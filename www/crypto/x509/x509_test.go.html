<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8165935">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8165990">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8166044">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8166095">package</span>&nbsp;<span class="ident" id="8166103">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8166109">import</span>&nbsp;<span class="op" id="8166116">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166119">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166128">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166142">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166158">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166177">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166192">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8166206">_</span>&nbsp;<span class="string" id="8166208">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8166225">_</span>&nbsp;<span class="string" id="8166227">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166244">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166264">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166281">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166300">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166316">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166332">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166344">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166351">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166362">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166373">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166384">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8166395">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8166402">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8166405">func</span>&nbsp;<span class="ident" id="8166410">TestParsePKCS1PrivateKey</span><span class="op" id="8166434">(</span><span class="ident" id="8166435">t</span>&nbsp;<span class="op" id="8166437">*</span><span class="ident" id="8166438"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8166445">.</span><span class="ident" id="8166446">T</span><span class="op" id="8166447">)</span>&nbsp;<span class="op" id="8166449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8166452">block</span><span class="op" id="8166457">,</span>&nbsp;<span class="ident" id="8166459">_</span>&nbsp;<span class="op" id="8166461">:=</span>&nbsp;<span class="ident" id="8166464"><a href="/crypto/x509/x509_test.go.html#8166316">pem</a></span><span class="op" id="8166467">.</span><span class="ident" id="8166468">Decode</span><span class="op" id="8166474">(</span><span class="op" id="8166475">[</span><span class="op" id="8166476">]</span><span class="builtintype" id="8166477">byte</span><span class="op" id="8166481">(</span><span class="ident" id="8166482"><a href="/crypto/x509/x509_test.go.html#8168074">pemPrivateKey</a></span><span class="op" id="8166495">)</span><span class="op" id="8166496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8166499">priv</span><span class="op" id="8166503">,</span>&nbsp;<span class="ident" id="8166505">err</span>&nbsp;<span class="op" id="8166509">:=</span>&nbsp;<span class="ident" id="8166512"><a href="/crypto/x509/pkcs1.go.html#4294252">ParsePKCS1PrivateKey</a></span><span class="op" id="8166532">(</span><span class="ident" id="8166533"><a href="/crypto/x509/x509_test.go.html#8166452">block</a></span><span class="op" id="8166538">.</span><span class="ident" id="8166539">Bytes</span><span class="op" id="8166544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8166547">if</span>&nbsp;<span class="ident" id="8166550"><a href="/crypto/x509/x509_test.go.html#8166505">err</a></span>&nbsp;<span class="op" id="8166554">!=</span>&nbsp;<span class="ident" id="8166557">nil</span>&nbsp;<span class="op" id="8166561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8166565"><a href="/crypto/x509/x509_test.go.html#8166435">t</a></span><span class="op" id="8166566">.</span><span class="ident" id="8166567">Errorf</span><span class="op" id="8166573">(</span><span class="string" id="8166574">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8166607">,</span>&nbsp;<span class="ident" id="8166609"><a href="/crypto/x509/x509_test.go.html#8166505">err</a></span><span class="op" id="8166612">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8166616">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8166624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8166627">if</span>&nbsp;<span class="ident" id="8166630"><a href="/crypto/x509/x509_test.go.html#8166499">priv</a></span><span class="op" id="8166634">.</span><span class="ident" id="8166635">PublicKey</span><span class="op" id="8166644">.</span><span class="ident" id="8166645">N</span><span class="op" id="8166646">.</span><span class="ident" id="8166647">Cmp</span><span class="op" id="8166650">(</span><span class="ident" id="8166651"><a href="/crypto/x509/x509_test.go.html#8168889">rsaPrivateKey</a></span><span class="op" id="8166664">.</span><span class="ident" id="8166665">PublicKey</span><span class="op" id="8166674">.</span><span class="ident" id="8166675">N</span><span class="op" id="8166676">)</span>&nbsp;<span class="op" id="8166678">!=</span>&nbsp;<span class="num" id="8166681">0</span>&nbsp;<span class="op" id="8166683">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8166688"><a href="/crypto/x509/x509_test.go.html#8166499">priv</a></span><span class="op" id="8166692">.</span><span class="ident" id="8166693">PublicKey</span><span class="op" id="8166702">.</span><span class="ident" id="8166703">E</span>&nbsp;<span class="op" id="8166705">!=</span>&nbsp;<span class="ident" id="8166708"><a href="/crypto/x509/x509_test.go.html#8168889">rsaPrivateKey</a></span><span class="op" id="8166721">.</span><span class="ident" id="8166722">PublicKey</span><span class="op" id="8166731">.</span><span class="ident" id="8166732">E</span>&nbsp;<span class="op" id="8166734">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8166739"><a href="/crypto/x509/x509_test.go.html#8166499">priv</a></span><span class="op" id="8166743">.</span><span class="ident" id="8166744">D</span><span class="op" id="8166745">.</span><span class="ident" id="8166746">Cmp</span><span class="op" id="8166749">(</span><span class="ident" id="8166750"><a href="/crypto/x509/x509_test.go.html#8168889">rsaPrivateKey</a></span><span class="op" id="8166763">.</span><span class="ident" id="8166764">D</span><span class="op" id="8166765">)</span>&nbsp;<span class="op" id="8166767">!=</span>&nbsp;<span class="num" id="8166770">0</span>&nbsp;<span class="op" id="8166772">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8166777"><a href="/crypto/x509/x509_test.go.html#8166499">priv</a></span><span class="op" id="8166781">.</span><span class="ident" id="8166782">Primes</span><span class="op" id="8166788">[</span><span class="num" id="8166789">0</span><span class="op" id="8166790">]</span><span class="op" id="8166791">.</span><span class="ident" id="8166792">Cmp</span><span class="op" id="8166795">(</span><span class="ident" id="8166796"><a href="/crypto/x509/x509_test.go.html#8168889">rsaPrivateKey</a></span><span class="op" id="8166809">.</span><span class="ident" id="8166810">Primes</span><span class="op" id="8166816">[</span><span class="num" id="8166817">0</span><span class="op" id="8166818">]</span><span class="op" id="8166819">)</span>&nbsp;<span class="op" id="8166821">!=</span>&nbsp;<span class="num" id="8166824">0</span>&nbsp;<span class="op" id="8166826">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8166831"><a href="/crypto/x509/x509_test.go.html#8166499">priv</a></span><span class="op" id="8166835">.</span><span class="ident" id="8166836">Primes</span><span class="op" id="8166842">[</span><span class="num" id="8166843">1</span><span class="op" id="8166844">]</span><span class="op" id="8166845">.</span><span class="ident" id="8166846">Cmp</span><span class="op" id="8166849">(</span><span class="ident" id="8166850"><a href="/crypto/x509/x509_test.go.html#8168889">rsaPrivateKey</a></span><span class="op" id="8166863">.</span><span class="ident" id="8166864">Primes</span><span class="op" id="8166870">[</span><span class="num" id="8166871">1</span><span class="op" id="8166872">]</span><span class="op" id="8166873">)</span>&nbsp;<span class="op" id="8166875">!=</span>&nbsp;<span class="num" id="8166878">0</span>&nbsp;<span class="op" id="8166880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8166884"><a href="/crypto/x509/x509_test.go.html#8166435">t</a></span><span class="op" id="8166885">.</span><span class="ident" id="8166886">Errorf</span><span class="op" id="8166892">(</span><span class="string" id="8166893">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="8166911">,</span>&nbsp;<span class="ident" id="8166913"><a href="/crypto/x509/x509_test.go.html#8166499">priv</a></span><span class="op" id="8166917">,</span>&nbsp;<span class="ident" id="8166919"><a href="/crypto/x509/x509_test.go.html#8168889">rsaPrivateKey</a></span><span class="op" id="8166932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8166935">}</span><br>
<span class="lineno"></span><span class="op" id="8166937">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8166940">func</span>&nbsp;<span class="ident" id="8166945">TestParsePKIXPublicKey</span><span class="op" id="8166967">(</span><span class="ident" id="8166968">t</span>&nbsp;<span class="op" id="8166970">*</span><span class="ident" id="8166971"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8166978">.</span><span class="ident" id="8166979">T</span><span class="op" id="8166980">)</span>&nbsp;<span class="op" id="8166982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8166985">block</span><span class="op" id="8166990">,</span>&nbsp;<span class="ident" id="8166992">_</span>&nbsp;<span class="op" id="8166994">:=</span>&nbsp;<span class="ident" id="8166997"><a href="/crypto/x509/x509_test.go.html#8166316">pem</a></span><span class="op" id="8167000">.</span><span class="ident" id="8167001">Decode</span><span class="op" id="8167007">(</span><span class="op" id="8167008">[</span><span class="op" id="8167009">]</span><span class="builtintype" id="8167010">byte</span><span class="op" id="8167014">(</span><span class="ident" id="8167015"><a href="/crypto/x509/x509_test.go.html#8167600">pemPublicKey</a></span><span class="op" id="8167027">)</span><span class="op" id="8167028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8167031">pub</span><span class="op" id="8167034">,</span>&nbsp;<span class="ident" id="8167036">err</span>&nbsp;<span class="op" id="8167040">:=</span>&nbsp;<span class="ident" id="8167043"><a href="/crypto/x509/x509.go.html#4317095">ParsePKIXPublicKey</a></span><span class="op" id="8167061">(</span><span class="ident" id="8167062"><a href="/crypto/x509/x509_test.go.html#8166985">block</a></span><span class="op" id="8167067">.</span><span class="ident" id="8167068">Bytes</span><span class="op" id="8167073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8167076">if</span>&nbsp;<span class="ident" id="8167079"><a href="/crypto/x509/x509_test.go.html#8167036">err</a></span>&nbsp;<span class="op" id="8167083">!=</span>&nbsp;<span class="ident" id="8167086">nil</span>&nbsp;<span class="op" id="8167090">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8167094"><a href="/crypto/x509/x509_test.go.html#8166968">t</a></span><span class="op" id="8167095">.</span><span class="ident" id="8167096">Errorf</span><span class="op" id="8167102">(</span><span class="string" id="8167103">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8167139">,</span>&nbsp;<span class="ident" id="8167141"><a href="/crypto/x509/x509_test.go.html#8167036">err</a></span><span class="op" id="8167144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8167148">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8167156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8167159">rsaPub</span><span class="op" id="8167165">,</span>&nbsp;<span class="ident" id="8167167">ok</span>&nbsp;<span class="op" id="8167170">:=</span>&nbsp;<span class="ident" id="8167173"><a href="/crypto/x509/x509_test.go.html#8167031">pub</a></span><span class="op" id="8167176">.</span><span class="op" id="8167177">(</span><span class="op" id="8167178">*</span><span class="ident" id="8167179"><a href="/crypto/x509/x509_test.go.html#8166192">rsa</a></span><span class="op" id="8167182">.</span><span class="ident" id="8167183">PublicKey</span><span class="op" id="8167192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8167195">if</span>&nbsp;<span class="op" id="8167198">!</span><span class="ident" id="8167199"><a href="/crypto/x509/x509_test.go.html#8167167">ok</a></span>&nbsp;<span class="op" id="8167202">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8167206"><a href="/crypto/x509/x509_test.go.html#8166968">t</a></span><span class="op" id="8167207">.</span><span class="ident" id="8167208">Errorf</span><span class="op" id="8167214">(</span><span class="string" id="8167215">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="8167281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8167285">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8167293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8167297">pubBytes2</span><span class="op" id="8167306">,</span>&nbsp;<span class="ident" id="8167308"><a href="/crypto/x509/x509_test.go.html#8167036">err</a></span>&nbsp;<span class="op" id="8167312">:=</span>&nbsp;<span class="ident" id="8167315"><a href="/crypto/x509/x509.go.html#4318676">MarshalPKIXPublicKey</a></span><span class="op" id="8167335">(</span><span class="ident" id="8167336"><a href="/crypto/x509/x509_test.go.html#8167159">rsaPub</a></span><span class="op" id="8167342">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8167345">if</span>&nbsp;<span class="ident" id="8167348"><a href="/crypto/x509/x509_test.go.html#8167036">err</a></span>&nbsp;<span class="op" id="8167352">!=</span>&nbsp;<span class="ident" id="8167355">nil</span>&nbsp;<span class="op" id="8167359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8167363"><a href="/crypto/x509/x509_test.go.html#8166968">t</a></span><span class="op" id="8167364">.</span><span class="ident" id="8167365">Errorf</span><span class="op" id="8167371">(</span><span class="string" id="8167372">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="8167430">,</span>&nbsp;<span class="ident" id="8167432"><a href="/crypto/x509/x509_test.go.html#8167036">err</a></span><span class="op" id="8167435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8167439">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8167447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8167450">if</span>&nbsp;<span class="op" id="8167453">!</span><span class="ident" id="8167454"><a href="/crypto/x509/x509_test.go.html#8166119">bytes</a></span><span class="op" id="8167459">.</span><span class="ident" id="8167460">Equal</span><span class="op" id="8167465">(</span><span class="ident" id="8167466"><a href="/crypto/x509/x509_test.go.html#8167297">pubBytes2</a></span><span class="op" id="8167475">,</span>&nbsp;<span class="ident" id="8167477"><a href="/crypto/x509/x509_test.go.html#8166985">block</a></span><span class="op" id="8167482">.</span><span class="ident" id="8167483">Bytes</span><span class="op" id="8167488">)</span>&nbsp;<span class="op" id="8167490">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8167494"><a href="/crypto/x509/x509_test.go.html#8166968">t</a></span><span class="op" id="8167495">.</span><span class="ident" id="8167496">Errorf</span><span class="op" id="8167502">(</span><span class="string" id="8167503">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="8167564">,</span>&nbsp;<span class="ident" id="8167566"><a href="/crypto/x509/x509_test.go.html#8167297">pubBytes2</a></span><span class="op" id="8167575">,</span>&nbsp;<span class="ident" id="8167577"><a href="/crypto/x509/x509_test.go.html#8166985">block</a></span><span class="op" id="8167582">.</span><span class="ident" id="8167583">Bytes</span><span class="op" id="8167588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8167591">}</span><br>
<span class="lineno"></span><span class="op" id="8167593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8167596">var</span>&nbsp;<span class="ident" id="8167600">pemPublicKey</span>&nbsp;<span class="op" id="8167613">=</span>&nbsp;<span class="string" id="8167615">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="8168070">var</span>&nbsp;<span class="ident" id="8168074">pemPrivateKey</span>&nbsp;<span class="op" id="8168088">=</span>&nbsp;<span class="string" id="8168090">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="8168587">func</span>&nbsp;<span class="ident" id="8168592">bigFromString</span><span class="op" id="8168605">(</span><span class="ident" id="8168606">s</span>&nbsp;<span class="builtintype" id="8168608">string</span><span class="op" id="8168614">)</span>&nbsp;<span class="op" id="8168616">*</span><span class="ident" id="8168617"><a href="/crypto/x509/x509_test.go.html#8166332">big</a></span><span class="op" id="8168620">.</span><span class="ident" id="8168621">Int</span>&nbsp;<span class="op" id="8168625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8168628">ret</span>&nbsp;<span class="op" id="8168632">:=</span>&nbsp;<span class="builtinfunc" id="8168635">new</span><span class="op" id="8168638">(</span><span class="ident" id="8168639"><a href="/crypto/x509/x509_test.go.html#8166332">big</a></span><span class="op" id="8168642">.</span><span class="ident" id="8168643">Int</span><span class="op" id="8168646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8168649"><a href="/crypto/x509/x509_test.go.html#8168628">ret</a></span><span class="op" id="8168652">.</span><span class="ident" id="8168653">SetString</span><span class="op" id="8168662">(</span><span class="ident" id="8168663"><a href="/crypto/x509/x509_test.go.html#8168606">s</a></span><span class="op" id="8168664">,</span>&nbsp;<span class="num" id="8168666">10</span><span class="op" id="8168668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8168671">return</span>&nbsp;<span class="ident" id="8168678"><a href="/crypto/x509/x509_test.go.html#8168628">ret</a></span><br>
<span class="lineno">95</span><span class="op" id="8168682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8168685">func</span>&nbsp;<span class="ident" id="8168690">fromBase10</span><span class="op" id="8168700">(</span><span class="ident" id="8168701">base10</span>&nbsp;<span class="builtintype" id="8168708">string</span><span class="op" id="8168714">)</span>&nbsp;<span class="op" id="8168716">*</span><span class="ident" id="8168717"><a href="/crypto/x509/x509_test.go.html#8166332">big</a></span><span class="op" id="8168720">.</span><span class="ident" id="8168721">Int</span>&nbsp;<span class="op" id="8168725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8168728">i</span>&nbsp;<span class="op" id="8168730">:=</span>&nbsp;<span class="builtinfunc" id="8168733">new</span><span class="op" id="8168736">(</span><span class="ident" id="8168737"><a href="/crypto/x509/x509_test.go.html#8166332">big</a></span><span class="op" id="8168740">.</span><span class="ident" id="8168741">Int</span><span class="op" id="8168744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8168747"><a href="/crypto/x509/x509_test.go.html#8168728">i</a></span><span class="op" id="8168748">.</span><span class="ident" id="8168749">SetString</span><span class="op" id="8168758">(</span><span class="ident" id="8168759"><a href="/crypto/x509/x509_test.go.html#8168701">base10</a></span><span class="op" id="8168765">,</span>&nbsp;<span class="num" id="8168767">10</span><span class="op" id="8168769">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8168772">return</span>&nbsp;<span class="ident" id="8168779"><a href="/crypto/x509/x509_test.go.html#8168728">i</a></span><br>
<span class="lineno"></span><span class="op" id="8168781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8168784">func</span>&nbsp;<span class="ident" id="8168789">bigFromHexString</span><span class="op" id="8168805">(</span><span class="ident" id="8168806">s</span>&nbsp;<span class="builtintype" id="8168808">string</span><span class="op" id="8168814">)</span>&nbsp;<span class="op" id="8168816">*</span><span class="ident" id="8168817"><a href="/crypto/x509/x509_test.go.html#8166332">big</a></span><span class="op" id="8168820">.</span><span class="ident" id="8168821">Int</span>&nbsp;<span class="op" id="8168825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8168828">ret</span>&nbsp;<span class="op" id="8168832">:=</span>&nbsp;<span class="builtinfunc" id="8168835">new</span><span class="op" id="8168838">(</span><span class="ident" id="8168839"><a href="/crypto/x509/x509_test.go.html#8166332">big</a></span><span class="op" id="8168842">.</span><span class="ident" id="8168843">Int</span><span class="op" id="8168846">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8168849"><a href="/crypto/x509/x509_test.go.html#8168828">ret</a></span><span class="op" id="8168852">.</span><span class="ident" id="8168853">SetString</span><span class="op" id="8168862">(</span><span class="ident" id="8168863"><a href="/crypto/x509/x509_test.go.html#8168806">s</a></span><span class="op" id="8168864">,</span>&nbsp;<span class="num" id="8168866">16</span><span class="op" id="8168868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8168871">return</span>&nbsp;<span class="ident" id="8168878"><a href="/crypto/x509/x509_test.go.html#8168828">ret</a></span><br>
<span class="lineno"></span><span class="op" id="8168882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8168885">var</span>&nbsp;<span class="ident" id="8168889">rsaPrivateKey</span>&nbsp;<span class="op" id="8168903">=</span>&nbsp;<span class="op" id="8168905">&amp;</span><span class="ident" id="8168906"><a href="/crypto/x509/x509_test.go.html#8166192">rsa</a></span><span class="op" id="8168909">.</span><span class="ident" id="8168910">PrivateKey</span><span class="op" id="8168920">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8168923">PublicKey</span><span class="op" id="8168932">:</span>&nbsp;<span class="ident" id="8168934"><a href="/crypto/x509/x509_test.go.html#8166192">rsa</a></span><span class="op" id="8168937">.</span><span class="ident" id="8168938">PublicKey</span><span class="op" id="8168947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8168951">N</span><span class="op" id="8168952">:</span>&nbsp;<span class="ident" id="8168954"><a href="/crypto/x509/x509_test.go.html#8168592">bigFromString</a></span><span class="op" id="8168967">(</span><span class="string" id="8168968">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="8169124">)</span><span class="op" id="8169125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8169129">E</span><span class="op" id="8169130">:</span>&nbsp;<span class="num" id="8169132">65537</span><span class="op" id="8169137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8169140">}</span><span class="op" id="8169141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8169144">D</span><span class="op" id="8169145">:</span>&nbsp;<span class="ident" id="8169147"><a href="/crypto/x509/x509_test.go.html#8168592">bigFromString</a></span><span class="op" id="8169160">(</span><span class="string" id="8169161">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="8169317">)</span><span class="op" id="8169318">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8169321">Primes</span><span class="op" id="8169327">:</span>&nbsp;<span class="op" id="8169329">[</span><span class="op" id="8169330">]</span><span class="op" id="8169331">*</span><span class="ident" id="8169332"><a href="/crypto/x509/x509_test.go.html#8166332">big</a></span><span class="op" id="8169335">.</span><span class="ident" id="8169336">Int</span><span class="op" id="8169339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8169343"><a href="/crypto/x509/x509_test.go.html#8168592">bigFromString</a></span><span class="op" id="8169356">(</span><span class="string" id="8169357">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="8169436">)</span><span class="op" id="8169437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8169441"><a href="/crypto/x509/x509_test.go.html#8168592">bigFromString</a></span><span class="op" id="8169454">(</span><span class="string" id="8169455">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="8169534">)</span><span class="op" id="8169535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8169538">}</span><span class="op" id="8169539">,</span><br>
<span class="lineno"></span><span class="op" id="8169541">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="8169544">func</span>&nbsp;<span class="ident" id="8169549">TestMarshalRSAPrivateKey</span><span class="op" id="8169573">(</span><span class="ident" id="8169574">t</span>&nbsp;<span class="op" id="8169576">*</span><span class="ident" id="8169577"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8169584">.</span><span class="ident" id="8169585">T</span><span class="op" id="8169586">)</span>&nbsp;<span class="op" id="8169588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8169591">priv</span>&nbsp;<span class="op" id="8169596">:=</span>&nbsp;<span class="op" id="8169599">&amp;</span><span class="ident" id="8169600"><a href="/crypto/x509/x509_test.go.html#8166192">rsa</a></span><span class="op" id="8169603">.</span><span class="ident" id="8169604">PrivateKey</span><span class="op" id="8169614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8169618">PublicKey</span><span class="op" id="8169627">:</span>&nbsp;<span class="ident" id="8169629"><a href="/crypto/x509/x509_test.go.html#8166192">rsa</a></span><span class="op" id="8169632">.</span><span class="ident" id="8169633">PublicKey</span><span class="op" id="8169642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8169647">N</span><span class="op" id="8169648">:</span>&nbsp;<span class="ident" id="8169650"><a href="/crypto/x509/x509_test.go.html#8168690">fromBase10</a></span><span class="op" id="8169660">(</span><span class="string" id="8169661">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="8170280">)</span><span class="op" id="8170281">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8170286">E</span><span class="op" id="8170287">:</span>&nbsp;<span class="num" id="8170289">3</span><span class="op" id="8170290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8170294">}</span><span class="op" id="8170295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8170299">D</span><span class="op" id="8170300">:</span>&nbsp;<span class="ident" id="8170302"><a href="/crypto/x509/x509_test.go.html#8168690">fromBase10</a></span><span class="op" id="8170312">(</span><span class="string" id="8170313">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="8170932">)</span><span class="op" id="8170933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8170937">Primes</span><span class="op" id="8170943">:</span>&nbsp;<span class="op" id="8170945">[</span><span class="op" id="8170946">]</span><span class="op" id="8170947">*</span><span class="ident" id="8170948"><a href="/crypto/x509/x509_test.go.html#8166332">big</a></span><span class="op" id="8170951">.</span><span class="ident" id="8170952">Int</span><span class="op" id="8170955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8170960"><a href="/crypto/x509/x509_test.go.html#8168690">fromBase10</a></span><span class="op" id="8170970">(</span><span class="string" id="8170971">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="8171181">)</span><span class="op" id="8171182">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171187"><a href="/crypto/x509/x509_test.go.html#8168690">fromBase10</a></span><span class="op" id="8171197">(</span><span class="string" id="8171198">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="8171405">)</span><span class="op" id="8171406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171411"><a href="/crypto/x509/x509_test.go.html#8168690">fromBase10</a></span><span class="op" id="8171421">(</span><span class="string" id="8171422">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="8171629">)</span><span class="op" id="8171630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8171634">}</span><span class="op" id="8171635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8171638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171642">derBytes</span>&nbsp;<span class="op" id="8171651">:=</span>&nbsp;<span class="ident" id="8171654"><a href="/crypto/x509/pkcs1.go.html#4295416">MarshalPKCS1PrivateKey</a></span><span class="op" id="8171676">(</span><span class="ident" id="8171677"><a href="/crypto/x509/x509_test.go.html#8169591">priv</a></span><span class="op" id="8171681">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171685">priv2</span><span class="op" id="8171690">,</span>&nbsp;<span class="ident" id="8171692">err</span>&nbsp;<span class="op" id="8171696">:=</span>&nbsp;<span class="ident" id="8171699"><a href="/crypto/x509/pkcs1.go.html#4294252">ParsePKCS1PrivateKey</a></span><span class="op" id="8171719">(</span><span class="ident" id="8171720"><a href="/crypto/x509/x509_test.go.html#8171642">derBytes</a></span><span class="op" id="8171728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8171731">if</span>&nbsp;<span class="ident" id="8171734"><a href="/crypto/x509/x509_test.go.html#8171692">err</a></span>&nbsp;<span class="op" id="8171738">!=</span>&nbsp;<span class="ident" id="8171741">nil</span>&nbsp;<span class="op" id="8171745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171749"><a href="/crypto/x509/x509_test.go.html#8169574">t</a></span><span class="op" id="8171750">.</span><span class="ident" id="8171751">Errorf</span><span class="op" id="8171757">(</span><span class="string" id="8171758">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8171792">,</span>&nbsp;<span class="ident" id="8171794"><a href="/crypto/x509/x509_test.go.html#8171692">err</a></span><span class="op" id="8171797">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8171801">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8171809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8171812">if</span>&nbsp;<span class="ident" id="8171815"><a href="/crypto/x509/x509_test.go.html#8169591">priv</a></span><span class="op" id="8171819">.</span><span class="ident" id="8171820">PublicKey</span><span class="op" id="8171829">.</span><span class="ident" id="8171830">N</span><span class="op" id="8171831">.</span><span class="ident" id="8171832">Cmp</span><span class="op" id="8171835">(</span><span class="ident" id="8171836"><a href="/crypto/x509/x509_test.go.html#8171685">priv2</a></span><span class="op" id="8171841">.</span><span class="ident" id="8171842">PublicKey</span><span class="op" id="8171851">.</span><span class="ident" id="8171852">N</span><span class="op" id="8171853">)</span>&nbsp;<span class="op" id="8171855">!=</span>&nbsp;<span class="num" id="8171858">0</span>&nbsp;<span class="op" id="8171860">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171865"><a href="/crypto/x509/x509_test.go.html#8169591">priv</a></span><span class="op" id="8171869">.</span><span class="ident" id="8171870">PublicKey</span><span class="op" id="8171879">.</span><span class="ident" id="8171880">E</span>&nbsp;<span class="op" id="8171882">!=</span>&nbsp;<span class="ident" id="8171885"><a href="/crypto/x509/x509_test.go.html#8171685">priv2</a></span><span class="op" id="8171890">.</span><span class="ident" id="8171891">PublicKey</span><span class="op" id="8171900">.</span><span class="ident" id="8171901">E</span>&nbsp;<span class="op" id="8171903">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171908"><a href="/crypto/x509/x509_test.go.html#8169591">priv</a></span><span class="op" id="8171912">.</span><span class="ident" id="8171913">D</span><span class="op" id="8171914">.</span><span class="ident" id="8171915">Cmp</span><span class="op" id="8171918">(</span><span class="ident" id="8171919"><a href="/crypto/x509/x509_test.go.html#8171685">priv2</a></span><span class="op" id="8171924">.</span><span class="ident" id="8171925">D</span><span class="op" id="8171926">)</span>&nbsp;<span class="op" id="8171928">!=</span>&nbsp;<span class="num" id="8171931">0</span>&nbsp;<span class="op" id="8171933">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8171938">len</span><span class="op" id="8171941">(</span><span class="ident" id="8171942"><a href="/crypto/x509/x509_test.go.html#8171685">priv2</a></span><span class="op" id="8171947">.</span><span class="ident" id="8171948">Primes</span><span class="op" id="8171954">)</span>&nbsp;<span class="op" id="8171956">!=</span>&nbsp;<span class="num" id="8171959">3</span>&nbsp;<span class="op" id="8171961">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8171966"><a href="/crypto/x509/x509_test.go.html#8169591">priv</a></span><span class="op" id="8171970">.</span><span class="ident" id="8171971">Primes</span><span class="op" id="8171977">[</span><span class="num" id="8171978">0</span><span class="op" id="8171979">]</span><span class="op" id="8171980">.</span><span class="ident" id="8171981">Cmp</span><span class="op" id="8171984">(</span><span class="ident" id="8171985"><a href="/crypto/x509/x509_test.go.html#8171685">priv2</a></span><span class="op" id="8171990">.</span><span class="ident" id="8171991">Primes</span><span class="op" id="8171997">[</span><span class="num" id="8171998">0</span><span class="op" id="8171999">]</span><span class="op" id="8172000">)</span>&nbsp;<span class="op" id="8172002">!=</span>&nbsp;<span class="num" id="8172005">0</span>&nbsp;<span class="op" id="8172007">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172012"><a href="/crypto/x509/x509_test.go.html#8169591">priv</a></span><span class="op" id="8172016">.</span><span class="ident" id="8172017">Primes</span><span class="op" id="8172023">[</span><span class="num" id="8172024">1</span><span class="op" id="8172025">]</span><span class="op" id="8172026">.</span><span class="ident" id="8172027">Cmp</span><span class="op" id="8172030">(</span><span class="ident" id="8172031"><a href="/crypto/x509/x509_test.go.html#8171685">priv2</a></span><span class="op" id="8172036">.</span><span class="ident" id="8172037">Primes</span><span class="op" id="8172043">[</span><span class="num" id="8172044">1</span><span class="op" id="8172045">]</span><span class="op" id="8172046">)</span>&nbsp;<span class="op" id="8172048">!=</span>&nbsp;<span class="num" id="8172051">0</span>&nbsp;<span class="op" id="8172053">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172058"><a href="/crypto/x509/x509_test.go.html#8169591">priv</a></span><span class="op" id="8172062">.</span><span class="ident" id="8172063">Primes</span><span class="op" id="8172069">[</span><span class="num" id="8172070">2</span><span class="op" id="8172071">]</span><span class="op" id="8172072">.</span><span class="ident" id="8172073">Cmp</span><span class="op" id="8172076">(</span><span class="ident" id="8172077"><a href="/crypto/x509/x509_test.go.html#8171685">priv2</a></span><span class="op" id="8172082">.</span><span class="ident" id="8172083">Primes</span><span class="op" id="8172089">[</span><span class="num" id="8172090">2</span><span class="op" id="8172091">]</span><span class="op" id="8172092">)</span>&nbsp;<span class="op" id="8172094">!=</span>&nbsp;<span class="num" id="8172097">0</span>&nbsp;<span class="op" id="8172099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172103"><a href="/crypto/x509/x509_test.go.html#8169574">t</a></span><span class="op" id="8172104">.</span><span class="ident" id="8172105">Errorf</span><span class="op" id="8172111">(</span><span class="string" id="8172112">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="8172130">,</span>&nbsp;<span class="ident" id="8172132"><a href="/crypto/x509/x509_test.go.html#8169591">priv</a></span><span class="op" id="8172136">,</span>&nbsp;<span class="ident" id="8172138"><a href="/crypto/x509/x509_test.go.html#8171685">priv2</a></span><span class="op" id="8172143">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172146">}</span><br>
<span class="lineno"></span><span class="op" id="8172148">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8172151">type</span>&nbsp;<span class="ident" id="8172156">matchHostnamesTest</span>&nbsp;<span class="keyword" id="8172175">struct</span>&nbsp;<span class="op" id="8172182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172185">pattern</span><span class="op" id="8172192">,</span>&nbsp;<span class="ident" id="8172194">host</span>&nbsp;<span class="builtintype" id="8172199">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172207">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8172221">bool</span><br>
<span class="lineno"></span><span class="op" id="8172226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8172229">var</span>&nbsp;<span class="ident" id="8172233">matchHostnamesTests</span>&nbsp;<span class="op" id="8172253">=</span>&nbsp;<span class="op" id="8172255">[</span><span class="op" id="8172256">]</span><span class="ident" id="8172257"><a href="/crypto/x509/x509_test.go.html#8172156">matchHostnamesTest</a></span><span class="op" id="8172275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172278">{</span><span class="string" id="8172279">&#34;a.b.c&#34;</span><span class="op" id="8172286">,</span>&nbsp;<span class="string" id="8172288">&#34;a.b.c&#34;</span><span class="op" id="8172295">,</span>&nbsp;<span class="ident" id="8172297">true</span><span class="op" id="8172301">}</span><span class="op" id="8172302">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172305">{</span><span class="string" id="8172306">&#34;a.b.c&#34;</span><span class="op" id="8172313">,</span>&nbsp;<span class="string" id="8172315">&#34;b.b.c&#34;</span><span class="op" id="8172322">,</span>&nbsp;<span class="ident" id="8172324">false</span><span class="op" id="8172329">}</span><span class="op" id="8172330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172333">{</span><span class="string" id="8172334">&#34;&#34;</span><span class="op" id="8172336">,</span>&nbsp;<span class="string" id="8172338">&#34;b.b.c&#34;</span><span class="op" id="8172345">,</span>&nbsp;<span class="ident" id="8172347">false</span><span class="op" id="8172352">}</span><span class="op" id="8172353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172356">{</span><span class="string" id="8172357">&#34;a.b.c&#34;</span><span class="op" id="8172364">,</span>&nbsp;<span class="string" id="8172366">&#34;&#34;</span><span class="op" id="8172368">,</span>&nbsp;<span class="ident" id="8172370">false</span><span class="op" id="8172375">}</span><span class="op" id="8172376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172379">{</span><span class="string" id="8172380">&#34;example.com&#34;</span><span class="op" id="8172393">,</span>&nbsp;<span class="string" id="8172395">&#34;example.com&#34;</span><span class="op" id="8172408">,</span>&nbsp;<span class="ident" id="8172410">true</span><span class="op" id="8172414">}</span><span class="op" id="8172415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172418">{</span><span class="string" id="8172419">&#34;example.com&#34;</span><span class="op" id="8172432">,</span>&nbsp;<span class="string" id="8172434">&#34;www.example.com&#34;</span><span class="op" id="8172451">,</span>&nbsp;<span class="ident" id="8172453">false</span><span class="op" id="8172458">}</span><span class="op" id="8172459">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172462">{</span><span class="string" id="8172463">&#34;*.example.com&#34;</span><span class="op" id="8172478">,</span>&nbsp;<span class="string" id="8172480">&#34;www.example.com&#34;</span><span class="op" id="8172497">,</span>&nbsp;<span class="ident" id="8172499">true</span><span class="op" id="8172503">}</span><span class="op" id="8172504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172507">{</span><span class="string" id="8172508">&#34;*.example.com&#34;</span><span class="op" id="8172523">,</span>&nbsp;<span class="string" id="8172525">&#34;xyz.www.example.com&#34;</span><span class="op" id="8172546">,</span>&nbsp;<span class="ident" id="8172548">false</span><span class="op" id="8172553">}</span><span class="op" id="8172554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172557">{</span><span class="string" id="8172558">&#34;*.*.example.com&#34;</span><span class="op" id="8172575">,</span>&nbsp;<span class="string" id="8172577">&#34;xyz.www.example.com&#34;</span><span class="op" id="8172598">,</span>&nbsp;<span class="ident" id="8172600">true</span><span class="op" id="8172604">}</span><span class="op" id="8172605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172608">{</span><span class="string" id="8172609">&#34;*.www.*.com&#34;</span><span class="op" id="8172622">,</span>&nbsp;<span class="string" id="8172624">&#34;xyz.www.example.com&#34;</span><span class="op" id="8172645">,</span>&nbsp;<span class="ident" id="8172647">true</span><span class="op" id="8172651">}</span><span class="op" id="8172652">,</span><br>
<span class="lineno"></span><span class="op" id="8172654">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="8172657">func</span>&nbsp;<span class="ident" id="8172662">TestMatchHostnames</span><span class="op" id="8172680">(</span><span class="ident" id="8172681">t</span>&nbsp;<span class="op" id="8172683">*</span><span class="ident" id="8172684"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8172691">.</span><span class="ident" id="8172692">T</span><span class="op" id="8172693">)</span>&nbsp;<span class="op" id="8172695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8172698">for</span>&nbsp;<span class="ident" id="8172702">i</span><span class="op" id="8172703">,</span>&nbsp;<span class="ident" id="8172705">test</span>&nbsp;<span class="op" id="8172710">:=</span>&nbsp;<span class="keyword" id="8172713">range</span>&nbsp;<span class="ident" id="8172719"><a href="/crypto/x509/x509_test.go.html#8172233">matchHostnamesTests</a></span>&nbsp;<span class="op" id="8172739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172743">r</span>&nbsp;<span class="op" id="8172745">:=</span>&nbsp;<span class="ident" id="8172748"><a href="/crypto/x509/verify.go.html#4312550">matchHostnames</a></span><span class="op" id="8172762">(</span><span class="ident" id="8172763"><a href="/crypto/x509/x509_test.go.html#8172705">test</a></span><span class="op" id="8172767">.</span><span class="ident" id="8172768">pattern</span><span class="op" id="8172775">,</span>&nbsp;<span class="ident" id="8172777"><a href="/crypto/x509/x509_test.go.html#8172705">test</a></span><span class="op" id="8172781">.</span><span class="ident" id="8172782">host</span><span class="op" id="8172786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8172790">if</span>&nbsp;<span class="ident" id="8172793"><a href="/crypto/x509/x509_test.go.html#8172743">r</a></span>&nbsp;<span class="op" id="8172795">!=</span>&nbsp;<span class="ident" id="8172798"><a href="/crypto/x509/x509_test.go.html#8172705">test</a></span><span class="op" id="8172802">.</span><span class="ident" id="8172803">ok</span>&nbsp;<span class="op" id="8172806">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172811"><a href="/crypto/x509/x509_test.go.html#8172681">t</a></span><span class="op" id="8172812">.</span><span class="ident" id="8172813">Errorf</span><span class="op" id="8172819">(</span><span class="string" id="8172820">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="8172851">,</span>&nbsp;<span class="ident" id="8172853"><a href="/crypto/x509/x509_test.go.html#8172702">i</a></span><span class="op" id="8172854">,</span>&nbsp;<span class="ident" id="8172856"><a href="/crypto/x509/x509_test.go.html#8172743">r</a></span><span class="op" id="8172857">,</span>&nbsp;<span class="ident" id="8172859"><a href="/crypto/x509/x509_test.go.html#8172705">test</a></span><span class="op" id="8172863">.</span><span class="ident" id="8172864">ok</span><span class="op" id="8172866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8172873">}</span><br>
<span class="lineno"></span><span class="op" id="8172875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="8172878">func</span>&nbsp;<span class="ident" id="8172883">TestMatchIP</span><span class="op" id="8172894">(</span><span class="ident" id="8172895">t</span>&nbsp;<span class="op" id="8172897">*</span><span class="ident" id="8172898"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8172905">.</span><span class="ident" id="8172906">T</span><span class="op" id="8172907">)</span>&nbsp;<span class="op" id="8172909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8172912">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172956">c</span>&nbsp;<span class="op" id="8172958">:=</span>&nbsp;<span class="op" id="8172961">&amp;</span><span class="ident" id="8172962"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="8172973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8172977">DNSNames</span><span class="op" id="8172985">:</span>&nbsp;<span class="op" id="8172987">[</span><span class="op" id="8172988">]</span><span class="builtintype" id="8172989">string</span><span class="op" id="8172995">{</span><span class="string" id="8172996">&#34;*.foo.bar.baz&#34;</span><span class="op" id="8173011">}</span><span class="op" id="8173012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173016">Subject</span><span class="op" id="8173023">:</span>&nbsp;<span class="ident" id="8173025"><a href="/crypto/x509/x509_test.go.html#8166244">pkix</a></span><span class="op" id="8173029">.</span><span class="ident" id="8173030">Name</span><span class="op" id="8173034">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173039">CommonName</span><span class="op" id="8173049">:</span>&nbsp;<span class="string" id="8173051">&#34;*.foo.bar.baz&#34;</span><span class="op" id="8173066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173070">}</span><span class="op" id="8173071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173077">err</span>&nbsp;<span class="op" id="8173081">:=</span>&nbsp;<span class="ident" id="8173084"><a href="/crypto/x509/x509_test.go.html#8172956">c</a></span><span class="op" id="8173085">.</span><span class="ident" id="8173086">VerifyHostname</span><span class="op" id="8173100">(</span><span class="string" id="8173101">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="8173119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8173122">if</span>&nbsp;<span class="ident" id="8173125"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span>&nbsp;<span class="op" id="8173129">!=</span>&nbsp;<span class="ident" id="8173132">nil</span>&nbsp;<span class="op" id="8173136">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173140"><a href="/crypto/x509/x509_test.go.html#8172895">t</a></span><span class="op" id="8173141">.</span><span class="ident" id="8173142">Fatalf</span><span class="op" id="8173148">(</span><span class="string" id="8173149">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="8173187">,</span>&nbsp;<span class="ident" id="8173189"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span><span class="op" id="8173192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8173199">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8173272">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173292"><a href="/crypto/x509/x509_test.go.html#8172956">c</a></span>&nbsp;<span class="op" id="8173294">=</span>&nbsp;<span class="op" id="8173296">&amp;</span><span class="ident" id="8173297"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="8173308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173312">DNSNames</span><span class="op" id="8173320">:</span>&nbsp;<span class="op" id="8173322">[</span><span class="op" id="8173323">]</span><span class="builtintype" id="8173324">string</span><span class="op" id="8173330">{</span><span class="string" id="8173331">&#34;*.2.3.4&#34;</span><span class="op" id="8173340">}</span><span class="op" id="8173341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173345">Subject</span><span class="op" id="8173352">:</span>&nbsp;<span class="ident" id="8173354"><a href="/crypto/x509/x509_test.go.html#8166244">pkix</a></span><span class="op" id="8173358">.</span><span class="ident" id="8173359">Name</span><span class="op" id="8173363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173368">CommonName</span><span class="op" id="8173378">:</span>&nbsp;<span class="string" id="8173380">&#34;*.2.3.4&#34;</span><span class="op" id="8173389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173393">}</span><span class="op" id="8173394">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173400"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span>&nbsp;<span class="op" id="8173404">=</span>&nbsp;<span class="ident" id="8173406"><a href="/crypto/x509/x509_test.go.html#8172956">c</a></span><span class="op" id="8173407">.</span><span class="ident" id="8173408">VerifyHostname</span><span class="op" id="8173422">(</span><span class="string" id="8173423">&#34;1.2.3.4&#34;</span><span class="op" id="8173432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8173435">if</span>&nbsp;<span class="ident" id="8173438"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span>&nbsp;<span class="op" id="8173442">==</span>&nbsp;<span class="ident" id="8173445">nil</span>&nbsp;<span class="op" id="8173449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173453"><a href="/crypto/x509/x509_test.go.html#8172895">t</a></span><span class="op" id="8173454">.</span><span class="ident" id="8173455">Fatalf</span><span class="op" id="8173461">(</span><span class="string" id="8173462">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="8173515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173518">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173522"><a href="/crypto/x509/x509_test.go.html#8172956">c</a></span>&nbsp;<span class="op" id="8173524">=</span>&nbsp;<span class="op" id="8173526">&amp;</span><span class="ident" id="8173527"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="8173538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173542">IPAddresses</span><span class="op" id="8173553">:</span>&nbsp;<span class="op" id="8173555">[</span><span class="op" id="8173556">]</span><span class="ident" id="8173557"><a href="/crypto/x509/x509_test.go.html#8166344">net</a></span><span class="op" id="8173560">.</span><span class="ident" id="8173561">IP</span><span class="op" id="8173563">{</span><span class="ident" id="8173564"><a href="/crypto/x509/x509_test.go.html#8166344">net</a></span><span class="op" id="8173567">.</span><span class="ident" id="8173568">ParseIP</span><span class="op" id="8173575">(</span><span class="string" id="8173576">&#34;127.0.0.1&#34;</span><span class="op" id="8173587">)</span><span class="op" id="8173588">,</span>&nbsp;<span class="ident" id="8173590"><a href="/crypto/x509/x509_test.go.html#8166344">net</a></span><span class="op" id="8173593">.</span><span class="ident" id="8173594">ParseIP</span><span class="op" id="8173601">(</span><span class="string" id="8173602">&#34;::1&#34;</span><span class="op" id="8173607">)</span><span class="op" id="8173608">}</span><span class="op" id="8173609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173615"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span>&nbsp;<span class="op" id="8173619">=</span>&nbsp;<span class="ident" id="8173621"><a href="/crypto/x509/x509_test.go.html#8172956">c</a></span><span class="op" id="8173622">.</span><span class="ident" id="8173623">VerifyHostname</span><span class="op" id="8173637">(</span><span class="string" id="8173638">&#34;127.0.0.1&#34;</span><span class="op" id="8173649">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8173652">if</span>&nbsp;<span class="ident" id="8173655"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span>&nbsp;<span class="op" id="8173659">!=</span>&nbsp;<span class="ident" id="8173662">nil</span>&nbsp;<span class="op" id="8173666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173670"><a href="/crypto/x509/x509_test.go.html#8172895">t</a></span><span class="op" id="8173671">.</span><span class="ident" id="8173672">Fatalf</span><span class="op" id="8173678">(</span><span class="string" id="8173679">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="8173710">,</span>&nbsp;<span class="ident" id="8173712"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span><span class="op" id="8173715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173721"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span>&nbsp;<span class="op" id="8173725">=</span>&nbsp;<span class="ident" id="8173727"><a href="/crypto/x509/x509_test.go.html#8172956">c</a></span><span class="op" id="8173728">.</span><span class="ident" id="8173729">VerifyHostname</span><span class="op" id="8173743">(</span><span class="string" id="8173744">&#34;::1&#34;</span><span class="op" id="8173749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8173752">if</span>&nbsp;<span class="ident" id="8173755"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span>&nbsp;<span class="op" id="8173759">!=</span>&nbsp;<span class="ident" id="8173762">nil</span>&nbsp;<span class="op" id="8173766">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173770"><a href="/crypto/x509/x509_test.go.html#8172895">t</a></span><span class="op" id="8173771">.</span><span class="ident" id="8173772">Fatalf</span><span class="op" id="8173778">(</span><span class="string" id="8173779">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="8173804">,</span>&nbsp;<span class="ident" id="8173806"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span><span class="op" id="8173809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173815"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span>&nbsp;<span class="op" id="8173819">=</span>&nbsp;<span class="ident" id="8173821"><a href="/crypto/x509/x509_test.go.html#8172956">c</a></span><span class="op" id="8173822">.</span><span class="ident" id="8173823">VerifyHostname</span><span class="op" id="8173837">(</span><span class="string" id="8173838">&#34;[::1]&#34;</span><span class="op" id="8173845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8173848">if</span>&nbsp;<span class="ident" id="8173851"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span>&nbsp;<span class="op" id="8173855">!=</span>&nbsp;<span class="ident" id="8173858">nil</span>&nbsp;<span class="op" id="8173862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173866"><a href="/crypto/x509/x509_test.go.html#8172895">t</a></span><span class="op" id="8173867">.</span><span class="ident" id="8173868">Fatalf</span><span class="op" id="8173874">(</span><span class="string" id="8173875">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="8173902">,</span>&nbsp;<span class="ident" id="8173904"><a href="/crypto/x509/x509_test.go.html#8173077">err</a></span><span class="op" id="8173907">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8173910">}</span><br>
<span class="lineno"></span><span class="op" id="8173912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8173915">func</span>&nbsp;<span class="ident" id="8173920">TestCertificateParse</span><span class="op" id="8173940">(</span><span class="ident" id="8173941">t</span>&nbsp;<span class="op" id="8173943">*</span><span class="ident" id="8173944"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8173951">.</span><span class="ident" id="8173952">T</span><span class="op" id="8173953">)</span>&nbsp;<span class="op" id="8173955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173958">s</span><span class="op" id="8173959">,</span>&nbsp;<span class="ident" id="8173961">_</span>&nbsp;<span class="op" id="8173963">:=</span>&nbsp;<span class="ident" id="8173966"><a href="/crypto/x509/x509_test.go.html#8166300">hex</a></span><span class="op" id="8173969">.</span><span class="ident" id="8173970">DecodeString</span><span class="op" id="8173982">(</span><span class="ident" id="8173983"><a href="/crypto/x509/x509_test.go.html#8174496">certBytes</a></span><span class="op" id="8173992">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8173995">certs</span><span class="op" id="8174000">,</span>&nbsp;<span class="ident" id="8174002">err</span>&nbsp;<span class="op" id="8174006">:=</span>&nbsp;<span class="ident" id="8174009"><a href="/crypto/x509/x509.go.html#4350954">ParseCertificates</a></span><span class="op" id="8174026">(</span><span class="ident" id="8174027"><a href="/crypto/x509/x509_test.go.html#8173958">s</a></span><span class="op" id="8174028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174031">if</span>&nbsp;<span class="ident" id="8174034"><a href="/crypto/x509/x509_test.go.html#8174002">err</a></span>&nbsp;<span class="op" id="8174038">!=</span>&nbsp;<span class="ident" id="8174041">nil</span>&nbsp;<span class="op" id="8174045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174049"><a href="/crypto/x509/x509_test.go.html#8173941">t</a></span><span class="op" id="8174050">.</span><span class="ident" id="8174051">Error</span><span class="op" id="8174056">(</span><span class="ident" id="8174057"><a href="/crypto/x509/x509_test.go.html#8174002">err</a></span><span class="op" id="8174060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174066">if</span>&nbsp;<span class="builtinfunc" id="8174069">len</span><span class="op" id="8174072">(</span><span class="ident" id="8174073"><a href="/crypto/x509/x509_test.go.html#8173995">certs</a></span><span class="op" id="8174078">)</span>&nbsp;<span class="op" id="8174080">!=</span>&nbsp;<span class="num" id="8174083">2</span>&nbsp;<span class="op" id="8174085">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174089"><a href="/crypto/x509/x509_test.go.html#8173941">t</a></span><span class="op" id="8174090">.</span><span class="ident" id="8174091">Errorf</span><span class="op" id="8174097">(</span><span class="string" id="8174098">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="8174136">,</span>&nbsp;<span class="builtinfunc" id="8174138">len</span><span class="op" id="8174141">(</span><span class="ident" id="8174142"><a href="/crypto/x509/x509_test.go.html#8173995">certs</a></span><span class="op" id="8174147">)</span><span class="op" id="8174148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174152">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174164"><a href="/crypto/x509/x509_test.go.html#8174002">err</a></span>&nbsp;<span class="op" id="8174168">=</span>&nbsp;<span class="ident" id="8174170"><a href="/crypto/x509/x509_test.go.html#8173995">certs</a></span><span class="op" id="8174175">[</span><span class="num" id="8174176">0</span><span class="op" id="8174177">]</span><span class="op" id="8174178">.</span><span class="ident" id="8174179">CheckSignatureFrom</span><span class="op" id="8174197">(</span><span class="ident" id="8174198"><a href="/crypto/x509/x509_test.go.html#8173995">certs</a></span><span class="op" id="8174203">[</span><span class="num" id="8174204">1</span><span class="op" id="8174205">]</span><span class="op" id="8174206">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174209">if</span>&nbsp;<span class="ident" id="8174212"><a href="/crypto/x509/x509_test.go.html#8174002">err</a></span>&nbsp;<span class="op" id="8174216">!=</span>&nbsp;<span class="ident" id="8174219">nil</span>&nbsp;<span class="op" id="8174223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174227"><a href="/crypto/x509/x509_test.go.html#8173941">t</a></span><span class="op" id="8174228">.</span><span class="ident" id="8174229">Error</span><span class="op" id="8174234">(</span><span class="ident" id="8174235"><a href="/crypto/x509/x509_test.go.html#8174002">err</a></span><span class="op" id="8174238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174245">if</span>&nbsp;<span class="ident" id="8174248">err</span>&nbsp;<span class="op" id="8174252">:=</span>&nbsp;<span class="ident" id="8174255"><a href="/crypto/x509/x509_test.go.html#8173995">certs</a></span><span class="op" id="8174260">[</span><span class="num" id="8174261">0</span><span class="op" id="8174262">]</span><span class="op" id="8174263">.</span><span class="ident" id="8174264">VerifyHostname</span><span class="op" id="8174278">(</span><span class="string" id="8174279">&#34;mail.google.com&#34;</span><span class="op" id="8174296">)</span><span class="op" id="8174297">;</span>&nbsp;<span class="ident" id="8174299"><a href="/crypto/x509/x509_test.go.html#8174248">err</a></span>&nbsp;<span class="op" id="8174303">!=</span>&nbsp;<span class="ident" id="8174306">nil</span>&nbsp;<span class="op" id="8174310">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174314"><a href="/crypto/x509/x509_test.go.html#8173941">t</a></span><span class="op" id="8174315">.</span><span class="ident" id="8174316">Error</span><span class="op" id="8174321">(</span><span class="ident" id="8174322"><a href="/crypto/x509/x509_test.go.html#8174248">err</a></span><span class="op" id="8174325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174332">const</span>&nbsp;<span class="ident" id="8174338">expectedExtensions</span>&nbsp;<span class="op" id="8174357">=</span>&nbsp;<span class="num" id="8174359">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8174362">if</span>&nbsp;<span class="ident" id="8174365">n</span>&nbsp;<span class="op" id="8174367">:=</span>&nbsp;<span class="builtinfunc" id="8174370">len</span><span class="op" id="8174373">(</span><span class="ident" id="8174374"><a href="/crypto/x509/x509_test.go.html#8173995">certs</a></span><span class="op" id="8174379">[</span><span class="num" id="8174380">0</span><span class="op" id="8174381">]</span><span class="op" id="8174382">.</span><span class="ident" id="8174383">Extensions</span><span class="op" id="8174393">)</span><span class="op" id="8174394">;</span>&nbsp;<span class="ident" id="8174396"><a href="/crypto/x509/x509_test.go.html#8174365">n</a></span>&nbsp;<span class="op" id="8174398">!=</span>&nbsp;<span class="ident" id="8174401"><a href="/crypto/x509/x509_test.go.html#8174338">expectedExtensions</a></span>&nbsp;<span class="op" id="8174420">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8174424"><a href="/crypto/x509/x509_test.go.html#8173941">t</a></span><span class="op" id="8174425">.</span><span class="ident" id="8174426">Errorf</span><span class="op" id="8174432">(</span><span class="string" id="8174433">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8174461">,</span>&nbsp;<span class="ident" id="8174463"><a href="/crypto/x509/x509_test.go.html#8174338">expectedExtensions</a></span><span class="op" id="8174481">,</span>&nbsp;<span class="ident" id="8174483"><a href="/crypto/x509/x509_test.go.html#8174365">n</a></span><span class="op" id="8174484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8174487">}</span><br>
<span class="lineno"></span><span class="op" id="8174489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8174492">var</span>&nbsp;<span class="ident" id="8174496">certBytes</span>&nbsp;<span class="op" id="8174506">=</span>&nbsp;<span class="string" id="8174508">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="8174589">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174592">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="8174673">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174676">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="8174757">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174760">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="8174841">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174844">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="8174925">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8174928">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="8175009">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175012">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="8175093">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175096">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="8175177">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175180">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="8175261">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175264">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="8175345">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175348">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="8175429">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175432">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="8175513">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175516">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="8175597">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175600">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="8175681">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175684">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="8175765">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175768">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="8175849">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175852">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="8175933">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8175936">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="8176017">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176020">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="8176101">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176104">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="8176185">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176188">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="8176269">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176272">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="8176353">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176356">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="8176437">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176440">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="8176521">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176524">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="8176605">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176608">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="8176689">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176692">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="8176773">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176776">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="8176857">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176860">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="8176941">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8176944">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="8177025">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177028">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="8177109">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177112">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="8177193">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177196">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="8177277">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177280">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="8177361">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177364">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="8177445">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177448">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="8177529">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177532">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="8177613">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177616">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="8177697">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177700">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="8177781">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177784">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="8177865">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177868">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="8177949">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8177952">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8177984">func</span>&nbsp;<span class="ident" id="8177989">TestCreateSelfSignedCertificate</span><span class="op" id="8178020">(</span><span class="ident" id="8178021">t</span>&nbsp;<span class="op" id="8178023">*</span><span class="ident" id="8178024"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8178031">.</span><span class="ident" id="8178032">T</span><span class="op" id="8178033">)</span>&nbsp;<span class="op" id="8178035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178038">random</span>&nbsp;<span class="op" id="8178045">:=</span>&nbsp;<span class="ident" id="8178048"><a href="/crypto/x509/x509_test.go.html#8166177">rand</a></span><span class="op" id="8178052">.</span><span class="ident" id="8178053">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178062">block</span><span class="op" id="8178067">,</span>&nbsp;<span class="ident" id="8178069">_</span>&nbsp;<span class="op" id="8178071">:=</span>&nbsp;<span class="ident" id="8178074"><a href="/crypto/x509/x509_test.go.html#8166316">pem</a></span><span class="op" id="8178077">.</span><span class="ident" id="8178078">Decode</span><span class="op" id="8178084">(</span><span class="op" id="8178085">[</span><span class="op" id="8178086">]</span><span class="builtintype" id="8178087">byte</span><span class="op" id="8178091">(</span><span class="ident" id="8178092"><a href="/crypto/x509/x509_test.go.html#8168074">pemPrivateKey</a></span><span class="op" id="8178105">)</span><span class="op" id="8178106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178109">rsaPriv</span><span class="op" id="8178116">,</span>&nbsp;<span class="ident" id="8178118">err</span>&nbsp;<span class="op" id="8178122">:=</span>&nbsp;<span class="ident" id="8178125"><a href="/crypto/x509/pkcs1.go.html#4294252">ParsePKCS1PrivateKey</a></span><span class="op" id="8178145">(</span><span class="ident" id="8178146"><a href="/crypto/x509/x509_test.go.html#8178062">block</a></span><span class="op" id="8178151">.</span><span class="ident" id="8178152">Bytes</span><span class="op" id="8178157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178160">if</span>&nbsp;<span class="ident" id="8178163"><a href="/crypto/x509/x509_test.go.html#8178118">err</a></span>&nbsp;<span class="op" id="8178167">!=</span>&nbsp;<span class="ident" id="8178170">nil</span>&nbsp;<span class="op" id="8178174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178178"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8178179">.</span><span class="ident" id="8178180">Fatalf</span><span class="op" id="8178186">(</span><span class="string" id="8178187">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8178220">,</span>&nbsp;<span class="ident" id="8178222"><a href="/crypto/x509/x509_test.go.html#8178118">err</a></span><span class="op" id="8178225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178228">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178232">ecdsaPriv</span><span class="op" id="8178241">,</span>&nbsp;<span class="ident" id="8178243"><a href="/crypto/x509/x509_test.go.html#8178118">err</a></span>&nbsp;<span class="op" id="8178247">:=</span>&nbsp;<span class="ident" id="8178250"><a href="/crypto/x509/x509_test.go.html#8166142">ecdsa</a></span><span class="op" id="8178255">.</span><span class="ident" id="8178256">GenerateKey</span><span class="op" id="8178267">(</span><span class="ident" id="8178268"><a href="/crypto/x509/x509_test.go.html#8166158">elliptic</a></span><span class="op" id="8178276">.</span><span class="ident" id="8178277">P256</span><span class="op" id="8178281">(</span><span class="op" id="8178282">)</span><span class="op" id="8178283">,</span>&nbsp;<span class="ident" id="8178285"><a href="/crypto/x509/x509_test.go.html#8166177">rand</a></span><span class="op" id="8178289">.</span><span class="ident" id="8178290">Reader</span><span class="op" id="8178296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178299">if</span>&nbsp;<span class="ident" id="8178302"><a href="/crypto/x509/x509_test.go.html#8178118">err</a></span>&nbsp;<span class="op" id="8178306">!=</span>&nbsp;<span class="ident" id="8178309">nil</span>&nbsp;<span class="op" id="8178313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178317"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8178318">.</span><span class="ident" id="8178319">Fatalf</span><span class="op" id="8178325">(</span><span class="string" id="8178326">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8178360">,</span>&nbsp;<span class="ident" id="8178362"><a href="/crypto/x509/x509_test.go.html#8178118">err</a></span><span class="op" id="8178365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178368">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178372">tests</span>&nbsp;<span class="op" id="8178378">:=</span>&nbsp;<span class="op" id="8178381">[</span><span class="op" id="8178382">]</span><span class="keyword" id="8178383">struct</span>&nbsp;<span class="op" id="8178390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178394">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8178404">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178413">pub</span><span class="op" id="8178416">,</span>&nbsp;<span class="ident" id="8178418">priv</span>&nbsp;<span class="keyword" id="8178423">interface</span><span class="op" id="8178432">{</span><span class="op" id="8178433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178437">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="8178447">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178454">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8178464"><a href="/crypto/x509/x509.go.html#4320325">SignatureAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178484">}</span><span class="op" id="8178485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178489">{</span><span class="string" id="8178490">&#34;RSA/RSA&#34;</span><span class="op" id="8178499">,</span>&nbsp;<span class="op" id="8178501">&amp;</span><span class="ident" id="8178502"><a href="/crypto/x509/x509_test.go.html#8178109">rsaPriv</a></span><span class="op" id="8178509">.</span><span class="ident" id="8178510">PublicKey</span><span class="op" id="8178519">,</span>&nbsp;<span class="ident" id="8178521"><a href="/crypto/x509/x509_test.go.html#8178109">rsaPriv</a></span><span class="op" id="8178528">,</span>&nbsp;<span class="ident" id="8178530">true</span><span class="op" id="8178534">,</span>&nbsp;<span class="ident" id="8178536"><a href="/crypto/x509/x509.go.html#4320435">SHA1WithRSA</a></span><span class="op" id="8178547">}</span><span class="op" id="8178548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178552">{</span><span class="string" id="8178553">&#34;RSA/ECDSA&#34;</span><span class="op" id="8178564">,</span>&nbsp;<span class="op" id="8178566">&amp;</span><span class="ident" id="8178567"><a href="/crypto/x509/x509_test.go.html#8178109">rsaPriv</a></span><span class="op" id="8178574">.</span><span class="ident" id="8178575">PublicKey</span><span class="op" id="8178584">,</span>&nbsp;<span class="ident" id="8178586"><a href="/crypto/x509/x509_test.go.html#8178232">ecdsaPriv</a></span><span class="op" id="8178595">,</span>&nbsp;<span class="ident" id="8178597">false</span><span class="op" id="8178602">,</span>&nbsp;<span class="ident" id="8178604"><a href="/crypto/x509/x509.go.html#4320553">ECDSAWithSHA384</a></span><span class="op" id="8178619">}</span><span class="op" id="8178620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178624">{</span><span class="string" id="8178625">&#34;ECDSA/RSA&#34;</span><span class="op" id="8178636">,</span>&nbsp;<span class="op" id="8178638">&amp;</span><span class="ident" id="8178639"><a href="/crypto/x509/x509_test.go.html#8178232">ecdsaPriv</a></span><span class="op" id="8178648">.</span><span class="ident" id="8178649">PublicKey</span><span class="op" id="8178658">,</span>&nbsp;<span class="ident" id="8178660"><a href="/crypto/x509/x509_test.go.html#8178109">rsaPriv</a></span><span class="op" id="8178667">,</span>&nbsp;<span class="ident" id="8178669">false</span><span class="op" id="8178674">,</span>&nbsp;<span class="ident" id="8178676"><a href="/crypto/x509/x509.go.html#4320448">SHA256WithRSA</a></span><span class="op" id="8178689">}</span><span class="op" id="8178690">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178694">{</span><span class="string" id="8178695">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="8178708">,</span>&nbsp;<span class="op" id="8178710">&amp;</span><span class="ident" id="8178711"><a href="/crypto/x509/x509_test.go.html#8178232">ecdsaPriv</a></span><span class="op" id="8178720">.</span><span class="ident" id="8178721">PublicKey</span><span class="op" id="8178730">,</span>&nbsp;<span class="ident" id="8178732"><a href="/crypto/x509/x509_test.go.html#8178232">ecdsaPriv</a></span><span class="op" id="8178741">,</span>&nbsp;<span class="ident" id="8178743">true</span><span class="op" id="8178747">,</span>&nbsp;<span class="ident" id="8178749"><a href="/crypto/x509/x509.go.html#4320521">ECDSAWithSHA1</a></span><span class="op" id="8178762">}</span><span class="op" id="8178763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8178766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178770">testExtKeyUsage</span>&nbsp;<span class="op" id="8178786">:=</span>&nbsp;<span class="op" id="8178789">[</span><span class="op" id="8178790">]</span><span class="ident" id="8178791"><a href="/crypto/x509/x509.go.html#4329095">ExtKeyUsage</a></span><span class="op" id="8178802">{</span><span class="ident" id="8178803"><a href="/crypto/x509/x509.go.html#4329179">ExtKeyUsageClientAuth</a></span><span class="op" id="8178824">,</span>&nbsp;<span class="ident" id="8178826"><a href="/crypto/x509/x509.go.html#4329156">ExtKeyUsageServerAuth</a></span><span class="op" id="8178847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178850">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="8178873">:=</span>&nbsp;<span class="op" id="8178876">[</span><span class="op" id="8178877">]</span><span class="ident" id="8178878"><a href="/crypto/x509/x509_test.go.html#8166264">asn1</a></span><span class="op" id="8178882">.</span><span class="ident" id="8178883">ObjectIdentifier</span><span class="op" id="8178899">{</span><span class="op" id="8178900">[</span><span class="op" id="8178901">]</span><span class="builtintype" id="8178902">int</span><span class="op" id="8178905">{</span><span class="num" id="8178906">1</span><span class="op" id="8178907">,</span>&nbsp;<span class="num" id="8178909">2</span><span class="op" id="8178910">,</span>&nbsp;<span class="num" id="8178912">3</span><span class="op" id="8178913">}</span><span class="op" id="8178914">,</span>&nbsp;<span class="op" id="8178916">[</span><span class="op" id="8178917">]</span><span class="builtintype" id="8178918">int</span><span class="op" id="8178921">{</span><span class="num" id="8178922">2</span><span class="op" id="8178923">,</span>&nbsp;<span class="num" id="8178925">59</span><span class="op" id="8178927">,</span>&nbsp;<span class="num" id="8178929">1</span><span class="op" id="8178930">}</span><span class="op" id="8178931">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8178934">extraExtensionData</span>&nbsp;<span class="op" id="8178953">:=</span>&nbsp;<span class="op" id="8178956">[</span><span class="op" id="8178957">]</span><span class="builtintype" id="8178958">byte</span><span class="op" id="8178962">(</span><span class="string" id="8178963">&#34;extra&nbsp;extension&#34;</span><span class="op" id="8178980">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8178984">for</span>&nbsp;<span class="ident" id="8178988">_</span><span class="op" id="8178989">,</span>&nbsp;<span class="ident" id="8178991">test</span>&nbsp;<span class="op" id="8178996">:=</span>&nbsp;<span class="keyword" id="8178999">range</span>&nbsp;<span class="ident" id="8179005"><a href="/crypto/x509/x509_test.go.html#8178372">tests</a></span>&nbsp;<span class="op" id="8179011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179015">commonName</span>&nbsp;<span class="op" id="8179026">:=</span>&nbsp;<span class="string" id="8179029">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179050">template</span>&nbsp;<span class="op" id="8179059">:=</span>&nbsp;<span class="ident" id="8179062"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="8179073">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179078">SerialNumber</span><span class="op" id="8179090">:</span>&nbsp;<span class="ident" id="8179092"><a href="/crypto/x509/x509_test.go.html#8166332">big</a></span><span class="op" id="8179095">.</span><span class="ident" id="8179096">NewInt</span><span class="op" id="8179102">(</span><span class="num" id="8179103">1</span><span class="op" id="8179104">)</span><span class="op" id="8179105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179110">Subject</span><span class="op" id="8179117">:</span>&nbsp;<span class="ident" id="8179119"><a href="/crypto/x509/x509_test.go.html#8166244">pkix</a></span><span class="op" id="8179123">.</span><span class="ident" id="8179124">Name</span><span class="op" id="8179128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179134">CommonName</span><span class="op" id="8179144">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8179148"><a href="/crypto/x509/x509_test.go.html#8179015">commonName</a></span><span class="op" id="8179158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179164">Organization</span><span class="op" id="8179176">:</span>&nbsp;<span class="op" id="8179178">[</span><span class="op" id="8179179">]</span><span class="builtintype" id="8179180">string</span><span class="op" id="8179186">{</span><span class="string" id="8179187">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8179199">}</span><span class="op" id="8179200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8179205">}</span><span class="op" id="8179206">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179211">NotBefore</span><span class="op" id="8179220">:</span>&nbsp;<span class="ident" id="8179222"><a href="/crypto/x509/x509_test.go.html#8166395">time</a></span><span class="op" id="8179226">.</span><span class="ident" id="8179227">Unix</span><span class="op" id="8179231">(</span><span class="num" id="8179232">1000</span><span class="op" id="8179236">,</span>&nbsp;<span class="num" id="8179238">0</span><span class="op" id="8179239">)</span><span class="op" id="8179240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179245">NotAfter</span><span class="op" id="8179253">:</span>&nbsp;&nbsp;<span class="ident" id="8179256"><a href="/crypto/x509/x509_test.go.html#8166395">time</a></span><span class="op" id="8179260">.</span><span class="ident" id="8179261">Unix</span><span class="op" id="8179265">(</span><span class="num" id="8179266">100000</span><span class="op" id="8179272">,</span>&nbsp;<span class="num" id="8179274">0</span><span class="op" id="8179275">)</span><span class="op" id="8179276">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179282">SignatureAlgorithm</span><span class="op" id="8179300">:</span>&nbsp;<span class="ident" id="8179302"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8179306">.</span><span class="ident" id="8179307">sigAlgo</span><span class="op" id="8179314">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179320">SubjectKeyId</span><span class="op" id="8179332">:</span>&nbsp;<span class="op" id="8179334">[</span><span class="op" id="8179335">]</span><span class="builtintype" id="8179336">byte</span><span class="op" id="8179340">{</span><span class="num" id="8179341">1</span><span class="op" id="8179342">,</span>&nbsp;<span class="num" id="8179344">2</span><span class="op" id="8179345">,</span>&nbsp;<span class="num" id="8179347">3</span><span class="op" id="8179348">,</span>&nbsp;<span class="num" id="8179350">4</span><span class="op" id="8179351">}</span><span class="op" id="8179352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179357">KeyUsage</span><span class="op" id="8179365">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179371"><a href="/crypto/x509/x509.go.html#4327178">KeyUsageCertSign</a></span><span class="op" id="8179387">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179393">ExtKeyUsage</span><span class="op" id="8179404">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8179413"><a href="/crypto/x509/x509_test.go.html#8178770">testExtKeyUsage</a></span><span class="op" id="8179428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179433">UnknownExtKeyUsage</span><span class="op" id="8179451">:</span>&nbsp;<span class="ident" id="8179453"><a href="/crypto/x509/x509_test.go.html#8178850">testUnknownExtKeyUsage</a></span><span class="op" id="8179475">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179481">BasicConstraintsValid</span><span class="op" id="8179502">:</span>&nbsp;<span class="ident" id="8179504">true</span><span class="op" id="8179508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179513">IsCA</span><span class="op" id="8179517">:</span>&nbsp;<span class="ident" id="8179519">true</span><span class="op" id="8179523">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179529">OCSPServer</span><span class="op" id="8179539">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8179552">[</span><span class="op" id="8179553">]</span><span class="builtintype" id="8179554">string</span><span class="op" id="8179560">{</span><span class="string" id="8179561">&#34;http://ocsp.example.com&#34;</span><span class="op" id="8179586">}</span><span class="op" id="8179587">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179592">IssuingCertificateURL</span><span class="op" id="8179613">:</span>&nbsp;<span class="op" id="8179615">[</span><span class="op" id="8179616">]</span><span class="builtintype" id="8179617">string</span><span class="op" id="8179623">{</span><span class="string" id="8179624">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="8179656">}</span><span class="op" id="8179657">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179663">DNSNames</span><span class="op" id="8179671">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8179679">[</span><span class="op" id="8179680">]</span><span class="builtintype" id="8179681">string</span><span class="op" id="8179687">{</span><span class="string" id="8179688">&#34;test.example.com&#34;</span><span class="op" id="8179706">}</span><span class="op" id="8179707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179712">EmailAddresses</span><span class="op" id="8179726">:</span>&nbsp;<span class="op" id="8179728">[</span><span class="op" id="8179729">]</span><span class="builtintype" id="8179730">string</span><span class="op" id="8179736">{</span><span class="string" id="8179737">&#34;gopher@golang.org&#34;</span><span class="op" id="8179756">}</span><span class="op" id="8179757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179762">IPAddresses</span><span class="op" id="8179773">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8179778">[</span><span class="op" id="8179779">]</span><span class="ident" id="8179780"><a href="/crypto/x509/x509_test.go.html#8166344">net</a></span><span class="op" id="8179783">.</span><span class="ident" id="8179784">IP</span><span class="op" id="8179786">{</span><span class="ident" id="8179787"><a href="/crypto/x509/x509_test.go.html#8166344">net</a></span><span class="op" id="8179790">.</span><span class="ident" id="8179791">IPv4</span><span class="op" id="8179795">(</span><span class="num" id="8179796">127</span><span class="op" id="8179799">,</span>&nbsp;<span class="num" id="8179801">0</span><span class="op" id="8179802">,</span>&nbsp;<span class="num" id="8179804">0</span><span class="op" id="8179805">,</span>&nbsp;<span class="num" id="8179807">1</span><span class="op" id="8179808">)</span><span class="op" id="8179809">.</span><span class="ident" id="8179810">To4</span><span class="op" id="8179813">(</span><span class="op" id="8179814">)</span><span class="op" id="8179815">,</span>&nbsp;<span class="ident" id="8179817"><a href="/crypto/x509/x509_test.go.html#8166344">net</a></span><span class="op" id="8179820">.</span><span class="ident" id="8179821">ParseIP</span><span class="op" id="8179828">(</span><span class="string" id="8179829">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="8179851">)</span><span class="op" id="8179852">}</span><span class="op" id="8179853">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179859">PolicyIdentifiers</span><span class="op" id="8179876">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8179880">[</span><span class="op" id="8179881">]</span><span class="ident" id="8179882"><a href="/crypto/x509/x509_test.go.html#8166264">asn1</a></span><span class="op" id="8179886">.</span><span class="ident" id="8179887">ObjectIdentifier</span><span class="op" id="8179903">{</span><span class="op" id="8179904">[</span><span class="op" id="8179905">]</span><span class="builtintype" id="8179906">int</span><span class="op" id="8179909">{</span><span class="num" id="8179910">1</span><span class="op" id="8179911">,</span>&nbsp;<span class="num" id="8179913">2</span><span class="op" id="8179914">,</span>&nbsp;<span class="num" id="8179916">3</span><span class="op" id="8179917">}</span><span class="op" id="8179918">}</span><span class="op" id="8179919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179924">PermittedDNSDomains</span><span class="op" id="8179943">:</span>&nbsp;<span class="op" id="8179945">[</span><span class="op" id="8179946">]</span><span class="builtintype" id="8179947">string</span><span class="op" id="8179953">{</span><span class="string" id="8179954">&#34;.example.com&#34;</span><span class="op" id="8179968">,</span>&nbsp;<span class="string" id="8179970">&#34;example.com&#34;</span><span class="op" id="8179983">}</span><span class="op" id="8179984">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8179990">CRLDistributionPoints</span><span class="op" id="8180011">:</span>&nbsp;<span class="op" id="8180013">[</span><span class="op" id="8180014">]</span><span class="builtintype" id="8180015">string</span><span class="op" id="8180021">{</span><span class="string" id="8180022">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="8180055">,</span>&nbsp;<span class="string" id="8180057">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="8180090">}</span><span class="op" id="8180091">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180097">ExtraExtensions</span><span class="op" id="8180112">:</span>&nbsp;<span class="op" id="8180114">[</span><span class="op" id="8180115">]</span><span class="ident" id="8180116"><a href="/crypto/x509/x509_test.go.html#8166244">pkix</a></span><span class="op" id="8180120">.</span><span class="ident" id="8180121">Extension</span><span class="op" id="8180130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180143">Id</span><span class="op" id="8180145">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8180150">[</span><span class="op" id="8180151">]</span><span class="builtintype" id="8180152">int</span><span class="op" id="8180155">{</span><span class="num" id="8180156">1</span><span class="op" id="8180157">,</span>&nbsp;<span class="num" id="8180159">2</span><span class="op" id="8180160">,</span>&nbsp;<span class="num" id="8180162">3</span><span class="op" id="8180163">,</span>&nbsp;<span class="num" id="8180165">4</span><span class="op" id="8180166">}</span><span class="op" id="8180167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180174">Value</span><span class="op" id="8180179">:</span>&nbsp;<span class="ident" id="8180181"><a href="/crypto/x509/x509_test.go.html#8178934">extraExtensionData</a></span><span class="op" id="8180199">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180205">}</span><span class="op" id="8180206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8180212">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180282">Id</span><span class="op" id="8180284">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8180292"><a href="/crypto/x509/x509.go.html#4351544">oidExtensionSubjectKeyId</a></span><span class="op" id="8180316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180323">Critical</span><span class="op" id="8180331">:</span>&nbsp;<span class="ident" id="8180333">false</span><span class="op" id="8180338">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180345">Value</span><span class="op" id="8180350">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8180355">[</span><span class="op" id="8180356">]</span><span class="builtintype" id="8180357">byte</span><span class="op" id="8180361">{</span><span class="num" id="8180362">0x04</span><span class="op" id="8180366">,</span>&nbsp;<span class="num" id="8180368">0x04</span><span class="op" id="8180372">,</span>&nbsp;<span class="num" id="8180374">4</span><span class="op" id="8180375">,</span>&nbsp;<span class="num" id="8180377">3</span><span class="op" id="8180378">,</span>&nbsp;<span class="num" id="8180380">2</span><span class="op" id="8180381">,</span>&nbsp;<span class="num" id="8180383">1</span><span class="op" id="8180384">}</span><span class="op" id="8180385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180391">}</span><span class="op" id="8180392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180397">}</span><span class="op" id="8180398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180407">derBytes</span><span class="op" id="8180415">,</span>&nbsp;<span class="ident" id="8180417">err</span>&nbsp;<span class="op" id="8180421">:=</span>&nbsp;<span class="ident" id="8180424"><a href="/crypto/x509/x509.go.html#4361151">CreateCertificate</a></span><span class="op" id="8180441">(</span><span class="ident" id="8180442"><a href="/crypto/x509/x509_test.go.html#8178038">random</a></span><span class="op" id="8180448">,</span>&nbsp;<span class="op" id="8180450">&amp;</span><span class="ident" id="8180451"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8180459">,</span>&nbsp;<span class="op" id="8180461">&amp;</span><span class="ident" id="8180462"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8180470">,</span>&nbsp;<span class="ident" id="8180472"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8180476">.</span><span class="ident" id="8180477">pub</span><span class="op" id="8180480">,</span>&nbsp;<span class="ident" id="8180482"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8180486">.</span><span class="ident" id="8180487">priv</span><span class="op" id="8180491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8180495">if</span>&nbsp;<span class="ident" id="8180498"><a href="/crypto/x509/x509_test.go.html#8180417">err</a></span>&nbsp;<span class="op" id="8180502">!=</span>&nbsp;<span class="ident" id="8180505">nil</span>&nbsp;<span class="op" id="8180509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180514"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8180515">.</span><span class="ident" id="8180516">Errorf</span><span class="op" id="8180522">(</span><span class="string" id="8180523">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8180561">,</span>&nbsp;<span class="ident" id="8180563"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8180567">.</span><span class="ident" id="8180568">name</span><span class="op" id="8180572">,</span>&nbsp;<span class="ident" id="8180574"><a href="/crypto/x509/x509_test.go.html#8180417">err</a></span><span class="op" id="8180577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8180582">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180593">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180598">cert</span><span class="op" id="8180602">,</span>&nbsp;<span class="ident" id="8180604"><a href="/crypto/x509/x509_test.go.html#8180417">err</a></span>&nbsp;<span class="op" id="8180608">:=</span>&nbsp;<span class="ident" id="8180611"><a href="/crypto/x509/x509.go.html#4350518">ParseCertificate</a></span><span class="op" id="8180627">(</span><span class="ident" id="8180628"><a href="/crypto/x509/x509_test.go.html#8180407">derBytes</a></span><span class="op" id="8180636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8180640">if</span>&nbsp;<span class="ident" id="8180643"><a href="/crypto/x509/x509_test.go.html#8180417">err</a></span>&nbsp;<span class="op" id="8180647">!=</span>&nbsp;<span class="ident" id="8180650">nil</span>&nbsp;<span class="op" id="8180654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180659"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8180660">.</span><span class="ident" id="8180661">Errorf</span><span class="op" id="8180667">(</span><span class="string" id="8180668">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8180705">,</span>&nbsp;<span class="ident" id="8180707"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8180711">.</span><span class="ident" id="8180712">name</span><span class="op" id="8180716">,</span>&nbsp;<span class="ident" id="8180718"><a href="/crypto/x509/x509_test.go.html#8180417">err</a></span><span class="op" id="8180721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8180726">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8180742">if</span>&nbsp;<span class="builtinfunc" id="8180745">len</span><span class="op" id="8180748">(</span><span class="ident" id="8180749"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8180753">.</span><span class="ident" id="8180754">PolicyIdentifiers</span><span class="op" id="8180771">)</span>&nbsp;<span class="op" id="8180773">!=</span>&nbsp;<span class="num" id="8180776">1</span>&nbsp;<span class="op" id="8180778">||</span>&nbsp;<span class="op" id="8180781">!</span><span class="ident" id="8180782"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8180786">.</span><span class="ident" id="8180787">PolicyIdentifiers</span><span class="op" id="8180804">[</span><span class="num" id="8180805">0</span><span class="op" id="8180806">]</span><span class="op" id="8180807">.</span><span class="ident" id="8180808">Equal</span><span class="op" id="8180813">(</span><span class="ident" id="8180814"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8180822">.</span><span class="ident" id="8180823">PolicyIdentifiers</span><span class="op" id="8180840">[</span><span class="num" id="8180841">0</span><span class="op" id="8180842">]</span><span class="op" id="8180843">)</span>&nbsp;<span class="op" id="8180845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8180850"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8180851">.</span><span class="ident" id="8180852">Errorf</span><span class="op" id="8180858">(</span><span class="string" id="8180859">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="8180917">,</span>&nbsp;<span class="ident" id="8180919"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8180923">.</span><span class="ident" id="8180924">name</span><span class="op" id="8180928">,</span>&nbsp;<span class="ident" id="8180930"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8180934">.</span><span class="ident" id="8180935">PolicyIdentifiers</span><span class="op" id="8180952">,</span>&nbsp;<span class="ident" id="8180954"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8180962">.</span><span class="ident" id="8180963">PolicyIdentifiers</span><span class="op" id="8180980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8180984">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8180989">if</span>&nbsp;<span class="builtinfunc" id="8180992">len</span><span class="op" id="8180995">(</span><span class="ident" id="8180996"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8181000">.</span><span class="ident" id="8181001">PermittedDNSDomains</span><span class="op" id="8181020">)</span>&nbsp;<span class="op" id="8181022">!=</span>&nbsp;<span class="num" id="8181025">2</span>&nbsp;<span class="op" id="8181027">||</span>&nbsp;<span class="ident" id="8181030"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8181034">.</span><span class="ident" id="8181035">PermittedDNSDomains</span><span class="op" id="8181054">[</span><span class="num" id="8181055">0</span><span class="op" id="8181056">]</span>&nbsp;<span class="op" id="8181058">!=</span>&nbsp;<span class="string" id="8181061">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="8181076">||</span>&nbsp;<span class="ident" id="8181079"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8181083">.</span><span class="ident" id="8181084">PermittedDNSDomains</span><span class="op" id="8181103">[</span><span class="num" id="8181104">1</span><span class="op" id="8181105">]</span>&nbsp;<span class="op" id="8181107">!=</span>&nbsp;<span class="string" id="8181110">&#34;example.com&#34;</span>&nbsp;<span class="op" id="8181124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181129"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8181130">.</span><span class="ident" id="8181131">Errorf</span><span class="op" id="8181137">(</span><span class="string" id="8181138">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="8181181">,</span>&nbsp;<span class="ident" id="8181183"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8181187">.</span><span class="ident" id="8181188">name</span><span class="op" id="8181192">,</span>&nbsp;<span class="ident" id="8181194"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8181198">.</span><span class="ident" id="8181199">PermittedDNSDomains</span><span class="op" id="8181218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8181227">if</span>&nbsp;<span class="ident" id="8181230"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8181234">.</span><span class="ident" id="8181235">Subject</span><span class="op" id="8181242">.</span><span class="ident" id="8181243">CommonName</span>&nbsp;<span class="op" id="8181254">!=</span>&nbsp;<span class="ident" id="8181257"><a href="/crypto/x509/x509_test.go.html#8179015">commonName</a></span>&nbsp;<span class="op" id="8181268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181273"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8181274">.</span><span class="ident" id="8181275">Errorf</span><span class="op" id="8181281">(</span><span class="string" id="8181282">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8181354">,</span>&nbsp;<span class="ident" id="8181356"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8181360">.</span><span class="ident" id="8181361">name</span><span class="op" id="8181365">,</span>&nbsp;<span class="ident" id="8181367"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8181371">.</span><span class="ident" id="8181372">Subject</span><span class="op" id="8181379">.</span><span class="ident" id="8181380">CommonName</span><span class="op" id="8181390">,</span>&nbsp;<span class="ident" id="8181392"><a href="/crypto/x509/x509_test.go.html#8179015">commonName</a></span><span class="op" id="8181402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8181411">if</span>&nbsp;<span class="ident" id="8181414"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8181418">.</span><span class="ident" id="8181419">Issuer</span><span class="op" id="8181425">.</span><span class="ident" id="8181426">CommonName</span>&nbsp;<span class="op" id="8181437">!=</span>&nbsp;<span class="ident" id="8181440"><a href="/crypto/x509/x509_test.go.html#8179015">commonName</a></span>&nbsp;<span class="op" id="8181451">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181456"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8181457">.</span><span class="ident" id="8181458">Errorf</span><span class="op" id="8181464">(</span><span class="string" id="8181465">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8181536">,</span>&nbsp;<span class="ident" id="8181538"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8181542">.</span><span class="ident" id="8181543">name</span><span class="op" id="8181547">,</span>&nbsp;<span class="ident" id="8181549"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8181553">.</span><span class="ident" id="8181554">Issuer</span><span class="op" id="8181560">.</span><span class="ident" id="8181561">CommonName</span><span class="op" id="8181571">,</span>&nbsp;<span class="ident" id="8181573"><a href="/crypto/x509/x509_test.go.html#8179015">commonName</a></span><span class="op" id="8181583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8181592">if</span>&nbsp;<span class="ident" id="8181595"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8181599">.</span><span class="ident" id="8181600">SignatureAlgorithm</span>&nbsp;<span class="op" id="8181619">!=</span>&nbsp;<span class="ident" id="8181622"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8181626">.</span><span class="ident" id="8181627">sigAlgo</span>&nbsp;<span class="op" id="8181635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181640"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8181641">.</span><span class="ident" id="8181642">Errorf</span><span class="op" id="8181648">(</span><span class="string" id="8181649">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8181718">,</span>&nbsp;<span class="ident" id="8181720"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8181724">.</span><span class="ident" id="8181725">name</span><span class="op" id="8181729">,</span>&nbsp;<span class="ident" id="8181731"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8181735">.</span><span class="ident" id="8181736">SignatureAlgorithm</span><span class="op" id="8181754">,</span>&nbsp;<span class="ident" id="8181756"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8181760">.</span><span class="ident" id="8181761">sigAlgo</span><span class="op" id="8181768">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8181777">if</span>&nbsp;<span class="op" id="8181780">!</span><span class="ident" id="8181781"><a href="/crypto/x509/x509_test.go.html#8166362">reflect</a></span><span class="op" id="8181788">.</span><span class="ident" id="8181789">DeepEqual</span><span class="op" id="8181798">(</span><span class="ident" id="8181799"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8181803">.</span><span class="ident" id="8181804">ExtKeyUsage</span><span class="op" id="8181815">,</span>&nbsp;<span class="ident" id="8181817"><a href="/crypto/x509/x509_test.go.html#8178770">testExtKeyUsage</a></span><span class="op" id="8181832">)</span>&nbsp;<span class="op" id="8181834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8181839"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8181840">.</span><span class="ident" id="8181841">Errorf</span><span class="op" id="8181847">(</span><span class="string" id="8181848">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8181924">,</span>&nbsp;<span class="ident" id="8181926"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8181930">.</span><span class="ident" id="8181931">name</span><span class="op" id="8181935">,</span>&nbsp;<span class="ident" id="8181937"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8181941">.</span><span class="ident" id="8181942">ExtKeyUsage</span><span class="op" id="8181953">,</span>&nbsp;<span class="ident" id="8181955"><a href="/crypto/x509/x509_test.go.html#8178770">testExtKeyUsage</a></span><span class="op" id="8181970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8181974">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8181979">if</span>&nbsp;<span class="op" id="8181982">!</span><span class="ident" id="8181983"><a href="/crypto/x509/x509_test.go.html#8166362">reflect</a></span><span class="op" id="8181990">.</span><span class="ident" id="8181991">DeepEqual</span><span class="op" id="8182000">(</span><span class="ident" id="8182001"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8182005">.</span><span class="ident" id="8182006">UnknownExtKeyUsage</span><span class="op" id="8182024">,</span>&nbsp;<span class="ident" id="8182026"><a href="/crypto/x509/x509_test.go.html#8178850">testUnknownExtKeyUsage</a></span><span class="op" id="8182048">)</span>&nbsp;<span class="op" id="8182050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8182055"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8182056">.</span><span class="ident" id="8182057">Errorf</span><span class="op" id="8182063">(</span><span class="string" id="8182064">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8182148">,</span>&nbsp;<span class="ident" id="8182150"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8182154">.</span><span class="ident" id="8182155">name</span><span class="op" id="8182159">,</span>&nbsp;<span class="ident" id="8182161"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8182165">.</span><span class="ident" id="8182166">UnknownExtKeyUsage</span><span class="op" id="8182184">,</span>&nbsp;<span class="ident" id="8182186"><a href="/crypto/x509/x509_test.go.html#8178850">testUnknownExtKeyUsage</a></span><span class="op" id="8182208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8182217">if</span>&nbsp;<span class="op" id="8182220">!</span><span class="ident" id="8182221"><a href="/crypto/x509/x509_test.go.html#8166362">reflect</a></span><span class="op" id="8182228">.</span><span class="ident" id="8182229">DeepEqual</span><span class="op" id="8182238">(</span><span class="ident" id="8182239"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8182243">.</span><span class="ident" id="8182244">OCSPServer</span><span class="op" id="8182254">,</span>&nbsp;<span class="ident" id="8182256"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8182264">.</span><span class="ident" id="8182265">OCSPServer</span><span class="op" id="8182275">)</span>&nbsp;<span class="op" id="8182277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8182282"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8182283">.</span><span class="ident" id="8182284">Errorf</span><span class="op" id="8182290">(</span><span class="string" id="8182291">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8182347">,</span>&nbsp;<span class="ident" id="8182349"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8182353">.</span><span class="ident" id="8182354">name</span><span class="op" id="8182358">,</span>&nbsp;<span class="ident" id="8182360"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8182364">.</span><span class="ident" id="8182365">OCSPServer</span><span class="op" id="8182375">,</span>&nbsp;<span class="ident" id="8182377"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8182385">.</span><span class="ident" id="8182386">OCSPServer</span><span class="op" id="8182396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8182405">if</span>&nbsp;<span class="op" id="8182408">!</span><span class="ident" id="8182409"><a href="/crypto/x509/x509_test.go.html#8166362">reflect</a></span><span class="op" id="8182416">.</span><span class="ident" id="8182417">DeepEqual</span><span class="op" id="8182426">(</span><span class="ident" id="8182427"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8182431">.</span><span class="ident" id="8182432">IssuingCertificateURL</span><span class="op" id="8182453">,</span>&nbsp;<span class="ident" id="8182455"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8182463">.</span><span class="ident" id="8182464">IssuingCertificateURL</span><span class="op" id="8182485">)</span>&nbsp;<span class="op" id="8182487">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8182492"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8182493">.</span><span class="ident" id="8182494">Errorf</span><span class="op" id="8182500">(</span><span class="string" id="8182501">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8182569">,</span>&nbsp;<span class="ident" id="8182571"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8182575">.</span><span class="ident" id="8182576">name</span><span class="op" id="8182580">,</span>&nbsp;<span class="ident" id="8182582"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8182586">.</span><span class="ident" id="8182587">IssuingCertificateURL</span><span class="op" id="8182608">,</span>&nbsp;<span class="ident" id="8182610"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8182618">.</span><span class="ident" id="8182619">IssuingCertificateURL</span><span class="op" id="8182640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8182649">if</span>&nbsp;<span class="op" id="8182652">!</span><span class="ident" id="8182653"><a href="/crypto/x509/x509_test.go.html#8166362">reflect</a></span><span class="op" id="8182660">.</span><span class="ident" id="8182661">DeepEqual</span><span class="op" id="8182670">(</span><span class="ident" id="8182671"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8182675">.</span><span class="ident" id="8182676">DNSNames</span><span class="op" id="8182684">,</span>&nbsp;<span class="ident" id="8182686"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8182694">.</span><span class="ident" id="8182695">DNSNames</span><span class="op" id="8182703">)</span>&nbsp;<span class="op" id="8182705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8182710"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8182711">.</span><span class="ident" id="8182712">Errorf</span><span class="op" id="8182718">(</span><span class="string" id="8182719">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8182776">,</span>&nbsp;<span class="ident" id="8182778"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8182782">.</span><span class="ident" id="8182783">name</span><span class="op" id="8182787">,</span>&nbsp;<span class="ident" id="8182789"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8182793">.</span><span class="ident" id="8182794">DNSNames</span><span class="op" id="8182802">,</span>&nbsp;<span class="ident" id="8182804"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8182812">.</span><span class="ident" id="8182813">DNSNames</span><span class="op" id="8182821">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8182825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8182830">if</span>&nbsp;<span class="op" id="8182833">!</span><span class="ident" id="8182834"><a href="/crypto/x509/x509_test.go.html#8166362">reflect</a></span><span class="op" id="8182841">.</span><span class="ident" id="8182842">DeepEqual</span><span class="op" id="8182851">(</span><span class="ident" id="8182852"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8182856">.</span><span class="ident" id="8182857">EmailAddresses</span><span class="op" id="8182871">,</span>&nbsp;<span class="ident" id="8182873"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8182881">.</span><span class="ident" id="8182882">EmailAddresses</span><span class="op" id="8182896">)</span>&nbsp;<span class="op" id="8182898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8182903"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8182904">.</span><span class="ident" id="8182905">Errorf</span><span class="op" id="8182911">(</span><span class="string" id="8182912">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8182966">,</span>&nbsp;<span class="ident" id="8182968"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8182972">.</span><span class="ident" id="8182973">name</span><span class="op" id="8182977">,</span>&nbsp;<span class="ident" id="8182979"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8182983">.</span><span class="ident" id="8182984">EmailAddresses</span><span class="op" id="8182998">,</span>&nbsp;<span class="ident" id="8183000"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8183008">.</span><span class="ident" id="8183009">EmailAddresses</span><span class="op" id="8183023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183027">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183032">if</span>&nbsp;<span class="op" id="8183035">!</span><span class="ident" id="8183036"><a href="/crypto/x509/x509_test.go.html#8166362">reflect</a></span><span class="op" id="8183043">.</span><span class="ident" id="8183044">DeepEqual</span><span class="op" id="8183053">(</span><span class="ident" id="8183054"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8183058">.</span><span class="ident" id="8183059">IPAddresses</span><span class="op" id="8183070">,</span>&nbsp;<span class="ident" id="8183072"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8183080">.</span><span class="ident" id="8183081">IPAddresses</span><span class="op" id="8183092">)</span>&nbsp;<span class="op" id="8183094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183099"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8183100">.</span><span class="ident" id="8183101">Errorf</span><span class="op" id="8183107">(</span><span class="string" id="8183108">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8183159">,</span>&nbsp;<span class="ident" id="8183161"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8183165">.</span><span class="ident" id="8183166">name</span><span class="op" id="8183170">,</span>&nbsp;<span class="ident" id="8183172"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8183176">.</span><span class="ident" id="8183177">IPAddresses</span><span class="op" id="8183188">,</span>&nbsp;<span class="ident" id="8183190"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8183198">.</span><span class="ident" id="8183199">IPAddresses</span><span class="op" id="8183210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183219">if</span>&nbsp;<span class="op" id="8183222">!</span><span class="ident" id="8183223"><a href="/crypto/x509/x509_test.go.html#8166362">reflect</a></span><span class="op" id="8183230">.</span><span class="ident" id="8183231">DeepEqual</span><span class="op" id="8183240">(</span><span class="ident" id="8183241"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8183245">.</span><span class="ident" id="8183246">CRLDistributionPoints</span><span class="op" id="8183267">,</span>&nbsp;<span class="ident" id="8183269"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8183277">.</span><span class="ident" id="8183278">CRLDistributionPoints</span><span class="op" id="8183299">)</span>&nbsp;<span class="op" id="8183301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183306"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8183307">.</span><span class="ident" id="8183308">Errorf</span><span class="op" id="8183314">(</span><span class="string" id="8183315">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8183382">,</span>&nbsp;<span class="ident" id="8183384"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8183388">.</span><span class="ident" id="8183389">name</span><span class="op" id="8183393">,</span>&nbsp;<span class="ident" id="8183395"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8183399">.</span><span class="ident" id="8183400">CRLDistributionPoints</span><span class="op" id="8183421">,</span>&nbsp;<span class="ident" id="8183423"><a href="/crypto/x509/x509_test.go.html#8179050">template</a></span><span class="op" id="8183431">.</span><span class="ident" id="8183432">CRLDistributionPoints</span><span class="op" id="8183453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183462">if</span>&nbsp;<span class="op" id="8183465">!</span><span class="ident" id="8183466"><a href="/crypto/x509/x509_test.go.html#8166119">bytes</a></span><span class="op" id="8183471">.</span><span class="ident" id="8183472">Equal</span><span class="op" id="8183477">(</span><span class="ident" id="8183478"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8183482">.</span><span class="ident" id="8183483">SubjectKeyId</span><span class="op" id="8183495">,</span>&nbsp;<span class="op" id="8183497">[</span><span class="op" id="8183498">]</span><span class="builtintype" id="8183499">byte</span><span class="op" id="8183503">{</span><span class="num" id="8183504">4</span><span class="op" id="8183505">,</span>&nbsp;<span class="num" id="8183507">3</span><span class="op" id="8183508">,</span>&nbsp;<span class="num" id="8183510">2</span><span class="op" id="8183511">,</span>&nbsp;<span class="num" id="8183513">1</span><span class="op" id="8183514">}</span><span class="op" id="8183515">)</span>&nbsp;<span class="op" id="8183517">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183522"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8183523">.</span><span class="ident" id="8183524">Errorf</span><span class="op" id="8183530">(</span><span class="string" id="8183531">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="8183581">,</span>&nbsp;<span class="ident" id="8183583"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8183587">.</span><span class="ident" id="8183588">name</span><span class="op" id="8183592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183601">if</span>&nbsp;<span class="ident" id="8183604"><a href="/crypto/x509/x509_test.go.html#8166119">bytes</a></span><span class="op" id="8183609">.</span><span class="ident" id="8183610">Index</span><span class="op" id="8183615">(</span><span class="ident" id="8183616"><a href="/crypto/x509/x509_test.go.html#8180407">derBytes</a></span><span class="op" id="8183624">,</span>&nbsp;<span class="ident" id="8183626"><a href="/crypto/x509/x509_test.go.html#8178934">extraExtensionData</a></span><span class="op" id="8183644">)</span>&nbsp;<span class="op" id="8183646">==</span>&nbsp;<span class="op" id="8183649">-</span><span class="num" id="8183650">1</span>&nbsp;<span class="op" id="8183652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183657"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8183658">.</span><span class="ident" id="8183659">Errorf</span><span class="op" id="8183665">(</span><span class="string" id="8183666">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="8183713">,</span>&nbsp;<span class="ident" id="8183715"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8183719">.</span><span class="ident" id="8183720">name</span><span class="op" id="8183724">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183733">if</span>&nbsp;<span class="ident" id="8183736"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8183740">.</span><span class="ident" id="8183741">checkSig</span>&nbsp;<span class="op" id="8183750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183755"><a href="/crypto/x509/x509_test.go.html#8180417">err</a></span>&nbsp;<span class="op" id="8183759">=</span>&nbsp;<span class="ident" id="8183761"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8183765">.</span><span class="ident" id="8183766">CheckSignatureFrom</span><span class="op" id="8183784">(</span><span class="ident" id="8183785"><a href="/crypto/x509/x509_test.go.html#8180598">cert</a></span><span class="op" id="8183789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183794">if</span>&nbsp;<span class="ident" id="8183797"><a href="/crypto/x509/x509_test.go.html#8180417">err</a></span>&nbsp;<span class="op" id="8183801">!=</span>&nbsp;<span class="ident" id="8183804">nil</span>&nbsp;<span class="op" id="8183808">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183814"><a href="/crypto/x509/x509_test.go.html#8178021">t</a></span><span class="op" id="8183815">.</span><span class="ident" id="8183816">Errorf</span><span class="op" id="8183822">(</span><span class="string" id="8183823">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8183862">,</span>&nbsp;<span class="ident" id="8183864"><a href="/crypto/x509/x509_test.go.html#8178991">test</a></span><span class="op" id="8183868">.</span><span class="ident" id="8183869">name</span><span class="op" id="8183873">,</span>&nbsp;<span class="ident" id="8183875"><a href="/crypto/x509/x509_test.go.html#8180417">err</a></span><span class="op" id="8183878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183890">}</span><br>
<span class="lineno"></span><span class="op" id="8183892">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="8183895">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="8183956">var</span>&nbsp;<span class="ident" id="8183960">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="8183977">=</span>&nbsp;<span class="string" id="8183979">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8184758">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="8184821">var</span>&nbsp;<span class="ident" id="8184825">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="8184848">=</span>&nbsp;<span class="string" id="8184850">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8185629">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="8185692">var</span>&nbsp;<span class="ident" id="8185696">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="8185719">=</span>&nbsp;<span class="string" id="8185721">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="8186581">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="8186644">var</span>&nbsp;<span class="ident" id="8186648">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="8186671">=</span>&nbsp;<span class="string" id="8186673">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="8187634">var</span>&nbsp;<span class="ident" id="8187638">ecdsaTests</span>&nbsp;<span class="op" id="8187649">=</span>&nbsp;<span class="op" id="8187651">[</span><span class="op" id="8187652">]</span><span class="keyword" id="8187653">struct</span>&nbsp;<span class="op" id="8187660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187663">sigAlgo</span>&nbsp;<span class="ident" id="8187671"><a href="/crypto/x509/x509.go.html#4320325">SignatureAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187691">pemCert</span>&nbsp;<span class="builtintype" id="8187699">string</span><br>
<span class="lineno"></span><span class="op" id="8187706">}</span><span class="op" id="8187707">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187710">{</span><span class="ident" id="8187711"><a href="/crypto/x509/x509.go.html#4320521">ECDSAWithSHA1</a></span><span class="op" id="8187724">,</span>&nbsp;<span class="ident" id="8187726"><a href="/crypto/x509/x509_test.go.html#8183960">ecdsaSHA1CertPem</a></span><span class="op" id="8187742">}</span><span class="op" id="8187743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187746">{</span><span class="ident" id="8187747"><a href="/crypto/x509/x509.go.html#4320536">ECDSAWithSHA256</a></span><span class="op" id="8187762">,</span>&nbsp;<span class="ident" id="8187764"><a href="/crypto/x509/x509_test.go.html#8184825">ecdsaSHA256p256CertPem</a></span><span class="op" id="8187786">}</span><span class="op" id="8187787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187790">{</span><span class="ident" id="8187791"><a href="/crypto/x509/x509.go.html#4320536">ECDSAWithSHA256</a></span><span class="op" id="8187806">,</span>&nbsp;<span class="ident" id="8187808"><a href="/crypto/x509/x509_test.go.html#8185696">ecdsaSHA256p384CertPem</a></span><span class="op" id="8187830">}</span><span class="op" id="8187831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187834">{</span><span class="ident" id="8187835"><a href="/crypto/x509/x509.go.html#4320553">ECDSAWithSHA384</a></span><span class="op" id="8187850">,</span>&nbsp;<span class="ident" id="8187852"><a href="/crypto/x509/x509_test.go.html#8186648">ecdsaSHA384p521CertPem</a></span><span class="op" id="8187874">}</span><span class="op" id="8187875">,</span><br>
<span class="lineno"></span><span class="op" id="8187877">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="8187880">func</span>&nbsp;<span class="ident" id="8187885">TestECDSA</span><span class="op" id="8187894">(</span><span class="ident" id="8187895">t</span>&nbsp;<span class="op" id="8187897">*</span><span class="ident" id="8187898"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8187905">.</span><span class="ident" id="8187906">T</span><span class="op" id="8187907">)</span>&nbsp;<span class="op" id="8187909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187912">for</span>&nbsp;<span class="ident" id="8187916">i</span><span class="op" id="8187917">,</span>&nbsp;<span class="ident" id="8187919">test</span>&nbsp;<span class="op" id="8187924">:=</span>&nbsp;<span class="keyword" id="8187927">range</span>&nbsp;<span class="ident" id="8187933"><a href="/crypto/x509/x509_test.go.html#8187638">ecdsaTests</a></span>&nbsp;<span class="op" id="8187944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187948">pemBlock</span><span class="op" id="8187956">,</span>&nbsp;<span class="ident" id="8187958">_</span>&nbsp;<span class="op" id="8187960">:=</span>&nbsp;<span class="ident" id="8187963"><a href="/crypto/x509/x509_test.go.html#8166316">pem</a></span><span class="op" id="8187966">.</span><span class="ident" id="8187967">Decode</span><span class="op" id="8187973">(</span><span class="op" id="8187974">[</span><span class="op" id="8187975">]</span><span class="builtintype" id="8187976">byte</span><span class="op" id="8187980">(</span><span class="ident" id="8187981"><a href="/crypto/x509/x509_test.go.html#8187919">test</a></span><span class="op" id="8187985">.</span><span class="ident" id="8187986">pemCert</span><span class="op" id="8187993">)</span><span class="op" id="8187994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187998">cert</span><span class="op" id="8188002">,</span>&nbsp;<span class="ident" id="8188004">err</span>&nbsp;<span class="op" id="8188008">:=</span>&nbsp;<span class="ident" id="8188011"><a href="/crypto/x509/x509.go.html#4350518">ParseCertificate</a></span><span class="op" id="8188027">(</span><span class="ident" id="8188028"><a href="/crypto/x509/x509_test.go.html#8187948">pemBlock</a></span><span class="op" id="8188036">.</span><span class="ident" id="8188037">Bytes</span><span class="op" id="8188042">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8188046">if</span>&nbsp;<span class="ident" id="8188049"><a href="/crypto/x509/x509_test.go.html#8188004">err</a></span>&nbsp;<span class="op" id="8188053">!=</span>&nbsp;<span class="ident" id="8188056">nil</span>&nbsp;<span class="op" id="8188060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188065"><a href="/crypto/x509/x509_test.go.html#8187895">t</a></span><span class="op" id="8188066">.</span><span class="ident" id="8188067">Errorf</span><span class="op" id="8188073">(</span><span class="string" id="8188074">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8188111">,</span>&nbsp;<span class="ident" id="8188113"><a href="/crypto/x509/x509_test.go.html#8187916">i</a></span><span class="op" id="8188114">,</span>&nbsp;<span class="ident" id="8188116"><a href="/crypto/x509/x509_test.go.html#8188004">err</a></span><span class="op" id="8188119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8188124">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8188139">if</span>&nbsp;<span class="ident" id="8188142">sa</span>&nbsp;<span class="op" id="8188145">:=</span>&nbsp;<span class="ident" id="8188148"><a href="/crypto/x509/x509_test.go.html#8187998">cert</a></span><span class="op" id="8188152">.</span><span class="ident" id="8188153">SignatureAlgorithm</span><span class="op" id="8188171">;</span>&nbsp;<span class="ident" id="8188173"><a href="/crypto/x509/x509_test.go.html#8188142">sa</a></span>&nbsp;<span class="op" id="8188176">!=</span>&nbsp;<span class="ident" id="8188179"><a href="/crypto/x509/x509_test.go.html#8187919">test</a></span><span class="op" id="8188183">.</span><span class="ident" id="8188184">sigAlgo</span>&nbsp;<span class="op" id="8188192">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188197"><a href="/crypto/x509/x509_test.go.html#8187895">t</a></span><span class="op" id="8188198">.</span><span class="ident" id="8188199">Errorf</span><span class="op" id="8188205">(</span><span class="string" id="8188206">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8188246">,</span>&nbsp;<span class="ident" id="8188248"><a href="/crypto/x509/x509_test.go.html#8187916">i</a></span><span class="op" id="8188249">,</span>&nbsp;<span class="ident" id="8188251"><a href="/crypto/x509/x509_test.go.html#8188142">sa</a></span><span class="op" id="8188253">,</span>&nbsp;<span class="ident" id="8188255"><a href="/crypto/x509/x509_test.go.html#8187919">test</a></span><span class="op" id="8188259">.</span><span class="ident" id="8188260">sigAlgo</span><span class="op" id="8188267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8188275">if</span>&nbsp;<span class="ident" id="8188278">parsedKey</span><span class="op" id="8188287">,</span>&nbsp;<span class="ident" id="8188289">ok</span>&nbsp;<span class="op" id="8188292">:=</span>&nbsp;<span class="ident" id="8188295"><a href="/crypto/x509/x509_test.go.html#8187998">cert</a></span><span class="op" id="8188299">.</span><span class="ident" id="8188300">PublicKey</span><span class="op" id="8188309">.</span><span class="op" id="8188310">(</span><span class="op" id="8188311">*</span><span class="ident" id="8188312"><a href="/crypto/x509/x509_test.go.html#8166142">ecdsa</a></span><span class="op" id="8188317">.</span><span class="ident" id="8188318">PublicKey</span><span class="op" id="8188327">)</span><span class="op" id="8188328">;</span>&nbsp;<span class="op" id="8188330">!</span><span class="ident" id="8188331"><a href="/crypto/x509/x509_test.go.html#8188289">ok</a></span>&nbsp;<span class="op" id="8188334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188339"><a href="/crypto/x509/x509_test.go.html#8187895">t</a></span><span class="op" id="8188340">.</span><span class="ident" id="8188341">Errorf</span><span class="op" id="8188347">(</span><span class="string" id="8188348">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="8188395">,</span>&nbsp;<span class="ident" id="8188397"><a href="/crypto/x509/x509_test.go.html#8187916">i</a></span><span class="op" id="8188398">,</span>&nbsp;<span class="ident" id="8188400"><a href="/crypto/x509/x509_test.go.html#8188278">parsedKey</a></span><span class="op" id="8188409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188413">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8188417">if</span>&nbsp;<span class="ident" id="8188420">pka</span>&nbsp;<span class="op" id="8188424">:=</span>&nbsp;<span class="ident" id="8188427"><a href="/crypto/x509/x509_test.go.html#8187998">cert</a></span><span class="op" id="8188431">.</span><span class="ident" id="8188432">PublicKeyAlgorithm</span><span class="op" id="8188450">;</span>&nbsp;<span class="ident" id="8188452"><a href="/crypto/x509/x509_test.go.html#8188420">pka</a></span>&nbsp;<span class="op" id="8188456">!=</span>&nbsp;<span class="ident" id="8188459"><a href="/crypto/x509/x509.go.html#4320690">ECDSA</a></span>&nbsp;<span class="op" id="8188465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188470"><a href="/crypto/x509/x509_test.go.html#8187895">t</a></span><span class="op" id="8188471">.</span><span class="ident" id="8188472">Errorf</span><span class="op" id="8188478">(</span><span class="string" id="8188479">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="8188523">,</span>&nbsp;<span class="ident" id="8188525"><a href="/crypto/x509/x509_test.go.html#8187916">i</a></span><span class="op" id="8188526">,</span>&nbsp;<span class="ident" id="8188528"><a href="/crypto/x509/x509_test.go.html#8188420">pka</a></span><span class="op" id="8188531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8188539">if</span>&nbsp;<span class="ident" id="8188542"><a href="/crypto/x509/x509_test.go.html#8188004">err</a></span>&nbsp;<span class="op" id="8188546">=</span>&nbsp;<span class="ident" id="8188548"><a href="/crypto/x509/x509_test.go.html#8187998">cert</a></span><span class="op" id="8188552">.</span><span class="ident" id="8188553">CheckSignatureFrom</span><span class="op" id="8188571">(</span><span class="ident" id="8188572"><a href="/crypto/x509/x509_test.go.html#8187998">cert</a></span><span class="op" id="8188576">)</span><span class="op" id="8188577">;</span>&nbsp;<span class="ident" id="8188579"><a href="/crypto/x509/x509_test.go.html#8188004">err</a></span>&nbsp;<span class="op" id="8188583">!=</span>&nbsp;<span class="ident" id="8188586">nil</span>&nbsp;<span class="op" id="8188590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188595"><a href="/crypto/x509/x509_test.go.html#8187895">t</a></span><span class="op" id="8188596">.</span><span class="ident" id="8188597">Errorf</span><span class="op" id="8188603">(</span><span class="string" id="8188604">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8188645">,</span>&nbsp;<span class="ident" id="8188647"><a href="/crypto/x509/x509_test.go.html#8187916">i</a></span><span class="op" id="8188648">,</span>&nbsp;<span class="ident" id="8188650"><a href="/crypto/x509/x509_test.go.html#8188004">err</a></span><span class="op" id="8188653">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188660">}</span><br>
<span class="lineno"></span><span class="op" id="8188662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8188665">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="8188712">var</span>&nbsp;<span class="ident" id="8188716">dsaCertPem</span>&nbsp;<span class="op" id="8188727">=</span>&nbsp;<span class="string" id="8188729">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="8190197">func</span>&nbsp;<span class="ident" id="8190202">TestParseCertificateWithDsaPublicKey</span><span class="op" id="8190238">(</span><span class="ident" id="8190239">t</span>&nbsp;<span class="op" id="8190241">*</span><span class="ident" id="8190242"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8190249">.</span><span class="ident" id="8190250">T</span><span class="op" id="8190251">)</span>&nbsp;<span class="op" id="8190253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190256">expectedKey</span>&nbsp;<span class="op" id="8190268">:=</span>&nbsp;<span class="op" id="8190271">&amp;</span><span class="ident" id="8190272"><a href="/crypto/x509/x509_test.go.html#8166128">dsa</a></span><span class="op" id="8190275">.</span><span class="ident" id="8190276">PublicKey</span><span class="op" id="8190285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190289">Parameters</span><span class="op" id="8190299">:</span>&nbsp;<span class="ident" id="8190301"><a href="/crypto/x509/x509_test.go.html#8166128">dsa</a></span><span class="op" id="8190304">.</span><span class="ident" id="8190305">Parameters</span><span class="op" id="8190315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190320">P</span><span class="op" id="8190321">:</span>&nbsp;<span class="ident" id="8190323"><a href="/crypto/x509/x509_test.go.html#8168789">bigFromHexString</a></span><span class="op" id="8190339">(</span><span class="string" id="8190340">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="8190600">)</span><span class="op" id="8190601">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190606">Q</span><span class="op" id="8190607">:</span>&nbsp;<span class="ident" id="8190609"><a href="/crypto/x509/x509_test.go.html#8168789">bigFromHexString</a></span><span class="op" id="8190625">(</span><span class="string" id="8190626">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="8190670">)</span><span class="op" id="8190671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190676">G</span><span class="op" id="8190677">:</span>&nbsp;<span class="ident" id="8190679"><a href="/crypto/x509/x509_test.go.html#8168789">bigFromHexString</a></span><span class="op" id="8190695">(</span><span class="string" id="8190696">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="8190956">)</span><span class="op" id="8190957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8190961">}</span><span class="op" id="8190962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8190966">Y</span><span class="op" id="8190967">:</span>&nbsp;<span class="ident" id="8190969"><a href="/crypto/x509/x509_test.go.html#8168789">bigFromHexString</a></span><span class="op" id="8190985">(</span><span class="string" id="8190986">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="8191244">)</span><span class="op" id="8191245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8191248">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191251">pemBlock</span><span class="op" id="8191259">,</span>&nbsp;<span class="ident" id="8191261">_</span>&nbsp;<span class="op" id="8191263">:=</span>&nbsp;<span class="ident" id="8191266"><a href="/crypto/x509/x509_test.go.html#8166316">pem</a></span><span class="op" id="8191269">.</span><span class="ident" id="8191270">Decode</span><span class="op" id="8191276">(</span><span class="op" id="8191277">[</span><span class="op" id="8191278">]</span><span class="builtintype" id="8191279">byte</span><span class="op" id="8191283">(</span><span class="ident" id="8191284"><a href="/crypto/x509/x509_test.go.html#8188716">dsaCertPem</a></span><span class="op" id="8191294">)</span><span class="op" id="8191295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191298">cert</span><span class="op" id="8191302">,</span>&nbsp;<span class="ident" id="8191304">err</span>&nbsp;<span class="op" id="8191308">:=</span>&nbsp;<span class="ident" id="8191311"><a href="/crypto/x509/x509.go.html#4350518">ParseCertificate</a></span><span class="op" id="8191327">(</span><span class="ident" id="8191328"><a href="/crypto/x509/x509_test.go.html#8191251">pemBlock</a></span><span class="op" id="8191336">.</span><span class="ident" id="8191337">Bytes</span><span class="op" id="8191342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8191345">if</span>&nbsp;<span class="ident" id="8191348"><a href="/crypto/x509/x509_test.go.html#8191304">err</a></span>&nbsp;<span class="op" id="8191352">!=</span>&nbsp;<span class="ident" id="8191355">nil</span>&nbsp;<span class="op" id="8191359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191363"><a href="/crypto/x509/x509_test.go.html#8190239">t</a></span><span class="op" id="8191364">.</span><span class="ident" id="8191365">Fatalf</span><span class="op" id="8191371">(</span><span class="string" id="8191372">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8191405">,</span>&nbsp;<span class="ident" id="8191407"><a href="/crypto/x509/x509_test.go.html#8191304">err</a></span><span class="op" id="8191410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8191413">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8191416">if</span>&nbsp;<span class="ident" id="8191419"><a href="/crypto/x509/x509_test.go.html#8191298">cert</a></span><span class="op" id="8191423">.</span><span class="ident" id="8191424">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="8191443">!=</span>&nbsp;<span class="ident" id="8191446"><a href="/crypto/x509/x509.go.html#4320685">DSA</a></span>&nbsp;<span class="op" id="8191450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191454"><a href="/crypto/x509/x509_test.go.html#8190239">t</a></span><span class="op" id="8191455">.</span><span class="ident" id="8191456">Errorf</span><span class="op" id="8191462">(</span><span class="string" id="8191463">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="8191497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8191500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191503">parsedKey</span><span class="op" id="8191512">,</span>&nbsp;<span class="ident" id="8191514">ok</span>&nbsp;<span class="op" id="8191517">:=</span>&nbsp;<span class="ident" id="8191520"><a href="/crypto/x509/x509_test.go.html#8191298">cert</a></span><span class="op" id="8191524">.</span><span class="ident" id="8191525">PublicKey</span><span class="op" id="8191534">.</span><span class="op" id="8191535">(</span><span class="op" id="8191536">*</span><span class="ident" id="8191537"><a href="/crypto/x509/x509_test.go.html#8166128">dsa</a></span><span class="op" id="8191540">.</span><span class="ident" id="8191541">PublicKey</span><span class="op" id="8191550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8191553">if</span>&nbsp;<span class="op" id="8191556">!</span><span class="ident" id="8191557"><a href="/crypto/x509/x509_test.go.html#8191514">ok</a></span>&nbsp;<span class="op" id="8191560">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191564"><a href="/crypto/x509/x509_test.go.html#8190239">t</a></span><span class="op" id="8191565">.</span><span class="ident" id="8191566">Fatalf</span><span class="op" id="8191572">(</span><span class="string" id="8191573">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8191607">,</span>&nbsp;<span class="ident" id="8191609"><a href="/crypto/x509/x509_test.go.html#8191304">err</a></span><span class="op" id="8191612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8191615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8191618">if</span>&nbsp;<span class="ident" id="8191621"><a href="/crypto/x509/x509_test.go.html#8190256">expectedKey</a></span><span class="op" id="8191632">.</span><span class="ident" id="8191633">Y</span><span class="op" id="8191634">.</span><span class="ident" id="8191635">Cmp</span><span class="op" id="8191638">(</span><span class="ident" id="8191639"><a href="/crypto/x509/x509_test.go.html#8191503">parsedKey</a></span><span class="op" id="8191648">.</span><span class="ident" id="8191649">Y</span><span class="op" id="8191650">)</span>&nbsp;<span class="op" id="8191652">!=</span>&nbsp;<span class="num" id="8191655">0</span>&nbsp;<span class="op" id="8191657">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191662"><a href="/crypto/x509/x509_test.go.html#8190256">expectedKey</a></span><span class="op" id="8191673">.</span><span class="ident" id="8191674">P</span><span class="op" id="8191675">.</span><span class="ident" id="8191676">Cmp</span><span class="op" id="8191679">(</span><span class="ident" id="8191680"><a href="/crypto/x509/x509_test.go.html#8191503">parsedKey</a></span><span class="op" id="8191689">.</span><span class="ident" id="8191690">P</span><span class="op" id="8191691">)</span>&nbsp;<span class="op" id="8191693">!=</span>&nbsp;<span class="num" id="8191696">0</span>&nbsp;<span class="op" id="8191698">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191703"><a href="/crypto/x509/x509_test.go.html#8190256">expectedKey</a></span><span class="op" id="8191714">.</span><span class="ident" id="8191715">Q</span><span class="op" id="8191716">.</span><span class="ident" id="8191717">Cmp</span><span class="op" id="8191720">(</span><span class="ident" id="8191721"><a href="/crypto/x509/x509_test.go.html#8191503">parsedKey</a></span><span class="op" id="8191730">.</span><span class="ident" id="8191731">Q</span><span class="op" id="8191732">)</span>&nbsp;<span class="op" id="8191734">!=</span>&nbsp;<span class="num" id="8191737">0</span>&nbsp;<span class="op" id="8191739">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191744"><a href="/crypto/x509/x509_test.go.html#8190256">expectedKey</a></span><span class="op" id="8191755">.</span><span class="ident" id="8191756">G</span><span class="op" id="8191757">.</span><span class="ident" id="8191758">Cmp</span><span class="op" id="8191761">(</span><span class="ident" id="8191762"><a href="/crypto/x509/x509_test.go.html#8191503">parsedKey</a></span><span class="op" id="8191771">.</span><span class="ident" id="8191772">G</span><span class="op" id="8191773">)</span>&nbsp;<span class="op" id="8191775">!=</span>&nbsp;<span class="num" id="8191778">0</span>&nbsp;<span class="op" id="8191780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191784"><a href="/crypto/x509/x509_test.go.html#8190239">t</a></span><span class="op" id="8191785">.</span><span class="ident" id="8191786">Fatal</span><span class="op" id="8191791">(</span><span class="string" id="8191792">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="8191830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8191833">}</span><br>
<span class="lineno"></span><span class="op" id="8191835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="8191838">func</span>&nbsp;<span class="ident" id="8191843">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="8191888">(</span><span class="ident" id="8191889">t</span>&nbsp;<span class="op" id="8191891">*</span><span class="ident" id="8191892"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8191899">.</span><span class="ident" id="8191900">T</span><span class="op" id="8191901">)</span>&nbsp;<span class="op" id="8191903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191906">pemBlock</span><span class="op" id="8191914">,</span>&nbsp;<span class="ident" id="8191916">_</span>&nbsp;<span class="op" id="8191918">:=</span>&nbsp;<span class="ident" id="8191921"><a href="/crypto/x509/x509_test.go.html#8166316">pem</a></span><span class="op" id="8191924">.</span><span class="ident" id="8191925">Decode</span><span class="op" id="8191931">(</span><span class="op" id="8191932">[</span><span class="op" id="8191933">]</span><span class="builtintype" id="8191934">byte</span><span class="op" id="8191938">(</span><span class="ident" id="8191939"><a href="/crypto/x509/x509_test.go.html#8188716">dsaCertPem</a></span><span class="op" id="8191949">)</span><span class="op" id="8191950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8191953">cert</span><span class="op" id="8191957">,</span>&nbsp;<span class="ident" id="8191959">err</span>&nbsp;<span class="op" id="8191963">:=</span>&nbsp;<span class="ident" id="8191966"><a href="/crypto/x509/x509.go.html#4350518">ParseCertificate</a></span><span class="op" id="8191982">(</span><span class="ident" id="8191983"><a href="/crypto/x509/x509_test.go.html#8191906">pemBlock</a></span><span class="op" id="8191991">.</span><span class="ident" id="8191992">Bytes</span><span class="op" id="8191997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8192000">if</span>&nbsp;<span class="ident" id="8192003"><a href="/crypto/x509/x509_test.go.html#8191959">err</a></span>&nbsp;<span class="op" id="8192007">!=</span>&nbsp;<span class="ident" id="8192010">nil</span>&nbsp;<span class="op" id="8192014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192018"><a href="/crypto/x509/x509_test.go.html#8191889">t</a></span><span class="op" id="8192019">.</span><span class="ident" id="8192020">Fatalf</span><span class="op" id="8192026">(</span><span class="string" id="8192027">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8192060">,</span>&nbsp;<span class="ident" id="8192062"><a href="/crypto/x509/x509_test.go.html#8191959">err</a></span><span class="op" id="8192065">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8192071">if</span>&nbsp;<span class="ident" id="8192074"><a href="/crypto/x509/x509_test.go.html#8191953">cert</a></span><span class="op" id="8192078">.</span><span class="ident" id="8192079">SignatureAlgorithm</span>&nbsp;<span class="op" id="8192098">!=</span>&nbsp;<span class="ident" id="8192101"><a href="/crypto/x509/x509.go.html#4320493">DSAWithSHA1</a></span>&nbsp;<span class="op" id="8192113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192117"><a href="/crypto/x509/x509_test.go.html#8191889">t</a></span><span class="op" id="8192118">.</span><span class="ident" id="8192119">Errorf</span><span class="op" id="8192125">(</span><span class="string" id="8192126">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="8192174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192177">}</span><br>
<span class="lineno"></span><span class="op" id="8192179">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="8192182">func</span>&nbsp;<span class="ident" id="8192187">TestVerifyCertificateWithDSASignature</span><span class="op" id="8192224">(</span><span class="ident" id="8192225">t</span>&nbsp;<span class="op" id="8192227">*</span><span class="ident" id="8192228"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8192235">.</span><span class="ident" id="8192236">T</span><span class="op" id="8192237">)</span>&nbsp;<span class="op" id="8192239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192242">pemBlock</span><span class="op" id="8192250">,</span>&nbsp;<span class="ident" id="8192252">_</span>&nbsp;<span class="op" id="8192254">:=</span>&nbsp;<span class="ident" id="8192257"><a href="/crypto/x509/x509_test.go.html#8166316">pem</a></span><span class="op" id="8192260">.</span><span class="ident" id="8192261">Decode</span><span class="op" id="8192267">(</span><span class="op" id="8192268">[</span><span class="op" id="8192269">]</span><span class="builtintype" id="8192270">byte</span><span class="op" id="8192274">(</span><span class="ident" id="8192275"><a href="/crypto/x509/x509_test.go.html#8188716">dsaCertPem</a></span><span class="op" id="8192285">)</span><span class="op" id="8192286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192289">cert</span><span class="op" id="8192293">,</span>&nbsp;<span class="ident" id="8192295">err</span>&nbsp;<span class="op" id="8192299">:=</span>&nbsp;<span class="ident" id="8192302"><a href="/crypto/x509/x509.go.html#4350518">ParseCertificate</a></span><span class="op" id="8192318">(</span><span class="ident" id="8192319"><a href="/crypto/x509/x509_test.go.html#8192242">pemBlock</a></span><span class="op" id="8192327">.</span><span class="ident" id="8192328">Bytes</span><span class="op" id="8192333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8192336">if</span>&nbsp;<span class="ident" id="8192339"><a href="/crypto/x509/x509_test.go.html#8192295">err</a></span>&nbsp;<span class="op" id="8192343">!=</span>&nbsp;<span class="ident" id="8192346">nil</span>&nbsp;<span class="op" id="8192350">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192354"><a href="/crypto/x509/x509_test.go.html#8192225">t</a></span><span class="op" id="8192355">.</span><span class="ident" id="8192356">Fatalf</span><span class="op" id="8192362">(</span><span class="string" id="8192363">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8192396">,</span>&nbsp;<span class="ident" id="8192398"><a href="/crypto/x509/x509_test.go.html#8192295">err</a></span><span class="op" id="8192401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8192407">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8192436">if</span>&nbsp;<span class="ident" id="8192439"><a href="/crypto/x509/x509_test.go.html#8192295">err</a></span>&nbsp;<span class="op" id="8192443">=</span>&nbsp;<span class="ident" id="8192445"><a href="/crypto/x509/x509_test.go.html#8192289">cert</a></span><span class="op" id="8192449">.</span><span class="ident" id="8192450">CheckSignatureFrom</span><span class="op" id="8192468">(</span><span class="ident" id="8192469"><a href="/crypto/x509/x509_test.go.html#8192289">cert</a></span><span class="op" id="8192473">)</span><span class="op" id="8192474">;</span>&nbsp;<span class="ident" id="8192476"><a href="/crypto/x509/x509_test.go.html#8192295">err</a></span>&nbsp;<span class="op" id="8192480">!=</span>&nbsp;<span class="ident" id="8192483">nil</span>&nbsp;<span class="op" id="8192487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8192491"><a href="/crypto/x509/x509_test.go.html#8192225">t</a></span><span class="op" id="8192492">.</span><span class="ident" id="8192493">Fatalf</span><span class="op" id="8192499">(</span><span class="string" id="8192500">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="8192541">,</span>&nbsp;<span class="ident" id="8192543"><a href="/crypto/x509/x509_test.go.html#8192295">err</a></span><span class="op" id="8192546">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8192549">}</span><br>
<span class="lineno"></span><span class="op" id="8192551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8192554">const</span>&nbsp;<span class="ident" id="8192560">pemCertificate</span>&nbsp;<span class="op" id="8192575">=</span>&nbsp;<span class="string" id="8192577">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="8193295">func</span>&nbsp;<span class="ident" id="8193300">TestCRLCreation</span><span class="op" id="8193315">(</span><span class="ident" id="8193316">t</span>&nbsp;<span class="op" id="8193318">*</span><span class="ident" id="8193319"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8193326">.</span><span class="ident" id="8193327">T</span><span class="op" id="8193328">)</span>&nbsp;<span class="op" id="8193330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193333">block</span><span class="op" id="8193338">,</span>&nbsp;<span class="ident" id="8193340">_</span>&nbsp;<span class="op" id="8193342">:=</span>&nbsp;<span class="ident" id="8193345"><a href="/crypto/x509/x509_test.go.html#8166316">pem</a></span><span class="op" id="8193348">.</span><span class="ident" id="8193349">Decode</span><span class="op" id="8193355">(</span><span class="op" id="8193356">[</span><span class="op" id="8193357">]</span><span class="builtintype" id="8193358">byte</span><span class="op" id="8193362">(</span><span class="ident" id="8193363"><a href="/crypto/x509/x509_test.go.html#8168074">pemPrivateKey</a></span><span class="op" id="8193376">)</span><span class="op" id="8193377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193380">priv</span><span class="op" id="8193384">,</span>&nbsp;<span class="ident" id="8193386">_</span>&nbsp;<span class="op" id="8193388">:=</span>&nbsp;<span class="ident" id="8193391"><a href="/crypto/x509/pkcs1.go.html#4294252">ParsePKCS1PrivateKey</a></span><span class="op" id="8193411">(</span><span class="ident" id="8193412"><a href="/crypto/x509/x509_test.go.html#8193333">block</a></span><span class="op" id="8193417">.</span><span class="ident" id="8193418">Bytes</span><span class="op" id="8193423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193426"><a href="/crypto/x509/x509_test.go.html#8193333">block</a></span><span class="op" id="8193431">,</span>&nbsp;<span class="ident" id="8193433">_</span>&nbsp;<span class="op" id="8193435">=</span>&nbsp;<span class="ident" id="8193437"><a href="/crypto/x509/x509_test.go.html#8166316">pem</a></span><span class="op" id="8193440">.</span><span class="ident" id="8193441">Decode</span><span class="op" id="8193447">(</span><span class="op" id="8193448">[</span><span class="op" id="8193449">]</span><span class="builtintype" id="8193450">byte</span><span class="op" id="8193454">(</span><span class="ident" id="8193455"><a href="/crypto/x509/x509_test.go.html#8192560">pemCertificate</a></span><span class="op" id="8193469">)</span><span class="op" id="8193470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193473">cert</span><span class="op" id="8193477">,</span>&nbsp;<span class="ident" id="8193479">_</span>&nbsp;<span class="op" id="8193481">:=</span>&nbsp;<span class="ident" id="8193484"><a href="/crypto/x509/x509.go.html#4350518">ParseCertificate</a></span><span class="op" id="8193500">(</span><span class="ident" id="8193501"><a href="/crypto/x509/x509_test.go.html#8193333">block</a></span><span class="op" id="8193506">.</span><span class="ident" id="8193507">Bytes</span><span class="op" id="8193512">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193516">now</span>&nbsp;<span class="op" id="8193520">:=</span>&nbsp;<span class="ident" id="8193523"><a href="/crypto/x509/x509_test.go.html#8166395">time</a></span><span class="op" id="8193527">.</span><span class="ident" id="8193528">Unix</span><span class="op" id="8193532">(</span><span class="num" id="8193533">1000</span><span class="op" id="8193537">,</span>&nbsp;<span class="num" id="8193539">0</span><span class="op" id="8193540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193543">expiry</span>&nbsp;<span class="op" id="8193550">:=</span>&nbsp;<span class="ident" id="8193553"><a href="/crypto/x509/x509_test.go.html#8166395">time</a></span><span class="op" id="8193557">.</span><span class="ident" id="8193558">Unix</span><span class="op" id="8193562">(</span><span class="num" id="8193563">10000</span><span class="op" id="8193568">,</span>&nbsp;<span class="num" id="8193570">0</span><span class="op" id="8193571">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193575">revokedCerts</span>&nbsp;<span class="op" id="8193588">:=</span>&nbsp;<span class="op" id="8193591">[</span><span class="op" id="8193592">]</span><span class="ident" id="8193593"><a href="/crypto/x509/x509_test.go.html#8166244">pkix</a></span><span class="op" id="8193597">.</span><span class="ident" id="8193598">RevokedCertificate</span><span class="op" id="8193616">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193625">SerialNumber</span><span class="op" id="8193637">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8193641"><a href="/crypto/x509/x509_test.go.html#8166332">big</a></span><span class="op" id="8193644">.</span><span class="ident" id="8193645">NewInt</span><span class="op" id="8193651">(</span><span class="num" id="8193652">1</span><span class="op" id="8193653">)</span><span class="op" id="8193654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193659">RevocationTime</span><span class="op" id="8193673">:</span>&nbsp;<span class="ident" id="8193675"><a href="/crypto/x509/x509_test.go.html#8193516">now</a></span><span class="op" id="8193678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193682">}</span><span class="op" id="8193683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193687">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193692">SerialNumber</span><span class="op" id="8193704">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8193708"><a href="/crypto/x509/x509_test.go.html#8166332">big</a></span><span class="op" id="8193711">.</span><span class="ident" id="8193712">NewInt</span><span class="op" id="8193718">(</span><span class="num" id="8193719">42</span><span class="op" id="8193721">)</span><span class="op" id="8193722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193727">RevocationTime</span><span class="op" id="8193741">:</span>&nbsp;<span class="ident" id="8193743"><a href="/crypto/x509/x509_test.go.html#8193516">now</a></span><span class="op" id="8193746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193750">}</span><span class="op" id="8193751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193758">crlBytes</span><span class="op" id="8193766">,</span>&nbsp;<span class="ident" id="8193768">err</span>&nbsp;<span class="op" id="8193772">:=</span>&nbsp;<span class="ident" id="8193775"><a href="/crypto/x509/x509_test.go.html#8193473">cert</a></span><span class="op" id="8193779">.</span><span class="ident" id="8193780">CreateCRL</span><span class="op" id="8193789">(</span><span class="ident" id="8193790"><a href="/crypto/x509/x509_test.go.html#8166177">rand</a></span><span class="op" id="8193794">.</span><span class="ident" id="8193795">Reader</span><span class="op" id="8193801">,</span>&nbsp;<span class="ident" id="8193803"><a href="/crypto/x509/x509_test.go.html#8193380">priv</a></span><span class="op" id="8193807">,</span>&nbsp;<span class="ident" id="8193809"><a href="/crypto/x509/x509_test.go.html#8193575">revokedCerts</a></span><span class="op" id="8193821">,</span>&nbsp;<span class="ident" id="8193823"><a href="/crypto/x509/x509_test.go.html#8193516">now</a></span><span class="op" id="8193826">,</span>&nbsp;<span class="ident" id="8193828"><a href="/crypto/x509/x509_test.go.html#8193543">expiry</a></span><span class="op" id="8193834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8193837">if</span>&nbsp;<span class="ident" id="8193840"><a href="/crypto/x509/x509_test.go.html#8193768">err</a></span>&nbsp;<span class="op" id="8193844">!=</span>&nbsp;<span class="ident" id="8193847">nil</span>&nbsp;<span class="op" id="8193851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193855"><a href="/crypto/x509/x509_test.go.html#8193316">t</a></span><span class="op" id="8193856">.</span><span class="ident" id="8193857">Errorf</span><span class="op" id="8193863">(</span><span class="string" id="8193864">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="8193888">,</span>&nbsp;<span class="ident" id="8193890"><a href="/crypto/x509/x509_test.go.html#8193768">err</a></span><span class="op" id="8193893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193900">_</span><span class="op" id="8193901">,</span>&nbsp;<span class="ident" id="8193903"><a href="/crypto/x509/x509_test.go.html#8193768">err</a></span>&nbsp;<span class="op" id="8193907">=</span>&nbsp;<span class="ident" id="8193909"><a href="/crypto/x509/x509.go.html#4363898">ParseDERCRL</a></span><span class="op" id="8193920">(</span><span class="ident" id="8193921"><a href="/crypto/x509/x509_test.go.html#8193758">crlBytes</a></span><span class="op" id="8193929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8193932">if</span>&nbsp;<span class="ident" id="8193935"><a href="/crypto/x509/x509_test.go.html#8193768">err</a></span>&nbsp;<span class="op" id="8193939">!=</span>&nbsp;<span class="ident" id="8193942">nil</span>&nbsp;<span class="op" id="8193946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8193950"><a href="/crypto/x509/x509_test.go.html#8193316">t</a></span><span class="op" id="8193951">.</span><span class="ident" id="8193952">Errorf</span><span class="op" id="8193958">(</span><span class="string" id="8193959">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="8193984">,</span>&nbsp;<span class="ident" id="8193986"><a href="/crypto/x509/x509_test.go.html#8193768">err</a></span><span class="op" id="8193989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8193992">}</span><br>
<span class="lineno"></span><span class="op" id="8193994">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="8193997">func</span>&nbsp;<span class="ident" id="8194002">fromBase64</span><span class="op" id="8194012">(</span><span class="ident" id="8194013">in</span>&nbsp;<span class="builtintype" id="8194016">string</span><span class="op" id="8194022">)</span>&nbsp;<span class="op" id="8194024">[</span><span class="op" id="8194025">]</span><span class="builtintype" id="8194026">byte</span>&nbsp;<span class="op" id="8194031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194034">out</span>&nbsp;<span class="op" id="8194038">:=</span>&nbsp;<span class="builtinfunc" id="8194041">make</span><span class="op" id="8194045">(</span><span class="op" id="8194046">[</span><span class="op" id="8194047">]</span><span class="builtintype" id="8194048">byte</span><span class="op" id="8194052">,</span>&nbsp;<span class="ident" id="8194054"><a href="/crypto/x509/x509_test.go.html#8166281">base64</a></span><span class="op" id="8194060">.</span><span class="ident" id="8194061">StdEncoding</span><span class="op" id="8194072">.</span><span class="ident" id="8194073">DecodedLen</span><span class="op" id="8194083">(</span><span class="builtinfunc" id="8194084">len</span><span class="op" id="8194087">(</span><span class="ident" id="8194088"><a href="/crypto/x509/x509_test.go.html#8194013">in</a></span><span class="op" id="8194090">)</span><span class="op" id="8194091">)</span><span class="op" id="8194092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194095">n</span><span class="op" id="8194096">,</span>&nbsp;<span class="ident" id="8194098">err</span>&nbsp;<span class="op" id="8194102">:=</span>&nbsp;<span class="ident" id="8194105"><a href="/crypto/x509/x509_test.go.html#8166281">base64</a></span><span class="op" id="8194111">.</span><span class="ident" id="8194112">StdEncoding</span><span class="op" id="8194123">.</span><span class="ident" id="8194124">Decode</span><span class="op" id="8194130">(</span><span class="ident" id="8194131"><a href="/crypto/x509/x509_test.go.html#8194034">out</a></span><span class="op" id="8194134">,</span>&nbsp;<span class="op" id="8194136">[</span><span class="op" id="8194137">]</span><span class="builtintype" id="8194138">byte</span><span class="op" id="8194142">(</span><span class="ident" id="8194143"><a href="/crypto/x509/x509_test.go.html#8194013">in</a></span><span class="op" id="8194145">)</span><span class="op" id="8194146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194149">if</span>&nbsp;<span class="ident" id="8194152"><a href="/crypto/x509/x509_test.go.html#8194098">err</a></span>&nbsp;<span class="op" id="8194156">!=</span>&nbsp;<span class="ident" id="8194159">nil</span>&nbsp;<span class="op" id="8194163">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8194167">panic</span><span class="op" id="8194172">(</span><span class="string" id="8194173">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="8194198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8194201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194204">return</span>&nbsp;<span class="ident" id="8194211"><a href="/crypto/x509/x509_test.go.html#8194034">out</a></span><span class="op" id="8194214">[</span><span class="op" id="8194215">:</span><span class="ident" id="8194216"><a href="/crypto/x509/x509_test.go.html#8194095">n</a></span><span class="op" id="8194217">]</span><br>
<span class="lineno"></span><span class="op" id="8194219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="8194222">func</span>&nbsp;<span class="ident" id="8194227">TestParseDERCRL</span><span class="op" id="8194242">(</span><span class="ident" id="8194243">t</span>&nbsp;<span class="op" id="8194245">*</span><span class="ident" id="8194246"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8194253">.</span><span class="ident" id="8194254">T</span><span class="op" id="8194255">)</span>&nbsp;<span class="op" id="8194257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194260">derBytes</span>&nbsp;<span class="op" id="8194269">:=</span>&nbsp;<span class="ident" id="8194272"><a href="/crypto/x509/x509_test.go.html#8194002">fromBase64</a></span><span class="op" id="8194282">(</span><span class="ident" id="8194283"><a href="/crypto/x509/x509_test.go.html#8196120">derCRLBase64</a></span><span class="op" id="8194295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194298">certList</span><span class="op" id="8194306">,</span>&nbsp;<span class="ident" id="8194308">err</span>&nbsp;<span class="op" id="8194312">:=</span>&nbsp;<span class="ident" id="8194315"><a href="/crypto/x509/x509.go.html#4363898">ParseDERCRL</a></span><span class="op" id="8194326">(</span><span class="ident" id="8194327"><a href="/crypto/x509/x509_test.go.html#8194260">derBytes</a></span><span class="op" id="8194335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194338">if</span>&nbsp;<span class="ident" id="8194341"><a href="/crypto/x509/x509_test.go.html#8194308">err</a></span>&nbsp;<span class="op" id="8194345">!=</span>&nbsp;<span class="ident" id="8194348">nil</span>&nbsp;<span class="op" id="8194352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194356"><a href="/crypto/x509/x509_test.go.html#8194243">t</a></span><span class="op" id="8194357">.</span><span class="ident" id="8194358">Errorf</span><span class="op" id="8194364">(</span><span class="string" id="8194365">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="8194384">,</span>&nbsp;<span class="ident" id="8194386"><a href="/crypto/x509/x509_test.go.html#8194308">err</a></span><span class="op" id="8194389">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194393">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8194401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194404">numCerts</span>&nbsp;<span class="op" id="8194413">:=</span>&nbsp;<span class="builtinfunc" id="8194416">len</span><span class="op" id="8194419">(</span><span class="ident" id="8194420"><a href="/crypto/x509/x509_test.go.html#8194298">certList</a></span><span class="op" id="8194428">.</span><span class="ident" id="8194429">TBSCertList</span><span class="op" id="8194440">.</span><span class="ident" id="8194441">RevokedCertificates</span><span class="op" id="8194460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194463">expected</span>&nbsp;<span class="op" id="8194472">:=</span>&nbsp;<span class="num" id="8194475">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194479">if</span>&nbsp;<span class="ident" id="8194482"><a href="/crypto/x509/x509_test.go.html#8194404">numCerts</a></span>&nbsp;<span class="op" id="8194491">!=</span>&nbsp;<span class="ident" id="8194494"><a href="/crypto/x509/x509_test.go.html#8194463">expected</a></span>&nbsp;<span class="op" id="8194503">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194507"><a href="/crypto/x509/x509_test.go.html#8194243">t</a></span><span class="op" id="8194508">.</span><span class="ident" id="8194509">Errorf</span><span class="op" id="8194515">(</span><span class="string" id="8194516">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="8194570">,</span>&nbsp;<span class="ident" id="8194572"><a href="/crypto/x509/x509_test.go.html#8194404">numCerts</a></span><span class="op" id="8194580">,</span>&nbsp;<span class="ident" id="8194582"><a href="/crypto/x509/x509_test.go.html#8194463">expected</a></span><span class="op" id="8194590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8194593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8194597">if</span>&nbsp;<span class="ident" id="8194600"><a href="/crypto/x509/x509_test.go.html#8194298">certList</a></span><span class="op" id="8194608">.</span><span class="ident" id="8194609">HasExpired</span><span class="op" id="8194619">(</span><span class="ident" id="8194620"><a href="/crypto/x509/x509_test.go.html#8166395">time</a></span><span class="op" id="8194624">.</span><span class="ident" id="8194625">Unix</span><span class="op" id="8194629">(</span><span class="num" id="8194630">1302517272</span><span class="op" id="8194640">,</span>&nbsp;<span class="num" id="8194642">0</span><span class="op" id="8194643">)</span><span class="op" id="8194644">)</span>&nbsp;<span class="op" id="8194646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194650"><a href="/crypto/x509/x509_test.go.html#8194243">t</a></span><span class="op" id="8194651">.</span><span class="ident" id="8194652">Errorf</span><span class="op" id="8194658">(</span><span class="string" id="8194659">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="8194697">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8194700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8194704">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="8194763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="8194766">func</span>&nbsp;<span class="ident" id="8194771">TestCRLWithoutExpiry</span><span class="op" id="8194791">(</span><span class="ident" id="8194792">t</span>&nbsp;<span class="op" id="8194794">*</span><span class="ident" id="8194795"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8194802">.</span><span class="ident" id="8194803">T</span><span class="op" id="8194804">)</span>&nbsp;<span class="op" id="8194806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8194809">derBytes</span>&nbsp;<span class="op" id="8194818">:=</span>&nbsp;<span class="ident" id="8194821"><a href="/crypto/x509/x509_test.go.html#8194002">fromBase64</a></span><span class="op" id="8194831">(</span><span class="string" id="8194832">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="8195126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195129">certList</span><span class="op" id="8195137">,</span>&nbsp;<span class="ident" id="8195139">err</span>&nbsp;<span class="op" id="8195143">:=</span>&nbsp;<span class="ident" id="8195146"><a href="/crypto/x509/x509.go.html#4363898">ParseDERCRL</a></span><span class="op" id="8195157">(</span><span class="ident" id="8195158"><a href="/crypto/x509/x509_test.go.html#8194809">derBytes</a></span><span class="op" id="8195166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195169">if</span>&nbsp;<span class="ident" id="8195172"><a href="/crypto/x509/x509_test.go.html#8195139">err</a></span>&nbsp;<span class="op" id="8195176">!=</span>&nbsp;<span class="ident" id="8195179">nil</span>&nbsp;<span class="op" id="8195183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195187"><a href="/crypto/x509/x509_test.go.html#8194792">t</a></span><span class="op" id="8195188">.</span><span class="ident" id="8195189">Fatal</span><span class="op" id="8195194">(</span><span class="ident" id="8195195"><a href="/crypto/x509/x509_test.go.html#8195139">err</a></span><span class="op" id="8195198">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195204">if</span>&nbsp;<span class="op" id="8195207">!</span><span class="ident" id="8195208"><a href="/crypto/x509/x509_test.go.html#8195129">certList</a></span><span class="op" id="8195216">.</span><span class="ident" id="8195217">TBSCertList</span><span class="op" id="8195228">.</span><span class="ident" id="8195229">NextUpdate</span><span class="op" id="8195239">.</span><span class="ident" id="8195240">IsZero</span><span class="op" id="8195246">(</span><span class="op" id="8195247">)</span>&nbsp;<span class="op" id="8195249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195253"><a href="/crypto/x509/x509_test.go.html#8194792">t</a></span><span class="op" id="8195254">.</span><span class="ident" id="8195255">Errorf</span><span class="op" id="8195261">(</span><span class="string" id="8195262">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="8195296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195299">}</span><br>
<span class="lineno"></span><span class="op" id="8195301">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="8195304">func</span>&nbsp;<span class="ident" id="8195309">TestParsePEMCRL</span><span class="op" id="8195324">(</span><span class="ident" id="8195325">t</span>&nbsp;<span class="op" id="8195327">*</span><span class="ident" id="8195328"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8195335">.</span><span class="ident" id="8195336">T</span><span class="op" id="8195337">)</span>&nbsp;<span class="op" id="8195339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195342">pemBytes</span>&nbsp;<span class="op" id="8195351">:=</span>&nbsp;<span class="ident" id="8195354"><a href="/crypto/x509/x509_test.go.html#8194002">fromBase64</a></span><span class="op" id="8195364">(</span><span class="ident" id="8195365"><a href="/crypto/x509/x509_test.go.html#8200817">pemCRLBase64</a></span><span class="op" id="8195377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195380">certList</span><span class="op" id="8195388">,</span>&nbsp;<span class="ident" id="8195390">err</span>&nbsp;<span class="op" id="8195394">:=</span>&nbsp;<span class="ident" id="8195397"><a href="/crypto/x509/x509.go.html#4363567">ParseCRL</a></span><span class="op" id="8195405">(</span><span class="ident" id="8195406"><a href="/crypto/x509/x509_test.go.html#8195342">pemBytes</a></span><span class="op" id="8195414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195417">if</span>&nbsp;<span class="ident" id="8195420"><a href="/crypto/x509/x509_test.go.html#8195390">err</a></span>&nbsp;<span class="op" id="8195424">!=</span>&nbsp;<span class="ident" id="8195427">nil</span>&nbsp;<span class="op" id="8195431">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195435"><a href="/crypto/x509/x509_test.go.html#8195325">t</a></span><span class="op" id="8195436">.</span><span class="ident" id="8195437">Errorf</span><span class="op" id="8195443">(</span><span class="string" id="8195444">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="8195463">,</span>&nbsp;<span class="ident" id="8195465"><a href="/crypto/x509/x509_test.go.html#8195390">err</a></span><span class="op" id="8195468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195472">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195483">numCerts</span>&nbsp;<span class="op" id="8195492">:=</span>&nbsp;<span class="builtinfunc" id="8195495">len</span><span class="op" id="8195498">(</span><span class="ident" id="8195499"><a href="/crypto/x509/x509_test.go.html#8195380">certList</a></span><span class="op" id="8195507">.</span><span class="ident" id="8195508">TBSCertList</span><span class="op" id="8195519">.</span><span class="ident" id="8195520">RevokedCertificates</span><span class="op" id="8195539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195542">expected</span>&nbsp;<span class="op" id="8195551">:=</span>&nbsp;<span class="num" id="8195554">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195557">if</span>&nbsp;<span class="ident" id="8195560"><a href="/crypto/x509/x509_test.go.html#8195483">numCerts</a></span>&nbsp;<span class="op" id="8195569">!=</span>&nbsp;<span class="ident" id="8195572"><a href="/crypto/x509/x509_test.go.html#8195542">expected</a></span>&nbsp;<span class="op" id="8195581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195585"><a href="/crypto/x509/x509_test.go.html#8195325">t</a></span><span class="op" id="8195586">.</span><span class="ident" id="8195587">Errorf</span><span class="op" id="8195593">(</span><span class="string" id="8195594">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="8195648">,</span>&nbsp;<span class="ident" id="8195650"><a href="/crypto/x509/x509_test.go.html#8195483">numCerts</a></span><span class="op" id="8195658">,</span>&nbsp;<span class="ident" id="8195660"><a href="/crypto/x509/x509_test.go.html#8195542">expected</a></span><span class="op" id="8195668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195675">if</span>&nbsp;<span class="ident" id="8195678"><a href="/crypto/x509/x509_test.go.html#8195380">certList</a></span><span class="op" id="8195686">.</span><span class="ident" id="8195687">HasExpired</span><span class="op" id="8195697">(</span><span class="ident" id="8195698"><a href="/crypto/x509/x509_test.go.html#8166395">time</a></span><span class="op" id="8195702">.</span><span class="ident" id="8195703">Unix</span><span class="op" id="8195707">(</span><span class="num" id="8195708">1302517272</span><span class="op" id="8195718">,</span>&nbsp;<span class="num" id="8195720">0</span><span class="op" id="8195721">)</span><span class="op" id="8195722">)</span>&nbsp;<span class="op" id="8195724">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195728"><a href="/crypto/x509/x509_test.go.html#8195325">t</a></span><span class="op" id="8195729">.</span><span class="ident" id="8195730">Errorf</span><span class="op" id="8195736">(</span><span class="string" id="8195737">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="8195775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8195782">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="8195841">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="8195844">func</span>&nbsp;<span class="ident" id="8195849">TestImports</span><span class="op" id="8195860">(</span><span class="ident" id="8195861">t</span>&nbsp;<span class="op" id="8195863">*</span><span class="ident" id="8195864"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8195871">.</span><span class="ident" id="8195872">T</span><span class="op" id="8195873">)</span>&nbsp;<span class="op" id="8195875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195878">switch</span>&nbsp;<span class="ident" id="8195885"><a href="/crypto/x509/x509_test.go.html#8166373">runtime</a></span><span class="op" id="8195892">.</span><span class="ident" id="8195893">GOOS</span>&nbsp;<span class="op" id="8195898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195901">case</span>&nbsp;<span class="string" id="8195906">&#34;android&#34;</span><span class="op" id="8195915">,</span>&nbsp;<span class="string" id="8195917">&#34;nacl&#34;</span><span class="op" id="8195923">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8195927"><a href="/crypto/x509/x509_test.go.html#8195861">t</a></span><span class="op" id="8195928">.</span><span class="ident" id="8195929">Skipf</span><span class="op" id="8195934">(</span><span class="string" id="8195935">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="8195951">,</span>&nbsp;<span class="ident" id="8195953"><a href="/crypto/x509/x509_test.go.html#8166373">runtime</a></span><span class="op" id="8195960">.</span><span class="ident" id="8195961">GOOS</span><span class="op" id="8195965">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8195968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8195972">if</span>&nbsp;<span class="ident" id="8195975">err</span>&nbsp;<span class="op" id="8195979">:=</span>&nbsp;<span class="ident" id="8195982"><a href="/crypto/x509/x509_test.go.html#8166351">exec</a></span><span class="op" id="8195986">.</span><span class="ident" id="8195987">Command</span><span class="op" id="8195994">(</span><span class="string" id="8195995">&#34;go&#34;</span><span class="op" id="8195999">,</span>&nbsp;<span class="string" id="8196001">&#34;run&#34;</span><span class="op" id="8196006">,</span>&nbsp;<span class="string" id="8196008">&#34;x509_test_import.go&#34;</span><span class="op" id="8196029">)</span><span class="op" id="8196030">.</span><span class="ident" id="8196031">Run</span><span class="op" id="8196034">(</span><span class="op" id="8196035">)</span><span class="op" id="8196036">;</span>&nbsp;<span class="ident" id="8196038"><a href="/crypto/x509/x509_test.go.html#8195975">err</a></span>&nbsp;<span class="op" id="8196042">!=</span>&nbsp;<span class="ident" id="8196045">nil</span>&nbsp;<span class="op" id="8196049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8196053"><a href="/crypto/x509/x509_test.go.html#8195861">t</a></span><span class="op" id="8196054">.</span><span class="ident" id="8196055">Errorf</span><span class="op" id="8196061">(</span><span class="string" id="8196062">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="8196101">,</span>&nbsp;<span class="ident" id="8196103"><a href="/crypto/x509/x509_test.go.html#8195975">err</a></span><span class="op" id="8196106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8196109">}</span><br>
<span class="lineno">750</span><span class="op" id="8196111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8196114">const</span>&nbsp;<span class="ident" id="8196120">derCRLBase64</span>&nbsp;<span class="op" id="8196133">=</span>&nbsp;<span class="string" id="8196135">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8200811">const</span>&nbsp;<span class="ident" id="8200817">pemCRLBase64</span>&nbsp;<span class="op" id="8200830">=</span>&nbsp;<span class="string" id="8200832">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="8201836">func</span>&nbsp;<span class="ident" id="8201841">TestCreateCertificateRequest</span><span class="op" id="8201869">(</span><span class="ident" id="8201870">t</span>&nbsp;<span class="op" id="8201872">*</span><span class="ident" id="8201873"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8201880">.</span><span class="ident" id="8201881">T</span><span class="op" id="8201882">)</span>&nbsp;<span class="op" id="8201884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201887">random</span>&nbsp;<span class="op" id="8201894">:=</span>&nbsp;<span class="ident" id="8201897"><a href="/crypto/x509/x509_test.go.html#8166177">rand</a></span><span class="op" id="8201901">.</span><span class="ident" id="8201902">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201911">block</span><span class="op" id="8201916">,</span>&nbsp;<span class="ident" id="8201918">_</span>&nbsp;<span class="op" id="8201920">:=</span>&nbsp;<span class="ident" id="8201923"><a href="/crypto/x509/x509_test.go.html#8166316">pem</a></span><span class="op" id="8201926">.</span><span class="ident" id="8201927">Decode</span><span class="op" id="8201933">(</span><span class="op" id="8201934">[</span><span class="op" id="8201935">]</span><span class="builtintype" id="8201936">byte</span><span class="op" id="8201940">(</span><span class="ident" id="8201941"><a href="/crypto/x509/x509_test.go.html#8168074">pemPrivateKey</a></span><span class="op" id="8201954">)</span><span class="op" id="8201955">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8201958">rsaPriv</span><span class="op" id="8201965">,</span>&nbsp;<span class="ident" id="8201967">err</span>&nbsp;<span class="op" id="8201971">:=</span>&nbsp;<span class="ident" id="8201974"><a href="/crypto/x509/pkcs1.go.html#4294252">ParsePKCS1PrivateKey</a></span><span class="op" id="8201994">(</span><span class="ident" id="8201995"><a href="/crypto/x509/x509_test.go.html#8201911">block</a></span><span class="op" id="8202000">.</span><span class="ident" id="8202001">Bytes</span><span class="op" id="8202006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202009">if</span>&nbsp;<span class="ident" id="8202012"><a href="/crypto/x509/x509_test.go.html#8201967">err</a></span>&nbsp;<span class="op" id="8202016">!=</span>&nbsp;<span class="ident" id="8202019">nil</span>&nbsp;<span class="op" id="8202023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202027"><a href="/crypto/x509/x509_test.go.html#8201870">t</a></span><span class="op" id="8202028">.</span><span class="ident" id="8202029">Fatalf</span><span class="op" id="8202035">(</span><span class="string" id="8202036">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8202069">,</span>&nbsp;<span class="ident" id="8202071"><a href="/crypto/x509/x509_test.go.html#8201967">err</a></span><span class="op" id="8202074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202081">ecdsa256Priv</span><span class="op" id="8202093">,</span>&nbsp;<span class="ident" id="8202095"><a href="/crypto/x509/x509_test.go.html#8201967">err</a></span>&nbsp;<span class="op" id="8202099">:=</span>&nbsp;<span class="ident" id="8202102"><a href="/crypto/x509/x509_test.go.html#8166142">ecdsa</a></span><span class="op" id="8202107">.</span><span class="ident" id="8202108">GenerateKey</span><span class="op" id="8202119">(</span><span class="ident" id="8202120"><a href="/crypto/x509/x509_test.go.html#8166158">elliptic</a></span><span class="op" id="8202128">.</span><span class="ident" id="8202129">P256</span><span class="op" id="8202133">(</span><span class="op" id="8202134">)</span><span class="op" id="8202135">,</span>&nbsp;<span class="ident" id="8202137"><a href="/crypto/x509/x509_test.go.html#8166177">rand</a></span><span class="op" id="8202141">.</span><span class="ident" id="8202142">Reader</span><span class="op" id="8202148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202151">if</span>&nbsp;<span class="ident" id="8202154"><a href="/crypto/x509/x509_test.go.html#8201967">err</a></span>&nbsp;<span class="op" id="8202158">!=</span>&nbsp;<span class="ident" id="8202161">nil</span>&nbsp;<span class="op" id="8202165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202169"><a href="/crypto/x509/x509_test.go.html#8201870">t</a></span><span class="op" id="8202170">.</span><span class="ident" id="8202171">Fatalf</span><span class="op" id="8202177">(</span><span class="string" id="8202178">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8202212">,</span>&nbsp;<span class="ident" id="8202214"><a href="/crypto/x509/x509_test.go.html#8201967">err</a></span><span class="op" id="8202217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202224">ecdsa384Priv</span><span class="op" id="8202236">,</span>&nbsp;<span class="ident" id="8202238"><a href="/crypto/x509/x509_test.go.html#8201967">err</a></span>&nbsp;<span class="op" id="8202242">:=</span>&nbsp;<span class="ident" id="8202245"><a href="/crypto/x509/x509_test.go.html#8166142">ecdsa</a></span><span class="op" id="8202250">.</span><span class="ident" id="8202251">GenerateKey</span><span class="op" id="8202262">(</span><span class="ident" id="8202263"><a href="/crypto/x509/x509_test.go.html#8166158">elliptic</a></span><span class="op" id="8202271">.</span><span class="ident" id="8202272">P384</span><span class="op" id="8202276">(</span><span class="op" id="8202277">)</span><span class="op" id="8202278">,</span>&nbsp;<span class="ident" id="8202280"><a href="/crypto/x509/x509_test.go.html#8166177">rand</a></span><span class="op" id="8202284">.</span><span class="ident" id="8202285">Reader</span><span class="op" id="8202291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202294">if</span>&nbsp;<span class="ident" id="8202297"><a href="/crypto/x509/x509_test.go.html#8201967">err</a></span>&nbsp;<span class="op" id="8202301">!=</span>&nbsp;<span class="ident" id="8202304">nil</span>&nbsp;<span class="op" id="8202308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202312"><a href="/crypto/x509/x509_test.go.html#8201870">t</a></span><span class="op" id="8202313">.</span><span class="ident" id="8202314">Fatalf</span><span class="op" id="8202320">(</span><span class="string" id="8202321">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8202355">,</span>&nbsp;<span class="ident" id="8202357"><a href="/crypto/x509/x509_test.go.html#8201967">err</a></span><span class="op" id="8202360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202367">ecdsa521Priv</span><span class="op" id="8202379">,</span>&nbsp;<span class="ident" id="8202381"><a href="/crypto/x509/x509_test.go.html#8201967">err</a></span>&nbsp;<span class="op" id="8202385">:=</span>&nbsp;<span class="ident" id="8202388"><a href="/crypto/x509/x509_test.go.html#8166142">ecdsa</a></span><span class="op" id="8202393">.</span><span class="ident" id="8202394">GenerateKey</span><span class="op" id="8202405">(</span><span class="ident" id="8202406"><a href="/crypto/x509/x509_test.go.html#8166158">elliptic</a></span><span class="op" id="8202414">.</span><span class="ident" id="8202415">P521</span><span class="op" id="8202419">(</span><span class="op" id="8202420">)</span><span class="op" id="8202421">,</span>&nbsp;<span class="ident" id="8202423"><a href="/crypto/x509/x509_test.go.html#8166177">rand</a></span><span class="op" id="8202427">.</span><span class="ident" id="8202428">Reader</span><span class="op" id="8202434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202437">if</span>&nbsp;<span class="ident" id="8202440"><a href="/crypto/x509/x509_test.go.html#8201967">err</a></span>&nbsp;<span class="op" id="8202444">!=</span>&nbsp;<span class="ident" id="8202447">nil</span>&nbsp;<span class="op" id="8202451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202455"><a href="/crypto/x509/x509_test.go.html#8201870">t</a></span><span class="op" id="8202456">.</span><span class="ident" id="8202457">Fatalf</span><span class="op" id="8202463">(</span><span class="string" id="8202464">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8202498">,</span>&nbsp;<span class="ident" id="8202500"><a href="/crypto/x509/x509_test.go.html#8201967">err</a></span><span class="op" id="8202503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202510">tests</span>&nbsp;<span class="op" id="8202516">:=</span>&nbsp;<span class="op" id="8202519">[</span><span class="op" id="8202520">]</span><span class="keyword" id="8202521">struct</span>&nbsp;<span class="op" id="8202528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202532">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8202540">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202549">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8202557">interface</span><span class="op" id="8202566">{</span><span class="op" id="8202567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202571">sigAlgo</span>&nbsp;<span class="ident" id="8202579"><a href="/crypto/x509/x509.go.html#4320325">SignatureAlgorithm</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202599">}</span><span class="op" id="8202600">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202604">{</span><span class="string" id="8202605">&#34;RSA&#34;</span><span class="op" id="8202610">,</span>&nbsp;<span class="ident" id="8202612"><a href="/crypto/x509/x509_test.go.html#8201958">rsaPriv</a></span><span class="op" id="8202619">,</span>&nbsp;<span class="ident" id="8202621"><a href="/crypto/x509/x509.go.html#4320435">SHA1WithRSA</a></span><span class="op" id="8202632">}</span><span class="op" id="8202633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202637">{</span><span class="string" id="8202638">&#34;ECDSA-256&#34;</span><span class="op" id="8202649">,</span>&nbsp;<span class="ident" id="8202651"><a href="/crypto/x509/x509_test.go.html#8202081">ecdsa256Priv</a></span><span class="op" id="8202663">,</span>&nbsp;<span class="ident" id="8202665"><a href="/crypto/x509/x509.go.html#4320521">ECDSAWithSHA1</a></span><span class="op" id="8202678">}</span><span class="op" id="8202679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202683">{</span><span class="string" id="8202684">&#34;ECDSA-384&#34;</span><span class="op" id="8202695">,</span>&nbsp;<span class="ident" id="8202697"><a href="/crypto/x509/x509_test.go.html#8202224">ecdsa384Priv</a></span><span class="op" id="8202709">,</span>&nbsp;<span class="ident" id="8202711"><a href="/crypto/x509/x509.go.html#4320521">ECDSAWithSHA1</a></span><span class="op" id="8202724">}</span><span class="op" id="8202725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202729">{</span><span class="string" id="8202730">&#34;ECDSA-521&#34;</span><span class="op" id="8202741">,</span>&nbsp;<span class="ident" id="8202743"><a href="/crypto/x509/x509_test.go.html#8202367">ecdsa521Priv</a></span><span class="op" id="8202755">,</span>&nbsp;<span class="ident" id="8202757"><a href="/crypto/x509/x509.go.html#4320521">ECDSAWithSHA1</a></span><span class="op" id="8202770">}</span><span class="op" id="8202771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202774">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8202778">for</span>&nbsp;<span class="ident" id="8202782">_</span><span class="op" id="8202783">,</span>&nbsp;<span class="ident" id="8202785">test</span>&nbsp;<span class="op" id="8202790">:=</span>&nbsp;<span class="keyword" id="8202793">range</span>&nbsp;<span class="ident" id="8202799"><a href="/crypto/x509/x509_test.go.html#8202510">tests</a></span>&nbsp;<span class="op" id="8202805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202809">template</span>&nbsp;<span class="op" id="8202818">:=</span>&nbsp;<span class="ident" id="8202821"><a href="/crypto/x509/x509.go.html#4365470">CertificateRequest</a></span><span class="op" id="8202839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202844">Subject</span><span class="op" id="8202851">:</span>&nbsp;<span class="ident" id="8202853"><a href="/crypto/x509/x509_test.go.html#8166244">pkix</a></span><span class="op" id="8202857">.</span><span class="ident" id="8202858">Name</span><span class="op" id="8202862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202868">CommonName</span><span class="op" id="8202878">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8202882">&#34;test.example.com&#34;</span><span class="op" id="8202900">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202906">Organization</span><span class="op" id="8202918">:</span>&nbsp;<span class="op" id="8202920">[</span><span class="op" id="8202921">]</span><span class="builtintype" id="8202922">string</span><span class="op" id="8202928">{</span><span class="string" id="8202929">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8202941">}</span><span class="op" id="8202942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8202947">}</span><span class="op" id="8202948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202953">SignatureAlgorithm</span><span class="op" id="8202971">:</span>&nbsp;<span class="ident" id="8202973"><a href="/crypto/x509/x509_test.go.html#8202785">test</a></span><span class="op" id="8202977">.</span><span class="ident" id="8202978">sigAlgo</span><span class="op" id="8202985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8202990">DNSNames</span><span class="op" id="8202998">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8203010">[</span><span class="op" id="8203011">]</span><span class="builtintype" id="8203012">string</span><span class="op" id="8203018">{</span><span class="string" id="8203019">&#34;test.example.com&#34;</span><span class="op" id="8203037">}</span><span class="op" id="8203038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203043">EmailAddresses</span><span class="op" id="8203057">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8203063">[</span><span class="op" id="8203064">]</span><span class="builtintype" id="8203065">string</span><span class="op" id="8203071">{</span><span class="string" id="8203072">&#34;gopher@golang.org&#34;</span><span class="op" id="8203091">}</span><span class="op" id="8203092">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203097">IPAddresses</span><span class="op" id="8203108">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8203117">[</span><span class="op" id="8203118">]</span><span class="ident" id="8203119"><a href="/crypto/x509/x509_test.go.html#8166344">net</a></span><span class="op" id="8203122">.</span><span class="ident" id="8203123">IP</span><span class="op" id="8203125">{</span><span class="ident" id="8203126"><a href="/crypto/x509/x509_test.go.html#8166344">net</a></span><span class="op" id="8203129">.</span><span class="ident" id="8203130">IPv4</span><span class="op" id="8203134">(</span><span class="num" id="8203135">127</span><span class="op" id="8203138">,</span>&nbsp;<span class="num" id="8203140">0</span><span class="op" id="8203141">,</span>&nbsp;<span class="num" id="8203143">0</span><span class="op" id="8203144">,</span>&nbsp;<span class="num" id="8203146">1</span><span class="op" id="8203147">)</span><span class="op" id="8203148">.</span><span class="ident" id="8203149">To4</span><span class="op" id="8203152">(</span><span class="op" id="8203153">)</span><span class="op" id="8203154">,</span>&nbsp;<span class="ident" id="8203156"><a href="/crypto/x509/x509_test.go.html#8166344">net</a></span><span class="op" id="8203159">.</span><span class="ident" id="8203160">ParseIP</span><span class="op" id="8203167">(</span><span class="string" id="8203168">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="8203190">)</span><span class="op" id="8203191">}</span><span class="op" id="8203192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8203196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203201">derBytes</span><span class="op" id="8203209">,</span>&nbsp;<span class="ident" id="8203211">err</span>&nbsp;<span class="op" id="8203215">:=</span>&nbsp;<span class="ident" id="8203218"><a href="/crypto/x509/x509.go.html#4367984">CreateCertificateRequest</a></span><span class="op" id="8203242">(</span><span class="ident" id="8203243"><a href="/crypto/x509/x509_test.go.html#8201887">random</a></span><span class="op" id="8203249">,</span>&nbsp;<span class="op" id="8203251">&amp;</span><span class="ident" id="8203252"><a href="/crypto/x509/x509_test.go.html#8202809">template</a></span><span class="op" id="8203260">,</span>&nbsp;<span class="ident" id="8203262"><a href="/crypto/x509/x509_test.go.html#8202785">test</a></span><span class="op" id="8203266">.</span><span class="ident" id="8203267">priv</span><span class="op" id="8203271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203275">if</span>&nbsp;<span class="ident" id="8203278"><a href="/crypto/x509/x509_test.go.html#8203211">err</a></span>&nbsp;<span class="op" id="8203282">!=</span>&nbsp;<span class="ident" id="8203285">nil</span>&nbsp;<span class="op" id="8203289">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203294"><a href="/crypto/x509/x509_test.go.html#8201870">t</a></span><span class="op" id="8203295">.</span><span class="ident" id="8203296">Errorf</span><span class="op" id="8203302">(</span><span class="string" id="8203303">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="8203349">,</span>&nbsp;<span class="ident" id="8203351"><a href="/crypto/x509/x509_test.go.html#8202785">test</a></span><span class="op" id="8203355">.</span><span class="ident" id="8203356">name</span><span class="op" id="8203360">,</span>&nbsp;<span class="ident" id="8203362"><a href="/crypto/x509/x509_test.go.html#8203211">err</a></span><span class="op" id="8203365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203370">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8203381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203386">out</span><span class="op" id="8203389">,</span>&nbsp;<span class="ident" id="8203391"><a href="/crypto/x509/x509_test.go.html#8203211">err</a></span>&nbsp;<span class="op" id="8203395">:=</span>&nbsp;<span class="ident" id="8203398"><a href="/crypto/x509/x509.go.html#4371996">ParseCertificateRequest</a></span><span class="op" id="8203421">(</span><span class="ident" id="8203422"><a href="/crypto/x509/x509_test.go.html#8203201">derBytes</a></span><span class="op" id="8203430">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203434">if</span>&nbsp;<span class="ident" id="8203437"><a href="/crypto/x509/x509_test.go.html#8203211">err</a></span>&nbsp;<span class="op" id="8203441">!=</span>&nbsp;<span class="ident" id="8203444">nil</span>&nbsp;<span class="op" id="8203448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203453"><a href="/crypto/x509/x509_test.go.html#8201870">t</a></span><span class="op" id="8203454">.</span><span class="ident" id="8203455">Errorf</span><span class="op" id="8203461">(</span><span class="string" id="8203462">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="8203508">,</span>&nbsp;<span class="ident" id="8203510"><a href="/crypto/x509/x509_test.go.html#8202785">test</a></span><span class="op" id="8203514">.</span><span class="ident" id="8203515">name</span><span class="op" id="8203519">,</span>&nbsp;<span class="ident" id="8203521"><a href="/crypto/x509/x509_test.go.html#8203211">err</a></span><span class="op" id="8203524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203529">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8203540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8203545">if</span>&nbsp;<span class="ident" id="8203548"><a href="/crypto/x509/x509_test.go.html#8203386">out</a></span><span class="op" id="8203551">.</span><span class="ident" id="8203552">Subject</span><span class="op" id="8203559">.</span><span class="ident" id="8203560">CommonName</span>&nbsp;<span class="op" id="8203571">!=</span>&nbsp;<span class="ident" id="8203574"><a href="/crypto/x509/x509_test.go.html#8202809">template</a></span><span class="op" id="8203582">.</span><span class="ident" id="8203583">Subject</span><span class="op" id="8203590">.</span><span class="ident" id="8203591">CommonName</span>&nbsp;<span class="op" id="8203602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203607"><a href="/crypto/x509/x509_test.go.html#8201870">t</a></span><span class="op" id="8203608">.</span><span class="ident" id="8203609">Errorf</span><span class="op" id="8203615">(</span><span class="string" id="8203616">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8203693">,</span>&nbsp;<span class="ident" id="8203695"><a href="/crypto/x509/x509_test.go.html#8202785">test</a></span><span class="op" id="8203699">.</span><span class="ident" id="8203700">name</span><span class="op" id="8203704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8203708">}</span>&nbsp;<span class="keyword" id="8203710">else</span>&nbsp;<span class="keyword" id="8203715">if</span>&nbsp;<span class="builtinfunc" id="8203718">len</span><span class="op" id="8203721">(</span><span class="ident" id="8203722"><a href="/crypto/x509/x509_test.go.html#8203386">out</a></span><span class="op" id="8203725">.</span><span class="ident" id="8203726">Subject</span><span class="op" id="8203733">.</span><span class="ident" id="8203734">Organization</span><span class="op" id="8203746">)</span>&nbsp;<span class="op" id="8203748">!=</span>&nbsp;<span class="builtinfunc" id="8203751">len</span><span class="op" id="8203754">(</span><span class="ident" id="8203755"><a href="/crypto/x509/x509_test.go.html#8202809">template</a></span><span class="op" id="8203763">.</span><span class="ident" id="8203764">Subject</span><span class="op" id="8203771">.</span><span class="ident" id="8203772">Organization</span><span class="op" id="8203784">)</span>&nbsp;<span class="op" id="8203786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203791"><a href="/crypto/x509/x509_test.go.html#8201870">t</a></span><span class="op" id="8203792">.</span><span class="ident" id="8203793">Errorf</span><span class="op" id="8203799">(</span><span class="string" id="8203800">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8203879">,</span>&nbsp;<span class="ident" id="8203881"><a href="/crypto/x509/x509_test.go.html#8202785">test</a></span><span class="op" id="8203885">.</span><span class="ident" id="8203886">name</span><span class="op" id="8203890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8203894">}</span>&nbsp;<span class="keyword" id="8203896">else</span>&nbsp;<span class="keyword" id="8203901">if</span>&nbsp;<span class="builtinfunc" id="8203904">len</span><span class="op" id="8203907">(</span><span class="ident" id="8203908"><a href="/crypto/x509/x509_test.go.html#8203386">out</a></span><span class="op" id="8203911">.</span><span class="ident" id="8203912">DNSNames</span><span class="op" id="8203920">)</span>&nbsp;<span class="op" id="8203922">!=</span>&nbsp;<span class="builtinfunc" id="8203925">len</span><span class="op" id="8203928">(</span><span class="ident" id="8203929"><a href="/crypto/x509/x509_test.go.html#8202809">template</a></span><span class="op" id="8203937">.</span><span class="ident" id="8203938">DNSNames</span><span class="op" id="8203946">)</span>&nbsp;<span class="op" id="8203948">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8203953"><a href="/crypto/x509/x509_test.go.html#8201870">t</a></span><span class="op" id="8203954">.</span><span class="ident" id="8203955">Errorf</span><span class="op" id="8203961">(</span><span class="string" id="8203962">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8204019">,</span>&nbsp;<span class="ident" id="8204021"><a href="/crypto/x509/x509_test.go.html#8202785">test</a></span><span class="op" id="8204025">.</span><span class="ident" id="8204026">name</span><span class="op" id="8204030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204034">}</span>&nbsp;<span class="keyword" id="8204036">else</span>&nbsp;<span class="keyword" id="8204041">if</span>&nbsp;<span class="builtinfunc" id="8204044">len</span><span class="op" id="8204047">(</span><span class="ident" id="8204048"><a href="/crypto/x509/x509_test.go.html#8203386">out</a></span><span class="op" id="8204051">.</span><span class="ident" id="8204052">EmailAddresses</span><span class="op" id="8204066">)</span>&nbsp;<span class="op" id="8204068">!=</span>&nbsp;<span class="builtinfunc" id="8204071">len</span><span class="op" id="8204074">(</span><span class="ident" id="8204075"><a href="/crypto/x509/x509_test.go.html#8202809">template</a></span><span class="op" id="8204083">.</span><span class="ident" id="8204084">EmailAddresses</span><span class="op" id="8204098">)</span>&nbsp;<span class="op" id="8204100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204105"><a href="/crypto/x509/x509_test.go.html#8201870">t</a></span><span class="op" id="8204106">.</span><span class="ident" id="8204107">Errorf</span><span class="op" id="8204113">(</span><span class="string" id="8204114">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8204183">,</span>&nbsp;<span class="ident" id="8204185"><a href="/crypto/x509/x509_test.go.html#8202785">test</a></span><span class="op" id="8204189">.</span><span class="ident" id="8204190">name</span><span class="op" id="8204194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204198">}</span>&nbsp;<span class="keyword" id="8204200">else</span>&nbsp;<span class="keyword" id="8204205">if</span>&nbsp;<span class="builtinfunc" id="8204208">len</span><span class="op" id="8204211">(</span><span class="ident" id="8204212"><a href="/crypto/x509/x509_test.go.html#8203386">out</a></span><span class="op" id="8204215">.</span><span class="ident" id="8204216">IPAddresses</span><span class="op" id="8204227">)</span>&nbsp;<span class="op" id="8204229">!=</span>&nbsp;<span class="builtinfunc" id="8204232">len</span><span class="op" id="8204235">(</span><span class="ident" id="8204236"><a href="/crypto/x509/x509_test.go.html#8202809">template</a></span><span class="op" id="8204244">.</span><span class="ident" id="8204245">IPAddresses</span><span class="op" id="8204256">)</span>&nbsp;<span class="op" id="8204258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204263"><a href="/crypto/x509/x509_test.go.html#8201870">t</a></span><span class="op" id="8204264">.</span><span class="ident" id="8204265">Errorf</span><span class="op" id="8204271">(</span><span class="string" id="8204272">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="8204341">,</span>&nbsp;<span class="ident" id="8204343"><a href="/crypto/x509/x509_test.go.html#8202785">test</a></span><span class="op" id="8204347">.</span><span class="ident" id="8204348">name</span><span class="op" id="8204352">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204359">}</span><br>
<span class="lineno"></span><span class="op" id="8204361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8204364">func</span>&nbsp;<span class="ident" id="8204369">marshalAndParseCSR</span><span class="op" id="8204387">(</span><span class="ident" id="8204388">t</span>&nbsp;<span class="op" id="8204390">*</span><span class="ident" id="8204391"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8204398">.</span><span class="ident" id="8204399">T</span><span class="op" id="8204400">,</span>&nbsp;<span class="ident" id="8204402">template</span>&nbsp;<span class="op" id="8204411">*</span><span class="ident" id="8204412"><a href="/crypto/x509/x509.go.html#4365470">CertificateRequest</a></span><span class="op" id="8204430">)</span>&nbsp;<span class="op" id="8204432">*</span><span class="ident" id="8204433"><a href="/crypto/x509/x509.go.html#4365470">CertificateRequest</a></span>&nbsp;<span class="op" id="8204452">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204455">block</span><span class="op" id="8204460">,</span>&nbsp;<span class="ident" id="8204462">_</span>&nbsp;<span class="op" id="8204464">:=</span>&nbsp;<span class="ident" id="8204467"><a href="/crypto/x509/x509_test.go.html#8166316">pem</a></span><span class="op" id="8204470">.</span><span class="ident" id="8204471">Decode</span><span class="op" id="8204477">(</span><span class="op" id="8204478">[</span><span class="op" id="8204479">]</span><span class="builtintype" id="8204480">byte</span><span class="op" id="8204484">(</span><span class="ident" id="8204485"><a href="/crypto/x509/x509_test.go.html#8168074">pemPrivateKey</a></span><span class="op" id="8204498">)</span><span class="op" id="8204499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204502">rsaPriv</span><span class="op" id="8204509">,</span>&nbsp;<span class="ident" id="8204511">err</span>&nbsp;<span class="op" id="8204515">:=</span>&nbsp;<span class="ident" id="8204518"><a href="/crypto/x509/pkcs1.go.html#4294252">ParsePKCS1PrivateKey</a></span><span class="op" id="8204538">(</span><span class="ident" id="8204539"><a href="/crypto/x509/x509_test.go.html#8204455">block</a></span><span class="op" id="8204544">.</span><span class="ident" id="8204545">Bytes</span><span class="op" id="8204550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204553">if</span>&nbsp;<span class="ident" id="8204556"><a href="/crypto/x509/x509_test.go.html#8204511">err</a></span>&nbsp;<span class="op" id="8204560">!=</span>&nbsp;<span class="ident" id="8204563">nil</span>&nbsp;<span class="op" id="8204567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204571"><a href="/crypto/x509/x509_test.go.html#8204388">t</a></span><span class="op" id="8204572">.</span><span class="ident" id="8204573">Fatal</span><span class="op" id="8204578">(</span><span class="ident" id="8204579"><a href="/crypto/x509/x509_test.go.html#8204511">err</a></span><span class="op" id="8204582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204585">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204589">derBytes</span><span class="op" id="8204597">,</span>&nbsp;<span class="ident" id="8204599"><a href="/crypto/x509/x509_test.go.html#8204511">err</a></span>&nbsp;<span class="op" id="8204603">:=</span>&nbsp;<span class="ident" id="8204606"><a href="/crypto/x509/x509.go.html#4367984">CreateCertificateRequest</a></span><span class="op" id="8204630">(</span><span class="ident" id="8204631"><a href="/crypto/x509/x509_test.go.html#8166177">rand</a></span><span class="op" id="8204635">.</span><span class="ident" id="8204636">Reader</span><span class="op" id="8204642">,</span>&nbsp;<span class="ident" id="8204644"><a href="/crypto/x509/x509_test.go.html#8204402">template</a></span><span class="op" id="8204652">,</span>&nbsp;<span class="ident" id="8204654"><a href="/crypto/x509/x509_test.go.html#8204502">rsaPriv</a></span><span class="op" id="8204661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204664">if</span>&nbsp;<span class="ident" id="8204667"><a href="/crypto/x509/x509_test.go.html#8204511">err</a></span>&nbsp;<span class="op" id="8204671">!=</span>&nbsp;<span class="ident" id="8204674">nil</span>&nbsp;<span class="op" id="8204678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204682"><a href="/crypto/x509/x509_test.go.html#8204388">t</a></span><span class="op" id="8204683">.</span><span class="ident" id="8204684">Fatal</span><span class="op" id="8204689">(</span><span class="ident" id="8204690"><a href="/crypto/x509/x509_test.go.html#8204511">err</a></span><span class="op" id="8204693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204696">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204700">csr</span><span class="op" id="8204703">,</span>&nbsp;<span class="ident" id="8204705"><a href="/crypto/x509/x509_test.go.html#8204511">err</a></span>&nbsp;<span class="op" id="8204709">:=</span>&nbsp;<span class="ident" id="8204712"><a href="/crypto/x509/x509.go.html#4371996">ParseCertificateRequest</a></span><span class="op" id="8204735">(</span><span class="ident" id="8204736"><a href="/crypto/x509/x509_test.go.html#8204589">derBytes</a></span><span class="op" id="8204744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204747">if</span>&nbsp;<span class="ident" id="8204750"><a href="/crypto/x509/x509_test.go.html#8204511">err</a></span>&nbsp;<span class="op" id="8204754">!=</span>&nbsp;<span class="ident" id="8204757">nil</span>&nbsp;<span class="op" id="8204761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204765"><a href="/crypto/x509/x509_test.go.html#8204388">t</a></span><span class="op" id="8204766">.</span><span class="ident" id="8204767">Fatal</span><span class="op" id="8204772">(</span><span class="ident" id="8204773"><a href="/crypto/x509/x509_test.go.html#8204511">err</a></span><span class="op" id="8204776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204779">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204783">return</span>&nbsp;<span class="ident" id="8204790"><a href="/crypto/x509/x509_test.go.html#8204700">csr</a></span><br>
<span class="lineno"></span><span class="op" id="8204794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8204797">func</span>&nbsp;<span class="ident" id="8204802">TestCertificateRequestOverrides</span><span class="op" id="8204833">(</span><span class="ident" id="8204834">t</span>&nbsp;<span class="op" id="8204836">*</span><span class="ident" id="8204837"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8204844">.</span><span class="ident" id="8204845">T</span><span class="op" id="8204846">)</span>&nbsp;<span class="op" id="8204848">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204851">sanContents</span><span class="op" id="8204862">,</span>&nbsp;<span class="ident" id="8204864">err</span>&nbsp;<span class="op" id="8204868">:=</span>&nbsp;<span class="ident" id="8204871"><a href="/crypto/x509/x509.go.html#4352695">marshalSANs</a></span><span class="op" id="8204882">(</span><span class="op" id="8204883">[</span><span class="op" id="8204884">]</span><span class="builtintype" id="8204885">string</span><span class="op" id="8204891">{</span><span class="string" id="8204892">&#34;foo.example.com&#34;</span><span class="op" id="8204909">}</span><span class="op" id="8204910">,</span>&nbsp;<span class="ident" id="8204912">nil</span><span class="op" id="8204915">,</span>&nbsp;<span class="ident" id="8204917">nil</span><span class="op" id="8204920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8204923">if</span>&nbsp;<span class="ident" id="8204926"><a href="/crypto/x509/x509_test.go.html#8204864">err</a></span>&nbsp;<span class="op" id="8204930">!=</span>&nbsp;<span class="ident" id="8204933">nil</span>&nbsp;<span class="op" id="8204937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204941"><a href="/crypto/x509/x509_test.go.html#8204834">t</a></span><span class="op" id="8204942">.</span><span class="ident" id="8204943">Fatal</span><span class="op" id="8204948">(</span><span class="ident" id="8204949"><a href="/crypto/x509/x509_test.go.html#8204864">err</a></span><span class="op" id="8204952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8204955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204959">template</span>&nbsp;<span class="op" id="8204968">:=</span>&nbsp;<span class="ident" id="8204971"><a href="/crypto/x509/x509.go.html#4365470">CertificateRequest</a></span><span class="op" id="8204989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8204993">Subject</span><span class="op" id="8205000">:</span>&nbsp;<span class="ident" id="8205002"><a href="/crypto/x509/x509_test.go.html#8166244">pkix</a></span><span class="op" id="8205006">.</span><span class="ident" id="8205007">Name</span><span class="op" id="8205011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205016">CommonName</span><span class="op" id="8205026">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8205030">&#34;test.example.com&#34;</span><span class="op" id="8205048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205053">Organization</span><span class="op" id="8205065">:</span>&nbsp;<span class="op" id="8205067">[</span><span class="op" id="8205068">]</span><span class="builtintype" id="8205069">string</span><span class="op" id="8205075">{</span><span class="string" id="8205076">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8205088">}</span><span class="op" id="8205089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205093">}</span><span class="op" id="8205094">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205098">DNSNames</span><span class="op" id="8205106">:</span>&nbsp;<span class="op" id="8205108">[</span><span class="op" id="8205109">]</span><span class="builtintype" id="8205110">string</span><span class="op" id="8205116">{</span><span class="string" id="8205117">&#34;test.example.com&#34;</span><span class="op" id="8205135">}</span><span class="op" id="8205136">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8205141">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8205206">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205221">ExtraExtensions</span><span class="op" id="8205236">:</span>&nbsp;<span class="op" id="8205238">[</span><span class="op" id="8205239">]</span><span class="ident" id="8205240"><a href="/crypto/x509/x509_test.go.html#8166244">pkix</a></span><span class="op" id="8205244">.</span><span class="ident" id="8205245">Extension</span><span class="op" id="8205254">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205265">Id</span><span class="op" id="8205267">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8205272"><a href="/crypto/x509/x509.go.html#4351829">oidExtensionSubjectAltName</a></span><span class="op" id="8205298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205304">Value</span><span class="op" id="8205309">:</span>&nbsp;<span class="ident" id="8205311"><a href="/crypto/x509/x509_test.go.html#8204851">sanContents</a></span><span class="op" id="8205322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205327">}</span><span class="op" id="8205328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205332">}</span><span class="op" id="8205333">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205340">csr</span>&nbsp;<span class="op" id="8205344">:=</span>&nbsp;<span class="ident" id="8205347"><a href="/crypto/x509/x509_test.go.html#8204369">marshalAndParseCSR</a></span><span class="op" id="8205365">(</span><span class="ident" id="8205366"><a href="/crypto/x509/x509_test.go.html#8204834">t</a></span><span class="op" id="8205367">,</span>&nbsp;<span class="op" id="8205369">&amp;</span><span class="ident" id="8205370"><a href="/crypto/x509/x509_test.go.html#8204959">template</a></span><span class="op" id="8205378">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8205382">if</span>&nbsp;<span class="builtinfunc" id="8205385">len</span><span class="op" id="8205388">(</span><span class="ident" id="8205389"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span><span class="op" id="8205392">.</span><span class="ident" id="8205393">DNSNames</span><span class="op" id="8205401">)</span>&nbsp;<span class="op" id="8205403">!=</span>&nbsp;<span class="num" id="8205406">1</span>&nbsp;<span class="op" id="8205408">||</span>&nbsp;<span class="ident" id="8205411"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span><span class="op" id="8205414">.</span><span class="ident" id="8205415">DNSNames</span><span class="op" id="8205423">[</span><span class="num" id="8205424">0</span><span class="op" id="8205425">]</span>&nbsp;<span class="op" id="8205427">!=</span>&nbsp;<span class="string" id="8205430">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="8205448">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205452"><a href="/crypto/x509/x509_test.go.html#8204834">t</a></span><span class="op" id="8205453">.</span><span class="ident" id="8205454">Errorf</span><span class="op" id="8205460">(</span><span class="string" id="8205461">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="8205508">,</span>&nbsp;<span class="ident" id="8205510"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span><span class="op" id="8205513">.</span><span class="ident" id="8205514">DNSNames</span><span class="op" id="8205522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8205529">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8205597">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8205667">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205703"><a href="/crypto/x509/x509_test.go.html#8204959">template</a></span><span class="op" id="8205711">.</span><span class="ident" id="8205712">Attributes</span>&nbsp;<span class="op" id="8205723">=</span>&nbsp;<span class="op" id="8205725">[</span><span class="op" id="8205726">]</span><span class="ident" id="8205727"><a href="/crypto/x509/x509_test.go.html#8166244">pkix</a></span><span class="op" id="8205731">.</span><span class="ident" id="8205732">AttributeTypeAndValueSET</span><span class="op" id="8205756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205765">Type</span><span class="op" id="8205769">:</span>&nbsp;<span class="ident" id="8205771"><a href="/crypto/x509/x509.go.html#4367467">oidExtensionRequest</a></span><span class="op" id="8205790">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205795">Value</span><span class="op" id="8205800">:</span>&nbsp;<span class="op" id="8205802">[</span><span class="op" id="8205803">]</span><span class="op" id="8205804">[</span><span class="op" id="8205805">]</span><span class="ident" id="8205806"><a href="/crypto/x509/x509_test.go.html#8166244">pkix</a></span><span class="op" id="8205810">.</span><span class="ident" id="8205811">AttributeTypeAndValue</span><span class="op" id="8205832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205853">Type</span><span class="op" id="8205857">:</span>&nbsp;&nbsp;<span class="ident" id="8205860"><a href="/crypto/x509/x509.go.html#4352057">oidExtensionAuthorityInfoAccess</a></span><span class="op" id="8205891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205899">Value</span><span class="op" id="8205904">:</span>&nbsp;<span class="op" id="8205906">[</span><span class="op" id="8205907">]</span><span class="builtintype" id="8205908">byte</span><span class="op" id="8205912">(</span><span class="string" id="8205913">&#34;foo&#34;</span><span class="op" id="8205918">)</span><span class="op" id="8205919">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205926">}</span><span class="op" id="8205927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205933">}</span><span class="op" id="8205934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205939">}</span><span class="op" id="8205940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205944">}</span><span class="op" id="8205945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8205948">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8205952"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span>&nbsp;<span class="op" id="8205956">=</span>&nbsp;<span class="ident" id="8205958"><a href="/crypto/x509/x509_test.go.html#8204369">marshalAndParseCSR</a></span><span class="op" id="8205976">(</span><span class="ident" id="8205977"><a href="/crypto/x509/x509_test.go.html#8204834">t</a></span><span class="op" id="8205978">,</span>&nbsp;<span class="op" id="8205980">&amp;</span><span class="ident" id="8205981"><a href="/crypto/x509/x509_test.go.html#8204959">template</a></span><span class="op" id="8205989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8205992">if</span>&nbsp;<span class="ident" id="8205995">l</span>&nbsp;<span class="op" id="8205997">:=</span>&nbsp;<span class="builtinfunc" id="8206000">len</span><span class="op" id="8206003">(</span><span class="ident" id="8206004"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span><span class="op" id="8206007">.</span><span class="ident" id="8206008">Attributes</span><span class="op" id="8206018">)</span><span class="op" id="8206019">;</span>&nbsp;<span class="ident" id="8206021"><a href="/crypto/x509/x509_test.go.html#8205995">l</a></span>&nbsp;<span class="op" id="8206023">!=</span>&nbsp;<span class="num" id="8206026">1</span>&nbsp;<span class="op" id="8206028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206032"><a href="/crypto/x509/x509_test.go.html#8204834">t</a></span><span class="op" id="8206033">.</span><span class="ident" id="8206034">Errorf</span><span class="op" id="8206040">(</span><span class="string" id="8206041">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="8206079">,</span>&nbsp;<span class="ident" id="8206081"><a href="/crypto/x509/x509_test.go.html#8205995">l</a></span><span class="op" id="8206082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206085">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8206089">if</span>&nbsp;<span class="op" id="8206092">!</span><span class="ident" id="8206093"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span><span class="op" id="8206096">.</span><span class="ident" id="8206097">Attributes</span><span class="op" id="8206107">[</span><span class="num" id="8206108">0</span><span class="op" id="8206109">]</span><span class="op" id="8206110">.</span><span class="ident" id="8206111">Type</span><span class="op" id="8206115">.</span><span class="ident" id="8206116">Equal</span><span class="op" id="8206121">(</span><span class="ident" id="8206122"><a href="/crypto/x509/x509.go.html#4367467">oidExtensionRequest</a></span><span class="op" id="8206141">)</span>&nbsp;<span class="op" id="8206143">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8206148">len</span><span class="op" id="8206151">(</span><span class="ident" id="8206152"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span><span class="op" id="8206155">.</span><span class="ident" id="8206156">Attributes</span><span class="op" id="8206166">[</span><span class="num" id="8206167">0</span><span class="op" id="8206168">]</span><span class="op" id="8206169">.</span><span class="ident" id="8206170">Value</span><span class="op" id="8206175">)</span>&nbsp;<span class="op" id="8206177">!=</span>&nbsp;<span class="num" id="8206180">1</span>&nbsp;<span class="op" id="8206182">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8206187">len</span><span class="op" id="8206190">(</span><span class="ident" id="8206191"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span><span class="op" id="8206194">.</span><span class="ident" id="8206195">Attributes</span><span class="op" id="8206205">[</span><span class="num" id="8206206">0</span><span class="op" id="8206207">]</span><span class="op" id="8206208">.</span><span class="ident" id="8206209">Value</span><span class="op" id="8206214">[</span><span class="num" id="8206215">0</span><span class="op" id="8206216">]</span><span class="op" id="8206217">)</span>&nbsp;<span class="op" id="8206219">!=</span>&nbsp;<span class="num" id="8206222">2</span>&nbsp;<span class="op" id="8206224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206228"><a href="/crypto/x509/x509_test.go.html#8204834">t</a></span><span class="op" id="8206229">.</span><span class="ident" id="8206230">Errorf</span><span class="op" id="8206236">(</span><span class="string" id="8206237">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="8206260">,</span>&nbsp;<span class="ident" id="8206262"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span><span class="op" id="8206265">.</span><span class="ident" id="8206266">Attributes</span><span class="op" id="8206276">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206283">sanContents2</span><span class="op" id="8206295">,</span>&nbsp;<span class="ident" id="8206297"><a href="/crypto/x509/x509_test.go.html#8204864">err</a></span>&nbsp;<span class="op" id="8206301">:=</span>&nbsp;<span class="ident" id="8206304"><a href="/crypto/x509/x509.go.html#4352695">marshalSANs</a></span><span class="op" id="8206315">(</span><span class="op" id="8206316">[</span><span class="op" id="8206317">]</span><span class="builtintype" id="8206318">string</span><span class="op" id="8206324">{</span><span class="string" id="8206325">&#34;foo2.example.com&#34;</span><span class="op" id="8206343">}</span><span class="op" id="8206344">,</span>&nbsp;<span class="ident" id="8206346">nil</span><span class="op" id="8206349">,</span>&nbsp;<span class="ident" id="8206351">nil</span><span class="op" id="8206354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8206357">if</span>&nbsp;<span class="ident" id="8206360"><a href="/crypto/x509/x509_test.go.html#8204864">err</a></span>&nbsp;<span class="op" id="8206364">!=</span>&nbsp;<span class="ident" id="8206367">nil</span>&nbsp;<span class="op" id="8206371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206375"><a href="/crypto/x509/x509_test.go.html#8204834">t</a></span><span class="op" id="8206376">.</span><span class="ident" id="8206377">Fatal</span><span class="op" id="8206382">(</span><span class="ident" id="8206383"><a href="/crypto/x509/x509_test.go.html#8204864">err</a></span><span class="op" id="8206386">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8206393">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206464"><a href="/crypto/x509/x509_test.go.html#8204959">template</a></span><span class="op" id="8206472">.</span><span class="ident" id="8206473">Attributes</span><span class="op" id="8206483">[</span><span class="num" id="8206484">0</span><span class="op" id="8206485">]</span><span class="op" id="8206486">.</span><span class="ident" id="8206487">Value</span><span class="op" id="8206492">[</span><span class="num" id="8206493">0</span><span class="op" id="8206494">]</span>&nbsp;<span class="op" id="8206496">=</span>&nbsp;<span class="builtinfunc" id="8206498">append</span><span class="op" id="8206504">(</span><span class="ident" id="8206505"><a href="/crypto/x509/x509_test.go.html#8204959">template</a></span><span class="op" id="8206513">.</span><span class="ident" id="8206514">Attributes</span><span class="op" id="8206524">[</span><span class="num" id="8206525">0</span><span class="op" id="8206526">]</span><span class="op" id="8206527">.</span><span class="ident" id="8206528">Value</span><span class="op" id="8206533">[</span><span class="num" id="8206534">0</span><span class="op" id="8206535">]</span><span class="op" id="8206536">,</span>&nbsp;<span class="ident" id="8206538"><a href="/crypto/x509/x509_test.go.html#8166244">pkix</a></span><span class="op" id="8206542">.</span><span class="ident" id="8206543">AttributeTypeAndValue</span><span class="op" id="8206564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206568">Type</span><span class="op" id="8206572">:</span>&nbsp;&nbsp;<span class="ident" id="8206575"><a href="/crypto/x509/x509.go.html#4351829">oidExtensionSubjectAltName</a></span><span class="op" id="8206601">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206605">Value</span><span class="op" id="8206610">:</span>&nbsp;<span class="ident" id="8206612"><a href="/crypto/x509/x509_test.go.html#8206283">sanContents2</a></span><span class="op" id="8206624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206627">}</span><span class="op" id="8206628">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206632"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span>&nbsp;<span class="op" id="8206636">=</span>&nbsp;<span class="ident" id="8206638"><a href="/crypto/x509/x509_test.go.html#8204369">marshalAndParseCSR</a></span><span class="op" id="8206656">(</span><span class="ident" id="8206657"><a href="/crypto/x509/x509_test.go.html#8204834">t</a></span><span class="op" id="8206658">,</span>&nbsp;<span class="op" id="8206660">&amp;</span><span class="ident" id="8206661"><a href="/crypto/x509/x509_test.go.html#8204959">template</a></span><span class="op" id="8206669">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8206673">if</span>&nbsp;<span class="builtinfunc" id="8206676">len</span><span class="op" id="8206679">(</span><span class="ident" id="8206680"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span><span class="op" id="8206683">.</span><span class="ident" id="8206684">DNSNames</span><span class="op" id="8206692">)</span>&nbsp;<span class="op" id="8206694">!=</span>&nbsp;<span class="num" id="8206697">1</span>&nbsp;<span class="op" id="8206699">||</span>&nbsp;<span class="ident" id="8206702"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span><span class="op" id="8206705">.</span><span class="ident" id="8206706">DNSNames</span><span class="op" id="8206714">[</span><span class="num" id="8206715">0</span><span class="op" id="8206716">]</span>&nbsp;<span class="op" id="8206718">!=</span>&nbsp;<span class="string" id="8206721">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="8206740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206744"><a href="/crypto/x509/x509_test.go.html#8204834">t</a></span><span class="op" id="8206745">.</span><span class="ident" id="8206746">Errorf</span><span class="op" id="8206752">(</span><span class="string" id="8206753">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="8206808">,</span>&nbsp;<span class="ident" id="8206810"><a href="/crypto/x509/x509_test.go.html#8205340">csr</a></span><span class="op" id="8206813">.</span><span class="ident" id="8206814">DNSNames</span><span class="op" id="8206822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8206825">}</span><br>
<span class="lineno"></span><span class="op" id="8206827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="8206830">func</span>&nbsp;<span class="ident" id="8206835">TestParseCertificateRequest</span><span class="op" id="8206862">(</span><span class="ident" id="8206863">t</span>&nbsp;<span class="op" id="8206865">*</span><span class="ident" id="8206866"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8206873">.</span><span class="ident" id="8206874">T</span><span class="op" id="8206875">)</span>&nbsp;<span class="op" id="8206877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206880">csrBytes</span>&nbsp;<span class="op" id="8206889">:=</span>&nbsp;<span class="ident" id="8206892"><a href="/crypto/x509/x509_test.go.html#8194002">fromBase64</a></span><span class="op" id="8206902">(</span><span class="ident" id="8206903"><a href="/crypto/x509/x509_test.go.html#8209670">csrBase64</a></span><span class="op" id="8206912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206915">csr</span><span class="op" id="8206918">,</span>&nbsp;<span class="ident" id="8206920">err</span>&nbsp;<span class="op" id="8206924">:=</span>&nbsp;<span class="ident" id="8206927"><a href="/crypto/x509/x509.go.html#4371996">ParseCertificateRequest</a></span><span class="op" id="8206950">(</span><span class="ident" id="8206951"><a href="/crypto/x509/x509_test.go.html#8206880">csrBytes</a></span><span class="op" id="8206959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8206962">if</span>&nbsp;<span class="ident" id="8206965"><a href="/crypto/x509/x509_test.go.html#8206920">err</a></span>&nbsp;<span class="op" id="8206969">!=</span>&nbsp;<span class="ident" id="8206972">nil</span>&nbsp;<span class="op" id="8206976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8206980"><a href="/crypto/x509/x509_test.go.html#8206863">t</a></span><span class="op" id="8206981">.</span><span class="ident" id="8206982">Fatalf</span><span class="op" id="8206988">(</span><span class="string" id="8206989">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="8207014">,</span>&nbsp;<span class="ident" id="8207016"><a href="/crypto/x509/x509_test.go.html#8206920">err</a></span><span class="op" id="8207019">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207026">if</span>&nbsp;<span class="builtinfunc" id="8207029">len</span><span class="op" id="8207032">(</span><span class="ident" id="8207033"><a href="/crypto/x509/x509_test.go.html#8206915">csr</a></span><span class="op" id="8207036">.</span><span class="ident" id="8207037">EmailAddresses</span><span class="op" id="8207051">)</span>&nbsp;<span class="op" id="8207053">!=</span>&nbsp;<span class="num" id="8207056">1</span>&nbsp;<span class="op" id="8207058">||</span>&nbsp;<span class="ident" id="8207061"><a href="/crypto/x509/x509_test.go.html#8206915">csr</a></span><span class="op" id="8207064">.</span><span class="ident" id="8207065">EmailAddresses</span><span class="op" id="8207079">[</span><span class="num" id="8207080">0</span><span class="op" id="8207081">]</span>&nbsp;<span class="op" id="8207083">!=</span>&nbsp;<span class="string" id="8207086">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="8207106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207110"><a href="/crypto/x509/x509_test.go.html#8206863">t</a></span><span class="op" id="8207111">.</span><span class="ident" id="8207112">Errorf</span><span class="op" id="8207118">(</span><span class="string" id="8207119">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="8207156">,</span>&nbsp;<span class="ident" id="8207158"><a href="/crypto/x509/x509_test.go.html#8206915">csr</a></span><span class="op" id="8207161">.</span><span class="ident" id="8207162">EmailAddresses</span><span class="op" id="8207176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207179">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207183">if</span>&nbsp;<span class="builtinfunc" id="8207186">len</span><span class="op" id="8207189">(</span><span class="ident" id="8207190"><a href="/crypto/x509/x509_test.go.html#8206915">csr</a></span><span class="op" id="8207193">.</span><span class="ident" id="8207194">DNSNames</span><span class="op" id="8207202">)</span>&nbsp;<span class="op" id="8207204">!=</span>&nbsp;<span class="num" id="8207207">1</span>&nbsp;<span class="op" id="8207209">||</span>&nbsp;<span class="ident" id="8207212"><a href="/crypto/x509/x509_test.go.html#8206915">csr</a></span><span class="op" id="8207215">.</span><span class="ident" id="8207216">DNSNames</span><span class="op" id="8207224">[</span><span class="num" id="8207225">0</span><span class="op" id="8207226">]</span>&nbsp;<span class="op" id="8207228">!=</span>&nbsp;<span class="string" id="8207231">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="8207250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207254"><a href="/crypto/x509/x509_test.go.html#8206863">t</a></span><span class="op" id="8207255">.</span><span class="ident" id="8207256">Errorf</span><span class="op" id="8207262">(</span><span class="string" id="8207263">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="8207294">,</span>&nbsp;<span class="ident" id="8207296"><a href="/crypto/x509/x509_test.go.html#8206915">csr</a></span><span class="op" id="8207299">.</span><span class="ident" id="8207300">DNSNames</span><span class="op" id="8207308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207315">if</span>&nbsp;<span class="builtinfunc" id="8207318">len</span><span class="op" id="8207321">(</span><span class="ident" id="8207322"><a href="/crypto/x509/x509_test.go.html#8206915">csr</a></span><span class="op" id="8207325">.</span><span class="ident" id="8207326">Subject</span><span class="op" id="8207333">.</span><span class="ident" id="8207334">Country</span><span class="op" id="8207341">)</span>&nbsp;<span class="op" id="8207343">!=</span>&nbsp;<span class="num" id="8207346">1</span>&nbsp;<span class="op" id="8207348">||</span>&nbsp;<span class="ident" id="8207351"><a href="/crypto/x509/x509_test.go.html#8206915">csr</a></span><span class="op" id="8207354">.</span><span class="ident" id="8207355">Subject</span><span class="op" id="8207362">.</span><span class="ident" id="8207363">Country</span><span class="op" id="8207370">[</span><span class="num" id="8207371">0</span><span class="op" id="8207372">]</span>&nbsp;<span class="op" id="8207374">!=</span>&nbsp;<span class="string" id="8207377">&#34;AU&#34;</span>&nbsp;<span class="op" id="8207382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207386"><a href="/crypto/x509/x509_test.go.html#8206863">t</a></span><span class="op" id="8207387">.</span><span class="ident" id="8207388">Errorf</span><span class="op" id="8207394">(</span><span class="string" id="8207395">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="8207423">,</span>&nbsp;<span class="ident" id="8207425"><a href="/crypto/x509/x509_test.go.html#8206915">csr</a></span><span class="op" id="8207428">.</span><span class="ident" id="8207429">Subject</span><span class="op" id="8207436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207443">found</span>&nbsp;<span class="op" id="8207449">:=</span>&nbsp;<span class="ident" id="8207452">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207459">for</span>&nbsp;<span class="ident" id="8207463">_</span><span class="op" id="8207464">,</span>&nbsp;<span class="ident" id="8207466">e</span>&nbsp;<span class="op" id="8207468">:=</span>&nbsp;<span class="keyword" id="8207471">range</span>&nbsp;<span class="ident" id="8207477"><a href="/crypto/x509/x509_test.go.html#8206915">csr</a></span><span class="op" id="8207480">.</span><span class="ident" id="8207481">Extensions</span>&nbsp;<span class="op" id="8207492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207496">if</span>&nbsp;<span class="ident" id="8207499"><a href="/crypto/x509/x509_test.go.html#8207466">e</a></span><span class="op" id="8207500">.</span><span class="ident" id="8207501">Id</span><span class="op" id="8207503">.</span><span class="ident" id="8207504">Equal</span><span class="op" id="8207509">(</span><span class="ident" id="8207510"><a href="/crypto/x509/x509.go.html#4351772">oidExtensionBasicConstraints</a></span><span class="op" id="8207538">)</span>&nbsp;<span class="op" id="8207540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207545"><a href="/crypto/x509/x509_test.go.html#8207443">found</a></span>&nbsp;<span class="op" id="8207551">=</span>&nbsp;<span class="ident" id="8207553">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207561">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207569">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207575">if</span>&nbsp;<span class="op" id="8207578">!</span><span class="ident" id="8207579"><a href="/crypto/x509/x509_test.go.html#8207443">found</a></span>&nbsp;<span class="op" id="8207585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207589"><a href="/crypto/x509/x509_test.go.html#8206863">t</a></span><span class="op" id="8207590">.</span><span class="ident" id="8207591">Errorf</span><span class="op" id="8207597">(</span><span class="string" id="8207598">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="8207644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207647">}</span><br>
<span class="lineno"></span><span class="op" id="8207649">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="8207652">func</span>&nbsp;<span class="ident" id="8207657">TestMaxPathLen</span><span class="op" id="8207671">(</span><span class="ident" id="8207672">t</span>&nbsp;<span class="op" id="8207674">*</span><span class="ident" id="8207675"><a href="/crypto/x509/x509_test.go.html#8166384">testing</a></span><span class="op" id="8207682">.</span><span class="ident" id="8207683">T</span><span class="op" id="8207684">)</span>&nbsp;<span class="op" id="8207686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207689">block</span><span class="op" id="8207694">,</span>&nbsp;<span class="ident" id="8207696">_</span>&nbsp;<span class="op" id="8207698">:=</span>&nbsp;<span class="ident" id="8207701"><a href="/crypto/x509/x509_test.go.html#8166316">pem</a></span><span class="op" id="8207704">.</span><span class="ident" id="8207705">Decode</span><span class="op" id="8207711">(</span><span class="op" id="8207712">[</span><span class="op" id="8207713">]</span><span class="builtintype" id="8207714">byte</span><span class="op" id="8207718">(</span><span class="ident" id="8207719"><a href="/crypto/x509/x509_test.go.html#8168074">pemPrivateKey</a></span><span class="op" id="8207732">)</span><span class="op" id="8207733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207736">rsaPriv</span><span class="op" id="8207743">,</span>&nbsp;<span class="ident" id="8207745">err</span>&nbsp;<span class="op" id="8207749">:=</span>&nbsp;<span class="ident" id="8207752"><a href="/crypto/x509/pkcs1.go.html#4294252">ParsePKCS1PrivateKey</a></span><span class="op" id="8207772">(</span><span class="ident" id="8207773"><a href="/crypto/x509/x509_test.go.html#8207689">block</a></span><span class="op" id="8207778">.</span><span class="ident" id="8207779">Bytes</span><span class="op" id="8207784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8207787">if</span>&nbsp;<span class="ident" id="8207790"><a href="/crypto/x509/x509_test.go.html#8207745">err</a></span>&nbsp;<span class="op" id="8207794">!=</span>&nbsp;<span class="ident" id="8207797">nil</span>&nbsp;<span class="op" id="8207801">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207805"><a href="/crypto/x509/x509_test.go.html#8207672">t</a></span><span class="op" id="8207806">.</span><span class="ident" id="8207807">Fatalf</span><span class="op" id="8207813">(</span><span class="string" id="8207814">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8207847">,</span>&nbsp;<span class="ident" id="8207849"><a href="/crypto/x509/x509_test.go.html#8207745">err</a></span><span class="op" id="8207852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207859">template</span>&nbsp;<span class="op" id="8207868">:=</span>&nbsp;<span class="op" id="8207871">&amp;</span><span class="ident" id="8207872"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="8207883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207887">SerialNumber</span><span class="op" id="8207899">:</span>&nbsp;<span class="ident" id="8207901"><a href="/crypto/x509/x509_test.go.html#8166332">big</a></span><span class="op" id="8207904">.</span><span class="ident" id="8207905">NewInt</span><span class="op" id="8207911">(</span><span class="num" id="8207912">1</span><span class="op" id="8207913">)</span><span class="op" id="8207914">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207918">Subject</span><span class="op" id="8207925">:</span>&nbsp;<span class="ident" id="8207927"><a href="/crypto/x509/x509_test.go.html#8166244">pkix</a></span><span class="op" id="8207931">.</span><span class="ident" id="8207932">Name</span><span class="op" id="8207936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207941">CommonName</span><span class="op" id="8207951">:</span>&nbsp;<span class="string" id="8207953">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="8207965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8207969">}</span><span class="op" id="8207970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8207974">NotBefore</span><span class="op" id="8207983">:</span>&nbsp;<span class="ident" id="8207985"><a href="/crypto/x509/x509_test.go.html#8166395">time</a></span><span class="op" id="8207989">.</span><span class="ident" id="8207990">Unix</span><span class="op" id="8207994">(</span><span class="num" id="8207995">1000</span><span class="op" id="8207999">,</span>&nbsp;<span class="num" id="8208001">0</span><span class="op" id="8208002">)</span><span class="op" id="8208003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208007">NotAfter</span><span class="op" id="8208015">:</span>&nbsp;&nbsp;<span class="ident" id="8208018"><a href="/crypto/x509/x509_test.go.html#8166395">time</a></span><span class="op" id="8208022">.</span><span class="ident" id="8208023">Unix</span><span class="op" id="8208027">(</span><span class="num" id="8208028">100000</span><span class="op" id="8208034">,</span>&nbsp;<span class="num" id="8208036">0</span><span class="op" id="8208037">)</span><span class="op" id="8208038">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208043">BasicConstraintsValid</span><span class="op" id="8208064">:</span>&nbsp;<span class="ident" id="8208066">true</span><span class="op" id="8208070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208074">IsCA</span><span class="op" id="8208078">:</span>&nbsp;<span class="ident" id="8208080">true</span><span class="op" id="8208084">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208091">serialiseAndParse</span>&nbsp;<span class="op" id="8208109">:=</span>&nbsp;<span class="keyword" id="8208112">func</span><span class="op" id="8208116">(</span><span class="ident" id="8208117">template</span>&nbsp;<span class="op" id="8208126">*</span><span class="ident" id="8208127"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span><span class="op" id="8208138">)</span>&nbsp;<span class="op" id="8208140">*</span><span class="ident" id="8208141"><a href="/crypto/x509/x509.go.html#4330775">Certificate</a></span>&nbsp;<span class="op" id="8208153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208157">derBytes</span><span class="op" id="8208165">,</span>&nbsp;<span class="ident" id="8208167">err</span>&nbsp;<span class="op" id="8208171">:=</span>&nbsp;<span class="ident" id="8208174"><a href="/crypto/x509/x509.go.html#4361151">CreateCertificate</a></span><span class="op" id="8208191">(</span><span class="ident" id="8208192"><a href="/crypto/x509/x509_test.go.html#8166177">rand</a></span><span class="op" id="8208196">.</span><span class="ident" id="8208197">Reader</span><span class="op" id="8208203">,</span>&nbsp;<span class="ident" id="8208205"><a href="/crypto/x509/x509_test.go.html#8208117">template</a></span><span class="op" id="8208213">,</span>&nbsp;<span class="ident" id="8208215"><a href="/crypto/x509/x509_test.go.html#8208117">template</a></span><span class="op" id="8208223">,</span>&nbsp;<span class="op" id="8208225">&amp;</span><span class="ident" id="8208226"><a href="/crypto/x509/x509_test.go.html#8207736">rsaPriv</a></span><span class="op" id="8208233">.</span><span class="ident" id="8208234">PublicKey</span><span class="op" id="8208243">,</span>&nbsp;<span class="ident" id="8208245"><a href="/crypto/x509/x509_test.go.html#8207736">rsaPriv</a></span><span class="op" id="8208252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208256">if</span>&nbsp;<span class="ident" id="8208259"><a href="/crypto/x509/x509_test.go.html#8208167">err</a></span>&nbsp;<span class="op" id="8208263">!=</span>&nbsp;<span class="ident" id="8208266">nil</span>&nbsp;<span class="op" id="8208270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208275"><a href="/crypto/x509/x509_test.go.html#8207672">t</a></span><span class="op" id="8208276">.</span><span class="ident" id="8208277">Fatalf</span><span class="op" id="8208283">(</span><span class="string" id="8208284">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8208318">,</span>&nbsp;<span class="ident" id="8208320"><a href="/crypto/x509/x509_test.go.html#8208167">err</a></span><span class="op" id="8208323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208328">return</span>&nbsp;<span class="ident" id="8208335">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208346">cert</span><span class="op" id="8208350">,</span>&nbsp;<span class="ident" id="8208352"><a href="/crypto/x509/x509_test.go.html#8208167">err</a></span>&nbsp;<span class="op" id="8208356">:=</span>&nbsp;<span class="ident" id="8208359"><a href="/crypto/x509/x509.go.html#4350518">ParseCertificate</a></span><span class="op" id="8208375">(</span><span class="ident" id="8208376"><a href="/crypto/x509/x509_test.go.html#8208157">derBytes</a></span><span class="op" id="8208384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208388">if</span>&nbsp;<span class="ident" id="8208391"><a href="/crypto/x509/x509_test.go.html#8208167">err</a></span>&nbsp;<span class="op" id="8208395">!=</span>&nbsp;<span class="ident" id="8208398">nil</span>&nbsp;<span class="op" id="8208402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208407"><a href="/crypto/x509/x509_test.go.html#8207672">t</a></span><span class="op" id="8208408">.</span><span class="ident" id="8208409">Fatalf</span><span class="op" id="8208415">(</span><span class="string" id="8208416">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="8208449">,</span>&nbsp;<span class="ident" id="8208451"><a href="/crypto/x509/x509_test.go.html#8208167">err</a></span><span class="op" id="8208454">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208459">return</span>&nbsp;<span class="ident" id="8208466">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208477">return</span>&nbsp;<span class="ident" id="8208484"><a href="/crypto/x509/x509_test.go.html#8208346">cert</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208490">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208494">cert1</span>&nbsp;<span class="op" id="8208500">:=</span>&nbsp;<span class="ident" id="8208503"><a href="/crypto/x509/x509_test.go.html#8208091">serialiseAndParse</a></span><span class="op" id="8208520">(</span><span class="ident" id="8208521"><a href="/crypto/x509/x509_test.go.html#8207859">template</a></span><span class="op" id="8208529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208532">if</span>&nbsp;<span class="ident" id="8208535">m</span>&nbsp;<span class="op" id="8208537">:=</span>&nbsp;<span class="ident" id="8208540"><a href="/crypto/x509/x509_test.go.html#8208494">cert1</a></span><span class="op" id="8208545">.</span><span class="ident" id="8208546">MaxPathLen</span><span class="op" id="8208556">;</span>&nbsp;<span class="ident" id="8208558"><a href="/crypto/x509/x509_test.go.html#8208535">m</a></span>&nbsp;<span class="op" id="8208560">!=</span>&nbsp;<span class="op" id="8208563">-</span><span class="num" id="8208564">1</span>&nbsp;<span class="op" id="8208566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208570"><a href="/crypto/x509/x509_test.go.html#8207672">t</a></span><span class="op" id="8208571">.</span><span class="ident" id="8208572">Errorf</span><span class="op" id="8208578">(</span><span class="string" id="8208579">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8208628">,</span>&nbsp;<span class="ident" id="8208630"><a href="/crypto/x509/x509_test.go.html#8208535">m</a></span><span class="op" id="8208631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208634">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208637">if</span>&nbsp;<span class="ident" id="8208640"><a href="/crypto/x509/x509_test.go.html#8208494">cert1</a></span><span class="op" id="8208645">.</span><span class="ident" id="8208646">MaxPathLenZero</span>&nbsp;<span class="op" id="8208661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208665"><a href="/crypto/x509/x509_test.go.html#8207672">t</a></span><span class="op" id="8208666">.</span><span class="ident" id="8208667">Errorf</span><span class="op" id="8208673">(</span><span class="string" id="8208674">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="8208722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208729"><a href="/crypto/x509/x509_test.go.html#8207859">template</a></span><span class="op" id="8208737">.</span><span class="ident" id="8208738">MaxPathLen</span>&nbsp;<span class="op" id="8208749">=</span>&nbsp;<span class="num" id="8208751">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208754">cert2</span>&nbsp;<span class="op" id="8208760">:=</span>&nbsp;<span class="ident" id="8208763"><a href="/crypto/x509/x509_test.go.html#8208091">serialiseAndParse</a></span><span class="op" id="8208780">(</span><span class="ident" id="8208781"><a href="/crypto/x509/x509_test.go.html#8207859">template</a></span><span class="op" id="8208789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208792">if</span>&nbsp;<span class="ident" id="8208795">m</span>&nbsp;<span class="op" id="8208797">:=</span>&nbsp;<span class="ident" id="8208800"><a href="/crypto/x509/x509_test.go.html#8208754">cert2</a></span><span class="op" id="8208805">.</span><span class="ident" id="8208806">MaxPathLen</span><span class="op" id="8208816">;</span>&nbsp;<span class="ident" id="8208818"><a href="/crypto/x509/x509_test.go.html#8208795">m</a></span>&nbsp;<span class="op" id="8208820">!=</span>&nbsp;<span class="num" id="8208823">1</span>&nbsp;<span class="op" id="8208825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208829"><a href="/crypto/x509/x509_test.go.html#8207672">t</a></span><span class="op" id="8208830">.</span><span class="ident" id="8208831">Errorf</span><span class="op" id="8208837">(</span><span class="string" id="8208838">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="8208888">,</span>&nbsp;<span class="ident" id="8208890"><a href="/crypto/x509/x509_test.go.html#8208795">m</a></span><span class="op" id="8208891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8208897">if</span>&nbsp;<span class="ident" id="8208900"><a href="/crypto/x509/x509_test.go.html#8208754">cert2</a></span><span class="op" id="8208905">.</span><span class="ident" id="8208906">MaxPathLenZero</span>&nbsp;<span class="op" id="8208921">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208925"><a href="/crypto/x509/x509_test.go.html#8207672">t</a></span><span class="op" id="8208926">.</span><span class="ident" id="8208927">Errorf</span><span class="op" id="8208933">(</span><span class="string" id="8208934">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="8208981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8208984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8208988"><a href="/crypto/x509/x509_test.go.html#8207859">template</a></span><span class="op" id="8208996">.</span><span class="ident" id="8208997">MaxPathLen</span>&nbsp;<span class="op" id="8209008">=</span>&nbsp;<span class="num" id="8209010">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209013"><a href="/crypto/x509/x509_test.go.html#8207859">template</a></span><span class="op" id="8209021">.</span><span class="ident" id="8209022">MaxPathLenZero</span>&nbsp;<span class="op" id="8209037">=</span>&nbsp;<span class="ident" id="8209039">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209045">cert3</span>&nbsp;<span class="op" id="8209051">:=</span>&nbsp;<span class="ident" id="8209054"><a href="/crypto/x509/x509_test.go.html#8208091">serialiseAndParse</a></span><span class="op" id="8209071">(</span><span class="ident" id="8209072"><a href="/crypto/x509/x509_test.go.html#8207859">template</a></span><span class="op" id="8209080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209083">if</span>&nbsp;<span class="ident" id="8209086">m</span>&nbsp;<span class="op" id="8209088">:=</span>&nbsp;<span class="ident" id="8209091"><a href="/crypto/x509/x509_test.go.html#8209045">cert3</a></span><span class="op" id="8209096">.</span><span class="ident" id="8209097">MaxPathLen</span><span class="op" id="8209107">;</span>&nbsp;<span class="ident" id="8209109"><a href="/crypto/x509/x509_test.go.html#8209086">m</a></span>&nbsp;<span class="op" id="8209111">!=</span>&nbsp;<span class="num" id="8209114">0</span>&nbsp;<span class="op" id="8209116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209120"><a href="/crypto/x509/x509_test.go.html#8207672">t</a></span><span class="op" id="8209121">.</span><span class="ident" id="8209122">Errorf</span><span class="op" id="8209128">(</span><span class="string" id="8209129">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8209173">,</span>&nbsp;<span class="ident" id="8209175"><a href="/crypto/x509/x509_test.go.html#8209086">m</a></span><span class="op" id="8209176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8209182">if</span>&nbsp;<span class="op" id="8209185">!</span><span class="ident" id="8209186"><a href="/crypto/x509/x509_test.go.html#8209045">cert3</a></span><span class="op" id="8209191">.</span><span class="ident" id="8209192">MaxPathLenZero</span>&nbsp;<span class="op" id="8209207">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8209211"><a href="/crypto/x509/x509_test.go.html#8207672">t</a></span><span class="op" id="8209212">.</span><span class="ident" id="8209213">Errorf</span><span class="op" id="8209219">(</span><span class="string" id="8209220">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="8209280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8209283">}</span><br>
<span class="lineno"></span><span class="op" id="8209285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8209288">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="8209328">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="8209429">//</span><br>
<span class="lineno"></span><span class="comment" id="8209432">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="8209482">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="8209498">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="8209531">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="8209597">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="8209664">const</span>&nbsp;<span class="ident" id="8209670">csrBase64</span>&nbsp;<span class="op" id="8209680">=</span>&nbsp;<span class="string" id="8209682">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
