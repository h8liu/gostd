<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509/pkix</h2>
<ul>
<li><a href="/gostd/crypto/x509/pkix/pkix.go.html">pkix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4425044">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4425099">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4425153">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4425204">//&nbsp;Package&nbsp;pkix&nbsp;contains&nbsp;shared,&nbsp;low&nbsp;level&nbsp;structures&nbsp;used&nbsp;for&nbsp;ASN.1&nbsp;parsing</span><br>
<span class="lineno"></span><span class="comment" id="4425281">//&nbsp;and&nbsp;serialization&nbsp;of&nbsp;X.509&nbsp;certificates,&nbsp;CRL&nbsp;and&nbsp;OCSP.</span><br>
<span class="lineno"></span><span class="keyword" id="4425339">package</span>&nbsp;<span class="ident" id="4425347">pkix</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4425353">import</span>&nbsp;<span class="op" id="4425360">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4425363">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4425380">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4425392">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4425399">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4425402">//&nbsp;AlgorithmIdentifier&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4425482">//&nbsp;5280,&nbsp;section&nbsp;4.1.1.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4425508">type</span>&nbsp;<span class="ident" id="4425513">AlgorithmIdentifier</span>&nbsp;<span class="keyword" id="4425533">struct</span>&nbsp;<span class="op" id="4425540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425543">Algorithm</span>&nbsp;&nbsp;<span class="ident" id="4425554">asn1</span><span class="op" id="4425558">.</span><span class="ident" id="4425559">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425577">Parameters</span>&nbsp;<span class="ident" id="4425588">asn1</span><span class="op" id="4425592">.</span><span class="ident" id="4425593">RawValue</span>&nbsp;<span class="string" id="4425602">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">20</span><span class="op" id="4425620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4425623">type</span>&nbsp;<span class="ident" id="4425628">RDNSequence</span>&nbsp;<span class="op" id="4425640">[</span><span class="op" id="4425641">]</span><span class="ident" id="4425642">RelativeDistinguishedNameSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4425672">type</span>&nbsp;<span class="ident" id="4425677">RelativeDistinguishedNameSET</span>&nbsp;<span class="op" id="4425706">[</span><span class="op" id="4425707">]</span><span class="ident" id="4425708">AttributeTypeAndValue</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4425731">//&nbsp;AttributeTypeAndValue&nbsp;mirrors&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4425804">//&nbsp;http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span><br>
<span class="lineno"></span><span class="keyword" id="4425858">type</span>&nbsp;<span class="ident" id="4425863">AttributeTypeAndValue</span>&nbsp;<span class="keyword" id="4425885">struct</span>&nbsp;<span class="op" id="4425892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425895">Type</span>&nbsp;&nbsp;<span class="ident" id="4425901">asn1</span><span class="op" id="4425905">.</span><span class="ident" id="4425906">ObjectIdentifier</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425924">Value</span>&nbsp;<span class="keyword" id="4425930">interface</span><span class="op" id="4425939">{</span><span class="op" id="4425940">}</span><br>
<span class="lineno"></span><span class="op" id="4425942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4425945">//&nbsp;AttributeTypeAndValueSET&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;ASN.1&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4426012">//&nbsp;AttributeTypeAndValue&nbsp;sequences&nbsp;from&nbsp;RFC&nbsp;2986&nbsp;(PKCS&nbsp;#10).</span><br>
<span class="lineno">35</span><span class="keyword" id="4426073">type</span>&nbsp;<span class="ident" id="4426078">AttributeTypeAndValueSET</span>&nbsp;<span class="keyword" id="4426103">struct</span>&nbsp;<span class="op" id="4426110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426113">Type</span>&nbsp;&nbsp;<span class="ident" id="4426119">asn1</span><span class="op" id="4426123">.</span><span class="ident" id="4426124">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426142">Value</span>&nbsp;<span class="op" id="4426148">[</span><span class="op" id="4426149">]</span><span class="op" id="4426150">[</span><span class="op" id="4426151">]</span><span class="ident" id="4426152">AttributeTypeAndValue</span>&nbsp;<span class="string" id="4426174">`asn1:&#34;set&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4426187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4426190">//&nbsp;Extension&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4426260">//&nbsp;5280,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4426282">type</span>&nbsp;<span class="ident" id="4426287">Extension</span>&nbsp;<span class="keyword" id="4426297">struct</span>&nbsp;<span class="op" id="4426304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426307">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4426316">asn1</span><span class="op" id="4426320">.</span><span class="ident" id="4426321">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426339">Critical</span>&nbsp;<span class="builtintype" id="4426348">bool</span>&nbsp;<span class="string" id="4426353">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426372">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426381">[</span><span class="op" id="4426382">]</span><span class="builtintype" id="4426383">byte</span><br>
<span class="lineno"></span><span class="op" id="4426388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4426391">//&nbsp;Name&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;distinguished&nbsp;name.&nbsp;This&nbsp;only&nbsp;includes&nbsp;the&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="4426469">//&nbsp;elements&nbsp;of&nbsp;a&nbsp;DN.&nbsp;&nbsp;Additional&nbsp;elements&nbsp;in&nbsp;the&nbsp;name&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">50</span><span class="keyword" id="4426536">type</span>&nbsp;<span class="ident" id="4426541">Name</span>&nbsp;<span class="keyword" id="4426546">struct</span>&nbsp;<span class="op" id="4426553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426556">Country</span><span class="op" id="4426563">,</span>&nbsp;<span class="ident" id="4426565">Organization</span><span class="op" id="4426577">,</span>&nbsp;<span class="ident" id="4426579">OrganizationalUnit</span>&nbsp;<span class="op" id="4426598">[</span><span class="op" id="4426599">]</span><span class="builtintype" id="4426600">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426608">Locality</span><span class="op" id="4426616">,</span>&nbsp;<span class="ident" id="4426618">Province</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426650">[</span><span class="op" id="4426651">]</span><span class="builtintype" id="4426652">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426660">StreetAddress</span><span class="op" id="4426673">,</span>&nbsp;<span class="ident" id="4426675">PostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4426702">[</span><span class="op" id="4426703">]</span><span class="builtintype" id="4426704">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426712">SerialNumber</span><span class="op" id="4426724">,</span>&nbsp;<span class="ident" id="4426726">CommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4426754">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426763">Names</span>&nbsp;<span class="op" id="4426769">[</span><span class="op" id="4426770">]</span><span class="ident" id="4426771">AttributeTypeAndValue</span><br>
<span class="lineno"></span><span class="op" id="4426793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4426796">func</span>&nbsp;<span class="op" id="4426801">(</span><span class="ident" id="4426802">n</span>&nbsp;<span class="op" id="4426804">*</span><span class="ident" id="4426805">Name</span><span class="op" id="4426809">)</span>&nbsp;<span class="ident" id="4426811">FillFromRDNSequence</span><span class="op" id="4426830">(</span><span class="ident" id="4426831">rdns</span>&nbsp;<span class="op" id="4426836">*</span><span class="ident" id="4426837">RDNSequence</span><span class="op" id="4426848">)</span>&nbsp;<span class="op" id="4426850">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4426853">for</span>&nbsp;<span class="ident" id="4426857">_</span><span class="op" id="4426858">,</span>&nbsp;<span class="ident" id="4426860">rdn</span>&nbsp;<span class="op" id="4426864">:=</span>&nbsp;<span class="keyword" id="4426867">range</span>&nbsp;<span class="op" id="4426873">*</span><span class="ident" id="4426874">rdns</span>&nbsp;<span class="op" id="4426879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4426883">if</span>&nbsp;<span class="builtinfunc" id="4426886">len</span><span class="op" id="4426889">(</span><span class="ident" id="4426890">rdn</span><span class="op" id="4426893">)</span>&nbsp;<span class="op" id="4426895">==</span>&nbsp;<span class="num" id="4426898">0</span>&nbsp;<span class="op" id="4426900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4426905">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4426916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426920">atv</span>&nbsp;<span class="op" id="4426924">:=</span>&nbsp;<span class="ident" id="4426927">rdn</span><span class="op" id="4426930">[</span><span class="num" id="4426931">0</span><span class="op" id="4426932">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426936">n</span><span class="op" id="4426937">.</span><span class="ident" id="4426938">Names</span>&nbsp;<span class="op" id="4426944">=</span>&nbsp;<span class="builtinfunc" id="4426946">append</span><span class="op" id="4426952">(</span><span class="ident" id="4426953">n</span><span class="op" id="4426954">.</span><span class="ident" id="4426955">Names</span><span class="op" id="4426960">,</span>&nbsp;<span class="ident" id="4426962">atv</span><span class="op" id="4426965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426969">value</span><span class="op" id="4426974">,</span>&nbsp;<span class="ident" id="4426976">ok</span>&nbsp;<span class="op" id="4426979">:=</span>&nbsp;<span class="ident" id="4426982">atv</span><span class="op" id="4426985">.</span><span class="ident" id="4426986">Value</span><span class="op" id="4426991">.</span><span class="op" id="4426992">(</span><span class="builtintype" id="4426993">string</span><span class="op" id="4426999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427003">if</span>&nbsp;<span class="op" id="4427006">!</span><span class="ident" id="4427007">ok</span>&nbsp;<span class="op" id="4427010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427015">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427026">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427031">t</span>&nbsp;<span class="op" id="4427033">:=</span>&nbsp;<span class="ident" id="4427036">atv</span><span class="op" id="4427039">.</span><span class="ident" id="4427040">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427047">if</span>&nbsp;<span class="builtinfunc" id="4427050">len</span><span class="op" id="4427053">(</span><span class="ident" id="4427054">t</span><span class="op" id="4427055">)</span>&nbsp;<span class="op" id="4427057">==</span>&nbsp;<span class="num" id="4427060">4</span>&nbsp;<span class="op" id="4427062">&amp;&amp;</span>&nbsp;<span class="ident" id="4427065">t</span><span class="op" id="4427066">[</span><span class="num" id="4427067">0</span><span class="op" id="4427068">]</span>&nbsp;<span class="op" id="4427070">==</span>&nbsp;<span class="num" id="4427073">2</span>&nbsp;<span class="op" id="4427075">&amp;&amp;</span>&nbsp;<span class="ident" id="4427078">t</span><span class="op" id="4427079">[</span><span class="num" id="4427080">1</span><span class="op" id="4427081">]</span>&nbsp;<span class="op" id="4427083">==</span>&nbsp;<span class="num" id="4427086">5</span>&nbsp;<span class="op" id="4427088">&amp;&amp;</span>&nbsp;<span class="ident" id="4427091">t</span><span class="op" id="4427092">[</span><span class="num" id="4427093">2</span><span class="op" id="4427094">]</span>&nbsp;<span class="op" id="4427096">==</span>&nbsp;<span class="num" id="4427099">4</span>&nbsp;<span class="op" id="4427101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427106">switch</span>&nbsp;<span class="ident" id="4427113">t</span><span class="op" id="4427114">[</span><span class="num" id="4427115">3</span><span class="op" id="4427116">]</span>&nbsp;<span class="op" id="4427118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427123">case</span>&nbsp;<span class="num" id="4427128">3</span><span class="op" id="4427129">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427135">n</span><span class="op" id="4427136">.</span><span class="ident" id="4427137">CommonName</span>&nbsp;<span class="op" id="4427148">=</span>&nbsp;<span class="ident" id="4427150">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427159">case</span>&nbsp;<span class="num" id="4427164">5</span><span class="op" id="4427165">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427171">n</span><span class="op" id="4427172">.</span><span class="ident" id="4427173">SerialNumber</span>&nbsp;<span class="op" id="4427186">=</span>&nbsp;<span class="ident" id="4427188">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427197">case</span>&nbsp;<span class="num" id="4427202">6</span><span class="op" id="4427203">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427209">n</span><span class="op" id="4427210">.</span><span class="ident" id="4427211">Country</span>&nbsp;<span class="op" id="4427219">=</span>&nbsp;<span class="builtinfunc" id="4427221">append</span><span class="op" id="4427227">(</span><span class="ident" id="4427228">n</span><span class="op" id="4427229">.</span><span class="ident" id="4427230">Country</span><span class="op" id="4427237">,</span>&nbsp;<span class="ident" id="4427239">value</span><span class="op" id="4427244">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427249">case</span>&nbsp;<span class="num" id="4427254">7</span><span class="op" id="4427255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427261">n</span><span class="op" id="4427262">.</span><span class="ident" id="4427263">Locality</span>&nbsp;<span class="op" id="4427272">=</span>&nbsp;<span class="builtinfunc" id="4427274">append</span><span class="op" id="4427280">(</span><span class="ident" id="4427281">n</span><span class="op" id="4427282">.</span><span class="ident" id="4427283">Locality</span><span class="op" id="4427291">,</span>&nbsp;<span class="ident" id="4427293">value</span><span class="op" id="4427298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427303">case</span>&nbsp;<span class="num" id="4427308">8</span><span class="op" id="4427309">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427315">n</span><span class="op" id="4427316">.</span><span class="ident" id="4427317">Province</span>&nbsp;<span class="op" id="4427326">=</span>&nbsp;<span class="builtinfunc" id="4427328">append</span><span class="op" id="4427334">(</span><span class="ident" id="4427335">n</span><span class="op" id="4427336">.</span><span class="ident" id="4427337">Province</span><span class="op" id="4427345">,</span>&nbsp;<span class="ident" id="4427347">value</span><span class="op" id="4427352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427357">case</span>&nbsp;<span class="num" id="4427362">9</span><span class="op" id="4427363">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427369">n</span><span class="op" id="4427370">.</span><span class="ident" id="4427371">StreetAddress</span>&nbsp;<span class="op" id="4427385">=</span>&nbsp;<span class="builtinfunc" id="4427387">append</span><span class="op" id="4427393">(</span><span class="ident" id="4427394">n</span><span class="op" id="4427395">.</span><span class="ident" id="4427396">StreetAddress</span><span class="op" id="4427409">,</span>&nbsp;<span class="ident" id="4427411">value</span><span class="op" id="4427416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427421">case</span>&nbsp;<span class="num" id="4427426">10</span><span class="op" id="4427428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427434">n</span><span class="op" id="4427435">.</span><span class="ident" id="4427436">Organization</span>&nbsp;<span class="op" id="4427449">=</span>&nbsp;<span class="builtinfunc" id="4427451">append</span><span class="op" id="4427457">(</span><span class="ident" id="4427458">n</span><span class="op" id="4427459">.</span><span class="ident" id="4427460">Organization</span><span class="op" id="4427472">,</span>&nbsp;<span class="ident" id="4427474">value</span><span class="op" id="4427479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427484">case</span>&nbsp;<span class="num" id="4427489">11</span><span class="op" id="4427491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427497">n</span><span class="op" id="4427498">.</span><span class="ident" id="4427499">OrganizationalUnit</span>&nbsp;<span class="op" id="4427518">=</span>&nbsp;<span class="builtinfunc" id="4427520">append</span><span class="op" id="4427526">(</span><span class="ident" id="4427527">n</span><span class="op" id="4427528">.</span><span class="ident" id="4427529">OrganizationalUnit</span><span class="op" id="4427547">,</span>&nbsp;<span class="ident" id="4427549">value</span><span class="op" id="4427554">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4427559">case</span>&nbsp;<span class="num" id="4427564">17</span><span class="op" id="4427566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427572">n</span><span class="op" id="4427573">.</span><span class="ident" id="4427574">PostalCode</span>&nbsp;<span class="op" id="4427585">=</span>&nbsp;<span class="builtinfunc" id="4427587">append</span><span class="op" id="4427593">(</span><span class="ident" id="4427594">n</span><span class="op" id="4427595">.</span><span class="ident" id="4427596">PostalCode</span><span class="op" id="4427606">,</span>&nbsp;<span class="ident" id="4427608">value</span><span class="op" id="4427613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4427625">}</span><br>
<span class="lineno">95</span><span class="op" id="4427627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4427630">var</span>&nbsp;<span class="op" id="4427634">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427637">oidCountry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427659">=</span>&nbsp;<span class="op" id="4427661">[</span><span class="op" id="4427662">]</span><span class="builtintype" id="4427663">int</span><span class="op" id="4427666">{</span><span class="num" id="4427667">2</span><span class="op" id="4427668">,</span>&nbsp;<span class="num" id="4427670">5</span><span class="op" id="4427671">,</span>&nbsp;<span class="num" id="4427673">4</span><span class="op" id="4427674">,</span>&nbsp;<span class="num" id="4427676">6</span><span class="op" id="4427677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427680">oidOrganization</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427702">=</span>&nbsp;<span class="op" id="4427704">[</span><span class="op" id="4427705">]</span><span class="builtintype" id="4427706">int</span><span class="op" id="4427709">{</span><span class="num" id="4427710">2</span><span class="op" id="4427711">,</span>&nbsp;<span class="num" id="4427713">5</span><span class="op" id="4427714">,</span>&nbsp;<span class="num" id="4427716">4</span><span class="op" id="4427717">,</span>&nbsp;<span class="num" id="4427719">10</span><span class="op" id="4427721">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427724">oidOrganizationalUnit</span>&nbsp;<span class="op" id="4427746">=</span>&nbsp;<span class="op" id="4427748">[</span><span class="op" id="4427749">]</span><span class="builtintype" id="4427750">int</span><span class="op" id="4427753">{</span><span class="num" id="4427754">2</span><span class="op" id="4427755">,</span>&nbsp;<span class="num" id="4427757">5</span><span class="op" id="4427758">,</span>&nbsp;<span class="num" id="4427760">4</span><span class="op" id="4427761">,</span>&nbsp;<span class="num" id="4427763">11</span><span class="op" id="4427765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427768">oidCommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427790">=</span>&nbsp;<span class="op" id="4427792">[</span><span class="op" id="4427793">]</span><span class="builtintype" id="4427794">int</span><span class="op" id="4427797">{</span><span class="num" id="4427798">2</span><span class="op" id="4427799">,</span>&nbsp;<span class="num" id="4427801">5</span><span class="op" id="4427802">,</span>&nbsp;<span class="num" id="4427804">4</span><span class="op" id="4427805">,</span>&nbsp;<span class="num" id="4427807">3</span><span class="op" id="4427808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427811">oidSerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427833">=</span>&nbsp;<span class="op" id="4427835">[</span><span class="op" id="4427836">]</span><span class="builtintype" id="4427837">int</span><span class="op" id="4427840">{</span><span class="num" id="4427841">2</span><span class="op" id="4427842">,</span>&nbsp;<span class="num" id="4427844">5</span><span class="op" id="4427845">,</span>&nbsp;<span class="num" id="4427847">4</span><span class="op" id="4427848">,</span>&nbsp;<span class="num" id="4427850">5</span><span class="op" id="4427851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427854">oidLocality</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427876">=</span>&nbsp;<span class="op" id="4427878">[</span><span class="op" id="4427879">]</span><span class="builtintype" id="4427880">int</span><span class="op" id="4427883">{</span><span class="num" id="4427884">2</span><span class="op" id="4427885">,</span>&nbsp;<span class="num" id="4427887">5</span><span class="op" id="4427888">,</span>&nbsp;<span class="num" id="4427890">4</span><span class="op" id="4427891">,</span>&nbsp;<span class="num" id="4427893">7</span><span class="op" id="4427894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427897">oidProvince</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427919">=</span>&nbsp;<span class="op" id="4427921">[</span><span class="op" id="4427922">]</span><span class="builtintype" id="4427923">int</span><span class="op" id="4427926">{</span><span class="num" id="4427927">2</span><span class="op" id="4427928">,</span>&nbsp;<span class="num" id="4427930">5</span><span class="op" id="4427931">,</span>&nbsp;<span class="num" id="4427933">4</span><span class="op" id="4427934">,</span>&nbsp;<span class="num" id="4427936">8</span><span class="op" id="4427937">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427940">oidStreetAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4427962">=</span>&nbsp;<span class="op" id="4427964">[</span><span class="op" id="4427965">]</span><span class="builtintype" id="4427966">int</span><span class="op" id="4427969">{</span><span class="num" id="4427970">2</span><span class="op" id="4427971">,</span>&nbsp;<span class="num" id="4427973">5</span><span class="op" id="4427974">,</span>&nbsp;<span class="num" id="4427976">4</span><span class="op" id="4427977">,</span>&nbsp;<span class="num" id="4427979">9</span><span class="op" id="4427980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4427983">oidPostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4428005">=</span>&nbsp;<span class="op" id="4428007">[</span><span class="op" id="4428008">]</span><span class="builtintype" id="4428009">int</span><span class="op" id="4428012">{</span><span class="num" id="4428013">2</span><span class="op" id="4428014">,</span>&nbsp;<span class="num" id="4428016">5</span><span class="op" id="4428017">,</span>&nbsp;<span class="num" id="4428019">4</span><span class="op" id="4428020">,</span>&nbsp;<span class="num" id="4428022">17</span><span class="op" id="4428024">}</span><br>
<span class="lineno"></span><span class="op" id="4428026">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4428029">//&nbsp;appendRDNs&nbsp;appends&nbsp;a&nbsp;relativeDistinguishedNameSET&nbsp;to&nbsp;the&nbsp;given&nbsp;RDNSequence</span><br>
<span class="lineno">110</span><span class="comment" id="4428107">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.&nbsp;The&nbsp;relativeDistinguishedNameSET&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4428182">//&nbsp;attributeTypeAndValue&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;given&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;5280,&nbsp;A.1,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4428260">//&nbsp;search&nbsp;for&nbsp;AttributeTypeAndValue.</span><br>
<span class="lineno"></span><span class="keyword" id="4428297">func</span>&nbsp;<span class="ident" id="4428302">appendRDNs</span><span class="op" id="4428312">(</span><span class="ident" id="4428313">in</span>&nbsp;<span class="ident" id="4428316">RDNSequence</span><span class="op" id="4428327">,</span>&nbsp;<span class="ident" id="4428329">values</span>&nbsp;<span class="op" id="4428336">[</span><span class="op" id="4428337">]</span><span class="builtintype" id="4428338">string</span><span class="op" id="4428344">,</span>&nbsp;<span class="ident" id="4428346">oid</span>&nbsp;<span class="ident" id="4428350">asn1</span><span class="op" id="4428354">.</span><span class="ident" id="4428355">ObjectIdentifier</span><span class="op" id="4428371">)</span>&nbsp;<span class="ident" id="4428373">RDNSequence</span>&nbsp;<span class="op" id="4428385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4428388">if</span>&nbsp;<span class="builtinfunc" id="4428391">len</span><span class="op" id="4428394">(</span><span class="ident" id="4428395">values</span><span class="op" id="4428401">)</span>&nbsp;<span class="op" id="4428403">==</span>&nbsp;<span class="num" id="4428406">0</span>&nbsp;<span class="op" id="4428408">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4428412">return</span>&nbsp;<span class="ident" id="4428419">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4428423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428427">s</span>&nbsp;<span class="op" id="4428429">:=</span>&nbsp;<span class="builtinfunc" id="4428432">make</span><span class="op" id="4428436">(</span><span class="op" id="4428437">[</span><span class="op" id="4428438">]</span><span class="ident" id="4428439">AttributeTypeAndValue</span><span class="op" id="4428460">,</span>&nbsp;<span class="builtinfunc" id="4428462">len</span><span class="op" id="4428465">(</span><span class="ident" id="4428466">values</span><span class="op" id="4428472">)</span><span class="op" id="4428473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4428476">for</span>&nbsp;<span class="ident" id="4428480">i</span><span class="op" id="4428481">,</span>&nbsp;<span class="ident" id="4428483">value</span>&nbsp;<span class="op" id="4428489">:=</span>&nbsp;<span class="keyword" id="4428492">range</span>&nbsp;<span class="ident" id="4428498">values</span>&nbsp;<span class="op" id="4428505">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428509">s</span><span class="op" id="4428510">[</span><span class="ident" id="4428511">i</span><span class="op" id="4428512">]</span><span class="op" id="4428513">.</span><span class="ident" id="4428514">Type</span>&nbsp;<span class="op" id="4428519">=</span>&nbsp;<span class="ident" id="4428521">oid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428527">s</span><span class="op" id="4428528">[</span><span class="ident" id="4428529">i</span><span class="op" id="4428530">]</span><span class="op" id="4428531">.</span><span class="ident" id="4428532">Value</span>&nbsp;<span class="op" id="4428538">=</span>&nbsp;<span class="ident" id="4428540">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4428547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4428551">return</span>&nbsp;<span class="builtinfunc" id="4428558">append</span><span class="op" id="4428564">(</span><span class="ident" id="4428565">in</span><span class="op" id="4428567">,</span>&nbsp;<span class="ident" id="4428569">s</span><span class="op" id="4428570">)</span><br>
<span class="lineno">125</span><span class="op" id="4428572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4428575">func</span>&nbsp;<span class="op" id="4428580">(</span><span class="ident" id="4428581">n</span>&nbsp;<span class="ident" id="4428583">Name</span><span class="op" id="4428587">)</span>&nbsp;<span class="ident" id="4428589">ToRDNSequence</span><span class="op" id="4428602">(</span><span class="op" id="4428603">)</span>&nbsp;<span class="op" id="4428605">(</span><span class="ident" id="4428606">ret</span>&nbsp;<span class="ident" id="4428610">RDNSequence</span><span class="op" id="4428621">)</span>&nbsp;<span class="op" id="4428623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428626">ret</span>&nbsp;<span class="op" id="4428630">=</span>&nbsp;<span class="ident" id="4428632">appendRDNs</span><span class="op" id="4428642">(</span><span class="ident" id="4428643">ret</span><span class="op" id="4428646">,</span>&nbsp;<span class="ident" id="4428648">n</span><span class="op" id="4428649">.</span><span class="ident" id="4428650">Country</span><span class="op" id="4428657">,</span>&nbsp;<span class="ident" id="4428659">oidCountry</span><span class="op" id="4428669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428672">ret</span>&nbsp;<span class="op" id="4428676">=</span>&nbsp;<span class="ident" id="4428678">appendRDNs</span><span class="op" id="4428688">(</span><span class="ident" id="4428689">ret</span><span class="op" id="4428692">,</span>&nbsp;<span class="ident" id="4428694">n</span><span class="op" id="4428695">.</span><span class="ident" id="4428696">Organization</span><span class="op" id="4428708">,</span>&nbsp;<span class="ident" id="4428710">oidOrganization</span><span class="op" id="4428725">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428728">ret</span>&nbsp;<span class="op" id="4428732">=</span>&nbsp;<span class="ident" id="4428734">appendRDNs</span><span class="op" id="4428744">(</span><span class="ident" id="4428745">ret</span><span class="op" id="4428748">,</span>&nbsp;<span class="ident" id="4428750">n</span><span class="op" id="4428751">.</span><span class="ident" id="4428752">OrganizationalUnit</span><span class="op" id="4428770">,</span>&nbsp;<span class="ident" id="4428772">oidOrganizationalUnit</span><span class="op" id="4428793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428796">ret</span>&nbsp;<span class="op" id="4428800">=</span>&nbsp;<span class="ident" id="4428802">appendRDNs</span><span class="op" id="4428812">(</span><span class="ident" id="4428813">ret</span><span class="op" id="4428816">,</span>&nbsp;<span class="ident" id="4428818">n</span><span class="op" id="4428819">.</span><span class="ident" id="4428820">Locality</span><span class="op" id="4428828">,</span>&nbsp;<span class="ident" id="4428830">oidLocality</span><span class="op" id="4428841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428844">ret</span>&nbsp;<span class="op" id="4428848">=</span>&nbsp;<span class="ident" id="4428850">appendRDNs</span><span class="op" id="4428860">(</span><span class="ident" id="4428861">ret</span><span class="op" id="4428864">,</span>&nbsp;<span class="ident" id="4428866">n</span><span class="op" id="4428867">.</span><span class="ident" id="4428868">Province</span><span class="op" id="4428876">,</span>&nbsp;<span class="ident" id="4428878">oidProvince</span><span class="op" id="4428889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428892">ret</span>&nbsp;<span class="op" id="4428896">=</span>&nbsp;<span class="ident" id="4428898">appendRDNs</span><span class="op" id="4428908">(</span><span class="ident" id="4428909">ret</span><span class="op" id="4428912">,</span>&nbsp;<span class="ident" id="4428914">n</span><span class="op" id="4428915">.</span><span class="ident" id="4428916">StreetAddress</span><span class="op" id="4428929">,</span>&nbsp;<span class="ident" id="4428931">oidStreetAddress</span><span class="op" id="4428947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428950">ret</span>&nbsp;<span class="op" id="4428954">=</span>&nbsp;<span class="ident" id="4428956">appendRDNs</span><span class="op" id="4428966">(</span><span class="ident" id="4428967">ret</span><span class="op" id="4428970">,</span>&nbsp;<span class="ident" id="4428972">n</span><span class="op" id="4428973">.</span><span class="ident" id="4428974">PostalCode</span><span class="op" id="4428984">,</span>&nbsp;<span class="ident" id="4428986">oidPostalCode</span><span class="op" id="4428999">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429002">if</span>&nbsp;<span class="builtinfunc" id="4429005">len</span><span class="op" id="4429008">(</span><span class="ident" id="4429009">n</span><span class="op" id="4429010">.</span><span class="ident" id="4429011">CommonName</span><span class="op" id="4429021">)</span>&nbsp;<span class="op" id="4429023">&gt;</span>&nbsp;<span class="num" id="4429025">0</span>&nbsp;<span class="op" id="4429027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429031">ret</span>&nbsp;<span class="op" id="4429035">=</span>&nbsp;<span class="ident" id="4429037">appendRDNs</span><span class="op" id="4429047">(</span><span class="ident" id="4429048">ret</span><span class="op" id="4429051">,</span>&nbsp;<span class="op" id="4429053">[</span><span class="op" id="4429054">]</span><span class="builtintype" id="4429055">string</span><span class="op" id="4429061">{</span><span class="ident" id="4429062">n</span><span class="op" id="4429063">.</span><span class="ident" id="4429064">CommonName</span><span class="op" id="4429074">}</span><span class="op" id="4429075">,</span>&nbsp;<span class="ident" id="4429077">oidCommonName</span><span class="op" id="4429090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429096">if</span>&nbsp;<span class="builtinfunc" id="4429099">len</span><span class="op" id="4429102">(</span><span class="ident" id="4429103">n</span><span class="op" id="4429104">.</span><span class="ident" id="4429105">SerialNumber</span><span class="op" id="4429117">)</span>&nbsp;<span class="op" id="4429119">&gt;</span>&nbsp;<span class="num" id="4429121">0</span>&nbsp;<span class="op" id="4429123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429127">ret</span>&nbsp;<span class="op" id="4429131">=</span>&nbsp;<span class="ident" id="4429133">appendRDNs</span><span class="op" id="4429143">(</span><span class="ident" id="4429144">ret</span><span class="op" id="4429147">,</span>&nbsp;<span class="op" id="4429149">[</span><span class="op" id="4429150">]</span><span class="builtintype" id="4429151">string</span><span class="op" id="4429157">{</span><span class="ident" id="4429158">n</span><span class="op" id="4429159">.</span><span class="ident" id="4429160">SerialNumber</span><span class="op" id="4429172">}</span><span class="op" id="4429173">,</span>&nbsp;<span class="ident" id="4429175">oidSerialNumber</span><span class="op" id="4429190">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4429193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429197">return</span>&nbsp;<span class="ident" id="4429204">ret</span><br>
<span class="lineno"></span><span class="op" id="4429208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4429211">//&nbsp;CertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4429287">//&nbsp;5280,&nbsp;section&nbsp;5.1.&nbsp;Use&nbsp;Certificate.CheckCRLSignature&nbsp;to&nbsp;verify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4429357">//&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4429371">type</span>&nbsp;<span class="ident" id="4429376">CertificateList</span>&nbsp;<span class="keyword" id="4429392">struct</span>&nbsp;<span class="op" id="4429399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429402">TBSCertList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429421">TBSCertificateList</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429441">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4429460">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429481">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429500">asn1</span><span class="op" id="4429504">.</span><span class="ident" id="4429505">BitString</span><br>
<span class="lineno"></span><span class="op" id="4429515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4429518">//&nbsp;HasExpired&nbsp;reports&nbsp;whether&nbsp;now&nbsp;is&nbsp;past&nbsp;the&nbsp;expiry&nbsp;time&nbsp;of&nbsp;certList.</span><br>
<span class="lineno">155</span><span class="keyword" id="4429589">func</span>&nbsp;<span class="op" id="4429594">(</span><span class="ident" id="4429595">certList</span>&nbsp;<span class="op" id="4429604">*</span><span class="ident" id="4429605">CertificateList</span><span class="op" id="4429620">)</span>&nbsp;<span class="ident" id="4429622">HasExpired</span><span class="op" id="4429632">(</span><span class="ident" id="4429633">now</span>&nbsp;<span class="ident" id="4429637">time</span><span class="op" id="4429641">.</span><span class="ident" id="4429642">Time</span><span class="op" id="4429646">)</span>&nbsp;<span class="builtintype" id="4429648">bool</span>&nbsp;<span class="op" id="4429653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4429656">return</span>&nbsp;<span class="ident" id="4429663">now</span><span class="op" id="4429666">.</span><span class="ident" id="4429667">After</span><span class="op" id="4429672">(</span><span class="ident" id="4429673">certList</span><span class="op" id="4429681">.</span><span class="ident" id="4429682">TBSCertList</span><span class="op" id="4429693">.</span><span class="ident" id="4429694">NextUpdate</span><span class="op" id="4429704">)</span><br>
<span class="lineno"></span><span class="op" id="4429706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4429709">//&nbsp;TBSCertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno">160</span><span class="comment" id="4429788">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4429810">type</span>&nbsp;<span class="ident" id="4429815">TBSCertificateList</span>&nbsp;<span class="keyword" id="4429834">struct</span>&nbsp;<span class="op" id="4429841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429844">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429864">asn1</span><span class="op" id="4429868">.</span><span class="ident" id="4429869">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429881">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4429901">int</span>&nbsp;<span class="string" id="4429905">`asn1:&#34;optional,default:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429934">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429954">AlgorithmIdentifier</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4429975">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4429995">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430008">ThisUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430028">time</span><span class="op" id="4430032">.</span><span class="ident" id="4430033">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430039">NextUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4430059">time</span><span class="op" id="4430063">.</span><span class="ident" id="4430064">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4430080">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430099">RevokedCertificates</span>&nbsp;<span class="op" id="4430119">[</span><span class="op" id="4430120">]</span><span class="ident" id="4430121">RevokedCertificate</span>&nbsp;<span class="string" id="4430140">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430159">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4430179">[</span><span class="op" id="4430180">]</span><span class="ident" id="4430181">Extension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4430200">`asn1:&#34;tag:0,optional,explicit&#34;`</span><br>
<span class="lineno">170</span><span class="op" id="4430233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4430236">//&nbsp;RevokedCertificate&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4430315">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4430337">type</span>&nbsp;<span class="ident" id="4430342">RevokedCertificate</span>&nbsp;<span class="keyword" id="4430361">struct</span>&nbsp;<span class="op" id="4430368">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430371">SerialNumber</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4430386">*</span><span class="ident" id="4430387">big</span><span class="op" id="4430390">.</span><span class="ident" id="4430391">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430396">RevocationTime</span>&nbsp;<span class="ident" id="4430411">time</span><span class="op" id="4430415">.</span><span class="ident" id="4430416">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4430422">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4430437">[</span><span class="op" id="4430438">]</span><span class="ident" id="4430439">Extension</span>&nbsp;<span class="string" id="4430449">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4430467">}</span>
</div>
</body>
</html>
