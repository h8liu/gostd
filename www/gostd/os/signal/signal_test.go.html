<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os/signal</h2>
<ul>
<li><a href="/gostd/os/signal/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/os/signal/signal.go.html">signal.go</a></li>
<li><a href="/gostd/os/signal/signal_test.go.html" class="current">signal_test.go</a></li>
<li><a href="/gostd/os/signal/signal_unix.go.html">signal_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7258096">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7258151">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7258205">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7258256">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7258321">package</span>&nbsp;<span class="ident" id="7258329">signal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7258337">import</span>&nbsp;<span class="op" id="7258344">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258347">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258355">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258368">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258374">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258385">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258396">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258407">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258418">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7258429">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7258436">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7258439">func</span>&nbsp;<span class="ident" id="7258444">waitSig</span><span class="op" id="7258451">(</span><span class="ident" id="7258452">t</span>&nbsp;<span class="op" id="7258454">*</span><span class="ident" id="7258455"><a href="/gostd/os/signal/signal_test.go.html#7258418">testing</a></span><span class="op" id="7258462">.</span><span class="ident" id="7258463"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7258464">,</span>&nbsp;<span class="ident" id="7258466">c</span>&nbsp;<span class="op" id="7258468">&lt;-</span><span class="keyword" id="7258470">chan</span>&nbsp;<span class="ident" id="7258475"><a href="/gostd/os/signal/signal_test.go.html#7258368">os</a></span><span class="op" id="7258477">.</span><span class="ident" id="7258478"><a href="/gostd/os/exec.go.html#2435118">Signal</a></span><span class="op" id="7258484">,</span>&nbsp;<span class="ident" id="7258486">sig</span>&nbsp;<span class="ident" id="7258490"><a href="/gostd/os/signal/signal_test.go.html#7258368">os</a></span><span class="op" id="7258492">.</span><span class="ident" id="7258493"><a href="/gostd/os/exec.go.html#2435118">Signal</a></span><span class="op" id="7258499">)</span>&nbsp;<span class="op" id="7258501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7258504">select</span>&nbsp;<span class="op" id="7258511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7258514">case</span>&nbsp;<span class="ident" id="7258519">s</span>&nbsp;<span class="op" id="7258521">:=</span>&nbsp;<span class="op" id="7258524">&lt;-</span><span class="ident" id="7258526"><a href="/gostd/os/signal/signal_test.go.html#7258466">c</a></span><span class="op" id="7258527">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7258531">if</span>&nbsp;<span class="ident" id="7258534"><a href="/gostd/os/signal/signal_test.go.html#7258519">s</a></span>&nbsp;<span class="op" id="7258536">!=</span>&nbsp;<span class="ident" id="7258539"><a href="/gostd/os/signal/signal_test.go.html#7258486">sig</a></span>&nbsp;<span class="op" id="7258543">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7258548"><a href="/gostd/os/signal/signal_test.go.html#7258452">t</a></span><span class="op" id="7258549">.</span><span class="ident" id="7258550"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7258556">(</span><span class="string" id="7258557">&#34;signal&nbsp;was&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7258581">,</span>&nbsp;<span class="ident" id="7258583"><a href="/gostd/os/signal/signal_test.go.html#7258519">s</a></span><span class="op" id="7258584">,</span>&nbsp;<span class="ident" id="7258586"><a href="/gostd/os/signal/signal_test.go.html#7258486">sig</a></span><span class="op" id="7258589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7258593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7258596">case</span>&nbsp;<span class="op" id="7258601">&lt;-</span><span class="ident" id="7258603"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7258607">.</span><span class="ident" id="7258608"><a href="/gostd/time/sleep.go.html#2716644">After</a></span><span class="op" id="7258613">(</span><span class="num" id="7258614">1</span>&nbsp;<span class="op" id="7258616">*</span>&nbsp;<span class="ident" id="7258618"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7258622">.</span><span class="ident" id="7258623"><a href="/gostd/time/time.go.html#2734862">Second</a></span><span class="op" id="7258629">)</span><span class="op" id="7258630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7258634"><a href="/gostd/os/signal/signal_test.go.html#7258452">t</a></span><span class="op" id="7258635">.</span><span class="ident" id="7258636"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7258642">(</span><span class="string" id="7258643">&#34;timeout&nbsp;waiting&nbsp;for&nbsp;%v&#34;</span><span class="op" id="7258667">,</span>&nbsp;<span class="ident" id="7258669"><a href="/gostd/os/signal/signal_test.go.html#7258486">sig</a></span><span class="op" id="7258672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7258675">}</span><br>
<span class="lineno">30</span><span class="op" id="7258677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7258680">//&nbsp;Test&nbsp;that&nbsp;basic&nbsp;signal&nbsp;handling&nbsp;works.</span><br>
<span class="lineno"></span><span class="keyword" id="7258722">func</span>&nbsp;<span class="ident" id="7258727">TestSignal</span><span class="op" id="7258737">(</span><span class="ident" id="7258738">t</span>&nbsp;<span class="op" id="7258740">*</span><span class="ident" id="7258741"><a href="/gostd/os/signal/signal_test.go.html#7258418">testing</a></span><span class="op" id="7258748">.</span><span class="ident" id="7258749"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7258750">)</span>&nbsp;<span class="op" id="7258752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7258755">//&nbsp;Ask&nbsp;for&nbsp;SIGHUP</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7258774">c</span>&nbsp;<span class="op" id="7258776">:=</span>&nbsp;<span class="builtinfunc" id="7258779">make</span><span class="op" id="7258783">(</span><span class="keyword" id="7258784">chan</span>&nbsp;<span class="ident" id="7258789"><a href="/gostd/os/signal/signal_test.go.html#7258368">os</a></span><span class="op" id="7258791">.</span><span class="ident" id="7258792"><a href="/gostd/os/exec.go.html#2435118">Signal</a></span><span class="op" id="7258798">,</span>&nbsp;<span class="num" id="7258800">1</span><span class="op" id="7258801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7258804"><a href="/gostd/os/signal/signal.go.html#5436636">Notify</a></span><span class="op" id="7258810">(</span><span class="ident" id="7258811"><a href="/gostd/os/signal/signal_test.go.html#7258774">c</a></span><span class="op" id="7258812">,</span>&nbsp;<span class="ident" id="7258814"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7258821">.</span><span class="ident" id="7258822"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604436">SIGHUP</a></span><span class="op" id="7258828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7258831">defer</span>&nbsp;<span class="ident" id="7258837"><a href="/gostd/os/signal/signal.go.html#5437456">Stop</a></span><span class="op" id="7258841">(</span><span class="ident" id="7258842"><a href="/gostd/os/signal/signal_test.go.html#7258774">c</a></span><span class="op" id="7258843">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7258847">//&nbsp;Send&nbsp;this&nbsp;process&nbsp;a&nbsp;SIGHUP</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7258878"><a href="/gostd/os/signal/signal_test.go.html#7258738">t</a></span><span class="op" id="7258879">.</span><span class="ident" id="7258880"><a href="/gostd/testing/testing.go.html#5479816">Logf</a></span><span class="op" id="7258884">(</span><span class="string" id="7258885">&#34;sighup...&#34;</span><span class="op" id="7258896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7258899"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7258906">.</span><span class="ident" id="7258907"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2625646">Kill</a></span><span class="op" id="7258911">(</span><span class="ident" id="7258912"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7258919">.</span><span class="ident" id="7258920"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2622832">Getpid</a></span><span class="op" id="7258926">(</span><span class="op" id="7258927">)</span><span class="op" id="7258928">,</span>&nbsp;<span class="ident" id="7258930"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7258937">.</span><span class="ident" id="7258938"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604436">SIGHUP</a></span><span class="op" id="7258944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7258947"><a href="/gostd/os/signal/signal_test.go.html#7258444">waitSig</a></span><span class="op" id="7258954">(</span><span class="ident" id="7258955"><a href="/gostd/os/signal/signal_test.go.html#7258738">t</a></span><span class="op" id="7258956">,</span>&nbsp;<span class="ident" id="7258958"><a href="/gostd/os/signal/signal_test.go.html#7258774">c</a></span><span class="op" id="7258959">,</span>&nbsp;<span class="ident" id="7258961"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7258968">.</span><span class="ident" id="7258969"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604436">SIGHUP</a></span><span class="op" id="7258975">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7258979">//&nbsp;Ask&nbsp;for&nbsp;everything&nbsp;we&nbsp;can&nbsp;get.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259014">c1</span>&nbsp;<span class="op" id="7259017">:=</span>&nbsp;<span class="builtinfunc" id="7259020">make</span><span class="op" id="7259024">(</span><span class="keyword" id="7259025">chan</span>&nbsp;<span class="ident" id="7259030"><a href="/gostd/os/signal/signal_test.go.html#7258368">os</a></span><span class="op" id="7259032">.</span><span class="ident" id="7259033"><a href="/gostd/os/exec.go.html#2435118">Signal</a></span><span class="op" id="7259039">,</span>&nbsp;<span class="num" id="7259041">1</span><span class="op" id="7259042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259045"><a href="/gostd/os/signal/signal.go.html#5436636">Notify</a></span><span class="op" id="7259051">(</span><span class="ident" id="7259052"><a href="/gostd/os/signal/signal_test.go.html#7259014">c1</a></span><span class="op" id="7259054">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7259058">//&nbsp;Send&nbsp;this&nbsp;process&nbsp;a&nbsp;SIGWINCH</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259091"><a href="/gostd/os/signal/signal_test.go.html#7258738">t</a></span><span class="op" id="7259092">.</span><span class="ident" id="7259093"><a href="/gostd/testing/testing.go.html#5479816">Logf</a></span><span class="op" id="7259097">(</span><span class="string" id="7259098">&#34;sigwinch...&#34;</span><span class="op" id="7259111">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259114"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259121">.</span><span class="ident" id="7259122"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2625646">Kill</a></span><span class="op" id="7259126">(</span><span class="ident" id="7259127"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259134">.</span><span class="ident" id="7259135"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2622832">Getpid</a></span><span class="op" id="7259141">(</span><span class="op" id="7259142">)</span><span class="op" id="7259143">,</span>&nbsp;<span class="ident" id="7259145"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259152">.</span><span class="ident" id="7259153"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2605074">SIGWINCH</a></span><span class="op" id="7259161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259164"><a href="/gostd/os/signal/signal_test.go.html#7258444">waitSig</a></span><span class="op" id="7259171">(</span><span class="ident" id="7259172"><a href="/gostd/os/signal/signal_test.go.html#7258738">t</a></span><span class="op" id="7259173">,</span>&nbsp;<span class="ident" id="7259175"><a href="/gostd/os/signal/signal_test.go.html#7259014">c1</a></span><span class="op" id="7259177">,</span>&nbsp;<span class="ident" id="7259179"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259186">.</span><span class="ident" id="7259187"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2605074">SIGWINCH</a></span><span class="op" id="7259195">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7259199">//&nbsp;Send&nbsp;two&nbsp;more&nbsp;SIGHUPs,&nbsp;to&nbsp;make&nbsp;sure&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7259244">//&nbsp;they&nbsp;get&nbsp;delivered&nbsp;on&nbsp;c1&nbsp;and&nbsp;that&nbsp;not&nbsp;reading</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7259294">//&nbsp;from&nbsp;c&nbsp;does&nbsp;not&nbsp;block&nbsp;everything.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259332"><a href="/gostd/os/signal/signal_test.go.html#7258738">t</a></span><span class="op" id="7259333">.</span><span class="ident" id="7259334"><a href="/gostd/testing/testing.go.html#5479816">Logf</a></span><span class="op" id="7259338">(</span><span class="string" id="7259339">&#34;sighup...&#34;</span><span class="op" id="7259350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259353"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259360">.</span><span class="ident" id="7259361"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2625646">Kill</a></span><span class="op" id="7259365">(</span><span class="ident" id="7259366"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259373">.</span><span class="ident" id="7259374"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2622832">Getpid</a></span><span class="op" id="7259380">(</span><span class="op" id="7259381">)</span><span class="op" id="7259382">,</span>&nbsp;<span class="ident" id="7259384"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259391">.</span><span class="ident" id="7259392"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604436">SIGHUP</a></span><span class="op" id="7259398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259401"><a href="/gostd/os/signal/signal_test.go.html#7258444">waitSig</a></span><span class="op" id="7259408">(</span><span class="ident" id="7259409"><a href="/gostd/os/signal/signal_test.go.html#7258738">t</a></span><span class="op" id="7259410">,</span>&nbsp;<span class="ident" id="7259412"><a href="/gostd/os/signal/signal_test.go.html#7259014">c1</a></span><span class="op" id="7259414">,</span>&nbsp;<span class="ident" id="7259416"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259423">.</span><span class="ident" id="7259424"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604436">SIGHUP</a></span><span class="op" id="7259430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259433"><a href="/gostd/os/signal/signal_test.go.html#7258738">t</a></span><span class="op" id="7259434">.</span><span class="ident" id="7259435"><a href="/gostd/testing/testing.go.html#5479816">Logf</a></span><span class="op" id="7259439">(</span><span class="string" id="7259440">&#34;sighup...&#34;</span><span class="op" id="7259451">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259454"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259461">.</span><span class="ident" id="7259462"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2625646">Kill</a></span><span class="op" id="7259466">(</span><span class="ident" id="7259467"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259474">.</span><span class="ident" id="7259475"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2622832">Getpid</a></span><span class="op" id="7259481">(</span><span class="op" id="7259482">)</span><span class="op" id="7259483">,</span>&nbsp;<span class="ident" id="7259485"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259492">.</span><span class="ident" id="7259493"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604436">SIGHUP</a></span><span class="op" id="7259499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259502"><a href="/gostd/os/signal/signal_test.go.html#7258444">waitSig</a></span><span class="op" id="7259509">(</span><span class="ident" id="7259510"><a href="/gostd/os/signal/signal_test.go.html#7258738">t</a></span><span class="op" id="7259511">,</span>&nbsp;<span class="ident" id="7259513"><a href="/gostd/os/signal/signal_test.go.html#7259014">c1</a></span><span class="op" id="7259515">,</span>&nbsp;<span class="ident" id="7259517"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259524">.</span><span class="ident" id="7259525"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604436">SIGHUP</a></span><span class="op" id="7259531">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7259535">//&nbsp;The&nbsp;first&nbsp;SIGHUP&nbsp;should&nbsp;be&nbsp;waiting&nbsp;for&nbsp;us&nbsp;on&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259587"><a href="/gostd/os/signal/signal_test.go.html#7258444">waitSig</a></span><span class="op" id="7259594">(</span><span class="ident" id="7259595"><a href="/gostd/os/signal/signal_test.go.html#7258738">t</a></span><span class="op" id="7259596">,</span>&nbsp;<span class="ident" id="7259598"><a href="/gostd/os/signal/signal_test.go.html#7258774">c</a></span><span class="op" id="7259599">,</span>&nbsp;<span class="ident" id="7259601"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259608">.</span><span class="ident" id="7259609"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604436">SIGHUP</a></span><span class="op" id="7259615">)</span><br>
<span class="lineno">65</span><span class="op" id="7259617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7259620">func</span>&nbsp;<span class="ident" id="7259625">TestStress</span><span class="op" id="7259635">(</span><span class="ident" id="7259636">t</span>&nbsp;<span class="op" id="7259638">*</span><span class="ident" id="7259639"><a href="/gostd/os/signal/signal_test.go.html#7258418">testing</a></span><span class="op" id="7259646">.</span><span class="ident" id="7259647"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7259648">)</span>&nbsp;<span class="op" id="7259650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259653">dur</span>&nbsp;<span class="op" id="7259657">:=</span>&nbsp;<span class="num" id="7259660">3</span>&nbsp;<span class="op" id="7259662">*</span>&nbsp;<span class="ident" id="7259664"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7259668">.</span><span class="ident" id="7259669"><a href="/gostd/time/time.go.html#2734862">Second</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7259677">if</span>&nbsp;<span class="ident" id="7259680"><a href="/gostd/os/signal/signal_test.go.html#7258418">testing</a></span><span class="op" id="7259687">.</span><span class="ident" id="7259688"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="7259693">(</span><span class="op" id="7259694">)</span>&nbsp;<span class="op" id="7259696">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259700"><a href="/gostd/os/signal/signal_test.go.html#7259653">dur</a></span>&nbsp;<span class="op" id="7259704">=</span>&nbsp;<span class="num" id="7259706">100</span>&nbsp;<span class="op" id="7259710">*</span>&nbsp;<span class="ident" id="7259712"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7259716">.</span><span class="ident" id="7259717"><a href="/gostd/time/time.go.html#2734819">Millisecond</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7259730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7259733">defer</span>&nbsp;<span class="ident" id="7259739"><a href="/gostd/os/signal/signal_test.go.html#7258385">runtime</a></span><span class="op" id="7259746">.</span><span class="ident" id="7259747"><a href="/gostd/runtime/debug.go.html#1521359">GOMAXPROCS</a></span><span class="op" id="7259757">(</span><span class="ident" id="7259758"><a href="/gostd/os/signal/signal_test.go.html#7258385">runtime</a></span><span class="op" id="7259765">.</span><span class="ident" id="7259766"><a href="/gostd/runtime/debug.go.html#1521359">GOMAXPROCS</a></span><span class="op" id="7259776">(</span><span class="num" id="7259777">4</span><span class="op" id="7259778">)</span><span class="op" id="7259779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259782">done</span>&nbsp;<span class="op" id="7259787">:=</span>&nbsp;<span class="builtinfunc" id="7259790">make</span><span class="op" id="7259794">(</span><span class="keyword" id="7259795">chan</span>&nbsp;<span class="builtintype" id="7259800">bool</span><span class="op" id="7259804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259807">finished</span>&nbsp;<span class="op" id="7259816">:=</span>&nbsp;<span class="builtinfunc" id="7259819">make</span><span class="op" id="7259823">(</span><span class="keyword" id="7259824">chan</span>&nbsp;<span class="builtintype" id="7259829">bool</span><span class="op" id="7259833">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7259836">go</span>&nbsp;<span class="keyword" id="7259839">func</span><span class="op" id="7259843">(</span><span class="op" id="7259844">)</span>&nbsp;<span class="op" id="7259846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259850">sig</span>&nbsp;<span class="op" id="7259854">:=</span>&nbsp;<span class="builtinfunc" id="7259857">make</span><span class="op" id="7259861">(</span><span class="keyword" id="7259862">chan</span>&nbsp;<span class="ident" id="7259867"><a href="/gostd/os/signal/signal_test.go.html#7258368">os</a></span><span class="op" id="7259869">.</span><span class="ident" id="7259870"><a href="/gostd/os/exec.go.html#2435118">Signal</a></span><span class="op" id="7259876">,</span>&nbsp;<span class="num" id="7259878">1</span><span class="op" id="7259879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259883"><a href="/gostd/os/signal/signal.go.html#5436636">Notify</a></span><span class="op" id="7259889">(</span><span class="ident" id="7259890"><a href="/gostd/os/signal/signal_test.go.html#7259850">sig</a></span><span class="op" id="7259893">,</span>&nbsp;<span class="ident" id="7259895"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7259902">.</span><span class="ident" id="7259903"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604998">SIGUSR1</a></span><span class="op" id="7259910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7259914">defer</span>&nbsp;<span class="ident" id="7259920"><a href="/gostd/os/signal/signal.go.html#5437456">Stop</a></span><span class="op" id="7259924">(</span><span class="ident" id="7259925"><a href="/gostd/os/signal/signal_test.go.html#7259850">sig</a></span><span class="op" id="7259928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7259931">Loop</span><span class="op" id="7259935">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7259939">for</span>&nbsp;<span class="op" id="7259943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7259948">select</span>&nbsp;<span class="op" id="7259955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7259960">case</span>&nbsp;<span class="op" id="7259965">&lt;-</span><span class="ident" id="7259967"><a href="/gostd/os/signal/signal_test.go.html#7259850">sig</a></span><span class="op" id="7259970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7259975">case</span>&nbsp;<span class="op" id="7259980">&lt;-</span><span class="ident" id="7259982"><a href="/gostd/os/signal/signal_test.go.html#7259782">done</a></span><span class="op" id="7259986">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7259992">break</span>&nbsp;<span class="ident" id="7259998"><a href="/gostd/os/signal/signal_test.go.html#7259931">Loop</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7260006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7260010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260014"><a href="/gostd/os/signal/signal_test.go.html#7259807">finished</a></span>&nbsp;<span class="op" id="7260023">&lt;-</span>&nbsp;<span class="builtintype" id="7260026">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7260032">}</span><span class="op" id="7260033">(</span><span class="op" id="7260034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7260037">go</span>&nbsp;<span class="keyword" id="7260040">func</span><span class="op" id="7260044">(</span><span class="op" id="7260045">)</span>&nbsp;<span class="op" id="7260047">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260050">Loop</span><span class="op" id="7260054">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7260058">for</span>&nbsp;<span class="op" id="7260062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7260067">select</span>&nbsp;<span class="op" id="7260074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7260079">case</span>&nbsp;<span class="op" id="7260084">&lt;-</span><span class="ident" id="7260086"><a href="/gostd/os/signal/signal_test.go.html#7259782">done</a></span><span class="op" id="7260090">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7260096">break</span>&nbsp;<span class="ident" id="7260102"><a href="/gostd/os/signal/signal_test.go.html#7260050">Loop</a></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7260110">default</span><span class="op" id="7260117">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260123"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7260130">.</span><span class="ident" id="7260131"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2625646">Kill</a></span><span class="op" id="7260135">(</span><span class="ident" id="7260136"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7260143">.</span><span class="ident" id="7260144"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2622832">Getpid</a></span><span class="op" id="7260150">(</span><span class="op" id="7260151">)</span><span class="op" id="7260152">,</span>&nbsp;<span class="ident" id="7260154"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7260161">.</span><span class="ident" id="7260162"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604998">SIGUSR1</a></span><span class="op" id="7260169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260175"><a href="/gostd/os/signal/signal_test.go.html#7258385">runtime</a></span><span class="op" id="7260182">.</span><span class="ident" id="7260183"><a href="/gostd/runtime/proc.go.html#1673108">Gosched</a></span><span class="op" id="7260190">(</span><span class="op" id="7260191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7260196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7260200">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260204"><a href="/gostd/os/signal/signal_test.go.html#7259807">finished</a></span>&nbsp;<span class="op" id="7260213">&lt;-</span>&nbsp;<span class="builtintype" id="7260216">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7260222">}</span><span class="op" id="7260223">(</span><span class="op" id="7260224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260227"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7260231">.</span><span class="ident" id="7260232"><a href="/gostd/time/sleep.go.html#2713940">Sleep</a></span><span class="op" id="7260237">(</span><span class="ident" id="7260238"><a href="/gostd/os/signal/signal_test.go.html#7259653">dur</a></span><span class="op" id="7260241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7260244">close</span><span class="op" id="7260249">(</span><span class="ident" id="7260250"><a href="/gostd/os/signal/signal_test.go.html#7259782">done</a></span><span class="op" id="7260254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7260257">&lt;-</span><span class="ident" id="7260259"><a href="/gostd/os/signal/signal_test.go.html#7259807">finished</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7260269">&lt;-</span><span class="ident" id="7260271"><a href="/gostd/os/signal/signal_test.go.html#7259807">finished</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7260281">//&nbsp;When&nbsp;run&nbsp;with&nbsp;&#39;go&nbsp;test&nbsp;-cpu=1,2,4&#39;&nbsp;SIGUSR1&nbsp;from&nbsp;this&nbsp;test&nbsp;can&nbsp;slip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7260352">//&nbsp;into&nbsp;subsequent&nbsp;TestSignal()&nbsp;causing&nbsp;failure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7260402">//&nbsp;Sleep&nbsp;for&nbsp;a&nbsp;while&nbsp;to&nbsp;reduce&nbsp;the&nbsp;possibility&nbsp;of&nbsp;the&nbsp;failure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260466"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7260470">.</span><span class="ident" id="7260471"><a href="/gostd/time/sleep.go.html#2713940">Sleep</a></span><span class="op" id="7260476">(</span><span class="num" id="7260477">10</span>&nbsp;<span class="op" id="7260480">*</span>&nbsp;<span class="ident" id="7260482"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7260486">.</span><span class="ident" id="7260487"><a href="/gostd/time/time.go.html#2734819">Millisecond</a></span><span class="op" id="7260498">)</span><br>
<span class="lineno">110</span><span class="op" id="7260500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7260503">var</span>&nbsp;<span class="ident" id="7260507">sendUncaughtSighup</span>&nbsp;<span class="op" id="7260526">=</span>&nbsp;<span class="ident" id="7260528"><a href="/gostd/os/signal/signal_test.go.html#7258347">flag</a></span><span class="op" id="7260532">.</span><span class="ident" id="7260533"><a href="/gostd/flag/flag.go.html#3949535">Int</a></span><span class="op" id="7260536">(</span><span class="string" id="7260537">&#34;send_uncaught_sighup&#34;</span><span class="op" id="7260559">,</span>&nbsp;<span class="num" id="7260561">0</span><span class="op" id="7260562">,</span>&nbsp;<span class="string" id="7260564">&#34;send&nbsp;uncaught&nbsp;SIGHUP&nbsp;during&nbsp;TestStop&#34;</span><span class="op" id="7260602">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7260605">//&nbsp;Test&nbsp;that&nbsp;Stop&nbsp;cancels&nbsp;the&nbsp;channel&#39;s&nbsp;registrations.</span><br>
<span class="lineno">115</span><span class="keyword" id="7260660">func</span>&nbsp;<span class="ident" id="7260665">TestStop</span><span class="op" id="7260673">(</span><span class="ident" id="7260674">t</span>&nbsp;<span class="op" id="7260676">*</span><span class="ident" id="7260677"><a href="/gostd/os/signal/signal_test.go.html#7258418">testing</a></span><span class="op" id="7260684">.</span><span class="ident" id="7260685"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7260686">)</span>&nbsp;<span class="op" id="7260688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260691">sigs</span>&nbsp;<span class="op" id="7260696">:=</span>&nbsp;<span class="op" id="7260699">[</span><span class="op" id="7260700">]</span><span class="ident" id="7260701"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7260708">.</span><span class="ident" id="7260709"><a href="/gostd/syscall/syscall_unix.go.html#2546285">Signal</a></span><span class="op" id="7260715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260719"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7260726">.</span><span class="ident" id="7260727"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2605074">SIGWINCH</a></span><span class="op" id="7260735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260739"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7260746">.</span><span class="ident" id="7260747"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604436">SIGHUP</a></span><span class="op" id="7260753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7260756">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7260760">for</span>&nbsp;<span class="ident" id="7260764">_</span><span class="op" id="7260765">,</span>&nbsp;<span class="ident" id="7260767">sig</span>&nbsp;<span class="op" id="7260771">:=</span>&nbsp;<span class="keyword" id="7260774">range</span>&nbsp;<span class="ident" id="7260780"><a href="/gostd/os/signal/signal_test.go.html#7260691">sigs</a></span>&nbsp;<span class="op" id="7260785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7260789">//&nbsp;Send&nbsp;the&nbsp;signal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7260811">//&nbsp;If&nbsp;it&#39;s&nbsp;SIGWINCH,&nbsp;we&nbsp;should&nbsp;not&nbsp;see&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7260856">//&nbsp;If&nbsp;it&#39;s&nbsp;SIGHUP,&nbsp;maybe&nbsp;we&#39;ll&nbsp;die.&nbsp;Let&nbsp;the&nbsp;flag&nbsp;tell&nbsp;us&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7260927">if</span>&nbsp;<span class="ident" id="7260930"><a href="/gostd/os/signal/signal_test.go.html#7260767">sig</a></span>&nbsp;<span class="op" id="7260934">!=</span>&nbsp;<span class="ident" id="7260937"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7260944">.</span><span class="ident" id="7260945"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604436">SIGHUP</a></span>&nbsp;<span class="op" id="7260952">||</span>&nbsp;<span class="op" id="7260955">*</span><span class="ident" id="7260956"><a href="/gostd/os/signal/signal_test.go.html#7260507">sendUncaughtSighup</a></span>&nbsp;<span class="op" id="7260975">==</span>&nbsp;<span class="num" id="7260978">1</span>&nbsp;<span class="op" id="7260980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7260985"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7260992">.</span><span class="ident" id="7260993"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2625646">Kill</a></span><span class="op" id="7260997">(</span><span class="ident" id="7260998"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7261005">.</span><span class="ident" id="7261006"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2622832">Getpid</a></span><span class="op" id="7261012">(</span><span class="op" id="7261013">)</span><span class="op" id="7261014">,</span>&nbsp;<span class="ident" id="7261016"><a href="/gostd/os/signal/signal_test.go.html#7260767">sig</a></span><span class="op" id="7261019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7261023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261027"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7261031">.</span><span class="ident" id="7261032"><a href="/gostd/time/sleep.go.html#2713940">Sleep</a></span><span class="op" id="7261037">(</span><span class="num" id="7261038">100</span>&nbsp;<span class="op" id="7261042">*</span>&nbsp;<span class="ident" id="7261044"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7261048">.</span><span class="ident" id="7261049"><a href="/gostd/time/time.go.html#2734819">Millisecond</a></span><span class="op" id="7261060">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7261065">//&nbsp;Ask&nbsp;for&nbsp;signal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261085">c</span>&nbsp;<span class="op" id="7261087">:=</span>&nbsp;<span class="builtinfunc" id="7261090">make</span><span class="op" id="7261094">(</span><span class="keyword" id="7261095">chan</span>&nbsp;<span class="ident" id="7261100"><a href="/gostd/os/signal/signal_test.go.html#7258368">os</a></span><span class="op" id="7261102">.</span><span class="ident" id="7261103"><a href="/gostd/os/exec.go.html#2435118">Signal</a></span><span class="op" id="7261109">,</span>&nbsp;<span class="num" id="7261111">1</span><span class="op" id="7261112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261116"><a href="/gostd/os/signal/signal.go.html#5436636">Notify</a></span><span class="op" id="7261122">(</span><span class="ident" id="7261123"><a href="/gostd/os/signal/signal_test.go.html#7261085">c</a></span><span class="op" id="7261124">,</span>&nbsp;<span class="ident" id="7261126"><a href="/gostd/os/signal/signal_test.go.html#7260767">sig</a></span><span class="op" id="7261129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7261133">defer</span>&nbsp;<span class="ident" id="7261139"><a href="/gostd/os/signal/signal.go.html#5437456">Stop</a></span><span class="op" id="7261143">(</span><span class="ident" id="7261144"><a href="/gostd/os/signal/signal_test.go.html#7261085">c</a></span><span class="op" id="7261145">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7261150">//&nbsp;Send&nbsp;this&nbsp;process&nbsp;that&nbsp;signal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261185"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7261192">.</span><span class="ident" id="7261193"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2625646">Kill</a></span><span class="op" id="7261197">(</span><span class="ident" id="7261198"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7261205">.</span><span class="ident" id="7261206"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2622832">Getpid</a></span><span class="op" id="7261212">(</span><span class="op" id="7261213">)</span><span class="op" id="7261214">,</span>&nbsp;<span class="ident" id="7261216"><a href="/gostd/os/signal/signal_test.go.html#7260767">sig</a></span><span class="op" id="7261219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261223"><a href="/gostd/os/signal/signal_test.go.html#7258444">waitSig</a></span><span class="op" id="7261230">(</span><span class="ident" id="7261231"><a href="/gostd/os/signal/signal_test.go.html#7260674">t</a></span><span class="op" id="7261232">,</span>&nbsp;<span class="ident" id="7261234"><a href="/gostd/os/signal/signal_test.go.html#7261085">c</a></span><span class="op" id="7261235">,</span>&nbsp;<span class="ident" id="7261237"><a href="/gostd/os/signal/signal_test.go.html#7260767">sig</a></span><span class="op" id="7261240">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261245"><a href="/gostd/os/signal/signal.go.html#5437456">Stop</a></span><span class="op" id="7261249">(</span><span class="ident" id="7261250"><a href="/gostd/os/signal/signal_test.go.html#7261085">c</a></span><span class="op" id="7261251">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7261255">select</span>&nbsp;<span class="op" id="7261262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7261266">case</span>&nbsp;<span class="ident" id="7261271">s</span>&nbsp;<span class="op" id="7261273">:=</span>&nbsp;<span class="op" id="7261276">&lt;-</span><span class="ident" id="7261278"><a href="/gostd/os/signal/signal_test.go.html#7261085">c</a></span><span class="op" id="7261279">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261284"><a href="/gostd/os/signal/signal_test.go.html#7260674">t</a></span><span class="op" id="7261285">.</span><span class="ident" id="7261286"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7261292">(</span><span class="string" id="7261293">&#34;unexpected&nbsp;signal&nbsp;%v&#34;</span><span class="op" id="7261315">,</span>&nbsp;<span class="ident" id="7261317"><a href="/gostd/os/signal/signal_test.go.html#7261271">s</a></span><span class="op" id="7261318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7261322">case</span>&nbsp;<span class="op" id="7261327">&lt;-</span><span class="ident" id="7261329"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7261333">.</span><span class="ident" id="7261334"><a href="/gostd/time/sleep.go.html#2716644">After</a></span><span class="op" id="7261339">(</span><span class="num" id="7261340">100</span>&nbsp;<span class="op" id="7261344">*</span>&nbsp;<span class="ident" id="7261346"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7261350">.</span><span class="ident" id="7261351"><a href="/gostd/time/time.go.html#2734819">Millisecond</a></span><span class="op" id="7261362">)</span><span class="op" id="7261363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7261368">//&nbsp;nothing&nbsp;to&nbsp;read&nbsp;-&nbsp;good</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7261396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7261401">//&nbsp;Send&nbsp;the&nbsp;signal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7261423">//&nbsp;If&nbsp;it&#39;s&nbsp;SIGWINCH,&nbsp;we&nbsp;should&nbsp;not&nbsp;see&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7261468">//&nbsp;If&nbsp;it&#39;s&nbsp;SIGHUP,&nbsp;maybe&nbsp;we&#39;ll&nbsp;die.&nbsp;Let&nbsp;the&nbsp;flag&nbsp;tell&nbsp;us&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7261539">if</span>&nbsp;<span class="ident" id="7261542"><a href="/gostd/os/signal/signal_test.go.html#7260767">sig</a></span>&nbsp;<span class="op" id="7261546">!=</span>&nbsp;<span class="ident" id="7261549"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7261556">.</span><span class="ident" id="7261557"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604436">SIGHUP</a></span>&nbsp;<span class="op" id="7261564">||</span>&nbsp;<span class="op" id="7261567">*</span><span class="ident" id="7261568"><a href="/gostd/os/signal/signal_test.go.html#7260507">sendUncaughtSighup</a></span>&nbsp;<span class="op" id="7261587">==</span>&nbsp;<span class="num" id="7261590">2</span>&nbsp;<span class="op" id="7261592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261597"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7261604">.</span><span class="ident" id="7261605"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2625646">Kill</a></span><span class="op" id="7261609">(</span><span class="ident" id="7261610"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7261617">.</span><span class="ident" id="7261618"><a href="/gostd/syscall/zsyscall_linux_amd64.go.html#2622832">Getpid</a></span><span class="op" id="7261624">(</span><span class="op" id="7261625">)</span><span class="op" id="7261626">,</span>&nbsp;<span class="ident" id="7261628"><a href="/gostd/os/signal/signal_test.go.html#7260767">sig</a></span><span class="op" id="7261631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7261635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7261640">select</span>&nbsp;<span class="op" id="7261647">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7261651">case</span>&nbsp;<span class="ident" id="7261656">s</span>&nbsp;<span class="op" id="7261658">:=</span>&nbsp;<span class="op" id="7261661">&lt;-</span><span class="ident" id="7261663"><a href="/gostd/os/signal/signal_test.go.html#7261085">c</a></span><span class="op" id="7261664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7261669"><a href="/gostd/os/signal/signal_test.go.html#7260674">t</a></span><span class="op" id="7261670">.</span><span class="ident" id="7261671"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7261677">(</span><span class="string" id="7261678">&#34;unexpected&nbsp;signal&nbsp;%v&#34;</span><span class="op" id="7261700">,</span>&nbsp;<span class="ident" id="7261702"><a href="/gostd/os/signal/signal_test.go.html#7261656">s</a></span><span class="op" id="7261703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7261707">case</span>&nbsp;<span class="op" id="7261712">&lt;-</span><span class="ident" id="7261714"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7261718">.</span><span class="ident" id="7261719"><a href="/gostd/time/sleep.go.html#2716644">After</a></span><span class="op" id="7261724">(</span><span class="num" id="7261725">100</span>&nbsp;<span class="op" id="7261729">*</span>&nbsp;<span class="ident" id="7261731"><a href="/gostd/os/signal/signal_test.go.html#7258429">time</a></span><span class="op" id="7261735">.</span><span class="ident" id="7261736"><a href="/gostd/time/time.go.html#2734819">Millisecond</a></span><span class="op" id="7261747">)</span><span class="op" id="7261748">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7261753">//&nbsp;nothing&nbsp;to&nbsp;read&nbsp;-&nbsp;good</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7261781">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7261784">}</span><br>
<span class="lineno"></span><span class="op" id="7261786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7261789">//&nbsp;Test&nbsp;that&nbsp;when&nbsp;run&nbsp;under&nbsp;nohup,&nbsp;an&nbsp;uncaught&nbsp;SIGHUP&nbsp;does&nbsp;not&nbsp;kill&nbsp;the&nbsp;program,</span><br>
<span class="lineno"></span><span class="comment" id="7261870">//&nbsp;but&nbsp;a</span><br>
<span class="lineno">165</span><span class="keyword" id="7261879">func</span>&nbsp;<span class="ident" id="7261884">TestNohup</span><span class="op" id="7261893">(</span><span class="ident" id="7261894">t</span>&nbsp;<span class="op" id="7261896">*</span><span class="ident" id="7261897"><a href="/gostd/os/signal/signal_test.go.html#7258418">testing</a></span><span class="op" id="7261904">.</span><span class="ident" id="7261905"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7261906">)</span>&nbsp;<span class="op" id="7261908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7261911">//&nbsp;Ugly:&nbsp;ask&nbsp;for&nbsp;SIGHUP&nbsp;so&nbsp;that&nbsp;child&nbsp;will&nbsp;not&nbsp;have&nbsp;no-hup&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7261975">//&nbsp;even&nbsp;if&nbsp;test&nbsp;is&nbsp;running&nbsp;under&nbsp;nohup&nbsp;environment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262028">//&nbsp;We&nbsp;have&nbsp;no&nbsp;intention&nbsp;of&nbsp;reading&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262072">c</span>&nbsp;<span class="op" id="7262074">:=</span>&nbsp;<span class="builtinfunc" id="7262077">make</span><span class="op" id="7262081">(</span><span class="keyword" id="7262082">chan</span>&nbsp;<span class="ident" id="7262087"><a href="/gostd/os/signal/signal_test.go.html#7258368">os</a></span><span class="op" id="7262089">.</span><span class="ident" id="7262090"><a href="/gostd/os/exec.go.html#2435118">Signal</a></span><span class="op" id="7262096">,</span>&nbsp;<span class="num" id="7262098">1</span><span class="op" id="7262099">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262102"><a href="/gostd/os/signal/signal.go.html#5436636">Notify</a></span><span class="op" id="7262108">(</span><span class="ident" id="7262109"><a href="/gostd/os/signal/signal_test.go.html#7262072">c</a></span><span class="op" id="7262110">,</span>&nbsp;<span class="ident" id="7262112"><a href="/gostd/os/signal/signal_test.go.html#7258407">syscall</a></span><span class="op" id="7262119">.</span><span class="ident" id="7262120"><a href="/gostd/syscall/zerrors_linux_amd64.go.html#2604436">SIGHUP</a></span><span class="op" id="7262126">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262130">//&nbsp;When&nbsp;run&nbsp;without&nbsp;nohup,&nbsp;the&nbsp;test&nbsp;should&nbsp;crash&nbsp;on&nbsp;an&nbsp;uncaught&nbsp;SIGHUP.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262203">//&nbsp;When&nbsp;run&nbsp;under&nbsp;nohup,&nbsp;the&nbsp;test&nbsp;should&nbsp;ignore&nbsp;uncaught&nbsp;SIGHUPs,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262270">//&nbsp;because&nbsp;the&nbsp;runtime&nbsp;is&nbsp;not&nbsp;supposed&nbsp;to&nbsp;be&nbsp;listening&nbsp;for&nbsp;them.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262336">//&nbsp;Either&nbsp;way,&nbsp;TestStop&nbsp;should&nbsp;still&nbsp;be&nbsp;able&nbsp;to&nbsp;catch&nbsp;them&nbsp;when&nbsp;it&nbsp;wants&nbsp;them</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262415">//&nbsp;and&nbsp;then&nbsp;when&nbsp;it&nbsp;stops&nbsp;wanting&nbsp;them,&nbsp;the&nbsp;original&nbsp;behavior&nbsp;should&nbsp;resume.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262493">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262497">//&nbsp;send_uncaught_sighup=1&nbsp;sends&nbsp;the&nbsp;SIGHUP&nbsp;before&nbsp;starting&nbsp;to&nbsp;listen&nbsp;for&nbsp;SIGHUPs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262580">//&nbsp;send_uncaught_sighup=2&nbsp;sends&nbsp;the&nbsp;SIGHUP&nbsp;after&nbsp;no&nbsp;longer&nbsp;listening&nbsp;for&nbsp;SIGHUPs.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262663">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7262667">//&nbsp;Both&nbsp;should&nbsp;fail&nbsp;without&nbsp;nohup&nbsp;and&nbsp;succeed&nbsp;with&nbsp;nohup.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7262727">for</span>&nbsp;<span class="ident" id="7262731">i</span>&nbsp;<span class="op" id="7262733">:=</span>&nbsp;<span class="num" id="7262736">1</span><span class="op" id="7262737">;</span>&nbsp;<span class="ident" id="7262739"><a href="/gostd/os/signal/signal_test.go.html#7262731">i</a></span>&nbsp;<span class="op" id="7262741">&lt;=</span>&nbsp;<span class="num" id="7262744">2</span><span class="op" id="7262745">;</span>&nbsp;<span class="ident" id="7262747"><a href="/gostd/os/signal/signal_test.go.html#7262731">i</a></span><span class="op" id="7262748">++</span>&nbsp;<span class="op" id="7262751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262755">out</span><span class="op" id="7262758">,</span>&nbsp;<span class="ident" id="7262760">err</span>&nbsp;<span class="op" id="7262764">:=</span>&nbsp;<span class="ident" id="7262767"><a href="/gostd/os/signal/signal_test.go.html#7258374">exec</a></span><span class="op" id="7262771">.</span><span class="ident" id="7262772"><a href="/gostd/os/exec/exec.go.html#5581161">Command</a></span><span class="op" id="7262779">(</span><span class="ident" id="7262780"><a href="/gostd/os/signal/signal_test.go.html#7258368">os</a></span><span class="op" id="7262782">.</span><span class="ident" id="7262783"><a href="/gostd/os/proc.go.html#2468733">Args</a></span><span class="op" id="7262787">[</span><span class="num" id="7262788">0</span><span class="op" id="7262789">]</span><span class="op" id="7262790">,</span>&nbsp;<span class="string" id="7262792">&#34;-test.run=TestStop&#34;</span><span class="op" id="7262812">,</span>&nbsp;<span class="string" id="7262814">&#34;-send_uncaught_sighup=&#34;</span><span class="op" id="7262838">+</span><span class="ident" id="7262839"><a href="/gostd/os/signal/signal_test.go.html#7258396">strconv</a></span><span class="op" id="7262846">.</span><span class="ident" id="7262847"><a href="/gostd/strconv/itoa.go.html#2407288">Itoa</a></span><span class="op" id="7262851">(</span><span class="ident" id="7262852"><a href="/gostd/os/signal/signal_test.go.html#7262731">i</a></span><span class="op" id="7262853">)</span><span class="op" id="7262854">)</span><span class="op" id="7262855">.</span><span class="ident" id="7262856"><a href="/gostd/os/exec/exec.go.html#5587541">CombinedOutput</a></span><span class="op" id="7262870">(</span><span class="op" id="7262871">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7262875">if</span>&nbsp;<span class="ident" id="7262878"><a href="/gostd/os/signal/signal_test.go.html#7262760">err</a></span>&nbsp;<span class="op" id="7262882">==</span>&nbsp;<span class="builtintype" id="7262885">nil</span>&nbsp;<span class="op" id="7262889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7262894"><a href="/gostd/os/signal/signal_test.go.html#7261894">t</a></span><span class="op" id="7262895">.</span><span class="ident" id="7262896"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7262902">(</span><span class="string" id="7262903">&#34;ran&nbsp;test&nbsp;with&nbsp;-send_uncaught_sighup=%d&nbsp;and&nbsp;it&nbsp;succeeded:&nbsp;expected&nbsp;failure.\nOutput:\n%s&#34;</span><span class="op" id="7262992">,</span>&nbsp;<span class="ident" id="7262994"><a href="/gostd/os/signal/signal_test.go.html#7262731">i</a></span><span class="op" id="7262995">,</span>&nbsp;<span class="ident" id="7262997"><a href="/gostd/os/signal/signal_test.go.html#7262755">out</a></span><span class="op" id="7263000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7263004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7263007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263011"><a href="/gostd/os/signal/signal.go.html#5437456">Stop</a></span><span class="op" id="7263015">(</span><span class="ident" id="7263016"><a href="/gostd/os/signal/signal_test.go.html#7262072">c</a></span><span class="op" id="7263017">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7263021">//&nbsp;Again,&nbsp;this&nbsp;time&nbsp;with&nbsp;nohup,&nbsp;assuming&nbsp;we&nbsp;can&nbsp;find&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263079">_</span><span class="op" id="7263080">,</span>&nbsp;<span class="ident" id="7263082">err</span>&nbsp;<span class="op" id="7263086">:=</span>&nbsp;<span class="ident" id="7263089"><a href="/gostd/os/signal/signal_test.go.html#7258368">os</a></span><span class="op" id="7263091">.</span><span class="ident" id="7263092"><a href="/gostd/os/file_unix.go.html#2455511">Stat</a></span><span class="op" id="7263096">(</span><span class="string" id="7263097">&#34;/usr/bin/nohup&#34;</span><span class="op" id="7263113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7263116">if</span>&nbsp;<span class="ident" id="7263119"><a href="/gostd/os/signal/signal_test.go.html#7263082">err</a></span>&nbsp;<span class="op" id="7263123">!=</span>&nbsp;<span class="builtintype" id="7263126">nil</span>&nbsp;<span class="op" id="7263130">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263134"><a href="/gostd/os/signal/signal_test.go.html#7261894">t</a></span><span class="op" id="7263135">.</span><span class="ident" id="7263136"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="7263140">(</span><span class="string" id="7263141">&#34;cannot&nbsp;find&nbsp;nohup;&nbsp;skipping&nbsp;second&nbsp;half&nbsp;of&nbsp;test&#34;</span><span class="op" id="7263190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7263193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7263197">for</span>&nbsp;<span class="ident" id="7263201">i</span>&nbsp;<span class="op" id="7263203">:=</span>&nbsp;<span class="num" id="7263206">1</span><span class="op" id="7263207">;</span>&nbsp;<span class="ident" id="7263209"><a href="/gostd/os/signal/signal_test.go.html#7263201">i</a></span>&nbsp;<span class="op" id="7263211">&lt;=</span>&nbsp;<span class="num" id="7263214">2</span><span class="op" id="7263215">;</span>&nbsp;<span class="ident" id="7263217"><a href="/gostd/os/signal/signal_test.go.html#7263201">i</a></span><span class="op" id="7263218">++</span>&nbsp;<span class="op" id="7263221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263225"><a href="/gostd/os/signal/signal_test.go.html#7258368">os</a></span><span class="op" id="7263227">.</span><span class="ident" id="7263228"><a href="/gostd/os/file_unix.go.html#2459394">Remove</a></span><span class="op" id="7263234">(</span><span class="string" id="7263235">&#34;nohup.out&#34;</span><span class="op" id="7263246">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263250">out</span><span class="op" id="7263253">,</span>&nbsp;<span class="ident" id="7263255">err</span>&nbsp;<span class="op" id="7263259">:=</span>&nbsp;<span class="ident" id="7263262"><a href="/gostd/os/signal/signal_test.go.html#7258374">exec</a></span><span class="op" id="7263266">.</span><span class="ident" id="7263267"><a href="/gostd/os/exec/exec.go.html#5581161">Command</a></span><span class="op" id="7263274">(</span><span class="string" id="7263275">&#34;/usr/bin/nohup&#34;</span><span class="op" id="7263291">,</span>&nbsp;<span class="ident" id="7263293"><a href="/gostd/os/signal/signal_test.go.html#7258368">os</a></span><span class="op" id="7263295">.</span><span class="ident" id="7263296"><a href="/gostd/os/proc.go.html#2468733">Args</a></span><span class="op" id="7263300">[</span><span class="num" id="7263301">0</span><span class="op" id="7263302">]</span><span class="op" id="7263303">,</span>&nbsp;<span class="string" id="7263305">&#34;-test.run=TestStop&#34;</span><span class="op" id="7263325">,</span>&nbsp;<span class="string" id="7263327">&#34;-send_uncaught_sighup=&#34;</span><span class="op" id="7263351">+</span><span class="ident" id="7263352"><a href="/gostd/os/signal/signal_test.go.html#7258396">strconv</a></span><span class="op" id="7263359">.</span><span class="ident" id="7263360"><a href="/gostd/strconv/itoa.go.html#2407288">Itoa</a></span><span class="op" id="7263364">(</span><span class="ident" id="7263365"><a href="/gostd/os/signal/signal_test.go.html#7263201">i</a></span><span class="op" id="7263366">)</span><span class="op" id="7263367">)</span><span class="op" id="7263368">.</span><span class="ident" id="7263369"><a href="/gostd/os/exec/exec.go.html#5587541">CombinedOutput</a></span><span class="op" id="7263383">(</span><span class="op" id="7263384">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263389">data</span><span class="op" id="7263393">,</span>&nbsp;<span class="ident" id="7263395">_</span>&nbsp;<span class="op" id="7263397">:=</span>&nbsp;<span class="ident" id="7263400"><a href="/gostd/os/signal/signal_test.go.html#7258355">ioutil</a></span><span class="op" id="7263406">.</span><span class="ident" id="7263407"><a href="/gostd/io/ioutil/ioutil.go.html#3765434">ReadFile</a></span><span class="op" id="7263415">(</span><span class="string" id="7263416">&#34;nohup.out&#34;</span><span class="op" id="7263427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263431"><a href="/gostd/os/signal/signal_test.go.html#7258368">os</a></span><span class="op" id="7263433">.</span><span class="ident" id="7263434"><a href="/gostd/os/file_unix.go.html#2459394">Remove</a></span><span class="op" id="7263440">(</span><span class="string" id="7263441">&#34;nohup.out&#34;</span><span class="op" id="7263452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7263456">if</span>&nbsp;<span class="ident" id="7263459"><a href="/gostd/os/signal/signal_test.go.html#7263255">err</a></span>&nbsp;<span class="op" id="7263463">!=</span>&nbsp;<span class="builtintype" id="7263466">nil</span>&nbsp;<span class="op" id="7263470">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7263475"><a href="/gostd/os/signal/signal_test.go.html#7261894">t</a></span><span class="op" id="7263476">.</span><span class="ident" id="7263477"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7263483">(</span><span class="string" id="7263484">&#34;ran&nbsp;test&nbsp;with&nbsp;-send_uncaught_sighup=%d&nbsp;under&nbsp;nohup&nbsp;and&nbsp;it&nbsp;failed:&nbsp;expected&nbsp;success.\nError:&nbsp;%v\nOutput:\n%s%s&#34;</span><span class="op" id="7263595">,</span>&nbsp;<span class="ident" id="7263597"><a href="/gostd/os/signal/signal_test.go.html#7263201">i</a></span><span class="op" id="7263598">,</span>&nbsp;<span class="ident" id="7263600"><a href="/gostd/os/signal/signal_test.go.html#7263255">err</a></span><span class="op" id="7263603">,</span>&nbsp;<span class="ident" id="7263605"><a href="/gostd/os/signal/signal_test.go.html#7263250">out</a></span><span class="op" id="7263608">,</span>&nbsp;<span class="ident" id="7263610"><a href="/gostd/os/signal/signal_test.go.html#7263389">data</a></span><span class="op" id="7263614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7263618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7263621">}</span><br>
<span class="lineno"></span><span class="op" id="7263623">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
