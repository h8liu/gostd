<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html" class="current">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2648115">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2648170">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2648224">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2648275">package</span>&nbsp;<span class="ident" id="2648283">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2648289">import</span>&nbsp;<span class="op" id="2648296">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2648299">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2648307">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2648317">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2648320">//&nbsp;A&nbsp;Location&nbsp;maps&nbsp;time&nbsp;instants&nbsp;to&nbsp;the&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2648386">//&nbsp;Typically,&nbsp;the&nbsp;Location&nbsp;represents&nbsp;the&nbsp;collection&nbsp;of&nbsp;time&nbsp;offsets</span><br>
<span class="lineno"></span><span class="comment" id="2648455">//&nbsp;in&nbsp;use&nbsp;in&nbsp;a&nbsp;geographical&nbsp;area,&nbsp;such&nbsp;as&nbsp;CEST&nbsp;and&nbsp;CET&nbsp;for&nbsp;central&nbsp;Europe.</span><br>
<span class="lineno">15</span><span class="keyword" id="2648530">type</span>&nbsp;<span class="ident" id="2648535">Location</span>&nbsp;<span class="keyword" id="2648544">struct</span>&nbsp;<span class="op" id="2648551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2648554">name</span>&nbsp;<span class="builtintype" id="2648559">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2648567">zone</span>&nbsp;<span class="op" id="2648572">[</span><span class="op" id="2648573">]</span><span class="ident" id="2648574">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2648580">tx</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2648585">[</span><span class="op" id="2648586">]</span><span class="ident" id="2648587">zoneTrans</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2648599">//&nbsp;Most&nbsp;lookups&nbsp;will&nbsp;be&nbsp;for&nbsp;the&nbsp;current&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2648646">//&nbsp;To&nbsp;avoid&nbsp;the&nbsp;binary&nbsp;search&nbsp;through&nbsp;tx,&nbsp;keep&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2648696">//&nbsp;static&nbsp;one-element&nbsp;cache&nbsp;that&nbsp;gives&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2648748">//&nbsp;zone&nbsp;for&nbsp;the&nbsp;time&nbsp;when&nbsp;the&nbsp;Location&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2648801">//&nbsp;if&nbsp;cacheStart&nbsp;&lt;=&nbsp;t&nbsp;&lt;=&nbsp;cacheEnd,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2648837">//&nbsp;lookup&nbsp;can&nbsp;return&nbsp;cacheZone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2648870">//&nbsp;The&nbsp;units&nbsp;for&nbsp;cacheStart&nbsp;and&nbsp;cacheEnd&nbsp;are&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2648924">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC,&nbsp;to&nbsp;match&nbsp;the&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2648977">//&nbsp;to&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2648992">cacheStart</span>&nbsp;<span class="ident" id="2649003">int64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2649010">cacheEnd</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2649021">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2649028">cacheZone</span>&nbsp;&nbsp;<span class="op" id="2649039">*</span><span class="ident" id="2649040">zone</span><br>
<span class="lineno"></span><span class="op" id="2649045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2649048">//&nbsp;A&nbsp;zone&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;such&nbsp;as&nbsp;CEST&nbsp;or&nbsp;CET.</span><br>
<span class="lineno">35</span><span class="keyword" id="2649109">type</span>&nbsp;<span class="ident" id="2649114">zone</span>&nbsp;<span class="keyword" id="2649119">struct</span>&nbsp;<span class="op" id="2649126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2649129">name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2649136">string</span>&nbsp;<span class="comment" id="2649143">//&nbsp;abbreviated&nbsp;name,&nbsp;&#34;CET&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2649171">offset</span>&nbsp;<span class="builtintype" id="2649178">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2649185">//&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2649209">isDST</span>&nbsp;&nbsp;<span class="builtintype" id="2649216">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2649223">//&nbsp;is&nbsp;this&nbsp;zone&nbsp;Daylight&nbsp;Savings&nbsp;Time?</span><br>
<span class="lineno"></span><span class="op" id="2649262">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="2649265">//&nbsp;A&nbsp;zoneTrans&nbsp;represents&nbsp;a&nbsp;single&nbsp;time&nbsp;zone&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2649322">type</span>&nbsp;<span class="ident" id="2649327">zoneTrans</span>&nbsp;<span class="keyword" id="2649337">struct</span>&nbsp;<span class="op" id="2649344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2649347">when</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2649360">int64</span>&nbsp;<span class="comment" id="2649366">//&nbsp;transition&nbsp;time,&nbsp;in&nbsp;seconds&nbsp;since&nbsp;1970&nbsp;GMT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2649413">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2649426">uint8</span>&nbsp;<span class="comment" id="2649432">//&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;zone&nbsp;that&nbsp;goes&nbsp;into&nbsp;effect&nbsp;at&nbsp;that&nbsp;time</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2649493">isstd</span><span class="op" id="2649498">,</span>&nbsp;<span class="ident" id="2649500">isutc</span>&nbsp;<span class="builtintype" id="2649506">bool</span>&nbsp;&nbsp;<span class="comment" id="2649512">//&nbsp;ignored&nbsp;-&nbsp;no&nbsp;idea&nbsp;what&nbsp;these&nbsp;mean</span><br>
<span class="lineno"></span><span class="op" id="2649549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2649552">//&nbsp;alpha&nbsp;and&nbsp;omega&nbsp;are&nbsp;the&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;time&nbsp;for&nbsp;zone</span><br>
<span class="lineno"></span><span class="comment" id="2649614">//&nbsp;transitions.</span><br>
<span class="lineno">50</span><span class="keyword" id="2649630">const</span>&nbsp;<span class="op" id="2649636">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2649639">alpha</span>&nbsp;<span class="op" id="2649645">=</span>&nbsp;<span class="op" id="2649647">-</span><span class="num" id="2649648">1</span>&nbsp;<span class="op" id="2649650">&lt;&lt;</span>&nbsp;<span class="num" id="2649653">63</span>&nbsp;&nbsp;<span class="comment" id="2649657">//&nbsp;math.MinInt64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2649675">omega</span>&nbsp;<span class="op" id="2649681">=</span>&nbsp;<span class="num" id="2649683">1</span><span class="op" id="2649684">&lt;&lt;</span><span class="num" id="2649686">63</span>&nbsp;<span class="op" id="2649689">-</span>&nbsp;<span class="num" id="2649691">1</span>&nbsp;<span class="comment" id="2649693">//&nbsp;math.MaxInt64</span><br>
<span class="lineno"></span><span class="op" id="2649710">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="2649713">//&nbsp;UTC&nbsp;represents&nbsp;Universal&nbsp;Coordinated&nbsp;Time&nbsp;(UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2649765">var</span>&nbsp;<span class="ident" id="2649769">UTC</span>&nbsp;<span class="op" id="2649773">*</span><span class="ident" id="2649774">Location</span>&nbsp;<span class="op" id="2649783">=</span>&nbsp;<span class="op" id="2649785">&amp;</span><span class="ident" id="2649786">utcLoc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2649794">//&nbsp;utcLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;get&nbsp;can&nbsp;refer&nbsp;to&nbsp;&amp;utcLoc</span><br>
<span class="lineno"></span><span class="comment" id="2649849">//&nbsp;and&nbsp;ensure&nbsp;that&nbsp;it&nbsp;never&nbsp;returns&nbsp;a&nbsp;nil&nbsp;*Location,</span><br>
<span class="lineno">60</span><span class="comment" id="2649902">//&nbsp;even&nbsp;if&nbsp;a&nbsp;badly&nbsp;behaved&nbsp;client&nbsp;has&nbsp;changed&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2649953">var</span>&nbsp;<span class="ident" id="2649957">utcLoc</span>&nbsp;<span class="op" id="2649964">=</span>&nbsp;<span class="ident" id="2649966">Location</span><span class="op" id="2649974">{</span><span class="ident" id="2649975">name</span><span class="op" id="2649979">:</span>&nbsp;<span class="string" id="2649981">&#34;UTC&#34;</span><span class="op" id="2649986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2649989">//&nbsp;Local&nbsp;represents&nbsp;the&nbsp;system&#39;s&nbsp;local&nbsp;time&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2650039">var</span>&nbsp;<span class="ident" id="2650043">Local</span>&nbsp;<span class="op" id="2650049">*</span><span class="ident" id="2650050">Location</span>&nbsp;<span class="op" id="2650059">=</span>&nbsp;<span class="op" id="2650061">&amp;</span><span class="ident" id="2650062">localLoc</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="2650072">//&nbsp;localLoc&nbsp;is&nbsp;separate&nbsp;so&nbsp;that&nbsp;initLocal&nbsp;can&nbsp;initialize</span><br>
<span class="lineno"></span><span class="comment" id="2650129">//&nbsp;it&nbsp;even&nbsp;if&nbsp;a&nbsp;client&nbsp;has&nbsp;changed&nbsp;Local.</span><br>
<span class="lineno"></span><span class="keyword" id="2650171">var</span>&nbsp;<span class="ident" id="2650175">localLoc</span>&nbsp;<span class="ident" id="2650184">Location</span><br>
<span class="lineno"></span><span class="keyword" id="2650193">var</span>&nbsp;<span class="ident" id="2650197">localOnce</span>&nbsp;<span class="ident" id="2650207">sync</span><span class="op" id="2650211">.</span><span class="ident" id="2650212">Once</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2650218">func</span>&nbsp;<span class="op" id="2650223">(</span><span class="ident" id="2650224">l</span>&nbsp;<span class="op" id="2650226">*</span><span class="ident" id="2650227">Location</span><span class="op" id="2650235">)</span>&nbsp;<span class="ident" id="2650237">get</span><span class="op" id="2650240">(</span><span class="op" id="2650241">)</span>&nbsp;<span class="op" id="2650243">*</span><span class="ident" id="2650244">Location</span>&nbsp;<span class="op" id="2650253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2650256">if</span>&nbsp;<span class="ident" id="2650259">l</span>&nbsp;<span class="op" id="2650261">==</span>&nbsp;<span class="builtintype" id="2650264">nil</span>&nbsp;<span class="op" id="2650268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2650272">return</span>&nbsp;<span class="op" id="2650279">&amp;</span><span class="ident" id="2650280">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2650288">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2650291">if</span>&nbsp;<span class="ident" id="2650294">l</span>&nbsp;<span class="op" id="2650296">==</span>&nbsp;<span class="op" id="2650299">&amp;</span><span class="ident" id="2650300">localLoc</span>&nbsp;<span class="op" id="2650309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2650313">localOnce</span><span class="op" id="2650322">.</span><span class="ident" id="2650323">Do</span><span class="op" id="2650325">(</span><span class="ident" id="2650326">initLocal</span><span class="op" id="2650335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2650338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2650341">return</span>&nbsp;<span class="ident" id="2650348">l</span><br>
<span class="lineno"></span><span class="op" id="2650350">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="2650353">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;descriptive&nbsp;name&nbsp;for&nbsp;the&nbsp;time&nbsp;zone&nbsp;information,</span><br>
<span class="lineno"></span><span class="comment" id="2650421">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;argument&nbsp;to&nbsp;LoadLocation.</span><br>
<span class="lineno"></span><span class="keyword" id="2650471">func</span>&nbsp;<span class="op" id="2650476">(</span><span class="ident" id="2650477">l</span>&nbsp;<span class="op" id="2650479">*</span><span class="ident" id="2650480">Location</span><span class="op" id="2650488">)</span>&nbsp;<span class="ident" id="2650490">String</span><span class="op" id="2650496">(</span><span class="op" id="2650497">)</span>&nbsp;<span class="builtintype" id="2650499">string</span>&nbsp;<span class="op" id="2650506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2650509">return</span>&nbsp;<span class="ident" id="2650516">l</span><span class="op" id="2650517">.</span><span class="ident" id="2650518">get</span><span class="op" id="2650521">(</span><span class="op" id="2650522">)</span><span class="op" id="2650523">.</span><span class="ident" id="2650524">name</span><br>
<span class="lineno">85</span><span class="op" id="2650529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2650532">//&nbsp;FixedZone&nbsp;returns&nbsp;a&nbsp;Location&nbsp;that&nbsp;always&nbsp;uses</span><br>
<span class="lineno"></span><span class="comment" id="2650581">//&nbsp;the&nbsp;given&nbsp;zone&nbsp;name&nbsp;and&nbsp;offset&nbsp;(seconds&nbsp;east&nbsp;of&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2650638">func</span>&nbsp;<span class="ident" id="2650643">FixedZone</span><span class="op" id="2650652">(</span><span class="ident" id="2650653">name</span>&nbsp;<span class="builtintype" id="2650658">string</span><span class="op" id="2650664">,</span>&nbsp;<span class="ident" id="2650666">offset</span>&nbsp;<span class="builtintype" id="2650673">int</span><span class="op" id="2650676">)</span>&nbsp;<span class="op" id="2650678">*</span><span class="ident" id="2650679">Location</span>&nbsp;<span class="op" id="2650688">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2650691">l</span>&nbsp;<span class="op" id="2650693">:=</span>&nbsp;<span class="op" id="2650696">&amp;</span><span class="ident" id="2650697">Location</span><span class="op" id="2650705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2650709">name</span><span class="op" id="2650713">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2650721">name</span><span class="op" id="2650725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2650729">zone</span><span class="op" id="2650733">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2650741">[</span><span class="op" id="2650742">]</span><span class="ident" id="2650743">zone</span><span class="op" id="2650747">{</span><span class="op" id="2650748">{</span><span class="ident" id="2650749">name</span><span class="op" id="2650753">,</span>&nbsp;<span class="ident" id="2650755">offset</span><span class="op" id="2650761">,</span>&nbsp;<span class="builtintype" id="2650763">false</span><span class="op" id="2650768">}</span><span class="op" id="2650769">}</span><span class="op" id="2650770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2650774">tx</span><span class="op" id="2650776">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2650786">[</span><span class="op" id="2650787">]</span><span class="ident" id="2650788">zoneTrans</span><span class="op" id="2650797">{</span><span class="op" id="2650798">{</span><span class="ident" id="2650799">alpha</span><span class="op" id="2650804">,</span>&nbsp;<span class="num" id="2650806">0</span><span class="op" id="2650807">,</span>&nbsp;<span class="builtintype" id="2650809">false</span><span class="op" id="2650814">,</span>&nbsp;<span class="builtintype" id="2650816">false</span><span class="op" id="2650821">}</span><span class="op" id="2650822">}</span><span class="op" id="2650823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2650827">cacheStart</span><span class="op" id="2650837">:</span>&nbsp;<span class="ident" id="2650839">alpha</span><span class="op" id="2650844">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2650848">cacheEnd</span><span class="op" id="2650856">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2650860">omega</span><span class="op" id="2650865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2650868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2650871">l</span><span class="op" id="2650872">.</span><span class="ident" id="2650873">cacheZone</span>&nbsp;<span class="op" id="2650883">=</span>&nbsp;<span class="op" id="2650885">&amp;</span><span class="ident" id="2650886">l</span><span class="op" id="2650887">.</span><span class="ident" id="2650888">zone</span><span class="op" id="2650892">[</span><span class="num" id="2650893">0</span><span class="op" id="2650894">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2650897">return</span>&nbsp;<span class="ident" id="2650904">l</span><br>
<span class="lineno"></span><span class="op" id="2650906">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2650909">//&nbsp;lookup&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;use&nbsp;at&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="2650972">//&nbsp;instant&nbsp;in&nbsp;time&nbsp;expressed&nbsp;as&nbsp;seconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2651048">//</span><br>
<span class="lineno"></span><span class="comment" id="2651051">//&nbsp;The&nbsp;returned&nbsp;information&nbsp;gives&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;),</span><br>
<span class="lineno">105</span><span class="comment" id="2651123">//&nbsp;the&nbsp;start&nbsp;and&nbsp;end&nbsp;times&nbsp;bracketing&nbsp;sec&nbsp;when&nbsp;that&nbsp;zone&nbsp;is&nbsp;in&nbsp;effect,</span><br>
<span class="lineno"></span><span class="comment" id="2651194">//&nbsp;the&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC&nbsp;(such&nbsp;as&nbsp;-5*60*60),&nbsp;and&nbsp;whether</span><br>
<span class="lineno"></span><span class="comment" id="2651263">//&nbsp;the&nbsp;daylight&nbsp;savings&nbsp;is&nbsp;being&nbsp;observed&nbsp;at&nbsp;that&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2651319">func</span>&nbsp;<span class="op" id="2651324">(</span><span class="ident" id="2651325">l</span>&nbsp;<span class="op" id="2651327">*</span><span class="ident" id="2651328">Location</span><span class="op" id="2651336">)</span>&nbsp;<span class="ident" id="2651338">lookup</span><span class="op" id="2651344">(</span><span class="ident" id="2651345">sec</span>&nbsp;<span class="ident" id="2651349">int64</span><span class="op" id="2651354">)</span>&nbsp;<span class="op" id="2651356">(</span><span class="ident" id="2651357">name</span>&nbsp;<span class="builtintype" id="2651362">string</span><span class="op" id="2651368">,</span>&nbsp;<span class="ident" id="2651370">offset</span>&nbsp;<span class="builtintype" id="2651377">int</span><span class="op" id="2651380">,</span>&nbsp;<span class="ident" id="2651382">isDST</span>&nbsp;<span class="builtintype" id="2651388">bool</span><span class="op" id="2651392">,</span>&nbsp;<span class="ident" id="2651394">start</span><span class="op" id="2651399">,</span>&nbsp;<span class="ident" id="2651401">end</span>&nbsp;<span class="ident" id="2651405">int64</span><span class="op" id="2651410">)</span>&nbsp;<span class="op" id="2651412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651415">l</span>&nbsp;<span class="op" id="2651417">=</span>&nbsp;<span class="ident" id="2651419">l</span><span class="op" id="2651420">.</span><span class="ident" id="2651421">get</span><span class="op" id="2651424">(</span><span class="op" id="2651425">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2651429">if</span>&nbsp;<span class="builtinfunc" id="2651432">len</span><span class="op" id="2651435">(</span><span class="ident" id="2651436">l</span><span class="op" id="2651437">.</span><span class="ident" id="2651438">zone</span><span class="op" id="2651442">)</span>&nbsp;<span class="op" id="2651444">==</span>&nbsp;<span class="num" id="2651447">0</span>&nbsp;<span class="op" id="2651449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651453">name</span>&nbsp;<span class="op" id="2651458">=</span>&nbsp;<span class="string" id="2651460">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651468">offset</span>&nbsp;<span class="op" id="2651475">=</span>&nbsp;<span class="num" id="2651477">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651481">isDST</span>&nbsp;<span class="op" id="2651487">=</span>&nbsp;<span class="builtintype" id="2651489">false</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651497">start</span>&nbsp;<span class="op" id="2651503">=</span>&nbsp;<span class="ident" id="2651505">alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651513">end</span>&nbsp;<span class="op" id="2651517">=</span>&nbsp;<span class="ident" id="2651519">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2651527">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2651535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2651539">if</span>&nbsp;<span class="ident" id="2651542">zone</span>&nbsp;<span class="op" id="2651547">:=</span>&nbsp;<span class="ident" id="2651550">l</span><span class="op" id="2651551">.</span><span class="ident" id="2651552">cacheZone</span><span class="op" id="2651561">;</span>&nbsp;<span class="ident" id="2651563">zone</span>&nbsp;<span class="op" id="2651568">!=</span>&nbsp;<span class="builtintype" id="2651571">nil</span>&nbsp;<span class="op" id="2651575">&amp;&amp;</span>&nbsp;<span class="ident" id="2651578">l</span><span class="op" id="2651579">.</span><span class="ident" id="2651580">cacheStart</span>&nbsp;<span class="op" id="2651591">&lt;=</span>&nbsp;<span class="ident" id="2651594">sec</span>&nbsp;<span class="op" id="2651598">&amp;&amp;</span>&nbsp;<span class="ident" id="2651601">sec</span>&nbsp;<span class="op" id="2651605">&lt;</span>&nbsp;<span class="ident" id="2651607">l</span><span class="op" id="2651608">.</span><span class="ident" id="2651609">cacheEnd</span>&nbsp;<span class="op" id="2651618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651622">name</span>&nbsp;<span class="op" id="2651627">=</span>&nbsp;<span class="ident" id="2651629">zone</span><span class="op" id="2651633">.</span><span class="ident" id="2651634">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651641">offset</span>&nbsp;<span class="op" id="2651648">=</span>&nbsp;<span class="ident" id="2651650">zone</span><span class="op" id="2651654">.</span><span class="ident" id="2651655">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651664">isDST</span>&nbsp;<span class="op" id="2651670">=</span>&nbsp;<span class="ident" id="2651672">zone</span><span class="op" id="2651676">.</span><span class="ident" id="2651677">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651685">start</span>&nbsp;<span class="op" id="2651691">=</span>&nbsp;<span class="ident" id="2651693">l</span><span class="op" id="2651694">.</span><span class="ident" id="2651695">cacheStart</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651708">end</span>&nbsp;<span class="op" id="2651712">=</span>&nbsp;<span class="ident" id="2651714">l</span><span class="op" id="2651715">.</span><span class="ident" id="2651716">cacheEnd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2651727">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2651735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2651739">if</span>&nbsp;<span class="builtinfunc" id="2651742">len</span><span class="op" id="2651745">(</span><span class="ident" id="2651746">l</span><span class="op" id="2651747">.</span><span class="ident" id="2651748">tx</span><span class="op" id="2651750">)</span>&nbsp;<span class="op" id="2651752">==</span>&nbsp;<span class="num" id="2651755">0</span>&nbsp;<span class="op" id="2651757">||</span>&nbsp;<span class="ident" id="2651760">sec</span>&nbsp;<span class="op" id="2651764">&lt;</span>&nbsp;<span class="ident" id="2651766">l</span><span class="op" id="2651767">.</span><span class="ident" id="2651768">tx</span><span class="op" id="2651770">[</span><span class="num" id="2651771">0</span><span class="op" id="2651772">]</span><span class="op" id="2651773">.</span><span class="ident" id="2651774">when</span>&nbsp;<span class="op" id="2651779">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651783">zone</span>&nbsp;<span class="op" id="2651788">:=</span>&nbsp;<span class="op" id="2651791">&amp;</span><span class="ident" id="2651792">l</span><span class="op" id="2651793">.</span><span class="ident" id="2651794">zone</span><span class="op" id="2651798">[</span><span class="ident" id="2651799">l</span><span class="op" id="2651800">.</span><span class="ident" id="2651801">lookupFirstZone</span><span class="op" id="2651816">(</span><span class="op" id="2651817">)</span><span class="op" id="2651818">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651822">name</span>&nbsp;<span class="op" id="2651827">=</span>&nbsp;<span class="ident" id="2651829">zone</span><span class="op" id="2651833">.</span><span class="ident" id="2651834">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651841">offset</span>&nbsp;<span class="op" id="2651848">=</span>&nbsp;<span class="ident" id="2651850">zone</span><span class="op" id="2651854">.</span><span class="ident" id="2651855">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651864">isDST</span>&nbsp;<span class="op" id="2651870">=</span>&nbsp;<span class="ident" id="2651872">zone</span><span class="op" id="2651876">.</span><span class="ident" id="2651877">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651885">start</span>&nbsp;<span class="op" id="2651891">=</span>&nbsp;<span class="ident" id="2651893">alpha</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2651901">if</span>&nbsp;<span class="builtinfunc" id="2651904">len</span><span class="op" id="2651907">(</span><span class="ident" id="2651908">l</span><span class="op" id="2651909">.</span><span class="ident" id="2651910">tx</span><span class="op" id="2651912">)</span>&nbsp;<span class="op" id="2651914">&gt;</span>&nbsp;<span class="num" id="2651916">0</span>&nbsp;<span class="op" id="2651918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651923">end</span>&nbsp;<span class="op" id="2651927">=</span>&nbsp;<span class="ident" id="2651929">l</span><span class="op" id="2651930">.</span><span class="ident" id="2651931">tx</span><span class="op" id="2651933">[</span><span class="num" id="2651934">0</span><span class="op" id="2651935">]</span><span class="op" id="2651936">.</span><span class="ident" id="2651937">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2651944">}</span>&nbsp;<span class="keyword" id="2651946">else</span>&nbsp;<span class="op" id="2651951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2651956">end</span>&nbsp;<span class="op" id="2651960">=</span>&nbsp;<span class="ident" id="2651962">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2651970">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2651974">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2651982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2651986">//&nbsp;Binary&nbsp;search&nbsp;for&nbsp;entry&nbsp;with&nbsp;largest&nbsp;time&nbsp;&lt;=&nbsp;sec.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2652040">//&nbsp;Not&nbsp;using&nbsp;sort.Search&nbsp;to&nbsp;avoid&nbsp;dependencies.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652089">tx</span>&nbsp;<span class="op" id="2652092">:=</span>&nbsp;<span class="ident" id="2652095">l</span><span class="op" id="2652096">.</span><span class="ident" id="2652097">tx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652101">end</span>&nbsp;<span class="op" id="2652105">=</span>&nbsp;<span class="ident" id="2652107">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652114">lo</span>&nbsp;<span class="op" id="2652117">:=</span>&nbsp;<span class="num" id="2652120">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652123">hi</span>&nbsp;<span class="op" id="2652126">:=</span>&nbsp;<span class="builtinfunc" id="2652129">len</span><span class="op" id="2652132">(</span><span class="ident" id="2652133">tx</span><span class="op" id="2652135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2652138">for</span>&nbsp;<span class="ident" id="2652142">hi</span><span class="op" id="2652144">-</span><span class="ident" id="2652145">lo</span>&nbsp;<span class="op" id="2652148">&gt;</span>&nbsp;<span class="num" id="2652150">1</span>&nbsp;<span class="op" id="2652152">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652156">m</span>&nbsp;<span class="op" id="2652158">:=</span>&nbsp;<span class="ident" id="2652161">lo</span>&nbsp;<span class="op" id="2652164">+</span>&nbsp;<span class="op" id="2652166">(</span><span class="ident" id="2652167">hi</span><span class="op" id="2652169">-</span><span class="ident" id="2652170">lo</span><span class="op" id="2652172">)</span><span class="op" id="2652173">/</span><span class="num" id="2652174">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652178">lim</span>&nbsp;<span class="op" id="2652182">:=</span>&nbsp;<span class="ident" id="2652185">tx</span><span class="op" id="2652187">[</span><span class="ident" id="2652188">m</span><span class="op" id="2652189">]</span><span class="op" id="2652190">.</span><span class="ident" id="2652191">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2652198">if</span>&nbsp;<span class="ident" id="2652201">sec</span>&nbsp;<span class="op" id="2652205">&lt;</span>&nbsp;<span class="ident" id="2652207">lim</span>&nbsp;<span class="op" id="2652211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652216">end</span>&nbsp;<span class="op" id="2652220">=</span>&nbsp;<span class="ident" id="2652222">lim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652229">hi</span>&nbsp;<span class="op" id="2652232">=</span>&nbsp;<span class="ident" id="2652234">m</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2652238">}</span>&nbsp;<span class="keyword" id="2652240">else</span>&nbsp;<span class="op" id="2652245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652250">lo</span>&nbsp;<span class="op" id="2652253">=</span>&nbsp;<span class="ident" id="2652255">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2652259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2652262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652265">zone</span>&nbsp;<span class="op" id="2652270">:=</span>&nbsp;<span class="op" id="2652273">&amp;</span><span class="ident" id="2652274">l</span><span class="op" id="2652275">.</span><span class="ident" id="2652276">zone</span><span class="op" id="2652280">[</span><span class="ident" id="2652281">tx</span><span class="op" id="2652283">[</span><span class="ident" id="2652284">lo</span><span class="op" id="2652286">]</span><span class="op" id="2652287">.</span><span class="ident" id="2652288">index</span><span class="op" id="2652293">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652296">name</span>&nbsp;<span class="op" id="2652301">=</span>&nbsp;<span class="ident" id="2652303">zone</span><span class="op" id="2652307">.</span><span class="ident" id="2652308">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652314">offset</span>&nbsp;<span class="op" id="2652321">=</span>&nbsp;<span class="ident" id="2652323">zone</span><span class="op" id="2652327">.</span><span class="ident" id="2652328">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652336">isDST</span>&nbsp;<span class="op" id="2652342">=</span>&nbsp;<span class="ident" id="2652344">zone</span><span class="op" id="2652348">.</span><span class="ident" id="2652349">isDST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2652356">start</span>&nbsp;<span class="op" id="2652362">=</span>&nbsp;<span class="ident" id="2652364">tx</span><span class="op" id="2652366">[</span><span class="ident" id="2652367">lo</span><span class="op" id="2652369">]</span><span class="op" id="2652370">.</span><span class="ident" id="2652371">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2652377">//&nbsp;end&nbsp;=&nbsp;maintained&nbsp;during&nbsp;the&nbsp;search</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2652416">return</span><br>
<span class="lineno"></span><span class="op" id="2652423">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2652426">//&nbsp;lookupFirstZone&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;time&nbsp;zone&nbsp;to&nbsp;use&nbsp;for&nbsp;times</span><br>
<span class="lineno"></span><span class="comment" id="2652497">//&nbsp;before&nbsp;the&nbsp;first&nbsp;transition&nbsp;time,&nbsp;or&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;transition</span><br>
<span class="lineno">170</span><span class="comment" id="2652566">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2652576">//</span><br>
<span class="lineno"></span><span class="comment" id="2652579">//&nbsp;The&nbsp;reference&nbsp;implementation&nbsp;in&nbsp;localtime.c&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2652631">//&nbsp;http://www.iana.org/time-zones/repository/releases/tzcode2013g.tar.gz</span><br>
<span class="lineno"></span><span class="comment" id="2652704">//&nbsp;implements&nbsp;the&nbsp;following&nbsp;algorithm&nbsp;for&nbsp;these&nbsp;cases:</span><br>
<span class="lineno">175</span><span class="comment" id="2652759">//&nbsp;1)&nbsp;If&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;unused&nbsp;by&nbsp;the&nbsp;transitions,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2652821">//&nbsp;2)&nbsp;Otherwise,&nbsp;if&nbsp;there&nbsp;are&nbsp;transition&nbsp;times,&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2652883">//&nbsp;&nbsp;&nbsp;&nbsp;transition&nbsp;is&nbsp;to&nbsp;a&nbsp;zone&nbsp;in&nbsp;daylight&nbsp;time,&nbsp;find&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="2652946">//&nbsp;&nbsp;&nbsp;&nbsp;non-daylight-time&nbsp;zone&nbsp;before&nbsp;and&nbsp;closest&nbsp;to&nbsp;the&nbsp;first&nbsp;transition</span><br>
<span class="lineno"></span><span class="comment" id="2653018">//&nbsp;&nbsp;&nbsp;&nbsp;zone.</span><br>
<span class="lineno">180</span><span class="comment" id="2653030">//&nbsp;3)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone&nbsp;that&nbsp;is&nbsp;not&nbsp;daylight&nbsp;time,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2653096">//&nbsp;&nbsp;&nbsp;&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno"></span><span class="comment" id="2653116">//&nbsp;4)&nbsp;Otherwise,&nbsp;use&nbsp;the&nbsp;first&nbsp;zone.</span><br>
<span class="lineno"></span><span class="keyword" id="2653153">func</span>&nbsp;<span class="op" id="2653158">(</span><span class="ident" id="2653159">l</span>&nbsp;<span class="op" id="2653161">*</span><span class="ident" id="2653162">Location</span><span class="op" id="2653170">)</span>&nbsp;<span class="ident" id="2653172">lookupFirstZone</span><span class="op" id="2653187">(</span><span class="op" id="2653188">)</span>&nbsp;<span class="builtintype" id="2653190">int</span>&nbsp;<span class="op" id="2653194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2653197">//&nbsp;Case&nbsp;1.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653209">if</span>&nbsp;<span class="op" id="2653212">!</span><span class="ident" id="2653213">l</span><span class="op" id="2653214">.</span><span class="ident" id="2653215">firstZoneUsed</span><span class="op" id="2653228">(</span><span class="op" id="2653229">)</span>&nbsp;<span class="op" id="2653231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653235">return</span>&nbsp;<span class="num" id="2653242">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2653245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2653249">//&nbsp;Case&nbsp;2.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653261">if</span>&nbsp;<span class="builtinfunc" id="2653264">len</span><span class="op" id="2653267">(</span><span class="ident" id="2653268">l</span><span class="op" id="2653269">.</span><span class="ident" id="2653270">tx</span><span class="op" id="2653272">)</span>&nbsp;<span class="op" id="2653274">&gt;</span>&nbsp;<span class="num" id="2653276">0</span>&nbsp;<span class="op" id="2653278">&amp;&amp;</span>&nbsp;<span class="ident" id="2653281">l</span><span class="op" id="2653282">.</span><span class="ident" id="2653283">zone</span><span class="op" id="2653287">[</span><span class="ident" id="2653288">l</span><span class="op" id="2653289">.</span><span class="ident" id="2653290">tx</span><span class="op" id="2653292">[</span><span class="num" id="2653293">0</span><span class="op" id="2653294">]</span><span class="op" id="2653295">.</span><span class="ident" id="2653296">index</span><span class="op" id="2653301">]</span><span class="op" id="2653302">.</span><span class="ident" id="2653303">isDST</span>&nbsp;<span class="op" id="2653309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653313">for</span>&nbsp;<span class="ident" id="2653317">zi</span>&nbsp;<span class="op" id="2653320">:=</span>&nbsp;<span class="builtintype" id="2653323">int</span><span class="op" id="2653326">(</span><span class="ident" id="2653327">l</span><span class="op" id="2653328">.</span><span class="ident" id="2653329">tx</span><span class="op" id="2653331">[</span><span class="num" id="2653332">0</span><span class="op" id="2653333">]</span><span class="op" id="2653334">.</span><span class="ident" id="2653335">index</span><span class="op" id="2653340">)</span>&nbsp;<span class="op" id="2653342">-</span>&nbsp;<span class="num" id="2653344">1</span><span class="op" id="2653345">;</span>&nbsp;<span class="ident" id="2653347">zi</span>&nbsp;<span class="op" id="2653350">&gt;=</span>&nbsp;<span class="num" id="2653353">0</span><span class="op" id="2653354">;</span>&nbsp;<span class="ident" id="2653356">zi</span><span class="op" id="2653358">--</span>&nbsp;<span class="op" id="2653361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653366">if</span>&nbsp;<span class="op" id="2653369">!</span><span class="ident" id="2653370">l</span><span class="op" id="2653371">.</span><span class="ident" id="2653372">zone</span><span class="op" id="2653376">[</span><span class="ident" id="2653377">zi</span><span class="op" id="2653379">]</span><span class="op" id="2653380">.</span><span class="ident" id="2653381">isDST</span>&nbsp;<span class="op" id="2653387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653393">return</span>&nbsp;<span class="ident" id="2653400">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2653406">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2653410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2653413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2653417">//&nbsp;Case&nbsp;3.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653429">for</span>&nbsp;<span class="ident" id="2653433">zi</span>&nbsp;<span class="op" id="2653436">:=</span>&nbsp;<span class="keyword" id="2653439">range</span>&nbsp;<span class="ident" id="2653445">l</span><span class="op" id="2653446">.</span><span class="ident" id="2653447">zone</span>&nbsp;<span class="op" id="2653452">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653456">if</span>&nbsp;<span class="op" id="2653459">!</span><span class="ident" id="2653460">l</span><span class="op" id="2653461">.</span><span class="ident" id="2653462">zone</span><span class="op" id="2653466">[</span><span class="ident" id="2653467">zi</span><span class="op" id="2653469">]</span><span class="op" id="2653470">.</span><span class="ident" id="2653471">isDST</span>&nbsp;<span class="op" id="2653477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653482">return</span>&nbsp;<span class="ident" id="2653489">zi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2653494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2653497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2653501">//&nbsp;Case&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653513">return</span>&nbsp;<span class="num" id="2653520">0</span><br>
<span class="lineno"></span><span class="op" id="2653522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2653525">//&nbsp;firstZoneUsed&nbsp;returns&nbsp;whether&nbsp;the&nbsp;first&nbsp;zone&nbsp;is&nbsp;used&nbsp;by&nbsp;some</span><br>
<span class="lineno">210</span><span class="comment" id="2653589">//&nbsp;transition.</span><br>
<span class="lineno"></span><span class="keyword" id="2653604">func</span>&nbsp;<span class="op" id="2653609">(</span><span class="ident" id="2653610">l</span>&nbsp;<span class="op" id="2653612">*</span><span class="ident" id="2653613">Location</span><span class="op" id="2653621">)</span>&nbsp;<span class="ident" id="2653623">firstZoneUsed</span><span class="op" id="2653636">(</span><span class="op" id="2653637">)</span>&nbsp;<span class="builtintype" id="2653639">bool</span>&nbsp;<span class="op" id="2653644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653647">for</span>&nbsp;<span class="ident" id="2653651">_</span><span class="op" id="2653652">,</span>&nbsp;<span class="ident" id="2653654">tx</span>&nbsp;<span class="op" id="2653657">:=</span>&nbsp;<span class="keyword" id="2653660">range</span>&nbsp;<span class="ident" id="2653666">l</span><span class="op" id="2653667">.</span><span class="ident" id="2653668">tx</span>&nbsp;<span class="op" id="2653671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653675">if</span>&nbsp;<span class="ident" id="2653678">tx</span><span class="op" id="2653680">.</span><span class="ident" id="2653681">index</span>&nbsp;<span class="op" id="2653687">==</span>&nbsp;<span class="num" id="2653690">0</span>&nbsp;<span class="op" id="2653692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653697">return</span>&nbsp;<span class="builtintype" id="2653704">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2653711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2653714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2653717">return</span>&nbsp;<span class="builtintype" id="2653724">false</span><br>
<span class="lineno"></span><span class="op" id="2653730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2653733">//&nbsp;lookupName&nbsp;returns&nbsp;information&nbsp;about&nbsp;the&nbsp;time&nbsp;zone&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="2653792">//&nbsp;the&nbsp;given&nbsp;name&nbsp;(such&nbsp;as&nbsp;&#34;EST&#34;)&nbsp;at&nbsp;the&nbsp;given&nbsp;pseudo-Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2653856">//&nbsp;(what&nbsp;the&nbsp;given&nbsp;time&nbsp;of&nbsp;day&nbsp;would&nbsp;be&nbsp;in&nbsp;UTC).</span><br>
<span class="lineno"></span><span class="keyword" id="2653905">func</span>&nbsp;<span class="op" id="2653910">(</span><span class="ident" id="2653911">l</span>&nbsp;<span class="op" id="2653913">*</span><span class="ident" id="2653914">Location</span><span class="op" id="2653922">)</span>&nbsp;<span class="ident" id="2653924">lookupName</span><span class="op" id="2653934">(</span><span class="ident" id="2653935">name</span>&nbsp;<span class="builtintype" id="2653940">string</span><span class="op" id="2653946">,</span>&nbsp;<span class="ident" id="2653948">unix</span>&nbsp;<span class="ident" id="2653953">int64</span><span class="op" id="2653958">)</span>&nbsp;<span class="op" id="2653960">(</span><span class="ident" id="2653961">offset</span>&nbsp;<span class="builtintype" id="2653968">int</span><span class="op" id="2653971">,</span>&nbsp;<span class="ident" id="2653973">isDST</span>&nbsp;<span class="builtintype" id="2653979">bool</span><span class="op" id="2653983">,</span>&nbsp;<span class="ident" id="2653985">ok</span>&nbsp;<span class="builtintype" id="2653988">bool</span><span class="op" id="2653992">)</span>&nbsp;<span class="op" id="2653994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2653997">l</span>&nbsp;<span class="op" id="2653999">=</span>&nbsp;<span class="ident" id="2654001">l</span><span class="op" id="2654002">.</span><span class="ident" id="2654003">get</span><span class="op" id="2654006">(</span><span class="op" id="2654007">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2654011">//&nbsp;First&nbsp;try&nbsp;for&nbsp;a&nbsp;zone&nbsp;with&nbsp;the&nbsp;right&nbsp;name&nbsp;that&nbsp;was&nbsp;actually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2654074">//&nbsp;in&nbsp;effect&nbsp;at&nbsp;the&nbsp;given&nbsp;time.&nbsp;(In&nbsp;Sydney,&nbsp;Australia,&nbsp;both&nbsp;standard</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2654144">//&nbsp;and&nbsp;daylight-savings&nbsp;time&nbsp;are&nbsp;abbreviated&nbsp;&#34;EST&#34;.&nbsp;Using&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2654207">//&nbsp;offset&nbsp;helps&nbsp;us&nbsp;pick&nbsp;the&nbsp;right&nbsp;one&nbsp;for&nbsp;the&nbsp;given&nbsp;time.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2654266">//&nbsp;It&#39;s&nbsp;not&nbsp;perfect:&nbsp;during&nbsp;the&nbsp;backward&nbsp;transition&nbsp;we&nbsp;might&nbsp;pick</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2654333">//&nbsp;either&nbsp;one.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2654350">for</span>&nbsp;<span class="ident" id="2654354">i</span>&nbsp;<span class="op" id="2654356">:=</span>&nbsp;<span class="keyword" id="2654359">range</span>&nbsp;<span class="ident" id="2654365">l</span><span class="op" id="2654366">.</span><span class="ident" id="2654367">zone</span>&nbsp;<span class="op" id="2654372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2654376">zone</span>&nbsp;<span class="op" id="2654381">:=</span>&nbsp;<span class="op" id="2654384">&amp;</span><span class="ident" id="2654385">l</span><span class="op" id="2654386">.</span><span class="ident" id="2654387">zone</span><span class="op" id="2654391">[</span><span class="ident" id="2654392">i</span><span class="op" id="2654393">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2654397">if</span>&nbsp;<span class="ident" id="2654400">zone</span><span class="op" id="2654404">.</span><span class="ident" id="2654405">name</span>&nbsp;<span class="op" id="2654410">==</span>&nbsp;<span class="ident" id="2654413">name</span>&nbsp;<span class="op" id="2654418">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2654423">nam</span><span class="op" id="2654426">,</span>&nbsp;<span class="ident" id="2654428">offset</span><span class="op" id="2654434">,</span>&nbsp;<span class="ident" id="2654436">isDST</span><span class="op" id="2654441">,</span>&nbsp;<span class="ident" id="2654443">_</span><span class="op" id="2654444">,</span>&nbsp;<span class="ident" id="2654446">_</span>&nbsp;<span class="op" id="2654448">:=</span>&nbsp;<span class="ident" id="2654451">l</span><span class="op" id="2654452">.</span><span class="ident" id="2654453">lookup</span><span class="op" id="2654459">(</span><span class="ident" id="2654460">unix</span>&nbsp;<span class="op" id="2654465">-</span>&nbsp;<span class="ident" id="2654467">int64</span><span class="op" id="2654472">(</span><span class="ident" id="2654473">zone</span><span class="op" id="2654477">.</span><span class="ident" id="2654478">offset</span><span class="op" id="2654484">)</span><span class="op" id="2654485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2654490">if</span>&nbsp;<span class="ident" id="2654493">nam</span>&nbsp;<span class="op" id="2654497">==</span>&nbsp;<span class="ident" id="2654500">zone</span><span class="op" id="2654504">.</span><span class="ident" id="2654505">name</span>&nbsp;<span class="op" id="2654510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2654516">return</span>&nbsp;<span class="ident" id="2654523">offset</span><span class="op" id="2654529">,</span>&nbsp;<span class="ident" id="2654531">isDST</span><span class="op" id="2654536">,</span>&nbsp;<span class="builtintype" id="2654538">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2654546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2654550">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2654553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2654557">//&nbsp;Otherwise&nbsp;fall&nbsp;back&nbsp;to&nbsp;an&nbsp;ordinary&nbsp;name&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2654608">for</span>&nbsp;<span class="ident" id="2654612">i</span>&nbsp;<span class="op" id="2654614">:=</span>&nbsp;<span class="keyword" id="2654617">range</span>&nbsp;<span class="ident" id="2654623">l</span><span class="op" id="2654624">.</span><span class="ident" id="2654625">zone</span>&nbsp;<span class="op" id="2654630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2654634">zone</span>&nbsp;<span class="op" id="2654639">:=</span>&nbsp;<span class="op" id="2654642">&amp;</span><span class="ident" id="2654643">l</span><span class="op" id="2654644">.</span><span class="ident" id="2654645">zone</span><span class="op" id="2654649">[</span><span class="ident" id="2654650">i</span><span class="op" id="2654651">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2654655">if</span>&nbsp;<span class="ident" id="2654658">zone</span><span class="op" id="2654662">.</span><span class="ident" id="2654663">name</span>&nbsp;<span class="op" id="2654668">==</span>&nbsp;<span class="ident" id="2654671">name</span>&nbsp;<span class="op" id="2654676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2654681">return</span>&nbsp;<span class="ident" id="2654688">zone</span><span class="op" id="2654692">.</span><span class="ident" id="2654693">offset</span><span class="op" id="2654699">,</span>&nbsp;<span class="ident" id="2654701">zone</span><span class="op" id="2654705">.</span><span class="ident" id="2654706">isDST</span><span class="op" id="2654711">,</span>&nbsp;<span class="builtintype" id="2654713">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2654720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2654723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2654727">//&nbsp;Otherwise,&nbsp;give&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2654751">return</span><br>
<span class="lineno"></span><span class="op" id="2654758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2654761">//&nbsp;NOTE(rsc):&nbsp;Eventually&nbsp;we&nbsp;will&nbsp;need&nbsp;to&nbsp;accept&nbsp;the&nbsp;POSIX&nbsp;TZ&nbsp;environment</span><br>
<span class="lineno">255</span><span class="comment" id="2654834">//&nbsp;syntax&nbsp;too,&nbsp;but&nbsp;I&nbsp;don&#39;t&nbsp;feel&nbsp;like&nbsp;implementing&nbsp;it&nbsp;today.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2654895">var</span>&nbsp;<span class="ident" id="2654899">zoneinfo</span><span class="op" id="2654907">,</span>&nbsp;<span class="ident" id="2654909">_</span>&nbsp;<span class="op" id="2654911">=</span>&nbsp;<span class="ident" id="2654913">syscall</span><span class="op" id="2654920">.</span><span class="ident" id="2654921">Getenv</span><span class="op" id="2654927">(</span><span class="string" id="2654928">&#34;ZONEINFO&#34;</span><span class="op" id="2654938">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2654941">//&nbsp;LoadLocation&nbsp;returns&nbsp;the&nbsp;Location&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno">260</span><span class="comment" id="2654999">//</span><br>
<span class="lineno"></span><span class="comment" id="2655002">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;&#34;&nbsp;or&nbsp;&#34;UTC&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2655059">//&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;&#34;Local&#34;,&nbsp;LoadLocation&nbsp;returns&nbsp;Local.</span><br>
<span class="lineno"></span><span class="comment" id="2655114">//</span><br>
<span class="lineno"></span><span class="comment" id="2655117">//&nbsp;Otherwise,&nbsp;the&nbsp;name&nbsp;is&nbsp;taken&nbsp;to&nbsp;be&nbsp;a&nbsp;location&nbsp;name&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;file</span><br>
<span class="lineno">265</span><span class="comment" id="2655195">//&nbsp;in&nbsp;the&nbsp;IANA&nbsp;Time&nbsp;Zone&nbsp;database,&nbsp;such&nbsp;as&nbsp;&#34;America/New_York&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2655258">//</span><br>
<span class="lineno"></span><span class="comment" id="2655261">//&nbsp;The&nbsp;time&nbsp;zone&nbsp;database&nbsp;needed&nbsp;by&nbsp;LoadLocation&nbsp;may&nbsp;not&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2655321">//&nbsp;present&nbsp;on&nbsp;all&nbsp;systems,&nbsp;especially&nbsp;non-Unix&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="2655377">//&nbsp;LoadLocation&nbsp;looks&nbsp;in&nbsp;the&nbsp;directory&nbsp;or&nbsp;uncompressed&nbsp;zip&nbsp;file</span><br>
<span class="lineno">270</span><span class="comment" id="2655441">//&nbsp;named&nbsp;by&nbsp;the&nbsp;ZONEINFO&nbsp;environment&nbsp;variable,&nbsp;if&nbsp;any,&nbsp;then&nbsp;looks&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2655510">//&nbsp;known&nbsp;installation&nbsp;locations&nbsp;on&nbsp;Unix&nbsp;systems,</span><br>
<span class="lineno"></span><span class="comment" id="2655559">//&nbsp;and&nbsp;finally&nbsp;looks&nbsp;in&nbsp;$GOROOT/lib/time/zoneinfo.zip.</span><br>
<span class="lineno"></span><span class="keyword" id="2655614">func</span>&nbsp;<span class="ident" id="2655619">LoadLocation</span><span class="op" id="2655631">(</span><span class="ident" id="2655632">name</span>&nbsp;<span class="builtintype" id="2655637">string</span><span class="op" id="2655643">)</span>&nbsp;<span class="op" id="2655645">(</span><span class="op" id="2655646">*</span><span class="ident" id="2655647">Location</span><span class="op" id="2655655">,</span>&nbsp;<span class="builtintype" id="2655657">error</span><span class="op" id="2655662">)</span>&nbsp;<span class="op" id="2655664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2655667">if</span>&nbsp;<span class="ident" id="2655670">name</span>&nbsp;<span class="op" id="2655675">==</span>&nbsp;<span class="string" id="2655678">&#34;&#34;</span>&nbsp;<span class="op" id="2655681">||</span>&nbsp;<span class="ident" id="2655684">name</span>&nbsp;<span class="op" id="2655689">==</span>&nbsp;<span class="string" id="2655692">&#34;UTC&#34;</span>&nbsp;<span class="op" id="2655698">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2655702">return</span>&nbsp;<span class="ident" id="2655709">UTC</span><span class="op" id="2655712">,</span>&nbsp;<span class="builtintype" id="2655714">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2655719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2655722">if</span>&nbsp;<span class="ident" id="2655725">name</span>&nbsp;<span class="op" id="2655730">==</span>&nbsp;<span class="string" id="2655733">&#34;Local&#34;</span>&nbsp;<span class="op" id="2655741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2655745">return</span>&nbsp;<span class="ident" id="2655752">Local</span><span class="op" id="2655757">,</span>&nbsp;<span class="builtintype" id="2655759">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2655764">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2655767">if</span>&nbsp;<span class="ident" id="2655770">zoneinfo</span>&nbsp;<span class="op" id="2655779">!=</span>&nbsp;<span class="string" id="2655782">&#34;&#34;</span>&nbsp;<span class="op" id="2655785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2655789">if</span>&nbsp;<span class="ident" id="2655792">z</span><span class="op" id="2655793">,</span>&nbsp;<span class="ident" id="2655795">err</span>&nbsp;<span class="op" id="2655799">:=</span>&nbsp;<span class="ident" id="2655802">loadZoneFile</span><span class="op" id="2655814">(</span><span class="ident" id="2655815">zoneinfo</span><span class="op" id="2655823">,</span>&nbsp;<span class="ident" id="2655825">name</span><span class="op" id="2655829">)</span><span class="op" id="2655830">;</span>&nbsp;<span class="ident" id="2655832">err</span>&nbsp;<span class="op" id="2655836">==</span>&nbsp;<span class="builtintype" id="2655839">nil</span>&nbsp;<span class="op" id="2655843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2655848">z</span><span class="op" id="2655849">.</span><span class="ident" id="2655850">name</span>&nbsp;<span class="op" id="2655855">=</span>&nbsp;<span class="ident" id="2655857">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2655865">return</span>&nbsp;<span class="ident" id="2655872">z</span><span class="op" id="2655873">,</span>&nbsp;<span class="builtintype" id="2655875">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2655881">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2655884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2655887">return</span>&nbsp;<span class="ident" id="2655894">loadLocation</span><span class="op" id="2655906">(</span><span class="ident" id="2655907">name</span><span class="op" id="2655911">)</span><br>
<span class="lineno"></span><span class="op" id="2655913">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
