<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6216131">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6216186">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6216240">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6216291">//&nbsp;Package&nbsp;signal&nbsp;implements&nbsp;access&nbsp;to&nbsp;incoming&nbsp;signals.</span><br>
<span class="lineno"></span><span class="keyword" id="6216348">package</span>&nbsp;<span class="ident" id="6216356">signal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6216364">//&nbsp;BUG(rsc):&nbsp;This&nbsp;package&nbsp;is&nbsp;not&nbsp;yet&nbsp;implemented&nbsp;on&nbsp;Plan&nbsp;9.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="6216425">import</span>&nbsp;<span class="op" id="6216432">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6216435">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6216441">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="6216448">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="6216451">var</span>&nbsp;<span class="ident" id="6216455">handlers</span>&nbsp;<span class="keyword" id="6216464">struct</span>&nbsp;<span class="op" id="6216471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216474"><a href="/os/signal/signal.go.html#6216441">sync</a></span><span class="op" id="6216478">.</span><span class="ident" id="6216479">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216486">m</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="6216490">map</span><span class="op" id="6216493">[</span><span class="keyword" id="6216494">chan</span><span class="op" id="6216498">&lt;-</span>&nbsp;<span class="ident" id="6216501"><a href="/os/signal/signal.go.html#6216435">os</a></span><span class="op" id="6216503">.</span><span class="ident" id="6216504">Signal</span><span class="op" id="6216510">]</span><span class="op" id="6216511">*</span><span class="ident" id="6216512"><a href="/os/signal/signal.go.html#6216547">handler</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216521">ref</span>&nbsp;<span class="op" id="6216525">[</span><span class="ident" id="6216526"><a href="/os/signal/signal_unix.go.html#6219450">numSig</a></span><span class="op" id="6216532">]</span><span class="ident" id="6216533">int64</span><br>
<span class="lineno"></span><span class="op" id="6216539">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6216542">type</span>&nbsp;<span class="ident" id="6216547">handler</span>&nbsp;<span class="keyword" id="6216555">struct</span>&nbsp;<span class="op" id="6216562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216565">mask</span>&nbsp;<span class="op" id="6216570">[</span><span class="op" id="6216571">(</span><span class="ident" id="6216572"><a href="/os/signal/signal_unix.go.html#6219450">numSig</a></span>&nbsp;<span class="op" id="6216579">+</span>&nbsp;<span class="num" id="6216581">31</span><span class="op" id="6216583">)</span>&nbsp;<span class="op" id="6216585">/</span>&nbsp;<span class="num" id="6216587">32</span><span class="op" id="6216589">]</span><span class="builtintype" id="6216590">uint32</span><br>
<span class="lineno"></span><span class="op" id="6216597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6216600">func</span>&nbsp;<span class="op" id="6216605">(</span><span class="ident" id="6216606">h</span>&nbsp;<span class="op" id="6216608">*</span><span class="ident" id="6216609"><a href="/os/signal/signal.go.html#6216547">handler</a></span><span class="op" id="6216616">)</span>&nbsp;<span class="ident" id="6216618">want</span><span class="op" id="6216622">(</span><span class="ident" id="6216623">sig</span>&nbsp;<span class="builtintype" id="6216627">int</span><span class="op" id="6216630">)</span>&nbsp;<span class="builtintype" id="6216632">bool</span>&nbsp;<span class="op" id="6216637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6216640">return</span>&nbsp;<span class="op" id="6216647">(</span><span class="ident" id="6216648"><a href="/os/signal/signal.go.html#6216606">h</a></span><span class="op" id="6216649">.</span><span class="ident" id="6216650">mask</span><span class="op" id="6216654">[</span><span class="ident" id="6216655"><a href="/os/signal/signal.go.html#6216623">sig</a></span><span class="op" id="6216658">/</span><span class="num" id="6216659">32</span><span class="op" id="6216661">]</span><span class="op" id="6216662">&gt;&gt;</span><span class="builtintype" id="6216664">uint</span><span class="op" id="6216668">(</span><span class="ident" id="6216669"><a href="/os/signal/signal.go.html#6216623">sig</a></span><span class="op" id="6216672">&amp;</span><span class="num" id="6216673">31</span><span class="op" id="6216675">)</span><span class="op" id="6216676">)</span><span class="op" id="6216677">&amp;</span><span class="num" id="6216678">1</span>&nbsp;<span class="op" id="6216680">!=</span>&nbsp;<span class="num" id="6216683">0</span><br>
<span class="lineno"></span><span class="op" id="6216685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6216688">func</span>&nbsp;<span class="op" id="6216693">(</span><span class="ident" id="6216694">h</span>&nbsp;<span class="op" id="6216696">*</span><span class="ident" id="6216697"><a href="/os/signal/signal.go.html#6216547">handler</a></span><span class="op" id="6216704">)</span>&nbsp;<span class="ident" id="6216706">set</span><span class="op" id="6216709">(</span><span class="ident" id="6216710">sig</span>&nbsp;<span class="builtintype" id="6216714">int</span><span class="op" id="6216717">)</span>&nbsp;<span class="op" id="6216719">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6216722"><a href="/os/signal/signal.go.html#6216694">h</a></span><span class="op" id="6216723">.</span><span class="ident" id="6216724">mask</span><span class="op" id="6216728">[</span><span class="ident" id="6216729"><a href="/os/signal/signal.go.html#6216710">sig</a></span><span class="op" id="6216732">/</span><span class="num" id="6216733">32</span><span class="op" id="6216735">]</span>&nbsp;<span class="op" id="6216737">|=</span>&nbsp;<span class="num" id="6216740">1</span>&nbsp;<span class="op" id="6216742">&lt;&lt;</span>&nbsp;<span class="builtintype" id="6216745">uint</span><span class="op" id="6216749">(</span><span class="ident" id="6216750"><a href="/os/signal/signal.go.html#6216710">sig</a></span><span class="op" id="6216753">&amp;</span><span class="num" id="6216754">31</span><span class="op" id="6216756">)</span><br>
<span class="lineno"></span><span class="op" id="6216758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6216761">//&nbsp;Notify&nbsp;causes&nbsp;package&nbsp;signal&nbsp;to&nbsp;relay&nbsp;incoming&nbsp;signals&nbsp;to&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="6216825">//&nbsp;If&nbsp;no&nbsp;signals&nbsp;are&nbsp;listed,&nbsp;all&nbsp;incoming&nbsp;signals&nbsp;will&nbsp;be&nbsp;relayed&nbsp;to&nbsp;c.</span><br>
<span class="lineno">35</span><span class="comment" id="6216897">//&nbsp;Otherwise,&nbsp;just&nbsp;the&nbsp;listed&nbsp;signals&nbsp;will.</span><br>
<span class="lineno"></span><span class="comment" id="6216941">//</span><br>
<span class="lineno"></span><span class="comment" id="6216944">//&nbsp;Package&nbsp;signal&nbsp;will&nbsp;not&nbsp;block&nbsp;sending&nbsp;to&nbsp;c:&nbsp;the&nbsp;caller&nbsp;must&nbsp;ensure</span><br>
<span class="lineno"></span><span class="comment" id="6217014">//&nbsp;that&nbsp;c&nbsp;has&nbsp;sufficient&nbsp;buffer&nbsp;space&nbsp;to&nbsp;keep&nbsp;up&nbsp;with&nbsp;the&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="6217081">//&nbsp;signal&nbsp;rate.&nbsp;&nbsp;For&nbsp;a&nbsp;channel&nbsp;used&nbsp;for&nbsp;notification&nbsp;of&nbsp;just&nbsp;one&nbsp;signal&nbsp;value,</span><br>
<span class="lineno">40</span><span class="comment" id="6217160">//&nbsp;a&nbsp;buffer&nbsp;of&nbsp;size&nbsp;1&nbsp;is&nbsp;sufficient.</span><br>
<span class="lineno"></span><span class="comment" id="6217197">//</span><br>
<span class="lineno"></span><span class="comment" id="6217200">//&nbsp;It&nbsp;is&nbsp;allowed&nbsp;to&nbsp;call&nbsp;Notify&nbsp;multiple&nbsp;times&nbsp;with&nbsp;the&nbsp;same&nbsp;channel:</span><br>
<span class="lineno"></span><span class="comment" id="6217270">//&nbsp;each&nbsp;call&nbsp;expands&nbsp;the&nbsp;set&nbsp;of&nbsp;signals&nbsp;sent&nbsp;to&nbsp;that&nbsp;channel.</span><br>
<span class="lineno"></span><span class="comment" id="6217332">//&nbsp;The&nbsp;only&nbsp;way&nbsp;to&nbsp;remove&nbsp;signals&nbsp;from&nbsp;the&nbsp;set&nbsp;is&nbsp;to&nbsp;call&nbsp;Stop.</span><br>
<span class="lineno">45</span><span class="comment" id="6217396">//</span><br>
<span class="lineno"></span><span class="comment" id="6217399">//&nbsp;It&nbsp;is&nbsp;allowed&nbsp;to&nbsp;call&nbsp;Notify&nbsp;multiple&nbsp;times&nbsp;with&nbsp;different&nbsp;channels</span><br>
<span class="lineno"></span><span class="comment" id="6217470">//&nbsp;and&nbsp;the&nbsp;same&nbsp;signals:&nbsp;each&nbsp;channel&nbsp;receives&nbsp;copies&nbsp;of&nbsp;incoming</span><br>
<span class="lineno"></span><span class="comment" id="6217536">//&nbsp;signals&nbsp;independently.</span><br>
<span class="lineno"></span><span class="keyword" id="6217562">func</span>&nbsp;<span class="ident" id="6217567">Notify</span><span class="op" id="6217573">(</span><span class="ident" id="6217574">c</span>&nbsp;<span class="keyword" id="6217576">chan</span><span class="op" id="6217580">&lt;-</span>&nbsp;<span class="ident" id="6217583"><a href="/os/signal/signal.go.html#6216435">os</a></span><span class="op" id="6217585">.</span><span class="ident" id="6217586">Signal</span><span class="op" id="6217592">,</span>&nbsp;<span class="ident" id="6217594">sig</span>&nbsp;<span class="op" id="6217598">...</span><span class="ident" id="6217601"><a href="/os/signal/signal.go.html#6216435">os</a></span><span class="op" id="6217603">.</span><span class="ident" id="6217604">Signal</span><span class="op" id="6217610">)</span>&nbsp;<span class="op" id="6217612">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217615">if</span>&nbsp;<span class="ident" id="6217618"><a href="/os/signal/signal.go.html#6217574">c</a></span>&nbsp;<span class="op" id="6217620">==</span>&nbsp;<span class="ident" id="6217623">nil</span>&nbsp;<span class="op" id="6217627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6217631">panic</span><span class="op" id="6217636">(</span><span class="string" id="6217637">&#34;os/signal:&nbsp;Notify&nbsp;using&nbsp;nil&nbsp;channel&#34;</span><span class="op" id="6217674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217681"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6217689">.</span><span class="ident" id="6217690">Lock</span><span class="op" id="6217694">(</span><span class="op" id="6217695">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217698">defer</span>&nbsp;<span class="ident" id="6217704"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6217712">.</span><span class="ident" id="6217713">Unlock</span><span class="op" id="6217719">(</span><span class="op" id="6217720">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217724">h</span>&nbsp;<span class="op" id="6217726">:=</span>&nbsp;<span class="ident" id="6217729"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6217737">.</span><span class="ident" id="6217738">m</span><span class="op" id="6217739">[</span><span class="ident" id="6217740"><a href="/os/signal/signal.go.html#6217574">c</a></span><span class="op" id="6217741">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217744">if</span>&nbsp;<span class="ident" id="6217747"><a href="/os/signal/signal.go.html#6217724">h</a></span>&nbsp;<span class="op" id="6217749">==</span>&nbsp;<span class="ident" id="6217752">nil</span>&nbsp;<span class="op" id="6217756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217760">if</span>&nbsp;<span class="ident" id="6217763"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6217771">.</span><span class="ident" id="6217772">m</span>&nbsp;<span class="op" id="6217774">==</span>&nbsp;<span class="ident" id="6217777">nil</span>&nbsp;<span class="op" id="6217781">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217786"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6217794">.</span><span class="ident" id="6217795">m</span>&nbsp;<span class="op" id="6217797">=</span>&nbsp;<span class="builtinfunc" id="6217799">make</span><span class="op" id="6217803">(</span><span class="keyword" id="6217804">map</span><span class="op" id="6217807">[</span><span class="keyword" id="6217808">chan</span><span class="op" id="6217812">&lt;-</span>&nbsp;<span class="ident" id="6217815"><a href="/os/signal/signal.go.html#6216435">os</a></span><span class="op" id="6217817">.</span><span class="ident" id="6217818">Signal</span><span class="op" id="6217824">]</span><span class="op" id="6217825">*</span><span class="ident" id="6217826"><a href="/os/signal/signal.go.html#6216547">handler</a></span><span class="op" id="6217833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217841"><a href="/os/signal/signal.go.html#6217724">h</a></span>&nbsp;<span class="op" id="6217843">=</span>&nbsp;<span class="builtinfunc" id="6217845">new</span><span class="op" id="6217848">(</span><span class="ident" id="6217849"><a href="/os/signal/signal.go.html#6216547">handler</a></span><span class="op" id="6217856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217860"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6217868">.</span><span class="ident" id="6217869">m</span><span class="op" id="6217870">[</span><span class="ident" id="6217871"><a href="/os/signal/signal.go.html#6217574">c</a></span><span class="op" id="6217872">]</span>&nbsp;<span class="op" id="6217874">=</span>&nbsp;<span class="ident" id="6217876"><a href="/os/signal/signal.go.html#6217724">h</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217879">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217883">add</span>&nbsp;<span class="op" id="6217887">:=</span>&nbsp;<span class="keyword" id="6217890">func</span><span class="op" id="6217894">(</span><span class="ident" id="6217895">n</span>&nbsp;<span class="builtintype" id="6217897">int</span><span class="op" id="6217900">)</span>&nbsp;<span class="op" id="6217902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217906">if</span>&nbsp;<span class="ident" id="6217909"><a href="/os/signal/signal.go.html#6217895">n</a></span>&nbsp;<span class="op" id="6217911">&lt;</span>&nbsp;<span class="num" id="6217913">0</span>&nbsp;<span class="op" id="6217915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217920">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6217929">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217933">if</span>&nbsp;<span class="op" id="6217936">!</span><span class="ident" id="6217937"><a href="/os/signal/signal.go.html#6217724">h</a></span><span class="op" id="6217938">.</span><span class="ident" id="6217939">want</span><span class="op" id="6217943">(</span><span class="ident" id="6217944"><a href="/os/signal/signal.go.html#6217895">n</a></span><span class="op" id="6217945">)</span>&nbsp;<span class="op" id="6217947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217952"><a href="/os/signal/signal.go.html#6217724">h</a></span><span class="op" id="6217953">.</span><span class="ident" id="6217954">set</span><span class="op" id="6217957">(</span><span class="ident" id="6217958"><a href="/os/signal/signal.go.html#6217895">n</a></span><span class="op" id="6217959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6217964">if</span>&nbsp;<span class="ident" id="6217967"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6217975">.</span><span class="ident" id="6217976">ref</span><span class="op" id="6217979">[</span><span class="ident" id="6217980"><a href="/os/signal/signal.go.html#6217895">n</a></span><span class="op" id="6217981">]</span>&nbsp;<span class="op" id="6217983">==</span>&nbsp;<span class="num" id="6217986">0</span>&nbsp;<span class="op" id="6217988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6217994"><a href="/os/signal/signal_unix.go.html#6219679">enableSignal</a></span><span class="op" id="6218006">(</span><span class="ident" id="6218007"><a href="/os/signal/signal.go.html#6217895">n</a></span><span class="op" id="6218008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218013">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6218018"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6218026">.</span><span class="ident" id="6218027">ref</span><span class="op" id="6218030">[</span><span class="ident" id="6218031"><a href="/os/signal/signal.go.html#6217895">n</a></span><span class="op" id="6218032">]</span><span class="op" id="6218033">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218045">if</span>&nbsp;<span class="builtinfunc" id="6218048">len</span><span class="op" id="6218051">(</span><span class="ident" id="6218052"><a href="/os/signal/signal.go.html#6217594">sig</a></span><span class="op" id="6218055">)</span>&nbsp;<span class="op" id="6218057">==</span>&nbsp;<span class="num" id="6218060">0</span>&nbsp;<span class="op" id="6218062">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218066">for</span>&nbsp;<span class="ident" id="6218070">n</span>&nbsp;<span class="op" id="6218072">:=</span>&nbsp;<span class="num" id="6218075">0</span><span class="op" id="6218076">;</span>&nbsp;<span class="ident" id="6218078"><a href="/os/signal/signal.go.html#6218070">n</a></span>&nbsp;<span class="op" id="6218080">&lt;</span>&nbsp;<span class="ident" id="6218082"><a href="/os/signal/signal_unix.go.html#6219450">numSig</a></span><span class="op" id="6218088">;</span>&nbsp;<span class="ident" id="6218090"><a href="/os/signal/signal.go.html#6218070">n</a></span><span class="op" id="6218091">++</span>&nbsp;<span class="op" id="6218094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6218099"><a href="/os/signal/signal.go.html#6217883">add</a></span><span class="op" id="6218102">(</span><span class="ident" id="6218103"><a href="/os/signal/signal.go.html#6218070">n</a></span><span class="op" id="6218104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218111">}</span>&nbsp;<span class="keyword" id="6218113">else</span>&nbsp;<span class="op" id="6218118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218122">for</span>&nbsp;<span class="ident" id="6218126">_</span><span class="op" id="6218127">,</span>&nbsp;<span class="ident" id="6218129">s</span>&nbsp;<span class="op" id="6218131">:=</span>&nbsp;<span class="keyword" id="6218134">range</span>&nbsp;<span class="ident" id="6218140"><a href="/os/signal/signal.go.html#6217594">sig</a></span>&nbsp;<span class="op" id="6218144">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6218149"><a href="/os/signal/signal.go.html#6217883">add</a></span><span class="op" id="6218152">(</span><span class="ident" id="6218153"><a href="/os/signal/signal_unix.go.html#6219496">signum</a></span><span class="op" id="6218159">(</span><span class="ident" id="6218160"><a href="/os/signal/signal.go.html#6218129">s</a></span><span class="op" id="6218161">)</span><span class="op" id="6218162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218169">}</span><br>
<span class="lineno"></span><span class="op" id="6218171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="6218174">//&nbsp;Stop&nbsp;causes&nbsp;package&nbsp;signal&nbsp;to&nbsp;stop&nbsp;relaying&nbsp;incoming&nbsp;signals&nbsp;to&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="6218244">//&nbsp;It&nbsp;undoes&nbsp;the&nbsp;effect&nbsp;of&nbsp;all&nbsp;prior&nbsp;calls&nbsp;to&nbsp;Notify&nbsp;using&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="6218306">//&nbsp;When&nbsp;Stop&nbsp;returns,&nbsp;it&nbsp;is&nbsp;guaranteed&nbsp;that&nbsp;c&nbsp;will&nbsp;receive&nbsp;no&nbsp;more&nbsp;signals.</span><br>
<span class="lineno"></span><span class="keyword" id="6218382">func</span>&nbsp;<span class="ident" id="6218387">Stop</span><span class="op" id="6218391">(</span><span class="ident" id="6218392">c</span>&nbsp;<span class="keyword" id="6218394">chan</span><span class="op" id="6218398">&lt;-</span>&nbsp;<span class="ident" id="6218401"><a href="/os/signal/signal.go.html#6216435">os</a></span><span class="op" id="6218403">.</span><span class="ident" id="6218404">Signal</span><span class="op" id="6218410">)</span>&nbsp;<span class="op" id="6218412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6218415"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6218423">.</span><span class="ident" id="6218424">Lock</span><span class="op" id="6218428">(</span><span class="op" id="6218429">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218432">defer</span>&nbsp;<span class="ident" id="6218438"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6218446">.</span><span class="ident" id="6218447">Unlock</span><span class="op" id="6218453">(</span><span class="op" id="6218454">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6218458">h</span>&nbsp;<span class="op" id="6218460">:=</span>&nbsp;<span class="ident" id="6218463"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6218471">.</span><span class="ident" id="6218472">m</span><span class="op" id="6218473">[</span><span class="ident" id="6218474"><a href="/os/signal/signal.go.html#6218392">c</a></span><span class="op" id="6218475">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218478">if</span>&nbsp;<span class="ident" id="6218481"><a href="/os/signal/signal.go.html#6218458">h</a></span>&nbsp;<span class="op" id="6218483">==</span>&nbsp;<span class="ident" id="6218486">nil</span>&nbsp;<span class="op" id="6218490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218494">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6218505">delete</span><span class="op" id="6218511">(</span><span class="ident" id="6218512"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6218520">.</span><span class="ident" id="6218521">m</span><span class="op" id="6218522">,</span>&nbsp;<span class="ident" id="6218524"><a href="/os/signal/signal.go.html#6218392">c</a></span><span class="op" id="6218525">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218529">for</span>&nbsp;<span class="ident" id="6218533">n</span>&nbsp;<span class="op" id="6218535">:=</span>&nbsp;<span class="num" id="6218538">0</span><span class="op" id="6218539">;</span>&nbsp;<span class="ident" id="6218541"><a href="/os/signal/signal.go.html#6218533">n</a></span>&nbsp;<span class="op" id="6218543">&lt;</span>&nbsp;<span class="ident" id="6218545"><a href="/os/signal/signal_unix.go.html#6219450">numSig</a></span><span class="op" id="6218551">;</span>&nbsp;<span class="ident" id="6218553"><a href="/os/signal/signal.go.html#6218533">n</a></span><span class="op" id="6218554">++</span>&nbsp;<span class="op" id="6218557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218561">if</span>&nbsp;<span class="ident" id="6218564"><a href="/os/signal/signal.go.html#6218458">h</a></span><span class="op" id="6218565">.</span><span class="ident" id="6218566">want</span><span class="op" id="6218570">(</span><span class="ident" id="6218571"><a href="/os/signal/signal.go.html#6218533">n</a></span><span class="op" id="6218572">)</span>&nbsp;<span class="op" id="6218574">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6218579"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6218587">.</span><span class="ident" id="6218588">ref</span><span class="op" id="6218591">[</span><span class="ident" id="6218592"><a href="/os/signal/signal.go.html#6218533">n</a></span><span class="op" id="6218593">]</span><span class="op" id="6218594">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218600">if</span>&nbsp;<span class="ident" id="6218603"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6218611">.</span><span class="ident" id="6218612">ref</span><span class="op" id="6218615">[</span><span class="ident" id="6218616"><a href="/os/signal/signal.go.html#6218533">n</a></span><span class="op" id="6218617">]</span>&nbsp;<span class="op" id="6218619">==</span>&nbsp;<span class="num" id="6218622">0</span>&nbsp;<span class="op" id="6218624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6218630"><a href="/os/signal/signal_unix.go.html#6219739">disableSignal</a></span><span class="op" id="6218643">(</span><span class="ident" id="6218644"><a href="/os/signal/signal.go.html#6218533">n</a></span><span class="op" id="6218645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218654">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218657">}</span><br>
<span class="lineno"></span><span class="op" id="6218659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6218662">func</span>&nbsp;<span class="ident" id="6218667">process</span><span class="op" id="6218674">(</span><span class="ident" id="6218675">sig</span>&nbsp;<span class="ident" id="6218679"><a href="/os/signal/signal.go.html#6216435">os</a></span><span class="op" id="6218681">.</span><span class="ident" id="6218682">Signal</span><span class="op" id="6218688">)</span>&nbsp;<span class="op" id="6218690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6218693">n</span>&nbsp;<span class="op" id="6218695">:=</span>&nbsp;<span class="ident" id="6218698"><a href="/os/signal/signal_unix.go.html#6219496">signum</a></span><span class="op" id="6218704">(</span><span class="ident" id="6218705"><a href="/os/signal/signal.go.html#6218675">sig</a></span><span class="op" id="6218708">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218711">if</span>&nbsp;<span class="ident" id="6218714"><a href="/os/signal/signal.go.html#6218693">n</a></span>&nbsp;<span class="op" id="6218716">&lt;</span>&nbsp;<span class="num" id="6218718">0</span>&nbsp;<span class="op" id="6218720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218724">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6218736"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6218744">.</span><span class="ident" id="6218745">Lock</span><span class="op" id="6218749">(</span><span class="op" id="6218750">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218753">defer</span>&nbsp;<span class="ident" id="6218759"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6218767">.</span><span class="ident" id="6218768">Unlock</span><span class="op" id="6218774">(</span><span class="op" id="6218775">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218779">for</span>&nbsp;<span class="ident" id="6218783">c</span><span class="op" id="6218784">,</span>&nbsp;<span class="ident" id="6218786">h</span>&nbsp;<span class="op" id="6218788">:=</span>&nbsp;<span class="keyword" id="6218791">range</span>&nbsp;<span class="ident" id="6218797"><a href="/os/signal/signal.go.html#6216455">handlers</a></span><span class="op" id="6218805">.</span><span class="ident" id="6218806">m</span>&nbsp;<span class="op" id="6218808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218812">if</span>&nbsp;<span class="ident" id="6218815"><a href="/os/signal/signal.go.html#6218786">h</a></span><span class="op" id="6218816">.</span><span class="ident" id="6218817">want</span><span class="op" id="6218821">(</span><span class="ident" id="6218822"><a href="/os/signal/signal.go.html#6218693">n</a></span><span class="op" id="6218823">)</span>&nbsp;<span class="op" id="6218825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6218830">//&nbsp;send&nbsp;but&nbsp;do&nbsp;not&nbsp;block&nbsp;for&nbsp;it</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218865">select</span>&nbsp;<span class="op" id="6218872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218877">case</span>&nbsp;<span class="ident" id="6218882"><a href="/os/signal/signal.go.html#6218783">c</a></span>&nbsp;<span class="op" id="6218884">&lt;-</span>&nbsp;<span class="ident" id="6218887"><a href="/os/signal/signal.go.html#6218675">sig</a></span><span class="op" id="6218890">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6218895">default</span><span class="op" id="6218902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218911">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6218914">}</span><br>
<span class="lineno"></span><span class="op" id="6218916">}</span>
</div>
</body>
</html>
