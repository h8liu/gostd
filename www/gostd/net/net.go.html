<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html" class="current">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4135961">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4136016">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4136070">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4136121">/*<br>
<span class="lineno"></span>Package&nbsp;net&nbsp;provides&nbsp;a&nbsp;portable&nbsp;interface&nbsp;for&nbsp;network&nbsp;I/O,&nbsp;including<br>
<span class="lineno"></span>TCP/IP,&nbsp;UDP,&nbsp;domain&nbsp;name&nbsp;resolution,&nbsp;and&nbsp;Unix&nbsp;domain&nbsp;sockets.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>Although&nbsp;the&nbsp;package&nbsp;provides&nbsp;access&nbsp;to&nbsp;low-level&nbsp;networking<br>
<span class="lineno">10</span>primitives,&nbsp;most&nbsp;clients&nbsp;will&nbsp;need&nbsp;only&nbsp;the&nbsp;basic&nbsp;interface&nbsp;provided<br>
<span class="lineno"></span>by&nbsp;the&nbsp;Dial,&nbsp;Listen,&nbsp;and&nbsp;Accept&nbsp;functions&nbsp;and&nbsp;the&nbsp;associated<br>
<span class="lineno"></span>Conn&nbsp;and&nbsp;Listener&nbsp;interfaces.&nbsp;The&nbsp;crypto/tls&nbsp;package&nbsp;uses<br>
<span class="lineno"></span>the&nbsp;same&nbsp;interfaces&nbsp;and&nbsp;similar&nbsp;Dial&nbsp;and&nbsp;Listen&nbsp;functions.<br>
<span class="lineno"></span><br>
<span class="lineno">15</span>The&nbsp;Dial&nbsp;function&nbsp;connects&nbsp;to&nbsp;a&nbsp;server:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspconn,&nbsp;err&nbsp;:=&nbsp;net.Dial(&#34;tcp&#34;,&nbsp;&#34;google.com:80&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfmt.Fprintf(conn,&nbsp;&#34;GET&nbsp;/&nbsp;HTTP/1.0\r\n\r\n&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspstatus,&nbsp;err&nbsp;:=&nbsp;bufio.NewReader(conn).ReadString(&#39;\n&#39;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;...<br>
<span class="lineno"></span><br>
<span class="lineno">25</span>The&nbsp;Listen&nbsp;function&nbsp;creates&nbsp;servers:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspln,&nbsp;err&nbsp;:=&nbsp;net.Listen(&#34;tcp&#34;,&nbsp;&#34;:8080&#34;)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspfor&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspconn,&nbsp;err&nbsp;:=&nbsp;ln.Accept()<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;handle&nbsp;error<br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspgo&nbsp;handleConnection(conn)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp}<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="4137024">package</span>&nbsp;<span class="ident" id="4137032">net</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4137037">//&nbsp;TODO(rsc):</span><br>
<span class="lineno"></span><span class="comment" id="4137051">//&nbsp;&nbsp;&nbsp;&nbspsupport&nbsp;for&nbsp;raw&nbsp;ethernet&nbsp;sockets</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4137088">import</span>&nbsp;<span class="op" id="4137095">(</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4137098">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4137108">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4137114">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4137120">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4137131">&#34;time&#34;</span><br>
<span class="lineno">50</span><span class="op" id="4137138">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4137141">//&nbsp;Addr&nbsp;represents&nbsp;a&nbsp;network&nbsp;end&nbsp;point&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4137189">type</span>&nbsp;<span class="ident" id="4137194">Addr</span>&nbsp;<span class="keyword" id="4137199">interface</span>&nbsp;<span class="op" id="4137209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137212">Network</span><span class="op" id="4137219">(</span><span class="op" id="4137220">)</span>&nbsp;<span class="builtintype" id="4137222">string</span>&nbsp;<span class="comment" id="4137229">//&nbsp;name&nbsp;of&nbsp;the&nbsp;network</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137253">String</span><span class="op" id="4137259">(</span><span class="op" id="4137260">)</span>&nbsp;<span class="builtintype" id="4137262">string</span>&nbsp;&nbsp;<span class="comment" id="4137270">//&nbsp;string&nbsp;form&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span><span class="op" id="4137296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4137299">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;generic&nbsp;stream-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="4137356">//</span><br>
<span class="lineno">60</span><span class="comment" id="4137359">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Conn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="4137427">type</span>&nbsp;<span class="ident" id="4137432">Conn</span>&nbsp;<span class="keyword" id="4137437">interface</span>&nbsp;<span class="op" id="4137447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4137450">//&nbsp;Read&nbsp;reads&nbsp;data&nbsp;from&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4137491">//&nbsp;Read&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4137566">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137633">Read</span><span class="op" id="4137637">(</span><span class="ident" id="4137638">b</span>&nbsp;<span class="op" id="4137640">[</span><span class="op" id="4137641">]</span><span class="builtintype" id="4137642">byte</span><span class="op" id="4137646">)</span>&nbsp;<span class="op" id="4137648">(</span><span class="ident" id="4137649">n</span>&nbsp;<span class="builtintype" id="4137651">int</span><span class="op" id="4137654">,</span>&nbsp;<span class="ident" id="4137656">err</span>&nbsp;<span class="builtintype" id="4137660">error</span><span class="op" id="4137665">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4137669">//&nbsp;Write&nbsp;writes&nbsp;data&nbsp;to&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4137710">//&nbsp;Write&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;a&nbsp;Error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4137786">//&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137854">Write</span><span class="op" id="4137859">(</span><span class="ident" id="4137860">b</span>&nbsp;<span class="op" id="4137862">[</span><span class="op" id="4137863">]</span><span class="builtintype" id="4137864">byte</span><span class="op" id="4137868">)</span>&nbsp;<span class="op" id="4137870">(</span><span class="ident" id="4137871">n</span>&nbsp;<span class="builtintype" id="4137873">int</span><span class="op" id="4137876">,</span>&nbsp;<span class="ident" id="4137878">err</span>&nbsp;<span class="builtintype" id="4137882">error</span><span class="op" id="4137887">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4137891">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4137924">//&nbsp;Any&nbsp;blocked&nbsp;Read&nbsp;or&nbsp;Write&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138002">Close</span><span class="op" id="4138007">(</span><span class="op" id="4138008">)</span>&nbsp;<span class="builtintype" id="4138010">error</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138018">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138067">LocalAddr</span><span class="op" id="4138076">(</span><span class="op" id="4138077">)</span>&nbsp;<span class="ident" id="4138079">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138086">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138137">RemoteAddr</span><span class="op" id="4138147">(</span><span class="op" id="4138148">)</span>&nbsp;<span class="ident" id="4138150">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138157">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138218">//&nbsp;with&nbsp;the&nbsp;connection.&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;both</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138276">//&nbsp;SetReadDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138318">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138322">//&nbsp;A&nbsp;deadline&nbsp;is&nbsp;an&nbsp;absolute&nbsp;time&nbsp;after&nbsp;which&nbsp;I/O&nbsp;operations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138384">//&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138436">//&nbsp;blocking.&nbsp;The&nbsp;deadline&nbsp;applies&nbsp;to&nbsp;all&nbsp;future&nbsp;I/O,&nbsp;not&nbsp;just</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138499">//&nbsp;the&nbsp;immediately&nbsp;following&nbsp;call&nbsp;to&nbsp;Read&nbsp;or&nbsp;Write.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138552">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138556">//&nbsp;An&nbsp;idle&nbsp;timeout&nbsp;can&nbsp;be&nbsp;implemented&nbsp;by&nbsp;repeatedly&nbsp;extending</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138619">//&nbsp;the&nbsp;deadline&nbsp;after&nbsp;successful&nbsp;Read&nbsp;or&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138674">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138678">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;I/O&nbsp;operations&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138741">SetDeadline</span><span class="op" id="4138752">(</span><span class="ident" id="4138753">t</span>&nbsp;<span class="ident" id="4138755">time</span><span class="op" id="4138759">.</span><span class="ident" id="4138760">Time</span><span class="op" id="4138764">)</span>&nbsp;<span class="builtintype" id="4138766">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138774">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138835">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138888">SetReadDeadline</span><span class="op" id="4138903">(</span><span class="ident" id="4138904">t</span>&nbsp;<span class="ident" id="4138906">time</span><span class="op" id="4138910">.</span><span class="ident" id="4138911">Time</span><span class="op" id="4138915">)</span>&nbsp;<span class="builtintype" id="4138917">error</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138925">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4138988">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139054">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139101">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139155">SetWriteDeadline</span><span class="op" id="4139171">(</span><span class="ident" id="4139172">t</span>&nbsp;<span class="ident" id="4139174">time</span><span class="op" id="4139178">.</span><span class="ident" id="4139179">Time</span><span class="op" id="4139183">)</span>&nbsp;<span class="builtintype" id="4139185">error</span><br>
<span class="lineno"></span><span class="op" id="4139191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4139194">type</span>&nbsp;<span class="ident" id="4139199">conn</span>&nbsp;<span class="keyword" id="4139204">struct</span>&nbsp;<span class="op" id="4139211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139214">fd</span>&nbsp;<span class="op" id="4139217">*</span><span class="ident" id="4139218">netFD</span><br>
<span class="lineno">110</span><span class="op" id="4139224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4139227">func</span>&nbsp;<span class="op" id="4139232">(</span><span class="ident" id="4139233">c</span>&nbsp;<span class="op" id="4139235">*</span><span class="ident" id="4139236">conn</span><span class="op" id="4139240">)</span>&nbsp;<span class="ident" id="4139242">ok</span><span class="op" id="4139244">(</span><span class="op" id="4139245">)</span>&nbsp;<span class="builtintype" id="4139247">bool</span>&nbsp;<span class="op" id="4139252">{</span>&nbsp;<span class="keyword" id="4139254">return</span>&nbsp;<span class="ident" id="4139261">c</span>&nbsp;<span class="op" id="4139263">!=</span>&nbsp;<span class="ident" id="4139266">nil</span>&nbsp;<span class="op" id="4139270">&amp;&amp;</span>&nbsp;<span class="ident" id="4139273">c</span><span class="op" id="4139274">.</span><span class="ident" id="4139275">fd</span>&nbsp;<span class="op" id="4139278">!=</span>&nbsp;<span class="ident" id="4139281">nil</span>&nbsp;<span class="op" id="4139285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4139288">//&nbsp;Implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;interface.</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="4139330">//&nbsp;Read&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Read&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="4139371">func</span>&nbsp;<span class="op" id="4139376">(</span><span class="ident" id="4139377">c</span>&nbsp;<span class="op" id="4139379">*</span><span class="ident" id="4139380">conn</span><span class="op" id="4139384">)</span>&nbsp;<span class="ident" id="4139386">Read</span><span class="op" id="4139390">(</span><span class="ident" id="4139391">b</span>&nbsp;<span class="op" id="4139393">[</span><span class="op" id="4139394">]</span><span class="builtintype" id="4139395">byte</span><span class="op" id="4139399">)</span>&nbsp;<span class="op" id="4139401">(</span><span class="builtintype" id="4139402">int</span><span class="op" id="4139405">,</span>&nbsp;<span class="builtintype" id="4139407">error</span><span class="op" id="4139412">)</span>&nbsp;<span class="op" id="4139414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139417">if</span>&nbsp;<span class="op" id="4139420">!</span><span class="ident" id="4139421">c</span><span class="op" id="4139422">.</span><span class="ident" id="4139423">ok</span><span class="op" id="4139425">(</span><span class="op" id="4139426">)</span>&nbsp;<span class="op" id="4139428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139432">return</span>&nbsp;<span class="num" id="4139439">0</span><span class="op" id="4139440">,</span>&nbsp;<span class="ident" id="4139442">syscall</span><span class="op" id="4139449">.</span><span class="ident" id="4139450">EINVAL</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4139458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139461">return</span>&nbsp;<span class="ident" id="4139468">c</span><span class="op" id="4139469">.</span><span class="ident" id="4139470">fd</span><span class="op" id="4139472">.</span><span class="ident" id="4139473">Read</span><span class="op" id="4139477">(</span><span class="ident" id="4139478">b</span><span class="op" id="4139479">)</span><br>
<span class="lineno"></span><span class="op" id="4139481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4139484">//&nbsp;Write&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;Write&nbsp;method.</span><br>
<span class="lineno">125</span><span class="keyword" id="4139527">func</span>&nbsp;<span class="op" id="4139532">(</span><span class="ident" id="4139533">c</span>&nbsp;<span class="op" id="4139535">*</span><span class="ident" id="4139536">conn</span><span class="op" id="4139540">)</span>&nbsp;<span class="ident" id="4139542">Write</span><span class="op" id="4139547">(</span><span class="ident" id="4139548">b</span>&nbsp;<span class="op" id="4139550">[</span><span class="op" id="4139551">]</span><span class="builtintype" id="4139552">byte</span><span class="op" id="4139556">)</span>&nbsp;<span class="op" id="4139558">(</span><span class="builtintype" id="4139559">int</span><span class="op" id="4139562">,</span>&nbsp;<span class="builtintype" id="4139564">error</span><span class="op" id="4139569">)</span>&nbsp;<span class="op" id="4139571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139574">if</span>&nbsp;<span class="op" id="4139577">!</span><span class="ident" id="4139578">c</span><span class="op" id="4139579">.</span><span class="ident" id="4139580">ok</span><span class="op" id="4139582">(</span><span class="op" id="4139583">)</span>&nbsp;<span class="op" id="4139585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139589">return</span>&nbsp;<span class="num" id="4139596">0</span><span class="op" id="4139597">,</span>&nbsp;<span class="ident" id="4139599">syscall</span><span class="op" id="4139606">.</span><span class="ident" id="4139607">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4139615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139618">return</span>&nbsp;<span class="ident" id="4139625">c</span><span class="op" id="4139626">.</span><span class="ident" id="4139627">fd</span><span class="op" id="4139629">.</span><span class="ident" id="4139630">Write</span><span class="op" id="4139635">(</span><span class="ident" id="4139636">b</span><span class="op" id="4139637">)</span><br>
<span class="lineno">130</span><span class="op" id="4139639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4139642">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4139674">func</span>&nbsp;<span class="op" id="4139679">(</span><span class="ident" id="4139680">c</span>&nbsp;<span class="op" id="4139682">*</span><span class="ident" id="4139683">conn</span><span class="op" id="4139687">)</span>&nbsp;<span class="ident" id="4139689">Close</span><span class="op" id="4139694">(</span><span class="op" id="4139695">)</span>&nbsp;<span class="builtintype" id="4139697">error</span>&nbsp;<span class="op" id="4139703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139706">if</span>&nbsp;<span class="op" id="4139709">!</span><span class="ident" id="4139710">c</span><span class="op" id="4139711">.</span><span class="ident" id="4139712">ok</span><span class="op" id="4139714">(</span><span class="op" id="4139715">)</span>&nbsp;<span class="op" id="4139717">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139721">return</span>&nbsp;<span class="ident" id="4139728">syscall</span><span class="op" id="4139735">.</span><span class="ident" id="4139736">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4139744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139747">return</span>&nbsp;<span class="ident" id="4139754">c</span><span class="op" id="4139755">.</span><span class="ident" id="4139756">fd</span><span class="op" id="4139758">.</span><span class="ident" id="4139759">Close</span><span class="op" id="4139764">(</span><span class="op" id="4139765">)</span><br>
<span class="lineno"></span><span class="op" id="4139767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="comment" id="4139770">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4139818">func</span>&nbsp;<span class="op" id="4139823">(</span><span class="ident" id="4139824">c</span>&nbsp;<span class="op" id="4139826">*</span><span class="ident" id="4139827">conn</span><span class="op" id="4139831">)</span>&nbsp;<span class="ident" id="4139833">LocalAddr</span><span class="op" id="4139842">(</span><span class="op" id="4139843">)</span>&nbsp;<span class="ident" id="4139845">Addr</span>&nbsp;<span class="op" id="4139850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139853">if</span>&nbsp;<span class="op" id="4139856">!</span><span class="ident" id="4139857">c</span><span class="op" id="4139858">.</span><span class="ident" id="4139859">ok</span><span class="op" id="4139861">(</span><span class="op" id="4139862">)</span>&nbsp;<span class="op" id="4139864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139868">return</span>&nbsp;<span class="ident" id="4139875">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4139880">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139883">return</span>&nbsp;<span class="ident" id="4139890">c</span><span class="op" id="4139891">.</span><span class="ident" id="4139892">fd</span><span class="op" id="4139894">.</span><span class="ident" id="4139895">laddr</span><br>
<span class="lineno"></span><span class="op" id="4139901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4139904">//&nbsp;RemoteAddr&nbsp;returns&nbsp;the&nbsp;remote&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4139954">func</span>&nbsp;<span class="op" id="4139959">(</span><span class="ident" id="4139960">c</span>&nbsp;<span class="op" id="4139962">*</span><span class="ident" id="4139963">conn</span><span class="op" id="4139967">)</span>&nbsp;<span class="ident" id="4139969">RemoteAddr</span><span class="op" id="4139979">(</span><span class="op" id="4139980">)</span>&nbsp;<span class="ident" id="4139982">Addr</span>&nbsp;<span class="op" id="4139987">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139990">if</span>&nbsp;<span class="op" id="4139993">!</span><span class="ident" id="4139994">c</span><span class="op" id="4139995">.</span><span class="ident" id="4139996">ok</span><span class="op" id="4139998">(</span><span class="op" id="4139999">)</span>&nbsp;<span class="op" id="4140001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140005">return</span>&nbsp;<span class="ident" id="4140012">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4140017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140020">return</span>&nbsp;<span class="ident" id="4140027">c</span><span class="op" id="4140028">.</span><span class="ident" id="4140029">fd</span><span class="op" id="4140031">.</span><span class="ident" id="4140032">raddr</span><br>
<span class="lineno"></span><span class="op" id="4140038">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="4140041">//&nbsp;SetDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="4140096">func</span>&nbsp;<span class="op" id="4140101">(</span><span class="ident" id="4140102">c</span>&nbsp;<span class="op" id="4140104">*</span><span class="ident" id="4140105">conn</span><span class="op" id="4140109">)</span>&nbsp;<span class="ident" id="4140111">SetDeadline</span><span class="op" id="4140122">(</span><span class="ident" id="4140123">t</span>&nbsp;<span class="ident" id="4140125">time</span><span class="op" id="4140129">.</span><span class="ident" id="4140130">Time</span><span class="op" id="4140134">)</span>&nbsp;<span class="builtintype" id="4140136">error</span>&nbsp;<span class="op" id="4140142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140145">if</span>&nbsp;<span class="op" id="4140148">!</span><span class="ident" id="4140149">c</span><span class="op" id="4140150">.</span><span class="ident" id="4140151">ok</span><span class="op" id="4140153">(</span><span class="op" id="4140154">)</span>&nbsp;<span class="op" id="4140156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140160">return</span>&nbsp;<span class="ident" id="4140167">syscall</span><span class="op" id="4140174">.</span><span class="ident" id="4140175">EINVAL</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4140183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140186">return</span>&nbsp;<span class="ident" id="4140193">c</span><span class="op" id="4140194">.</span><span class="ident" id="4140195">fd</span><span class="op" id="4140197">.</span><span class="ident" id="4140198">setDeadline</span><span class="op" id="4140209">(</span><span class="ident" id="4140210">t</span><span class="op" id="4140211">)</span><br>
<span class="lineno"></span><span class="op" id="4140213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4140216">//&nbsp;SetReadDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetReadDeadline&nbsp;method.</span><br>
<span class="lineno">165</span><span class="keyword" id="4140279">func</span>&nbsp;<span class="op" id="4140284">(</span><span class="ident" id="4140285">c</span>&nbsp;<span class="op" id="4140287">*</span><span class="ident" id="4140288">conn</span><span class="op" id="4140292">)</span>&nbsp;<span class="ident" id="4140294">SetReadDeadline</span><span class="op" id="4140309">(</span><span class="ident" id="4140310">t</span>&nbsp;<span class="ident" id="4140312">time</span><span class="op" id="4140316">.</span><span class="ident" id="4140317">Time</span><span class="op" id="4140321">)</span>&nbsp;<span class="builtintype" id="4140323">error</span>&nbsp;<span class="op" id="4140329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140332">if</span>&nbsp;<span class="op" id="4140335">!</span><span class="ident" id="4140336">c</span><span class="op" id="4140337">.</span><span class="ident" id="4140338">ok</span><span class="op" id="4140340">(</span><span class="op" id="4140341">)</span>&nbsp;<span class="op" id="4140343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140347">return</span>&nbsp;<span class="ident" id="4140354">syscall</span><span class="op" id="4140361">.</span><span class="ident" id="4140362">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4140370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140373">return</span>&nbsp;<span class="ident" id="4140380">c</span><span class="op" id="4140381">.</span><span class="ident" id="4140382">fd</span><span class="op" id="4140384">.</span><span class="ident" id="4140385">setReadDeadline</span><span class="op" id="4140400">(</span><span class="ident" id="4140401">t</span><span class="op" id="4140402">)</span><br>
<span class="lineno">170</span><span class="op" id="4140404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4140407">//&nbsp;SetWriteDeadline&nbsp;implements&nbsp;the&nbsp;Conn&nbsp;SetWriteDeadline&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="4140472">func</span>&nbsp;<span class="op" id="4140477">(</span><span class="ident" id="4140478">c</span>&nbsp;<span class="op" id="4140480">*</span><span class="ident" id="4140481">conn</span><span class="op" id="4140485">)</span>&nbsp;<span class="ident" id="4140487">SetWriteDeadline</span><span class="op" id="4140503">(</span><span class="ident" id="4140504">t</span>&nbsp;<span class="ident" id="4140506">time</span><span class="op" id="4140510">.</span><span class="ident" id="4140511">Time</span><span class="op" id="4140515">)</span>&nbsp;<span class="builtintype" id="4140517">error</span>&nbsp;<span class="op" id="4140523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140526">if</span>&nbsp;<span class="op" id="4140529">!</span><span class="ident" id="4140530">c</span><span class="op" id="4140531">.</span><span class="ident" id="4140532">ok</span><span class="op" id="4140534">(</span><span class="op" id="4140535">)</span>&nbsp;<span class="op" id="4140537">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140541">return</span>&nbsp;<span class="ident" id="4140548">syscall</span><span class="op" id="4140555">.</span><span class="ident" id="4140556">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4140564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140567">return</span>&nbsp;<span class="ident" id="4140574">c</span><span class="op" id="4140575">.</span><span class="ident" id="4140576">fd</span><span class="op" id="4140578">.</span><span class="ident" id="4140579">setWriteDeadline</span><span class="op" id="4140595">(</span><span class="ident" id="4140596">t</span><span class="op" id="4140597">)</span><br>
<span class="lineno"></span><span class="op" id="4140599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="4140602">//&nbsp;SetReadBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4140659">//&nbsp;receive&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4140709">func</span>&nbsp;<span class="op" id="4140714">(</span><span class="ident" id="4140715">c</span>&nbsp;<span class="op" id="4140717">*</span><span class="ident" id="4140718">conn</span><span class="op" id="4140722">)</span>&nbsp;<span class="ident" id="4140724">SetReadBuffer</span><span class="op" id="4140737">(</span><span class="ident" id="4140738">bytes</span>&nbsp;<span class="builtintype" id="4140744">int</span><span class="op" id="4140747">)</span>&nbsp;<span class="builtintype" id="4140749">error</span>&nbsp;<span class="op" id="4140755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140758">if</span>&nbsp;<span class="op" id="4140761">!</span><span class="ident" id="4140762">c</span><span class="op" id="4140763">.</span><span class="ident" id="4140764">ok</span><span class="op" id="4140766">(</span><span class="op" id="4140767">)</span>&nbsp;<span class="op" id="4140769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140773">return</span>&nbsp;<span class="ident" id="4140780">syscall</span><span class="op" id="4140787">.</span><span class="ident" id="4140788">EINVAL</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4140796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140799">return</span>&nbsp;<span class="ident" id="4140806">setReadBuffer</span><span class="op" id="4140819">(</span><span class="ident" id="4140820">c</span><span class="op" id="4140821">.</span><span class="ident" id="4140822">fd</span><span class="op" id="4140824">,</span>&nbsp;<span class="ident" id="4140826">bytes</span><span class="op" id="4140831">)</span><br>
<span class="lineno"></span><span class="op" id="4140833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4140836">//&nbsp;SetWriteBuffer&nbsp;sets&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;operating&nbsp;system&#39;s</span><br>
<span class="lineno">190</span><span class="comment" id="4140894">//&nbsp;transmit&nbsp;buffer&nbsp;associated&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4140945">func</span>&nbsp;<span class="op" id="4140950">(</span><span class="ident" id="4140951">c</span>&nbsp;<span class="op" id="4140953">*</span><span class="ident" id="4140954">conn</span><span class="op" id="4140958">)</span>&nbsp;<span class="ident" id="4140960">SetWriteBuffer</span><span class="op" id="4140974">(</span><span class="ident" id="4140975">bytes</span>&nbsp;<span class="builtintype" id="4140981">int</span><span class="op" id="4140984">)</span>&nbsp;<span class="builtintype" id="4140986">error</span>&nbsp;<span class="op" id="4140992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140995">if</span>&nbsp;<span class="op" id="4140998">!</span><span class="ident" id="4140999">c</span><span class="op" id="4141000">.</span><span class="ident" id="4141001">ok</span><span class="op" id="4141003">(</span><span class="op" id="4141004">)</span>&nbsp;<span class="op" id="4141006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4141010">return</span>&nbsp;<span class="ident" id="4141017">syscall</span><span class="op" id="4141024">.</span><span class="ident" id="4141025">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4141033">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4141036">return</span>&nbsp;<span class="ident" id="4141043">setWriteBuffer</span><span class="op" id="4141057">(</span><span class="ident" id="4141058">c</span><span class="op" id="4141059">.</span><span class="ident" id="4141060">fd</span><span class="op" id="4141062">,</span>&nbsp;<span class="ident" id="4141064">bytes</span><span class="op" id="4141069">)</span><br>
<span class="lineno"></span><span class="op" id="4141071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4141074">//&nbsp;File&nbsp;sets&nbsp;the&nbsp;underlying&nbsp;os.File&nbsp;to&nbsp;blocking&nbsp;mode&nbsp;and&nbsp;returns&nbsp;a&nbsp;copy.</span><br>
<span class="lineno"></span><span class="comment" id="4141147">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.</span><br>
<span class="lineno">200</span><span class="comment" id="4141210">//&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="comment" id="4141275">//</span><br>
<span class="lineno"></span><span class="comment" id="4141278">//&nbsp;The&nbsp;returned&nbsp;os.File&#39;s&nbsp;file&nbsp;descriptor&nbsp;is&nbsp;different&nbsp;from&nbsp;the&nbsp;connection&#39;s.</span><br>
<span class="lineno"></span><span class="comment" id="4141356">//&nbsp;Attempting&nbsp;to&nbsp;change&nbsp;properties&nbsp;of&nbsp;the&nbsp;original&nbsp;using&nbsp;this&nbsp;duplicate</span><br>
<span class="lineno"></span><span class="comment" id="4141428">//&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;have&nbsp;the&nbsp;desired&nbsp;effect.</span><br>
<span class="lineno">205</span><span class="keyword" id="4141471">func</span>&nbsp;<span class="op" id="4141476">(</span><span class="ident" id="4141477">c</span>&nbsp;<span class="op" id="4141479">*</span><span class="ident" id="4141480">conn</span><span class="op" id="4141484">)</span>&nbsp;<span class="ident" id="4141486">File</span><span class="op" id="4141490">(</span><span class="op" id="4141491">)</span>&nbsp;<span class="op" id="4141493">(</span><span class="ident" id="4141494">f</span>&nbsp;<span class="op" id="4141496">*</span><span class="ident" id="4141497">os</span><span class="op" id="4141499">.</span><span class="ident" id="4141500">File</span><span class="op" id="4141504">,</span>&nbsp;<span class="ident" id="4141506">err</span>&nbsp;<span class="builtintype" id="4141510">error</span><span class="op" id="4141515">)</span>&nbsp;<span class="op" id="4141517">{</span>&nbsp;<span class="keyword" id="4141519">return</span>&nbsp;<span class="ident" id="4141526">c</span><span class="op" id="4141527">.</span><span class="ident" id="4141528">fd</span><span class="op" id="4141530">.</span><span class="ident" id="4141531">dup</span><span class="op" id="4141534">(</span><span class="op" id="4141535">)</span>&nbsp;<span class="op" id="4141537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4141540">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;network&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4141580">type</span>&nbsp;<span class="ident" id="4141585">Error</span>&nbsp;<span class="keyword" id="4141591">interface</span>&nbsp;<span class="op" id="4141601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4141604">error</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141611">Timeout</span><span class="op" id="4141618">(</span><span class="op" id="4141619">)</span>&nbsp;<span class="builtintype" id="4141621">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4141628">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;a&nbsp;timeout?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141656">Temporary</span><span class="op" id="4141665">(</span><span class="op" id="4141666">)</span>&nbsp;<span class="builtintype" id="4141668">bool</span>&nbsp;<span class="comment" id="4141673">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;temporary?</span><br>
<span class="lineno"></span><span class="op" id="4141700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4141703">//&nbsp;PacketConn&nbsp;is&nbsp;a&nbsp;generic&nbsp;packet-oriented&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">215</span><span class="comment" id="4141766">//</span><br>
<span class="lineno"></span><span class="comment" id="4141769">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;PacketConn&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="keyword" id="4141843">type</span>&nbsp;<span class="ident" id="4141848">PacketConn</span>&nbsp;<span class="keyword" id="4141859">interface</span>&nbsp;<span class="op" id="4141869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141872">//&nbsp;ReadFrom&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;the&nbsp;connection,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141921">//&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141979">//&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142031">//&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142054">//&nbsp;ReadFrom&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142102">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142164">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetReadDeadline.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142205">ReadFrom</span><span class="op" id="4142213">(</span><span class="ident" id="4142214">b</span>&nbsp;<span class="op" id="4142216">[</span><span class="op" id="4142217">]</span><span class="builtintype" id="4142218">byte</span><span class="op" id="4142222">)</span>&nbsp;<span class="op" id="4142224">(</span><span class="ident" id="4142225">n</span>&nbsp;<span class="builtintype" id="4142227">int</span><span class="op" id="4142230">,</span>&nbsp;<span class="ident" id="4142232">addr</span>&nbsp;<span class="ident" id="4142237">Addr</span><span class="op" id="4142241">,</span>&nbsp;<span class="ident" id="4142243">err</span>&nbsp;<span class="builtintype" id="4142247">error</span><span class="op" id="4142252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142256">//&nbsp;WriteTo&nbsp;writes&nbsp;a&nbsp;packet&nbsp;with&nbsp;payload&nbsp;b&nbsp;to&nbsp;addr.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142308">//&nbsp;WriteTo&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142355">//&nbsp;an&nbsp;error&nbsp;with&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142417">//&nbsp;see&nbsp;SetDeadline&nbsp;and&nbsp;SetWriteDeadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142459">//&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142520">WriteTo</span><span class="op" id="4142527">(</span><span class="ident" id="4142528">b</span>&nbsp;<span class="op" id="4142530">[</span><span class="op" id="4142531">]</span><span class="builtintype" id="4142532">byte</span><span class="op" id="4142536">,</span>&nbsp;<span class="ident" id="4142538">addr</span>&nbsp;<span class="ident" id="4142543">Addr</span><span class="op" id="4142547">)</span>&nbsp;<span class="op" id="4142549">(</span><span class="ident" id="4142550">n</span>&nbsp;<span class="builtintype" id="4142552">int</span><span class="op" id="4142555">,</span>&nbsp;<span class="ident" id="4142557">err</span>&nbsp;<span class="builtintype" id="4142561">error</span><span class="op" id="4142566">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142570">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142603">//&nbsp;Any&nbsp;blocked&nbsp;ReadFrom&nbsp;or&nbsp;WriteTo&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142687">Close</span><span class="op" id="4142692">(</span><span class="op" id="4142693">)</span>&nbsp;<span class="builtintype" id="4142695">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142703">//&nbsp;LocalAddr&nbsp;returns&nbsp;the&nbsp;local&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142752">LocalAddr</span><span class="op" id="4142761">(</span><span class="op" id="4142762">)</span>&nbsp;<span class="ident" id="4142764">Addr</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142771">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;read&nbsp;and&nbsp;write&nbsp;deadlines&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142832">//&nbsp;with&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142857">SetDeadline</span><span class="op" id="4142868">(</span><span class="ident" id="4142869">t</span>&nbsp;<span class="ident" id="4142871">time</span><span class="op" id="4142875">.</span><span class="ident" id="4142876">Time</span><span class="op" id="4142880">)</span>&nbsp;<span class="builtintype" id="4142882">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142890">//&nbsp;SetReadDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Read&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142951">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Read&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143013">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143055">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Read&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143108">SetReadDeadline</span><span class="op" id="4143123">(</span><span class="ident" id="4143124">t</span>&nbsp;<span class="ident" id="4143126">time</span><span class="op" id="4143130">.</span><span class="ident" id="4143131">Time</span><span class="op" id="4143135">)</span>&nbsp;<span class="builtintype" id="4143137">error</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143145">//&nbsp;SetWriteDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;for&nbsp;future&nbsp;Write&nbsp;calls.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143208">//&nbsp;If&nbsp;the&nbsp;deadline&nbsp;is&nbsp;reached,&nbsp;Write&nbsp;will&nbsp;fail&nbsp;with&nbsp;a&nbsp;timeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143271">//&nbsp;(see&nbsp;type&nbsp;Error)&nbsp;instead&nbsp;of&nbsp;blocking.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143313">//&nbsp;A&nbsp;zero&nbsp;value&nbsp;for&nbsp;t&nbsp;means&nbsp;Write&nbsp;will&nbsp;not&nbsp;time&nbsp;out.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143367">//&nbsp;Even&nbsp;if&nbsp;write&nbsp;times&nbsp;out,&nbsp;it&nbsp;may&nbsp;return&nbsp;n&nbsp;&gt;&nbsp;0,&nbsp;indicating&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143433">//&nbsp;some&nbsp;of&nbsp;the&nbsp;data&nbsp;was&nbsp;successfully&nbsp;written.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143480">SetWriteDeadline</span><span class="op" id="4143496">(</span><span class="ident" id="4143497">t</span>&nbsp;<span class="ident" id="4143499">time</span><span class="op" id="4143503">.</span><span class="ident" id="4143504">Time</span><span class="op" id="4143508">)</span>&nbsp;<span class="builtintype" id="4143510">error</span><br>
<span class="lineno"></span><span class="op" id="4143516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="4143519">var</span>&nbsp;<span class="ident" id="4143523">listenerBacklog</span>&nbsp;<span class="op" id="4143539">=</span>&nbsp;<span class="ident" id="4143541">maxListenerBacklog</span><span class="op" id="4143559">(</span><span class="op" id="4143560">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4143563">//&nbsp;A&nbsp;Listener&nbsp;is&nbsp;a&nbsp;generic&nbsp;network&nbsp;listener&nbsp;for&nbsp;stream-oriented&nbsp;protocols.</span><br>
<span class="lineno"></span><span class="comment" id="4143638">//</span><br>
<span class="lineno"></span><span class="comment" id="4143641">//&nbsp;Multiple&nbsp;goroutines&nbsp;may&nbsp;invoke&nbsp;methods&nbsp;on&nbsp;a&nbsp;Listener&nbsp;simultaneously.</span><br>
<span class="lineno">265</span><span class="keyword" id="4143713">type</span>&nbsp;<span class="ident" id="4143718">Listener</span>&nbsp;<span class="keyword" id="4143727">interface</span>&nbsp;<span class="op" id="4143737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143740">//&nbsp;Accept&nbsp;waits&nbsp;for&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;connection&nbsp;to&nbsp;the&nbsp;listener.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143810">Accept</span><span class="op" id="4143816">(</span><span class="op" id="4143817">)</span>&nbsp;<span class="op" id="4143819">(</span><span class="ident" id="4143820">c</span>&nbsp;<span class="ident" id="4143822">Conn</span><span class="op" id="4143826">,</span>&nbsp;<span class="ident" id="4143828">err</span>&nbsp;<span class="builtintype" id="4143832">error</span><span class="op" id="4143837">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143841">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;listener.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143872">//&nbsp;Any&nbsp;blocked&nbsp;Accept&nbsp;operations&nbsp;will&nbsp;be&nbsp;unblocked&nbsp;and&nbsp;return&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143943">Close</span><span class="op" id="4143948">(</span><span class="op" id="4143949">)</span>&nbsp;<span class="builtintype" id="4143951">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143959">//&nbsp;Addr&nbsp;returns&nbsp;the&nbsp;listener&#39;s&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144008">Addr</span><span class="op" id="4144012">(</span><span class="op" id="4144013">)</span>&nbsp;<span class="ident" id="4144015">Addr</span><br>
<span class="lineno">275</span><span class="op" id="4144020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4144023">//&nbsp;Various&nbsp;errors&nbsp;contained&nbsp;in&nbsp;OpError.</span><br>
<span class="lineno"></span><span class="keyword" id="4144063">var</span>&nbsp;<span class="op" id="4144067">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144070">//&nbsp;For&nbsp;connection&nbsp;setup&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144117">errMissingAddress</span>&nbsp;<span class="op" id="4144135">=</span>&nbsp;<span class="ident" id="4144137">errors</span><span class="op" id="4144143">.</span><span class="ident" id="4144144">New</span><span class="op" id="4144147">(</span><span class="string" id="4144148">&#34;missing&nbsp;address&#34;</span><span class="op" id="4144165">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144169">//&nbsp;For&nbsp;both&nbsp;read&nbsp;and&nbsp;write&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144209">errTimeout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4144229">error</span>&nbsp;<span class="op" id="4144235">=</span>&nbsp;<span class="op" id="4144237">&amp;</span><span class="ident" id="4144238">timeoutError</span><span class="op" id="4144250">{</span><span class="op" id="4144251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144254">errClosing</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4144280">=</span>&nbsp;<span class="ident" id="4144282">errors</span><span class="op" id="4144288">.</span><span class="ident" id="4144289">New</span><span class="op" id="4144292">(</span><span class="string" id="4144293">&#34;use&nbsp;of&nbsp;closed&nbsp;network&nbsp;connection&#34;</span><span class="op" id="4144327">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144330">ErrWriteToConnected</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4144356">=</span>&nbsp;<span class="ident" id="4144358">errors</span><span class="op" id="4144364">.</span><span class="ident" id="4144365">New</span><span class="op" id="4144368">(</span><span class="string" id="4144369">&#34;use&nbsp;of&nbsp;WriteTo&nbsp;with&nbsp;pre-connected&nbsp;connection&#34;</span><span class="op" id="4144415">)</span><br>
<span class="lineno"></span><span class="op" id="4144417">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4144420">//&nbsp;OpError&nbsp;is&nbsp;the&nbsp;error&nbsp;type&nbsp;usually&nbsp;returned&nbsp;by&nbsp;functions&nbsp;in&nbsp;the&nbsp;net</span><br>
<span class="lineno"></span><span class="comment" id="4144490">//&nbsp;package.&nbsp;It&nbsp;describes&nbsp;the&nbsp;operation,&nbsp;network&nbsp;type,&nbsp;and&nbsp;address&nbsp;of</span><br>
<span class="lineno">290</span><span class="comment" id="4144559">//&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4144572">type</span>&nbsp;<span class="ident" id="4144577">OpError</span>&nbsp;<span class="keyword" id="4144585">struct</span>&nbsp;<span class="op" id="4144592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144595">//&nbsp;Op&nbsp;is&nbsp;the&nbsp;operation&nbsp;which&nbsp;caused&nbsp;the&nbsp;error,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144651">//&nbsp;&#34;read&#34;&nbsp;or&nbsp;&#34;write&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144674">Op</span>&nbsp;<span class="builtintype" id="4144677">string</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144686">//&nbsp;Net&nbsp;is&nbsp;the&nbsp;network&nbsp;type&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144744">//&nbsp;such&nbsp;as&nbsp;&#34;tcp&#34;&nbsp;or&nbsp;&#34;udp6&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144773">Net</span>&nbsp;<span class="builtintype" id="4144777">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144786">//&nbsp;Addr&nbsp;is&nbsp;the&nbsp;network&nbsp;address&nbsp;on&nbsp;which&nbsp;this&nbsp;error&nbsp;occurred.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144848">Addr</span>&nbsp;<span class="ident" id="4144853">Addr</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144860">//&nbsp;Err&nbsp;is&nbsp;the&nbsp;error&nbsp;that&nbsp;occurred&nbsp;during&nbsp;the&nbsp;operation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144917">Err</span>&nbsp;<span class="builtintype" id="4144921">error</span><br>
<span class="lineno">305</span><span class="op" id="4144927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4144930">func</span>&nbsp;<span class="op" id="4144935">(</span><span class="ident" id="4144936">e</span>&nbsp;<span class="op" id="4144938">*</span><span class="ident" id="4144939">OpError</span><span class="op" id="4144946">)</span>&nbsp;<span class="ident" id="4144948">Error</span><span class="op" id="4144953">(</span><span class="op" id="4144954">)</span>&nbsp;<span class="builtintype" id="4144956">string</span>&nbsp;<span class="op" id="4144963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144966">if</span>&nbsp;<span class="ident" id="4144969">e</span>&nbsp;<span class="op" id="4144971">==</span>&nbsp;<span class="ident" id="4144974">nil</span>&nbsp;<span class="op" id="4144978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144982">return</span>&nbsp;<span class="string" id="4144989">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145001">s</span>&nbsp;<span class="op" id="4145003">:=</span>&nbsp;<span class="ident" id="4145006">e</span><span class="op" id="4145007">.</span><span class="ident" id="4145008">Op</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145012">if</span>&nbsp;<span class="ident" id="4145015">e</span><span class="op" id="4145016">.</span><span class="ident" id="4145017">Net</span>&nbsp;<span class="op" id="4145021">!=</span>&nbsp;<span class="string" id="4145024">&#34;&#34;</span>&nbsp;<span class="op" id="4145027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145031">s</span>&nbsp;<span class="op" id="4145033">+=</span>&nbsp;<span class="string" id="4145036">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="4145040">+</span>&nbsp;<span class="ident" id="4145042">e</span><span class="op" id="4145043">.</span><span class="ident" id="4145044">Net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145049">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145052">if</span>&nbsp;<span class="ident" id="4145055">e</span><span class="op" id="4145056">.</span><span class="ident" id="4145057">Addr</span>&nbsp;<span class="op" id="4145062">!=</span>&nbsp;<span class="ident" id="4145065">nil</span>&nbsp;<span class="op" id="4145069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145073">s</span>&nbsp;<span class="op" id="4145075">+=</span>&nbsp;<span class="string" id="4145078">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="4145082">+</span>&nbsp;<span class="ident" id="4145084">e</span><span class="op" id="4145085">.</span><span class="ident" id="4145086">Addr</span><span class="op" id="4145090">.</span><span class="ident" id="4145091">String</span><span class="op" id="4145097">(</span><span class="op" id="4145098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145104">s</span>&nbsp;<span class="op" id="4145106">+=</span>&nbsp;<span class="string" id="4145109">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="4145114">+</span>&nbsp;<span class="ident" id="4145116">e</span><span class="op" id="4145117">.</span><span class="ident" id="4145118">Err</span><span class="op" id="4145121">.</span><span class="ident" id="4145122">Error</span><span class="op" id="4145127">(</span><span class="op" id="4145128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145131">return</span>&nbsp;<span class="ident" id="4145138">s</span><br>
<span class="lineno">320</span><span class="op" id="4145140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145143">type</span>&nbsp;<span class="ident" id="4145148">temporary</span>&nbsp;<span class="keyword" id="4145158">interface</span>&nbsp;<span class="op" id="4145168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145171">Temporary</span><span class="op" id="4145180">(</span><span class="op" id="4145181">)</span>&nbsp;<span class="builtintype" id="4145183">bool</span><br>
<span class="lineno"></span><span class="op" id="4145188">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="4145191">func</span>&nbsp;<span class="op" id="4145196">(</span><span class="ident" id="4145197">e</span>&nbsp;<span class="op" id="4145199">*</span><span class="ident" id="4145200">OpError</span><span class="op" id="4145207">)</span>&nbsp;<span class="ident" id="4145209">Temporary</span><span class="op" id="4145218">(</span><span class="op" id="4145219">)</span>&nbsp;<span class="builtintype" id="4145221">bool</span>&nbsp;<span class="op" id="4145226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145229">t</span><span class="op" id="4145230">,</span>&nbsp;<span class="ident" id="4145232">ok</span>&nbsp;<span class="op" id="4145235">:=</span>&nbsp;<span class="ident" id="4145238">e</span><span class="op" id="4145239">.</span><span class="ident" id="4145240">Err</span><span class="op" id="4145243">.</span><span class="op" id="4145244">(</span><span class="ident" id="4145245">temporary</span><span class="op" id="4145254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145257">return</span>&nbsp;<span class="ident" id="4145264">ok</span>&nbsp;<span class="op" id="4145267">&amp;&amp;</span>&nbsp;<span class="ident" id="4145270">t</span><span class="op" id="4145271">.</span><span class="ident" id="4145272">Temporary</span><span class="op" id="4145281">(</span><span class="op" id="4145282">)</span><br>
<span class="lineno"></span><span class="op" id="4145284">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="4145287">var</span>&nbsp;<span class="ident" id="4145291">noDeadline</span>&nbsp;<span class="op" id="4145302">=</span>&nbsp;<span class="ident" id="4145304">time</span><span class="op" id="4145308">.</span><span class="ident" id="4145309">Time</span><span class="op" id="4145313">{</span><span class="op" id="4145314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145317">type</span>&nbsp;<span class="ident" id="4145322">timeout</span>&nbsp;<span class="keyword" id="4145330">interface</span>&nbsp;<span class="op" id="4145340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145343">Timeout</span><span class="op" id="4145350">(</span><span class="op" id="4145351">)</span>&nbsp;<span class="builtintype" id="4145353">bool</span><br>
<span class="lineno">335</span><span class="op" id="4145358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145361">func</span>&nbsp;<span class="op" id="4145366">(</span><span class="ident" id="4145367">e</span>&nbsp;<span class="op" id="4145369">*</span><span class="ident" id="4145370">OpError</span><span class="op" id="4145377">)</span>&nbsp;<span class="ident" id="4145379">Timeout</span><span class="op" id="4145386">(</span><span class="op" id="4145387">)</span>&nbsp;<span class="builtintype" id="4145389">bool</span>&nbsp;<span class="op" id="4145394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145397">t</span><span class="op" id="4145398">,</span>&nbsp;<span class="ident" id="4145400">ok</span>&nbsp;<span class="op" id="4145403">:=</span>&nbsp;<span class="ident" id="4145406">e</span><span class="op" id="4145407">.</span><span class="ident" id="4145408">Err</span><span class="op" id="4145411">.</span><span class="op" id="4145412">(</span><span class="ident" id="4145413">timeout</span><span class="op" id="4145420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145423">return</span>&nbsp;<span class="ident" id="4145430">ok</span>&nbsp;<span class="op" id="4145433">&amp;&amp;</span>&nbsp;<span class="ident" id="4145436">t</span><span class="op" id="4145437">.</span><span class="ident" id="4145438">Timeout</span><span class="op" id="4145445">(</span><span class="op" id="4145446">)</span><br>
<span class="lineno">340</span><span class="op" id="4145448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145451">type</span>&nbsp;<span class="ident" id="4145456">timeoutError</span>&nbsp;<span class="keyword" id="4145469">struct</span><span class="op" id="4145475">{</span><span class="op" id="4145476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145479">func</span>&nbsp;<span class="op" id="4145484">(</span><span class="ident" id="4145485">e</span>&nbsp;<span class="op" id="4145487">*</span><span class="ident" id="4145488">timeoutError</span><span class="op" id="4145500">)</span>&nbsp;<span class="ident" id="4145502">Error</span><span class="op" id="4145507">(</span><span class="op" id="4145508">)</span>&nbsp;<span class="builtintype" id="4145510">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4145519">{</span>&nbsp;<span class="keyword" id="4145521">return</span>&nbsp;<span class="string" id="4145528">&#34;i/o&nbsp;timeout&#34;</span>&nbsp;<span class="op" id="4145542">}</span><br>
<span class="lineno">345</span><span class="keyword" id="4145544">func</span>&nbsp;<span class="op" id="4145549">(</span><span class="ident" id="4145550">e</span>&nbsp;<span class="op" id="4145552">*</span><span class="ident" id="4145553">timeoutError</span><span class="op" id="4145565">)</span>&nbsp;<span class="ident" id="4145567">Timeout</span><span class="op" id="4145574">(</span><span class="op" id="4145575">)</span>&nbsp;<span class="builtintype" id="4145577">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4145584">{</span>&nbsp;<span class="keyword" id="4145586">return</span>&nbsp;<span class="builtintype" id="4145593">true</span>&nbsp;<span class="op" id="4145598">}</span><br>
<span class="lineno"></span><span class="keyword" id="4145600">func</span>&nbsp;<span class="op" id="4145605">(</span><span class="ident" id="4145606">e</span>&nbsp;<span class="op" id="4145608">*</span><span class="ident" id="4145609">timeoutError</span><span class="op" id="4145621">)</span>&nbsp;<span class="ident" id="4145623">Temporary</span><span class="op" id="4145632">(</span><span class="op" id="4145633">)</span>&nbsp;<span class="builtintype" id="4145635">bool</span>&nbsp;<span class="op" id="4145640">{</span>&nbsp;<span class="keyword" id="4145642">return</span>&nbsp;<span class="builtintype" id="4145649">true</span>&nbsp;<span class="op" id="4145654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145657">type</span>&nbsp;<span class="ident" id="4145662">AddrError</span>&nbsp;<span class="keyword" id="4145672">struct</span>&nbsp;<span class="op" id="4145679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145682">Err</span>&nbsp;&nbsp;<span class="builtintype" id="4145687">string</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145695">Addr</span>&nbsp;<span class="builtintype" id="4145700">string</span><br>
<span class="lineno"></span><span class="op" id="4145707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145710">func</span>&nbsp;<span class="op" id="4145715">(</span><span class="ident" id="4145716">e</span>&nbsp;<span class="op" id="4145718">*</span><span class="ident" id="4145719">AddrError</span><span class="op" id="4145728">)</span>&nbsp;<span class="ident" id="4145730">Error</span><span class="op" id="4145735">(</span><span class="op" id="4145736">)</span>&nbsp;<span class="builtintype" id="4145738">string</span>&nbsp;<span class="op" id="4145745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145748">if</span>&nbsp;<span class="ident" id="4145751">e</span>&nbsp;<span class="op" id="4145753">==</span>&nbsp;<span class="ident" id="4145756">nil</span>&nbsp;<span class="op" id="4145760">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145764">return</span>&nbsp;<span class="string" id="4145771">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145783">s</span>&nbsp;<span class="op" id="4145785">:=</span>&nbsp;<span class="ident" id="4145788">e</span><span class="op" id="4145789">.</span><span class="ident" id="4145790">Err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145795">if</span>&nbsp;<span class="ident" id="4145798">e</span><span class="op" id="4145799">.</span><span class="ident" id="4145800">Addr</span>&nbsp;<span class="op" id="4145805">!=</span>&nbsp;<span class="string" id="4145808">&#34;&#34;</span>&nbsp;<span class="op" id="4145811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145815">s</span>&nbsp;<span class="op" id="4145817">+=</span>&nbsp;<span class="string" id="4145820">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="4145824">+</span>&nbsp;<span class="ident" id="4145826">e</span><span class="op" id="4145827">.</span><span class="ident" id="4145828">Addr</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145837">return</span>&nbsp;<span class="ident" id="4145844">s</span><br>
<span class="lineno"></span><span class="op" id="4145846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145849">func</span>&nbsp;<span class="op" id="4145854">(</span><span class="ident" id="4145855">e</span>&nbsp;<span class="op" id="4145857">*</span><span class="ident" id="4145858">AddrError</span><span class="op" id="4145867">)</span>&nbsp;<span class="ident" id="4145869">Temporary</span><span class="op" id="4145878">(</span><span class="op" id="4145879">)</span>&nbsp;<span class="builtintype" id="4145881">bool</span>&nbsp;<span class="op" id="4145886">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145889">return</span>&nbsp;<span class="builtintype" id="4145896">false</span><br>
<span class="lineno"></span><span class="op" id="4145902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145905">func</span>&nbsp;<span class="op" id="4145910">(</span><span class="ident" id="4145911">e</span>&nbsp;<span class="op" id="4145913">*</span><span class="ident" id="4145914">AddrError</span><span class="op" id="4145923">)</span>&nbsp;<span class="ident" id="4145925">Timeout</span><span class="op" id="4145932">(</span><span class="op" id="4145933">)</span>&nbsp;<span class="builtintype" id="4145935">bool</span>&nbsp;<span class="op" id="4145940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145943">return</span>&nbsp;<span class="builtintype" id="4145950">false</span><br>
<span class="lineno">370</span><span class="op" id="4145956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145959">type</span>&nbsp;<span class="ident" id="4145964">UnknownNetworkError</span>&nbsp;<span class="builtintype" id="4145984">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145992">func</span>&nbsp;<span class="op" id="4145997">(</span><span class="ident" id="4145998">e</span>&nbsp;<span class="ident" id="4146000">UnknownNetworkError</span><span class="op" id="4146019">)</span>&nbsp;<span class="ident" id="4146021">Error</span><span class="op" id="4146026">(</span><span class="op" id="4146027">)</span>&nbsp;<span class="builtintype" id="4146029">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4146038">{</span>&nbsp;<span class="keyword" id="4146040">return</span>&nbsp;<span class="string" id="4146047">&#34;unknown&nbsp;network&nbsp;&#34;</span>&nbsp;<span class="op" id="4146066">+</span>&nbsp;<span class="builtintype" id="4146068">string</span><span class="op" id="4146074">(</span><span class="ident" id="4146075">e</span><span class="op" id="4146076">)</span>&nbsp;<span class="op" id="4146078">}</span><br>
<span class="lineno">375</span><span class="keyword" id="4146080">func</span>&nbsp;<span class="op" id="4146085">(</span><span class="ident" id="4146086">e</span>&nbsp;<span class="ident" id="4146088">UnknownNetworkError</span><span class="op" id="4146107">)</span>&nbsp;<span class="ident" id="4146109">Temporary</span><span class="op" id="4146118">(</span><span class="op" id="4146119">)</span>&nbsp;<span class="builtintype" id="4146121">bool</span>&nbsp;<span class="op" id="4146126">{</span>&nbsp;<span class="keyword" id="4146128">return</span>&nbsp;<span class="builtintype" id="4146135">false</span>&nbsp;<span class="op" id="4146141">}</span><br>
<span class="lineno"></span><span class="keyword" id="4146143">func</span>&nbsp;<span class="op" id="4146148">(</span><span class="ident" id="4146149">e</span>&nbsp;<span class="ident" id="4146151">UnknownNetworkError</span><span class="op" id="4146170">)</span>&nbsp;<span class="ident" id="4146172">Timeout</span><span class="op" id="4146179">(</span><span class="op" id="4146180">)</span>&nbsp;<span class="builtintype" id="4146182">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4146189">{</span>&nbsp;<span class="keyword" id="4146191">return</span>&nbsp;<span class="builtintype" id="4146198">false</span>&nbsp;<span class="op" id="4146204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4146207">type</span>&nbsp;<span class="ident" id="4146212">InvalidAddrError</span>&nbsp;<span class="builtintype" id="4146229">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span><span class="keyword" id="4146237">func</span>&nbsp;<span class="op" id="4146242">(</span><span class="ident" id="4146243">e</span>&nbsp;<span class="ident" id="4146245">InvalidAddrError</span><span class="op" id="4146261">)</span>&nbsp;<span class="ident" id="4146263">Error</span><span class="op" id="4146268">(</span><span class="op" id="4146269">)</span>&nbsp;<span class="builtintype" id="4146271">string</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4146280">{</span>&nbsp;<span class="keyword" id="4146282">return</span>&nbsp;<span class="builtintype" id="4146289">string</span><span class="op" id="4146295">(</span><span class="ident" id="4146296">e</span><span class="op" id="4146297">)</span>&nbsp;<span class="op" id="4146299">}</span><br>
<span class="lineno"></span><span class="keyword" id="4146301">func</span>&nbsp;<span class="op" id="4146306">(</span><span class="ident" id="4146307">e</span>&nbsp;<span class="ident" id="4146309">InvalidAddrError</span><span class="op" id="4146325">)</span>&nbsp;<span class="ident" id="4146327">Timeout</span><span class="op" id="4146334">(</span><span class="op" id="4146335">)</span>&nbsp;<span class="builtintype" id="4146337">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4146344">{</span>&nbsp;<span class="keyword" id="4146346">return</span>&nbsp;<span class="builtintype" id="4146353">false</span>&nbsp;<span class="op" id="4146359">}</span><br>
<span class="lineno"></span><span class="keyword" id="4146361">func</span>&nbsp;<span class="op" id="4146366">(</span><span class="ident" id="4146367">e</span>&nbsp;<span class="ident" id="4146369">InvalidAddrError</span><span class="op" id="4146385">)</span>&nbsp;<span class="ident" id="4146387">Temporary</span><span class="op" id="4146396">(</span><span class="op" id="4146397">)</span>&nbsp;<span class="builtintype" id="4146399">bool</span>&nbsp;<span class="op" id="4146404">{</span>&nbsp;<span class="keyword" id="4146406">return</span>&nbsp;<span class="builtintype" id="4146413">false</span>&nbsp;<span class="op" id="4146419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4146422">//&nbsp;DNSConfigError&nbsp;represents&nbsp;an&nbsp;error&nbsp;reading&nbsp;the&nbsp;machine&#39;s&nbsp;DNS&nbsp;configuration.</span><br>
<span class="lineno">385</span><span class="keyword" id="4146501">type</span>&nbsp;<span class="ident" id="4146506">DNSConfigError</span>&nbsp;<span class="keyword" id="4146521">struct</span>&nbsp;<span class="op" id="4146528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146531">Err</span>&nbsp;<span class="builtintype" id="4146535">error</span><br>
<span class="lineno"></span><span class="op" id="4146541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4146544">func</span>&nbsp;<span class="op" id="4146549">(</span><span class="ident" id="4146550">e</span>&nbsp;<span class="op" id="4146552">*</span><span class="ident" id="4146553">DNSConfigError</span><span class="op" id="4146567">)</span>&nbsp;<span class="ident" id="4146569">Error</span><span class="op" id="4146574">(</span><span class="op" id="4146575">)</span>&nbsp;<span class="builtintype" id="4146577">string</span>&nbsp;<span class="op" id="4146584">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146587">return</span>&nbsp;<span class="string" id="4146594">&#34;error&nbsp;reading&nbsp;DNS&nbsp;config:&nbsp;&#34;</span>&nbsp;<span class="op" id="4146623">+</span>&nbsp;<span class="ident" id="4146625">e</span><span class="op" id="4146626">.</span><span class="ident" id="4146627">Err</span><span class="op" id="4146630">.</span><span class="ident" id="4146631">Error</span><span class="op" id="4146636">(</span><span class="op" id="4146637">)</span><br>
<span class="lineno"></span><span class="op" id="4146639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4146642">func</span>&nbsp;<span class="op" id="4146647">(</span><span class="ident" id="4146648">e</span>&nbsp;<span class="op" id="4146650">*</span><span class="ident" id="4146651">DNSConfigError</span><span class="op" id="4146665">)</span>&nbsp;<span class="ident" id="4146667">Timeout</span><span class="op" id="4146674">(</span><span class="op" id="4146675">)</span>&nbsp;<span class="builtintype" id="4146677">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4146684">{</span>&nbsp;<span class="keyword" id="4146686">return</span>&nbsp;<span class="builtintype" id="4146693">false</span>&nbsp;<span class="op" id="4146699">}</span><br>
<span class="lineno"></span><span class="keyword" id="4146701">func</span>&nbsp;<span class="op" id="4146706">(</span><span class="ident" id="4146707">e</span>&nbsp;<span class="op" id="4146709">*</span><span class="ident" id="4146710">DNSConfigError</span><span class="op" id="4146724">)</span>&nbsp;<span class="ident" id="4146726">Temporary</span><span class="op" id="4146735">(</span><span class="op" id="4146736">)</span>&nbsp;<span class="builtintype" id="4146738">bool</span>&nbsp;<span class="op" id="4146743">{</span>&nbsp;<span class="keyword" id="4146745">return</span>&nbsp;<span class="builtintype" id="4146752">false</span>&nbsp;<span class="op" id="4146758">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="4146761">type</span>&nbsp;<span class="ident" id="4146766">writerOnly</span>&nbsp;<span class="keyword" id="4146777">struct</span>&nbsp;<span class="op" id="4146784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146787">io</span><span class="op" id="4146789">.</span><span class="ident" id="4146790">Writer</span><br>
<span class="lineno"></span><span class="op" id="4146797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="comment" id="4146800">//&nbsp;Fallback&nbsp;implementation&nbsp;of&nbsp;io.ReaderFrom&#39;s&nbsp;ReadFrom,&nbsp;when&nbsp;sendfile&nbsp;isn&#39;t</span><br>
<span class="lineno"></span><span class="comment" id="4146876">//&nbsp;applicable.</span><br>
<span class="lineno"></span><span class="keyword" id="4146891">func</span>&nbsp;<span class="ident" id="4146896">genericReadFrom</span><span class="op" id="4146911">(</span><span class="ident" id="4146912">w</span>&nbsp;<span class="ident" id="4146914">io</span><span class="op" id="4146916">.</span><span class="ident" id="4146917">Writer</span><span class="op" id="4146923">,</span>&nbsp;<span class="ident" id="4146925">r</span>&nbsp;<span class="ident" id="4146927">io</span><span class="op" id="4146929">.</span><span class="ident" id="4146930">Reader</span><span class="op" id="4146936">)</span>&nbsp;<span class="op" id="4146938">(</span><span class="ident" id="4146939">n</span>&nbsp;<span class="ident" id="4146941">int64</span><span class="op" id="4146946">,</span>&nbsp;<span class="ident" id="4146948">err</span>&nbsp;<span class="builtintype" id="4146952">error</span><span class="op" id="4146957">)</span>&nbsp;<span class="op" id="4146959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4146962">//&nbsp;Use&nbsp;wrapper&nbsp;to&nbsp;hide&nbsp;existing&nbsp;r.ReadFrom&nbsp;from&nbsp;io.Copy.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147020">return</span>&nbsp;<span class="ident" id="4147027">io</span><span class="op" id="4147029">.</span><span class="ident" id="4147030">Copy</span><span class="op" id="4147034">(</span><span class="ident" id="4147035">writerOnly</span><span class="op" id="4147045">{</span><span class="ident" id="4147046">w</span><span class="op" id="4147047">}</span><span class="op" id="4147048">,</span>&nbsp;<span class="ident" id="4147050">r</span><span class="op" id="4147051">)</span><br>
<span class="lineno">405</span><span class="op" id="4147053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4147056">//&nbsp;Limit&nbsp;the&nbsp;number&nbsp;of&nbsp;concurrent&nbsp;cgo-using&nbsp;goroutines,&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="4147120">//&nbsp;each&nbsp;will&nbsp;block&nbsp;an&nbsp;entire&nbsp;operating&nbsp;system&nbsp;thread.&nbsp;The&nbsp;usual&nbsp;culprit</span><br>
<span class="lineno"></span><span class="comment" id="4147192">//&nbsp;is&nbsp;resolving&nbsp;many&nbsp;DNS&nbsp;names&nbsp;in&nbsp;separate&nbsp;goroutines&nbsp;but&nbsp;the&nbsp;DNS</span><br>
<span class="lineno">410</span><span class="comment" id="4147258">//&nbsp;server&nbsp;is&nbsp;not&nbsp;responding.&nbsp;Then&nbsp;the&nbsp;many&nbsp;lookups&nbsp;each&nbsp;use&nbsp;a&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="4147330">//&nbsp;thread,&nbsp;and&nbsp;the&nbsp;system&nbsp;or&nbsp;the&nbsp;program&nbsp;runs&nbsp;out&nbsp;of&nbsp;threads.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4147393">var</span>&nbsp;<span class="ident" id="4147397">threadLimit</span>&nbsp;<span class="op" id="4147409">=</span>&nbsp;<span class="builtinfunc" id="4147411">make</span><span class="op" id="4147415">(</span><span class="keyword" id="4147416">chan</span>&nbsp;<span class="keyword" id="4147421">struct</span><span class="op" id="4147427">{</span><span class="op" id="4147428">}</span><span class="op" id="4147429">,</span>&nbsp;<span class="num" id="4147431">500</span><span class="op" id="4147434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">415</span><span class="comment" id="4147437">//&nbsp;Using&nbsp;send&nbsp;for&nbsp;acquire&nbsp;is&nbsp;fine&nbsp;here&nbsp;because&nbsp;we&nbsp;are&nbsp;not&nbsp;using&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="4147506">//&nbsp;to&nbsp;protect&nbsp;any&nbsp;memory.&nbsp;All&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;goroutines</span><br>
<span class="lineno"></span><span class="comment" id="4147578">//&nbsp;making&nbsp;calls&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4147606">func</span>&nbsp;<span class="ident" id="4147611">acquireThread</span><span class="op" id="4147624">(</span><span class="op" id="4147625">)</span>&nbsp;<span class="op" id="4147627">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147630">threadLimit</span>&nbsp;<span class="op" id="4147642">&lt;-</span>&nbsp;<span class="keyword" id="4147645">struct</span><span class="op" id="4147651">{</span><span class="op" id="4147652">}</span><span class="op" id="4147653">{</span><span class="op" id="4147654">}</span><br>
<span class="lineno"></span><span class="op" id="4147656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4147659">func</span>&nbsp;<span class="ident" id="4147664">releaseThread</span><span class="op" id="4147677">(</span><span class="op" id="4147678">)</span>&nbsp;<span class="op" id="4147680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147683">&lt;-</span><span class="ident" id="4147685">threadLimit</span><br>
<span class="lineno">425</span><span class="op" id="4147697">}</span>
</div>
</body>
</html>
