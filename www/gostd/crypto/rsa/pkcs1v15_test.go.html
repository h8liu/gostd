<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html" class="current">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7311065">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7311120">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7311174">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7311225">package</span>&nbsp;<span class="ident" id="7311233">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7311238">import</span>&nbsp;<span class="op" id="7311245">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311248">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311257">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311267">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311282">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311297">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311316">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311332">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311338">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311350">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311361">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="7311377">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7311380">func</span>&nbsp;<span class="ident" id="7311385">decodeBase64</span><span class="op" id="7311397">(</span><span class="ident" id="7311398">in</span>&nbsp;<span class="builtintype" id="7311401">string</span><span class="op" id="7311407">)</span>&nbsp;<span class="op" id="7311409">[</span><span class="op" id="7311410">]</span><span class="builtintype" id="7311411">byte</span>&nbsp;<span class="op" id="7311416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7311419">out</span>&nbsp;<span class="op" id="7311423">:=</span>&nbsp;<span class="builtinfunc" id="7311426">make</span><span class="op" id="7311430">(</span><span class="op" id="7311431">[</span><span class="op" id="7311432">]</span><span class="builtintype" id="7311433">byte</span><span class="op" id="7311437">,</span>&nbsp;<span class="ident" id="7311439">base64</span><span class="op" id="7311445">.</span><span class="ident" id="7311446">StdEncoding</span><span class="op" id="7311457">.</span><span class="ident" id="7311458">DecodedLen</span><span class="op" id="7311468">(</span><span class="builtinfunc" id="7311469">len</span><span class="op" id="7311472">(</span><span class="ident" id="7311473">in</span><span class="op" id="7311475">)</span><span class="op" id="7311476">)</span><span class="op" id="7311477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7311480">n</span><span class="op" id="7311481">,</span>&nbsp;<span class="ident" id="7311483">err</span>&nbsp;<span class="op" id="7311487">:=</span>&nbsp;<span class="ident" id="7311490">base64</span><span class="op" id="7311496">.</span><span class="ident" id="7311497">StdEncoding</span><span class="op" id="7311508">.</span><span class="ident" id="7311509">Decode</span><span class="op" id="7311515">(</span><span class="ident" id="7311516">out</span><span class="op" id="7311519">,</span>&nbsp;<span class="op" id="7311521">[</span><span class="op" id="7311522">]</span><span class="builtintype" id="7311523">byte</span><span class="op" id="7311527">(</span><span class="ident" id="7311528">in</span><span class="op" id="7311530">)</span><span class="op" id="7311531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7311534">if</span>&nbsp;<span class="ident" id="7311537">err</span>&nbsp;<span class="op" id="7311541">!=</span>&nbsp;<span class="ident" id="7311544">nil</span>&nbsp;<span class="op" id="7311548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7311552">return</span>&nbsp;<span class="ident" id="7311559">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7311564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7311567">return</span>&nbsp;<span class="ident" id="7311574">out</span><span class="op" id="7311577">[</span><span class="num" id="7311578">0</span><span class="op" id="7311579">:</span><span class="ident" id="7311580">n</span><span class="op" id="7311581">]</span><br>
<span class="lineno"></span><span class="op" id="7311583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7311586">type</span>&nbsp;<span class="ident" id="7311591">DecryptPKCS1v15Test</span>&nbsp;<span class="keyword" id="7311611">struct</span>&nbsp;<span class="op" id="7311618">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7311621">in</span><span class="op" id="7311623">,</span>&nbsp;<span class="ident" id="7311625">out</span>&nbsp;<span class="builtintype" id="7311629">string</span><br>
<span class="lineno"></span><span class="op" id="7311636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7311639">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="7311713">var</span>&nbsp;<span class="ident" id="7311717">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="7311738">=</span>&nbsp;<span class="op" id="7311740">[</span><span class="op" id="7311741">]</span><span class="ident" id="7311742">DecryptPKCS1v15Test</span><span class="op" id="7311761">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7311764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311768">&#34;gIcUIoVkD6ATMBk/u/nlCZCCWRKdkfjCgFdo35VpRXLduiKXhNz1XupLLzTXAybEq15juc+EgY5o0DHv/nt3yg==&#34;</span><span class="op" id="7311858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311862">&#34;x&#34;</span><span class="op" id="7311865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7311868">}</span><span class="op" id="7311869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7311872">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311876">&#34;Y7TOCSqofGhkRb+jaVRLzK8xw2cSo1IVES19utzv6hwvx+M8kFsoWQm5DzBeJCZTCVDPkTpavUuEbgp8hnUGDw==&#34;</span><span class="op" id="7311966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311970">&#34;testing.&#34;</span><span class="op" id="7311980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7311983">}</span><span class="op" id="7311984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7311987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7311991">&#34;arReP9DJtEVyV2Dg3dDp4c/PSk1O6lxkoJ8HcFupoRorBZG+7+1fDAwT1olNddFnQMjmkb8vxwmNMoTAT/BFjQ==&#34;</span><span class="op" id="7312081">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7312085">&#34;testing.\n&#34;</span><span class="op" id="7312097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312100">}</span><span class="op" id="7312101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7312108">&#34;WtaBXIoGC54+vH0NH0CHHE+dRDOsMc/6BrfFu2lEqcKL9+uDuWaf+Xj9mrbQCjjZcpQuX733zyok/jsnqe/Ftw==&#34;</span><span class="op" id="7312198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7312202">&#34;01234567890123456789012345678901234567890123456789012&#34;</span><span class="op" id="7312257">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312260">}</span><span class="op" id="7312261">,</span><br>
<span class="lineno"></span><span class="op" id="7312263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7312266">func</span>&nbsp;<span class="ident" id="7312271">TestDecryptPKCS1v15</span><span class="op" id="7312290">(</span><span class="ident" id="7312291">t</span>&nbsp;<span class="op" id="7312293">*</span><span class="ident" id="7312294">testing</span><span class="op" id="7312301">.</span><span class="ident" id="7312302">T</span><span class="op" id="7312303">)</span>&nbsp;<span class="op" id="7312305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312308">for</span>&nbsp;<span class="ident" id="7312312">i</span><span class="op" id="7312313">,</span>&nbsp;<span class="ident" id="7312315">test</span>&nbsp;<span class="op" id="7312320">:=</span>&nbsp;<span class="keyword" id="7312323">range</span>&nbsp;<span class="ident" id="7312329">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="7312350">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312354">out</span><span class="op" id="7312357">,</span>&nbsp;<span class="ident" id="7312359">err</span>&nbsp;<span class="op" id="7312363">:=</span>&nbsp;<span class="ident" id="7312366">DecryptPKCS1v15</span><span class="op" id="7312381">(</span><span class="ident" id="7312382">nil</span><span class="op" id="7312385">,</span>&nbsp;<span class="ident" id="7312387">rsaPrivateKey</span><span class="op" id="7312400">,</span>&nbsp;<span class="ident" id="7312402">decodeBase64</span><span class="op" id="7312414">(</span><span class="ident" id="7312415">test</span><span class="op" id="7312419">.</span><span class="ident" id="7312420">in</span><span class="op" id="7312422">)</span><span class="op" id="7312423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312427">if</span>&nbsp;<span class="ident" id="7312430">err</span>&nbsp;<span class="op" id="7312434">!=</span>&nbsp;<span class="ident" id="7312437">nil</span>&nbsp;<span class="op" id="7312441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312446">t</span><span class="op" id="7312447">.</span><span class="ident" id="7312448">Errorf</span><span class="op" id="7312454">(</span><span class="string" id="7312455">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="7312477">,</span>&nbsp;<span class="ident" id="7312479">i</span><span class="op" id="7312480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312488">want</span>&nbsp;<span class="op" id="7312493">:=</span>&nbsp;<span class="op" id="7312496">[</span><span class="op" id="7312497">]</span><span class="builtintype" id="7312498">byte</span><span class="op" id="7312502">(</span><span class="ident" id="7312503">test</span><span class="op" id="7312507">.</span><span class="ident" id="7312508">out</span><span class="op" id="7312511">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312515">if</span>&nbsp;<span class="op" id="7312518">!</span><span class="ident" id="7312519">bytes</span><span class="op" id="7312524">.</span><span class="ident" id="7312525">Equal</span><span class="op" id="7312530">(</span><span class="ident" id="7312531">out</span><span class="op" id="7312534">,</span>&nbsp;<span class="ident" id="7312536">want</span><span class="op" id="7312540">)</span>&nbsp;<span class="op" id="7312542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312547">t</span><span class="op" id="7312548">.</span><span class="ident" id="7312549">Errorf</span><span class="op" id="7312555">(</span><span class="string" id="7312556">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7312578">,</span>&nbsp;<span class="ident" id="7312580">i</span><span class="op" id="7312581">,</span>&nbsp;<span class="ident" id="7312583">out</span><span class="op" id="7312586">,</span>&nbsp;<span class="ident" id="7312588">want</span><span class="op" id="7312592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312599">}</span><br>
<span class="lineno"></span><span class="op" id="7312601">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="7312604">func</span>&nbsp;<span class="ident" id="7312609">TestEncryptPKCS1v15</span><span class="op" id="7312628">(</span><span class="ident" id="7312629">t</span>&nbsp;<span class="op" id="7312631">*</span><span class="ident" id="7312632">testing</span><span class="op" id="7312639">.</span><span class="ident" id="7312640">T</span><span class="op" id="7312641">)</span>&nbsp;<span class="op" id="7312643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312646">random</span>&nbsp;<span class="op" id="7312653">:=</span>&nbsp;<span class="ident" id="7312656">rand</span><span class="op" id="7312660">.</span><span class="ident" id="7312661">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312669">k</span>&nbsp;<span class="op" id="7312671">:=</span>&nbsp;<span class="op" id="7312674">(</span><span class="ident" id="7312675">rsaPrivateKey</span><span class="op" id="7312688">.</span><span class="ident" id="7312689">N</span><span class="op" id="7312690">.</span><span class="ident" id="7312691">BitLen</span><span class="op" id="7312697">(</span><span class="op" id="7312698">)</span>&nbsp;<span class="op" id="7312700">+</span>&nbsp;<span class="num" id="7312702">7</span><span class="op" id="7312703">)</span>&nbsp;<span class="op" id="7312705">/</span>&nbsp;<span class="num" id="7312707">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312711">tryEncryptDecrypt</span>&nbsp;<span class="op" id="7312729">:=</span>&nbsp;<span class="keyword" id="7312732">func</span><span class="op" id="7312736">(</span><span class="ident" id="7312737">in</span>&nbsp;<span class="op" id="7312740">[</span><span class="op" id="7312741">]</span><span class="builtintype" id="7312742">byte</span><span class="op" id="7312746">,</span>&nbsp;<span class="ident" id="7312748">blind</span>&nbsp;<span class="builtintype" id="7312754">bool</span><span class="op" id="7312758">)</span>&nbsp;<span class="builtintype" id="7312760">bool</span>&nbsp;<span class="op" id="7312765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312769">if</span>&nbsp;<span class="builtinfunc" id="7312772">len</span><span class="op" id="7312775">(</span><span class="ident" id="7312776">in</span><span class="op" id="7312778">)</span>&nbsp;<span class="op" id="7312780">&gt;</span>&nbsp;<span class="ident" id="7312782">k</span><span class="op" id="7312783">-</span><span class="num" id="7312784">11</span>&nbsp;<span class="op" id="7312787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312792">in</span>&nbsp;<span class="op" id="7312795">=</span>&nbsp;<span class="ident" id="7312797">in</span><span class="op" id="7312799">[</span><span class="num" id="7312800">0</span>&nbsp;<span class="op" id="7312802">:</span>&nbsp;<span class="ident" id="7312804">k</span><span class="op" id="7312805">-</span><span class="num" id="7312806">11</span><span class="op" id="7312808">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312817">ciphertext</span><span class="op" id="7312827">,</span>&nbsp;<span class="ident" id="7312829">err</span>&nbsp;<span class="op" id="7312833">:=</span>&nbsp;<span class="ident" id="7312836">EncryptPKCS1v15</span><span class="op" id="7312851">(</span><span class="ident" id="7312852">random</span><span class="op" id="7312858">,</span>&nbsp;<span class="op" id="7312860">&amp;</span><span class="ident" id="7312861">rsaPrivateKey</span><span class="op" id="7312874">.</span><span class="ident" id="7312875">PublicKey</span><span class="op" id="7312884">,</span>&nbsp;<span class="ident" id="7312886">in</span><span class="op" id="7312888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312892">if</span>&nbsp;<span class="ident" id="7312895">err</span>&nbsp;<span class="op" id="7312899">!=</span>&nbsp;<span class="ident" id="7312902">nil</span>&nbsp;<span class="op" id="7312906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7312911">t</span><span class="op" id="7312912">.</span><span class="ident" id="7312913">Errorf</span><span class="op" id="7312919">(</span><span class="string" id="7312920">&#34;error&nbsp;encrypting:&nbsp;%s&#34;</span><span class="op" id="7312942">,</span>&nbsp;<span class="ident" id="7312944">err</span><span class="op" id="7312947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312952">return</span>&nbsp;<span class="builtintype" id="7312959">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7312967">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312972">var</span>&nbsp;<span class="ident" id="7312976">rand</span>&nbsp;<span class="ident" id="7312981">io</span><span class="op" id="7312983">.</span><span class="ident" id="7312984">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7312993">if</span>&nbsp;<span class="op" id="7312996">!</span><span class="ident" id="7312997">blind</span>&nbsp;<span class="op" id="7313003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313008">rand</span>&nbsp;<span class="op" id="7313013">=</span>&nbsp;<span class="ident" id="7313015">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313021">}</span>&nbsp;<span class="keyword" id="7313023">else</span>&nbsp;<span class="op" id="7313028">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313033">rand</span>&nbsp;<span class="op" id="7313038">=</span>&nbsp;<span class="ident" id="7313040">random</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313053">plaintext</span><span class="op" id="7313062">,</span>&nbsp;<span class="ident" id="7313064">err</span>&nbsp;<span class="op" id="7313068">:=</span>&nbsp;<span class="ident" id="7313071">DecryptPKCS1v15</span><span class="op" id="7313086">(</span><span class="ident" id="7313087">rand</span><span class="op" id="7313091">,</span>&nbsp;<span class="ident" id="7313093">rsaPrivateKey</span><span class="op" id="7313106">,</span>&nbsp;<span class="ident" id="7313108">ciphertext</span><span class="op" id="7313118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313122">if</span>&nbsp;<span class="ident" id="7313125">err</span>&nbsp;<span class="op" id="7313129">!=</span>&nbsp;<span class="ident" id="7313132">nil</span>&nbsp;<span class="op" id="7313136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313141">t</span><span class="op" id="7313142">.</span><span class="ident" id="7313143">Errorf</span><span class="op" id="7313149">(</span><span class="string" id="7313150">&#34;error&nbsp;decrypting:&nbsp;%s&#34;</span><span class="op" id="7313172">,</span>&nbsp;<span class="ident" id="7313174">err</span><span class="op" id="7313177">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313182">return</span>&nbsp;<span class="builtintype" id="7313189">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313202">if</span>&nbsp;<span class="op" id="7313205">!</span><span class="ident" id="7313206">bytes</span><span class="op" id="7313211">.</span><span class="ident" id="7313212">Equal</span><span class="op" id="7313217">(</span><span class="ident" id="7313218">plaintext</span><span class="op" id="7313227">,</span>&nbsp;<span class="ident" id="7313229">in</span><span class="op" id="7313231">)</span>&nbsp;<span class="op" id="7313233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313238">t</span><span class="op" id="7313239">.</span><span class="ident" id="7313240">Errorf</span><span class="op" id="7313246">(</span><span class="string" id="7313247">&#34;output&nbsp;mismatch:&nbsp;%#v&nbsp;%#v&#34;</span><span class="op" id="7313273">,</span>&nbsp;<span class="ident" id="7313275">plaintext</span><span class="op" id="7313284">,</span>&nbsp;<span class="ident" id="7313286">in</span><span class="op" id="7313288">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313293">return</span>&nbsp;<span class="builtintype" id="7313300">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313312">return</span>&nbsp;<span class="builtintype" id="7313319">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313329">config</span>&nbsp;<span class="op" id="7313336">:=</span>&nbsp;<span class="builtinfunc" id="7313339">new</span><span class="op" id="7313342">(</span><span class="ident" id="7313343">quick</span><span class="op" id="7313348">.</span><span class="ident" id="7313349">Config</span><span class="op" id="7313355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7313358">if</span>&nbsp;<span class="ident" id="7313361">testing</span><span class="op" id="7313368">.</span><span class="ident" id="7313369">Short</span><span class="op" id="7313374">(</span><span class="op" id="7313375">)</span>&nbsp;<span class="op" id="7313377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313381">config</span><span class="op" id="7313387">.</span><span class="ident" id="7313388">MaxCount</span>&nbsp;<span class="op" id="7313397">=</span>&nbsp;<span class="num" id="7313399">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7313406">quick</span><span class="op" id="7313411">.</span><span class="ident" id="7313412">Check</span><span class="op" id="7313417">(</span><span class="ident" id="7313418">tryEncryptDecrypt</span><span class="op" id="7313435">,</span>&nbsp;<span class="ident" id="7313437">config</span><span class="op" id="7313443">)</span><br>
<span class="lineno">105</span><span class="op" id="7313445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7313448">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="7313522">var</span>&nbsp;<span class="ident" id="7313526">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="7313557">=</span>&nbsp;<span class="op" id="7313559">[</span><span class="op" id="7313560">]</span><span class="ident" id="7313561">DecryptPKCS1v15Test</span><span class="op" id="7313580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313583">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7313587">&#34;e6ukkae6Gykq0fKzYwULpZehX+UPXYzMoB5mHQUDEiclRbOTqas4Y0E6nwns1BBpdvEJcilhl5zsox/6DtGsYg==&#34;</span><span class="op" id="7313677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7313681">&#34;1234&#34;</span><span class="op" id="7313687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313690">}</span><span class="op" id="7313691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7313698">&#34;Dtis4uk/q/LQGGqGk97P59K03hkCIVFMEFZRgVWOAAhxgYpCRG0MX2adptt92l67IqMki6iVQyyt0TtX3IdtEw==&#34;</span><span class="op" id="7313788">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7313792">&#34;FAIL&#34;</span><span class="op" id="7313798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313801">}</span><span class="op" id="7313802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7313809">&#34;LIyFyCYCptPxrvTxpol8F3M7ZivlMsf53zs0vHRAv+rDIh2YsHS69ePMoPMe3TkOMZ3NupiL3takPxIs1sK+dw==&#34;</span><span class="op" id="7313899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7313903">&#34;abcd&#34;</span><span class="op" id="7313909">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313912">}</span><span class="op" id="7313913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7313916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7313920">&#34;bafnobel46bKy76JzqU/RIVOH0uAYvzUtauKmIidKgM0sMlvobYVAVQPeUQ/oTGjbIZ1v/6Gyi5AO4DtHruGdw==&#34;</span><span class="op" id="7314010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7314014">&#34;FAIL&#34;</span><span class="op" id="7314020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314023">}</span><span class="op" id="7314024">,</span><br>
<span class="lineno">125</span><span class="op" id="7314026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7314029">func</span>&nbsp;<span class="ident" id="7314034">TestEncryptPKCS1v15SessionKey</span><span class="op" id="7314063">(</span><span class="ident" id="7314064">t</span>&nbsp;<span class="op" id="7314066">*</span><span class="ident" id="7314067">testing</span><span class="op" id="7314074">.</span><span class="ident" id="7314075">T</span><span class="op" id="7314076">)</span>&nbsp;<span class="op" id="7314078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7314081">for</span>&nbsp;<span class="ident" id="7314085">i</span><span class="op" id="7314086">,</span>&nbsp;<span class="ident" id="7314088">test</span>&nbsp;<span class="op" id="7314093">:=</span>&nbsp;<span class="keyword" id="7314096">range</span>&nbsp;<span class="ident" id="7314102">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="7314133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314137">key</span>&nbsp;<span class="op" id="7314141">:=</span>&nbsp;<span class="op" id="7314144">[</span><span class="op" id="7314145">]</span><span class="builtintype" id="7314146">byte</span><span class="op" id="7314150">(</span><span class="string" id="7314151">&#34;FAIL&#34;</span><span class="op" id="7314157">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314161">err</span>&nbsp;<span class="op" id="7314165">:=</span>&nbsp;<span class="ident" id="7314168">DecryptPKCS1v15SessionKey</span><span class="op" id="7314193">(</span><span class="ident" id="7314194">nil</span><span class="op" id="7314197">,</span>&nbsp;<span class="ident" id="7314199">rsaPrivateKey</span><span class="op" id="7314212">,</span>&nbsp;<span class="ident" id="7314214">decodeBase64</span><span class="op" id="7314226">(</span><span class="ident" id="7314227">test</span><span class="op" id="7314231">.</span><span class="ident" id="7314232">in</span><span class="op" id="7314234">)</span><span class="op" id="7314235">,</span>&nbsp;<span class="ident" id="7314237">key</span><span class="op" id="7314240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7314244">if</span>&nbsp;<span class="ident" id="7314247">err</span>&nbsp;<span class="op" id="7314251">!=</span>&nbsp;<span class="ident" id="7314254">nil</span>&nbsp;<span class="op" id="7314258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314263">t</span><span class="op" id="7314264">.</span><span class="ident" id="7314265">Errorf</span><span class="op" id="7314271">(</span><span class="string" id="7314272">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="7314294">,</span>&nbsp;<span class="ident" id="7314296">i</span><span class="op" id="7314297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314305">want</span>&nbsp;<span class="op" id="7314310">:=</span>&nbsp;<span class="op" id="7314313">[</span><span class="op" id="7314314">]</span><span class="builtintype" id="7314315">byte</span><span class="op" id="7314319">(</span><span class="ident" id="7314320">test</span><span class="op" id="7314324">.</span><span class="ident" id="7314325">out</span><span class="op" id="7314328">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7314332">if</span>&nbsp;<span class="op" id="7314335">!</span><span class="ident" id="7314336">bytes</span><span class="op" id="7314341">.</span><span class="ident" id="7314342">Equal</span><span class="op" id="7314347">(</span><span class="ident" id="7314348">key</span><span class="op" id="7314351">,</span>&nbsp;<span class="ident" id="7314353">want</span><span class="op" id="7314357">)</span>&nbsp;<span class="op" id="7314359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314364">t</span><span class="op" id="7314365">.</span><span class="ident" id="7314366">Errorf</span><span class="op" id="7314372">(</span><span class="string" id="7314373">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7314395">,</span>&nbsp;<span class="ident" id="7314397">i</span><span class="op" id="7314398">,</span>&nbsp;<span class="ident" id="7314400">key</span><span class="op" id="7314403">,</span>&nbsp;<span class="ident" id="7314405">want</span><span class="op" id="7314409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314416">}</span><br>
<span class="lineno"></span><span class="op" id="7314418">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7314421">func</span>&nbsp;<span class="ident" id="7314426">TestNonZeroRandomBytes</span><span class="op" id="7314448">(</span><span class="ident" id="7314449">t</span>&nbsp;<span class="op" id="7314451">*</span><span class="ident" id="7314452">testing</span><span class="op" id="7314459">.</span><span class="ident" id="7314460">T</span><span class="op" id="7314461">)</span>&nbsp;<span class="op" id="7314463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314466">random</span>&nbsp;<span class="op" id="7314473">:=</span>&nbsp;<span class="ident" id="7314476">rand</span><span class="op" id="7314480">.</span><span class="ident" id="7314481">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314490">b</span>&nbsp;<span class="op" id="7314492">:=</span>&nbsp;<span class="builtinfunc" id="7314495">make</span><span class="op" id="7314499">(</span><span class="op" id="7314500">[</span><span class="op" id="7314501">]</span><span class="builtintype" id="7314502">byte</span><span class="op" id="7314506">,</span>&nbsp;<span class="num" id="7314508">512</span><span class="op" id="7314511">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314514">err</span>&nbsp;<span class="op" id="7314518">:=</span>&nbsp;<span class="ident" id="7314521">nonZeroRandomBytes</span><span class="op" id="7314539">(</span><span class="ident" id="7314540">b</span><span class="op" id="7314541">,</span>&nbsp;<span class="ident" id="7314543">random</span><span class="op" id="7314549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7314552">if</span>&nbsp;<span class="ident" id="7314555">err</span>&nbsp;<span class="op" id="7314559">!=</span>&nbsp;<span class="ident" id="7314562">nil</span>&nbsp;<span class="op" id="7314566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314570">t</span><span class="op" id="7314571">.</span><span class="ident" id="7314572">Errorf</span><span class="op" id="7314578">(</span><span class="string" id="7314579">&#34;returned&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7314599">,</span>&nbsp;<span class="ident" id="7314601">err</span><span class="op" id="7314604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7314610">for</span>&nbsp;<span class="ident" id="7314614">_</span><span class="op" id="7314615">,</span>&nbsp;<span class="ident" id="7314617">b</span>&nbsp;<span class="op" id="7314619">:=</span>&nbsp;<span class="keyword" id="7314622">range</span>&nbsp;<span class="ident" id="7314628">b</span>&nbsp;<span class="op" id="7314630">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7314634">if</span>&nbsp;<span class="ident" id="7314637">b</span>&nbsp;<span class="op" id="7314639">==</span>&nbsp;<span class="num" id="7314642">0</span>&nbsp;<span class="op" id="7314644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314649">t</span><span class="op" id="7314650">.</span><span class="ident" id="7314651">Errorf</span><span class="op" id="7314657">(</span><span class="string" id="7314658">&#34;Zero&nbsp;octet&nbsp;found&#34;</span><span class="op" id="7314676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7314681">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314693">}</span><br>
<span class="lineno">155</span><span class="op" id="7314695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7314698">type</span>&nbsp;<span class="ident" id="7314703">signPKCS1v15Test</span>&nbsp;<span class="keyword" id="7314720">struct</span>&nbsp;<span class="op" id="7314727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7314730">in</span><span class="op" id="7314732">,</span>&nbsp;<span class="ident" id="7314734">out</span>&nbsp;<span class="builtintype" id="7314738">string</span><br>
<span class="lineno"></span><span class="op" id="7314745">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="7314748">//&nbsp;These&nbsp;vectors&nbsp;have&nbsp;been&nbsp;tested&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="7314787">//&nbsp;&nbsp;&nbsp;`openssl&nbsp;rsautl&nbsp;-verify&nbsp;-inkey&nbsp;pk&nbsp;-in&nbsp;signature&nbsp;|&nbsp;hexdump&nbsp;-C`</span><br>
<span class="lineno"></span><span class="keyword" id="7314854">var</span>&nbsp;<span class="ident" id="7314858">signPKCS1v15Tests</span>&nbsp;<span class="op" id="7314876">=</span>&nbsp;<span class="op" id="7314878">[</span><span class="op" id="7314879">]</span><span class="ident" id="7314880">signPKCS1v15Test</span><span class="op" id="7314896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7314899">{</span><span class="string" id="7314900">&#34;Test.\n&#34;</span><span class="op" id="7314909">,</span>&nbsp;<span class="string" id="7314911">&#34;a4f3fa6ea93bcdd0c57be020c1193ecbfd6f200a3d95c409769b029578fa0e336ad9a347600e40d3ae823b8c7e6bad88cc07c1d54c3a1523cbbb6d58efc362ae&#34;</span><span class="op" id="7315041">}</span><span class="op" id="7315042">,</span><br>
<span class="lineno">165</span><span class="op" id="7315044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7315047">func</span>&nbsp;<span class="ident" id="7315052">TestSignPKCS1v15</span><span class="op" id="7315068">(</span><span class="ident" id="7315069">t</span>&nbsp;<span class="op" id="7315071">*</span><span class="ident" id="7315072">testing</span><span class="op" id="7315079">.</span><span class="ident" id="7315080">T</span><span class="op" id="7315081">)</span>&nbsp;<span class="op" id="7315083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315086">for</span>&nbsp;<span class="ident" id="7315090">i</span><span class="op" id="7315091">,</span>&nbsp;<span class="ident" id="7315093">test</span>&nbsp;<span class="op" id="7315098">:=</span>&nbsp;<span class="keyword" id="7315101">range</span>&nbsp;<span class="ident" id="7315107">signPKCS1v15Tests</span>&nbsp;<span class="op" id="7315125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315129">h</span>&nbsp;<span class="op" id="7315131">:=</span>&nbsp;<span class="ident" id="7315134">sha1</span><span class="op" id="7315138">.</span><span class="ident" id="7315139">New</span><span class="op" id="7315142">(</span><span class="op" id="7315143">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315147">h</span><span class="op" id="7315148">.</span><span class="ident" id="7315149">Write</span><span class="op" id="7315154">(</span><span class="op" id="7315155">[</span><span class="op" id="7315156">]</span><span class="builtintype" id="7315157">byte</span><span class="op" id="7315161">(</span><span class="ident" id="7315162">test</span><span class="op" id="7315166">.</span><span class="ident" id="7315167">in</span><span class="op" id="7315169">)</span><span class="op" id="7315170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315174">digest</span>&nbsp;<span class="op" id="7315181">:=</span>&nbsp;<span class="ident" id="7315184">h</span><span class="op" id="7315185">.</span><span class="ident" id="7315186">Sum</span><span class="op" id="7315189">(</span><span class="ident" id="7315190">nil</span><span class="op" id="7315193">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315198">s</span><span class="op" id="7315199">,</span>&nbsp;<span class="ident" id="7315201">err</span>&nbsp;<span class="op" id="7315205">:=</span>&nbsp;<span class="ident" id="7315208">SignPKCS1v15</span><span class="op" id="7315220">(</span><span class="ident" id="7315221">nil</span><span class="op" id="7315224">,</span>&nbsp;<span class="ident" id="7315226">rsaPrivateKey</span><span class="op" id="7315239">,</span>&nbsp;<span class="ident" id="7315241">crypto</span><span class="op" id="7315247">.</span><span class="ident" id="7315248">SHA1</span><span class="op" id="7315252">,</span>&nbsp;<span class="ident" id="7315254">digest</span><span class="op" id="7315260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315264">if</span>&nbsp;<span class="ident" id="7315267">err</span>&nbsp;<span class="op" id="7315271">!=</span>&nbsp;<span class="ident" id="7315274">nil</span>&nbsp;<span class="op" id="7315278">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315283">t</span><span class="op" id="7315284">.</span><span class="ident" id="7315285">Errorf</span><span class="op" id="7315291">(</span><span class="string" id="7315292">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="7315300">,</span>&nbsp;<span class="ident" id="7315302">i</span><span class="op" id="7315303">,</span>&nbsp;<span class="ident" id="7315305">err</span><span class="op" id="7315308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7315312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315317">expected</span><span class="op" id="7315325">,</span>&nbsp;<span class="ident" id="7315327">_</span>&nbsp;<span class="op" id="7315329">:=</span>&nbsp;<span class="ident" id="7315332">hex</span><span class="op" id="7315335">.</span><span class="ident" id="7315336">DecodeString</span><span class="op" id="7315348">(</span><span class="ident" id="7315349">test</span><span class="op" id="7315353">.</span><span class="ident" id="7315354">out</span><span class="op" id="7315357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315361">if</span>&nbsp;<span class="op" id="7315364">!</span><span class="ident" id="7315365">bytes</span><span class="op" id="7315370">.</span><span class="ident" id="7315371">Equal</span><span class="op" id="7315376">(</span><span class="ident" id="7315377">s</span><span class="op" id="7315378">,</span>&nbsp;<span class="ident" id="7315380">expected</span><span class="op" id="7315388">)</span>&nbsp;<span class="op" id="7315390">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315395">t</span><span class="op" id="7315396">.</span><span class="ident" id="7315397">Errorf</span><span class="op" id="7315403">(</span><span class="string" id="7315404">&#34;#%d&nbsp;got:&nbsp;%x&nbsp;want:&nbsp;%x&#34;</span><span class="op" id="7315426">,</span>&nbsp;<span class="ident" id="7315428">i</span><span class="op" id="7315429">,</span>&nbsp;<span class="ident" id="7315431">s</span><span class="op" id="7315432">,</span>&nbsp;<span class="ident" id="7315434">expected</span><span class="op" id="7315442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7315446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7315449">}</span><br>
<span class="lineno"></span><span class="op" id="7315451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="7315454">func</span>&nbsp;<span class="ident" id="7315459">TestVerifyPKCS1v15</span><span class="op" id="7315477">(</span><span class="ident" id="7315478">t</span>&nbsp;<span class="op" id="7315480">*</span><span class="ident" id="7315481">testing</span><span class="op" id="7315488">.</span><span class="ident" id="7315489">T</span><span class="op" id="7315490">)</span>&nbsp;<span class="op" id="7315492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315495">for</span>&nbsp;<span class="ident" id="7315499">i</span><span class="op" id="7315500">,</span>&nbsp;<span class="ident" id="7315502">test</span>&nbsp;<span class="op" id="7315507">:=</span>&nbsp;<span class="keyword" id="7315510">range</span>&nbsp;<span class="ident" id="7315516">signPKCS1v15Tests</span>&nbsp;<span class="op" id="7315534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315538">h</span>&nbsp;<span class="op" id="7315540">:=</span>&nbsp;<span class="ident" id="7315543">sha1</span><span class="op" id="7315547">.</span><span class="ident" id="7315548">New</span><span class="op" id="7315551">(</span><span class="op" id="7315552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315556">h</span><span class="op" id="7315557">.</span><span class="ident" id="7315558">Write</span><span class="op" id="7315563">(</span><span class="op" id="7315564">[</span><span class="op" id="7315565">]</span><span class="builtintype" id="7315566">byte</span><span class="op" id="7315570">(</span><span class="ident" id="7315571">test</span><span class="op" id="7315575">.</span><span class="ident" id="7315576">in</span><span class="op" id="7315578">)</span><span class="op" id="7315579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315583">digest</span>&nbsp;<span class="op" id="7315590">:=</span>&nbsp;<span class="ident" id="7315593">h</span><span class="op" id="7315594">.</span><span class="ident" id="7315595">Sum</span><span class="op" id="7315598">(</span><span class="ident" id="7315599">nil</span><span class="op" id="7315602">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315607">sig</span><span class="op" id="7315610">,</span>&nbsp;<span class="ident" id="7315612">_</span>&nbsp;<span class="op" id="7315614">:=</span>&nbsp;<span class="ident" id="7315617">hex</span><span class="op" id="7315620">.</span><span class="ident" id="7315621">DecodeString</span><span class="op" id="7315633">(</span><span class="ident" id="7315634">test</span><span class="op" id="7315638">.</span><span class="ident" id="7315639">out</span><span class="op" id="7315642">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315647">err</span>&nbsp;<span class="op" id="7315651">:=</span>&nbsp;<span class="ident" id="7315654">VerifyPKCS1v15</span><span class="op" id="7315668">(</span><span class="op" id="7315669">&amp;</span><span class="ident" id="7315670">rsaPrivateKey</span><span class="op" id="7315683">.</span><span class="ident" id="7315684">PublicKey</span><span class="op" id="7315693">,</span>&nbsp;<span class="ident" id="7315695">crypto</span><span class="op" id="7315701">.</span><span class="ident" id="7315702">SHA1</span><span class="op" id="7315706">,</span>&nbsp;<span class="ident" id="7315708">digest</span><span class="op" id="7315714">,</span>&nbsp;<span class="ident" id="7315716">sig</span><span class="op" id="7315719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7315723">if</span>&nbsp;<span class="ident" id="7315726">err</span>&nbsp;<span class="op" id="7315730">!=</span>&nbsp;<span class="ident" id="7315733">nil</span>&nbsp;<span class="op" id="7315737">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315742">t</span><span class="op" id="7315743">.</span><span class="ident" id="7315744">Errorf</span><span class="op" id="7315750">(</span><span class="string" id="7315751">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="7315759">,</span>&nbsp;<span class="ident" id="7315761">i</span><span class="op" id="7315762">,</span>&nbsp;<span class="ident" id="7315764">err</span><span class="op" id="7315767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7315771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7315774">}</span><br>
<span class="lineno"></span><span class="op" id="7315776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="7315779">func</span>&nbsp;<span class="ident" id="7315784">TestOverlongMessagePKCS1v15</span><span class="op" id="7315811">(</span><span class="ident" id="7315812">t</span>&nbsp;<span class="op" id="7315814">*</span><span class="ident" id="7315815">testing</span><span class="op" id="7315822">.</span><span class="ident" id="7315823">T</span><span class="op" id="7315824">)</span>&nbsp;<span class="op" id="7315826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315829">ciphertext</span>&nbsp;<span class="op" id="7315840">:=</span>&nbsp;<span class="ident" id="7315843">decodeBase64</span><span class="op" id="7315855">(</span><span class="string" id="7315856">&#34;fjOVdirUzFoLlukv80dBllMLjXythIf22feqPrNo0YoIjzyzyoMFiLjAc/Y4krkeZ11XFThIrEvw\nkRiZcCq5ng==&#34;</span><span class="op" id="7315948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7315951">_</span><span class="op" id="7315952">,</span>&nbsp;<span class="ident" id="7315954">err</span>&nbsp;<span class="op" id="7315958">:=</span>&nbsp;<span class="ident" id="7315961">DecryptPKCS1v15</span><span class="op" id="7315976">(</span><span class="ident" id="7315977">nil</span><span class="op" id="7315980">,</span>&nbsp;<span class="ident" id="7315982">rsaPrivateKey</span><span class="op" id="7315995">,</span>&nbsp;<span class="ident" id="7315997">ciphertext</span><span class="op" id="7316007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7316010">if</span>&nbsp;<span class="ident" id="7316013">err</span>&nbsp;<span class="op" id="7316017">==</span>&nbsp;<span class="ident" id="7316020">nil</span>&nbsp;<span class="op" id="7316024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7316028">t</span><span class="op" id="7316029">.</span><span class="ident" id="7316030">Error</span><span class="op" id="7316035">(</span><span class="string" id="7316036">&#34;RSA&nbsp;decrypted&nbsp;a&nbsp;message&nbsp;that&nbsp;was&nbsp;too&nbsp;long.&#34;</span><span class="op" id="7316080">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7316083">}</span><br>
<span class="lineno"></span><span class="op" id="7316085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7316088">func</span>&nbsp;<span class="ident" id="7316093">TestUnpaddedSignature</span><span class="op" id="7316114">(</span><span class="ident" id="7316115">t</span>&nbsp;<span class="op" id="7316117">*</span><span class="ident" id="7316118">testing</span><span class="op" id="7316125">.</span><span class="ident" id="7316126">T</span><span class="op" id="7316127">)</span>&nbsp;<span class="op" id="7316129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7316132">msg</span>&nbsp;<span class="op" id="7316136">:=</span>&nbsp;<span class="op" id="7316139">[</span><span class="op" id="7316140">]</span><span class="builtintype" id="7316141">byte</span><span class="op" id="7316145">(</span><span class="string" id="7316146">&#34;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013\n&#34;</span><span class="op" id="7316178">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7316181">//&nbsp;This&nbsp;base64&nbsp;value&nbsp;was&nbsp;generated&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7316223">//&nbsp;%&nbsp;echo&nbsp;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013&nbsp;&gt;&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7316274">//&nbsp;%&nbsp;openssl&nbsp;rsautl&nbsp;-sign&nbsp;-inkey&nbsp;key&nbsp;-out&nbsp;/tmp/sig&nbsp;-in&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7316339">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7316343">//&nbsp;Where&nbsp;&#34;key&#34;&nbsp;contains&nbsp;the&nbsp;RSA&nbsp;private&nbsp;key&nbsp;given&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;this</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7316416">//&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7316426">expectedSig</span>&nbsp;<span class="op" id="7316438">:=</span>&nbsp;<span class="ident" id="7316441">decodeBase64</span><span class="op" id="7316453">(</span><span class="string" id="7316454">&#34;pX4DR8azytjdQ1rtUiC040FjkepuQut5q2ZFX1pTjBrOVKNjgsCDyiJDGZTCNoh9qpXYbhl7iEym30BWWwuiZg==&#34;</span><span class="op" id="7316544">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7316548">sig</span><span class="op" id="7316551">,</span>&nbsp;<span class="ident" id="7316553">err</span>&nbsp;<span class="op" id="7316557">:=</span>&nbsp;<span class="ident" id="7316560">SignPKCS1v15</span><span class="op" id="7316572">(</span><span class="ident" id="7316573">nil</span><span class="op" id="7316576">,</span>&nbsp;<span class="ident" id="7316578">rsaPrivateKey</span><span class="op" id="7316591">,</span>&nbsp;<span class="ident" id="7316593">crypto</span><span class="op" id="7316599">.</span><span class="ident" id="7316600">Hash</span><span class="op" id="7316604">(</span><span class="num" id="7316605">0</span><span class="op" id="7316606">)</span><span class="op" id="7316607">,</span>&nbsp;<span class="ident" id="7316609">msg</span><span class="op" id="7316612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7316615">if</span>&nbsp;<span class="ident" id="7316618">err</span>&nbsp;<span class="op" id="7316622">!=</span>&nbsp;<span class="ident" id="7316625">nil</span>&nbsp;<span class="op" id="7316629">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7316633">t</span><span class="op" id="7316634">.</span><span class="ident" id="7316635">Fatalf</span><span class="op" id="7316641">(</span><span class="string" id="7316642">&#34;SignPKCS1v15&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7316667">,</span>&nbsp;<span class="ident" id="7316669">err</span><span class="op" id="7316672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7316675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7316678">if</span>&nbsp;<span class="op" id="7316681">!</span><span class="ident" id="7316682">bytes</span><span class="op" id="7316687">.</span><span class="ident" id="7316688">Equal</span><span class="op" id="7316693">(</span><span class="ident" id="7316694">sig</span><span class="op" id="7316697">,</span>&nbsp;<span class="ident" id="7316699">expectedSig</span><span class="op" id="7316710">)</span>&nbsp;<span class="op" id="7316712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7316716">t</span><span class="op" id="7316717">.</span><span class="ident" id="7316718">Fatalf</span><span class="op" id="7316724">(</span><span class="string" id="7316725">&#34;signature&nbsp;is&nbsp;not&nbsp;expected&nbsp;value:&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7316775">,</span>&nbsp;<span class="ident" id="7316777">sig</span><span class="op" id="7316780">,</span>&nbsp;<span class="ident" id="7316782">expectedSig</span><span class="op" id="7316793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7316796">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7316799">if</span>&nbsp;<span class="ident" id="7316802">err</span>&nbsp;<span class="op" id="7316806">:=</span>&nbsp;<span class="ident" id="7316809">VerifyPKCS1v15</span><span class="op" id="7316823">(</span><span class="op" id="7316824">&amp;</span><span class="ident" id="7316825">rsaPrivateKey</span><span class="op" id="7316838">.</span><span class="ident" id="7316839">PublicKey</span><span class="op" id="7316848">,</span>&nbsp;<span class="ident" id="7316850">crypto</span><span class="op" id="7316856">.</span><span class="ident" id="7316857">Hash</span><span class="op" id="7316861">(</span><span class="num" id="7316862">0</span><span class="op" id="7316863">)</span><span class="op" id="7316864">,</span>&nbsp;<span class="ident" id="7316866">msg</span><span class="op" id="7316869">,</span>&nbsp;<span class="ident" id="7316871">sig</span><span class="op" id="7316874">)</span><span class="op" id="7316875">;</span>&nbsp;<span class="ident" id="7316877">err</span>&nbsp;<span class="op" id="7316881">!=</span>&nbsp;<span class="ident" id="7316884">nil</span>&nbsp;<span class="op" id="7316888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7316892">t</span><span class="op" id="7316893">.</span><span class="ident" id="7316894">Fatalf</span><span class="op" id="7316900">(</span><span class="string" id="7316901">&#34;signature&nbsp;failed&nbsp;to&nbsp;verify:&nbsp;%s&#34;</span><span class="op" id="7316933">,</span>&nbsp;<span class="ident" id="7316935">err</span><span class="op" id="7316938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7316941">}</span><br>
<span class="lineno"></span><span class="op" id="7316943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="7316946">func</span>&nbsp;<span class="ident" id="7316951">TestShortSessionKey</span><span class="op" id="7316970">(</span><span class="ident" id="7316971">t</span>&nbsp;<span class="op" id="7316973">*</span><span class="ident" id="7316974">testing</span><span class="op" id="7316981">.</span><span class="ident" id="7316982">T</span><span class="op" id="7316983">)</span>&nbsp;<span class="op" id="7316985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7316988">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;attempting&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;session&nbsp;key&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7317054">//&nbsp;ciphertext&nbsp;is&nbsp;too&nbsp;small&nbsp;doesn&#39;t&nbsp;run&nbsp;outside&nbsp;the&nbsp;array&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7317120">ciphertext</span><span class="op" id="7317130">,</span>&nbsp;<span class="ident" id="7317132">err</span>&nbsp;<span class="op" id="7317136">:=</span>&nbsp;<span class="ident" id="7317139">EncryptPKCS1v15</span><span class="op" id="7317154">(</span><span class="ident" id="7317155">rand</span><span class="op" id="7317159">.</span><span class="ident" id="7317160">Reader</span><span class="op" id="7317166">,</span>&nbsp;<span class="op" id="7317168">&amp;</span><span class="ident" id="7317169">rsaPrivateKey</span><span class="op" id="7317182">.</span><span class="ident" id="7317183">PublicKey</span><span class="op" id="7317192">,</span>&nbsp;<span class="op" id="7317194">[</span><span class="op" id="7317195">]</span><span class="builtintype" id="7317196">byte</span><span class="op" id="7317200">{</span><span class="num" id="7317201">1</span><span class="op" id="7317202">}</span><span class="op" id="7317203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7317206">if</span>&nbsp;<span class="ident" id="7317209">err</span>&nbsp;<span class="op" id="7317213">!=</span>&nbsp;<span class="ident" id="7317216">nil</span>&nbsp;<span class="op" id="7317220">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7317224">t</span><span class="op" id="7317225">.</span><span class="ident" id="7317226">Fatalf</span><span class="op" id="7317232">(</span><span class="string" id="7317233">&#34;Failed&nbsp;to&nbsp;encrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="7317270">,</span>&nbsp;<span class="ident" id="7317272">err</span><span class="op" id="7317275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7317278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7317282">var</span>&nbsp;<span class="ident" id="7317286">key</span>&nbsp;<span class="op" id="7317290">[</span><span class="num" id="7317291">32</span><span class="op" id="7317293">]</span><span class="builtintype" id="7317294">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7317300">if</span>&nbsp;<span class="ident" id="7317303">err</span>&nbsp;<span class="op" id="7317307">:=</span>&nbsp;<span class="ident" id="7317310">DecryptPKCS1v15SessionKey</span><span class="op" id="7317335">(</span><span class="ident" id="7317336">nil</span><span class="op" id="7317339">,</span>&nbsp;<span class="ident" id="7317341">rsaPrivateKey</span><span class="op" id="7317354">,</span>&nbsp;<span class="ident" id="7317356">ciphertext</span><span class="op" id="7317366">,</span>&nbsp;<span class="ident" id="7317368">key</span><span class="op" id="7317371">[</span><span class="op" id="7317372">:</span><span class="op" id="7317373">]</span><span class="op" id="7317374">)</span><span class="op" id="7317375">;</span>&nbsp;<span class="ident" id="7317377">err</span>&nbsp;<span class="op" id="7317381">!=</span>&nbsp;<span class="ident" id="7317384">nil</span>&nbsp;<span class="op" id="7317388">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7317392">t</span><span class="op" id="7317393">.</span><span class="ident" id="7317394">Fatalf</span><span class="op" id="7317400">(</span><span class="string" id="7317401">&#34;Failed&nbsp;to&nbsp;decrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="7317438">,</span>&nbsp;<span class="ident" id="7317440">err</span><span class="op" id="7317443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7317446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7317450">for</span>&nbsp;<span class="ident" id="7317454">_</span><span class="op" id="7317455">,</span>&nbsp;<span class="ident" id="7317457">v</span>&nbsp;<span class="op" id="7317459">:=</span>&nbsp;<span class="keyword" id="7317462">range</span>&nbsp;<span class="ident" id="7317468">key</span>&nbsp;<span class="op" id="7317472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7317476">if</span>&nbsp;<span class="ident" id="7317479">v</span>&nbsp;<span class="op" id="7317481">!=</span>&nbsp;<span class="num" id="7317484">0</span>&nbsp;<span class="op" id="7317486">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7317491">t</span><span class="op" id="7317492">.</span><span class="ident" id="7317493">Fatal</span><span class="op" id="7317498">(</span><span class="string" id="7317499">&#34;key&nbsp;was&nbsp;modified&nbsp;when&nbsp;ciphertext&nbsp;was&nbsp;invalid&#34;</span><span class="op" id="7317545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7317549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7317552">}</span><br>
<span class="lineno"></span><span class="op" id="7317554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="7317557">//&nbsp;In&nbsp;order&nbsp;to&nbsp;generate&nbsp;new&nbsp;test&nbsp;vectors&nbsp;you&#39;ll&nbsp;need&nbsp;the&nbsp;PEM&nbsp;form&nbsp;of&nbsp;this&nbsp;key:</span><br>
<span class="lineno"></span><span class="comment" id="7317636">//&nbsp;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno"></span><span class="comment" id="7317671">//&nbsp;MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0</span><br>
<span class="lineno"></span><span class="comment" id="7317739">//&nbsp;fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu</span><br>
<span class="lineno"></span><span class="comment" id="7317807">//&nbsp;/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu</span><br>
<span class="lineno">255</span><span class="comment" id="7317875">//&nbsp;RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/</span><br>
<span class="lineno"></span><span class="comment" id="7317943">//&nbsp;EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A</span><br>
<span class="lineno"></span><span class="comment" id="7318011">//&nbsp;IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS</span><br>
<span class="lineno"></span><span class="comment" id="7318079">//&nbsp;tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V</span><br>
<span class="lineno"></span><span class="comment" id="7318123">//&nbsp;-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="7318157">var</span>&nbsp;<span class="ident" id="7318161">rsaPrivateKey</span>&nbsp;<span class="op" id="7318175">=</span>&nbsp;<span class="op" id="7318177">&amp;</span><span class="ident" id="7318178">PrivateKey</span><span class="op" id="7318188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7318191">PublicKey</span><span class="op" id="7318200">:</span>&nbsp;<span class="ident" id="7318202">PublicKey</span><span class="op" id="7318211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7318215">N</span><span class="op" id="7318216">:</span>&nbsp;<span class="ident" id="7318218">fromBase10</span><span class="op" id="7318228">(</span><span class="string" id="7318229">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="7318385">)</span><span class="op" id="7318386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7318390">E</span><span class="op" id="7318391">:</span>&nbsp;<span class="num" id="7318393">65537</span><span class="op" id="7318398">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7318401">}</span><span class="op" id="7318402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7318405">D</span><span class="op" id="7318406">:</span>&nbsp;<span class="ident" id="7318408">fromBase10</span><span class="op" id="7318418">(</span><span class="string" id="7318419">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="7318575">)</span><span class="op" id="7318576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7318579">Primes</span><span class="op" id="7318585">:</span>&nbsp;<span class="op" id="7318587">[</span><span class="op" id="7318588">]</span><span class="op" id="7318589">*</span><span class="ident" id="7318590">big</span><span class="op" id="7318593">.</span><span class="ident" id="7318594">Int</span><span class="op" id="7318597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7318601">fromBase10</span><span class="op" id="7318611">(</span><span class="string" id="7318612">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="7318691">)</span><span class="op" id="7318692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7318696">fromBase10</span><span class="op" id="7318706">(</span><span class="string" id="7318707">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="7318786">)</span><span class="op" id="7318787">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7318790">}</span><span class="op" id="7318791">,</span><br>
<span class="lineno"></span><span class="op" id="7318793">}</span>
</div>
</body>
</html>
