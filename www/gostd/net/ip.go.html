<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4076771">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4076826">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4076880">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4076931">//&nbsp;IP&nbsp;address&nbsp;manipulations</span><br>
<span class="lineno"></span><span class="comment" id="4076959">//</span><br>
<span class="lineno"></span><span class="comment" id="4076962">//&nbsp;IPv4&nbsp;addresses&nbsp;are&nbsp;4&nbsp;bytes;&nbsp;IPv6&nbsp;addresses&nbsp;are&nbsp;16&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="4077022">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4077080">//&nbsp;adding&nbsp;a&nbsp;canonical&nbsp;prefix&nbsp;(10&nbsp;zeros,&nbsp;2&nbsp;0xFFs).</span><br>
<span class="lineno">10</span><span class="comment" id="4077130">//&nbsp;This&nbsp;library&nbsp;accepts&nbsp;either&nbsp;size&nbsp;of&nbsp;byte&nbsp;slice&nbsp;but&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="4077191">//&nbsp;returns&nbsp;16-byte&nbsp;addresses.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4077222">package</span>&nbsp;<span class="ident" id="4077230">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4077235">import</span>&nbsp;<span class="string" id="4077242">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4077252">//&nbsp;IP&nbsp;address&nbsp;lengths&nbsp;(bytes).</span><br>
<span class="lineno"></span><span class="keyword" id="4077283">const</span>&nbsp;<span class="op" id="4077289">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077292">IPv4len</span>&nbsp;<span class="op" id="4077300">=</span>&nbsp;<span class="num" id="4077302">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077305">IPv6len</span>&nbsp;<span class="op" id="4077313">=</span>&nbsp;<span class="num" id="4077315">16</span><br>
<span class="lineno"></span><span class="op" id="4077318">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4077321">//&nbsp;An&nbsp;IP&nbsp;is&nbsp;a&nbsp;single&nbsp;IP&nbsp;address,&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="4077372">//&nbsp;Functions&nbsp;in&nbsp;this&nbsp;package&nbsp;accept&nbsp;either&nbsp;4-byte&nbsp;(IPv4)</span><br>
<span class="lineno">25</span><span class="comment" id="4077429">//&nbsp;or&nbsp;16-byte&nbsp;(IPv6)&nbsp;slices&nbsp;as&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="4077467">//</span><br>
<span class="lineno"></span><span class="comment" id="4077470">//&nbsp;Note&nbsp;that&nbsp;in&nbsp;this&nbsp;documentation,&nbsp;referring&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4077522">//&nbsp;IP&nbsp;address&nbsp;as&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="4077574">//&nbsp;is&nbsp;a&nbsp;semantic&nbsp;property&nbsp;of&nbsp;the&nbsp;address,&nbsp;not&nbsp;just&nbsp;the</span><br>
<span class="lineno">30</span><span class="comment" id="4077629">//&nbsp;length&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice:&nbsp;a&nbsp;16-byte&nbsp;slice&nbsp;can&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="4077684">//&nbsp;be&nbsp;an&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4077707">type</span>&nbsp;<span class="ident" id="4077712">IP</span>&nbsp;<span class="op" id="4077715">[</span><span class="op" id="4077716">]</span><span class="builtintype" id="4077717">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4077723">//&nbsp;An&nbsp;IP&nbsp;mask&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">35</span><span class="keyword" id="4077755">type</span>&nbsp;<span class="ident" id="4077760">IPMask</span>&nbsp;<span class="op" id="4077767">[</span><span class="op" id="4077768">]</span><span class="builtintype" id="4077769">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4077775">//&nbsp;An&nbsp;IPNet&nbsp;represents&nbsp;an&nbsp;IP&nbsp;network.</span><br>
<span class="lineno"></span><span class="keyword" id="4077813">type</span>&nbsp;<span class="ident" id="4077818">IPNet</span>&nbsp;<span class="keyword" id="4077824">struct</span>&nbsp;<span class="op" id="4077831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077834">IP</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4077839">IP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4077846">//&nbsp;network&nbsp;number</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4077865">Mask</span>&nbsp;<span class="ident" id="4077870">IPMask</span>&nbsp;<span class="comment" id="4077877">//&nbsp;network&nbsp;mask</span><br>
<span class="lineno"></span><span class="op" id="4077893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4077896">//&nbsp;IPv4&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;(in&nbsp;16-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4077952">//&nbsp;IPv4&nbsp;address&nbsp;a.b.c.d.</span><br>
<span class="lineno">45</span><span class="keyword" id="4077977">func</span>&nbsp;<span class="ident" id="4077982">IPv4</span><span class="op" id="4077986">(</span><span class="ident" id="4077987">a</span><span class="op" id="4077988">,</span>&nbsp;<span class="ident" id="4077990">b</span><span class="op" id="4077991">,</span>&nbsp;<span class="ident" id="4077993">c</span><span class="op" id="4077994">,</span>&nbsp;<span class="ident" id="4077996">d</span>&nbsp;<span class="builtintype" id="4077998">byte</span><span class="op" id="4078002">)</span>&nbsp;<span class="ident" id="4078004">IP</span>&nbsp;<span class="op" id="4078007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078010">p</span>&nbsp;<span class="op" id="4078012">:=</span>&nbsp;<span class="builtinfunc" id="4078015">make</span><span class="op" id="4078019">(</span><span class="ident" id="4078020">IP</span><span class="op" id="4078022">,</span>&nbsp;<span class="ident" id="4078024">IPv6len</span><span class="op" id="4078031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4078034">copy</span><span class="op" id="4078038">(</span><span class="ident" id="4078039">p</span><span class="op" id="4078040">,</span>&nbsp;<span class="ident" id="4078042">v4InV6Prefix</span><span class="op" id="4078054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078057">p</span><span class="op" id="4078058">[</span><span class="num" id="4078059">12</span><span class="op" id="4078061">]</span>&nbsp;<span class="op" id="4078063">=</span>&nbsp;<span class="ident" id="4078065">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078068">p</span><span class="op" id="4078069">[</span><span class="num" id="4078070">13</span><span class="op" id="4078072">]</span>&nbsp;<span class="op" id="4078074">=</span>&nbsp;<span class="ident" id="4078076">b</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078079">p</span><span class="op" id="4078080">[</span><span class="num" id="4078081">14</span><span class="op" id="4078083">]</span>&nbsp;<span class="op" id="4078085">=</span>&nbsp;<span class="ident" id="4078087">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078090">p</span><span class="op" id="4078091">[</span><span class="num" id="4078092">15</span><span class="op" id="4078094">]</span>&nbsp;<span class="op" id="4078096">=</span>&nbsp;<span class="ident" id="4078098">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078101">return</span>&nbsp;<span class="ident" id="4078108">p</span><br>
<span class="lineno"></span><span class="op" id="4078110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="4078113">var</span>&nbsp;<span class="ident" id="4078117">v4InV6Prefix</span>&nbsp;<span class="op" id="4078130">=</span>&nbsp;<span class="op" id="4078132">[</span><span class="op" id="4078133">]</span><span class="builtintype" id="4078134">byte</span><span class="op" id="4078138">{</span><span class="num" id="4078139">0</span><span class="op" id="4078140">,</span>&nbsp;<span class="num" id="4078142">0</span><span class="op" id="4078143">,</span>&nbsp;<span class="num" id="4078145">0</span><span class="op" id="4078146">,</span>&nbsp;<span class="num" id="4078148">0</span><span class="op" id="4078149">,</span>&nbsp;<span class="num" id="4078151">0</span><span class="op" id="4078152">,</span>&nbsp;<span class="num" id="4078154">0</span><span class="op" id="4078155">,</span>&nbsp;<span class="num" id="4078157">0</span><span class="op" id="4078158">,</span>&nbsp;<span class="num" id="4078160">0</span><span class="op" id="4078161">,</span>&nbsp;<span class="num" id="4078163">0</span><span class="op" id="4078164">,</span>&nbsp;<span class="num" id="4078166">0</span><span class="op" id="4078167">,</span>&nbsp;<span class="num" id="4078169">0xff</span><span class="op" id="4078173">,</span>&nbsp;<span class="num" id="4078175">0xff</span><span class="op" id="4078179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4078182">//&nbsp;IPv4Mask&nbsp;returns&nbsp;the&nbsp;IP&nbsp;mask&nbsp;(in&nbsp;4-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4078238">//&nbsp;IPv4&nbsp;mask&nbsp;a.b.c.d.</span><br>
<span class="lineno"></span><span class="keyword" id="4078260">func</span>&nbsp;<span class="ident" id="4078265">IPv4Mask</span><span class="op" id="4078273">(</span><span class="ident" id="4078274">a</span><span class="op" id="4078275">,</span>&nbsp;<span class="ident" id="4078277">b</span><span class="op" id="4078278">,</span>&nbsp;<span class="ident" id="4078280">c</span><span class="op" id="4078281">,</span>&nbsp;<span class="ident" id="4078283">d</span>&nbsp;<span class="builtintype" id="4078285">byte</span><span class="op" id="4078289">)</span>&nbsp;<span class="ident" id="4078291">IPMask</span>&nbsp;<span class="op" id="4078298">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078301">p</span>&nbsp;<span class="op" id="4078303">:=</span>&nbsp;<span class="builtinfunc" id="4078306">make</span><span class="op" id="4078310">(</span><span class="ident" id="4078311">IPMask</span><span class="op" id="4078317">,</span>&nbsp;<span class="ident" id="4078319">IPv4len</span><span class="op" id="4078326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078329">p</span><span class="op" id="4078330">[</span><span class="num" id="4078331">0</span><span class="op" id="4078332">]</span>&nbsp;<span class="op" id="4078334">=</span>&nbsp;<span class="ident" id="4078336">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078339">p</span><span class="op" id="4078340">[</span><span class="num" id="4078341">1</span><span class="op" id="4078342">]</span>&nbsp;<span class="op" id="4078344">=</span>&nbsp;<span class="ident" id="4078346">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078349">p</span><span class="op" id="4078350">[</span><span class="num" id="4078351">2</span><span class="op" id="4078352">]</span>&nbsp;<span class="op" id="4078354">=</span>&nbsp;<span class="ident" id="4078356">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078359">p</span><span class="op" id="4078360">[</span><span class="num" id="4078361">3</span><span class="op" id="4078362">]</span>&nbsp;<span class="op" id="4078364">=</span>&nbsp;<span class="ident" id="4078366">d</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078369">return</span>&nbsp;<span class="ident" id="4078376">p</span><br>
<span class="lineno"></span><span class="op" id="4078378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4078381">//&nbsp;CIDRMask&nbsp;returns&nbsp;an&nbsp;IPMask&nbsp;consisting&nbsp;of&nbsp;`ones&#39;&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="4078439">//&nbsp;followed&nbsp;by&nbsp;0s&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;length&nbsp;of&nbsp;`bits&#39;&nbsp;bits.</span><br>
<span class="lineno">70</span><span class="comment" id="4078494">//&nbsp;For&nbsp;a&nbsp;mask&nbsp;of&nbsp;this&nbsp;form,&nbsp;CIDRMask&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;IPMask.Size.</span><br>
<span class="lineno"></span><span class="keyword" id="4078562">func</span>&nbsp;<span class="ident" id="4078567">CIDRMask</span><span class="op" id="4078575">(</span><span class="ident" id="4078576">ones</span><span class="op" id="4078580">,</span>&nbsp;<span class="ident" id="4078582">bits</span>&nbsp;<span class="builtintype" id="4078587">int</span><span class="op" id="4078590">)</span>&nbsp;<span class="ident" id="4078592">IPMask</span>&nbsp;<span class="op" id="4078599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078602">if</span>&nbsp;<span class="ident" id="4078605">bits</span>&nbsp;<span class="op" id="4078610">!=</span>&nbsp;<span class="num" id="4078613">8</span><span class="op" id="4078614">*</span><span class="ident" id="4078615">IPv4len</span>&nbsp;<span class="op" id="4078623">&amp;&amp;</span>&nbsp;<span class="ident" id="4078626">bits</span>&nbsp;<span class="op" id="4078631">!=</span>&nbsp;<span class="num" id="4078634">8</span><span class="op" id="4078635">*</span><span class="ident" id="4078636">IPv6len</span>&nbsp;<span class="op" id="4078644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078648">return</span>&nbsp;<span class="ident" id="4078655">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078660">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078663">if</span>&nbsp;<span class="ident" id="4078666">ones</span>&nbsp;<span class="op" id="4078671">&lt;</span>&nbsp;<span class="num" id="4078673">0</span>&nbsp;<span class="op" id="4078675">||</span>&nbsp;<span class="ident" id="4078678">ones</span>&nbsp;<span class="op" id="4078683">&gt;</span>&nbsp;<span class="ident" id="4078685">bits</span>&nbsp;<span class="op" id="4078690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078694">return</span>&nbsp;<span class="ident" id="4078701">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078709">l</span>&nbsp;<span class="op" id="4078711">:=</span>&nbsp;<span class="ident" id="4078714">bits</span>&nbsp;<span class="op" id="4078719">/</span>&nbsp;<span class="num" id="4078721">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078724">m</span>&nbsp;<span class="op" id="4078726">:=</span>&nbsp;<span class="builtinfunc" id="4078729">make</span><span class="op" id="4078733">(</span><span class="ident" id="4078734">IPMask</span><span class="op" id="4078740">,</span>&nbsp;<span class="ident" id="4078742">l</span><span class="op" id="4078743">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078746">n</span>&nbsp;<span class="op" id="4078748">:=</span>&nbsp;<span class="builtintype" id="4078751">uint</span><span class="op" id="4078755">(</span><span class="ident" id="4078756">ones</span><span class="op" id="4078760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078763">for</span>&nbsp;<span class="ident" id="4078767">i</span>&nbsp;<span class="op" id="4078769">:=</span>&nbsp;<span class="num" id="4078772">0</span><span class="op" id="4078773">;</span>&nbsp;<span class="ident" id="4078775">i</span>&nbsp;<span class="op" id="4078777">&lt;</span>&nbsp;<span class="ident" id="4078779">l</span><span class="op" id="4078780">;</span>&nbsp;<span class="ident" id="4078782">i</span><span class="op" id="4078783">++</span>&nbsp;<span class="op" id="4078786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078790">if</span>&nbsp;<span class="ident" id="4078793">n</span>&nbsp;<span class="op" id="4078795">&gt;=</span>&nbsp;<span class="num" id="4078798">8</span>&nbsp;<span class="op" id="4078800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078805">m</span><span class="op" id="4078806">[</span><span class="ident" id="4078807">i</span><span class="op" id="4078808">]</span>&nbsp;<span class="op" id="4078810">=</span>&nbsp;<span class="num" id="4078812">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078820">n</span>&nbsp;<span class="op" id="4078822">-=</span>&nbsp;<span class="num" id="4078825">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078830">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078845">m</span><span class="op" id="4078846">[</span><span class="ident" id="4078847">i</span><span class="op" id="4078848">]</span>&nbsp;<span class="op" id="4078850">=</span>&nbsp;<span class="op" id="4078852">^</span><span class="builtintype" id="4078853">byte</span><span class="op" id="4078857">(</span><span class="num" id="4078858">0xff</span>&nbsp;<span class="op" id="4078863">&gt;&gt;</span>&nbsp;<span class="ident" id="4078866">n</span><span class="op" id="4078867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078871">n</span>&nbsp;<span class="op" id="4078873">=</span>&nbsp;<span class="num" id="4078875">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4078878">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4078881">return</span>&nbsp;<span class="ident" id="4078888">m</span><br>
<span class="lineno"></span><span class="op" id="4078890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4078893">//&nbsp;Well-known&nbsp;IPv4&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="4078922">var</span>&nbsp;<span class="op" id="4078926">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078929">IPv4bcast</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078943">=</span>&nbsp;<span class="ident" id="4078945">IPv4</span><span class="op" id="4078949">(</span><span class="num" id="4078950">255</span><span class="op" id="4078953">,</span>&nbsp;<span class="num" id="4078955">255</span><span class="op" id="4078958">,</span>&nbsp;<span class="num" id="4078960">255</span><span class="op" id="4078963">,</span>&nbsp;<span class="num" id="4078965">255</span><span class="op" id="4078968">)</span>&nbsp;<span class="comment" id="4078970">//&nbsp;broadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4078984">IPv4allsys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4078998">=</span>&nbsp;<span class="ident" id="4079000">IPv4</span><span class="op" id="4079004">(</span><span class="num" id="4079005">224</span><span class="op" id="4079008">,</span>&nbsp;<span class="num" id="4079010">0</span><span class="op" id="4079011">,</span>&nbsp;<span class="num" id="4079013">0</span><span class="op" id="4079014">,</span>&nbsp;<span class="num" id="4079016">1</span><span class="op" id="4079017">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4079025">//&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079041">IPv4allrouter</span>&nbsp;<span class="op" id="4079055">=</span>&nbsp;<span class="ident" id="4079057">IPv4</span><span class="op" id="4079061">(</span><span class="num" id="4079062">224</span><span class="op" id="4079065">,</span>&nbsp;<span class="num" id="4079067">0</span><span class="op" id="4079068">,</span>&nbsp;<span class="num" id="4079070">0</span><span class="op" id="4079071">,</span>&nbsp;<span class="num" id="4079073">2</span><span class="op" id="4079074">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4079082">//&nbsp;all&nbsp;routers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079098">IPv4zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4079112">=</span>&nbsp;<span class="ident" id="4079114">IPv4</span><span class="op" id="4079118">(</span><span class="num" id="4079119">0</span><span class="op" id="4079120">,</span>&nbsp;<span class="num" id="4079122">0</span><span class="op" id="4079123">,</span>&nbsp;<span class="num" id="4079125">0</span><span class="op" id="4079126">,</span>&nbsp;<span class="num" id="4079128">0</span><span class="op" id="4079129">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4079139">//&nbsp;all&nbsp;zeros</span><br>
<span class="lineno"></span><span class="op" id="4079152">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4079155">//&nbsp;Well-known&nbsp;IPv6&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="4079184">var</span>&nbsp;<span class="op" id="4079188">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079191">IPv6zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4079218">=</span>&nbsp;<span class="ident" id="4079220">IP</span><span class="op" id="4079222">{</span><span class="num" id="4079223">0</span><span class="op" id="4079224">,</span>&nbsp;<span class="num" id="4079226">0</span><span class="op" id="4079227">,</span>&nbsp;<span class="num" id="4079229">0</span><span class="op" id="4079230">,</span>&nbsp;<span class="num" id="4079232">0</span><span class="op" id="4079233">,</span>&nbsp;<span class="num" id="4079235">0</span><span class="op" id="4079236">,</span>&nbsp;<span class="num" id="4079238">0</span><span class="op" id="4079239">,</span>&nbsp;<span class="num" id="4079241">0</span><span class="op" id="4079242">,</span>&nbsp;<span class="num" id="4079244">0</span><span class="op" id="4079245">,</span>&nbsp;<span class="num" id="4079247">0</span><span class="op" id="4079248">,</span>&nbsp;<span class="num" id="4079250">0</span><span class="op" id="4079251">,</span>&nbsp;<span class="num" id="4079253">0</span><span class="op" id="4079254">,</span>&nbsp;<span class="num" id="4079256">0</span><span class="op" id="4079257">,</span>&nbsp;<span class="num" id="4079259">0</span><span class="op" id="4079260">,</span>&nbsp;<span class="num" id="4079262">0</span><span class="op" id="4079263">,</span>&nbsp;<span class="num" id="4079265">0</span><span class="op" id="4079266">,</span>&nbsp;<span class="num" id="4079268">0</span><span class="op" id="4079269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079272">IPv6unspecified</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4079299">=</span>&nbsp;<span class="ident" id="4079301">IP</span><span class="op" id="4079303">{</span><span class="num" id="4079304">0</span><span class="op" id="4079305">,</span>&nbsp;<span class="num" id="4079307">0</span><span class="op" id="4079308">,</span>&nbsp;<span class="num" id="4079310">0</span><span class="op" id="4079311">,</span>&nbsp;<span class="num" id="4079313">0</span><span class="op" id="4079314">,</span>&nbsp;<span class="num" id="4079316">0</span><span class="op" id="4079317">,</span>&nbsp;<span class="num" id="4079319">0</span><span class="op" id="4079320">,</span>&nbsp;<span class="num" id="4079322">0</span><span class="op" id="4079323">,</span>&nbsp;<span class="num" id="4079325">0</span><span class="op" id="4079326">,</span>&nbsp;<span class="num" id="4079328">0</span><span class="op" id="4079329">,</span>&nbsp;<span class="num" id="4079331">0</span><span class="op" id="4079332">,</span>&nbsp;<span class="num" id="4079334">0</span><span class="op" id="4079335">,</span>&nbsp;<span class="num" id="4079337">0</span><span class="op" id="4079338">,</span>&nbsp;<span class="num" id="4079340">0</span><span class="op" id="4079341">,</span>&nbsp;<span class="num" id="4079343">0</span><span class="op" id="4079344">,</span>&nbsp;<span class="num" id="4079346">0</span><span class="op" id="4079347">,</span>&nbsp;<span class="num" id="4079349">0</span><span class="op" id="4079350">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079353">IPv6loopback</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4079380">=</span>&nbsp;<span class="ident" id="4079382">IP</span><span class="op" id="4079384">{</span><span class="num" id="4079385">0</span><span class="op" id="4079386">,</span>&nbsp;<span class="num" id="4079388">0</span><span class="op" id="4079389">,</span>&nbsp;<span class="num" id="4079391">0</span><span class="op" id="4079392">,</span>&nbsp;<span class="num" id="4079394">0</span><span class="op" id="4079395">,</span>&nbsp;<span class="num" id="4079397">0</span><span class="op" id="4079398">,</span>&nbsp;<span class="num" id="4079400">0</span><span class="op" id="4079401">,</span>&nbsp;<span class="num" id="4079403">0</span><span class="op" id="4079404">,</span>&nbsp;<span class="num" id="4079406">0</span><span class="op" id="4079407">,</span>&nbsp;<span class="num" id="4079409">0</span><span class="op" id="4079410">,</span>&nbsp;<span class="num" id="4079412">0</span><span class="op" id="4079413">,</span>&nbsp;<span class="num" id="4079415">0</span><span class="op" id="4079416">,</span>&nbsp;<span class="num" id="4079418">0</span><span class="op" id="4079419">,</span>&nbsp;<span class="num" id="4079421">0</span><span class="op" id="4079422">,</span>&nbsp;<span class="num" id="4079424">0</span><span class="op" id="4079425">,</span>&nbsp;<span class="num" id="4079427">0</span><span class="op" id="4079428">,</span>&nbsp;<span class="num" id="4079430">1</span><span class="op" id="4079431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079434">IPv6interfacelocalallnodes</span>&nbsp;<span class="op" id="4079461">=</span>&nbsp;<span class="ident" id="4079463">IP</span><span class="op" id="4079465">{</span><span class="num" id="4079466">0xff</span><span class="op" id="4079470">,</span>&nbsp;<span class="num" id="4079472">0x01</span><span class="op" id="4079476">,</span>&nbsp;<span class="num" id="4079478">0</span><span class="op" id="4079479">,</span>&nbsp;<span class="num" id="4079481">0</span><span class="op" id="4079482">,</span>&nbsp;<span class="num" id="4079484">0</span><span class="op" id="4079485">,</span>&nbsp;<span class="num" id="4079487">0</span><span class="op" id="4079488">,</span>&nbsp;<span class="num" id="4079490">0</span><span class="op" id="4079491">,</span>&nbsp;<span class="num" id="4079493">0</span><span class="op" id="4079494">,</span>&nbsp;<span class="num" id="4079496">0</span><span class="op" id="4079497">,</span>&nbsp;<span class="num" id="4079499">0</span><span class="op" id="4079500">,</span>&nbsp;<span class="num" id="4079502">0</span><span class="op" id="4079503">,</span>&nbsp;<span class="num" id="4079505">0</span><span class="op" id="4079506">,</span>&nbsp;<span class="num" id="4079508">0</span><span class="op" id="4079509">,</span>&nbsp;<span class="num" id="4079511">0</span><span class="op" id="4079512">,</span>&nbsp;<span class="num" id="4079514">0</span><span class="op" id="4079515">,</span>&nbsp;<span class="num" id="4079517">0x01</span><span class="op" id="4079521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079524">IPv6linklocalallnodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4079551">=</span>&nbsp;<span class="ident" id="4079553">IP</span><span class="op" id="4079555">{</span><span class="num" id="4079556">0xff</span><span class="op" id="4079560">,</span>&nbsp;<span class="num" id="4079562">0x02</span><span class="op" id="4079566">,</span>&nbsp;<span class="num" id="4079568">0</span><span class="op" id="4079569">,</span>&nbsp;<span class="num" id="4079571">0</span><span class="op" id="4079572">,</span>&nbsp;<span class="num" id="4079574">0</span><span class="op" id="4079575">,</span>&nbsp;<span class="num" id="4079577">0</span><span class="op" id="4079578">,</span>&nbsp;<span class="num" id="4079580">0</span><span class="op" id="4079581">,</span>&nbsp;<span class="num" id="4079583">0</span><span class="op" id="4079584">,</span>&nbsp;<span class="num" id="4079586">0</span><span class="op" id="4079587">,</span>&nbsp;<span class="num" id="4079589">0</span><span class="op" id="4079590">,</span>&nbsp;<span class="num" id="4079592">0</span><span class="op" id="4079593">,</span>&nbsp;<span class="num" id="4079595">0</span><span class="op" id="4079596">,</span>&nbsp;<span class="num" id="4079598">0</span><span class="op" id="4079599">,</span>&nbsp;<span class="num" id="4079601">0</span><span class="op" id="4079602">,</span>&nbsp;<span class="num" id="4079604">0</span><span class="op" id="4079605">,</span>&nbsp;<span class="num" id="4079607">0x01</span><span class="op" id="4079611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4079614">IPv6linklocalallrouters</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4079641">=</span>&nbsp;<span class="ident" id="4079643">IP</span><span class="op" id="4079645">{</span><span class="num" id="4079646">0xff</span><span class="op" id="4079650">,</span>&nbsp;<span class="num" id="4079652">0x02</span><span class="op" id="4079656">,</span>&nbsp;<span class="num" id="4079658">0</span><span class="op" id="4079659">,</span>&nbsp;<span class="num" id="4079661">0</span><span class="op" id="4079662">,</span>&nbsp;<span class="num" id="4079664">0</span><span class="op" id="4079665">,</span>&nbsp;<span class="num" id="4079667">0</span><span class="op" id="4079668">,</span>&nbsp;<span class="num" id="4079670">0</span><span class="op" id="4079671">,</span>&nbsp;<span class="num" id="4079673">0</span><span class="op" id="4079674">,</span>&nbsp;<span class="num" id="4079676">0</span><span class="op" id="4079677">,</span>&nbsp;<span class="num" id="4079679">0</span><span class="op" id="4079680">,</span>&nbsp;<span class="num" id="4079682">0</span><span class="op" id="4079683">,</span>&nbsp;<span class="num" id="4079685">0</span><span class="op" id="4079686">,</span>&nbsp;<span class="num" id="4079688">0</span><span class="op" id="4079689">,</span>&nbsp;<span class="num" id="4079691">0</span><span class="op" id="4079692">,</span>&nbsp;<span class="num" id="4079694">0</span><span class="op" id="4079695">,</span>&nbsp;<span class="num" id="4079697">0x02</span><span class="op" id="4079701">}</span><br>
<span class="lineno"></span><span class="op" id="4079703">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="4079706">//&nbsp;IsUnspecified&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;an&nbsp;unspecified&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4079769">func</span>&nbsp;<span class="op" id="4079774">(</span><span class="ident" id="4079775">ip</span>&nbsp;<span class="ident" id="4079778">IP</span><span class="op" id="4079780">)</span>&nbsp;<span class="ident" id="4079782">IsUnspecified</span><span class="op" id="4079795">(</span><span class="op" id="4079796">)</span>&nbsp;<span class="builtintype" id="4079798">bool</span>&nbsp;<span class="op" id="4079803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079806">if</span>&nbsp;<span class="ident" id="4079809">ip</span><span class="op" id="4079811">.</span><span class="ident" id="4079812">Equal</span><span class="op" id="4079817">(</span><span class="ident" id="4079818">IPv4zero</span><span class="op" id="4079826">)</span>&nbsp;<span class="op" id="4079828">||</span>&nbsp;<span class="ident" id="4079831">ip</span><span class="op" id="4079833">.</span><span class="ident" id="4079834">Equal</span><span class="op" id="4079839">(</span><span class="ident" id="4079840">IPv6unspecified</span><span class="op" id="4079855">)</span>&nbsp;<span class="op" id="4079857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079861">return</span>&nbsp;<span class="builtintype" id="4079868">true</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4079874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079877">return</span>&nbsp;<span class="builtintype" id="4079884">false</span><br>
<span class="lineno"></span><span class="op" id="4079890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4079893">//&nbsp;IsLoopback&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;loopback&nbsp;address.</span><br>
<span class="lineno">120</span><span class="keyword" id="4079949">func</span>&nbsp;<span class="op" id="4079954">(</span><span class="ident" id="4079955">ip</span>&nbsp;<span class="ident" id="4079958">IP</span><span class="op" id="4079960">)</span>&nbsp;<span class="ident" id="4079962">IsLoopback</span><span class="op" id="4079972">(</span><span class="op" id="4079973">)</span>&nbsp;<span class="builtintype" id="4079975">bool</span>&nbsp;<span class="op" id="4079980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4079983">if</span>&nbsp;<span class="ident" id="4079986">ip4</span>&nbsp;<span class="op" id="4079990">:=</span>&nbsp;<span class="ident" id="4079993">ip</span><span class="op" id="4079995">.</span><span class="ident" id="4079996">To4</span><span class="op" id="4079999">(</span><span class="op" id="4080000">)</span><span class="op" id="4080001">;</span>&nbsp;<span class="ident" id="4080003">ip4</span>&nbsp;<span class="op" id="4080007">!=</span>&nbsp;<span class="ident" id="4080010">nil</span>&nbsp;<span class="op" id="4080014">&amp;&amp;</span>&nbsp;<span class="ident" id="4080017">ip4</span><span class="op" id="4080020">[</span><span class="num" id="4080021">0</span><span class="op" id="4080022">]</span>&nbsp;<span class="op" id="4080024">==</span>&nbsp;<span class="num" id="4080027">127</span>&nbsp;<span class="op" id="4080031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4080035">return</span>&nbsp;<span class="builtintype" id="4080042">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4080048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4080051">return</span>&nbsp;<span class="ident" id="4080058">ip</span><span class="op" id="4080060">.</span><span class="ident" id="4080061">Equal</span><span class="op" id="4080066">(</span><span class="ident" id="4080067">IPv6loopback</span><span class="op" id="4080079">)</span><br>
<span class="lineno">125</span><span class="op" id="4080081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4080084">//&nbsp;IsMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4080142">func</span>&nbsp;<span class="op" id="4080147">(</span><span class="ident" id="4080148">ip</span>&nbsp;<span class="ident" id="4080151">IP</span><span class="op" id="4080153">)</span>&nbsp;<span class="ident" id="4080155">IsMulticast</span><span class="op" id="4080166">(</span><span class="op" id="4080167">)</span>&nbsp;<span class="builtintype" id="4080169">bool</span>&nbsp;<span class="op" id="4080174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4080177">if</span>&nbsp;<span class="ident" id="4080180">ip4</span>&nbsp;<span class="op" id="4080184">:=</span>&nbsp;<span class="ident" id="4080187">ip</span><span class="op" id="4080189">.</span><span class="ident" id="4080190">To4</span><span class="op" id="4080193">(</span><span class="op" id="4080194">)</span><span class="op" id="4080195">;</span>&nbsp;<span class="ident" id="4080197">ip4</span>&nbsp;<span class="op" id="4080201">!=</span>&nbsp;<span class="ident" id="4080204">nil</span>&nbsp;<span class="op" id="4080208">&amp;&amp;</span>&nbsp;<span class="ident" id="4080211">ip4</span><span class="op" id="4080214">[</span><span class="num" id="4080215">0</span><span class="op" id="4080216">]</span><span class="op" id="4080217">&amp;</span><span class="num" id="4080218">0xf0</span>&nbsp;<span class="op" id="4080223">==</span>&nbsp;<span class="num" id="4080226">0xe0</span>&nbsp;<span class="op" id="4080231">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4080235">return</span>&nbsp;<span class="builtintype" id="4080242">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4080248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4080251">return</span>&nbsp;<span class="ident" id="4080258">ip</span><span class="op" id="4080260">[</span><span class="num" id="4080261">0</span><span class="op" id="4080262">]</span>&nbsp;<span class="op" id="4080264">==</span>&nbsp;<span class="num" id="4080267">0xff</span><br>
<span class="lineno"></span><span class="op" id="4080272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4080275">//&nbsp;IsInterfaceLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4080330">//&nbsp;an&nbsp;interface-local&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4080371">func</span>&nbsp;<span class="op" id="4080376">(</span><span class="ident" id="4080377">ip</span>&nbsp;<span class="ident" id="4080380">IP</span><span class="op" id="4080382">)</span>&nbsp;<span class="ident" id="4080384">IsInterfaceLocalMulticast</span><span class="op" id="4080409">(</span><span class="op" id="4080410">)</span>&nbsp;<span class="builtintype" id="4080412">bool</span>&nbsp;<span class="op" id="4080417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4080420">return</span>&nbsp;<span class="builtinfunc" id="4080427">len</span><span class="op" id="4080430">(</span><span class="ident" id="4080431">ip</span><span class="op" id="4080433">)</span>&nbsp;<span class="op" id="4080435">==</span>&nbsp;<span class="ident" id="4080438">IPv6len</span>&nbsp;<span class="op" id="4080446">&amp;&amp;</span>&nbsp;<span class="ident" id="4080449">ip</span><span class="op" id="4080451">[</span><span class="num" id="4080452">0</span><span class="op" id="4080453">]</span>&nbsp;<span class="op" id="4080455">==</span>&nbsp;<span class="num" id="4080458">0xff</span>&nbsp;<span class="op" id="4080463">&amp;&amp;</span>&nbsp;<span class="ident" id="4080466">ip</span><span class="op" id="4080468">[</span><span class="num" id="4080469">1</span><span class="op" id="4080470">]</span><span class="op" id="4080471">&amp;</span><span class="num" id="4080472">0x0f</span>&nbsp;<span class="op" id="4080477">==</span>&nbsp;<span class="num" id="4080480">0x01</span><br>
<span class="lineno"></span><span class="op" id="4080485">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="4080488">//&nbsp;IsLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="4080547">//&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4080569">func</span>&nbsp;<span class="op" id="4080574">(</span><span class="ident" id="4080575">ip</span>&nbsp;<span class="ident" id="4080578">IP</span><span class="op" id="4080580">)</span>&nbsp;<span class="ident" id="4080582">IsLinkLocalMulticast</span><span class="op" id="4080602">(</span><span class="op" id="4080603">)</span>&nbsp;<span class="builtintype" id="4080605">bool</span>&nbsp;<span class="op" id="4080610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4080613">if</span>&nbsp;<span class="ident" id="4080616">ip4</span>&nbsp;<span class="op" id="4080620">:=</span>&nbsp;<span class="ident" id="4080623">ip</span><span class="op" id="4080625">.</span><span class="ident" id="4080626">To4</span><span class="op" id="4080629">(</span><span class="op" id="4080630">)</span><span class="op" id="4080631">;</span>&nbsp;<span class="ident" id="4080633">ip4</span>&nbsp;<span class="op" id="4080637">!=</span>&nbsp;<span class="ident" id="4080640">nil</span>&nbsp;<span class="op" id="4080644">&amp;&amp;</span>&nbsp;<span class="ident" id="4080647">ip4</span><span class="op" id="4080650">[</span><span class="num" id="4080651">0</span><span class="op" id="4080652">]</span>&nbsp;<span class="op" id="4080654">==</span>&nbsp;<span class="num" id="4080657">224</span>&nbsp;<span class="op" id="4080661">&amp;&amp;</span>&nbsp;<span class="ident" id="4080664">ip4</span><span class="op" id="4080667">[</span><span class="num" id="4080668">1</span><span class="op" id="4080669">]</span>&nbsp;<span class="op" id="4080671">==</span>&nbsp;<span class="num" id="4080674">0</span>&nbsp;<span class="op" id="4080676">&amp;&amp;</span>&nbsp;<span class="ident" id="4080679">ip4</span><span class="op" id="4080682">[</span><span class="num" id="4080683">2</span><span class="op" id="4080684">]</span>&nbsp;<span class="op" id="4080686">==</span>&nbsp;<span class="num" id="4080689">0</span>&nbsp;<span class="op" id="4080691">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4080695">return</span>&nbsp;<span class="builtintype" id="4080702">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4080708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4080711">return</span>&nbsp;<span class="ident" id="4080718">ip</span><span class="op" id="4080720">[</span><span class="num" id="4080721">0</span><span class="op" id="4080722">]</span>&nbsp;<span class="op" id="4080724">==</span>&nbsp;<span class="num" id="4080727">0xff</span>&nbsp;<span class="op" id="4080732">&amp;&amp;</span>&nbsp;<span class="ident" id="4080735">ip</span><span class="op" id="4080737">[</span><span class="num" id="4080738">1</span><span class="op" id="4080739">]</span><span class="op" id="4080740">&amp;</span><span class="num" id="4080741">0x0f</span>&nbsp;<span class="op" id="4080746">==</span>&nbsp;<span class="num" id="4080749">0x02</span><br>
<span class="lineno"></span><span class="op" id="4080754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="4080757">//&nbsp;IsLinkLocalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="4080814">//&nbsp;unicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4080834">func</span>&nbsp;<span class="op" id="4080839">(</span><span class="ident" id="4080840">ip</span>&nbsp;<span class="ident" id="4080843">IP</span><span class="op" id="4080845">)</span>&nbsp;<span class="ident" id="4080847">IsLinkLocalUnicast</span><span class="op" id="4080865">(</span><span class="op" id="4080866">)</span>&nbsp;<span class="builtintype" id="4080868">bool</span>&nbsp;<span class="op" id="4080873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4080876">if</span>&nbsp;<span class="ident" id="4080879">ip4</span>&nbsp;<span class="op" id="4080883">:=</span>&nbsp;<span class="ident" id="4080886">ip</span><span class="op" id="4080888">.</span><span class="ident" id="4080889">To4</span><span class="op" id="4080892">(</span><span class="op" id="4080893">)</span><span class="op" id="4080894">;</span>&nbsp;<span class="ident" id="4080896">ip4</span>&nbsp;<span class="op" id="4080900">!=</span>&nbsp;<span class="ident" id="4080903">nil</span>&nbsp;<span class="op" id="4080907">&amp;&amp;</span>&nbsp;<span class="ident" id="4080910">ip4</span><span class="op" id="4080913">[</span><span class="num" id="4080914">0</span><span class="op" id="4080915">]</span>&nbsp;<span class="op" id="4080917">==</span>&nbsp;<span class="num" id="4080920">169</span>&nbsp;<span class="op" id="4080924">&amp;&amp;</span>&nbsp;<span class="ident" id="4080927">ip4</span><span class="op" id="4080930">[</span><span class="num" id="4080931">1</span><span class="op" id="4080932">]</span>&nbsp;<span class="op" id="4080934">==</span>&nbsp;<span class="num" id="4080937">254</span>&nbsp;<span class="op" id="4080941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4080945">return</span>&nbsp;<span class="builtintype" id="4080952">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4080958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4080961">return</span>&nbsp;<span class="ident" id="4080968">ip</span><span class="op" id="4080970">[</span><span class="num" id="4080971">0</span><span class="op" id="4080972">]</span>&nbsp;<span class="op" id="4080974">==</span>&nbsp;<span class="num" id="4080977">0xfe</span>&nbsp;<span class="op" id="4080982">&amp;&amp;</span>&nbsp;<span class="ident" id="4080985">ip</span><span class="op" id="4080987">[</span><span class="num" id="4080988">1</span><span class="op" id="4080989">]</span><span class="op" id="4080990">&amp;</span><span class="num" id="4080991">0xc0</span>&nbsp;<span class="op" id="4080996">==</span>&nbsp;<span class="num" id="4080999">0x80</span><br>
<span class="lineno"></span><span class="op" id="4081004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4081007">//&nbsp;IsGlobalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;global&nbsp;unicast</span><br>
<span class="lineno">160</span><span class="comment" id="4081065">//&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4081077">func</span>&nbsp;<span class="op" id="4081082">(</span><span class="ident" id="4081083">ip</span>&nbsp;<span class="ident" id="4081086">IP</span><span class="op" id="4081088">)</span>&nbsp;<span class="ident" id="4081090">IsGlobalUnicast</span><span class="op" id="4081105">(</span><span class="op" id="4081106">)</span>&nbsp;<span class="builtintype" id="4081108">bool</span>&nbsp;<span class="op" id="4081113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081116">return</span>&nbsp;<span class="op" id="4081123">!</span><span class="ident" id="4081124">ip</span><span class="op" id="4081126">.</span><span class="ident" id="4081127">IsUnspecified</span><span class="op" id="4081140">(</span><span class="op" id="4081141">)</span>&nbsp;<span class="op" id="4081143">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081148">!</span><span class="ident" id="4081149">ip</span><span class="op" id="4081151">.</span><span class="ident" id="4081152">IsLoopback</span><span class="op" id="4081162">(</span><span class="op" id="4081163">)</span>&nbsp;<span class="op" id="4081165">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081170">!</span><span class="ident" id="4081171">ip</span><span class="op" id="4081173">.</span><span class="ident" id="4081174">IsMulticast</span><span class="op" id="4081185">(</span><span class="op" id="4081186">)</span>&nbsp;<span class="op" id="4081188">&amp;&amp;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081193">!</span><span class="ident" id="4081194">ip</span><span class="op" id="4081196">.</span><span class="ident" id="4081197">IsLinkLocalUnicast</span><span class="op" id="4081215">(</span><span class="op" id="4081216">)</span><br>
<span class="lineno"></span><span class="op" id="4081218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4081221">//&nbsp;Is&nbsp;p&nbsp;all&nbsp;zeros?</span><br>
<span class="lineno"></span><span class="keyword" id="4081240">func</span>&nbsp;<span class="ident" id="4081245">isZeros</span><span class="op" id="4081252">(</span><span class="ident" id="4081253">p</span>&nbsp;<span class="ident" id="4081255">IP</span><span class="op" id="4081257">)</span>&nbsp;<span class="builtintype" id="4081259">bool</span>&nbsp;<span class="op" id="4081264">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081267">for</span>&nbsp;<span class="ident" id="4081271">i</span>&nbsp;<span class="op" id="4081273">:=</span>&nbsp;<span class="num" id="4081276">0</span><span class="op" id="4081277">;</span>&nbsp;<span class="ident" id="4081279">i</span>&nbsp;<span class="op" id="4081281">&lt;</span>&nbsp;<span class="builtinfunc" id="4081283">len</span><span class="op" id="4081286">(</span><span class="ident" id="4081287">p</span><span class="op" id="4081288">)</span><span class="op" id="4081289">;</span>&nbsp;<span class="ident" id="4081291">i</span><span class="op" id="4081292">++</span>&nbsp;<span class="op" id="4081295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081299">if</span>&nbsp;<span class="ident" id="4081302">p</span><span class="op" id="4081303">[</span><span class="ident" id="4081304">i</span><span class="op" id="4081305">]</span>&nbsp;<span class="op" id="4081307">!=</span>&nbsp;<span class="num" id="4081310">0</span>&nbsp;<span class="op" id="4081312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081317">return</span>&nbsp;<span class="builtintype" id="4081324">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081335">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081338">return</span>&nbsp;<span class="builtintype" id="4081345">true</span><br>
<span class="lineno"></span><span class="op" id="4081350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4081353">//&nbsp;To4&nbsp;converts&nbsp;the&nbsp;IPv4&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;4-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="4081417">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;To4&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">180</span><span class="keyword" id="4081467">func</span>&nbsp;<span class="op" id="4081472">(</span><span class="ident" id="4081473">ip</span>&nbsp;<span class="ident" id="4081476">IP</span><span class="op" id="4081478">)</span>&nbsp;<span class="ident" id="4081480">To4</span><span class="op" id="4081483">(</span><span class="op" id="4081484">)</span>&nbsp;<span class="ident" id="4081486">IP</span>&nbsp;<span class="op" id="4081489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081492">if</span>&nbsp;<span class="builtinfunc" id="4081495">len</span><span class="op" id="4081498">(</span><span class="ident" id="4081499">ip</span><span class="op" id="4081501">)</span>&nbsp;<span class="op" id="4081503">==</span>&nbsp;<span class="ident" id="4081506">IPv4len</span>&nbsp;<span class="op" id="4081514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081518">return</span>&nbsp;<span class="ident" id="4081525">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081532">if</span>&nbsp;<span class="builtinfunc" id="4081535">len</span><span class="op" id="4081538">(</span><span class="ident" id="4081539">ip</span><span class="op" id="4081541">)</span>&nbsp;<span class="op" id="4081543">==</span>&nbsp;<span class="ident" id="4081546">IPv6len</span>&nbsp;<span class="op" id="4081554">&amp;&amp;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081559">isZeros</span><span class="op" id="4081566">(</span><span class="ident" id="4081567">ip</span><span class="op" id="4081569">[</span><span class="num" id="4081570">0</span><span class="op" id="4081571">:</span><span class="num" id="4081572">10</span><span class="op" id="4081574">]</span><span class="op" id="4081575">)</span>&nbsp;<span class="op" id="4081577">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081582">ip</span><span class="op" id="4081584">[</span><span class="num" id="4081585">10</span><span class="op" id="4081587">]</span>&nbsp;<span class="op" id="4081589">==</span>&nbsp;<span class="num" id="4081592">0xff</span>&nbsp;<span class="op" id="4081597">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081602">ip</span><span class="op" id="4081604">[</span><span class="num" id="4081605">11</span><span class="op" id="4081607">]</span>&nbsp;<span class="op" id="4081609">==</span>&nbsp;<span class="num" id="4081612">0xff</span>&nbsp;<span class="op" id="4081617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081621">return</span>&nbsp;<span class="ident" id="4081628">ip</span><span class="op" id="4081630">[</span><span class="num" id="4081631">12</span><span class="op" id="4081633">:</span><span class="num" id="4081634">16</span><span class="op" id="4081636">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081639">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081642">return</span>&nbsp;<span class="ident" id="4081649">nil</span><br>
<span class="lineno"></span><span class="op" id="4081653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4081656">//&nbsp;To16&nbsp;converts&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;16-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="4081720">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IP&nbsp;address&nbsp;(it&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length),&nbsp;To16&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">195</span><span class="keyword" id="4081794">func</span>&nbsp;<span class="op" id="4081799">(</span><span class="ident" id="4081800">ip</span>&nbsp;<span class="ident" id="4081803">IP</span><span class="op" id="4081805">)</span>&nbsp;<span class="ident" id="4081807">To16</span><span class="op" id="4081811">(</span><span class="op" id="4081812">)</span>&nbsp;<span class="ident" id="4081814">IP</span>&nbsp;<span class="op" id="4081817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081820">if</span>&nbsp;<span class="builtinfunc" id="4081823">len</span><span class="op" id="4081826">(</span><span class="ident" id="4081827">ip</span><span class="op" id="4081829">)</span>&nbsp;<span class="op" id="4081831">==</span>&nbsp;<span class="ident" id="4081834">IPv4len</span>&nbsp;<span class="op" id="4081842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081846">return</span>&nbsp;<span class="ident" id="4081853">IPv4</span><span class="op" id="4081857">(</span><span class="ident" id="4081858">ip</span><span class="op" id="4081860">[</span><span class="num" id="4081861">0</span><span class="op" id="4081862">]</span><span class="op" id="4081863">,</span>&nbsp;<span class="ident" id="4081865">ip</span><span class="op" id="4081867">[</span><span class="num" id="4081868">1</span><span class="op" id="4081869">]</span><span class="op" id="4081870">,</span>&nbsp;<span class="ident" id="4081872">ip</span><span class="op" id="4081874">[</span><span class="num" id="4081875">2</span><span class="op" id="4081876">]</span><span class="op" id="4081877">,</span>&nbsp;<span class="ident" id="4081879">ip</span><span class="op" id="4081881">[</span><span class="num" id="4081882">3</span><span class="op" id="4081883">]</span><span class="op" id="4081884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081890">if</span>&nbsp;<span class="builtinfunc" id="4081893">len</span><span class="op" id="4081896">(</span><span class="ident" id="4081897">ip</span><span class="op" id="4081899">)</span>&nbsp;<span class="op" id="4081901">==</span>&nbsp;<span class="ident" id="4081904">IPv6len</span>&nbsp;<span class="op" id="4081912">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081916">return</span>&nbsp;<span class="ident" id="4081923">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081930">return</span>&nbsp;<span class="ident" id="4081937">nil</span><br>
<span class="lineno"></span><span class="op" id="4081941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="4081944">//&nbsp;Default&nbsp;route&nbsp;masks&nbsp;for&nbsp;IPv4.</span><br>
<span class="lineno"></span><span class="keyword" id="4081977">var</span>&nbsp;<span class="op" id="4081981">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4081984">classAMask</span>&nbsp;<span class="op" id="4081995">=</span>&nbsp;<span class="ident" id="4081997">IPv4Mask</span><span class="op" id="4082005">(</span><span class="num" id="4082006">0xff</span><span class="op" id="4082010">,</span>&nbsp;<span class="num" id="4082012">0</span><span class="op" id="4082013">,</span>&nbsp;<span class="num" id="4082015">0</span><span class="op" id="4082016">,</span>&nbsp;<span class="num" id="4082018">0</span><span class="op" id="4082019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082022">classBMask</span>&nbsp;<span class="op" id="4082033">=</span>&nbsp;<span class="ident" id="4082035">IPv4Mask</span><span class="op" id="4082043">(</span><span class="num" id="4082044">0xff</span><span class="op" id="4082048">,</span>&nbsp;<span class="num" id="4082050">0xff</span><span class="op" id="4082054">,</span>&nbsp;<span class="num" id="4082056">0</span><span class="op" id="4082057">,</span>&nbsp;<span class="num" id="4082059">0</span><span class="op" id="4082060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082063">classCMask</span>&nbsp;<span class="op" id="4082074">=</span>&nbsp;<span class="ident" id="4082076">IPv4Mask</span><span class="op" id="4082084">(</span><span class="num" id="4082085">0xff</span><span class="op" id="4082089">,</span>&nbsp;<span class="num" id="4082091">0xff</span><span class="op" id="4082095">,</span>&nbsp;<span class="num" id="4082097">0xff</span><span class="op" id="4082101">,</span>&nbsp;<span class="num" id="4082103">0</span><span class="op" id="4082104">)</span><br>
<span class="lineno">210</span><span class="op" id="4082106">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4082109">//&nbsp;DefaultMask&nbsp;returns&nbsp;the&nbsp;default&nbsp;IP&nbsp;mask&nbsp;for&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="4082175">//&nbsp;Only&nbsp;IPv4&nbsp;addresses&nbsp;have&nbsp;default&nbsp;masks;&nbsp;DefaultMask&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4082238">//&nbsp;nil&nbsp;if&nbsp;ip&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno">215</span><span class="keyword" id="4082280">func</span>&nbsp;<span class="op" id="4082285">(</span><span class="ident" id="4082286">ip</span>&nbsp;<span class="ident" id="4082289">IP</span><span class="op" id="4082291">)</span>&nbsp;<span class="ident" id="4082293">DefaultMask</span><span class="op" id="4082304">(</span><span class="op" id="4082305">)</span>&nbsp;<span class="ident" id="4082307">IPMask</span>&nbsp;<span class="op" id="4082314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082317">if</span>&nbsp;<span class="ident" id="4082320">ip</span>&nbsp;<span class="op" id="4082323">=</span>&nbsp;<span class="ident" id="4082325">ip</span><span class="op" id="4082327">.</span><span class="ident" id="4082328">To4</span><span class="op" id="4082331">(</span><span class="op" id="4082332">)</span><span class="op" id="4082333">;</span>&nbsp;<span class="ident" id="4082335">ip</span>&nbsp;<span class="op" id="4082338">==</span>&nbsp;<span class="ident" id="4082341">nil</span>&nbsp;<span class="op" id="4082345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082349">return</span>&nbsp;<span class="ident" id="4082356">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082364">switch</span>&nbsp;<span class="builtintype" id="4082371">true</span>&nbsp;<span class="op" id="4082376">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082379">case</span>&nbsp;<span class="ident" id="4082384">ip</span><span class="op" id="4082386">[</span><span class="num" id="4082387">0</span><span class="op" id="4082388">]</span>&nbsp;<span class="op" id="4082390">&lt;</span>&nbsp;<span class="num" id="4082392">0x80</span><span class="op" id="4082396">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082400">return</span>&nbsp;<span class="ident" id="4082407">classAMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082419">case</span>&nbsp;<span class="ident" id="4082424">ip</span><span class="op" id="4082426">[</span><span class="num" id="4082427">0</span><span class="op" id="4082428">]</span>&nbsp;<span class="op" id="4082430">&lt;</span>&nbsp;<span class="num" id="4082432">0xC0</span><span class="op" id="4082436">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082440">return</span>&nbsp;<span class="ident" id="4082447">classBMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082459">default</span><span class="op" id="4082466">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082470">return</span>&nbsp;<span class="ident" id="4082477">classCMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082489">}</span><br>
<span class="lineno"></span><span class="op" id="4082491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4082494">func</span>&nbsp;<span class="ident" id="4082499">allFF</span><span class="op" id="4082504">(</span><span class="ident" id="4082505">b</span>&nbsp;<span class="op" id="4082507">[</span><span class="op" id="4082508">]</span><span class="builtintype" id="4082509">byte</span><span class="op" id="4082513">)</span>&nbsp;<span class="builtintype" id="4082515">bool</span>&nbsp;<span class="op" id="4082520">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082523">for</span>&nbsp;<span class="ident" id="4082527">_</span><span class="op" id="4082528">,</span>&nbsp;<span class="ident" id="4082530">c</span>&nbsp;<span class="op" id="4082532">:=</span>&nbsp;<span class="keyword" id="4082535">range</span>&nbsp;<span class="ident" id="4082541">b</span>&nbsp;<span class="op" id="4082543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082547">if</span>&nbsp;<span class="ident" id="4082550">c</span>&nbsp;<span class="op" id="4082552">!=</span>&nbsp;<span class="num" id="4082555">0xff</span>&nbsp;<span class="op" id="4082560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082565">return</span>&nbsp;<span class="builtintype" id="4082572">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082583">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082586">return</span>&nbsp;<span class="builtintype" id="4082593">true</span><br>
<span class="lineno"></span><span class="op" id="4082598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4082601">//&nbsp;Mask&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;masking&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;with&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="4082668">func</span>&nbsp;<span class="op" id="4082673">(</span><span class="ident" id="4082674">ip</span>&nbsp;<span class="ident" id="4082677">IP</span><span class="op" id="4082679">)</span>&nbsp;<span class="ident" id="4082681">Mask</span><span class="op" id="4082685">(</span><span class="ident" id="4082686">mask</span>&nbsp;<span class="ident" id="4082691">IPMask</span><span class="op" id="4082697">)</span>&nbsp;<span class="ident" id="4082699">IP</span>&nbsp;<span class="op" id="4082702">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082705">if</span>&nbsp;<span class="builtinfunc" id="4082708">len</span><span class="op" id="4082711">(</span><span class="ident" id="4082712">mask</span><span class="op" id="4082716">)</span>&nbsp;<span class="op" id="4082718">==</span>&nbsp;<span class="ident" id="4082721">IPv6len</span>&nbsp;<span class="op" id="4082729">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4082732">len</span><span class="op" id="4082735">(</span><span class="ident" id="4082736">ip</span><span class="op" id="4082738">)</span>&nbsp;<span class="op" id="4082740">==</span>&nbsp;<span class="ident" id="4082743">IPv4len</span>&nbsp;<span class="op" id="4082751">&amp;&amp;</span>&nbsp;<span class="ident" id="4082754">allFF</span><span class="op" id="4082759">(</span><span class="ident" id="4082760">mask</span><span class="op" id="4082764">[</span><span class="op" id="4082765">:</span><span class="num" id="4082766">12</span><span class="op" id="4082768">]</span><span class="op" id="4082769">)</span>&nbsp;<span class="op" id="4082771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082775">mask</span>&nbsp;<span class="op" id="4082780">=</span>&nbsp;<span class="ident" id="4082782">mask</span><span class="op" id="4082786">[</span><span class="num" id="4082787">12</span><span class="op" id="4082789">:</span><span class="op" id="4082790">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082796">if</span>&nbsp;<span class="builtinfunc" id="4082799">len</span><span class="op" id="4082802">(</span><span class="ident" id="4082803">mask</span><span class="op" id="4082807">)</span>&nbsp;<span class="op" id="4082809">==</span>&nbsp;<span class="ident" id="4082812">IPv4len</span>&nbsp;<span class="op" id="4082820">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4082823">len</span><span class="op" id="4082826">(</span><span class="ident" id="4082827">ip</span><span class="op" id="4082829">)</span>&nbsp;<span class="op" id="4082831">==</span>&nbsp;<span class="ident" id="4082834">IPv6len</span>&nbsp;<span class="op" id="4082842">&amp;&amp;</span>&nbsp;<span class="ident" id="4082845">bytesEqual</span><span class="op" id="4082855">(</span><span class="ident" id="4082856">ip</span><span class="op" id="4082858">[</span><span class="op" id="4082859">:</span><span class="num" id="4082860">12</span><span class="op" id="4082862">]</span><span class="op" id="4082863">,</span>&nbsp;<span class="ident" id="4082865">v4InV6Prefix</span><span class="op" id="4082877">)</span>&nbsp;<span class="op" id="4082879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082883">ip</span>&nbsp;<span class="op" id="4082886">=</span>&nbsp;<span class="ident" id="4082888">ip</span><span class="op" id="4082890">[</span><span class="num" id="4082891">12</span><span class="op" id="4082893">:</span><span class="op" id="4082894">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082900">n</span>&nbsp;<span class="op" id="4082902">:=</span>&nbsp;<span class="builtinfunc" id="4082905">len</span><span class="op" id="4082908">(</span><span class="ident" id="4082909">ip</span><span class="op" id="4082911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082914">if</span>&nbsp;<span class="ident" id="4082917">n</span>&nbsp;<span class="op" id="4082919">!=</span>&nbsp;<span class="builtinfunc" id="4082922">len</span><span class="op" id="4082925">(</span><span class="ident" id="4082926">mask</span><span class="op" id="4082930">)</span>&nbsp;<span class="op" id="4082932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082936">return</span>&nbsp;<span class="ident" id="4082943">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082948">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082951">out</span>&nbsp;<span class="op" id="4082955">:=</span>&nbsp;<span class="builtinfunc" id="4082958">make</span><span class="op" id="4082962">(</span><span class="ident" id="4082963">IP</span><span class="op" id="4082965">,</span>&nbsp;<span class="ident" id="4082967">n</span><span class="op" id="4082968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082971">for</span>&nbsp;<span class="ident" id="4082975">i</span>&nbsp;<span class="op" id="4082977">:=</span>&nbsp;<span class="num" id="4082980">0</span><span class="op" id="4082981">;</span>&nbsp;<span class="ident" id="4082983">i</span>&nbsp;<span class="op" id="4082985">&lt;</span>&nbsp;<span class="ident" id="4082987">n</span><span class="op" id="4082988">;</span>&nbsp;<span class="ident" id="4082990">i</span><span class="op" id="4082991">++</span>&nbsp;<span class="op" id="4082994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082998">out</span><span class="op" id="4083001">[</span><span class="ident" id="4083002">i</span><span class="op" id="4083003">]</span>&nbsp;<span class="op" id="4083005">=</span>&nbsp;<span class="ident" id="4083007">ip</span><span class="op" id="4083009">[</span><span class="ident" id="4083010">i</span><span class="op" id="4083011">]</span>&nbsp;<span class="op" id="4083013">&amp;</span>&nbsp;<span class="ident" id="4083015">mask</span><span class="op" id="4083019">[</span><span class="ident" id="4083020">i</span><span class="op" id="4083021">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083027">return</span>&nbsp;<span class="ident" id="4083034">out</span><br>
<span class="lineno">255</span><span class="op" id="4083038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4083041">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="4083097">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;the&nbsp;string&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="4083161">//&nbsp;is&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;).&nbsp;&nbsp;Otherwise&nbsp;the&nbsp;representation</span><br>
<span class="lineno">260</span><span class="comment" id="4083230">//&nbsp;is&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;).</span><br>
<span class="lineno"></span><span class="keyword" id="4083267">func</span>&nbsp;<span class="op" id="4083272">(</span><span class="ident" id="4083273">ip</span>&nbsp;<span class="ident" id="4083276">IP</span><span class="op" id="4083278">)</span>&nbsp;<span class="ident" id="4083280">String</span><span class="op" id="4083286">(</span><span class="op" id="4083287">)</span>&nbsp;<span class="builtintype" id="4083289">string</span>&nbsp;<span class="op" id="4083296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083299">p</span>&nbsp;<span class="op" id="4083301">:=</span>&nbsp;<span class="ident" id="4083304">ip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083309">if</span>&nbsp;<span class="builtinfunc" id="4083312">len</span><span class="op" id="4083315">(</span><span class="ident" id="4083316">ip</span><span class="op" id="4083318">)</span>&nbsp;<span class="op" id="4083320">==</span>&nbsp;<span class="num" id="4083323">0</span>&nbsp;<span class="op" id="4083325">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083329">return</span>&nbsp;<span class="string" id="4083336">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083349">//&nbsp;If&nbsp;IPv4,&nbsp;use&nbsp;dotted&nbsp;notation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083383">if</span>&nbsp;<span class="ident" id="4083386">p4</span>&nbsp;<span class="op" id="4083389">:=</span>&nbsp;<span class="ident" id="4083392">p</span><span class="op" id="4083393">.</span><span class="ident" id="4083394">To4</span><span class="op" id="4083397">(</span><span class="op" id="4083398">)</span><span class="op" id="4083399">;</span>&nbsp;<span class="builtinfunc" id="4083401">len</span><span class="op" id="4083404">(</span><span class="ident" id="4083405">p4</span><span class="op" id="4083407">)</span>&nbsp;<span class="op" id="4083409">==</span>&nbsp;<span class="ident" id="4083412">IPv4len</span>&nbsp;<span class="op" id="4083420">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083424">return</span>&nbsp;<span class="ident" id="4083431">itod</span><span class="op" id="4083435">(</span><span class="builtintype" id="4083436">uint</span><span class="op" id="4083440">(</span><span class="ident" id="4083441">p4</span><span class="op" id="4083443">[</span><span class="num" id="4083444">0</span><span class="op" id="4083445">]</span><span class="op" id="4083446">)</span><span class="op" id="4083447">)</span>&nbsp;<span class="op" id="4083449">+</span>&nbsp;<span class="string" id="4083451">&#34;.&#34;</span>&nbsp;<span class="op" id="4083455">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083460">itod</span><span class="op" id="4083464">(</span><span class="builtintype" id="4083465">uint</span><span class="op" id="4083469">(</span><span class="ident" id="4083470">p4</span><span class="op" id="4083472">[</span><span class="num" id="4083473">1</span><span class="op" id="4083474">]</span><span class="op" id="4083475">)</span><span class="op" id="4083476">)</span>&nbsp;<span class="op" id="4083478">+</span>&nbsp;<span class="string" id="4083480">&#34;.&#34;</span>&nbsp;<span class="op" id="4083484">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083489">itod</span><span class="op" id="4083493">(</span><span class="builtintype" id="4083494">uint</span><span class="op" id="4083498">(</span><span class="ident" id="4083499">p4</span><span class="op" id="4083501">[</span><span class="num" id="4083502">2</span><span class="op" id="4083503">]</span><span class="op" id="4083504">)</span><span class="op" id="4083505">)</span>&nbsp;<span class="op" id="4083507">+</span>&nbsp;<span class="string" id="4083509">&#34;.&#34;</span>&nbsp;<span class="op" id="4083513">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083518">itod</span><span class="op" id="4083522">(</span><span class="builtintype" id="4083523">uint</span><span class="op" id="4083527">(</span><span class="ident" id="4083528">p4</span><span class="op" id="4083530">[</span><span class="num" id="4083531">3</span><span class="op" id="4083532">]</span><span class="op" id="4083533">)</span><span class="op" id="4083534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083537">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083540">if</span>&nbsp;<span class="builtinfunc" id="4083543">len</span><span class="op" id="4083546">(</span><span class="ident" id="4083547">p</span><span class="op" id="4083548">)</span>&nbsp;<span class="op" id="4083550">!=</span>&nbsp;<span class="ident" id="4083553">IPv6len</span>&nbsp;<span class="op" id="4083561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083565">return</span>&nbsp;<span class="string" id="4083572">&#34;?&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083581">//&nbsp;Find&nbsp;longest&nbsp;run&nbsp;of&nbsp;zeros.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083612">e0</span>&nbsp;<span class="op" id="4083615">:=</span>&nbsp;<span class="op" id="4083618">-</span><span class="num" id="4083619">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083622">e1</span>&nbsp;<span class="op" id="4083625">:=</span>&nbsp;<span class="op" id="4083628">-</span><span class="num" id="4083629">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083632">for</span>&nbsp;<span class="ident" id="4083636">i</span>&nbsp;<span class="op" id="4083638">:=</span>&nbsp;<span class="num" id="4083641">0</span><span class="op" id="4083642">;</span>&nbsp;<span class="ident" id="4083644">i</span>&nbsp;<span class="op" id="4083646">&lt;</span>&nbsp;<span class="ident" id="4083648">IPv6len</span><span class="op" id="4083655">;</span>&nbsp;<span class="ident" id="4083657">i</span>&nbsp;<span class="op" id="4083659">+=</span>&nbsp;<span class="num" id="4083662">2</span>&nbsp;<span class="op" id="4083664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083668">j</span>&nbsp;<span class="op" id="4083670">:=</span>&nbsp;<span class="ident" id="4083673">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083677">for</span>&nbsp;<span class="ident" id="4083681">j</span>&nbsp;<span class="op" id="4083683">&lt;</span>&nbsp;<span class="ident" id="4083685">IPv6len</span>&nbsp;<span class="op" id="4083693">&amp;&amp;</span>&nbsp;<span class="ident" id="4083696">p</span><span class="op" id="4083697">[</span><span class="ident" id="4083698">j</span><span class="op" id="4083699">]</span>&nbsp;<span class="op" id="4083701">==</span>&nbsp;<span class="num" id="4083704">0</span>&nbsp;<span class="op" id="4083706">&amp;&amp;</span>&nbsp;<span class="ident" id="4083709">p</span><span class="op" id="4083710">[</span><span class="ident" id="4083711">j</span><span class="op" id="4083712">+</span><span class="num" id="4083713">1</span><span class="op" id="4083714">]</span>&nbsp;<span class="op" id="4083716">==</span>&nbsp;<span class="num" id="4083719">0</span>&nbsp;<span class="op" id="4083721">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083726">j</span>&nbsp;<span class="op" id="4083728">+=</span>&nbsp;<span class="num" id="4083731">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083739">if</span>&nbsp;<span class="ident" id="4083742">j</span>&nbsp;<span class="op" id="4083744">&gt;</span>&nbsp;<span class="ident" id="4083746">i</span>&nbsp;<span class="op" id="4083748">&amp;&amp;</span>&nbsp;<span class="ident" id="4083751">j</span><span class="op" id="4083752">-</span><span class="ident" id="4083753">i</span>&nbsp;<span class="op" id="4083755">&gt;</span>&nbsp;<span class="ident" id="4083757">e1</span><span class="op" id="4083759">-</span><span class="ident" id="4083760">e0</span>&nbsp;<span class="op" id="4083763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083768">e0</span>&nbsp;<span class="op" id="4083771">=</span>&nbsp;<span class="ident" id="4083773">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083778">e1</span>&nbsp;<span class="op" id="4083781">=</span>&nbsp;<span class="ident" id="4083783">j</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083788">i</span>&nbsp;<span class="op" id="4083790">=</span>&nbsp;<span class="ident" id="4083792">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083802">//&nbsp;The&nbsp;symbol&nbsp;&#34;::&#34;&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;shorten&nbsp;just&nbsp;one&nbsp;16&nbsp;bit&nbsp;0&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083875">if</span>&nbsp;<span class="ident" id="4083878">e1</span><span class="op" id="4083880">-</span><span class="ident" id="4083881">e0</span>&nbsp;<span class="op" id="4083884">&lt;=</span>&nbsp;<span class="num" id="4083887">2</span>&nbsp;<span class="op" id="4083889">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083893">e0</span>&nbsp;<span class="op" id="4083896">=</span>&nbsp;<span class="op" id="4083898">-</span><span class="num" id="4083899">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083903">e1</span>&nbsp;<span class="op" id="4083906">=</span>&nbsp;<span class="op" id="4083908">-</span><span class="num" id="4083909">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083916">const</span>&nbsp;<span class="ident" id="4083922">maxLen</span>&nbsp;<span class="op" id="4083929">=</span>&nbsp;<span class="builtinfunc" id="4083931">len</span><span class="op" id="4083934">(</span><span class="string" id="4083935">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op" id="4083976">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083979">b</span>&nbsp;<span class="op" id="4083981">:=</span>&nbsp;<span class="builtinfunc" id="4083984">make</span><span class="op" id="4083988">(</span><span class="op" id="4083989">[</span><span class="op" id="4083990">]</span><span class="builtintype" id="4083991">byte</span><span class="op" id="4083995">,</span>&nbsp;<span class="num" id="4083997">0</span><span class="op" id="4083998">,</span>&nbsp;<span class="ident" id="4084000">maxLen</span><span class="op" id="4084006">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4084010">//&nbsp;Print&nbsp;with&nbsp;possible&nbsp;::&nbsp;in&nbsp;place&nbsp;of&nbsp;run&nbsp;of&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084062">for</span>&nbsp;<span class="ident" id="4084066">i</span>&nbsp;<span class="op" id="4084068">:=</span>&nbsp;<span class="num" id="4084071">0</span><span class="op" id="4084072">;</span>&nbsp;<span class="ident" id="4084074">i</span>&nbsp;<span class="op" id="4084076">&lt;</span>&nbsp;<span class="ident" id="4084078">IPv6len</span><span class="op" id="4084085">;</span>&nbsp;<span class="ident" id="4084087">i</span>&nbsp;<span class="op" id="4084089">+=</span>&nbsp;<span class="num" id="4084092">2</span>&nbsp;<span class="op" id="4084094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084098">if</span>&nbsp;<span class="ident" id="4084101">i</span>&nbsp;<span class="op" id="4084103">==</span>&nbsp;<span class="ident" id="4084106">e0</span>&nbsp;<span class="op" id="4084109">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084114">b</span>&nbsp;<span class="op" id="4084116">=</span>&nbsp;<span class="builtinfunc" id="4084118">append</span><span class="op" id="4084124">(</span><span class="ident" id="4084125">b</span><span class="op" id="4084126">,</span>&nbsp;<span class="string" id="4084128">&#39;:&#39;</span><span class="op" id="4084131">,</span>&nbsp;<span class="string" id="4084133">&#39;:&#39;</span><span class="op" id="4084136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084141">i</span>&nbsp;<span class="op" id="4084143">=</span>&nbsp;<span class="ident" id="4084145">e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084151">if</span>&nbsp;<span class="ident" id="4084154">i</span>&nbsp;<span class="op" id="4084156">&gt;=</span>&nbsp;<span class="ident" id="4084159">IPv6len</span>&nbsp;<span class="op" id="4084167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084173">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084182">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084186">}</span>&nbsp;<span class="keyword" id="4084188">else</span>&nbsp;<span class="keyword" id="4084193">if</span>&nbsp;<span class="ident" id="4084196">i</span>&nbsp;<span class="op" id="4084198">&gt;</span>&nbsp;<span class="num" id="4084200">0</span>&nbsp;<span class="op" id="4084202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084207">b</span>&nbsp;<span class="op" id="4084209">=</span>&nbsp;<span class="builtinfunc" id="4084211">append</span><span class="op" id="4084217">(</span><span class="ident" id="4084218">b</span><span class="op" id="4084219">,</span>&nbsp;<span class="string" id="4084221">&#39;:&#39;</span><span class="op" id="4084224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084232">b</span>&nbsp;<span class="op" id="4084234">=</span>&nbsp;<span class="ident" id="4084236">appendHex</span><span class="op" id="4084245">(</span><span class="ident" id="4084246">b</span><span class="op" id="4084247">,</span>&nbsp;<span class="op" id="4084249">(</span><span class="builtintype" id="4084250">uint32</span><span class="op" id="4084256">(</span><span class="ident" id="4084257">p</span><span class="op" id="4084258">[</span><span class="ident" id="4084259">i</span><span class="op" id="4084260">]</span><span class="op" id="4084261">)</span><span class="op" id="4084262">&lt;&lt;</span><span class="num" id="4084264">8</span><span class="op" id="4084265">)</span><span class="op" id="4084266">|</span><span class="builtintype" id="4084267">uint32</span><span class="op" id="4084273">(</span><span class="ident" id="4084274">p</span><span class="op" id="4084275">[</span><span class="ident" id="4084276">i</span><span class="op" id="4084277">+</span><span class="num" id="4084278">1</span><span class="op" id="4084279">]</span><span class="op" id="4084280">)</span><span class="op" id="4084281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084284">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084287">return</span>&nbsp;<span class="builtintype" id="4084294">string</span><span class="op" id="4084300">(</span><span class="ident" id="4084301">b</span><span class="op" id="4084302">)</span><br>
<span class="lineno"></span><span class="op" id="4084304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4084307">//&nbsp;ipEmptyString&nbsp;is&nbsp;like&nbsp;ip.String&nbsp;except&nbsp;that&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4084365">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;when&nbsp;ip&nbsp;is&nbsp;unset.</span><br>
<span class="lineno">320</span><span class="keyword" id="4084402">func</span>&nbsp;<span class="ident" id="4084407">ipEmptyString</span><span class="op" id="4084420">(</span><span class="ident" id="4084421">ip</span>&nbsp;<span class="ident" id="4084424">IP</span><span class="op" id="4084426">)</span>&nbsp;<span class="builtintype" id="4084428">string</span>&nbsp;<span class="op" id="4084435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084438">if</span>&nbsp;<span class="builtinfunc" id="4084441">len</span><span class="op" id="4084444">(</span><span class="ident" id="4084445">ip</span><span class="op" id="4084447">)</span>&nbsp;<span class="op" id="4084449">==</span>&nbsp;<span class="num" id="4084452">0</span>&nbsp;<span class="op" id="4084454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084458">return</span>&nbsp;<span class="string" id="4084465">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084472">return</span>&nbsp;<span class="ident" id="4084479">ip</span><span class="op" id="4084481">.</span><span class="ident" id="4084482">String</span><span class="op" id="4084488">(</span><span class="op" id="4084489">)</span><br>
<span class="lineno">325</span><span class="op" id="4084491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4084494">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="4084558">//&nbsp;The&nbsp;encoding&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;returned&nbsp;by&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword" id="4084609">func</span>&nbsp;<span class="op" id="4084614">(</span><span class="ident" id="4084615">ip</span>&nbsp;<span class="ident" id="4084618">IP</span><span class="op" id="4084620">)</span>&nbsp;<span class="ident" id="4084622">MarshalText</span><span class="op" id="4084633">(</span><span class="op" id="4084634">)</span>&nbsp;<span class="op" id="4084636">(</span><span class="op" id="4084637">[</span><span class="op" id="4084638">]</span><span class="builtintype" id="4084639">byte</span><span class="op" id="4084643">,</span>&nbsp;<span class="builtintype" id="4084645">error</span><span class="op" id="4084650">)</span>&nbsp;<span class="op" id="4084652">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084655">if</span>&nbsp;<span class="builtinfunc" id="4084658">len</span><span class="op" id="4084661">(</span><span class="ident" id="4084662">ip</span><span class="op" id="4084664">)</span>&nbsp;<span class="op" id="4084666">==</span>&nbsp;<span class="num" id="4084669">0</span>&nbsp;<span class="op" id="4084671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084675">return</span>&nbsp;<span class="op" id="4084682">[</span><span class="op" id="4084683">]</span><span class="builtintype" id="4084684">byte</span><span class="op" id="4084688">(</span><span class="string" id="4084689">&#34;&#34;</span><span class="op" id="4084691">)</span><span class="op" id="4084692">,</span>&nbsp;<span class="ident" id="4084694">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084702">if</span>&nbsp;<span class="builtinfunc" id="4084705">len</span><span class="op" id="4084708">(</span><span class="ident" id="4084709">ip</span><span class="op" id="4084711">)</span>&nbsp;<span class="op" id="4084713">!=</span>&nbsp;<span class="ident" id="4084716">IPv4len</span>&nbsp;<span class="op" id="4084724">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4084727">len</span><span class="op" id="4084730">(</span><span class="ident" id="4084731">ip</span><span class="op" id="4084733">)</span>&nbsp;<span class="op" id="4084735">!=</span>&nbsp;<span class="ident" id="4084738">IPv6len</span>&nbsp;<span class="op" id="4084746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084750">return</span>&nbsp;<span class="ident" id="4084757">nil</span><span class="op" id="4084760">,</span>&nbsp;<span class="ident" id="4084762">errors</span><span class="op" id="4084768">.</span><span class="ident" id="4084769">New</span><span class="op" id="4084772">(</span><span class="string" id="4084773">&#34;invalid&nbsp;IP&nbsp;address&#34;</span><span class="op" id="4084793">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084799">return</span>&nbsp;<span class="op" id="4084806">[</span><span class="op" id="4084807">]</span><span class="builtintype" id="4084808">byte</span><span class="op" id="4084812">(</span><span class="ident" id="4084813">ip</span><span class="op" id="4084815">.</span><span class="ident" id="4084816">String</span><span class="op" id="4084822">(</span><span class="op" id="4084823">)</span><span class="op" id="4084824">)</span><span class="op" id="4084825">,</span>&nbsp;<span class="ident" id="4084827">nil</span><br>
<span class="lineno"></span><span class="op" id="4084831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4084834">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno">340</span><span class="comment" id="4084902">//&nbsp;The&nbsp;IP&nbsp;address&nbsp;is&nbsp;expected&nbsp;in&nbsp;a&nbsp;form&nbsp;accepted&nbsp;by&nbsp;ParseIP.</span><br>
<span class="lineno"></span><span class="keyword" id="4084963">func</span>&nbsp;<span class="op" id="4084968">(</span><span class="ident" id="4084969">ip</span>&nbsp;<span class="op" id="4084972">*</span><span class="ident" id="4084973">IP</span><span class="op" id="4084975">)</span>&nbsp;<span class="ident" id="4084977">UnmarshalText</span><span class="op" id="4084990">(</span><span class="ident" id="4084991">text</span>&nbsp;<span class="op" id="4084996">[</span><span class="op" id="4084997">]</span><span class="builtintype" id="4084998">byte</span><span class="op" id="4085002">)</span>&nbsp;<span class="builtintype" id="4085004">error</span>&nbsp;<span class="op" id="4085010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085013">if</span>&nbsp;<span class="builtinfunc" id="4085016">len</span><span class="op" id="4085019">(</span><span class="ident" id="4085020">text</span><span class="op" id="4085024">)</span>&nbsp;<span class="op" id="4085026">==</span>&nbsp;<span class="num" id="4085029">0</span>&nbsp;<span class="op" id="4085031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085035">*</span><span class="ident" id="4085036">ip</span>&nbsp;<span class="op" id="4085039">=</span>&nbsp;<span class="ident" id="4085041">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085047">return</span>&nbsp;<span class="ident" id="4085054">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085062">s</span>&nbsp;<span class="op" id="4085064">:=</span>&nbsp;<span class="builtintype" id="4085067">string</span><span class="op" id="4085073">(</span><span class="ident" id="4085074">text</span><span class="op" id="4085078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085081">x</span>&nbsp;<span class="op" id="4085083">:=</span>&nbsp;<span class="ident" id="4085086">ParseIP</span><span class="op" id="4085093">(</span><span class="ident" id="4085094">s</span><span class="op" id="4085095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085098">if</span>&nbsp;<span class="ident" id="4085101">x</span>&nbsp;<span class="op" id="4085103">==</span>&nbsp;<span class="ident" id="4085106">nil</span>&nbsp;<span class="op" id="4085110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085114">return</span>&nbsp;<span class="op" id="4085121">&amp;</span><span class="ident" id="4085122">ParseError</span><span class="op" id="4085132">{</span><span class="string" id="4085133">&#34;IP&nbsp;address&#34;</span><span class="op" id="4085145">,</span>&nbsp;<span class="ident" id="4085147">s</span><span class="op" id="4085148">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085154">*</span><span class="ident" id="4085155">ip</span>&nbsp;<span class="op" id="4085158">=</span>&nbsp;<span class="ident" id="4085160">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085163">return</span>&nbsp;<span class="ident" id="4085170">nil</span><br>
<span class="lineno"></span><span class="op" id="4085174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4085177">//&nbsp;Equal&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;and&nbsp;x&nbsp;are&nbsp;the&nbsp;same&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="4085236">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;and&nbsp;that&nbsp;same&nbsp;address&nbsp;in&nbsp;IPv6&nbsp;form&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4085294">//&nbsp;considered&nbsp;to&nbsp;be&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="4085321">func</span>&nbsp;<span class="op" id="4085326">(</span><span class="ident" id="4085327">ip</span>&nbsp;<span class="ident" id="4085330">IP</span><span class="op" id="4085332">)</span>&nbsp;<span class="ident" id="4085334">Equal</span><span class="op" id="4085339">(</span><span class="ident" id="4085340">x</span>&nbsp;<span class="ident" id="4085342">IP</span><span class="op" id="4085344">)</span>&nbsp;<span class="builtintype" id="4085346">bool</span>&nbsp;<span class="op" id="4085351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085354">if</span>&nbsp;<span class="builtinfunc" id="4085357">len</span><span class="op" id="4085360">(</span><span class="ident" id="4085361">ip</span><span class="op" id="4085363">)</span>&nbsp;<span class="op" id="4085365">==</span>&nbsp;<span class="builtinfunc" id="4085368">len</span><span class="op" id="4085371">(</span><span class="ident" id="4085372">x</span><span class="op" id="4085373">)</span>&nbsp;<span class="op" id="4085375">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085379">return</span>&nbsp;<span class="ident" id="4085386">bytesEqual</span><span class="op" id="4085396">(</span><span class="ident" id="4085397">ip</span><span class="op" id="4085399">,</span>&nbsp;<span class="ident" id="4085401">x</span><span class="op" id="4085402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085408">if</span>&nbsp;<span class="builtinfunc" id="4085411">len</span><span class="op" id="4085414">(</span><span class="ident" id="4085415">ip</span><span class="op" id="4085417">)</span>&nbsp;<span class="op" id="4085419">==</span>&nbsp;<span class="ident" id="4085422">IPv4len</span>&nbsp;<span class="op" id="4085430">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4085433">len</span><span class="op" id="4085436">(</span><span class="ident" id="4085437">x</span><span class="op" id="4085438">)</span>&nbsp;<span class="op" id="4085440">==</span>&nbsp;<span class="ident" id="4085443">IPv6len</span>&nbsp;<span class="op" id="4085451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085455">return</span>&nbsp;<span class="ident" id="4085462">bytesEqual</span><span class="op" id="4085472">(</span><span class="ident" id="4085473">x</span><span class="op" id="4085474">[</span><span class="num" id="4085475">0</span><span class="op" id="4085476">:</span><span class="num" id="4085477">12</span><span class="op" id="4085479">]</span><span class="op" id="4085480">,</span>&nbsp;<span class="ident" id="4085482">v4InV6Prefix</span><span class="op" id="4085494">)</span>&nbsp;<span class="op" id="4085496">&amp;&amp;</span>&nbsp;<span class="ident" id="4085499">bytesEqual</span><span class="op" id="4085509">(</span><span class="ident" id="4085510">ip</span><span class="op" id="4085512">,</span>&nbsp;<span class="ident" id="4085514">x</span><span class="op" id="4085515">[</span><span class="num" id="4085516">12</span><span class="op" id="4085518">:</span><span class="op" id="4085519">]</span><span class="op" id="4085520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085523">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085526">if</span>&nbsp;<span class="builtinfunc" id="4085529">len</span><span class="op" id="4085532">(</span><span class="ident" id="4085533">ip</span><span class="op" id="4085535">)</span>&nbsp;<span class="op" id="4085537">==</span>&nbsp;<span class="ident" id="4085540">IPv6len</span>&nbsp;<span class="op" id="4085548">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4085551">len</span><span class="op" id="4085554">(</span><span class="ident" id="4085555">x</span><span class="op" id="4085556">)</span>&nbsp;<span class="op" id="4085558">==</span>&nbsp;<span class="ident" id="4085561">IPv4len</span>&nbsp;<span class="op" id="4085569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085573">return</span>&nbsp;<span class="ident" id="4085580">bytesEqual</span><span class="op" id="4085590">(</span><span class="ident" id="4085591">ip</span><span class="op" id="4085593">[</span><span class="num" id="4085594">0</span><span class="op" id="4085595">:</span><span class="num" id="4085596">12</span><span class="op" id="4085598">]</span><span class="op" id="4085599">,</span>&nbsp;<span class="ident" id="4085601">v4InV6Prefix</span><span class="op" id="4085613">)</span>&nbsp;<span class="op" id="4085615">&amp;&amp;</span>&nbsp;<span class="ident" id="4085618">bytesEqual</span><span class="op" id="4085628">(</span><span class="ident" id="4085629">ip</span><span class="op" id="4085631">[</span><span class="num" id="4085632">12</span><span class="op" id="4085634">:</span><span class="op" id="4085635">]</span><span class="op" id="4085636">,</span>&nbsp;<span class="ident" id="4085638">x</span><span class="op" id="4085639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085645">return</span>&nbsp;<span class="builtintype" id="4085652">false</span><br>
<span class="lineno"></span><span class="op" id="4085658">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="keyword" id="4085661">func</span>&nbsp;<span class="ident" id="4085666">bytesEqual</span><span class="op" id="4085676">(</span><span class="ident" id="4085677">x</span><span class="op" id="4085678">,</span>&nbsp;<span class="ident" id="4085680">y</span>&nbsp;<span class="op" id="4085682">[</span><span class="op" id="4085683">]</span><span class="builtintype" id="4085684">byte</span><span class="op" id="4085688">)</span>&nbsp;<span class="builtintype" id="4085690">bool</span>&nbsp;<span class="op" id="4085695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085698">if</span>&nbsp;<span class="builtinfunc" id="4085701">len</span><span class="op" id="4085704">(</span><span class="ident" id="4085705">x</span><span class="op" id="4085706">)</span>&nbsp;<span class="op" id="4085708">!=</span>&nbsp;<span class="builtinfunc" id="4085711">len</span><span class="op" id="4085714">(</span><span class="ident" id="4085715">y</span><span class="op" id="4085716">)</span>&nbsp;<span class="op" id="4085718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085722">return</span>&nbsp;<span class="builtintype" id="4085729">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085736">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085739">for</span>&nbsp;<span class="ident" id="4085743">i</span><span class="op" id="4085744">,</span>&nbsp;<span class="ident" id="4085746">b</span>&nbsp;<span class="op" id="4085748">:=</span>&nbsp;<span class="keyword" id="4085751">range</span>&nbsp;<span class="ident" id="4085757">x</span>&nbsp;<span class="op" id="4085759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085763">if</span>&nbsp;<span class="ident" id="4085766">y</span><span class="op" id="4085767">[</span><span class="ident" id="4085768">i</span><span class="op" id="4085769">]</span>&nbsp;<span class="op" id="4085771">!=</span>&nbsp;<span class="ident" id="4085774">b</span>&nbsp;<span class="op" id="4085776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085781">return</span>&nbsp;<span class="builtintype" id="4085788">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085799">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085802">return</span>&nbsp;<span class="builtintype" id="4085809">true</span><br>
<span class="lineno"></span><span class="op" id="4085814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4085817">//&nbsp;If&nbsp;mask&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;1&nbsp;bits&nbsp;followed&nbsp;by&nbsp;0&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="4085872">//&nbsp;return&nbsp;the&nbsp;number&nbsp;of&nbsp;1&nbsp;bits.</span><br>
<span class="lineno">385</span><span class="keyword" id="4085904">func</span>&nbsp;<span class="ident" id="4085909">simpleMaskLength</span><span class="op" id="4085925">(</span><span class="ident" id="4085926">mask</span>&nbsp;<span class="ident" id="4085931">IPMask</span><span class="op" id="4085937">)</span>&nbsp;<span class="builtintype" id="4085939">int</span>&nbsp;<span class="op" id="4085943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085946">var</span>&nbsp;<span class="ident" id="4085950">n</span>&nbsp;<span class="builtintype" id="4085952">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085957">for</span>&nbsp;<span class="ident" id="4085961">i</span><span class="op" id="4085962">,</span>&nbsp;<span class="ident" id="4085964">v</span>&nbsp;<span class="op" id="4085966">:=</span>&nbsp;<span class="keyword" id="4085969">range</span>&nbsp;<span class="ident" id="4085975">mask</span>&nbsp;<span class="op" id="4085980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085984">if</span>&nbsp;<span class="ident" id="4085987">v</span>&nbsp;<span class="op" id="4085989">==</span>&nbsp;<span class="num" id="4085992">0xff</span>&nbsp;<span class="op" id="4085997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086002">n</span>&nbsp;<span class="op" id="4086004">+=</span>&nbsp;<span class="num" id="4086007">8</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086012">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4086027">//&nbsp;found&nbsp;non-ff&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4086050">//&nbsp;count&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086068">for</span>&nbsp;<span class="ident" id="4086072">v</span><span class="op" id="4086073">&amp;</span><span class="num" id="4086074">0x80</span>&nbsp;<span class="op" id="4086079">!=</span>&nbsp;<span class="num" id="4086082">0</span>&nbsp;<span class="op" id="4086084">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086089">n</span><span class="op" id="4086090">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086096">v</span>&nbsp;<span class="op" id="4086098">&lt;&lt;=</span>&nbsp;<span class="num" id="4086102">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4086110">//&nbsp;rest&nbsp;must&nbsp;be&nbsp;0&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086135">if</span>&nbsp;<span class="ident" id="4086138">v</span>&nbsp;<span class="op" id="4086140">!=</span>&nbsp;<span class="num" id="4086143">0</span>&nbsp;<span class="op" id="4086145">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086150">return</span>&nbsp;<span class="op" id="4086157">-</span><span class="num" id="4086158">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086166">for</span>&nbsp;<span class="ident" id="4086170">i</span><span class="op" id="4086171">++</span><span class="op" id="4086173">;</span>&nbsp;<span class="ident" id="4086175">i</span>&nbsp;<span class="op" id="4086177">&lt;</span>&nbsp;<span class="builtinfunc" id="4086179">len</span><span class="op" id="4086182">(</span><span class="ident" id="4086183">mask</span><span class="op" id="4086187">)</span><span class="op" id="4086188">;</span>&nbsp;<span class="ident" id="4086190">i</span><span class="op" id="4086191">++</span>&nbsp;<span class="op" id="4086194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086199">if</span>&nbsp;<span class="ident" id="4086202">mask</span><span class="op" id="4086206">[</span><span class="ident" id="4086207">i</span><span class="op" id="4086208">]</span>&nbsp;<span class="op" id="4086210">!=</span>&nbsp;<span class="num" id="4086213">0</span>&nbsp;<span class="op" id="4086215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086221">return</span>&nbsp;<span class="op" id="4086228">-</span><span class="num" id="4086229">1</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086242">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086252">return</span>&nbsp;<span class="ident" id="4086259">n</span><br>
<span class="lineno">410</span><span class="op" id="4086261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4086264">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;ones&nbsp;and&nbsp;total&nbsp;bits&nbsp;in&nbsp;the&nbsp;mask.</span><br>
<span class="lineno"></span><span class="comment" id="4086335">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form--ones&nbsp;followed&nbsp;by&nbsp;zeros--then</span><br>
<span class="lineno"></span><span class="comment" id="4086409">//&nbsp;Size&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">415</span><span class="keyword" id="4086431">func</span>&nbsp;<span class="op" id="4086436">(</span><span class="ident" id="4086437">m</span>&nbsp;<span class="ident" id="4086439">IPMask</span><span class="op" id="4086445">)</span>&nbsp;<span class="ident" id="4086447">Size</span><span class="op" id="4086451">(</span><span class="op" id="4086452">)</span>&nbsp;<span class="op" id="4086454">(</span><span class="ident" id="4086455">ones</span><span class="op" id="4086459">,</span>&nbsp;<span class="ident" id="4086461">bits</span>&nbsp;<span class="builtintype" id="4086466">int</span><span class="op" id="4086469">)</span>&nbsp;<span class="op" id="4086471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086474">ones</span><span class="op" id="4086478">,</span>&nbsp;<span class="ident" id="4086480">bits</span>&nbsp;<span class="op" id="4086485">=</span>&nbsp;<span class="ident" id="4086487">simpleMaskLength</span><span class="op" id="4086503">(</span><span class="ident" id="4086504">m</span><span class="op" id="4086505">)</span><span class="op" id="4086506">,</span>&nbsp;<span class="builtinfunc" id="4086508">len</span><span class="op" id="4086511">(</span><span class="ident" id="4086512">m</span><span class="op" id="4086513">)</span><span class="op" id="4086514">*</span><span class="num" id="4086515">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086518">if</span>&nbsp;<span class="ident" id="4086521">ones</span>&nbsp;<span class="op" id="4086526">==</span>&nbsp;<span class="op" id="4086529">-</span><span class="num" id="4086530">1</span>&nbsp;<span class="op" id="4086532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086536">return</span>&nbsp;<span class="num" id="4086543">0</span><span class="op" id="4086544">,</span>&nbsp;<span class="num" id="4086546">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086549">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086552">return</span><br>
<span class="lineno"></span><span class="op" id="4086559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4086562">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;hexadecimal&nbsp;form&nbsp;of&nbsp;m,&nbsp;with&nbsp;no&nbsp;punctuation.</span><br>
<span class="lineno"></span><span class="keyword" id="4086628">func</span>&nbsp;<span class="op" id="4086633">(</span><span class="ident" id="4086634">m</span>&nbsp;<span class="ident" id="4086636">IPMask</span><span class="op" id="4086642">)</span>&nbsp;<span class="ident" id="4086644">String</span><span class="op" id="4086650">(</span><span class="op" id="4086651">)</span>&nbsp;<span class="builtintype" id="4086653">string</span>&nbsp;<span class="op" id="4086660">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086663">if</span>&nbsp;<span class="builtinfunc" id="4086666">len</span><span class="op" id="4086669">(</span><span class="ident" id="4086670">m</span><span class="op" id="4086671">)</span>&nbsp;<span class="op" id="4086673">==</span>&nbsp;<span class="num" id="4086676">0</span>&nbsp;<span class="op" id="4086678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086682">return</span>&nbsp;<span class="string" id="4086689">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086701">buf</span>&nbsp;<span class="op" id="4086705">:=</span>&nbsp;<span class="builtinfunc" id="4086708">make</span><span class="op" id="4086712">(</span><span class="op" id="4086713">[</span><span class="op" id="4086714">]</span><span class="builtintype" id="4086715">byte</span><span class="op" id="4086719">,</span>&nbsp;<span class="builtinfunc" id="4086721">len</span><span class="op" id="4086724">(</span><span class="ident" id="4086725">m</span><span class="op" id="4086726">)</span><span class="op" id="4086727">*</span><span class="num" id="4086728">2</span><span class="op" id="4086729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086732">for</span>&nbsp;<span class="ident" id="4086736">i</span><span class="op" id="4086737">,</span>&nbsp;<span class="ident" id="4086739">b</span>&nbsp;<span class="op" id="4086741">:=</span>&nbsp;<span class="keyword" id="4086744">range</span>&nbsp;<span class="ident" id="4086750">m</span>&nbsp;<span class="op" id="4086752">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086756">buf</span><span class="op" id="4086759">[</span><span class="ident" id="4086760">i</span><span class="op" id="4086761">*</span><span class="num" id="4086762">2</span><span class="op" id="4086763">]</span><span class="op" id="4086764">,</span>&nbsp;<span class="ident" id="4086766">buf</span><span class="op" id="4086769">[</span><span class="ident" id="4086770">i</span><span class="op" id="4086771">*</span><span class="num" id="4086772">2</span><span class="op" id="4086773">+</span><span class="num" id="4086774">1</span><span class="op" id="4086775">]</span>&nbsp;<span class="op" id="4086777">=</span>&nbsp;<span class="ident" id="4086779">hexDigit</span><span class="op" id="4086787">[</span><span class="ident" id="4086788">b</span><span class="op" id="4086789">&gt;&gt;</span><span class="num" id="4086791">4</span><span class="op" id="4086792">]</span><span class="op" id="4086793">,</span>&nbsp;<span class="ident" id="4086795">hexDigit</span><span class="op" id="4086803">[</span><span class="ident" id="4086804">b</span><span class="op" id="4086805">&amp;</span><span class="num" id="4086806">0xf</span><span class="op" id="4086809">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086815">return</span>&nbsp;<span class="builtintype" id="4086822">string</span><span class="op" id="4086828">(</span><span class="ident" id="4086829">buf</span><span class="op" id="4086832">)</span><br>
<span class="lineno"></span><span class="op" id="4086834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="4086837">func</span>&nbsp;<span class="ident" id="4086842">networkNumberAndMask</span><span class="op" id="4086862">(</span><span class="ident" id="4086863">n</span>&nbsp;<span class="op" id="4086865">*</span><span class="ident" id="4086866">IPNet</span><span class="op" id="4086871">)</span>&nbsp;<span class="op" id="4086873">(</span><span class="ident" id="4086874">ip</span>&nbsp;<span class="ident" id="4086877">IP</span><span class="op" id="4086879">,</span>&nbsp;<span class="ident" id="4086881">m</span>&nbsp;<span class="ident" id="4086883">IPMask</span><span class="op" id="4086889">)</span>&nbsp;<span class="op" id="4086891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086894">if</span>&nbsp;<span class="ident" id="4086897">ip</span>&nbsp;<span class="op" id="4086900">=</span>&nbsp;<span class="ident" id="4086902">n</span><span class="op" id="4086903">.</span><span class="ident" id="4086904">IP</span><span class="op" id="4086906">.</span><span class="ident" id="4086907">To4</span><span class="op" id="4086910">(</span><span class="op" id="4086911">)</span><span class="op" id="4086912">;</span>&nbsp;<span class="ident" id="4086914">ip</span>&nbsp;<span class="op" id="4086917">==</span>&nbsp;<span class="ident" id="4086920">nil</span>&nbsp;<span class="op" id="4086924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086928">ip</span>&nbsp;<span class="op" id="4086931">=</span>&nbsp;<span class="ident" id="4086933">n</span><span class="op" id="4086934">.</span><span class="ident" id="4086935">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086940">if</span>&nbsp;<span class="builtinfunc" id="4086943">len</span><span class="op" id="4086946">(</span><span class="ident" id="4086947">ip</span><span class="op" id="4086949">)</span>&nbsp;<span class="op" id="4086951">!=</span>&nbsp;<span class="ident" id="4086954">IPv6len</span>&nbsp;<span class="op" id="4086962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086967">return</span>&nbsp;<span class="ident" id="4086974">nil</span><span class="op" id="4086977">,</span>&nbsp;<span class="ident" id="4086979">nil</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086991">m</span>&nbsp;<span class="op" id="4086993">=</span>&nbsp;<span class="ident" id="4086995">n</span><span class="op" id="4086996">.</span><span class="ident" id="4086997">Mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087003">switch</span>&nbsp;<span class="builtinfunc" id="4087010">len</span><span class="op" id="4087013">(</span><span class="ident" id="4087014">m</span><span class="op" id="4087015">)</span>&nbsp;<span class="op" id="4087017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087020">case</span>&nbsp;<span class="ident" id="4087025">IPv4len</span><span class="op" id="4087032">:</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087036">if</span>&nbsp;<span class="builtinfunc" id="4087039">len</span><span class="op" id="4087042">(</span><span class="ident" id="4087043">ip</span><span class="op" id="4087045">)</span>&nbsp;<span class="op" id="4087047">!=</span>&nbsp;<span class="ident" id="4087050">IPv4len</span>&nbsp;<span class="op" id="4087058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087063">return</span>&nbsp;<span class="ident" id="4087070">nil</span><span class="op" id="4087073">,</span>&nbsp;<span class="ident" id="4087075">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087084">case</span>&nbsp;<span class="ident" id="4087089">IPv6len</span><span class="op" id="4087096">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087100">if</span>&nbsp;<span class="builtinfunc" id="4087103">len</span><span class="op" id="4087106">(</span><span class="ident" id="4087107">ip</span><span class="op" id="4087109">)</span>&nbsp;<span class="op" id="4087111">==</span>&nbsp;<span class="ident" id="4087114">IPv4len</span>&nbsp;<span class="op" id="4087122">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087127">m</span>&nbsp;<span class="op" id="4087129">=</span>&nbsp;<span class="ident" id="4087131">m</span><span class="op" id="4087132">[</span><span class="num" id="4087133">12</span><span class="op" id="4087135">:</span><span class="op" id="4087136">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087143">default</span><span class="op" id="4087150">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087154">return</span>&nbsp;<span class="ident" id="4087161">nil</span><span class="op" id="4087164">,</span>&nbsp;<span class="ident" id="4087166">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087171">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087174">return</span><br>
<span class="lineno"></span><span class="op" id="4087181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4087184">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;network&nbsp;includes&nbsp;ip.</span><br>
<span class="lineno"></span><span class="keyword" id="4087237">func</span>&nbsp;<span class="op" id="4087242">(</span><span class="ident" id="4087243">n</span>&nbsp;<span class="op" id="4087245">*</span><span class="ident" id="4087246">IPNet</span><span class="op" id="4087251">)</span>&nbsp;<span class="ident" id="4087253">Contains</span><span class="op" id="4087261">(</span><span class="ident" id="4087262">ip</span>&nbsp;<span class="ident" id="4087265">IP</span><span class="op" id="4087267">)</span>&nbsp;<span class="builtintype" id="4087269">bool</span>&nbsp;<span class="op" id="4087274">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087277">nn</span><span class="op" id="4087279">,</span>&nbsp;<span class="ident" id="4087281">m</span>&nbsp;<span class="op" id="4087283">:=</span>&nbsp;<span class="ident" id="4087286">networkNumberAndMask</span><span class="op" id="4087306">(</span><span class="ident" id="4087307">n</span><span class="op" id="4087308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087311">if</span>&nbsp;<span class="ident" id="4087314">x</span>&nbsp;<span class="op" id="4087316">:=</span>&nbsp;<span class="ident" id="4087319">ip</span><span class="op" id="4087321">.</span><span class="ident" id="4087322">To4</span><span class="op" id="4087325">(</span><span class="op" id="4087326">)</span><span class="op" id="4087327">;</span>&nbsp;<span class="ident" id="4087329">x</span>&nbsp;<span class="op" id="4087331">!=</span>&nbsp;<span class="ident" id="4087334">nil</span>&nbsp;<span class="op" id="4087338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087342">ip</span>&nbsp;<span class="op" id="4087345">=</span>&nbsp;<span class="ident" id="4087347">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087353">l</span>&nbsp;<span class="op" id="4087355">:=</span>&nbsp;<span class="builtinfunc" id="4087358">len</span><span class="op" id="4087361">(</span><span class="ident" id="4087362">ip</span><span class="op" id="4087364">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087367">if</span>&nbsp;<span class="ident" id="4087370">l</span>&nbsp;<span class="op" id="4087372">!=</span>&nbsp;<span class="builtinfunc" id="4087375">len</span><span class="op" id="4087378">(</span><span class="ident" id="4087379">nn</span><span class="op" id="4087381">)</span>&nbsp;<span class="op" id="4087383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087387">return</span>&nbsp;<span class="builtintype" id="4087394">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087404">for</span>&nbsp;<span class="ident" id="4087408">i</span>&nbsp;<span class="op" id="4087410">:=</span>&nbsp;<span class="num" id="4087413">0</span><span class="op" id="4087414">;</span>&nbsp;<span class="ident" id="4087416">i</span>&nbsp;<span class="op" id="4087418">&lt;</span>&nbsp;<span class="ident" id="4087420">l</span><span class="op" id="4087421">;</span>&nbsp;<span class="ident" id="4087423">i</span><span class="op" id="4087424">++</span>&nbsp;<span class="op" id="4087427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087431">if</span>&nbsp;<span class="ident" id="4087434">nn</span><span class="op" id="4087436">[</span><span class="ident" id="4087437">i</span><span class="op" id="4087438">]</span><span class="op" id="4087439">&amp;</span><span class="ident" id="4087440">m</span><span class="op" id="4087441">[</span><span class="ident" id="4087442">i</span><span class="op" id="4087443">]</span>&nbsp;<span class="op" id="4087445">!=</span>&nbsp;<span class="ident" id="4087448">ip</span><span class="op" id="4087450">[</span><span class="ident" id="4087451">i</span><span class="op" id="4087452">]</span><span class="op" id="4087453">&amp;</span><span class="ident" id="4087454">m</span><span class="op" id="4087455">[</span><span class="ident" id="4087456">i</span><span class="op" id="4087457">]</span>&nbsp;<span class="op" id="4087459">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087464">return</span>&nbsp;<span class="builtintype" id="4087471">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087485">return</span>&nbsp;<span class="builtintype" id="4087492">true</span><br>
<span class="lineno"></span><span class="op" id="4087497">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="4087500">//&nbsp;Network&nbsp;returns&nbsp;the&nbsp;address&#39;s&nbsp;network&nbsp;name,&nbsp;&#34;ip+net&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4087557">func</span>&nbsp;<span class="op" id="4087562">(</span><span class="ident" id="4087563">n</span>&nbsp;<span class="op" id="4087565">*</span><span class="ident" id="4087566">IPNet</span><span class="op" id="4087571">)</span>&nbsp;<span class="ident" id="4087573">Network</span><span class="op" id="4087580">(</span><span class="op" id="4087581">)</span>&nbsp;<span class="builtintype" id="4087583">string</span>&nbsp;<span class="op" id="4087590">{</span>&nbsp;<span class="keyword" id="4087592">return</span>&nbsp;<span class="string" id="4087599">&#34;ip+net&#34;</span>&nbsp;<span class="op" id="4087608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4087611">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;CIDR&nbsp;notation&nbsp;of&nbsp;n&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;</span><br>
<span class="lineno">480</span><span class="comment" id="4087676">//&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="4087735">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form,&nbsp;it&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4087795">//&nbsp;string&nbsp;which&nbsp;consists&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,&nbsp;followed&nbsp;by&nbsp;a&nbsp;slash</span><br>
<span class="lineno"></span><span class="comment" id="4087858">//&nbsp;character&nbsp;and&nbsp;a&nbsp;mask&nbsp;expressed&nbsp;as&nbsp;hexadecimal&nbsp;form&nbsp;with&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="4087920">//&nbsp;punctuation&nbsp;like&nbsp;&#34;192.168.100.1/c000ff00&#34;.</span><br>
<span class="lineno">485</span><span class="keyword" id="4087966">func</span>&nbsp;<span class="op" id="4087971">(</span><span class="ident" id="4087972">n</span>&nbsp;<span class="op" id="4087974">*</span><span class="ident" id="4087975">IPNet</span><span class="op" id="4087980">)</span>&nbsp;<span class="ident" id="4087982">String</span><span class="op" id="4087988">(</span><span class="op" id="4087989">)</span>&nbsp;<span class="builtintype" id="4087991">string</span>&nbsp;<span class="op" id="4087998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088001">nn</span><span class="op" id="4088003">,</span>&nbsp;<span class="ident" id="4088005">m</span>&nbsp;<span class="op" id="4088007">:=</span>&nbsp;<span class="ident" id="4088010">networkNumberAndMask</span><span class="op" id="4088030">(</span><span class="ident" id="4088031">n</span><span class="op" id="4088032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088035">if</span>&nbsp;<span class="ident" id="4088038">nn</span>&nbsp;<span class="op" id="4088041">==</span>&nbsp;<span class="ident" id="4088044">nil</span>&nbsp;<span class="op" id="4088048">||</span>&nbsp;<span class="ident" id="4088051">m</span>&nbsp;<span class="op" id="4088053">==</span>&nbsp;<span class="ident" id="4088056">nil</span>&nbsp;<span class="op" id="4088060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088064">return</span>&nbsp;<span class="string" id="4088071">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088080">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088083">l</span>&nbsp;<span class="op" id="4088085">:=</span>&nbsp;<span class="ident" id="4088088">simpleMaskLength</span><span class="op" id="4088104">(</span><span class="ident" id="4088105">m</span><span class="op" id="4088106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088109">if</span>&nbsp;<span class="ident" id="4088112">l</span>&nbsp;<span class="op" id="4088114">==</span>&nbsp;<span class="op" id="4088117">-</span><span class="num" id="4088118">1</span>&nbsp;<span class="op" id="4088120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088124">return</span>&nbsp;<span class="ident" id="4088131">nn</span><span class="op" id="4088133">.</span><span class="ident" id="4088134">String</span><span class="op" id="4088140">(</span><span class="op" id="4088141">)</span>&nbsp;<span class="op" id="4088143">+</span>&nbsp;<span class="string" id="4088145">&#34;/&#34;</span>&nbsp;<span class="op" id="4088149">+</span>&nbsp;<span class="ident" id="4088151">m</span><span class="op" id="4088152">.</span><span class="ident" id="4088153">String</span><span class="op" id="4088159">(</span><span class="op" id="4088160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088166">return</span>&nbsp;<span class="ident" id="4088173">nn</span><span class="op" id="4088175">.</span><span class="ident" id="4088176">String</span><span class="op" id="4088182">(</span><span class="op" id="4088183">)</span>&nbsp;<span class="op" id="4088185">+</span>&nbsp;<span class="string" id="4088187">&#34;/&#34;</span>&nbsp;<span class="op" id="4088191">+</span>&nbsp;<span class="ident" id="4088193">itod</span><span class="op" id="4088197">(</span><span class="builtintype" id="4088198">uint</span><span class="op" id="4088202">(</span><span class="ident" id="4088203">l</span><span class="op" id="4088204">)</span><span class="op" id="4088205">)</span><br>
<span class="lineno">495</span><span class="op" id="4088207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4088210">//&nbsp;Parse&nbsp;IPv4&nbsp;address&nbsp;(d.d.d.d).</span><br>
<span class="lineno"></span><span class="keyword" id="4088243">func</span>&nbsp;<span class="ident" id="4088248">parseIPv4</span><span class="op" id="4088257">(</span><span class="ident" id="4088258">s</span>&nbsp;<span class="builtintype" id="4088260">string</span><span class="op" id="4088266">)</span>&nbsp;<span class="ident" id="4088268">IP</span>&nbsp;<span class="op" id="4088271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088274">var</span>&nbsp;<span class="ident" id="4088278">p</span>&nbsp;<span class="op" id="4088280">[</span><span class="ident" id="4088281">IPv4len</span><span class="op" id="4088288">]</span><span class="builtintype" id="4088289">byte</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088295">i</span>&nbsp;<span class="op" id="4088297">:=</span>&nbsp;<span class="num" id="4088300">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088303">for</span>&nbsp;<span class="ident" id="4088307">j</span>&nbsp;<span class="op" id="4088309">:=</span>&nbsp;<span class="num" id="4088312">0</span><span class="op" id="4088313">;</span>&nbsp;<span class="ident" id="4088315">j</span>&nbsp;<span class="op" id="4088317">&lt;</span>&nbsp;<span class="ident" id="4088319">IPv4len</span><span class="op" id="4088326">;</span>&nbsp;<span class="ident" id="4088328">j</span><span class="op" id="4088329">++</span>&nbsp;<span class="op" id="4088332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088336">if</span>&nbsp;<span class="ident" id="4088339">i</span>&nbsp;<span class="op" id="4088341">&gt;=</span>&nbsp;<span class="builtinfunc" id="4088344">len</span><span class="op" id="4088347">(</span><span class="ident" id="4088348">s</span><span class="op" id="4088349">)</span>&nbsp;<span class="op" id="4088351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4088356">//&nbsp;Missing&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088378">return</span>&nbsp;<span class="ident" id="4088385">nil</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088395">if</span>&nbsp;<span class="ident" id="4088398">j</span>&nbsp;<span class="op" id="4088400">&gt;</span>&nbsp;<span class="num" id="4088402">0</span>&nbsp;<span class="op" id="4088404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088409">if</span>&nbsp;<span class="ident" id="4088412">s</span><span class="op" id="4088413">[</span><span class="ident" id="4088414">i</span><span class="op" id="4088415">]</span>&nbsp;<span class="op" id="4088417">!=</span>&nbsp;<span class="string" id="4088420">&#39;.&#39;</span>&nbsp;<span class="op" id="4088424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088430">return</span>&nbsp;<span class="ident" id="4088437">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088444">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088449">i</span><span class="op" id="4088450">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088459">var</span>&nbsp;<span class="op" id="4088463">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088468">n</span>&nbsp;&nbsp;<span class="builtintype" id="4088471">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088478">ok</span>&nbsp;<span class="builtintype" id="4088481">bool</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088492">n</span><span class="op" id="4088493">,</span>&nbsp;<span class="ident" id="4088495">i</span><span class="op" id="4088496">,</span>&nbsp;<span class="ident" id="4088498">ok</span>&nbsp;<span class="op" id="4088501">=</span>&nbsp;<span class="ident" id="4088503">dtoi</span><span class="op" id="4088507">(</span><span class="ident" id="4088508">s</span><span class="op" id="4088509">,</span>&nbsp;<span class="ident" id="4088511">i</span><span class="op" id="4088512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088516">if</span>&nbsp;<span class="op" id="4088519">!</span><span class="ident" id="4088520">ok</span>&nbsp;<span class="op" id="4088523">||</span>&nbsp;<span class="ident" id="4088526">n</span>&nbsp;<span class="op" id="4088528">&gt;</span>&nbsp;<span class="num" id="4088530">0xFF</span>&nbsp;<span class="op" id="4088535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088540">return</span>&nbsp;<span class="ident" id="4088547">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088553">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088557">p</span><span class="op" id="4088558">[</span><span class="ident" id="4088559">j</span><span class="op" id="4088560">]</span>&nbsp;<span class="op" id="4088562">=</span>&nbsp;<span class="builtintype" id="4088564">byte</span><span class="op" id="4088568">(</span><span class="ident" id="4088569">n</span><span class="op" id="4088570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088576">if</span>&nbsp;<span class="ident" id="4088579">i</span>&nbsp;<span class="op" id="4088581">!=</span>&nbsp;<span class="builtinfunc" id="4088584">len</span><span class="op" id="4088587">(</span><span class="ident" id="4088588">s</span><span class="op" id="4088589">)</span>&nbsp;<span class="op" id="4088591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088595">return</span>&nbsp;<span class="ident" id="4088602">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088607">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088610">return</span>&nbsp;<span class="ident" id="4088617">IPv4</span><span class="op" id="4088621">(</span><span class="ident" id="4088622">p</span><span class="op" id="4088623">[</span><span class="num" id="4088624">0</span><span class="op" id="4088625">]</span><span class="op" id="4088626">,</span>&nbsp;<span class="ident" id="4088628">p</span><span class="op" id="4088629">[</span><span class="num" id="4088630">1</span><span class="op" id="4088631">]</span><span class="op" id="4088632">,</span>&nbsp;<span class="ident" id="4088634">p</span><span class="op" id="4088635">[</span><span class="num" id="4088636">2</span><span class="op" id="4088637">]</span><span class="op" id="4088638">,</span>&nbsp;<span class="ident" id="4088640">p</span><span class="op" id="4088641">[</span><span class="num" id="4088642">3</span><span class="op" id="4088643">]</span><span class="op" id="4088644">)</span><br>
<span class="lineno"></span><span class="op" id="4088646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4088649">//&nbsp;parseIPv6&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;literal&nbsp;IPv6&nbsp;address&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4291</span><br>
<span class="lineno"></span><span class="comment" id="4088719">//&nbsp;and&nbsp;RFC&nbsp;5952.&nbsp;&nbsp;It&nbsp;can&nbsp;also&nbsp;parse&nbsp;a&nbsp;literal&nbsp;scoped&nbsp;IPv6&nbsp;address&nbsp;with</span><br>
<span class="lineno">530</span><span class="comment" id="4088790">//&nbsp;zone&nbsp;identifier&nbsp;which&nbsp;is&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4007&nbsp;when&nbsp;zoneAllowed&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4088860">//&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="4088869">func</span>&nbsp;<span class="ident" id="4088874">parseIPv6</span><span class="op" id="4088883">(</span><span class="ident" id="4088884">s</span>&nbsp;<span class="builtintype" id="4088886">string</span><span class="op" id="4088892">,</span>&nbsp;<span class="ident" id="4088894">zoneAllowed</span>&nbsp;<span class="builtintype" id="4088906">bool</span><span class="op" id="4088910">)</span>&nbsp;<span class="op" id="4088912">(</span><span class="ident" id="4088913">ip</span>&nbsp;<span class="ident" id="4088916">IP</span><span class="op" id="4088918">,</span>&nbsp;<span class="ident" id="4088920">zone</span>&nbsp;<span class="builtintype" id="4088925">string</span><span class="op" id="4088931">)</span>&nbsp;<span class="op" id="4088933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088936">ip</span>&nbsp;<span class="op" id="4088939">=</span>&nbsp;<span class="builtinfunc" id="4088941">make</span><span class="op" id="4088945">(</span><span class="ident" id="4088946">IP</span><span class="op" id="4088948">,</span>&nbsp;<span class="ident" id="4088950">IPv6len</span><span class="op" id="4088957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088960">ellipsis</span>&nbsp;<span class="op" id="4088969">:=</span>&nbsp;<span class="op" id="4088972">-</span><span class="num" id="4088973">1</span>&nbsp;<span class="comment" id="4088975">//&nbsp;position&nbsp;of&nbsp;ellipsis&nbsp;in&nbsp;p</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089005">i</span>&nbsp;<span class="op" id="4089007">:=</span>&nbsp;<span class="num" id="4089010">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4089020">//&nbsp;index&nbsp;in&nbsp;string&nbsp;s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089043">if</span>&nbsp;<span class="ident" id="4089046">zoneAllowed</span>&nbsp;<span class="op" id="4089058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089062">s</span><span class="op" id="4089063">,</span>&nbsp;<span class="ident" id="4089065">zone</span>&nbsp;<span class="op" id="4089070">=</span>&nbsp;<span class="ident" id="4089072">splitHostZone</span><span class="op" id="4089085">(</span><span class="ident" id="4089086">s</span><span class="op" id="4089087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089090">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4089094">//&nbsp;Might&nbsp;have&nbsp;leading&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089126">if</span>&nbsp;<span class="builtinfunc" id="4089129">len</span><span class="op" id="4089132">(</span><span class="ident" id="4089133">s</span><span class="op" id="4089134">)</span>&nbsp;<span class="op" id="4089136">&gt;=</span>&nbsp;<span class="num" id="4089139">2</span>&nbsp;<span class="op" id="4089141">&amp;&amp;</span>&nbsp;<span class="ident" id="4089144">s</span><span class="op" id="4089145">[</span><span class="num" id="4089146">0</span><span class="op" id="4089147">]</span>&nbsp;<span class="op" id="4089149">==</span>&nbsp;<span class="string" id="4089152">&#39;:&#39;</span>&nbsp;<span class="op" id="4089156">&amp;&amp;</span>&nbsp;<span class="ident" id="4089159">s</span><span class="op" id="4089160">[</span><span class="num" id="4089161">1</span><span class="op" id="4089162">]</span>&nbsp;<span class="op" id="4089164">==</span>&nbsp;<span class="string" id="4089167">&#39;:&#39;</span>&nbsp;<span class="op" id="4089171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089175">ellipsis</span>&nbsp;<span class="op" id="4089184">=</span>&nbsp;<span class="num" id="4089186">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089190">i</span>&nbsp;<span class="op" id="4089192">=</span>&nbsp;<span class="num" id="4089194">2</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4089198">//&nbsp;Might&nbsp;be&nbsp;only&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089226">if</span>&nbsp;<span class="ident" id="4089229">i</span>&nbsp;<span class="op" id="4089231">==</span>&nbsp;<span class="builtinfunc" id="4089234">len</span><span class="op" id="4089237">(</span><span class="ident" id="4089238">s</span><span class="op" id="4089239">)</span>&nbsp;<span class="op" id="4089241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089246">return</span>&nbsp;<span class="ident" id="4089253">ip</span><span class="op" id="4089255">,</span>&nbsp;<span class="ident" id="4089257">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089267">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4089271">//&nbsp;Loop,&nbsp;parsing&nbsp;hex&nbsp;numbers&nbsp;followed&nbsp;by&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089320">j</span>&nbsp;<span class="op" id="4089322">:=</span>&nbsp;<span class="num" id="4089325">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089328">for</span>&nbsp;<span class="ident" id="4089332">j</span>&nbsp;<span class="op" id="4089334">&lt;</span>&nbsp;<span class="ident" id="4089336">IPv6len</span>&nbsp;<span class="op" id="4089344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4089348">//&nbsp;Hex&nbsp;number.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089365">n</span><span class="op" id="4089366">,</span>&nbsp;<span class="ident" id="4089368">i1</span><span class="op" id="4089370">,</span>&nbsp;<span class="ident" id="4089372">ok</span>&nbsp;<span class="op" id="4089375">:=</span>&nbsp;<span class="ident" id="4089378">xtoi</span><span class="op" id="4089382">(</span><span class="ident" id="4089383">s</span><span class="op" id="4089384">,</span>&nbsp;<span class="ident" id="4089386">i</span><span class="op" id="4089387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089391">if</span>&nbsp;<span class="op" id="4089394">!</span><span class="ident" id="4089395">ok</span>&nbsp;<span class="op" id="4089398">||</span>&nbsp;<span class="ident" id="4089401">n</span>&nbsp;<span class="op" id="4089403">&gt;</span>&nbsp;<span class="num" id="4089405">0xFFFF</span>&nbsp;<span class="op" id="4089412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089417">return</span>&nbsp;<span class="ident" id="4089424">nil</span><span class="op" id="4089427">,</span>&nbsp;<span class="ident" id="4089429">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4089441">//&nbsp;If&nbsp;followed&nbsp;by&nbsp;dot,&nbsp;might&nbsp;be&nbsp;in&nbsp;trailing&nbsp;IPv4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089493">if</span>&nbsp;<span class="ident" id="4089496">i1</span>&nbsp;<span class="op" id="4089499">&lt;</span>&nbsp;<span class="builtinfunc" id="4089501">len</span><span class="op" id="4089504">(</span><span class="ident" id="4089505">s</span><span class="op" id="4089506">)</span>&nbsp;<span class="op" id="4089508">&amp;&amp;</span>&nbsp;<span class="ident" id="4089511">s</span><span class="op" id="4089512">[</span><span class="ident" id="4089513">i1</span><span class="op" id="4089515">]</span>&nbsp;<span class="op" id="4089517">==</span>&nbsp;<span class="string" id="4089520">&#39;.&#39;</span>&nbsp;<span class="op" id="4089524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089529">if</span>&nbsp;<span class="ident" id="4089532">ellipsis</span>&nbsp;<span class="op" id="4089541">&lt;</span>&nbsp;<span class="num" id="4089543">0</span>&nbsp;<span class="op" id="4089545">&amp;&amp;</span>&nbsp;<span class="ident" id="4089548">j</span>&nbsp;<span class="op" id="4089550">!=</span>&nbsp;<span class="ident" id="4089553">IPv6len</span><span class="op" id="4089560">-</span><span class="ident" id="4089561">IPv4len</span>&nbsp;<span class="op" id="4089569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4089575">//&nbsp;Not&nbsp;the&nbsp;right&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089603">return</span>&nbsp;<span class="ident" id="4089610">nil</span><span class="op" id="4089613">,</span>&nbsp;<span class="ident" id="4089615">zone</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089628">if</span>&nbsp;<span class="ident" id="4089631">j</span><span class="op" id="4089632">+</span><span class="ident" id="4089633">IPv4len</span>&nbsp;<span class="op" id="4089641">&gt;</span>&nbsp;<span class="ident" id="4089643">IPv6len</span>&nbsp;<span class="op" id="4089651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4089657">//&nbsp;Not&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089681">return</span>&nbsp;<span class="ident" id="4089688">nil</span><span class="op" id="4089691">,</span>&nbsp;<span class="ident" id="4089693">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089701">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089706">ip4</span>&nbsp;<span class="op" id="4089710">:=</span>&nbsp;<span class="ident" id="4089713">parseIPv4</span><span class="op" id="4089722">(</span><span class="ident" id="4089723">s</span><span class="op" id="4089724">[</span><span class="ident" id="4089725">i</span><span class="op" id="4089726">:</span><span class="op" id="4089727">]</span><span class="op" id="4089728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089733">if</span>&nbsp;<span class="ident" id="4089736">ip4</span>&nbsp;<span class="op" id="4089740">==</span>&nbsp;<span class="ident" id="4089743">nil</span>&nbsp;<span class="op" id="4089747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089753">return</span>&nbsp;<span class="ident" id="4089760">nil</span><span class="op" id="4089763">,</span>&nbsp;<span class="ident" id="4089765">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089778">ip</span><span class="op" id="4089780">[</span><span class="ident" id="4089781">j</span><span class="op" id="4089782">]</span>&nbsp;<span class="op" id="4089784">=</span>&nbsp;<span class="ident" id="4089786">ip4</span><span class="op" id="4089789">[</span><span class="num" id="4089790">12</span><span class="op" id="4089792">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089797">ip</span><span class="op" id="4089799">[</span><span class="ident" id="4089800">j</span><span class="op" id="4089801">+</span><span class="num" id="4089802">1</span><span class="op" id="4089803">]</span>&nbsp;<span class="op" id="4089805">=</span>&nbsp;<span class="ident" id="4089807">ip4</span><span class="op" id="4089810">[</span><span class="num" id="4089811">13</span><span class="op" id="4089813">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089818">ip</span><span class="op" id="4089820">[</span><span class="ident" id="4089821">j</span><span class="op" id="4089822">+</span><span class="num" id="4089823">2</span><span class="op" id="4089824">]</span>&nbsp;<span class="op" id="4089826">=</span>&nbsp;<span class="ident" id="4089828">ip4</span><span class="op" id="4089831">[</span><span class="num" id="4089832">14</span><span class="op" id="4089834">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089839">ip</span><span class="op" id="4089841">[</span><span class="ident" id="4089842">j</span><span class="op" id="4089843">+</span><span class="num" id="4089844">3</span><span class="op" id="4089845">]</span>&nbsp;<span class="op" id="4089847">=</span>&nbsp;<span class="ident" id="4089849">ip4</span><span class="op" id="4089852">[</span><span class="num" id="4089853">15</span><span class="op" id="4089855">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089860">i</span>&nbsp;<span class="op" id="4089862">=</span>&nbsp;<span class="builtinfunc" id="4089864">len</span><span class="op" id="4089867">(</span><span class="ident" id="4089868">s</span><span class="op" id="4089869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089874">j</span>&nbsp;<span class="op" id="4089876">+=</span>&nbsp;<span class="ident" id="4089879">IPv4len</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089890">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4089903">//&nbsp;Save&nbsp;this&nbsp;16-bit&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089932">ip</span><span class="op" id="4089934">[</span><span class="ident" id="4089935">j</span><span class="op" id="4089936">]</span>&nbsp;<span class="op" id="4089938">=</span>&nbsp;<span class="builtintype" id="4089940">byte</span><span class="op" id="4089944">(</span><span class="ident" id="4089945">n</span>&nbsp;<span class="op" id="4089947">&gt;&gt;</span>&nbsp;<span class="num" id="4089950">8</span><span class="op" id="4089951">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089955">ip</span><span class="op" id="4089957">[</span><span class="ident" id="4089958">j</span><span class="op" id="4089959">+</span><span class="num" id="4089960">1</span><span class="op" id="4089961">]</span>&nbsp;<span class="op" id="4089963">=</span>&nbsp;<span class="builtintype" id="4089965">byte</span><span class="op" id="4089969">(</span><span class="ident" id="4089970">n</span><span class="op" id="4089971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089975">j</span>&nbsp;<span class="op" id="4089977">+=</span>&nbsp;<span class="num" id="4089980">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4089985">//&nbsp;Stop&nbsp;at&nbsp;end&nbsp;of&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090013">i</span>&nbsp;<span class="op" id="4090015">=</span>&nbsp;<span class="ident" id="4090017">i1</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090022">if</span>&nbsp;<span class="ident" id="4090025">i</span>&nbsp;<span class="op" id="4090027">==</span>&nbsp;<span class="builtinfunc" id="4090030">len</span><span class="op" id="4090033">(</span><span class="ident" id="4090034">s</span><span class="op" id="4090035">)</span>&nbsp;<span class="op" id="4090037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090042">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4090055">//&nbsp;Otherwise&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;colon&nbsp;and&nbsp;more.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090106">if</span>&nbsp;<span class="ident" id="4090109">s</span><span class="op" id="4090110">[</span><span class="ident" id="4090111">i</span><span class="op" id="4090112">]</span>&nbsp;<span class="op" id="4090114">!=</span>&nbsp;<span class="string" id="4090117">&#39;:&#39;</span>&nbsp;<span class="op" id="4090121">||</span>&nbsp;<span class="ident" id="4090124">i</span><span class="op" id="4090125">+</span><span class="num" id="4090126">1</span>&nbsp;<span class="op" id="4090128">==</span>&nbsp;<span class="builtinfunc" id="4090131">len</span><span class="op" id="4090134">(</span><span class="ident" id="4090135">s</span><span class="op" id="4090136">)</span>&nbsp;<span class="op" id="4090138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090143">return</span>&nbsp;<span class="ident" id="4090150">nil</span><span class="op" id="4090153">,</span>&nbsp;<span class="ident" id="4090155">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090166">i</span><span class="op" id="4090167">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4090173">//&nbsp;Look&nbsp;for&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090197">if</span>&nbsp;<span class="ident" id="4090200">s</span><span class="op" id="4090201">[</span><span class="ident" id="4090202">i</span><span class="op" id="4090203">]</span>&nbsp;<span class="op" id="4090205">==</span>&nbsp;<span class="string" id="4090208">&#39;:&#39;</span>&nbsp;<span class="op" id="4090212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090217">if</span>&nbsp;<span class="ident" id="4090220">ellipsis</span>&nbsp;<span class="op" id="4090229">&gt;=</span>&nbsp;<span class="num" id="4090232">0</span>&nbsp;<span class="op" id="4090234">{</span>&nbsp;<span class="comment" id="4090236">//&nbsp;already&nbsp;have&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090260">return</span>&nbsp;<span class="ident" id="4090267">nil</span><span class="op" id="4090270">,</span>&nbsp;<span class="ident" id="4090272">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090280">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090285">ellipsis</span>&nbsp;<span class="op" id="4090294">=</span>&nbsp;<span class="ident" id="4090296">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090301">if</span>&nbsp;<span class="ident" id="4090304">i</span><span class="op" id="4090305">++</span><span class="op" id="4090307">;</span>&nbsp;<span class="ident" id="4090309">i</span>&nbsp;<span class="op" id="4090311">==</span>&nbsp;<span class="builtinfunc" id="4090314">len</span><span class="op" id="4090317">(</span><span class="ident" id="4090318">s</span><span class="op" id="4090319">)</span>&nbsp;<span class="op" id="4090321">{</span>&nbsp;<span class="comment" id="4090323">//&nbsp;can&nbsp;be&nbsp;at&nbsp;end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090344">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090357">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4090364">//&nbsp;Must&nbsp;have&nbsp;used&nbsp;entire&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090398">if</span>&nbsp;<span class="ident" id="4090401">i</span>&nbsp;<span class="op" id="4090403">!=</span>&nbsp;<span class="builtinfunc" id="4090406">len</span><span class="op" id="4090409">(</span><span class="ident" id="4090410">s</span><span class="op" id="4090411">)</span>&nbsp;<span class="op" id="4090413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090417">return</span>&nbsp;<span class="ident" id="4090424">nil</span><span class="op" id="4090427">,</span>&nbsp;<span class="ident" id="4090429">zone</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4090439">//&nbsp;If&nbsp;didn&#39;t&nbsp;parse&nbsp;enough,&nbsp;expand&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090484">if</span>&nbsp;<span class="ident" id="4090487">j</span>&nbsp;<span class="op" id="4090489">&lt;</span>&nbsp;<span class="ident" id="4090491">IPv6len</span>&nbsp;<span class="op" id="4090499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090503">if</span>&nbsp;<span class="ident" id="4090506">ellipsis</span>&nbsp;<span class="op" id="4090515">&lt;</span>&nbsp;<span class="num" id="4090517">0</span>&nbsp;<span class="op" id="4090519">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090524">return</span>&nbsp;<span class="ident" id="4090531">nil</span><span class="op" id="4090534">,</span>&nbsp;<span class="ident" id="4090536">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090547">n</span>&nbsp;<span class="op" id="4090549">:=</span>&nbsp;<span class="ident" id="4090552">IPv6len</span>&nbsp;<span class="op" id="4090560">-</span>&nbsp;<span class="ident" id="4090562">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090566">for</span>&nbsp;<span class="ident" id="4090570">k</span>&nbsp;<span class="op" id="4090572">:=</span>&nbsp;<span class="ident" id="4090575">j</span>&nbsp;<span class="op" id="4090577">-</span>&nbsp;<span class="num" id="4090579">1</span><span class="op" id="4090580">;</span>&nbsp;<span class="ident" id="4090582">k</span>&nbsp;<span class="op" id="4090584">&gt;=</span>&nbsp;<span class="ident" id="4090587">ellipsis</span><span class="op" id="4090595">;</span>&nbsp;<span class="ident" id="4090597">k</span><span class="op" id="4090598">--</span>&nbsp;<span class="op" id="4090601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090606">ip</span><span class="op" id="4090608">[</span><span class="ident" id="4090609">k</span><span class="op" id="4090610">+</span><span class="ident" id="4090611">n</span><span class="op" id="4090612">]</span>&nbsp;<span class="op" id="4090614">=</span>&nbsp;<span class="ident" id="4090616">ip</span><span class="op" id="4090618">[</span><span class="ident" id="4090619">k</span><span class="op" id="4090620">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090628">for</span>&nbsp;<span class="ident" id="4090632">k</span>&nbsp;<span class="op" id="4090634">:=</span>&nbsp;<span class="ident" id="4090637">ellipsis</span>&nbsp;<span class="op" id="4090646">+</span>&nbsp;<span class="ident" id="4090648">n</span>&nbsp;<span class="op" id="4090650">-</span>&nbsp;<span class="num" id="4090652">1</span><span class="op" id="4090653">;</span>&nbsp;<span class="ident" id="4090655">k</span>&nbsp;<span class="op" id="4090657">&gt;=</span>&nbsp;<span class="ident" id="4090660">ellipsis</span><span class="op" id="4090668">;</span>&nbsp;<span class="ident" id="4090670">k</span><span class="op" id="4090671">--</span>&nbsp;<span class="op" id="4090674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090679">ip</span><span class="op" id="4090681">[</span><span class="ident" id="4090682">k</span><span class="op" id="4090683">]</span>&nbsp;<span class="op" id="4090685">=</span>&nbsp;<span class="num" id="4090687">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090694">}</span>&nbsp;<span class="keyword" id="4090696">else</span>&nbsp;<span class="keyword" id="4090701">if</span>&nbsp;<span class="ident" id="4090704">ellipsis</span>&nbsp;<span class="op" id="4090713">&gt;=</span>&nbsp;<span class="num" id="4090716">0</span>&nbsp;<span class="op" id="4090718">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4090722">//&nbsp;Ellipsis&nbsp;must&nbsp;represent&nbsp;at&nbsp;least&nbsp;one&nbsp;0&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090773">return</span>&nbsp;<span class="ident" id="4090780">nil</span><span class="op" id="4090783">,</span>&nbsp;<span class="ident" id="4090785">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090794">return</span>&nbsp;<span class="ident" id="4090801">ip</span><span class="op" id="4090803">,</span>&nbsp;<span class="ident" id="4090805">zone</span><br>
<span class="lineno"></span><span class="op" id="4090810">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="4090813">//&nbsp;A&nbsp;ParseError&nbsp;represents&nbsp;a&nbsp;malformed&nbsp;text&nbsp;string&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;string&nbsp;that&nbsp;was&nbsp;expected.</span><br>
<span class="lineno"></span><span class="keyword" id="4090906">type</span>&nbsp;<span class="ident" id="4090911">ParseError</span>&nbsp;<span class="keyword" id="4090922">struct</span>&nbsp;<span class="op" id="4090929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090932">Type</span>&nbsp;<span class="builtintype" id="4090937">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090945">Text</span>&nbsp;<span class="builtintype" id="4090950">string</span><br>
<span class="lineno">640</span><span class="op" id="4090957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4090960">func</span>&nbsp;<span class="op" id="4090965">(</span><span class="ident" id="4090966">e</span>&nbsp;<span class="op" id="4090968">*</span><span class="ident" id="4090969">ParseError</span><span class="op" id="4090979">)</span>&nbsp;<span class="ident" id="4090981">Error</span><span class="op" id="4090986">(</span><span class="op" id="4090987">)</span>&nbsp;<span class="builtintype" id="4090989">string</span>&nbsp;<span class="op" id="4090996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090999">return</span>&nbsp;<span class="string" id="4091006">&#34;invalid&nbsp;&#34;</span>&nbsp;<span class="op" id="4091017">+</span>&nbsp;<span class="ident" id="4091019">e</span><span class="op" id="4091020">.</span><span class="ident" id="4091021">Type</span>&nbsp;<span class="op" id="4091026">+</span>&nbsp;<span class="string" id="4091028">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="4091033">+</span>&nbsp;<span class="ident" id="4091035">e</span><span class="op" id="4091036">.</span><span class="ident" id="4091037">Text</span><br>
<span class="lineno"></span><span class="op" id="4091042">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment" id="4091045">//&nbsp;ParseIP&nbsp;parses&nbsp;s&nbsp;as&nbsp;an&nbsp;IP&nbsp;address,&nbsp;returning&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="4091105">//&nbsp;The&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;in&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="4091163">//&nbsp;or&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;)&nbsp;form.</span><br>
<span class="lineno"></span><span class="comment" id="4091205">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;textual&nbsp;representation&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno">650</span><span class="comment" id="4091269">//&nbsp;ParseIP&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4091293">func</span>&nbsp;<span class="ident" id="4091298">ParseIP</span><span class="op" id="4091305">(</span><span class="ident" id="4091306">s</span>&nbsp;<span class="builtintype" id="4091308">string</span><span class="op" id="4091314">)</span>&nbsp;<span class="ident" id="4091316">IP</span>&nbsp;<span class="op" id="4091319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091322">for</span>&nbsp;<span class="ident" id="4091326">i</span>&nbsp;<span class="op" id="4091328">:=</span>&nbsp;<span class="num" id="4091331">0</span><span class="op" id="4091332">;</span>&nbsp;<span class="ident" id="4091334">i</span>&nbsp;<span class="op" id="4091336">&lt;</span>&nbsp;<span class="builtinfunc" id="4091338">len</span><span class="op" id="4091341">(</span><span class="ident" id="4091342">s</span><span class="op" id="4091343">)</span><span class="op" id="4091344">;</span>&nbsp;<span class="ident" id="4091346">i</span><span class="op" id="4091347">++</span>&nbsp;<span class="op" id="4091350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091354">switch</span>&nbsp;<span class="ident" id="4091361">s</span><span class="op" id="4091362">[</span><span class="ident" id="4091363">i</span><span class="op" id="4091364">]</span>&nbsp;<span class="op" id="4091366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091370">case</span>&nbsp;<span class="string" id="4091375">&#39;.&#39;</span><span class="op" id="4091378">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091383">return</span>&nbsp;<span class="ident" id="4091390">parseIPv4</span><span class="op" id="4091399">(</span><span class="ident" id="4091400">s</span><span class="op" id="4091401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091405">case</span>&nbsp;<span class="string" id="4091410">&#39;:&#39;</span><span class="op" id="4091413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091418">ip</span><span class="op" id="4091420">,</span>&nbsp;<span class="ident" id="4091422">_</span>&nbsp;<span class="op" id="4091424">:=</span>&nbsp;<span class="ident" id="4091427">parseIPv6</span><span class="op" id="4091436">(</span><span class="ident" id="4091437">s</span><span class="op" id="4091438">,</span>&nbsp;<span class="builtintype" id="4091440">false</span><span class="op" id="4091445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091450">return</span>&nbsp;<span class="ident" id="4091457">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4091462">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4091465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091468">return</span>&nbsp;<span class="ident" id="4091475">nil</span><br>
<span class="lineno"></span><span class="op" id="4091479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4091482">//&nbsp;ParseCIDR&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;CIDR&nbsp;notation&nbsp;IP&nbsp;address&nbsp;and&nbsp;mask,</span><br>
<span class="lineno">665</span><span class="comment" id="4091544">//&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4091605">//&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="4091631">//</span><br>
<span class="lineno"></span><span class="comment" id="4091634">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;and&nbsp;the&nbsp;network&nbsp;implied&nbsp;by&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="4091697">//&nbsp;and&nbsp;mask.&nbsp;&nbsp;For&nbsp;example,&nbsp;ParseCIDR(&#34;192.168.100.1/16&#34;)&nbsp;returns</span><br>
<span class="lineno">670</span><span class="comment" id="4091762">//&nbsp;the&nbsp;IP&nbsp;address&nbsp;192.168.100.1&nbsp;and&nbsp;the&nbsp;network&nbsp;192.168.0.0/16.</span><br>
<span class="lineno"></span><span class="keyword" id="4091826">func</span>&nbsp;<span class="ident" id="4091831">ParseCIDR</span><span class="op" id="4091840">(</span><span class="ident" id="4091841">s</span>&nbsp;<span class="builtintype" id="4091843">string</span><span class="op" id="4091849">)</span>&nbsp;<span class="op" id="4091851">(</span><span class="ident" id="4091852">IP</span><span class="op" id="4091854">,</span>&nbsp;<span class="op" id="4091856">*</span><span class="ident" id="4091857">IPNet</span><span class="op" id="4091862">,</span>&nbsp;<span class="builtintype" id="4091864">error</span><span class="op" id="4091869">)</span>&nbsp;<span class="op" id="4091871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091874">i</span>&nbsp;<span class="op" id="4091876">:=</span>&nbsp;<span class="ident" id="4091879">byteIndex</span><span class="op" id="4091888">(</span><span class="ident" id="4091889">s</span><span class="op" id="4091890">,</span>&nbsp;<span class="string" id="4091892">&#39;/&#39;</span><span class="op" id="4091895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091898">if</span>&nbsp;<span class="ident" id="4091901">i</span>&nbsp;<span class="op" id="4091903">&lt;</span>&nbsp;<span class="num" id="4091905">0</span>&nbsp;<span class="op" id="4091907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091911">return</span>&nbsp;<span class="ident" id="4091918">nil</span><span class="op" id="4091921">,</span>&nbsp;<span class="ident" id="4091923">nil</span><span class="op" id="4091926">,</span>&nbsp;<span class="op" id="4091928">&amp;</span><span class="ident" id="4091929">ParseError</span><span class="op" id="4091939">{</span><span class="string" id="4091940">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="4091954">,</span>&nbsp;<span class="ident" id="4091956">s</span><span class="op" id="4091957">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4091960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091963">addr</span><span class="op" id="4091967">,</span>&nbsp;<span class="ident" id="4091969">mask</span>&nbsp;<span class="op" id="4091974">:=</span>&nbsp;<span class="ident" id="4091977">s</span><span class="op" id="4091978">[</span><span class="op" id="4091979">:</span><span class="ident" id="4091980">i</span><span class="op" id="4091981">]</span><span class="op" id="4091982">,</span>&nbsp;<span class="ident" id="4091984">s</span><span class="op" id="4091985">[</span><span class="ident" id="4091986">i</span><span class="op" id="4091987">+</span><span class="num" id="4091988">1</span><span class="op" id="4091989">:</span><span class="op" id="4091990">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091993">iplen</span>&nbsp;<span class="op" id="4091999">:=</span>&nbsp;<span class="ident" id="4092002">IPv4len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092011">ip</span>&nbsp;<span class="op" id="4092014">:=</span>&nbsp;<span class="ident" id="4092017">parseIPv4</span><span class="op" id="4092026">(</span><span class="ident" id="4092027">addr</span><span class="op" id="4092031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092034">if</span>&nbsp;<span class="ident" id="4092037">ip</span>&nbsp;<span class="op" id="4092040">==</span>&nbsp;<span class="ident" id="4092043">nil</span>&nbsp;<span class="op" id="4092047">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092051">iplen</span>&nbsp;<span class="op" id="4092057">=</span>&nbsp;<span class="ident" id="4092059">IPv6len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092069">ip</span><span class="op" id="4092071">,</span>&nbsp;<span class="ident" id="4092073">_</span>&nbsp;<span class="op" id="4092075">=</span>&nbsp;<span class="ident" id="4092077">parseIPv6</span><span class="op" id="4092086">(</span><span class="ident" id="4092087">addr</span><span class="op" id="4092091">,</span>&nbsp;<span class="builtintype" id="4092093">false</span><span class="op" id="4092098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092104">n</span><span class="op" id="4092105">,</span>&nbsp;<span class="ident" id="4092107">i</span><span class="op" id="4092108">,</span>&nbsp;<span class="ident" id="4092110">ok</span>&nbsp;<span class="op" id="4092113">:=</span>&nbsp;<span class="ident" id="4092116">dtoi</span><span class="op" id="4092120">(</span><span class="ident" id="4092121">mask</span><span class="op" id="4092125">,</span>&nbsp;<span class="num" id="4092127">0</span><span class="op" id="4092128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092131">if</span>&nbsp;<span class="ident" id="4092134">ip</span>&nbsp;<span class="op" id="4092137">==</span>&nbsp;<span class="ident" id="4092140">nil</span>&nbsp;<span class="op" id="4092144">||</span>&nbsp;<span class="op" id="4092147">!</span><span class="ident" id="4092148">ok</span>&nbsp;<span class="op" id="4092151">||</span>&nbsp;<span class="ident" id="4092154">i</span>&nbsp;<span class="op" id="4092156">!=</span>&nbsp;<span class="builtinfunc" id="4092159">len</span><span class="op" id="4092162">(</span><span class="ident" id="4092163">mask</span><span class="op" id="4092167">)</span>&nbsp;<span class="op" id="4092169">||</span>&nbsp;<span class="ident" id="4092172">n</span>&nbsp;<span class="op" id="4092174">&lt;</span>&nbsp;<span class="num" id="4092176">0</span>&nbsp;<span class="op" id="4092178">||</span>&nbsp;<span class="ident" id="4092181">n</span>&nbsp;<span class="op" id="4092183">&gt;</span>&nbsp;<span class="num" id="4092185">8</span><span class="op" id="4092186">*</span><span class="ident" id="4092187">iplen</span>&nbsp;<span class="op" id="4092193">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092197">return</span>&nbsp;<span class="ident" id="4092204">nil</span><span class="op" id="4092207">,</span>&nbsp;<span class="ident" id="4092209">nil</span><span class="op" id="4092212">,</span>&nbsp;<span class="op" id="4092214">&amp;</span><span class="ident" id="4092215">ParseError</span><span class="op" id="4092225">{</span><span class="string" id="4092226">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="4092240">,</span>&nbsp;<span class="ident" id="4092242">s</span><span class="op" id="4092243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092249">m</span>&nbsp;<span class="op" id="4092251">:=</span>&nbsp;<span class="ident" id="4092254">CIDRMask</span><span class="op" id="4092262">(</span><span class="ident" id="4092263">n</span><span class="op" id="4092264">,</span>&nbsp;<span class="num" id="4092266">8</span><span class="op" id="4092267">*</span><span class="ident" id="4092268">iplen</span><span class="op" id="4092273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092276">return</span>&nbsp;<span class="ident" id="4092283">ip</span><span class="op" id="4092285">,</span>&nbsp;<span class="op" id="4092287">&amp;</span><span class="ident" id="4092288">IPNet</span><span class="op" id="4092293">{</span><span class="ident" id="4092294">IP</span><span class="op" id="4092296">:</span>&nbsp;<span class="ident" id="4092298">ip</span><span class="op" id="4092300">.</span><span class="ident" id="4092301">Mask</span><span class="op" id="4092305">(</span><span class="ident" id="4092306">m</span><span class="op" id="4092307">)</span><span class="op" id="4092308">,</span>&nbsp;<span class="ident" id="4092310">Mask</span><span class="op" id="4092314">:</span>&nbsp;<span class="ident" id="4092316">m</span><span class="op" id="4092317">}</span><span class="op" id="4092318">,</span>&nbsp;<span class="ident" id="4092320">nil</span><br>
<span class="lineno"></span><span class="op" id="4092324">}</span>
</div>
</body>
</html>
