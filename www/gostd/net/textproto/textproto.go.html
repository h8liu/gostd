<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3557233">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3557289">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3557343">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3557394">//&nbsp;Package&nbsp;textproto&nbsp;implements&nbsp;generic&nbsp;support&nbsp;for&nbsp;text-based&nbsp;request/response</span><br>
<span class="lineno"></span><span class="comment" id="3557474">//&nbsp;protocols&nbsp;in&nbsp;the&nbsp;style&nbsp;of&nbsp;HTTP,&nbsp;NNTP,&nbsp;and&nbsp;SMTP.</span><br>
<span class="lineno"></span><span class="comment" id="3557525">//</span><br>
<span class="lineno"></span><span class="comment" id="3557528">//&nbsp;The&nbsp;package&nbsp;provides:</span><br>
<span class="lineno"></span><span class="comment" id="3557553">//</span><br>
<span class="lineno">10</span><span class="comment" id="3557556">//&nbsp;Error,&nbsp;which&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3557613">//&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="3557626">//</span><br>
<span class="lineno"></span><span class="comment" id="3557629">//&nbsp;Pipeline,&nbsp;to&nbsp;manage&nbsp;pipelined&nbsp;requests&nbsp;and&nbsp;responses</span><br>
<span class="lineno"></span><span class="comment" id="3557685">//&nbsp;in&nbsp;a&nbsp;client.</span><br>
<span class="lineno">15</span><span class="comment" id="3557701">//</span><br>
<span class="lineno"></span><span class="comment" id="3557704">//&nbsp;Reader,&nbsp;to&nbsp;read&nbsp;numeric&nbsp;response&nbsp;code&nbsp;lines,</span><br>
<span class="lineno"></span><span class="comment" id="3557752">//&nbsp;key:&nbsp;value&nbsp;headers,&nbsp;lines&nbsp;wrapped&nbsp;with&nbsp;leading&nbsp;spaces</span><br>
<span class="lineno"></span><span class="comment" id="3557809">//&nbsp;on&nbsp;continuation&nbsp;lines,&nbsp;and&nbsp;whole&nbsp;text&nbsp;blocks&nbsp;ending</span><br>
<span class="lineno"></span><span class="comment" id="3557864">//&nbsp;with&nbsp;a&nbsp;dot&nbsp;on&nbsp;a&nbsp;line&nbsp;by&nbsp;itself.</span><br>
<span class="lineno">20</span><span class="comment" id="3557899">//</span><br>
<span class="lineno"></span><span class="comment" id="3557902">//&nbsp;Writer,&nbsp;to&nbsp;write&nbsp;dot-encoded&nbsp;text&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="comment" id="3557947">//</span><br>
<span class="lineno"></span><span class="comment" id="3557950">//&nbsp;Conn,&nbsp;a&nbsp;convenient&nbsp;packaging&nbsp;of&nbsp;Reader,&nbsp;Writer,&nbsp;and&nbsp;Pipeline&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="3558022">//&nbsp;with&nbsp;a&nbsp;single&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">25</span><span class="comment" id="3558059">//</span><br>
<span class="lineno"></span><span class="keyword" id="3558062">package</span>&nbsp;<span class="ident" id="3558070">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3558081">import</span>&nbsp;<span class="op" id="3558088">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3558091">&#34;bufio&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3558100">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3558107">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3558113">&#34;net&#34;</span><br>
<span class="lineno"></span><span class="op" id="3558119">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3558122">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="3558185">type</span>&nbsp;<span class="ident" id="3558190">Error</span>&nbsp;<span class="keyword" id="3558196">struct</span>&nbsp;<span class="op" id="3558203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558206">Code</span>&nbsp;<span class="builtintype" id="3558211">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558216">Msg</span>&nbsp;&nbsp;<span class="builtintype" id="3558221">string</span><br>
<span class="lineno"></span><span class="op" id="3558228">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3558231">func</span>&nbsp;<span class="op" id="3558236">(</span><span class="ident" id="3558237">e</span>&nbsp;<span class="op" id="3558239">*</span><span class="ident" id="3558240">Error</span><span class="op" id="3558245">)</span>&nbsp;<span class="ident" id="3558247">Error</span><span class="op" id="3558252">(</span><span class="op" id="3558253">)</span>&nbsp;<span class="builtintype" id="3558255">string</span>&nbsp;<span class="op" id="3558262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3558265">return</span>&nbsp;<span class="ident" id="3558272">fmt</span><span class="op" id="3558275">.</span><span class="ident" id="3558276">Sprintf</span><span class="op" id="3558283">(</span><span class="string" id="3558284">&#34;%03d&nbsp;%s&#34;</span><span class="op" id="3558293">,</span>&nbsp;<span class="ident" id="3558295">e</span><span class="op" id="3558296">.</span><span class="ident" id="3558297">Code</span><span class="op" id="3558301">,</span>&nbsp;<span class="ident" id="3558303">e</span><span class="op" id="3558304">.</span><span class="ident" id="3558305">Msg</span><span class="op" id="3558308">)</span><br>
<span class="lineno"></span><span class="op" id="3558310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3558313">//&nbsp;A&nbsp;ProtocolError&nbsp;describes&nbsp;a&nbsp;protocol&nbsp;violation&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="3558368">//&nbsp;as&nbsp;an&nbsp;invalid&nbsp;response&nbsp;or&nbsp;a&nbsp;hung-up&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3558419">type</span>&nbsp;<span class="ident" id="3558424">ProtocolError</span>&nbsp;<span class="builtintype" id="3558438">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3558446">func</span>&nbsp;<span class="op" id="3558451">(</span><span class="ident" id="3558452">p</span>&nbsp;<span class="ident" id="3558454">ProtocolError</span><span class="op" id="3558467">)</span>&nbsp;<span class="ident" id="3558469">Error</span><span class="op" id="3558474">(</span><span class="op" id="3558475">)</span>&nbsp;<span class="builtintype" id="3558477">string</span>&nbsp;<span class="op" id="3558484">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3558487">return</span>&nbsp;<span class="builtintype" id="3558494">string</span><span class="op" id="3558500">(</span><span class="ident" id="3558501">p</span><span class="op" id="3558502">)</span><br>
<span class="lineno"></span><span class="op" id="3558504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3558507">//&nbsp;A&nbsp;Conn&nbsp;represents&nbsp;a&nbsp;textual&nbsp;network&nbsp;protocol&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3558567">//&nbsp;It&nbsp;consists&nbsp;of&nbsp;a&nbsp;Reader&nbsp;and&nbsp;Writer&nbsp;to&nbsp;manage&nbsp;I/O</span><br>
<span class="lineno">55</span><span class="comment" id="3558619">//&nbsp;and&nbsp;a&nbsp;Pipeline&nbsp;to&nbsp;sequence&nbsp;concurrent&nbsp;requests&nbsp;on&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="3558688">//&nbsp;These&nbsp;embedded&nbsp;types&nbsp;carry&nbsp;methods&nbsp;with&nbsp;them;</span><br>
<span class="lineno"></span><span class="comment" id="3558737">//&nbsp;see&nbsp;the&nbsp;documentation&nbsp;of&nbsp;those&nbsp;types&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="3558790">type</span>&nbsp;<span class="ident" id="3558795">Conn</span>&nbsp;<span class="keyword" id="3558800">struct</span>&nbsp;<span class="op" id="3558807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558810">Reader</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558818">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558826">Pipeline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558836">conn</span>&nbsp;<span class="ident" id="3558841">io</span><span class="op" id="3558843">.</span><span class="ident" id="3558844">ReadWriteCloser</span><br>
<span class="lineno"></span><span class="op" id="3558860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="3558863">//&nbsp;NewConn&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;using&nbsp;conn&nbsp;for&nbsp;I/O.</span><br>
<span class="lineno"></span><span class="keyword" id="3558913">func</span>&nbsp;<span class="ident" id="3558918">NewConn</span><span class="op" id="3558925">(</span><span class="ident" id="3558926">conn</span>&nbsp;<span class="ident" id="3558931">io</span><span class="op" id="3558933">.</span><span class="ident" id="3558934">ReadWriteCloser</span><span class="op" id="3558949">)</span>&nbsp;<span class="op" id="3558951">*</span><span class="ident" id="3558952">Conn</span>&nbsp;<span class="op" id="3558957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3558960">return</span>&nbsp;<span class="op" id="3558967">&amp;</span><span class="ident" id="3558968">Conn</span><span class="op" id="3558972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3558976">Reader</span><span class="op" id="3558982">:</span>&nbsp;<span class="ident" id="3558984">Reader</span><span class="op" id="3558990">{</span><span class="ident" id="3558991">R</span><span class="op" id="3558992">:</span>&nbsp;<span class="ident" id="3558994">bufio</span><span class="op" id="3558999">.</span><span class="ident" id="3559000">NewReader</span><span class="op" id="3559009">(</span><span class="ident" id="3559010">conn</span><span class="op" id="3559014">)</span><span class="op" id="3559015">}</span><span class="op" id="3559016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559020">Writer</span><span class="op" id="3559026">:</span>&nbsp;<span class="ident" id="3559028">Writer</span><span class="op" id="3559034">{</span><span class="ident" id="3559035">W</span><span class="op" id="3559036">:</span>&nbsp;<span class="ident" id="3559038">bufio</span><span class="op" id="3559043">.</span><span class="ident" id="3559044">NewWriter</span><span class="op" id="3559053">(</span><span class="ident" id="3559054">conn</span><span class="op" id="3559058">)</span><span class="op" id="3559059">}</span><span class="op" id="3559060">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559064">conn</span><span class="op" id="3559068">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3559072">conn</span><span class="op" id="3559076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3559079">}</span><br>
<span class="lineno"></span><span class="op" id="3559081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3559084">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">75</span><span class="keyword" id="3559116">func</span>&nbsp;<span class="op" id="3559121">(</span><span class="ident" id="3559122">c</span>&nbsp;<span class="op" id="3559124">*</span><span class="ident" id="3559125">Conn</span><span class="op" id="3559129">)</span>&nbsp;<span class="ident" id="3559131">Close</span><span class="op" id="3559136">(</span><span class="op" id="3559137">)</span>&nbsp;<span class="builtintype" id="3559139">error</span>&nbsp;<span class="op" id="3559145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3559148">return</span>&nbsp;<span class="ident" id="3559155">c</span><span class="op" id="3559156">.</span><span class="ident" id="3559157">conn</span><span class="op" id="3559161">.</span><span class="ident" id="3559162">Close</span><span class="op" id="3559167">(</span><span class="op" id="3559168">)</span><br>
<span class="lineno"></span><span class="op" id="3559170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3559173">//&nbsp;Dial&nbsp;connects&nbsp;to&nbsp;the&nbsp;given&nbsp;address&nbsp;on&nbsp;the&nbsp;given&nbsp;network&nbsp;using&nbsp;net.Dial</span><br>
<span class="lineno">80</span><span class="comment" id="3559247">//&nbsp;and&nbsp;then&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="3559298">func</span>&nbsp;<span class="ident" id="3559303">Dial</span><span class="op" id="3559307">(</span><span class="ident" id="3559308">network</span><span class="op" id="3559315">,</span>&nbsp;<span class="ident" id="3559317">addr</span>&nbsp;<span class="builtintype" id="3559322">string</span><span class="op" id="3559328">)</span>&nbsp;<span class="op" id="3559330">(</span><span class="op" id="3559331">*</span><span class="ident" id="3559332">Conn</span><span class="op" id="3559336">,</span>&nbsp;<span class="builtintype" id="3559338">error</span><span class="op" id="3559343">)</span>&nbsp;<span class="op" id="3559345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3559348">c</span><span class="op" id="3559349">,</span>&nbsp;<span class="ident" id="3559351">err</span>&nbsp;<span class="op" id="3559355">:=</span>&nbsp;<span class="ident" id="3559358">net</span><span class="op" id="3559361">.</span><span class="ident" id="3559362">Dial</span><span class="op" id="3559366">(</span><span class="ident" id="3559367">network</span><span class="op" id="3559374">,</span>&nbsp;<span class="ident" id="3559376">addr</span><span class="op" id="3559380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3559383">if</span>&nbsp;<span class="ident" id="3559386">err</span>&nbsp;<span class="op" id="3559390">!=</span>&nbsp;<span class="ident" id="3559393">nil</span>&nbsp;<span class="op" id="3559397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3559401">return</span>&nbsp;<span class="ident" id="3559408">nil</span><span class="op" id="3559411">,</span>&nbsp;<span class="ident" id="3559413">err</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3559418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3559421">return</span>&nbsp;<span class="ident" id="3559428">NewConn</span><span class="op" id="3559435">(</span><span class="ident" id="3559436">c</span><span class="op" id="3559437">)</span><span class="op" id="3559438">,</span>&nbsp;<span class="ident" id="3559440">nil</span><br>
<span class="lineno"></span><span class="op" id="3559444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3559447">//&nbsp;Cmd&nbsp;is&nbsp;a&nbsp;convenience&nbsp;method&nbsp;that&nbsp;sends&nbsp;a&nbsp;command&nbsp;after</span><br>
<span class="lineno">90</span><span class="comment" id="3559505">//&nbsp;waiting&nbsp;its&nbsp;turn&nbsp;in&nbsp;the&nbsp;pipeline.&nbsp;&nbsp;The&nbsp;command&nbsp;text&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3559567">//&nbsp;result&nbsp;of&nbsp;formatting&nbsp;format&nbsp;with&nbsp;args&nbsp;and&nbsp;appending&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="comment" id="3559628">//&nbsp;Cmd&nbsp;returns&nbsp;the&nbsp;id&nbsp;of&nbsp;the&nbsp;command,&nbsp;for&nbsp;use&nbsp;with&nbsp;StartResponse&nbsp;and&nbsp;EndResponse.</span><br>
<span class="lineno"></span><span class="comment" id="3559710">//</span><br>
<span class="lineno"></span><span class="comment" id="3559713">//&nbsp;For&nbsp;example,&nbsp;a&nbsp;client&nbsp;might&nbsp;run&nbsp;a&nbsp;HELP&nbsp;command&nbsp;that&nbsp;returns&nbsp;a&nbsp;dot-body</span><br>
<span class="lineno">95</span><span class="comment" id="3559787">//&nbsp;by&nbsp;using:</span><br>
<span class="lineno"></span><span class="comment" id="3559800">//</span><br>
<span class="lineno"></span><span class="comment" id="3559803">//&nbsp;&nbsp;&nbsp;&nbspid,&nbsp;err&nbsp;:=&nbsp;c.Cmd(&#34;HELP&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3559831">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3559850">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno">100</span><span class="comment" id="3559870">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3559875">//</span><br>
<span class="lineno"></span><span class="comment" id="3559878">//&nbsp;&nbsp;&nbsp;&nbspc.StartResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="3559901">//&nbsp;&nbsp;&nbsp;&nbspdefer&nbsp;c.EndResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="3559928">//</span><br>
<span class="lineno">105</span><span class="comment" id="3559931">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;_,&nbsp;_,&nbsp;err&nbsp;=&nbsp;c.ReadCodeLine(110);&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3559983">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="3560003">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3560008">//&nbsp;&nbsp;&nbsp;&nbsptext,&nbsp;err&nbsp;:=&nbsp;c.ReadDotBytes()</span><br>
<span class="lineno"></span><span class="comment" id="3560041">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno">110</span><span class="comment" id="3560060">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="3560080">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="3560085">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;c.ReadCodeLine(250)</span><br>
<span class="lineno"></span><span class="comment" id="3560115">//</span><br>
<span class="lineno"></span><span class="keyword" id="3560118">func</span>&nbsp;<span class="op" id="3560123">(</span><span class="ident" id="3560124">c</span>&nbsp;<span class="op" id="3560126">*</span><span class="ident" id="3560127">Conn</span><span class="op" id="3560131">)</span>&nbsp;<span class="ident" id="3560133">Cmd</span><span class="op" id="3560136">(</span><span class="ident" id="3560137">format</span>&nbsp;<span class="builtintype" id="3560144">string</span><span class="op" id="3560150">,</span>&nbsp;<span class="ident" id="3560152">args</span>&nbsp;<span class="op" id="3560157">...</span><span class="keyword" id="3560160">interface</span><span class="op" id="3560169">{</span><span class="op" id="3560170">}</span><span class="op" id="3560171">)</span>&nbsp;<span class="op" id="3560173">(</span><span class="ident" id="3560174">id</span>&nbsp;<span class="builtintype" id="3560177">uint</span><span class="op" id="3560181">,</span>&nbsp;<span class="ident" id="3560183">err</span>&nbsp;<span class="builtintype" id="3560187">error</span><span class="op" id="3560192">)</span>&nbsp;<span class="op" id="3560194">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3560197">id</span>&nbsp;<span class="op" id="3560200">=</span>&nbsp;<span class="ident" id="3560202">c</span><span class="op" id="3560203">.</span><span class="ident" id="3560204">Next</span><span class="op" id="3560208">(</span><span class="op" id="3560209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3560212">c</span><span class="op" id="3560213">.</span><span class="ident" id="3560214">StartRequest</span><span class="op" id="3560226">(</span><span class="ident" id="3560227">id</span><span class="op" id="3560229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3560232">err</span>&nbsp;<span class="op" id="3560236">=</span>&nbsp;<span class="ident" id="3560238">c</span><span class="op" id="3560239">.</span><span class="ident" id="3560240">PrintfLine</span><span class="op" id="3560250">(</span><span class="ident" id="3560251">format</span><span class="op" id="3560257">,</span>&nbsp;<span class="ident" id="3560259">args</span><span class="op" id="3560263">...</span><span class="op" id="3560266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3560269">c</span><span class="op" id="3560270">.</span><span class="ident" id="3560271">EndRequest</span><span class="op" id="3560281">(</span><span class="ident" id="3560282">id</span><span class="op" id="3560284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560287">if</span>&nbsp;<span class="ident" id="3560290">err</span>&nbsp;<span class="op" id="3560294">!=</span>&nbsp;<span class="ident" id="3560297">nil</span>&nbsp;<span class="op" id="3560301">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560305">return</span>&nbsp;<span class="num" id="3560312">0</span><span class="op" id="3560313">,</span>&nbsp;<span class="ident" id="3560315">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3560320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560323">return</span>&nbsp;<span class="ident" id="3560330">id</span><span class="op" id="3560332">,</span>&nbsp;<span class="ident" id="3560334">nil</span><br>
<span class="lineno"></span><span class="op" id="3560338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="3560341">//&nbsp;TrimString&nbsp;returns&nbsp;s&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3560407">func</span>&nbsp;<span class="ident" id="3560412">TrimString</span><span class="op" id="3560422">(</span><span class="ident" id="3560423">s</span>&nbsp;<span class="builtintype" id="3560425">string</span><span class="op" id="3560431">)</span>&nbsp;<span class="builtintype" id="3560433">string</span>&nbsp;<span class="op" id="3560440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560443">for</span>&nbsp;<span class="builtinfunc" id="3560447">len</span><span class="op" id="3560450">(</span><span class="ident" id="3560451">s</span><span class="op" id="3560452">)</span>&nbsp;<span class="op" id="3560454">&gt;</span>&nbsp;<span class="num" id="3560456">0</span>&nbsp;<span class="op" id="3560458">&amp;&amp;</span>&nbsp;<span class="ident" id="3560461">isASCIISpace</span><span class="op" id="3560473">(</span><span class="ident" id="3560474">s</span><span class="op" id="3560475">[</span><span class="num" id="3560476">0</span><span class="op" id="3560477">]</span><span class="op" id="3560478">)</span>&nbsp;<span class="op" id="3560480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3560484">s</span>&nbsp;<span class="op" id="3560486">=</span>&nbsp;<span class="ident" id="3560488">s</span><span class="op" id="3560489">[</span><span class="num" id="3560490">1</span><span class="op" id="3560491">:</span><span class="op" id="3560492">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3560495">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560498">for</span>&nbsp;<span class="builtinfunc" id="3560502">len</span><span class="op" id="3560505">(</span><span class="ident" id="3560506">s</span><span class="op" id="3560507">)</span>&nbsp;<span class="op" id="3560509">&gt;</span>&nbsp;<span class="num" id="3560511">0</span>&nbsp;<span class="op" id="3560513">&amp;&amp;</span>&nbsp;<span class="ident" id="3560516">isASCIISpace</span><span class="op" id="3560528">(</span><span class="ident" id="3560529">s</span><span class="op" id="3560530">[</span><span class="builtinfunc" id="3560531">len</span><span class="op" id="3560534">(</span><span class="ident" id="3560535">s</span><span class="op" id="3560536">)</span><span class="op" id="3560537">-</span><span class="num" id="3560538">1</span><span class="op" id="3560539">]</span><span class="op" id="3560540">)</span>&nbsp;<span class="op" id="3560542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3560546">s</span>&nbsp;<span class="op" id="3560548">=</span>&nbsp;<span class="ident" id="3560550">s</span><span class="op" id="3560551">[</span><span class="op" id="3560552">:</span><span class="builtinfunc" id="3560553">len</span><span class="op" id="3560556">(</span><span class="ident" id="3560557">s</span><span class="op" id="3560558">)</span><span class="op" id="3560559">-</span><span class="num" id="3560560">1</span><span class="op" id="3560561">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3560564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560567">return</span>&nbsp;<span class="ident" id="3560574">s</span><br>
<span class="lineno"></span><span class="op" id="3560576">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="3560579">//&nbsp;TrimBytes&nbsp;returns&nbsp;b&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3560644">func</span>&nbsp;<span class="ident" id="3560649">TrimBytes</span><span class="op" id="3560658">(</span><span class="ident" id="3560659">b</span>&nbsp;<span class="op" id="3560661">[</span><span class="op" id="3560662">]</span><span class="builtintype" id="3560663">byte</span><span class="op" id="3560667">)</span>&nbsp;<span class="op" id="3560669">[</span><span class="op" id="3560670">]</span><span class="builtintype" id="3560671">byte</span>&nbsp;<span class="op" id="3560676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560679">for</span>&nbsp;<span class="builtinfunc" id="3560683">len</span><span class="op" id="3560686">(</span><span class="ident" id="3560687">b</span><span class="op" id="3560688">)</span>&nbsp;<span class="op" id="3560690">&gt;</span>&nbsp;<span class="num" id="3560692">0</span>&nbsp;<span class="op" id="3560694">&amp;&amp;</span>&nbsp;<span class="ident" id="3560697">isASCIISpace</span><span class="op" id="3560709">(</span><span class="ident" id="3560710">b</span><span class="op" id="3560711">[</span><span class="num" id="3560712">0</span><span class="op" id="3560713">]</span><span class="op" id="3560714">)</span>&nbsp;<span class="op" id="3560716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3560720">b</span>&nbsp;<span class="op" id="3560722">=</span>&nbsp;<span class="ident" id="3560724">b</span><span class="op" id="3560725">[</span><span class="num" id="3560726">1</span><span class="op" id="3560727">:</span><span class="op" id="3560728">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3560731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560734">for</span>&nbsp;<span class="builtinfunc" id="3560738">len</span><span class="op" id="3560741">(</span><span class="ident" id="3560742">b</span><span class="op" id="3560743">)</span>&nbsp;<span class="op" id="3560745">&gt;</span>&nbsp;<span class="num" id="3560747">0</span>&nbsp;<span class="op" id="3560749">&amp;&amp;</span>&nbsp;<span class="ident" id="3560752">isASCIISpace</span><span class="op" id="3560764">(</span><span class="ident" id="3560765">b</span><span class="op" id="3560766">[</span><span class="builtinfunc" id="3560767">len</span><span class="op" id="3560770">(</span><span class="ident" id="3560771">b</span><span class="op" id="3560772">)</span><span class="op" id="3560773">-</span><span class="num" id="3560774">1</span><span class="op" id="3560775">]</span><span class="op" id="3560776">)</span>&nbsp;<span class="op" id="3560778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3560782">b</span>&nbsp;<span class="op" id="3560784">=</span>&nbsp;<span class="ident" id="3560786">b</span><span class="op" id="3560787">[</span><span class="op" id="3560788">:</span><span class="builtinfunc" id="3560789">len</span><span class="op" id="3560792">(</span><span class="ident" id="3560793">b</span><span class="op" id="3560794">)</span><span class="op" id="3560795">-</span><span class="num" id="3560796">1</span><span class="op" id="3560797">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3560800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560803">return</span>&nbsp;<span class="ident" id="3560810">b</span><br>
<span class="lineno">145</span><span class="op" id="3560812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3560815">func</span>&nbsp;<span class="ident" id="3560820">isASCIISpace</span><span class="op" id="3560832">(</span><span class="ident" id="3560833">b</span>&nbsp;<span class="builtintype" id="3560835">byte</span><span class="op" id="3560839">)</span>&nbsp;<span class="builtintype" id="3560841">bool</span>&nbsp;<span class="op" id="3560846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560849">return</span>&nbsp;<span class="ident" id="3560856">b</span>&nbsp;<span class="op" id="3560858">==</span>&nbsp;<span class="string" id="3560861">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3560865">||</span>&nbsp;<span class="ident" id="3560868">b</span>&nbsp;<span class="op" id="3560870">==</span>&nbsp;<span class="string" id="3560873">&#39;\t&#39;</span>&nbsp;<span class="op" id="3560878">||</span>&nbsp;<span class="ident" id="3560881">b</span>&nbsp;<span class="op" id="3560883">==</span>&nbsp;<span class="string" id="3560886">&#39;\n&#39;</span>&nbsp;<span class="op" id="3560891">||</span>&nbsp;<span class="ident" id="3560894">b</span>&nbsp;<span class="op" id="3560896">==</span>&nbsp;<span class="string" id="3560899">&#39;\r&#39;</span><br>
<span class="lineno"></span><span class="op" id="3560904">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="3560907">func</span>&nbsp;<span class="ident" id="3560912">isASCIILetter</span><span class="op" id="3560925">(</span><span class="ident" id="3560926">b</span>&nbsp;<span class="builtintype" id="3560928">byte</span><span class="op" id="3560932">)</span>&nbsp;<span class="builtintype" id="3560934">bool</span>&nbsp;<span class="op" id="3560939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3560942">b</span>&nbsp;<span class="op" id="3560944">|=</span>&nbsp;<span class="num" id="3560947">0x20</span>&nbsp;<span class="comment" id="3560952">//&nbsp;make&nbsp;lower&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3560972">return</span>&nbsp;<span class="string" id="3560979">&#39;a&#39;</span>&nbsp;<span class="op" id="3560983">&lt;=</span>&nbsp;<span class="ident" id="3560986">b</span>&nbsp;<span class="op" id="3560988">&amp;&amp;</span>&nbsp;<span class="ident" id="3560991">b</span>&nbsp;<span class="op" id="3560993">&lt;=</span>&nbsp;<span class="string" id="3560996">&#39;z&#39;</span><br>
<span class="lineno"></span><span class="op" id="3561000">}</span>
</div>
</body>
</html>
