<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword">package</span>&nbsp;<span class="ident">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;InstArch8&nbsp;dispatches&nbsp;and&nbsp;executes&nbsp;an&nbsp;arch8&nbsp;instruction.</span><br>
<span class="lineno"></span><span class="keyword">type</span>&nbsp;<span class="ident">instArch8</span>&nbsp;<span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">reg</span>&nbsp;<span class="ident">instReg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">imm</span>&nbsp;<span class="ident">instImm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">br</span>&nbsp;&nbsp;<span class="ident">instBr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">sys</span>&nbsp;<span class="ident">instSys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">jmp</span>&nbsp;<span class="ident">instJmp</span><br>
<span class="lineno">10</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment">//&nbsp;I&nbsp;executes&nbsp;an&nbsp;arch8&nbsp;instructino</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="op">(</span><span class="ident">i</span>&nbsp;<span class="op">*</span><span class="ident">instArch8</span><span class="op">)</span>&nbsp;<span class="ident">I</span><span class="op">(</span><span class="ident">cpu</span>&nbsp;<span class="op">*</span><span class="ident">cpu</span><span class="op">,</span>&nbsp;<span class="ident">in</span>&nbsp;<span class="builtintype">uint32</span><span class="op">)</span>&nbsp;<span class="op">*</span><span class="ident">Excep</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">(</span><span class="ident">in</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">31</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">op</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">(</span><span class="ident">in</span>&nbsp;<span class="op">&gt;&gt;</span>&nbsp;<span class="num">24</span><span class="op">)</span>&nbsp;<span class="op">&amp;</span>&nbsp;<span class="num">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">switch</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">op</span>&nbsp;<span class="op">==</span>&nbsp;<span class="num">0</span><span class="op">:</span>&nbsp;<span class="comment">//&nbsp;op&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">i</span><span class="op">.</span><span class="ident">reg</span><span class="op">.</span><span class="ident">I</span><span class="op">(</span><span class="ident">cpu</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">op</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">32</span><span class="op">:</span>&nbsp;<span class="comment">//&nbsp;op&nbsp;in&nbsp;(0,&nbsp;32)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">i</span><span class="op">.</span><span class="ident">imm</span><span class="op">.</span><span class="ident">I</span><span class="op">(</span><span class="ident">cpu</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">op</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">64</span><span class="op">:</span>&nbsp;<span class="comment">//&nbsp;op&nbsp;in&nbsp;[32,&nbsp;64)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">i</span><span class="op">.</span><span class="ident">br</span><span class="op">.</span><span class="ident">I</span><span class="op">(</span><span class="ident">cpu</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">case</span>&nbsp;<span class="ident">op</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="num">128</span><span class="op">:</span>&nbsp;<span class="comment">//&nbsp;op&nbsp;in&nbsp;[64,&nbsp;128)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">i</span><span class="op">.</span><span class="ident">sys</span><span class="op">.</span><span class="ident">I</span><span class="op">(</span><span class="ident">cpu</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">default</span><span class="op">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc">panic</span><span class="op">(</span><span class="string">&#34;bug&#34;</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">i</span><span class="op">.</span><span class="ident">jmp</span><span class="op">.</span><span class="ident">I</span><span class="op">(</span><span class="ident">cpu</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span>
</div>
</body>
</html>
