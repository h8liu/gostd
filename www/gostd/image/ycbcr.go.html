<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>image</h2>
<ul>
<li><a href="/gostd/image/decode_example_test.go.html">decode_example_test.go</a></li>
<li><a href="/gostd/image/decode_test.go.html">decode_test.go</a></li>
<li><a href="/gostd/image/format.go.html">format.go</a></li>
<li><a href="/gostd/image/geom.go.html">geom.go</a></li>
<li><a href="/gostd/image/image.go.html">image.go</a></li>
<li><a href="/gostd/image/image_test.go.html">image_test.go</a></li>
<li><a href="/gostd/image/names.go.html">names.go</a></li>
<li><a href="/gostd/image/ycbcr.go.html">ycbcr.go</a></li>
<li><a href="/gostd/image/ycbcr_test.go.html">ycbcr_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4080523">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4080578">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4080632">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4080683">package</span>&nbsp;<span class="ident" id="4080691">image</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4080698">import</span>&nbsp;<span class="op" id="4080705">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4080708">&#34;image/color&#34;</span><br>
<span class="lineno"></span><span class="op" id="4080722">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4080725">//&nbsp;YCbCrSubsampleRatio&nbsp;is&nbsp;the&nbsp;chroma&nbsp;subsample&nbsp;ratio&nbsp;used&nbsp;in&nbsp;a&nbsp;YCbCr&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="4080801">type</span>&nbsp;<span class="ident" id="4080806">YCbCrSubsampleRatio</span>&nbsp;<span class="builtintype" id="4080826">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4080831">const</span>&nbsp;<span class="op" id="4080837">(</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080840">YCbCrSubsampleRatio444</span>&nbsp;<span class="ident" id="4080863">YCbCrSubsampleRatio</span>&nbsp;<span class="op" id="4080883">=</span>&nbsp;<span class="ident" id="4080885">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080891">YCbCrSubsampleRatio422</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080915">YCbCrSubsampleRatio420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4080939">YCbCrSubsampleRatio440</span><br>
<span class="lineno"></span><span class="op" id="4080962">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="4080965">func</span>&nbsp;<span class="op" id="4080970">(</span><span class="ident" id="4080971">s</span>&nbsp;<span class="ident" id="4080973">YCbCrSubsampleRatio</span><span class="op" id="4080992">)</span>&nbsp;<span class="ident" id="4080994">String</span><span class="op" id="4081000">(</span><span class="op" id="4081001">)</span>&nbsp;<span class="builtintype" id="4081003">string</span>&nbsp;<span class="op" id="4081010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081013">switch</span>&nbsp;<span class="ident" id="4081020">s</span>&nbsp;<span class="op" id="4081022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081025">case</span>&nbsp;<span class="ident" id="4081030">YCbCrSubsampleRatio444</span><span class="op" id="4081052">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081056">return</span>&nbsp;<span class="string" id="4081063">&#34;YCbCrSubsampleRatio444&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081089">case</span>&nbsp;<span class="ident" id="4081094">YCbCrSubsampleRatio422</span><span class="op" id="4081116">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081120">return</span>&nbsp;<span class="string" id="4081127">&#34;YCbCrSubsampleRatio422&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081153">case</span>&nbsp;<span class="ident" id="4081158">YCbCrSubsampleRatio420</span><span class="op" id="4081180">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081184">return</span>&nbsp;<span class="string" id="4081191">&#34;YCbCrSubsampleRatio420&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081217">case</span>&nbsp;<span class="ident" id="4081222">YCbCrSubsampleRatio440</span><span class="op" id="4081244">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081248">return</span>&nbsp;<span class="string" id="4081255">&#34;YCbCrSubsampleRatio440&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4081281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4081284">return</span>&nbsp;<span class="string" id="4081291">&#34;YCbCrSubsampleRatioUnknown&#34;</span><br>
<span class="lineno"></span><span class="op" id="4081320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4081323">//&nbsp;YCbCr&nbsp;is&nbsp;an&nbsp;in-memory&nbsp;image&nbsp;of&nbsp;Y&#39;CbCr&nbsp;colors.&nbsp;There&nbsp;is&nbsp;one&nbsp;Y&nbsp;sample&nbsp;per</span><br>
<span class="lineno"></span><span class="comment" id="4081398">//&nbsp;pixel,&nbsp;but&nbsp;each&nbsp;Cb&nbsp;and&nbsp;Cr&nbsp;sample&nbsp;can&nbsp;span&nbsp;one&nbsp;or&nbsp;more&nbsp;pixels.</span><br>
<span class="lineno"></span><span class="comment" id="4081463">//&nbsp;YStride&nbsp;is&nbsp;the&nbsp;Y&nbsp;slice&nbsp;index&nbsp;delta&nbsp;between&nbsp;vertically&nbsp;adjacent&nbsp;pixels.</span><br>
<span class="lineno"></span><span class="comment" id="4081537">//&nbsp;CStride&nbsp;is&nbsp;the&nbsp;Cb&nbsp;and&nbsp;Cr&nbsp;slice&nbsp;index&nbsp;delta&nbsp;between&nbsp;vertically&nbsp;adjacent&nbsp;pixels</span><br>
<span class="lineno"></span><span class="comment" id="4081618">//&nbsp;that&nbsp;map&nbsp;to&nbsp;separate&nbsp;chroma&nbsp;samples.</span><br>
<span class="lineno">40</span><span class="comment" id="4081658">//&nbsp;It&nbsp;is&nbsp;not&nbsp;an&nbsp;absolute&nbsp;requirement,&nbsp;but&nbsp;YStride&nbsp;and&nbsp;len(Y)&nbsp;are&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="4081733">//&nbsp;multiples&nbsp;of&nbsp;8,&nbsp;and:</span><br>
<span class="lineno"></span><span class="comment" id="4081757">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:4:4,&nbsp;CStride&nbsp;==&nbsp;YStride/1&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/1.</span><br>
<span class="lineno"></span><span class="comment" id="4081827">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:2:2,&nbsp;CStride&nbsp;==&nbsp;YStride/2&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/2.</span><br>
<span class="lineno"></span><span class="comment" id="4081897">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:2:0,&nbsp;CStride&nbsp;==&nbsp;YStride/2&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/4.</span><br>
<span class="lineno">45</span><span class="comment" id="4081967">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:4:0,&nbsp;CStride&nbsp;==&nbsp;YStride/1&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="4082037">type</span>&nbsp;<span class="ident" id="4082042">YCbCr</span>&nbsp;<span class="keyword" id="4082048">struct</span>&nbsp;<span class="op" id="4082055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082058">Y</span><span class="op" id="4082059">,</span>&nbsp;<span class="ident" id="4082061">Cb</span><span class="op" id="4082063">,</span>&nbsp;<span class="ident" id="4082065">Cr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4082073">[</span><span class="op" id="4082074">]</span><span class="builtintype" id="4082075">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082082">YStride</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4082097">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082102">CStride</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4082117">int</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082122">SubsampleRatio</span>&nbsp;<span class="ident" id="4082137">YCbCrSubsampleRatio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082158">Rect</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4082173">Rectangle</span><br>
<span class="lineno"></span><span class="op" id="4082183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4082186">func</span>&nbsp;<span class="op" id="4082191">(</span><span class="ident" id="4082192">p</span>&nbsp;<span class="op" id="4082194">*</span><span class="ident" id="4082195">YCbCr</span><span class="op" id="4082200">)</span>&nbsp;<span class="ident" id="4082202">ColorModel</span><span class="op" id="4082212">(</span><span class="op" id="4082213">)</span>&nbsp;<span class="ident" id="4082215">color</span><span class="op" id="4082220">.</span><span class="ident" id="4082221">Model</span>&nbsp;<span class="op" id="4082227">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082230">return</span>&nbsp;<span class="ident" id="4082237">color</span><span class="op" id="4082242">.</span><span class="ident" id="4082243">YCbCrModel</span><br>
<span class="lineno"></span><span class="op" id="4082254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4082257">func</span>&nbsp;<span class="op" id="4082262">(</span><span class="ident" id="4082263">p</span>&nbsp;<span class="op" id="4082265">*</span><span class="ident" id="4082266">YCbCr</span><span class="op" id="4082271">)</span>&nbsp;<span class="ident" id="4082273">Bounds</span><span class="op" id="4082279">(</span><span class="op" id="4082280">)</span>&nbsp;<span class="ident" id="4082282">Rectangle</span>&nbsp;<span class="op" id="4082292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082295">return</span>&nbsp;<span class="ident" id="4082302">p</span><span class="op" id="4082303">.</span><span class="ident" id="4082304">Rect</span><br>
<span class="lineno">60</span><span class="op" id="4082309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4082312">func</span>&nbsp;<span class="op" id="4082317">(</span><span class="ident" id="4082318">p</span>&nbsp;<span class="op" id="4082320">*</span><span class="ident" id="4082321">YCbCr</span><span class="op" id="4082326">)</span>&nbsp;<span class="ident" id="4082328">At</span><span class="op" id="4082330">(</span><span class="ident" id="4082331">x</span><span class="op" id="4082332">,</span>&nbsp;<span class="ident" id="4082334">y</span>&nbsp;<span class="builtintype" id="4082336">int</span><span class="op" id="4082339">)</span>&nbsp;<span class="ident" id="4082341">color</span><span class="op" id="4082346">.</span><span class="ident" id="4082347">Color</span>&nbsp;<span class="op" id="4082353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082356">return</span>&nbsp;<span class="ident" id="4082363">p</span><span class="op" id="4082364">.</span><span class="ident" id="4082365">YCbCrAt</span><span class="op" id="4082372">(</span><span class="ident" id="4082373">x</span><span class="op" id="4082374">,</span>&nbsp;<span class="ident" id="4082376">y</span><span class="op" id="4082377">)</span><br>
<span class="lineno"></span><span class="op" id="4082379">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="4082382">func</span>&nbsp;<span class="op" id="4082387">(</span><span class="ident" id="4082388">p</span>&nbsp;<span class="op" id="4082390">*</span><span class="ident" id="4082391">YCbCr</span><span class="op" id="4082396">)</span>&nbsp;<span class="ident" id="4082398">YCbCrAt</span><span class="op" id="4082405">(</span><span class="ident" id="4082406">x</span><span class="op" id="4082407">,</span>&nbsp;<span class="ident" id="4082409">y</span>&nbsp;<span class="builtintype" id="4082411">int</span><span class="op" id="4082414">)</span>&nbsp;<span class="ident" id="4082416">color</span><span class="op" id="4082421">.</span><span class="ident" id="4082422">YCbCr</span>&nbsp;<span class="op" id="4082428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082431">if</span>&nbsp;<span class="op" id="4082434">!</span><span class="op" id="4082435">(</span><span class="ident" id="4082436">Point</span><span class="op" id="4082441">{</span><span class="ident" id="4082442">x</span><span class="op" id="4082443">,</span>&nbsp;<span class="ident" id="4082445">y</span><span class="op" id="4082446">}</span><span class="op" id="4082447">.</span><span class="ident" id="4082448">In</span><span class="op" id="4082450">(</span><span class="ident" id="4082451">p</span><span class="op" id="4082452">.</span><span class="ident" id="4082453">Rect</span><span class="op" id="4082457">)</span><span class="op" id="4082458">)</span>&nbsp;<span class="op" id="4082460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082464">return</span>&nbsp;<span class="ident" id="4082471">color</span><span class="op" id="4082476">.</span><span class="ident" id="4082477">YCbCr</span><span class="op" id="4082482">{</span><span class="op" id="4082483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082486">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082489">yi</span>&nbsp;<span class="op" id="4082492">:=</span>&nbsp;<span class="ident" id="4082495">p</span><span class="op" id="4082496">.</span><span class="ident" id="4082497">YOffset</span><span class="op" id="4082504">(</span><span class="ident" id="4082505">x</span><span class="op" id="4082506">,</span>&nbsp;<span class="ident" id="4082508">y</span><span class="op" id="4082509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082512">ci</span>&nbsp;<span class="op" id="4082515">:=</span>&nbsp;<span class="ident" id="4082518">p</span><span class="op" id="4082519">.</span><span class="ident" id="4082520">COffset</span><span class="op" id="4082527">(</span><span class="ident" id="4082528">x</span><span class="op" id="4082529">,</span>&nbsp;<span class="ident" id="4082531">y</span><span class="op" id="4082532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082535">return</span>&nbsp;<span class="ident" id="4082542">color</span><span class="op" id="4082547">.</span><span class="ident" id="4082548">YCbCr</span><span class="op" id="4082553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082557">p</span><span class="op" id="4082558">.</span><span class="ident" id="4082559">Y</span><span class="op" id="4082560">[</span><span class="ident" id="4082561">yi</span><span class="op" id="4082563">]</span><span class="op" id="4082564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082568">p</span><span class="op" id="4082569">.</span><span class="ident" id="4082570">Cb</span><span class="op" id="4082572">[</span><span class="ident" id="4082573">ci</span><span class="op" id="4082575">]</span><span class="op" id="4082576">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4082580">p</span><span class="op" id="4082581">.</span><span class="ident" id="4082582">Cr</span><span class="op" id="4082584">[</span><span class="ident" id="4082585">ci</span><span class="op" id="4082587">]</span><span class="op" id="4082588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4082591">}</span><br>
<span class="lineno"></span><span class="op" id="4082593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4082596">//&nbsp;YOffset&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Y&nbsp;that&nbsp;corresponds&nbsp;to</span><br>
<span class="lineno">80</span><span class="comment" id="4082671">//&nbsp;the&nbsp;pixel&nbsp;at&nbsp;(x,&nbsp;y).</span><br>
<span class="lineno"></span><span class="keyword" id="4082695">func</span>&nbsp;<span class="op" id="4082700">(</span><span class="ident" id="4082701">p</span>&nbsp;<span class="op" id="4082703">*</span><span class="ident" id="4082704">YCbCr</span><span class="op" id="4082709">)</span>&nbsp;<span class="ident" id="4082711">YOffset</span><span class="op" id="4082718">(</span><span class="ident" id="4082719">x</span><span class="op" id="4082720">,</span>&nbsp;<span class="ident" id="4082722">y</span>&nbsp;<span class="builtintype" id="4082724">int</span><span class="op" id="4082727">)</span>&nbsp;<span class="builtintype" id="4082729">int</span>&nbsp;<span class="op" id="4082733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082736">return</span>&nbsp;<span class="op" id="4082743">(</span><span class="ident" id="4082744">y</span><span class="op" id="4082745">-</span><span class="ident" id="4082746">p</span><span class="op" id="4082747">.</span><span class="ident" id="4082748">Rect</span><span class="op" id="4082752">.</span><span class="ident" id="4082753">Min</span><span class="op" id="4082756">.</span><span class="ident" id="4082757">Y</span><span class="op" id="4082758">)</span><span class="op" id="4082759">*</span><span class="ident" id="4082760">p</span><span class="op" id="4082761">.</span><span class="ident" id="4082762">YStride</span>&nbsp;<span class="op" id="4082770">+</span>&nbsp;<span class="op" id="4082772">(</span><span class="ident" id="4082773">x</span>&nbsp;<span class="op" id="4082775">-</span>&nbsp;<span class="ident" id="4082777">p</span><span class="op" id="4082778">.</span><span class="ident" id="4082779">Rect</span><span class="op" id="4082783">.</span><span class="ident" id="4082784">Min</span><span class="op" id="4082787">.</span><span class="ident" id="4082788">X</span><span class="op" id="4082789">)</span><br>
<span class="lineno"></span><span class="op" id="4082791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4082794">//&nbsp;COffset&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Cb&nbsp;or&nbsp;Cr&nbsp;that&nbsp;corresponds</span><br>
<span class="lineno"></span><span class="comment" id="4082873">//&nbsp;to&nbsp;the&nbsp;pixel&nbsp;at&nbsp;(x,&nbsp;y).</span><br>
<span class="lineno"></span><span class="keyword" id="4082900">func</span>&nbsp;<span class="op" id="4082905">(</span><span class="ident" id="4082906">p</span>&nbsp;<span class="op" id="4082908">*</span><span class="ident" id="4082909">YCbCr</span><span class="op" id="4082914">)</span>&nbsp;<span class="ident" id="4082916">COffset</span><span class="op" id="4082923">(</span><span class="ident" id="4082924">x</span><span class="op" id="4082925">,</span>&nbsp;<span class="ident" id="4082927">y</span>&nbsp;<span class="builtintype" id="4082929">int</span><span class="op" id="4082932">)</span>&nbsp;<span class="builtintype" id="4082934">int</span>&nbsp;<span class="op" id="4082938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082941">switch</span>&nbsp;<span class="ident" id="4082948">p</span><span class="op" id="4082949">.</span><span class="ident" id="4082950">SubsampleRatio</span>&nbsp;<span class="op" id="4082965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082968">case</span>&nbsp;<span class="ident" id="4082973">YCbCrSubsampleRatio422</span><span class="op" id="4082995">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4082999">return</span>&nbsp;<span class="op" id="4083006">(</span><span class="ident" id="4083007">y</span><span class="op" id="4083008">-</span><span class="ident" id="4083009">p</span><span class="op" id="4083010">.</span><span class="ident" id="4083011">Rect</span><span class="op" id="4083015">.</span><span class="ident" id="4083016">Min</span><span class="op" id="4083019">.</span><span class="ident" id="4083020">Y</span><span class="op" id="4083021">)</span><span class="op" id="4083022">*</span><span class="ident" id="4083023">p</span><span class="op" id="4083024">.</span><span class="ident" id="4083025">CStride</span>&nbsp;<span class="op" id="4083033">+</span>&nbsp;<span class="op" id="4083035">(</span><span class="ident" id="4083036">x</span><span class="op" id="4083037">/</span><span class="num" id="4083038">2</span>&nbsp;<span class="op" id="4083040">-</span>&nbsp;<span class="ident" id="4083042">p</span><span class="op" id="4083043">.</span><span class="ident" id="4083044">Rect</span><span class="op" id="4083048">.</span><span class="ident" id="4083049">Min</span><span class="op" id="4083052">.</span><span class="ident" id="4083053">X</span><span class="op" id="4083054">/</span><span class="num" id="4083055">2</span><span class="op" id="4083056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083059">case</span>&nbsp;<span class="ident" id="4083064">YCbCrSubsampleRatio420</span><span class="op" id="4083086">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083090">return</span>&nbsp;<span class="op" id="4083097">(</span><span class="ident" id="4083098">y</span><span class="op" id="4083099">/</span><span class="num" id="4083100">2</span><span class="op" id="4083101">-</span><span class="ident" id="4083102">p</span><span class="op" id="4083103">.</span><span class="ident" id="4083104">Rect</span><span class="op" id="4083108">.</span><span class="ident" id="4083109">Min</span><span class="op" id="4083112">.</span><span class="ident" id="4083113">Y</span><span class="op" id="4083114">/</span><span class="num" id="4083115">2</span><span class="op" id="4083116">)</span><span class="op" id="4083117">*</span><span class="ident" id="4083118">p</span><span class="op" id="4083119">.</span><span class="ident" id="4083120">CStride</span>&nbsp;<span class="op" id="4083128">+</span>&nbsp;<span class="op" id="4083130">(</span><span class="ident" id="4083131">x</span><span class="op" id="4083132">/</span><span class="num" id="4083133">2</span>&nbsp;<span class="op" id="4083135">-</span>&nbsp;<span class="ident" id="4083137">p</span><span class="op" id="4083138">.</span><span class="ident" id="4083139">Rect</span><span class="op" id="4083143">.</span><span class="ident" id="4083144">Min</span><span class="op" id="4083147">.</span><span class="ident" id="4083148">X</span><span class="op" id="4083149">/</span><span class="num" id="4083150">2</span><span class="op" id="4083151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083154">case</span>&nbsp;<span class="ident" id="4083159">YCbCrSubsampleRatio440</span><span class="op" id="4083181">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083185">return</span>&nbsp;<span class="op" id="4083192">(</span><span class="ident" id="4083193">y</span><span class="op" id="4083194">/</span><span class="num" id="4083195">2</span><span class="op" id="4083196">-</span><span class="ident" id="4083197">p</span><span class="op" id="4083198">.</span><span class="ident" id="4083199">Rect</span><span class="op" id="4083203">.</span><span class="ident" id="4083204">Min</span><span class="op" id="4083207">.</span><span class="ident" id="4083208">Y</span><span class="op" id="4083209">/</span><span class="num" id="4083210">2</span><span class="op" id="4083211">)</span><span class="op" id="4083212">*</span><span class="ident" id="4083213">p</span><span class="op" id="4083214">.</span><span class="ident" id="4083215">CStride</span>&nbsp;<span class="op" id="4083223">+</span>&nbsp;<span class="op" id="4083225">(</span><span class="ident" id="4083226">x</span>&nbsp;<span class="op" id="4083228">-</span>&nbsp;<span class="ident" id="4083230">p</span><span class="op" id="4083231">.</span><span class="ident" id="4083232">Rect</span><span class="op" id="4083236">.</span><span class="ident" id="4083237">Min</span><span class="op" id="4083240">.</span><span class="ident" id="4083241">X</span><span class="op" id="4083242">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083248">//&nbsp;Default&nbsp;to&nbsp;4:4:4&nbsp;subsampling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083282">return</span>&nbsp;<span class="op" id="4083289">(</span><span class="ident" id="4083290">y</span><span class="op" id="4083291">-</span><span class="ident" id="4083292">p</span><span class="op" id="4083293">.</span><span class="ident" id="4083294">Rect</span><span class="op" id="4083298">.</span><span class="ident" id="4083299">Min</span><span class="op" id="4083302">.</span><span class="ident" id="4083303">Y</span><span class="op" id="4083304">)</span><span class="op" id="4083305">*</span><span class="ident" id="4083306">p</span><span class="op" id="4083307">.</span><span class="ident" id="4083308">CStride</span>&nbsp;<span class="op" id="4083316">+</span>&nbsp;<span class="op" id="4083318">(</span><span class="ident" id="4083319">x</span>&nbsp;<span class="op" id="4083321">-</span>&nbsp;<span class="ident" id="4083323">p</span><span class="op" id="4083324">.</span><span class="ident" id="4083325">Rect</span><span class="op" id="4083329">.</span><span class="ident" id="4083330">Min</span><span class="op" id="4083333">.</span><span class="ident" id="4083334">X</span><span class="op" id="4083335">)</span><br>
<span class="lineno"></span><span class="op" id="4083337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="4083340">//&nbsp;SubImage&nbsp;returns&nbsp;an&nbsp;image&nbsp;representing&nbsp;the&nbsp;portion&nbsp;of&nbsp;the&nbsp;image&nbsp;p&nbsp;visible</span><br>
<span class="lineno"></span><span class="comment" id="4083417">//&nbsp;through&nbsp;r.&nbsp;The&nbsp;returned&nbsp;value&nbsp;shares&nbsp;pixels&nbsp;with&nbsp;the&nbsp;original&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="4083489">func</span>&nbsp;<span class="op" id="4083494">(</span><span class="ident" id="4083495">p</span>&nbsp;<span class="op" id="4083497">*</span><span class="ident" id="4083498">YCbCr</span><span class="op" id="4083503">)</span>&nbsp;<span class="ident" id="4083505">SubImage</span><span class="op" id="4083513">(</span><span class="ident" id="4083514">r</span>&nbsp;<span class="ident" id="4083516">Rectangle</span><span class="op" id="4083525">)</span>&nbsp;<span class="ident" id="4083527">Image</span>&nbsp;<span class="op" id="4083533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083536">r</span>&nbsp;<span class="op" id="4083538">=</span>&nbsp;<span class="ident" id="4083540">r</span><span class="op" id="4083541">.</span><span class="ident" id="4083542">Intersect</span><span class="op" id="4083551">(</span><span class="ident" id="4083552">p</span><span class="op" id="4083553">.</span><span class="ident" id="4083554">Rect</span><span class="op" id="4083558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083561">//&nbsp;If&nbsp;r1&nbsp;and&nbsp;r2&nbsp;are&nbsp;Rectangles,&nbsp;r1.Intersect(r2)&nbsp;is&nbsp;not&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;inside</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083642">//&nbsp;either&nbsp;r1&nbsp;or&nbsp;r2&nbsp;if&nbsp;the&nbsp;intersection&nbsp;is&nbsp;empty.&nbsp;Without&nbsp;explicitly&nbsp;checking&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4083724">//&nbsp;this,&nbsp;the&nbsp;Pix[i:]&nbsp;expression&nbsp;below&nbsp;can&nbsp;panic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083774">if</span>&nbsp;<span class="ident" id="4083777">r</span><span class="op" id="4083778">.</span><span class="ident" id="4083779">Empty</span><span class="op" id="4083784">(</span><span class="op" id="4083785">)</span>&nbsp;<span class="op" id="4083787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083791">return</span>&nbsp;<span class="op" id="4083798">&amp;</span><span class="ident" id="4083799">YCbCr</span><span class="op" id="4083804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083809">SubsampleRatio</span><span class="op" id="4083823">:</span>&nbsp;<span class="ident" id="4083825">p</span><span class="op" id="4083826">.</span><span class="ident" id="4083827">SubsampleRatio</span><span class="op" id="4083841">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4083848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083851">yi</span>&nbsp;<span class="op" id="4083854">:=</span>&nbsp;<span class="ident" id="4083857">p</span><span class="op" id="4083858">.</span><span class="ident" id="4083859">YOffset</span><span class="op" id="4083866">(</span><span class="ident" id="4083867">r</span><span class="op" id="4083868">.</span><span class="ident" id="4083869">Min</span><span class="op" id="4083872">.</span><span class="ident" id="4083873">X</span><span class="op" id="4083874">,</span>&nbsp;<span class="ident" id="4083876">r</span><span class="op" id="4083877">.</span><span class="ident" id="4083878">Min</span><span class="op" id="4083881">.</span><span class="ident" id="4083882">Y</span><span class="op" id="4083883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083886">ci</span>&nbsp;<span class="op" id="4083889">:=</span>&nbsp;<span class="ident" id="4083892">p</span><span class="op" id="4083893">.</span><span class="ident" id="4083894">COffset</span><span class="op" id="4083901">(</span><span class="ident" id="4083902">r</span><span class="op" id="4083903">.</span><span class="ident" id="4083904">Min</span><span class="op" id="4083907">.</span><span class="ident" id="4083908">X</span><span class="op" id="4083909">,</span>&nbsp;<span class="ident" id="4083911">r</span><span class="op" id="4083912">.</span><span class="ident" id="4083913">Min</span><span class="op" id="4083916">.</span><span class="ident" id="4083917">Y</span><span class="op" id="4083918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4083921">return</span>&nbsp;<span class="op" id="4083928">&amp;</span><span class="ident" id="4083929">YCbCr</span><span class="op" id="4083934">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083938">Y</span><span class="op" id="4083939">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083954">p</span><span class="op" id="4083955">.</span><span class="ident" id="4083956">Y</span><span class="op" id="4083957">[</span><span class="ident" id="4083958">yi</span><span class="op" id="4083960">:</span><span class="op" id="4083961">]</span><span class="op" id="4083962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083966">Cb</span><span class="op" id="4083968">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4083982">p</span><span class="op" id="4083983">.</span><span class="ident" id="4083984">Cb</span><span class="op" id="4083986">[</span><span class="ident" id="4083987">ci</span><span class="op" id="4083989">:</span><span class="op" id="4083990">]</span><span class="op" id="4083991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4083995">Cr</span><span class="op" id="4083997">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084011">p</span><span class="op" id="4084012">.</span><span class="ident" id="4084013">Cr</span><span class="op" id="4084015">[</span><span class="ident" id="4084016">ci</span><span class="op" id="4084018">:</span><span class="op" id="4084019">]</span><span class="op" id="4084020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084024">SubsampleRatio</span><span class="op" id="4084038">:</span>&nbsp;<span class="ident" id="4084040">p</span><span class="op" id="4084041">.</span><span class="ident" id="4084042">SubsampleRatio</span><span class="op" id="4084056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084060">YStride</span><span class="op" id="4084067">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084076">p</span><span class="op" id="4084077">.</span><span class="ident" id="4084078">YStride</span><span class="op" id="4084085">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084089">CStride</span><span class="op" id="4084096">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084105">p</span><span class="op" id="4084106">.</span><span class="ident" id="4084107">CStride</span><span class="op" id="4084114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084118">Rect</span><span class="op" id="4084122">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084134">r</span><span class="op" id="4084135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084138">}</span><br>
<span class="lineno"></span><span class="op" id="4084140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="4084143">func</span>&nbsp;<span class="op" id="4084148">(</span><span class="ident" id="4084149">p</span>&nbsp;<span class="op" id="4084151">*</span><span class="ident" id="4084152">YCbCr</span><span class="op" id="4084157">)</span>&nbsp;<span class="ident" id="4084159">Opaque</span><span class="op" id="4084165">(</span><span class="op" id="4084166">)</span>&nbsp;<span class="builtintype" id="4084168">bool</span>&nbsp;<span class="op" id="4084173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084176">return</span>&nbsp;<span class="builtintype" id="4084183">true</span><br>
<span class="lineno"></span><span class="op" id="4084188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4084191">//&nbsp;NewYCbCr&nbsp;returns&nbsp;a&nbsp;new&nbsp;YCbCr&nbsp;with&nbsp;the&nbsp;given&nbsp;bounds&nbsp;and&nbsp;subsample&nbsp;ratio.</span><br>
<span class="lineno">130</span><span class="keyword" id="4084266">func</span>&nbsp;<span class="ident" id="4084271">NewYCbCr</span><span class="op" id="4084279">(</span><span class="ident" id="4084280">r</span>&nbsp;<span class="ident" id="4084282">Rectangle</span><span class="op" id="4084291">,</span>&nbsp;<span class="ident" id="4084293">subsampleRatio</span>&nbsp;<span class="ident" id="4084308">YCbCrSubsampleRatio</span><span class="op" id="4084327">)</span>&nbsp;<span class="op" id="4084329">*</span><span class="ident" id="4084330">YCbCr</span>&nbsp;<span class="op" id="4084336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084339">w</span><span class="op" id="4084340">,</span>&nbsp;<span class="ident" id="4084342">h</span><span class="op" id="4084343">,</span>&nbsp;<span class="ident" id="4084345">cw</span><span class="op" id="4084347">,</span>&nbsp;<span class="ident" id="4084349">ch</span>&nbsp;<span class="op" id="4084352">:=</span>&nbsp;<span class="ident" id="4084355">r</span><span class="op" id="4084356">.</span><span class="ident" id="4084357">Dx</span><span class="op" id="4084359">(</span><span class="op" id="4084360">)</span><span class="op" id="4084361">,</span>&nbsp;<span class="ident" id="4084363">r</span><span class="op" id="4084364">.</span><span class="ident" id="4084365">Dy</span><span class="op" id="4084367">(</span><span class="op" id="4084368">)</span><span class="op" id="4084369">,</span>&nbsp;<span class="num" id="4084371">0</span><span class="op" id="4084372">,</span>&nbsp;<span class="num" id="4084374">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084377">switch</span>&nbsp;<span class="ident" id="4084384">subsampleRatio</span>&nbsp;<span class="op" id="4084399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084402">case</span>&nbsp;<span class="ident" id="4084407">YCbCrSubsampleRatio422</span><span class="op" id="4084429">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084433">cw</span>&nbsp;<span class="op" id="4084436">=</span>&nbsp;<span class="op" id="4084438">(</span><span class="ident" id="4084439">r</span><span class="op" id="4084440">.</span><span class="ident" id="4084441">Max</span><span class="op" id="4084444">.</span><span class="ident" id="4084445">X</span><span class="op" id="4084446">+</span><span class="num" id="4084447">1</span><span class="op" id="4084448">)</span><span class="op" id="4084449">/</span><span class="num" id="4084450">2</span>&nbsp;<span class="op" id="4084452">-</span>&nbsp;<span class="ident" id="4084454">r</span><span class="op" id="4084455">.</span><span class="ident" id="4084456">Min</span><span class="op" id="4084459">.</span><span class="ident" id="4084460">X</span><span class="op" id="4084461">/</span><span class="num" id="4084462">2</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084466">ch</span>&nbsp;<span class="op" id="4084469">=</span>&nbsp;<span class="ident" id="4084471">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084474">case</span>&nbsp;<span class="ident" id="4084479">YCbCrSubsampleRatio420</span><span class="op" id="4084501">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084505">cw</span>&nbsp;<span class="op" id="4084508">=</span>&nbsp;<span class="op" id="4084510">(</span><span class="ident" id="4084511">r</span><span class="op" id="4084512">.</span><span class="ident" id="4084513">Max</span><span class="op" id="4084516">.</span><span class="ident" id="4084517">X</span><span class="op" id="4084518">+</span><span class="num" id="4084519">1</span><span class="op" id="4084520">)</span><span class="op" id="4084521">/</span><span class="num" id="4084522">2</span>&nbsp;<span class="op" id="4084524">-</span>&nbsp;<span class="ident" id="4084526">r</span><span class="op" id="4084527">.</span><span class="ident" id="4084528">Min</span><span class="op" id="4084531">.</span><span class="ident" id="4084532">X</span><span class="op" id="4084533">/</span><span class="num" id="4084534">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084538">ch</span>&nbsp;<span class="op" id="4084541">=</span>&nbsp;<span class="op" id="4084543">(</span><span class="ident" id="4084544">r</span><span class="op" id="4084545">.</span><span class="ident" id="4084546">Max</span><span class="op" id="4084549">.</span><span class="ident" id="4084550">Y</span><span class="op" id="4084551">+</span><span class="num" id="4084552">1</span><span class="op" id="4084553">)</span><span class="op" id="4084554">/</span><span class="num" id="4084555">2</span>&nbsp;<span class="op" id="4084557">-</span>&nbsp;<span class="ident" id="4084559">r</span><span class="op" id="4084560">.</span><span class="ident" id="4084561">Min</span><span class="op" id="4084564">.</span><span class="ident" id="4084565">Y</span><span class="op" id="4084566">/</span><span class="num" id="4084567">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084570">case</span>&nbsp;<span class="ident" id="4084575">YCbCrSubsampleRatio440</span><span class="op" id="4084597">:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084601">cw</span>&nbsp;<span class="op" id="4084604">=</span>&nbsp;<span class="ident" id="4084606">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084610">ch</span>&nbsp;<span class="op" id="4084613">=</span>&nbsp;<span class="op" id="4084615">(</span><span class="ident" id="4084616">r</span><span class="op" id="4084617">.</span><span class="ident" id="4084618">Max</span><span class="op" id="4084621">.</span><span class="ident" id="4084622">Y</span><span class="op" id="4084623">+</span><span class="num" id="4084624">1</span><span class="op" id="4084625">)</span><span class="op" id="4084626">/</span><span class="num" id="4084627">2</span>&nbsp;<span class="op" id="4084629">-</span>&nbsp;<span class="ident" id="4084631">r</span><span class="op" id="4084632">.</span><span class="ident" id="4084633">Min</span><span class="op" id="4084636">.</span><span class="ident" id="4084637">Y</span><span class="op" id="4084638">/</span><span class="num" id="4084639">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084642">default</span><span class="op" id="4084649">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4084653">//&nbsp;Default&nbsp;to&nbsp;4:4:4&nbsp;subsampling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084688">cw</span>&nbsp;<span class="op" id="4084691">=</span>&nbsp;<span class="ident" id="4084693">w</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084697">ch</span>&nbsp;<span class="op" id="4084700">=</span>&nbsp;<span class="ident" id="4084702">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084708">b</span>&nbsp;<span class="op" id="4084710">:=</span>&nbsp;<span class="builtinfunc" id="4084713">make</span><span class="op" id="4084717">(</span><span class="op" id="4084718">[</span><span class="op" id="4084719">]</span><span class="builtintype" id="4084720">byte</span><span class="op" id="4084724">,</span>&nbsp;<span class="ident" id="4084726">w</span><span class="op" id="4084727">*</span><span class="ident" id="4084728">h</span><span class="op" id="4084729">+</span><span class="num" id="4084730">2</span><span class="op" id="4084731">*</span><span class="ident" id="4084732">cw</span><span class="op" id="4084734">*</span><span class="ident" id="4084735">ch</span><span class="op" id="4084737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4084740">return</span>&nbsp;<span class="op" id="4084747">&amp;</span><span class="ident" id="4084748">YCbCr</span><span class="op" id="4084753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084757">Y</span><span class="op" id="4084758">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084773">b</span><span class="op" id="4084774">[</span><span class="op" id="4084775">:</span><span class="ident" id="4084776">w</span><span class="op" id="4084777">*</span><span class="ident" id="4084778">h</span><span class="op" id="4084779">]</span><span class="op" id="4084780">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084784">Cb</span><span class="op" id="4084786">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084800">b</span><span class="op" id="4084801">[</span><span class="ident" id="4084802">w</span><span class="op" id="4084803">*</span><span class="ident" id="4084804">h</span><span class="op" id="4084805">+</span><span class="num" id="4084806">0</span><span class="op" id="4084807">*</span><span class="ident" id="4084808">cw</span><span class="op" id="4084810">*</span><span class="ident" id="4084811">ch</span>&nbsp;<span class="op" id="4084814">:</span>&nbsp;<span class="ident" id="4084816">w</span><span class="op" id="4084817">*</span><span class="ident" id="4084818">h</span><span class="op" id="4084819">+</span><span class="num" id="4084820">1</span><span class="op" id="4084821">*</span><span class="ident" id="4084822">cw</span><span class="op" id="4084824">*</span><span class="ident" id="4084825">ch</span><span class="op" id="4084827">]</span><span class="op" id="4084828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084832">Cr</span><span class="op" id="4084834">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084848">b</span><span class="op" id="4084849">[</span><span class="ident" id="4084850">w</span><span class="op" id="4084851">*</span><span class="ident" id="4084852">h</span><span class="op" id="4084853">+</span><span class="num" id="4084854">1</span><span class="op" id="4084855">*</span><span class="ident" id="4084856">cw</span><span class="op" id="4084858">*</span><span class="ident" id="4084859">ch</span>&nbsp;<span class="op" id="4084862">:</span>&nbsp;<span class="ident" id="4084864">w</span><span class="op" id="4084865">*</span><span class="ident" id="4084866">h</span><span class="op" id="4084867">+</span><span class="num" id="4084868">2</span><span class="op" id="4084869">*</span><span class="ident" id="4084870">cw</span><span class="op" id="4084872">*</span><span class="ident" id="4084873">ch</span><span class="op" id="4084875">]</span><span class="op" id="4084876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084880">SubsampleRatio</span><span class="op" id="4084894">:</span>&nbsp;<span class="ident" id="4084896">subsampleRatio</span><span class="op" id="4084910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084914">YStride</span><span class="op" id="4084921">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084930">w</span><span class="op" id="4084931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084935">CStride</span><span class="op" id="4084942">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084951">cw</span><span class="op" id="4084953">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4084957">Rect</span><span class="op" id="4084961">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4084973">r</span><span class="op" id="4084974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4084977">}</span><br>
<span class="lineno"></span><span class="op" id="4084979">}</span>
</div>
</body>
</html>
