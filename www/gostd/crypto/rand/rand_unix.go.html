<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rand</h2>
<ul>
<li><a href="/gostd/crypto/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/crypto/rand/rand_linux.go.html">rand_linux.go</a></li>
<li><a href="/gostd/crypto/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/crypto/rand/rand_unix.go.html" class="current">rand_unix.go</a></li>
<li><a href="/gostd/crypto/rand/util.go.html">util.go</a></li>
<li><a href="/gostd/crypto/rand/util_test.go.html">util_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4356794">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4356850">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4356904">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4356955">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;plan9&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4357031">//&nbsp;Unix&nbsp;cryptographically&nbsp;secure&nbsp;pseudorandom&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="4357084">//&nbsp;generator.</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4357099">package</span>&nbsp;<span class="ident" id="4357107">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4357113">import</span>&nbsp;<span class="op" id="4357120">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4357123">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4357132">&#34;crypto/aes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4357146">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4357163">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4357169">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4357175">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4357186">&#34;sync&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4357194">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4357201">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4357204">const</span>&nbsp;<span class="ident" id="4357210">urandomDevice</span>&nbsp;<span class="op" id="4357224">=</span>&nbsp;<span class="string" id="4357226">&#34;/dev/urandom&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4357242">//&nbsp;Easy&nbsp;implementation:&nbsp;read&nbsp;from&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><span class="comment" id="4357290">//&nbsp;This&nbsp;is&nbsp;sufficient&nbsp;on&nbsp;Linux,&nbsp;OS&nbsp;X,&nbsp;and&nbsp;FreeBSD.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4357342">func</span>&nbsp;<span class="ident" id="4357347">init</span><span class="op" id="4357351">(</span><span class="op" id="4357352">)</span>&nbsp;<span class="op" id="4357354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357357">if</span>&nbsp;<span class="ident" id="4357360"><a href="/gostd/crypto/rand/rand_unix.go.html#4357175">runtime</a></span><span class="op" id="4357367">.</span><span class="ident" id="4357368"><a href="/gostd/runtime/extern.go.html#1533673">GOOS</a></span>&nbsp;<span class="op" id="4357373">==</span>&nbsp;<span class="string" id="4357376">&#34;plan9&#34;</span>&nbsp;<span class="op" id="4357384">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357388"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span>&nbsp;<span class="op" id="4357395">=</span>&nbsp;<span class="ident" id="4357397"><a href="/gostd/crypto/rand/rand_unix.go.html#4358677">newReader</a></span><span class="op" id="4357406">(</span><span class="builtintype" id="4357407">nil</span><span class="op" id="4357410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4357413">}</span>&nbsp;<span class="keyword" id="4357415">else</span>&nbsp;<span class="op" id="4357420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357424"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span>&nbsp;<span class="op" id="4357431">=</span>&nbsp;<span class="op" id="4357433">&amp;</span><span class="ident" id="4357434"><a href="/gostd/crypto/rand/rand_unix.go.html#4357539">devReader</a></span><span class="op" id="4357443">{</span><span class="ident" id="4357444"><a href="/gostd/crypto/rand/rand_unix.go.html#4357559">name</a></span><span class="op" id="4357448">:</span>&nbsp;<span class="ident" id="4357450"><a href="/gostd/crypto/rand/rand_unix.go.html#4357210">urandomDevice</a></span><span class="op" id="4357463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4357466">}</span><br>
<span class="lineno"></span><span class="op" id="4357468">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4357471">//&nbsp;A&nbsp;devReader&nbsp;satisfies&nbsp;reads&nbsp;by&nbsp;reading&nbsp;the&nbsp;file&nbsp;named&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4357534">type</span>&nbsp;<span class="ident" id="4357539">devReader</span>&nbsp;<span class="keyword" id="4357549">struct</span>&nbsp;<span class="op" id="4357556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357559">name</span>&nbsp;<span class="builtintype" id="4357564">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357572">f</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357577"><a href="/gostd/crypto/rand/rand_unix.go.html#4357163">io</a></span><span class="op" id="4357579">.</span><span class="ident" id="4357580"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357588">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4357593"><a href="/gostd/crypto/rand/rand_unix.go.html#4357186">sync</a></span><span class="op" id="4357597">.</span><span class="ident" id="4357598"><a href="/gostd/sync/mutex.go.html#1443974">Mutex</a></span><br>
<span class="lineno"></span><span class="op" id="4357604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4357607">//&nbsp;altGetRandom&nbsp;if&nbsp;non-nil&nbsp;specifies&nbsp;an&nbsp;OS-specific&nbsp;function&nbsp;to&nbsp;get</span><br>
<span class="lineno"></span><span class="comment" id="4357675">//&nbsp;urandom-style&nbsp;randomness.</span><br>
<span class="lineno">45</span><span class="keyword" id="4357704">var</span>&nbsp;<span class="ident" id="4357708">altGetRandom</span>&nbsp;<span class="keyword" id="4357721">func</span><span class="op" id="4357725">(</span><span class="op" id="4357726">[</span><span class="op" id="4357727">]</span><span class="builtintype" id="4357728">byte</span><span class="op" id="4357732">)</span>&nbsp;<span class="op" id="4357734">(</span><span class="ident" id="4357735">ok</span>&nbsp;<span class="builtintype" id="4357738">bool</span><span class="op" id="4357742">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4357745">func</span>&nbsp;<span class="op" id="4357750">(</span><span class="ident" id="4357751">r</span>&nbsp;<span class="op" id="4357753">*</span><span class="ident" id="4357754"><a href="/gostd/crypto/rand/rand_unix.go.html#4357539">devReader</a></span><span class="op" id="4357763">)</span>&nbsp;<span class="ident" id="4357765">Read</span><span class="op" id="4357769">(</span><span class="ident" id="4357770">b</span>&nbsp;<span class="op" id="4357772">[</span><span class="op" id="4357773">]</span><span class="builtintype" id="4357774">byte</span><span class="op" id="4357778">)</span>&nbsp;<span class="op" id="4357780">(</span><span class="ident" id="4357781">n</span>&nbsp;<span class="builtintype" id="4357783">int</span><span class="op" id="4357786">,</span>&nbsp;<span class="ident" id="4357788">err</span>&nbsp;<span class="builtintype" id="4357792">error</span><span class="op" id="4357797">)</span>&nbsp;<span class="op" id="4357799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357802">if</span>&nbsp;<span class="ident" id="4357805"><a href="/gostd/crypto/rand/rand_unix.go.html#4357708">altGetRandom</a></span>&nbsp;<span class="op" id="4357818">!=</span>&nbsp;<span class="builtintype" id="4357821">nil</span>&nbsp;<span class="op" id="4357825">&amp;&amp;</span>&nbsp;<span class="ident" id="4357828"><a href="/gostd/crypto/rand/rand_unix.go.html#4357751">r</a></span><span class="op" id="4357829">.</span><span class="ident" id="4357830"><a href="/gostd/crypto/rand/rand_unix.go.html#4357559">name</a></span>&nbsp;<span class="op" id="4357835">==</span>&nbsp;<span class="ident" id="4357838"><a href="/gostd/crypto/rand/rand_unix.go.html#4357210">urandomDevice</a></span>&nbsp;<span class="op" id="4357852">&amp;&amp;</span>&nbsp;<span class="ident" id="4357855"><a href="/gostd/crypto/rand/rand_unix.go.html#4357708">altGetRandom</a></span><span class="op" id="4357867">(</span><span class="ident" id="4357868"><a href="/gostd/crypto/rand/rand_unix.go.html#4357770">b</a></span><span class="op" id="4357869">)</span>&nbsp;<span class="op" id="4357871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357875">return</span>&nbsp;<span class="builtinfunc" id="4357882">len</span><span class="op" id="4357885">(</span><span class="ident" id="4357886"><a href="/gostd/crypto/rand/rand_unix.go.html#4357770">b</a></span><span class="op" id="4357887">)</span><span class="op" id="4357888">,</span>&nbsp;<span class="builtintype" id="4357890">nil</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4357895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357898"><a href="/gostd/crypto/rand/rand_unix.go.html#4357751">r</a></span><span class="op" id="4357899">.</span><span class="ident" id="4357900"><a href="/gostd/crypto/rand/rand_unix.go.html#4357588">mu</a></span><span class="op" id="4357902">.</span><span class="ident" id="4357903"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="4357907">(</span><span class="op" id="4357908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357911">defer</span>&nbsp;<span class="ident" id="4357917"><a href="/gostd/crypto/rand/rand_unix.go.html#4357751">r</a></span><span class="op" id="4357918">.</span><span class="ident" id="4357919"><a href="/gostd/crypto/rand/rand_unix.go.html#4357588">mu</a></span><span class="op" id="4357921">.</span><span class="ident" id="4357922"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="4357928">(</span><span class="op" id="4357929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357932">if</span>&nbsp;<span class="ident" id="4357935"><a href="/gostd/crypto/rand/rand_unix.go.html#4357751">r</a></span><span class="op" id="4357936">.</span><span class="ident" id="4357937"><a href="/gostd/crypto/rand/rand_unix.go.html#4357572">f</a></span>&nbsp;<span class="op" id="4357939">==</span>&nbsp;<span class="builtintype" id="4357942">nil</span>&nbsp;<span class="op" id="4357946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4357950">f</span><span class="op" id="4357951">,</span>&nbsp;<span class="ident" id="4357953">err</span>&nbsp;<span class="op" id="4357957">:=</span>&nbsp;<span class="ident" id="4357960"><a href="/gostd/crypto/rand/rand_unix.go.html#4357169">os</a></span><span class="op" id="4357962">.</span><span class="ident" id="4357963"><a href="/gostd/os/file.go.html#2446863">Open</a></span><span class="op" id="4357967">(</span><span class="ident" id="4357968"><a href="/gostd/crypto/rand/rand_unix.go.html#4357751">r</a></span><span class="op" id="4357969">.</span><span class="ident" id="4357970"><a href="/gostd/crypto/rand/rand_unix.go.html#4357559">name</a></span><span class="op" id="4357974">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357978">if</span>&nbsp;<span class="ident" id="4357981"><a href="/gostd/crypto/rand/rand_unix.go.html#4357950">f</a></span>&nbsp;<span class="op" id="4357983">==</span>&nbsp;<span class="builtintype" id="4357986">nil</span>&nbsp;<span class="op" id="4357990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4357995">return</span>&nbsp;<span class="num" id="4358002">0</span><span class="op" id="4358003">,</span>&nbsp;<span class="ident" id="4358005"><a href="/gostd/crypto/rand/rand_unix.go.html#4357953">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4358011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4358015">if</span>&nbsp;<span class="ident" id="4358018"><a href="/gostd/crypto/rand/rand_unix.go.html#4357175">runtime</a></span><span class="op" id="4358025">.</span><span class="ident" id="4358026"><a href="/gostd/runtime/extern.go.html#1533673">GOOS</a></span>&nbsp;<span class="op" id="4358031">==</span>&nbsp;<span class="string" id="4358034">&#34;plan9&#34;</span>&nbsp;<span class="op" id="4358042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358047"><a href="/gostd/crypto/rand/rand_unix.go.html#4357751">r</a></span><span class="op" id="4358048">.</span><span class="ident" id="4358049"><a href="/gostd/crypto/rand/rand_unix.go.html#4357572">f</a></span>&nbsp;<span class="op" id="4358051">=</span>&nbsp;<span class="ident" id="4358053"><a href="/gostd/crypto/rand/rand_unix.go.html#4357950">f</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4358057">}</span>&nbsp;<span class="keyword" id="4358059">else</span>&nbsp;<span class="op" id="4358064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358069"><a href="/gostd/crypto/rand/rand_unix.go.html#4357751">r</a></span><span class="op" id="4358070">.</span><span class="ident" id="4358071"><a href="/gostd/crypto/rand/rand_unix.go.html#4357572">f</a></span>&nbsp;<span class="op" id="4358073">=</span>&nbsp;<span class="ident" id="4358075"><a href="/gostd/crypto/rand/rand_unix.go.html#4357123">bufio</a></span><span class="op" id="4358080">.</span><span class="ident" id="4358081"><a href="/gostd/bufio/bufio.go.html#1355792">NewReader</a></span><span class="op" id="4358090">(</span><span class="ident" id="4358091"><a href="/gostd/crypto/rand/rand_unix.go.html#4357950">f</a></span><span class="op" id="4358092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4358096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4358099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4358102">return</span>&nbsp;<span class="ident" id="4358109"><a href="/gostd/crypto/rand/rand_unix.go.html#4357751">r</a></span><span class="op" id="4358110">.</span><span class="ident" id="4358111"><a href="/gostd/crypto/rand/rand_unix.go.html#4357572">f</a></span><span class="op" id="4358112">.</span><span class="ident" id="4358113"><a href="/gostd/io/io.go.html#1421843">Read</a></span><span class="op" id="4358117">(</span><span class="ident" id="4358118"><a href="/gostd/crypto/rand/rand_unix.go.html#4357770">b</a></span><span class="op" id="4358119">)</span><br>
<span class="lineno">65</span><span class="op" id="4358121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4358124">//&nbsp;Alternate&nbsp;pseudo-random&nbsp;implementation&nbsp;for&nbsp;use&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="4358177">//&nbsp;systems&nbsp;without&nbsp;a&nbsp;reliable&nbsp;/dev/urandom.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4358222">//&nbsp;newReader&nbsp;returns&nbsp;a&nbsp;new&nbsp;pseudorandom&nbsp;generator&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4358277">//&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;entropy.&nbsp;&nbsp;If&nbsp;entropy&nbsp;==&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="4358338">//&nbsp;the&nbsp;generator&nbsp;seeds&nbsp;itself&nbsp;by&nbsp;reading&nbsp;from&nbsp;the&nbsp;system&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="4358397">//&nbsp;random&nbsp;number&nbsp;generator,&nbsp;typically&nbsp;/dev/random.</span><br>
<span class="lineno"></span><span class="comment" id="4358448">//&nbsp;The&nbsp;Read&nbsp;method&nbsp;on&nbsp;the&nbsp;returned&nbsp;reader&nbsp;always&nbsp;returns</span><br>
<span class="lineno">75</span><span class="comment" id="4358505">//&nbsp;the&nbsp;full&nbsp;amount&nbsp;asked&nbsp;for,&nbsp;or&nbsp;else&nbsp;it&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4358564">//</span><br>
<span class="lineno"></span><span class="comment" id="4358567">//&nbsp;The&nbsp;generator&nbsp;uses&nbsp;the&nbsp;X9.31&nbsp;algorithm&nbsp;with&nbsp;AES-128,</span><br>
<span class="lineno"></span><span class="comment" id="4358623">//&nbsp;reseeding&nbsp;after&nbsp;every&nbsp;1&nbsp;MB&nbsp;of&nbsp;generated&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4358672">func</span>&nbsp;<span class="ident" id="4358677">newReader</span><span class="op" id="4358686">(</span><span class="ident" id="4358687">entropy</span>&nbsp;<span class="ident" id="4358695"><a href="/gostd/crypto/rand/rand_unix.go.html#4357163">io</a></span><span class="op" id="4358697">.</span><span class="ident" id="4358698"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="4358704">)</span>&nbsp;<span class="ident" id="4358706"><a href="/gostd/crypto/rand/rand_unix.go.html#4357163">io</a></span><span class="op" id="4358708">.</span><span class="ident" id="4358709"><a href="/gostd/io/io.go.html#1421823">Reader</a></span>&nbsp;<span class="op" id="4358716">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4358719">if</span>&nbsp;<span class="ident" id="4358722"><a href="/gostd/crypto/rand/rand_unix.go.html#4358687">entropy</a></span>&nbsp;<span class="op" id="4358730">==</span>&nbsp;<span class="builtintype" id="4358733">nil</span>&nbsp;<span class="op" id="4358737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358741"><a href="/gostd/crypto/rand/rand_unix.go.html#4358687">entropy</a></span>&nbsp;<span class="op" id="4358749">=</span>&nbsp;<span class="op" id="4358751">&amp;</span><span class="ident" id="4358752"><a href="/gostd/crypto/rand/rand_unix.go.html#4357539">devReader</a></span><span class="op" id="4358761">{</span><span class="ident" id="4358762"><a href="/gostd/crypto/rand/rand_unix.go.html#4357559">name</a></span><span class="op" id="4358766">:</span>&nbsp;<span class="string" id="4358768">&#34;/dev/random&#34;</span><span class="op" id="4358781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4358784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4358787">return</span>&nbsp;<span class="op" id="4358794">&amp;</span><span class="ident" id="4358795"><a href="/gostd/crypto/rand/rand_unix.go.html#4358828">reader</a></span><span class="op" id="4358801">{</span><span class="ident" id="4358802"><a href="/gostd/crypto/rand/rand_unix.go.html#4358980">entropy</a></span><span class="op" id="4358809">:</span>&nbsp;<span class="ident" id="4358811"><a href="/gostd/crypto/rand/rand_unix.go.html#4358687">entropy</a></span><span class="op" id="4358818">}</span><br>
<span class="lineno"></span><span class="op" id="4358820">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="4358823">type</span>&nbsp;<span class="ident" id="4358828">reader</span>&nbsp;<span class="keyword" id="4358835">struct</span>&nbsp;<span class="op" id="4358842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358845">mu</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358866"><a href="/gostd/crypto/rand/rand_unix.go.html#4357186">sync</a></span><span class="op" id="4358870">.</span><span class="ident" id="4358871"><a href="/gostd/sync/mutex.go.html#1443974">Mutex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358878">budget</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4358899">int</span>&nbsp;<span class="comment" id="4358903">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;that&nbsp;can&nbsp;be&nbsp;generated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358945">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358966"><a href="/gostd/crypto/rand/rand_unix.go.html#4357146">cipher</a></span><span class="op" id="4358972">.</span><span class="ident" id="4358973"><a href="/gostd/crypto/cipher/cipher.go.html#4410698">Block</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4358980">entropy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359001"><a href="/gostd/crypto/rand/rand_unix.go.html#4357163">io</a></span><span class="op" id="4359003">.</span><span class="ident" id="4359004"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359012">time</span><span class="op" id="4359016">,</span>&nbsp;<span class="ident" id="4359018">seed</span><span class="op" id="4359022">,</span>&nbsp;<span class="ident" id="4359024">dst</span><span class="op" id="4359027">,</span>&nbsp;<span class="ident" id="4359029">key</span>&nbsp;<span class="op" id="4359033">[</span><span class="ident" id="4359034"><a href="/gostd/crypto/rand/rand_unix.go.html#4357132">aes</a></span><span class="op" id="4359037">.</span><span class="ident" id="4359038"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="4359047">]</span><span class="builtintype" id="4359048">byte</span><br>
<span class="lineno"></span><span class="op" id="4359053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4359056">func</span>&nbsp;<span class="op" id="4359061">(</span><span class="ident" id="4359062">r</span>&nbsp;<span class="op" id="4359064">*</span><span class="ident" id="4359065"><a href="/gostd/crypto/rand/rand_unix.go.html#4358828">reader</a></span><span class="op" id="4359071">)</span>&nbsp;<span class="ident" id="4359073">Read</span><span class="op" id="4359077">(</span><span class="ident" id="4359078">b</span>&nbsp;<span class="op" id="4359080">[</span><span class="op" id="4359081">]</span><span class="builtintype" id="4359082">byte</span><span class="op" id="4359086">)</span>&nbsp;<span class="op" id="4359088">(</span><span class="ident" id="4359089">n</span>&nbsp;<span class="builtintype" id="4359091">int</span><span class="op" id="4359094">,</span>&nbsp;<span class="ident" id="4359096">err</span>&nbsp;<span class="builtintype" id="4359100">error</span><span class="op" id="4359105">)</span>&nbsp;<span class="op" id="4359107">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359110"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359111">.</span><span class="ident" id="4359112"><a href="/gostd/crypto/rand/rand_unix.go.html#4358845">mu</a></span><span class="op" id="4359114">.</span><span class="ident" id="4359115"><a href="/gostd/sync/mutex.go.html#1444351">Lock</a></span><span class="op" id="4359119">(</span><span class="op" id="4359120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4359123">defer</span>&nbsp;<span class="ident" id="4359129"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359130">.</span><span class="ident" id="4359131"><a href="/gostd/crypto/rand/rand_unix.go.html#4358845">mu</a></span><span class="op" id="4359133">.</span><span class="ident" id="4359134"><a href="/gostd/sync/mutex.go.html#1445283">Unlock</a></span><span class="op" id="4359140">(</span><span class="op" id="4359141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359144"><a href="/gostd/crypto/rand/rand_unix.go.html#4359089">n</a></span>&nbsp;<span class="op" id="4359146">=</span>&nbsp;<span class="builtinfunc" id="4359148">len</span><span class="op" id="4359151">(</span><span class="ident" id="4359152"><a href="/gostd/crypto/rand/rand_unix.go.html#4359078">b</a></span><span class="op" id="4359153">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4359157">for</span>&nbsp;<span class="builtinfunc" id="4359161">len</span><span class="op" id="4359164">(</span><span class="ident" id="4359165"><a href="/gostd/crypto/rand/rand_unix.go.html#4359078">b</a></span><span class="op" id="4359166">)</span>&nbsp;<span class="op" id="4359168">&gt;</span>&nbsp;<span class="num" id="4359170">0</span>&nbsp;<span class="op" id="4359172">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4359176">if</span>&nbsp;<span class="ident" id="4359179"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359180">.</span><span class="ident" id="4359181"><a href="/gostd/crypto/rand/rand_unix.go.html#4358878">budget</a></span>&nbsp;<span class="op" id="4359188">==</span>&nbsp;<span class="num" id="4359191">0</span>&nbsp;<span class="op" id="4359193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359198">_</span><span class="op" id="4359199">,</span>&nbsp;<span class="ident" id="4359201">err</span>&nbsp;<span class="op" id="4359205">:=</span>&nbsp;<span class="ident" id="4359208"><a href="/gostd/crypto/rand/rand_unix.go.html#4357163">io</a></span><span class="op" id="4359210">.</span><span class="ident" id="4359211"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="4359219">(</span><span class="ident" id="4359220"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359221">.</span><span class="ident" id="4359222"><a href="/gostd/crypto/rand/rand_unix.go.html#4358980">entropy</a></span><span class="op" id="4359229">,</span>&nbsp;<span class="ident" id="4359231"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359232">.</span><span class="ident" id="4359233"><a href="/gostd/crypto/rand/rand_unix.go.html#4359018">seed</a></span><span class="op" id="4359237">[</span><span class="num" id="4359238">0</span><span class="op" id="4359239">:</span><span class="op" id="4359240">]</span><span class="op" id="4359241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4359246">if</span>&nbsp;<span class="ident" id="4359249"><a href="/gostd/crypto/rand/rand_unix.go.html#4359201">err</a></span>&nbsp;<span class="op" id="4359253">!=</span>&nbsp;<span class="builtintype" id="4359256">nil</span>&nbsp;<span class="op" id="4359260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4359266">return</span>&nbsp;<span class="ident" id="4359273"><a href="/gostd/crypto/rand/rand_unix.go.html#4359089">n</a></span>&nbsp;<span class="op" id="4359275">-</span>&nbsp;<span class="builtinfunc" id="4359277">len</span><span class="op" id="4359280">(</span><span class="ident" id="4359281"><a href="/gostd/crypto/rand/rand_unix.go.html#4359078">b</a></span><span class="op" id="4359282">)</span><span class="op" id="4359283">,</span>&nbsp;<span class="ident" id="4359285"><a href="/gostd/crypto/rand/rand_unix.go.html#4359201">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4359292">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359297">_</span><span class="op" id="4359298">,</span>&nbsp;<span class="ident" id="4359300"><a href="/gostd/crypto/rand/rand_unix.go.html#4359201">err</a></span>&nbsp;<span class="op" id="4359304">=</span>&nbsp;<span class="ident" id="4359306"><a href="/gostd/crypto/rand/rand_unix.go.html#4357163">io</a></span><span class="op" id="4359308">.</span><span class="ident" id="4359309"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="4359317">(</span><span class="ident" id="4359318"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359319">.</span><span class="ident" id="4359320"><a href="/gostd/crypto/rand/rand_unix.go.html#4358980">entropy</a></span><span class="op" id="4359327">,</span>&nbsp;<span class="ident" id="4359329"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359330">.</span><span class="ident" id="4359331"><a href="/gostd/crypto/rand/rand_unix.go.html#4359029">key</a></span><span class="op" id="4359334">[</span><span class="num" id="4359335">0</span><span class="op" id="4359336">:</span><span class="op" id="4359337">]</span><span class="op" id="4359338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4359343">if</span>&nbsp;<span class="ident" id="4359346"><a href="/gostd/crypto/rand/rand_unix.go.html#4359201">err</a></span>&nbsp;<span class="op" id="4359350">!=</span>&nbsp;<span class="builtintype" id="4359353">nil</span>&nbsp;<span class="op" id="4359357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4359363">return</span>&nbsp;<span class="ident" id="4359370"><a href="/gostd/crypto/rand/rand_unix.go.html#4359089">n</a></span>&nbsp;<span class="op" id="4359372">-</span>&nbsp;<span class="builtinfunc" id="4359374">len</span><span class="op" id="4359377">(</span><span class="ident" id="4359378"><a href="/gostd/crypto/rand/rand_unix.go.html#4359078">b</a></span><span class="op" id="4359379">)</span><span class="op" id="4359380">,</span>&nbsp;<span class="ident" id="4359382"><a href="/gostd/crypto/rand/rand_unix.go.html#4359201">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4359389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359394"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359395">.</span><span class="ident" id="4359396"><a href="/gostd/crypto/rand/rand_unix.go.html#4358945">cipher</a></span><span class="op" id="4359402">,</span>&nbsp;<span class="ident" id="4359404"><a href="/gostd/crypto/rand/rand_unix.go.html#4359201">err</a></span>&nbsp;<span class="op" id="4359408">=</span>&nbsp;<span class="ident" id="4359410"><a href="/gostd/crypto/rand/rand_unix.go.html#4357132">aes</a></span><span class="op" id="4359413">.</span><span class="ident" id="4359414"><a href="/gostd/crypto/aes/cipher.go.html#4373344">NewCipher</a></span><span class="op" id="4359423">(</span><span class="ident" id="4359424"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359425">.</span><span class="ident" id="4359426"><a href="/gostd/crypto/rand/rand_unix.go.html#4359029">key</a></span><span class="op" id="4359429">[</span><span class="num" id="4359430">0</span><span class="op" id="4359431">:</span><span class="op" id="4359432">]</span><span class="op" id="4359433">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4359438">if</span>&nbsp;<span class="ident" id="4359441"><a href="/gostd/crypto/rand/rand_unix.go.html#4359201">err</a></span>&nbsp;<span class="op" id="4359445">!=</span>&nbsp;<span class="builtintype" id="4359448">nil</span>&nbsp;<span class="op" id="4359452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4359458">return</span>&nbsp;<span class="ident" id="4359465"><a href="/gostd/crypto/rand/rand_unix.go.html#4359089">n</a></span>&nbsp;<span class="op" id="4359467">-</span>&nbsp;<span class="builtinfunc" id="4359469">len</span><span class="op" id="4359472">(</span><span class="ident" id="4359473"><a href="/gostd/crypto/rand/rand_unix.go.html#4359078">b</a></span><span class="op" id="4359474">)</span><span class="op" id="4359475">,</span>&nbsp;<span class="ident" id="4359477"><a href="/gostd/crypto/rand/rand_unix.go.html#4359201">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4359484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359489"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359490">.</span><span class="ident" id="4359491"><a href="/gostd/crypto/rand/rand_unix.go.html#4358878">budget</a></span>&nbsp;<span class="op" id="4359498">=</span>&nbsp;<span class="num" id="4359500">1</span>&nbsp;<span class="op" id="4359502">&lt;&lt;</span>&nbsp;<span class="num" id="4359505">20</span>&nbsp;<span class="comment" id="4359508">//&nbsp;reseed&nbsp;after&nbsp;generating&nbsp;1MB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4359541">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359545"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359546">.</span><span class="ident" id="4359547"><a href="/gostd/crypto/rand/rand_unix.go.html#4358878">budget</a></span>&nbsp;<span class="op" id="4359554">-=</span>&nbsp;<span class="ident" id="4359557"><a href="/gostd/crypto/rand/rand_unix.go.html#4357132">aes</a></span><span class="op" id="4359560">.</span><span class="ident" id="4359561"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4359574">//&nbsp;ANSI&nbsp;X9.31&nbsp;(==&nbsp;X9.17)&nbsp;algorithm,&nbsp;but&nbsp;using&nbsp;AES&nbsp;in&nbsp;place&nbsp;of&nbsp;3DES.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4359644">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4359649">//&nbsp;single&nbsp;block:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4359668">//&nbsp;t&nbsp;=&nbsp;encrypt(time)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4359691">//&nbsp;dst&nbsp;=&nbsp;encrypt(t^seed)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4359718">//&nbsp;seed&nbsp;=&nbsp;encrypt(t^dst)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359745">ns</span>&nbsp;<span class="op" id="4359748">:=</span>&nbsp;<span class="ident" id="4359751"><a href="/gostd/crypto/rand/rand_unix.go.html#4357194">time</a></span><span class="op" id="4359755">.</span><span class="ident" id="4359756"><a href="/gostd/time/time.go.html#2743088">Now</a></span><span class="op" id="4359759">(</span><span class="op" id="4359760">)</span><span class="op" id="4359761">.</span><span class="ident" id="4359762"><a href="/gostd/time/time.go.html#2744495">UnixNano</a></span><span class="op" id="4359770">(</span><span class="op" id="4359771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359775"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359776">.</span><span class="ident" id="4359777"><a href="/gostd/crypto/rand/rand_unix.go.html#4359012">time</a></span><span class="op" id="4359781">[</span><span class="num" id="4359782">0</span><span class="op" id="4359783">]</span>&nbsp;<span class="op" id="4359785">=</span>&nbsp;<span class="builtintype" id="4359787">byte</span><span class="op" id="4359791">(</span><span class="ident" id="4359792"><a href="/gostd/crypto/rand/rand_unix.go.html#4359745">ns</a></span>&nbsp;<span class="op" id="4359795">&gt;&gt;</span>&nbsp;<span class="num" id="4359798">56</span><span class="op" id="4359800">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359804"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359805">.</span><span class="ident" id="4359806"><a href="/gostd/crypto/rand/rand_unix.go.html#4359012">time</a></span><span class="op" id="4359810">[</span><span class="num" id="4359811">1</span><span class="op" id="4359812">]</span>&nbsp;<span class="op" id="4359814">=</span>&nbsp;<span class="builtintype" id="4359816">byte</span><span class="op" id="4359820">(</span><span class="ident" id="4359821"><a href="/gostd/crypto/rand/rand_unix.go.html#4359745">ns</a></span>&nbsp;<span class="op" id="4359824">&gt;&gt;</span>&nbsp;<span class="num" id="4359827">48</span><span class="op" id="4359829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359833"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359834">.</span><span class="ident" id="4359835"><a href="/gostd/crypto/rand/rand_unix.go.html#4359012">time</a></span><span class="op" id="4359839">[</span><span class="num" id="4359840">2</span><span class="op" id="4359841">]</span>&nbsp;<span class="op" id="4359843">=</span>&nbsp;<span class="builtintype" id="4359845">byte</span><span class="op" id="4359849">(</span><span class="ident" id="4359850"><a href="/gostd/crypto/rand/rand_unix.go.html#4359745">ns</a></span>&nbsp;<span class="op" id="4359853">&gt;&gt;</span>&nbsp;<span class="num" id="4359856">40</span><span class="op" id="4359858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359862"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359863">.</span><span class="ident" id="4359864"><a href="/gostd/crypto/rand/rand_unix.go.html#4359012">time</a></span><span class="op" id="4359868">[</span><span class="num" id="4359869">3</span><span class="op" id="4359870">]</span>&nbsp;<span class="op" id="4359872">=</span>&nbsp;<span class="builtintype" id="4359874">byte</span><span class="op" id="4359878">(</span><span class="ident" id="4359879"><a href="/gostd/crypto/rand/rand_unix.go.html#4359745">ns</a></span>&nbsp;<span class="op" id="4359882">&gt;&gt;</span>&nbsp;<span class="num" id="4359885">32</span><span class="op" id="4359887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359891"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359892">.</span><span class="ident" id="4359893"><a href="/gostd/crypto/rand/rand_unix.go.html#4359012">time</a></span><span class="op" id="4359897">[</span><span class="num" id="4359898">4</span><span class="op" id="4359899">]</span>&nbsp;<span class="op" id="4359901">=</span>&nbsp;<span class="builtintype" id="4359903">byte</span><span class="op" id="4359907">(</span><span class="ident" id="4359908"><a href="/gostd/crypto/rand/rand_unix.go.html#4359745">ns</a></span>&nbsp;<span class="op" id="4359911">&gt;&gt;</span>&nbsp;<span class="num" id="4359914">24</span><span class="op" id="4359916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359920"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359921">.</span><span class="ident" id="4359922"><a href="/gostd/crypto/rand/rand_unix.go.html#4359012">time</a></span><span class="op" id="4359926">[</span><span class="num" id="4359927">5</span><span class="op" id="4359928">]</span>&nbsp;<span class="op" id="4359930">=</span>&nbsp;<span class="builtintype" id="4359932">byte</span><span class="op" id="4359936">(</span><span class="ident" id="4359937"><a href="/gostd/crypto/rand/rand_unix.go.html#4359745">ns</a></span>&nbsp;<span class="op" id="4359940">&gt;&gt;</span>&nbsp;<span class="num" id="4359943">16</span><span class="op" id="4359945">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359949"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359950">.</span><span class="ident" id="4359951"><a href="/gostd/crypto/rand/rand_unix.go.html#4359012">time</a></span><span class="op" id="4359955">[</span><span class="num" id="4359956">6</span><span class="op" id="4359957">]</span>&nbsp;<span class="op" id="4359959">=</span>&nbsp;<span class="builtintype" id="4359961">byte</span><span class="op" id="4359965">(</span><span class="ident" id="4359966"><a href="/gostd/crypto/rand/rand_unix.go.html#4359745">ns</a></span>&nbsp;<span class="op" id="4359969">&gt;&gt;</span>&nbsp;<span class="num" id="4359972">8</span><span class="op" id="4359973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4359977"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4359978">.</span><span class="ident" id="4359979"><a href="/gostd/crypto/rand/rand_unix.go.html#4359012">time</a></span><span class="op" id="4359983">[</span><span class="num" id="4359984">7</span><span class="op" id="4359985">]</span>&nbsp;<span class="op" id="4359987">=</span>&nbsp;<span class="builtintype" id="4359989">byte</span><span class="op" id="4359993">(</span><span class="ident" id="4359994"><a href="/gostd/crypto/rand/rand_unix.go.html#4359745">ns</a></span><span class="op" id="4359996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4360000"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360001">.</span><span class="ident" id="4360002"><a href="/gostd/crypto/rand/rand_unix.go.html#4358945">cipher</a></span><span class="op" id="4360008">.</span><span class="ident" id="4360009"><a href="/gostd/crypto/cipher/cipher.go.html#4410882">Encrypt</a></span><span class="op" id="4360016">(</span><span class="ident" id="4360017"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360018">.</span><span class="ident" id="4360019"><a href="/gostd/crypto/rand/rand_unix.go.html#4359012">time</a></span><span class="op" id="4360023">[</span><span class="num" id="4360024">0</span><span class="op" id="4360025">:</span><span class="op" id="4360026">]</span><span class="op" id="4360027">,</span>&nbsp;<span class="ident" id="4360029"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360030">.</span><span class="ident" id="4360031"><a href="/gostd/crypto/rand/rand_unix.go.html#4359012">time</a></span><span class="op" id="4360035">[</span><span class="num" id="4360036">0</span><span class="op" id="4360037">:</span><span class="op" id="4360038">]</span><span class="op" id="4360039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360043">for</span>&nbsp;<span class="ident" id="4360047">i</span>&nbsp;<span class="op" id="4360049">:=</span>&nbsp;<span class="num" id="4360052">0</span><span class="op" id="4360053">;</span>&nbsp;<span class="ident" id="4360055"><a href="/gostd/crypto/rand/rand_unix.go.html#4360047">i</a></span>&nbsp;<span class="op" id="4360057">&lt;</span>&nbsp;<span class="ident" id="4360059"><a href="/gostd/crypto/rand/rand_unix.go.html#4357132">aes</a></span><span class="op" id="4360062">.</span><span class="ident" id="4360063"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="4360072">;</span>&nbsp;<span class="ident" id="4360074"><a href="/gostd/crypto/rand/rand_unix.go.html#4360047">i</a></span><span class="op" id="4360075">++</span>&nbsp;<span class="op" id="4360078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4360083"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360084">.</span><span class="ident" id="4360085"><a href="/gostd/crypto/rand/rand_unix.go.html#4359024">dst</a></span><span class="op" id="4360088">[</span><span class="ident" id="4360089"><a href="/gostd/crypto/rand/rand_unix.go.html#4360047">i</a></span><span class="op" id="4360090">]</span>&nbsp;<span class="op" id="4360092">=</span>&nbsp;<span class="ident" id="4360094"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360095">.</span><span class="ident" id="4360096"><a href="/gostd/crypto/rand/rand_unix.go.html#4359012">time</a></span><span class="op" id="4360100">[</span><span class="ident" id="4360101"><a href="/gostd/crypto/rand/rand_unix.go.html#4360047">i</a></span><span class="op" id="4360102">]</span>&nbsp;<span class="op" id="4360104">^</span>&nbsp;<span class="ident" id="4360106"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360107">.</span><span class="ident" id="4360108"><a href="/gostd/crypto/rand/rand_unix.go.html#4359018">seed</a></span><span class="op" id="4360112">[</span><span class="ident" id="4360113"><a href="/gostd/crypto/rand/rand_unix.go.html#4360047">i</a></span><span class="op" id="4360114">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4360118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4360122"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360123">.</span><span class="ident" id="4360124"><a href="/gostd/crypto/rand/rand_unix.go.html#4358945">cipher</a></span><span class="op" id="4360130">.</span><span class="ident" id="4360131"><a href="/gostd/crypto/cipher/cipher.go.html#4410882">Encrypt</a></span><span class="op" id="4360138">(</span><span class="ident" id="4360139"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360140">.</span><span class="ident" id="4360141"><a href="/gostd/crypto/rand/rand_unix.go.html#4359024">dst</a></span><span class="op" id="4360144">[</span><span class="num" id="4360145">0</span><span class="op" id="4360146">:</span><span class="op" id="4360147">]</span><span class="op" id="4360148">,</span>&nbsp;<span class="ident" id="4360150"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360151">.</span><span class="ident" id="4360152"><a href="/gostd/crypto/rand/rand_unix.go.html#4359024">dst</a></span><span class="op" id="4360155">[</span><span class="num" id="4360156">0</span><span class="op" id="4360157">:</span><span class="op" id="4360158">]</span><span class="op" id="4360159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360163">for</span>&nbsp;<span class="ident" id="4360167">i</span>&nbsp;<span class="op" id="4360169">:=</span>&nbsp;<span class="num" id="4360172">0</span><span class="op" id="4360173">;</span>&nbsp;<span class="ident" id="4360175"><a href="/gostd/crypto/rand/rand_unix.go.html#4360167">i</a></span>&nbsp;<span class="op" id="4360177">&lt;</span>&nbsp;<span class="ident" id="4360179"><a href="/gostd/crypto/rand/rand_unix.go.html#4357132">aes</a></span><span class="op" id="4360182">.</span><span class="ident" id="4360183"><a href="/gostd/crypto/aes/cipher.go.html#4372902">BlockSize</a></span><span class="op" id="4360192">;</span>&nbsp;<span class="ident" id="4360194"><a href="/gostd/crypto/rand/rand_unix.go.html#4360167">i</a></span><span class="op" id="4360195">++</span>&nbsp;<span class="op" id="4360198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4360203"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360204">.</span><span class="ident" id="4360205"><a href="/gostd/crypto/rand/rand_unix.go.html#4359018">seed</a></span><span class="op" id="4360209">[</span><span class="ident" id="4360210"><a href="/gostd/crypto/rand/rand_unix.go.html#4360167">i</a></span><span class="op" id="4360211">]</span>&nbsp;<span class="op" id="4360213">=</span>&nbsp;<span class="ident" id="4360215"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360216">.</span><span class="ident" id="4360217"><a href="/gostd/crypto/rand/rand_unix.go.html#4359012">time</a></span><span class="op" id="4360221">[</span><span class="ident" id="4360222"><a href="/gostd/crypto/rand/rand_unix.go.html#4360167">i</a></span><span class="op" id="4360223">]</span>&nbsp;<span class="op" id="4360225">^</span>&nbsp;<span class="ident" id="4360227"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360228">.</span><span class="ident" id="4360229"><a href="/gostd/crypto/rand/rand_unix.go.html#4359024">dst</a></span><span class="op" id="4360232">[</span><span class="ident" id="4360233"><a href="/gostd/crypto/rand/rand_unix.go.html#4360167">i</a></span><span class="op" id="4360234">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4360238">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4360242"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360243">.</span><span class="ident" id="4360244"><a href="/gostd/crypto/rand/rand_unix.go.html#4358945">cipher</a></span><span class="op" id="4360250">.</span><span class="ident" id="4360251"><a href="/gostd/crypto/cipher/cipher.go.html#4410882">Encrypt</a></span><span class="op" id="4360258">(</span><span class="ident" id="4360259"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360260">.</span><span class="ident" id="4360261"><a href="/gostd/crypto/rand/rand_unix.go.html#4359018">seed</a></span><span class="op" id="4360265">[</span><span class="num" id="4360266">0</span><span class="op" id="4360267">:</span><span class="op" id="4360268">]</span><span class="op" id="4360269">,</span>&nbsp;<span class="ident" id="4360271"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360272">.</span><span class="ident" id="4360273"><a href="/gostd/crypto/rand/rand_unix.go.html#4359018">seed</a></span><span class="op" id="4360277">[</span><span class="num" id="4360278">0</span><span class="op" id="4360279">:</span><span class="op" id="4360280">]</span><span class="op" id="4360281">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4360286">m</span>&nbsp;<span class="op" id="4360288">:=</span>&nbsp;<span class="builtinfunc" id="4360291">copy</span><span class="op" id="4360295">(</span><span class="ident" id="4360296"><a href="/gostd/crypto/rand/rand_unix.go.html#4359078">b</a></span><span class="op" id="4360297">,</span>&nbsp;<span class="ident" id="4360299"><a href="/gostd/crypto/rand/rand_unix.go.html#4359062">r</a></span><span class="op" id="4360300">.</span><span class="ident" id="4360301"><a href="/gostd/crypto/rand/rand_unix.go.html#4359024">dst</a></span><span class="op" id="4360304">[</span><span class="num" id="4360305">0</span><span class="op" id="4360306">:</span><span class="op" id="4360307">]</span><span class="op" id="4360308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4360312"><a href="/gostd/crypto/rand/rand_unix.go.html#4359078">b</a></span>&nbsp;<span class="op" id="4360314">=</span>&nbsp;<span class="ident" id="4360316"><a href="/gostd/crypto/rand/rand_unix.go.html#4359078">b</a></span><span class="op" id="4360317">[</span><span class="ident" id="4360318"><a href="/gostd/crypto/rand/rand_unix.go.html#4360286">m</a></span><span class="op" id="4360319">:</span><span class="op" id="4360320">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4360323">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4360327">return</span>&nbsp;<span class="ident" id="4360334"><a href="/gostd/crypto/rand/rand_unix.go.html#4359089">n</a></span><span class="op" id="4360335">,</span>&nbsp;<span class="builtintype" id="4360337">nil</span><br>
<span class="lineno"></span><span class="op" id="4360341">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
