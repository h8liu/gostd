<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1678308">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1678363">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1678417">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1678468">//&nbsp;Time-related&nbsp;runtime&nbsp;and&nbsp;pieces&nbsp;of&nbsp;package&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1678521">package</span>&nbsp;<span class="ident" id="1678529">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1678538">import</span>&nbsp;<span class="string" id="1678545">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1678555">//&nbsp;Package&nbsp;time&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1678607">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../time/sleep.go:/runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="1678673">//&nbsp;For&nbsp;GOOS=nacl,&nbsp;package&nbsp;syscall&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1678743">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../syscall/net_nacl.go:/runtimeTimer.</span><br>
<span class="lineno">15</span><span class="keyword" id="1678815">type</span>&nbsp;<span class="ident" id="1678820">timer</span>&nbsp;<span class="keyword" id="1678826">struct</span>&nbsp;<span class="op" id="1678833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1678836">i</span>&nbsp;<span class="builtintype" id="1678838">int</span>&nbsp;<span class="comment" id="1678842">//&nbsp;heap&nbsp;index</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1678858">//&nbsp;Timer&nbsp;wakes&nbsp;up&nbsp;at&nbsp;when,&nbsp;and&nbsp;then&nbsp;at&nbsp;when+period,&nbsp;...&nbsp;(period&nbsp;&gt;&nbsp;0&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1678933">//&nbsp;each&nbsp;time&nbsp;calling&nbsp;f(now,&nbsp;arg)&nbsp;in&nbsp;the&nbsp;timer&nbsp;goroutine,&nbsp;so&nbsp;f&nbsp;must&nbsp;be</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1679004">//&nbsp;a&nbsp;well-behaved&nbsp;function&nbsp;and&nbsp;not&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679047">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1679054">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679061">period</span>&nbsp;<span class="ident" id="1679068">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679075">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1679082">func</span><span class="op" id="1679086">(</span><span class="keyword" id="1679087">interface</span><span class="op" id="1679096">{</span><span class="op" id="1679097">}</span><span class="op" id="1679098">,</span>&nbsp;<span class="builtintype" id="1679100">uintptr</span><span class="op" id="1679107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679110">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1679117">interface</span><span class="op" id="1679126">{</span><span class="op" id="1679127">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679130">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1679137">uintptr</span><br>
<span class="lineno"></span><span class="op" id="1679145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1679148">var</span>&nbsp;<span class="ident" id="1679152">timers</span>&nbsp;<span class="keyword" id="1679159">struct</span>&nbsp;<span class="op" id="1679166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679169">lock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1679182">mutex</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679189">gp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1679202">*</span><span class="ident" id="1679203">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679206">created</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1679219">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679225">sleeping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1679238">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679244">rescheduling</span>&nbsp;<span class="builtintype" id="1679257">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679263">waitnote</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1679276">note</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679282">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1679295">[</span><span class="op" id="1679296">]</span><span class="op" id="1679297">*</span><span class="ident" id="1679298">timer</span><br>
<span class="lineno"></span><span class="op" id="1679304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1679307">//&nbsp;nacl&nbsp;fake&nbsp;time&nbsp;support&nbsp;-&nbsp;time&nbsp;in&nbsp;nanoseconds&nbsp;since&nbsp;1970</span><br>
<span class="lineno"></span><span class="keyword" id="1679366">var</span>&nbsp;<span class="ident" id="1679370">faketime</span>&nbsp;<span class="ident" id="1679379">int64</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1679386">//&nbsp;Package&nbsp;time&nbsp;APIs.</span><br>
<span class="lineno"></span><span class="comment" id="1679408">//&nbsp;Godoc&nbsp;uses&nbsp;the&nbsp;comments&nbsp;in&nbsp;package&nbsp;time,&nbsp;not&nbsp;these.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1679464">//&nbsp;time.now&nbsp;is&nbsp;implemented&nbsp;in&nbsp;assembly.</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="1679505">//&nbsp;Sleep&nbsp;puts&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;to&nbsp;sleep&nbsp;for&nbsp;at&nbsp;least&nbsp;ns&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="1679579">func</span>&nbsp;<span class="ident" id="1679584">timeSleep</span><span class="op" id="1679593">(</span><span class="ident" id="1679594">ns</span>&nbsp;<span class="ident" id="1679597">int64</span><span class="op" id="1679602">)</span>&nbsp;<span class="op" id="1679604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1679607">if</span>&nbsp;<span class="ident" id="1679610">ns</span>&nbsp;<span class="op" id="1679613">&lt;=</span>&nbsp;<span class="num" id="1679616">0</span>&nbsp;<span class="op" id="1679618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1679622">return</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1679630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679634">t</span>&nbsp;<span class="op" id="1679636">:=</span>&nbsp;<span class="builtinfunc" id="1679639">new</span><span class="op" id="1679642">(</span><span class="ident" id="1679643">timer</span><span class="op" id="1679648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679651">t</span><span class="op" id="1679652">.</span><span class="ident" id="1679653">when</span>&nbsp;<span class="op" id="1679658">=</span>&nbsp;<span class="ident" id="1679660">nanotime</span><span class="op" id="1679668">(</span><span class="op" id="1679669">)</span>&nbsp;<span class="op" id="1679671">+</span>&nbsp;<span class="ident" id="1679673">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679677">t</span><span class="op" id="1679678">.</span><span class="ident" id="1679679">f</span>&nbsp;<span class="op" id="1679681">=</span>&nbsp;<span class="ident" id="1679683">goroutineReady</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679699">t</span><span class="op" id="1679700">.</span><span class="ident" id="1679701">arg</span>&nbsp;<span class="op" id="1679705">=</span>&nbsp;<span class="ident" id="1679707">getg</span><span class="op" id="1679711">(</span><span class="op" id="1679712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679715">lock</span><span class="op" id="1679719">(</span><span class="op" id="1679720">&amp;</span><span class="ident" id="1679721">timers</span><span class="op" id="1679727">.</span><span class="ident" id="1679728">lock</span><span class="op" id="1679732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679735">addtimerLocked</span><span class="op" id="1679749">(</span><span class="ident" id="1679750">t</span><span class="op" id="1679751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679754">goparkunlock</span><span class="op" id="1679766">(</span><span class="op" id="1679767">&amp;</span><span class="ident" id="1679768">timers</span><span class="op" id="1679774">.</span><span class="ident" id="1679775">lock</span><span class="op" id="1679779">,</span>&nbsp;<span class="string" id="1679781">&#34;sleep&#34;</span><span class="op" id="1679788">)</span><br>
<span class="lineno"></span><span class="op" id="1679790">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="1679793">//&nbsp;startTimer&nbsp;adds&nbsp;t&nbsp;to&nbsp;the&nbsp;timer&nbsp;heap.</span><br>
<span class="lineno"></span><span class="keyword" id="1679833">func</span>&nbsp;<span class="ident" id="1679838">startTimer</span><span class="op" id="1679848">(</span><span class="ident" id="1679849">t</span>&nbsp;<span class="op" id="1679851">*</span><span class="ident" id="1679852">timer</span><span class="op" id="1679857">)</span>&nbsp;<span class="op" id="1679859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1679862">if</span>&nbsp;<span class="ident" id="1679865">raceenabled</span>&nbsp;<span class="op" id="1679877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679881">racerelease</span><span class="op" id="1679892">(</span><span class="ident" id="1679893">unsafe</span><span class="op" id="1679899">.</span><span class="ident" id="1679900">Pointer</span><span class="op" id="1679907">(</span><span class="ident" id="1679908">t</span><span class="op" id="1679909">)</span><span class="op" id="1679910">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1679913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1679916">addtimer</span><span class="op" id="1679924">(</span><span class="ident" id="1679925">t</span><span class="op" id="1679926">)</span><br>
<span class="lineno"></span><span class="op" id="1679928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1679931">//&nbsp;stopTimer&nbsp;removes&nbsp;t&nbsp;from&nbsp;the&nbsp;timer&nbsp;heap&nbsp;if&nbsp;it&nbsp;is&nbsp;there.</span><br>
<span class="lineno">70</span><span class="comment" id="1679990">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;t&nbsp;was&nbsp;removed,&nbsp;false&nbsp;if&nbsp;t&nbsp;wasn&#39;t&nbsp;even&nbsp;there.</span><br>
<span class="lineno"></span><span class="keyword" id="1680057">func</span>&nbsp;<span class="ident" id="1680062">stopTimer</span><span class="op" id="1680071">(</span><span class="ident" id="1680072">t</span>&nbsp;<span class="op" id="1680074">*</span><span class="ident" id="1680075">timer</span><span class="op" id="1680080">)</span>&nbsp;<span class="builtintype" id="1680082">bool</span>&nbsp;<span class="op" id="1680087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680090">return</span>&nbsp;<span class="ident" id="1680097">deltimer</span><span class="op" id="1680105">(</span><span class="ident" id="1680106">t</span><span class="op" id="1680107">)</span><br>
<span class="lineno"></span><span class="op" id="1680109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="1680112">//&nbsp;Go&nbsp;runtime.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1680128">//&nbsp;Ready&nbsp;the&nbsp;goroutine&nbsp;arg.</span><br>
<span class="lineno"></span><span class="keyword" id="1680156">func</span>&nbsp;<span class="ident" id="1680161">goroutineReady</span><span class="op" id="1680175">(</span><span class="ident" id="1680176">arg</span>&nbsp;<span class="keyword" id="1680180">interface</span><span class="op" id="1680189">{</span><span class="op" id="1680190">}</span><span class="op" id="1680191">,</span>&nbsp;<span class="ident" id="1680193">seq</span>&nbsp;<span class="builtintype" id="1680197">uintptr</span><span class="op" id="1680204">)</span>&nbsp;<span class="op" id="1680206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680209">goready</span><span class="op" id="1680216">(</span><span class="ident" id="1680217">arg</span><span class="op" id="1680220">.</span><span class="op" id="1680221">(</span><span class="op" id="1680222">*</span><span class="ident" id="1680223">g</span><span class="op" id="1680224">)</span><span class="op" id="1680225">)</span><br>
<span class="lineno">80</span><span class="op" id="1680227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1680230">func</span>&nbsp;<span class="ident" id="1680235">addtimer</span><span class="op" id="1680243">(</span><span class="ident" id="1680244">t</span>&nbsp;<span class="op" id="1680246">*</span><span class="ident" id="1680247">timer</span><span class="op" id="1680252">)</span>&nbsp;<span class="op" id="1680254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680257">lock</span><span class="op" id="1680261">(</span><span class="op" id="1680262">&amp;</span><span class="ident" id="1680263">timers</span><span class="op" id="1680269">.</span><span class="ident" id="1680270">lock</span><span class="op" id="1680274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680277">addtimerLocked</span><span class="op" id="1680291">(</span><span class="ident" id="1680292">t</span><span class="op" id="1680293">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680296">unlock</span><span class="op" id="1680302">(</span><span class="op" id="1680303">&amp;</span><span class="ident" id="1680304">timers</span><span class="op" id="1680310">.</span><span class="ident" id="1680311">lock</span><span class="op" id="1680315">)</span><br>
<span class="lineno"></span><span class="op" id="1680317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1680320">//&nbsp;Add&nbsp;a&nbsp;timer&nbsp;to&nbsp;the&nbsp;heap&nbsp;and&nbsp;start&nbsp;or&nbsp;kick&nbsp;the&nbsp;timer&nbsp;proc.</span><br>
<span class="lineno"></span><span class="comment" id="1680381">//&nbsp;If&nbsp;the&nbsp;new&nbsp;timer&nbsp;is&nbsp;earlier&nbsp;than&nbsp;any&nbsp;of&nbsp;the&nbsp;others.</span><br>
<span class="lineno">90</span><span class="comment" id="1680436">//&nbsp;Timers&nbsp;are&nbsp;locked.</span><br>
<span class="lineno"></span><span class="keyword" id="1680458">func</span>&nbsp;<span class="ident" id="1680463">addtimerLocked</span><span class="op" id="1680477">(</span><span class="ident" id="1680478">t</span>&nbsp;<span class="op" id="1680480">*</span><span class="ident" id="1680481">timer</span><span class="op" id="1680486">)</span>&nbsp;<span class="op" id="1680488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1680491">//&nbsp;when&nbsp;must&nbsp;never&nbsp;be&nbsp;negative;&nbsp;otherwise&nbsp;timerproc&nbsp;will&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1680558">//&nbsp;during&nbsp;its&nbsp;delta&nbsp;calculation&nbsp;and&nbsp;never&nbsp;expire&nbsp;other&nbsp;runtimeÂ·timers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680631">if</span>&nbsp;<span class="ident" id="1680634">t</span><span class="op" id="1680635">.</span><span class="ident" id="1680636">when</span>&nbsp;<span class="op" id="1680641">&lt;</span>&nbsp;<span class="num" id="1680643">0</span>&nbsp;<span class="op" id="1680645">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680649">t</span><span class="op" id="1680650">.</span><span class="ident" id="1680651">when</span>&nbsp;<span class="op" id="1680656">=</span>&nbsp;<span class="num" id="1680658">1</span><span class="op" id="1680659">&lt;&lt;</span><span class="num" id="1680661">63</span>&nbsp;<span class="op" id="1680664">-</span>&nbsp;<span class="num" id="1680666">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1680669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680672">t</span><span class="op" id="1680673">.</span><span class="ident" id="1680674">i</span>&nbsp;<span class="op" id="1680676">=</span>&nbsp;<span class="builtinfunc" id="1680678">len</span><span class="op" id="1680681">(</span><span class="ident" id="1680682">timers</span><span class="op" id="1680688">.</span><span class="ident" id="1680689">t</span><span class="op" id="1680690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680693">timers</span><span class="op" id="1680699">.</span><span class="ident" id="1680700">t</span>&nbsp;<span class="op" id="1680702">=</span>&nbsp;<span class="builtinfunc" id="1680704">append</span><span class="op" id="1680710">(</span><span class="ident" id="1680711">timers</span><span class="op" id="1680717">.</span><span class="ident" id="1680718">t</span><span class="op" id="1680719">,</span>&nbsp;<span class="ident" id="1680721">t</span><span class="op" id="1680722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680725">siftupTimer</span><span class="op" id="1680736">(</span><span class="ident" id="1680737">t</span><span class="op" id="1680738">.</span><span class="ident" id="1680739">i</span><span class="op" id="1680740">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680743">if</span>&nbsp;<span class="ident" id="1680746">t</span><span class="op" id="1680747">.</span><span class="ident" id="1680748">i</span>&nbsp;<span class="op" id="1680750">==</span>&nbsp;<span class="num" id="1680753">0</span>&nbsp;<span class="op" id="1680755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1680759">//&nbsp;siftup&nbsp;moved&nbsp;to&nbsp;top:&nbsp;new&nbsp;earliest&nbsp;deadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680808">if</span>&nbsp;<span class="ident" id="1680811">timers</span><span class="op" id="1680817">.</span><span class="ident" id="1680818">sleeping</span>&nbsp;<span class="op" id="1680827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680832">timers</span><span class="op" id="1680838">.</span><span class="ident" id="1680839">sleeping</span>&nbsp;<span class="op" id="1680848">=</span>&nbsp;<span class="builtintype" id="1680850">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680859">notewakeup</span><span class="op" id="1680869">(</span><span class="op" id="1680870">&amp;</span><span class="ident" id="1680871">timers</span><span class="op" id="1680877">.</span><span class="ident" id="1680878">waitnote</span><span class="op" id="1680886">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1680890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680894">if</span>&nbsp;<span class="ident" id="1680897">timers</span><span class="op" id="1680903">.</span><span class="ident" id="1680904">rescheduling</span>&nbsp;<span class="op" id="1680917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680922">timers</span><span class="op" id="1680928">.</span><span class="ident" id="1680929">rescheduling</span>&nbsp;<span class="op" id="1680942">=</span>&nbsp;<span class="builtintype" id="1680944">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1680953">goready</span><span class="op" id="1680960">(</span><span class="ident" id="1680961">timers</span><span class="op" id="1680967">.</span><span class="ident" id="1680968">gp</span><span class="op" id="1680970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1680974">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1680977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1680980">if</span>&nbsp;<span class="op" id="1680983">!</span><span class="ident" id="1680984">timers</span><span class="op" id="1680990">.</span><span class="ident" id="1680991">created</span>&nbsp;<span class="op" id="1680999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681003">timers</span><span class="op" id="1681009">.</span><span class="ident" id="1681010">created</span>&nbsp;<span class="op" id="1681018">=</span>&nbsp;<span class="builtintype" id="1681020">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681027">go</span>&nbsp;<span class="ident" id="1681030">timerproc</span><span class="op" id="1681039">(</span><span class="op" id="1681040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1681043">}</span><br>
<span class="lineno">115</span><span class="op" id="1681045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1681048">//&nbsp;Delete&nbsp;timer&nbsp;t&nbsp;from&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span><span class="comment" id="1681081">//&nbsp;Do&nbsp;not&nbsp;need&nbsp;to&nbsp;update&nbsp;the&nbsp;timerproc:&nbsp;if&nbsp;it&nbsp;wakes&nbsp;up&nbsp;early,&nbsp;no&nbsp;big&nbsp;deal.</span><br>
<span class="lineno"></span><span class="keyword" id="1681156">func</span>&nbsp;<span class="ident" id="1681161">deltimer</span><span class="op" id="1681169">(</span><span class="ident" id="1681170">t</span>&nbsp;<span class="op" id="1681172">*</span><span class="ident" id="1681173">timer</span><span class="op" id="1681178">)</span>&nbsp;<span class="builtintype" id="1681180">bool</span>&nbsp;<span class="op" id="1681185">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1681188">//&nbsp;Dereference&nbsp;t&nbsp;so&nbsp;that&nbsp;any&nbsp;panic&nbsp;happens&nbsp;before&nbsp;the&nbsp;lock&nbsp;is&nbsp;held.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1681257">//&nbsp;Discard&nbsp;result,&nbsp;because&nbsp;t&nbsp;might&nbsp;be&nbsp;moving&nbsp;in&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681316">_</span>&nbsp;<span class="op" id="1681318">=</span>&nbsp;<span class="ident" id="1681320">t</span><span class="op" id="1681321">.</span><span class="ident" id="1681322">i</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681326">lock</span><span class="op" id="1681330">(</span><span class="op" id="1681331">&amp;</span><span class="ident" id="1681332">timers</span><span class="op" id="1681338">.</span><span class="ident" id="1681339">lock</span><span class="op" id="1681343">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1681346">//&nbsp;t&nbsp;may&nbsp;not&nbsp;be&nbsp;registered&nbsp;anymore&nbsp;and&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1681395">//&nbsp;a&nbsp;bogus&nbsp;i&nbsp;(typically&nbsp;0,&nbsp;if&nbsp;generated&nbsp;by&nbsp;Go).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1681444">//&nbsp;Verify&nbsp;it&nbsp;before&nbsp;proceeding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681477">i</span>&nbsp;<span class="op" id="1681479">:=</span>&nbsp;<span class="ident" id="1681482">t</span><span class="op" id="1681483">.</span><span class="ident" id="1681484">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681487">last</span>&nbsp;<span class="op" id="1681492">:=</span>&nbsp;<span class="builtinfunc" id="1681495">len</span><span class="op" id="1681498">(</span><span class="ident" id="1681499">timers</span><span class="op" id="1681505">.</span><span class="ident" id="1681506">t</span><span class="op" id="1681507">)</span>&nbsp;<span class="op" id="1681509">-</span>&nbsp;<span class="num" id="1681511">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681514">if</span>&nbsp;<span class="ident" id="1681517">i</span>&nbsp;<span class="op" id="1681519">&lt;</span>&nbsp;<span class="num" id="1681521">0</span>&nbsp;<span class="op" id="1681523">||</span>&nbsp;<span class="ident" id="1681526">i</span>&nbsp;<span class="op" id="1681528">&gt;</span>&nbsp;<span class="ident" id="1681530">last</span>&nbsp;<span class="op" id="1681535">||</span>&nbsp;<span class="ident" id="1681538">timers</span><span class="op" id="1681544">.</span><span class="ident" id="1681545">t</span><span class="op" id="1681546">[</span><span class="ident" id="1681547">i</span><span class="op" id="1681548">]</span>&nbsp;<span class="op" id="1681550">!=</span>&nbsp;<span class="ident" id="1681553">t</span>&nbsp;<span class="op" id="1681555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681559">unlock</span><span class="op" id="1681565">(</span><span class="op" id="1681566">&amp;</span><span class="ident" id="1681567">timers</span><span class="op" id="1681573">.</span><span class="ident" id="1681574">lock</span><span class="op" id="1681578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681582">return</span>&nbsp;<span class="builtintype" id="1681589">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1681596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681599">if</span>&nbsp;<span class="ident" id="1681602">i</span>&nbsp;<span class="op" id="1681604">!=</span>&nbsp;<span class="ident" id="1681607">last</span>&nbsp;<span class="op" id="1681612">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681616">timers</span><span class="op" id="1681622">.</span><span class="ident" id="1681623">t</span><span class="op" id="1681624">[</span><span class="ident" id="1681625">i</span><span class="op" id="1681626">]</span>&nbsp;<span class="op" id="1681628">=</span>&nbsp;<span class="ident" id="1681630">timers</span><span class="op" id="1681636">.</span><span class="ident" id="1681637">t</span><span class="op" id="1681638">[</span><span class="ident" id="1681639">last</span><span class="op" id="1681643">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681647">timers</span><span class="op" id="1681653">.</span><span class="ident" id="1681654">t</span><span class="op" id="1681655">[</span><span class="ident" id="1681656">i</span><span class="op" id="1681657">]</span><span class="op" id="1681658">.</span><span class="ident" id="1681659">i</span>&nbsp;<span class="op" id="1681661">=</span>&nbsp;<span class="ident" id="1681663">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1681666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681669">timers</span><span class="op" id="1681675">.</span><span class="ident" id="1681676">t</span><span class="op" id="1681677">[</span><span class="ident" id="1681678">last</span><span class="op" id="1681682">]</span>&nbsp;<span class="op" id="1681684">=</span>&nbsp;<span class="ident" id="1681686">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681691">timers</span><span class="op" id="1681697">.</span><span class="ident" id="1681698">t</span>&nbsp;<span class="op" id="1681700">=</span>&nbsp;<span class="ident" id="1681702">timers</span><span class="op" id="1681708">.</span><span class="ident" id="1681709">t</span><span class="op" id="1681710">[</span><span class="op" id="1681711">:</span><span class="ident" id="1681712">last</span><span class="op" id="1681716">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681719">if</span>&nbsp;<span class="ident" id="1681722">i</span>&nbsp;<span class="op" id="1681724">!=</span>&nbsp;<span class="ident" id="1681727">last</span>&nbsp;<span class="op" id="1681732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681736">siftupTimer</span><span class="op" id="1681747">(</span><span class="ident" id="1681748">i</span><span class="op" id="1681749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681753">siftdownTimer</span><span class="op" id="1681766">(</span><span class="ident" id="1681767">i</span><span class="op" id="1681768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1681771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1681774">unlock</span><span class="op" id="1681780">(</span><span class="op" id="1681781">&amp;</span><span class="ident" id="1681782">timers</span><span class="op" id="1681788">.</span><span class="ident" id="1681789">lock</span><span class="op" id="1681793">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1681796">return</span>&nbsp;<span class="builtintype" id="1681803">true</span><br>
<span class="lineno"></span><span class="op" id="1681808">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1681811">//&nbsp;Timerproc&nbsp;runs&nbsp;the&nbsp;time-driven&nbsp;events.</span><br>
<span class="lineno"></span><span class="comment" id="1681853">//&nbsp;It&nbsp;sleeps&nbsp;until&nbsp;the&nbsp;next&nbsp;event&nbsp;in&nbsp;the&nbsp;timers&nbsp;heap.</span><br>
<span class="lineno">150</span><span class="comment" id="1681907">//&nbsp;If&nbsp;addtimer&nbsp;inserts&nbsp;a&nbsp;new&nbsp;earlier&nbsp;event,&nbsp;addtimer1&nbsp;wakes&nbsp;timerproc&nbsp;early.</span><br>
<span class="lineno"></span><span class="keyword" id="1681984">func</span>&nbsp;<span class="ident" id="1681989">timerproc</span><span class="op" id="1681998">(</span><span class="op" id="1681999">)</span>&nbsp;<span class="op" id="1682001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682004">timers</span><span class="op" id="1682010">.</span><span class="ident" id="1682011">gp</span>&nbsp;<span class="op" id="1682014">=</span>&nbsp;<span class="ident" id="1682016">getg</span><span class="op" id="1682020">(</span><span class="op" id="1682021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682024">timers</span><span class="op" id="1682030">.</span><span class="ident" id="1682031">gp</span><span class="op" id="1682033">.</span><span class="ident" id="1682034">issystem</span>&nbsp;<span class="op" id="1682043">=</span>&nbsp;<span class="builtintype" id="1682045">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682051">for</span>&nbsp;<span class="op" id="1682055">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682059">lock</span><span class="op" id="1682063">(</span><span class="op" id="1682064">&amp;</span><span class="ident" id="1682065">timers</span><span class="op" id="1682071">.</span><span class="ident" id="1682072">lock</span><span class="op" id="1682076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682080">timers</span><span class="op" id="1682086">.</span><span class="ident" id="1682087">sleeping</span>&nbsp;<span class="op" id="1682096">=</span>&nbsp;<span class="builtintype" id="1682098">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682106">now</span>&nbsp;<span class="op" id="1682110">:=</span>&nbsp;<span class="ident" id="1682113">nanotime</span><span class="op" id="1682121">(</span><span class="op" id="1682122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682126">delta</span>&nbsp;<span class="op" id="1682132">:=</span>&nbsp;<span class="ident" id="1682135">int64</span><span class="op" id="1682140">(</span><span class="op" id="1682141">-</span><span class="num" id="1682142">1</span><span class="op" id="1682143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682147">for</span>&nbsp;<span class="op" id="1682151">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682156">if</span>&nbsp;<span class="builtinfunc" id="1682159">len</span><span class="op" id="1682162">(</span><span class="ident" id="1682163">timers</span><span class="op" id="1682169">.</span><span class="ident" id="1682170">t</span><span class="op" id="1682171">)</span>&nbsp;<span class="op" id="1682173">==</span>&nbsp;<span class="num" id="1682176">0</span>&nbsp;<span class="op" id="1682178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682184">delta</span>&nbsp;<span class="op" id="1682190">=</span>&nbsp;<span class="op" id="1682192">-</span><span class="num" id="1682193">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682199">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1682208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682213">t</span>&nbsp;<span class="op" id="1682215">:=</span>&nbsp;<span class="ident" id="1682218">timers</span><span class="op" id="1682224">.</span><span class="ident" id="1682225">t</span><span class="op" id="1682226">[</span><span class="num" id="1682227">0</span><span class="op" id="1682228">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682233">delta</span>&nbsp;<span class="op" id="1682239">=</span>&nbsp;<span class="ident" id="1682241">t</span><span class="op" id="1682242">.</span><span class="ident" id="1682243">when</span>&nbsp;<span class="op" id="1682248">-</span>&nbsp;<span class="ident" id="1682250">now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682257">if</span>&nbsp;<span class="ident" id="1682260">delta</span>&nbsp;<span class="op" id="1682266">&gt;</span>&nbsp;<span class="num" id="1682268">0</span>&nbsp;<span class="op" id="1682270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682276">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1682285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682290">if</span>&nbsp;<span class="ident" id="1682293">t</span><span class="op" id="1682294">.</span><span class="ident" id="1682295">period</span>&nbsp;<span class="op" id="1682302">&gt;</span>&nbsp;<span class="num" id="1682304">0</span>&nbsp;<span class="op" id="1682306">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1682312">//&nbsp;leave&nbsp;in&nbsp;heap&nbsp;but&nbsp;adjust&nbsp;next&nbsp;time&nbsp;to&nbsp;fire</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682362">t</span><span class="op" id="1682363">.</span><span class="ident" id="1682364">when</span>&nbsp;<span class="op" id="1682369">+=</span>&nbsp;<span class="ident" id="1682372">t</span><span class="op" id="1682373">.</span><span class="ident" id="1682374">period</span>&nbsp;<span class="op" id="1682381">*</span>&nbsp;<span class="op" id="1682383">(</span><span class="num" id="1682384">1</span>&nbsp;<span class="op" id="1682386">+</span>&nbsp;<span class="op" id="1682388">-</span><span class="ident" id="1682389">delta</span><span class="op" id="1682394">/</span><span class="ident" id="1682395">t</span><span class="op" id="1682396">.</span><span class="ident" id="1682397">period</span><span class="op" id="1682403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682409">siftdownTimer</span><span class="op" id="1682422">(</span><span class="num" id="1682423">0</span><span class="op" id="1682424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1682429">}</span>&nbsp;<span class="keyword" id="1682431">else</span>&nbsp;<span class="op" id="1682436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1682442">//&nbsp;remove&nbsp;from&nbsp;heap</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682466">last</span>&nbsp;<span class="op" id="1682471">:=</span>&nbsp;<span class="builtinfunc" id="1682474">len</span><span class="op" id="1682477">(</span><span class="ident" id="1682478">timers</span><span class="op" id="1682484">.</span><span class="ident" id="1682485">t</span><span class="op" id="1682486">)</span>&nbsp;<span class="op" id="1682488">-</span>&nbsp;<span class="num" id="1682490">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682496">if</span>&nbsp;<span class="ident" id="1682499">last</span>&nbsp;<span class="op" id="1682504">&gt;</span>&nbsp;<span class="num" id="1682506">0</span>&nbsp;<span class="op" id="1682508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682515">timers</span><span class="op" id="1682521">.</span><span class="ident" id="1682522">t</span><span class="op" id="1682523">[</span><span class="num" id="1682524">0</span><span class="op" id="1682525">]</span>&nbsp;<span class="op" id="1682527">=</span>&nbsp;<span class="ident" id="1682529">timers</span><span class="op" id="1682535">.</span><span class="ident" id="1682536">t</span><span class="op" id="1682537">[</span><span class="ident" id="1682538">last</span><span class="op" id="1682542">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682549">timers</span><span class="op" id="1682555">.</span><span class="ident" id="1682556">t</span><span class="op" id="1682557">[</span><span class="num" id="1682558">0</span><span class="op" id="1682559">]</span><span class="op" id="1682560">.</span><span class="ident" id="1682561">i</span>&nbsp;<span class="op" id="1682563">=</span>&nbsp;<span class="num" id="1682565">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1682571">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682577">timers</span><span class="op" id="1682583">.</span><span class="ident" id="1682584">t</span><span class="op" id="1682585">[</span><span class="ident" id="1682586">last</span><span class="op" id="1682590">]</span>&nbsp;<span class="op" id="1682592">=</span>&nbsp;<span class="ident" id="1682594">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682602">timers</span><span class="op" id="1682608">.</span><span class="ident" id="1682609">t</span>&nbsp;<span class="op" id="1682611">=</span>&nbsp;<span class="ident" id="1682613">timers</span><span class="op" id="1682619">.</span><span class="ident" id="1682620">t</span><span class="op" id="1682621">[</span><span class="op" id="1682622">:</span><span class="ident" id="1682623">last</span><span class="op" id="1682627">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682633">if</span>&nbsp;<span class="ident" id="1682636">last</span>&nbsp;<span class="op" id="1682641">&gt;</span>&nbsp;<span class="num" id="1682643">0</span>&nbsp;<span class="op" id="1682645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682652">siftdownTimer</span><span class="op" id="1682665">(</span><span class="num" id="1682666">0</span><span class="op" id="1682667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1682673">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682679">t</span><span class="op" id="1682680">.</span><span class="ident" id="1682681">i</span>&nbsp;<span class="op" id="1682683">=</span>&nbsp;<span class="op" id="1682685">-</span><span class="num" id="1682686">1</span>&nbsp;<span class="comment" id="1682688">//&nbsp;mark&nbsp;as&nbsp;removed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1682710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682715">f</span>&nbsp;<span class="op" id="1682717">:=</span>&nbsp;<span class="ident" id="1682720">t</span><span class="op" id="1682721">.</span><span class="ident" id="1682722">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682727">arg</span>&nbsp;<span class="op" id="1682731">:=</span>&nbsp;<span class="ident" id="1682734">t</span><span class="op" id="1682735">.</span><span class="ident" id="1682736">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682743">seq</span>&nbsp;<span class="op" id="1682747">:=</span>&nbsp;<span class="ident" id="1682750">t</span><span class="op" id="1682751">.</span><span class="ident" id="1682752">seq</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682759">unlock</span><span class="op" id="1682765">(</span><span class="op" id="1682766">&amp;</span><span class="ident" id="1682767">timers</span><span class="op" id="1682773">.</span><span class="ident" id="1682774">lock</span><span class="op" id="1682778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682783">if</span>&nbsp;<span class="ident" id="1682786">raceenabled</span>&nbsp;<span class="op" id="1682798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682804">raceacquire</span><span class="op" id="1682815">(</span><span class="ident" id="1682816">unsafe</span><span class="op" id="1682822">.</span><span class="ident" id="1682823">Pointer</span><span class="op" id="1682830">(</span><span class="ident" id="1682831">t</span><span class="op" id="1682832">)</span><span class="op" id="1682833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1682838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682843">f</span><span class="op" id="1682844">(</span><span class="ident" id="1682845">arg</span><span class="op" id="1682848">,</span>&nbsp;<span class="ident" id="1682850">seq</span><span class="op" id="1682853">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682858">lock</span><span class="op" id="1682862">(</span><span class="op" id="1682863">&amp;</span><span class="ident" id="1682864">timers</span><span class="op" id="1682870">.</span><span class="ident" id="1682871">lock</span><span class="op" id="1682875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1682879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1682883">if</span>&nbsp;<span class="ident" id="1682886">delta</span>&nbsp;<span class="op" id="1682892">&lt;</span>&nbsp;<span class="num" id="1682894">0</span>&nbsp;<span class="op" id="1682896">||</span>&nbsp;<span class="ident" id="1682899">faketime</span>&nbsp;<span class="op" id="1682908">&gt;</span>&nbsp;<span class="num" id="1682910">0</span>&nbsp;<span class="op" id="1682912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1682917">//&nbsp;No&nbsp;timers&nbsp;left&nbsp;-&nbsp;put&nbsp;goroutine&nbsp;to&nbsp;sleep.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682964">timers</span><span class="op" id="1682970">.</span><span class="ident" id="1682971">rescheduling</span>&nbsp;<span class="op" id="1682984">=</span>&nbsp;<span class="builtintype" id="1682986">true</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1682994">goparkunlock</span><span class="op" id="1683006">(</span><span class="op" id="1683007">&amp;</span><span class="ident" id="1683008">timers</span><span class="op" id="1683014">.</span><span class="ident" id="1683015">lock</span><span class="op" id="1683019">,</span>&nbsp;<span class="string" id="1683021">&#34;timer&nbsp;goroutine&nbsp;(idle)&#34;</span><span class="op" id="1683045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683050">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1683061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1683065">//&nbsp;At&nbsp;least&nbsp;one&nbsp;timer&nbsp;pending.&nbsp;&nbsp;Sleep&nbsp;until&nbsp;then.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683117">timers</span><span class="op" id="1683123">.</span><span class="ident" id="1683124">sleeping</span>&nbsp;<span class="op" id="1683133">=</span>&nbsp;<span class="builtintype" id="1683135">true</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683142">noteclear</span><span class="op" id="1683151">(</span><span class="op" id="1683152">&amp;</span><span class="ident" id="1683153">timers</span><span class="op" id="1683159">.</span><span class="ident" id="1683160">waitnote</span><span class="op" id="1683168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683172">unlock</span><span class="op" id="1683178">(</span><span class="op" id="1683179">&amp;</span><span class="ident" id="1683180">timers</span><span class="op" id="1683186">.</span><span class="ident" id="1683187">lock</span><span class="op" id="1683191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683195">notetsleepg</span><span class="op" id="1683206">(</span><span class="op" id="1683207">&amp;</span><span class="ident" id="1683208">timers</span><span class="op" id="1683214">.</span><span class="ident" id="1683215">waitnote</span><span class="op" id="1683223">,</span>&nbsp;<span class="ident" id="1683225">delta</span><span class="op" id="1683230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1683233">}</span><br>
<span class="lineno"></span><span class="op" id="1683235">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="1683238">func</span>&nbsp;<span class="ident" id="1683243">timejump</span><span class="op" id="1683251">(</span><span class="op" id="1683252">)</span>&nbsp;<span class="op" id="1683254">*</span><span class="ident" id="1683255">g</span>&nbsp;<span class="op" id="1683257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683260">if</span>&nbsp;<span class="ident" id="1683263">faketime</span>&nbsp;<span class="op" id="1683272">==</span>&nbsp;<span class="num" id="1683275">0</span>&nbsp;<span class="op" id="1683277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683281">return</span>&nbsp;<span class="ident" id="1683288">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1683293">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683297">lock</span><span class="op" id="1683301">(</span><span class="op" id="1683302">&amp;</span><span class="ident" id="1683303">timers</span><span class="op" id="1683309">.</span><span class="ident" id="1683310">lock</span><span class="op" id="1683314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683317">if</span>&nbsp;<span class="op" id="1683320">!</span><span class="ident" id="1683321">timers</span><span class="op" id="1683327">.</span><span class="ident" id="1683328">created</span>&nbsp;<span class="op" id="1683336">||</span>&nbsp;<span class="builtinfunc" id="1683339">len</span><span class="op" id="1683342">(</span><span class="ident" id="1683343">timers</span><span class="op" id="1683349">.</span><span class="ident" id="1683350">t</span><span class="op" id="1683351">)</span>&nbsp;<span class="op" id="1683353">==</span>&nbsp;<span class="num" id="1683356">0</span>&nbsp;<span class="op" id="1683358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683362">unlock</span><span class="op" id="1683368">(</span><span class="op" id="1683369">&amp;</span><span class="ident" id="1683370">timers</span><span class="op" id="1683376">.</span><span class="ident" id="1683377">lock</span><span class="op" id="1683381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683385">return</span>&nbsp;<span class="ident" id="1683392">nil</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1683397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683401">var</span>&nbsp;<span class="ident" id="1683405">gp</span>&nbsp;<span class="op" id="1683408">*</span><span class="ident" id="1683409">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683412">if</span>&nbsp;<span class="ident" id="1683415">faketime</span>&nbsp;<span class="op" id="1683424">&lt;</span>&nbsp;<span class="ident" id="1683426">timers</span><span class="op" id="1683432">.</span><span class="ident" id="1683433">t</span><span class="op" id="1683434">[</span><span class="num" id="1683435">0</span><span class="op" id="1683436">]</span><span class="op" id="1683437">.</span><span class="ident" id="1683438">when</span>&nbsp;<span class="op" id="1683443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683447">faketime</span>&nbsp;<span class="op" id="1683456">=</span>&nbsp;<span class="ident" id="1683458">timers</span><span class="op" id="1683464">.</span><span class="ident" id="1683465">t</span><span class="op" id="1683466">[</span><span class="num" id="1683467">0</span><span class="op" id="1683468">]</span><span class="op" id="1683469">.</span><span class="ident" id="1683470">when</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683477">if</span>&nbsp;<span class="ident" id="1683480">timers</span><span class="op" id="1683486">.</span><span class="ident" id="1683487">rescheduling</span>&nbsp;<span class="op" id="1683500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683505">timers</span><span class="op" id="1683511">.</span><span class="ident" id="1683512">rescheduling</span>&nbsp;<span class="op" id="1683525">=</span>&nbsp;<span class="builtintype" id="1683527">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683536">gp</span>&nbsp;<span class="op" id="1683539">=</span>&nbsp;<span class="ident" id="1683541">timers</span><span class="op" id="1683547">.</span><span class="ident" id="1683548">gp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1683553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1683556">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683559">unlock</span><span class="op" id="1683565">(</span><span class="op" id="1683566">&amp;</span><span class="ident" id="1683567">timers</span><span class="op" id="1683573">.</span><span class="ident" id="1683574">lock</span><span class="op" id="1683578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683581">return</span>&nbsp;<span class="ident" id="1683588">gp</span><br>
<span class="lineno"></span><span class="op" id="1683591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1683594">//&nbsp;Heap&nbsp;maintenance&nbsp;algorithms.</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="1683627">func</span>&nbsp;<span class="ident" id="1683632">siftupTimer</span><span class="op" id="1683643">(</span><span class="ident" id="1683644">i</span>&nbsp;<span class="builtintype" id="1683646">int</span><span class="op" id="1683649">)</span>&nbsp;<span class="op" id="1683651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683654">t</span>&nbsp;<span class="op" id="1683656">:=</span>&nbsp;<span class="ident" id="1683659">timers</span><span class="op" id="1683665">.</span><span class="ident" id="1683666">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683669">when</span>&nbsp;<span class="op" id="1683674">:=</span>&nbsp;<span class="ident" id="1683677">t</span><span class="op" id="1683678">[</span><span class="ident" id="1683679">i</span><span class="op" id="1683680">]</span><span class="op" id="1683681">.</span><span class="ident" id="1683682">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683688">tmp</span>&nbsp;<span class="op" id="1683692">:=</span>&nbsp;<span class="ident" id="1683695">t</span><span class="op" id="1683696">[</span><span class="ident" id="1683697">i</span><span class="op" id="1683698">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683701">for</span>&nbsp;<span class="ident" id="1683705">i</span>&nbsp;<span class="op" id="1683707">&gt;</span>&nbsp;<span class="num" id="1683709">0</span>&nbsp;<span class="op" id="1683711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683715">p</span>&nbsp;<span class="op" id="1683717">:=</span>&nbsp;<span class="op" id="1683720">(</span><span class="ident" id="1683721">i</span>&nbsp;<span class="op" id="1683723">-</span>&nbsp;<span class="num" id="1683725">1</span><span class="op" id="1683726">)</span>&nbsp;<span class="op" id="1683728">/</span>&nbsp;<span class="num" id="1683730">4</span>&nbsp;<span class="comment" id="1683732">//&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683744">if</span>&nbsp;<span class="ident" id="1683747">when</span>&nbsp;<span class="op" id="1683752">&gt;=</span>&nbsp;<span class="ident" id="1683755">t</span><span class="op" id="1683756">[</span><span class="ident" id="1683757">p</span><span class="op" id="1683758">]</span><span class="op" id="1683759">.</span><span class="ident" id="1683760">when</span>&nbsp;<span class="op" id="1683765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683770">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1683778">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683782">t</span><span class="op" id="1683783">[</span><span class="ident" id="1683784">i</span><span class="op" id="1683785">]</span>&nbsp;<span class="op" id="1683787">=</span>&nbsp;<span class="ident" id="1683789">t</span><span class="op" id="1683790">[</span><span class="ident" id="1683791">p</span><span class="op" id="1683792">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683796">t</span><span class="op" id="1683797">[</span><span class="ident" id="1683798">i</span><span class="op" id="1683799">]</span><span class="op" id="1683800">.</span><span class="ident" id="1683801">i</span>&nbsp;<span class="op" id="1683803">=</span>&nbsp;<span class="ident" id="1683805">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683809">t</span><span class="op" id="1683810">[</span><span class="ident" id="1683811">p</span><span class="op" id="1683812">]</span>&nbsp;<span class="op" id="1683814">=</span>&nbsp;<span class="ident" id="1683816">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683822">t</span><span class="op" id="1683823">[</span><span class="ident" id="1683824">p</span><span class="op" id="1683825">]</span><span class="op" id="1683826">.</span><span class="ident" id="1683827">i</span>&nbsp;<span class="op" id="1683829">=</span>&nbsp;<span class="ident" id="1683831">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683835">i</span>&nbsp;<span class="op" id="1683837">=</span>&nbsp;<span class="ident" id="1683839">p</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1683842">}</span><br>
<span class="lineno"></span><span class="op" id="1683844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1683847">func</span>&nbsp;<span class="ident" id="1683852">siftdownTimer</span><span class="op" id="1683865">(</span><span class="ident" id="1683866">i</span>&nbsp;<span class="builtintype" id="1683868">int</span><span class="op" id="1683871">)</span>&nbsp;<span class="op" id="1683873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683876">t</span>&nbsp;<span class="op" id="1683878">:=</span>&nbsp;<span class="ident" id="1683881">timers</span><span class="op" id="1683887">.</span><span class="ident" id="1683888">t</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683891">n</span>&nbsp;<span class="op" id="1683893">:=</span>&nbsp;<span class="builtinfunc" id="1683896">len</span><span class="op" id="1683899">(</span><span class="ident" id="1683900">t</span><span class="op" id="1683901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683904">when</span>&nbsp;<span class="op" id="1683909">:=</span>&nbsp;<span class="ident" id="1683912">t</span><span class="op" id="1683913">[</span><span class="ident" id="1683914">i</span><span class="op" id="1683915">]</span><span class="op" id="1683916">.</span><span class="ident" id="1683917">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683923">tmp</span>&nbsp;<span class="op" id="1683927">:=</span>&nbsp;<span class="ident" id="1683930">t</span><span class="op" id="1683931">[</span><span class="ident" id="1683932">i</span><span class="op" id="1683933">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1683936">for</span>&nbsp;<span class="op" id="1683940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683944">c</span>&nbsp;<span class="op" id="1683946">:=</span>&nbsp;<span class="ident" id="1683949">i</span><span class="op" id="1683950">*</span><span class="num" id="1683951">4</span>&nbsp;<span class="op" id="1683953">+</span>&nbsp;<span class="num" id="1683955">1</span>&nbsp;<span class="comment" id="1683957">//&nbsp;left&nbsp;child</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1683973">c3</span>&nbsp;<span class="op" id="1683976">:=</span>&nbsp;<span class="ident" id="1683979">c</span>&nbsp;<span class="op" id="1683981">+</span>&nbsp;<span class="num" id="1683983">2</span>&nbsp;&nbsp;<span class="comment" id="1683986">//&nbsp;mid&nbsp;child</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1684001">if</span>&nbsp;<span class="ident" id="1684004">c</span>&nbsp;<span class="op" id="1684006">&gt;=</span>&nbsp;<span class="ident" id="1684009">n</span>&nbsp;<span class="op" id="1684011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1684016">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684028">w</span>&nbsp;<span class="op" id="1684030">:=</span>&nbsp;<span class="ident" id="1684033">t</span><span class="op" id="1684034">[</span><span class="ident" id="1684035">c</span><span class="op" id="1684036">]</span><span class="op" id="1684037">.</span><span class="ident" id="1684038">when</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1684045">if</span>&nbsp;<span class="ident" id="1684048">c</span><span class="op" id="1684049">+</span><span class="num" id="1684050">1</span>&nbsp;<span class="op" id="1684052">&lt;</span>&nbsp;<span class="ident" id="1684054">n</span>&nbsp;<span class="op" id="1684056">&amp;&amp;</span>&nbsp;<span class="ident" id="1684059">t</span><span class="op" id="1684060">[</span><span class="ident" id="1684061">c</span><span class="op" id="1684062">+</span><span class="num" id="1684063">1</span><span class="op" id="1684064">]</span><span class="op" id="1684065">.</span><span class="ident" id="1684066">when</span>&nbsp;<span class="op" id="1684071">&lt;</span>&nbsp;<span class="ident" id="1684073">w</span>&nbsp;<span class="op" id="1684075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684080">w</span>&nbsp;<span class="op" id="1684082">=</span>&nbsp;<span class="ident" id="1684084">t</span><span class="op" id="1684085">[</span><span class="ident" id="1684086">c</span><span class="op" id="1684087">+</span><span class="num" id="1684088">1</span><span class="op" id="1684089">]</span><span class="op" id="1684090">.</span><span class="ident" id="1684091">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684099">c</span><span class="op" id="1684100">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1684109">if</span>&nbsp;<span class="ident" id="1684112">c3</span>&nbsp;<span class="op" id="1684115">&lt;</span>&nbsp;<span class="ident" id="1684117">n</span>&nbsp;<span class="op" id="1684119">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684124">w3</span>&nbsp;<span class="op" id="1684127">:=</span>&nbsp;<span class="ident" id="1684130">t</span><span class="op" id="1684131">[</span><span class="ident" id="1684132">c3</span><span class="op" id="1684134">]</span><span class="op" id="1684135">.</span><span class="ident" id="1684136">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1684144">if</span>&nbsp;<span class="ident" id="1684147">c3</span><span class="op" id="1684149">+</span><span class="num" id="1684150">1</span>&nbsp;<span class="op" id="1684152">&lt;</span>&nbsp;<span class="ident" id="1684154">n</span>&nbsp;<span class="op" id="1684156">&amp;&amp;</span>&nbsp;<span class="ident" id="1684159">t</span><span class="op" id="1684160">[</span><span class="ident" id="1684161">c3</span><span class="op" id="1684163">+</span><span class="num" id="1684164">1</span><span class="op" id="1684165">]</span><span class="op" id="1684166">.</span><span class="ident" id="1684167">when</span>&nbsp;<span class="op" id="1684172">&lt;</span>&nbsp;<span class="ident" id="1684174">w3</span>&nbsp;<span class="op" id="1684177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684183">w3</span>&nbsp;<span class="op" id="1684186">=</span>&nbsp;<span class="ident" id="1684188">t</span><span class="op" id="1684189">[</span><span class="ident" id="1684190">c3</span><span class="op" id="1684192">+</span><span class="num" id="1684193">1</span><span class="op" id="1684194">]</span><span class="op" id="1684195">.</span><span class="ident" id="1684196">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684205">c3</span><span class="op" id="1684207">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684213">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1684218">if</span>&nbsp;<span class="ident" id="1684221">w3</span>&nbsp;<span class="op" id="1684224">&lt;</span>&nbsp;<span class="ident" id="1684226">w</span>&nbsp;<span class="op" id="1684228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684234">w</span>&nbsp;<span class="op" id="1684236">=</span>&nbsp;<span class="ident" id="1684238">w3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684245">c</span>&nbsp;<span class="op" id="1684247">=</span>&nbsp;<span class="ident" id="1684249">c3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684259">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1684263">if</span>&nbsp;<span class="ident" id="1684266">w</span>&nbsp;<span class="op" id="1684268">&gt;=</span>&nbsp;<span class="ident" id="1684271">when</span>&nbsp;<span class="op" id="1684276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1684281">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684293">t</span><span class="op" id="1684294">[</span><span class="ident" id="1684295">i</span><span class="op" id="1684296">]</span>&nbsp;<span class="op" id="1684298">=</span>&nbsp;<span class="ident" id="1684300">t</span><span class="op" id="1684301">[</span><span class="ident" id="1684302">c</span><span class="op" id="1684303">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684307">t</span><span class="op" id="1684308">[</span><span class="ident" id="1684309">i</span><span class="op" id="1684310">]</span><span class="op" id="1684311">.</span><span class="ident" id="1684312">i</span>&nbsp;<span class="op" id="1684314">=</span>&nbsp;<span class="ident" id="1684316">i</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684320">t</span><span class="op" id="1684321">[</span><span class="ident" id="1684322">c</span><span class="op" id="1684323">]</span>&nbsp;<span class="op" id="1684325">=</span>&nbsp;<span class="ident" id="1684327">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684333">t</span><span class="op" id="1684334">[</span><span class="ident" id="1684335">c</span><span class="op" id="1684336">]</span><span class="op" id="1684337">.</span><span class="ident" id="1684338">i</span>&nbsp;<span class="op" id="1684340">=</span>&nbsp;<span class="ident" id="1684342">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684346">i</span>&nbsp;<span class="op" id="1684348">=</span>&nbsp;<span class="ident" id="1684350">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684353">}</span><br>
<span class="lineno"></span><span class="op" id="1684355">}</span>
</div>
</body>
</html>
