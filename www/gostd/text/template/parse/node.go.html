<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html" class="current">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3614274">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3614329">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3614383">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3614434">//&nbsp;Parse&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3614451">package</span>&nbsp;<span class="ident" id="3614459">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3614466">import</span>&nbsp;<span class="op" id="3614473">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3614476">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3614485">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3614492">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3614503">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3614513">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3614516">var</span>&nbsp;<span class="ident" id="3614520">textFormat</span>&nbsp;<span class="op" id="3614531">=</span>&nbsp;<span class="string" id="3614533">&#34;%s&#34;</span>&nbsp;<span class="comment" id="3614538">//&nbsp;Changed&nbsp;to&nbsp;&#34;%q&#34;&nbsp;in&nbsp;tests&nbsp;for&nbsp;better&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3614594">//&nbsp;A&nbsp;Node&nbsp;is&nbsp;an&nbsp;element&nbsp;in&nbsp;the&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;interface&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span><span class="comment" id="3614663">//&nbsp;The&nbsp;interface&nbsp;contains&nbsp;an&nbsp;unexported&nbsp;method&nbsp;so&nbsp;that&nbsp;only</span><br>
<span class="lineno">20</span><span class="comment" id="3614723">//&nbsp;types&nbsp;local&nbsp;to&nbsp;this&nbsp;package&nbsp;can&nbsp;satisfy&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3614770">type</span>&nbsp;<span class="ident" id="3614775">Node</span>&nbsp;<span class="keyword" id="3614780">interface</span>&nbsp;<span class="op" id="3614790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3614793">Type</span><span class="op" id="3614797">(</span><span class="op" id="3614798">)</span>&nbsp;<span class="ident" id="3614800">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3614810">String</span><span class="op" id="3614816">(</span><span class="op" id="3614817">)</span>&nbsp;<span class="builtintype" id="3614819">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3614827">//&nbsp;Copy&nbsp;does&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;Node&nbsp;and&nbsp;all&nbsp;its&nbsp;components.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3614889">//&nbsp;To&nbsp;avoid&nbsp;type&nbsp;assertions,&nbsp;some&nbsp;XxxNodes&nbsp;also&nbsp;have&nbsp;specialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3614955">//&nbsp;CopyXxx&nbsp;methods&nbsp;that&nbsp;return&nbsp;*XxxNode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3614997">Copy</span><span class="op" id="3615001">(</span><span class="op" id="3615002">)</span>&nbsp;<span class="ident" id="3615004">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615010">Position</span><span class="op" id="3615018">(</span><span class="op" id="3615019">)</span>&nbsp;<span class="ident" id="3615021">Pos</span>&nbsp;<span class="comment" id="3615025">//&nbsp;byte&nbsp;position&nbsp;of&nbsp;start&nbsp;of&nbsp;node&nbsp;in&nbsp;full&nbsp;original&nbsp;input&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3615090">//&nbsp;tree&nbsp;returns&nbsp;the&nbsp;containing&nbsp;*Tree.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3615129">//&nbsp;It&nbsp;is&nbsp;unexported&nbsp;so&nbsp;all&nbsp;implementations&nbsp;of&nbsp;Node&nbsp;are&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615202">tree</span><span class="op" id="3615206">(</span><span class="op" id="3615207">)</span>&nbsp;<span class="op" id="3615209">*</span><span class="ident" id="3615210">Tree</span><br>
<span class="lineno"></span><span class="op" id="3615215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3615218">//&nbsp;NodeType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parse&nbsp;tree&nbsp;node.</span><br>
<span class="lineno">35</span><span class="keyword" id="3615272">type</span>&nbsp;<span class="ident" id="3615277">NodeType</span>&nbsp;<span class="builtintype" id="3615286">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3615291">//&nbsp;Pos&nbsp;represents&nbsp;a&nbsp;byte&nbsp;position&nbsp;in&nbsp;the&nbsp;original&nbsp;input&nbsp;text&nbsp;from&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="3615363">//&nbsp;this&nbsp;template&nbsp;was&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="3615392">type</span>&nbsp;<span class="ident" id="3615397">Pos</span>&nbsp;<span class="builtintype" id="3615401">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3615406">func</span>&nbsp;<span class="op" id="3615411">(</span><span class="ident" id="3615412">p</span>&nbsp;<span class="ident" id="3615414">Pos</span><span class="op" id="3615417">)</span>&nbsp;<span class="ident" id="3615419">Position</span><span class="op" id="3615427">(</span><span class="op" id="3615428">)</span>&nbsp;<span class="ident" id="3615430">Pos</span>&nbsp;<span class="op" id="3615434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3615437">return</span>&nbsp;<span class="ident" id="3615444">p</span><br>
<span class="lineno"></span><span class="op" id="3615446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3615449">//&nbsp;Type&nbsp;returns&nbsp;itself&nbsp;and&nbsp;provides&nbsp;an&nbsp;easy&nbsp;default&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="3615516">//&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;Node.&nbsp;Embedded&nbsp;in&nbsp;all&nbsp;non-trivial&nbsp;Nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="3615579">func</span>&nbsp;<span class="op" id="3615584">(</span><span class="ident" id="3615585">t</span>&nbsp;<span class="ident" id="3615587">NodeType</span><span class="op" id="3615595">)</span>&nbsp;<span class="ident" id="3615597">Type</span><span class="op" id="3615601">(</span><span class="op" id="3615602">)</span>&nbsp;<span class="ident" id="3615604">NodeType</span>&nbsp;<span class="op" id="3615613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3615616">return</span>&nbsp;<span class="ident" id="3615623">t</span><br>
<span class="lineno"></span><span class="op" id="3615625">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3615628">const</span>&nbsp;<span class="op" id="3615634">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615637">NodeText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615652">NodeType</span>&nbsp;<span class="op" id="3615661">=</span>&nbsp;<span class="ident" id="3615663">iota</span>&nbsp;<span class="comment" id="3615668">//&nbsp;Plain&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615684">NodeAction</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3615715">//&nbsp;A&nbsp;non-control&nbsp;action&nbsp;such&nbsp;as&nbsp;a&nbsp;field&nbsp;evaluation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615768">NodeBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3615799">//&nbsp;A&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615823">NodeChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3615854">//&nbsp;A&nbsp;sequence&nbsp;of&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615888">NodeCommand</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3615919">//&nbsp;An&nbsp;element&nbsp;of&nbsp;a&nbsp;pipeline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615949">NodeDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3615980">//&nbsp;The&nbsp;cursor,&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616001">nodeElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616032">//&nbsp;An&nbsp;else&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616071">nodeEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616102">//&nbsp;An&nbsp;end&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616140">NodeField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616171">//&nbsp;A&nbsp;field&nbsp;or&nbsp;method&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616199">NodeIdentifier</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616230">//&nbsp;An&nbsp;identifier;&nbsp;always&nbsp;a&nbsp;function&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616273">NodeIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616304">//&nbsp;An&nbsp;if&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616322">NodeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616353">//&nbsp;A&nbsp;list&nbsp;of&nbsp;Nodes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616374">NodeNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616405">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616434">NodeNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616465">//&nbsp;A&nbsp;numerical&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616491">NodePipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616522">//&nbsp;A&nbsp;pipeline&nbsp;of&nbsp;commands.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616550">NodeRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616581">//&nbsp;A&nbsp;range&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616601">NodeString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616632">//&nbsp;A&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616655">NodeTemplate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616686">//&nbsp;A&nbsp;template&nbsp;invocation&nbsp;action.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616720">NodeVariable</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616751">//&nbsp;A&nbsp;$&nbsp;variable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616769">NodeWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616800">//&nbsp;A&nbsp;with&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="3616818">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3616821">//&nbsp;Nodes.</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="3616832">//&nbsp;ListNode&nbsp;holds&nbsp;a&nbsp;sequence&nbsp;of&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="3616871">type</span>&nbsp;<span class="ident" id="3616876">ListNode</span>&nbsp;<span class="keyword" id="3616885">struct</span>&nbsp;<span class="op" id="3616892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616895">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616905">Pos</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616910">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3616916">*</span><span class="ident" id="3616917">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616923">Nodes</span>&nbsp;<span class="op" id="3616929">[</span><span class="op" id="3616930">]</span><span class="ident" id="3616931">Node</span>&nbsp;<span class="comment" id="3616936">//&nbsp;The&nbsp;element&nbsp;nodes&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3616975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3616978">func</span>&nbsp;<span class="op" id="3616983">(</span><span class="ident" id="3616984">t</span>&nbsp;<span class="op" id="3616986">*</span><span class="ident" id="3616987">Tree</span><span class="op" id="3616991">)</span>&nbsp;<span class="ident" id="3616993">newList</span><span class="op" id="3617000">(</span><span class="ident" id="3617001">pos</span>&nbsp;<span class="ident" id="3617005">Pos</span><span class="op" id="3617008">)</span>&nbsp;<span class="op" id="3617010">*</span><span class="ident" id="3617011">ListNode</span>&nbsp;<span class="op" id="3617020">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617023">return</span>&nbsp;<span class="op" id="3617030">&amp;</span><span class="ident" id="3617031">ListNode</span><span class="op" id="3617039">{</span><span class="ident" id="3617040">tr</span><span class="op" id="3617042">:</span>&nbsp;<span class="ident" id="3617044">t</span><span class="op" id="3617045">,</span>&nbsp;<span class="ident" id="3617047">NodeType</span><span class="op" id="3617055">:</span>&nbsp;<span class="ident" id="3617057">NodeList</span><span class="op" id="3617065">,</span>&nbsp;<span class="ident" id="3617067">Pos</span><span class="op" id="3617070">:</span>&nbsp;<span class="ident" id="3617072">pos</span><span class="op" id="3617075">}</span><br>
<span class="lineno"></span><span class="op" id="3617077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3617080">func</span>&nbsp;<span class="op" id="3617085">(</span><span class="ident" id="3617086">l</span>&nbsp;<span class="op" id="3617088">*</span><span class="ident" id="3617089">ListNode</span><span class="op" id="3617097">)</span>&nbsp;<span class="builtinfunc" id="3617099">append</span><span class="op" id="3617105">(</span><span class="ident" id="3617106">n</span>&nbsp;<span class="ident" id="3617108">Node</span><span class="op" id="3617112">)</span>&nbsp;<span class="op" id="3617114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617117">l</span><span class="op" id="3617118">.</span><span class="ident" id="3617119">Nodes</span>&nbsp;<span class="op" id="3617125">=</span>&nbsp;<span class="builtinfunc" id="3617127">append</span><span class="op" id="3617133">(</span><span class="ident" id="3617134">l</span><span class="op" id="3617135">.</span><span class="ident" id="3617136">Nodes</span><span class="op" id="3617141">,</span>&nbsp;<span class="ident" id="3617143">n</span><span class="op" id="3617144">)</span><br>
<span class="lineno">90</span><span class="op" id="3617146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3617149">func</span>&nbsp;<span class="op" id="3617154">(</span><span class="ident" id="3617155">l</span>&nbsp;<span class="op" id="3617157">*</span><span class="ident" id="3617158">ListNode</span><span class="op" id="3617166">)</span>&nbsp;<span class="ident" id="3617168">tree</span><span class="op" id="3617172">(</span><span class="op" id="3617173">)</span>&nbsp;<span class="op" id="3617175">*</span><span class="ident" id="3617176">Tree</span>&nbsp;<span class="op" id="3617181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617184">return</span>&nbsp;<span class="ident" id="3617191">l</span><span class="op" id="3617192">.</span><span class="ident" id="3617193">tr</span><br>
<span class="lineno"></span><span class="op" id="3617196">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3617199">func</span>&nbsp;<span class="op" id="3617204">(</span><span class="ident" id="3617205">l</span>&nbsp;<span class="op" id="3617207">*</span><span class="ident" id="3617208">ListNode</span><span class="op" id="3617216">)</span>&nbsp;<span class="ident" id="3617218">String</span><span class="op" id="3617224">(</span><span class="op" id="3617225">)</span>&nbsp;<span class="builtintype" id="3617227">string</span>&nbsp;<span class="op" id="3617234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617237">b</span>&nbsp;<span class="op" id="3617239">:=</span>&nbsp;<span class="builtinfunc" id="3617242">new</span><span class="op" id="3617245">(</span><span class="ident" id="3617246">bytes</span><span class="op" id="3617251">.</span><span class="ident" id="3617252">Buffer</span><span class="op" id="3617258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617261">for</span>&nbsp;<span class="ident" id="3617265">_</span><span class="op" id="3617266">,</span>&nbsp;<span class="ident" id="3617268">n</span>&nbsp;<span class="op" id="3617270">:=</span>&nbsp;<span class="keyword" id="3617273">range</span>&nbsp;<span class="ident" id="3617279">l</span><span class="op" id="3617280">.</span><span class="ident" id="3617281">Nodes</span>&nbsp;<span class="op" id="3617287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617291">fmt</span><span class="op" id="3617294">.</span><span class="ident" id="3617295">Fprint</span><span class="op" id="3617301">(</span><span class="ident" id="3617302">b</span><span class="op" id="3617303">,</span>&nbsp;<span class="ident" id="3617305">n</span><span class="op" id="3617306">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617312">return</span>&nbsp;<span class="ident" id="3617319">b</span><span class="op" id="3617320">.</span><span class="ident" id="3617321">String</span><span class="op" id="3617327">(</span><span class="op" id="3617328">)</span><br>
<span class="lineno"></span><span class="op" id="3617330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3617333">func</span>&nbsp;<span class="op" id="3617338">(</span><span class="ident" id="3617339">l</span>&nbsp;<span class="op" id="3617341">*</span><span class="ident" id="3617342">ListNode</span><span class="op" id="3617350">)</span>&nbsp;<span class="ident" id="3617352">CopyList</span><span class="op" id="3617360">(</span><span class="op" id="3617361">)</span>&nbsp;<span class="op" id="3617363">*</span><span class="ident" id="3617364">ListNode</span>&nbsp;<span class="op" id="3617373">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617376">if</span>&nbsp;<span class="ident" id="3617379">l</span>&nbsp;<span class="op" id="3617381">==</span>&nbsp;<span class="builtintype" id="3617384">nil</span>&nbsp;<span class="op" id="3617388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617392">return</span>&nbsp;<span class="ident" id="3617399">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617405">n</span>&nbsp;<span class="op" id="3617407">:=</span>&nbsp;<span class="ident" id="3617410">l</span><span class="op" id="3617411">.</span><span class="ident" id="3617412">tr</span><span class="op" id="3617414">.</span><span class="ident" id="3617415">newList</span><span class="op" id="3617422">(</span><span class="ident" id="3617423">l</span><span class="op" id="3617424">.</span><span class="ident" id="3617425">Pos</span><span class="op" id="3617428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617431">for</span>&nbsp;<span class="ident" id="3617435">_</span><span class="op" id="3617436">,</span>&nbsp;<span class="ident" id="3617438">elem</span>&nbsp;<span class="op" id="3617443">:=</span>&nbsp;<span class="keyword" id="3617446">range</span>&nbsp;<span class="ident" id="3617452">l</span><span class="op" id="3617453">.</span><span class="ident" id="3617454">Nodes</span>&nbsp;<span class="op" id="3617460">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617464">n</span><span class="op" id="3617465">.</span><span class="builtinfunc" id="3617466">append</span><span class="op" id="3617472">(</span><span class="ident" id="3617473">elem</span><span class="op" id="3617477">.</span><span class="ident" id="3617478">Copy</span><span class="op" id="3617482">(</span><span class="op" id="3617483">)</span><span class="op" id="3617484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617490">return</span>&nbsp;<span class="ident" id="3617497">n</span><br>
<span class="lineno"></span><span class="op" id="3617499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="3617502">func</span>&nbsp;<span class="op" id="3617507">(</span><span class="ident" id="3617508">l</span>&nbsp;<span class="op" id="3617510">*</span><span class="ident" id="3617511">ListNode</span><span class="op" id="3617519">)</span>&nbsp;<span class="ident" id="3617521">Copy</span><span class="op" id="3617525">(</span><span class="op" id="3617526">)</span>&nbsp;<span class="ident" id="3617528">Node</span>&nbsp;<span class="op" id="3617533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617536">return</span>&nbsp;<span class="ident" id="3617543">l</span><span class="op" id="3617544">.</span><span class="ident" id="3617545">CopyList</span><span class="op" id="3617553">(</span><span class="op" id="3617554">)</span><br>
<span class="lineno"></span><span class="op" id="3617556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3617559">//&nbsp;TextNode&nbsp;holds&nbsp;plain&nbsp;text.</span><br>
<span class="lineno">120</span><span class="keyword" id="3617589">type</span>&nbsp;<span class="ident" id="3617594">TextNode</span>&nbsp;<span class="keyword" id="3617603">struct</span>&nbsp;<span class="op" id="3617610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617613">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617623">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617628">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3617633">*</span><span class="ident" id="3617634">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617640">Text</span>&nbsp;<span class="op" id="3617645">[</span><span class="op" id="3617646">]</span><span class="builtintype" id="3617647">byte</span>&nbsp;<span class="comment" id="3617652">//&nbsp;The&nbsp;text;&nbsp;may&nbsp;span&nbsp;newlines.</span><br>
<span class="lineno">125</span><span class="op" id="3617684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3617687">func</span>&nbsp;<span class="op" id="3617692">(</span><span class="ident" id="3617693">t</span>&nbsp;<span class="op" id="3617695">*</span><span class="ident" id="3617696">Tree</span><span class="op" id="3617700">)</span>&nbsp;<span class="ident" id="3617702">newText</span><span class="op" id="3617709">(</span><span class="ident" id="3617710">pos</span>&nbsp;<span class="ident" id="3617714">Pos</span><span class="op" id="3617717">,</span>&nbsp;<span class="ident" id="3617719">text</span>&nbsp;<span class="builtintype" id="3617724">string</span><span class="op" id="3617730">)</span>&nbsp;<span class="op" id="3617732">*</span><span class="ident" id="3617733">TextNode</span>&nbsp;<span class="op" id="3617742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617745">return</span>&nbsp;<span class="op" id="3617752">&amp;</span><span class="ident" id="3617753">TextNode</span><span class="op" id="3617761">{</span><span class="ident" id="3617762">tr</span><span class="op" id="3617764">:</span>&nbsp;<span class="ident" id="3617766">t</span><span class="op" id="3617767">,</span>&nbsp;<span class="ident" id="3617769">NodeType</span><span class="op" id="3617777">:</span>&nbsp;<span class="ident" id="3617779">NodeText</span><span class="op" id="3617787">,</span>&nbsp;<span class="ident" id="3617789">Pos</span><span class="op" id="3617792">:</span>&nbsp;<span class="ident" id="3617794">pos</span><span class="op" id="3617797">,</span>&nbsp;<span class="ident" id="3617799">Text</span><span class="op" id="3617803">:</span>&nbsp;<span class="op" id="3617805">[</span><span class="op" id="3617806">]</span><span class="builtintype" id="3617807">byte</span><span class="op" id="3617811">(</span><span class="ident" id="3617812">text</span><span class="op" id="3617816">)</span><span class="op" id="3617817">}</span><br>
<span class="lineno"></span><span class="op" id="3617819">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="3617822">func</span>&nbsp;<span class="op" id="3617827">(</span><span class="ident" id="3617828">t</span>&nbsp;<span class="op" id="3617830">*</span><span class="ident" id="3617831">TextNode</span><span class="op" id="3617839">)</span>&nbsp;<span class="ident" id="3617841">String</span><span class="op" id="3617847">(</span><span class="op" id="3617848">)</span>&nbsp;<span class="builtintype" id="3617850">string</span>&nbsp;<span class="op" id="3617857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617860">return</span>&nbsp;<span class="ident" id="3617867">fmt</span><span class="op" id="3617870">.</span><span class="ident" id="3617871">Sprintf</span><span class="op" id="3617878">(</span><span class="ident" id="3617879">textFormat</span><span class="op" id="3617889">,</span>&nbsp;<span class="ident" id="3617891">t</span><span class="op" id="3617892">.</span><span class="ident" id="3617893">Text</span><span class="op" id="3617897">)</span><br>
<span class="lineno"></span><span class="op" id="3617899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3617902">func</span>&nbsp;<span class="op" id="3617907">(</span><span class="ident" id="3617908">t</span>&nbsp;<span class="op" id="3617910">*</span><span class="ident" id="3617911">TextNode</span><span class="op" id="3617919">)</span>&nbsp;<span class="ident" id="3617921">tree</span><span class="op" id="3617925">(</span><span class="op" id="3617926">)</span>&nbsp;<span class="op" id="3617928">*</span><span class="ident" id="3617929">Tree</span>&nbsp;<span class="op" id="3617934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617937">return</span>&nbsp;<span class="ident" id="3617944">t</span><span class="op" id="3617945">.</span><span class="ident" id="3617946">tr</span><br>
<span class="lineno"></span><span class="op" id="3617949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3617952">func</span>&nbsp;<span class="op" id="3617957">(</span><span class="ident" id="3617958">t</span>&nbsp;<span class="op" id="3617960">*</span><span class="ident" id="3617961">TextNode</span><span class="op" id="3617969">)</span>&nbsp;<span class="ident" id="3617971">Copy</span><span class="op" id="3617975">(</span><span class="op" id="3617976">)</span>&nbsp;<span class="ident" id="3617978">Node</span>&nbsp;<span class="op" id="3617983">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617986">return</span>&nbsp;<span class="op" id="3617993">&amp;</span><span class="ident" id="3617994">TextNode</span><span class="op" id="3618002">{</span><span class="ident" id="3618003">tr</span><span class="op" id="3618005">:</span>&nbsp;<span class="ident" id="3618007">t</span><span class="op" id="3618008">.</span><span class="ident" id="3618009">tr</span><span class="op" id="3618011">,</span>&nbsp;<span class="ident" id="3618013">NodeType</span><span class="op" id="3618021">:</span>&nbsp;<span class="ident" id="3618023">NodeText</span><span class="op" id="3618031">,</span>&nbsp;<span class="ident" id="3618033">Pos</span><span class="op" id="3618036">:</span>&nbsp;<span class="ident" id="3618038">t</span><span class="op" id="3618039">.</span><span class="ident" id="3618040">Pos</span><span class="op" id="3618043">,</span>&nbsp;<span class="ident" id="3618045">Text</span><span class="op" id="3618049">:</span>&nbsp;<span class="builtinfunc" id="3618051">append</span><span class="op" id="3618057">(</span><span class="op" id="3618058">[</span><span class="op" id="3618059">]</span><span class="builtintype" id="3618060">byte</span><span class="op" id="3618064">{</span><span class="op" id="3618065">}</span><span class="op" id="3618066">,</span>&nbsp;<span class="ident" id="3618068">t</span><span class="op" id="3618069">.</span><span class="ident" id="3618070">Text</span><span class="op" id="3618074">...</span><span class="op" id="3618077">)</span><span class="op" id="3618078">}</span><br>
<span class="lineno"></span><span class="op" id="3618080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3618083">//&nbsp;PipeNode&nbsp;holds&nbsp;a&nbsp;pipeline&nbsp;with&nbsp;optional&nbsp;declaration</span><br>
<span class="lineno"></span><span class="keyword" id="3618138">type</span>&nbsp;<span class="ident" id="3618143">PipeNode</span>&nbsp;<span class="keyword" id="3618152">struct</span>&nbsp;<span class="op" id="3618159">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618162">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618172">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618177">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3618182">*</span><span class="ident" id="3618183">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618189">Line</span>&nbsp;<span class="builtintype" id="3618194">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3618210">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618280">Decl</span>&nbsp;<span class="op" id="3618285">[</span><span class="op" id="3618286">]</span><span class="op" id="3618287">*</span><span class="ident" id="3618288">VariableNode</span>&nbsp;<span class="comment" id="3618301">//&nbsp;Variable&nbsp;declarations&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618345">Cmds</span>&nbsp;<span class="op" id="3618350">[</span><span class="op" id="3618351">]</span><span class="op" id="3618352">*</span><span class="ident" id="3618353">CommandNode</span>&nbsp;&nbsp;<span class="comment" id="3618366">//&nbsp;The&nbsp;commands&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3618400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3618403">func</span>&nbsp;<span class="op" id="3618408">(</span><span class="ident" id="3618409">t</span>&nbsp;<span class="op" id="3618411">*</span><span class="ident" id="3618412">Tree</span><span class="op" id="3618416">)</span>&nbsp;<span class="ident" id="3618418">newPipeline</span><span class="op" id="3618429">(</span><span class="ident" id="3618430">pos</span>&nbsp;<span class="ident" id="3618434">Pos</span><span class="op" id="3618437">,</span>&nbsp;<span class="ident" id="3618439">line</span>&nbsp;<span class="builtintype" id="3618444">int</span><span class="op" id="3618447">,</span>&nbsp;<span class="ident" id="3618449">decl</span>&nbsp;<span class="op" id="3618454">[</span><span class="op" id="3618455">]</span><span class="op" id="3618456">*</span><span class="ident" id="3618457">VariableNode</span><span class="op" id="3618469">)</span>&nbsp;<span class="op" id="3618471">*</span><span class="ident" id="3618472">PipeNode</span>&nbsp;<span class="op" id="3618481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618484">return</span>&nbsp;<span class="op" id="3618491">&amp;</span><span class="ident" id="3618492">PipeNode</span><span class="op" id="3618500">{</span><span class="ident" id="3618501">tr</span><span class="op" id="3618503">:</span>&nbsp;<span class="ident" id="3618505">t</span><span class="op" id="3618506">,</span>&nbsp;<span class="ident" id="3618508">NodeType</span><span class="op" id="3618516">:</span>&nbsp;<span class="ident" id="3618518">NodePipe</span><span class="op" id="3618526">,</span>&nbsp;<span class="ident" id="3618528">Pos</span><span class="op" id="3618531">:</span>&nbsp;<span class="ident" id="3618533">pos</span><span class="op" id="3618536">,</span>&nbsp;<span class="ident" id="3618538">Line</span><span class="op" id="3618542">:</span>&nbsp;<span class="ident" id="3618544">line</span><span class="op" id="3618548">,</span>&nbsp;<span class="ident" id="3618550">Decl</span><span class="op" id="3618554">:</span>&nbsp;<span class="ident" id="3618556">decl</span><span class="op" id="3618560">}</span><br>
<span class="lineno">155</span><span class="op" id="3618562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3618565">func</span>&nbsp;<span class="op" id="3618570">(</span><span class="ident" id="3618571">p</span>&nbsp;<span class="op" id="3618573">*</span><span class="ident" id="3618574">PipeNode</span><span class="op" id="3618582">)</span>&nbsp;<span class="builtinfunc" id="3618584">append</span><span class="op" id="3618590">(</span><span class="ident" id="3618591">command</span>&nbsp;<span class="op" id="3618599">*</span><span class="ident" id="3618600">CommandNode</span><span class="op" id="3618611">)</span>&nbsp;<span class="op" id="3618613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618616">p</span><span class="op" id="3618617">.</span><span class="ident" id="3618618">Cmds</span>&nbsp;<span class="op" id="3618623">=</span>&nbsp;<span class="builtinfunc" id="3618625">append</span><span class="op" id="3618631">(</span><span class="ident" id="3618632">p</span><span class="op" id="3618633">.</span><span class="ident" id="3618634">Cmds</span><span class="op" id="3618638">,</span>&nbsp;<span class="ident" id="3618640">command</span><span class="op" id="3618647">)</span><br>
<span class="lineno"></span><span class="op" id="3618649">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="3618652">func</span>&nbsp;<span class="op" id="3618657">(</span><span class="ident" id="3618658">p</span>&nbsp;<span class="op" id="3618660">*</span><span class="ident" id="3618661">PipeNode</span><span class="op" id="3618669">)</span>&nbsp;<span class="ident" id="3618671">String</span><span class="op" id="3618677">(</span><span class="op" id="3618678">)</span>&nbsp;<span class="builtintype" id="3618680">string</span>&nbsp;<span class="op" id="3618687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618690">s</span>&nbsp;<span class="op" id="3618692">:=</span>&nbsp;<span class="string" id="3618695">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618699">if</span>&nbsp;<span class="builtinfunc" id="3618702">len</span><span class="op" id="3618705">(</span><span class="ident" id="3618706">p</span><span class="op" id="3618707">.</span><span class="ident" id="3618708">Decl</span><span class="op" id="3618712">)</span>&nbsp;<span class="op" id="3618714">&gt;</span>&nbsp;<span class="num" id="3618716">0</span>&nbsp;<span class="op" id="3618718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618722">for</span>&nbsp;<span class="ident" id="3618726">i</span><span class="op" id="3618727">,</span>&nbsp;<span class="ident" id="3618729">v</span>&nbsp;<span class="op" id="3618731">:=</span>&nbsp;<span class="keyword" id="3618734">range</span>&nbsp;<span class="ident" id="3618740">p</span><span class="op" id="3618741">.</span><span class="ident" id="3618742">Decl</span>&nbsp;<span class="op" id="3618747">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618752">if</span>&nbsp;<span class="ident" id="3618755">i</span>&nbsp;<span class="op" id="3618757">&gt;</span>&nbsp;<span class="num" id="3618759">0</span>&nbsp;<span class="op" id="3618761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618767">s</span>&nbsp;<span class="op" id="3618769">+=</span>&nbsp;<span class="string" id="3618772">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3618780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618785">s</span>&nbsp;<span class="op" id="3618787">+=</span>&nbsp;<span class="ident" id="3618790">v</span><span class="op" id="3618791">.</span><span class="ident" id="3618792">String</span><span class="op" id="3618798">(</span><span class="op" id="3618799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3618803">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618807">s</span>&nbsp;<span class="op" id="3618809">+=</span>&nbsp;<span class="string" id="3618812">&#34;&nbsp;:=&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3618820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618823">for</span>&nbsp;<span class="ident" id="3618827">i</span><span class="op" id="3618828">,</span>&nbsp;<span class="ident" id="3618830">c</span>&nbsp;<span class="op" id="3618832">:=</span>&nbsp;<span class="keyword" id="3618835">range</span>&nbsp;<span class="ident" id="3618841">p</span><span class="op" id="3618842">.</span><span class="ident" id="3618843">Cmds</span>&nbsp;<span class="op" id="3618848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618852">if</span>&nbsp;<span class="ident" id="3618855">i</span>&nbsp;<span class="op" id="3618857">&gt;</span>&nbsp;<span class="num" id="3618859">0</span>&nbsp;<span class="op" id="3618861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618866">s</span>&nbsp;<span class="op" id="3618868">+=</span>&nbsp;<span class="string" id="3618871">&#34;&nbsp;|&nbsp;&#34;</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3618879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618883">s</span>&nbsp;<span class="op" id="3618885">+=</span>&nbsp;<span class="ident" id="3618888">c</span><span class="op" id="3618889">.</span><span class="ident" id="3618890">String</span><span class="op" id="3618896">(</span><span class="op" id="3618897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3618900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618903">return</span>&nbsp;<span class="ident" id="3618910">s</span><br>
<span class="lineno"></span><span class="op" id="3618912">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="3618915">func</span>&nbsp;<span class="op" id="3618920">(</span><span class="ident" id="3618921">p</span>&nbsp;<span class="op" id="3618923">*</span><span class="ident" id="3618924">PipeNode</span><span class="op" id="3618932">)</span>&nbsp;<span class="ident" id="3618934">tree</span><span class="op" id="3618938">(</span><span class="op" id="3618939">)</span>&nbsp;<span class="op" id="3618941">*</span><span class="ident" id="3618942">Tree</span>&nbsp;<span class="op" id="3618947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618950">return</span>&nbsp;<span class="ident" id="3618957">p</span><span class="op" id="3618958">.</span><span class="ident" id="3618959">tr</span><br>
<span class="lineno"></span><span class="op" id="3618962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3618965">func</span>&nbsp;<span class="op" id="3618970">(</span><span class="ident" id="3618971">p</span>&nbsp;<span class="op" id="3618973">*</span><span class="ident" id="3618974">PipeNode</span><span class="op" id="3618982">)</span>&nbsp;<span class="ident" id="3618984">CopyPipe</span><span class="op" id="3618992">(</span><span class="op" id="3618993">)</span>&nbsp;<span class="op" id="3618995">*</span><span class="ident" id="3618996">PipeNode</span>&nbsp;<span class="op" id="3619005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619008">if</span>&nbsp;<span class="ident" id="3619011">p</span>&nbsp;<span class="op" id="3619013">==</span>&nbsp;<span class="builtintype" id="3619016">nil</span>&nbsp;<span class="op" id="3619020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619024">return</span>&nbsp;<span class="ident" id="3619031">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3619034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619037">var</span>&nbsp;<span class="ident" id="3619041">decl</span>&nbsp;<span class="op" id="3619046">[</span><span class="op" id="3619047">]</span><span class="op" id="3619048">*</span><span class="ident" id="3619049">VariableNode</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619063">for</span>&nbsp;<span class="ident" id="3619067">_</span><span class="op" id="3619068">,</span>&nbsp;<span class="ident" id="3619070">d</span>&nbsp;<span class="op" id="3619072">:=</span>&nbsp;<span class="keyword" id="3619075">range</span>&nbsp;<span class="ident" id="3619081">p</span><span class="op" id="3619082">.</span><span class="ident" id="3619083">Decl</span>&nbsp;<span class="op" id="3619088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619092">decl</span>&nbsp;<span class="op" id="3619097">=</span>&nbsp;<span class="builtinfunc" id="3619099">append</span><span class="op" id="3619105">(</span><span class="ident" id="3619106">decl</span><span class="op" id="3619110">,</span>&nbsp;<span class="ident" id="3619112">d</span><span class="op" id="3619113">.</span><span class="ident" id="3619114">Copy</span><span class="op" id="3619118">(</span><span class="op" id="3619119">)</span><span class="op" id="3619120">.</span><span class="op" id="3619121">(</span><span class="op" id="3619122">*</span><span class="ident" id="3619123">VariableNode</span><span class="op" id="3619135">)</span><span class="op" id="3619136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3619139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619142">n</span>&nbsp;<span class="op" id="3619144">:=</span>&nbsp;<span class="ident" id="3619147">p</span><span class="op" id="3619148">.</span><span class="ident" id="3619149">tr</span><span class="op" id="3619151">.</span><span class="ident" id="3619152">newPipeline</span><span class="op" id="3619163">(</span><span class="ident" id="3619164">p</span><span class="op" id="3619165">.</span><span class="ident" id="3619166">Pos</span><span class="op" id="3619169">,</span>&nbsp;<span class="ident" id="3619171">p</span><span class="op" id="3619172">.</span><span class="ident" id="3619173">Line</span><span class="op" id="3619177">,</span>&nbsp;<span class="ident" id="3619179">decl</span><span class="op" id="3619183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619186">for</span>&nbsp;<span class="ident" id="3619190">_</span><span class="op" id="3619191">,</span>&nbsp;<span class="ident" id="3619193">c</span>&nbsp;<span class="op" id="3619195">:=</span>&nbsp;<span class="keyword" id="3619198">range</span>&nbsp;<span class="ident" id="3619204">p</span><span class="op" id="3619205">.</span><span class="ident" id="3619206">Cmds</span>&nbsp;<span class="op" id="3619211">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619215">n</span><span class="op" id="3619216">.</span><span class="builtinfunc" id="3619217">append</span><span class="op" id="3619223">(</span><span class="ident" id="3619224">c</span><span class="op" id="3619225">.</span><span class="ident" id="3619226">Copy</span><span class="op" id="3619230">(</span><span class="op" id="3619231">)</span><span class="op" id="3619232">.</span><span class="op" id="3619233">(</span><span class="op" id="3619234">*</span><span class="ident" id="3619235">CommandNode</span><span class="op" id="3619246">)</span><span class="op" id="3619247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3619250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619253">return</span>&nbsp;<span class="ident" id="3619260">n</span><br>
<span class="lineno"></span><span class="op" id="3619262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="3619265">func</span>&nbsp;<span class="op" id="3619270">(</span><span class="ident" id="3619271">p</span>&nbsp;<span class="op" id="3619273">*</span><span class="ident" id="3619274">PipeNode</span><span class="op" id="3619282">)</span>&nbsp;<span class="ident" id="3619284">Copy</span><span class="op" id="3619288">(</span><span class="op" id="3619289">)</span>&nbsp;<span class="ident" id="3619291">Node</span>&nbsp;<span class="op" id="3619296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619299">return</span>&nbsp;<span class="ident" id="3619306">p</span><span class="op" id="3619307">.</span><span class="ident" id="3619308">CopyPipe</span><span class="op" id="3619316">(</span><span class="op" id="3619317">)</span><br>
<span class="lineno"></span><span class="op" id="3619319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3619322">//&nbsp;ActionNode&nbsp;holds&nbsp;an&nbsp;action&nbsp;(something&nbsp;bounded&nbsp;by&nbsp;delimiters).</span><br>
<span class="lineno">205</span><span class="comment" id="3619387">//&nbsp;Control&nbsp;actions&nbsp;have&nbsp;their&nbsp;own&nbsp;nodes;&nbsp;ActionNode&nbsp;represents&nbsp;simple</span><br>
<span class="lineno"></span><span class="comment" id="3619457">//&nbsp;ones&nbsp;such&nbsp;as&nbsp;field&nbsp;evaluations&nbsp;and&nbsp;parenthesized&nbsp;pipelines.</span><br>
<span class="lineno"></span><span class="keyword" id="3619520">type</span>&nbsp;<span class="ident" id="3619525">ActionNode</span>&nbsp;<span class="keyword" id="3619536">struct</span>&nbsp;<span class="op" id="3619543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619546">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619556">Pos</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619561">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3619566">*</span><span class="ident" id="3619567">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619573">Line</span>&nbsp;<span class="builtintype" id="3619578">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3619588">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619658">Pipe</span>&nbsp;<span class="op" id="3619663">*</span><span class="ident" id="3619664">PipeNode</span>&nbsp;<span class="comment" id="3619673">//&nbsp;The&nbsp;pipeline&nbsp;in&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="3619704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="3619707">func</span>&nbsp;<span class="op" id="3619712">(</span><span class="ident" id="3619713">t</span>&nbsp;<span class="op" id="3619715">*</span><span class="ident" id="3619716">Tree</span><span class="op" id="3619720">)</span>&nbsp;<span class="ident" id="3619722">newAction</span><span class="op" id="3619731">(</span><span class="ident" id="3619732">pos</span>&nbsp;<span class="ident" id="3619736">Pos</span><span class="op" id="3619739">,</span>&nbsp;<span class="ident" id="3619741">line</span>&nbsp;<span class="builtintype" id="3619746">int</span><span class="op" id="3619749">,</span>&nbsp;<span class="ident" id="3619751">pipe</span>&nbsp;<span class="op" id="3619756">*</span><span class="ident" id="3619757">PipeNode</span><span class="op" id="3619765">)</span>&nbsp;<span class="op" id="3619767">*</span><span class="ident" id="3619768">ActionNode</span>&nbsp;<span class="op" id="3619779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619782">return</span>&nbsp;<span class="op" id="3619789">&amp;</span><span class="ident" id="3619790">ActionNode</span><span class="op" id="3619800">{</span><span class="ident" id="3619801">tr</span><span class="op" id="3619803">:</span>&nbsp;<span class="ident" id="3619805">t</span><span class="op" id="3619806">,</span>&nbsp;<span class="ident" id="3619808">NodeType</span><span class="op" id="3619816">:</span>&nbsp;<span class="ident" id="3619818">NodeAction</span><span class="op" id="3619828">,</span>&nbsp;<span class="ident" id="3619830">Pos</span><span class="op" id="3619833">:</span>&nbsp;<span class="ident" id="3619835">pos</span><span class="op" id="3619838">,</span>&nbsp;<span class="ident" id="3619840">Line</span><span class="op" id="3619844">:</span>&nbsp;<span class="ident" id="3619846">line</span><span class="op" id="3619850">,</span>&nbsp;<span class="ident" id="3619852">Pipe</span><span class="op" id="3619856">:</span>&nbsp;<span class="ident" id="3619858">pipe</span><span class="op" id="3619862">}</span><br>
<span class="lineno"></span><span class="op" id="3619864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3619867">func</span>&nbsp;<span class="op" id="3619872">(</span><span class="ident" id="3619873">a</span>&nbsp;<span class="op" id="3619875">*</span><span class="ident" id="3619876">ActionNode</span><span class="op" id="3619886">)</span>&nbsp;<span class="ident" id="3619888">String</span><span class="op" id="3619894">(</span><span class="op" id="3619895">)</span>&nbsp;<span class="builtintype" id="3619897">string</span>&nbsp;<span class="op" id="3619904">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619907">return</span>&nbsp;<span class="ident" id="3619914">fmt</span><span class="op" id="3619917">.</span><span class="ident" id="3619918">Sprintf</span><span class="op" id="3619925">(</span><span class="string" id="3619926">&#34;{{%s}}&#34;</span><span class="op" id="3619934">,</span>&nbsp;<span class="ident" id="3619936">a</span><span class="op" id="3619937">.</span><span class="ident" id="3619938">Pipe</span><span class="op" id="3619942">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="3619945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3619948">func</span>&nbsp;<span class="op" id="3619953">(</span><span class="ident" id="3619954">a</span>&nbsp;<span class="op" id="3619956">*</span><span class="ident" id="3619957">ActionNode</span><span class="op" id="3619967">)</span>&nbsp;<span class="ident" id="3619969">tree</span><span class="op" id="3619973">(</span><span class="op" id="3619974">)</span>&nbsp;<span class="op" id="3619976">*</span><span class="ident" id="3619977">Tree</span>&nbsp;<span class="op" id="3619982">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619985">return</span>&nbsp;<span class="ident" id="3619992">a</span><span class="op" id="3619993">.</span><span class="ident" id="3619994">tr</span><br>
<span class="lineno"></span><span class="op" id="3619997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3620000">func</span>&nbsp;<span class="op" id="3620005">(</span><span class="ident" id="3620006">a</span>&nbsp;<span class="op" id="3620008">*</span><span class="ident" id="3620009">ActionNode</span><span class="op" id="3620019">)</span>&nbsp;<span class="ident" id="3620021">Copy</span><span class="op" id="3620025">(</span><span class="op" id="3620026">)</span>&nbsp;<span class="ident" id="3620028">Node</span>&nbsp;<span class="op" id="3620033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620036">return</span>&nbsp;<span class="ident" id="3620043">a</span><span class="op" id="3620044">.</span><span class="ident" id="3620045">tr</span><span class="op" id="3620047">.</span><span class="ident" id="3620048">newAction</span><span class="op" id="3620057">(</span><span class="ident" id="3620058">a</span><span class="op" id="3620059">.</span><span class="ident" id="3620060">Pos</span><span class="op" id="3620063">,</span>&nbsp;<span class="ident" id="3620065">a</span><span class="op" id="3620066">.</span><span class="ident" id="3620067">Line</span><span class="op" id="3620071">,</span>&nbsp;<span class="ident" id="3620073">a</span><span class="op" id="3620074">.</span><span class="ident" id="3620075">Pipe</span><span class="op" id="3620079">.</span><span class="ident" id="3620080">CopyPipe</span><span class="op" id="3620088">(</span><span class="op" id="3620089">)</span><span class="op" id="3620090">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="op" id="3620093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3620096">//&nbsp;CommandNode&nbsp;holds&nbsp;a&nbsp;command&nbsp;(a&nbsp;pipeline&nbsp;inside&nbsp;an&nbsp;evaluating&nbsp;action).</span><br>
<span class="lineno"></span><span class="keyword" id="3620169">type</span>&nbsp;<span class="ident" id="3620174">CommandNode</span>&nbsp;<span class="keyword" id="3620186">struct</span>&nbsp;<span class="op" id="3620193">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620196">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620206">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620211">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3620216">*</span><span class="ident" id="3620217">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620223">Args</span>&nbsp;<span class="op" id="3620228">[</span><span class="op" id="3620229">]</span><span class="ident" id="3620230">Node</span>&nbsp;<span class="comment" id="3620235">//&nbsp;Arguments&nbsp;in&nbsp;lexical&nbsp;order:&nbsp;Identifier,&nbsp;field,&nbsp;or&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="3620298">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="3620301">func</span>&nbsp;<span class="op" id="3620306">(</span><span class="ident" id="3620307">t</span>&nbsp;<span class="op" id="3620309">*</span><span class="ident" id="3620310">Tree</span><span class="op" id="3620314">)</span>&nbsp;<span class="ident" id="3620316">newCommand</span><span class="op" id="3620326">(</span><span class="ident" id="3620327">pos</span>&nbsp;<span class="ident" id="3620331">Pos</span><span class="op" id="3620334">)</span>&nbsp;<span class="op" id="3620336">*</span><span class="ident" id="3620337">CommandNode</span>&nbsp;<span class="op" id="3620349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620352">return</span>&nbsp;<span class="op" id="3620359">&amp;</span><span class="ident" id="3620360">CommandNode</span><span class="op" id="3620371">{</span><span class="ident" id="3620372">tr</span><span class="op" id="3620374">:</span>&nbsp;<span class="ident" id="3620376">t</span><span class="op" id="3620377">,</span>&nbsp;<span class="ident" id="3620379">NodeType</span><span class="op" id="3620387">:</span>&nbsp;<span class="ident" id="3620389">NodeCommand</span><span class="op" id="3620400">,</span>&nbsp;<span class="ident" id="3620402">Pos</span><span class="op" id="3620405">:</span>&nbsp;<span class="ident" id="3620407">pos</span><span class="op" id="3620410">}</span><br>
<span class="lineno"></span><span class="op" id="3620412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="3620415">func</span>&nbsp;<span class="op" id="3620420">(</span><span class="ident" id="3620421">c</span>&nbsp;<span class="op" id="3620423">*</span><span class="ident" id="3620424">CommandNode</span><span class="op" id="3620435">)</span>&nbsp;<span class="builtinfunc" id="3620437">append</span><span class="op" id="3620443">(</span><span class="ident" id="3620444">arg</span>&nbsp;<span class="ident" id="3620448">Node</span><span class="op" id="3620452">)</span>&nbsp;<span class="op" id="3620454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620457">c</span><span class="op" id="3620458">.</span><span class="ident" id="3620459">Args</span>&nbsp;<span class="op" id="3620464">=</span>&nbsp;<span class="builtinfunc" id="3620466">append</span><span class="op" id="3620472">(</span><span class="ident" id="3620473">c</span><span class="op" id="3620474">.</span><span class="ident" id="3620475">Args</span><span class="op" id="3620479">,</span>&nbsp;<span class="ident" id="3620481">arg</span><span class="op" id="3620484">)</span><br>
<span class="lineno"></span><span class="op" id="3620486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3620489">func</span>&nbsp;<span class="op" id="3620494">(</span><span class="ident" id="3620495">c</span>&nbsp;<span class="op" id="3620497">*</span><span class="ident" id="3620498">CommandNode</span><span class="op" id="3620509">)</span>&nbsp;<span class="ident" id="3620511">String</span><span class="op" id="3620517">(</span><span class="op" id="3620518">)</span>&nbsp;<span class="builtintype" id="3620520">string</span>&nbsp;<span class="op" id="3620527">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620530">s</span>&nbsp;<span class="op" id="3620532">:=</span>&nbsp;<span class="string" id="3620535">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620539">for</span>&nbsp;<span class="ident" id="3620543">i</span><span class="op" id="3620544">,</span>&nbsp;<span class="ident" id="3620546">arg</span>&nbsp;<span class="op" id="3620550">:=</span>&nbsp;<span class="keyword" id="3620553">range</span>&nbsp;<span class="ident" id="3620559">c</span><span class="op" id="3620560">.</span><span class="ident" id="3620561">Args</span>&nbsp;<span class="op" id="3620566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620570">if</span>&nbsp;<span class="ident" id="3620573">i</span>&nbsp;<span class="op" id="3620575">&gt;</span>&nbsp;<span class="num" id="3620577">0</span>&nbsp;<span class="op" id="3620579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620584">s</span>&nbsp;<span class="op" id="3620586">+=</span>&nbsp;<span class="string" id="3620589">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620595">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620599">if</span>&nbsp;<span class="ident" id="3620602">arg</span><span class="op" id="3620605">,</span>&nbsp;<span class="ident" id="3620607">ok</span>&nbsp;<span class="op" id="3620610">:=</span>&nbsp;<span class="ident" id="3620613">arg</span><span class="op" id="3620616">.</span><span class="op" id="3620617">(</span><span class="op" id="3620618">*</span><span class="ident" id="3620619">PipeNode</span><span class="op" id="3620627">)</span><span class="op" id="3620628">;</span>&nbsp;<span class="ident" id="3620630">ok</span>&nbsp;<span class="op" id="3620633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620638">s</span>&nbsp;<span class="op" id="3620640">+=</span>&nbsp;<span class="string" id="3620643">&#34;(&#34;</span>&nbsp;<span class="op" id="3620647">+</span>&nbsp;<span class="ident" id="3620649">arg</span><span class="op" id="3620652">.</span><span class="ident" id="3620653">String</span><span class="op" id="3620659">(</span><span class="op" id="3620660">)</span>&nbsp;<span class="op" id="3620662">+</span>&nbsp;<span class="string" id="3620664">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620671">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620686">s</span>&nbsp;<span class="op" id="3620688">+=</span>&nbsp;<span class="ident" id="3620691">arg</span><span class="op" id="3620694">.</span><span class="ident" id="3620695">String</span><span class="op" id="3620701">(</span><span class="op" id="3620702">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620708">return</span>&nbsp;<span class="ident" id="3620715">s</span><br>
<span class="lineno"></span><span class="op" id="3620717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3620720">func</span>&nbsp;<span class="op" id="3620725">(</span><span class="ident" id="3620726">c</span>&nbsp;<span class="op" id="3620728">*</span><span class="ident" id="3620729">CommandNode</span><span class="op" id="3620740">)</span>&nbsp;<span class="ident" id="3620742">tree</span><span class="op" id="3620746">(</span><span class="op" id="3620747">)</span>&nbsp;<span class="op" id="3620749">*</span><span class="ident" id="3620750">Tree</span>&nbsp;<span class="op" id="3620755">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620758">return</span>&nbsp;<span class="ident" id="3620765">c</span><span class="op" id="3620766">.</span><span class="ident" id="3620767">tr</span><br>
<span class="lineno"></span><span class="op" id="3620770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3620773">func</span>&nbsp;<span class="op" id="3620778">(</span><span class="ident" id="3620779">c</span>&nbsp;<span class="op" id="3620781">*</span><span class="ident" id="3620782">CommandNode</span><span class="op" id="3620793">)</span>&nbsp;<span class="ident" id="3620795">Copy</span><span class="op" id="3620799">(</span><span class="op" id="3620800">)</span>&nbsp;<span class="ident" id="3620802">Node</span>&nbsp;<span class="op" id="3620807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620810">if</span>&nbsp;<span class="ident" id="3620813">c</span>&nbsp;<span class="op" id="3620815">==</span>&nbsp;<span class="builtintype" id="3620818">nil</span>&nbsp;<span class="op" id="3620822">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620826">return</span>&nbsp;<span class="ident" id="3620833">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620839">n</span>&nbsp;<span class="op" id="3620841">:=</span>&nbsp;<span class="ident" id="3620844">c</span><span class="op" id="3620845">.</span><span class="ident" id="3620846">tr</span><span class="op" id="3620848">.</span><span class="ident" id="3620849">newCommand</span><span class="op" id="3620859">(</span><span class="ident" id="3620860">c</span><span class="op" id="3620861">.</span><span class="ident" id="3620862">Pos</span><span class="op" id="3620865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620868">for</span>&nbsp;<span class="ident" id="3620872">_</span><span class="op" id="3620873">,</span>&nbsp;<span class="ident" id="3620875">c</span>&nbsp;<span class="op" id="3620877">:=</span>&nbsp;<span class="keyword" id="3620880">range</span>&nbsp;<span class="ident" id="3620886">c</span><span class="op" id="3620887">.</span><span class="ident" id="3620888">Args</span>&nbsp;<span class="op" id="3620893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620897">n</span><span class="op" id="3620898">.</span><span class="builtinfunc" id="3620899">append</span><span class="op" id="3620905">(</span><span class="ident" id="3620906">c</span><span class="op" id="3620907">.</span><span class="ident" id="3620908">Copy</span><span class="op" id="3620912">(</span><span class="op" id="3620913">)</span><span class="op" id="3620914">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620920">return</span>&nbsp;<span class="ident" id="3620927">n</span><br>
<span class="lineno"></span><span class="op" id="3620929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3620932">//&nbsp;IdentifierNode&nbsp;holds&nbsp;an&nbsp;identifier.</span><br>
<span class="lineno">280</span><span class="keyword" id="3620971">type</span>&nbsp;<span class="ident" id="3620976">IdentifierNode</span>&nbsp;<span class="keyword" id="3620991">struct</span>&nbsp;<span class="op" id="3620998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3621001">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3621011">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3621016">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3621022">*</span><span class="ident" id="3621023">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3621029">Ident</span>&nbsp;<span class="builtintype" id="3621035">string</span>&nbsp;<span class="comment" id="3621042">//&nbsp;The&nbsp;identifier&#39;s&nbsp;name.</span><br>
<span class="lineno">285</span><span class="op" id="3621068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3621071">//&nbsp;NewIdentifier&nbsp;returns&nbsp;a&nbsp;new&nbsp;IdentifierNode&nbsp;with&nbsp;the&nbsp;given&nbsp;identifier&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3621149">func</span>&nbsp;<span class="ident" id="3621154">NewIdentifier</span><span class="op" id="3621167">(</span><span class="ident" id="3621168">ident</span>&nbsp;<span class="builtintype" id="3621174">string</span><span class="op" id="3621180">)</span>&nbsp;<span class="op" id="3621182">*</span><span class="ident" id="3621183">IdentifierNode</span>&nbsp;<span class="op" id="3621198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621201">return</span>&nbsp;<span class="op" id="3621208">&amp;</span><span class="ident" id="3621209">IdentifierNode</span><span class="op" id="3621223">{</span><span class="ident" id="3621224">NodeType</span><span class="op" id="3621232">:</span>&nbsp;<span class="ident" id="3621234">NodeIdentifier</span><span class="op" id="3621248">,</span>&nbsp;<span class="ident" id="3621250">Ident</span><span class="op" id="3621255">:</span>&nbsp;<span class="ident" id="3621257">ident</span><span class="op" id="3621262">}</span><br>
<span class="lineno">290</span><span class="op" id="3621264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3621267">//&nbsp;SetPos&nbsp;sets&nbsp;the&nbsp;position.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="3621363">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="3621391">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno">295</span><span class="keyword" id="3621413">func</span>&nbsp;<span class="op" id="3621418">(</span><span class="ident" id="3621419">i</span>&nbsp;<span class="op" id="3621421">*</span><span class="ident" id="3621422">IdentifierNode</span><span class="op" id="3621436">)</span>&nbsp;<span class="ident" id="3621438">SetPos</span><span class="op" id="3621444">(</span><span class="ident" id="3621445">pos</span>&nbsp;<span class="ident" id="3621449">Pos</span><span class="op" id="3621452">)</span>&nbsp;<span class="op" id="3621454">*</span><span class="ident" id="3621455">IdentifierNode</span>&nbsp;<span class="op" id="3621470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3621473">i</span><span class="op" id="3621474">.</span><span class="ident" id="3621475">Pos</span>&nbsp;<span class="op" id="3621479">=</span>&nbsp;<span class="ident" id="3621481">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621486">return</span>&nbsp;<span class="ident" id="3621493">i</span><br>
<span class="lineno"></span><span class="op" id="3621495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="3621498">//&nbsp;SetTree&nbsp;sets&nbsp;the&nbsp;parent&nbsp;tree&nbsp;for&nbsp;the&nbsp;node.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="3621611">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="3621639">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno"></span><span class="keyword" id="3621661">func</span>&nbsp;<span class="op" id="3621666">(</span><span class="ident" id="3621667">i</span>&nbsp;<span class="op" id="3621669">*</span><span class="ident" id="3621670">IdentifierNode</span><span class="op" id="3621684">)</span>&nbsp;<span class="ident" id="3621686">SetTree</span><span class="op" id="3621693">(</span><span class="ident" id="3621694">t</span>&nbsp;<span class="op" id="3621696">*</span><span class="ident" id="3621697">Tree</span><span class="op" id="3621701">)</span>&nbsp;<span class="op" id="3621703">*</span><span class="ident" id="3621704">IdentifierNode</span>&nbsp;<span class="op" id="3621719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3621722">i</span><span class="op" id="3621723">.</span><span class="ident" id="3621724">tr</span>&nbsp;<span class="op" id="3621727">=</span>&nbsp;<span class="ident" id="3621729">t</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621732">return</span>&nbsp;<span class="ident" id="3621739">i</span><br>
<span class="lineno"></span><span class="op" id="3621741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3621744">func</span>&nbsp;<span class="op" id="3621749">(</span><span class="ident" id="3621750">i</span>&nbsp;<span class="op" id="3621752">*</span><span class="ident" id="3621753">IdentifierNode</span><span class="op" id="3621767">)</span>&nbsp;<span class="ident" id="3621769">String</span><span class="op" id="3621775">(</span><span class="op" id="3621776">)</span>&nbsp;<span class="builtintype" id="3621778">string</span>&nbsp;<span class="op" id="3621785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621788">return</span>&nbsp;<span class="ident" id="3621795">i</span><span class="op" id="3621796">.</span><span class="ident" id="3621797">Ident</span><br>
<span class="lineno">310</span><span class="op" id="3621803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3621806">func</span>&nbsp;<span class="op" id="3621811">(</span><span class="ident" id="3621812">i</span>&nbsp;<span class="op" id="3621814">*</span><span class="ident" id="3621815">IdentifierNode</span><span class="op" id="3621829">)</span>&nbsp;<span class="ident" id="3621831">tree</span><span class="op" id="3621835">(</span><span class="op" id="3621836">)</span>&nbsp;<span class="op" id="3621838">*</span><span class="ident" id="3621839">Tree</span>&nbsp;<span class="op" id="3621844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621847">return</span>&nbsp;<span class="ident" id="3621854">i</span><span class="op" id="3621855">.</span><span class="ident" id="3621856">tr</span><br>
<span class="lineno"></span><span class="op" id="3621859">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="3621862">func</span>&nbsp;<span class="op" id="3621867">(</span><span class="ident" id="3621868">i</span>&nbsp;<span class="op" id="3621870">*</span><span class="ident" id="3621871">IdentifierNode</span><span class="op" id="3621885">)</span>&nbsp;<span class="ident" id="3621887">Copy</span><span class="op" id="3621891">(</span><span class="op" id="3621892">)</span>&nbsp;<span class="ident" id="3621894">Node</span>&nbsp;<span class="op" id="3621899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621902">return</span>&nbsp;<span class="ident" id="3621909">NewIdentifier</span><span class="op" id="3621922">(</span><span class="ident" id="3621923">i</span><span class="op" id="3621924">.</span><span class="ident" id="3621925">Ident</span><span class="op" id="3621930">)</span><span class="op" id="3621931">.</span><span class="ident" id="3621932">SetTree</span><span class="op" id="3621939">(</span><span class="ident" id="3621940">i</span><span class="op" id="3621941">.</span><span class="ident" id="3621942">tr</span><span class="op" id="3621944">)</span><span class="op" id="3621945">.</span><span class="ident" id="3621946">SetPos</span><span class="op" id="3621952">(</span><span class="ident" id="3621953">i</span><span class="op" id="3621954">.</span><span class="ident" id="3621955">Pos</span><span class="op" id="3621958">)</span><br>
<span class="lineno"></span><span class="op" id="3621960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="3621963">//&nbsp;VariableNode&nbsp;holds&nbsp;a&nbsp;list&nbsp;of&nbsp;variable&nbsp;names,&nbsp;possibly&nbsp;with&nbsp;chained&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="3622039">//&nbsp;accesses.&nbsp;The&nbsp;dollar&nbsp;sign&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;(first)&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3622097">type</span>&nbsp;<span class="ident" id="3622102">VariableNode</span>&nbsp;<span class="keyword" id="3622115">struct</span>&nbsp;<span class="op" id="3622122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622125">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622135">Pos</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622140">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3622146">*</span><span class="ident" id="3622147">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622153">Ident</span>&nbsp;<span class="op" id="3622159">[</span><span class="op" id="3622160">]</span><span class="builtintype" id="3622161">string</span>&nbsp;<span class="comment" id="3622168">//&nbsp;Variable&nbsp;name&nbsp;and&nbsp;fields&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3622214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3622217">func</span>&nbsp;<span class="op" id="3622222">(</span><span class="ident" id="3622223">t</span>&nbsp;<span class="op" id="3622225">*</span><span class="ident" id="3622226">Tree</span><span class="op" id="3622230">)</span>&nbsp;<span class="ident" id="3622232">newVariable</span><span class="op" id="3622243">(</span><span class="ident" id="3622244">pos</span>&nbsp;<span class="ident" id="3622248">Pos</span><span class="op" id="3622251">,</span>&nbsp;<span class="ident" id="3622253">ident</span>&nbsp;<span class="builtintype" id="3622259">string</span><span class="op" id="3622265">)</span>&nbsp;<span class="op" id="3622267">*</span><span class="ident" id="3622268">VariableNode</span>&nbsp;<span class="op" id="3622281">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3622284">return</span>&nbsp;<span class="op" id="3622291">&amp;</span><span class="ident" id="3622292">VariableNode</span><span class="op" id="3622304">{</span><span class="ident" id="3622305">tr</span><span class="op" id="3622307">:</span>&nbsp;<span class="ident" id="3622309">t</span><span class="op" id="3622310">,</span>&nbsp;<span class="ident" id="3622312">NodeType</span><span class="op" id="3622320">:</span>&nbsp;<span class="ident" id="3622322">NodeVariable</span><span class="op" id="3622334">,</span>&nbsp;<span class="ident" id="3622336">Pos</span><span class="op" id="3622339">:</span>&nbsp;<span class="ident" id="3622341">pos</span><span class="op" id="3622344">,</span>&nbsp;<span class="ident" id="3622346">Ident</span><span class="op" id="3622351">:</span>&nbsp;<span class="ident" id="3622353">strings</span><span class="op" id="3622360">.</span><span class="ident" id="3622361">Split</span><span class="op" id="3622366">(</span><span class="ident" id="3622367">ident</span><span class="op" id="3622372">,</span>&nbsp;<span class="string" id="3622374">&#34;.&#34;</span><span class="op" id="3622377">)</span><span class="op" id="3622378">}</span><br>
<span class="lineno"></span><span class="op" id="3622380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3622383">func</span>&nbsp;<span class="op" id="3622388">(</span><span class="ident" id="3622389">v</span>&nbsp;<span class="op" id="3622391">*</span><span class="ident" id="3622392">VariableNode</span><span class="op" id="3622404">)</span>&nbsp;<span class="ident" id="3622406">String</span><span class="op" id="3622412">(</span><span class="op" id="3622413">)</span>&nbsp;<span class="builtintype" id="3622415">string</span>&nbsp;<span class="op" id="3622422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622425">s</span>&nbsp;<span class="op" id="3622427">:=</span>&nbsp;<span class="string" id="3622430">&#34;&#34;</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3622434">for</span>&nbsp;<span class="ident" id="3622438">i</span><span class="op" id="3622439">,</span>&nbsp;<span class="ident" id="3622441">id</span>&nbsp;<span class="op" id="3622444">:=</span>&nbsp;<span class="keyword" id="3622447">range</span>&nbsp;<span class="ident" id="3622453">v</span><span class="op" id="3622454">.</span><span class="ident" id="3622455">Ident</span>&nbsp;<span class="op" id="3622461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3622465">if</span>&nbsp;<span class="ident" id="3622468">i</span>&nbsp;<span class="op" id="3622470">&gt;</span>&nbsp;<span class="num" id="3622472">0</span>&nbsp;<span class="op" id="3622474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622479">s</span>&nbsp;<span class="op" id="3622481">+=</span>&nbsp;<span class="string" id="3622484">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3622490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622494">s</span>&nbsp;<span class="op" id="3622496">+=</span>&nbsp;<span class="ident" id="3622499">id</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3622503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3622506">return</span>&nbsp;<span class="ident" id="3622513">s</span><br>
<span class="lineno"></span><span class="op" id="3622515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3622518">func</span>&nbsp;<span class="op" id="3622523">(</span><span class="ident" id="3622524">v</span>&nbsp;<span class="op" id="3622526">*</span><span class="ident" id="3622527">VariableNode</span><span class="op" id="3622539">)</span>&nbsp;<span class="ident" id="3622541">tree</span><span class="op" id="3622545">(</span><span class="op" id="3622546">)</span>&nbsp;<span class="op" id="3622548">*</span><span class="ident" id="3622549">Tree</span>&nbsp;<span class="op" id="3622554">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3622557">return</span>&nbsp;<span class="ident" id="3622564">v</span><span class="op" id="3622565">.</span><span class="ident" id="3622566">tr</span><br>
<span class="lineno"></span><span class="op" id="3622569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3622572">func</span>&nbsp;<span class="op" id="3622577">(</span><span class="ident" id="3622578">v</span>&nbsp;<span class="op" id="3622580">*</span><span class="ident" id="3622581">VariableNode</span><span class="op" id="3622593">)</span>&nbsp;<span class="ident" id="3622595">Copy</span><span class="op" id="3622599">(</span><span class="op" id="3622600">)</span>&nbsp;<span class="ident" id="3622602">Node</span>&nbsp;<span class="op" id="3622607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3622610">return</span>&nbsp;<span class="op" id="3622617">&amp;</span><span class="ident" id="3622618">VariableNode</span><span class="op" id="3622630">{</span><span class="ident" id="3622631">tr</span><span class="op" id="3622633">:</span>&nbsp;<span class="ident" id="3622635">v</span><span class="op" id="3622636">.</span><span class="ident" id="3622637">tr</span><span class="op" id="3622639">,</span>&nbsp;<span class="ident" id="3622641">NodeType</span><span class="op" id="3622649">:</span>&nbsp;<span class="ident" id="3622651">NodeVariable</span><span class="op" id="3622663">,</span>&nbsp;<span class="ident" id="3622665">Pos</span><span class="op" id="3622668">:</span>&nbsp;<span class="ident" id="3622670">v</span><span class="op" id="3622671">.</span><span class="ident" id="3622672">Pos</span><span class="op" id="3622675">,</span>&nbsp;<span class="ident" id="3622677">Ident</span><span class="op" id="3622682">:</span>&nbsp;<span class="builtinfunc" id="3622684">append</span><span class="op" id="3622690">(</span><span class="op" id="3622691">[</span><span class="op" id="3622692">]</span><span class="builtintype" id="3622693">string</span><span class="op" id="3622699">{</span><span class="op" id="3622700">}</span><span class="op" id="3622701">,</span>&nbsp;<span class="ident" id="3622703">v</span><span class="op" id="3622704">.</span><span class="ident" id="3622705">Ident</span><span class="op" id="3622710">...</span><span class="op" id="3622713">)</span><span class="op" id="3622714">}</span><br>
<span class="lineno">350</span><span class="op" id="3622716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3622719">//&nbsp;DotNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;.&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="3622764">type</span>&nbsp;<span class="ident" id="3622769">DotNode</span>&nbsp;<span class="keyword" id="3622777">struct</span>&nbsp;<span class="op" id="3622784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622787">NodeType</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622797">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622802">tr</span>&nbsp;<span class="op" id="3622805">*</span><span class="ident" id="3622806">Tree</span><br>
<span class="lineno"></span><span class="op" id="3622811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3622814">func</span>&nbsp;<span class="op" id="3622819">(</span><span class="ident" id="3622820">t</span>&nbsp;<span class="op" id="3622822">*</span><span class="ident" id="3622823">Tree</span><span class="op" id="3622827">)</span>&nbsp;<span class="ident" id="3622829">newDot</span><span class="op" id="3622835">(</span><span class="ident" id="3622836">pos</span>&nbsp;<span class="ident" id="3622840">Pos</span><span class="op" id="3622843">)</span>&nbsp;<span class="op" id="3622845">*</span><span class="ident" id="3622846">DotNode</span>&nbsp;<span class="op" id="3622854">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3622857">return</span>&nbsp;<span class="op" id="3622864">&amp;</span><span class="ident" id="3622865">DotNode</span><span class="op" id="3622872">{</span><span class="ident" id="3622873">tr</span><span class="op" id="3622875">:</span>&nbsp;<span class="ident" id="3622877">t</span><span class="op" id="3622878">,</span>&nbsp;<span class="ident" id="3622880">NodeType</span><span class="op" id="3622888">:</span>&nbsp;<span class="ident" id="3622890">NodeDot</span><span class="op" id="3622897">,</span>&nbsp;<span class="ident" id="3622899">Pos</span><span class="op" id="3622902">:</span>&nbsp;<span class="ident" id="3622904">pos</span><span class="op" id="3622907">}</span><br>
<span class="lineno"></span><span class="op" id="3622909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3622912">func</span>&nbsp;<span class="op" id="3622917">(</span><span class="ident" id="3622918">d</span>&nbsp;<span class="op" id="3622920">*</span><span class="ident" id="3622921">DotNode</span><span class="op" id="3622928">)</span>&nbsp;<span class="ident" id="3622930">Type</span><span class="op" id="3622934">(</span><span class="op" id="3622935">)</span>&nbsp;<span class="ident" id="3622937">NodeType</span>&nbsp;<span class="op" id="3622946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3622949">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623013">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623081">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623105">return</span>&nbsp;<span class="ident" id="3623112">NodeDot</span><br>
<span class="lineno"></span><span class="op" id="3623120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="3623123">func</span>&nbsp;<span class="op" id="3623128">(</span><span class="ident" id="3623129">d</span>&nbsp;<span class="op" id="3623131">*</span><span class="ident" id="3623132">DotNode</span><span class="op" id="3623139">)</span>&nbsp;<span class="ident" id="3623141">String</span><span class="op" id="3623147">(</span><span class="op" id="3623148">)</span>&nbsp;<span class="builtintype" id="3623150">string</span>&nbsp;<span class="op" id="3623157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623160">return</span>&nbsp;<span class="string" id="3623167">&#34;.&#34;</span><br>
<span class="lineno"></span><span class="op" id="3623171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3623174">func</span>&nbsp;<span class="op" id="3623179">(</span><span class="ident" id="3623180">d</span>&nbsp;<span class="op" id="3623182">*</span><span class="ident" id="3623183">DotNode</span><span class="op" id="3623190">)</span>&nbsp;<span class="ident" id="3623192">tree</span><span class="op" id="3623196">(</span><span class="op" id="3623197">)</span>&nbsp;<span class="op" id="3623199">*</span><span class="ident" id="3623200">Tree</span>&nbsp;<span class="op" id="3623205">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623208">return</span>&nbsp;<span class="ident" id="3623215">d</span><span class="op" id="3623216">.</span><span class="ident" id="3623217">tr</span><br>
<span class="lineno"></span><span class="op" id="3623220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3623223">func</span>&nbsp;<span class="op" id="3623228">(</span><span class="ident" id="3623229">d</span>&nbsp;<span class="op" id="3623231">*</span><span class="ident" id="3623232">DotNode</span><span class="op" id="3623239">)</span>&nbsp;<span class="ident" id="3623241">Copy</span><span class="op" id="3623245">(</span><span class="op" id="3623246">)</span>&nbsp;<span class="ident" id="3623248">Node</span>&nbsp;<span class="op" id="3623253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623256">return</span>&nbsp;<span class="ident" id="3623263">d</span><span class="op" id="3623264">.</span><span class="ident" id="3623265">tr</span><span class="op" id="3623267">.</span><span class="ident" id="3623268">newDot</span><span class="op" id="3623274">(</span><span class="ident" id="3623275">d</span><span class="op" id="3623276">.</span><span class="ident" id="3623277">Pos</span><span class="op" id="3623280">)</span><br>
<span class="lineno">380</span><span class="op" id="3623282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3623285">//&nbsp;NilNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;nil&#39;&nbsp;representing&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="3623369">type</span>&nbsp;<span class="ident" id="3623374">NilNode</span>&nbsp;<span class="keyword" id="3623382">struct</span>&nbsp;<span class="op" id="3623389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3623392">NodeType</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3623402">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3623407">tr</span>&nbsp;<span class="op" id="3623410">*</span><span class="ident" id="3623411">Tree</span><br>
<span class="lineno"></span><span class="op" id="3623416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3623419">func</span>&nbsp;<span class="op" id="3623424">(</span><span class="ident" id="3623425">t</span>&nbsp;<span class="op" id="3623427">*</span><span class="ident" id="3623428">Tree</span><span class="op" id="3623432">)</span>&nbsp;<span class="ident" id="3623434">newNil</span><span class="op" id="3623440">(</span><span class="ident" id="3623441">pos</span>&nbsp;<span class="ident" id="3623445">Pos</span><span class="op" id="3623448">)</span>&nbsp;<span class="op" id="3623450">*</span><span class="ident" id="3623451">NilNode</span>&nbsp;<span class="op" id="3623459">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623462">return</span>&nbsp;<span class="op" id="3623469">&amp;</span><span class="ident" id="3623470">NilNode</span><span class="op" id="3623477">{</span><span class="ident" id="3623478">tr</span><span class="op" id="3623480">:</span>&nbsp;<span class="ident" id="3623482">t</span><span class="op" id="3623483">,</span>&nbsp;<span class="ident" id="3623485">NodeType</span><span class="op" id="3623493">:</span>&nbsp;<span class="ident" id="3623495">NodeNil</span><span class="op" id="3623502">,</span>&nbsp;<span class="ident" id="3623504">Pos</span><span class="op" id="3623507">:</span>&nbsp;<span class="ident" id="3623509">pos</span><span class="op" id="3623512">}</span><br>
<span class="lineno"></span><span class="op" id="3623514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3623517">func</span>&nbsp;<span class="op" id="3623522">(</span><span class="ident" id="3623523">n</span>&nbsp;<span class="op" id="3623525">*</span><span class="ident" id="3623526">NilNode</span><span class="op" id="3623533">)</span>&nbsp;<span class="ident" id="3623535">Type</span><span class="op" id="3623539">(</span><span class="op" id="3623540">)</span>&nbsp;<span class="ident" id="3623542">NodeType</span>&nbsp;<span class="op" id="3623551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623554">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623618">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623686">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623710">return</span>&nbsp;<span class="ident" id="3623717">NodeNil</span><br>
<span class="lineno"></span><span class="op" id="3623725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="3623728">func</span>&nbsp;<span class="op" id="3623733">(</span><span class="ident" id="3623734">n</span>&nbsp;<span class="op" id="3623736">*</span><span class="ident" id="3623737">NilNode</span><span class="op" id="3623744">)</span>&nbsp;<span class="ident" id="3623746">String</span><span class="op" id="3623752">(</span><span class="op" id="3623753">)</span>&nbsp;<span class="builtintype" id="3623755">string</span>&nbsp;<span class="op" id="3623762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623765">return</span>&nbsp;<span class="string" id="3623772">&#34;nil&#34;</span><br>
<span class="lineno"></span><span class="op" id="3623778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3623781">func</span>&nbsp;<span class="op" id="3623786">(</span><span class="ident" id="3623787">n</span>&nbsp;<span class="op" id="3623789">*</span><span class="ident" id="3623790">NilNode</span><span class="op" id="3623797">)</span>&nbsp;<span class="ident" id="3623799">tree</span><span class="op" id="3623803">(</span><span class="op" id="3623804">)</span>&nbsp;<span class="op" id="3623806">*</span><span class="ident" id="3623807">Tree</span>&nbsp;<span class="op" id="3623812">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623815">return</span>&nbsp;<span class="ident" id="3623822">n</span><span class="op" id="3623823">.</span><span class="ident" id="3623824">tr</span><br>
<span class="lineno"></span><span class="op" id="3623827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3623830">func</span>&nbsp;<span class="op" id="3623835">(</span><span class="ident" id="3623836">n</span>&nbsp;<span class="op" id="3623838">*</span><span class="ident" id="3623839">NilNode</span><span class="op" id="3623846">)</span>&nbsp;<span class="ident" id="3623848">Copy</span><span class="op" id="3623852">(</span><span class="op" id="3623853">)</span>&nbsp;<span class="ident" id="3623855">Node</span>&nbsp;<span class="op" id="3623860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623863">return</span>&nbsp;<span class="ident" id="3623870">n</span><span class="op" id="3623871">.</span><span class="ident" id="3623872">tr</span><span class="op" id="3623874">.</span><span class="ident" id="3623875">newNil</span><span class="op" id="3623881">(</span><span class="ident" id="3623882">n</span><span class="op" id="3623883">.</span><span class="ident" id="3623884">Pos</span><span class="op" id="3623887">)</span><br>
<span class="lineno">410</span><span class="op" id="3623889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3623892">//&nbsp;FieldNode&nbsp;holds&nbsp;a&nbsp;field&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3623951">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3623989">//&nbsp;The&nbsp;period&nbsp;is&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">415</span><span class="keyword" id="3624031">type</span>&nbsp;<span class="ident" id="3624036">FieldNode</span>&nbsp;<span class="keyword" id="3624046">struct</span>&nbsp;<span class="op" id="3624053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624056">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624066">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624071">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3624077">*</span><span class="ident" id="3624078">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624084">Ident</span>&nbsp;<span class="op" id="3624090">[</span><span class="op" id="3624091">]</span><span class="builtintype" id="3624092">string</span>&nbsp;<span class="comment" id="3624099">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">420</span><span class="op" id="3624136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3624139">func</span>&nbsp;<span class="op" id="3624144">(</span><span class="ident" id="3624145">t</span>&nbsp;<span class="op" id="3624147">*</span><span class="ident" id="3624148">Tree</span><span class="op" id="3624152">)</span>&nbsp;<span class="ident" id="3624154">newField</span><span class="op" id="3624162">(</span><span class="ident" id="3624163">pos</span>&nbsp;<span class="ident" id="3624167">Pos</span><span class="op" id="3624170">,</span>&nbsp;<span class="ident" id="3624172">ident</span>&nbsp;<span class="builtintype" id="3624178">string</span><span class="op" id="3624184">)</span>&nbsp;<span class="op" id="3624186">*</span><span class="ident" id="3624187">FieldNode</span>&nbsp;<span class="op" id="3624197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3624200">return</span>&nbsp;<span class="op" id="3624207">&amp;</span><span class="ident" id="3624208">FieldNode</span><span class="op" id="3624217">{</span><span class="ident" id="3624218">tr</span><span class="op" id="3624220">:</span>&nbsp;<span class="ident" id="3624222">t</span><span class="op" id="3624223">,</span>&nbsp;<span class="ident" id="3624225">NodeType</span><span class="op" id="3624233">:</span>&nbsp;<span class="ident" id="3624235">NodeField</span><span class="op" id="3624244">,</span>&nbsp;<span class="ident" id="3624246">Pos</span><span class="op" id="3624249">:</span>&nbsp;<span class="ident" id="3624251">pos</span><span class="op" id="3624254">,</span>&nbsp;<span class="ident" id="3624256">Ident</span><span class="op" id="3624261">:</span>&nbsp;<span class="ident" id="3624263">strings</span><span class="op" id="3624270">.</span><span class="ident" id="3624271">Split</span><span class="op" id="3624276">(</span><span class="ident" id="3624277">ident</span><span class="op" id="3624282">[</span><span class="num" id="3624283">1</span><span class="op" id="3624284">:</span><span class="op" id="3624285">]</span><span class="op" id="3624286">,</span>&nbsp;<span class="string" id="3624288">&#34;.&#34;</span><span class="op" id="3624291">)</span><span class="op" id="3624292">}</span>&nbsp;<span class="comment" id="3624294">//&nbsp;[1:]&nbsp;to&nbsp;drop&nbsp;leading&nbsp;period</span><br>
<span class="lineno"></span><span class="op" id="3624325">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="3624328">func</span>&nbsp;<span class="op" id="3624333">(</span><span class="ident" id="3624334">f</span>&nbsp;<span class="op" id="3624336">*</span><span class="ident" id="3624337">FieldNode</span><span class="op" id="3624346">)</span>&nbsp;<span class="ident" id="3624348">String</span><span class="op" id="3624354">(</span><span class="op" id="3624355">)</span>&nbsp;<span class="builtintype" id="3624357">string</span>&nbsp;<span class="op" id="3624364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624367">s</span>&nbsp;<span class="op" id="3624369">:=</span>&nbsp;<span class="string" id="3624372">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3624376">for</span>&nbsp;<span class="ident" id="3624380">_</span><span class="op" id="3624381">,</span>&nbsp;<span class="ident" id="3624383">id</span>&nbsp;<span class="op" id="3624386">:=</span>&nbsp;<span class="keyword" id="3624389">range</span>&nbsp;<span class="ident" id="3624395">f</span><span class="op" id="3624396">.</span><span class="ident" id="3624397">Ident</span>&nbsp;<span class="op" id="3624403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624407">s</span>&nbsp;<span class="op" id="3624409">+=</span>&nbsp;<span class="string" id="3624412">&#34;.&#34;</span>&nbsp;<span class="op" id="3624416">+</span>&nbsp;<span class="ident" id="3624418">id</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3624422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3624425">return</span>&nbsp;<span class="ident" id="3624432">s</span><br>
<span class="lineno"></span><span class="op" id="3624434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3624437">func</span>&nbsp;<span class="op" id="3624442">(</span><span class="ident" id="3624443">f</span>&nbsp;<span class="op" id="3624445">*</span><span class="ident" id="3624446">FieldNode</span><span class="op" id="3624455">)</span>&nbsp;<span class="ident" id="3624457">tree</span><span class="op" id="3624461">(</span><span class="op" id="3624462">)</span>&nbsp;<span class="op" id="3624464">*</span><span class="ident" id="3624465">Tree</span>&nbsp;<span class="op" id="3624470">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3624473">return</span>&nbsp;<span class="ident" id="3624480">f</span><span class="op" id="3624481">.</span><span class="ident" id="3624482">tr</span><br>
<span class="lineno"></span><span class="op" id="3624485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3624488">func</span>&nbsp;<span class="op" id="3624493">(</span><span class="ident" id="3624494">f</span>&nbsp;<span class="op" id="3624496">*</span><span class="ident" id="3624497">FieldNode</span><span class="op" id="3624506">)</span>&nbsp;<span class="ident" id="3624508">Copy</span><span class="op" id="3624512">(</span><span class="op" id="3624513">)</span>&nbsp;<span class="ident" id="3624515">Node</span>&nbsp;<span class="op" id="3624520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3624523">return</span>&nbsp;<span class="op" id="3624530">&amp;</span><span class="ident" id="3624531">FieldNode</span><span class="op" id="3624540">{</span><span class="ident" id="3624541">tr</span><span class="op" id="3624543">:</span>&nbsp;<span class="ident" id="3624545">f</span><span class="op" id="3624546">.</span><span class="ident" id="3624547">tr</span><span class="op" id="3624549">,</span>&nbsp;<span class="ident" id="3624551">NodeType</span><span class="op" id="3624559">:</span>&nbsp;<span class="ident" id="3624561">NodeField</span><span class="op" id="3624570">,</span>&nbsp;<span class="ident" id="3624572">Pos</span><span class="op" id="3624575">:</span>&nbsp;<span class="ident" id="3624577">f</span><span class="op" id="3624578">.</span><span class="ident" id="3624579">Pos</span><span class="op" id="3624582">,</span>&nbsp;<span class="ident" id="3624584">Ident</span><span class="op" id="3624589">:</span>&nbsp;<span class="builtinfunc" id="3624591">append</span><span class="op" id="3624597">(</span><span class="op" id="3624598">[</span><span class="op" id="3624599">]</span><span class="builtintype" id="3624600">string</span><span class="op" id="3624606">{</span><span class="op" id="3624607">}</span><span class="op" id="3624608">,</span>&nbsp;<span class="ident" id="3624610">f</span><span class="op" id="3624611">.</span><span class="ident" id="3624612">Ident</span><span class="op" id="3624617">...</span><span class="op" id="3624620">)</span><span class="op" id="3624621">}</span><br>
<span class="lineno">440</span><span class="op" id="3624623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3624626">//&nbsp;ChainNode&nbsp;holds&nbsp;a&nbsp;term&nbsp;followed&nbsp;by&nbsp;a&nbsp;chain&nbsp;of&nbsp;field&nbsp;accesses&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3624722">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3624760">//&nbsp;The&nbsp;periods&nbsp;are&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">445</span><span class="keyword" id="3624804">type</span>&nbsp;<span class="ident" id="3624809">ChainNode</span>&nbsp;<span class="keyword" id="3624819">struct</span>&nbsp;<span class="op" id="3624826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624829">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624839">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624844">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3624850">*</span><span class="ident" id="3624851">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624857">Node</span>&nbsp;&nbsp;<span class="ident" id="3624863">Node</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624869">Field</span>&nbsp;<span class="op" id="3624875">[</span><span class="op" id="3624876">]</span><span class="builtintype" id="3624877">string</span>&nbsp;<span class="comment" id="3624884">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3624921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3624924">func</span>&nbsp;<span class="op" id="3624929">(</span><span class="ident" id="3624930">t</span>&nbsp;<span class="op" id="3624932">*</span><span class="ident" id="3624933">Tree</span><span class="op" id="3624937">)</span>&nbsp;<span class="ident" id="3624939">newChain</span><span class="op" id="3624947">(</span><span class="ident" id="3624948">pos</span>&nbsp;<span class="ident" id="3624952">Pos</span><span class="op" id="3624955">,</span>&nbsp;<span class="ident" id="3624957">node</span>&nbsp;<span class="ident" id="3624962">Node</span><span class="op" id="3624966">)</span>&nbsp;<span class="op" id="3624968">*</span><span class="ident" id="3624969">ChainNode</span>&nbsp;<span class="op" id="3624979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3624982">return</span>&nbsp;<span class="op" id="3624989">&amp;</span><span class="ident" id="3624990">ChainNode</span><span class="op" id="3624999">{</span><span class="ident" id="3625000">tr</span><span class="op" id="3625002">:</span>&nbsp;<span class="ident" id="3625004">t</span><span class="op" id="3625005">,</span>&nbsp;<span class="ident" id="3625007">NodeType</span><span class="op" id="3625015">:</span>&nbsp;<span class="ident" id="3625017">NodeChain</span><span class="op" id="3625026">,</span>&nbsp;<span class="ident" id="3625028">Pos</span><span class="op" id="3625031">:</span>&nbsp;<span class="ident" id="3625033">pos</span><span class="op" id="3625036">,</span>&nbsp;<span class="ident" id="3625038">Node</span><span class="op" id="3625042">:</span>&nbsp;<span class="ident" id="3625044">node</span><span class="op" id="3625048">}</span><br>
<span class="lineno">455</span><span class="op" id="3625050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3625053">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;named&nbsp;field&nbsp;(which&nbsp;should&nbsp;start&nbsp;with&nbsp;a&nbsp;period)&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="3625141">func</span>&nbsp;<span class="op" id="3625146">(</span><span class="ident" id="3625147">c</span>&nbsp;<span class="op" id="3625149">*</span><span class="ident" id="3625150">ChainNode</span><span class="op" id="3625159">)</span>&nbsp;<span class="ident" id="3625161">Add</span><span class="op" id="3625164">(</span><span class="ident" id="3625165">field</span>&nbsp;<span class="builtintype" id="3625171">string</span><span class="op" id="3625177">)</span>&nbsp;<span class="op" id="3625179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625182">if</span>&nbsp;<span class="builtinfunc" id="3625185">len</span><span class="op" id="3625188">(</span><span class="ident" id="3625189">field</span><span class="op" id="3625194">)</span>&nbsp;<span class="op" id="3625196">==</span>&nbsp;<span class="num" id="3625199">0</span>&nbsp;<span class="op" id="3625201">||</span>&nbsp;<span class="ident" id="3625204">field</span><span class="op" id="3625209">[</span><span class="num" id="3625210">0</span><span class="op" id="3625211">]</span>&nbsp;<span class="op" id="3625213">!=</span>&nbsp;<span class="string" id="3625216">&#39;.&#39;</span>&nbsp;<span class="op" id="3625220">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3625224">panic</span><span class="op" id="3625229">(</span><span class="string" id="3625230">&#34;no&nbsp;dot&nbsp;in&nbsp;field&#34;</span><span class="op" id="3625247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625253">field</span>&nbsp;<span class="op" id="3625259">=</span>&nbsp;<span class="ident" id="3625261">field</span><span class="op" id="3625266">[</span><span class="num" id="3625267">1</span><span class="op" id="3625268">:</span><span class="op" id="3625269">]</span>&nbsp;<span class="comment" id="3625271">//&nbsp;Remove&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625295">if</span>&nbsp;<span class="ident" id="3625298">field</span>&nbsp;<span class="op" id="3625304">==</span>&nbsp;<span class="string" id="3625307">&#34;&#34;</span>&nbsp;<span class="op" id="3625310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3625314">panic</span><span class="op" id="3625319">(</span><span class="string" id="3625320">&#34;empty&nbsp;field&#34;</span><span class="op" id="3625333">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625339">c</span><span class="op" id="3625340">.</span><span class="ident" id="3625341">Field</span>&nbsp;<span class="op" id="3625347">=</span>&nbsp;<span class="builtinfunc" id="3625349">append</span><span class="op" id="3625355">(</span><span class="ident" id="3625356">c</span><span class="op" id="3625357">.</span><span class="ident" id="3625358">Field</span><span class="op" id="3625363">,</span>&nbsp;<span class="ident" id="3625365">field</span><span class="op" id="3625370">)</span><br>
<span class="lineno"></span><span class="op" id="3625372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3625375">func</span>&nbsp;<span class="op" id="3625380">(</span><span class="ident" id="3625381">c</span>&nbsp;<span class="op" id="3625383">*</span><span class="ident" id="3625384">ChainNode</span><span class="op" id="3625393">)</span>&nbsp;<span class="ident" id="3625395">String</span><span class="op" id="3625401">(</span><span class="op" id="3625402">)</span>&nbsp;<span class="builtintype" id="3625404">string</span>&nbsp;<span class="op" id="3625411">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625414">s</span>&nbsp;<span class="op" id="3625416">:=</span>&nbsp;<span class="ident" id="3625419">c</span><span class="op" id="3625420">.</span><span class="ident" id="3625421">Node</span><span class="op" id="3625425">.</span><span class="ident" id="3625426">String</span><span class="op" id="3625432">(</span><span class="op" id="3625433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625436">if</span>&nbsp;<span class="ident" id="3625439">_</span><span class="op" id="3625440">,</span>&nbsp;<span class="ident" id="3625442">ok</span>&nbsp;<span class="op" id="3625445">:=</span>&nbsp;<span class="ident" id="3625448">c</span><span class="op" id="3625449">.</span><span class="ident" id="3625450">Node</span><span class="op" id="3625454">.</span><span class="op" id="3625455">(</span><span class="op" id="3625456">*</span><span class="ident" id="3625457">PipeNode</span><span class="op" id="3625465">)</span><span class="op" id="3625466">;</span>&nbsp;<span class="ident" id="3625468">ok</span>&nbsp;<span class="op" id="3625471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625475">s</span>&nbsp;<span class="op" id="3625477">=</span>&nbsp;<span class="string" id="3625479">&#34;(&#34;</span>&nbsp;<span class="op" id="3625483">+</span>&nbsp;<span class="ident" id="3625485">s</span>&nbsp;<span class="op" id="3625487">+</span>&nbsp;<span class="string" id="3625489">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625497">for</span>&nbsp;<span class="ident" id="3625501">_</span><span class="op" id="3625502">,</span>&nbsp;<span class="ident" id="3625504">field</span>&nbsp;<span class="op" id="3625510">:=</span>&nbsp;<span class="keyword" id="3625513">range</span>&nbsp;<span class="ident" id="3625519">c</span><span class="op" id="3625520">.</span><span class="ident" id="3625521">Field</span>&nbsp;<span class="op" id="3625527">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625531">s</span>&nbsp;<span class="op" id="3625533">+=</span>&nbsp;<span class="string" id="3625536">&#34;.&#34;</span>&nbsp;<span class="op" id="3625540">+</span>&nbsp;<span class="ident" id="3625542">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625552">return</span>&nbsp;<span class="ident" id="3625559">s</span><br>
<span class="lineno"></span><span class="op" id="3625561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="3625564">func</span>&nbsp;<span class="op" id="3625569">(</span><span class="ident" id="3625570">c</span>&nbsp;<span class="op" id="3625572">*</span><span class="ident" id="3625573">ChainNode</span><span class="op" id="3625582">)</span>&nbsp;<span class="ident" id="3625584">tree</span><span class="op" id="3625588">(</span><span class="op" id="3625589">)</span>&nbsp;<span class="op" id="3625591">*</span><span class="ident" id="3625592">Tree</span>&nbsp;<span class="op" id="3625597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625600">return</span>&nbsp;<span class="ident" id="3625607">c</span><span class="op" id="3625608">.</span><span class="ident" id="3625609">tr</span><br>
<span class="lineno"></span><span class="op" id="3625612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3625615">func</span>&nbsp;<span class="op" id="3625620">(</span><span class="ident" id="3625621">c</span>&nbsp;<span class="op" id="3625623">*</span><span class="ident" id="3625624">ChainNode</span><span class="op" id="3625633">)</span>&nbsp;<span class="ident" id="3625635">Copy</span><span class="op" id="3625639">(</span><span class="op" id="3625640">)</span>&nbsp;<span class="ident" id="3625642">Node</span>&nbsp;<span class="op" id="3625647">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625650">return</span>&nbsp;<span class="op" id="3625657">&amp;</span><span class="ident" id="3625658">ChainNode</span><span class="op" id="3625667">{</span><span class="ident" id="3625668">tr</span><span class="op" id="3625670">:</span>&nbsp;<span class="ident" id="3625672">c</span><span class="op" id="3625673">.</span><span class="ident" id="3625674">tr</span><span class="op" id="3625676">,</span>&nbsp;<span class="ident" id="3625678">NodeType</span><span class="op" id="3625686">:</span>&nbsp;<span class="ident" id="3625688">NodeChain</span><span class="op" id="3625697">,</span>&nbsp;<span class="ident" id="3625699">Pos</span><span class="op" id="3625702">:</span>&nbsp;<span class="ident" id="3625704">c</span><span class="op" id="3625705">.</span><span class="ident" id="3625706">Pos</span><span class="op" id="3625709">,</span>&nbsp;<span class="ident" id="3625711">Node</span><span class="op" id="3625715">:</span>&nbsp;<span class="ident" id="3625717">c</span><span class="op" id="3625718">.</span><span class="ident" id="3625719">Node</span><span class="op" id="3625723">,</span>&nbsp;<span class="ident" id="3625725">Field</span><span class="op" id="3625730">:</span>&nbsp;<span class="builtinfunc" id="3625732">append</span><span class="op" id="3625738">(</span><span class="op" id="3625739">[</span><span class="op" id="3625740">]</span><span class="builtintype" id="3625741">string</span><span class="op" id="3625747">{</span><span class="op" id="3625748">}</span><span class="op" id="3625749">,</span>&nbsp;<span class="ident" id="3625751">c</span><span class="op" id="3625752">.</span><span class="ident" id="3625753">Field</span><span class="op" id="3625758">...</span><span class="op" id="3625761">)</span><span class="op" id="3625762">}</span><br>
<span class="lineno"></span><span class="op" id="3625764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3625767">//&nbsp;BoolNode&nbsp;holds&nbsp;a&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="3625805">type</span>&nbsp;<span class="ident" id="3625810">BoolNode</span>&nbsp;<span class="keyword" id="3625819">struct</span>&nbsp;<span class="op" id="3625826">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625829">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625839">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625844">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3625849">*</span><span class="ident" id="3625850">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625856">True</span>&nbsp;<span class="builtintype" id="3625861">bool</span>&nbsp;<span class="comment" id="3625866">//&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="3625904">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="3625907">func</span>&nbsp;<span class="op" id="3625912">(</span><span class="ident" id="3625913">t</span>&nbsp;<span class="op" id="3625915">*</span><span class="ident" id="3625916">Tree</span><span class="op" id="3625920">)</span>&nbsp;<span class="ident" id="3625922">newBool</span><span class="op" id="3625929">(</span><span class="ident" id="3625930">pos</span>&nbsp;<span class="ident" id="3625934">Pos</span><span class="op" id="3625937">,</span>&nbsp;<span class="builtintype" id="3625939">true</span>&nbsp;<span class="builtintype" id="3625944">bool</span><span class="op" id="3625948">)</span>&nbsp;<span class="op" id="3625950">*</span><span class="ident" id="3625951">BoolNode</span>&nbsp;<span class="op" id="3625960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625963">return</span>&nbsp;<span class="op" id="3625970">&amp;</span><span class="ident" id="3625971">BoolNode</span><span class="op" id="3625979">{</span><span class="ident" id="3625980">tr</span><span class="op" id="3625982">:</span>&nbsp;<span class="ident" id="3625984">t</span><span class="op" id="3625985">,</span>&nbsp;<span class="ident" id="3625987">NodeType</span><span class="op" id="3625995">:</span>&nbsp;<span class="ident" id="3625997">NodeBool</span><span class="op" id="3626005">,</span>&nbsp;<span class="ident" id="3626007">Pos</span><span class="op" id="3626010">:</span>&nbsp;<span class="ident" id="3626012">pos</span><span class="op" id="3626015">,</span>&nbsp;<span class="ident" id="3626017">True</span><span class="op" id="3626021">:</span>&nbsp;<span class="builtintype" id="3626023">true</span><span class="op" id="3626027">}</span><br>
<span class="lineno"></span><span class="op" id="3626029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="3626032">func</span>&nbsp;<span class="op" id="3626037">(</span><span class="ident" id="3626038">b</span>&nbsp;<span class="op" id="3626040">*</span><span class="ident" id="3626041">BoolNode</span><span class="op" id="3626049">)</span>&nbsp;<span class="ident" id="3626051">String</span><span class="op" id="3626057">(</span><span class="op" id="3626058">)</span>&nbsp;<span class="builtintype" id="3626060">string</span>&nbsp;<span class="op" id="3626067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626070">if</span>&nbsp;<span class="ident" id="3626073">b</span><span class="op" id="3626074">.</span><span class="ident" id="3626075">True</span>&nbsp;<span class="op" id="3626080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626084">return</span>&nbsp;<span class="string" id="3626091">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3626099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626102">return</span>&nbsp;<span class="string" id="3626109">&#34;false&#34;</span><br>
<span class="lineno">505</span><span class="op" id="3626117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3626120">func</span>&nbsp;<span class="op" id="3626125">(</span><span class="ident" id="3626126">b</span>&nbsp;<span class="op" id="3626128">*</span><span class="ident" id="3626129">BoolNode</span><span class="op" id="3626137">)</span>&nbsp;<span class="ident" id="3626139">tree</span><span class="op" id="3626143">(</span><span class="op" id="3626144">)</span>&nbsp;<span class="op" id="3626146">*</span><span class="ident" id="3626147">Tree</span>&nbsp;<span class="op" id="3626152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626155">return</span>&nbsp;<span class="ident" id="3626162">b</span><span class="op" id="3626163">.</span><span class="ident" id="3626164">tr</span><br>
<span class="lineno"></span><span class="op" id="3626167">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="3626170">func</span>&nbsp;<span class="op" id="3626175">(</span><span class="ident" id="3626176">b</span>&nbsp;<span class="op" id="3626178">*</span><span class="ident" id="3626179">BoolNode</span><span class="op" id="3626187">)</span>&nbsp;<span class="ident" id="3626189">Copy</span><span class="op" id="3626193">(</span><span class="op" id="3626194">)</span>&nbsp;<span class="ident" id="3626196">Node</span>&nbsp;<span class="op" id="3626201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626204">return</span>&nbsp;<span class="ident" id="3626211">b</span><span class="op" id="3626212">.</span><span class="ident" id="3626213">tr</span><span class="op" id="3626215">.</span><span class="ident" id="3626216">newBool</span><span class="op" id="3626223">(</span><span class="ident" id="3626224">b</span><span class="op" id="3626225">.</span><span class="ident" id="3626226">Pos</span><span class="op" id="3626229">,</span>&nbsp;<span class="ident" id="3626231">b</span><span class="op" id="3626232">.</span><span class="ident" id="3626233">True</span><span class="op" id="3626237">)</span><br>
<span class="lineno"></span><span class="op" id="3626239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="3626242">//&nbsp;NumberNode&nbsp;holds&nbsp;a&nbsp;number:&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;integer,&nbsp;float,&nbsp;or&nbsp;complex.</span><br>
<span class="lineno"></span><span class="comment" id="3626319">//&nbsp;The&nbsp;value&nbsp;is&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;under&nbsp;all&nbsp;the&nbsp;types&nbsp;that&nbsp;can&nbsp;represent&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="3626403">//&nbsp;This&nbsp;simulates&nbsp;in&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;code&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Go&#39;s&nbsp;ideal&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3626485">type</span>&nbsp;<span class="ident" id="3626490">NumberNode</span>&nbsp;<span class="keyword" id="3626501">struct</span>&nbsp;<span class="op" id="3626508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626511">NodeType</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626521">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626526">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3626537">*</span><span class="ident" id="3626538">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626544">IsInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3626555">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3626566">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626600">IsUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3626611">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3626622">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;unsigned&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626665">IsFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3626676">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3626687">//&nbsp;Number&nbsp;has&nbsp;a&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626726">IsComplex</span>&nbsp;&nbsp;<span class="builtintype" id="3626737">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3626748">//&nbsp;Number&nbsp;is&nbsp;complex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626771">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626782">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3626793">//&nbsp;The&nbsp;signed&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626823">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626834">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3626845">//&nbsp;The&nbsp;unsigned&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626877">Float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3626888">float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3626899">//&nbsp;The&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626929">Complex128</span>&nbsp;<span class="builtintype" id="3626940">complex128</span>&nbsp;<span class="comment" id="3626951">//&nbsp;The&nbsp;complex&nbsp;value.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626974">Text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3626985">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3626996">//&nbsp;The&nbsp;original&nbsp;textual&nbsp;representation&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="op" id="3627051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3627054">func</span>&nbsp;<span class="op" id="3627059">(</span><span class="ident" id="3627060">t</span>&nbsp;<span class="op" id="3627062">*</span><span class="ident" id="3627063">Tree</span><span class="op" id="3627067">)</span>&nbsp;<span class="ident" id="3627069">newNumber</span><span class="op" id="3627078">(</span><span class="ident" id="3627079">pos</span>&nbsp;<span class="ident" id="3627083">Pos</span><span class="op" id="3627086">,</span>&nbsp;<span class="ident" id="3627088">text</span>&nbsp;<span class="builtintype" id="3627093">string</span><span class="op" id="3627099">,</span>&nbsp;<span class="ident" id="3627101">typ</span>&nbsp;<span class="ident" id="3627105">itemType</span><span class="op" id="3627113">)</span>&nbsp;<span class="op" id="3627115">(</span><span class="op" id="3627116">*</span><span class="ident" id="3627117">NumberNode</span><span class="op" id="3627127">,</span>&nbsp;<span class="builtintype" id="3627129">error</span><span class="op" id="3627134">)</span>&nbsp;<span class="op" id="3627136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627139">n</span>&nbsp;<span class="op" id="3627141">:=</span>&nbsp;<span class="op" id="3627144">&amp;</span><span class="ident" id="3627145">NumberNode</span><span class="op" id="3627155">{</span><span class="ident" id="3627156">tr</span><span class="op" id="3627158">:</span>&nbsp;<span class="ident" id="3627160">t</span><span class="op" id="3627161">,</span>&nbsp;<span class="ident" id="3627163">NodeType</span><span class="op" id="3627171">:</span>&nbsp;<span class="ident" id="3627173">NodeNumber</span><span class="op" id="3627183">,</span>&nbsp;<span class="ident" id="3627185">Pos</span><span class="op" id="3627188">:</span>&nbsp;<span class="ident" id="3627190">pos</span><span class="op" id="3627193">,</span>&nbsp;<span class="ident" id="3627195">Text</span><span class="op" id="3627199">:</span>&nbsp;<span class="ident" id="3627201">text</span><span class="op" id="3627205">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627208">switch</span>&nbsp;<span class="ident" id="3627215">typ</span>&nbsp;<span class="op" id="3627219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627222">case</span>&nbsp;<span class="ident" id="3627227">itemCharConstant</span><span class="op" id="3627243">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3627247">rune</span><span class="op" id="3627251">,</span>&nbsp;<span class="ident" id="3627253">_</span><span class="op" id="3627254">,</span>&nbsp;<span class="ident" id="3627256">tail</span><span class="op" id="3627260">,</span>&nbsp;<span class="ident" id="3627262">err</span>&nbsp;<span class="op" id="3627266">:=</span>&nbsp;<span class="ident" id="3627269">strconv</span><span class="op" id="3627276">.</span><span class="ident" id="3627277">UnquoteChar</span><span class="op" id="3627288">(</span><span class="ident" id="3627289">text</span><span class="op" id="3627293">[</span><span class="num" id="3627294">1</span><span class="op" id="3627295">:</span><span class="op" id="3627296">]</span><span class="op" id="3627297">,</span>&nbsp;<span class="ident" id="3627299">text</span><span class="op" id="3627303">[</span><span class="num" id="3627304">0</span><span class="op" id="3627305">]</span><span class="op" id="3627306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627310">if</span>&nbsp;<span class="ident" id="3627313">err</span>&nbsp;<span class="op" id="3627317">!=</span>&nbsp;<span class="builtintype" id="3627320">nil</span>&nbsp;<span class="op" id="3627324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627329">return</span>&nbsp;<span class="builtintype" id="3627336">nil</span><span class="op" id="3627339">,</span>&nbsp;<span class="ident" id="3627341">err</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3627347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627351">if</span>&nbsp;<span class="ident" id="3627354">tail</span>&nbsp;<span class="op" id="3627359">!=</span>&nbsp;<span class="string" id="3627362">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="3627366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627371">return</span>&nbsp;<span class="builtintype" id="3627378">nil</span><span class="op" id="3627381">,</span>&nbsp;<span class="ident" id="3627383">fmt</span><span class="op" id="3627386">.</span><span class="ident" id="3627387">Errorf</span><span class="op" id="3627393">(</span><span class="string" id="3627394">&#34;malformed&nbsp;character&nbsp;constant:&nbsp;%s&#34;</span><span class="op" id="3627428">,</span>&nbsp;<span class="ident" id="3627430">text</span><span class="op" id="3627434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3627438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627442">n</span><span class="op" id="3627443">.</span><span class="ident" id="3627444">Int64</span>&nbsp;<span class="op" id="3627450">=</span>&nbsp;<span class="ident" id="3627452">int64</span><span class="op" id="3627457">(</span><span class="builtintype" id="3627458">rune</span><span class="op" id="3627462">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627466">n</span><span class="op" id="3627467">.</span><span class="ident" id="3627468">IsInt</span>&nbsp;<span class="op" id="3627474">=</span>&nbsp;<span class="builtintype" id="3627476">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627483">n</span><span class="op" id="3627484">.</span><span class="ident" id="3627485">Uint64</span>&nbsp;<span class="op" id="3627492">=</span>&nbsp;<span class="ident" id="3627494">uint64</span><span class="op" id="3627500">(</span><span class="builtintype" id="3627501">rune</span><span class="op" id="3627505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627509">n</span><span class="op" id="3627510">.</span><span class="ident" id="3627511">IsUint</span>&nbsp;<span class="op" id="3627518">=</span>&nbsp;<span class="builtintype" id="3627520">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627527">n</span><span class="op" id="3627528">.</span><span class="ident" id="3627529">Float64</span>&nbsp;<span class="op" id="3627537">=</span>&nbsp;<span class="builtintype" id="3627539">float64</span><span class="op" id="3627546">(</span><span class="builtintype" id="3627547">rune</span><span class="op" id="3627551">)</span>&nbsp;<span class="comment" id="3627553">//&nbsp;odd&nbsp;but&nbsp;those&nbsp;are&nbsp;the&nbsp;rules.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627587">n</span><span class="op" id="3627588">.</span><span class="ident" id="3627589">IsFloat</span>&nbsp;<span class="op" id="3627597">=</span>&nbsp;<span class="builtintype" id="3627599">true</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627606">return</span>&nbsp;<span class="ident" id="3627613">n</span><span class="op" id="3627614">,</span>&nbsp;<span class="builtintype" id="3627616">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627621">case</span>&nbsp;<span class="ident" id="3627626">itemComplex</span><span class="op" id="3627637">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3627641">//&nbsp;fmt.Sscan&nbsp;can&nbsp;parse&nbsp;the&nbsp;pair,&nbsp;so&nbsp;let&nbsp;it&nbsp;do&nbsp;the&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627699">if</span>&nbsp;<span class="ident" id="3627702">_</span><span class="op" id="3627703">,</span>&nbsp;<span class="ident" id="3627705">err</span>&nbsp;<span class="op" id="3627709">:=</span>&nbsp;<span class="ident" id="3627712">fmt</span><span class="op" id="3627715">.</span><span class="ident" id="3627716">Sscan</span><span class="op" id="3627721">(</span><span class="ident" id="3627722">text</span><span class="op" id="3627726">,</span>&nbsp;<span class="op" id="3627728">&amp;</span><span class="ident" id="3627729">n</span><span class="op" id="3627730">.</span><span class="ident" id="3627731">Complex128</span><span class="op" id="3627741">)</span><span class="op" id="3627742">;</span>&nbsp;<span class="ident" id="3627744">err</span>&nbsp;<span class="op" id="3627748">!=</span>&nbsp;<span class="builtintype" id="3627751">nil</span>&nbsp;<span class="op" id="3627755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627760">return</span>&nbsp;<span class="builtintype" id="3627767">nil</span><span class="op" id="3627770">,</span>&nbsp;<span class="ident" id="3627772">err</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3627778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627782">n</span><span class="op" id="3627783">.</span><span class="ident" id="3627784">IsComplex</span>&nbsp;<span class="op" id="3627794">=</span>&nbsp;<span class="builtintype" id="3627796">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627803">n</span><span class="op" id="3627804">.</span><span class="ident" id="3627805">simplifyComplex</span><span class="op" id="3627820">(</span><span class="op" id="3627821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627825">return</span>&nbsp;<span class="ident" id="3627832">n</span><span class="op" id="3627833">,</span>&nbsp;<span class="builtintype" id="3627835">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3627840">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3627843">//&nbsp;Imaginary&nbsp;constants&nbsp;can&nbsp;only&nbsp;be&nbsp;complex&nbsp;unless&nbsp;they&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627909">if</span>&nbsp;<span class="builtinfunc" id="3627912">len</span><span class="op" id="3627915">(</span><span class="ident" id="3627916">text</span><span class="op" id="3627920">)</span>&nbsp;<span class="op" id="3627922">&gt;</span>&nbsp;<span class="num" id="3627924">0</span>&nbsp;<span class="op" id="3627926">&amp;&amp;</span>&nbsp;<span class="ident" id="3627929">text</span><span class="op" id="3627933">[</span><span class="builtinfunc" id="3627934">len</span><span class="op" id="3627937">(</span><span class="ident" id="3627938">text</span><span class="op" id="3627942">)</span><span class="op" id="3627943">-</span><span class="num" id="3627944">1</span><span class="op" id="3627945">]</span>&nbsp;<span class="op" id="3627947">==</span>&nbsp;<span class="string" id="3627950">&#39;i&#39;</span>&nbsp;<span class="op" id="3627954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627958">f</span><span class="op" id="3627959">,</span>&nbsp;<span class="ident" id="3627961">err</span>&nbsp;<span class="op" id="3627965">:=</span>&nbsp;<span class="ident" id="3627968">strconv</span><span class="op" id="3627975">.</span><span class="ident" id="3627976">ParseFloat</span><span class="op" id="3627986">(</span><span class="ident" id="3627987">text</span><span class="op" id="3627991">[</span><span class="op" id="3627992">:</span><span class="builtinfunc" id="3627993">len</span><span class="op" id="3627996">(</span><span class="ident" id="3627997">text</span><span class="op" id="3628001">)</span><span class="op" id="3628002">-</span><span class="num" id="3628003">1</span><span class="op" id="3628004">]</span><span class="op" id="3628005">,</span>&nbsp;<span class="num" id="3628007">64</span><span class="op" id="3628009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628013">if</span>&nbsp;<span class="ident" id="3628016">err</span>&nbsp;<span class="op" id="3628020">==</span>&nbsp;<span class="builtintype" id="3628023">nil</span>&nbsp;<span class="op" id="3628027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628032">n</span><span class="op" id="3628033">.</span><span class="ident" id="3628034">IsComplex</span>&nbsp;<span class="op" id="3628044">=</span>&nbsp;<span class="builtintype" id="3628046">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628054">n</span><span class="op" id="3628055">.</span><span class="ident" id="3628056">Complex128</span>&nbsp;<span class="op" id="3628067">=</span>&nbsp;<span class="builtinfunc" id="3628069">complex</span><span class="op" id="3628076">(</span><span class="num" id="3628077">0</span><span class="op" id="3628078">,</span>&nbsp;<span class="ident" id="3628080">f</span><span class="op" id="3628081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628086">n</span><span class="op" id="3628087">.</span><span class="ident" id="3628088">simplifyComplex</span><span class="op" id="3628103">(</span><span class="op" id="3628104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628109">return</span>&nbsp;<span class="ident" id="3628116">n</span><span class="op" id="3628117">,</span>&nbsp;<span class="builtintype" id="3628119">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628128">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3628131">//&nbsp;Do&nbsp;integer&nbsp;test&nbsp;first&nbsp;so&nbsp;we&nbsp;get&nbsp;0x123&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628178">u</span><span class="op" id="3628179">,</span>&nbsp;<span class="ident" id="3628181">err</span>&nbsp;<span class="op" id="3628185">:=</span>&nbsp;<span class="ident" id="3628188">strconv</span><span class="op" id="3628195">.</span><span class="ident" id="3628196">ParseUint</span><span class="op" id="3628205">(</span><span class="ident" id="3628206">text</span><span class="op" id="3628210">,</span>&nbsp;<span class="num" id="3628212">0</span><span class="op" id="3628213">,</span>&nbsp;<span class="num" id="3628215">64</span><span class="op" id="3628217">)</span>&nbsp;<span class="comment" id="3628219">//&nbsp;will&nbsp;fail&nbsp;for&nbsp;-0;&nbsp;fixed&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628254">if</span>&nbsp;<span class="ident" id="3628257">err</span>&nbsp;<span class="op" id="3628261">==</span>&nbsp;<span class="builtintype" id="3628264">nil</span>&nbsp;<span class="op" id="3628268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628272">n</span><span class="op" id="3628273">.</span><span class="ident" id="3628274">IsUint</span>&nbsp;<span class="op" id="3628281">=</span>&nbsp;<span class="builtintype" id="3628283">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628290">n</span><span class="op" id="3628291">.</span><span class="ident" id="3628292">Uint64</span>&nbsp;<span class="op" id="3628299">=</span>&nbsp;<span class="ident" id="3628301">u</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628307">i</span><span class="op" id="3628308">,</span>&nbsp;<span class="ident" id="3628310">err</span>&nbsp;<span class="op" id="3628314">:=</span>&nbsp;<span class="ident" id="3628317">strconv</span><span class="op" id="3628324">.</span><span class="ident" id="3628325">ParseInt</span><span class="op" id="3628333">(</span><span class="ident" id="3628334">text</span><span class="op" id="3628338">,</span>&nbsp;<span class="num" id="3628340">0</span><span class="op" id="3628341">,</span>&nbsp;<span class="num" id="3628343">64</span><span class="op" id="3628345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628348">if</span>&nbsp;<span class="ident" id="3628351">err</span>&nbsp;<span class="op" id="3628355">==</span>&nbsp;<span class="builtintype" id="3628358">nil</span>&nbsp;<span class="op" id="3628362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628366">n</span><span class="op" id="3628367">.</span><span class="ident" id="3628368">IsInt</span>&nbsp;<span class="op" id="3628374">=</span>&nbsp;<span class="builtintype" id="3628376">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628383">n</span><span class="op" id="3628384">.</span><span class="ident" id="3628385">Int64</span>&nbsp;<span class="op" id="3628391">=</span>&nbsp;<span class="ident" id="3628393">i</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628397">if</span>&nbsp;<span class="ident" id="3628400">i</span>&nbsp;<span class="op" id="3628402">==</span>&nbsp;<span class="num" id="3628405">0</span>&nbsp;<span class="op" id="3628407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628412">n</span><span class="op" id="3628413">.</span><span class="ident" id="3628414">IsUint</span>&nbsp;<span class="op" id="3628421">=</span>&nbsp;<span class="builtintype" id="3628423">true</span>&nbsp;<span class="comment" id="3628428">//&nbsp;in&nbsp;case&nbsp;of&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628449">n</span><span class="op" id="3628450">.</span><span class="ident" id="3628451">Uint64</span>&nbsp;<span class="op" id="3628458">=</span>&nbsp;<span class="ident" id="3628460">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628467">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3628470">//&nbsp;If&nbsp;an&nbsp;integer&nbsp;extraction&nbsp;succeeded,&nbsp;promote&nbsp;the&nbsp;float.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628529">if</span>&nbsp;<span class="ident" id="3628532">n</span><span class="op" id="3628533">.</span><span class="ident" id="3628534">IsInt</span>&nbsp;<span class="op" id="3628540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628544">n</span><span class="op" id="3628545">.</span><span class="ident" id="3628546">IsFloat</span>&nbsp;<span class="op" id="3628554">=</span>&nbsp;<span class="builtintype" id="3628556">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628563">n</span><span class="op" id="3628564">.</span><span class="ident" id="3628565">Float64</span>&nbsp;<span class="op" id="3628573">=</span>&nbsp;<span class="builtintype" id="3628575">float64</span><span class="op" id="3628582">(</span><span class="ident" id="3628583">n</span><span class="op" id="3628584">.</span><span class="ident" id="3628585">Int64</span><span class="op" id="3628590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628593">}</span>&nbsp;<span class="keyword" id="3628595">else</span>&nbsp;<span class="keyword" id="3628600">if</span>&nbsp;<span class="ident" id="3628603">n</span><span class="op" id="3628604">.</span><span class="ident" id="3628605">IsUint</span>&nbsp;<span class="op" id="3628612">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628616">n</span><span class="op" id="3628617">.</span><span class="ident" id="3628618">IsFloat</span>&nbsp;<span class="op" id="3628626">=</span>&nbsp;<span class="builtintype" id="3628628">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628635">n</span><span class="op" id="3628636">.</span><span class="ident" id="3628637">Float64</span>&nbsp;<span class="op" id="3628645">=</span>&nbsp;<span class="builtintype" id="3628647">float64</span><span class="op" id="3628654">(</span><span class="ident" id="3628655">n</span><span class="op" id="3628656">.</span><span class="ident" id="3628657">Uint64</span><span class="op" id="3628663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628666">}</span>&nbsp;<span class="keyword" id="3628668">else</span>&nbsp;<span class="op" id="3628673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628677">f</span><span class="op" id="3628678">,</span>&nbsp;<span class="ident" id="3628680">err</span>&nbsp;<span class="op" id="3628684">:=</span>&nbsp;<span class="ident" id="3628687">strconv</span><span class="op" id="3628694">.</span><span class="ident" id="3628695">ParseFloat</span><span class="op" id="3628705">(</span><span class="ident" id="3628706">text</span><span class="op" id="3628710">,</span>&nbsp;<span class="num" id="3628712">64</span><span class="op" id="3628714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628718">if</span>&nbsp;<span class="ident" id="3628721">err</span>&nbsp;<span class="op" id="3628725">==</span>&nbsp;<span class="builtintype" id="3628728">nil</span>&nbsp;<span class="op" id="3628732">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628737">n</span><span class="op" id="3628738">.</span><span class="ident" id="3628739">IsFloat</span>&nbsp;<span class="op" id="3628747">=</span>&nbsp;<span class="builtintype" id="3628749">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628757">n</span><span class="op" id="3628758">.</span><span class="ident" id="3628759">Float64</span>&nbsp;<span class="op" id="3628767">=</span>&nbsp;<span class="ident" id="3628769">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3628774">//&nbsp;If&nbsp;a&nbsp;floating-point&nbsp;extraction&nbsp;succeeded,&nbsp;extract&nbsp;the&nbsp;int&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628849">if</span>&nbsp;<span class="op" id="3628852">!</span><span class="ident" id="3628853">n</span><span class="op" id="3628854">.</span><span class="ident" id="3628855">IsInt</span>&nbsp;<span class="op" id="3628861">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3628864">float64</span><span class="op" id="3628871">(</span><span class="ident" id="3628872">int64</span><span class="op" id="3628877">(</span><span class="ident" id="3628878">f</span><span class="op" id="3628879">)</span><span class="op" id="3628880">)</span>&nbsp;<span class="op" id="3628882">==</span>&nbsp;<span class="ident" id="3628885">f</span>&nbsp;<span class="op" id="3628887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628893">n</span><span class="op" id="3628894">.</span><span class="ident" id="3628895">IsInt</span>&nbsp;<span class="op" id="3628901">=</span>&nbsp;<span class="builtintype" id="3628903">true</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628912">n</span><span class="op" id="3628913">.</span><span class="ident" id="3628914">Int64</span>&nbsp;<span class="op" id="3628920">=</span>&nbsp;<span class="ident" id="3628922">int64</span><span class="op" id="3628927">(</span><span class="ident" id="3628928">f</span><span class="op" id="3628929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628939">if</span>&nbsp;<span class="op" id="3628942">!</span><span class="ident" id="3628943">n</span><span class="op" id="3628944">.</span><span class="ident" id="3628945">IsUint</span>&nbsp;<span class="op" id="3628952">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3628955">float64</span><span class="op" id="3628962">(</span><span class="ident" id="3628963">uint64</span><span class="op" id="3628969">(</span><span class="ident" id="3628970">f</span><span class="op" id="3628971">)</span><span class="op" id="3628972">)</span>&nbsp;<span class="op" id="3628974">==</span>&nbsp;<span class="ident" id="3628977">f</span>&nbsp;<span class="op" id="3628979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628985">n</span><span class="op" id="3628986">.</span><span class="ident" id="3628987">IsUint</span>&nbsp;<span class="op" id="3628994">=</span>&nbsp;<span class="builtintype" id="3628996">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629005">n</span><span class="op" id="3629006">.</span><span class="ident" id="3629007">Uint64</span>&nbsp;<span class="op" id="3629014">=</span>&nbsp;<span class="ident" id="3629016">uint64</span><span class="op" id="3629022">(</span><span class="ident" id="3629023">f</span><span class="op" id="3629024">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629039">if</span>&nbsp;<span class="op" id="3629042">!</span><span class="ident" id="3629043">n</span><span class="op" id="3629044">.</span><span class="ident" id="3629045">IsInt</span>&nbsp;<span class="op" id="3629051">&amp;&amp;</span>&nbsp;<span class="op" id="3629054">!</span><span class="ident" id="3629055">n</span><span class="op" id="3629056">.</span><span class="ident" id="3629057">IsUint</span>&nbsp;<span class="op" id="3629064">&amp;&amp;</span>&nbsp;<span class="op" id="3629067">!</span><span class="ident" id="3629068">n</span><span class="op" id="3629069">.</span><span class="ident" id="3629070">IsFloat</span>&nbsp;<span class="op" id="3629078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629082">return</span>&nbsp;<span class="builtintype" id="3629089">nil</span><span class="op" id="3629092">,</span>&nbsp;<span class="ident" id="3629094">fmt</span><span class="op" id="3629097">.</span><span class="ident" id="3629098">Errorf</span><span class="op" id="3629104">(</span><span class="string" id="3629105">&#34;illegal&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="3629132">,</span>&nbsp;<span class="ident" id="3629134">text</span><span class="op" id="3629138">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629144">return</span>&nbsp;<span class="ident" id="3629151">n</span><span class="op" id="3629152">,</span>&nbsp;<span class="builtintype" id="3629154">nil</span><br>
<span class="lineno"></span><span class="op" id="3629158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3629161">//&nbsp;simplifyComplex&nbsp;pulls&nbsp;out&nbsp;any&nbsp;other&nbsp;types&nbsp;that&nbsp;are&nbsp;represented&nbsp;by&nbsp;the&nbsp;complex&nbsp;number.</span><br>
<span class="lineno">615</span><span class="comment" id="3629250">//&nbsp;These&nbsp;all&nbsp;require&nbsp;that&nbsp;the&nbsp;imaginary&nbsp;part&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="3629304">func</span>&nbsp;<span class="op" id="3629309">(</span><span class="ident" id="3629310">n</span>&nbsp;<span class="op" id="3629312">*</span><span class="ident" id="3629313">NumberNode</span><span class="op" id="3629323">)</span>&nbsp;<span class="ident" id="3629325">simplifyComplex</span><span class="op" id="3629340">(</span><span class="op" id="3629341">)</span>&nbsp;<span class="op" id="3629343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629346">n</span><span class="op" id="3629347">.</span><span class="ident" id="3629348">IsFloat</span>&nbsp;<span class="op" id="3629356">=</span>&nbsp;<span class="builtinfunc" id="3629358">imag</span><span class="op" id="3629362">(</span><span class="ident" id="3629363">n</span><span class="op" id="3629364">.</span><span class="ident" id="3629365">Complex128</span><span class="op" id="3629375">)</span>&nbsp;<span class="op" id="3629377">==</span>&nbsp;<span class="num" id="3629380">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629383">if</span>&nbsp;<span class="ident" id="3629386">n</span><span class="op" id="3629387">.</span><span class="ident" id="3629388">IsFloat</span>&nbsp;<span class="op" id="3629396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629400">n</span><span class="op" id="3629401">.</span><span class="ident" id="3629402">Float64</span>&nbsp;<span class="op" id="3629410">=</span>&nbsp;<span class="builtinfunc" id="3629412">real</span><span class="op" id="3629416">(</span><span class="ident" id="3629417">n</span><span class="op" id="3629418">.</span><span class="ident" id="3629419">Complex128</span><span class="op" id="3629429">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629433">n</span><span class="op" id="3629434">.</span><span class="ident" id="3629435">IsInt</span>&nbsp;<span class="op" id="3629441">=</span>&nbsp;<span class="builtintype" id="3629443">float64</span><span class="op" id="3629450">(</span><span class="ident" id="3629451">int64</span><span class="op" id="3629456">(</span><span class="ident" id="3629457">n</span><span class="op" id="3629458">.</span><span class="ident" id="3629459">Float64</span><span class="op" id="3629466">)</span><span class="op" id="3629467">)</span>&nbsp;<span class="op" id="3629469">==</span>&nbsp;<span class="ident" id="3629472">n</span><span class="op" id="3629473">.</span><span class="ident" id="3629474">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629484">if</span>&nbsp;<span class="ident" id="3629487">n</span><span class="op" id="3629488">.</span><span class="ident" id="3629489">IsInt</span>&nbsp;<span class="op" id="3629495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629500">n</span><span class="op" id="3629501">.</span><span class="ident" id="3629502">Int64</span>&nbsp;<span class="op" id="3629508">=</span>&nbsp;<span class="ident" id="3629510">int64</span><span class="op" id="3629515">(</span><span class="ident" id="3629516">n</span><span class="op" id="3629517">.</span><span class="ident" id="3629518">Float64</span><span class="op" id="3629525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629533">n</span><span class="op" id="3629534">.</span><span class="ident" id="3629535">IsUint</span>&nbsp;<span class="op" id="3629542">=</span>&nbsp;<span class="builtintype" id="3629544">float64</span><span class="op" id="3629551">(</span><span class="ident" id="3629552">uint64</span><span class="op" id="3629558">(</span><span class="ident" id="3629559">n</span><span class="op" id="3629560">.</span><span class="ident" id="3629561">Float64</span><span class="op" id="3629568">)</span><span class="op" id="3629569">)</span>&nbsp;<span class="op" id="3629571">==</span>&nbsp;<span class="ident" id="3629574">n</span><span class="op" id="3629575">.</span><span class="ident" id="3629576">Float64</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629586">if</span>&nbsp;<span class="ident" id="3629589">n</span><span class="op" id="3629590">.</span><span class="ident" id="3629591">IsUint</span>&nbsp;<span class="op" id="3629598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629603">n</span><span class="op" id="3629604">.</span><span class="ident" id="3629605">Uint64</span>&nbsp;<span class="op" id="3629612">=</span>&nbsp;<span class="ident" id="3629614">uint64</span><span class="op" id="3629620">(</span><span class="ident" id="3629621">n</span><span class="op" id="3629622">.</span><span class="ident" id="3629623">Float64</span><span class="op" id="3629630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629637">}</span><br>
<span class="lineno"></span><span class="op" id="3629639">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="3629642">func</span>&nbsp;<span class="op" id="3629647">(</span><span class="ident" id="3629648">n</span>&nbsp;<span class="op" id="3629650">*</span><span class="ident" id="3629651">NumberNode</span><span class="op" id="3629661">)</span>&nbsp;<span class="ident" id="3629663">String</span><span class="op" id="3629669">(</span><span class="op" id="3629670">)</span>&nbsp;<span class="builtintype" id="3629672">string</span>&nbsp;<span class="op" id="3629679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629682">return</span>&nbsp;<span class="ident" id="3629689">n</span><span class="op" id="3629690">.</span><span class="ident" id="3629691">Text</span><br>
<span class="lineno"></span><span class="op" id="3629696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span><span class="keyword" id="3629699">func</span>&nbsp;<span class="op" id="3629704">(</span><span class="ident" id="3629705">n</span>&nbsp;<span class="op" id="3629707">*</span><span class="ident" id="3629708">NumberNode</span><span class="op" id="3629718">)</span>&nbsp;<span class="ident" id="3629720">tree</span><span class="op" id="3629724">(</span><span class="op" id="3629725">)</span>&nbsp;<span class="op" id="3629727">*</span><span class="ident" id="3629728">Tree</span>&nbsp;<span class="op" id="3629733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629736">return</span>&nbsp;<span class="ident" id="3629743">n</span><span class="op" id="3629744">.</span><span class="ident" id="3629745">tr</span><br>
<span class="lineno"></span><span class="op" id="3629748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3629751">func</span>&nbsp;<span class="op" id="3629756">(</span><span class="ident" id="3629757">n</span>&nbsp;<span class="op" id="3629759">*</span><span class="ident" id="3629760">NumberNode</span><span class="op" id="3629770">)</span>&nbsp;<span class="ident" id="3629772">Copy</span><span class="op" id="3629776">(</span><span class="op" id="3629777">)</span>&nbsp;<span class="ident" id="3629779">Node</span>&nbsp;<span class="op" id="3629784">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629787">nn</span>&nbsp;<span class="op" id="3629790">:=</span>&nbsp;<span class="builtinfunc" id="3629793">new</span><span class="op" id="3629796">(</span><span class="ident" id="3629797">NumberNode</span><span class="op" id="3629807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629810">*</span><span class="ident" id="3629811">nn</span>&nbsp;<span class="op" id="3629814">=</span>&nbsp;<span class="op" id="3629816">*</span><span class="ident" id="3629817">n</span>&nbsp;<span class="comment" id="3629819">//&nbsp;Easy,&nbsp;fast,&nbsp;correct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629844">return</span>&nbsp;<span class="ident" id="3629851">nn</span><br>
<span class="lineno"></span><span class="op" id="3629854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span><span class="comment" id="3629857">//&nbsp;StringNode&nbsp;holds&nbsp;a&nbsp;string&nbsp;constant.&nbsp;The&nbsp;value&nbsp;has&nbsp;been&nbsp;&#34;unquoted&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3629927">type</span>&nbsp;<span class="ident" id="3629932">StringNode</span>&nbsp;<span class="keyword" id="3629943">struct</span>&nbsp;<span class="op" id="3629950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629953">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629963">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629968">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629975">*</span><span class="ident" id="3629976">Tree</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629982">Quoted</span>&nbsp;<span class="builtintype" id="3629989">string</span>&nbsp;<span class="comment" id="3629996">//&nbsp;The&nbsp;original&nbsp;text&nbsp;of&nbsp;the&nbsp;string,&nbsp;with&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630046">Text</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3630053">string</span>&nbsp;<span class="comment" id="3630060">//&nbsp;The&nbsp;string,&nbsp;after&nbsp;quote&nbsp;processing.</span><br>
<span class="lineno"></span><span class="op" id="3630099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3630102">func</span>&nbsp;<span class="op" id="3630107">(</span><span class="ident" id="3630108">t</span>&nbsp;<span class="op" id="3630110">*</span><span class="ident" id="3630111">Tree</span><span class="op" id="3630115">)</span>&nbsp;<span class="ident" id="3630117">newString</span><span class="op" id="3630126">(</span><span class="ident" id="3630127">pos</span>&nbsp;<span class="ident" id="3630131">Pos</span><span class="op" id="3630134">,</span>&nbsp;<span class="ident" id="3630136">orig</span><span class="op" id="3630140">,</span>&nbsp;<span class="ident" id="3630142">text</span>&nbsp;<span class="builtintype" id="3630147">string</span><span class="op" id="3630153">)</span>&nbsp;<span class="op" id="3630155">*</span><span class="ident" id="3630156">StringNode</span>&nbsp;<span class="op" id="3630167">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630170">return</span>&nbsp;<span class="op" id="3630177">&amp;</span><span class="ident" id="3630178">StringNode</span><span class="op" id="3630188">{</span><span class="ident" id="3630189">tr</span><span class="op" id="3630191">:</span>&nbsp;<span class="ident" id="3630193">t</span><span class="op" id="3630194">,</span>&nbsp;<span class="ident" id="3630196">NodeType</span><span class="op" id="3630204">:</span>&nbsp;<span class="ident" id="3630206">NodeString</span><span class="op" id="3630216">,</span>&nbsp;<span class="ident" id="3630218">Pos</span><span class="op" id="3630221">:</span>&nbsp;<span class="ident" id="3630223">pos</span><span class="op" id="3630226">,</span>&nbsp;<span class="ident" id="3630228">Quoted</span><span class="op" id="3630234">:</span>&nbsp;<span class="ident" id="3630236">orig</span><span class="op" id="3630240">,</span>&nbsp;<span class="ident" id="3630242">Text</span><span class="op" id="3630246">:</span>&nbsp;<span class="ident" id="3630248">text</span><span class="op" id="3630252">}</span><br>
<span class="lineno"></span><span class="op" id="3630254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3630257">func</span>&nbsp;<span class="op" id="3630262">(</span><span class="ident" id="3630263">s</span>&nbsp;<span class="op" id="3630265">*</span><span class="ident" id="3630266">StringNode</span><span class="op" id="3630276">)</span>&nbsp;<span class="ident" id="3630278">String</span><span class="op" id="3630284">(</span><span class="op" id="3630285">)</span>&nbsp;<span class="builtintype" id="3630287">string</span>&nbsp;<span class="op" id="3630294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630297">return</span>&nbsp;<span class="ident" id="3630304">s</span><span class="op" id="3630305">.</span><span class="ident" id="3630306">Quoted</span><br>
<span class="lineno">660</span><span class="op" id="3630313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3630316">func</span>&nbsp;<span class="op" id="3630321">(</span><span class="ident" id="3630322">s</span>&nbsp;<span class="op" id="3630324">*</span><span class="ident" id="3630325">StringNode</span><span class="op" id="3630335">)</span>&nbsp;<span class="ident" id="3630337">tree</span><span class="op" id="3630341">(</span><span class="op" id="3630342">)</span>&nbsp;<span class="op" id="3630344">*</span><span class="ident" id="3630345">Tree</span>&nbsp;<span class="op" id="3630350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630353">return</span>&nbsp;<span class="ident" id="3630360">s</span><span class="op" id="3630361">.</span><span class="ident" id="3630362">tr</span><br>
<span class="lineno"></span><span class="op" id="3630365">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="keyword" id="3630368">func</span>&nbsp;<span class="op" id="3630373">(</span><span class="ident" id="3630374">s</span>&nbsp;<span class="op" id="3630376">*</span><span class="ident" id="3630377">StringNode</span><span class="op" id="3630387">)</span>&nbsp;<span class="ident" id="3630389">Copy</span><span class="op" id="3630393">(</span><span class="op" id="3630394">)</span>&nbsp;<span class="ident" id="3630396">Node</span>&nbsp;<span class="op" id="3630401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630404">return</span>&nbsp;<span class="ident" id="3630411">s</span><span class="op" id="3630412">.</span><span class="ident" id="3630413">tr</span><span class="op" id="3630415">.</span><span class="ident" id="3630416">newString</span><span class="op" id="3630425">(</span><span class="ident" id="3630426">s</span><span class="op" id="3630427">.</span><span class="ident" id="3630428">Pos</span><span class="op" id="3630431">,</span>&nbsp;<span class="ident" id="3630433">s</span><span class="op" id="3630434">.</span><span class="ident" id="3630435">Quoted</span><span class="op" id="3630441">,</span>&nbsp;<span class="ident" id="3630443">s</span><span class="op" id="3630444">.</span><span class="ident" id="3630445">Text</span><span class="op" id="3630449">)</span><br>
<span class="lineno"></span><span class="op" id="3630451">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="3630454">//&nbsp;endNode&nbsp;represents&nbsp;an&nbsp;{{end}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="comment" id="3630495">//&nbsp;It&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span><span class="keyword" id="3630542">type</span>&nbsp;<span class="ident" id="3630547">endNode</span>&nbsp;<span class="keyword" id="3630555">struct</span>&nbsp;<span class="op" id="3630562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630565">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630575">Pos</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630580">tr</span>&nbsp;<span class="op" id="3630583">*</span><span class="ident" id="3630584">Tree</span><br>
<span class="lineno"></span><span class="op" id="3630589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3630592">func</span>&nbsp;<span class="op" id="3630597">(</span><span class="ident" id="3630598">t</span>&nbsp;<span class="op" id="3630600">*</span><span class="ident" id="3630601">Tree</span><span class="op" id="3630605">)</span>&nbsp;<span class="ident" id="3630607">newEnd</span><span class="op" id="3630613">(</span><span class="ident" id="3630614">pos</span>&nbsp;<span class="ident" id="3630618">Pos</span><span class="op" id="3630621">)</span>&nbsp;<span class="op" id="3630623">*</span><span class="ident" id="3630624">endNode</span>&nbsp;<span class="op" id="3630632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630635">return</span>&nbsp;<span class="op" id="3630642">&amp;</span><span class="ident" id="3630643">endNode</span><span class="op" id="3630650">{</span><span class="ident" id="3630651">tr</span><span class="op" id="3630653">:</span>&nbsp;<span class="ident" id="3630655">t</span><span class="op" id="3630656">,</span>&nbsp;<span class="ident" id="3630658">NodeType</span><span class="op" id="3630666">:</span>&nbsp;<span class="ident" id="3630668">nodeEnd</span><span class="op" id="3630675">,</span>&nbsp;<span class="ident" id="3630677">Pos</span><span class="op" id="3630680">:</span>&nbsp;<span class="ident" id="3630682">pos</span><span class="op" id="3630685">}</span><br>
<span class="lineno">680</span><span class="op" id="3630687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3630690">func</span>&nbsp;<span class="op" id="3630695">(</span><span class="ident" id="3630696">e</span>&nbsp;<span class="op" id="3630698">*</span><span class="ident" id="3630699">endNode</span><span class="op" id="3630706">)</span>&nbsp;<span class="ident" id="3630708">String</span><span class="op" id="3630714">(</span><span class="op" id="3630715">)</span>&nbsp;<span class="builtintype" id="3630717">string</span>&nbsp;<span class="op" id="3630724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630727">return</span>&nbsp;<span class="string" id="3630734">&#34;{{end}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="3630744">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="3630747">func</span>&nbsp;<span class="op" id="3630752">(</span><span class="ident" id="3630753">e</span>&nbsp;<span class="op" id="3630755">*</span><span class="ident" id="3630756">endNode</span><span class="op" id="3630763">)</span>&nbsp;<span class="ident" id="3630765">tree</span><span class="op" id="3630769">(</span><span class="op" id="3630770">)</span>&nbsp;<span class="op" id="3630772">*</span><span class="ident" id="3630773">Tree</span>&nbsp;<span class="op" id="3630778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630781">return</span>&nbsp;<span class="ident" id="3630788">e</span><span class="op" id="3630789">.</span><span class="ident" id="3630790">tr</span><br>
<span class="lineno"></span><span class="op" id="3630793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="3630796">func</span>&nbsp;<span class="op" id="3630801">(</span><span class="ident" id="3630802">e</span>&nbsp;<span class="op" id="3630804">*</span><span class="ident" id="3630805">endNode</span><span class="op" id="3630812">)</span>&nbsp;<span class="ident" id="3630814">Copy</span><span class="op" id="3630818">(</span><span class="op" id="3630819">)</span>&nbsp;<span class="ident" id="3630821">Node</span>&nbsp;<span class="op" id="3630826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630829">return</span>&nbsp;<span class="ident" id="3630836">e</span><span class="op" id="3630837">.</span><span class="ident" id="3630838">tr</span><span class="op" id="3630840">.</span><span class="ident" id="3630841">newEnd</span><span class="op" id="3630847">(</span><span class="ident" id="3630848">e</span><span class="op" id="3630849">.</span><span class="ident" id="3630850">Pos</span><span class="op" id="3630853">)</span><br>
<span class="lineno"></span><span class="op" id="3630855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3630858">//&nbsp;elseNode&nbsp;represents&nbsp;an&nbsp;{{else}}&nbsp;action.&nbsp;Does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;tree.</span><br>
<span class="lineno">695</span><span class="keyword" id="3630936">type</span>&nbsp;<span class="ident" id="3630941">elseNode</span>&nbsp;<span class="keyword" id="3630950">struct</span>&nbsp;<span class="op" id="3630957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630960">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630970">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630975">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3630980">*</span><span class="ident" id="3630981">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630987">Line</span>&nbsp;<span class="builtintype" id="3630992">int</span>&nbsp;<span class="comment" id="3630996">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno">700</span><span class="op" id="3631065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3631068">func</span>&nbsp;<span class="op" id="3631073">(</span><span class="ident" id="3631074">t</span>&nbsp;<span class="op" id="3631076">*</span><span class="ident" id="3631077">Tree</span><span class="op" id="3631081">)</span>&nbsp;<span class="ident" id="3631083">newElse</span><span class="op" id="3631090">(</span><span class="ident" id="3631091">pos</span>&nbsp;<span class="ident" id="3631095">Pos</span><span class="op" id="3631098">,</span>&nbsp;<span class="ident" id="3631100">line</span>&nbsp;<span class="builtintype" id="3631105">int</span><span class="op" id="3631108">)</span>&nbsp;<span class="op" id="3631110">*</span><span class="ident" id="3631111">elseNode</span>&nbsp;<span class="op" id="3631120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631123">return</span>&nbsp;<span class="op" id="3631130">&amp;</span><span class="ident" id="3631131">elseNode</span><span class="op" id="3631139">{</span><span class="ident" id="3631140">tr</span><span class="op" id="3631142">:</span>&nbsp;<span class="ident" id="3631144">t</span><span class="op" id="3631145">,</span>&nbsp;<span class="ident" id="3631147">NodeType</span><span class="op" id="3631155">:</span>&nbsp;<span class="ident" id="3631157">nodeElse</span><span class="op" id="3631165">,</span>&nbsp;<span class="ident" id="3631167">Pos</span><span class="op" id="3631170">:</span>&nbsp;<span class="ident" id="3631172">pos</span><span class="op" id="3631175">,</span>&nbsp;<span class="ident" id="3631177">Line</span><span class="op" id="3631181">:</span>&nbsp;<span class="ident" id="3631183">line</span><span class="op" id="3631187">}</span><br>
<span class="lineno"></span><span class="op" id="3631189">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="3631192">func</span>&nbsp;<span class="op" id="3631197">(</span><span class="ident" id="3631198">e</span>&nbsp;<span class="op" id="3631200">*</span><span class="ident" id="3631201">elseNode</span><span class="op" id="3631209">)</span>&nbsp;<span class="ident" id="3631211">Type</span><span class="op" id="3631215">(</span><span class="op" id="3631216">)</span>&nbsp;<span class="ident" id="3631218">NodeType</span>&nbsp;<span class="op" id="3631227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631230">return</span>&nbsp;<span class="ident" id="3631237">nodeElse</span><br>
<span class="lineno"></span><span class="op" id="3631246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="3631249">func</span>&nbsp;<span class="op" id="3631254">(</span><span class="ident" id="3631255">e</span>&nbsp;<span class="op" id="3631257">*</span><span class="ident" id="3631258">elseNode</span><span class="op" id="3631266">)</span>&nbsp;<span class="ident" id="3631268">String</span><span class="op" id="3631274">(</span><span class="op" id="3631275">)</span>&nbsp;<span class="builtintype" id="3631277">string</span>&nbsp;<span class="op" id="3631284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631287">return</span>&nbsp;<span class="string" id="3631294">&#34;{{else}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="3631305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3631308">func</span>&nbsp;<span class="op" id="3631313">(</span><span class="ident" id="3631314">e</span>&nbsp;<span class="op" id="3631316">*</span><span class="ident" id="3631317">elseNode</span><span class="op" id="3631325">)</span>&nbsp;<span class="ident" id="3631327">tree</span><span class="op" id="3631331">(</span><span class="op" id="3631332">)</span>&nbsp;<span class="op" id="3631334">*</span><span class="ident" id="3631335">Tree</span>&nbsp;<span class="op" id="3631340">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631343">return</span>&nbsp;<span class="ident" id="3631350">e</span><span class="op" id="3631351">.</span><span class="ident" id="3631352">tr</span><br>
<span class="lineno"></span><span class="op" id="3631355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3631358">func</span>&nbsp;<span class="op" id="3631363">(</span><span class="ident" id="3631364">e</span>&nbsp;<span class="op" id="3631366">*</span><span class="ident" id="3631367">elseNode</span><span class="op" id="3631375">)</span>&nbsp;<span class="ident" id="3631377">Copy</span><span class="op" id="3631381">(</span><span class="op" id="3631382">)</span>&nbsp;<span class="ident" id="3631384">Node</span>&nbsp;<span class="op" id="3631389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631392">return</span>&nbsp;<span class="ident" id="3631399">e</span><span class="op" id="3631400">.</span><span class="ident" id="3631401">tr</span><span class="op" id="3631403">.</span><span class="ident" id="3631404">newElse</span><span class="op" id="3631411">(</span><span class="ident" id="3631412">e</span><span class="op" id="3631413">.</span><span class="ident" id="3631414">Pos</span><span class="op" id="3631417">,</span>&nbsp;<span class="ident" id="3631419">e</span><span class="op" id="3631420">.</span><span class="ident" id="3631421">Line</span><span class="op" id="3631425">)</span><br>
<span class="lineno">720</span><span class="op" id="3631427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3631430">//&nbsp;BranchNode&nbsp;is&nbsp;the&nbsp;common&nbsp;representation&nbsp;of&nbsp;if,&nbsp;range,&nbsp;and&nbsp;with.</span><br>
<span class="lineno"></span><span class="keyword" id="3631497">type</span>&nbsp;<span class="ident" id="3631502">BranchNode</span>&nbsp;<span class="keyword" id="3631513">struct</span>&nbsp;<span class="op" id="3631520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631523">NodeType</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631533">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631538">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3631547">*</span><span class="ident" id="3631548">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631554">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3631563">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3631573">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631643">Pipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3631652">*</span><span class="ident" id="3631653">PipeNode</span>&nbsp;<span class="comment" id="3631662">//&nbsp;The&nbsp;pipeline&nbsp;to&nbsp;be&nbsp;evaluated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631696">List</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3631705">*</span><span class="ident" id="3631706">ListNode</span>&nbsp;<span class="comment" id="3631715">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;non-empty.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631762">ElseList</span>&nbsp;<span class="op" id="3631771">*</span><span class="ident" id="3631772">ListNode</span>&nbsp;<span class="comment" id="3631781">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;empty&nbsp;(nil&nbsp;if&nbsp;absent).</span><br>
<span class="lineno"></span><span class="op" id="3631839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3631842">func</span>&nbsp;<span class="op" id="3631847">(</span><span class="ident" id="3631848">b</span>&nbsp;<span class="op" id="3631850">*</span><span class="ident" id="3631851">BranchNode</span><span class="op" id="3631861">)</span>&nbsp;<span class="ident" id="3631863">String</span><span class="op" id="3631869">(</span><span class="op" id="3631870">)</span>&nbsp;<span class="builtintype" id="3631872">string</span>&nbsp;<span class="op" id="3631879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631882">name</span>&nbsp;<span class="op" id="3631887">:=</span>&nbsp;<span class="string" id="3631890">&#34;&#34;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631894">switch</span>&nbsp;<span class="ident" id="3631901">b</span><span class="op" id="3631902">.</span><span class="ident" id="3631903">NodeType</span>&nbsp;<span class="op" id="3631912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631915">case</span>&nbsp;<span class="ident" id="3631920">NodeIf</span><span class="op" id="3631926">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631930">name</span>&nbsp;<span class="op" id="3631935">=</span>&nbsp;<span class="string" id="3631937">&#34;if&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631943">case</span>&nbsp;<span class="ident" id="3631948">NodeRange</span><span class="op" id="3631957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631961">name</span>&nbsp;<span class="op" id="3631966">=</span>&nbsp;<span class="string" id="3631968">&#34;range&#34;</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631977">case</span>&nbsp;<span class="ident" id="3631982">NodeWith</span><span class="op" id="3631990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631994">name</span>&nbsp;<span class="op" id="3631999">=</span>&nbsp;<span class="string" id="3632001">&#34;with&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632009">default</span><span class="op" id="3632016">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3632020">panic</span><span class="op" id="3632025">(</span><span class="string" id="3632026">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="3632047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632050">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632053">if</span>&nbsp;<span class="ident" id="3632056">b</span><span class="op" id="3632057">.</span><span class="ident" id="3632058">ElseList</span>&nbsp;<span class="op" id="3632067">!=</span>&nbsp;<span class="builtintype" id="3632070">nil</span>&nbsp;<span class="op" id="3632074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632078">return</span>&nbsp;<span class="ident" id="3632085">fmt</span><span class="op" id="3632088">.</span><span class="ident" id="3632089">Sprintf</span><span class="op" id="3632096">(</span><span class="string" id="3632097">&#34;{{%s&nbsp;%s}}%s{{else}}%s{{end}}&#34;</span><span class="op" id="3632127">,</span>&nbsp;<span class="ident" id="3632129">name</span><span class="op" id="3632133">,</span>&nbsp;<span class="ident" id="3632135">b</span><span class="op" id="3632136">.</span><span class="ident" id="3632137">Pipe</span><span class="op" id="3632141">,</span>&nbsp;<span class="ident" id="3632143">b</span><span class="op" id="3632144">.</span><span class="ident" id="3632145">List</span><span class="op" id="3632149">,</span>&nbsp;<span class="ident" id="3632151">b</span><span class="op" id="3632152">.</span><span class="ident" id="3632153">ElseList</span><span class="op" id="3632161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632167">return</span>&nbsp;<span class="ident" id="3632174">fmt</span><span class="op" id="3632177">.</span><span class="ident" id="3632178">Sprintf</span><span class="op" id="3632185">(</span><span class="string" id="3632186">&#34;{{%s&nbsp;%s}}%s{{end}}&#34;</span><span class="op" id="3632206">,</span>&nbsp;<span class="ident" id="3632208">name</span><span class="op" id="3632212">,</span>&nbsp;<span class="ident" id="3632214">b</span><span class="op" id="3632215">.</span><span class="ident" id="3632216">Pipe</span><span class="op" id="3632220">,</span>&nbsp;<span class="ident" id="3632222">b</span><span class="op" id="3632223">.</span><span class="ident" id="3632224">List</span><span class="op" id="3632228">)</span><br>
<span class="lineno"></span><span class="op" id="3632230">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="keyword" id="3632233">func</span>&nbsp;<span class="op" id="3632238">(</span><span class="ident" id="3632239">b</span>&nbsp;<span class="op" id="3632241">*</span><span class="ident" id="3632242">BranchNode</span><span class="op" id="3632252">)</span>&nbsp;<span class="ident" id="3632254">tree</span><span class="op" id="3632258">(</span><span class="op" id="3632259">)</span>&nbsp;<span class="op" id="3632261">*</span><span class="ident" id="3632262">Tree</span>&nbsp;<span class="op" id="3632267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632270">return</span>&nbsp;<span class="ident" id="3632277">b</span><span class="op" id="3632278">.</span><span class="ident" id="3632279">tr</span><br>
<span class="lineno"></span><span class="op" id="3632282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="keyword" id="3632285">func</span>&nbsp;<span class="op" id="3632290">(</span><span class="ident" id="3632291">b</span>&nbsp;<span class="op" id="3632293">*</span><span class="ident" id="3632294">BranchNode</span><span class="op" id="3632304">)</span>&nbsp;<span class="ident" id="3632306">Copy</span><span class="op" id="3632310">(</span><span class="op" id="3632311">)</span>&nbsp;<span class="ident" id="3632313">Node</span>&nbsp;<span class="op" id="3632318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632321">switch</span>&nbsp;<span class="ident" id="3632328">b</span><span class="op" id="3632329">.</span><span class="ident" id="3632330">NodeType</span>&nbsp;<span class="op" id="3632339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632342">case</span>&nbsp;<span class="ident" id="3632347">NodeIf</span><span class="op" id="3632353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632357">return</span>&nbsp;<span class="ident" id="3632364">b</span><span class="op" id="3632365">.</span><span class="ident" id="3632366">tr</span><span class="op" id="3632368">.</span><span class="ident" id="3632369">newIf</span><span class="op" id="3632374">(</span><span class="ident" id="3632375">b</span><span class="op" id="3632376">.</span><span class="ident" id="3632377">Pos</span><span class="op" id="3632380">,</span>&nbsp;<span class="ident" id="3632382">b</span><span class="op" id="3632383">.</span><span class="ident" id="3632384">Line</span><span class="op" id="3632388">,</span>&nbsp;<span class="ident" id="3632390">b</span><span class="op" id="3632391">.</span><span class="ident" id="3632392">Pipe</span><span class="op" id="3632396">,</span>&nbsp;<span class="ident" id="3632398">b</span><span class="op" id="3632399">.</span><span class="ident" id="3632400">List</span><span class="op" id="3632404">,</span>&nbsp;<span class="ident" id="3632406">b</span><span class="op" id="3632407">.</span><span class="ident" id="3632408">ElseList</span><span class="op" id="3632416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632419">case</span>&nbsp;<span class="ident" id="3632424">NodeRange</span><span class="op" id="3632433">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632437">return</span>&nbsp;<span class="ident" id="3632444">b</span><span class="op" id="3632445">.</span><span class="ident" id="3632446">tr</span><span class="op" id="3632448">.</span><span class="ident" id="3632449">newRange</span><span class="op" id="3632457">(</span><span class="ident" id="3632458">b</span><span class="op" id="3632459">.</span><span class="ident" id="3632460">Pos</span><span class="op" id="3632463">,</span>&nbsp;<span class="ident" id="3632465">b</span><span class="op" id="3632466">.</span><span class="ident" id="3632467">Line</span><span class="op" id="3632471">,</span>&nbsp;<span class="ident" id="3632473">b</span><span class="op" id="3632474">.</span><span class="ident" id="3632475">Pipe</span><span class="op" id="3632479">,</span>&nbsp;<span class="ident" id="3632481">b</span><span class="op" id="3632482">.</span><span class="ident" id="3632483">List</span><span class="op" id="3632487">,</span>&nbsp;<span class="ident" id="3632489">b</span><span class="op" id="3632490">.</span><span class="ident" id="3632491">ElseList</span><span class="op" id="3632499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632502">case</span>&nbsp;<span class="ident" id="3632507">NodeWith</span><span class="op" id="3632515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632519">return</span>&nbsp;<span class="ident" id="3632526">b</span><span class="op" id="3632527">.</span><span class="ident" id="3632528">tr</span><span class="op" id="3632530">.</span><span class="ident" id="3632531">newWith</span><span class="op" id="3632538">(</span><span class="ident" id="3632539">b</span><span class="op" id="3632540">.</span><span class="ident" id="3632541">Pos</span><span class="op" id="3632544">,</span>&nbsp;<span class="ident" id="3632546">b</span><span class="op" id="3632547">.</span><span class="ident" id="3632548">Line</span><span class="op" id="3632552">,</span>&nbsp;<span class="ident" id="3632554">b</span><span class="op" id="3632555">.</span><span class="ident" id="3632556">Pipe</span><span class="op" id="3632560">,</span>&nbsp;<span class="ident" id="3632562">b</span><span class="op" id="3632563">.</span><span class="ident" id="3632564">List</span><span class="op" id="3632568">,</span>&nbsp;<span class="ident" id="3632570">b</span><span class="op" id="3632571">.</span><span class="ident" id="3632572">ElseList</span><span class="op" id="3632580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632583">default</span><span class="op" id="3632590">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3632594">panic</span><span class="op" id="3632599">(</span><span class="string" id="3632600">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="3632621">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632624">}</span><br>
<span class="lineno"></span><span class="op" id="3632626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3632629">//&nbsp;IfNode&nbsp;represents&nbsp;an&nbsp;{{if}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="3632685">type</span>&nbsp;<span class="ident" id="3632690">IfNode</span>&nbsp;<span class="keyword" id="3632697">struct</span>&nbsp;<span class="op" id="3632704">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3632707">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3632718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3632721">func</span>&nbsp;<span class="op" id="3632726">(</span><span class="ident" id="3632727">t</span>&nbsp;<span class="op" id="3632729">*</span><span class="ident" id="3632730">Tree</span><span class="op" id="3632734">)</span>&nbsp;<span class="ident" id="3632736">newIf</span><span class="op" id="3632741">(</span><span class="ident" id="3632742">pos</span>&nbsp;<span class="ident" id="3632746">Pos</span><span class="op" id="3632749">,</span>&nbsp;<span class="ident" id="3632751">line</span>&nbsp;<span class="builtintype" id="3632756">int</span><span class="op" id="3632759">,</span>&nbsp;<span class="ident" id="3632761">pipe</span>&nbsp;<span class="op" id="3632766">*</span><span class="ident" id="3632767">PipeNode</span><span class="op" id="3632775">,</span>&nbsp;<span class="ident" id="3632777">list</span><span class="op" id="3632781">,</span>&nbsp;<span class="ident" id="3632783">elseList</span>&nbsp;<span class="op" id="3632792">*</span><span class="ident" id="3632793">ListNode</span><span class="op" id="3632801">)</span>&nbsp;<span class="op" id="3632803">*</span><span class="ident" id="3632804">IfNode</span>&nbsp;<span class="op" id="3632811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632814">return</span>&nbsp;<span class="op" id="3632821">&amp;</span><span class="ident" id="3632822">IfNode</span><span class="op" id="3632828">{</span><span class="ident" id="3632829">BranchNode</span><span class="op" id="3632839">{</span><span class="ident" id="3632840">tr</span><span class="op" id="3632842">:</span>&nbsp;<span class="ident" id="3632844">t</span><span class="op" id="3632845">,</span>&nbsp;<span class="ident" id="3632847">NodeType</span><span class="op" id="3632855">:</span>&nbsp;<span class="ident" id="3632857">NodeIf</span><span class="op" id="3632863">,</span>&nbsp;<span class="ident" id="3632865">Pos</span><span class="op" id="3632868">:</span>&nbsp;<span class="ident" id="3632870">pos</span><span class="op" id="3632873">,</span>&nbsp;<span class="ident" id="3632875">Line</span><span class="op" id="3632879">:</span>&nbsp;<span class="ident" id="3632881">line</span><span class="op" id="3632885">,</span>&nbsp;<span class="ident" id="3632887">Pipe</span><span class="op" id="3632891">:</span>&nbsp;<span class="ident" id="3632893">pipe</span><span class="op" id="3632897">,</span>&nbsp;<span class="ident" id="3632899">List</span><span class="op" id="3632903">:</span>&nbsp;<span class="ident" id="3632905">list</span><span class="op" id="3632909">,</span>&nbsp;<span class="ident" id="3632911">ElseList</span><span class="op" id="3632919">:</span>&nbsp;<span class="ident" id="3632921">elseList</span><span class="op" id="3632929">}</span><span class="op" id="3632930">}</span><br>
<span class="lineno">775</span><span class="op" id="3632932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3632935">func</span>&nbsp;<span class="op" id="3632940">(</span><span class="ident" id="3632941">i</span>&nbsp;<span class="op" id="3632943">*</span><span class="ident" id="3632944">IfNode</span><span class="op" id="3632950">)</span>&nbsp;<span class="ident" id="3632952">Copy</span><span class="op" id="3632956">(</span><span class="op" id="3632957">)</span>&nbsp;<span class="ident" id="3632959">Node</span>&nbsp;<span class="op" id="3632964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632967">return</span>&nbsp;<span class="ident" id="3632974">i</span><span class="op" id="3632975">.</span><span class="ident" id="3632976">tr</span><span class="op" id="3632978">.</span><span class="ident" id="3632979">newIf</span><span class="op" id="3632984">(</span><span class="ident" id="3632985">i</span><span class="op" id="3632986">.</span><span class="ident" id="3632987">Pos</span><span class="op" id="3632990">,</span>&nbsp;<span class="ident" id="3632992">i</span><span class="op" id="3632993">.</span><span class="ident" id="3632994">Line</span><span class="op" id="3632998">,</span>&nbsp;<span class="ident" id="3633000">i</span><span class="op" id="3633001">.</span><span class="ident" id="3633002">Pipe</span><span class="op" id="3633006">.</span><span class="ident" id="3633007">CopyPipe</span><span class="op" id="3633015">(</span><span class="op" id="3633016">)</span><span class="op" id="3633017">,</span>&nbsp;<span class="ident" id="3633019">i</span><span class="op" id="3633020">.</span><span class="ident" id="3633021">List</span><span class="op" id="3633025">.</span><span class="ident" id="3633026">CopyList</span><span class="op" id="3633034">(</span><span class="op" id="3633035">)</span><span class="op" id="3633036">,</span>&nbsp;<span class="ident" id="3633038">i</span><span class="op" id="3633039">.</span><span class="ident" id="3633040">ElseList</span><span class="op" id="3633048">.</span><span class="ident" id="3633049">CopyList</span><span class="op" id="3633057">(</span><span class="op" id="3633058">)</span><span class="op" id="3633059">)</span><br>
<span class="lineno"></span><span class="op" id="3633061">}</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span><span class="comment" id="3633064">//&nbsp;RangeNode&nbsp;represents&nbsp;a&nbsp;{{range}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="3633125">type</span>&nbsp;<span class="ident" id="3633130">RangeNode</span>&nbsp;<span class="keyword" id="3633140">struct</span>&nbsp;<span class="op" id="3633147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3633150">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3633161">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="keyword" id="3633164">func</span>&nbsp;<span class="op" id="3633169">(</span><span class="ident" id="3633170">t</span>&nbsp;<span class="op" id="3633172">*</span><span class="ident" id="3633173">Tree</span><span class="op" id="3633177">)</span>&nbsp;<span class="ident" id="3633179">newRange</span><span class="op" id="3633187">(</span><span class="ident" id="3633188">pos</span>&nbsp;<span class="ident" id="3633192">Pos</span><span class="op" id="3633195">,</span>&nbsp;<span class="ident" id="3633197">line</span>&nbsp;<span class="builtintype" id="3633202">int</span><span class="op" id="3633205">,</span>&nbsp;<span class="ident" id="3633207">pipe</span>&nbsp;<span class="op" id="3633212">*</span><span class="ident" id="3633213">PipeNode</span><span class="op" id="3633221">,</span>&nbsp;<span class="ident" id="3633223">list</span><span class="op" id="3633227">,</span>&nbsp;<span class="ident" id="3633229">elseList</span>&nbsp;<span class="op" id="3633238">*</span><span class="ident" id="3633239">ListNode</span><span class="op" id="3633247">)</span>&nbsp;<span class="op" id="3633249">*</span><span class="ident" id="3633250">RangeNode</span>&nbsp;<span class="op" id="3633260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3633263">return</span>&nbsp;<span class="op" id="3633270">&amp;</span><span class="ident" id="3633271">RangeNode</span><span class="op" id="3633280">{</span><span class="ident" id="3633281">BranchNode</span><span class="op" id="3633291">{</span><span class="ident" id="3633292">tr</span><span class="op" id="3633294">:</span>&nbsp;<span class="ident" id="3633296">t</span><span class="op" id="3633297">,</span>&nbsp;<span class="ident" id="3633299">NodeType</span><span class="op" id="3633307">:</span>&nbsp;<span class="ident" id="3633309">NodeRange</span><span class="op" id="3633318">,</span>&nbsp;<span class="ident" id="3633320">Pos</span><span class="op" id="3633323">:</span>&nbsp;<span class="ident" id="3633325">pos</span><span class="op" id="3633328">,</span>&nbsp;<span class="ident" id="3633330">Line</span><span class="op" id="3633334">:</span>&nbsp;<span class="ident" id="3633336">line</span><span class="op" id="3633340">,</span>&nbsp;<span class="ident" id="3633342">Pipe</span><span class="op" id="3633346">:</span>&nbsp;<span class="ident" id="3633348">pipe</span><span class="op" id="3633352">,</span>&nbsp;<span class="ident" id="3633354">List</span><span class="op" id="3633358">:</span>&nbsp;<span class="ident" id="3633360">list</span><span class="op" id="3633364">,</span>&nbsp;<span class="ident" id="3633366">ElseList</span><span class="op" id="3633374">:</span>&nbsp;<span class="ident" id="3633376">elseList</span><span class="op" id="3633384">}</span><span class="op" id="3633385">}</span><br>
<span class="lineno"></span><span class="op" id="3633387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword" id="3633390">func</span>&nbsp;<span class="op" id="3633395">(</span><span class="ident" id="3633396">r</span>&nbsp;<span class="op" id="3633398">*</span><span class="ident" id="3633399">RangeNode</span><span class="op" id="3633408">)</span>&nbsp;<span class="ident" id="3633410">Copy</span><span class="op" id="3633414">(</span><span class="op" id="3633415">)</span>&nbsp;<span class="ident" id="3633417">Node</span>&nbsp;<span class="op" id="3633422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3633425">return</span>&nbsp;<span class="ident" id="3633432">r</span><span class="op" id="3633433">.</span><span class="ident" id="3633434">tr</span><span class="op" id="3633436">.</span><span class="ident" id="3633437">newRange</span><span class="op" id="3633445">(</span><span class="ident" id="3633446">r</span><span class="op" id="3633447">.</span><span class="ident" id="3633448">Pos</span><span class="op" id="3633451">,</span>&nbsp;<span class="ident" id="3633453">r</span><span class="op" id="3633454">.</span><span class="ident" id="3633455">Line</span><span class="op" id="3633459">,</span>&nbsp;<span class="ident" id="3633461">r</span><span class="op" id="3633462">.</span><span class="ident" id="3633463">Pipe</span><span class="op" id="3633467">.</span><span class="ident" id="3633468">CopyPipe</span><span class="op" id="3633476">(</span><span class="op" id="3633477">)</span><span class="op" id="3633478">,</span>&nbsp;<span class="ident" id="3633480">r</span><span class="op" id="3633481">.</span><span class="ident" id="3633482">List</span><span class="op" id="3633486">.</span><span class="ident" id="3633487">CopyList</span><span class="op" id="3633495">(</span><span class="op" id="3633496">)</span><span class="op" id="3633497">,</span>&nbsp;<span class="ident" id="3633499">r</span><span class="op" id="3633500">.</span><span class="ident" id="3633501">ElseList</span><span class="op" id="3633509">.</span><span class="ident" id="3633510">CopyList</span><span class="op" id="3633518">(</span><span class="op" id="3633519">)</span><span class="op" id="3633520">)</span><br>
<span class="lineno"></span><span class="op" id="3633522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3633525">//&nbsp;WithNode&nbsp;represents&nbsp;a&nbsp;{{with}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno">795</span><span class="keyword" id="3633584">type</span>&nbsp;<span class="ident" id="3633589">WithNode</span>&nbsp;<span class="keyword" id="3633598">struct</span>&nbsp;<span class="op" id="3633605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3633608">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3633619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3633622">func</span>&nbsp;<span class="op" id="3633627">(</span><span class="ident" id="3633628">t</span>&nbsp;<span class="op" id="3633630">*</span><span class="ident" id="3633631">Tree</span><span class="op" id="3633635">)</span>&nbsp;<span class="ident" id="3633637">newWith</span><span class="op" id="3633644">(</span><span class="ident" id="3633645">pos</span>&nbsp;<span class="ident" id="3633649">Pos</span><span class="op" id="3633652">,</span>&nbsp;<span class="ident" id="3633654">line</span>&nbsp;<span class="builtintype" id="3633659">int</span><span class="op" id="3633662">,</span>&nbsp;<span class="ident" id="3633664">pipe</span>&nbsp;<span class="op" id="3633669">*</span><span class="ident" id="3633670">PipeNode</span><span class="op" id="3633678">,</span>&nbsp;<span class="ident" id="3633680">list</span><span class="op" id="3633684">,</span>&nbsp;<span class="ident" id="3633686">elseList</span>&nbsp;<span class="op" id="3633695">*</span><span class="ident" id="3633696">ListNode</span><span class="op" id="3633704">)</span>&nbsp;<span class="op" id="3633706">*</span><span class="ident" id="3633707">WithNode</span>&nbsp;<span class="op" id="3633716">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3633719">return</span>&nbsp;<span class="op" id="3633726">&amp;</span><span class="ident" id="3633727">WithNode</span><span class="op" id="3633735">{</span><span class="ident" id="3633736">BranchNode</span><span class="op" id="3633746">{</span><span class="ident" id="3633747">tr</span><span class="op" id="3633749">:</span>&nbsp;<span class="ident" id="3633751">t</span><span class="op" id="3633752">,</span>&nbsp;<span class="ident" id="3633754">NodeType</span><span class="op" id="3633762">:</span>&nbsp;<span class="ident" id="3633764">NodeWith</span><span class="op" id="3633772">,</span>&nbsp;<span class="ident" id="3633774">Pos</span><span class="op" id="3633777">:</span>&nbsp;<span class="ident" id="3633779">pos</span><span class="op" id="3633782">,</span>&nbsp;<span class="ident" id="3633784">Line</span><span class="op" id="3633788">:</span>&nbsp;<span class="ident" id="3633790">line</span><span class="op" id="3633794">,</span>&nbsp;<span class="ident" id="3633796">Pipe</span><span class="op" id="3633800">:</span>&nbsp;<span class="ident" id="3633802">pipe</span><span class="op" id="3633806">,</span>&nbsp;<span class="ident" id="3633808">List</span><span class="op" id="3633812">:</span>&nbsp;<span class="ident" id="3633814">list</span><span class="op" id="3633818">,</span>&nbsp;<span class="ident" id="3633820">ElseList</span><span class="op" id="3633828">:</span>&nbsp;<span class="ident" id="3633830">elseList</span><span class="op" id="3633838">}</span><span class="op" id="3633839">}</span><br>
<span class="lineno"></span><span class="op" id="3633841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3633844">func</span>&nbsp;<span class="op" id="3633849">(</span><span class="ident" id="3633850">w</span>&nbsp;<span class="op" id="3633852">*</span><span class="ident" id="3633853">WithNode</span><span class="op" id="3633861">)</span>&nbsp;<span class="ident" id="3633863">Copy</span><span class="op" id="3633867">(</span><span class="op" id="3633868">)</span>&nbsp;<span class="ident" id="3633870">Node</span>&nbsp;<span class="op" id="3633875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3633878">return</span>&nbsp;<span class="ident" id="3633885">w</span><span class="op" id="3633886">.</span><span class="ident" id="3633887">tr</span><span class="op" id="3633889">.</span><span class="ident" id="3633890">newWith</span><span class="op" id="3633897">(</span><span class="ident" id="3633898">w</span><span class="op" id="3633899">.</span><span class="ident" id="3633900">Pos</span><span class="op" id="3633903">,</span>&nbsp;<span class="ident" id="3633905">w</span><span class="op" id="3633906">.</span><span class="ident" id="3633907">Line</span><span class="op" id="3633911">,</span>&nbsp;<span class="ident" id="3633913">w</span><span class="op" id="3633914">.</span><span class="ident" id="3633915">Pipe</span><span class="op" id="3633919">.</span><span class="ident" id="3633920">CopyPipe</span><span class="op" id="3633928">(</span><span class="op" id="3633929">)</span><span class="op" id="3633930">,</span>&nbsp;<span class="ident" id="3633932">w</span><span class="op" id="3633933">.</span><span class="ident" id="3633934">List</span><span class="op" id="3633938">.</span><span class="ident" id="3633939">CopyList</span><span class="op" id="3633947">(</span><span class="op" id="3633948">)</span><span class="op" id="3633949">,</span>&nbsp;<span class="ident" id="3633951">w</span><span class="op" id="3633952">.</span><span class="ident" id="3633953">ElseList</span><span class="op" id="3633961">.</span><span class="ident" id="3633962">CopyList</span><span class="op" id="3633970">(</span><span class="op" id="3633971">)</span><span class="op" id="3633972">)</span><br>
<span class="lineno">805</span><span class="op" id="3633974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3633977">//&nbsp;TemplateNode&nbsp;represents&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="3634027">type</span>&nbsp;<span class="ident" id="3634032">TemplateNode</span>&nbsp;<span class="keyword" id="3634045">struct</span>&nbsp;<span class="op" id="3634052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634055">NodeType</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634065">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634070">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3634075">*</span><span class="ident" id="3634076">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634082">Line</span>&nbsp;<span class="builtintype" id="3634087">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3634097">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634167">Name</span>&nbsp;<span class="builtintype" id="3634172">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3634182">//&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;(unquoted).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634223">Pipe</span>&nbsp;<span class="op" id="3634228">*</span><span class="ident" id="3634229">PipeNode</span>&nbsp;<span class="comment" id="3634238">//&nbsp;The&nbsp;command&nbsp;to&nbsp;evaluate&nbsp;as&nbsp;dot&nbsp;for&nbsp;the&nbsp;template.</span><br>
<span class="lineno">815</span><span class="op" id="3634290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3634293">func</span>&nbsp;<span class="op" id="3634298">(</span><span class="ident" id="3634299">t</span>&nbsp;<span class="op" id="3634301">*</span><span class="ident" id="3634302">Tree</span><span class="op" id="3634306">)</span>&nbsp;<span class="ident" id="3634308">newTemplate</span><span class="op" id="3634319">(</span><span class="ident" id="3634320">pos</span>&nbsp;<span class="ident" id="3634324">Pos</span><span class="op" id="3634327">,</span>&nbsp;<span class="ident" id="3634329">line</span>&nbsp;<span class="builtintype" id="3634334">int</span><span class="op" id="3634337">,</span>&nbsp;<span class="ident" id="3634339">name</span>&nbsp;<span class="builtintype" id="3634344">string</span><span class="op" id="3634350">,</span>&nbsp;<span class="ident" id="3634352">pipe</span>&nbsp;<span class="op" id="3634357">*</span><span class="ident" id="3634358">PipeNode</span><span class="op" id="3634366">)</span>&nbsp;<span class="op" id="3634368">*</span><span class="ident" id="3634369">TemplateNode</span>&nbsp;<span class="op" id="3634382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634385">return</span>&nbsp;<span class="op" id="3634392">&amp;</span><span class="ident" id="3634393">TemplateNode</span><span class="op" id="3634405">{</span><span class="ident" id="3634406">tr</span><span class="op" id="3634408">:</span>&nbsp;<span class="ident" id="3634410">t</span><span class="op" id="3634411">,</span>&nbsp;<span class="ident" id="3634413">NodeType</span><span class="op" id="3634421">:</span>&nbsp;<span class="ident" id="3634423">NodeTemplate</span><span class="op" id="3634435">,</span>&nbsp;<span class="ident" id="3634437">Pos</span><span class="op" id="3634440">:</span>&nbsp;<span class="ident" id="3634442">pos</span><span class="op" id="3634445">,</span>&nbsp;<span class="ident" id="3634447">Line</span><span class="op" id="3634451">:</span>&nbsp;<span class="ident" id="3634453">line</span><span class="op" id="3634457">,</span>&nbsp;<span class="ident" id="3634459">Name</span><span class="op" id="3634463">:</span>&nbsp;<span class="ident" id="3634465">name</span><span class="op" id="3634469">,</span>&nbsp;<span class="ident" id="3634471">Pipe</span><span class="op" id="3634475">:</span>&nbsp;<span class="ident" id="3634477">pipe</span><span class="op" id="3634481">}</span><br>
<span class="lineno"></span><span class="op" id="3634483">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="keyword" id="3634486">func</span>&nbsp;<span class="op" id="3634491">(</span><span class="ident" id="3634492">t</span>&nbsp;<span class="op" id="3634494">*</span><span class="ident" id="3634495">TemplateNode</span><span class="op" id="3634507">)</span>&nbsp;<span class="ident" id="3634509">String</span><span class="op" id="3634515">(</span><span class="op" id="3634516">)</span>&nbsp;<span class="builtintype" id="3634518">string</span>&nbsp;<span class="op" id="3634525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634528">if</span>&nbsp;<span class="ident" id="3634531">t</span><span class="op" id="3634532">.</span><span class="ident" id="3634533">Pipe</span>&nbsp;<span class="op" id="3634538">==</span>&nbsp;<span class="builtintype" id="3634541">nil</span>&nbsp;<span class="op" id="3634545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634549">return</span>&nbsp;<span class="ident" id="3634556">fmt</span><span class="op" id="3634559">.</span><span class="ident" id="3634560">Sprintf</span><span class="op" id="3634567">(</span><span class="string" id="3634568">&#34;{{template&nbsp;%q}}&#34;</span><span class="op" id="3634585">,</span>&nbsp;<span class="ident" id="3634587">t</span><span class="op" id="3634588">.</span><span class="ident" id="3634589">Name</span><span class="op" id="3634593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3634596">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634599">return</span>&nbsp;<span class="ident" id="3634606">fmt</span><span class="op" id="3634609">.</span><span class="ident" id="3634610">Sprintf</span><span class="op" id="3634617">(</span><span class="string" id="3634618">&#34;{{template&nbsp;%q&nbsp;%s}}&#34;</span><span class="op" id="3634638">,</span>&nbsp;<span class="ident" id="3634640">t</span><span class="op" id="3634641">.</span><span class="ident" id="3634642">Name</span><span class="op" id="3634646">,</span>&nbsp;<span class="ident" id="3634648">t</span><span class="op" id="3634649">.</span><span class="ident" id="3634650">Pipe</span><span class="op" id="3634654">)</span><br>
<span class="lineno"></span><span class="op" id="3634656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3634659">func</span>&nbsp;<span class="op" id="3634664">(</span><span class="ident" id="3634665">t</span>&nbsp;<span class="op" id="3634667">*</span><span class="ident" id="3634668">TemplateNode</span><span class="op" id="3634680">)</span>&nbsp;<span class="ident" id="3634682">tree</span><span class="op" id="3634686">(</span><span class="op" id="3634687">)</span>&nbsp;<span class="op" id="3634689">*</span><span class="ident" id="3634690">Tree</span>&nbsp;<span class="op" id="3634695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634698">return</span>&nbsp;<span class="ident" id="3634705">t</span><span class="op" id="3634706">.</span><span class="ident" id="3634707">tr</span><br>
<span class="lineno">830</span><span class="op" id="3634710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3634713">func</span>&nbsp;<span class="op" id="3634718">(</span><span class="ident" id="3634719">t</span>&nbsp;<span class="op" id="3634721">*</span><span class="ident" id="3634722">TemplateNode</span><span class="op" id="3634734">)</span>&nbsp;<span class="ident" id="3634736">Copy</span><span class="op" id="3634740">(</span><span class="op" id="3634741">)</span>&nbsp;<span class="ident" id="3634743">Node</span>&nbsp;<span class="op" id="3634748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634751">return</span>&nbsp;<span class="ident" id="3634758">t</span><span class="op" id="3634759">.</span><span class="ident" id="3634760">tr</span><span class="op" id="3634762">.</span><span class="ident" id="3634763">newTemplate</span><span class="op" id="3634774">(</span><span class="ident" id="3634775">t</span><span class="op" id="3634776">.</span><span class="ident" id="3634777">Pos</span><span class="op" id="3634780">,</span>&nbsp;<span class="ident" id="3634782">t</span><span class="op" id="3634783">.</span><span class="ident" id="3634784">Line</span><span class="op" id="3634788">,</span>&nbsp;<span class="ident" id="3634790">t</span><span class="op" id="3634791">.</span><span class="ident" id="3634792">Name</span><span class="op" id="3634796">,</span>&nbsp;<span class="ident" id="3634798">t</span><span class="op" id="3634799">.</span><span class="ident" id="3634800">Pipe</span><span class="op" id="3634804">.</span><span class="ident" id="3634805">CopyPipe</span><span class="op" id="3634813">(</span><span class="op" id="3634814">)</span><span class="op" id="3634815">)</span><br>
<span class="lineno"></span><span class="op" id="3634817">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
