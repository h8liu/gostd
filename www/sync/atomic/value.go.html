<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1456234">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1456289">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1456343">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1456394">package</span>&nbsp;<span class="ident" id="1456402">atomic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1456410">import</span>&nbsp;<span class="op" id="1456417">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1456420">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="1456429">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1456432">//&nbsp;A&nbsp;Value&nbsp;provides&nbsp;an&nbsp;atomic&nbsp;load&nbsp;and&nbsp;store&nbsp;of&nbsp;a&nbsp;consistently&nbsp;typed&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="1456508">//&nbsp;Values&nbsp;can&nbsp;be&nbsp;created&nbsp;as&nbsp;part&nbsp;of&nbsp;other&nbsp;data&nbsp;structures.</span><br>
<span class="lineno"></span><span class="comment" id="1456567">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Value&nbsp;returns&nbsp;nil&nbsp;from&nbsp;Load.</span><br>
<span class="lineno"></span><span class="comment" id="1456620">//&nbsp;Once&nbsp;Store&nbsp;has&nbsp;been&nbsp;called,&nbsp;a&nbsp;Value&nbsp;must&nbsp;not&nbsp;be&nbsp;copied.</span><br>
<span class="lineno">15</span><span class="keyword" id="1456679">type</span>&nbsp;<span class="ident" id="1456684">Value</span>&nbsp;<span class="keyword" id="1456690">struct</span>&nbsp;<span class="op" id="1456697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456700">v</span>&nbsp;<span class="keyword" id="1456702">interface</span><span class="op" id="1456711">{</span><span class="op" id="1456712">}</span><br>
<span class="lineno"></span><span class="op" id="1456714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1456717">//&nbsp;ifaceWords&nbsp;is&nbsp;interface{}&nbsp;internal&nbsp;representation.</span><br>
<span class="lineno">20</span><span class="keyword" id="1456771">type</span>&nbsp;<span class="ident" id="1456776">ifaceWords</span>&nbsp;<span class="keyword" id="1456787">struct</span>&nbsp;<span class="op" id="1456794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456797">typ</span>&nbsp;&nbsp;<span class="ident" id="1456802">unsafe</span><span class="op" id="1456808">.</span><span class="ident" id="1456809">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1456818">data</span>&nbsp;<span class="ident" id="1456823">unsafe</span><span class="op" id="1456829">.</span><span class="ident" id="1456830">Pointer</span><br>
<span class="lineno"></span><span class="op" id="1456838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="1456841">//&nbsp;Load&nbsp;returns&nbsp;the&nbsp;value&nbsp;set&nbsp;by&nbsp;the&nbsp;most&nbsp;recent&nbsp;Store.</span><br>
<span class="lineno"></span><span class="comment" id="1456897">//&nbsp;It&nbsp;returns&nbsp;nil&nbsp;if&nbsp;there&nbsp;has&nbsp;been&nbsp;no&nbsp;call&nbsp;to&nbsp;Store&nbsp;for&nbsp;this&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="1456966">func</span>&nbsp;<span class="op" id="1456971">(</span><span class="ident" id="1456972">v</span>&nbsp;<span class="op" id="1456974">*</span><span class="ident" id="1456975">Value</span><span class="op" id="1456980">)</span>&nbsp;<span class="ident" id="1456982">Load</span><span class="op" id="1456986">(</span><span class="op" id="1456987">)</span>&nbsp;<span class="op" id="1456989">(</span><span class="ident" id="1456990">x</span>&nbsp;<span class="keyword" id="1456992">interface</span><span class="op" id="1457001">{</span><span class="op" id="1457002">}</span><span class="op" id="1457003">)</span>&nbsp;<span class="op" id="1457005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1457008">vp</span>&nbsp;<span class="op" id="1457011">:=</span>&nbsp;<span class="op" id="1457014">(</span><span class="op" id="1457015">*</span><span class="ident" id="1457016">ifaceWords</span><span class="op" id="1457026">)</span><span class="op" id="1457027">(</span><span class="ident" id="1457028">unsafe</span><span class="op" id="1457034">.</span><span class="ident" id="1457035">Pointer</span><span class="op" id="1457042">(</span><span class="ident" id="1457043">v</span><span class="op" id="1457044">)</span><span class="op" id="1457045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1457048">typ</span>&nbsp;<span class="op" id="1457052">:=</span>&nbsp;<span class="ident" id="1457055">LoadPointer</span><span class="op" id="1457066">(</span><span class="op" id="1457067">&amp;</span><span class="ident" id="1457068">vp</span><span class="op" id="1457070">.</span><span class="ident" id="1457071">typ</span><span class="op" id="1457074">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1457077">if</span>&nbsp;<span class="ident" id="1457080">typ</span>&nbsp;<span class="op" id="1457084">==</span>&nbsp;<span class="ident" id="1457087">nil</span>&nbsp;<span class="op" id="1457091">||</span>&nbsp;<span class="builtintype" id="1457094">uintptr</span><span class="op" id="1457101">(</span><span class="ident" id="1457102">typ</span><span class="op" id="1457105">)</span>&nbsp;<span class="op" id="1457107">==</span>&nbsp;<span class="op" id="1457110">^</span><span class="builtintype" id="1457111">uintptr</span><span class="op" id="1457118">(</span><span class="num" id="1457119">0</span><span class="op" id="1457120">)</span>&nbsp;<span class="op" id="1457122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1457126">//&nbsp;First&nbsp;store&nbsp;not&nbsp;yet&nbsp;completed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1457162">return</span>&nbsp;<span class="ident" id="1457169">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1457174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1457177">data</span>&nbsp;<span class="op" id="1457182">:=</span>&nbsp;<span class="ident" id="1457185">LoadPointer</span><span class="op" id="1457196">(</span><span class="op" id="1457197">&amp;</span><span class="ident" id="1457198">vp</span><span class="op" id="1457200">.</span><span class="ident" id="1457201">data</span><span class="op" id="1457205">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1457208">xp</span>&nbsp;<span class="op" id="1457211">:=</span>&nbsp;<span class="op" id="1457214">(</span><span class="op" id="1457215">*</span><span class="ident" id="1457216">ifaceWords</span><span class="op" id="1457226">)</span><span class="op" id="1457227">(</span><span class="ident" id="1457228">unsafe</span><span class="op" id="1457234">.</span><span class="ident" id="1457235">Pointer</span><span class="op" id="1457242">(</span><span class="op" id="1457243">&amp;</span><span class="ident" id="1457244">x</span><span class="op" id="1457245">)</span><span class="op" id="1457246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1457249">xp</span><span class="op" id="1457251">.</span><span class="ident" id="1457252">typ</span>&nbsp;<span class="op" id="1457256">=</span>&nbsp;<span class="ident" id="1457258">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1457263">xp</span><span class="op" id="1457265">.</span><span class="ident" id="1457266">data</span>&nbsp;<span class="op" id="1457271">=</span>&nbsp;<span class="ident" id="1457273">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1457279">return</span><br>
<span class="lineno"></span><span class="op" id="1457286">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1457289">//&nbsp;Store&nbsp;sets&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;Value&nbsp;to&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1457332">//&nbsp;All&nbsp;calls&nbsp;to&nbsp;Store&nbsp;for&nbsp;a&nbsp;given&nbsp;Value&nbsp;must&nbsp;use&nbsp;values&nbsp;of&nbsp;the&nbsp;same&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="1457415">//&nbsp;Store&nbsp;of&nbsp;an&nbsp;inconsistent&nbsp;type&nbsp;panics,&nbsp;as&nbsp;does&nbsp;Store(nil).</span><br>
<span class="lineno"></span><span class="keyword" id="1457476">func</span>&nbsp;<span class="op" id="1457481">(</span><span class="ident" id="1457482">v</span>&nbsp;<span class="op" id="1457484">*</span><span class="ident" id="1457485">Value</span><span class="op" id="1457490">)</span>&nbsp;<span class="ident" id="1457492">Store</span><span class="op" id="1457497">(</span><span class="ident" id="1457498">x</span>&nbsp;<span class="keyword" id="1457500">interface</span><span class="op" id="1457509">{</span><span class="op" id="1457510">}</span><span class="op" id="1457511">)</span>&nbsp;<span class="op" id="1457513">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1457516">if</span>&nbsp;<span class="ident" id="1457519">x</span>&nbsp;<span class="op" id="1457521">==</span>&nbsp;<span class="ident" id="1457524">nil</span>&nbsp;<span class="op" id="1457528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1457532">panic</span><span class="op" id="1457537">(</span><span class="string" id="1457538">&#34;sync/atomic:&nbsp;store&nbsp;of&nbsp;nil&nbsp;value&nbsp;into&nbsp;Value&#34;</span><span class="op" id="1457582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1457585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1457588">vp</span>&nbsp;<span class="op" id="1457591">:=</span>&nbsp;<span class="op" id="1457594">(</span><span class="op" id="1457595">*</span><span class="ident" id="1457596">ifaceWords</span><span class="op" id="1457606">)</span><span class="op" id="1457607">(</span><span class="ident" id="1457608">unsafe</span><span class="op" id="1457614">.</span><span class="ident" id="1457615">Pointer</span><span class="op" id="1457622">(</span><span class="ident" id="1457623">v</span><span class="op" id="1457624">)</span><span class="op" id="1457625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1457628">xp</span>&nbsp;<span class="op" id="1457631">:=</span>&nbsp;<span class="op" id="1457634">(</span><span class="op" id="1457635">*</span><span class="ident" id="1457636">ifaceWords</span><span class="op" id="1457646">)</span><span class="op" id="1457647">(</span><span class="ident" id="1457648">unsafe</span><span class="op" id="1457654">.</span><span class="ident" id="1457655">Pointer</span><span class="op" id="1457662">(</span><span class="op" id="1457663">&amp;</span><span class="ident" id="1457664">x</span><span class="op" id="1457665">)</span><span class="op" id="1457666">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1457669">for</span>&nbsp;<span class="op" id="1457673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1457677">typ</span>&nbsp;<span class="op" id="1457681">:=</span>&nbsp;<span class="ident" id="1457684">LoadPointer</span><span class="op" id="1457695">(</span><span class="op" id="1457696">&amp;</span><span class="ident" id="1457697">vp</span><span class="op" id="1457699">.</span><span class="ident" id="1457700">typ</span><span class="op" id="1457703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1457707">if</span>&nbsp;<span class="ident" id="1457710">typ</span>&nbsp;<span class="op" id="1457714">==</span>&nbsp;<span class="ident" id="1457717">nil</span>&nbsp;<span class="op" id="1457721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1457726">//&nbsp;Attempt&nbsp;to&nbsp;start&nbsp;first&nbsp;store.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1457762">//&nbsp;Disable&nbsp;preemption&nbsp;so&nbsp;that&nbsp;other&nbsp;goroutines&nbsp;can&nbsp;use</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1457820">//&nbsp;active&nbsp;spin&nbsp;wait&nbsp;to&nbsp;wait&nbsp;for&nbsp;completion;&nbsp;and&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1457879">//&nbsp;GC&nbsp;does&nbsp;not&nbsp;see&nbsp;the&nbsp;fake&nbsp;type&nbsp;accidentally.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1457929">runtime_procPin</span><span class="op" id="1457944">(</span><span class="op" id="1457945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1457950">if</span>&nbsp;<span class="op" id="1457953">!</span><span class="ident" id="1457954">CompareAndSwapPointer</span><span class="op" id="1457975">(</span><span class="op" id="1457976">&amp;</span><span class="ident" id="1457977">vp</span><span class="op" id="1457979">.</span><span class="ident" id="1457980">typ</span><span class="op" id="1457983">,</span>&nbsp;<span class="ident" id="1457985">nil</span><span class="op" id="1457988">,</span>&nbsp;<span class="ident" id="1457990">unsafe</span><span class="op" id="1457996">.</span><span class="ident" id="1457997">Pointer</span><span class="op" id="1458004">(</span><span class="op" id="1458005">^</span><span class="builtintype" id="1458006">uintptr</span><span class="op" id="1458013">(</span><span class="num" id="1458014">0</span><span class="op" id="1458015">)</span><span class="op" id="1458016">)</span><span class="op" id="1458017">)</span>&nbsp;<span class="op" id="1458019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1458025">runtime_procUnpin</span><span class="op" id="1458042">(</span><span class="op" id="1458043">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1458049">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1458061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1458066">//&nbsp;Complete&nbsp;first&nbsp;store.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1458094">StorePointer</span><span class="op" id="1458106">(</span><span class="op" id="1458107">&amp;</span><span class="ident" id="1458108">vp</span><span class="op" id="1458110">.</span><span class="ident" id="1458111">data</span><span class="op" id="1458115">,</span>&nbsp;<span class="ident" id="1458117">xp</span><span class="op" id="1458119">.</span><span class="ident" id="1458120">data</span><span class="op" id="1458124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1458129">StorePointer</span><span class="op" id="1458141">(</span><span class="op" id="1458142">&amp;</span><span class="ident" id="1458143">vp</span><span class="op" id="1458145">.</span><span class="ident" id="1458146">typ</span><span class="op" id="1458149">,</span>&nbsp;<span class="ident" id="1458151">xp</span><span class="op" id="1458153">.</span><span class="ident" id="1458154">typ</span><span class="op" id="1458157">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1458162">runtime_procUnpin</span><span class="op" id="1458179">(</span><span class="op" id="1458180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1458185">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1458194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1458198">if</span>&nbsp;<span class="builtintype" id="1458201">uintptr</span><span class="op" id="1458208">(</span><span class="ident" id="1458209">typ</span><span class="op" id="1458212">)</span>&nbsp;<span class="op" id="1458214">==</span>&nbsp;<span class="op" id="1458217">^</span><span class="builtintype" id="1458218">uintptr</span><span class="op" id="1458225">(</span><span class="num" id="1458226">0</span><span class="op" id="1458227">)</span>&nbsp;<span class="op" id="1458229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1458234">//&nbsp;First&nbsp;store&nbsp;in&nbsp;progress.&nbsp;Wait.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1458271">//&nbsp;Since&nbsp;we&nbsp;disable&nbsp;preemption&nbsp;around&nbsp;the&nbsp;first&nbsp;store,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1458329">//&nbsp;we&nbsp;can&nbsp;wait&nbsp;with&nbsp;active&nbsp;spinning.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1458369">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1458380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1458384">//&nbsp;First&nbsp;store&nbsp;completed.&nbsp;Check&nbsp;type&nbsp;and&nbsp;overwrite&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1458443">if</span>&nbsp;<span class="ident" id="1458446">typ</span>&nbsp;<span class="op" id="1458450">!=</span>&nbsp;<span class="ident" id="1458453">xp</span><span class="op" id="1458455">.</span><span class="ident" id="1458456">typ</span>&nbsp;<span class="op" id="1458460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1458465">panic</span><span class="op" id="1458470">(</span><span class="string" id="1458471">&#34;sync/atomic:&nbsp;store&nbsp;of&nbsp;inconsistently&nbsp;typed&nbsp;value&nbsp;into&nbsp;Value&#34;</span><span class="op" id="1458532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1458536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1458540">StorePointer</span><span class="op" id="1458552">(</span><span class="op" id="1458553">&amp;</span><span class="ident" id="1458554">vp</span><span class="op" id="1458556">.</span><span class="ident" id="1458557">data</span><span class="op" id="1458561">,</span>&nbsp;<span class="ident" id="1458563">xp</span><span class="op" id="1458565">.</span><span class="ident" id="1458566">data</span><span class="op" id="1458570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1458574">return</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1458582">}</span><br>
<span class="lineno"></span><span class="op" id="1458584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1458587">//&nbsp;Disable/enable&nbsp;preemption,&nbsp;implemented&nbsp;in&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="keyword" id="1458641">func</span>&nbsp;<span class="ident" id="1458646">runtime_procPin</span><span class="op" id="1458661">(</span><span class="op" id="1458662">)</span><br>
<span class="lineno">85</span><span class="keyword" id="1458664">func</span>&nbsp;<span class="ident" id="1458669">runtime_procUnpin</span><span class="op" id="1458686">(</span><span class="op" id="1458687">)</span>
</div>
</body>
</html>
