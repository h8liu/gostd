<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html" class="current">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2711036">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2711091">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2711145">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2711196">//&nbsp;Package&nbsp;time&nbsp;provides&nbsp;functionality&nbsp;for&nbsp;measuring&nbsp;and&nbsp;displaying&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2711270">//</span><br>
<span class="lineno"></span><span class="comment" id="2711273">//&nbsp;The&nbsp;calendrical&nbsp;calculations&nbsp;always&nbsp;assume&nbsp;a&nbsp;Gregorian&nbsp;calendar.</span><br>
<span class="lineno"></span><span class="keyword" id="2711341">package</span>&nbsp;<span class="ident" id="2711349">time</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2711355">import</span>&nbsp;<span class="string" id="2711362">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2711372">//&nbsp;A&nbsp;Time&nbsp;represents&nbsp;an&nbsp;instant&nbsp;in&nbsp;time&nbsp;with&nbsp;nanosecond&nbsp;precision.</span><br>
<span class="lineno"></span><span class="comment" id="2711439">//</span><br>
<span class="lineno"></span><span class="comment" id="2711442">//&nbsp;Programs&nbsp;using&nbsp;times&nbsp;should&nbsp;typically&nbsp;store&nbsp;and&nbsp;pass&nbsp;them&nbsp;as&nbsp;values,</span><br>
<span class="lineno">15</span><span class="comment" id="2711514">//&nbsp;not&nbsp;pointers.&nbsp;&nbsp;That&nbsp;is,&nbsp;time&nbsp;variables&nbsp;and&nbsp;struct&nbsp;fields&nbsp;should&nbsp;be&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2711587">//&nbsp;type&nbsp;time.Time,&nbsp;not&nbsp;*time.Time.&nbsp;&nbsp;A&nbsp;Time&nbsp;value&nbsp;can&nbsp;be&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2711651">//&nbsp;multiple&nbsp;goroutines&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="comment" id="2711690">//</span><br>
<span class="lineno"></span><span class="comment" id="2711693">//&nbsp;Time&nbsp;instants&nbsp;can&nbsp;be&nbsp;compared&nbsp;using&nbsp;the&nbsp;Before,&nbsp;After,&nbsp;and&nbsp;Equal&nbsp;methods.</span><br>
<span class="lineno">20</span><span class="comment" id="2711770">//&nbsp;The&nbsp;Sub&nbsp;method&nbsp;subtracts&nbsp;two&nbsp;instants,&nbsp;producing&nbsp;a&nbsp;Duration.</span><br>
<span class="lineno"></span><span class="comment" id="2711834">//&nbsp;The&nbsp;Add&nbsp;method&nbsp;adds&nbsp;a&nbsp;Time&nbsp;and&nbsp;a&nbsp;Duration,&nbsp;producing&nbsp;a&nbsp;Time.</span><br>
<span class="lineno"></span><span class="comment" id="2711898">//</span><br>
<span class="lineno"></span><span class="comment" id="2711901">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;Time&nbsp;is&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00.000000000&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2711978">//&nbsp;As&nbsp;this&nbsp;time&nbsp;is&nbsp;unlikely&nbsp;to&nbsp;come&nbsp;up&nbsp;in&nbsp;practice,&nbsp;the&nbsp;IsZero&nbsp;method&nbsp;gives</span><br>
<span class="lineno">25</span><span class="comment" id="2712054">//&nbsp;a&nbsp;simple&nbsp;way&nbsp;of&nbsp;detecting&nbsp;a&nbsp;time&nbsp;that&nbsp;has&nbsp;not&nbsp;been&nbsp;initialized&nbsp;explicitly.</span><br>
<span class="lineno"></span><span class="comment" id="2712132">//</span><br>
<span class="lineno"></span><span class="comment" id="2712135">//&nbsp;Each&nbsp;Time&nbsp;has&nbsp;associated&nbsp;with&nbsp;it&nbsp;a&nbsp;Location,&nbsp;consulted&nbsp;when&nbsp;computing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2712212">//&nbsp;presentation&nbsp;form&nbsp;of&nbsp;the&nbsp;time,&nbsp;such&nbsp;as&nbsp;in&nbsp;the&nbsp;Format,&nbsp;Hour,&nbsp;and&nbsp;Year&nbsp;methods.</span><br>
<span class="lineno"></span><span class="comment" id="2712293">//&nbsp;The&nbsp;methods&nbsp;Local,&nbsp;UTC,&nbsp;and&nbsp;In&nbsp;return&nbsp;a&nbsp;Time&nbsp;with&nbsp;a&nbsp;specific&nbsp;location.</span><br>
<span class="lineno">30</span><span class="comment" id="2712367">//&nbsp;Changing&nbsp;the&nbsp;location&nbsp;in&nbsp;this&nbsp;way&nbsp;changes&nbsp;only&nbsp;the&nbsp;presentation;&nbsp;it&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2712447">//&nbsp;change&nbsp;the&nbsp;instant&nbsp;in&nbsp;time&nbsp;being&nbsp;denoted&nbsp;and&nbsp;therefore&nbsp;does&nbsp;not&nbsp;affect&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2712525">//&nbsp;computations&nbsp;described&nbsp;in&nbsp;earlier&nbsp;paragraphs.</span><br>
<span class="lineno"></span><span class="comment" id="2712574">//</span><br>
<span class="lineno"></span><span class="comment" id="2712577">//&nbsp;Note&nbsp;that&nbsp;the&nbsp;Go&nbsp;==&nbsp;operator&nbsp;compares&nbsp;not&nbsp;just&nbsp;the&nbsp;time&nbsp;instant&nbsp;but&nbsp;also&nbsp;the</span><br>
<span class="lineno">35</span><span class="comment" id="2712657">//&nbsp;Location.&nbsp;Therefore,&nbsp;Time&nbsp;values&nbsp;should&nbsp;not&nbsp;be&nbsp;used&nbsp;as&nbsp;map&nbsp;or&nbsp;database&nbsp;keys</span><br>
<span class="lineno"></span><span class="comment" id="2712736">//&nbsp;without&nbsp;first&nbsp;guaranteeing&nbsp;that&nbsp;the&nbsp;identical&nbsp;Location&nbsp;has&nbsp;been&nbsp;set&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2712815">//&nbsp;values,&nbsp;which&nbsp;can&nbsp;be&nbsp;achieved&nbsp;through&nbsp;use&nbsp;of&nbsp;the&nbsp;UTC&nbsp;or&nbsp;Local&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2712888">//</span><br>
<span class="lineno"></span><span class="keyword" id="2712891">type</span>&nbsp;<span class="ident" id="2712896">Time</span>&nbsp;<span class="keyword" id="2712901">struct</span>&nbsp;<span class="op" id="2712908">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2712911">//&nbsp;sec&nbsp;gives&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;elapsed&nbsp;since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2712961">//&nbsp;January&nbsp;1,&nbsp;year&nbsp;1&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2712997">sec</span>&nbsp;<span class="ident" id="2713001">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2713009">//&nbsp;nsec&nbsp;specifies&nbsp;a&nbsp;non-negative&nbsp;nanosecond</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2713054">//&nbsp;offset&nbsp;within&nbsp;the&nbsp;second&nbsp;named&nbsp;by&nbsp;Seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2713101">//&nbsp;It&nbsp;must&nbsp;be&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713145">nsec</span>&nbsp;<span class="builtintype" id="2713150">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2713158">//&nbsp;loc&nbsp;specifies&nbsp;the&nbsp;Location&nbsp;that&nbsp;should&nbsp;be&nbsp;used&nbsp;to</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2713212">//&nbsp;determine&nbsp;the&nbsp;minute,&nbsp;hour,&nbsp;month,&nbsp;day,&nbsp;and&nbsp;year</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2713265">//&nbsp;that&nbsp;correspond&nbsp;to&nbsp;this&nbsp;Time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2713299">//&nbsp;Only&nbsp;the&nbsp;zero&nbsp;Time&nbsp;has&nbsp;a&nbsp;nil&nbsp;Location.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2713342">//&nbsp;In&nbsp;that&nbsp;case&nbsp;it&nbsp;is&nbsp;interpreted&nbsp;to&nbsp;mean&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2713390">loc</span>&nbsp;<span class="op" id="2713394">*</span><span class="ident" id="2713395">Location</span><br>
<span class="lineno">55</span><span class="op" id="2713404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2713407">//&nbsp;After&nbsp;reports&nbsp;whether&nbsp;the&nbsp;time&nbsp;instant&nbsp;t&nbsp;is&nbsp;after&nbsp;u.</span><br>
<span class="lineno"></span><span class="keyword" id="2713463">func</span>&nbsp;<span class="op" id="2713468">(</span><span class="ident" id="2713469">t</span>&nbsp;<span class="ident" id="2713471">Time</span><span class="op" id="2713475">)</span>&nbsp;<span class="ident" id="2713477">After</span><span class="op" id="2713482">(</span><span class="ident" id="2713483">u</span>&nbsp;<span class="ident" id="2713485">Time</span><span class="op" id="2713489">)</span>&nbsp;<span class="builtintype" id="2713491">bool</span>&nbsp;<span class="op" id="2713496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2713499">return</span>&nbsp;<span class="ident" id="2713506">t</span><span class="op" id="2713507">.</span><span class="ident" id="2713508">sec</span>&nbsp;<span class="op" id="2713512">&gt;</span>&nbsp;<span class="ident" id="2713514">u</span><span class="op" id="2713515">.</span><span class="ident" id="2713516">sec</span>&nbsp;<span class="op" id="2713520">||</span>&nbsp;<span class="ident" id="2713523">t</span><span class="op" id="2713524">.</span><span class="ident" id="2713525">sec</span>&nbsp;<span class="op" id="2713529">==</span>&nbsp;<span class="ident" id="2713532">u</span><span class="op" id="2713533">.</span><span class="ident" id="2713534">sec</span>&nbsp;<span class="op" id="2713538">&amp;&amp;</span>&nbsp;<span class="ident" id="2713541">t</span><span class="op" id="2713542">.</span><span class="ident" id="2713543">nsec</span>&nbsp;<span class="op" id="2713548">&gt;</span>&nbsp;<span class="ident" id="2713550">u</span><span class="op" id="2713551">.</span><span class="ident" id="2713552">nsec</span><br>
<span class="lineno">60</span><span class="op" id="2713557">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2713560">//&nbsp;Before&nbsp;reports&nbsp;whether&nbsp;the&nbsp;time&nbsp;instant&nbsp;t&nbsp;is&nbsp;before&nbsp;u.</span><br>
<span class="lineno"></span><span class="keyword" id="2713618">func</span>&nbsp;<span class="op" id="2713623">(</span><span class="ident" id="2713624">t</span>&nbsp;<span class="ident" id="2713626">Time</span><span class="op" id="2713630">)</span>&nbsp;<span class="ident" id="2713632">Before</span><span class="op" id="2713638">(</span><span class="ident" id="2713639">u</span>&nbsp;<span class="ident" id="2713641">Time</span><span class="op" id="2713645">)</span>&nbsp;<span class="builtintype" id="2713647">bool</span>&nbsp;<span class="op" id="2713652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2713655">return</span>&nbsp;<span class="ident" id="2713662">t</span><span class="op" id="2713663">.</span><span class="ident" id="2713664">sec</span>&nbsp;<span class="op" id="2713668">&lt;</span>&nbsp;<span class="ident" id="2713670">u</span><span class="op" id="2713671">.</span><span class="ident" id="2713672">sec</span>&nbsp;<span class="op" id="2713676">||</span>&nbsp;<span class="ident" id="2713679">t</span><span class="op" id="2713680">.</span><span class="ident" id="2713681">sec</span>&nbsp;<span class="op" id="2713685">==</span>&nbsp;<span class="ident" id="2713688">u</span><span class="op" id="2713689">.</span><span class="ident" id="2713690">sec</span>&nbsp;<span class="op" id="2713694">&amp;&amp;</span>&nbsp;<span class="ident" id="2713697">t</span><span class="op" id="2713698">.</span><span class="ident" id="2713699">nsec</span>&nbsp;<span class="op" id="2713704">&lt;</span>&nbsp;<span class="ident" id="2713706">u</span><span class="op" id="2713707">.</span><span class="ident" id="2713708">nsec</span><br>
<span class="lineno">65</span><span class="op" id="2713713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2713716">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;t&nbsp;and&nbsp;u&nbsp;represent&nbsp;the&nbsp;same&nbsp;time&nbsp;instant.</span><br>
<span class="lineno"></span><span class="comment" id="2713782">//&nbsp;Two&nbsp;times&nbsp;can&nbsp;be&nbsp;equal&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;different&nbsp;locations.</span><br>
<span class="lineno"></span><span class="comment" id="2713849">//&nbsp;For&nbsp;example,&nbsp;6:00&nbsp;+0200&nbsp;CEST&nbsp;and&nbsp;4:00&nbsp;UTC&nbsp;are&nbsp;Equal.</span><br>
<span class="lineno">70</span><span class="comment" id="2713905">//&nbsp;This&nbsp;comparison&nbsp;is&nbsp;different&nbsp;from&nbsp;using&nbsp;t&nbsp;==&nbsp;u,&nbsp;which&nbsp;also&nbsp;compares</span><br>
<span class="lineno"></span><span class="comment" id="2713976">//&nbsp;the&nbsp;locations.</span><br>
<span class="lineno"></span><span class="keyword" id="2713994">func</span>&nbsp;<span class="op" id="2713999">(</span><span class="ident" id="2714000">t</span>&nbsp;<span class="ident" id="2714002">Time</span><span class="op" id="2714006">)</span>&nbsp;<span class="ident" id="2714008">Equal</span><span class="op" id="2714013">(</span><span class="ident" id="2714014">u</span>&nbsp;<span class="ident" id="2714016">Time</span><span class="op" id="2714020">)</span>&nbsp;<span class="builtintype" id="2714022">bool</span>&nbsp;<span class="op" id="2714027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2714030">return</span>&nbsp;<span class="ident" id="2714037">t</span><span class="op" id="2714038">.</span><span class="ident" id="2714039">sec</span>&nbsp;<span class="op" id="2714043">==</span>&nbsp;<span class="ident" id="2714046">u</span><span class="op" id="2714047">.</span><span class="ident" id="2714048">sec</span>&nbsp;<span class="op" id="2714052">&amp;&amp;</span>&nbsp;<span class="ident" id="2714055">t</span><span class="op" id="2714056">.</span><span class="ident" id="2714057">nsec</span>&nbsp;<span class="op" id="2714062">==</span>&nbsp;<span class="ident" id="2714065">u</span><span class="op" id="2714066">.</span><span class="ident" id="2714067">nsec</span><br>
<span class="lineno"></span><span class="op" id="2714072">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2714075">//&nbsp;A&nbsp;Month&nbsp;specifies&nbsp;a&nbsp;month&nbsp;of&nbsp;the&nbsp;year&nbsp;(January&nbsp;=&nbsp;1,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2714136">type</span>&nbsp;<span class="ident" id="2714141">Month</span>&nbsp;<span class="builtintype" id="2714147">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2714152">const</span>&nbsp;<span class="op" id="2714158">(</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714161">January</span>&nbsp;<span class="ident" id="2714169">Month</span>&nbsp;<span class="op" id="2714175">=</span>&nbsp;<span class="num" id="2714177">1</span>&nbsp;<span class="op" id="2714179">+</span>&nbsp;<span class="ident" id="2714181">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714187">February</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714197">March</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714204">April</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714211">May</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714216">June</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714222">July</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714228">August</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714236">September</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714247">October</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714256">November</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714266">December</span><br>
<span class="lineno"></span><span class="op" id="2714275">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2714278">var</span>&nbsp;<span class="ident" id="2714282">months</span>&nbsp;<span class="op" id="2714289">=</span>&nbsp;<span class="op" id="2714291">[</span><span class="op" id="2714292">...</span><span class="op" id="2714295">]</span><span class="builtintype" id="2714296">string</span><span class="op" id="2714302">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714305">&#34;January&#34;</span><span class="op" id="2714314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714317">&#34;February&#34;</span><span class="op" id="2714327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714330">&#34;March&#34;</span><span class="op" id="2714337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714340">&#34;April&#34;</span><span class="op" id="2714347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714350">&#34;May&#34;</span><span class="op" id="2714355">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714358">&#34;June&#34;</span><span class="op" id="2714364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714367">&#34;July&#34;</span><span class="op" id="2714373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714376">&#34;August&#34;</span><span class="op" id="2714384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714387">&#34;September&#34;</span><span class="op" id="2714398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714401">&#34;October&#34;</span><span class="op" id="2714410">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714413">&#34;November&#34;</span><span class="op" id="2714423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714426">&#34;December&#34;</span><span class="op" id="2714436">,</span><br>
<span class="lineno"></span><span class="op" id="2714438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2714441">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;English&nbsp;name&nbsp;of&nbsp;the&nbsp;month&nbsp;(&#34;January&#34;,&nbsp;&#34;February&#34;,&nbsp;...).</span><br>
<span class="lineno">110</span><span class="keyword" id="2714519">func</span>&nbsp;<span class="op" id="2714524">(</span><span class="ident" id="2714525">m</span>&nbsp;<span class="ident" id="2714527">Month</span><span class="op" id="2714532">)</span>&nbsp;<span class="ident" id="2714534">String</span><span class="op" id="2714540">(</span><span class="op" id="2714541">)</span>&nbsp;<span class="builtintype" id="2714543">string</span>&nbsp;<span class="op" id="2714550">{</span>&nbsp;<span class="keyword" id="2714552">return</span>&nbsp;<span class="ident" id="2714559">months</span><span class="op" id="2714565">[</span><span class="ident" id="2714566">m</span><span class="op" id="2714567">-</span><span class="num" id="2714568">1</span><span class="op" id="2714569">]</span>&nbsp;<span class="op" id="2714571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2714574">//&nbsp;A&nbsp;Weekday&nbsp;specifies&nbsp;a&nbsp;day&nbsp;of&nbsp;the&nbsp;week&nbsp;(Sunday&nbsp;=&nbsp;0,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2714634">type</span>&nbsp;<span class="ident" id="2714639">Weekday</span>&nbsp;<span class="builtintype" id="2714647">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="2714652">const</span>&nbsp;<span class="op" id="2714658">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714661">Sunday</span>&nbsp;<span class="ident" id="2714668">Weekday</span>&nbsp;<span class="op" id="2714676">=</span>&nbsp;<span class="ident" id="2714678">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714684">Monday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714692">Tuesday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714701">Wednesday</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714712">Thursday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714722">Friday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2714730">Saturday</span><br>
<span class="lineno"></span><span class="op" id="2714739">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2714742">var</span>&nbsp;<span class="ident" id="2714746">days</span>&nbsp;<span class="op" id="2714751">=</span>&nbsp;<span class="op" id="2714753">[</span><span class="op" id="2714754">...</span><span class="op" id="2714757">]</span><span class="builtintype" id="2714758">string</span><span class="op" id="2714764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714767">&#34;Sunday&#34;</span><span class="op" id="2714775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714778">&#34;Monday&#34;</span><span class="op" id="2714786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714789">&#34;Tuesday&#34;</span><span class="op" id="2714798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714801">&#34;Wednesday&#34;</span><span class="op" id="2714812">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714815">&#34;Thursday&#34;</span><span class="op" id="2714825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714828">&#34;Friday&#34;</span><span class="op" id="2714836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2714839">&#34;Saturday&#34;</span><span class="op" id="2714849">,</span><br>
<span class="lineno"></span><span class="op" id="2714851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="2714854">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;English&nbsp;name&nbsp;of&nbsp;the&nbsp;day&nbsp;(&#34;Sunday&#34;,&nbsp;&#34;Monday&#34;,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2714927">func</span>&nbsp;<span class="op" id="2714932">(</span><span class="ident" id="2714933">d</span>&nbsp;<span class="ident" id="2714935">Weekday</span><span class="op" id="2714942">)</span>&nbsp;<span class="ident" id="2714944">String</span><span class="op" id="2714950">(</span><span class="op" id="2714951">)</span>&nbsp;<span class="builtintype" id="2714953">string</span>&nbsp;<span class="op" id="2714960">{</span>&nbsp;<span class="keyword" id="2714962">return</span>&nbsp;<span class="ident" id="2714969">days</span><span class="op" id="2714973">[</span><span class="ident" id="2714974">d</span><span class="op" id="2714975">]</span>&nbsp;<span class="op" id="2714977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2714980">//&nbsp;Computations&nbsp;on&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2715005">//</span><br>
<span class="lineno">140</span><span class="comment" id="2715008">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Time&nbsp;is&nbsp;defined&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2715054">//&nbsp;&nbsp;&nbsp;&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00.000000000&nbsp;UTC</span><br>
<span class="lineno"></span><span class="comment" id="2715099">//&nbsp;which&nbsp;(1)&nbsp;looks&nbsp;like&nbsp;a&nbsp;zero,&nbsp;or&nbsp;as&nbsp;close&nbsp;as&nbsp;you&nbsp;can&nbsp;get&nbsp;in&nbsp;a&nbsp;date</span><br>
<span class="lineno"></span><span class="comment" id="2715168">//&nbsp;(1-1-1&nbsp;00:00:00&nbsp;UTC),&nbsp;(2)&nbsp;is&nbsp;unlikely&nbsp;enough&nbsp;to&nbsp;arise&nbsp;in&nbsp;practice&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2715240">//&nbsp;be&nbsp;a&nbsp;suitable&nbsp;&#34;not&nbsp;set&#34;&nbsp;sentinel,&nbsp;unlike&nbsp;Jan&nbsp;1&nbsp;1970,&nbsp;and&nbsp;(3)&nbsp;has&nbsp;a</span><br>
<span class="lineno">145</span><span class="comment" id="2715310">//&nbsp;non-negative&nbsp;year&nbsp;even&nbsp;in&nbsp;time&nbsp;zones&nbsp;west&nbsp;of&nbsp;UTC,&nbsp;unlike&nbsp;1-1-0</span><br>
<span class="lineno"></span><span class="comment" id="2715376">//&nbsp;00:00:00&nbsp;UTC,&nbsp;which&nbsp;would&nbsp;be&nbsp;12-31-(-1)&nbsp;19:00:00&nbsp;in&nbsp;New&nbsp;York.</span><br>
<span class="lineno"></span><span class="comment" id="2715441">//</span><br>
<span class="lineno"></span><span class="comment" id="2715444">//&nbsp;The&nbsp;zero&nbsp;Time&nbsp;value&nbsp;does&nbsp;not&nbsp;force&nbsp;a&nbsp;specific&nbsp;epoch&nbsp;for&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2715512">//&nbsp;representation.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;use&nbsp;the&nbsp;Unix&nbsp;epoch&nbsp;internally,&nbsp;we</span><br>
<span class="lineno">150</span><span class="comment" id="2715582">//&nbsp;could&nbsp;define&nbsp;that&nbsp;to&nbsp;distinguish&nbsp;a&nbsp;zero&nbsp;value&nbsp;from&nbsp;Jan&nbsp;1&nbsp;1970,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2715653">//&nbsp;time&nbsp;would&nbsp;be&nbsp;represented&nbsp;by&nbsp;sec=-1,&nbsp;nsec=1e9.&nbsp;&nbsp;However,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2715721">//&nbsp;suggest&nbsp;a&nbsp;representation,&nbsp;namely&nbsp;using&nbsp;1-1-1&nbsp;00:00:00&nbsp;UTC&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2715789">//&nbsp;epoch,&nbsp;and&nbsp;that&#39;s&nbsp;what&nbsp;we&nbsp;do.</span><br>
<span class="lineno"></span><span class="comment" id="2715822">//</span><br>
<span class="lineno">155</span><span class="comment" id="2715825">//&nbsp;The&nbsp;Add&nbsp;and&nbsp;Sub&nbsp;computations&nbsp;are&nbsp;oblivious&nbsp;to&nbsp;the&nbsp;choice&nbsp;of&nbsp;epoch.</span><br>
<span class="lineno"></span><span class="comment" id="2715895">//</span><br>
<span class="lineno"></span><span class="comment" id="2715898">//&nbsp;The&nbsp;presentation&nbsp;computations&nbsp;-&nbsp;year,&nbsp;month,&nbsp;minute,&nbsp;and&nbsp;so&nbsp;on&nbsp;-&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2715970">//&nbsp;rely&nbsp;heavily&nbsp;on&nbsp;division&nbsp;and&nbsp;modulus&nbsp;by&nbsp;positive&nbsp;constants.&nbsp;&nbsp;For</span><br>
<span class="lineno"></span><span class="comment" id="2716038">//&nbsp;calendrical&nbsp;calculations&nbsp;we&nbsp;want&nbsp;these&nbsp;divisions&nbsp;to&nbsp;round&nbsp;down,&nbsp;even</span><br>
<span class="lineno">160</span><span class="comment" id="2716110">//&nbsp;for&nbsp;negative&nbsp;values,&nbsp;so&nbsp;that&nbsp;the&nbsp;remainder&nbsp;is&nbsp;always&nbsp;positive,&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="2716180">//&nbsp;Go&#39;s&nbsp;division&nbsp;(like&nbsp;most&nbsp;hardware&nbsp;division&nbsp;instructions)&nbsp;rounds&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2716250">//&nbsp;zero.&nbsp;&nbsp;We&nbsp;can&nbsp;still&nbsp;do&nbsp;those&nbsp;computations&nbsp;and&nbsp;then&nbsp;adjust&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="2716322">//&nbsp;for&nbsp;a&nbsp;negative&nbsp;numerator,&nbsp;but&nbsp;it&#39;s&nbsp;annoying&nbsp;to&nbsp;write&nbsp;the&nbsp;adjustment</span><br>
<span class="lineno"></span><span class="comment" id="2716393">//&nbsp;over&nbsp;and&nbsp;over.&nbsp;&nbsp;Instead,&nbsp;we&nbsp;can&nbsp;change&nbsp;to&nbsp;a&nbsp;different&nbsp;epoch&nbsp;so&nbsp;long</span><br>
<span class="lineno">165</span><span class="comment" id="2716464">//&nbsp;ago&nbsp;that&nbsp;all&nbsp;the&nbsp;times&nbsp;we&nbsp;care&nbsp;about&nbsp;will&nbsp;be&nbsp;positive,&nbsp;and&nbsp;then&nbsp;round</span><br>
<span class="lineno"></span><span class="comment" id="2716537">//&nbsp;to&nbsp;zero&nbsp;and&nbsp;round&nbsp;down&nbsp;coincide.&nbsp;&nbsp;These&nbsp;presentation&nbsp;routines&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2716610">//&nbsp;have&nbsp;to&nbsp;add&nbsp;the&nbsp;zone&nbsp;offset,&nbsp;so&nbsp;adding&nbsp;the&nbsp;translation&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2716675">//&nbsp;alternate&nbsp;epoch&nbsp;is&nbsp;cheap.&nbsp;&nbsp;For&nbsp;example,&nbsp;having&nbsp;a&nbsp;non-negative&nbsp;time&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="2716747">//&nbsp;means&nbsp;that&nbsp;we&nbsp;can&nbsp;write</span><br>
<span class="lineno">170</span><span class="comment" id="2716774">//</span><br>
<span class="lineno"></span><span class="comment" id="2716777">//&nbsp;&nbsp;&nbsp;&nbsp;sec&nbsp;=&nbsp;t&nbsp;%&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2716793">//</span><br>
<span class="lineno"></span><span class="comment" id="2716796">//&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2716810">//</span><br>
<span class="lineno">175</span><span class="comment" id="2716813">//&nbsp;&nbsp;&nbsp;&nbsp;sec&nbsp;=&nbsp;t&nbsp;%&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2716829">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sec&nbsp;&lt;&nbsp;0&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="2716845">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sec&nbsp;+=&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2716859">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="2716864">//</span><br>
<span class="lineno">180</span><span class="comment" id="2716867">//&nbsp;everywhere.</span><br>
<span class="lineno"></span><span class="comment" id="2716882">//</span><br>
<span class="lineno"></span><span class="comment" id="2716885">//&nbsp;The&nbsp;calendar&nbsp;runs&nbsp;on&nbsp;an&nbsp;exact&nbsp;400&nbsp;year&nbsp;cycle:&nbsp;a&nbsp;400-year&nbsp;calendar</span><br>
<span class="lineno"></span><span class="comment" id="2716954">//&nbsp;printed&nbsp;for&nbsp;1970-2469&nbsp;will&nbsp;apply&nbsp;as&nbsp;well&nbsp;to&nbsp;2470-2869.&nbsp;&nbsp;Even&nbsp;the&nbsp;days</span><br>
<span class="lineno"></span><span class="comment" id="2717027">//&nbsp;of&nbsp;the&nbsp;week&nbsp;match&nbsp;up.&nbsp;&nbsp;It&nbsp;simplifies&nbsp;the&nbsp;computations&nbsp;to&nbsp;choose&nbsp;the</span><br>
<span class="lineno">185</span><span class="comment" id="2717098">//&nbsp;cycle&nbsp;boundaries&nbsp;so&nbsp;that&nbsp;the&nbsp;exceptional&nbsp;years&nbsp;are&nbsp;always&nbsp;delayed&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2717170">//&nbsp;long&nbsp;as&nbsp;possible.&nbsp;&nbsp;That&nbsp;means&nbsp;choosing&nbsp;a&nbsp;year&nbsp;equal&nbsp;to&nbsp;1&nbsp;mod&nbsp;400,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="2717242">//&nbsp;that&nbsp;the&nbsp;first&nbsp;leap&nbsp;year&nbsp;is&nbsp;the&nbsp;4th&nbsp;year,&nbsp;the&nbsp;first&nbsp;missed&nbsp;leap&nbsp;year</span><br>
<span class="lineno"></span><span class="comment" id="2717314">//&nbsp;is&nbsp;the&nbsp;100th&nbsp;year,&nbsp;and&nbsp;the&nbsp;missed&nbsp;missed&nbsp;leap&nbsp;year&nbsp;is&nbsp;the&nbsp;400th&nbsp;year.</span><br>
<span class="lineno"></span><span class="comment" id="2717387">//&nbsp;So&nbsp;we&#39;d&nbsp;prefer&nbsp;instead&nbsp;to&nbsp;print&nbsp;a&nbsp;calendar&nbsp;for&nbsp;2001-2400&nbsp;and&nbsp;reuse&nbsp;it</span><br>
<span class="lineno">190</span><span class="comment" id="2717460">//&nbsp;for&nbsp;2401-2800.</span><br>
<span class="lineno"></span><span class="comment" id="2717478">//</span><br>
<span class="lineno"></span><span class="comment" id="2717481">//&nbsp;Finally,&nbsp;it&#39;s&nbsp;convenient&nbsp;if&nbsp;the&nbsp;delta&nbsp;between&nbsp;the&nbsp;Unix&nbsp;epoch&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2717549">//&nbsp;long-ago&nbsp;epoch&nbsp;is&nbsp;representable&nbsp;by&nbsp;an&nbsp;int64&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2717606">//</span><br>
<span class="lineno">195</span><span class="comment" id="2717609">//&nbsp;These&nbsp;three&nbsp;considerations—choose&nbsp;an&nbsp;epoch&nbsp;as&nbsp;early&nbsp;as&nbsp;possible,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2717684">//&nbsp;uses&nbsp;a&nbsp;year&nbsp;equal&nbsp;to&nbsp;1&nbsp;mod&nbsp;400,&nbsp;and&nbsp;that&nbsp;is&nbsp;no&nbsp;more&nbsp;than&nbsp;2⁶³&nbsp;seconds</span><br>
<span class="lineno"></span><span class="comment" id="2717759">//&nbsp;earlier&nbsp;than&nbsp;1970—bring&nbsp;us&nbsp;to&nbsp;the&nbsp;year&nbsp;-292277022399.&nbsp;&nbsp;We&nbsp;refer&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2717831">//&nbsp;this&nbsp;year&nbsp;as&nbsp;the&nbsp;absolute&nbsp;zero&nbsp;year,&nbsp;and&nbsp;to&nbsp;times&nbsp;measured&nbsp;as&nbsp;a&nbsp;uint64</span><br>
<span class="lineno"></span><span class="comment" id="2717905">//&nbsp;seconds&nbsp;since&nbsp;this&nbsp;year&nbsp;as&nbsp;absolute&nbsp;times.</span><br>
<span class="lineno">200</span><span class="comment" id="2717951">//</span><br>
<span class="lineno"></span><span class="comment" id="2717954">//&nbsp;Times&nbsp;measured&nbsp;as&nbsp;an&nbsp;int64&nbsp;seconds&nbsp;since&nbsp;the&nbsp;year&nbsp;1—the&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="2718030">//&nbsp;used&nbsp;for&nbsp;Time&#39;s&nbsp;sec&nbsp;field—are&nbsp;called&nbsp;internal&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2718088">//</span><br>
<span class="lineno"></span><span class="comment" id="2718091">//&nbsp;Times&nbsp;measured&nbsp;as&nbsp;an&nbsp;int64&nbsp;seconds&nbsp;since&nbsp;the&nbsp;year&nbsp;1970&nbsp;are&nbsp;called&nbsp;Unix</span><br>
<span class="lineno">205</span><span class="comment" id="2718165">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2718175">//</span><br>
<span class="lineno"></span><span class="comment" id="2718178">//&nbsp;It&nbsp;is&nbsp;tempting&nbsp;to&nbsp;just&nbsp;use&nbsp;the&nbsp;year&nbsp;1&nbsp;as&nbsp;the&nbsp;absolute&nbsp;epoch,&nbsp;defining</span><br>
<span class="lineno"></span><span class="comment" id="2718251">//&nbsp;that&nbsp;the&nbsp;routines&nbsp;are&nbsp;only&nbsp;valid&nbsp;for&nbsp;years&nbsp;&gt;=&nbsp;1.&nbsp;&nbsp;However,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2718317">//&nbsp;routines&nbsp;would&nbsp;then&nbsp;be&nbsp;invalid&nbsp;when&nbsp;displaying&nbsp;the&nbsp;epoch&nbsp;in&nbsp;time&nbsp;zones</span><br>
<span class="lineno">210</span><span class="comment" id="2718391">//&nbsp;west&nbsp;of&nbsp;UTC,&nbsp;since&nbsp;it&nbsp;is&nbsp;year&nbsp;0.&nbsp;&nbsp;It&nbsp;doesn&#39;t&nbsp;seem&nbsp;tenable&nbsp;to&nbsp;say&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2718464">//&nbsp;printing&nbsp;the&nbsp;zero&nbsp;time&nbsp;correctly&nbsp;isn&#39;t&nbsp;supported&nbsp;in&nbsp;half&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2718533">//&nbsp;zones.&nbsp;&nbsp;By&nbsp;comparison,&nbsp;it&#39;s&nbsp;reasonable&nbsp;to&nbsp;mishandle&nbsp;some&nbsp;times&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2718602">//&nbsp;the&nbsp;year&nbsp;-292277022399.</span><br>
<span class="lineno"></span><span class="comment" id="2718629">//</span><br>
<span class="lineno">215</span><span class="comment" id="2718632">//&nbsp;All&nbsp;this&nbsp;is&nbsp;opaque&nbsp;to&nbsp;clients&nbsp;of&nbsp;the&nbsp;API&nbsp;and&nbsp;can&nbsp;be&nbsp;changed&nbsp;if&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2718700">//&nbsp;better&nbsp;implementation&nbsp;presents&nbsp;itself.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2718743">const</span>&nbsp;<span class="op" id="2718749">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2718752">//&nbsp;The&nbsp;unsigned&nbsp;zero&nbsp;year&nbsp;for&nbsp;internal&nbsp;calculations.</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2718806">//&nbsp;Must&nbsp;be&nbsp;1&nbsp;mod&nbsp;400,&nbsp;and&nbsp;times&nbsp;before&nbsp;it&nbsp;will&nbsp;not&nbsp;compute&nbsp;correctly,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2718877">//&nbsp;but&nbsp;otherwise&nbsp;can&nbsp;be&nbsp;changed&nbsp;at&nbsp;will.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2718919">absoluteZeroYear</span>&nbsp;<span class="op" id="2718936">=</span>&nbsp;<span class="op" id="2718938">-</span><span class="num" id="2718939">292277022399</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2718954">//&nbsp;The&nbsp;year&nbsp;of&nbsp;the&nbsp;zero&nbsp;Time.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2718985">//&nbsp;Assumed&nbsp;by&nbsp;the&nbsp;unixToInternal&nbsp;computation&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719038">internalYear</span>&nbsp;<span class="op" id="2719051">=</span>&nbsp;<span class="num" id="2719053">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2719057">//&nbsp;The&nbsp;year&nbsp;of&nbsp;the&nbsp;zero&nbsp;Unix&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719093">unixYear</span>&nbsp;<span class="op" id="2719102">=</span>&nbsp;<span class="num" id="2719104">1970</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2719111">//&nbsp;Offsets&nbsp;to&nbsp;convert&nbsp;between&nbsp;internal&nbsp;and&nbsp;absolute&nbsp;or&nbsp;Unix&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719179">absoluteToInternal</span>&nbsp;<span class="ident" id="2719198">int64</span>&nbsp;<span class="op" id="2719204">=</span>&nbsp;<span class="op" id="2719206">(</span><span class="ident" id="2719207">absoluteZeroYear</span>&nbsp;<span class="op" id="2719224">-</span>&nbsp;<span class="ident" id="2719226">internalYear</span><span class="op" id="2719238">)</span>&nbsp;<span class="op" id="2719240">*</span>&nbsp;<span class="num" id="2719242">365.2425</span>&nbsp;<span class="op" id="2719251">*</span>&nbsp;<span class="ident" id="2719253">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719268">internalToAbsolute</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2719293">=</span>&nbsp;<span class="op" id="2719295">-</span><span class="ident" id="2719296">absoluteToInternal</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719317">unixToInternal</span>&nbsp;<span class="ident" id="2719332">int64</span>&nbsp;<span class="op" id="2719338">=</span>&nbsp;<span class="op" id="2719340">(</span><span class="num" id="2719341">1969</span><span class="op" id="2719345">*</span><span class="num" id="2719346">365</span>&nbsp;<span class="op" id="2719350">+</span>&nbsp;<span class="num" id="2719352">1969</span><span class="op" id="2719356">/</span><span class="num" id="2719357">4</span>&nbsp;<span class="op" id="2719359">-</span>&nbsp;<span class="num" id="2719361">1969</span><span class="op" id="2719365">/</span><span class="num" id="2719366">100</span>&nbsp;<span class="op" id="2719370">+</span>&nbsp;<span class="num" id="2719372">1969</span><span class="op" id="2719376">/</span><span class="num" id="2719377">400</span><span class="op" id="2719380">)</span>&nbsp;<span class="op" id="2719382">*</span>&nbsp;<span class="ident" id="2719384">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719399">internalToUnix</span>&nbsp;<span class="ident" id="2719414">int64</span>&nbsp;<span class="op" id="2719420">=</span>&nbsp;<span class="op" id="2719422">-</span><span class="ident" id="2719423">unixToInternal</span><br>
<span class="lineno"></span><span class="op" id="2719438">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2719441">//&nbsp;IsZero&nbsp;reports&nbsp;whether&nbsp;t&nbsp;represents&nbsp;the&nbsp;zero&nbsp;time&nbsp;instant,</span><br>
<span class="lineno">240</span><span class="comment" id="2719503">//&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2719539">func</span>&nbsp;<span class="op" id="2719544">(</span><span class="ident" id="2719545">t</span>&nbsp;<span class="ident" id="2719547">Time</span><span class="op" id="2719551">)</span>&nbsp;<span class="ident" id="2719553">IsZero</span><span class="op" id="2719559">(</span><span class="op" id="2719560">)</span>&nbsp;<span class="builtintype" id="2719562">bool</span>&nbsp;<span class="op" id="2719567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2719570">return</span>&nbsp;<span class="ident" id="2719577">t</span><span class="op" id="2719578">.</span><span class="ident" id="2719579">sec</span>&nbsp;<span class="op" id="2719583">==</span>&nbsp;<span class="num" id="2719586">0</span>&nbsp;<span class="op" id="2719588">&amp;&amp;</span>&nbsp;<span class="ident" id="2719591">t</span><span class="op" id="2719592">.</span><span class="ident" id="2719593">nsec</span>&nbsp;<span class="op" id="2719598">==</span>&nbsp;<span class="num" id="2719601">0</span><br>
<span class="lineno"></span><span class="op" id="2719603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="2719606">//&nbsp;abs&nbsp;returns&nbsp;the&nbsp;time&nbsp;t&nbsp;as&nbsp;an&nbsp;absolute&nbsp;time,&nbsp;adjusted&nbsp;by&nbsp;the&nbsp;zone&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="2719682">//&nbsp;It&nbsp;is&nbsp;called&nbsp;when&nbsp;computing&nbsp;a&nbsp;presentation&nbsp;property&nbsp;like&nbsp;Month&nbsp;or&nbsp;Hour.</span><br>
<span class="lineno"></span><span class="keyword" id="2719757">func</span>&nbsp;<span class="op" id="2719762">(</span><span class="ident" id="2719763">t</span>&nbsp;<span class="ident" id="2719765">Time</span><span class="op" id="2719769">)</span>&nbsp;<span class="ident" id="2719771">abs</span><span class="op" id="2719774">(</span><span class="op" id="2719775">)</span>&nbsp;<span class="ident" id="2719777">uint64</span>&nbsp;<span class="op" id="2719784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719787">l</span>&nbsp;<span class="op" id="2719789">:=</span>&nbsp;<span class="ident" id="2719792">t</span><span class="op" id="2719793">.</span><span class="ident" id="2719794">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2719799">//&nbsp;Avoid&nbsp;function&nbsp;calls&nbsp;when&nbsp;possible.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2719839">if</span>&nbsp;<span class="ident" id="2719842">l</span>&nbsp;<span class="op" id="2719844">==</span>&nbsp;<span class="builtintype" id="2719847">nil</span>&nbsp;<span class="op" id="2719851">||</span>&nbsp;<span class="ident" id="2719854">l</span>&nbsp;<span class="op" id="2719856">==</span>&nbsp;<span class="op" id="2719859">&amp;</span><span class="ident" id="2719860">localLoc</span>&nbsp;<span class="op" id="2719869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719873">l</span>&nbsp;<span class="op" id="2719875">=</span>&nbsp;<span class="ident" id="2719877">l</span><span class="op" id="2719878">.</span><span class="ident" id="2719879">get</span><span class="op" id="2719882">(</span><span class="op" id="2719883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2719886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2719889">sec</span>&nbsp;<span class="op" id="2719893">:=</span>&nbsp;<span class="ident" id="2719896">t</span><span class="op" id="2719897">.</span><span class="ident" id="2719898">sec</span>&nbsp;<span class="op" id="2719902">+</span>&nbsp;<span class="ident" id="2719904">internalToUnix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2719920">if</span>&nbsp;<span class="ident" id="2719923">l</span>&nbsp;<span class="op" id="2719925">!=</span>&nbsp;<span class="op" id="2719928">&amp;</span><span class="ident" id="2719929">utcLoc</span>&nbsp;<span class="op" id="2719936">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2719940">if</span>&nbsp;<span class="ident" id="2719943">l</span><span class="op" id="2719944">.</span><span class="ident" id="2719945">cacheZone</span>&nbsp;<span class="op" id="2719955">!=</span>&nbsp;<span class="builtintype" id="2719958">nil</span>&nbsp;<span class="op" id="2719962">&amp;&amp;</span>&nbsp;<span class="ident" id="2719965">l</span><span class="op" id="2719966">.</span><span class="ident" id="2719967">cacheStart</span>&nbsp;<span class="op" id="2719978">&lt;=</span>&nbsp;<span class="ident" id="2719981">sec</span>&nbsp;<span class="op" id="2719985">&amp;&amp;</span>&nbsp;<span class="ident" id="2719988">sec</span>&nbsp;<span class="op" id="2719992">&lt;</span>&nbsp;<span class="ident" id="2719994">l</span><span class="op" id="2719995">.</span><span class="ident" id="2719996">cacheEnd</span>&nbsp;<span class="op" id="2720005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720010">sec</span>&nbsp;<span class="op" id="2720014">+=</span>&nbsp;<span class="ident" id="2720017">int64</span><span class="op" id="2720022">(</span><span class="ident" id="2720023">l</span><span class="op" id="2720024">.</span><span class="ident" id="2720025">cacheZone</span><span class="op" id="2720034">.</span><span class="ident" id="2720035">offset</span><span class="op" id="2720041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720045">}</span>&nbsp;<span class="keyword" id="2720047">else</span>&nbsp;<span class="op" id="2720052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720057">_</span><span class="op" id="2720058">,</span>&nbsp;<span class="ident" id="2720060">offset</span><span class="op" id="2720066">,</span>&nbsp;<span class="ident" id="2720068">_</span><span class="op" id="2720069">,</span>&nbsp;<span class="ident" id="2720071">_</span><span class="op" id="2720072">,</span>&nbsp;<span class="ident" id="2720074">_</span>&nbsp;<span class="op" id="2720076">:=</span>&nbsp;<span class="ident" id="2720079">l</span><span class="op" id="2720080">.</span><span class="ident" id="2720081">lookup</span><span class="op" id="2720087">(</span><span class="ident" id="2720088">sec</span><span class="op" id="2720091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720096">sec</span>&nbsp;<span class="op" id="2720100">+=</span>&nbsp;<span class="ident" id="2720103">int64</span><span class="op" id="2720108">(</span><span class="ident" id="2720109">offset</span><span class="op" id="2720115">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720125">return</span>&nbsp;<span class="ident" id="2720132">uint64</span><span class="op" id="2720138">(</span><span class="ident" id="2720139">sec</span>&nbsp;<span class="op" id="2720143">+</span>&nbsp;<span class="op" id="2720145">(</span><span class="ident" id="2720146">unixToInternal</span>&nbsp;<span class="op" id="2720161">+</span>&nbsp;<span class="ident" id="2720163">internalToAbsolute</span><span class="op" id="2720181">)</span><span class="op" id="2720182">)</span><br>
<span class="lineno"></span><span class="op" id="2720184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="2720187">//&nbsp;locabs&nbsp;is&nbsp;a&nbsp;combination&nbsp;of&nbsp;the&nbsp;Zone&nbsp;and&nbsp;abs&nbsp;methods,</span><br>
<span class="lineno"></span><span class="comment" id="2720243">//&nbsp;extracting&nbsp;both&nbsp;return&nbsp;values&nbsp;from&nbsp;a&nbsp;single&nbsp;zone&nbsp;lookup.</span><br>
<span class="lineno"></span><span class="keyword" id="2720303">func</span>&nbsp;<span class="op" id="2720308">(</span><span class="ident" id="2720309">t</span>&nbsp;<span class="ident" id="2720311">Time</span><span class="op" id="2720315">)</span>&nbsp;<span class="ident" id="2720317">locabs</span><span class="op" id="2720323">(</span><span class="op" id="2720324">)</span>&nbsp;<span class="op" id="2720326">(</span><span class="ident" id="2720327">name</span>&nbsp;<span class="builtintype" id="2720332">string</span><span class="op" id="2720338">,</span>&nbsp;<span class="ident" id="2720340">offset</span>&nbsp;<span class="builtintype" id="2720347">int</span><span class="op" id="2720350">,</span>&nbsp;<span class="ident" id="2720352">abs</span>&nbsp;<span class="ident" id="2720356">uint64</span><span class="op" id="2720362">)</span>&nbsp;<span class="op" id="2720364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720367">l</span>&nbsp;<span class="op" id="2720369">:=</span>&nbsp;<span class="ident" id="2720372">t</span><span class="op" id="2720373">.</span><span class="ident" id="2720374">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720379">if</span>&nbsp;<span class="ident" id="2720382">l</span>&nbsp;<span class="op" id="2720384">==</span>&nbsp;<span class="builtintype" id="2720387">nil</span>&nbsp;<span class="op" id="2720391">||</span>&nbsp;<span class="ident" id="2720394">l</span>&nbsp;<span class="op" id="2720396">==</span>&nbsp;<span class="op" id="2720399">&amp;</span><span class="ident" id="2720400">localLoc</span>&nbsp;<span class="op" id="2720409">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720413">l</span>&nbsp;<span class="op" id="2720415">=</span>&nbsp;<span class="ident" id="2720417">l</span><span class="op" id="2720418">.</span><span class="ident" id="2720419">get</span><span class="op" id="2720422">(</span><span class="op" id="2720423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2720429">//&nbsp;Avoid&nbsp;function&nbsp;call&nbsp;if&nbsp;we&nbsp;hit&nbsp;the&nbsp;local&nbsp;time&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720485">sec</span>&nbsp;<span class="op" id="2720489">:=</span>&nbsp;<span class="ident" id="2720492">t</span><span class="op" id="2720493">.</span><span class="ident" id="2720494">sec</span>&nbsp;<span class="op" id="2720498">+</span>&nbsp;<span class="ident" id="2720500">internalToUnix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720516">if</span>&nbsp;<span class="ident" id="2720519">l</span>&nbsp;<span class="op" id="2720521">!=</span>&nbsp;<span class="op" id="2720524">&amp;</span><span class="ident" id="2720525">utcLoc</span>&nbsp;<span class="op" id="2720532">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720536">if</span>&nbsp;<span class="ident" id="2720539">l</span><span class="op" id="2720540">.</span><span class="ident" id="2720541">cacheZone</span>&nbsp;<span class="op" id="2720551">!=</span>&nbsp;<span class="builtintype" id="2720554">nil</span>&nbsp;<span class="op" id="2720558">&amp;&amp;</span>&nbsp;<span class="ident" id="2720561">l</span><span class="op" id="2720562">.</span><span class="ident" id="2720563">cacheStart</span>&nbsp;<span class="op" id="2720574">&lt;=</span>&nbsp;<span class="ident" id="2720577">sec</span>&nbsp;<span class="op" id="2720581">&amp;&amp;</span>&nbsp;<span class="ident" id="2720584">sec</span>&nbsp;<span class="op" id="2720588">&lt;</span>&nbsp;<span class="ident" id="2720590">l</span><span class="op" id="2720591">.</span><span class="ident" id="2720592">cacheEnd</span>&nbsp;<span class="op" id="2720601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720606">name</span>&nbsp;<span class="op" id="2720611">=</span>&nbsp;<span class="ident" id="2720613">l</span><span class="op" id="2720614">.</span><span class="ident" id="2720615">cacheZone</span><span class="op" id="2720624">.</span><span class="ident" id="2720625">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720633">offset</span>&nbsp;<span class="op" id="2720640">=</span>&nbsp;<span class="ident" id="2720642">l</span><span class="op" id="2720643">.</span><span class="ident" id="2720644">cacheZone</span><span class="op" id="2720653">.</span><span class="ident" id="2720654">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720663">}</span>&nbsp;<span class="keyword" id="2720665">else</span>&nbsp;<span class="op" id="2720670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720675">name</span><span class="op" id="2720679">,</span>&nbsp;<span class="ident" id="2720681">offset</span><span class="op" id="2720687">,</span>&nbsp;<span class="ident" id="2720689">_</span><span class="op" id="2720690">,</span>&nbsp;<span class="ident" id="2720692">_</span><span class="op" id="2720693">,</span>&nbsp;<span class="ident" id="2720695">_</span>&nbsp;<span class="op" id="2720697">=</span>&nbsp;<span class="ident" id="2720699">l</span><span class="op" id="2720700">.</span><span class="ident" id="2720701">lookup</span><span class="op" id="2720707">(</span><span class="ident" id="2720708">sec</span><span class="op" id="2720711">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720719">sec</span>&nbsp;<span class="op" id="2720723">+=</span>&nbsp;<span class="ident" id="2720726">int64</span><span class="op" id="2720731">(</span><span class="ident" id="2720732">offset</span><span class="op" id="2720738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720741">}</span>&nbsp;<span class="keyword" id="2720743">else</span>&nbsp;<span class="op" id="2720748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720752">name</span>&nbsp;<span class="op" id="2720757">=</span>&nbsp;<span class="string" id="2720759">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2720766">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720769">abs</span>&nbsp;<span class="op" id="2720773">=</span>&nbsp;<span class="ident" id="2720775">uint64</span><span class="op" id="2720781">(</span><span class="ident" id="2720782">sec</span>&nbsp;<span class="op" id="2720786">+</span>&nbsp;<span class="op" id="2720788">(</span><span class="ident" id="2720789">unixToInternal</span>&nbsp;<span class="op" id="2720804">+</span>&nbsp;<span class="ident" id="2720806">internalToAbsolute</span><span class="op" id="2720824">)</span><span class="op" id="2720825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720828">return</span><br>
<span class="lineno"></span><span class="op" id="2720835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2720838">//&nbsp;Date&nbsp;returns&nbsp;the&nbsp;year,&nbsp;month,&nbsp;and&nbsp;day&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno">290</span><span class="keyword" id="2720898">func</span>&nbsp;<span class="op" id="2720903">(</span><span class="ident" id="2720904">t</span>&nbsp;<span class="ident" id="2720906">Time</span><span class="op" id="2720910">)</span>&nbsp;<span class="ident" id="2720912">Date</span><span class="op" id="2720916">(</span><span class="op" id="2720917">)</span>&nbsp;<span class="op" id="2720919">(</span><span class="ident" id="2720920">year</span>&nbsp;<span class="builtintype" id="2720925">int</span><span class="op" id="2720928">,</span>&nbsp;<span class="ident" id="2720930">month</span>&nbsp;<span class="ident" id="2720936">Month</span><span class="op" id="2720941">,</span>&nbsp;<span class="ident" id="2720943">day</span>&nbsp;<span class="builtintype" id="2720947">int</span><span class="op" id="2720950">)</span>&nbsp;<span class="op" id="2720952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2720955">year</span><span class="op" id="2720959">,</span>&nbsp;<span class="ident" id="2720961">month</span><span class="op" id="2720966">,</span>&nbsp;<span class="ident" id="2720968">day</span><span class="op" id="2720971">,</span>&nbsp;<span class="ident" id="2720973">_</span>&nbsp;<span class="op" id="2720975">=</span>&nbsp;<span class="ident" id="2720977">t</span><span class="op" id="2720978">.</span><span class="ident" id="2720979">date</span><span class="op" id="2720983">(</span><span class="builtintype" id="2720984">true</span><span class="op" id="2720988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2720991">return</span><br>
<span class="lineno"></span><span class="op" id="2720998">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="comment" id="2721001">//&nbsp;Year&nbsp;returns&nbsp;the&nbsp;year&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="2721045">func</span>&nbsp;<span class="op" id="2721050">(</span><span class="ident" id="2721051">t</span>&nbsp;<span class="ident" id="2721053">Time</span><span class="op" id="2721057">)</span>&nbsp;<span class="ident" id="2721059">Year</span><span class="op" id="2721063">(</span><span class="op" id="2721064">)</span>&nbsp;<span class="builtintype" id="2721066">int</span>&nbsp;<span class="op" id="2721070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721073">year</span><span class="op" id="2721077">,</span>&nbsp;<span class="ident" id="2721079">_</span><span class="op" id="2721080">,</span>&nbsp;<span class="ident" id="2721082">_</span><span class="op" id="2721083">,</span>&nbsp;<span class="ident" id="2721085">_</span>&nbsp;<span class="op" id="2721087">:=</span>&nbsp;<span class="ident" id="2721090">t</span><span class="op" id="2721091">.</span><span class="ident" id="2721092">date</span><span class="op" id="2721096">(</span><span class="builtintype" id="2721097">false</span><span class="op" id="2721102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2721105">return</span>&nbsp;<span class="ident" id="2721112">year</span><br>
<span class="lineno"></span><span class="op" id="2721117">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2721120">//&nbsp;Month&nbsp;returns&nbsp;the&nbsp;month&nbsp;of&nbsp;the&nbsp;year&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2721175">func</span>&nbsp;<span class="op" id="2721180">(</span><span class="ident" id="2721181">t</span>&nbsp;<span class="ident" id="2721183">Time</span><span class="op" id="2721187">)</span>&nbsp;<span class="ident" id="2721189">Month</span><span class="op" id="2721194">(</span><span class="op" id="2721195">)</span>&nbsp;<span class="ident" id="2721197">Month</span>&nbsp;<span class="op" id="2721203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721206">_</span><span class="op" id="2721207">,</span>&nbsp;<span class="ident" id="2721209">month</span><span class="op" id="2721214">,</span>&nbsp;<span class="ident" id="2721216">_</span><span class="op" id="2721217">,</span>&nbsp;<span class="ident" id="2721219">_</span>&nbsp;<span class="op" id="2721221">:=</span>&nbsp;<span class="ident" id="2721224">t</span><span class="op" id="2721225">.</span><span class="ident" id="2721226">date</span><span class="op" id="2721230">(</span><span class="builtintype" id="2721231">true</span><span class="op" id="2721235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2721238">return</span>&nbsp;<span class="ident" id="2721245">month</span><br>
<span class="lineno">305</span><span class="op" id="2721251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2721254">//&nbsp;Day&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;month&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2721306">func</span>&nbsp;<span class="op" id="2721311">(</span><span class="ident" id="2721312">t</span>&nbsp;<span class="ident" id="2721314">Time</span><span class="op" id="2721318">)</span>&nbsp;<span class="ident" id="2721320">Day</span><span class="op" id="2721323">(</span><span class="op" id="2721324">)</span>&nbsp;<span class="builtintype" id="2721326">int</span>&nbsp;<span class="op" id="2721330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721333">_</span><span class="op" id="2721334">,</span>&nbsp;<span class="ident" id="2721336">_</span><span class="op" id="2721337">,</span>&nbsp;<span class="ident" id="2721339">day</span><span class="op" id="2721342">,</span>&nbsp;<span class="ident" id="2721344">_</span>&nbsp;<span class="op" id="2721346">:=</span>&nbsp;<span class="ident" id="2721349">t</span><span class="op" id="2721350">.</span><span class="ident" id="2721351">date</span><span class="op" id="2721355">(</span><span class="builtintype" id="2721356">true</span><span class="op" id="2721360">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2721363">return</span>&nbsp;<span class="ident" id="2721370">day</span><br>
<span class="lineno"></span><span class="op" id="2721374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2721377">//&nbsp;Weekday&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;week&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2721432">func</span>&nbsp;<span class="op" id="2721437">(</span><span class="ident" id="2721438">t</span>&nbsp;<span class="ident" id="2721440">Time</span><span class="op" id="2721444">)</span>&nbsp;<span class="ident" id="2721446">Weekday</span><span class="op" id="2721453">(</span><span class="op" id="2721454">)</span>&nbsp;<span class="ident" id="2721456">Weekday</span>&nbsp;<span class="op" id="2721464">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2721467">return</span>&nbsp;<span class="ident" id="2721474">absWeekday</span><span class="op" id="2721484">(</span><span class="ident" id="2721485">t</span><span class="op" id="2721486">.</span><span class="ident" id="2721487">abs</span><span class="op" id="2721490">(</span><span class="op" id="2721491">)</span><span class="op" id="2721492">)</span><br>
<span class="lineno"></span><span class="op" id="2721494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2721497">//&nbsp;absWeekday&nbsp;is&nbsp;like&nbsp;Weekday&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2721561">func</span>&nbsp;<span class="ident" id="2721566">absWeekday</span><span class="op" id="2721576">(</span><span class="ident" id="2721577">abs</span>&nbsp;<span class="ident" id="2721581">uint64</span><span class="op" id="2721587">)</span>&nbsp;<span class="ident" id="2721589">Weekday</span>&nbsp;<span class="op" id="2721597">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2721600">//&nbsp;January&nbsp;1&nbsp;of&nbsp;the&nbsp;absolute&nbsp;year,&nbsp;like&nbsp;January&nbsp;1&nbsp;of&nbsp;2001,&nbsp;was&nbsp;a&nbsp;Monday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2721674">sec</span>&nbsp;<span class="op" id="2721678">:=</span>&nbsp;<span class="op" id="2721681">(</span><span class="ident" id="2721682">abs</span>&nbsp;<span class="op" id="2721686">+</span>&nbsp;<span class="ident" id="2721688">uint64</span><span class="op" id="2721694">(</span><span class="ident" id="2721695">Monday</span><span class="op" id="2721701">)</span><span class="op" id="2721702">*</span><span class="ident" id="2721703">secondsPerDay</span><span class="op" id="2721716">)</span>&nbsp;<span class="op" id="2721718">%</span>&nbsp;<span class="ident" id="2721720">secondsPerWeek</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2721736">return</span>&nbsp;<span class="ident" id="2721743">Weekday</span><span class="op" id="2721750">(</span><span class="builtintype" id="2721751">int</span><span class="op" id="2721754">(</span><span class="ident" id="2721755">sec</span><span class="op" id="2721758">)</span>&nbsp;<span class="op" id="2721760">/</span>&nbsp;<span class="ident" id="2721762">secondsPerDay</span><span class="op" id="2721775">)</span><br>
<span class="lineno"></span><span class="op" id="2721777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="comment" id="2721780">//&nbsp;ISOWeek&nbsp;returns&nbsp;the&nbsp;ISO&nbsp;8601&nbsp;year&nbsp;and&nbsp;week&nbsp;number&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="2721852">//&nbsp;Week&nbsp;ranges&nbsp;from&nbsp;1&nbsp;to&nbsp;53.&nbsp;Jan&nbsp;01&nbsp;to&nbsp;Jan&nbsp;03&nbsp;of&nbsp;year&nbsp;n&nbsp;might&nbsp;belong&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2721924">//&nbsp;week&nbsp;52&nbsp;or&nbsp;53&nbsp;of&nbsp;year&nbsp;n-1,&nbsp;and&nbsp;Dec&nbsp;29&nbsp;to&nbsp;Dec&nbsp;31&nbsp;might&nbsp;belong&nbsp;to&nbsp;week&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2721998">//&nbsp;of&nbsp;year&nbsp;n+1.</span><br>
<span class="lineno"></span><span class="keyword" id="2722014">func</span>&nbsp;<span class="op" id="2722019">(</span><span class="ident" id="2722020">t</span>&nbsp;<span class="ident" id="2722022">Time</span><span class="op" id="2722026">)</span>&nbsp;<span class="ident" id="2722028">ISOWeek</span><span class="op" id="2722035">(</span><span class="op" id="2722036">)</span>&nbsp;<span class="op" id="2722038">(</span><span class="ident" id="2722039">year</span><span class="op" id="2722043">,</span>&nbsp;<span class="ident" id="2722045">week</span>&nbsp;<span class="builtintype" id="2722050">int</span><span class="op" id="2722053">)</span>&nbsp;<span class="op" id="2722055">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722058">year</span><span class="op" id="2722062">,</span>&nbsp;<span class="ident" id="2722064">month</span><span class="op" id="2722069">,</span>&nbsp;<span class="ident" id="2722071">day</span><span class="op" id="2722074">,</span>&nbsp;<span class="ident" id="2722076">yday</span>&nbsp;<span class="op" id="2722081">:=</span>&nbsp;<span class="ident" id="2722084">t</span><span class="op" id="2722085">.</span><span class="ident" id="2722086">date</span><span class="op" id="2722090">(</span><span class="builtintype" id="2722091">true</span><span class="op" id="2722095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722098">wday</span>&nbsp;<span class="op" id="2722103">:=</span>&nbsp;<span class="builtintype" id="2722106">int</span><span class="op" id="2722109">(</span><span class="ident" id="2722110">t</span><span class="op" id="2722111">.</span><span class="ident" id="2722112">Weekday</span><span class="op" id="2722119">(</span><span class="op" id="2722120">)</span><span class="op" id="2722121">+</span><span class="num" id="2722122">6</span><span class="op" id="2722123">)</span>&nbsp;<span class="op" id="2722125">%</span>&nbsp;<span class="num" id="2722127">7</span>&nbsp;<span class="comment" id="2722129">//&nbsp;weekday&nbsp;but&nbsp;Monday&nbsp;=&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2722157">const</span>&nbsp;<span class="op" id="2722163">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722167">Mon</span>&nbsp;<span class="builtintype" id="2722171">int</span>&nbsp;<span class="op" id="2722175">=</span>&nbsp;<span class="ident" id="2722177">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722184">Tue</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722190">Wed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722196">Thu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722202">Fri</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722208">Sat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722214">Sun</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2722219">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2722223">//&nbsp;Calculate&nbsp;week&nbsp;as&nbsp;number&nbsp;of&nbsp;Mondays&nbsp;in&nbsp;year&nbsp;up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2722277">//&nbsp;and&nbsp;including&nbsp;today,&nbsp;plus&nbsp;1&nbsp;because&nbsp;the&nbsp;first&nbsp;week&nbsp;is&nbsp;week&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2722343">//&nbsp;Putting&nbsp;the&nbsp;+&nbsp;1&nbsp;inside&nbsp;the&nbsp;numerator&nbsp;as&nbsp;a&nbsp;+&nbsp;7&nbsp;keeps&nbsp;the</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2722403">//&nbsp;numerator&nbsp;from&nbsp;being&nbsp;negative,&nbsp;which&nbsp;would&nbsp;cause&nbsp;it&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2722462">//&nbsp;round&nbsp;incorrectly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722485">week</span>&nbsp;<span class="op" id="2722490">=</span>&nbsp;<span class="op" id="2722492">(</span><span class="ident" id="2722493">yday</span>&nbsp;<span class="op" id="2722498">-</span>&nbsp;<span class="ident" id="2722500">wday</span>&nbsp;<span class="op" id="2722505">+</span>&nbsp;<span class="num" id="2722507">7</span><span class="op" id="2722508">)</span>&nbsp;<span class="op" id="2722510">/</span>&nbsp;<span class="num" id="2722512">7</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2722516">//&nbsp;The&nbsp;week&nbsp;number&nbsp;is&nbsp;now&nbsp;correct&nbsp;under&nbsp;the&nbsp;assumption</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2722572">//&nbsp;that&nbsp;the&nbsp;first&nbsp;Monday&nbsp;of&nbsp;the&nbsp;year&nbsp;is&nbsp;in&nbsp;week&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2722624">//&nbsp;If&nbsp;Jan&nbsp;1&nbsp;is&nbsp;a&nbsp;Tuesday,&nbsp;Wednesday,&nbsp;or&nbsp;Thursday,&nbsp;the&nbsp;first&nbsp;Monday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2722692">//&nbsp;is&nbsp;actually&nbsp;in&nbsp;week&nbsp;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722719">jan1wday</span>&nbsp;<span class="op" id="2722728">:=</span>&nbsp;<span class="op" id="2722731">(</span><span class="ident" id="2722732">wday</span>&nbsp;<span class="op" id="2722737">-</span>&nbsp;<span class="ident" id="2722739">yday</span>&nbsp;<span class="op" id="2722744">+</span>&nbsp;<span class="num" id="2722746">7</span><span class="op" id="2722747">*</span><span class="num" id="2722748">53</span><span class="op" id="2722750">)</span>&nbsp;<span class="op" id="2722752">%</span>&nbsp;<span class="num" id="2722754">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2722757">if</span>&nbsp;<span class="ident" id="2722760">Tue</span>&nbsp;<span class="op" id="2722764">&lt;=</span>&nbsp;<span class="ident" id="2722767">jan1wday</span>&nbsp;<span class="op" id="2722776">&amp;&amp;</span>&nbsp;<span class="ident" id="2722779">jan1wday</span>&nbsp;<span class="op" id="2722788">&lt;=</span>&nbsp;<span class="ident" id="2722791">Thu</span>&nbsp;<span class="op" id="2722795">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722799">week</span><span class="op" id="2722803">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2722807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2722811">//&nbsp;If&nbsp;the&nbsp;week&nbsp;number&nbsp;is&nbsp;still&nbsp;0,&nbsp;we&#39;re&nbsp;in&nbsp;early&nbsp;January&nbsp;but&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2722876">//&nbsp;the&nbsp;last&nbsp;week&nbsp;of&nbsp;last&nbsp;year.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2722908">if</span>&nbsp;<span class="ident" id="2722911">week</span>&nbsp;<span class="op" id="2722916">==</span>&nbsp;<span class="num" id="2722919">0</span>&nbsp;<span class="op" id="2722921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722925">year</span><span class="op" id="2722929">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2722934">week</span>&nbsp;<span class="op" id="2722939">=</span>&nbsp;<span class="num" id="2722941">52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2722946">//&nbsp;A&nbsp;year&nbsp;has&nbsp;53&nbsp;weeks&nbsp;when&nbsp;Jan&nbsp;1&nbsp;or&nbsp;Dec&nbsp;31&nbsp;is&nbsp;a&nbsp;Thursday,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723007">//&nbsp;meaning&nbsp;Jan&nbsp;1&nbsp;of&nbsp;the&nbsp;next&nbsp;year&nbsp;is&nbsp;a&nbsp;Friday</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723055">//&nbsp;or&nbsp;it&nbsp;was&nbsp;a&nbsp;leap&nbsp;year&nbsp;and&nbsp;Jan&nbsp;1&nbsp;of&nbsp;the&nbsp;next&nbsp;year&nbsp;is&nbsp;a&nbsp;Saturday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723124">if</span>&nbsp;<span class="ident" id="2723127">jan1wday</span>&nbsp;<span class="op" id="2723136">==</span>&nbsp;<span class="ident" id="2723139">Fri</span>&nbsp;<span class="op" id="2723143">||</span>&nbsp;<span class="op" id="2723146">(</span><span class="ident" id="2723147">jan1wday</span>&nbsp;<span class="op" id="2723156">==</span>&nbsp;<span class="ident" id="2723159">Sat</span>&nbsp;<span class="op" id="2723163">&amp;&amp;</span>&nbsp;<span class="ident" id="2723166">isLeap</span><span class="op" id="2723172">(</span><span class="ident" id="2723173">year</span><span class="op" id="2723177">)</span><span class="op" id="2723178">)</span>&nbsp;<span class="op" id="2723180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723185">week</span><span class="op" id="2723189">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2723194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2723197">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723201">//&nbsp;December&nbsp;29&nbsp;to&nbsp;31&nbsp;are&nbsp;in&nbsp;week&nbsp;1&nbsp;of&nbsp;next&nbsp;year&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723253">//&nbsp;they&nbsp;are&nbsp;after&nbsp;the&nbsp;last&nbsp;Thursday&nbsp;of&nbsp;the&nbsp;year&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2723306">//&nbsp;December&nbsp;31&nbsp;is&nbsp;a&nbsp;Monday,&nbsp;Tuesday,&nbsp;or&nbsp;Wednesday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723358">if</span>&nbsp;<span class="ident" id="2723361">month</span>&nbsp;<span class="op" id="2723367">==</span>&nbsp;<span class="ident" id="2723370">December</span>&nbsp;<span class="op" id="2723379">&amp;&amp;</span>&nbsp;<span class="ident" id="2723382">day</span>&nbsp;<span class="op" id="2723386">&gt;=</span>&nbsp;<span class="num" id="2723389">29</span>&nbsp;<span class="op" id="2723392">&amp;&amp;</span>&nbsp;<span class="ident" id="2723395">wday</span>&nbsp;<span class="op" id="2723400">&lt;</span>&nbsp;<span class="ident" id="2723402">Thu</span>&nbsp;<span class="op" id="2723406">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723410">if</span>&nbsp;<span class="ident" id="2723413">dec31wday</span>&nbsp;<span class="op" id="2723423">:=</span>&nbsp;<span class="op" id="2723426">(</span><span class="ident" id="2723427">wday</span>&nbsp;<span class="op" id="2723432">+</span>&nbsp;<span class="num" id="2723434">31</span>&nbsp;<span class="op" id="2723437">-</span>&nbsp;<span class="ident" id="2723439">day</span><span class="op" id="2723442">)</span>&nbsp;<span class="op" id="2723444">%</span>&nbsp;<span class="num" id="2723446">7</span><span class="op" id="2723447">;</span>&nbsp;<span class="ident" id="2723449">Mon</span>&nbsp;<span class="op" id="2723453">&lt;=</span>&nbsp;<span class="ident" id="2723456">dec31wday</span>&nbsp;<span class="op" id="2723466">&amp;&amp;</span>&nbsp;<span class="ident" id="2723469">dec31wday</span>&nbsp;<span class="op" id="2723479">&lt;=</span>&nbsp;<span class="ident" id="2723482">Wed</span>&nbsp;<span class="op" id="2723486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723491">year</span><span class="op" id="2723495">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723501">week</span>&nbsp;<span class="op" id="2723506">=</span>&nbsp;<span class="num" id="2723508">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2723512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2723515">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723519">return</span><br>
<span class="lineno"></span><span class="op" id="2723526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2723529">//&nbsp;Clock&nbsp;returns&nbsp;the&nbsp;hour,&nbsp;minute,&nbsp;and&nbsp;second&nbsp;within&nbsp;the&nbsp;day&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno">385</span><span class="keyword" id="2723606">func</span>&nbsp;<span class="op" id="2723611">(</span><span class="ident" id="2723612">t</span>&nbsp;<span class="ident" id="2723614">Time</span><span class="op" id="2723618">)</span>&nbsp;<span class="ident" id="2723620">Clock</span><span class="op" id="2723625">(</span><span class="op" id="2723626">)</span>&nbsp;<span class="op" id="2723628">(</span><span class="ident" id="2723629">hour</span><span class="op" id="2723633">,</span>&nbsp;<span class="ident" id="2723635">min</span><span class="op" id="2723638">,</span>&nbsp;<span class="ident" id="2723640">sec</span>&nbsp;<span class="builtintype" id="2723644">int</span><span class="op" id="2723647">)</span>&nbsp;<span class="op" id="2723649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723652">return</span>&nbsp;<span class="ident" id="2723659">absClock</span><span class="op" id="2723667">(</span><span class="ident" id="2723668">t</span><span class="op" id="2723669">.</span><span class="ident" id="2723670">abs</span><span class="op" id="2723673">(</span><span class="op" id="2723674">)</span><span class="op" id="2723675">)</span><br>
<span class="lineno"></span><span class="op" id="2723677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2723680">//&nbsp;absClock&nbsp;is&nbsp;like&nbsp;clock&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="2723740">func</span>&nbsp;<span class="ident" id="2723745">absClock</span><span class="op" id="2723753">(</span><span class="ident" id="2723754">abs</span>&nbsp;<span class="ident" id="2723758">uint64</span><span class="op" id="2723764">)</span>&nbsp;<span class="op" id="2723766">(</span><span class="ident" id="2723767">hour</span><span class="op" id="2723771">,</span>&nbsp;<span class="ident" id="2723773">min</span><span class="op" id="2723776">,</span>&nbsp;<span class="ident" id="2723778">sec</span>&nbsp;<span class="builtintype" id="2723782">int</span><span class="op" id="2723785">)</span>&nbsp;<span class="op" id="2723787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723790">sec</span>&nbsp;<span class="op" id="2723794">=</span>&nbsp;<span class="builtintype" id="2723796">int</span><span class="op" id="2723799">(</span><span class="ident" id="2723800">abs</span>&nbsp;<span class="op" id="2723804">%</span>&nbsp;<span class="ident" id="2723806">secondsPerDay</span><span class="op" id="2723819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723822">hour</span>&nbsp;<span class="op" id="2723827">=</span>&nbsp;<span class="ident" id="2723829">sec</span>&nbsp;<span class="op" id="2723833">/</span>&nbsp;<span class="ident" id="2723835">secondsPerHour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723851">sec</span>&nbsp;<span class="op" id="2723855">-=</span>&nbsp;<span class="ident" id="2723858">hour</span>&nbsp;<span class="op" id="2723863">*</span>&nbsp;<span class="ident" id="2723865">secondsPerHour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723881">min</span>&nbsp;<span class="op" id="2723885">=</span>&nbsp;<span class="ident" id="2723887">sec</span>&nbsp;<span class="op" id="2723891">/</span>&nbsp;<span class="ident" id="2723893">secondsPerMinute</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2723911">sec</span>&nbsp;<span class="op" id="2723915">-=</span>&nbsp;<span class="ident" id="2723918">min</span>&nbsp;<span class="op" id="2723922">*</span>&nbsp;<span class="ident" id="2723924">secondsPerMinute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2723942">return</span><br>
<span class="lineno"></span><span class="op" id="2723949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2723952">//&nbsp;Hour&nbsp;returns&nbsp;the&nbsp;hour&nbsp;within&nbsp;the&nbsp;day&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;23].</span><br>
<span class="lineno">400</span><span class="keyword" id="2724030">func</span>&nbsp;<span class="op" id="2724035">(</span><span class="ident" id="2724036">t</span>&nbsp;<span class="ident" id="2724038">Time</span><span class="op" id="2724042">)</span>&nbsp;<span class="ident" id="2724044">Hour</span><span class="op" id="2724048">(</span><span class="op" id="2724049">)</span>&nbsp;<span class="builtintype" id="2724051">int</span>&nbsp;<span class="op" id="2724055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2724058">return</span>&nbsp;<span class="builtintype" id="2724065">int</span><span class="op" id="2724068">(</span><span class="ident" id="2724069">t</span><span class="op" id="2724070">.</span><span class="ident" id="2724071">abs</span><span class="op" id="2724074">(</span><span class="op" id="2724075">)</span><span class="op" id="2724076">%</span><span class="ident" id="2724077">secondsPerDay</span><span class="op" id="2724090">)</span>&nbsp;<span class="op" id="2724092">/</span>&nbsp;<span class="ident" id="2724094">secondsPerHour</span><br>
<span class="lineno"></span><span class="op" id="2724109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2724112">//&nbsp;Minute&nbsp;returns&nbsp;the&nbsp;minute&nbsp;offset&nbsp;within&nbsp;the&nbsp;hour&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;59].</span><br>
<span class="lineno">405</span><span class="keyword" id="2724202">func</span>&nbsp;<span class="op" id="2724207">(</span><span class="ident" id="2724208">t</span>&nbsp;<span class="ident" id="2724210">Time</span><span class="op" id="2724214">)</span>&nbsp;<span class="ident" id="2724216">Minute</span><span class="op" id="2724222">(</span><span class="op" id="2724223">)</span>&nbsp;<span class="builtintype" id="2724225">int</span>&nbsp;<span class="op" id="2724229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2724232">return</span>&nbsp;<span class="builtintype" id="2724239">int</span><span class="op" id="2724242">(</span><span class="ident" id="2724243">t</span><span class="op" id="2724244">.</span><span class="ident" id="2724245">abs</span><span class="op" id="2724248">(</span><span class="op" id="2724249">)</span><span class="op" id="2724250">%</span><span class="ident" id="2724251">secondsPerHour</span><span class="op" id="2724265">)</span>&nbsp;<span class="op" id="2724267">/</span>&nbsp;<span class="ident" id="2724269">secondsPerMinute</span><br>
<span class="lineno"></span><span class="op" id="2724286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2724289">//&nbsp;Second&nbsp;returns&nbsp;the&nbsp;second&nbsp;offset&nbsp;within&nbsp;the&nbsp;minute&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;59].</span><br>
<span class="lineno">410</span><span class="keyword" id="2724381">func</span>&nbsp;<span class="op" id="2724386">(</span><span class="ident" id="2724387">t</span>&nbsp;<span class="ident" id="2724389">Time</span><span class="op" id="2724393">)</span>&nbsp;<span class="ident" id="2724395">Second</span><span class="op" id="2724401">(</span><span class="op" id="2724402">)</span>&nbsp;<span class="builtintype" id="2724404">int</span>&nbsp;<span class="op" id="2724408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2724411">return</span>&nbsp;<span class="builtintype" id="2724418">int</span><span class="op" id="2724421">(</span><span class="ident" id="2724422">t</span><span class="op" id="2724423">.</span><span class="ident" id="2724424">abs</span><span class="op" id="2724427">(</span><span class="op" id="2724428">)</span>&nbsp;<span class="op" id="2724430">%</span>&nbsp;<span class="ident" id="2724432">secondsPerMinute</span><span class="op" id="2724448">)</span><br>
<span class="lineno"></span><span class="op" id="2724450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2724453">//&nbsp;Nanosecond&nbsp;returns&nbsp;the&nbsp;nanosecond&nbsp;offset&nbsp;within&nbsp;the&nbsp;second&nbsp;specified&nbsp;by&nbsp;t,</span><br>
<span class="lineno">415</span><span class="comment" id="2724531">//&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span><span class="keyword" id="2724563">func</span>&nbsp;<span class="op" id="2724568">(</span><span class="ident" id="2724569">t</span>&nbsp;<span class="ident" id="2724571">Time</span><span class="op" id="2724575">)</span>&nbsp;<span class="ident" id="2724577">Nanosecond</span><span class="op" id="2724587">(</span><span class="op" id="2724588">)</span>&nbsp;<span class="builtintype" id="2724590">int</span>&nbsp;<span class="op" id="2724594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2724597">return</span>&nbsp;<span class="builtintype" id="2724604">int</span><span class="op" id="2724607">(</span><span class="ident" id="2724608">t</span><span class="op" id="2724609">.</span><span class="ident" id="2724610">nsec</span><span class="op" id="2724614">)</span><br>
<span class="lineno"></span><span class="op" id="2724616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2724619">//&nbsp;YearDay&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;year&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[1,365]&nbsp;for&nbsp;non-leap&nbsp;years,</span><br>
<span class="lineno"></span><span class="comment" id="2724715">//&nbsp;and&nbsp;[1,366]&nbsp;in&nbsp;leap&nbsp;years.</span><br>
<span class="lineno"></span><span class="keyword" id="2724745">func</span>&nbsp;<span class="op" id="2724750">(</span><span class="ident" id="2724751">t</span>&nbsp;<span class="ident" id="2724753">Time</span><span class="op" id="2724757">)</span>&nbsp;<span class="ident" id="2724759">YearDay</span><span class="op" id="2724766">(</span><span class="op" id="2724767">)</span>&nbsp;<span class="builtintype" id="2724769">int</span>&nbsp;<span class="op" id="2724773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2724776">_</span><span class="op" id="2724777">,</span>&nbsp;<span class="ident" id="2724779">_</span><span class="op" id="2724780">,</span>&nbsp;<span class="ident" id="2724782">_</span><span class="op" id="2724783">,</span>&nbsp;<span class="ident" id="2724785">yday</span>&nbsp;<span class="op" id="2724790">:=</span>&nbsp;<span class="ident" id="2724793">t</span><span class="op" id="2724794">.</span><span class="ident" id="2724795">date</span><span class="op" id="2724799">(</span><span class="builtintype" id="2724800">false</span><span class="op" id="2724805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2724808">return</span>&nbsp;<span class="ident" id="2724815">yday</span>&nbsp;<span class="op" id="2724820">+</span>&nbsp;<span class="num" id="2724822">1</span><br>
<span class="lineno">425</span><span class="op" id="2724824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2724827">//&nbsp;A&nbsp;Duration&nbsp;represents&nbsp;the&nbsp;elapsed&nbsp;time&nbsp;between&nbsp;two&nbsp;instants</span><br>
<span class="lineno"></span><span class="comment" id="2724890">//&nbsp;as&nbsp;an&nbsp;int64&nbsp;nanosecond&nbsp;count.&nbsp;&nbsp;The&nbsp;representation&nbsp;limits&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2724954">//&nbsp;largest&nbsp;representable&nbsp;duration&nbsp;to&nbsp;approximately&nbsp;290&nbsp;years.</span><br>
<span class="lineno">430</span><span class="keyword" id="2725016">type</span>&nbsp;<span class="ident" id="2725021">Duration</span>&nbsp;<span class="ident" id="2725030">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2725037">const</span>&nbsp;<span class="op" id="2725043">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725046">minDuration</span>&nbsp;<span class="ident" id="2725058">Duration</span>&nbsp;<span class="op" id="2725067">=</span>&nbsp;<span class="op" id="2725069">-</span><span class="num" id="2725070">1</span>&nbsp;<span class="op" id="2725072">&lt;&lt;</span>&nbsp;<span class="num" id="2725075">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725079">maxDuration</span>&nbsp;<span class="ident" id="2725091">Duration</span>&nbsp;<span class="op" id="2725100">=</span>&nbsp;<span class="num" id="2725102">1</span><span class="op" id="2725103">&lt;&lt;</span><span class="num" id="2725105">63</span>&nbsp;<span class="op" id="2725108">-</span>&nbsp;<span class="num" id="2725110">1</span><br>
<span class="lineno">435</span><span class="op" id="2725112">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2725115">//&nbsp;Common&nbsp;durations.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;definition&nbsp;for&nbsp;units&nbsp;of&nbsp;Day&nbsp;or&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2725187">//&nbsp;to&nbsp;avoid&nbsp;confusion&nbsp;across&nbsp;daylight&nbsp;savings&nbsp;time&nbsp;zone&nbsp;transitions.</span><br>
<span class="lineno"></span><span class="comment" id="2725256">//</span><br>
<span class="lineno">440</span><span class="comment" id="2725259">//&nbsp;To&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;units&nbsp;in&nbsp;a&nbsp;Duration,&nbsp;divide:</span><br>
<span class="lineno"></span><span class="comment" id="2725314">//&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;time.Second</span><br>
<span class="lineno"></span><span class="comment" id="2725339">//&nbsp;&nbsp;&nbsp;&nbsp;fmt.Print(int64(second/time.Millisecond))&nbsp;//&nbsp;prints&nbsp;1000</span><br>
<span class="lineno"></span><span class="comment" id="2725399">//</span><br>
<span class="lineno"></span><span class="comment" id="2725402">//&nbsp;To&nbsp;convert&nbsp;an&nbsp;integer&nbsp;number&nbsp;of&nbsp;units&nbsp;to&nbsp;a&nbsp;Duration,&nbsp;multiply:</span><br>
<span class="lineno">445</span><span class="comment" id="2725468">//&nbsp;&nbsp;&nbsp;&nbsp;seconds&nbsp;:=&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2725485">//&nbsp;&nbsp;&nbsp;&nbsp;fmt.Print(time.Duration(seconds)*time.Second)&nbsp;//&nbsp;prints&nbsp;10s</span><br>
<span class="lineno"></span><span class="comment" id="2725548">//</span><br>
<span class="lineno"></span><span class="keyword" id="2725551">const</span>&nbsp;<span class="op" id="2725557">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725560">Nanosecond</span>&nbsp;&nbsp;<span class="ident" id="2725572">Duration</span>&nbsp;<span class="op" id="2725581">=</span>&nbsp;<span class="num" id="2725583">1</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725586">Microsecond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2725607">=</span>&nbsp;<span class="num" id="2725609">1000</span>&nbsp;<span class="op" id="2725614">*</span>&nbsp;<span class="ident" id="2725616">Nanosecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725628">Millisecond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2725649">=</span>&nbsp;<span class="num" id="2725651">1000</span>&nbsp;<span class="op" id="2725656">*</span>&nbsp;<span class="ident" id="2725658">Microsecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725671">Second</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2725692">=</span>&nbsp;<span class="num" id="2725694">1000</span>&nbsp;<span class="op" id="2725699">*</span>&nbsp;<span class="ident" id="2725701">Millisecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725714">Minute</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2725735">=</span>&nbsp;<span class="num" id="2725737">60</span>&nbsp;<span class="op" id="2725740">*</span>&nbsp;<span class="ident" id="2725742">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2725750">Hour</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2725771">=</span>&nbsp;<span class="num" id="2725773">60</span>&nbsp;<span class="op" id="2725776">*</span>&nbsp;<span class="ident" id="2725778">Minute</span><br>
<span class="lineno">455</span><span class="op" id="2725785">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2725788">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representing&nbsp;the&nbsp;duration&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;72h3m0.5s&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2725866">//&nbsp;Leading&nbsp;zero&nbsp;units&nbsp;are&nbsp;omitted.&nbsp;&nbsp;As&nbsp;a&nbsp;special&nbsp;case,&nbsp;durations&nbsp;less&nbsp;than&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="2725945">//&nbsp;second&nbsp;format&nbsp;use&nbsp;a&nbsp;smaller&nbsp;unit&nbsp;(milli-,&nbsp;micro-,&nbsp;or&nbsp;nanoseconds)&nbsp;to&nbsp;ensure</span><br>
<span class="lineno">460</span><span class="comment" id="2726024">//&nbsp;that&nbsp;the&nbsp;leading&nbsp;digit&nbsp;is&nbsp;non-zero.&nbsp;&nbsp;The&nbsp;zero&nbsp;duration&nbsp;formats&nbsp;as&nbsp;0,</span><br>
<span class="lineno"></span><span class="comment" id="2726096">//&nbsp;with&nbsp;no&nbsp;unit.</span><br>
<span class="lineno"></span><span class="keyword" id="2726113">func</span>&nbsp;<span class="op" id="2726118">(</span><span class="ident" id="2726119">d</span>&nbsp;<span class="ident" id="2726121">Duration</span><span class="op" id="2726129">)</span>&nbsp;<span class="ident" id="2726131">String</span><span class="op" id="2726137">(</span><span class="op" id="2726138">)</span>&nbsp;<span class="builtintype" id="2726140">string</span>&nbsp;<span class="op" id="2726147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2726150">//&nbsp;Largest&nbsp;time&nbsp;is&nbsp;2540400h10m10.000000000s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2726195">var</span>&nbsp;<span class="ident" id="2726199">buf</span>&nbsp;<span class="op" id="2726203">[</span><span class="num" id="2726204">32</span><span class="op" id="2726206">]</span><span class="builtintype" id="2726207">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726213">w</span>&nbsp;<span class="op" id="2726215">:=</span>&nbsp;<span class="builtinfunc" id="2726218">len</span><span class="op" id="2726221">(</span><span class="ident" id="2726222">buf</span><span class="op" id="2726225">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726229">u</span>&nbsp;<span class="op" id="2726231">:=</span>&nbsp;<span class="ident" id="2726234">uint64</span><span class="op" id="2726240">(</span><span class="ident" id="2726241">d</span><span class="op" id="2726242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726245">neg</span>&nbsp;<span class="op" id="2726249">:=</span>&nbsp;<span class="ident" id="2726252">d</span>&nbsp;<span class="op" id="2726254">&lt;</span>&nbsp;<span class="num" id="2726256">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2726259">if</span>&nbsp;<span class="ident" id="2726262">neg</span>&nbsp;<span class="op" id="2726266">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726270">u</span>&nbsp;<span class="op" id="2726272">=</span>&nbsp;<span class="op" id="2726274">-</span><span class="ident" id="2726275">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2726278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2726282">if</span>&nbsp;<span class="ident" id="2726285">u</span>&nbsp;<span class="op" id="2726287">&lt;</span>&nbsp;<span class="ident" id="2726289">uint64</span><span class="op" id="2726295">(</span><span class="ident" id="2726296">Second</span><span class="op" id="2726302">)</span>&nbsp;<span class="op" id="2726304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2726308">//&nbsp;Special&nbsp;case:&nbsp;if&nbsp;duration&nbsp;is&nbsp;smaller&nbsp;than&nbsp;a&nbsp;second,</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2726365">//&nbsp;use&nbsp;smaller&nbsp;units,&nbsp;like&nbsp;1.2ms</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2726400">var</span>&nbsp;<span class="ident" id="2726404">prec</span>&nbsp;<span class="builtintype" id="2726409">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726415">w</span><span class="op" id="2726416">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726421">buf</span><span class="op" id="2726424">[</span><span class="ident" id="2726425">w</span><span class="op" id="2726426">]</span>&nbsp;<span class="op" id="2726428">=</span>&nbsp;<span class="string" id="2726430">&#39;s&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726436">w</span><span class="op" id="2726437">--</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2726442">switch</span>&nbsp;<span class="op" id="2726449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2726453">case</span>&nbsp;<span class="ident" id="2726458">u</span>&nbsp;<span class="op" id="2726460">==</span>&nbsp;<span class="num" id="2726463">0</span><span class="op" id="2726464">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2726469">return</span>&nbsp;<span class="string" id="2726476">&#34;0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2726482">case</span>&nbsp;<span class="ident" id="2726487">u</span>&nbsp;<span class="op" id="2726489">&lt;</span>&nbsp;<span class="ident" id="2726491">uint64</span><span class="op" id="2726497">(</span><span class="ident" id="2726498">Microsecond</span><span class="op" id="2726509">)</span><span class="op" id="2726510">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2726515">//&nbsp;print&nbsp;nanoseconds</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726539">prec</span>&nbsp;<span class="op" id="2726544">=</span>&nbsp;<span class="num" id="2726546">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726551">buf</span><span class="op" id="2726554">[</span><span class="ident" id="2726555">w</span><span class="op" id="2726556">]</span>&nbsp;<span class="op" id="2726558">=</span>&nbsp;<span class="string" id="2726560">&#39;n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2726566">case</span>&nbsp;<span class="ident" id="2726571">u</span>&nbsp;<span class="op" id="2726573">&lt;</span>&nbsp;<span class="ident" id="2726575">uint64</span><span class="op" id="2726581">(</span><span class="ident" id="2726582">Millisecond</span><span class="op" id="2726593">)</span><span class="op" id="2726594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2726599">//&nbsp;print&nbsp;microseconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726624">prec</span>&nbsp;<span class="op" id="2726629">=</span>&nbsp;<span class="num" id="2726631">3</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2726636">//&nbsp;U+00B5&nbsp;&#39;µ&#39;&nbsp;micro&nbsp;sign&nbsp;==&nbsp;0xC2&nbsp;0xB5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726678">w</span><span class="op" id="2726679">--</span>&nbsp;<span class="comment" id="2726682">//&nbsp;Need&nbsp;room&nbsp;for&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2726713">copy</span><span class="op" id="2726717">(</span><span class="ident" id="2726718">buf</span><span class="op" id="2726721">[</span><span class="ident" id="2726722">w</span><span class="op" id="2726723">:</span><span class="op" id="2726724">]</span><span class="op" id="2726725">,</span>&nbsp;<span class="string" id="2726727">&#34;µ&#34;</span><span class="op" id="2726731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2726735">default</span><span class="op" id="2726742">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2726747">//&nbsp;print&nbsp;milliseconds</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726772">prec</span>&nbsp;<span class="op" id="2726777">=</span>&nbsp;<span class="num" id="2726779">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726784">buf</span><span class="op" id="2726787">[</span><span class="ident" id="2726788">w</span><span class="op" id="2726789">]</span>&nbsp;<span class="op" id="2726791">=</span>&nbsp;<span class="string" id="2726793">&#39;m&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2726799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726803">w</span><span class="op" id="2726804">,</span>&nbsp;<span class="ident" id="2726806">u</span>&nbsp;<span class="op" id="2726808">=</span>&nbsp;<span class="ident" id="2726810">fmtFrac</span><span class="op" id="2726817">(</span><span class="ident" id="2726818">buf</span><span class="op" id="2726821">[</span><span class="op" id="2726822">:</span><span class="ident" id="2726823">w</span><span class="op" id="2726824">]</span><span class="op" id="2726825">,</span>&nbsp;<span class="ident" id="2726827">u</span><span class="op" id="2726828">,</span>&nbsp;<span class="ident" id="2726830">prec</span><span class="op" id="2726834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726838">w</span>&nbsp;<span class="op" id="2726840">=</span>&nbsp;<span class="ident" id="2726842">fmtInt</span><span class="op" id="2726848">(</span><span class="ident" id="2726849">buf</span><span class="op" id="2726852">[</span><span class="op" id="2726853">:</span><span class="ident" id="2726854">w</span><span class="op" id="2726855">]</span><span class="op" id="2726856">,</span>&nbsp;<span class="ident" id="2726858">u</span><span class="op" id="2726859">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2726862">}</span>&nbsp;<span class="keyword" id="2726864">else</span>&nbsp;<span class="op" id="2726869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726873">w</span><span class="op" id="2726874">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726879">buf</span><span class="op" id="2726882">[</span><span class="ident" id="2726883">w</span><span class="op" id="2726884">]</span>&nbsp;<span class="op" id="2726886">=</span>&nbsp;<span class="string" id="2726888">&#39;s&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726895">w</span><span class="op" id="2726896">,</span>&nbsp;<span class="ident" id="2726898">u</span>&nbsp;<span class="op" id="2726900">=</span>&nbsp;<span class="ident" id="2726902">fmtFrac</span><span class="op" id="2726909">(</span><span class="ident" id="2726910">buf</span><span class="op" id="2726913">[</span><span class="op" id="2726914">:</span><span class="ident" id="2726915">w</span><span class="op" id="2726916">]</span><span class="op" id="2726917">,</span>&nbsp;<span class="ident" id="2726919">u</span><span class="op" id="2726920">,</span>&nbsp;<span class="num" id="2726922">9</span><span class="op" id="2726923">)</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2726928">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726958">w</span>&nbsp;<span class="op" id="2726960">=</span>&nbsp;<span class="ident" id="2726962">fmtInt</span><span class="op" id="2726968">(</span><span class="ident" id="2726969">buf</span><span class="op" id="2726972">[</span><span class="op" id="2726973">:</span><span class="ident" id="2726974">w</span><span class="op" id="2726975">]</span><span class="op" id="2726976">,</span>&nbsp;<span class="ident" id="2726978">u</span><span class="op" id="2726979">%</span><span class="num" id="2726980">60</span><span class="op" id="2726982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2726986">u</span>&nbsp;<span class="op" id="2726988">/=</span>&nbsp;<span class="num" id="2726991">60</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2726997">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2727027">if</span>&nbsp;<span class="ident" id="2727030">u</span>&nbsp;<span class="op" id="2727032">&gt;</span>&nbsp;<span class="num" id="2727034">0</span>&nbsp;<span class="op" id="2727036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727041">w</span><span class="op" id="2727042">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727048">buf</span><span class="op" id="2727051">[</span><span class="ident" id="2727052">w</span><span class="op" id="2727053">]</span>&nbsp;<span class="op" id="2727055">=</span>&nbsp;<span class="string" id="2727057">&#39;m&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727064">w</span>&nbsp;<span class="op" id="2727066">=</span>&nbsp;<span class="ident" id="2727068">fmtInt</span><span class="op" id="2727074">(</span><span class="ident" id="2727075">buf</span><span class="op" id="2727078">[</span><span class="op" id="2727079">:</span><span class="ident" id="2727080">w</span><span class="op" id="2727081">]</span><span class="op" id="2727082">,</span>&nbsp;<span class="ident" id="2727084">u</span><span class="op" id="2727085">%</span><span class="num" id="2727086">60</span><span class="op" id="2727088">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727093">u</span>&nbsp;<span class="op" id="2727095">/=</span>&nbsp;<span class="num" id="2727098">60</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2727105">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;hours</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2727134">//&nbsp;Stop&nbsp;at&nbsp;hours&nbsp;because&nbsp;days&nbsp;can&nbsp;be&nbsp;different&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2727193">if</span>&nbsp;<span class="ident" id="2727196">u</span>&nbsp;<span class="op" id="2727198">&gt;</span>&nbsp;<span class="num" id="2727200">0</span>&nbsp;<span class="op" id="2727202">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727208">w</span><span class="op" id="2727209">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727216">buf</span><span class="op" id="2727219">[</span><span class="ident" id="2727220">w</span><span class="op" id="2727221">]</span>&nbsp;<span class="op" id="2727223">=</span>&nbsp;<span class="string" id="2727225">&#39;h&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727233">w</span>&nbsp;<span class="op" id="2727235">=</span>&nbsp;<span class="ident" id="2727237">fmtInt</span><span class="op" id="2727243">(</span><span class="ident" id="2727244">buf</span><span class="op" id="2727247">[</span><span class="op" id="2727248">:</span><span class="ident" id="2727249">w</span><span class="op" id="2727250">]</span><span class="op" id="2727251">,</span>&nbsp;<span class="ident" id="2727253">u</span><span class="op" id="2727254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2727259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2727263">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2727266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2727270">if</span>&nbsp;<span class="ident" id="2727273">neg</span>&nbsp;<span class="op" id="2727277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727281">w</span><span class="op" id="2727282">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727287">buf</span><span class="op" id="2727290">[</span><span class="ident" id="2727291">w</span><span class="op" id="2727292">]</span>&nbsp;<span class="op" id="2727294">=</span>&nbsp;<span class="string" id="2727296">&#39;-&#39;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2727301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2727305">return</span>&nbsp;<span class="builtintype" id="2727312">string</span><span class="op" id="2727318">(</span><span class="ident" id="2727319">buf</span><span class="op" id="2727322">[</span><span class="ident" id="2727323">w</span><span class="op" id="2727324">:</span><span class="op" id="2727325">]</span><span class="op" id="2727326">)</span><br>
<span class="lineno"></span><span class="op" id="2727328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="2727331">//&nbsp;fmtFrac&nbsp;formats&nbsp;the&nbsp;fraction&nbsp;of&nbsp;v/10**prec&nbsp;(e.g.,&nbsp;&#34;.12345&#34;)&nbsp;into&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2727403">//&nbsp;tail&nbsp;of&nbsp;buf,&nbsp;omitting&nbsp;trailing&nbsp;zeros.&nbsp;&nbsp;it&nbsp;omits&nbsp;the&nbsp;decimal</span><br>
<span class="lineno"></span><span class="comment" id="2727466">//&nbsp;point&nbsp;too&nbsp;when&nbsp;the&nbsp;fraction&nbsp;is&nbsp;0.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2727535">//&nbsp;output&nbsp;bytes&nbsp;begin&nbsp;and&nbsp;the&nbsp;value&nbsp;v/10**prec.</span><br>
<span class="lineno"></span><span class="keyword" id="2727583">func</span>&nbsp;<span class="ident" id="2727588">fmtFrac</span><span class="op" id="2727595">(</span><span class="ident" id="2727596">buf</span>&nbsp;<span class="op" id="2727600">[</span><span class="op" id="2727601">]</span><span class="builtintype" id="2727602">byte</span><span class="op" id="2727606">,</span>&nbsp;<span class="ident" id="2727608">v</span>&nbsp;<span class="ident" id="2727610">uint64</span><span class="op" id="2727616">,</span>&nbsp;<span class="ident" id="2727618">prec</span>&nbsp;<span class="builtintype" id="2727623">int</span><span class="op" id="2727626">)</span>&nbsp;<span class="op" id="2727628">(</span><span class="ident" id="2727629">nw</span>&nbsp;<span class="builtintype" id="2727632">int</span><span class="op" id="2727635">,</span>&nbsp;<span class="ident" id="2727637">nv</span>&nbsp;<span class="ident" id="2727640">uint64</span><span class="op" id="2727646">)</span>&nbsp;<span class="op" id="2727648">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2727651">//&nbsp;Omit&nbsp;trailing&nbsp;zeros&nbsp;up&nbsp;to&nbsp;and&nbsp;including&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727710">w</span>&nbsp;<span class="op" id="2727712">:=</span>&nbsp;<span class="builtinfunc" id="2727715">len</span><span class="op" id="2727718">(</span><span class="ident" id="2727719">buf</span><span class="op" id="2727722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2727725">print</span>&nbsp;<span class="op" id="2727731">:=</span>&nbsp;<span class="builtintype" id="2727734">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2727741">for</span>&nbsp;<span class="ident" id="2727745">i</span>&nbsp;<span class="op" id="2727747">:=</span>&nbsp;<span class="num" id="2727750">0</span><span class="op" id="2727751">;</span>&nbsp;<span class="ident" id="2727753">i</span>&nbsp;<span class="op" id="2727755">&lt;</span>&nbsp;<span class="ident" id="2727757">prec</span><span class="op" id="2727761">;</span>&nbsp;<span class="ident" id="2727763">i</span><span class="op" id="2727764">++</span>&nbsp;<span class="op" id="2727767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727771">digit</span>&nbsp;<span class="op" id="2727777">:=</span>&nbsp;<span class="ident" id="2727780">v</span>&nbsp;<span class="op" id="2727782">%</span>&nbsp;<span class="num" id="2727784">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2727789">print</span>&nbsp;<span class="op" id="2727795">=</span>&nbsp;<span class="builtinfunc" id="2727797">print</span>&nbsp;<span class="op" id="2727803">||</span>&nbsp;<span class="ident" id="2727806">digit</span>&nbsp;<span class="op" id="2727812">!=</span>&nbsp;<span class="num" id="2727815">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2727819">if</span>&nbsp;<span class="builtinfunc" id="2727822">print</span>&nbsp;<span class="op" id="2727828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727833">w</span><span class="op" id="2727834">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727840">buf</span><span class="op" id="2727843">[</span><span class="ident" id="2727844">w</span><span class="op" id="2727845">]</span>&nbsp;<span class="op" id="2727847">=</span>&nbsp;<span class="builtintype" id="2727849">byte</span><span class="op" id="2727853">(</span><span class="ident" id="2727854">digit</span><span class="op" id="2727859">)</span>&nbsp;<span class="op" id="2727861">+</span>&nbsp;<span class="string" id="2727863">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2727869">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727873">v</span>&nbsp;<span class="op" id="2727875">/=</span>&nbsp;<span class="num" id="2727878">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2727882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2727885">if</span>&nbsp;<span class="builtinfunc" id="2727888">print</span>&nbsp;<span class="op" id="2727894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727898">w</span><span class="op" id="2727899">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2727904">buf</span><span class="op" id="2727907">[</span><span class="ident" id="2727908">w</span><span class="op" id="2727909">]</span>&nbsp;<span class="op" id="2727911">=</span>&nbsp;<span class="string" id="2727913">&#39;.&#39;</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2727918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2727921">return</span>&nbsp;<span class="ident" id="2727928">w</span><span class="op" id="2727929">,</span>&nbsp;<span class="ident" id="2727931">v</span><br>
<span class="lineno"></span><span class="op" id="2727933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2727936">//&nbsp;fmtInt&nbsp;formats&nbsp;v&nbsp;into&nbsp;the&nbsp;tail&nbsp;of&nbsp;buf.</span><br>
<span class="lineno">560</span><span class="comment" id="2727978">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;where&nbsp;the&nbsp;output&nbsp;begins.</span><br>
<span class="lineno"></span><span class="keyword" id="2728027">func</span>&nbsp;<span class="ident" id="2728032">fmtInt</span><span class="op" id="2728038">(</span><span class="ident" id="2728039">buf</span>&nbsp;<span class="op" id="2728043">[</span><span class="op" id="2728044">]</span><span class="builtintype" id="2728045">byte</span><span class="op" id="2728049">,</span>&nbsp;<span class="ident" id="2728051">v</span>&nbsp;<span class="ident" id="2728053">uint64</span><span class="op" id="2728059">)</span>&nbsp;<span class="builtintype" id="2728061">int</span>&nbsp;<span class="op" id="2728065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2728068">w</span>&nbsp;<span class="op" id="2728070">:=</span>&nbsp;<span class="builtinfunc" id="2728073">len</span><span class="op" id="2728076">(</span><span class="ident" id="2728077">buf</span><span class="op" id="2728080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2728083">if</span>&nbsp;<span class="ident" id="2728086">v</span>&nbsp;<span class="op" id="2728088">==</span>&nbsp;<span class="num" id="2728091">0</span>&nbsp;<span class="op" id="2728093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2728097">w</span><span class="op" id="2728098">--</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2728103">buf</span><span class="op" id="2728106">[</span><span class="ident" id="2728107">w</span><span class="op" id="2728108">]</span>&nbsp;<span class="op" id="2728110">=</span>&nbsp;<span class="string" id="2728112">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2728117">}</span>&nbsp;<span class="keyword" id="2728119">else</span>&nbsp;<span class="op" id="2728124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2728128">for</span>&nbsp;<span class="ident" id="2728132">v</span>&nbsp;<span class="op" id="2728134">&gt;</span>&nbsp;<span class="num" id="2728136">0</span>&nbsp;<span class="op" id="2728138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2728143">w</span><span class="op" id="2728144">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2728150">buf</span><span class="op" id="2728153">[</span><span class="ident" id="2728154">w</span><span class="op" id="2728155">]</span>&nbsp;<span class="op" id="2728157">=</span>&nbsp;<span class="builtintype" id="2728159">byte</span><span class="op" id="2728163">(</span><span class="ident" id="2728164">v</span><span class="op" id="2728165">%</span><span class="num" id="2728166">10</span><span class="op" id="2728168">)</span>&nbsp;<span class="op" id="2728170">+</span>&nbsp;<span class="string" id="2728172">&#39;0&#39;</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2728179">v</span>&nbsp;<span class="op" id="2728181">/=</span>&nbsp;<span class="num" id="2728184">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2728189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2728192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2728195">return</span>&nbsp;<span class="ident" id="2728202">w</span><br>
<span class="lineno"></span><span class="op" id="2728204">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="2728207">//&nbsp;Nanoseconds&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;an&nbsp;integer&nbsp;nanosecond&nbsp;count.</span><br>
<span class="lineno"></span><span class="keyword" id="2728275">func</span>&nbsp;<span class="op" id="2728280">(</span><span class="ident" id="2728281">d</span>&nbsp;<span class="ident" id="2728283">Duration</span><span class="op" id="2728291">)</span>&nbsp;<span class="ident" id="2728293">Nanoseconds</span><span class="op" id="2728304">(</span><span class="op" id="2728305">)</span>&nbsp;<span class="ident" id="2728307">int64</span>&nbsp;<span class="op" id="2728313">{</span>&nbsp;<span class="keyword" id="2728315">return</span>&nbsp;<span class="ident" id="2728322">int64</span><span class="op" id="2728327">(</span><span class="ident" id="2728328">d</span><span class="op" id="2728329">)</span>&nbsp;<span class="op" id="2728331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2728334">//&nbsp;These&nbsp;methods&nbsp;return&nbsp;float64&nbsp;because&nbsp;the&nbsp;dominant</span><br>
<span class="lineno">580</span><span class="comment" id="2728387">//&nbsp;use&nbsp;case&nbsp;is&nbsp;for&nbsp;printing&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;like&nbsp;1.5s,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2728454">//&nbsp;a&nbsp;truncation&nbsp;to&nbsp;integer&nbsp;would&nbsp;make&nbsp;them&nbsp;not&nbsp;useful&nbsp;in&nbsp;those&nbsp;cases.</span><br>
<span class="lineno"></span><span class="comment" id="2728524">//&nbsp;Splitting&nbsp;the&nbsp;integer&nbsp;and&nbsp;fraction&nbsp;ourselves&nbsp;guarantees&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2728588">//&nbsp;converting&nbsp;the&nbsp;returned&nbsp;float64&nbsp;to&nbsp;an&nbsp;integer&nbsp;rounds&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2728653">//&nbsp;way&nbsp;that&nbsp;a&nbsp;pure&nbsp;integer&nbsp;conversion&nbsp;would&nbsp;have,&nbsp;even&nbsp;in&nbsp;cases</span><br>
<span class="lineno">585</span><span class="comment" id="2728717">//&nbsp;where,&nbsp;say,&nbsp;float64(d.Nanoseconds())/1e9&nbsp;would&nbsp;have&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2728780">//&nbsp;differently.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2728797">//&nbsp;Seconds&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;seconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2728868">func</span>&nbsp;<span class="op" id="2728873">(</span><span class="ident" id="2728874">d</span>&nbsp;<span class="ident" id="2728876">Duration</span><span class="op" id="2728884">)</span>&nbsp;<span class="ident" id="2728886">Seconds</span><span class="op" id="2728893">(</span><span class="op" id="2728894">)</span>&nbsp;<span class="builtintype" id="2728896">float64</span>&nbsp;<span class="op" id="2728904">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2728907">sec</span>&nbsp;<span class="op" id="2728911">:=</span>&nbsp;<span class="ident" id="2728914">d</span>&nbsp;<span class="op" id="2728916">/</span>&nbsp;<span class="ident" id="2728918">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2728926">nsec</span>&nbsp;<span class="op" id="2728931">:=</span>&nbsp;<span class="ident" id="2728934">d</span>&nbsp;<span class="op" id="2728936">%</span>&nbsp;<span class="ident" id="2728938">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2728946">return</span>&nbsp;<span class="builtintype" id="2728953">float64</span><span class="op" id="2728960">(</span><span class="ident" id="2728961">sec</span><span class="op" id="2728964">)</span>&nbsp;<span class="op" id="2728966">+</span>&nbsp;<span class="builtintype" id="2728968">float64</span><span class="op" id="2728975">(</span><span class="ident" id="2728976">nsec</span><span class="op" id="2728980">)</span><span class="op" id="2728981">*</span><span class="num" id="2728982">1e-9</span><br>
<span class="lineno"></span><span class="op" id="2728987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="2728990">//&nbsp;Minutes&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;minutes.</span><br>
<span class="lineno"></span><span class="keyword" id="2729061">func</span>&nbsp;<span class="op" id="2729066">(</span><span class="ident" id="2729067">d</span>&nbsp;<span class="ident" id="2729069">Duration</span><span class="op" id="2729077">)</span>&nbsp;<span class="ident" id="2729079">Minutes</span><span class="op" id="2729086">(</span><span class="op" id="2729087">)</span>&nbsp;<span class="builtintype" id="2729089">float64</span>&nbsp;<span class="op" id="2729097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2729100">min</span>&nbsp;<span class="op" id="2729104">:=</span>&nbsp;<span class="ident" id="2729107">d</span>&nbsp;<span class="op" id="2729109">/</span>&nbsp;<span class="ident" id="2729111">Minute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2729119">nsec</span>&nbsp;<span class="op" id="2729124">:=</span>&nbsp;<span class="ident" id="2729127">d</span>&nbsp;<span class="op" id="2729129">%</span>&nbsp;<span class="ident" id="2729131">Minute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2729139">return</span>&nbsp;<span class="builtintype" id="2729146">float64</span><span class="op" id="2729153">(</span><span class="ident" id="2729154">min</span><span class="op" id="2729157">)</span>&nbsp;<span class="op" id="2729159">+</span>&nbsp;<span class="builtintype" id="2729161">float64</span><span class="op" id="2729168">(</span><span class="ident" id="2729169">nsec</span><span class="op" id="2729173">)</span><span class="op" id="2729174">*</span><span class="op" id="2729175">(</span><span class="num" id="2729176">1e-9</span><span class="op" id="2729180">/</span><span class="num" id="2729181">60</span><span class="op" id="2729183">)</span><br>
<span class="lineno">600</span><span class="op" id="2729185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2729188">//&nbsp;Hours&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;hours.</span><br>
<span class="lineno"></span><span class="keyword" id="2729255">func</span>&nbsp;<span class="op" id="2729260">(</span><span class="ident" id="2729261">d</span>&nbsp;<span class="ident" id="2729263">Duration</span><span class="op" id="2729271">)</span>&nbsp;<span class="ident" id="2729273">Hours</span><span class="op" id="2729278">(</span><span class="op" id="2729279">)</span>&nbsp;<span class="builtintype" id="2729281">float64</span>&nbsp;<span class="op" id="2729289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2729292">hour</span>&nbsp;<span class="op" id="2729297">:=</span>&nbsp;<span class="ident" id="2729300">d</span>&nbsp;<span class="op" id="2729302">/</span>&nbsp;<span class="ident" id="2729304">Hour</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2729310">nsec</span>&nbsp;<span class="op" id="2729315">:=</span>&nbsp;<span class="ident" id="2729318">d</span>&nbsp;<span class="op" id="2729320">%</span>&nbsp;<span class="ident" id="2729322">Hour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2729328">return</span>&nbsp;<span class="builtintype" id="2729335">float64</span><span class="op" id="2729342">(</span><span class="ident" id="2729343">hour</span><span class="op" id="2729347">)</span>&nbsp;<span class="op" id="2729349">+</span>&nbsp;<span class="builtintype" id="2729351">float64</span><span class="op" id="2729358">(</span><span class="ident" id="2729359">nsec</span><span class="op" id="2729363">)</span><span class="op" id="2729364">*</span><span class="op" id="2729365">(</span><span class="num" id="2729366">1e-9</span><span class="op" id="2729370">/</span><span class="num" id="2729371">60</span><span class="op" id="2729373">/</span><span class="num" id="2729374">60</span><span class="op" id="2729376">)</span><br>
<span class="lineno"></span><span class="op" id="2729378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2729381">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;time&nbsp;t+d.</span><br>
<span class="lineno">610</span><span class="keyword" id="2729410">func</span>&nbsp;<span class="op" id="2729415">(</span><span class="ident" id="2729416">t</span>&nbsp;<span class="ident" id="2729418">Time</span><span class="op" id="2729422">)</span>&nbsp;<span class="ident" id="2729424">Add</span><span class="op" id="2729427">(</span><span class="ident" id="2729428">d</span>&nbsp;<span class="ident" id="2729430">Duration</span><span class="op" id="2729438">)</span>&nbsp;<span class="ident" id="2729440">Time</span>&nbsp;<span class="op" id="2729445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2729448">t</span><span class="op" id="2729449">.</span><span class="ident" id="2729450">sec</span>&nbsp;<span class="op" id="2729454">+=</span>&nbsp;<span class="ident" id="2729457">int64</span><span class="op" id="2729462">(</span><span class="ident" id="2729463">d</span>&nbsp;<span class="op" id="2729465">/</span>&nbsp;<span class="num" id="2729467">1e9</span><span class="op" id="2729470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2729473">nsec</span>&nbsp;<span class="op" id="2729478">:=</span>&nbsp;<span class="builtintype" id="2729481">int32</span><span class="op" id="2729486">(</span><span class="ident" id="2729487">t</span><span class="op" id="2729488">.</span><span class="ident" id="2729489">nsec</span><span class="op" id="2729493">)</span>&nbsp;<span class="op" id="2729495">+</span>&nbsp;<span class="builtintype" id="2729497">int32</span><span class="op" id="2729502">(</span><span class="ident" id="2729503">d</span><span class="op" id="2729504">%</span><span class="num" id="2729505">1e9</span><span class="op" id="2729508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2729511">if</span>&nbsp;<span class="ident" id="2729514">nsec</span>&nbsp;<span class="op" id="2729519">&gt;=</span>&nbsp;<span class="num" id="2729522">1e9</span>&nbsp;<span class="op" id="2729526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2729530">t</span><span class="op" id="2729531">.</span><span class="ident" id="2729532">sec</span><span class="op" id="2729535">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2729540">nsec</span>&nbsp;<span class="op" id="2729545">-=</span>&nbsp;<span class="num" id="2729548">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2729553">}</span>&nbsp;<span class="keyword" id="2729555">else</span>&nbsp;<span class="keyword" id="2729560">if</span>&nbsp;<span class="ident" id="2729563">nsec</span>&nbsp;<span class="op" id="2729568">&lt;</span>&nbsp;<span class="num" id="2729570">0</span>&nbsp;<span class="op" id="2729572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2729576">t</span><span class="op" id="2729577">.</span><span class="ident" id="2729578">sec</span><span class="op" id="2729581">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2729586">nsec</span>&nbsp;<span class="op" id="2729591">+=</span>&nbsp;<span class="num" id="2729594">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2729599">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2729602">t</span><span class="op" id="2729603">.</span><span class="ident" id="2729604">nsec</span>&nbsp;<span class="op" id="2729609">=</span>&nbsp;<span class="ident" id="2729611">nsec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2729617">return</span>&nbsp;<span class="ident" id="2729624">t</span><br>
<span class="lineno"></span><span class="op" id="2729626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2729629">//&nbsp;Sub&nbsp;returns&nbsp;the&nbsp;duration&nbsp;t-u.&nbsp;If&nbsp;the&nbsp;result&nbsp;exceeds&nbsp;the&nbsp;maximum&nbsp;(or&nbsp;minimum)</span><br>
<span class="lineno">625</span><span class="comment" id="2729709">//&nbsp;value&nbsp;that&nbsp;can&nbsp;be&nbsp;stored&nbsp;in&nbsp;a&nbsp;Duration,&nbsp;the&nbsp;maximum&nbsp;(or&nbsp;minimum)&nbsp;duration</span><br>
<span class="lineno"></span><span class="comment" id="2729786">//&nbsp;will&nbsp;be&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="2729807">//&nbsp;To&nbsp;compute&nbsp;t-d&nbsp;for&nbsp;a&nbsp;duration&nbsp;d,&nbsp;use&nbsp;t.Add(-d).</span><br>
<span class="lineno"></span><span class="keyword" id="2729858">func</span>&nbsp;<span class="op" id="2729863">(</span><span class="ident" id="2729864">t</span>&nbsp;<span class="ident" id="2729866">Time</span><span class="op" id="2729870">)</span>&nbsp;<span class="ident" id="2729872">Sub</span><span class="op" id="2729875">(</span><span class="ident" id="2729876">u</span>&nbsp;<span class="ident" id="2729878">Time</span><span class="op" id="2729882">)</span>&nbsp;<span class="ident" id="2729884">Duration</span>&nbsp;<span class="op" id="2729893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2729896">d</span>&nbsp;<span class="op" id="2729898">:=</span>&nbsp;<span class="ident" id="2729901">Duration</span><span class="op" id="2729909">(</span><span class="ident" id="2729910">t</span><span class="op" id="2729911">.</span><span class="ident" id="2729912">sec</span><span class="op" id="2729915">-</span><span class="ident" id="2729916">u</span><span class="op" id="2729917">.</span><span class="ident" id="2729918">sec</span><span class="op" id="2729921">)</span><span class="op" id="2729922">*</span><span class="ident" id="2729923">Second</span>&nbsp;<span class="op" id="2729930">+</span>&nbsp;<span class="ident" id="2729932">Duration</span><span class="op" id="2729940">(</span><span class="builtintype" id="2729941">int32</span><span class="op" id="2729946">(</span><span class="ident" id="2729947">t</span><span class="op" id="2729948">.</span><span class="ident" id="2729949">nsec</span><span class="op" id="2729953">)</span><span class="op" id="2729954">-</span><span class="builtintype" id="2729955">int32</span><span class="op" id="2729960">(</span><span class="ident" id="2729961">u</span><span class="op" id="2729962">.</span><span class="ident" id="2729963">nsec</span><span class="op" id="2729967">)</span><span class="op" id="2729968">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2729971">//&nbsp;Check&nbsp;for&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2730008">switch</span>&nbsp;<span class="op" id="2730015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2730018">case</span>&nbsp;<span class="ident" id="2730023">u</span><span class="op" id="2730024">.</span><span class="ident" id="2730025">Add</span><span class="op" id="2730028">(</span><span class="ident" id="2730029">d</span><span class="op" id="2730030">)</span><span class="op" id="2730031">.</span><span class="ident" id="2730032">Equal</span><span class="op" id="2730037">(</span><span class="ident" id="2730038">t</span><span class="op" id="2730039">)</span><span class="op" id="2730040">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2730044">return</span>&nbsp;<span class="ident" id="2730051">d</span>&nbsp;<span class="comment" id="2730053">//&nbsp;d&nbsp;is&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2730070">case</span>&nbsp;<span class="ident" id="2730075">t</span><span class="op" id="2730076">.</span><span class="ident" id="2730077">Before</span><span class="op" id="2730083">(</span><span class="ident" id="2730084">u</span><span class="op" id="2730085">)</span><span class="op" id="2730086">:</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2730090">return</span>&nbsp;<span class="ident" id="2730097">minDuration</span>&nbsp;<span class="comment" id="2730109">//&nbsp;t&nbsp;-&nbsp;u&nbsp;is&nbsp;negative&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2730144">default</span><span class="op" id="2730151">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2730155">return</span>&nbsp;<span class="ident" id="2730162">maxDuration</span>&nbsp;<span class="comment" id="2730174">//&nbsp;t&nbsp;-&nbsp;u&nbsp;is&nbsp;positive&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2730209">}</span><br>
<span class="lineno"></span><span class="op" id="2730211">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2730214">//&nbsp;Since&nbsp;returns&nbsp;the&nbsp;time&nbsp;elapsed&nbsp;since&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2730257">//&nbsp;It&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;time.Now().Sub(t).</span><br>
<span class="lineno"></span><span class="keyword" id="2730299">func</span>&nbsp;<span class="ident" id="2730304">Since</span><span class="op" id="2730309">(</span><span class="ident" id="2730310">t</span>&nbsp;<span class="ident" id="2730312">Time</span><span class="op" id="2730316">)</span>&nbsp;<span class="ident" id="2730318">Duration</span>&nbsp;<span class="op" id="2730327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2730330">return</span>&nbsp;<span class="ident" id="2730337">Now</span><span class="op" id="2730340">(</span><span class="op" id="2730341">)</span><span class="op" id="2730342">.</span><span class="ident" id="2730343">Sub</span><span class="op" id="2730346">(</span><span class="ident" id="2730347">t</span><span class="op" id="2730348">)</span><br>
<span class="lineno">645</span><span class="op" id="2730350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2730353">//&nbsp;AddDate&nbsp;returns&nbsp;the&nbsp;time&nbsp;corresponding&nbsp;to&nbsp;adding&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2730409">//&nbsp;given&nbsp;number&nbsp;of&nbsp;years,&nbsp;months,&nbsp;and&nbsp;days&nbsp;to&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2730458">//&nbsp;For&nbsp;example,&nbsp;AddDate(-1,&nbsp;2,&nbsp;3)&nbsp;applied&nbsp;to&nbsp;January&nbsp;1,&nbsp;2011</span><br>
<span class="lineno">650</span><span class="comment" id="2730519">//&nbsp;returns&nbsp;March&nbsp;4,&nbsp;2010.</span><br>
<span class="lineno"></span><span class="comment" id="2730545">//</span><br>
<span class="lineno"></span><span class="comment" id="2730548">//&nbsp;AddDate&nbsp;normalizes&nbsp;its&nbsp;result&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;that&nbsp;Date&nbsp;does,</span><br>
<span class="lineno"></span><span class="comment" id="2730613">//&nbsp;so,&nbsp;for&nbsp;example,&nbsp;adding&nbsp;one&nbsp;month&nbsp;to&nbsp;October&nbsp;31&nbsp;yields</span><br>
<span class="lineno"></span><span class="comment" id="2730671">//&nbsp;December&nbsp;1,&nbsp;the&nbsp;normalized&nbsp;form&nbsp;for&nbsp;November&nbsp;31.</span><br>
<span class="lineno">655</span><span class="keyword" id="2730723">func</span>&nbsp;<span class="op" id="2730728">(</span><span class="ident" id="2730729">t</span>&nbsp;<span class="ident" id="2730731">Time</span><span class="op" id="2730735">)</span>&nbsp;<span class="ident" id="2730737">AddDate</span><span class="op" id="2730744">(</span><span class="ident" id="2730745">years</span>&nbsp;<span class="builtintype" id="2730751">int</span><span class="op" id="2730754">,</span>&nbsp;<span class="ident" id="2730756">months</span>&nbsp;<span class="builtintype" id="2730763">int</span><span class="op" id="2730766">,</span>&nbsp;<span class="ident" id="2730768">days</span>&nbsp;<span class="builtintype" id="2730773">int</span><span class="op" id="2730776">)</span>&nbsp;<span class="ident" id="2730778">Time</span>&nbsp;<span class="op" id="2730783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2730786">year</span><span class="op" id="2730790">,</span>&nbsp;<span class="ident" id="2730792">month</span><span class="op" id="2730797">,</span>&nbsp;<span class="ident" id="2730799">day</span>&nbsp;<span class="op" id="2730803">:=</span>&nbsp;<span class="ident" id="2730806">t</span><span class="op" id="2730807">.</span><span class="ident" id="2730808">Date</span><span class="op" id="2730812">(</span><span class="op" id="2730813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2730816">hour</span><span class="op" id="2730820">,</span>&nbsp;<span class="ident" id="2730822">min</span><span class="op" id="2730825">,</span>&nbsp;<span class="ident" id="2730827">sec</span>&nbsp;<span class="op" id="2730831">:=</span>&nbsp;<span class="ident" id="2730834">t</span><span class="op" id="2730835">.</span><span class="ident" id="2730836">Clock</span><span class="op" id="2730841">(</span><span class="op" id="2730842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2730845">return</span>&nbsp;<span class="ident" id="2730852">Date</span><span class="op" id="2730856">(</span><span class="ident" id="2730857">year</span><span class="op" id="2730861">+</span><span class="ident" id="2730862">years</span><span class="op" id="2730867">,</span>&nbsp;<span class="ident" id="2730869">month</span><span class="op" id="2730874">+</span><span class="ident" id="2730875">Month</span><span class="op" id="2730880">(</span><span class="ident" id="2730881">months</span><span class="op" id="2730887">)</span><span class="op" id="2730888">,</span>&nbsp;<span class="ident" id="2730890">day</span><span class="op" id="2730893">+</span><span class="ident" id="2730894">days</span><span class="op" id="2730898">,</span>&nbsp;<span class="ident" id="2730900">hour</span><span class="op" id="2730904">,</span>&nbsp;<span class="ident" id="2730906">min</span><span class="op" id="2730909">,</span>&nbsp;<span class="ident" id="2730911">sec</span><span class="op" id="2730914">,</span>&nbsp;<span class="builtintype" id="2730916">int</span><span class="op" id="2730919">(</span><span class="ident" id="2730920">t</span><span class="op" id="2730921">.</span><span class="ident" id="2730922">nsec</span><span class="op" id="2730926">)</span><span class="op" id="2730927">,</span>&nbsp;<span class="ident" id="2730929">t</span><span class="op" id="2730930">.</span><span class="ident" id="2730931">loc</span><span class="op" id="2730934">)</span><br>
<span class="lineno"></span><span class="op" id="2730936">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="keyword" id="2730939">const</span>&nbsp;<span class="op" id="2730945">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2730948">secondsPerMinute</span>&nbsp;<span class="op" id="2730965">=</span>&nbsp;<span class="num" id="2730967">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2730971">secondsPerHour</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2730988">=</span>&nbsp;<span class="num" id="2730990">60</span>&nbsp;<span class="op" id="2730993">*</span>&nbsp;<span class="num" id="2730995">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2730999">secondsPerDay</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2731016">=</span>&nbsp;<span class="num" id="2731018">24</span>&nbsp;<span class="op" id="2731021">*</span>&nbsp;<span class="ident" id="2731023">secondsPerHour</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2731039">secondsPerWeek</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2731056">=</span>&nbsp;<span class="num" id="2731058">7</span>&nbsp;<span class="op" id="2731060">*</span>&nbsp;<span class="ident" id="2731062">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2731077">daysPer400Years</span>&nbsp;&nbsp;<span class="op" id="2731094">=</span>&nbsp;<span class="num" id="2731096">365</span><span class="op" id="2731099">*</span><span class="num" id="2731100">400</span>&nbsp;<span class="op" id="2731104">+</span>&nbsp;<span class="num" id="2731106">97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2731110">daysPer100Years</span>&nbsp;&nbsp;<span class="op" id="2731127">=</span>&nbsp;<span class="num" id="2731129">365</span><span class="op" id="2731132">*</span><span class="num" id="2731133">100</span>&nbsp;<span class="op" id="2731137">+</span>&nbsp;<span class="num" id="2731139">24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2731143">daysPer4Years</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2731160">=</span>&nbsp;<span class="num" id="2731162">365</span><span class="op" id="2731165">*</span><span class="num" id="2731166">4</span>&nbsp;<span class="op" id="2731168">+</span>&nbsp;<span class="num" id="2731170">1</span><br>
<span class="lineno"></span><span class="op" id="2731172">)</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="2731175">//&nbsp;date&nbsp;computes&nbsp;the&nbsp;year,&nbsp;day&nbsp;of&nbsp;year,&nbsp;and&nbsp;when&nbsp;full=true,</span><br>
<span class="lineno"></span><span class="comment" id="2731235">//&nbsp;the&nbsp;month&nbsp;and&nbsp;day&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="2731275">func</span>&nbsp;<span class="op" id="2731280">(</span><span class="ident" id="2731281">t</span>&nbsp;<span class="ident" id="2731283">Time</span><span class="op" id="2731287">)</span>&nbsp;<span class="ident" id="2731289">date</span><span class="op" id="2731293">(</span><span class="ident" id="2731294">full</span>&nbsp;<span class="builtintype" id="2731299">bool</span><span class="op" id="2731303">)</span>&nbsp;<span class="op" id="2731305">(</span><span class="ident" id="2731306">year</span>&nbsp;<span class="builtintype" id="2731311">int</span><span class="op" id="2731314">,</span>&nbsp;<span class="ident" id="2731316">month</span>&nbsp;<span class="ident" id="2731322">Month</span><span class="op" id="2731327">,</span>&nbsp;<span class="ident" id="2731329">day</span>&nbsp;<span class="builtintype" id="2731333">int</span><span class="op" id="2731336">,</span>&nbsp;<span class="ident" id="2731338">yday</span>&nbsp;<span class="builtintype" id="2731343">int</span><span class="op" id="2731346">)</span>&nbsp;<span class="op" id="2731348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2731351">return</span>&nbsp;<span class="ident" id="2731358">absDate</span><span class="op" id="2731365">(</span><span class="ident" id="2731366">t</span><span class="op" id="2731367">.</span><span class="ident" id="2731368">abs</span><span class="op" id="2731371">(</span><span class="op" id="2731372">)</span><span class="op" id="2731373">,</span>&nbsp;<span class="ident" id="2731375">full</span><span class="op" id="2731379">)</span><br>
<span class="lineno">675</span><span class="op" id="2731381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2731384">//&nbsp;absDate&nbsp;is&nbsp;like&nbsp;date&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2731442">func</span>&nbsp;<span class="ident" id="2731447">absDate</span><span class="op" id="2731454">(</span><span class="ident" id="2731455">abs</span>&nbsp;<span class="ident" id="2731459">uint64</span><span class="op" id="2731465">,</span>&nbsp;<span class="ident" id="2731467">full</span>&nbsp;<span class="builtintype" id="2731472">bool</span><span class="op" id="2731476">)</span>&nbsp;<span class="op" id="2731478">(</span><span class="ident" id="2731479">year</span>&nbsp;<span class="builtintype" id="2731484">int</span><span class="op" id="2731487">,</span>&nbsp;<span class="ident" id="2731489">month</span>&nbsp;<span class="ident" id="2731495">Month</span><span class="op" id="2731500">,</span>&nbsp;<span class="ident" id="2731502">day</span>&nbsp;<span class="builtintype" id="2731506">int</span><span class="op" id="2731509">,</span>&nbsp;<span class="ident" id="2731511">yday</span>&nbsp;<span class="builtintype" id="2731516">int</span><span class="op" id="2731519">)</span>&nbsp;<span class="op" id="2731521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2731524">//&nbsp;Split&nbsp;into&nbsp;time&nbsp;and&nbsp;day.</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2731553">d</span>&nbsp;<span class="op" id="2731555">:=</span>&nbsp;<span class="ident" id="2731558">abs</span>&nbsp;<span class="op" id="2731562">/</span>&nbsp;<span class="ident" id="2731564">secondsPerDay</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2731580">//&nbsp;Account&nbsp;for&nbsp;400&nbsp;year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2731613">n</span>&nbsp;<span class="op" id="2731615">:=</span>&nbsp;<span class="ident" id="2731618">d</span>&nbsp;<span class="op" id="2731620">/</span>&nbsp;<span class="ident" id="2731622">daysPer400Years</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2731639">y</span>&nbsp;<span class="op" id="2731641">:=</span>&nbsp;<span class="num" id="2731644">400</span>&nbsp;<span class="op" id="2731648">*</span>&nbsp;<span class="ident" id="2731650">n</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2731653">d</span>&nbsp;<span class="op" id="2731655">-=</span>&nbsp;<span class="ident" id="2731658">daysPer400Years</span>&nbsp;<span class="op" id="2731674">*</span>&nbsp;<span class="ident" id="2731676">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2731680">//&nbsp;Cut&nbsp;off&nbsp;100-year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2731709">//&nbsp;The&nbsp;last&nbsp;cycle&nbsp;has&nbsp;one&nbsp;extra&nbsp;leap&nbsp;year,&nbsp;so&nbsp;on&nbsp;the&nbsp;last&nbsp;day</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2731772">//&nbsp;of&nbsp;that&nbsp;year,&nbsp;day&nbsp;/&nbsp;daysPer100Years&nbsp;will&nbsp;be&nbsp;4&nbsp;instead&nbsp;of&nbsp;3.</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2731836">//&nbsp;Cut&nbsp;it&nbsp;back&nbsp;down&nbsp;to&nbsp;3&nbsp;by&nbsp;subtracting&nbsp;n&gt;&gt;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2731883">n</span>&nbsp;<span class="op" id="2731885">=</span>&nbsp;<span class="ident" id="2731887">d</span>&nbsp;<span class="op" id="2731889">/</span>&nbsp;<span class="ident" id="2731891">daysPer100Years</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2731908">n</span>&nbsp;<span class="op" id="2731910">-=</span>&nbsp;<span class="ident" id="2731913">n</span>&nbsp;<span class="op" id="2731915">&gt;&gt;</span>&nbsp;<span class="num" id="2731918">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2731921">y</span>&nbsp;<span class="op" id="2731923">+=</span>&nbsp;<span class="num" id="2731926">100</span>&nbsp;<span class="op" id="2731930">*</span>&nbsp;<span class="ident" id="2731932">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2731935">d</span>&nbsp;<span class="op" id="2731937">-=</span>&nbsp;<span class="ident" id="2731940">daysPer100Years</span>&nbsp;<span class="op" id="2731956">*</span>&nbsp;<span class="ident" id="2731958">n</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2731962">//&nbsp;Cut&nbsp;off&nbsp;4-year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2731989">//&nbsp;The&nbsp;last&nbsp;cycle&nbsp;has&nbsp;a&nbsp;missing&nbsp;leap&nbsp;year,&nbsp;which&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2732048">//&nbsp;affect&nbsp;the&nbsp;computation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732076">n</span>&nbsp;<span class="op" id="2732078">=</span>&nbsp;<span class="ident" id="2732080">d</span>&nbsp;<span class="op" id="2732082">/</span>&nbsp;<span class="ident" id="2732084">daysPer4Years</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732099">y</span>&nbsp;<span class="op" id="2732101">+=</span>&nbsp;<span class="num" id="2732104">4</span>&nbsp;<span class="op" id="2732106">*</span>&nbsp;<span class="ident" id="2732108">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732111">d</span>&nbsp;<span class="op" id="2732113">-=</span>&nbsp;<span class="ident" id="2732116">daysPer4Years</span>&nbsp;<span class="op" id="2732130">*</span>&nbsp;<span class="ident" id="2732132">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2732136">//&nbsp;Cut&nbsp;off&nbsp;years&nbsp;within&nbsp;a&nbsp;4-year&nbsp;cycle.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2732177">//&nbsp;The&nbsp;last&nbsp;year&nbsp;is&nbsp;a&nbsp;leap&nbsp;year,&nbsp;so&nbsp;on&nbsp;the&nbsp;last&nbsp;day&nbsp;of&nbsp;that&nbsp;year,</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2732244">//&nbsp;day&nbsp;/&nbsp;365&nbsp;will&nbsp;be&nbsp;4&nbsp;instead&nbsp;of&nbsp;3.&nbsp;&nbsp;Cut&nbsp;it&nbsp;back&nbsp;down&nbsp;to&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2732305">//&nbsp;by&nbsp;subtracting&nbsp;n&gt;&gt;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732330">n</span>&nbsp;<span class="op" id="2732332">=</span>&nbsp;<span class="ident" id="2732334">d</span>&nbsp;<span class="op" id="2732336">/</span>&nbsp;<span class="num" id="2732338">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732343">n</span>&nbsp;<span class="op" id="2732345">-=</span>&nbsp;<span class="ident" id="2732348">n</span>&nbsp;<span class="op" id="2732350">&gt;&gt;</span>&nbsp;<span class="num" id="2732353">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732356">y</span>&nbsp;<span class="op" id="2732358">+=</span>&nbsp;<span class="ident" id="2732361">n</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732364">d</span>&nbsp;<span class="op" id="2732366">-=</span>&nbsp;<span class="num" id="2732369">365</span>&nbsp;<span class="op" id="2732373">*</span>&nbsp;<span class="ident" id="2732375">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732379">year</span>&nbsp;<span class="op" id="2732384">=</span>&nbsp;<span class="builtintype" id="2732386">int</span><span class="op" id="2732389">(</span><span class="ident" id="2732390">int64</span><span class="op" id="2732395">(</span><span class="ident" id="2732396">y</span><span class="op" id="2732397">)</span>&nbsp;<span class="op" id="2732399">+</span>&nbsp;<span class="ident" id="2732401">absoluteZeroYear</span><span class="op" id="2732417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732420">yday</span>&nbsp;<span class="op" id="2732425">=</span>&nbsp;<span class="builtintype" id="2732427">int</span><span class="op" id="2732430">(</span><span class="ident" id="2732431">d</span><span class="op" id="2732432">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2732436">if</span>&nbsp;<span class="op" id="2732439">!</span><span class="ident" id="2732440">full</span>&nbsp;<span class="op" id="2732445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2732449">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2732457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732461">day</span>&nbsp;<span class="op" id="2732465">=</span>&nbsp;<span class="ident" id="2732467">yday</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2732473">if</span>&nbsp;<span class="ident" id="2732476">isLeap</span><span class="op" id="2732482">(</span><span class="ident" id="2732483">year</span><span class="op" id="2732487">)</span>&nbsp;<span class="op" id="2732489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2732493">//&nbsp;Leap&nbsp;year</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2732508">switch</span>&nbsp;<span class="op" id="2732515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2732519">case</span>&nbsp;<span class="ident" id="2732524">day</span>&nbsp;<span class="op" id="2732528">&gt;</span>&nbsp;<span class="num" id="2732530">31</span><span class="op" id="2732532">+</span><span class="num" id="2732533">29</span><span class="op" id="2732535">-</span><span class="num" id="2732536">1</span><span class="op" id="2732537">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2732542">//&nbsp;After&nbsp;leap&nbsp;day;&nbsp;pretend&nbsp;it&nbsp;wasn&#39;t&nbsp;there.</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732589">day</span><span class="op" id="2732592">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2732597">case</span>&nbsp;<span class="ident" id="2732602">day</span>&nbsp;<span class="op" id="2732606">==</span>&nbsp;<span class="num" id="2732609">31</span><span class="op" id="2732611">+</span><span class="num" id="2732612">29</span><span class="op" id="2732614">-</span><span class="num" id="2732615">1</span><span class="op" id="2732616">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2732621">//&nbsp;Leap&nbsp;day.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732637">month</span>&nbsp;<span class="op" id="2732643">=</span>&nbsp;<span class="ident" id="2732645">February</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732657">day</span>&nbsp;<span class="op" id="2732661">=</span>&nbsp;<span class="num" id="2732663">29</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2732669">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2732678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2732681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2732685">//&nbsp;Estimate&nbsp;month&nbsp;on&nbsp;assumption&nbsp;that&nbsp;every&nbsp;month&nbsp;has&nbsp;31&nbsp;days.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2732748">//&nbsp;The&nbsp;estimate&nbsp;may&nbsp;be&nbsp;too&nbsp;low&nbsp;by&nbsp;at&nbsp;most&nbsp;one&nbsp;month,&nbsp;so&nbsp;adjust.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732813">month</span>&nbsp;<span class="op" id="2732819">=</span>&nbsp;<span class="ident" id="2732821">Month</span><span class="op" id="2732826">(</span><span class="ident" id="2732827">day</span>&nbsp;<span class="op" id="2732831">/</span>&nbsp;<span class="num" id="2732833">31</span><span class="op" id="2732835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732838">end</span>&nbsp;<span class="op" id="2732842">:=</span>&nbsp;<span class="builtintype" id="2732845">int</span><span class="op" id="2732848">(</span><span class="ident" id="2732849">daysBefore</span><span class="op" id="2732859">[</span><span class="ident" id="2732860">month</span><span class="op" id="2732865">+</span><span class="num" id="2732866">1</span><span class="op" id="2732867">]</span><span class="op" id="2732868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2732871">var</span>&nbsp;<span class="ident" id="2732875">begin</span>&nbsp;<span class="builtintype" id="2732881">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2732886">if</span>&nbsp;<span class="ident" id="2732889">day</span>&nbsp;<span class="op" id="2732893">&gt;=</span>&nbsp;<span class="ident" id="2732896">end</span>&nbsp;<span class="op" id="2732900">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732904">month</span><span class="op" id="2732909">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732914">begin</span>&nbsp;<span class="op" id="2732920">=</span>&nbsp;<span class="ident" id="2732922">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2732927">}</span>&nbsp;<span class="keyword" id="2732929">else</span>&nbsp;<span class="op" id="2732934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732938">begin</span>&nbsp;<span class="op" id="2732944">=</span>&nbsp;<span class="builtintype" id="2732946">int</span><span class="op" id="2732949">(</span><span class="ident" id="2732950">daysBefore</span><span class="op" id="2732960">[</span><span class="ident" id="2732961">month</span><span class="op" id="2732966">]</span><span class="op" id="2732967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2732970">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2732974">month</span><span class="op" id="2732979">++</span>&nbsp;<span class="comment" id="2732982">//&nbsp;because&nbsp;January&nbsp;is&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2733007">day</span>&nbsp;<span class="op" id="2733011">=</span>&nbsp;<span class="ident" id="2733013">day</span>&nbsp;<span class="op" id="2733017">-</span>&nbsp;<span class="ident" id="2733019">begin</span>&nbsp;<span class="op" id="2733025">+</span>&nbsp;<span class="num" id="2733027">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2733030">return</span><br>
<span class="lineno"></span><span class="op" id="2733037">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="comment" id="2733040">//&nbsp;daysBefore[m]&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;in&nbsp;a&nbsp;non-leap&nbsp;year</span><br>
<span class="lineno"></span><span class="comment" id="2733102">//&nbsp;before&nbsp;month&nbsp;m&nbsp;begins.&nbsp;&nbsp;There&nbsp;is&nbsp;an&nbsp;entry&nbsp;for&nbsp;m=12,&nbsp;counting</span><br>
<span class="lineno"></span><span class="comment" id="2733166">//&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;before&nbsp;January&nbsp;of&nbsp;next&nbsp;year&nbsp;(365).</span><br>
<span class="lineno"></span><span class="keyword" id="2733223">var</span>&nbsp;<span class="ident" id="2733227">daysBefore</span>&nbsp;<span class="op" id="2733238">=</span>&nbsp;<span class="op" id="2733240">[</span><span class="op" id="2733241">...</span><span class="op" id="2733244">]</span><span class="builtintype" id="2733245">int32</span><span class="op" id="2733250">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733253">0</span><span class="op" id="2733254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733257">31</span><span class="op" id="2733259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733262">31</span>&nbsp;<span class="op" id="2733265">+</span>&nbsp;<span class="num" id="2733267">28</span><span class="op" id="2733269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733272">31</span>&nbsp;<span class="op" id="2733275">+</span>&nbsp;<span class="num" id="2733277">28</span>&nbsp;<span class="op" id="2733280">+</span>&nbsp;<span class="num" id="2733282">31</span><span class="op" id="2733284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733287">31</span>&nbsp;<span class="op" id="2733290">+</span>&nbsp;<span class="num" id="2733292">28</span>&nbsp;<span class="op" id="2733295">+</span>&nbsp;<span class="num" id="2733297">31</span>&nbsp;<span class="op" id="2733300">+</span>&nbsp;<span class="num" id="2733302">30</span><span class="op" id="2733304">,</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733307">31</span>&nbsp;<span class="op" id="2733310">+</span>&nbsp;<span class="num" id="2733312">28</span>&nbsp;<span class="op" id="2733315">+</span>&nbsp;<span class="num" id="2733317">31</span>&nbsp;<span class="op" id="2733320">+</span>&nbsp;<span class="num" id="2733322">30</span>&nbsp;<span class="op" id="2733325">+</span>&nbsp;<span class="num" id="2733327">31</span><span class="op" id="2733329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733332">31</span>&nbsp;<span class="op" id="2733335">+</span>&nbsp;<span class="num" id="2733337">28</span>&nbsp;<span class="op" id="2733340">+</span>&nbsp;<span class="num" id="2733342">31</span>&nbsp;<span class="op" id="2733345">+</span>&nbsp;<span class="num" id="2733347">30</span>&nbsp;<span class="op" id="2733350">+</span>&nbsp;<span class="num" id="2733352">31</span>&nbsp;<span class="op" id="2733355">+</span>&nbsp;<span class="num" id="2733357">30</span><span class="op" id="2733359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733362">31</span>&nbsp;<span class="op" id="2733365">+</span>&nbsp;<span class="num" id="2733367">28</span>&nbsp;<span class="op" id="2733370">+</span>&nbsp;<span class="num" id="2733372">31</span>&nbsp;<span class="op" id="2733375">+</span>&nbsp;<span class="num" id="2733377">30</span>&nbsp;<span class="op" id="2733380">+</span>&nbsp;<span class="num" id="2733382">31</span>&nbsp;<span class="op" id="2733385">+</span>&nbsp;<span class="num" id="2733387">30</span>&nbsp;<span class="op" id="2733390">+</span>&nbsp;<span class="num" id="2733392">31</span><span class="op" id="2733394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733397">31</span>&nbsp;<span class="op" id="2733400">+</span>&nbsp;<span class="num" id="2733402">28</span>&nbsp;<span class="op" id="2733405">+</span>&nbsp;<span class="num" id="2733407">31</span>&nbsp;<span class="op" id="2733410">+</span>&nbsp;<span class="num" id="2733412">30</span>&nbsp;<span class="op" id="2733415">+</span>&nbsp;<span class="num" id="2733417">31</span>&nbsp;<span class="op" id="2733420">+</span>&nbsp;<span class="num" id="2733422">30</span>&nbsp;<span class="op" id="2733425">+</span>&nbsp;<span class="num" id="2733427">31</span>&nbsp;<span class="op" id="2733430">+</span>&nbsp;<span class="num" id="2733432">31</span><span class="op" id="2733434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733437">31</span>&nbsp;<span class="op" id="2733440">+</span>&nbsp;<span class="num" id="2733442">28</span>&nbsp;<span class="op" id="2733445">+</span>&nbsp;<span class="num" id="2733447">31</span>&nbsp;<span class="op" id="2733450">+</span>&nbsp;<span class="num" id="2733452">30</span>&nbsp;<span class="op" id="2733455">+</span>&nbsp;<span class="num" id="2733457">31</span>&nbsp;<span class="op" id="2733460">+</span>&nbsp;<span class="num" id="2733462">30</span>&nbsp;<span class="op" id="2733465">+</span>&nbsp;<span class="num" id="2733467">31</span>&nbsp;<span class="op" id="2733470">+</span>&nbsp;<span class="num" id="2733472">31</span>&nbsp;<span class="op" id="2733475">+</span>&nbsp;<span class="num" id="2733477">30</span><span class="op" id="2733479">,</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733482">31</span>&nbsp;<span class="op" id="2733485">+</span>&nbsp;<span class="num" id="2733487">28</span>&nbsp;<span class="op" id="2733490">+</span>&nbsp;<span class="num" id="2733492">31</span>&nbsp;<span class="op" id="2733495">+</span>&nbsp;<span class="num" id="2733497">30</span>&nbsp;<span class="op" id="2733500">+</span>&nbsp;<span class="num" id="2733502">31</span>&nbsp;<span class="op" id="2733505">+</span>&nbsp;<span class="num" id="2733507">30</span>&nbsp;<span class="op" id="2733510">+</span>&nbsp;<span class="num" id="2733512">31</span>&nbsp;<span class="op" id="2733515">+</span>&nbsp;<span class="num" id="2733517">31</span>&nbsp;<span class="op" id="2733520">+</span>&nbsp;<span class="num" id="2733522">30</span>&nbsp;<span class="op" id="2733525">+</span>&nbsp;<span class="num" id="2733527">31</span><span class="op" id="2733529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733532">31</span>&nbsp;<span class="op" id="2733535">+</span>&nbsp;<span class="num" id="2733537">28</span>&nbsp;<span class="op" id="2733540">+</span>&nbsp;<span class="num" id="2733542">31</span>&nbsp;<span class="op" id="2733545">+</span>&nbsp;<span class="num" id="2733547">30</span>&nbsp;<span class="op" id="2733550">+</span>&nbsp;<span class="num" id="2733552">31</span>&nbsp;<span class="op" id="2733555">+</span>&nbsp;<span class="num" id="2733557">30</span>&nbsp;<span class="op" id="2733560">+</span>&nbsp;<span class="num" id="2733562">31</span>&nbsp;<span class="op" id="2733565">+</span>&nbsp;<span class="num" id="2733567">31</span>&nbsp;<span class="op" id="2733570">+</span>&nbsp;<span class="num" id="2733572">30</span>&nbsp;<span class="op" id="2733575">+</span>&nbsp;<span class="num" id="2733577">31</span>&nbsp;<span class="op" id="2733580">+</span>&nbsp;<span class="num" id="2733582">30</span><span class="op" id="2733584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2733587">31</span>&nbsp;<span class="op" id="2733590">+</span>&nbsp;<span class="num" id="2733592">28</span>&nbsp;<span class="op" id="2733595">+</span>&nbsp;<span class="num" id="2733597">31</span>&nbsp;<span class="op" id="2733600">+</span>&nbsp;<span class="num" id="2733602">30</span>&nbsp;<span class="op" id="2733605">+</span>&nbsp;<span class="num" id="2733607">31</span>&nbsp;<span class="op" id="2733610">+</span>&nbsp;<span class="num" id="2733612">30</span>&nbsp;<span class="op" id="2733615">+</span>&nbsp;<span class="num" id="2733617">31</span>&nbsp;<span class="op" id="2733620">+</span>&nbsp;<span class="num" id="2733622">31</span>&nbsp;<span class="op" id="2733625">+</span>&nbsp;<span class="num" id="2733627">30</span>&nbsp;<span class="op" id="2733630">+</span>&nbsp;<span class="num" id="2733632">31</span>&nbsp;<span class="op" id="2733635">+</span>&nbsp;<span class="num" id="2733637">30</span>&nbsp;<span class="op" id="2733640">+</span>&nbsp;<span class="num" id="2733642">31</span><span class="op" id="2733644">,</span><br>
<span class="lineno"></span><span class="op" id="2733646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span><span class="keyword" id="2733649">func</span>&nbsp;<span class="ident" id="2733654">daysIn</span><span class="op" id="2733660">(</span><span class="ident" id="2733661">m</span>&nbsp;<span class="ident" id="2733663">Month</span><span class="op" id="2733668">,</span>&nbsp;<span class="ident" id="2733670">year</span>&nbsp;<span class="builtintype" id="2733675">int</span><span class="op" id="2733678">)</span>&nbsp;<span class="builtintype" id="2733680">int</span>&nbsp;<span class="op" id="2733684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2733687">if</span>&nbsp;<span class="ident" id="2733690">m</span>&nbsp;<span class="op" id="2733692">==</span>&nbsp;<span class="ident" id="2733695">February</span>&nbsp;<span class="op" id="2733704">&amp;&amp;</span>&nbsp;<span class="ident" id="2733707">isLeap</span><span class="op" id="2733713">(</span><span class="ident" id="2733714">year</span><span class="op" id="2733718">)</span>&nbsp;<span class="op" id="2733720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2733724">return</span>&nbsp;<span class="num" id="2733731">29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2733735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2733738">return</span>&nbsp;<span class="builtintype" id="2733745">int</span><span class="op" id="2733748">(</span><span class="ident" id="2733749">daysBefore</span><span class="op" id="2733759">[</span><span class="ident" id="2733760">m</span><span class="op" id="2733761">]</span>&nbsp;<span class="op" id="2733763">-</span>&nbsp;<span class="ident" id="2733765">daysBefore</span><span class="op" id="2733775">[</span><span class="ident" id="2733776">m</span><span class="op" id="2733777">-</span><span class="num" id="2733778">1</span><span class="op" id="2733779">]</span><span class="op" id="2733780">)</span><br>
<span class="lineno">775</span><span class="op" id="2733782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2733785">//&nbsp;Provided&nbsp;by&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="keyword" id="2733817">func</span>&nbsp;<span class="ident" id="2733822">now</span><span class="op" id="2733825">(</span><span class="op" id="2733826">)</span>&nbsp;<span class="op" id="2733828">(</span><span class="ident" id="2733829">sec</span>&nbsp;<span class="ident" id="2733833">int64</span><span class="op" id="2733838">,</span>&nbsp;<span class="ident" id="2733840">nsec</span>&nbsp;<span class="builtintype" id="2733845">int32</span><span class="op" id="2733850">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span><span class="comment" id="2733853">//&nbsp;Now&nbsp;returns&nbsp;the&nbsp;current&nbsp;local&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2733892">func</span>&nbsp;<span class="ident" id="2733897">Now</span><span class="op" id="2733900">(</span><span class="op" id="2733901">)</span>&nbsp;<span class="ident" id="2733903">Time</span>&nbsp;<span class="op" id="2733908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2733911">sec</span><span class="op" id="2733914">,</span>&nbsp;<span class="ident" id="2733916">nsec</span>&nbsp;<span class="op" id="2733921">:=</span>&nbsp;<span class="ident" id="2733924">now</span><span class="op" id="2733927">(</span><span class="op" id="2733928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2733931">return</span>&nbsp;<span class="ident" id="2733938">Time</span><span class="op" id="2733942">{</span><span class="ident" id="2733943">sec</span>&nbsp;<span class="op" id="2733947">+</span>&nbsp;<span class="ident" id="2733949">unixToInternal</span><span class="op" id="2733963">,</span>&nbsp;<span class="ident" id="2733965">nsec</span><span class="op" id="2733969">,</span>&nbsp;<span class="ident" id="2733971">Local</span><span class="op" id="2733976">}</span><br>
<span class="lineno"></span><span class="op" id="2733978">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="comment" id="2733981">//&nbsp;UTC&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;set&nbsp;to&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2734028">func</span>&nbsp;<span class="op" id="2734033">(</span><span class="ident" id="2734034">t</span>&nbsp;<span class="ident" id="2734036">Time</span><span class="op" id="2734040">)</span>&nbsp;<span class="ident" id="2734042">UTC</span><span class="op" id="2734045">(</span><span class="op" id="2734046">)</span>&nbsp;<span class="ident" id="2734048">Time</span>&nbsp;<span class="op" id="2734053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2734056">t</span><span class="op" id="2734057">.</span><span class="ident" id="2734058">loc</span>&nbsp;<span class="op" id="2734062">=</span>&nbsp;<span class="ident" id="2734064">UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2734069">return</span>&nbsp;<span class="ident" id="2734076">t</span><br>
<span class="lineno">790</span><span class="op" id="2734078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2734081">//&nbsp;Local&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;set&nbsp;to&nbsp;local&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2734137">func</span>&nbsp;<span class="op" id="2734142">(</span><span class="ident" id="2734143">t</span>&nbsp;<span class="ident" id="2734145">Time</span><span class="op" id="2734149">)</span>&nbsp;<span class="ident" id="2734151">Local</span><span class="op" id="2734156">(</span><span class="op" id="2734157">)</span>&nbsp;<span class="ident" id="2734159">Time</span>&nbsp;<span class="op" id="2734164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2734167">t</span><span class="op" id="2734168">.</span><span class="ident" id="2734169">loc</span>&nbsp;<span class="op" id="2734173">=</span>&nbsp;<span class="ident" id="2734175">Local</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2734182">return</span>&nbsp;<span class="ident" id="2734189">t</span><br>
<span class="lineno"></span><span class="op" id="2734191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2734194">//&nbsp;In&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;information&nbsp;set&nbsp;to&nbsp;loc.</span><br>
<span class="lineno"></span><span class="comment" id="2734252">//</span><br>
<span class="lineno">800</span><span class="comment" id="2734255">//&nbsp;In&nbsp;panics&nbsp;if&nbsp;loc&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2734283">func</span>&nbsp;<span class="op" id="2734288">(</span><span class="ident" id="2734289">t</span>&nbsp;<span class="ident" id="2734291">Time</span><span class="op" id="2734295">)</span>&nbsp;<span class="ident" id="2734297">In</span><span class="op" id="2734299">(</span><span class="ident" id="2734300">loc</span>&nbsp;<span class="op" id="2734304">*</span><span class="ident" id="2734305">Location</span><span class="op" id="2734313">)</span>&nbsp;<span class="ident" id="2734315">Time</span>&nbsp;<span class="op" id="2734320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2734323">if</span>&nbsp;<span class="ident" id="2734326">loc</span>&nbsp;<span class="op" id="2734330">==</span>&nbsp;<span class="builtintype" id="2734333">nil</span>&nbsp;<span class="op" id="2734337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2734341">panic</span><span class="op" id="2734346">(</span><span class="string" id="2734347">&#34;time:&nbsp;missing&nbsp;Location&nbsp;in&nbsp;call&nbsp;to&nbsp;Time.In&#34;</span><span class="op" id="2734390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2734393">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2734396">t</span><span class="op" id="2734397">.</span><span class="ident" id="2734398">loc</span>&nbsp;<span class="op" id="2734402">=</span>&nbsp;<span class="ident" id="2734404">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2734409">return</span>&nbsp;<span class="ident" id="2734416">t</span><br>
<span class="lineno"></span><span class="op" id="2734418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2734421">//&nbsp;Location&nbsp;returns&nbsp;the&nbsp;time&nbsp;zone&nbsp;information&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno">810</span><span class="keyword" id="2734486">func</span>&nbsp;<span class="op" id="2734491">(</span><span class="ident" id="2734492">t</span>&nbsp;<span class="ident" id="2734494">Time</span><span class="op" id="2734498">)</span>&nbsp;<span class="ident" id="2734500">Location</span><span class="op" id="2734508">(</span><span class="op" id="2734509">)</span>&nbsp;<span class="op" id="2734511">*</span><span class="ident" id="2734512">Location</span>&nbsp;<span class="op" id="2734521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2734524">l</span>&nbsp;<span class="op" id="2734526">:=</span>&nbsp;<span class="ident" id="2734529">t</span><span class="op" id="2734530">.</span><span class="ident" id="2734531">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2734536">if</span>&nbsp;<span class="ident" id="2734539">l</span>&nbsp;<span class="op" id="2734541">==</span>&nbsp;<span class="builtintype" id="2734544">nil</span>&nbsp;<span class="op" id="2734548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2734552">l</span>&nbsp;<span class="op" id="2734554">=</span>&nbsp;<span class="ident" id="2734556">UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2734561">}</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2734564">return</span>&nbsp;<span class="ident" id="2734571">l</span><br>
<span class="lineno"></span><span class="op" id="2734573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2734576">//&nbsp;Zone&nbsp;computes&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;effect&nbsp;at&nbsp;time&nbsp;t,&nbsp;returning&nbsp;the&nbsp;abbreviated</span><br>
<span class="lineno"></span><span class="comment" id="2734654">//&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;)&nbsp;and&nbsp;its&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC.</span><br>
<span class="lineno">820</span><span class="keyword" id="2734729">func</span>&nbsp;<span class="op" id="2734734">(</span><span class="ident" id="2734735">t</span>&nbsp;<span class="ident" id="2734737">Time</span><span class="op" id="2734741">)</span>&nbsp;<span class="ident" id="2734743">Zone</span><span class="op" id="2734747">(</span><span class="op" id="2734748">)</span>&nbsp;<span class="op" id="2734750">(</span><span class="ident" id="2734751">name</span>&nbsp;<span class="builtintype" id="2734756">string</span><span class="op" id="2734762">,</span>&nbsp;<span class="ident" id="2734764">offset</span>&nbsp;<span class="builtintype" id="2734771">int</span><span class="op" id="2734774">)</span>&nbsp;<span class="op" id="2734776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2734779">name</span><span class="op" id="2734783">,</span>&nbsp;<span class="ident" id="2734785">offset</span><span class="op" id="2734791">,</span>&nbsp;<span class="ident" id="2734793">_</span><span class="op" id="2734794">,</span>&nbsp;<span class="ident" id="2734796">_</span><span class="op" id="2734797">,</span>&nbsp;<span class="ident" id="2734799">_</span>&nbsp;<span class="op" id="2734801">=</span>&nbsp;<span class="ident" id="2734803">t</span><span class="op" id="2734804">.</span><span class="ident" id="2734805">loc</span><span class="op" id="2734808">.</span><span class="ident" id="2734809">lookup</span><span class="op" id="2734815">(</span><span class="ident" id="2734816">t</span><span class="op" id="2734817">.</span><span class="ident" id="2734818">sec</span>&nbsp;<span class="op" id="2734822">+</span>&nbsp;<span class="ident" id="2734824">internalToUnix</span><span class="op" id="2734838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2734841">return</span><br>
<span class="lineno"></span><span class="op" id="2734848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span><span class="comment" id="2734851">//&nbsp;Unix&nbsp;returns&nbsp;t&nbsp;as&nbsp;a&nbsp;Unix&nbsp;time,&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;elapsed</span><br>
<span class="lineno"></span><span class="comment" id="2734915">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2734945">func</span>&nbsp;<span class="op" id="2734950">(</span><span class="ident" id="2734951">t</span>&nbsp;<span class="ident" id="2734953">Time</span><span class="op" id="2734957">)</span>&nbsp;<span class="ident" id="2734959">Unix</span><span class="op" id="2734963">(</span><span class="op" id="2734964">)</span>&nbsp;<span class="ident" id="2734966">int64</span>&nbsp;<span class="op" id="2734972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2734975">return</span>&nbsp;<span class="ident" id="2734982">t</span><span class="op" id="2734983">.</span><span class="ident" id="2734984">sec</span>&nbsp;<span class="op" id="2734988">+</span>&nbsp;<span class="ident" id="2734990">internalToUnix</span><br>
<span class="lineno"></span><span class="op" id="2735005">}</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span><span class="comment" id="2735008">//&nbsp;UnixNano&nbsp;returns&nbsp;t&nbsp;as&nbsp;a&nbsp;Unix&nbsp;time,&nbsp;the&nbsp;number&nbsp;of&nbsp;nanoseconds&nbsp;elapsed</span><br>
<span class="lineno"></span><span class="comment" id="2735080">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.&nbsp;The&nbsp;result&nbsp;is&nbsp;undefined&nbsp;if&nbsp;the&nbsp;Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2735151">//&nbsp;in&nbsp;nanoseconds&nbsp;cannot&nbsp;be&nbsp;represented&nbsp;by&nbsp;an&nbsp;int64.&nbsp;Note&nbsp;that&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2735219">//&nbsp;means&nbsp;the&nbsp;result&nbsp;of&nbsp;calling&nbsp;UnixNano&nbsp;on&nbsp;the&nbsp;zero&nbsp;Time&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">835</span><span class="keyword" id="2735290">func</span>&nbsp;<span class="op" id="2735295">(</span><span class="ident" id="2735296">t</span>&nbsp;<span class="ident" id="2735298">Time</span><span class="op" id="2735302">)</span>&nbsp;<span class="ident" id="2735304">UnixNano</span><span class="op" id="2735312">(</span><span class="op" id="2735313">)</span>&nbsp;<span class="ident" id="2735315">int64</span>&nbsp;<span class="op" id="2735321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2735324">return</span>&nbsp;<span class="op" id="2735331">(</span><span class="ident" id="2735332">t</span><span class="op" id="2735333">.</span><span class="ident" id="2735334">sec</span><span class="op" id="2735337">+</span><span class="ident" id="2735338">internalToUnix</span><span class="op" id="2735352">)</span><span class="op" id="2735353">*</span><span class="num" id="2735354">1e9</span>&nbsp;<span class="op" id="2735358">+</span>&nbsp;<span class="ident" id="2735360">int64</span><span class="op" id="2735365">(</span><span class="ident" id="2735366">t</span><span class="op" id="2735367">.</span><span class="ident" id="2735368">nsec</span><span class="op" id="2735372">)</span><br>
<span class="lineno"></span><span class="op" id="2735374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2735377">const</span>&nbsp;<span class="ident" id="2735383">timeBinaryVersion</span>&nbsp;<span class="builtintype" id="2735401">byte</span>&nbsp;<span class="op" id="2735406">=</span>&nbsp;<span class="num" id="2735408">1</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="comment" id="2735411">//&nbsp;MarshalBinary&nbsp;implements&nbsp;the&nbsp;encoding.BinaryMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2735479">func</span>&nbsp;<span class="op" id="2735484">(</span><span class="ident" id="2735485">t</span>&nbsp;<span class="ident" id="2735487">Time</span><span class="op" id="2735491">)</span>&nbsp;<span class="ident" id="2735493">MarshalBinary</span><span class="op" id="2735506">(</span><span class="op" id="2735507">)</span>&nbsp;<span class="op" id="2735509">(</span><span class="op" id="2735510">[</span><span class="op" id="2735511">]</span><span class="builtintype" id="2735512">byte</span><span class="op" id="2735516">,</span>&nbsp;<span class="builtintype" id="2735518">error</span><span class="op" id="2735523">)</span>&nbsp;<span class="op" id="2735525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2735528">var</span>&nbsp;<span class="ident" id="2735532">offsetMin</span>&nbsp;<span class="builtintype" id="2735542">int16</span>&nbsp;<span class="comment" id="2735548">//&nbsp;minutes&nbsp;east&nbsp;of&nbsp;UTC.&nbsp;-1&nbsp;is&nbsp;UTC.</span><br>
<span class="lineno"></span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2735585">if</span>&nbsp;<span class="ident" id="2735588">t</span><span class="op" id="2735589">.</span><span class="ident" id="2735590">Location</span><span class="op" id="2735598">(</span><span class="op" id="2735599">)</span>&nbsp;<span class="op" id="2735601">==</span>&nbsp;<span class="op" id="2735604">&amp;</span><span class="ident" id="2735605">utcLoc</span>&nbsp;<span class="op" id="2735612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2735616">offsetMin</span>&nbsp;<span class="op" id="2735626">=</span>&nbsp;<span class="op" id="2735628">-</span><span class="num" id="2735629">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2735632">}</span>&nbsp;<span class="keyword" id="2735634">else</span>&nbsp;<span class="op" id="2735639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2735643">_</span><span class="op" id="2735644">,</span>&nbsp;<span class="ident" id="2735646">offset</span>&nbsp;<span class="op" id="2735653">:=</span>&nbsp;<span class="ident" id="2735656">t</span><span class="op" id="2735657">.</span><span class="ident" id="2735658">Zone</span><span class="op" id="2735662">(</span><span class="op" id="2735663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2735667">if</span>&nbsp;<span class="ident" id="2735670">offset</span><span class="op" id="2735676">%</span><span class="num" id="2735677">60</span>&nbsp;<span class="op" id="2735680">!=</span>&nbsp;<span class="num" id="2735683">0</span>&nbsp;<span class="op" id="2735685">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2735690">return</span>&nbsp;<span class="builtintype" id="2735697">nil</span><span class="op" id="2735700">,</span>&nbsp;<span class="ident" id="2735702">errors</span><span class="op" id="2735708">.</span><span class="ident" id="2735709">New</span><span class="op" id="2735712">(</span><span class="string" id="2735713">&#34;Time.MarshalBinary:&nbsp;zone&nbsp;offset&nbsp;has&nbsp;fractional&nbsp;minute&#34;</span><span class="op" id="2735768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2735772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2735776">offset</span>&nbsp;<span class="op" id="2735783">/=</span>&nbsp;<span class="num" id="2735786">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2735791">if</span>&nbsp;<span class="ident" id="2735794">offset</span>&nbsp;<span class="op" id="2735801">&lt;</span>&nbsp;<span class="op" id="2735803">-</span><span class="num" id="2735804">32768</span>&nbsp;<span class="op" id="2735810">||</span>&nbsp;<span class="ident" id="2735813">offset</span>&nbsp;<span class="op" id="2735820">==</span>&nbsp;<span class="op" id="2735823">-</span><span class="num" id="2735824">1</span>&nbsp;<span class="op" id="2735826">||</span>&nbsp;<span class="ident" id="2735829">offset</span>&nbsp;<span class="op" id="2735836">&gt;</span>&nbsp;<span class="num" id="2735838">32767</span>&nbsp;<span class="op" id="2735844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2735849">return</span>&nbsp;<span class="builtintype" id="2735856">nil</span><span class="op" id="2735859">,</span>&nbsp;<span class="ident" id="2735861">errors</span><span class="op" id="2735867">.</span><span class="ident" id="2735868">New</span><span class="op" id="2735871">(</span><span class="string" id="2735872">&#34;Time.MarshalBinary:&nbsp;unexpected&nbsp;zone&nbsp;offset&#34;</span><span class="op" id="2735916">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2735920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2735924">offsetMin</span>&nbsp;<span class="op" id="2735934">=</span>&nbsp;<span class="builtintype" id="2735936">int16</span><span class="op" id="2735941">(</span><span class="ident" id="2735942">offset</span><span class="op" id="2735948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2735951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2735955">enc</span>&nbsp;<span class="op" id="2735959">:=</span>&nbsp;<span class="op" id="2735962">[</span><span class="op" id="2735963">]</span><span class="builtintype" id="2735964">byte</span><span class="op" id="2735968">{</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2735972">timeBinaryVersion</span><span class="op" id="2735989">,</span>&nbsp;<span class="comment" id="2735991">//&nbsp;byte&nbsp;0&nbsp;:&nbsp;version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736013">byte</span><span class="op" id="2736017">(</span><span class="ident" id="2736018">t</span><span class="op" id="2736019">.</span><span class="ident" id="2736020">sec</span>&nbsp;<span class="op" id="2736024">&gt;&gt;</span>&nbsp;<span class="num" id="2736027">56</span><span class="op" id="2736029">)</span><span class="op" id="2736030">,</span>&nbsp;<span class="comment" id="2736032">//&nbsp;bytes&nbsp;1-8:&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736056">byte</span><span class="op" id="2736060">(</span><span class="ident" id="2736061">t</span><span class="op" id="2736062">.</span><span class="ident" id="2736063">sec</span>&nbsp;<span class="op" id="2736067">&gt;&gt;</span>&nbsp;<span class="num" id="2736070">48</span><span class="op" id="2736072">)</span><span class="op" id="2736073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736077">byte</span><span class="op" id="2736081">(</span><span class="ident" id="2736082">t</span><span class="op" id="2736083">.</span><span class="ident" id="2736084">sec</span>&nbsp;<span class="op" id="2736088">&gt;&gt;</span>&nbsp;<span class="num" id="2736091">40</span><span class="op" id="2736093">)</span><span class="op" id="2736094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736098">byte</span><span class="op" id="2736102">(</span><span class="ident" id="2736103">t</span><span class="op" id="2736104">.</span><span class="ident" id="2736105">sec</span>&nbsp;<span class="op" id="2736109">&gt;&gt;</span>&nbsp;<span class="num" id="2736112">32</span><span class="op" id="2736114">)</span><span class="op" id="2736115">,</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736119">byte</span><span class="op" id="2736123">(</span><span class="ident" id="2736124">t</span><span class="op" id="2736125">.</span><span class="ident" id="2736126">sec</span>&nbsp;<span class="op" id="2736130">&gt;&gt;</span>&nbsp;<span class="num" id="2736133">24</span><span class="op" id="2736135">)</span><span class="op" id="2736136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736140">byte</span><span class="op" id="2736144">(</span><span class="ident" id="2736145">t</span><span class="op" id="2736146">.</span><span class="ident" id="2736147">sec</span>&nbsp;<span class="op" id="2736151">&gt;&gt;</span>&nbsp;<span class="num" id="2736154">16</span><span class="op" id="2736156">)</span><span class="op" id="2736157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736161">byte</span><span class="op" id="2736165">(</span><span class="ident" id="2736166">t</span><span class="op" id="2736167">.</span><span class="ident" id="2736168">sec</span>&nbsp;<span class="op" id="2736172">&gt;&gt;</span>&nbsp;<span class="num" id="2736175">8</span><span class="op" id="2736176">)</span><span class="op" id="2736177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736181">byte</span><span class="op" id="2736185">(</span><span class="ident" id="2736186">t</span><span class="op" id="2736187">.</span><span class="ident" id="2736188">sec</span><span class="op" id="2736191">)</span><span class="op" id="2736192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736196">byte</span><span class="op" id="2736200">(</span><span class="ident" id="2736201">t</span><span class="op" id="2736202">.</span><span class="ident" id="2736203">nsec</span>&nbsp;<span class="op" id="2736208">&gt;&gt;</span>&nbsp;<span class="num" id="2736211">24</span><span class="op" id="2736213">)</span><span class="op" id="2736214">,</span>&nbsp;<span class="comment" id="2736216">//&nbsp;bytes&nbsp;9-12:&nbsp;nanoseconds</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736245">byte</span><span class="op" id="2736249">(</span><span class="ident" id="2736250">t</span><span class="op" id="2736251">.</span><span class="ident" id="2736252">nsec</span>&nbsp;<span class="op" id="2736257">&gt;&gt;</span>&nbsp;<span class="num" id="2736260">16</span><span class="op" id="2736262">)</span><span class="op" id="2736263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736267">byte</span><span class="op" id="2736271">(</span><span class="ident" id="2736272">t</span><span class="op" id="2736273">.</span><span class="ident" id="2736274">nsec</span>&nbsp;<span class="op" id="2736279">&gt;&gt;</span>&nbsp;<span class="num" id="2736282">8</span><span class="op" id="2736283">)</span><span class="op" id="2736284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736288">byte</span><span class="op" id="2736292">(</span><span class="ident" id="2736293">t</span><span class="op" id="2736294">.</span><span class="ident" id="2736295">nsec</span><span class="op" id="2736299">)</span><span class="op" id="2736300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736304">byte</span><span class="op" id="2736308">(</span><span class="ident" id="2736309">offsetMin</span>&nbsp;<span class="op" id="2736319">&gt;&gt;</span>&nbsp;<span class="num" id="2736322">8</span><span class="op" id="2736323">)</span><span class="op" id="2736324">,</span>&nbsp;<span class="comment" id="2736326">//&nbsp;bytes&nbsp;13-14:&nbsp;zone&nbsp;offset&nbsp;in&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2736367">byte</span><span class="op" id="2736371">(</span><span class="ident" id="2736372">offsetMin</span><span class="op" id="2736381">)</span><span class="op" id="2736382">,</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2736385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2736389">return</span>&nbsp;<span class="ident" id="2736396">enc</span><span class="op" id="2736399">,</span>&nbsp;<span class="builtintype" id="2736401">nil</span><br>
<span class="lineno"></span><span class="op" id="2736405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">880</span><span class="comment" id="2736408">//&nbsp;UnmarshalBinary&nbsp;implements&nbsp;the&nbsp;encoding.BinaryUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2736480">func</span>&nbsp;<span class="op" id="2736485">(</span><span class="ident" id="2736486">t</span>&nbsp;<span class="op" id="2736488">*</span><span class="ident" id="2736489">Time</span><span class="op" id="2736493">)</span>&nbsp;<span class="ident" id="2736495">UnmarshalBinary</span><span class="op" id="2736510">(</span><span class="ident" id="2736511">data</span>&nbsp;<span class="op" id="2736516">[</span><span class="op" id="2736517">]</span><span class="builtintype" id="2736518">byte</span><span class="op" id="2736522">)</span>&nbsp;<span class="builtintype" id="2736524">error</span>&nbsp;<span class="op" id="2736530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2736533">buf</span>&nbsp;<span class="op" id="2736537">:=</span>&nbsp;<span class="ident" id="2736540">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2736546">if</span>&nbsp;<span class="builtinfunc" id="2736549">len</span><span class="op" id="2736552">(</span><span class="ident" id="2736553">buf</span><span class="op" id="2736556">)</span>&nbsp;<span class="op" id="2736558">==</span>&nbsp;<span class="num" id="2736561">0</span>&nbsp;<span class="op" id="2736563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2736567">return</span>&nbsp;<span class="ident" id="2736574">errors</span><span class="op" id="2736580">.</span><span class="ident" id="2736581">New</span><span class="op" id="2736584">(</span><span class="string" id="2736585">&#34;Time.UnmarshalBinary:&nbsp;no&nbsp;data&#34;</span><span class="op" id="2736616">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2736619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2736623">if</span>&nbsp;<span class="ident" id="2736626">buf</span><span class="op" id="2736629">[</span><span class="num" id="2736630">0</span><span class="op" id="2736631">]</span>&nbsp;<span class="op" id="2736633">!=</span>&nbsp;<span class="ident" id="2736636">timeBinaryVersion</span>&nbsp;<span class="op" id="2736654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2736658">return</span>&nbsp;<span class="ident" id="2736665">errors</span><span class="op" id="2736671">.</span><span class="ident" id="2736672">New</span><span class="op" id="2736675">(</span><span class="string" id="2736676">&#34;Time.UnmarshalBinary:&nbsp;unsupported&nbsp;version&#34;</span><span class="op" id="2736719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2736722">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2736726">if</span>&nbsp;<span class="builtinfunc" id="2736729">len</span><span class="op" id="2736732">(</span><span class="ident" id="2736733">buf</span><span class="op" id="2736736">)</span>&nbsp;<span class="op" id="2736738">!=</span>&nbsp;<span class="comment" id="2736741">/*version*/</span>&nbsp;<span class="num" id="2736753">1</span><span class="op" id="2736754">+</span>&nbsp;<span class="comment" id="2736756">/*sec*/</span>&nbsp;<span class="num" id="2736764">8</span><span class="op" id="2736765">+</span>&nbsp;<span class="comment" id="2736767">/*nsec*/</span>&nbsp;<span class="num" id="2736776">4</span><span class="op" id="2736777">+</span>&nbsp;<span class="comment" id="2736779">/*zone&nbsp;offset*/</span>&nbsp;<span class="num" id="2736795">2</span>&nbsp;<span class="op" id="2736797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2736801">return</span>&nbsp;<span class="ident" id="2736808">errors</span><span class="op" id="2736814">.</span><span class="ident" id="2736815">New</span><span class="op" id="2736818">(</span><span class="string" id="2736819">&#34;Time.UnmarshalBinary:&nbsp;invalid&nbsp;length&#34;</span><span class="op" id="2736857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2736860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2736864">buf</span>&nbsp;<span class="op" id="2736868">=</span>&nbsp;<span class="ident" id="2736870">buf</span><span class="op" id="2736873">[</span><span class="num" id="2736874">1</span><span class="op" id="2736875">:</span><span class="op" id="2736876">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2736879">t</span><span class="op" id="2736880">.</span><span class="ident" id="2736881">sec</span>&nbsp;<span class="op" id="2736885">=</span>&nbsp;<span class="ident" id="2736887">int64</span><span class="op" id="2736892">(</span><span class="ident" id="2736893">buf</span><span class="op" id="2736896">[</span><span class="num" id="2736897">7</span><span class="op" id="2736898">]</span><span class="op" id="2736899">)</span>&nbsp;<span class="op" id="2736901">|</span>&nbsp;<span class="ident" id="2736903">int64</span><span class="op" id="2736908">(</span><span class="ident" id="2736909">buf</span><span class="op" id="2736912">[</span><span class="num" id="2736913">6</span><span class="op" id="2736914">]</span><span class="op" id="2736915">)</span><span class="op" id="2736916">&lt;&lt;</span><span class="num" id="2736918">8</span>&nbsp;<span class="op" id="2736920">|</span>&nbsp;<span class="ident" id="2736922">int64</span><span class="op" id="2736927">(</span><span class="ident" id="2736928">buf</span><span class="op" id="2736931">[</span><span class="num" id="2736932">5</span><span class="op" id="2736933">]</span><span class="op" id="2736934">)</span><span class="op" id="2736935">&lt;&lt;</span><span class="num" id="2736937">16</span>&nbsp;<span class="op" id="2736940">|</span>&nbsp;<span class="ident" id="2736942">int64</span><span class="op" id="2736947">(</span><span class="ident" id="2736948">buf</span><span class="op" id="2736951">[</span><span class="num" id="2736952">4</span><span class="op" id="2736953">]</span><span class="op" id="2736954">)</span><span class="op" id="2736955">&lt;&lt;</span><span class="num" id="2736957">24</span>&nbsp;<span class="op" id="2736960">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2736964">int64</span><span class="op" id="2736969">(</span><span class="ident" id="2736970">buf</span><span class="op" id="2736973">[</span><span class="num" id="2736974">3</span><span class="op" id="2736975">]</span><span class="op" id="2736976">)</span><span class="op" id="2736977">&lt;&lt;</span><span class="num" id="2736979">32</span>&nbsp;<span class="op" id="2736982">|</span>&nbsp;<span class="ident" id="2736984">int64</span><span class="op" id="2736989">(</span><span class="ident" id="2736990">buf</span><span class="op" id="2736993">[</span><span class="num" id="2736994">2</span><span class="op" id="2736995">]</span><span class="op" id="2736996">)</span><span class="op" id="2736997">&lt;&lt;</span><span class="num" id="2736999">40</span>&nbsp;<span class="op" id="2737002">|</span>&nbsp;<span class="ident" id="2737004">int64</span><span class="op" id="2737009">(</span><span class="ident" id="2737010">buf</span><span class="op" id="2737013">[</span><span class="num" id="2737014">1</span><span class="op" id="2737015">]</span><span class="op" id="2737016">)</span><span class="op" id="2737017">&lt;&lt;</span><span class="num" id="2737019">48</span>&nbsp;<span class="op" id="2737022">|</span>&nbsp;<span class="ident" id="2737024">int64</span><span class="op" id="2737029">(</span><span class="ident" id="2737030">buf</span><span class="op" id="2737033">[</span><span class="num" id="2737034">0</span><span class="op" id="2737035">]</span><span class="op" id="2737036">)</span><span class="op" id="2737037">&lt;&lt;</span><span class="num" id="2737039">56</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2737044">buf</span>&nbsp;<span class="op" id="2737048">=</span>&nbsp;<span class="ident" id="2737050">buf</span><span class="op" id="2737053">[</span><span class="num" id="2737054">8</span><span class="op" id="2737055">:</span><span class="op" id="2737056">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2737059">t</span><span class="op" id="2737060">.</span><span class="ident" id="2737061">nsec</span>&nbsp;<span class="op" id="2737066">=</span>&nbsp;<span class="builtintype" id="2737068">int32</span><span class="op" id="2737073">(</span><span class="ident" id="2737074">buf</span><span class="op" id="2737077">[</span><span class="num" id="2737078">3</span><span class="op" id="2737079">]</span><span class="op" id="2737080">)</span>&nbsp;<span class="op" id="2737082">|</span>&nbsp;<span class="builtintype" id="2737084">int32</span><span class="op" id="2737089">(</span><span class="ident" id="2737090">buf</span><span class="op" id="2737093">[</span><span class="num" id="2737094">2</span><span class="op" id="2737095">]</span><span class="op" id="2737096">)</span><span class="op" id="2737097">&lt;&lt;</span><span class="num" id="2737099">8</span>&nbsp;<span class="op" id="2737101">|</span>&nbsp;<span class="builtintype" id="2737103">int32</span><span class="op" id="2737108">(</span><span class="ident" id="2737109">buf</span><span class="op" id="2737112">[</span><span class="num" id="2737113">1</span><span class="op" id="2737114">]</span><span class="op" id="2737115">)</span><span class="op" id="2737116">&lt;&lt;</span><span class="num" id="2737118">16</span>&nbsp;<span class="op" id="2737121">|</span>&nbsp;<span class="builtintype" id="2737123">int32</span><span class="op" id="2737128">(</span><span class="ident" id="2737129">buf</span><span class="op" id="2737132">[</span><span class="num" id="2737133">0</span><span class="op" id="2737134">]</span><span class="op" id="2737135">)</span><span class="op" id="2737136">&lt;&lt;</span><span class="num" id="2737138">24</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2737143">buf</span>&nbsp;<span class="op" id="2737147">=</span>&nbsp;<span class="ident" id="2737149">buf</span><span class="op" id="2737152">[</span><span class="num" id="2737153">4</span><span class="op" id="2737154">:</span><span class="op" id="2737155">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2737158">offset</span>&nbsp;<span class="op" id="2737165">:=</span>&nbsp;<span class="builtintype" id="2737168">int</span><span class="op" id="2737171">(</span><span class="builtintype" id="2737172">int16</span><span class="op" id="2737177">(</span><span class="ident" id="2737178">buf</span><span class="op" id="2737181">[</span><span class="num" id="2737182">1</span><span class="op" id="2737183">]</span><span class="op" id="2737184">)</span><span class="op" id="2737185">|</span><span class="builtintype" id="2737186">int16</span><span class="op" id="2737191">(</span><span class="ident" id="2737192">buf</span><span class="op" id="2737195">[</span><span class="num" id="2737196">0</span><span class="op" id="2737197">]</span><span class="op" id="2737198">)</span><span class="op" id="2737199">&lt;&lt;</span><span class="num" id="2737201">8</span><span class="op" id="2737202">)</span>&nbsp;<span class="op" id="2737204">*</span>&nbsp;<span class="num" id="2737206">60</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2737211">if</span>&nbsp;<span class="ident" id="2737214">offset</span>&nbsp;<span class="op" id="2737221">==</span>&nbsp;<span class="op" id="2737224">-</span><span class="num" id="2737225">1</span><span class="op" id="2737226">*</span><span class="num" id="2737227">60</span>&nbsp;<span class="op" id="2737230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2737234">t</span><span class="op" id="2737235">.</span><span class="ident" id="2737236">loc</span>&nbsp;<span class="op" id="2737240">=</span>&nbsp;<span class="op" id="2737242">&amp;</span><span class="ident" id="2737243">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2737251">}</span>&nbsp;<span class="keyword" id="2737253">else</span>&nbsp;<span class="keyword" id="2737258">if</span>&nbsp;<span class="ident" id="2737261">_</span><span class="op" id="2737262">,</span>&nbsp;<span class="ident" id="2737264">localoff</span><span class="op" id="2737272">,</span>&nbsp;<span class="ident" id="2737274">_</span><span class="op" id="2737275">,</span>&nbsp;<span class="ident" id="2737277">_</span><span class="op" id="2737278">,</span>&nbsp;<span class="ident" id="2737280">_</span>&nbsp;<span class="op" id="2737282">:=</span>&nbsp;<span class="ident" id="2737285">Local</span><span class="op" id="2737290">.</span><span class="ident" id="2737291">lookup</span><span class="op" id="2737297">(</span><span class="ident" id="2737298">t</span><span class="op" id="2737299">.</span><span class="ident" id="2737300">sec</span>&nbsp;<span class="op" id="2737304">+</span>&nbsp;<span class="ident" id="2737306">internalToUnix</span><span class="op" id="2737320">)</span><span class="op" id="2737321">;</span>&nbsp;<span class="ident" id="2737323">offset</span>&nbsp;<span class="op" id="2737330">==</span>&nbsp;<span class="ident" id="2737333">localoff</span>&nbsp;<span class="op" id="2737342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2737346">t</span><span class="op" id="2737347">.</span><span class="ident" id="2737348">loc</span>&nbsp;<span class="op" id="2737352">=</span>&nbsp;<span class="ident" id="2737354">Local</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2737361">}</span>&nbsp;<span class="keyword" id="2737363">else</span>&nbsp;<span class="op" id="2737368">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2737372">t</span><span class="op" id="2737373">.</span><span class="ident" id="2737374">loc</span>&nbsp;<span class="op" id="2737378">=</span>&nbsp;<span class="ident" id="2737380">FixedZone</span><span class="op" id="2737389">(</span><span class="string" id="2737390">&#34;&#34;</span><span class="op" id="2737392">,</span>&nbsp;<span class="ident" id="2737394">offset</span><span class="op" id="2737400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2737403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2737407">return</span>&nbsp;<span class="builtintype" id="2737414">nil</span><br>
<span class="lineno"></span><span class="op" id="2737418">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="comment" id="2737421">//&nbsp;TODO(rsc):&nbsp;Remove&nbsp;GobEncoder,&nbsp;GobDecoder,&nbsp;MarshalJSON,&nbsp;UnmarshalJSON&nbsp;in&nbsp;Go&nbsp;2.</span><br>
<span class="lineno"></span><span class="comment" id="2737502">//&nbsp;The&nbsp;same&nbsp;semantics&nbsp;will&nbsp;be&nbsp;provided&nbsp;by&nbsp;the&nbsp;generic&nbsp;MarshalBinary,&nbsp;MarshalText,</span><br>
<span class="lineno"></span><span class="comment" id="2737584">//&nbsp;UnmarshalBinary,&nbsp;UnmarshalText.</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span><span class="comment" id="2737620">//&nbsp;GobEncode&nbsp;implements&nbsp;the&nbsp;gob.GobEncoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2737674">func</span>&nbsp;<span class="op" id="2737679">(</span><span class="ident" id="2737680">t</span>&nbsp;<span class="ident" id="2737682">Time</span><span class="op" id="2737686">)</span>&nbsp;<span class="ident" id="2737688">GobEncode</span><span class="op" id="2737697">(</span><span class="op" id="2737698">)</span>&nbsp;<span class="op" id="2737700">(</span><span class="op" id="2737701">[</span><span class="op" id="2737702">]</span><span class="builtintype" id="2737703">byte</span><span class="op" id="2737707">,</span>&nbsp;<span class="builtintype" id="2737709">error</span><span class="op" id="2737714">)</span>&nbsp;<span class="op" id="2737716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2737719">return</span>&nbsp;<span class="ident" id="2737726">t</span><span class="op" id="2737727">.</span><span class="ident" id="2737728">MarshalBinary</span><span class="op" id="2737741">(</span><span class="op" id="2737742">)</span><br>
<span class="lineno"></span><span class="op" id="2737744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="comment" id="2737747">//&nbsp;GobDecode&nbsp;implements&nbsp;the&nbsp;gob.GobDecoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2737801">func</span>&nbsp;<span class="op" id="2737806">(</span><span class="ident" id="2737807">t</span>&nbsp;<span class="op" id="2737809">*</span><span class="ident" id="2737810">Time</span><span class="op" id="2737814">)</span>&nbsp;<span class="ident" id="2737816">GobDecode</span><span class="op" id="2737825">(</span><span class="ident" id="2737826">data</span>&nbsp;<span class="op" id="2737831">[</span><span class="op" id="2737832">]</span><span class="builtintype" id="2737833">byte</span><span class="op" id="2737837">)</span>&nbsp;<span class="builtintype" id="2737839">error</span>&nbsp;<span class="op" id="2737845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2737848">return</span>&nbsp;<span class="ident" id="2737855">t</span><span class="op" id="2737856">.</span><span class="ident" id="2737857">UnmarshalBinary</span><span class="op" id="2737872">(</span><span class="ident" id="2737873">data</span><span class="op" id="2737877">)</span><br>
<span class="lineno"></span><span class="op" id="2737879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span><span class="comment" id="2737882">//&nbsp;MarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Marshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2737938">//&nbsp;The&nbsp;time&nbsp;is&nbsp;a&nbsp;quoted&nbsp;string&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format,&nbsp;with&nbsp;sub-second&nbsp;precision&nbsp;added&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2738033">func</span>&nbsp;<span class="op" id="2738038">(</span><span class="ident" id="2738039">t</span>&nbsp;<span class="ident" id="2738041">Time</span><span class="op" id="2738045">)</span>&nbsp;<span class="ident" id="2738047">MarshalJSON</span><span class="op" id="2738058">(</span><span class="op" id="2738059">)</span>&nbsp;<span class="op" id="2738061">(</span><span class="op" id="2738062">[</span><span class="op" id="2738063">]</span><span class="builtintype" id="2738064">byte</span><span class="op" id="2738068">,</span>&nbsp;<span class="builtintype" id="2738070">error</span><span class="op" id="2738075">)</span>&nbsp;<span class="op" id="2738077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2738080">if</span>&nbsp;<span class="ident" id="2738083">y</span>&nbsp;<span class="op" id="2738085">:=</span>&nbsp;<span class="ident" id="2738088">t</span><span class="op" id="2738089">.</span><span class="ident" id="2738090">Year</span><span class="op" id="2738094">(</span><span class="op" id="2738095">)</span><span class="op" id="2738096">;</span>&nbsp;<span class="ident" id="2738098">y</span>&nbsp;<span class="op" id="2738100">&lt;</span>&nbsp;<span class="num" id="2738102">0</span>&nbsp;<span class="op" id="2738104">||</span>&nbsp;<span class="ident" id="2738107">y</span>&nbsp;<span class="op" id="2738109">&gt;=</span>&nbsp;<span class="num" id="2738112">10000</span>&nbsp;<span class="op" id="2738118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2738122">//&nbsp;RFC&nbsp;3339&nbsp;is&nbsp;clear&nbsp;that&nbsp;years&nbsp;are&nbsp;4&nbsp;digits&nbsp;exactly.</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2738178">//&nbsp;See&nbsp;golang.org/issue/4556#c15&nbsp;for&nbsp;more&nbsp;discussion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2738234">return</span>&nbsp;<span class="builtintype" id="2738241">nil</span><span class="op" id="2738244">,</span>&nbsp;<span class="ident" id="2738246">errors</span><span class="op" id="2738252">.</span><span class="ident" id="2738253">New</span><span class="op" id="2738256">(</span><span class="string" id="2738257">&#34;Time.MarshalJSON:&nbsp;year&nbsp;outside&nbsp;of&nbsp;range&nbsp;[0,9999]&#34;</span><span class="op" id="2738307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2738310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2738313">return</span>&nbsp;<span class="op" id="2738320">[</span><span class="op" id="2738321">]</span><span class="builtintype" id="2738322">byte</span><span class="op" id="2738326">(</span><span class="ident" id="2738327">t</span><span class="op" id="2738328">.</span><span class="ident" id="2738329">Format</span><span class="op" id="2738335">(</span><span class="string" id="2738336">`&#34;`</span>&nbsp;<span class="op" id="2738340">+</span>&nbsp;<span class="ident" id="2738342">RFC3339Nano</span>&nbsp;<span class="op" id="2738354">+</span>&nbsp;<span class="string" id="2738356">`&#34;`</span><span class="op" id="2738359">)</span><span class="op" id="2738360">)</span><span class="op" id="2738361">,</span>&nbsp;<span class="builtintype" id="2738363">nil</span><br>
<span class="lineno"></span><span class="op" id="2738367">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="comment" id="2738370">//&nbsp;UnmarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Unmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2738430">//&nbsp;The&nbsp;time&nbsp;is&nbsp;expected&nbsp;to&nbsp;be&nbsp;a&nbsp;quoted&nbsp;string&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="2738496">func</span>&nbsp;<span class="op" id="2738501">(</span><span class="ident" id="2738502">t</span>&nbsp;<span class="op" id="2738504">*</span><span class="ident" id="2738505">Time</span><span class="op" id="2738509">)</span>&nbsp;<span class="ident" id="2738511">UnmarshalJSON</span><span class="op" id="2738524">(</span><span class="ident" id="2738525">data</span>&nbsp;<span class="op" id="2738530">[</span><span class="op" id="2738531">]</span><span class="builtintype" id="2738532">byte</span><span class="op" id="2738536">)</span>&nbsp;<span class="op" id="2738538">(</span><span class="ident" id="2738539">err</span>&nbsp;<span class="builtintype" id="2738543">error</span><span class="op" id="2738548">)</span>&nbsp;<span class="op" id="2738550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2738553">//&nbsp;Fractional&nbsp;seconds&nbsp;are&nbsp;handled&nbsp;implicitly&nbsp;by&nbsp;Parse.</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2738609">*</span><span class="ident" id="2738610">t</span><span class="op" id="2738611">,</span>&nbsp;<span class="ident" id="2738613">err</span>&nbsp;<span class="op" id="2738617">=</span>&nbsp;<span class="ident" id="2738619">Parse</span><span class="op" id="2738624">(</span><span class="string" id="2738625">`&#34;`</span><span class="op" id="2738628">+</span><span class="ident" id="2738629">RFC3339</span><span class="op" id="2738636">+</span><span class="string" id="2738637">`&#34;`</span><span class="op" id="2738640">,</span>&nbsp;<span class="builtintype" id="2738642">string</span><span class="op" id="2738648">(</span><span class="ident" id="2738649">data</span><span class="op" id="2738653">)</span><span class="op" id="2738654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2738657">return</span><br>
<span class="lineno"></span><span class="op" id="2738664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2738667">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno">950</span><span class="comment" id="2738731">//&nbsp;The&nbsp;time&nbsp;is&nbsp;formatted&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format,&nbsp;with&nbsp;sub-second&nbsp;precision&nbsp;added&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2738820">func</span>&nbsp;<span class="op" id="2738825">(</span><span class="ident" id="2738826">t</span>&nbsp;<span class="ident" id="2738828">Time</span><span class="op" id="2738832">)</span>&nbsp;<span class="ident" id="2738834">MarshalText</span><span class="op" id="2738845">(</span><span class="op" id="2738846">)</span>&nbsp;<span class="op" id="2738848">(</span><span class="op" id="2738849">[</span><span class="op" id="2738850">]</span><span class="builtintype" id="2738851">byte</span><span class="op" id="2738855">,</span>&nbsp;<span class="builtintype" id="2738857">error</span><span class="op" id="2738862">)</span>&nbsp;<span class="op" id="2738864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2738867">if</span>&nbsp;<span class="ident" id="2738870">y</span>&nbsp;<span class="op" id="2738872">:=</span>&nbsp;<span class="ident" id="2738875">t</span><span class="op" id="2738876">.</span><span class="ident" id="2738877">Year</span><span class="op" id="2738881">(</span><span class="op" id="2738882">)</span><span class="op" id="2738883">;</span>&nbsp;<span class="ident" id="2738885">y</span>&nbsp;<span class="op" id="2738887">&lt;</span>&nbsp;<span class="num" id="2738889">0</span>&nbsp;<span class="op" id="2738891">||</span>&nbsp;<span class="ident" id="2738894">y</span>&nbsp;<span class="op" id="2738896">&gt;=</span>&nbsp;<span class="num" id="2738899">10000</span>&nbsp;<span class="op" id="2738905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2738909">return</span>&nbsp;<span class="builtintype" id="2738916">nil</span><span class="op" id="2738919">,</span>&nbsp;<span class="ident" id="2738921">errors</span><span class="op" id="2738927">.</span><span class="ident" id="2738928">New</span><span class="op" id="2738931">(</span><span class="string" id="2738932">&#34;Time.MarshalText:&nbsp;year&nbsp;outside&nbsp;of&nbsp;range&nbsp;[0,9999]&#34;</span><span class="op" id="2738982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2738985">}</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2738988">return</span>&nbsp;<span class="op" id="2738995">[</span><span class="op" id="2738996">]</span><span class="builtintype" id="2738997">byte</span><span class="op" id="2739001">(</span><span class="ident" id="2739002">t</span><span class="op" id="2739003">.</span><span class="ident" id="2739004">Format</span><span class="op" id="2739010">(</span><span class="ident" id="2739011">RFC3339Nano</span><span class="op" id="2739022">)</span><span class="op" id="2739023">)</span><span class="op" id="2739024">,</span>&nbsp;<span class="builtintype" id="2739026">nil</span><br>
<span class="lineno"></span><span class="op" id="2739030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2739033">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2739101">//&nbsp;The&nbsp;time&nbsp;is&nbsp;expected&nbsp;to&nbsp;be&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format.</span><br>
<span class="lineno">960</span><span class="keyword" id="2739151">func</span>&nbsp;<span class="op" id="2739156">(</span><span class="ident" id="2739157">t</span>&nbsp;<span class="op" id="2739159">*</span><span class="ident" id="2739160">Time</span><span class="op" id="2739164">)</span>&nbsp;<span class="ident" id="2739166">UnmarshalText</span><span class="op" id="2739179">(</span><span class="ident" id="2739180">data</span>&nbsp;<span class="op" id="2739185">[</span><span class="op" id="2739186">]</span><span class="builtintype" id="2739187">byte</span><span class="op" id="2739191">)</span>&nbsp;<span class="op" id="2739193">(</span><span class="ident" id="2739194">err</span>&nbsp;<span class="builtintype" id="2739198">error</span><span class="op" id="2739203">)</span>&nbsp;<span class="op" id="2739205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2739208">//&nbsp;Fractional&nbsp;seconds&nbsp;are&nbsp;handled&nbsp;implicitly&nbsp;by&nbsp;Parse.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2739264">*</span><span class="ident" id="2739265">t</span><span class="op" id="2739266">,</span>&nbsp;<span class="ident" id="2739268">err</span>&nbsp;<span class="op" id="2739272">=</span>&nbsp;<span class="ident" id="2739274">Parse</span><span class="op" id="2739279">(</span><span class="ident" id="2739280">RFC3339</span><span class="op" id="2739287">,</span>&nbsp;<span class="builtintype" id="2739289">string</span><span class="op" id="2739295">(</span><span class="ident" id="2739296">data</span><span class="op" id="2739300">)</span><span class="op" id="2739301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2739304">return</span><br>
<span class="lineno"></span><span class="op" id="2739311">}</span><br>
<span class="lineno">965</span><br>
<span class="lineno"></span><span class="comment" id="2739314">//&nbsp;Unix&nbsp;returns&nbsp;the&nbsp;local&nbsp;Time&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;given&nbsp;Unix&nbsp;time,</span><br>
<span class="lineno"></span><span class="comment" id="2739383">//&nbsp;sec&nbsp;seconds&nbsp;and&nbsp;nsec&nbsp;nanoseconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2739446">//&nbsp;It&nbsp;is&nbsp;valid&nbsp;to&nbsp;pass&nbsp;nsec&nbsp;outside&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span><span class="keyword" id="2739508">func</span>&nbsp;<span class="ident" id="2739513">Unix</span><span class="op" id="2739517">(</span><span class="ident" id="2739518">sec</span>&nbsp;<span class="ident" id="2739522">int64</span><span class="op" id="2739527">,</span>&nbsp;<span class="ident" id="2739529">nsec</span>&nbsp;<span class="ident" id="2739534">int64</span><span class="op" id="2739539">)</span>&nbsp;<span class="ident" id="2739541">Time</span>&nbsp;<span class="op" id="2739546">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2739549">if</span>&nbsp;<span class="ident" id="2739552">nsec</span>&nbsp;<span class="op" id="2739557">&lt;</span>&nbsp;<span class="num" id="2739559">0</span>&nbsp;<span class="op" id="2739561">||</span>&nbsp;<span class="ident" id="2739564">nsec</span>&nbsp;<span class="op" id="2739569">&gt;=</span>&nbsp;<span class="num" id="2739572">1e9</span>&nbsp;<span class="op" id="2739576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2739580">n</span>&nbsp;<span class="op" id="2739582">:=</span>&nbsp;<span class="ident" id="2739585">nsec</span>&nbsp;<span class="op" id="2739590">/</span>&nbsp;<span class="num" id="2739592">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2739598">sec</span>&nbsp;<span class="op" id="2739602">+=</span>&nbsp;<span class="ident" id="2739605">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2739609">nsec</span>&nbsp;<span class="op" id="2739614">-=</span>&nbsp;<span class="ident" id="2739617">n</span>&nbsp;<span class="op" id="2739619">*</span>&nbsp;<span class="num" id="2739621">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2739627">if</span>&nbsp;<span class="ident" id="2739630">nsec</span>&nbsp;<span class="op" id="2739635">&lt;</span>&nbsp;<span class="num" id="2739637">0</span>&nbsp;<span class="op" id="2739639">{</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2739644">nsec</span>&nbsp;<span class="op" id="2739649">+=</span>&nbsp;<span class="num" id="2739652">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2739659">sec</span><span class="op" id="2739662">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2739667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2739670">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2739673">return</span>&nbsp;<span class="ident" id="2739680">Time</span><span class="op" id="2739684">{</span><span class="ident" id="2739685">sec</span>&nbsp;<span class="op" id="2739689">+</span>&nbsp;<span class="ident" id="2739691">unixToInternal</span><span class="op" id="2739705">,</span>&nbsp;<span class="builtintype" id="2739707">int32</span><span class="op" id="2739712">(</span><span class="ident" id="2739713">nsec</span><span class="op" id="2739717">)</span><span class="op" id="2739718">,</span>&nbsp;<span class="ident" id="2739720">Local</span><span class="op" id="2739725">}</span><br>
<span class="lineno">980</span><span class="op" id="2739727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2739730">func</span>&nbsp;<span class="ident" id="2739735">isLeap</span><span class="op" id="2739741">(</span><span class="ident" id="2739742">year</span>&nbsp;<span class="builtintype" id="2739747">int</span><span class="op" id="2739750">)</span>&nbsp;<span class="builtintype" id="2739752">bool</span>&nbsp;<span class="op" id="2739757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2739760">return</span>&nbsp;<span class="ident" id="2739767">year</span><span class="op" id="2739771">%</span><span class="num" id="2739772">4</span>&nbsp;<span class="op" id="2739774">==</span>&nbsp;<span class="num" id="2739777">0</span>&nbsp;<span class="op" id="2739779">&amp;&amp;</span>&nbsp;<span class="op" id="2739782">(</span><span class="ident" id="2739783">year</span><span class="op" id="2739787">%</span><span class="num" id="2739788">100</span>&nbsp;<span class="op" id="2739792">!=</span>&nbsp;<span class="num" id="2739795">0</span>&nbsp;<span class="op" id="2739797">||</span>&nbsp;<span class="ident" id="2739800">year</span><span class="op" id="2739804">%</span><span class="num" id="2739805">400</span>&nbsp;<span class="op" id="2739809">==</span>&nbsp;<span class="num" id="2739812">0</span><span class="op" id="2739813">)</span><br>
<span class="lineno"></span><span class="op" id="2739815">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="2739818">//&nbsp;norm&nbsp;returns&nbsp;nhi,&nbsp;nlo&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2739853">//&nbsp;&nbsp;&nbsp;&nbsp;hi&nbsp;*&nbsp;base&nbsp;+&nbsp;lo&nbsp;==&nbsp;nhi&nbsp;*&nbsp;base&nbsp;+&nbsp;nlo</span><br>
<span class="lineno"></span><span class="comment" id="2739891">//&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&lt;=&nbsp;nlo&nbsp;&lt;&nbsp;base</span><br>
<span class="lineno"></span><span class="keyword" id="2739910">func</span>&nbsp;<span class="ident" id="2739915">norm</span><span class="op" id="2739919">(</span><span class="ident" id="2739920">hi</span><span class="op" id="2739922">,</span>&nbsp;<span class="ident" id="2739924">lo</span><span class="op" id="2739926">,</span>&nbsp;<span class="ident" id="2739928">base</span>&nbsp;<span class="builtintype" id="2739933">int</span><span class="op" id="2739936">)</span>&nbsp;<span class="op" id="2739938">(</span><span class="ident" id="2739939">nhi</span><span class="op" id="2739942">,</span>&nbsp;<span class="ident" id="2739944">nlo</span>&nbsp;<span class="builtintype" id="2739948">int</span><span class="op" id="2739951">)</span>&nbsp;<span class="op" id="2739953">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2739956">if</span>&nbsp;<span class="ident" id="2739959">lo</span>&nbsp;<span class="op" id="2739962">&lt;</span>&nbsp;<span class="num" id="2739964">0</span>&nbsp;<span class="op" id="2739966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2739970">n</span>&nbsp;<span class="op" id="2739972">:=</span>&nbsp;<span class="op" id="2739975">(</span><span class="op" id="2739976">-</span><span class="ident" id="2739977">lo</span><span class="op" id="2739979">-</span><span class="num" id="2739980">1</span><span class="op" id="2739981">)</span><span class="op" id="2739982">/</span><span class="ident" id="2739983">base</span>&nbsp;<span class="op" id="2739988">+</span>&nbsp;<span class="num" id="2739990">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2739994">hi</span>&nbsp;<span class="op" id="2739997">-=</span>&nbsp;<span class="ident" id="2740000">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2740004">lo</span>&nbsp;<span class="op" id="2740007">+=</span>&nbsp;<span class="ident" id="2740010">n</span>&nbsp;<span class="op" id="2740012">*</span>&nbsp;<span class="ident" id="2740014">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2740020">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2740023">if</span>&nbsp;<span class="ident" id="2740026">lo</span>&nbsp;<span class="op" id="2740029">&gt;=</span>&nbsp;<span class="ident" id="2740032">base</span>&nbsp;<span class="op" id="2740037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2740041">n</span>&nbsp;<span class="op" id="2740043">:=</span>&nbsp;<span class="ident" id="2740046">lo</span>&nbsp;<span class="op" id="2740049">/</span>&nbsp;<span class="ident" id="2740051">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2740058">hi</span>&nbsp;<span class="op" id="2740061">+=</span>&nbsp;<span class="ident" id="2740064">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2740068">lo</span>&nbsp;<span class="op" id="2740071">-=</span>&nbsp;<span class="ident" id="2740074">n</span>&nbsp;<span class="op" id="2740076">*</span>&nbsp;<span class="ident" id="2740078">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2740084">}</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2740087">return</span>&nbsp;<span class="ident" id="2740094">hi</span><span class="op" id="2740096">,</span>&nbsp;<span class="ident" id="2740098">lo</span><br>
<span class="lineno"></span><span class="op" id="2740101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2740104">//&nbsp;Date&nbsp;returns&nbsp;the&nbsp;Time&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2740146">//&nbsp;&nbsp;&nbsp;&nbsp;yyyy-mm-dd&nbsp;hh:mm:ss&nbsp;+&nbsp;nsec&nbsp;nanoseconds</span><br>
<span class="lineno">1005</span><span class="comment" id="2740188">//&nbsp;in&nbsp;the&nbsp;appropriate&nbsp;zone&nbsp;for&nbsp;that&nbsp;time&nbsp;in&nbsp;the&nbsp;given&nbsp;location.</span><br>
<span class="lineno"></span><span class="comment" id="2740252">//</span><br>
<span class="lineno"></span><span class="comment" id="2740255">//&nbsp;The&nbsp;month,&nbsp;day,&nbsp;hour,&nbsp;min,&nbsp;sec,&nbsp;and&nbsp;nsec&nbsp;values&nbsp;may&nbsp;be&nbsp;outside</span><br>
<span class="lineno"></span><span class="comment" id="2740321">//&nbsp;their&nbsp;usual&nbsp;ranges&nbsp;and&nbsp;will&nbsp;be&nbsp;normalized&nbsp;during&nbsp;the&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="2740389">//&nbsp;For&nbsp;example,&nbsp;October&nbsp;32&nbsp;converts&nbsp;to&nbsp;November&nbsp;1.</span><br>
<span class="lineno">1010</span><span class="comment" id="2740440">//</span><br>
<span class="lineno"></span><span class="comment" id="2740443">//&nbsp;A&nbsp;daylight&nbsp;savings&nbsp;time&nbsp;transition&nbsp;skips&nbsp;or&nbsp;repeats&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2740505">//&nbsp;For&nbsp;example,&nbsp;in&nbsp;the&nbsp;United&nbsp;States,&nbsp;March&nbsp;13,&nbsp;2011&nbsp;2:15am&nbsp;never&nbsp;occurred,</span><br>
<span class="lineno"></span><span class="comment" id="2740581">//&nbsp;while&nbsp;November&nbsp;6,&nbsp;2011&nbsp;1:15am&nbsp;occurred&nbsp;twice.&nbsp;&nbsp;In&nbsp;such&nbsp;cases,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2740650">//&nbsp;choice&nbsp;of&nbsp;time&nbsp;zone,&nbsp;and&nbsp;therefore&nbsp;the&nbsp;time,&nbsp;is&nbsp;not&nbsp;well-defined.</span><br>
<span class="lineno">1015</span><span class="comment" id="2740719">//&nbsp;Date&nbsp;returns&nbsp;a&nbsp;time&nbsp;that&nbsp;is&nbsp;correct&nbsp;in&nbsp;one&nbsp;of&nbsp;the&nbsp;two&nbsp;zones&nbsp;involved</span><br>
<span class="lineno"></span><span class="comment" id="2740791">//&nbsp;in&nbsp;the&nbsp;transition,&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;guarantee&nbsp;which.</span><br>
<span class="lineno"></span><span class="comment" id="2740846">//</span><br>
<span class="lineno"></span><span class="comment" id="2740849">//&nbsp;Date&nbsp;panics&nbsp;if&nbsp;loc&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2740879">func</span>&nbsp;<span class="ident" id="2740884">Date</span><span class="op" id="2740888">(</span><span class="ident" id="2740889">year</span>&nbsp;<span class="builtintype" id="2740894">int</span><span class="op" id="2740897">,</span>&nbsp;<span class="ident" id="2740899">month</span>&nbsp;<span class="ident" id="2740905">Month</span><span class="op" id="2740910">,</span>&nbsp;<span class="ident" id="2740912">day</span><span class="op" id="2740915">,</span>&nbsp;<span class="ident" id="2740917">hour</span><span class="op" id="2740921">,</span>&nbsp;<span class="ident" id="2740923">min</span><span class="op" id="2740926">,</span>&nbsp;<span class="ident" id="2740928">sec</span><span class="op" id="2740931">,</span>&nbsp;<span class="ident" id="2740933">nsec</span>&nbsp;<span class="builtintype" id="2740938">int</span><span class="op" id="2740941">,</span>&nbsp;<span class="ident" id="2740943">loc</span>&nbsp;<span class="op" id="2740947">*</span><span class="ident" id="2740948">Location</span><span class="op" id="2740956">)</span>&nbsp;<span class="ident" id="2740958">Time</span>&nbsp;<span class="op" id="2740963">{</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2740966">if</span>&nbsp;<span class="ident" id="2740969">loc</span>&nbsp;<span class="op" id="2740973">==</span>&nbsp;<span class="builtintype" id="2740976">nil</span>&nbsp;<span class="op" id="2740980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2740984">panic</span><span class="op" id="2740989">(</span><span class="string" id="2740990">&#34;time:&nbsp;missing&nbsp;Location&nbsp;in&nbsp;call&nbsp;to&nbsp;Date&#34;</span><span class="op" id="2741030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2741033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2741037">//&nbsp;Normalize&nbsp;month,&nbsp;overflowing&nbsp;into&nbsp;year.</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741081">m</span>&nbsp;<span class="op" id="2741083">:=</span>&nbsp;<span class="builtintype" id="2741086">int</span><span class="op" id="2741089">(</span><span class="ident" id="2741090">month</span><span class="op" id="2741095">)</span>&nbsp;<span class="op" id="2741097">-</span>&nbsp;<span class="num" id="2741099">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741102">year</span><span class="op" id="2741106">,</span>&nbsp;<span class="ident" id="2741108">m</span>&nbsp;<span class="op" id="2741110">=</span>&nbsp;<span class="ident" id="2741112">norm</span><span class="op" id="2741116">(</span><span class="ident" id="2741117">year</span><span class="op" id="2741121">,</span>&nbsp;<span class="ident" id="2741123">m</span><span class="op" id="2741124">,</span>&nbsp;<span class="num" id="2741126">12</span><span class="op" id="2741128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741131">month</span>&nbsp;<span class="op" id="2741137">=</span>&nbsp;<span class="ident" id="2741139">Month</span><span class="op" id="2741144">(</span><span class="ident" id="2741145">m</span><span class="op" id="2741146">)</span>&nbsp;<span class="op" id="2741148">+</span>&nbsp;<span class="num" id="2741150">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2741154">//&nbsp;Normalize&nbsp;nsec,&nbsp;sec,&nbsp;min,&nbsp;hour,&nbsp;overflowing&nbsp;into&nbsp;day.</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741212">sec</span><span class="op" id="2741215">,</span>&nbsp;<span class="ident" id="2741217">nsec</span>&nbsp;<span class="op" id="2741222">=</span>&nbsp;<span class="ident" id="2741224">norm</span><span class="op" id="2741228">(</span><span class="ident" id="2741229">sec</span><span class="op" id="2741232">,</span>&nbsp;<span class="ident" id="2741234">nsec</span><span class="op" id="2741238">,</span>&nbsp;<span class="num" id="2741240">1e9</span><span class="op" id="2741243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741246">min</span><span class="op" id="2741249">,</span>&nbsp;<span class="ident" id="2741251">sec</span>&nbsp;<span class="op" id="2741255">=</span>&nbsp;<span class="ident" id="2741257">norm</span><span class="op" id="2741261">(</span><span class="ident" id="2741262">min</span><span class="op" id="2741265">,</span>&nbsp;<span class="ident" id="2741267">sec</span><span class="op" id="2741270">,</span>&nbsp;<span class="num" id="2741272">60</span><span class="op" id="2741274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741277">hour</span><span class="op" id="2741281">,</span>&nbsp;<span class="ident" id="2741283">min</span>&nbsp;<span class="op" id="2741287">=</span>&nbsp;<span class="ident" id="2741289">norm</span><span class="op" id="2741293">(</span><span class="ident" id="2741294">hour</span><span class="op" id="2741298">,</span>&nbsp;<span class="ident" id="2741300">min</span><span class="op" id="2741303">,</span>&nbsp;<span class="num" id="2741305">60</span><span class="op" id="2741307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741310">day</span><span class="op" id="2741313">,</span>&nbsp;<span class="ident" id="2741315">hour</span>&nbsp;<span class="op" id="2741320">=</span>&nbsp;<span class="ident" id="2741322">norm</span><span class="op" id="2741326">(</span><span class="ident" id="2741327">day</span><span class="op" id="2741330">,</span>&nbsp;<span class="ident" id="2741332">hour</span><span class="op" id="2741336">,</span>&nbsp;<span class="num" id="2741338">24</span><span class="op" id="2741340">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741344">y</span>&nbsp;<span class="op" id="2741346">:=</span>&nbsp;<span class="ident" id="2741349">uint64</span><span class="op" id="2741355">(</span><span class="ident" id="2741356">int64</span><span class="op" id="2741361">(</span><span class="ident" id="2741362">year</span><span class="op" id="2741366">)</span>&nbsp;<span class="op" id="2741368">-</span>&nbsp;<span class="ident" id="2741370">absoluteZeroYear</span><span class="op" id="2741386">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2741390">//&nbsp;Compute&nbsp;days&nbsp;since&nbsp;the&nbsp;absolute&nbsp;epoch.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2741434">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;from&nbsp;400-year&nbsp;cycles.</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741472">n</span>&nbsp;<span class="op" id="2741474">:=</span>&nbsp;<span class="ident" id="2741477">y</span>&nbsp;<span class="op" id="2741479">/</span>&nbsp;<span class="num" id="2741481">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741486">y</span>&nbsp;<span class="op" id="2741488">-=</span>&nbsp;<span class="num" id="2741491">400</span>&nbsp;<span class="op" id="2741495">*</span>&nbsp;<span class="ident" id="2741497">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741500">d</span>&nbsp;<span class="op" id="2741502">:=</span>&nbsp;<span class="ident" id="2741505">daysPer400Years</span>&nbsp;<span class="op" id="2741521">*</span>&nbsp;<span class="ident" id="2741523">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2741527">//&nbsp;Add&nbsp;in&nbsp;100-year&nbsp;cycles.</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741555">n</span>&nbsp;<span class="op" id="2741557">=</span>&nbsp;<span class="ident" id="2741559">y</span>&nbsp;<span class="op" id="2741561">/</span>&nbsp;<span class="num" id="2741563">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741568">y</span>&nbsp;<span class="op" id="2741570">-=</span>&nbsp;<span class="num" id="2741573">100</span>&nbsp;<span class="op" id="2741577">*</span>&nbsp;<span class="ident" id="2741579">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741582">d</span>&nbsp;<span class="op" id="2741584">+=</span>&nbsp;<span class="ident" id="2741587">daysPer100Years</span>&nbsp;<span class="op" id="2741603">*</span>&nbsp;<span class="ident" id="2741605">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2741609">//&nbsp;Add&nbsp;in&nbsp;4-year&nbsp;cycles.</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741635">n</span>&nbsp;<span class="op" id="2741637">=</span>&nbsp;<span class="ident" id="2741639">y</span>&nbsp;<span class="op" id="2741641">/</span>&nbsp;<span class="num" id="2741643">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741646">y</span>&nbsp;<span class="op" id="2741648">-=</span>&nbsp;<span class="num" id="2741651">4</span>&nbsp;<span class="op" id="2741653">*</span>&nbsp;<span class="ident" id="2741655">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741658">d</span>&nbsp;<span class="op" id="2741660">+=</span>&nbsp;<span class="ident" id="2741663">daysPer4Years</span>&nbsp;<span class="op" id="2741677">*</span>&nbsp;<span class="ident" id="2741679">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2741683">//&nbsp;Add&nbsp;in&nbsp;non-leap&nbsp;years.</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741710">n</span>&nbsp;<span class="op" id="2741712">=</span>&nbsp;<span class="ident" id="2741714">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741717">d</span>&nbsp;<span class="op" id="2741719">+=</span>&nbsp;<span class="num" id="2741722">365</span>&nbsp;<span class="op" id="2741726">*</span>&nbsp;<span class="ident" id="2741728">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2741732">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;before&nbsp;this&nbsp;month.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741767">d</span>&nbsp;<span class="op" id="2741769">+=</span>&nbsp;<span class="ident" id="2741772">uint64</span><span class="op" id="2741778">(</span><span class="ident" id="2741779">daysBefore</span><span class="op" id="2741789">[</span><span class="ident" id="2741790">month</span><span class="op" id="2741795">-</span><span class="num" id="2741796">1</span><span class="op" id="2741797">]</span><span class="op" id="2741798">)</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2741801">if</span>&nbsp;<span class="ident" id="2741804">isLeap</span><span class="op" id="2741810">(</span><span class="ident" id="2741811">year</span><span class="op" id="2741815">)</span>&nbsp;<span class="op" id="2741817">&amp;&amp;</span>&nbsp;<span class="ident" id="2741820">month</span>&nbsp;<span class="op" id="2741826">&gt;=</span>&nbsp;<span class="ident" id="2741829">March</span>&nbsp;<span class="op" id="2741835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741839">d</span><span class="op" id="2741840">++</span>&nbsp;<span class="comment" id="2741843">//&nbsp;February&nbsp;29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2741859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2741863">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;before&nbsp;today.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741893">d</span>&nbsp;<span class="op" id="2741895">+=</span>&nbsp;<span class="ident" id="2741898">uint64</span><span class="op" id="2741904">(</span><span class="ident" id="2741905">day</span>&nbsp;<span class="op" id="2741909">-</span>&nbsp;<span class="num" id="2741911">1</span><span class="op" id="2741912">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2741916">//&nbsp;Add&nbsp;in&nbsp;time&nbsp;elapsed&nbsp;today.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741947">abs</span>&nbsp;<span class="op" id="2741951">:=</span>&nbsp;<span class="ident" id="2741954">d</span>&nbsp;<span class="op" id="2741956">*</span>&nbsp;<span class="ident" id="2741958">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2741973">abs</span>&nbsp;<span class="op" id="2741977">+=</span>&nbsp;<span class="ident" id="2741980">uint64</span><span class="op" id="2741986">(</span><span class="ident" id="2741987">hour</span><span class="op" id="2741991">*</span><span class="ident" id="2741992">secondsPerHour</span>&nbsp;<span class="op" id="2742007">+</span>&nbsp;<span class="ident" id="2742009">min</span><span class="op" id="2742012">*</span><span class="ident" id="2742013">secondsPerMinute</span>&nbsp;<span class="op" id="2742030">+</span>&nbsp;<span class="ident" id="2742032">sec</span><span class="op" id="2742035">)</span><br>
<span class="lineno">1070</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2742039">unix</span>&nbsp;<span class="op" id="2742044">:=</span>&nbsp;<span class="ident" id="2742047">int64</span><span class="op" id="2742052">(</span><span class="ident" id="2742053">abs</span><span class="op" id="2742056">)</span>&nbsp;<span class="op" id="2742058">+</span>&nbsp;<span class="op" id="2742060">(</span><span class="ident" id="2742061">absoluteToInternal</span>&nbsp;<span class="op" id="2742080">+</span>&nbsp;<span class="ident" id="2742082">internalToUnix</span><span class="op" id="2742096">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2742100">//&nbsp;Look&nbsp;for&nbsp;zone&nbsp;offset&nbsp;for&nbsp;t,&nbsp;so&nbsp;we&nbsp;can&nbsp;adjust&nbsp;to&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2742157">//&nbsp;The&nbsp;lookup&nbsp;function&nbsp;expects&nbsp;UTC,&nbsp;so&nbsp;we&nbsp;pass&nbsp;t&nbsp;in&nbsp;the</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2742214">//&nbsp;hope&nbsp;that&nbsp;it&nbsp;will&nbsp;not&nbsp;be&nbsp;too&nbsp;close&nbsp;to&nbsp;a&nbsp;zone&nbsp;transition,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2742275">//&nbsp;and&nbsp;then&nbsp;adjust&nbsp;if&nbsp;it&nbsp;is.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2742305">_</span><span class="op" id="2742306">,</span>&nbsp;<span class="ident" id="2742308">offset</span><span class="op" id="2742314">,</span>&nbsp;<span class="ident" id="2742316">_</span><span class="op" id="2742317">,</span>&nbsp;<span class="ident" id="2742319">start</span><span class="op" id="2742324">,</span>&nbsp;<span class="ident" id="2742326">end</span>&nbsp;<span class="op" id="2742330">:=</span>&nbsp;<span class="ident" id="2742333">loc</span><span class="op" id="2742336">.</span><span class="ident" id="2742337">lookup</span><span class="op" id="2742343">(</span><span class="ident" id="2742344">unix</span><span class="op" id="2742348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2742351">if</span>&nbsp;<span class="ident" id="2742354">offset</span>&nbsp;<span class="op" id="2742361">!=</span>&nbsp;<span class="num" id="2742364">0</span>&nbsp;<span class="op" id="2742366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2742370">switch</span>&nbsp;<span class="ident" id="2742377">utc</span>&nbsp;<span class="op" id="2742381">:=</span>&nbsp;<span class="ident" id="2742384">unix</span>&nbsp;<span class="op" id="2742389">-</span>&nbsp;<span class="ident" id="2742391">int64</span><span class="op" id="2742396">(</span><span class="ident" id="2742397">offset</span><span class="op" id="2742403">)</span><span class="op" id="2742404">;</span>&nbsp;<span class="op" id="2742406">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2742410">case</span>&nbsp;<span class="ident" id="2742415">utc</span>&nbsp;<span class="op" id="2742419">&lt;</span>&nbsp;<span class="ident" id="2742421">start</span><span class="op" id="2742426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2742431">_</span><span class="op" id="2742432">,</span>&nbsp;<span class="ident" id="2742434">offset</span><span class="op" id="2742440">,</span>&nbsp;<span class="ident" id="2742442">_</span><span class="op" id="2742443">,</span>&nbsp;<span class="ident" id="2742445">_</span><span class="op" id="2742446">,</span>&nbsp;<span class="ident" id="2742448">_</span>&nbsp;<span class="op" id="2742450">=</span>&nbsp;<span class="ident" id="2742452">loc</span><span class="op" id="2742455">.</span><span class="ident" id="2742456">lookup</span><span class="op" id="2742462">(</span><span class="ident" id="2742463">start</span>&nbsp;<span class="op" id="2742469">-</span>&nbsp;<span class="num" id="2742471">1</span><span class="op" id="2742472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2742476">case</span>&nbsp;<span class="ident" id="2742481">utc</span>&nbsp;<span class="op" id="2742485">&gt;=</span>&nbsp;<span class="ident" id="2742488">end</span><span class="op" id="2742491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2742496">_</span><span class="op" id="2742497">,</span>&nbsp;<span class="ident" id="2742499">offset</span><span class="op" id="2742505">,</span>&nbsp;<span class="ident" id="2742507">_</span><span class="op" id="2742508">,</span>&nbsp;<span class="ident" id="2742510">_</span><span class="op" id="2742511">,</span>&nbsp;<span class="ident" id="2742513">_</span>&nbsp;<span class="op" id="2742515">=</span>&nbsp;<span class="ident" id="2742517">loc</span><span class="op" id="2742520">.</span><span class="ident" id="2742521">lookup</span><span class="op" id="2742527">(</span><span class="ident" id="2742528">end</span><span class="op" id="2742531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2742535">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2742539">unix</span>&nbsp;<span class="op" id="2742544">-=</span>&nbsp;<span class="ident" id="2742547">int64</span><span class="op" id="2742552">(</span><span class="ident" id="2742553">offset</span><span class="op" id="2742559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2742562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2742566">return</span>&nbsp;<span class="ident" id="2742573">Time</span><span class="op" id="2742577">{</span><span class="ident" id="2742578">unix</span>&nbsp;<span class="op" id="2742583">+</span>&nbsp;<span class="ident" id="2742585">unixToInternal</span><span class="op" id="2742599">,</span>&nbsp;<span class="builtintype" id="2742601">int32</span><span class="op" id="2742606">(</span><span class="ident" id="2742607">nsec</span><span class="op" id="2742611">)</span><span class="op" id="2742612">,</span>&nbsp;<span class="ident" id="2742614">loc</span><span class="op" id="2742617">}</span><br>
<span class="lineno"></span><span class="op" id="2742619">}</span><br>
<span class="lineno">1090</span><br>
<span class="lineno"></span><span class="comment" id="2742622">//&nbsp;Truncate&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;t&nbsp;down&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;d&nbsp;(since&nbsp;the&nbsp;zero&nbsp;time).</span><br>
<span class="lineno"></span><span class="comment" id="2742714">//&nbsp;If&nbsp;d&nbsp;&lt;=&nbsp;0,&nbsp;Truncate&nbsp;returns&nbsp;t&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2742758">func</span>&nbsp;<span class="op" id="2742763">(</span><span class="ident" id="2742764">t</span>&nbsp;<span class="ident" id="2742766">Time</span><span class="op" id="2742770">)</span>&nbsp;<span class="ident" id="2742772">Truncate</span><span class="op" id="2742780">(</span><span class="ident" id="2742781">d</span>&nbsp;<span class="ident" id="2742783">Duration</span><span class="op" id="2742791">)</span>&nbsp;<span class="ident" id="2742793">Time</span>&nbsp;<span class="op" id="2742798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2742801">if</span>&nbsp;<span class="ident" id="2742804">d</span>&nbsp;<span class="op" id="2742806">&lt;=</span>&nbsp;<span class="num" id="2742809">0</span>&nbsp;<span class="op" id="2742811">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2742815">return</span>&nbsp;<span class="ident" id="2742822">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2742825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2742828">_</span><span class="op" id="2742829">,</span>&nbsp;<span class="ident" id="2742831">r</span>&nbsp;<span class="op" id="2742833">:=</span>&nbsp;<span class="ident" id="2742836">div</span><span class="op" id="2742839">(</span><span class="ident" id="2742840">t</span><span class="op" id="2742841">,</span>&nbsp;<span class="ident" id="2742843">d</span><span class="op" id="2742844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2742847">return</span>&nbsp;<span class="ident" id="2742854">t</span><span class="op" id="2742855">.</span><span class="ident" id="2742856">Add</span><span class="op" id="2742859">(</span><span class="op" id="2742860">-</span><span class="ident" id="2742861">r</span><span class="op" id="2742862">)</span><br>
<span class="lineno"></span><span class="op" id="2742864">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="comment" id="2742867">//&nbsp;Round&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;t&nbsp;to&nbsp;the&nbsp;nearest&nbsp;multiple&nbsp;of&nbsp;d&nbsp;(since&nbsp;the&nbsp;zero&nbsp;time).</span><br>
<span class="lineno"></span><span class="comment" id="2742961">//&nbsp;The&nbsp;rounding&nbsp;behavior&nbsp;for&nbsp;halfway&nbsp;values&nbsp;is&nbsp;to&nbsp;round&nbsp;up.</span><br>
<span class="lineno"></span><span class="comment" id="2743021">//&nbsp;If&nbsp;d&nbsp;&lt;=&nbsp;0,&nbsp;Round&nbsp;returns&nbsp;t&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2743062">func</span>&nbsp;<span class="op" id="2743067">(</span><span class="ident" id="2743068">t</span>&nbsp;<span class="ident" id="2743070">Time</span><span class="op" id="2743074">)</span>&nbsp;<span class="ident" id="2743076">Round</span><span class="op" id="2743081">(</span><span class="ident" id="2743082">d</span>&nbsp;<span class="ident" id="2743084">Duration</span><span class="op" id="2743092">)</span>&nbsp;<span class="ident" id="2743094">Time</span>&nbsp;<span class="op" id="2743099">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2743102">if</span>&nbsp;<span class="ident" id="2743105">d</span>&nbsp;<span class="op" id="2743107">&lt;=</span>&nbsp;<span class="num" id="2743110">0</span>&nbsp;<span class="op" id="2743112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2743116">return</span>&nbsp;<span class="ident" id="2743123">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2743126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743129">_</span><span class="op" id="2743130">,</span>&nbsp;<span class="ident" id="2743132">r</span>&nbsp;<span class="op" id="2743134">:=</span>&nbsp;<span class="ident" id="2743137">div</span><span class="op" id="2743140">(</span><span class="ident" id="2743141">t</span><span class="op" id="2743142">,</span>&nbsp;<span class="ident" id="2743144">d</span><span class="op" id="2743145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2743148">if</span>&nbsp;<span class="ident" id="2743151">r</span><span class="op" id="2743152">+</span><span class="ident" id="2743153">r</span>&nbsp;<span class="op" id="2743155">&lt;</span>&nbsp;<span class="ident" id="2743157">d</span>&nbsp;<span class="op" id="2743159">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2743163">return</span>&nbsp;<span class="ident" id="2743170">t</span><span class="op" id="2743171">.</span><span class="ident" id="2743172">Add</span><span class="op" id="2743175">(</span><span class="op" id="2743176">-</span><span class="ident" id="2743177">r</span><span class="op" id="2743178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2743181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2743184">return</span>&nbsp;<span class="ident" id="2743191">t</span><span class="op" id="2743192">.</span><span class="ident" id="2743193">Add</span><span class="op" id="2743196">(</span><span class="ident" id="2743197">d</span>&nbsp;<span class="op" id="2743199">-</span>&nbsp;<span class="ident" id="2743201">r</span><span class="op" id="2743202">)</span><br>
<span class="lineno"></span><span class="op" id="2743204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2743207">//&nbsp;div&nbsp;divides&nbsp;t&nbsp;by&nbsp;d&nbsp;and&nbsp;returns&nbsp;the&nbsp;quotient&nbsp;parity&nbsp;and&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="2743276">//&nbsp;We&nbsp;don&#39;t&nbsp;use&nbsp;the&nbsp;quotient&nbsp;parity&nbsp;anymore&nbsp;(round&nbsp;half&nbsp;up&nbsp;instead&nbsp;of&nbsp;round&nbsp;to&nbsp;even)</span><br>
<span class="lineno"></span><span class="comment" id="2743361">//&nbsp;but&nbsp;it&#39;s&nbsp;still&nbsp;here&nbsp;in&nbsp;case&nbsp;we&nbsp;change&nbsp;our&nbsp;minds.</span><br>
<span class="lineno"></span><span class="keyword" id="2743413">func</span>&nbsp;<span class="ident" id="2743418">div</span><span class="op" id="2743421">(</span><span class="ident" id="2743422">t</span>&nbsp;<span class="ident" id="2743424">Time</span><span class="op" id="2743428">,</span>&nbsp;<span class="ident" id="2743430">d</span>&nbsp;<span class="ident" id="2743432">Duration</span><span class="op" id="2743440">)</span>&nbsp;<span class="op" id="2743442">(</span><span class="ident" id="2743443">qmod2</span>&nbsp;<span class="builtintype" id="2743449">int</span><span class="op" id="2743452">,</span>&nbsp;<span class="ident" id="2743454">r</span>&nbsp;<span class="ident" id="2743456">Duration</span><span class="op" id="2743464">)</span>&nbsp;<span class="op" id="2743466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743469">neg</span>&nbsp;<span class="op" id="2743473">:=</span>&nbsp;<span class="builtintype" id="2743476">false</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743483">nsec</span>&nbsp;<span class="op" id="2743488">:=</span>&nbsp;<span class="builtintype" id="2743491">int32</span><span class="op" id="2743496">(</span><span class="ident" id="2743497">t</span><span class="op" id="2743498">.</span><span class="ident" id="2743499">nsec</span><span class="op" id="2743503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2743506">if</span>&nbsp;<span class="ident" id="2743509">t</span><span class="op" id="2743510">.</span><span class="ident" id="2743511">sec</span>&nbsp;<span class="op" id="2743515">&lt;</span>&nbsp;<span class="num" id="2743517">0</span>&nbsp;<span class="op" id="2743519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2743523">//&nbsp;Operate&nbsp;on&nbsp;absolute&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743555">neg</span>&nbsp;<span class="op" id="2743559">=</span>&nbsp;<span class="builtintype" id="2743561">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743568">t</span><span class="op" id="2743569">.</span><span class="ident" id="2743570">sec</span>&nbsp;<span class="op" id="2743574">=</span>&nbsp;<span class="op" id="2743576">-</span><span class="ident" id="2743577">t</span><span class="op" id="2743578">.</span><span class="ident" id="2743579">sec</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743585">nsec</span>&nbsp;<span class="op" id="2743590">=</span>&nbsp;<span class="op" id="2743592">-</span><span class="ident" id="2743593">nsec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2743600">if</span>&nbsp;<span class="ident" id="2743603">nsec</span>&nbsp;<span class="op" id="2743608">&lt;</span>&nbsp;<span class="num" id="2743610">0</span>&nbsp;<span class="op" id="2743612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743617">nsec</span>&nbsp;<span class="op" id="2743622">+=</span>&nbsp;<span class="num" id="2743625">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743632">t</span><span class="op" id="2743633">.</span><span class="ident" id="2743634">sec</span><span class="op" id="2743637">--</span>&nbsp;<span class="comment" id="2743640">//&nbsp;t.sec&nbsp;&gt;=&nbsp;1&nbsp;before&nbsp;the&nbsp;--&nbsp;so&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2743678">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2743681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2743685">switch</span>&nbsp;<span class="op" id="2743692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2743695">//&nbsp;Special&nbsp;case:&nbsp;2d&nbsp;divides&nbsp;1&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2743734">case</span>&nbsp;<span class="ident" id="2743739">d</span>&nbsp;<span class="op" id="2743741">&lt;</span>&nbsp;<span class="ident" id="2743743">Second</span>&nbsp;<span class="op" id="2743750">&amp;&amp;</span>&nbsp;<span class="ident" id="2743753">Second</span><span class="op" id="2743759">%</span><span class="op" id="2743760">(</span><span class="ident" id="2743761">d</span><span class="op" id="2743762">+</span><span class="ident" id="2743763">d</span><span class="op" id="2743764">)</span>&nbsp;<span class="op" id="2743766">==</span>&nbsp;<span class="num" id="2743769">0</span><span class="op" id="2743770">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743774">qmod2</span>&nbsp;<span class="op" id="2743780">=</span>&nbsp;<span class="builtintype" id="2743782">int</span><span class="op" id="2743785">(</span><span class="ident" id="2743786">nsec</span><span class="op" id="2743790">/</span><span class="builtintype" id="2743791">int32</span><span class="op" id="2743796">(</span><span class="ident" id="2743797">d</span><span class="op" id="2743798">)</span><span class="op" id="2743799">)</span>&nbsp;<span class="op" id="2743801">&amp;</span>&nbsp;<span class="num" id="2743803">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743807">r</span>&nbsp;<span class="op" id="2743809">=</span>&nbsp;<span class="ident" id="2743811">Duration</span><span class="op" id="2743819">(</span><span class="ident" id="2743820">nsec</span>&nbsp;<span class="op" id="2743825">%</span>&nbsp;<span class="builtintype" id="2743827">int32</span><span class="op" id="2743832">(</span><span class="ident" id="2743833">d</span><span class="op" id="2743834">)</span><span class="op" id="2743835">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2743839">//&nbsp;Special&nbsp;case:&nbsp;d&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;1&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2743886">case</span>&nbsp;<span class="ident" id="2743891">d</span><span class="op" id="2743892">%</span><span class="ident" id="2743893">Second</span>&nbsp;<span class="op" id="2743900">==</span>&nbsp;<span class="num" id="2743903">0</span><span class="op" id="2743904">:</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743908">d1</span>&nbsp;<span class="op" id="2743911">:=</span>&nbsp;<span class="ident" id="2743914">int64</span><span class="op" id="2743919">(</span><span class="ident" id="2743920">d</span>&nbsp;<span class="op" id="2743922">/</span>&nbsp;<span class="ident" id="2743924">Second</span><span class="op" id="2743930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743934">qmod2</span>&nbsp;<span class="op" id="2743940">=</span>&nbsp;<span class="builtintype" id="2743942">int</span><span class="op" id="2743945">(</span><span class="ident" id="2743946">t</span><span class="op" id="2743947">.</span><span class="ident" id="2743948">sec</span><span class="op" id="2743951">/</span><span class="ident" id="2743952">d1</span><span class="op" id="2743954">)</span>&nbsp;<span class="op" id="2743956">&amp;</span>&nbsp;<span class="num" id="2743958">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2743962">r</span>&nbsp;<span class="op" id="2743964">=</span>&nbsp;<span class="ident" id="2743966">Duration</span><span class="op" id="2743974">(</span><span class="ident" id="2743975">t</span><span class="op" id="2743976">.</span><span class="ident" id="2743977">sec</span><span class="op" id="2743980">%</span><span class="ident" id="2743981">d1</span><span class="op" id="2743983">)</span><span class="op" id="2743984">*</span><span class="ident" id="2743985">Second</span>&nbsp;<span class="op" id="2743992">+</span>&nbsp;<span class="ident" id="2743994">Duration</span><span class="op" id="2744002">(</span><span class="ident" id="2744003">nsec</span><span class="op" id="2744007">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2744011">//&nbsp;General&nbsp;case.</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2744029">//&nbsp;This&nbsp;could&nbsp;be&nbsp;faster&nbsp;if&nbsp;more&nbsp;cleverness&nbsp;were&nbsp;applied,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2744087">//&nbsp;but&nbsp;it&#39;s&nbsp;really&nbsp;only&nbsp;here&nbsp;to&nbsp;avoid&nbsp;special&nbsp;case&nbsp;restrictions&nbsp;in&nbsp;the&nbsp;API.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2744164">//&nbsp;No&nbsp;one&nbsp;will&nbsp;care&nbsp;about&nbsp;these&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2744204">default</span><span class="op" id="2744211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2744215">//&nbsp;Compute&nbsp;nanoseconds&nbsp;as&nbsp;128-bit&nbsp;number.</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744259">sec</span>&nbsp;<span class="op" id="2744263">:=</span>&nbsp;<span class="ident" id="2744266">uint64</span><span class="op" id="2744272">(</span><span class="ident" id="2744273">t</span><span class="op" id="2744274">.</span><span class="ident" id="2744275">sec</span><span class="op" id="2744278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744282">tmp</span>&nbsp;<span class="op" id="2744286">:=</span>&nbsp;<span class="op" id="2744289">(</span><span class="ident" id="2744290">sec</span>&nbsp;<span class="op" id="2744294">&gt;&gt;</span>&nbsp;<span class="num" id="2744297">32</span><span class="op" id="2744299">)</span>&nbsp;<span class="op" id="2744301">*</span>&nbsp;<span class="num" id="2744303">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744309">u1</span>&nbsp;<span class="op" id="2744312">:=</span>&nbsp;<span class="ident" id="2744315">tmp</span>&nbsp;<span class="op" id="2744319">&gt;&gt;</span>&nbsp;<span class="num" id="2744322">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744327">u0</span>&nbsp;<span class="op" id="2744330">:=</span>&nbsp;<span class="ident" id="2744333">tmp</span>&nbsp;<span class="op" id="2744337">&lt;&lt;</span>&nbsp;<span class="num" id="2744340">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744345">tmp</span>&nbsp;<span class="op" id="2744349">=</span>&nbsp;<span class="ident" id="2744351">uint64</span><span class="op" id="2744357">(</span><span class="ident" id="2744358">sec</span><span class="op" id="2744361">&amp;</span><span class="num" id="2744362">0xFFFFFFFF</span><span class="op" id="2744372">)</span>&nbsp;<span class="op" id="2744374">*</span>&nbsp;<span class="num" id="2744376">1e9</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744382">u0x</span><span class="op" id="2744385">,</span>&nbsp;<span class="ident" id="2744387">u0</span>&nbsp;<span class="op" id="2744390">:=</span>&nbsp;<span class="ident" id="2744393">u0</span><span class="op" id="2744395">,</span>&nbsp;<span class="ident" id="2744397">u0</span><span class="op" id="2744399">+</span><span class="ident" id="2744400">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2744406">if</span>&nbsp;<span class="ident" id="2744409">u0</span>&nbsp;<span class="op" id="2744412">&lt;</span>&nbsp;<span class="ident" id="2744414">u0x</span>&nbsp;<span class="op" id="2744418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744423">u1</span><span class="op" id="2744425">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2744430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744434">u0x</span><span class="op" id="2744437">,</span>&nbsp;<span class="ident" id="2744439">u0</span>&nbsp;<span class="op" id="2744442">=</span>&nbsp;<span class="ident" id="2744444">u0</span><span class="op" id="2744446">,</span>&nbsp;<span class="ident" id="2744448">u0</span><span class="op" id="2744450">+</span><span class="ident" id="2744451">uint64</span><span class="op" id="2744457">(</span><span class="ident" id="2744458">nsec</span><span class="op" id="2744462">)</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2744466">if</span>&nbsp;<span class="ident" id="2744469">u0</span>&nbsp;<span class="op" id="2744472">&lt;</span>&nbsp;<span class="ident" id="2744474">u0x</span>&nbsp;<span class="op" id="2744478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744483">u1</span><span class="op" id="2744485">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2744490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2744495">//&nbsp;Compute&nbsp;remainder&nbsp;by&nbsp;subtracting&nbsp;r&lt;&lt;k&nbsp;for&nbsp;decreasing&nbsp;k.</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2744556">//&nbsp;Quotient&nbsp;parity&nbsp;is&nbsp;whether&nbsp;we&nbsp;subtract&nbsp;on&nbsp;last&nbsp;round.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744615">d1</span>&nbsp;<span class="op" id="2744618">:=</span>&nbsp;<span class="ident" id="2744621">uint64</span><span class="op" id="2744627">(</span><span class="ident" id="2744628">d</span><span class="op" id="2744629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2744633">for</span>&nbsp;<span class="ident" id="2744637">d1</span><span class="op" id="2744639">&gt;&gt;</span><span class="num" id="2744641">63</span>&nbsp;<span class="op" id="2744644">!=</span>&nbsp;<span class="num" id="2744647">1</span>&nbsp;<span class="op" id="2744649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744654">d1</span>&nbsp;<span class="op" id="2744657">&lt;&lt;=</span>&nbsp;<span class="num" id="2744661">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2744665">}</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744669">d0</span>&nbsp;<span class="op" id="2744672">:=</span>&nbsp;<span class="ident" id="2744675">uint64</span><span class="op" id="2744681">(</span><span class="num" id="2744682">0</span><span class="op" id="2744683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2744687">for</span>&nbsp;<span class="op" id="2744691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744696">qmod2</span>&nbsp;<span class="op" id="2744702">=</span>&nbsp;<span class="num" id="2744704">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2744709">if</span>&nbsp;<span class="ident" id="2744712">u1</span>&nbsp;<span class="op" id="2744715">&gt;</span>&nbsp;<span class="ident" id="2744717">d1</span>&nbsp;<span class="op" id="2744720">||</span>&nbsp;<span class="ident" id="2744723">u1</span>&nbsp;<span class="op" id="2744726">==</span>&nbsp;<span class="ident" id="2744729">d1</span>&nbsp;<span class="op" id="2744732">&amp;&amp;</span>&nbsp;<span class="ident" id="2744735">u0</span>&nbsp;<span class="op" id="2744738">&gt;=</span>&nbsp;<span class="ident" id="2744741">d0</span>&nbsp;<span class="op" id="2744744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2744750">//&nbsp;subtract</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744766">qmod2</span>&nbsp;<span class="op" id="2744772">=</span>&nbsp;<span class="num" id="2744774">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744780">u0x</span><span class="op" id="2744783">,</span>&nbsp;<span class="ident" id="2744785">u0</span>&nbsp;<span class="op" id="2744788">=</span>&nbsp;<span class="ident" id="2744790">u0</span><span class="op" id="2744792">,</span>&nbsp;<span class="ident" id="2744794">u0</span><span class="op" id="2744796">-</span><span class="ident" id="2744797">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2744804">if</span>&nbsp;<span class="ident" id="2744807">u0</span>&nbsp;<span class="op" id="2744810">&gt;</span>&nbsp;<span class="ident" id="2744812">u0x</span>&nbsp;<span class="op" id="2744816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744823">u1</span><span class="op" id="2744825">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2744832">}</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744838">u1</span>&nbsp;<span class="op" id="2744841">-=</span>&nbsp;<span class="ident" id="2744844">d1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2744850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2744855">if</span>&nbsp;<span class="ident" id="2744858">d1</span>&nbsp;<span class="op" id="2744861">==</span>&nbsp;<span class="num" id="2744864">0</span>&nbsp;<span class="op" id="2744866">&amp;&amp;</span>&nbsp;<span class="ident" id="2744869">d0</span>&nbsp;<span class="op" id="2744872">==</span>&nbsp;<span class="ident" id="2744875">uint64</span><span class="op" id="2744881">(</span><span class="ident" id="2744882">d</span><span class="op" id="2744883">)</span>&nbsp;<span class="op" id="2744885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2744891">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2744900">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744905">d0</span>&nbsp;<span class="op" id="2744908">&gt;&gt;=</span>&nbsp;<span class="num" id="2744912">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744917">d0</span>&nbsp;<span class="op" id="2744920">|=</span>&nbsp;<span class="op" id="2744923">(</span><span class="ident" id="2744924">d1</span>&nbsp;<span class="op" id="2744927">&amp;</span>&nbsp;<span class="num" id="2744929">1</span><span class="op" id="2744930">)</span>&nbsp;<span class="op" id="2744932">&lt;&lt;</span>&nbsp;<span class="num" id="2744935">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744941">d1</span>&nbsp;<span class="op" id="2744944">&gt;&gt;=</span>&nbsp;<span class="num" id="2744948">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2744952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2744956">r</span>&nbsp;<span class="op" id="2744958">=</span>&nbsp;<span class="ident" id="2744960">Duration</span><span class="op" id="2744968">(</span><span class="ident" id="2744969">u0</span><span class="op" id="2744971">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2744974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2744978">if</span>&nbsp;<span class="ident" id="2744981">neg</span>&nbsp;<span class="op" id="2744985">&amp;&amp;</span>&nbsp;<span class="ident" id="2744988">r</span>&nbsp;<span class="op" id="2744990">!=</span>&nbsp;<span class="num" id="2744993">0</span>&nbsp;<span class="op" id="2744995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2744999">//&nbsp;If&nbsp;input&nbsp;was&nbsp;negative&nbsp;and&nbsp;not&nbsp;an&nbsp;exact&nbsp;multiple&nbsp;of&nbsp;d,&nbsp;we&nbsp;computed&nbsp;q,&nbsp;r&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2745085">//&nbsp;&nbsp;&nbsp;&nbsp;q*d&nbsp;+&nbsp;r&nbsp;=&nbsp;-t</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2745103">//&nbsp;But&nbsp;the&nbsp;right&nbsp;answers&nbsp;are&nbsp;given&nbsp;by&nbsp;-(q-1),&nbsp;d-r:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2745156">//&nbsp;&nbsp;&nbsp;&nbsp;q*d&nbsp;+&nbsp;r&nbsp;=&nbsp;-t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2745174">//&nbsp;&nbsp;&nbsp;&nbsp;-q*d&nbsp;-&nbsp;r&nbsp;=&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2745192">//&nbsp;&nbsp;&nbsp;&nbsp;-(q-1)*d&nbsp;+&nbsp;(d&nbsp;-&nbsp;r)&nbsp;=&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2745220">qmod2</span>&nbsp;<span class="op" id="2745226">^=</span>&nbsp;<span class="num" id="2745229">1</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2745233">r</span>&nbsp;<span class="op" id="2745235">=</span>&nbsp;<span class="ident" id="2745237">d</span>&nbsp;<span class="op" id="2745239">-</span>&nbsp;<span class="ident" id="2745241">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2745244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2745247">return</span><br>
<span class="lineno"></span><span class="op" id="2745254">}</span>
</div>
</body>
</html>
