<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/url</h2>
<ul>
<li><a href="/gostd/net/url/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/url/url.go.html">url.go</a></li>
<li><a href="/gostd/net/url/url_test.go.html" class="current">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6943157">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6943212">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6943266">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6943317">package</span>&nbsp;<span class="ident" id="6943325">url</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6943330">import</span>&nbsp;<span class="op" id="6943337">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6943340">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6943347">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6943358">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6943369">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6943379">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6943382">type</span>&nbsp;<span class="ident" id="6943387">URLTest</span>&nbsp;<span class="keyword" id="6943395">struct</span>&nbsp;<span class="op" id="6943402">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6943405">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6943415">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6943423">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6943433">*</span><span class="ident" id="6943434">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6943439">roundtrip</span>&nbsp;<span class="builtintype" id="6943449">string</span>&nbsp;<span class="comment" id="6943456">//&nbsp;expected&nbsp;result&nbsp;of&nbsp;reserializing&nbsp;the&nbsp;URL;&nbsp;empty&nbsp;means&nbsp;same&nbsp;as&nbsp;&#34;in&#34;.</span><br>
<span class="lineno"></span><span class="op" id="6943527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="6943530">var</span>&nbsp;<span class="ident" id="6943534">urltests</span>&nbsp;<span class="op" id="6943543">=</span>&nbsp;<span class="op" id="6943545">[</span><span class="op" id="6943546">]</span><span class="ident" id="6943547">URLTest</span><span class="op" id="6943554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6943557">//&nbsp;no&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6943569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6943573">&#34;http://www.google.com&#34;</span><span class="op" id="6943596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6943600">&amp;</span><span class="ident" id="6943601">URL</span><span class="op" id="6943604">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6943609">Scheme</span><span class="op" id="6943615">:</span>&nbsp;<span class="string" id="6943617">&#34;http&#34;</span><span class="op" id="6943623">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6943628">Host</span><span class="op" id="6943632">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6943636">&#34;www.google.com&#34;</span><span class="op" id="6943652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6943656">}</span><span class="op" id="6943657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6943661">&#34;&#34;</span><span class="op" id="6943663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6943666">}</span><span class="op" id="6943667">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6943670">//&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6943679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6943683">&#34;http://www.google.com/&#34;</span><span class="op" id="6943707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6943711">&amp;</span><span class="ident" id="6943712">URL</span><span class="op" id="6943715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6943720">Scheme</span><span class="op" id="6943726">:</span>&nbsp;<span class="string" id="6943728">&#34;http&#34;</span><span class="op" id="6943734">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6943739">Host</span><span class="op" id="6943743">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6943747">&#34;www.google.com&#34;</span><span class="op" id="6943763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6943768">Path</span><span class="op" id="6943772">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6943776">&#34;/&#34;</span><span class="op" id="6943779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6943783">}</span><span class="op" id="6943784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6943788">&#34;&#34;</span><span class="op" id="6943790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6943793">}</span><span class="op" id="6943794">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6943797">//&nbsp;path&nbsp;with&nbsp;hex&nbsp;escaping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6943824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6943828">&#34;http://www.google.com/file%20one%26two&#34;</span><span class="op" id="6943868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6943872">&amp;</span><span class="ident" id="6943873">URL</span><span class="op" id="6943876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6943881">Scheme</span><span class="op" id="6943887">:</span>&nbsp;<span class="string" id="6943889">&#34;http&#34;</span><span class="op" id="6943895">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6943900">Host</span><span class="op" id="6943904">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6943908">&#34;www.google.com&#34;</span><span class="op" id="6943924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6943929">Path</span><span class="op" id="6943933">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6943937">&#34;/file&nbsp;one&amp;two&#34;</span><span class="op" id="6943952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6943956">}</span><span class="op" id="6943957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6943961">&#34;http://www.google.com/file%20one&amp;two&#34;</span><span class="op" id="6943999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944002">}</span><span class="op" id="6944003">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6944006">//&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944019">&#34;ftp://webmaster@www.google.com/&#34;</span><span class="op" id="6944052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944056">&amp;</span><span class="ident" id="6944057">URL</span><span class="op" id="6944060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944065">Scheme</span><span class="op" id="6944071">:</span>&nbsp;<span class="string" id="6944073">&#34;ftp&#34;</span><span class="op" id="6944078">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944083">User</span><span class="op" id="6944087">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6944091">User</span><span class="op" id="6944095">(</span><span class="string" id="6944096">&#34;webmaster&#34;</span><span class="op" id="6944107">)</span><span class="op" id="6944108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944113">Host</span><span class="op" id="6944117">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6944121">&#34;www.google.com&#34;</span><span class="op" id="6944137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944142">Path</span><span class="op" id="6944146">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6944150">&#34;/&#34;</span><span class="op" id="6944153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944157">}</span><span class="op" id="6944158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944162">&#34;&#34;</span><span class="op" id="6944164">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944167">}</span><span class="op" id="6944168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6944171">//&nbsp;escape&nbsp;sequence&nbsp;in&nbsp;username</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944207">&#34;ftp://john%20doe@www.google.com/&#34;</span><span class="op" id="6944241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944245">&amp;</span><span class="ident" id="6944246">URL</span><span class="op" id="6944249">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944254">Scheme</span><span class="op" id="6944260">:</span>&nbsp;<span class="string" id="6944262">&#34;ftp&#34;</span><span class="op" id="6944267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944272">User</span><span class="op" id="6944276">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6944280">User</span><span class="op" id="6944284">(</span><span class="string" id="6944285">&#34;john&nbsp;doe&#34;</span><span class="op" id="6944295">)</span><span class="op" id="6944296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944301">Host</span><span class="op" id="6944305">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6944309">&#34;www.google.com&#34;</span><span class="op" id="6944325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944330">Path</span><span class="op" id="6944334">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6944338">&#34;/&#34;</span><span class="op" id="6944341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944345">}</span><span class="op" id="6944346">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944350">&#34;ftp://john%20doe@www.google.com/&#34;</span><span class="op" id="6944384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944387">}</span><span class="op" id="6944388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6944391">//&nbsp;query</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944405">&#34;http://www.google.com/?q=go+language&#34;</span><span class="op" id="6944443">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944447">&amp;</span><span class="ident" id="6944448">URL</span><span class="op" id="6944451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944456">Scheme</span><span class="op" id="6944462">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6944466">&#34;http&#34;</span><span class="op" id="6944472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944477">Host</span><span class="op" id="6944481">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944487">&#34;www.google.com&#34;</span><span class="op" id="6944503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944508">Path</span><span class="op" id="6944512">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944518">&#34;/&#34;</span><span class="op" id="6944521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944526">RawQuery</span><span class="op" id="6944534">:</span>&nbsp;<span class="string" id="6944536">&#34;q=go+language&#34;</span><span class="op" id="6944551">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944555">}</span><span class="op" id="6944556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944560">&#34;&#34;</span><span class="op" id="6944562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944565">}</span><span class="op" id="6944566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6944569">//&nbsp;query&nbsp;with&nbsp;hex&nbsp;escaping:&nbsp;NOT&nbsp;parsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944609">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944613">&#34;http://www.google.com/?q=go%20language&#34;</span><span class="op" id="6944653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944657">&amp;</span><span class="ident" id="6944658">URL</span><span class="op" id="6944661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944666">Scheme</span><span class="op" id="6944672">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6944676">&#34;http&#34;</span><span class="op" id="6944682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944687">Host</span><span class="op" id="6944691">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944697">&#34;www.google.com&#34;</span><span class="op" id="6944713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944718">Path</span><span class="op" id="6944722">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944728">&#34;/&#34;</span><span class="op" id="6944731">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944736">RawQuery</span><span class="op" id="6944744">:</span>&nbsp;<span class="string" id="6944746">&#34;q=go%20language&#34;</span><span class="op" id="6944763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944767">}</span><span class="op" id="6944768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944772">&#34;&#34;</span><span class="op" id="6944774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944777">}</span><span class="op" id="6944778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6944781">//&nbsp;%20&nbsp;outside&nbsp;query</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944807">&#34;http://www.google.com/a%20b?q=c+d&#34;</span><span class="op" id="6944842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944846">&amp;</span><span class="ident" id="6944847">URL</span><span class="op" id="6944850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944855">Scheme</span><span class="op" id="6944861">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6944865">&#34;http&#34;</span><span class="op" id="6944871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944876">Host</span><span class="op" id="6944880">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944886">&#34;www.google.com&#34;</span><span class="op" id="6944902">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944907">Path</span><span class="op" id="6944911">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944917">&#34;/a&nbsp;b&#34;</span><span class="op" id="6944923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6944928">RawQuery</span><span class="op" id="6944936">:</span>&nbsp;<span class="string" id="6944938">&#34;q=c+d&#34;</span><span class="op" id="6944945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944949">}</span><span class="op" id="6944950">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6944954">&#34;&#34;</span><span class="op" id="6944956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6944959">}</span><span class="op" id="6944960">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6944963">//&nbsp;path&nbsp;without&nbsp;leading&nbsp;/,&nbsp;so&nbsp;no&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6945009">&#34;http:www.google.com/?q=go+language&#34;</span><span class="op" id="6945045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945049">&amp;</span><span class="ident" id="6945050">URL</span><span class="op" id="6945053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6945058">Scheme</span><span class="op" id="6945064">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6945068">&#34;http&#34;</span><span class="op" id="6945074">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6945079">Opaque</span><span class="op" id="6945085">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6945089">&#34;www.google.com/&#34;</span><span class="op" id="6945106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6945111">RawQuery</span><span class="op" id="6945119">:</span>&nbsp;<span class="string" id="6945121">&#34;q=go+language&#34;</span><span class="op" id="6945136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945140">}</span><span class="op" id="6945141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6945145">&#34;http:www.google.com/?q=go+language&#34;</span><span class="op" id="6945181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945184">}</span><span class="op" id="6945185">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6945188">//&nbsp;path&nbsp;without&nbsp;leading&nbsp;/,&nbsp;so&nbsp;no&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6945234">&#34;http:%2f%2fwww.google.com/?q=go+language&#34;</span><span class="op" id="6945276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945280">&amp;</span><span class="ident" id="6945281">URL</span><span class="op" id="6945284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6945289">Scheme</span><span class="op" id="6945295">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6945299">&#34;http&#34;</span><span class="op" id="6945305">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6945310">Opaque</span><span class="op" id="6945316">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6945320">&#34;%2f%2fwww.google.com/&#34;</span><span class="op" id="6945343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6945348">RawQuery</span><span class="op" id="6945356">:</span>&nbsp;<span class="string" id="6945358">&#34;q=go+language&#34;</span><span class="op" id="6945373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945377">}</span><span class="op" id="6945378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6945382">&#34;http:%2f%2fwww.google.com/?q=go+language&#34;</span><span class="op" id="6945424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945427">}</span><span class="op" id="6945428">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6945431">//&nbsp;non-authority&nbsp;with&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6945463">&#34;mailto:/webmaster@golang.org&#34;</span><span class="op" id="6945493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945497">&amp;</span><span class="ident" id="6945498">URL</span><span class="op" id="6945501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6945506">Scheme</span><span class="op" id="6945512">:</span>&nbsp;<span class="string" id="6945514">&#34;mailto&#34;</span><span class="op" id="6945522">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6945527">Path</span><span class="op" id="6945531">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6945535">&#34;/webmaster@golang.org&#34;</span><span class="op" id="6945558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945562">}</span><span class="op" id="6945563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6945567">&#34;mailto:///webmaster@golang.org&#34;</span><span class="op" id="6945599">,</span>&nbsp;<span class="comment" id="6945601">//&nbsp;unfortunate&nbsp;compromise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945628">}</span><span class="op" id="6945629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6945632">//&nbsp;non-authority</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6945654">&#34;mailto:webmaster@golang.org&#34;</span><span class="op" id="6945683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945687">&amp;</span><span class="ident" id="6945688">URL</span><span class="op" id="6945691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6945696">Scheme</span><span class="op" id="6945702">:</span>&nbsp;<span class="string" id="6945704">&#34;mailto&#34;</span><span class="op" id="6945712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6945717">Opaque</span><span class="op" id="6945723">:</span>&nbsp;<span class="string" id="6945725">&#34;webmaster@golang.org&#34;</span><span class="op" id="6945747">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945751">}</span><span class="op" id="6945752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6945756">&#34;&#34;</span><span class="op" id="6945758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945761">}</span><span class="op" id="6945762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6945765">//&nbsp;unescaped&nbsp;://&nbsp;in&nbsp;query&nbsp;should&nbsp;not&nbsp;create&nbsp;a&nbsp;scheme</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945819">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6945823">&#34;/foo?query=http://bad&#34;</span><span class="op" id="6945846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945850">&amp;</span><span class="ident" id="6945851">URL</span><span class="op" id="6945854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6945859">Path</span><span class="op" id="6945863">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6945869">&#34;/foo&#34;</span><span class="op" id="6945875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6945880">RawQuery</span><span class="op" id="6945888">:</span>&nbsp;<span class="string" id="6945890">&#34;query=http://bad&#34;</span><span class="op" id="6945908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945912">}</span><span class="op" id="6945913">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6945917">&#34;&#34;</span><span class="op" id="6945919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945922">}</span><span class="op" id="6945923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6945926">//&nbsp;leading&nbsp;//&nbsp;without&nbsp;scheme&nbsp;should&nbsp;create&nbsp;an&nbsp;authority</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6945987">&#34;//foo&#34;</span><span class="op" id="6945994">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6945998">&amp;</span><span class="ident" id="6945999">URL</span><span class="op" id="6946002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946007">Host</span><span class="op" id="6946011">:</span>&nbsp;<span class="string" id="6946013">&#34;foo&#34;</span><span class="op" id="6946018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946022">}</span><span class="op" id="6946023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6946027">&#34;&#34;</span><span class="op" id="6946029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946032">}</span><span class="op" id="6946033">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6946036">//&nbsp;leading&nbsp;//&nbsp;without&nbsp;scheme,&nbsp;with&nbsp;userinfo,&nbsp;path,&nbsp;and&nbsp;query</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6946102">&#34;//user@foo/path?a=b&#34;</span><span class="op" id="6946123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946127">&amp;</span><span class="ident" id="6946128">URL</span><span class="op" id="6946131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946136">User</span><span class="op" id="6946140">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946146">User</span><span class="op" id="6946150">(</span><span class="string" id="6946151">&#34;user&#34;</span><span class="op" id="6946157">)</span><span class="op" id="6946158">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946163">Host</span><span class="op" id="6946167">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6946173">&#34;foo&#34;</span><span class="op" id="6946178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946183">Path</span><span class="op" id="6946187">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6946193">&#34;/path&#34;</span><span class="op" id="6946200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946205">RawQuery</span><span class="op" id="6946213">:</span>&nbsp;<span class="string" id="6946215">&#34;a=b&#34;</span><span class="op" id="6946220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946224">}</span><span class="op" id="6946225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6946229">&#34;&#34;</span><span class="op" id="6946231">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946234">}</span><span class="op" id="6946235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6946238">//&nbsp;Three&nbsp;leading&nbsp;slashes&nbsp;isn&#39;t&nbsp;an&nbsp;authority,&nbsp;but&nbsp;doesn&#39;t&nbsp;return&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6946313">//&nbsp;(We&nbsp;can&#39;t&nbsp;return&nbsp;an&nbsp;error,&nbsp;as&nbsp;this&nbsp;code&nbsp;is&nbsp;also&nbsp;used&nbsp;via</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6946374">//&nbsp;ServeHTTP&nbsp;-&gt;&nbsp;ReadRequest&nbsp;-&gt;&nbsp;Parse,&nbsp;which&nbsp;is&nbsp;arguably&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6946433">//&nbsp;different&nbsp;URL&nbsp;parsing&nbsp;context,&nbsp;but&nbsp;currently&nbsp;shares&nbsp;the</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6946493">//&nbsp;same&nbsp;codepath)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6946516">&#34;///threeslashes&#34;</span><span class="op" id="6946533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946537">&amp;</span><span class="ident" id="6946538">URL</span><span class="op" id="6946541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946546">Path</span><span class="op" id="6946550">:</span>&nbsp;<span class="string" id="6946552">&#34;///threeslashes&#34;</span><span class="op" id="6946569">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946573">}</span><span class="op" id="6946574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6946578">&#34;&#34;</span><span class="op" id="6946580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946583">}</span><span class="op" id="6946584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6946591">&#34;http://user:password@google.com&#34;</span><span class="op" id="6946624">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946628">&amp;</span><span class="ident" id="6946629">URL</span><span class="op" id="6946632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946637">Scheme</span><span class="op" id="6946643">:</span>&nbsp;<span class="string" id="6946645">&#34;http&#34;</span><span class="op" id="6946651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946656">User</span><span class="op" id="6946660">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6946664">UserPassword</span><span class="op" id="6946676">(</span><span class="string" id="6946677">&#34;user&#34;</span><span class="op" id="6946683">,</span>&nbsp;<span class="string" id="6946685">&#34;password&#34;</span><span class="op" id="6946695">)</span><span class="op" id="6946696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946701">Host</span><span class="op" id="6946705">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6946709">&#34;google.com&#34;</span><span class="op" id="6946721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946725">}</span><span class="op" id="6946726">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6946730">&#34;http://user:password@google.com&#34;</span><span class="op" id="6946763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946766">}</span><span class="op" id="6946767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6946770">//&nbsp;unescaped&nbsp;@&nbsp;in&nbsp;username&nbsp;should&nbsp;not&nbsp;confuse&nbsp;host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6946826">&#34;http://j@ne:password@google.com&#34;</span><span class="op" id="6946859">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946863">&amp;</span><span class="ident" id="6946864">URL</span><span class="op" id="6946867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946872">Scheme</span><span class="op" id="6946878">:</span>&nbsp;<span class="string" id="6946880">&#34;http&#34;</span><span class="op" id="6946886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946891">User</span><span class="op" id="6946895">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6946899">UserPassword</span><span class="op" id="6946911">(</span><span class="string" id="6946912">&#34;j@ne&#34;</span><span class="op" id="6946918">,</span>&nbsp;<span class="string" id="6946920">&#34;password&#34;</span><span class="op" id="6946930">)</span><span class="op" id="6946931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6946936">Host</span><span class="op" id="6946940">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6946944">&#34;google.com&#34;</span><span class="op" id="6946956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6946960">}</span><span class="op" id="6946961">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6946965">&#34;http://j%40ne:password@google.com&#34;</span><span class="op" id="6947000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947003">}</span><span class="op" id="6947004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6947007">//&nbsp;unescaped&nbsp;@&nbsp;in&nbsp;password&nbsp;should&nbsp;not&nbsp;confuse&nbsp;host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947063">&#34;http://jane:p@ssword@google.com&#34;</span><span class="op" id="6947096">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947100">&amp;</span><span class="ident" id="6947101">URL</span><span class="op" id="6947104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947109">Scheme</span><span class="op" id="6947115">:</span>&nbsp;<span class="string" id="6947117">&#34;http&#34;</span><span class="op" id="6947123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947128">User</span><span class="op" id="6947132">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6947136">UserPassword</span><span class="op" id="6947148">(</span><span class="string" id="6947149">&#34;jane&#34;</span><span class="op" id="6947155">,</span>&nbsp;<span class="string" id="6947157">&#34;p@ssword&#34;</span><span class="op" id="6947167">)</span><span class="op" id="6947168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947173">Host</span><span class="op" id="6947177">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6947181">&#34;google.com&#34;</span><span class="op" id="6947193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947197">}</span><span class="op" id="6947198">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947202">&#34;http://jane:p%40ssword@google.com&#34;</span><span class="op" id="6947237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947240">}</span><span class="op" id="6947241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947248">&#34;http://j@ne:password@google.com/p@th?q=@go&#34;</span><span class="op" id="6947292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947296">&amp;</span><span class="ident" id="6947297">URL</span><span class="op" id="6947300">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947305">Scheme</span><span class="op" id="6947311">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6947315">&#34;http&#34;</span><span class="op" id="6947321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947326">User</span><span class="op" id="6947330">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947336">UserPassword</span><span class="op" id="6947348">(</span><span class="string" id="6947349">&#34;j@ne&#34;</span><span class="op" id="6947355">,</span>&nbsp;<span class="string" id="6947357">&#34;password&#34;</span><span class="op" id="6947367">)</span><span class="op" id="6947368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947373">Host</span><span class="op" id="6947377">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947383">&#34;google.com&#34;</span><span class="op" id="6947395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947400">Path</span><span class="op" id="6947404">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947410">&#34;/p@th&#34;</span><span class="op" id="6947417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947422">RawQuery</span><span class="op" id="6947430">:</span>&nbsp;<span class="string" id="6947432">&#34;q=@go&#34;</span><span class="op" id="6947439">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947443">}</span><span class="op" id="6947444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947448">&#34;http://j%40ne:password@google.com/p@th?q=@go&#34;</span><span class="op" id="6947494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947497">}</span><span class="op" id="6947498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947505">&#34;http://www.google.com/?q=go+language#foo&#34;</span><span class="op" id="6947547">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947551">&amp;</span><span class="ident" id="6947552">URL</span><span class="op" id="6947555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947560">Scheme</span><span class="op" id="6947566">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6947570">&#34;http&#34;</span><span class="op" id="6947576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947581">Host</span><span class="op" id="6947585">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947591">&#34;www.google.com&#34;</span><span class="op" id="6947607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947612">Path</span><span class="op" id="6947616">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947622">&#34;/&#34;</span><span class="op" id="6947625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947630">RawQuery</span><span class="op" id="6947638">:</span>&nbsp;<span class="string" id="6947640">&#34;q=go+language&#34;</span><span class="op" id="6947655">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947660">Fragment</span><span class="op" id="6947668">:</span>&nbsp;<span class="string" id="6947670">&#34;foo&#34;</span><span class="op" id="6947675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947679">}</span><span class="op" id="6947680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947684">&#34;&#34;</span><span class="op" id="6947686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947689">}</span><span class="op" id="6947690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947693">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947697">&#34;http://www.google.com/?q=go+language#foo%26bar&#34;</span><span class="op" id="6947745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947749">&amp;</span><span class="ident" id="6947750">URL</span><span class="op" id="6947753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947758">Scheme</span><span class="op" id="6947764">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6947768">&#34;http&#34;</span><span class="op" id="6947774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947779">Host</span><span class="op" id="6947783">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947789">&#34;www.google.com&#34;</span><span class="op" id="6947805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947810">Path</span><span class="op" id="6947814">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947820">&#34;/&#34;</span><span class="op" id="6947823">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947828">RawQuery</span><span class="op" id="6947836">:</span>&nbsp;<span class="string" id="6947838">&#34;q=go+language&#34;</span><span class="op" id="6947853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947858">Fragment</span><span class="op" id="6947866">:</span>&nbsp;<span class="string" id="6947868">&#34;foo&amp;bar&#34;</span><span class="op" id="6947877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947881">}</span><span class="op" id="6947882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947886">&#34;http://www.google.com/?q=go+language#foo&amp;bar&#34;</span><span class="op" id="6947932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947935">}</span><span class="op" id="6947936">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6947943">&#34;file:///home/adg/rabbits&#34;</span><span class="op" id="6947969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6947973">&amp;</span><span class="ident" id="6947974">URL</span><span class="op" id="6947977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6947982">Scheme</span><span class="op" id="6947988">:</span>&nbsp;<span class="string" id="6947990">&#34;file&#34;</span><span class="op" id="6947996">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948001">Host</span><span class="op" id="6948005">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6948009">&#34;&#34;</span><span class="op" id="6948011">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948016">Path</span><span class="op" id="6948020">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6948024">&#34;/home/adg/rabbits&#34;</span><span class="op" id="6948043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948047">}</span><span class="op" id="6948048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6948052">&#34;file:///home/adg/rabbits&#34;</span><span class="op" id="6948078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948081">}</span><span class="op" id="6948082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6948085">//&nbsp;&#34;Windows&#34;&nbsp;paths&nbsp;are&nbsp;no&nbsp;exception&nbsp;to&nbsp;the&nbsp;rule.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6948135">//&nbsp;See&nbsp;golang.org/issue/6027,&nbsp;especially&nbsp;comment&nbsp;#9.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6948193">&#34;file:///C:/FooBar/Baz.txt&#34;</span><span class="op" id="6948220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948224">&amp;</span><span class="ident" id="6948225">URL</span><span class="op" id="6948228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948233">Scheme</span><span class="op" id="6948239">:</span>&nbsp;<span class="string" id="6948241">&#34;file&#34;</span><span class="op" id="6948247">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948252">Host</span><span class="op" id="6948256">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6948260">&#34;&#34;</span><span class="op" id="6948262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948267">Path</span><span class="op" id="6948271">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6948275">&#34;/C:/FooBar/Baz.txt&#34;</span><span class="op" id="6948295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948299">}</span><span class="op" id="6948300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6948304">&#34;file:///C:/FooBar/Baz.txt&#34;</span><span class="op" id="6948331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948334">}</span><span class="op" id="6948335">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6948338">//&nbsp;case-insensitive&nbsp;scheme</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6948370">&#34;MaIlTo:webmaster@golang.org&#34;</span><span class="op" id="6948399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948403">&amp;</span><span class="ident" id="6948404">URL</span><span class="op" id="6948407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948412">Scheme</span><span class="op" id="6948418">:</span>&nbsp;<span class="string" id="6948420">&#34;mailto&#34;</span><span class="op" id="6948428">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948433">Opaque</span><span class="op" id="6948439">:</span>&nbsp;<span class="string" id="6948441">&#34;webmaster@golang.org&#34;</span><span class="op" id="6948463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948467">}</span><span class="op" id="6948468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6948472">&#34;mailto:webmaster@golang.org&#34;</span><span class="op" id="6948501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948504">}</span><span class="op" id="6948505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6948508">//&nbsp;Relative&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6948530">&#34;a/b/c&#34;</span><span class="op" id="6948537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948541">&amp;</span><span class="ident" id="6948542">URL</span><span class="op" id="6948545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948550">Path</span><span class="op" id="6948554">:</span>&nbsp;<span class="string" id="6948556">&#34;a/b/c&#34;</span><span class="op" id="6948563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948567">}</span><span class="op" id="6948568">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6948572">&#34;a/b/c&#34;</span><span class="op" id="6948579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948582">}</span><span class="op" id="6948583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6948586">//&nbsp;escaped&nbsp;&#39;?&#39;&nbsp;in&nbsp;username&nbsp;and&nbsp;password</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6948631">&#34;http://%3Fam:pa%3Fsword@google.com&#34;</span><span class="op" id="6948667">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948671">&amp;</span><span class="ident" id="6948672">URL</span><span class="op" id="6948675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948680">Scheme</span><span class="op" id="6948686">:</span>&nbsp;<span class="string" id="6948688">&#34;http&#34;</span><span class="op" id="6948694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948699">User</span><span class="op" id="6948703">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6948707">UserPassword</span><span class="op" id="6948719">(</span><span class="string" id="6948720">&#34;?am&#34;</span><span class="op" id="6948725">,</span>&nbsp;<span class="string" id="6948727">&#34;pa?sword&#34;</span><span class="op" id="6948737">)</span><span class="op" id="6948738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948743">Host</span><span class="op" id="6948747">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6948751">&#34;google.com&#34;</span><span class="op" id="6948763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948767">}</span><span class="op" id="6948768">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6948772">&#34;&#34;</span><span class="op" id="6948774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948777">}</span><span class="op" id="6948778">,</span><br>
<span class="lineno"></span><span class="op" id="6948780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6948783">//&nbsp;more&nbsp;useful&nbsp;string&nbsp;for&nbsp;debugging&nbsp;than&nbsp;fmt&#39;s&nbsp;struct&nbsp;printer</span><br>
<span class="lineno">295</span><span class="keyword" id="6948845">func</span>&nbsp;<span class="ident" id="6948850">ufmt</span><span class="op" id="6948854">(</span><span class="ident" id="6948855">u</span>&nbsp;<span class="op" id="6948857">*</span><span class="ident" id="6948858">URL</span><span class="op" id="6948861">)</span>&nbsp;<span class="builtintype" id="6948863">string</span>&nbsp;<span class="op" id="6948870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6948873">var</span>&nbsp;<span class="ident" id="6948877">user</span><span class="op" id="6948881">,</span>&nbsp;<span class="ident" id="6948883">pass</span>&nbsp;<span class="keyword" id="6948888">interface</span><span class="op" id="6948897">{</span><span class="op" id="6948898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6948901">if</span>&nbsp;<span class="ident" id="6948904">u</span><span class="op" id="6948905">.</span><span class="ident" id="6948906">User</span>&nbsp;<span class="op" id="6948911">!=</span>&nbsp;<span class="builtintype" id="6948914">nil</span>&nbsp;<span class="op" id="6948918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948922">user</span>&nbsp;<span class="op" id="6948927">=</span>&nbsp;<span class="ident" id="6948929">u</span><span class="op" id="6948930">.</span><span class="ident" id="6948931">User</span><span class="op" id="6948935">.</span><span class="ident" id="6948936">Username</span><span class="op" id="6948944">(</span><span class="op" id="6948945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6948949">if</span>&nbsp;<span class="ident" id="6948952">p</span><span class="op" id="6948953">,</span>&nbsp;<span class="ident" id="6948955">ok</span>&nbsp;<span class="op" id="6948958">:=</span>&nbsp;<span class="ident" id="6948961">u</span><span class="op" id="6948962">.</span><span class="ident" id="6948963">User</span><span class="op" id="6948967">.</span><span class="ident" id="6948968">Password</span><span class="op" id="6948976">(</span><span class="op" id="6948977">)</span><span class="op" id="6948978">;</span>&nbsp;<span class="ident" id="6948980">ok</span>&nbsp;<span class="op" id="6948983">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6948988">pass</span>&nbsp;<span class="op" id="6948993">=</span>&nbsp;<span class="ident" id="6948995">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6948999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6949002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949005">return</span>&nbsp;<span class="ident" id="6949012">fmt</span><span class="op" id="6949015">.</span><span class="ident" id="6949016">Sprintf</span><span class="op" id="6949023">(</span><span class="string" id="6949024">&#34;opaque=%q,&nbsp;scheme=%q,&nbsp;user=%#v,&nbsp;pass=%#v,&nbsp;host=%q,&nbsp;path=%q,&nbsp;rawq=%q,&nbsp;frag=%q&#34;</span><span class="op" id="6949102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949106">u</span><span class="op" id="6949107">.</span><span class="ident" id="6949108">Opaque</span><span class="op" id="6949114">,</span>&nbsp;<span class="ident" id="6949116">u</span><span class="op" id="6949117">.</span><span class="ident" id="6949118">Scheme</span><span class="op" id="6949124">,</span>&nbsp;<span class="ident" id="6949126">user</span><span class="op" id="6949130">,</span>&nbsp;<span class="ident" id="6949132">pass</span><span class="op" id="6949136">,</span>&nbsp;<span class="ident" id="6949138">u</span><span class="op" id="6949139">.</span><span class="ident" id="6949140">Host</span><span class="op" id="6949144">,</span>&nbsp;<span class="ident" id="6949146">u</span><span class="op" id="6949147">.</span><span class="ident" id="6949148">Path</span><span class="op" id="6949152">,</span>&nbsp;<span class="ident" id="6949154">u</span><span class="op" id="6949155">.</span><span class="ident" id="6949156">RawQuery</span><span class="op" id="6949164">,</span>&nbsp;<span class="ident" id="6949166">u</span><span class="op" id="6949167">.</span><span class="ident" id="6949168">Fragment</span><span class="op" id="6949176">)</span><br>
<span class="lineno">305</span><span class="op" id="6949178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6949181">func</span>&nbsp;<span class="ident" id="6949186">DoTest</span><span class="op" id="6949192">(</span><span class="ident" id="6949193">t</span>&nbsp;<span class="op" id="6949195">*</span><span class="ident" id="6949196">testing</span><span class="op" id="6949203">.</span><span class="ident" id="6949204">T</span><span class="op" id="6949205">,</span>&nbsp;<span class="ident" id="6949207">parse</span>&nbsp;<span class="keyword" id="6949213">func</span><span class="op" id="6949217">(</span><span class="builtintype" id="6949218">string</span><span class="op" id="6949224">)</span>&nbsp;<span class="op" id="6949226">(</span><span class="op" id="6949227">*</span><span class="ident" id="6949228">URL</span><span class="op" id="6949231">,</span>&nbsp;<span class="builtintype" id="6949233">error</span><span class="op" id="6949238">)</span><span class="op" id="6949239">,</span>&nbsp;<span class="ident" id="6949241">name</span>&nbsp;<span class="builtintype" id="6949246">string</span><span class="op" id="6949252">,</span>&nbsp;<span class="ident" id="6949254">tests</span>&nbsp;<span class="op" id="6949260">[</span><span class="op" id="6949261">]</span><span class="ident" id="6949262">URLTest</span><span class="op" id="6949269">)</span>&nbsp;<span class="op" id="6949271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949274">for</span>&nbsp;<span class="ident" id="6949278">_</span><span class="op" id="6949279">,</span>&nbsp;<span class="ident" id="6949281">tt</span>&nbsp;<span class="op" id="6949284">:=</span>&nbsp;<span class="keyword" id="6949287">range</span>&nbsp;<span class="ident" id="6949293">tests</span>&nbsp;<span class="op" id="6949299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949303">u</span><span class="op" id="6949304">,</span>&nbsp;<span class="ident" id="6949306">err</span>&nbsp;<span class="op" id="6949310">:=</span>&nbsp;<span class="ident" id="6949313">parse</span><span class="op" id="6949318">(</span><span class="ident" id="6949319">tt</span><span class="op" id="6949321">.</span><span class="ident" id="6949322">in</span><span class="op" id="6949324">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949328">if</span>&nbsp;<span class="ident" id="6949331">err</span>&nbsp;<span class="op" id="6949335">!=</span>&nbsp;<span class="builtintype" id="6949338">nil</span>&nbsp;<span class="op" id="6949342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949347">t</span><span class="op" id="6949348">.</span><span class="ident" id="6949349">Errorf</span><span class="op" id="6949355">(</span><span class="string" id="6949356">&#34;%s(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="6949382">,</span>&nbsp;<span class="ident" id="6949384">name</span><span class="op" id="6949388">,</span>&nbsp;<span class="ident" id="6949390">tt</span><span class="op" id="6949392">.</span><span class="ident" id="6949393">in</span><span class="op" id="6949395">,</span>&nbsp;<span class="ident" id="6949397">err</span><span class="op" id="6949400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949405">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6949416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949420">if</span>&nbsp;<span class="op" id="6949423">!</span><span class="ident" id="6949424">reflect</span><span class="op" id="6949431">.</span><span class="ident" id="6949432">DeepEqual</span><span class="op" id="6949441">(</span><span class="ident" id="6949442">u</span><span class="op" id="6949443">,</span>&nbsp;<span class="ident" id="6949445">tt</span><span class="op" id="6949447">.</span><span class="ident" id="6949448">out</span><span class="op" id="6949451">)</span>&nbsp;<span class="op" id="6949453">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949458">t</span><span class="op" id="6949459">.</span><span class="ident" id="6949460">Errorf</span><span class="op" id="6949466">(</span><span class="string" id="6949467">&#34;%s(%q):\n\thave&nbsp;%v\n\twant&nbsp;%v\n&#34;</span><span class="op" id="6949500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949506">name</span><span class="op" id="6949510">,</span>&nbsp;<span class="ident" id="6949512">tt</span><span class="op" id="6949514">.</span><span class="ident" id="6949515">in</span><span class="op" id="6949517">,</span>&nbsp;<span class="ident" id="6949519">ufmt</span><span class="op" id="6949523">(</span><span class="ident" id="6949524">u</span><span class="op" id="6949525">)</span><span class="op" id="6949526">,</span>&nbsp;<span class="ident" id="6949528">ufmt</span><span class="op" id="6949532">(</span><span class="ident" id="6949533">tt</span><span class="op" id="6949535">.</span><span class="ident" id="6949536">out</span><span class="op" id="6949539">)</span><span class="op" id="6949540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6949544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6949547">}</span><br>
<span class="lineno"></span><span class="op" id="6949549">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="keyword" id="6949552">func</span>&nbsp;<span class="ident" id="6949557">BenchmarkString</span><span class="op" id="6949572">(</span><span class="ident" id="6949573">b</span>&nbsp;<span class="op" id="6949575">*</span><span class="ident" id="6949576">testing</span><span class="op" id="6949583">.</span><span class="ident" id="6949584">B</span><span class="op" id="6949585">)</span>&nbsp;<span class="op" id="6949587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949590">b</span><span class="op" id="6949591">.</span><span class="ident" id="6949592">StopTimer</span><span class="op" id="6949601">(</span><span class="op" id="6949602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949605">b</span><span class="op" id="6949606">.</span><span class="ident" id="6949607">ReportAllocs</span><span class="op" id="6949619">(</span><span class="op" id="6949620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949623">for</span>&nbsp;<span class="ident" id="6949627">_</span><span class="op" id="6949628">,</span>&nbsp;<span class="ident" id="6949630">tt</span>&nbsp;<span class="op" id="6949633">:=</span>&nbsp;<span class="keyword" id="6949636">range</span>&nbsp;<span class="ident" id="6949642">urltests</span>&nbsp;<span class="op" id="6949651">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949655">u</span><span class="op" id="6949656">,</span>&nbsp;<span class="ident" id="6949658">err</span>&nbsp;<span class="op" id="6949662">:=</span>&nbsp;<span class="ident" id="6949665">Parse</span><span class="op" id="6949670">(</span><span class="ident" id="6949671">tt</span><span class="op" id="6949673">.</span><span class="ident" id="6949674">in</span><span class="op" id="6949676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949680">if</span>&nbsp;<span class="ident" id="6949683">err</span>&nbsp;<span class="op" id="6949687">!=</span>&nbsp;<span class="builtintype" id="6949690">nil</span>&nbsp;<span class="op" id="6949694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949699">b</span><span class="op" id="6949700">.</span><span class="ident" id="6949701">Errorf</span><span class="op" id="6949707">(</span><span class="string" id="6949708">&#34;Parse(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="6949737">,</span>&nbsp;<span class="ident" id="6949739">tt</span><span class="op" id="6949741">.</span><span class="ident" id="6949742">in</span><span class="op" id="6949744">,</span>&nbsp;<span class="ident" id="6949746">err</span><span class="op" id="6949749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949754">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6949765">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949769">if</span>&nbsp;<span class="ident" id="6949772">tt</span><span class="op" id="6949774">.</span><span class="ident" id="6949775">roundtrip</span>&nbsp;<span class="op" id="6949785">==</span>&nbsp;<span class="string" id="6949788">&#34;&#34;</span>&nbsp;<span class="op" id="6949791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949796">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6949807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949811">b</span><span class="op" id="6949812">.</span><span class="ident" id="6949813">StartTimer</span><span class="op" id="6949823">(</span><span class="op" id="6949824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949828">var</span>&nbsp;<span class="ident" id="6949832">g</span>&nbsp;<span class="builtintype" id="6949834">string</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949843">for</span>&nbsp;<span class="ident" id="6949847">i</span>&nbsp;<span class="op" id="6949849">:=</span>&nbsp;<span class="num" id="6949852">0</span><span class="op" id="6949853">;</span>&nbsp;<span class="ident" id="6949855">i</span>&nbsp;<span class="op" id="6949857">&lt;</span>&nbsp;<span class="ident" id="6949859">b</span><span class="op" id="6949860">.</span><span class="ident" id="6949861">N</span><span class="op" id="6949862">;</span>&nbsp;<span class="ident" id="6949864">i</span><span class="op" id="6949865">++</span>&nbsp;<span class="op" id="6949868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949873">g</span>&nbsp;<span class="op" id="6949875">=</span>&nbsp;<span class="ident" id="6949877">u</span><span class="op" id="6949878">.</span><span class="ident" id="6949879">String</span><span class="op" id="6949885">(</span><span class="op" id="6949886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6949890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949894">b</span><span class="op" id="6949895">.</span><span class="ident" id="6949896">StopTimer</span><span class="op" id="6949905">(</span><span class="op" id="6949906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6949910">if</span>&nbsp;<span class="ident" id="6949913">w</span>&nbsp;<span class="op" id="6949915">:=</span>&nbsp;<span class="ident" id="6949918">tt</span><span class="op" id="6949920">.</span><span class="ident" id="6949921">roundtrip</span><span class="op" id="6949930">;</span>&nbsp;<span class="ident" id="6949932">g</span>&nbsp;<span class="op" id="6949934">!=</span>&nbsp;<span class="ident" id="6949937">w</span>&nbsp;<span class="op" id="6949939">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6949944">b</span><span class="op" id="6949945">.</span><span class="ident" id="6949946">Errorf</span><span class="op" id="6949952">(</span><span class="string" id="6949953">&#34;Parse(%q).String()&nbsp;==&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6949988">,</span>&nbsp;<span class="ident" id="6949990">tt</span><span class="op" id="6949992">.</span><span class="ident" id="6949993">in</span><span class="op" id="6949995">,</span>&nbsp;<span class="ident" id="6949997">g</span><span class="op" id="6949998">,</span>&nbsp;<span class="ident" id="6950000">w</span><span class="op" id="6950001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950008">}</span><br>
<span class="lineno"></span><span class="op" id="6950010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="6950013">func</span>&nbsp;<span class="ident" id="6950018">TestParse</span><span class="op" id="6950027">(</span><span class="ident" id="6950028">t</span>&nbsp;<span class="op" id="6950030">*</span><span class="ident" id="6950031">testing</span><span class="op" id="6950038">.</span><span class="ident" id="6950039">T</span><span class="op" id="6950040">)</span>&nbsp;<span class="op" id="6950042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6950045">DoTest</span><span class="op" id="6950051">(</span><span class="ident" id="6950052">t</span><span class="op" id="6950053">,</span>&nbsp;<span class="ident" id="6950055">Parse</span><span class="op" id="6950060">,</span>&nbsp;<span class="string" id="6950062">&#34;Parse&#34;</span><span class="op" id="6950069">,</span>&nbsp;<span class="ident" id="6950071">urltests</span><span class="op" id="6950079">)</span><br>
<span class="lineno"></span><span class="op" id="6950081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6950084">const</span>&nbsp;<span class="ident" id="6950090">pathThatLooksSchemeRelative</span>&nbsp;<span class="op" id="6950118">=</span>&nbsp;<span class="string" id="6950120">&#34;//not.a.user@not.a.host/just/a/path&#34;</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span><span class="keyword" id="6950159">var</span>&nbsp;<span class="ident" id="6950163">parseRequestURLTests</span>&nbsp;<span class="op" id="6950184">=</span>&nbsp;<span class="op" id="6950186">[</span><span class="op" id="6950187">]</span><span class="keyword" id="6950188">struct</span>&nbsp;<span class="op" id="6950195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6950198">url</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6950212">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6950220">expectedValid</span>&nbsp;<span class="builtintype" id="6950234">bool</span><br>
<span class="lineno"></span><span class="op" id="6950239">}</span><span class="op" id="6950240">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950243">{</span><span class="string" id="6950244">&#34;http://foo.com&#34;</span><span class="op" id="6950260">,</span>&nbsp;<span class="builtintype" id="6950262">true</span><span class="op" id="6950266">}</span><span class="op" id="6950267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950270">{</span><span class="string" id="6950271">&#34;http://foo.com/&#34;</span><span class="op" id="6950288">,</span>&nbsp;<span class="builtintype" id="6950290">true</span><span class="op" id="6950294">}</span><span class="op" id="6950295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950298">{</span><span class="string" id="6950299">&#34;http://foo.com/path&#34;</span><span class="op" id="6950320">,</span>&nbsp;<span class="builtintype" id="6950322">true</span><span class="op" id="6950326">}</span><span class="op" id="6950327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950330">{</span><span class="string" id="6950331">&#34;/&#34;</span><span class="op" id="6950334">,</span>&nbsp;<span class="builtintype" id="6950336">true</span><span class="op" id="6950340">}</span><span class="op" id="6950341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950344">{</span><span class="ident" id="6950345">pathThatLooksSchemeRelative</span><span class="op" id="6950372">,</span>&nbsp;<span class="builtintype" id="6950374">true</span><span class="op" id="6950378">}</span><span class="op" id="6950379">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950382">{</span><span class="string" id="6950383">&#34;//not.a.user@%66%6f%6f.com/just/a/path/also&#34;</span><span class="op" id="6950428">,</span>&nbsp;<span class="builtintype" id="6950430">true</span><span class="op" id="6950434">}</span><span class="op" id="6950435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950438">{</span><span class="string" id="6950439">&#34;foo.html&#34;</span><span class="op" id="6950449">,</span>&nbsp;<span class="builtintype" id="6950451">false</span><span class="op" id="6950456">}</span><span class="op" id="6950457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950460">{</span><span class="string" id="6950461">&#34;../dir/&#34;</span><span class="op" id="6950470">,</span>&nbsp;<span class="builtintype" id="6950472">false</span><span class="op" id="6950477">}</span><span class="op" id="6950478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950481">{</span><span class="string" id="6950482">&#34;*&#34;</span><span class="op" id="6950485">,</span>&nbsp;<span class="builtintype" id="6950487">true</span><span class="op" id="6950491">}</span><span class="op" id="6950492">,</span><br>
<span class="lineno"></span><span class="op" id="6950494">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="6950497">func</span>&nbsp;<span class="ident" id="6950502">TestParseRequestURI</span><span class="op" id="6950521">(</span><span class="ident" id="6950522">t</span>&nbsp;<span class="op" id="6950524">*</span><span class="ident" id="6950525">testing</span><span class="op" id="6950532">.</span><span class="ident" id="6950533">T</span><span class="op" id="6950534">)</span>&nbsp;<span class="op" id="6950536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6950539">for</span>&nbsp;<span class="ident" id="6950543">_</span><span class="op" id="6950544">,</span>&nbsp;<span class="ident" id="6950546">test</span>&nbsp;<span class="op" id="6950551">:=</span>&nbsp;<span class="keyword" id="6950554">range</span>&nbsp;<span class="ident" id="6950560">parseRequestURLTests</span>&nbsp;<span class="op" id="6950581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6950585">_</span><span class="op" id="6950586">,</span>&nbsp;<span class="ident" id="6950588">err</span>&nbsp;<span class="op" id="6950592">:=</span>&nbsp;<span class="ident" id="6950595">ParseRequestURI</span><span class="op" id="6950610">(</span><span class="ident" id="6950611">test</span><span class="op" id="6950615">.</span><span class="ident" id="6950616">url</span><span class="op" id="6950619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6950623">valid</span>&nbsp;<span class="op" id="6950629">:=</span>&nbsp;<span class="ident" id="6950632">err</span>&nbsp;<span class="op" id="6950636">==</span>&nbsp;<span class="builtintype" id="6950639">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6950645">if</span>&nbsp;<span class="ident" id="6950648">valid</span>&nbsp;<span class="op" id="6950654">!=</span>&nbsp;<span class="ident" id="6950657">test</span><span class="op" id="6950661">.</span><span class="ident" id="6950662">expectedValid</span>&nbsp;<span class="op" id="6950676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6950681">t</span><span class="op" id="6950682">.</span><span class="ident" id="6950683">Errorf</span><span class="op" id="6950689">(</span><span class="string" id="6950690">&#34;Expected&nbsp;valid=%v&nbsp;for&nbsp;%q;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6950724">,</span>&nbsp;<span class="ident" id="6950726">test</span><span class="op" id="6950730">.</span><span class="ident" id="6950731">expectedValid</span><span class="op" id="6950744">,</span>&nbsp;<span class="ident" id="6950746">test</span><span class="op" id="6950750">.</span><span class="ident" id="6950751">url</span><span class="op" id="6950754">,</span>&nbsp;<span class="ident" id="6950756">valid</span><span class="op" id="6950761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6950772">url</span><span class="op" id="6950775">,</span>&nbsp;<span class="ident" id="6950777">err</span>&nbsp;<span class="op" id="6950781">:=</span>&nbsp;<span class="ident" id="6950784">ParseRequestURI</span><span class="op" id="6950799">(</span><span class="ident" id="6950800">pathThatLooksSchemeRelative</span><span class="op" id="6950827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6950830">if</span>&nbsp;<span class="ident" id="6950833">err</span>&nbsp;<span class="op" id="6950837">!=</span>&nbsp;<span class="builtintype" id="6950840">nil</span>&nbsp;<span class="op" id="6950844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6950848">t</span><span class="op" id="6950849">.</span><span class="ident" id="6950850">Fatalf</span><span class="op" id="6950856">(</span><span class="string" id="6950857">&#34;Unexpected&nbsp;error&nbsp;%v&#34;</span><span class="op" id="6950878">,</span>&nbsp;<span class="ident" id="6950880">err</span><span class="op" id="6950883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6950886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6950889">if</span>&nbsp;<span class="ident" id="6950892">url</span><span class="op" id="6950895">.</span><span class="ident" id="6950896">Path</span>&nbsp;<span class="op" id="6950901">!=</span>&nbsp;<span class="ident" id="6950904">pathThatLooksSchemeRelative</span>&nbsp;<span class="op" id="6950932">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6950936">t</span><span class="op" id="6950937">.</span><span class="ident" id="6950938">Errorf</span><span class="op" id="6950944">(</span><span class="string" id="6950945">&#34;Expected&nbsp;path&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6950971">,</span>&nbsp;<span class="ident" id="6950973">pathThatLooksSchemeRelative</span><span class="op" id="6951000">,</span>&nbsp;<span class="ident" id="6951002">url</span><span class="op" id="6951005">.</span><span class="ident" id="6951006">Path</span><span class="op" id="6951010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6951013">}</span><br>
<span class="lineno"></span><span class="op" id="6951015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6951018">func</span>&nbsp;<span class="ident" id="6951023">DoTestString</span><span class="op" id="6951035">(</span><span class="ident" id="6951036">t</span>&nbsp;<span class="op" id="6951038">*</span><span class="ident" id="6951039">testing</span><span class="op" id="6951046">.</span><span class="ident" id="6951047">T</span><span class="op" id="6951048">,</span>&nbsp;<span class="ident" id="6951050">parse</span>&nbsp;<span class="keyword" id="6951056">func</span><span class="op" id="6951060">(</span><span class="builtintype" id="6951061">string</span><span class="op" id="6951067">)</span>&nbsp;<span class="op" id="6951069">(</span><span class="op" id="6951070">*</span><span class="ident" id="6951071">URL</span><span class="op" id="6951074">,</span>&nbsp;<span class="builtintype" id="6951076">error</span><span class="op" id="6951081">)</span><span class="op" id="6951082">,</span>&nbsp;<span class="ident" id="6951084">name</span>&nbsp;<span class="builtintype" id="6951089">string</span><span class="op" id="6951095">,</span>&nbsp;<span class="ident" id="6951097">tests</span>&nbsp;<span class="op" id="6951103">[</span><span class="op" id="6951104">]</span><span class="ident" id="6951105">URLTest</span><span class="op" id="6951112">)</span>&nbsp;<span class="op" id="6951114">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6951117">for</span>&nbsp;<span class="ident" id="6951121">_</span><span class="op" id="6951122">,</span>&nbsp;<span class="ident" id="6951124">tt</span>&nbsp;<span class="op" id="6951127">:=</span>&nbsp;<span class="keyword" id="6951130">range</span>&nbsp;<span class="ident" id="6951136">tests</span>&nbsp;<span class="op" id="6951142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951146">u</span><span class="op" id="6951147">,</span>&nbsp;<span class="ident" id="6951149">err</span>&nbsp;<span class="op" id="6951153">:=</span>&nbsp;<span class="ident" id="6951156">parse</span><span class="op" id="6951161">(</span><span class="ident" id="6951162">tt</span><span class="op" id="6951164">.</span><span class="ident" id="6951165">in</span><span class="op" id="6951167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6951171">if</span>&nbsp;<span class="ident" id="6951174">err</span>&nbsp;<span class="op" id="6951178">!=</span>&nbsp;<span class="builtintype" id="6951181">nil</span>&nbsp;<span class="op" id="6951185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951190">t</span><span class="op" id="6951191">.</span><span class="ident" id="6951192">Errorf</span><span class="op" id="6951198">(</span><span class="string" id="6951199">&#34;%s(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="6951225">,</span>&nbsp;<span class="ident" id="6951227">name</span><span class="op" id="6951231">,</span>&nbsp;<span class="ident" id="6951233">tt</span><span class="op" id="6951235">.</span><span class="ident" id="6951236">in</span><span class="op" id="6951238">,</span>&nbsp;<span class="ident" id="6951240">err</span><span class="op" id="6951243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6951248">continue</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6951259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951263">expected</span>&nbsp;<span class="op" id="6951272">:=</span>&nbsp;<span class="ident" id="6951275">tt</span><span class="op" id="6951277">.</span><span class="ident" id="6951278">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6951283">if</span>&nbsp;<span class="builtinfunc" id="6951286">len</span><span class="op" id="6951289">(</span><span class="ident" id="6951290">tt</span><span class="op" id="6951292">.</span><span class="ident" id="6951293">roundtrip</span><span class="op" id="6951302">)</span>&nbsp;<span class="op" id="6951304">&gt;</span>&nbsp;<span class="num" id="6951306">0</span>&nbsp;<span class="op" id="6951308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951313">expected</span>&nbsp;<span class="op" id="6951322">=</span>&nbsp;<span class="ident" id="6951324">tt</span><span class="op" id="6951326">.</span><span class="ident" id="6951327">roundtrip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6951339">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951343">s</span>&nbsp;<span class="op" id="6951345">:=</span>&nbsp;<span class="ident" id="6951348">u</span><span class="op" id="6951349">.</span><span class="ident" id="6951350">String</span><span class="op" id="6951356">(</span><span class="op" id="6951357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6951361">if</span>&nbsp;<span class="ident" id="6951364">s</span>&nbsp;<span class="op" id="6951366">!=</span>&nbsp;<span class="ident" id="6951369">expected</span>&nbsp;<span class="op" id="6951378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951383">t</span><span class="op" id="6951384">.</span><span class="ident" id="6951385">Errorf</span><span class="op" id="6951391">(</span><span class="string" id="6951392">&#34;%s(%q).String()&nbsp;==&nbsp;%q&nbsp;(expected&nbsp;%q)&#34;</span><span class="op" id="6951429">,</span>&nbsp;<span class="ident" id="6951431">name</span><span class="op" id="6951435">,</span>&nbsp;<span class="ident" id="6951437">tt</span><span class="op" id="6951439">.</span><span class="ident" id="6951440">in</span><span class="op" id="6951442">,</span>&nbsp;<span class="ident" id="6951444">s</span><span class="op" id="6951445">,</span>&nbsp;<span class="ident" id="6951447">expected</span><span class="op" id="6951455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6951459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6951462">}</span><br>
<span class="lineno">400</span><span class="op" id="6951464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6951467">func</span>&nbsp;<span class="ident" id="6951472">TestURLString</span><span class="op" id="6951485">(</span><span class="ident" id="6951486">t</span>&nbsp;<span class="op" id="6951488">*</span><span class="ident" id="6951489">testing</span><span class="op" id="6951496">.</span><span class="ident" id="6951497">T</span><span class="op" id="6951498">)</span>&nbsp;<span class="op" id="6951500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951503">DoTestString</span><span class="op" id="6951515">(</span><span class="ident" id="6951516">t</span><span class="op" id="6951517">,</span>&nbsp;<span class="ident" id="6951519">Parse</span><span class="op" id="6951524">,</span>&nbsp;<span class="string" id="6951526">&#34;Parse&#34;</span><span class="op" id="6951533">,</span>&nbsp;<span class="ident" id="6951535">urltests</span><span class="op" id="6951543">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6951547">//&nbsp;no&nbsp;leading&nbsp;slash&nbsp;on&nbsp;path&nbsp;should&nbsp;prepend</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6951591">//&nbsp;slash&nbsp;on&nbsp;String()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951618">noslash</span>&nbsp;<span class="op" id="6951626">:=</span>&nbsp;<span class="ident" id="6951629">URLTest</span><span class="op" id="6951636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6951640">&#34;http://www.google.com/search&#34;</span><span class="op" id="6951670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6951674">&amp;</span><span class="ident" id="6951675">URL</span><span class="op" id="6951678">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951683">Scheme</span><span class="op" id="6951689">:</span>&nbsp;<span class="string" id="6951691">&#34;http&#34;</span><span class="op" id="6951697">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951702">Host</span><span class="op" id="6951706">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6951710">&#34;www.google.com&#34;</span><span class="op" id="6951726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951731">Path</span><span class="op" id="6951735">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6951739">&#34;search&#34;</span><span class="op" id="6951747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6951751">}</span><span class="op" id="6951752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6951756">&#34;&#34;</span><span class="op" id="6951758">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6951761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951764">s</span>&nbsp;<span class="op" id="6951766">:=</span>&nbsp;<span class="ident" id="6951769">noslash</span><span class="op" id="6951776">.</span><span class="ident" id="6951777">out</span><span class="op" id="6951780">.</span><span class="ident" id="6951781">String</span><span class="op" id="6951787">(</span><span class="op" id="6951788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6951791">if</span>&nbsp;<span class="ident" id="6951794">s</span>&nbsp;<span class="op" id="6951796">!=</span>&nbsp;<span class="ident" id="6951799">noslash</span><span class="op" id="6951806">.</span><span class="ident" id="6951807">in</span>&nbsp;<span class="op" id="6951810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951814">t</span><span class="op" id="6951815">.</span><span class="ident" id="6951816">Errorf</span><span class="op" id="6951822">(</span><span class="string" id="6951823">&#34;Expected&nbsp;%s;&nbsp;go&nbsp;%s&#34;</span><span class="op" id="6951843">,</span>&nbsp;<span class="ident" id="6951845">noslash</span><span class="op" id="6951852">.</span><span class="ident" id="6951853">in</span><span class="op" id="6951855">,</span>&nbsp;<span class="ident" id="6951857">s</span><span class="op" id="6951858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6951861">}</span><br>
<span class="lineno">420</span><span class="op" id="6951863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6951866">type</span>&nbsp;<span class="ident" id="6951871">EscapeTest</span>&nbsp;<span class="keyword" id="6951882">struct</span>&nbsp;<span class="op" id="6951889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951892">in</span>&nbsp;&nbsp;<span class="builtintype" id="6951896">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951904">out</span>&nbsp;<span class="builtintype" id="6951908">string</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6951916">err</span>&nbsp;<span class="builtintype" id="6951920">error</span><br>
<span class="lineno"></span><span class="op" id="6951926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6951929">var</span>&nbsp;<span class="ident" id="6951933">unescapeTests</span>&nbsp;<span class="op" id="6951947">=</span>&nbsp;<span class="op" id="6951949">[</span><span class="op" id="6951950">]</span><span class="ident" id="6951951">EscapeTest</span><span class="op" id="6951961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6951964">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6951968">&#34;&#34;</span><span class="op" id="6951970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6951974">&#34;&#34;</span><span class="op" id="6951976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6951980">nil</span><span class="op" id="6951983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6951986">}</span><span class="op" id="6951987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6951990">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6951994">&#34;abc&#34;</span><span class="op" id="6951999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952003">&#34;abc&#34;</span><span class="op" id="6952008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6952012">nil</span><span class="op" id="6952015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952018">}</span><span class="op" id="6952019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952022">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952026">&#34;1%41&#34;</span><span class="op" id="6952032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952036">&#34;1A&#34;</span><span class="op" id="6952040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6952044">nil</span><span class="op" id="6952047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952050">}</span><span class="op" id="6952051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952054">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952058">&#34;1%41%42%43&#34;</span><span class="op" id="6952070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952074">&#34;1ABC&#34;</span><span class="op" id="6952080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6952084">nil</span><span class="op" id="6952087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952090">}</span><span class="op" id="6952091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952094">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952098">&#34;%4a&#34;</span><span class="op" id="6952103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952107">&#34;J&#34;</span><span class="op" id="6952110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6952114">nil</span><span class="op" id="6952117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952120">}</span><span class="op" id="6952121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952124">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952128">&#34;%6F&#34;</span><span class="op" id="6952133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952137">&#34;o&#34;</span><span class="op" id="6952140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6952144">nil</span><span class="op" id="6952147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952150">}</span><span class="op" id="6952151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952154">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952158">&#34;%&#34;</span><span class="op" id="6952161">,</span>&nbsp;<span class="comment" id="6952163">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952198">&#34;&#34;</span><span class="op" id="6952200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6952204">EscapeError</span><span class="op" id="6952215">(</span><span class="string" id="6952216">&#34;%&#34;</span><span class="op" id="6952219">)</span><span class="op" id="6952220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952223">}</span><span class="op" id="6952224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952227">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952231">&#34;%a&#34;</span><span class="op" id="6952235">,</span>&nbsp;<span class="comment" id="6952237">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952272">&#34;&#34;</span><span class="op" id="6952274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6952278">EscapeError</span><span class="op" id="6952289">(</span><span class="string" id="6952290">&#34;%a&#34;</span><span class="op" id="6952294">)</span><span class="op" id="6952295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952298">}</span><span class="op" id="6952299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952302">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952306">&#34;%1&#34;</span><span class="op" id="6952310">,</span>&nbsp;<span class="comment" id="6952312">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952347">&#34;&#34;</span><span class="op" id="6952349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6952353">EscapeError</span><span class="op" id="6952364">(</span><span class="string" id="6952365">&#34;%1&#34;</span><span class="op" id="6952369">)</span><span class="op" id="6952370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952373">}</span><span class="op" id="6952374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952377">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952381">&#34;123%45%6&#34;</span><span class="op" id="6952391">,</span>&nbsp;<span class="comment" id="6952393">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952428">&#34;&#34;</span><span class="op" id="6952430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6952434">EscapeError</span><span class="op" id="6952445">(</span><span class="string" id="6952446">&#34;%6&#34;</span><span class="op" id="6952450">)</span><span class="op" id="6952451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952454">}</span><span class="op" id="6952455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952458">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952462">&#34;%zzzzz&#34;</span><span class="op" id="6952470">,</span>&nbsp;<span class="comment" id="6952472">//&nbsp;invalid&nbsp;hex&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952496">&#34;&#34;</span><span class="op" id="6952498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6952502">EscapeError</span><span class="op" id="6952513">(</span><span class="string" id="6952514">&#34;%zz&#34;</span><span class="op" id="6952519">)</span><span class="op" id="6952520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952523">}</span><span class="op" id="6952524">,</span><br>
<span class="lineno"></span><span class="op" id="6952526">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="6952529">func</span>&nbsp;<span class="ident" id="6952534">TestUnescape</span><span class="op" id="6952546">(</span><span class="ident" id="6952547">t</span>&nbsp;<span class="op" id="6952549">*</span><span class="ident" id="6952550">testing</span><span class="op" id="6952557">.</span><span class="ident" id="6952558">T</span><span class="op" id="6952559">)</span>&nbsp;<span class="op" id="6952561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6952564">for</span>&nbsp;<span class="ident" id="6952568">_</span><span class="op" id="6952569">,</span>&nbsp;<span class="ident" id="6952571">tt</span>&nbsp;<span class="op" id="6952574">:=</span>&nbsp;<span class="keyword" id="6952577">range</span>&nbsp;<span class="ident" id="6952583">unescapeTests</span>&nbsp;<span class="op" id="6952597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6952601">actual</span><span class="op" id="6952607">,</span>&nbsp;<span class="ident" id="6952609">err</span>&nbsp;<span class="op" id="6952613">:=</span>&nbsp;<span class="ident" id="6952616">QueryUnescape</span><span class="op" id="6952629">(</span><span class="ident" id="6952630">tt</span><span class="op" id="6952632">.</span><span class="ident" id="6952633">in</span><span class="op" id="6952635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6952639">if</span>&nbsp;<span class="ident" id="6952642">actual</span>&nbsp;<span class="op" id="6952649">!=</span>&nbsp;<span class="ident" id="6952652">tt</span><span class="op" id="6952654">.</span><span class="ident" id="6952655">out</span>&nbsp;<span class="op" id="6952659">||</span>&nbsp;<span class="op" id="6952662">(</span><span class="ident" id="6952663">err</span>&nbsp;<span class="op" id="6952667">!=</span>&nbsp;<span class="builtintype" id="6952670">nil</span><span class="op" id="6952673">)</span>&nbsp;<span class="op" id="6952675">!=</span>&nbsp;<span class="op" id="6952678">(</span><span class="ident" id="6952679">tt</span><span class="op" id="6952681">.</span><span class="ident" id="6952682">err</span>&nbsp;<span class="op" id="6952686">!=</span>&nbsp;<span class="builtintype" id="6952689">nil</span><span class="op" id="6952692">)</span>&nbsp;<span class="op" id="6952694">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6952699">t</span><span class="op" id="6952700">.</span><span class="ident" id="6952701">Errorf</span><span class="op" id="6952707">(</span><span class="string" id="6952708">&#34;QueryUnescape(%q)&nbsp;=&nbsp;%q,&nbsp;%s;&nbsp;want&nbsp;%q,&nbsp;%s&#34;</span><span class="op" id="6952749">,</span>&nbsp;<span class="ident" id="6952751">tt</span><span class="op" id="6952753">.</span><span class="ident" id="6952754">in</span><span class="op" id="6952756">,</span>&nbsp;<span class="ident" id="6952758">actual</span><span class="op" id="6952764">,</span>&nbsp;<span class="ident" id="6952766">err</span><span class="op" id="6952769">,</span>&nbsp;<span class="ident" id="6952771">tt</span><span class="op" id="6952773">.</span><span class="ident" id="6952774">out</span><span class="op" id="6952777">,</span>&nbsp;<span class="ident" id="6952779">tt</span><span class="op" id="6952781">.</span><span class="ident" id="6952782">err</span><span class="op" id="6952785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952792">}</span><br>
<span class="lineno"></span><span class="op" id="6952794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span><span class="keyword" id="6952797">var</span>&nbsp;<span class="ident" id="6952801">escapeTests</span>&nbsp;<span class="op" id="6952813">=</span>&nbsp;<span class="op" id="6952815">[</span><span class="op" id="6952816">]</span><span class="ident" id="6952817">EscapeTest</span><span class="op" id="6952827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952834">&#34;&#34;</span><span class="op" id="6952836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952840">&#34;&#34;</span><span class="op" id="6952842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6952846">nil</span><span class="op" id="6952849">,</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952852">}</span><span class="op" id="6952853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952860">&#34;abc&#34;</span><span class="op" id="6952865">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952869">&#34;abc&#34;</span><span class="op" id="6952874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6952878">nil</span><span class="op" id="6952881">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952884">}</span><span class="op" id="6952885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952892">&#34;one&nbsp;two&#34;</span><span class="op" id="6952901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952905">&#34;one+two&#34;</span><span class="op" id="6952914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6952918">nil</span><span class="op" id="6952921">,</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952924">}</span><span class="op" id="6952925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952932">&#34;10%&#34;</span><span class="op" id="6952937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952941">&#34;10%25&#34;</span><span class="op" id="6952948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6952952">nil</span><span class="op" id="6952955">,</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952958">}</span><span class="op" id="6952959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6952962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6952966">&#34;&nbsp;?&amp;=#+%!&lt;&gt;#\&#34;{}|\\^[]`☺\t:/@$&#39;()*,;&#34;</span><span class="op" id="6953005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6953009">&#34;+%3F%26%3D%23%2B%25%21%3C%3E%23%22%7B%7D%7C%5C%5E%5B%5D%60%E2%98%BA%09%3A%2F%40%24%27%28%29%2A%2C%3B&#34;</span><span class="op" id="6953111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6953115">nil</span><span class="op" id="6953118">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6953121">}</span><span class="op" id="6953122">,</span><br>
<span class="lineno"></span><span class="op" id="6953124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6953127">func</span>&nbsp;<span class="ident" id="6953132">TestEscape</span><span class="op" id="6953142">(</span><span class="ident" id="6953143">t</span>&nbsp;<span class="op" id="6953145">*</span><span class="ident" id="6953146">testing</span><span class="op" id="6953153">.</span><span class="ident" id="6953154">T</span><span class="op" id="6953155">)</span>&nbsp;<span class="op" id="6953157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6953160">for</span>&nbsp;<span class="ident" id="6953164">_</span><span class="op" id="6953165">,</span>&nbsp;<span class="ident" id="6953167">tt</span>&nbsp;<span class="op" id="6953170">:=</span>&nbsp;<span class="keyword" id="6953173">range</span>&nbsp;<span class="ident" id="6953179">escapeTests</span>&nbsp;<span class="op" id="6953191">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6953195">actual</span>&nbsp;<span class="op" id="6953202">:=</span>&nbsp;<span class="ident" id="6953205">QueryEscape</span><span class="op" id="6953216">(</span><span class="ident" id="6953217">tt</span><span class="op" id="6953219">.</span><span class="ident" id="6953220">in</span><span class="op" id="6953222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6953226">if</span>&nbsp;<span class="ident" id="6953229">tt</span><span class="op" id="6953231">.</span><span class="ident" id="6953232">out</span>&nbsp;<span class="op" id="6953236">!=</span>&nbsp;<span class="ident" id="6953239">actual</span>&nbsp;<span class="op" id="6953246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6953251">t</span><span class="op" id="6953252">.</span><span class="ident" id="6953253">Errorf</span><span class="op" id="6953259">(</span><span class="string" id="6953260">&#34;QueryEscape(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6953291">,</span>&nbsp;<span class="ident" id="6953293">tt</span><span class="op" id="6953295">.</span><span class="ident" id="6953296">in</span><span class="op" id="6953298">,</span>&nbsp;<span class="ident" id="6953300">actual</span><span class="op" id="6953306">,</span>&nbsp;<span class="ident" id="6953308">tt</span><span class="op" id="6953310">.</span><span class="ident" id="6953311">out</span><span class="op" id="6953314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6953318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6953323">//&nbsp;for&nbsp;bonus&nbsp;points,&nbsp;verify&nbsp;that&nbsp;escape:unescape&nbsp;is&nbsp;an&nbsp;identity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6953390">roundtrip</span><span class="op" id="6953399">,</span>&nbsp;<span class="ident" id="6953401">err</span>&nbsp;<span class="op" id="6953405">:=</span>&nbsp;<span class="ident" id="6953408">QueryUnescape</span><span class="op" id="6953421">(</span><span class="ident" id="6953422">actual</span><span class="op" id="6953428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6953432">if</span>&nbsp;<span class="ident" id="6953435">roundtrip</span>&nbsp;<span class="op" id="6953445">!=</span>&nbsp;<span class="ident" id="6953448">tt</span><span class="op" id="6953450">.</span><span class="ident" id="6953451">in</span>&nbsp;<span class="op" id="6953454">||</span>&nbsp;<span class="ident" id="6953457">err</span>&nbsp;<span class="op" id="6953461">!=</span>&nbsp;<span class="builtintype" id="6953464">nil</span>&nbsp;<span class="op" id="6953468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6953473">t</span><span class="op" id="6953474">.</span><span class="ident" id="6953475">Errorf</span><span class="op" id="6953481">(</span><span class="string" id="6953482">&#34;QueryUnescape(%q)&nbsp;=&nbsp;%q,&nbsp;%s;&nbsp;want&nbsp;%q,&nbsp;%s&#34;</span><span class="op" id="6953523">,</span>&nbsp;<span class="ident" id="6953525">actual</span><span class="op" id="6953531">,</span>&nbsp;<span class="ident" id="6953533">roundtrip</span><span class="op" id="6953542">,</span>&nbsp;<span class="ident" id="6953544">err</span><span class="op" id="6953547">,</span>&nbsp;<span class="ident" id="6953549">tt</span><span class="op" id="6953551">.</span><span class="ident" id="6953552">in</span><span class="op" id="6953554">,</span>&nbsp;<span class="string" id="6953556">&#34;[no&nbsp;error]&#34;</span><span class="op" id="6953568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6953572">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6953575">}</span><br>
<span class="lineno"></span><span class="op" id="6953577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6953580">//var&nbsp;userinfoTests&nbsp;=&nbsp;[]UserinfoTest{</span><br>
<span class="lineno"></span><span class="comment" id="6953618">//&nbsp;&nbsp;&nbsp;&nbsp;{&#34;user&#34;,&nbsp;&#34;password&#34;,&nbsp;&#34;user:password&#34;},</span><br>
<span class="lineno">540</span><span class="comment" id="6953660">//&nbsp;&nbsp;&nbsp;&nbsp;{&#34;foo:bar&#34;,&nbsp;&#34;~!@#$%^&amp;*()_+{}|[]\\-=`:;&#39;\&#34;&lt;&gt;?,./&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="6953713">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;foo%3Abar:~!%40%23$%25%5E&amp;*()_+%7B%7D%7C%5B%5D%5C-=%60%3A;&#39;%22%3C%3E?,.%2F&#34;},</span><br>
<span class="lineno"></span><span class="comment" id="6953796">//}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6953801">type</span>&nbsp;<span class="ident" id="6953806">EncodeQueryTest</span>&nbsp;<span class="keyword" id="6953822">struct</span>&nbsp;<span class="op" id="6953829">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6953832">m</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6953841">Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6953849">expected</span>&nbsp;<span class="builtintype" id="6953858">string</span><br>
<span class="lineno"></span><span class="op" id="6953865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6953868">var</span>&nbsp;<span class="ident" id="6953872">encodeQueryTests</span>&nbsp;<span class="op" id="6953889">=</span>&nbsp;<span class="op" id="6953891">[</span><span class="op" id="6953892">]</span><span class="ident" id="6953893">EncodeQueryTest</span><span class="op" id="6953908">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6953911">{</span><span class="builtintype" id="6953912">nil</span><span class="op" id="6953915">,</span>&nbsp;<span class="string" id="6953917">&#34;&#34;</span><span class="op" id="6953919">}</span><span class="op" id="6953920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6953923">{</span><span class="ident" id="6953924">Values</span><span class="op" id="6953930">{</span><span class="string" id="6953931">&#34;q&#34;</span><span class="op" id="6953934">:</span>&nbsp;<span class="op" id="6953936">{</span><span class="string" id="6953937">&#34;puppies&#34;</span><span class="op" id="6953946">}</span><span class="op" id="6953947">,</span>&nbsp;<span class="string" id="6953949">&#34;oe&#34;</span><span class="op" id="6953953">:</span>&nbsp;<span class="op" id="6953955">{</span><span class="string" id="6953956">&#34;utf8&#34;</span><span class="op" id="6953962">}</span><span class="op" id="6953963">}</span><span class="op" id="6953964">,</span>&nbsp;<span class="string" id="6953966">&#34;oe=utf8&amp;q=puppies&#34;</span><span class="op" id="6953985">}</span><span class="op" id="6953986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6953989">{</span><span class="ident" id="6953990">Values</span><span class="op" id="6953996">{</span><span class="string" id="6953997">&#34;q&#34;</span><span class="op" id="6954000">:</span>&nbsp;<span class="op" id="6954002">{</span><span class="string" id="6954003">&#34;dogs&#34;</span><span class="op" id="6954009">,</span>&nbsp;<span class="string" id="6954011">&#34;&amp;&#34;</span><span class="op" id="6954014">,</span>&nbsp;<span class="string" id="6954016">&#34;7&#34;</span><span class="op" id="6954019">}</span><span class="op" id="6954020">}</span><span class="op" id="6954021">,</span>&nbsp;<span class="string" id="6954023">&#34;q=dogs&amp;q=%26&amp;q=7&#34;</span><span class="op" id="6954041">}</span><span class="op" id="6954042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954045">{</span><span class="ident" id="6954046">Values</span><span class="op" id="6954052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6954056">&#34;a&#34;</span><span class="op" id="6954059">:</span>&nbsp;<span class="op" id="6954061">{</span><span class="string" id="6954062">&#34;a1&#34;</span><span class="op" id="6954066">,</span>&nbsp;<span class="string" id="6954068">&#34;a2&#34;</span><span class="op" id="6954072">,</span>&nbsp;<span class="string" id="6954074">&#34;a3&#34;</span><span class="op" id="6954078">}</span><span class="op" id="6954079">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6954083">&#34;b&#34;</span><span class="op" id="6954086">:</span>&nbsp;<span class="op" id="6954088">{</span><span class="string" id="6954089">&#34;b1&#34;</span><span class="op" id="6954093">,</span>&nbsp;<span class="string" id="6954095">&#34;b2&#34;</span><span class="op" id="6954099">,</span>&nbsp;<span class="string" id="6954101">&#34;b3&#34;</span><span class="op" id="6954105">}</span><span class="op" id="6954106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6954110">&#34;c&#34;</span><span class="op" id="6954113">:</span>&nbsp;<span class="op" id="6954115">{</span><span class="string" id="6954116">&#34;c1&#34;</span><span class="op" id="6954120">,</span>&nbsp;<span class="string" id="6954122">&#34;c2&#34;</span><span class="op" id="6954126">,</span>&nbsp;<span class="string" id="6954128">&#34;c3&#34;</span><span class="op" id="6954132">}</span><span class="op" id="6954133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954136">}</span><span class="op" id="6954137">,</span>&nbsp;<span class="string" id="6954139">&#34;a=a1&amp;a=a2&amp;a=a3&amp;b=b1&amp;b=b2&amp;b=b3&amp;c=c1&amp;c=c2&amp;c=c3&#34;</span><span class="op" id="6954185">}</span><span class="op" id="6954186">,</span><br>
<span class="lineno"></span><span class="op" id="6954188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="6954191">func</span>&nbsp;<span class="ident" id="6954196">TestEncodeQuery</span><span class="op" id="6954211">(</span><span class="ident" id="6954212">t</span>&nbsp;<span class="op" id="6954214">*</span><span class="ident" id="6954215">testing</span><span class="op" id="6954222">.</span><span class="ident" id="6954223">T</span><span class="op" id="6954224">)</span>&nbsp;<span class="op" id="6954226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6954229">for</span>&nbsp;<span class="ident" id="6954233">_</span><span class="op" id="6954234">,</span>&nbsp;<span class="ident" id="6954236">tt</span>&nbsp;<span class="op" id="6954239">:=</span>&nbsp;<span class="keyword" id="6954242">range</span>&nbsp;<span class="ident" id="6954248">encodeQueryTests</span>&nbsp;<span class="op" id="6954265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6954269">if</span>&nbsp;<span class="ident" id="6954272">q</span>&nbsp;<span class="op" id="6954274">:=</span>&nbsp;<span class="ident" id="6954277">tt</span><span class="op" id="6954279">.</span><span class="ident" id="6954280">m</span><span class="op" id="6954281">.</span><span class="ident" id="6954282">Encode</span><span class="op" id="6954288">(</span><span class="op" id="6954289">)</span><span class="op" id="6954290">;</span>&nbsp;<span class="ident" id="6954292">q</span>&nbsp;<span class="op" id="6954294">!=</span>&nbsp;<span class="ident" id="6954297">tt</span><span class="op" id="6954299">.</span><span class="ident" id="6954300">expected</span>&nbsp;<span class="op" id="6954309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6954314">t</span><span class="op" id="6954315">.</span><span class="ident" id="6954316">Errorf</span><span class="op" id="6954322">(</span><span class="string" id="6954323">`EncodeQuery(%+v)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q`</span><span class="op" id="6954355">,</span>&nbsp;<span class="ident" id="6954357">tt</span><span class="op" id="6954359">.</span><span class="ident" id="6954360">m</span><span class="op" id="6954361">,</span>&nbsp;<span class="ident" id="6954363">q</span><span class="op" id="6954364">,</span>&nbsp;<span class="ident" id="6954366">tt</span><span class="op" id="6954368">.</span><span class="ident" id="6954369">expected</span><span class="op" id="6954377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954381">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954384">}</span><br>
<span class="lineno"></span><span class="op" id="6954386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6954389">var</span>&nbsp;<span class="ident" id="6954393">resolvePathTests</span>&nbsp;<span class="op" id="6954410">=</span>&nbsp;<span class="op" id="6954412">[</span><span class="op" id="6954413">]</span><span class="keyword" id="6954414">struct</span>&nbsp;<span class="op" id="6954421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6954424">base</span><span class="op" id="6954428">,</span>&nbsp;<span class="ident" id="6954430">ref</span><span class="op" id="6954433">,</span>&nbsp;<span class="ident" id="6954435">expected</span>&nbsp;<span class="builtintype" id="6954444">string</span><br>
<span class="lineno">570</span><span class="op" id="6954451">}</span><span class="op" id="6954452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954455">{</span><span class="string" id="6954456">&#34;a/b&#34;</span><span class="op" id="6954461">,</span>&nbsp;<span class="string" id="6954463">&#34;.&#34;</span><span class="op" id="6954466">,</span>&nbsp;<span class="string" id="6954468">&#34;/a/&#34;</span><span class="op" id="6954473">}</span><span class="op" id="6954474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954477">{</span><span class="string" id="6954478">&#34;a/b&#34;</span><span class="op" id="6954483">,</span>&nbsp;<span class="string" id="6954485">&#34;c&#34;</span><span class="op" id="6954488">,</span>&nbsp;<span class="string" id="6954490">&#34;/a/c&#34;</span><span class="op" id="6954496">}</span><span class="op" id="6954497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954500">{</span><span class="string" id="6954501">&#34;a/b&#34;</span><span class="op" id="6954506">,</span>&nbsp;<span class="string" id="6954508">&#34;..&#34;</span><span class="op" id="6954512">,</span>&nbsp;<span class="string" id="6954514">&#34;/&#34;</span><span class="op" id="6954517">}</span><span class="op" id="6954518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954521">{</span><span class="string" id="6954522">&#34;a/&#34;</span><span class="op" id="6954526">,</span>&nbsp;<span class="string" id="6954528">&#34;..&#34;</span><span class="op" id="6954532">,</span>&nbsp;<span class="string" id="6954534">&#34;/&#34;</span><span class="op" id="6954537">}</span><span class="op" id="6954538">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954541">{</span><span class="string" id="6954542">&#34;a/&#34;</span><span class="op" id="6954546">,</span>&nbsp;<span class="string" id="6954548">&#34;../..&#34;</span><span class="op" id="6954555">,</span>&nbsp;<span class="string" id="6954557">&#34;/&#34;</span><span class="op" id="6954560">}</span><span class="op" id="6954561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954564">{</span><span class="string" id="6954565">&#34;a/b/c&#34;</span><span class="op" id="6954572">,</span>&nbsp;<span class="string" id="6954574">&#34;..&#34;</span><span class="op" id="6954578">,</span>&nbsp;<span class="string" id="6954580">&#34;/a/&#34;</span><span class="op" id="6954585">}</span><span class="op" id="6954586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954589">{</span><span class="string" id="6954590">&#34;a/b/c&#34;</span><span class="op" id="6954597">,</span>&nbsp;<span class="string" id="6954599">&#34;../d&#34;</span><span class="op" id="6954605">,</span>&nbsp;<span class="string" id="6954607">&#34;/a/d&#34;</span><span class="op" id="6954613">}</span><span class="op" id="6954614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954617">{</span><span class="string" id="6954618">&#34;a/b/c&#34;</span><span class="op" id="6954625">,</span>&nbsp;<span class="string" id="6954627">&#34;.././d&#34;</span><span class="op" id="6954635">,</span>&nbsp;<span class="string" id="6954637">&#34;/a/d&#34;</span><span class="op" id="6954643">}</span><span class="op" id="6954644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954647">{</span><span class="string" id="6954648">&#34;a/b&#34;</span><span class="op" id="6954653">,</span>&nbsp;<span class="string" id="6954655">&#34;./..&#34;</span><span class="op" id="6954661">,</span>&nbsp;<span class="string" id="6954663">&#34;/&#34;</span><span class="op" id="6954666">}</span><span class="op" id="6954667">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954670">{</span><span class="string" id="6954671">&#34;a/./b&#34;</span><span class="op" id="6954678">,</span>&nbsp;<span class="string" id="6954680">&#34;.&#34;</span><span class="op" id="6954683">,</span>&nbsp;<span class="string" id="6954685">&#34;/a/&#34;</span><span class="op" id="6954690">}</span><span class="op" id="6954691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954694">{</span><span class="string" id="6954695">&#34;a/../&#34;</span><span class="op" id="6954702">,</span>&nbsp;<span class="string" id="6954704">&#34;.&#34;</span><span class="op" id="6954707">,</span>&nbsp;<span class="string" id="6954709">&#34;/&#34;</span><span class="op" id="6954712">}</span><span class="op" id="6954713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954716">{</span><span class="string" id="6954717">&#34;a/.././b&#34;</span><span class="op" id="6954727">,</span>&nbsp;<span class="string" id="6954729">&#34;c&#34;</span><span class="op" id="6954732">,</span>&nbsp;<span class="string" id="6954734">&#34;/c&#34;</span><span class="op" id="6954738">}</span><span class="op" id="6954739">,</span><br>
<span class="lineno"></span><span class="op" id="6954741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="keyword" id="6954744">func</span>&nbsp;<span class="ident" id="6954749">TestResolvePath</span><span class="op" id="6954764">(</span><span class="ident" id="6954765">t</span>&nbsp;<span class="op" id="6954767">*</span><span class="ident" id="6954768">testing</span><span class="op" id="6954775">.</span><span class="ident" id="6954776">T</span><span class="op" id="6954777">)</span>&nbsp;<span class="op" id="6954779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6954782">for</span>&nbsp;<span class="ident" id="6954786">_</span><span class="op" id="6954787">,</span>&nbsp;<span class="ident" id="6954789">test</span>&nbsp;<span class="op" id="6954794">:=</span>&nbsp;<span class="keyword" id="6954797">range</span>&nbsp;<span class="ident" id="6954803">resolvePathTests</span>&nbsp;<span class="op" id="6954820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6954824">got</span>&nbsp;<span class="op" id="6954828">:=</span>&nbsp;<span class="ident" id="6954831">resolvePath</span><span class="op" id="6954842">(</span><span class="ident" id="6954843">test</span><span class="op" id="6954847">.</span><span class="ident" id="6954848">base</span><span class="op" id="6954852">,</span>&nbsp;<span class="ident" id="6954854">test</span><span class="op" id="6954858">.</span><span class="ident" id="6954859">ref</span><span class="op" id="6954862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6954866">if</span>&nbsp;<span class="ident" id="6954869">got</span>&nbsp;<span class="op" id="6954873">!=</span>&nbsp;<span class="ident" id="6954876">test</span><span class="op" id="6954880">.</span><span class="ident" id="6954881">expected</span>&nbsp;<span class="op" id="6954890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6954895">t</span><span class="op" id="6954896">.</span><span class="ident" id="6954897">Errorf</span><span class="op" id="6954903">(</span><span class="string" id="6954904">&#34;For&nbsp;%q&nbsp;+&nbsp;%q&nbsp;got&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="6954937">,</span>&nbsp;<span class="ident" id="6954939">test</span><span class="op" id="6954943">.</span><span class="ident" id="6954944">base</span><span class="op" id="6954948">,</span>&nbsp;<span class="ident" id="6954950">test</span><span class="op" id="6954954">.</span><span class="ident" id="6954955">ref</span><span class="op" id="6954958">,</span>&nbsp;<span class="ident" id="6954960">got</span><span class="op" id="6954963">,</span>&nbsp;<span class="ident" id="6954965">test</span><span class="op" id="6954969">.</span><span class="ident" id="6954970">expected</span><span class="op" id="6954978">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6954985">}</span><br>
<span class="lineno"></span><span class="op" id="6954987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6954990">var</span>&nbsp;<span class="ident" id="6954994">resolveReferenceTests</span>&nbsp;<span class="op" id="6955016">=</span>&nbsp;<span class="op" id="6955018">[</span><span class="op" id="6955019">]</span><span class="keyword" id="6955020">struct</span>&nbsp;<span class="op" id="6955027">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6955030">base</span><span class="op" id="6955034">,</span>&nbsp;<span class="ident" id="6955036">rel</span><span class="op" id="6955039">,</span>&nbsp;<span class="ident" id="6955041">expected</span>&nbsp;<span class="builtintype" id="6955050">string</span><br>
<span class="lineno"></span><span class="op" id="6955057">}</span><span class="op" id="6955058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6955061">//&nbsp;Absolute&nbsp;URL&nbsp;references</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955089">{</span><span class="string" id="6955090">&#34;http://foo.com?a=b&#34;</span><span class="op" id="6955110">,</span>&nbsp;<span class="string" id="6955112">&#34;https://bar.com/&#34;</span><span class="op" id="6955130">,</span>&nbsp;<span class="string" id="6955132">&#34;https://bar.com/&#34;</span><span class="op" id="6955150">}</span><span class="op" id="6955151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955154">{</span><span class="string" id="6955155">&#34;http://foo.com/&#34;</span><span class="op" id="6955172">,</span>&nbsp;<span class="string" id="6955174">&#34;https://bar.com/?a=b&#34;</span><span class="op" id="6955196">,</span>&nbsp;<span class="string" id="6955198">&#34;https://bar.com/?a=b&#34;</span><span class="op" id="6955220">}</span><span class="op" id="6955221">,</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955224">{</span><span class="string" id="6955225">&#34;http://foo.com/bar&#34;</span><span class="op" id="6955245">,</span>&nbsp;<span class="string" id="6955247">&#34;mailto:foo@example.com&#34;</span><span class="op" id="6955271">,</span>&nbsp;<span class="string" id="6955273">&#34;mailto:foo@example.com&#34;</span><span class="op" id="6955297">}</span><span class="op" id="6955298">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6955302">//&nbsp;Path-absolute&nbsp;references</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955331">{</span><span class="string" id="6955332">&#34;http://foo.com/bar&#34;</span><span class="op" id="6955352">,</span>&nbsp;<span class="string" id="6955354">&#34;/baz&#34;</span><span class="op" id="6955360">,</span>&nbsp;<span class="string" id="6955362">&#34;http://foo.com/baz&#34;</span><span class="op" id="6955382">}</span><span class="op" id="6955383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955386">{</span><span class="string" id="6955387">&#34;http://foo.com/bar?a=b#f&#34;</span><span class="op" id="6955413">,</span>&nbsp;<span class="string" id="6955415">&#34;/baz&#34;</span><span class="op" id="6955421">,</span>&nbsp;<span class="string" id="6955423">&#34;http://foo.com/baz&#34;</span><span class="op" id="6955443">}</span><span class="op" id="6955444">,</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955447">{</span><span class="string" id="6955448">&#34;http://foo.com/bar?a=b&#34;</span><span class="op" id="6955472">,</span>&nbsp;<span class="string" id="6955474">&#34;/baz?c=d&#34;</span><span class="op" id="6955484">,</span>&nbsp;<span class="string" id="6955486">&#34;http://foo.com/baz?c=d&#34;</span><span class="op" id="6955510">}</span><span class="op" id="6955511">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6955515">//&nbsp;Scheme-relative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955535">{</span><span class="string" id="6955536">&#34;https://foo.com/bar?a=b&#34;</span><span class="op" id="6955561">,</span>&nbsp;<span class="string" id="6955563">&#34;//bar.com/quux&#34;</span><span class="op" id="6955579">,</span>&nbsp;<span class="string" id="6955581">&#34;https://bar.com/quux&#34;</span><span class="op" id="6955603">}</span><span class="op" id="6955604">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6955608">//&nbsp;Path-relative&nbsp;references:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6955639">//&nbsp;...&nbsp;current&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955665">{</span><span class="string" id="6955666">&#34;http://foo.com&#34;</span><span class="op" id="6955682">,</span>&nbsp;<span class="string" id="6955684">&#34;.&#34;</span><span class="op" id="6955687">,</span>&nbsp;<span class="string" id="6955689">&#34;http://foo.com/&#34;</span><span class="op" id="6955706">}</span><span class="op" id="6955707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955710">{</span><span class="string" id="6955711">&#34;http://foo.com/bar&#34;</span><span class="op" id="6955731">,</span>&nbsp;<span class="string" id="6955733">&#34;.&#34;</span><span class="op" id="6955736">,</span>&nbsp;<span class="string" id="6955738">&#34;http://foo.com/&#34;</span><span class="op" id="6955755">}</span><span class="op" id="6955756">,</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955759">{</span><span class="string" id="6955760">&#34;http://foo.com/bar/&#34;</span><span class="op" id="6955781">,</span>&nbsp;<span class="string" id="6955783">&#34;.&#34;</span><span class="op" id="6955786">,</span>&nbsp;<span class="string" id="6955788">&#34;http://foo.com/bar/&#34;</span><span class="op" id="6955809">}</span><span class="op" id="6955810">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6955814">//&nbsp;...&nbsp;going&nbsp;down</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955833">{</span><span class="string" id="6955834">&#34;http://foo.com&#34;</span><span class="op" id="6955850">,</span>&nbsp;<span class="string" id="6955852">&#34;bar&#34;</span><span class="op" id="6955857">,</span>&nbsp;<span class="string" id="6955859">&#34;http://foo.com/bar&#34;</span><span class="op" id="6955879">}</span><span class="op" id="6955880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955883">{</span><span class="string" id="6955884">&#34;http://foo.com/&#34;</span><span class="op" id="6955901">,</span>&nbsp;<span class="string" id="6955903">&#34;bar&#34;</span><span class="op" id="6955908">,</span>&nbsp;<span class="string" id="6955910">&#34;http://foo.com/bar&#34;</span><span class="op" id="6955930">}</span><span class="op" id="6955931">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6955934">{</span><span class="string" id="6955935">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6955959">,</span>&nbsp;<span class="string" id="6955961">&#34;quux&#34;</span><span class="op" id="6955967">,</span>&nbsp;<span class="string" id="6955969">&#34;http://foo.com/bar/quux&#34;</span><span class="op" id="6955994">}</span><span class="op" id="6955995">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6955999">//&nbsp;...&nbsp;going&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6956016">{</span><span class="string" id="6956017">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6956041">,</span>&nbsp;<span class="string" id="6956043">&#34;../quux&#34;</span><span class="op" id="6956052">,</span>&nbsp;<span class="string" id="6956054">&#34;http://foo.com/quux&#34;</span><span class="op" id="6956075">}</span><span class="op" id="6956076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6956079">{</span><span class="string" id="6956080">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6956104">,</span>&nbsp;<span class="string" id="6956106">&#34;../../../../../quux&#34;</span><span class="op" id="6956127">,</span>&nbsp;<span class="string" id="6956129">&#34;http://foo.com/quux&#34;</span><span class="op" id="6956150">}</span><span class="op" id="6956151">,</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6956154">{</span><span class="string" id="6956155">&#34;http://foo.com/bar&#34;</span><span class="op" id="6956175">,</span>&nbsp;<span class="string" id="6956177">&#34;..&#34;</span><span class="op" id="6956181">,</span>&nbsp;<span class="string" id="6956183">&#34;http://foo.com/&#34;</span><span class="op" id="6956200">}</span><span class="op" id="6956201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6956204">{</span><span class="string" id="6956205">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6956229">,</span>&nbsp;<span class="string" id="6956231">&#34;./..&#34;</span><span class="op" id="6956237">,</span>&nbsp;<span class="string" id="6956239">&#34;http://foo.com/&#34;</span><span class="op" id="6956256">}</span><span class="op" id="6956257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6956260">//&nbsp;&#34;..&#34;&nbsp;in&nbsp;the&nbsp;middle&nbsp;(issue&nbsp;3560)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6956296">{</span><span class="string" id="6956297">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6956321">,</span>&nbsp;<span class="string" id="6956323">&#34;quux/dotdot/../tail&#34;</span><span class="op" id="6956344">,</span>&nbsp;<span class="string" id="6956346">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6956376">}</span><span class="op" id="6956377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6956380">{</span><span class="string" id="6956381">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6956405">,</span>&nbsp;<span class="string" id="6956407">&#34;quux/./dotdot/../tail&#34;</span><span class="op" id="6956430">,</span>&nbsp;<span class="string" id="6956432">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6956462">}</span><span class="op" id="6956463">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6956466">{</span><span class="string" id="6956467">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6956491">,</span>&nbsp;<span class="string" id="6956493">&#34;quux/./dotdot/.././tail&#34;</span><span class="op" id="6956518">,</span>&nbsp;<span class="string" id="6956520">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6956550">}</span><span class="op" id="6956551">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6956554">{</span><span class="string" id="6956555">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6956579">,</span>&nbsp;<span class="string" id="6956581">&#34;quux/./dotdot/./../tail&#34;</span><span class="op" id="6956606">,</span>&nbsp;<span class="string" id="6956608">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6956638">}</span><span class="op" id="6956639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6956642">{</span><span class="string" id="6956643">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6956667">,</span>&nbsp;<span class="string" id="6956669">&#34;quux/./dotdot/dotdot/././../../tail&#34;</span><span class="op" id="6956706">,</span>&nbsp;<span class="string" id="6956708">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6956738">}</span><span class="op" id="6956739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6956742">{</span><span class="string" id="6956743">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6956767">,</span>&nbsp;<span class="string" id="6956769">&#34;quux/./dotdot/dotdot/./.././../tail&#34;</span><span class="op" id="6956806">,</span>&nbsp;<span class="string" id="6956808">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6956838">}</span><span class="op" id="6956839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6956842">{</span><span class="string" id="6956843">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6956867">,</span>&nbsp;<span class="string" id="6956869">&#34;quux/./dotdot/dotdot/dotdot/./../../.././././tail&#34;</span><span class="op" id="6956920">,</span>&nbsp;<span class="string" id="6956922">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6956952">}</span><span class="op" id="6956953">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6956956">{</span><span class="string" id="6956957">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6956981">,</span>&nbsp;<span class="string" id="6956983">&#34;quux/./dotdot/../dotdot/../dot/./tail/..&#34;</span><span class="op" id="6957025">,</span>&nbsp;<span class="string" id="6957027">&#34;http://foo.com/bar/quux/dot/&#34;</span><span class="op" id="6957057">}</span><span class="op" id="6957058">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6957062">//&nbsp;Remove&nbsp;any&nbsp;dot-segments&nbsp;prior&nbsp;to&nbsp;forming&nbsp;the&nbsp;target&nbsp;URI.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6957123">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957176">{</span><span class="string" id="6957177">&#34;http://foo.com/dot/./dotdot/../foo/bar&#34;</span><span class="op" id="6957217">,</span>&nbsp;<span class="string" id="6957219">&#34;../baz&#34;</span><span class="op" id="6957227">,</span>&nbsp;<span class="string" id="6957229">&#34;http://foo.com/dot/baz&#34;</span><span class="op" id="6957253">}</span><span class="op" id="6957254">,</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6957258">//&nbsp;Triple&nbsp;dot&nbsp;isn&#39;t&nbsp;special</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957287">{</span><span class="string" id="6957288">&#34;http://foo.com/bar&#34;</span><span class="op" id="6957308">,</span>&nbsp;<span class="string" id="6957310">&#34;...&#34;</span><span class="op" id="6957315">,</span>&nbsp;<span class="string" id="6957317">&#34;http://foo.com/...&#34;</span><span class="op" id="6957337">}</span><span class="op" id="6957338">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6957342">//&nbsp;Fragment</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957355">{</span><span class="string" id="6957356">&#34;http://foo.com/bar&#34;</span><span class="op" id="6957376">,</span>&nbsp;<span class="string" id="6957378">&#34;.#frag&#34;</span><span class="op" id="6957386">,</span>&nbsp;<span class="string" id="6957388">&#34;http://foo.com/#frag&#34;</span><span class="op" id="6957410">}</span><span class="op" id="6957411">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6957415">//&nbsp;RFC&nbsp;3986:&nbsp;Normal&nbsp;Examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6957445">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957498">{</span><span class="string" id="6957499">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6957519">,</span>&nbsp;<span class="string" id="6957521">&#34;g:h&#34;</span><span class="op" id="6957526">,</span>&nbsp;<span class="string" id="6957528">&#34;g:h&#34;</span><span class="op" id="6957533">}</span><span class="op" id="6957534">,</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957537">{</span><span class="string" id="6957538">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6957558">,</span>&nbsp;<span class="string" id="6957560">&#34;g&#34;</span><span class="op" id="6957563">,</span>&nbsp;<span class="string" id="6957565">&#34;http://a/b/c/g&#34;</span><span class="op" id="6957581">}</span><span class="op" id="6957582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957585">{</span><span class="string" id="6957586">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6957606">,</span>&nbsp;<span class="string" id="6957608">&#34;./g&#34;</span><span class="op" id="6957613">,</span>&nbsp;<span class="string" id="6957615">&#34;http://a/b/c/g&#34;</span><span class="op" id="6957631">}</span><span class="op" id="6957632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957635">{</span><span class="string" id="6957636">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6957656">,</span>&nbsp;<span class="string" id="6957658">&#34;g/&#34;</span><span class="op" id="6957662">,</span>&nbsp;<span class="string" id="6957664">&#34;http://a/b/c/g/&#34;</span><span class="op" id="6957681">}</span><span class="op" id="6957682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957685">{</span><span class="string" id="6957686">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6957706">,</span>&nbsp;<span class="string" id="6957708">&#34;/g&#34;</span><span class="op" id="6957712">,</span>&nbsp;<span class="string" id="6957714">&#34;http://a/g&#34;</span><span class="op" id="6957726">}</span><span class="op" id="6957727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957730">{</span><span class="string" id="6957731">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6957751">,</span>&nbsp;<span class="string" id="6957753">&#34;//g&#34;</span><span class="op" id="6957758">,</span>&nbsp;<span class="string" id="6957760">&#34;http://g&#34;</span><span class="op" id="6957770">}</span><span class="op" id="6957771">,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957774">{</span><span class="string" id="6957775">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6957795">,</span>&nbsp;<span class="string" id="6957797">&#34;?y&#34;</span><span class="op" id="6957801">,</span>&nbsp;<span class="string" id="6957803">&#34;http://a/b/c/d;p?y&#34;</span><span class="op" id="6957823">}</span><span class="op" id="6957824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957827">{</span><span class="string" id="6957828">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6957848">,</span>&nbsp;<span class="string" id="6957850">&#34;g?y&#34;</span><span class="op" id="6957855">,</span>&nbsp;<span class="string" id="6957857">&#34;http://a/b/c/g?y&#34;</span><span class="op" id="6957875">}</span><span class="op" id="6957876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957879">{</span><span class="string" id="6957880">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6957900">,</span>&nbsp;<span class="string" id="6957902">&#34;#s&#34;</span><span class="op" id="6957906">,</span>&nbsp;<span class="string" id="6957908">&#34;http://a/b/c/d;p?q#s&#34;</span><span class="op" id="6957930">}</span><span class="op" id="6957931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957934">{</span><span class="string" id="6957935">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6957955">,</span>&nbsp;<span class="string" id="6957957">&#34;g#s&#34;</span><span class="op" id="6957962">,</span>&nbsp;<span class="string" id="6957964">&#34;http://a/b/c/g#s&#34;</span><span class="op" id="6957982">}</span><span class="op" id="6957983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6957986">{</span><span class="string" id="6957987">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958007">,</span>&nbsp;<span class="string" id="6958009">&#34;g?y#s&#34;</span><span class="op" id="6958016">,</span>&nbsp;<span class="string" id="6958018">&#34;http://a/b/c/g?y#s&#34;</span><span class="op" id="6958038">}</span><span class="op" id="6958039">,</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958042">{</span><span class="string" id="6958043">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958063">,</span>&nbsp;<span class="string" id="6958065">&#34;;x&#34;</span><span class="op" id="6958069">,</span>&nbsp;<span class="string" id="6958071">&#34;http://a/b/c/;x&#34;</span><span class="op" id="6958088">}</span><span class="op" id="6958089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958092">{</span><span class="string" id="6958093">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958113">,</span>&nbsp;<span class="string" id="6958115">&#34;g;x&#34;</span><span class="op" id="6958120">,</span>&nbsp;<span class="string" id="6958122">&#34;http://a/b/c/g;x&#34;</span><span class="op" id="6958140">}</span><span class="op" id="6958141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958144">{</span><span class="string" id="6958145">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958165">,</span>&nbsp;<span class="string" id="6958167">&#34;g;x?y#s&#34;</span><span class="op" id="6958176">,</span>&nbsp;<span class="string" id="6958178">&#34;http://a/b/c/g;x?y#s&#34;</span><span class="op" id="6958200">}</span><span class="op" id="6958201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958204">{</span><span class="string" id="6958205">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958225">,</span>&nbsp;<span class="string" id="6958227">&#34;&#34;</span><span class="op" id="6958229">,</span>&nbsp;<span class="string" id="6958231">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958251">}</span><span class="op" id="6958252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958255">{</span><span class="string" id="6958256">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958276">,</span>&nbsp;<span class="string" id="6958278">&#34;.&#34;</span><span class="op" id="6958281">,</span>&nbsp;<span class="string" id="6958283">&#34;http://a/b/c/&#34;</span><span class="op" id="6958298">}</span><span class="op" id="6958299">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958302">{</span><span class="string" id="6958303">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958323">,</span>&nbsp;<span class="string" id="6958325">&#34;./&#34;</span><span class="op" id="6958329">,</span>&nbsp;<span class="string" id="6958331">&#34;http://a/b/c/&#34;</span><span class="op" id="6958346">}</span><span class="op" id="6958347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958350">{</span><span class="string" id="6958351">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958371">,</span>&nbsp;<span class="string" id="6958373">&#34;..&#34;</span><span class="op" id="6958377">,</span>&nbsp;<span class="string" id="6958379">&#34;http://a/b/&#34;</span><span class="op" id="6958392">}</span><span class="op" id="6958393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958396">{</span><span class="string" id="6958397">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958417">,</span>&nbsp;<span class="string" id="6958419">&#34;../&#34;</span><span class="op" id="6958424">,</span>&nbsp;<span class="string" id="6958426">&#34;http://a/b/&#34;</span><span class="op" id="6958439">}</span><span class="op" id="6958440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958443">{</span><span class="string" id="6958444">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958464">,</span>&nbsp;<span class="string" id="6958466">&#34;../g&#34;</span><span class="op" id="6958472">,</span>&nbsp;<span class="string" id="6958474">&#34;http://a/b/g&#34;</span><span class="op" id="6958488">}</span><span class="op" id="6958489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958492">{</span><span class="string" id="6958493">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958513">,</span>&nbsp;<span class="string" id="6958515">&#34;../..&#34;</span><span class="op" id="6958522">,</span>&nbsp;<span class="string" id="6958524">&#34;http://a/&#34;</span><span class="op" id="6958535">}</span><span class="op" id="6958536">,</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958539">{</span><span class="string" id="6958540">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958560">,</span>&nbsp;<span class="string" id="6958562">&#34;../../&#34;</span><span class="op" id="6958570">,</span>&nbsp;<span class="string" id="6958572">&#34;http://a/&#34;</span><span class="op" id="6958583">}</span><span class="op" id="6958584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958587">{</span><span class="string" id="6958588">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958608">,</span>&nbsp;<span class="string" id="6958610">&#34;../../g&#34;</span><span class="op" id="6958619">,</span>&nbsp;<span class="string" id="6958621">&#34;http://a/g&#34;</span><span class="op" id="6958633">}</span><span class="op" id="6958634">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6958638">//&nbsp;RFC&nbsp;3986:&nbsp;Abnormal&nbsp;Examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6958670">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.4.2</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958723">{</span><span class="string" id="6958724">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958744">,</span>&nbsp;<span class="string" id="6958746">&#34;../../../g&#34;</span><span class="op" id="6958758">,</span>&nbsp;<span class="string" id="6958760">&#34;http://a/g&#34;</span><span class="op" id="6958772">}</span><span class="op" id="6958773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958776">{</span><span class="string" id="6958777">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958797">,</span>&nbsp;<span class="string" id="6958799">&#34;../../../../g&#34;</span><span class="op" id="6958814">,</span>&nbsp;<span class="string" id="6958816">&#34;http://a/g&#34;</span><span class="op" id="6958828">}</span><span class="op" id="6958829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958832">{</span><span class="string" id="6958833">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958853">,</span>&nbsp;<span class="string" id="6958855">&#34;/./g&#34;</span><span class="op" id="6958861">,</span>&nbsp;<span class="string" id="6958863">&#34;http://a/g&#34;</span><span class="op" id="6958875">}</span><span class="op" id="6958876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958879">{</span><span class="string" id="6958880">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958900">,</span>&nbsp;<span class="string" id="6958902">&#34;/../g&#34;</span><span class="op" id="6958909">,</span>&nbsp;<span class="string" id="6958911">&#34;http://a/g&#34;</span><span class="op" id="6958923">}</span><span class="op" id="6958924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958927">{</span><span class="string" id="6958928">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958948">,</span>&nbsp;<span class="string" id="6958950">&#34;g.&#34;</span><span class="op" id="6958954">,</span>&nbsp;<span class="string" id="6958956">&#34;http://a/b/c/g.&#34;</span><span class="op" id="6958973">}</span><span class="op" id="6958974">,</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6958977">{</span><span class="string" id="6958978">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6958998">,</span>&nbsp;<span class="string" id="6959000">&#34;.g&#34;</span><span class="op" id="6959004">,</span>&nbsp;<span class="string" id="6959006">&#34;http://a/b/c/.g&#34;</span><span class="op" id="6959023">}</span><span class="op" id="6959024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959027">{</span><span class="string" id="6959028">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6959048">,</span>&nbsp;<span class="string" id="6959050">&#34;g..&#34;</span><span class="op" id="6959055">,</span>&nbsp;<span class="string" id="6959057">&#34;http://a/b/c/g..&#34;</span><span class="op" id="6959075">}</span><span class="op" id="6959076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959079">{</span><span class="string" id="6959080">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6959100">,</span>&nbsp;<span class="string" id="6959102">&#34;..g&#34;</span><span class="op" id="6959107">,</span>&nbsp;<span class="string" id="6959109">&#34;http://a/b/c/..g&#34;</span><span class="op" id="6959127">}</span><span class="op" id="6959128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959131">{</span><span class="string" id="6959132">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6959152">,</span>&nbsp;<span class="string" id="6959154">&#34;./../g&#34;</span><span class="op" id="6959162">,</span>&nbsp;<span class="string" id="6959164">&#34;http://a/b/g&#34;</span><span class="op" id="6959178">}</span><span class="op" id="6959179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959182">{</span><span class="string" id="6959183">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6959203">,</span>&nbsp;<span class="string" id="6959205">&#34;./g/.&#34;</span><span class="op" id="6959212">,</span>&nbsp;<span class="string" id="6959214">&#34;http://a/b/c/g/&#34;</span><span class="op" id="6959231">}</span><span class="op" id="6959232">,</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959235">{</span><span class="string" id="6959236">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6959256">,</span>&nbsp;<span class="string" id="6959258">&#34;g/./h&#34;</span><span class="op" id="6959265">,</span>&nbsp;<span class="string" id="6959267">&#34;http://a/b/c/g/h&#34;</span><span class="op" id="6959285">}</span><span class="op" id="6959286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959289">{</span><span class="string" id="6959290">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6959310">,</span>&nbsp;<span class="string" id="6959312">&#34;g/../h&#34;</span><span class="op" id="6959320">,</span>&nbsp;<span class="string" id="6959322">&#34;http://a/b/c/h&#34;</span><span class="op" id="6959338">}</span><span class="op" id="6959339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959342">{</span><span class="string" id="6959343">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6959363">,</span>&nbsp;<span class="string" id="6959365">&#34;g;x=1/./y&#34;</span><span class="op" id="6959376">,</span>&nbsp;<span class="string" id="6959378">&#34;http://a/b/c/g;x=1/y&#34;</span><span class="op" id="6959400">}</span><span class="op" id="6959401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959404">{</span><span class="string" id="6959405">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6959425">,</span>&nbsp;<span class="string" id="6959427">&#34;g;x=1/../y&#34;</span><span class="op" id="6959439">,</span>&nbsp;<span class="string" id="6959441">&#34;http://a/b/c/y&#34;</span><span class="op" id="6959457">}</span><span class="op" id="6959458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959461">{</span><span class="string" id="6959462">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6959482">,</span>&nbsp;<span class="string" id="6959484">&#34;g?y/./x&#34;</span><span class="op" id="6959493">,</span>&nbsp;<span class="string" id="6959495">&#34;http://a/b/c/g?y/./x&#34;</span><span class="op" id="6959517">}</span><span class="op" id="6959518">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959521">{</span><span class="string" id="6959522">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6959542">,</span>&nbsp;<span class="string" id="6959544">&#34;g?y/../x&#34;</span><span class="op" id="6959554">,</span>&nbsp;<span class="string" id="6959556">&#34;http://a/b/c/g?y/../x&#34;</span><span class="op" id="6959579">}</span><span class="op" id="6959580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959583">{</span><span class="string" id="6959584">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6959604">,</span>&nbsp;<span class="string" id="6959606">&#34;g#s/./x&#34;</span><span class="op" id="6959615">,</span>&nbsp;<span class="string" id="6959617">&#34;http://a/b/c/g#s/./x&#34;</span><span class="op" id="6959639">}</span><span class="op" id="6959640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959643">{</span><span class="string" id="6959644">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6959664">,</span>&nbsp;<span class="string" id="6959666">&#34;g#s/../x&#34;</span><span class="op" id="6959676">,</span>&nbsp;<span class="string" id="6959678">&#34;http://a/b/c/g#s/../x&#34;</span><span class="op" id="6959701">}</span><span class="op" id="6959702">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6959706">//&nbsp;Extras.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959718">{</span><span class="string" id="6959719">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="6959740">,</span>&nbsp;<span class="string" id="6959742">&#34;//g?q&#34;</span><span class="op" id="6959749">,</span>&nbsp;<span class="string" id="6959751">&#34;https://g?q&#34;</span><span class="op" id="6959764">}</span><span class="op" id="6959765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959768">{</span><span class="string" id="6959769">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="6959790">,</span>&nbsp;<span class="string" id="6959792">&#34;//g#s&#34;</span><span class="op" id="6959799">,</span>&nbsp;<span class="string" id="6959801">&#34;https://g#s&#34;</span><span class="op" id="6959814">}</span><span class="op" id="6959815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959818">{</span><span class="string" id="6959819">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="6959840">,</span>&nbsp;<span class="string" id="6959842">&#34;//g/d/e/f?y#s&#34;</span><span class="op" id="6959857">,</span>&nbsp;<span class="string" id="6959859">&#34;https://g/d/e/f?y#s&#34;</span><span class="op" id="6959880">}</span><span class="op" id="6959881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959884">{</span><span class="string" id="6959885">&#34;https://a/b/c/d;p#s&#34;</span><span class="op" id="6959906">,</span>&nbsp;<span class="string" id="6959908">&#34;?y&#34;</span><span class="op" id="6959912">,</span>&nbsp;<span class="string" id="6959914">&#34;https://a/b/c/d;p?y&#34;</span><span class="op" id="6959935">}</span><span class="op" id="6959936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6959939">{</span><span class="string" id="6959940">&#34;https://a/b/c/d;p?q#s&#34;</span><span class="op" id="6959963">,</span>&nbsp;<span class="string" id="6959965">&#34;?y&#34;</span><span class="op" id="6959969">,</span>&nbsp;<span class="string" id="6959971">&#34;https://a/b/c/d;p?y&#34;</span><span class="op" id="6959992">}</span><span class="op" id="6959993">,</span><br>
<span class="lineno">700</span><span class="op" id="6959995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6959998">func</span>&nbsp;<span class="ident" id="6960003">TestResolveReference</span><span class="op" id="6960023">(</span><span class="ident" id="6960024">t</span>&nbsp;<span class="op" id="6960026">*</span><span class="ident" id="6960027">testing</span><span class="op" id="6960034">.</span><span class="ident" id="6960035">T</span><span class="op" id="6960036">)</span>&nbsp;<span class="op" id="6960038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960041">mustParse</span>&nbsp;<span class="op" id="6960051">:=</span>&nbsp;<span class="keyword" id="6960054">func</span><span class="op" id="6960058">(</span><span class="ident" id="6960059">url</span>&nbsp;<span class="builtintype" id="6960063">string</span><span class="op" id="6960069">)</span>&nbsp;<span class="op" id="6960071">*</span><span class="ident" id="6960072">URL</span>&nbsp;<span class="op" id="6960076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960080">u</span><span class="op" id="6960081">,</span>&nbsp;<span class="ident" id="6960083">err</span>&nbsp;<span class="op" id="6960087">:=</span>&nbsp;<span class="ident" id="6960090">Parse</span><span class="op" id="6960095">(</span><span class="ident" id="6960096">url</span><span class="op" id="6960099">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6960103">if</span>&nbsp;<span class="ident" id="6960106">err</span>&nbsp;<span class="op" id="6960110">!=</span>&nbsp;<span class="builtintype" id="6960113">nil</span>&nbsp;<span class="op" id="6960117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960122">t</span><span class="op" id="6960123">.</span><span class="ident" id="6960124">Fatalf</span><span class="op" id="6960130">(</span><span class="string" id="6960131">&#34;Expected&nbsp;URL&nbsp;to&nbsp;parse:&nbsp;%q,&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6960173">,</span>&nbsp;<span class="ident" id="6960175">url</span><span class="op" id="6960178">,</span>&nbsp;<span class="ident" id="6960180">err</span><span class="op" id="6960183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6960187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6960191">return</span>&nbsp;<span class="ident" id="6960198">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6960201">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960204">opaque</span>&nbsp;<span class="op" id="6960211">:=</span>&nbsp;<span class="op" id="6960214">&amp;</span><span class="ident" id="6960215">URL</span><span class="op" id="6960218">{</span><span class="ident" id="6960219">Scheme</span><span class="op" id="6960225">:</span>&nbsp;<span class="string" id="6960227">&#34;scheme&#34;</span><span class="op" id="6960235">,</span>&nbsp;<span class="ident" id="6960237">Opaque</span><span class="op" id="6960243">:</span>&nbsp;<span class="string" id="6960245">&#34;opaque&#34;</span><span class="op" id="6960253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6960256">for</span>&nbsp;<span class="ident" id="6960260">_</span><span class="op" id="6960261">,</span>&nbsp;<span class="ident" id="6960263">test</span>&nbsp;<span class="op" id="6960268">:=</span>&nbsp;<span class="keyword" id="6960271">range</span>&nbsp;<span class="ident" id="6960277">resolveReferenceTests</span>&nbsp;<span class="op" id="6960299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960303">base</span>&nbsp;<span class="op" id="6960308">:=</span>&nbsp;<span class="ident" id="6960311">mustParse</span><span class="op" id="6960320">(</span><span class="ident" id="6960321">test</span><span class="op" id="6960325">.</span><span class="ident" id="6960326">base</span><span class="op" id="6960330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960334">rel</span>&nbsp;<span class="op" id="6960338">:=</span>&nbsp;<span class="ident" id="6960341">mustParse</span><span class="op" id="6960350">(</span><span class="ident" id="6960351">test</span><span class="op" id="6960355">.</span><span class="ident" id="6960356">rel</span><span class="op" id="6960359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960363">url</span>&nbsp;<span class="op" id="6960367">:=</span>&nbsp;<span class="ident" id="6960370">base</span><span class="op" id="6960374">.</span><span class="ident" id="6960375">ResolveReference</span><span class="op" id="6960391">(</span><span class="ident" id="6960392">rel</span><span class="op" id="6960395">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6960399">if</span>&nbsp;<span class="ident" id="6960402">url</span><span class="op" id="6960405">.</span><span class="ident" id="6960406">String</span><span class="op" id="6960412">(</span><span class="op" id="6960413">)</span>&nbsp;<span class="op" id="6960415">!=</span>&nbsp;<span class="ident" id="6960418">test</span><span class="op" id="6960422">.</span><span class="ident" id="6960423">expected</span>&nbsp;<span class="op" id="6960432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960437">t</span><span class="op" id="6960438">.</span><span class="ident" id="6960439">Errorf</span><span class="op" id="6960445">(</span><span class="string" id="6960446">&#34;URL(%q).ResolveReference(%q)&nbsp;==&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6960490">,</span>&nbsp;<span class="ident" id="6960492">test</span><span class="op" id="6960496">.</span><span class="ident" id="6960497">base</span><span class="op" id="6960501">,</span>&nbsp;<span class="ident" id="6960503">test</span><span class="op" id="6960507">.</span><span class="ident" id="6960508">rel</span><span class="op" id="6960511">,</span>&nbsp;<span class="ident" id="6960513">test</span><span class="op" id="6960517">.</span><span class="ident" id="6960518">expected</span><span class="op" id="6960526">,</span>&nbsp;<span class="ident" id="6960528">url</span><span class="op" id="6960531">.</span><span class="ident" id="6960532">String</span><span class="op" id="6960538">(</span><span class="op" id="6960539">)</span><span class="op" id="6960540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6960544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6960548">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6960593">if</span>&nbsp;<span class="ident" id="6960596">base</span>&nbsp;<span class="op" id="6960601">==</span>&nbsp;<span class="ident" id="6960604">url</span>&nbsp;<span class="op" id="6960608">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960613">t</span><span class="op" id="6960614">.</span><span class="ident" id="6960615">Errorf</span><span class="op" id="6960621">(</span><span class="string" id="6960622">&#34;Expected&nbsp;URL.ResolveReference&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="6960681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6960685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6960689">//&nbsp;Test&nbsp;the&nbsp;convenience&nbsp;wrapper&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960728">url</span><span class="op" id="6960731">,</span>&nbsp;<span class="ident" id="6960733">err</span>&nbsp;<span class="op" id="6960737">:=</span>&nbsp;<span class="ident" id="6960740">base</span><span class="op" id="6960744">.</span><span class="ident" id="6960745">Parse</span><span class="op" id="6960750">(</span><span class="ident" id="6960751">test</span><span class="op" id="6960755">.</span><span class="ident" id="6960756">rel</span><span class="op" id="6960759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6960763">if</span>&nbsp;<span class="ident" id="6960766">err</span>&nbsp;<span class="op" id="6960770">!=</span>&nbsp;<span class="builtintype" id="6960773">nil</span>&nbsp;<span class="op" id="6960777">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960782">t</span><span class="op" id="6960783">.</span><span class="ident" id="6960784">Errorf</span><span class="op" id="6960790">(</span><span class="string" id="6960791">&#34;URL(%q).Parse(%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6960821">,</span>&nbsp;<span class="ident" id="6960823">test</span><span class="op" id="6960827">.</span><span class="ident" id="6960828">base</span><span class="op" id="6960832">,</span>&nbsp;<span class="ident" id="6960834">test</span><span class="op" id="6960838">.</span><span class="ident" id="6960839">rel</span><span class="op" id="6960842">,</span>&nbsp;<span class="ident" id="6960844">err</span><span class="op" id="6960847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6960851">}</span>&nbsp;<span class="keyword" id="6960853">else</span>&nbsp;<span class="keyword" id="6960858">if</span>&nbsp;<span class="ident" id="6960861">url</span><span class="op" id="6960864">.</span><span class="ident" id="6960865">String</span><span class="op" id="6960871">(</span><span class="op" id="6960872">)</span>&nbsp;<span class="op" id="6960874">!=</span>&nbsp;<span class="ident" id="6960877">test</span><span class="op" id="6960881">.</span><span class="ident" id="6960882">expected</span>&nbsp;<span class="op" id="6960891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6960896">t</span><span class="op" id="6960897">.</span><span class="ident" id="6960898">Errorf</span><span class="op" id="6960904">(</span><span class="string" id="6960905">&#34;URL(%q).Parse(%q)&nbsp;==&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6960938">,</span>&nbsp;<span class="ident" id="6960940">test</span><span class="op" id="6960944">.</span><span class="ident" id="6960945">base</span><span class="op" id="6960949">,</span>&nbsp;<span class="ident" id="6960951">test</span><span class="op" id="6960955">.</span><span class="ident" id="6960956">rel</span><span class="op" id="6960959">,</span>&nbsp;<span class="ident" id="6960961">test</span><span class="op" id="6960965">.</span><span class="ident" id="6960966">expected</span><span class="op" id="6960974">,</span>&nbsp;<span class="ident" id="6960976">url</span><span class="op" id="6960979">.</span><span class="ident" id="6960980">String</span><span class="op" id="6960986">(</span><span class="op" id="6960987">)</span><span class="op" id="6960988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6960992">}</span>&nbsp;<span class="keyword" id="6960994">else</span>&nbsp;<span class="keyword" id="6960999">if</span>&nbsp;<span class="ident" id="6961002">base</span>&nbsp;<span class="op" id="6961007">==</span>&nbsp;<span class="ident" id="6961010">url</span>&nbsp;<span class="op" id="6961014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6961019">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned&nbsp;for&nbsp;the&nbsp;wrapper&nbsp;too.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6961085">t</span><span class="op" id="6961086">.</span><span class="ident" id="6961087">Errorf</span><span class="op" id="6961093">(</span><span class="string" id="6961094">&#34;Expected&nbsp;URL.Parse&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="6961142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6961146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6961150">//&nbsp;Ensure&nbsp;Opaque&nbsp;resets&nbsp;the&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6961185">url</span>&nbsp;<span class="op" id="6961189">=</span>&nbsp;<span class="ident" id="6961191">base</span><span class="op" id="6961195">.</span><span class="ident" id="6961196">ResolveReference</span><span class="op" id="6961212">(</span><span class="ident" id="6961213">opaque</span><span class="op" id="6961219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6961223">if</span>&nbsp;<span class="op" id="6961226">*</span><span class="ident" id="6961227">url</span>&nbsp;<span class="op" id="6961231">!=</span>&nbsp;<span class="op" id="6961234">*</span><span class="ident" id="6961235">opaque</span>&nbsp;<span class="op" id="6961242">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6961247">t</span><span class="op" id="6961248">.</span><span class="ident" id="6961249">Errorf</span><span class="op" id="6961255">(</span><span class="string" id="6961256">&#34;ResolveReference&nbsp;failed&nbsp;to&nbsp;resolve&nbsp;opaque&nbsp;URL:&nbsp;want&nbsp;%#v,&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="6961322">,</span>&nbsp;<span class="ident" id="6961324">url</span><span class="op" id="6961327">,</span>&nbsp;<span class="ident" id="6961329">opaque</span><span class="op" id="6961335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6961339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6961343">//&nbsp;Test&nbsp;the&nbsp;convenience&nbsp;wrapper&nbsp;with&nbsp;an&nbsp;opaque&nbsp;URL&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6961401">url</span><span class="op" id="6961404">,</span>&nbsp;<span class="ident" id="6961406">err</span>&nbsp;<span class="op" id="6961410">=</span>&nbsp;<span class="ident" id="6961412">base</span><span class="op" id="6961416">.</span><span class="ident" id="6961417">Parse</span><span class="op" id="6961422">(</span><span class="string" id="6961423">&#34;scheme:opaque&#34;</span><span class="op" id="6961438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6961442">if</span>&nbsp;<span class="ident" id="6961445">err</span>&nbsp;<span class="op" id="6961449">!=</span>&nbsp;<span class="builtintype" id="6961452">nil</span>&nbsp;<span class="op" id="6961456">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6961461">t</span><span class="op" id="6961462">.</span><span class="ident" id="6961463">Errorf</span><span class="op" id="6961469">(</span><span class="string" id="6961470">`URL(%q).Parse(&#34;scheme:opaque&#34;)&nbsp;failed:&nbsp;%v`</span><span class="op" id="6961513">,</span>&nbsp;<span class="ident" id="6961515">test</span><span class="op" id="6961519">.</span><span class="ident" id="6961520">base</span><span class="op" id="6961524">,</span>&nbsp;<span class="ident" id="6961526">err</span><span class="op" id="6961529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6961533">}</span>&nbsp;<span class="keyword" id="6961535">else</span>&nbsp;<span class="keyword" id="6961540">if</span>&nbsp;<span class="op" id="6961543">*</span><span class="ident" id="6961544">url</span>&nbsp;<span class="op" id="6961548">!=</span>&nbsp;<span class="op" id="6961551">*</span><span class="ident" id="6961552">opaque</span>&nbsp;<span class="op" id="6961559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6961564">t</span><span class="op" id="6961565">.</span><span class="ident" id="6961566">Errorf</span><span class="op" id="6961572">(</span><span class="string" id="6961573">&#34;Parse&nbsp;failed&nbsp;to&nbsp;resolve&nbsp;opaque&nbsp;URL:&nbsp;want&nbsp;%#v,&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="6961628">,</span>&nbsp;<span class="ident" id="6961630">url</span><span class="op" id="6961633">,</span>&nbsp;<span class="ident" id="6961635">opaque</span><span class="op" id="6961641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6961645">}</span>&nbsp;<span class="keyword" id="6961647">else</span>&nbsp;<span class="keyword" id="6961652">if</span>&nbsp;<span class="ident" id="6961655">base</span>&nbsp;<span class="op" id="6961660">==</span>&nbsp;<span class="ident" id="6961663">url</span>&nbsp;<span class="op" id="6961667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6961672">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned,&nbsp;again.</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6961725">t</span><span class="op" id="6961726">.</span><span class="ident" id="6961727">Errorf</span><span class="op" id="6961733">(</span><span class="string" id="6961734">&#34;Expected&nbsp;URL.Parse&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="6961782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6961786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6961789">}</span><br>
<span class="lineno"></span><span class="op" id="6961791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">750</span><span class="keyword" id="6961794">func</span>&nbsp;<span class="ident" id="6961799">TestQueryValues</span><span class="op" id="6961814">(</span><span class="ident" id="6961815">t</span>&nbsp;<span class="op" id="6961817">*</span><span class="ident" id="6961818">testing</span><span class="op" id="6961825">.</span><span class="ident" id="6961826">T</span><span class="op" id="6961827">)</span>&nbsp;<span class="op" id="6961829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6961832">u</span><span class="op" id="6961833">,</span>&nbsp;<span class="ident" id="6961835">_</span>&nbsp;<span class="op" id="6961837">:=</span>&nbsp;<span class="ident" id="6961840">Parse</span><span class="op" id="6961845">(</span><span class="string" id="6961846">&#34;http://x.com?foo=bar&amp;bar=1&amp;bar=2&#34;</span><span class="op" id="6961880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6961883">v</span>&nbsp;<span class="op" id="6961885">:=</span>&nbsp;<span class="ident" id="6961888">u</span><span class="op" id="6961889">.</span><span class="ident" id="6961890">Query</span><span class="op" id="6961895">(</span><span class="op" id="6961896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6961899">if</span>&nbsp;<span class="builtinfunc" id="6961902">len</span><span class="op" id="6961905">(</span><span class="ident" id="6961906">v</span><span class="op" id="6961907">)</span>&nbsp;<span class="op" id="6961909">!=</span>&nbsp;<span class="num" id="6961912">2</span>&nbsp;<span class="op" id="6961914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6961918">t</span><span class="op" id="6961919">.</span><span class="ident" id="6961920">Errorf</span><span class="op" id="6961926">(</span><span class="string" id="6961927">&#34;got&nbsp;%d&nbsp;keys&nbsp;in&nbsp;Query&nbsp;values,&nbsp;want&nbsp;2&#34;</span><span class="op" id="6961964">,</span>&nbsp;<span class="builtinfunc" id="6961966">len</span><span class="op" id="6961969">(</span><span class="ident" id="6961970">v</span><span class="op" id="6961971">)</span><span class="op" id="6961972">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6961975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6961978">if</span>&nbsp;<span class="ident" id="6961981">g</span><span class="op" id="6961982">,</span>&nbsp;<span class="ident" id="6961984">e</span>&nbsp;<span class="op" id="6961986">:=</span>&nbsp;<span class="ident" id="6961989">v</span><span class="op" id="6961990">.</span><span class="ident" id="6961991">Get</span><span class="op" id="6961994">(</span><span class="string" id="6961995">&#34;foo&#34;</span><span class="op" id="6962000">)</span><span class="op" id="6962001">,</span>&nbsp;<span class="string" id="6962003">&#34;bar&#34;</span><span class="op" id="6962008">;</span>&nbsp;<span class="ident" id="6962010">g</span>&nbsp;<span class="op" id="6962012">!=</span>&nbsp;<span class="ident" id="6962015">e</span>&nbsp;<span class="op" id="6962017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962021">t</span><span class="op" id="6962022">.</span><span class="ident" id="6962023">Errorf</span><span class="op" id="6962029">(</span><span class="string" id="6962030">&#34;Get(foo)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6962054">,</span>&nbsp;<span class="ident" id="6962056">g</span><span class="op" id="6962057">,</span>&nbsp;<span class="ident" id="6962059">e</span><span class="op" id="6962060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6962066">//&nbsp;Case&nbsp;sensitive:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6962086">if</span>&nbsp;<span class="ident" id="6962089">g</span><span class="op" id="6962090">,</span>&nbsp;<span class="ident" id="6962092">e</span>&nbsp;<span class="op" id="6962094">:=</span>&nbsp;<span class="ident" id="6962097">v</span><span class="op" id="6962098">.</span><span class="ident" id="6962099">Get</span><span class="op" id="6962102">(</span><span class="string" id="6962103">&#34;Foo&#34;</span><span class="op" id="6962108">)</span><span class="op" id="6962109">,</span>&nbsp;<span class="string" id="6962111">&#34;&#34;</span><span class="op" id="6962113">;</span>&nbsp;<span class="ident" id="6962115">g</span>&nbsp;<span class="op" id="6962117">!=</span>&nbsp;<span class="ident" id="6962120">e</span>&nbsp;<span class="op" id="6962122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962126">t</span><span class="op" id="6962127">.</span><span class="ident" id="6962128">Errorf</span><span class="op" id="6962134">(</span><span class="string" id="6962135">&#34;Get(Foo)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6962159">,</span>&nbsp;<span class="ident" id="6962161">g</span><span class="op" id="6962162">,</span>&nbsp;<span class="ident" id="6962164">e</span><span class="op" id="6962165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6962171">if</span>&nbsp;<span class="ident" id="6962174">g</span><span class="op" id="6962175">,</span>&nbsp;<span class="ident" id="6962177">e</span>&nbsp;<span class="op" id="6962179">:=</span>&nbsp;<span class="ident" id="6962182">v</span><span class="op" id="6962183">.</span><span class="ident" id="6962184">Get</span><span class="op" id="6962187">(</span><span class="string" id="6962188">&#34;bar&#34;</span><span class="op" id="6962193">)</span><span class="op" id="6962194">,</span>&nbsp;<span class="string" id="6962196">&#34;1&#34;</span><span class="op" id="6962199">;</span>&nbsp;<span class="ident" id="6962201">g</span>&nbsp;<span class="op" id="6962203">!=</span>&nbsp;<span class="ident" id="6962206">e</span>&nbsp;<span class="op" id="6962208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962212">t</span><span class="op" id="6962213">.</span><span class="ident" id="6962214">Errorf</span><span class="op" id="6962220">(</span><span class="string" id="6962221">&#34;Get(bar)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6962245">,</span>&nbsp;<span class="ident" id="6962247">g</span><span class="op" id="6962248">,</span>&nbsp;<span class="ident" id="6962250">e</span><span class="op" id="6962251">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6962257">if</span>&nbsp;<span class="ident" id="6962260">g</span><span class="op" id="6962261">,</span>&nbsp;<span class="ident" id="6962263">e</span>&nbsp;<span class="op" id="6962265">:=</span>&nbsp;<span class="ident" id="6962268">v</span><span class="op" id="6962269">.</span><span class="ident" id="6962270">Get</span><span class="op" id="6962273">(</span><span class="string" id="6962274">&#34;baz&#34;</span><span class="op" id="6962279">)</span><span class="op" id="6962280">,</span>&nbsp;<span class="string" id="6962282">&#34;&#34;</span><span class="op" id="6962284">;</span>&nbsp;<span class="ident" id="6962286">g</span>&nbsp;<span class="op" id="6962288">!=</span>&nbsp;<span class="ident" id="6962291">e</span>&nbsp;<span class="op" id="6962293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962297">t</span><span class="op" id="6962298">.</span><span class="ident" id="6962299">Errorf</span><span class="op" id="6962305">(</span><span class="string" id="6962306">&#34;Get(baz)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6962330">,</span>&nbsp;<span class="ident" id="6962332">g</span><span class="op" id="6962333">,</span>&nbsp;<span class="ident" id="6962335">e</span><span class="op" id="6962336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962342">v</span><span class="op" id="6962343">.</span><span class="ident" id="6962344">Del</span><span class="op" id="6962347">(</span><span class="string" id="6962348">&#34;bar&#34;</span><span class="op" id="6962353">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6962356">if</span>&nbsp;<span class="ident" id="6962359">g</span><span class="op" id="6962360">,</span>&nbsp;<span class="ident" id="6962362">e</span>&nbsp;<span class="op" id="6962364">:=</span>&nbsp;<span class="ident" id="6962367">v</span><span class="op" id="6962368">.</span><span class="ident" id="6962369">Get</span><span class="op" id="6962372">(</span><span class="string" id="6962373">&#34;bar&#34;</span><span class="op" id="6962378">)</span><span class="op" id="6962379">,</span>&nbsp;<span class="string" id="6962381">&#34;&#34;</span><span class="op" id="6962383">;</span>&nbsp;<span class="ident" id="6962385">g</span>&nbsp;<span class="op" id="6962387">!=</span>&nbsp;<span class="ident" id="6962390">e</span>&nbsp;<span class="op" id="6962392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962396">t</span><span class="op" id="6962397">.</span><span class="ident" id="6962398">Errorf</span><span class="op" id="6962404">(</span><span class="string" id="6962405">&#34;second&nbsp;Get(bar)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6962436">,</span>&nbsp;<span class="ident" id="6962438">g</span><span class="op" id="6962439">,</span>&nbsp;<span class="ident" id="6962441">e</span><span class="op" id="6962442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962445">}</span><br>
<span class="lineno"></span><span class="op" id="6962447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span><span class="keyword" id="6962450">type</span>&nbsp;<span class="ident" id="6962455">parseTest</span>&nbsp;<span class="keyword" id="6962465">struct</span>&nbsp;<span class="op" id="6962472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962475">query</span>&nbsp;<span class="builtintype" id="6962481">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962489">out</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6962495">Values</span><br>
<span class="lineno"></span><span class="op" id="6962502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span><span class="keyword" id="6962505">var</span>&nbsp;<span class="ident" id="6962509">parseTests</span>&nbsp;<span class="op" id="6962520">=</span>&nbsp;<span class="op" id="6962522">[</span><span class="op" id="6962523">]</span><span class="ident" id="6962524">parseTest</span><span class="op" id="6962533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962540">query</span><span class="op" id="6962545">:</span>&nbsp;<span class="string" id="6962547">&#34;a=1&amp;b=2&#34;</span><span class="op" id="6962556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962560">out</span><span class="op" id="6962563">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6962567">Values</span><span class="op" id="6962573">{</span><span class="string" id="6962574">&#34;a&#34;</span><span class="op" id="6962577">:</span>&nbsp;<span class="op" id="6962579">[</span><span class="op" id="6962580">]</span><span class="builtintype" id="6962581">string</span><span class="op" id="6962587">{</span><span class="string" id="6962588">&#34;1&#34;</span><span class="op" id="6962591">}</span><span class="op" id="6962592">,</span>&nbsp;<span class="string" id="6962594">&#34;b&#34;</span><span class="op" id="6962597">:</span>&nbsp;<span class="op" id="6962599">[</span><span class="op" id="6962600">]</span><span class="builtintype" id="6962601">string</span><span class="op" id="6962607">{</span><span class="string" id="6962608">&#34;2&#34;</span><span class="op" id="6962611">}</span><span class="op" id="6962612">}</span><span class="op" id="6962613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962616">}</span><span class="op" id="6962617">,</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962624">query</span><span class="op" id="6962629">:</span>&nbsp;<span class="string" id="6962631">&#34;a=1&amp;a=2&amp;a=banana&#34;</span><span class="op" id="6962649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962653">out</span><span class="op" id="6962656">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6962660">Values</span><span class="op" id="6962666">{</span><span class="string" id="6962667">&#34;a&#34;</span><span class="op" id="6962670">:</span>&nbsp;<span class="op" id="6962672">[</span><span class="op" id="6962673">]</span><span class="builtintype" id="6962674">string</span><span class="op" id="6962680">{</span><span class="string" id="6962681">&#34;1&#34;</span><span class="op" id="6962684">,</span>&nbsp;<span class="string" id="6962686">&#34;2&#34;</span><span class="op" id="6962689">,</span>&nbsp;<span class="string" id="6962691">&#34;banana&#34;</span><span class="op" id="6962699">}</span><span class="op" id="6962700">}</span><span class="op" id="6962701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962704">}</span><span class="op" id="6962705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962708">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962712">query</span><span class="op" id="6962717">:</span>&nbsp;<span class="string" id="6962719">&#34;ascii=%3Ckey%3A+0x90%3E&#34;</span><span class="op" id="6962744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962748">out</span><span class="op" id="6962751">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6962755">Values</span><span class="op" id="6962761">{</span><span class="string" id="6962762">&#34;ascii&#34;</span><span class="op" id="6962769">:</span>&nbsp;<span class="op" id="6962771">[</span><span class="op" id="6962772">]</span><span class="builtintype" id="6962773">string</span><span class="op" id="6962779">{</span><span class="string" id="6962780">&#34;&lt;key:&nbsp;0x90&gt;&#34;</span><span class="op" id="6962793">}</span><span class="op" id="6962794">}</span><span class="op" id="6962795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962798">}</span><span class="op" id="6962799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962806">query</span><span class="op" id="6962811">:</span>&nbsp;<span class="string" id="6962813">&#34;a=1;b=2&#34;</span><span class="op" id="6962822">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962826">out</span><span class="op" id="6962829">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6962833">Values</span><span class="op" id="6962839">{</span><span class="string" id="6962840">&#34;a&#34;</span><span class="op" id="6962843">:</span>&nbsp;<span class="op" id="6962845">[</span><span class="op" id="6962846">]</span><span class="builtintype" id="6962847">string</span><span class="op" id="6962853">{</span><span class="string" id="6962854">&#34;1&#34;</span><span class="op" id="6962857">}</span><span class="op" id="6962858">,</span>&nbsp;<span class="string" id="6962860">&#34;b&#34;</span><span class="op" id="6962863">:</span>&nbsp;<span class="op" id="6962865">[</span><span class="op" id="6962866">]</span><span class="builtintype" id="6962867">string</span><span class="op" id="6962873">{</span><span class="string" id="6962874">&#34;2&#34;</span><span class="op" id="6962877">}</span><span class="op" id="6962878">}</span><span class="op" id="6962879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962882">}</span><span class="op" id="6962883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962890">query</span><span class="op" id="6962895">:</span>&nbsp;<span class="string" id="6962897">&#34;a=1&amp;a=2;a=banana&#34;</span><span class="op" id="6962915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6962919">out</span><span class="op" id="6962922">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6962926">Values</span><span class="op" id="6962932">{</span><span class="string" id="6962933">&#34;a&#34;</span><span class="op" id="6962936">:</span>&nbsp;<span class="op" id="6962938">[</span><span class="op" id="6962939">]</span><span class="builtintype" id="6962940">string</span><span class="op" id="6962946">{</span><span class="string" id="6962947">&#34;1&#34;</span><span class="op" id="6962950">,</span>&nbsp;<span class="string" id="6962952">&#34;2&#34;</span><span class="op" id="6962955">,</span>&nbsp;<span class="string" id="6962957">&#34;banana&#34;</span><span class="op" id="6962965">}</span><span class="op" id="6962966">}</span><span class="op" id="6962967">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6962970">}</span><span class="op" id="6962971">,</span><br>
<span class="lineno"></span><span class="op" id="6962973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6962976">func</span>&nbsp;<span class="ident" id="6962981">TestParseQuery</span><span class="op" id="6962995">(</span><span class="ident" id="6962996">t</span>&nbsp;<span class="op" id="6962998">*</span><span class="ident" id="6962999">testing</span><span class="op" id="6963006">.</span><span class="ident" id="6963007">T</span><span class="op" id="6963008">)</span>&nbsp;<span class="op" id="6963010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6963013">for</span>&nbsp;<span class="ident" id="6963017">i</span><span class="op" id="6963018">,</span>&nbsp;<span class="ident" id="6963020">test</span>&nbsp;<span class="op" id="6963025">:=</span>&nbsp;<span class="keyword" id="6963028">range</span>&nbsp;<span class="ident" id="6963034">parseTests</span>&nbsp;<span class="op" id="6963045">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963049">form</span><span class="op" id="6963053">,</span>&nbsp;<span class="ident" id="6963055">err</span>&nbsp;<span class="op" id="6963059">:=</span>&nbsp;<span class="ident" id="6963062">ParseQuery</span><span class="op" id="6963072">(</span><span class="ident" id="6963073">test</span><span class="op" id="6963077">.</span><span class="ident" id="6963078">query</span><span class="op" id="6963083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6963087">if</span>&nbsp;<span class="ident" id="6963090">err</span>&nbsp;<span class="op" id="6963094">!=</span>&nbsp;<span class="builtintype" id="6963097">nil</span>&nbsp;<span class="op" id="6963101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963106">t</span><span class="op" id="6963107">.</span><span class="ident" id="6963108">Errorf</span><span class="op" id="6963114">(</span><span class="string" id="6963115">&#34;test&nbsp;%d:&nbsp;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6963146">,</span>&nbsp;<span class="ident" id="6963148">i</span><span class="op" id="6963149">,</span>&nbsp;<span class="ident" id="6963151">err</span><span class="op" id="6963154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6963159">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963170">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6963174">if</span>&nbsp;<span class="builtinfunc" id="6963177">len</span><span class="op" id="6963180">(</span><span class="ident" id="6963181">form</span><span class="op" id="6963185">)</span>&nbsp;<span class="op" id="6963187">!=</span>&nbsp;<span class="builtinfunc" id="6963190">len</span><span class="op" id="6963193">(</span><span class="ident" id="6963194">test</span><span class="op" id="6963198">.</span><span class="ident" id="6963199">out</span><span class="op" id="6963202">)</span>&nbsp;<span class="op" id="6963204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963209">t</span><span class="op" id="6963210">.</span><span class="ident" id="6963211">Errorf</span><span class="op" id="6963217">(</span><span class="string" id="6963218">&#34;test&nbsp;%d:&nbsp;len(form)&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6963252">,</span>&nbsp;<span class="ident" id="6963254">i</span><span class="op" id="6963255">,</span>&nbsp;<span class="builtinfunc" id="6963257">len</span><span class="op" id="6963260">(</span><span class="ident" id="6963261">form</span><span class="op" id="6963265">)</span><span class="op" id="6963266">,</span>&nbsp;<span class="builtinfunc" id="6963268">len</span><span class="op" id="6963271">(</span><span class="ident" id="6963272">test</span><span class="op" id="6963276">.</span><span class="ident" id="6963277">out</span><span class="op" id="6963280">)</span><span class="op" id="6963281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6963289">for</span>&nbsp;<span class="ident" id="6963293">k</span><span class="op" id="6963294">,</span>&nbsp;<span class="ident" id="6963296">evs</span>&nbsp;<span class="op" id="6963300">:=</span>&nbsp;<span class="keyword" id="6963303">range</span>&nbsp;<span class="ident" id="6963309">test</span><span class="op" id="6963313">.</span><span class="ident" id="6963314">out</span>&nbsp;<span class="op" id="6963318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963323">vs</span><span class="op" id="6963325">,</span>&nbsp;<span class="ident" id="6963327">ok</span>&nbsp;<span class="op" id="6963330">:=</span>&nbsp;<span class="ident" id="6963333">form</span><span class="op" id="6963337">[</span><span class="ident" id="6963338">k</span><span class="op" id="6963339">]</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6963344">if</span>&nbsp;<span class="op" id="6963347">!</span><span class="ident" id="6963348">ok</span>&nbsp;<span class="op" id="6963351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963357">t</span><span class="op" id="6963358">.</span><span class="ident" id="6963359">Errorf</span><span class="op" id="6963365">(</span><span class="string" id="6963366">&#34;test&nbsp;%d:&nbsp;Missing&nbsp;key&nbsp;%q&#34;</span><span class="op" id="6963391">,</span>&nbsp;<span class="ident" id="6963393">i</span><span class="op" id="6963394">,</span>&nbsp;<span class="ident" id="6963396">k</span><span class="op" id="6963397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6963403">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6963420">if</span>&nbsp;<span class="builtinfunc" id="6963423">len</span><span class="op" id="6963426">(</span><span class="ident" id="6963427">vs</span><span class="op" id="6963429">)</span>&nbsp;<span class="op" id="6963431">!=</span>&nbsp;<span class="builtinfunc" id="6963434">len</span><span class="op" id="6963437">(</span><span class="ident" id="6963438">evs</span><span class="op" id="6963441">)</span>&nbsp;<span class="op" id="6963443">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963449">t</span><span class="op" id="6963450">.</span><span class="ident" id="6963451">Errorf</span><span class="op" id="6963457">(</span><span class="string" id="6963458">&#34;test&nbsp;%d:&nbsp;len(form[%q])&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6963496">,</span>&nbsp;<span class="ident" id="6963498">i</span><span class="op" id="6963499">,</span>&nbsp;<span class="ident" id="6963501">k</span><span class="op" id="6963502">,</span>&nbsp;<span class="builtinfunc" id="6963504">len</span><span class="op" id="6963507">(</span><span class="ident" id="6963508">vs</span><span class="op" id="6963510">)</span><span class="op" id="6963511">,</span>&nbsp;<span class="builtinfunc" id="6963513">len</span><span class="op" id="6963516">(</span><span class="ident" id="6963517">evs</span><span class="op" id="6963520">)</span><span class="op" id="6963521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6963527">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6963544">for</span>&nbsp;<span class="ident" id="6963548">j</span><span class="op" id="6963549">,</span>&nbsp;<span class="ident" id="6963551">ev</span>&nbsp;<span class="op" id="6963554">:=</span>&nbsp;<span class="keyword" id="6963557">range</span>&nbsp;<span class="ident" id="6963563">evs</span>&nbsp;<span class="op" id="6963567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6963573">if</span>&nbsp;<span class="ident" id="6963576">v</span>&nbsp;<span class="op" id="6963578">:=</span>&nbsp;<span class="ident" id="6963581">vs</span><span class="op" id="6963583">[</span><span class="ident" id="6963584">j</span><span class="op" id="6963585">]</span><span class="op" id="6963586">;</span>&nbsp;<span class="ident" id="6963588">v</span>&nbsp;<span class="op" id="6963590">!=</span>&nbsp;<span class="ident" id="6963593">ev</span>&nbsp;<span class="op" id="6963596">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963603">t</span><span class="op" id="6963604">.</span><span class="ident" id="6963605">Errorf</span><span class="op" id="6963611">(</span><span class="string" id="6963612">&#34;test&nbsp;%d:&nbsp;form[%q][%d]&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6963649">,</span>&nbsp;<span class="ident" id="6963651">i</span><span class="op" id="6963652">,</span>&nbsp;<span class="ident" id="6963654">k</span><span class="op" id="6963655">,</span>&nbsp;<span class="ident" id="6963657">j</span><span class="op" id="6963658">,</span>&nbsp;<span class="ident" id="6963660">v</span><span class="op" id="6963661">,</span>&nbsp;<span class="ident" id="6963663">ev</span><span class="op" id="6963665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963683">}</span><br>
<span class="lineno">830</span><span class="op" id="6963685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6963688">type</span>&nbsp;<span class="ident" id="6963693">RequestURITest</span>&nbsp;<span class="keyword" id="6963708">struct</span>&nbsp;<span class="op" id="6963715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963718">url</span>&nbsp;<span class="op" id="6963722">*</span><span class="ident" id="6963723">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963728">out</span>&nbsp;<span class="builtintype" id="6963732">string</span><br>
<span class="lineno">835</span><span class="op" id="6963739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6963742">var</span>&nbsp;<span class="ident" id="6963746">requritests</span>&nbsp;<span class="op" id="6963758">=</span>&nbsp;<span class="op" id="6963760">[</span><span class="op" id="6963761">]</span><span class="ident" id="6963762">RequestURITest</span><span class="op" id="6963776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963783">&amp;</span><span class="ident" id="6963784">URL</span><span class="op" id="6963787">{</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963792">Scheme</span><span class="op" id="6963798">:</span>&nbsp;<span class="string" id="6963800">&#34;http&#34;</span><span class="op" id="6963806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963811">Host</span><span class="op" id="6963815">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6963819">&#34;example.com&#34;</span><span class="op" id="6963832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963837">Path</span><span class="op" id="6963841">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6963845">&#34;&#34;</span><span class="op" id="6963847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963851">}</span><span class="op" id="6963852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6963856">&#34;/&#34;</span><span class="op" id="6963859">,</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963862">}</span><span class="op" id="6963863">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963870">&amp;</span><span class="ident" id="6963871">URL</span><span class="op" id="6963874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963879">Scheme</span><span class="op" id="6963885">:</span>&nbsp;<span class="string" id="6963887">&#34;http&#34;</span><span class="op" id="6963893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963898">Host</span><span class="op" id="6963902">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6963906">&#34;example.com&#34;</span><span class="op" id="6963919">,</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6963924">Path</span><span class="op" id="6963928">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6963932">&#34;/a&nbsp;b&#34;</span><span class="op" id="6963938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963942">}</span><span class="op" id="6963943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6963947">&#34;/a%20b&#34;</span><span class="op" id="6963955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963958">}</span><span class="op" id="6963959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6963962">//&nbsp;golang.org/issue/4860&nbsp;variant&nbsp;1</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6963998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964002">&amp;</span><span class="ident" id="6964003">URL</span><span class="op" id="6964006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964011">Scheme</span><span class="op" id="6964017">:</span>&nbsp;<span class="string" id="6964019">&#34;http&#34;</span><span class="op" id="6964025">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964030">Host</span><span class="op" id="6964034">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6964038">&#34;example.com&#34;</span><span class="op" id="6964051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964056">Opaque</span><span class="op" id="6964062">:</span>&nbsp;<span class="string" id="6964064">&#34;/%2F/%2F/&#34;</span><span class="op" id="6964075">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964079">}</span><span class="op" id="6964080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6964084">&#34;/%2F/%2F/&#34;</span><span class="op" id="6964095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964098">}</span><span class="op" id="6964099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6964102">//&nbsp;golang.org/issue/4860&nbsp;variant&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964138">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964142">&amp;</span><span class="ident" id="6964143">URL</span><span class="op" id="6964146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964151">Scheme</span><span class="op" id="6964157">:</span>&nbsp;<span class="string" id="6964159">&#34;http&#34;</span><span class="op" id="6964165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964170">Host</span><span class="op" id="6964174">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6964178">&#34;example.com&#34;</span><span class="op" id="6964191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964196">Opaque</span><span class="op" id="6964202">:</span>&nbsp;<span class="string" id="6964204">&#34;//other.example.com/%2F/%2F/&#34;</span><span class="op" id="6964234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964238">}</span><span class="op" id="6964239">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6964243">&#34;http://other.example.com/%2F/%2F/&#34;</span><span class="op" id="6964278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964281">}</span><span class="op" id="6964282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964289">&amp;</span><span class="ident" id="6964290">URL</span><span class="op" id="6964293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964298">Scheme</span><span class="op" id="6964304">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6964308">&#34;http&#34;</span><span class="op" id="6964314">,</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964319">Host</span><span class="op" id="6964323">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6964329">&#34;example.com&#34;</span><span class="op" id="6964342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964347">Path</span><span class="op" id="6964351">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6964357">&#34;/a&nbsp;b&#34;</span><span class="op" id="6964363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964368">RawQuery</span><span class="op" id="6964376">:</span>&nbsp;<span class="string" id="6964378">&#34;q=go+language&#34;</span><span class="op" id="6964393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964397">}</span><span class="op" id="6964398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6964402">&#34;/a%20b?q=go+language&#34;</span><span class="op" id="6964424">,</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964427">}</span><span class="op" id="6964428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964435">&amp;</span><span class="ident" id="6964436">URL</span><span class="op" id="6964439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964444">Scheme</span><span class="op" id="6964450">:</span>&nbsp;<span class="string" id="6964452">&#34;myschema&#34;</span><span class="op" id="6964462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964467">Opaque</span><span class="op" id="6964473">:</span>&nbsp;<span class="string" id="6964475">&#34;opaque&#34;</span><span class="op" id="6964483">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964487">}</span><span class="op" id="6964488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6964492">&#34;opaque&#34;</span><span class="op" id="6964500">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964503">}</span><span class="op" id="6964504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964511">&amp;</span><span class="ident" id="6964512">URL</span><span class="op" id="6964515">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964520">Scheme</span><span class="op" id="6964526">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6964530">&#34;myschema&#34;</span><span class="op" id="6964540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964545">Opaque</span><span class="op" id="6964551">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6964555">&#34;opaque&#34;</span><span class="op" id="6964563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964568">RawQuery</span><span class="op" id="6964576">:</span>&nbsp;<span class="string" id="6964578">&#34;q=go+language&#34;</span><span class="op" id="6964593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964597">}</span><span class="op" id="6964598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6964602">&#34;opaque?q=go+language&#34;</span><span class="op" id="6964624">,</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964627">}</span><span class="op" id="6964628">,</span><br>
<span class="lineno"></span><span class="op" id="6964630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6964633">func</span>&nbsp;<span class="ident" id="6964638">TestRequestURI</span><span class="op" id="6964652">(</span><span class="ident" id="6964653">t</span>&nbsp;<span class="op" id="6964655">*</span><span class="ident" id="6964656">testing</span><span class="op" id="6964663">.</span><span class="ident" id="6964664">T</span><span class="op" id="6964665">)</span>&nbsp;<span class="op" id="6964667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6964670">for</span>&nbsp;<span class="ident" id="6964674">_</span><span class="op" id="6964675">,</span>&nbsp;<span class="ident" id="6964677">tt</span>&nbsp;<span class="op" id="6964680">:=</span>&nbsp;<span class="keyword" id="6964683">range</span>&nbsp;<span class="ident" id="6964689">requritests</span>&nbsp;<span class="op" id="6964701">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964705">s</span>&nbsp;<span class="op" id="6964707">:=</span>&nbsp;<span class="ident" id="6964710">tt</span><span class="op" id="6964712">.</span><span class="ident" id="6964713">url</span><span class="op" id="6964716">.</span><span class="ident" id="6964717">RequestURI</span><span class="op" id="6964727">(</span><span class="op" id="6964728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6964732">if</span>&nbsp;<span class="ident" id="6964735">s</span>&nbsp;<span class="op" id="6964737">!=</span>&nbsp;<span class="ident" id="6964740">tt</span><span class="op" id="6964742">.</span><span class="ident" id="6964743">out</span>&nbsp;<span class="op" id="6964747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964752">t</span><span class="op" id="6964753">.</span><span class="ident" id="6964754">Errorf</span><span class="op" id="6964760">(</span><span class="string" id="6964761">&#34;%#v.RequestURI()&nbsp;==&nbsp;%q&nbsp;(expected&nbsp;%q)&#34;</span><span class="op" id="6964799">,</span>&nbsp;<span class="ident" id="6964801">tt</span><span class="op" id="6964803">.</span><span class="ident" id="6964804">url</span><span class="op" id="6964807">,</span>&nbsp;<span class="ident" id="6964809">s</span><span class="op" id="6964810">,</span>&nbsp;<span class="ident" id="6964812">tt</span><span class="op" id="6964814">.</span><span class="ident" id="6964815">out</span><span class="op" id="6964818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6964825">}</span><br>
<span class="lineno">905</span><span class="op" id="6964827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6964830">func</span>&nbsp;<span class="ident" id="6964835">TestParseFailure</span><span class="op" id="6964851">(</span><span class="ident" id="6964852">t</span>&nbsp;<span class="op" id="6964854">*</span><span class="ident" id="6964855">testing</span><span class="op" id="6964862">.</span><span class="ident" id="6964863">T</span><span class="op" id="6964864">)</span>&nbsp;<span class="op" id="6964866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6964869">//&nbsp;Test&nbsp;that&nbsp;the&nbsp;first&nbsp;parse&nbsp;error&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6964918">const</span>&nbsp;<span class="ident" id="6964924">url</span>&nbsp;<span class="op" id="6964928">=</span>&nbsp;<span class="string" id="6964930">&#34;%gh&amp;%ij&#34;</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964941">_</span><span class="op" id="6964942">,</span>&nbsp;<span class="ident" id="6964944">err</span>&nbsp;<span class="op" id="6964948">:=</span>&nbsp;<span class="ident" id="6964951">ParseQuery</span><span class="op" id="6964961">(</span><span class="ident" id="6964962">url</span><span class="op" id="6964965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6964968">errStr</span>&nbsp;<span class="op" id="6964975">:=</span>&nbsp;<span class="ident" id="6964978">fmt</span><span class="op" id="6964981">.</span><span class="ident" id="6964982">Sprint</span><span class="op" id="6964988">(</span><span class="ident" id="6964989">err</span><span class="op" id="6964992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6964995">if</span>&nbsp;<span class="op" id="6964998">!</span><span class="ident" id="6964999">strings</span><span class="op" id="6965006">.</span><span class="ident" id="6965007">Contains</span><span class="op" id="6965015">(</span><span class="ident" id="6965016">errStr</span><span class="op" id="6965022">,</span>&nbsp;<span class="string" id="6965024">&#34;%gh&#34;</span><span class="op" id="6965029">)</span>&nbsp;<span class="op" id="6965031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6965035">t</span><span class="op" id="6965036">.</span><span class="ident" id="6965037">Errorf</span><span class="op" id="6965043">(</span><span class="string" id="6965044">`ParseQuery(%q)&nbsp;returned&nbsp;error&nbsp;%q,&nbsp;want&nbsp;something&nbsp;containing&nbsp;%q&#34;`</span><span class="op" id="6965109">,</span>&nbsp;<span class="ident" id="6965111">url</span><span class="op" id="6965114">,</span>&nbsp;<span class="ident" id="6965116">errStr</span><span class="op" id="6965122">,</span>&nbsp;<span class="string" id="6965124">&#34;%gh&#34;</span><span class="op" id="6965129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965132">}</span><br>
<span class="lineno">915</span><span class="op" id="6965134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6965137">type</span>&nbsp;<span class="ident" id="6965142">shouldEscapeTest</span>&nbsp;<span class="keyword" id="6965159">struct</span>&nbsp;<span class="op" id="6965166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6965169">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6965176">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6965182">mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6965189">encoding</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6965199">escape</span>&nbsp;<span class="builtintype" id="6965206">bool</span><br>
<span class="lineno"></span><span class="op" id="6965211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6965214">var</span>&nbsp;<span class="ident" id="6965218">shouldEscapeTests</span>&nbsp;<span class="op" id="6965236">=</span>&nbsp;<span class="op" id="6965238">[</span><span class="op" id="6965239">]</span><span class="ident" id="6965240">shouldEscapeTest</span><span class="op" id="6965256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6965259">//&nbsp;Unreserved&nbsp;characters&nbsp;(§2.3)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965293">{</span><span class="string" id="6965294">&#39;a&#39;</span><span class="op" id="6965297">,</span>&nbsp;<span class="ident" id="6965299">encodePath</span><span class="op" id="6965309">,</span>&nbsp;<span class="builtintype" id="6965311">false</span><span class="op" id="6965316">}</span><span class="op" id="6965317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965320">{</span><span class="string" id="6965321">&#39;a&#39;</span><span class="op" id="6965324">,</span>&nbsp;<span class="ident" id="6965326">encodeUserPassword</span><span class="op" id="6965344">,</span>&nbsp;<span class="builtintype" id="6965346">false</span><span class="op" id="6965351">}</span><span class="op" id="6965352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965355">{</span><span class="string" id="6965356">&#39;a&#39;</span><span class="op" id="6965359">,</span>&nbsp;<span class="ident" id="6965361">encodeQueryComponent</span><span class="op" id="6965381">,</span>&nbsp;<span class="builtintype" id="6965383">false</span><span class="op" id="6965388">}</span><span class="op" id="6965389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965392">{</span><span class="string" id="6965393">&#39;a&#39;</span><span class="op" id="6965396">,</span>&nbsp;<span class="ident" id="6965398">encodeFragment</span><span class="op" id="6965412">,</span>&nbsp;<span class="builtintype" id="6965414">false</span><span class="op" id="6965419">}</span><span class="op" id="6965420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965423">{</span><span class="string" id="6965424">&#39;z&#39;</span><span class="op" id="6965427">,</span>&nbsp;<span class="ident" id="6965429">encodePath</span><span class="op" id="6965439">,</span>&nbsp;<span class="builtintype" id="6965441">false</span><span class="op" id="6965446">}</span><span class="op" id="6965447">,</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965450">{</span><span class="string" id="6965451">&#39;A&#39;</span><span class="op" id="6965454">,</span>&nbsp;<span class="ident" id="6965456">encodePath</span><span class="op" id="6965466">,</span>&nbsp;<span class="builtintype" id="6965468">false</span><span class="op" id="6965473">}</span><span class="op" id="6965474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965477">{</span><span class="string" id="6965478">&#39;Z&#39;</span><span class="op" id="6965481">,</span>&nbsp;<span class="ident" id="6965483">encodePath</span><span class="op" id="6965493">,</span>&nbsp;<span class="builtintype" id="6965495">false</span><span class="op" id="6965500">}</span><span class="op" id="6965501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965504">{</span><span class="string" id="6965505">&#39;0&#39;</span><span class="op" id="6965508">,</span>&nbsp;<span class="ident" id="6965510">encodePath</span><span class="op" id="6965520">,</span>&nbsp;<span class="builtintype" id="6965522">false</span><span class="op" id="6965527">}</span><span class="op" id="6965528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965531">{</span><span class="string" id="6965532">&#39;9&#39;</span><span class="op" id="6965535">,</span>&nbsp;<span class="ident" id="6965537">encodePath</span><span class="op" id="6965547">,</span>&nbsp;<span class="builtintype" id="6965549">false</span><span class="op" id="6965554">}</span><span class="op" id="6965555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965558">{</span><span class="string" id="6965559">&#39;-&#39;</span><span class="op" id="6965562">,</span>&nbsp;<span class="ident" id="6965564">encodePath</span><span class="op" id="6965574">,</span>&nbsp;<span class="builtintype" id="6965576">false</span><span class="op" id="6965581">}</span><span class="op" id="6965582">,</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965585">{</span><span class="string" id="6965586">&#39;-&#39;</span><span class="op" id="6965589">,</span>&nbsp;<span class="ident" id="6965591">encodeUserPassword</span><span class="op" id="6965609">,</span>&nbsp;<span class="builtintype" id="6965611">false</span><span class="op" id="6965616">}</span><span class="op" id="6965617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965620">{</span><span class="string" id="6965621">&#39;-&#39;</span><span class="op" id="6965624">,</span>&nbsp;<span class="ident" id="6965626">encodeQueryComponent</span><span class="op" id="6965646">,</span>&nbsp;<span class="builtintype" id="6965648">false</span><span class="op" id="6965653">}</span><span class="op" id="6965654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965657">{</span><span class="string" id="6965658">&#39;-&#39;</span><span class="op" id="6965661">,</span>&nbsp;<span class="ident" id="6965663">encodeFragment</span><span class="op" id="6965677">,</span>&nbsp;<span class="builtintype" id="6965679">false</span><span class="op" id="6965684">}</span><span class="op" id="6965685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965688">{</span><span class="string" id="6965689">&#39;.&#39;</span><span class="op" id="6965692">,</span>&nbsp;<span class="ident" id="6965694">encodePath</span><span class="op" id="6965704">,</span>&nbsp;<span class="builtintype" id="6965706">false</span><span class="op" id="6965711">}</span><span class="op" id="6965712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965715">{</span><span class="string" id="6965716">&#39;_&#39;</span><span class="op" id="6965719">,</span>&nbsp;<span class="ident" id="6965721">encodePath</span><span class="op" id="6965731">,</span>&nbsp;<span class="builtintype" id="6965733">false</span><span class="op" id="6965738">}</span><span class="op" id="6965739">,</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965742">{</span><span class="string" id="6965743">&#39;~&#39;</span><span class="op" id="6965746">,</span>&nbsp;<span class="ident" id="6965748">encodePath</span><span class="op" id="6965758">,</span>&nbsp;<span class="builtintype" id="6965760">false</span><span class="op" id="6965765">}</span><span class="op" id="6965766">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6965770">//&nbsp;User&nbsp;information&nbsp;(§3.2.1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965801">{</span><span class="string" id="6965802">&#39;:&#39;</span><span class="op" id="6965805">,</span>&nbsp;<span class="ident" id="6965807">encodeUserPassword</span><span class="op" id="6965825">,</span>&nbsp;<span class="builtintype" id="6965827">true</span><span class="op" id="6965831">}</span><span class="op" id="6965832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965835">{</span><span class="string" id="6965836">&#39;/&#39;</span><span class="op" id="6965839">,</span>&nbsp;<span class="ident" id="6965841">encodeUserPassword</span><span class="op" id="6965859">,</span>&nbsp;<span class="builtintype" id="6965861">true</span><span class="op" id="6965865">}</span><span class="op" id="6965866">,</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965869">{</span><span class="string" id="6965870">&#39;?&#39;</span><span class="op" id="6965873">,</span>&nbsp;<span class="ident" id="6965875">encodeUserPassword</span><span class="op" id="6965893">,</span>&nbsp;<span class="builtintype" id="6965895">true</span><span class="op" id="6965899">}</span><span class="op" id="6965900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965903">{</span><span class="string" id="6965904">&#39;@&#39;</span><span class="op" id="6965907">,</span>&nbsp;<span class="ident" id="6965909">encodeUserPassword</span><span class="op" id="6965927">,</span>&nbsp;<span class="builtintype" id="6965929">true</span><span class="op" id="6965933">}</span><span class="op" id="6965934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965937">{</span><span class="string" id="6965938">&#39;$&#39;</span><span class="op" id="6965941">,</span>&nbsp;<span class="ident" id="6965943">encodeUserPassword</span><span class="op" id="6965961">,</span>&nbsp;<span class="builtintype" id="6965963">false</span><span class="op" id="6965968">}</span><span class="op" id="6965969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6965972">{</span><span class="string" id="6965973">&#39;&amp;&#39;</span><span class="op" id="6965976">,</span>&nbsp;<span class="ident" id="6965978">encodeUserPassword</span><span class="op" id="6965996">,</span>&nbsp;<span class="builtintype" id="6965998">false</span><span class="op" id="6966003">}</span><span class="op" id="6966004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6966007">{</span><span class="string" id="6966008">&#39;+&#39;</span><span class="op" id="6966011">,</span>&nbsp;<span class="ident" id="6966013">encodeUserPassword</span><span class="op" id="6966031">,</span>&nbsp;<span class="builtintype" id="6966033">false</span><span class="op" id="6966038">}</span><span class="op" id="6966039">,</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6966042">{</span><span class="string" id="6966043">&#39;,&#39;</span><span class="op" id="6966046">,</span>&nbsp;<span class="ident" id="6966048">encodeUserPassword</span><span class="op" id="6966066">,</span>&nbsp;<span class="builtintype" id="6966068">false</span><span class="op" id="6966073">}</span><span class="op" id="6966074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6966077">{</span><span class="string" id="6966078">&#39;;&#39;</span><span class="op" id="6966081">,</span>&nbsp;<span class="ident" id="6966083">encodeUserPassword</span><span class="op" id="6966101">,</span>&nbsp;<span class="builtintype" id="6966103">false</span><span class="op" id="6966108">}</span><span class="op" id="6966109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6966112">{</span><span class="string" id="6966113">&#39;=&#39;</span><span class="op" id="6966116">,</span>&nbsp;<span class="ident" id="6966118">encodeUserPassword</span><span class="op" id="6966136">,</span>&nbsp;<span class="builtintype" id="6966138">false</span><span class="op" id="6966143">}</span><span class="op" id="6966144">,</span><br>
<span class="lineno"></span><span class="op" id="6966146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">955</span><span class="keyword" id="6966149">func</span>&nbsp;<span class="ident" id="6966154">TestShouldEscape</span><span class="op" id="6966170">(</span><span class="ident" id="6966171">t</span>&nbsp;<span class="op" id="6966173">*</span><span class="ident" id="6966174">testing</span><span class="op" id="6966181">.</span><span class="ident" id="6966182">T</span><span class="op" id="6966183">)</span>&nbsp;<span class="op" id="6966185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6966188">for</span>&nbsp;<span class="ident" id="6966192">_</span><span class="op" id="6966193">,</span>&nbsp;<span class="ident" id="6966195">tt</span>&nbsp;<span class="op" id="6966198">:=</span>&nbsp;<span class="keyword" id="6966201">range</span>&nbsp;<span class="ident" id="6966207">shouldEscapeTests</span>&nbsp;<span class="op" id="6966225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6966229">if</span>&nbsp;<span class="ident" id="6966232">shouldEscape</span><span class="op" id="6966244">(</span><span class="ident" id="6966245">tt</span><span class="op" id="6966247">.</span><span class="ident" id="6966248">in</span><span class="op" id="6966250">,</span>&nbsp;<span class="ident" id="6966252">tt</span><span class="op" id="6966254">.</span><span class="ident" id="6966255">mode</span><span class="op" id="6966259">)</span>&nbsp;<span class="op" id="6966261">!=</span>&nbsp;<span class="ident" id="6966264">tt</span><span class="op" id="6966266">.</span><span class="ident" id="6966267">escape</span>&nbsp;<span class="op" id="6966274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6966279">t</span><span class="op" id="6966280">.</span><span class="ident" id="6966281">Errorf</span><span class="op" id="6966287">(</span><span class="string" id="6966288">&#34;shouldEscape(%q,&nbsp;%v)&nbsp;returned&nbsp;%v;&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6966335">,</span>&nbsp;<span class="ident" id="6966337">tt</span><span class="op" id="6966339">.</span><span class="ident" id="6966340">in</span><span class="op" id="6966342">,</span>&nbsp;<span class="ident" id="6966344">tt</span><span class="op" id="6966346">.</span><span class="ident" id="6966347">mode</span><span class="op" id="6966351">,</span>&nbsp;<span class="op" id="6966353">!</span><span class="ident" id="6966354">tt</span><span class="op" id="6966356">.</span><span class="ident" id="6966357">escape</span><span class="op" id="6966363">,</span>&nbsp;<span class="ident" id="6966365">tt</span><span class="op" id="6966367">.</span><span class="ident" id="6966368">escape</span><span class="op" id="6966374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6966378">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6966381">}</span><br>
<span class="lineno"></span><span class="op" id="6966383">}</span>
</div>
</body>
</html>
