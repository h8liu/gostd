<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2077680">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2077735">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2077789">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2077840">package</span>&nbsp;<span class="ident" id="2077848">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2077854">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;comment&nbsp;below&nbsp;are&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="2077908">//&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_remainder.c&nbsp;and&nbsp;came</span><br>
<span class="lineno"></span><span class="comment" id="2077966">//&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of</span><br>
<span class="lineno">10</span><span class="comment" id="2078027">//&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="2078046">//</span><br>
<span class="lineno"></span><span class="comment" id="2078049">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2078105">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2078174">//</span><br>
<span class="lineno">15</span><span class="comment" id="2078177">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno"></span><span class="comment" id="2078236">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2078292">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2078349">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2078366">//&nbsp;====================================================</span><br>
<span class="lineno">20</span><span class="comment" id="2078422">//</span><br>
<span class="lineno"></span><span class="comment" id="2078425">//&nbsp;__ieee754_remainder(x,y)</span><br>
<span class="lineno"></span><span class="comment" id="2078453">//&nbsp;Return&nbsp;:</span><br>
<span class="lineno"></span><span class="comment" id="2078465">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returns&nbsp;&nbsp;x&nbsp;REM&nbsp;y&nbsp;&nbsp;=&nbsp;&nbsp;x&nbsp;-&nbsp;[x/y]*y&nbsp;&nbsp;as&nbsp;if&nbsp;in&nbsp;infinite</span><br>
<span class="lineno"></span><span class="comment" id="2078525">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;precision&nbsp;arithmetic,&nbsp;where&nbsp;[x/y]&nbsp;is&nbsp;the&nbsp;(infinite&nbsp;bit)</span><br>
<span class="lineno">25</span><span class="comment" id="2078589">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integer&nbsp;nearest&nbsp;x/y&nbsp;(in&nbsp;half&nbsp;way&nbsp;cases,&nbsp;choose&nbsp;the&nbsp;even&nbsp;one).</span><br>
<span class="lineno"></span><span class="comment" id="2078659">//&nbsp;Method&nbsp;:</span><br>
<span class="lineno"></span><span class="comment" id="2078671">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Based&nbsp;on&nbsp;Mod()&nbsp;returning&nbsp;&nbsp;x&nbsp;-&nbsp;[x/y]chopped&nbsp;*&nbsp;y&nbsp;&nbsp;exactly.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2078737">//&nbsp;Remainder&nbsp;returns&nbsp;the&nbsp;IEEE&nbsp;754&nbsp;floating-point&nbsp;remainder&nbsp;of&nbsp;x/y.</span><br>
<span class="lineno">30</span><span class="comment" id="2078804">//</span><br>
<span class="lineno"></span><span class="comment" id="2078807">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2078829">//&nbsp;&nbsp;&nbsp;&nbspRemainder(±Inf,&nbsp;y)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2078858">//&nbsp;&nbsp;&nbsp;&nbspRemainder(NaN,&nbsp;y)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2078885">//&nbsp;&nbsp;&nbsp;&nbspRemainder(x,&nbsp;0)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">35</span><span class="comment" id="2078910">//&nbsp;&nbsp;&nbsp;&nbspRemainder(x,&nbsp;±Inf)&nbsp;=&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2078937">//&nbsp;&nbsp;&nbsp;&nbspRemainder(x,&nbsp;NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2078964">func</span>&nbsp;<span class="ident" id="2078969">Remainder</span><span class="op" id="2078978">(</span><span class="ident" id="2078979">x</span><span class="op" id="2078980">,</span>&nbsp;<span class="ident" id="2078982">y</span>&nbsp;<span class="builtintype" id="2078984">float64</span><span class="op" id="2078991">)</span>&nbsp;<span class="builtintype" id="2078993">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2079002">func</span>&nbsp;<span class="ident" id="2079007">remainder</span><span class="op" id="2079016">(</span><span class="ident" id="2079017">x</span><span class="op" id="2079018">,</span>&nbsp;<span class="ident" id="2079020">y</span>&nbsp;<span class="builtintype" id="2079022">float64</span><span class="op" id="2079029">)</span>&nbsp;<span class="builtintype" id="2079031">float64</span>&nbsp;<span class="op" id="2079039">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079042">const</span>&nbsp;<span class="op" id="2079048">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079052">Tiny</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2079060">=</span>&nbsp;<span class="num" id="2079062">4.45014771701440276618e-308</span>&nbsp;<span class="comment" id="2079090">//&nbsp;0x0020000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079114">HalfMax</span>&nbsp;<span class="op" id="2079122">=</span>&nbsp;<span class="ident" id="2079124">MaxFloat64</span>&nbsp;<span class="op" id="2079135">/</span>&nbsp;<span class="num" id="2079137">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2079143">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079161">switch</span>&nbsp;<span class="op" id="2079168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079171">case</span>&nbsp;<span class="ident" id="2079176">IsNaN</span><span class="op" id="2079181">(</span><span class="ident" id="2079182">x</span><span class="op" id="2079183">)</span>&nbsp;<span class="op" id="2079185">||</span>&nbsp;<span class="ident" id="2079188">IsNaN</span><span class="op" id="2079193">(</span><span class="ident" id="2079194">y</span><span class="op" id="2079195">)</span>&nbsp;<span class="op" id="2079197">||</span>&nbsp;<span class="ident" id="2079200">IsInf</span><span class="op" id="2079205">(</span><span class="ident" id="2079206">x</span><span class="op" id="2079207">,</span>&nbsp;<span class="num" id="2079209">0</span><span class="op" id="2079210">)</span>&nbsp;<span class="op" id="2079212">||</span>&nbsp;<span class="ident" id="2079215">y</span>&nbsp;<span class="op" id="2079217">==</span>&nbsp;<span class="num" id="2079220">0</span><span class="op" id="2079221">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079225">return</span>&nbsp;<span class="ident" id="2079232">NaN</span><span class="op" id="2079235">(</span><span class="op" id="2079236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079239">case</span>&nbsp;<span class="ident" id="2079244">IsInf</span><span class="op" id="2079249">(</span><span class="ident" id="2079250">y</span><span class="op" id="2079251">,</span>&nbsp;<span class="num" id="2079253">0</span><span class="op" id="2079254">)</span><span class="op" id="2079255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079259">return</span>&nbsp;<span class="ident" id="2079266">x</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079272">sign</span>&nbsp;<span class="op" id="2079277">:=</span>&nbsp;<span class="ident" id="2079280">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079287">if</span>&nbsp;<span class="ident" id="2079290">x</span>&nbsp;<span class="op" id="2079292">&lt;</span>&nbsp;<span class="num" id="2079294">0</span>&nbsp;<span class="op" id="2079296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079300">x</span>&nbsp;<span class="op" id="2079302">=</span>&nbsp;<span class="op" id="2079304">-</span><span class="ident" id="2079305">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079309">sign</span>&nbsp;<span class="op" id="2079314">=</span>&nbsp;<span class="ident" id="2079316">true</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079325">if</span>&nbsp;<span class="ident" id="2079328">y</span>&nbsp;<span class="op" id="2079330">&lt;</span>&nbsp;<span class="num" id="2079332">0</span>&nbsp;<span class="op" id="2079334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079338">y</span>&nbsp;<span class="op" id="2079340">=</span>&nbsp;<span class="op" id="2079342">-</span><span class="ident" id="2079343">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079349">if</span>&nbsp;<span class="ident" id="2079352">x</span>&nbsp;<span class="op" id="2079354">==</span>&nbsp;<span class="ident" id="2079357">y</span>&nbsp;<span class="op" id="2079359">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079363">return</span>&nbsp;<span class="num" id="2079370">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079376">if</span>&nbsp;<span class="ident" id="2079379">y</span>&nbsp;<span class="op" id="2079381">&lt;=</span>&nbsp;<span class="ident" id="2079384">HalfMax</span>&nbsp;<span class="op" id="2079392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079396">x</span>&nbsp;<span class="op" id="2079398">=</span>&nbsp;<span class="ident" id="2079400">Mod</span><span class="op" id="2079403">(</span><span class="ident" id="2079404">x</span><span class="op" id="2079405">,</span>&nbsp;<span class="ident" id="2079407">y</span><span class="op" id="2079408">+</span><span class="ident" id="2079409">y</span><span class="op" id="2079410">)</span>&nbsp;<span class="comment" id="2079412">//&nbsp;now&nbsp;x&nbsp;&lt;&nbsp;2y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079427">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079430">if</span>&nbsp;<span class="ident" id="2079433">y</span>&nbsp;<span class="op" id="2079435">&lt;</span>&nbsp;<span class="ident" id="2079437">Tiny</span>&nbsp;<span class="op" id="2079442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079446">if</span>&nbsp;<span class="ident" id="2079449">x</span><span class="op" id="2079450">+</span><span class="ident" id="2079451">x</span>&nbsp;<span class="op" id="2079453">&gt;</span>&nbsp;<span class="ident" id="2079455">y</span>&nbsp;<span class="op" id="2079457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079462">x</span>&nbsp;<span class="op" id="2079464">-=</span>&nbsp;<span class="ident" id="2079467">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079472">if</span>&nbsp;<span class="ident" id="2079475">x</span><span class="op" id="2079476">+</span><span class="ident" id="2079477">x</span>&nbsp;<span class="op" id="2079479">&gt;=</span>&nbsp;<span class="ident" id="2079482">y</span>&nbsp;<span class="op" id="2079484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079490">x</span>&nbsp;<span class="op" id="2079492">-=</span>&nbsp;<span class="ident" id="2079495">y</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079507">}</span>&nbsp;<span class="keyword" id="2079509">else</span>&nbsp;<span class="op" id="2079514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079518">yHalf</span>&nbsp;<span class="op" id="2079524">:=</span>&nbsp;<span class="num" id="2079527">0.5</span>&nbsp;<span class="op" id="2079531">*</span>&nbsp;<span class="ident" id="2079533">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079537">if</span>&nbsp;<span class="ident" id="2079540">x</span>&nbsp;<span class="op" id="2079542">&gt;</span>&nbsp;<span class="ident" id="2079544">yHalf</span>&nbsp;<span class="op" id="2079550">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079555">x</span>&nbsp;<span class="op" id="2079557">-=</span>&nbsp;<span class="ident" id="2079560">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079565">if</span>&nbsp;<span class="ident" id="2079568">x</span>&nbsp;<span class="op" id="2079570">&gt;=</span>&nbsp;<span class="ident" id="2079573">yHalf</span>&nbsp;<span class="op" id="2079579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079585">x</span>&nbsp;<span class="op" id="2079587">-=</span>&nbsp;<span class="ident" id="2079590">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079599">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079605">if</span>&nbsp;<span class="ident" id="2079608">sign</span>&nbsp;<span class="op" id="2079613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2079617">x</span>&nbsp;<span class="op" id="2079619">=</span>&nbsp;<span class="op" id="2079621">-</span><span class="ident" id="2079622">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2079625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2079628">return</span>&nbsp;<span class="ident" id="2079635">x</span><br>
<span class="lineno">85</span><span class="op" id="2079637">}</span>
</div>
</body>
</html>
