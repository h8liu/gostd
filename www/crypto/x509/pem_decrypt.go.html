<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4000415">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4000470">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4000524">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4000575">package</span>&nbsp;<span class="ident" id="4000583">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4000589">//&nbsp;RFC&nbsp;1423&nbsp;describes&nbsp;the&nbsp;encryption&nbsp;of&nbsp;PEM&nbsp;blocks.&nbsp;The&nbsp;algorithm&nbsp;used&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4000663">//&nbsp;generate&nbsp;a&nbsp;key&nbsp;from&nbsp;the&nbsp;password&nbsp;was&nbsp;derived&nbsp;by&nbsp;looking&nbsp;at&nbsp;the&nbsp;OpenSSL</span><br>
<span class="lineno"></span><span class="comment" id="4000737">//&nbsp;implementation.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4000757">import</span>&nbsp;<span class="op" id="4000764">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4000767">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4000781">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4000798">&#34;crypto/des&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4000812">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4000826">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4000842">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4000858">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4000868">&#34;io&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4000874">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4000884">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4000887">type</span>&nbsp;<span class="ident" id="4000892">PEMCipher</span>&nbsp;<span class="builtintype" id="4000902">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4000907">//&nbsp;Possible&nbsp;values&nbsp;for&nbsp;the&nbsp;EncryptPEMBlock&nbsp;encryption&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4000972">const</span>&nbsp;<span class="op" id="4000978">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000981">_</span>&nbsp;<span class="ident" id="4000983"><a href="/crypto/x509/pem_decrypt.go.html#4000892">PEMCipher</a></span>&nbsp;<span class="op" id="4000993">=</span>&nbsp;<span class="ident" id="4000995">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001001">PEMCipherDES</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001015">PEMCipher3DES</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001030">PEMCipherAES128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001047">PEMCipherAES192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001064">PEMCipherAES256</span><br>
<span class="lineno"></span><span class="op" id="4001080">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4001083">//&nbsp;rfc1423Algo&nbsp;holds&nbsp;a&nbsp;method&nbsp;for&nbsp;enciphering&nbsp;a&nbsp;PEM&nbsp;block.</span><br>
<span class="lineno"></span><span class="keyword" id="4001142">type</span>&nbsp;<span class="ident" id="4001147">rfc1423Algo</span>&nbsp;<span class="keyword" id="4001159">struct</span>&nbsp;<span class="op" id="4001166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001169">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4001180"><a href="/crypto/x509/pem_decrypt.go.html#4000892">PEMCipher</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001191">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4001202">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001210">cipherFunc</span>&nbsp;<span class="keyword" id="4001221">func</span><span class="op" id="4001225">(</span><span class="ident" id="4001226">key</span>&nbsp;<span class="op" id="4001230">[</span><span class="op" id="4001231">]</span><span class="builtintype" id="4001232">byte</span><span class="op" id="4001236">)</span>&nbsp;<span class="op" id="4001238">(</span><span class="ident" id="4001239"><a href="/crypto/x509/pem_decrypt.go.html#4000781">cipher</a></span><span class="op" id="4001245">.</span><span class="ident" id="4001246">Block</span><span class="op" id="4001251">,</span>&nbsp;<span class="builtintype" id="4001253">error</span><span class="op" id="4001258">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001261">keySize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4001272">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001277">blockSize</span>&nbsp;&nbsp;<span class="builtintype" id="4001288">int</span><br>
<span class="lineno"></span><span class="op" id="4001292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4001295">//&nbsp;rfc1423Algos&nbsp;holds&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;possible&nbsp;ways&nbsp;to&nbsp;encrypt&nbsp;a&nbsp;PEM</span><br>
<span class="lineno">45</span><span class="comment" id="4001363">//&nbsp;block.&nbsp;&nbsp;The&nbsp;ivSize&nbsp;numbers&nbsp;were&nbsp;taken&nbsp;from&nbsp;the&nbsp;OpenSSL&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="4001429">var</span>&nbsp;<span class="ident" id="4001433">rfc1423Algos</span>&nbsp;<span class="op" id="4001446">=</span>&nbsp;<span class="op" id="4001448">[</span><span class="op" id="4001449">]</span><span class="ident" id="4001450"><a href="/crypto/x509/pem_decrypt.go.html#4001147">rfc1423Algo</a></span><span class="op" id="4001461">{</span><span class="op" id="4001462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001465">cipher</span><span class="op" id="4001471">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4001477"><a href="/crypto/x509/pem_decrypt.go.html#4001001">PEMCipherDES</a></span><span class="op" id="4001489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001492">name</span><span class="op" id="4001496">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4001504">&#34;DES-CBC&#34;</span><span class="op" id="4001513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001516">cipherFunc</span><span class="op" id="4001526">:</span>&nbsp;<span class="ident" id="4001528"><a href="/crypto/x509/pem_decrypt.go.html#4000798">des</a></span><span class="op" id="4001531">.</span><span class="ident" id="4001532">NewCipher</span><span class="op" id="4001541">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001544">keySize</span><span class="op" id="4001551">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4001556">8</span><span class="op" id="4001557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001560">blockSize</span><span class="op" id="4001569">:</span>&nbsp;&nbsp;<span class="ident" id="4001572"><a href="/crypto/x509/pem_decrypt.go.html#4000798">des</a></span><span class="op" id="4001575">.</span><span class="ident" id="4001576">BlockSize</span><span class="op" id="4001585">,</span><br>
<span class="lineno"></span><span class="op" id="4001587">}</span><span class="op" id="4001588">,</span>&nbsp;<span class="op" id="4001590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001593">cipher</span><span class="op" id="4001599">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4001605"><a href="/crypto/x509/pem_decrypt.go.html#4001015">PEMCipher3DES</a></span><span class="op" id="4001618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001621">name</span><span class="op" id="4001625">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4001633">&#34;DES-EDE3-CBC&#34;</span><span class="op" id="4001647">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001650">cipherFunc</span><span class="op" id="4001660">:</span>&nbsp;<span class="ident" id="4001662"><a href="/crypto/x509/pem_decrypt.go.html#4000798">des</a></span><span class="op" id="4001665">.</span><span class="ident" id="4001666">NewTripleDESCipher</span><span class="op" id="4001684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001687">keySize</span><span class="op" id="4001694">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4001699">24</span><span class="op" id="4001701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001704">blockSize</span><span class="op" id="4001713">:</span>&nbsp;&nbsp;<span class="ident" id="4001716"><a href="/crypto/x509/pem_decrypt.go.html#4000798">des</a></span><span class="op" id="4001719">.</span><span class="ident" id="4001720">BlockSize</span><span class="op" id="4001729">,</span><br>
<span class="lineno"></span><span class="op" id="4001731">}</span><span class="op" id="4001732">,</span>&nbsp;<span class="op" id="4001734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001737">cipher</span><span class="op" id="4001743">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4001749"><a href="/crypto/x509/pem_decrypt.go.html#4001030">PEMCipherAES128</a></span><span class="op" id="4001764">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001767">name</span><span class="op" id="4001771">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4001779">&#34;AES-128-CBC&#34;</span><span class="op" id="4001792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001795">cipherFunc</span><span class="op" id="4001805">:</span>&nbsp;<span class="ident" id="4001807"><a href="/crypto/x509/pem_decrypt.go.html#4000767">aes</a></span><span class="op" id="4001810">.</span><span class="ident" id="4001811">NewCipher</span><span class="op" id="4001820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001823">keySize</span><span class="op" id="4001830">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4001835">16</span><span class="op" id="4001837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001840">blockSize</span><span class="op" id="4001849">:</span>&nbsp;&nbsp;<span class="ident" id="4001852"><a href="/crypto/x509/pem_decrypt.go.html#4000767">aes</a></span><span class="op" id="4001855">.</span><span class="ident" id="4001856">BlockSize</span><span class="op" id="4001865">,</span><br>
<span class="lineno"></span><span class="op" id="4001867">}</span><span class="op" id="4001868">,</span>&nbsp;<span class="op" id="4001870">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001873">cipher</span><span class="op" id="4001879">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4001885"><a href="/crypto/x509/pem_decrypt.go.html#4001047">PEMCipherAES192</a></span><span class="op" id="4001900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001903">name</span><span class="op" id="4001907">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4001915">&#34;AES-192-CBC&#34;</span><span class="op" id="4001928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001931">cipherFunc</span><span class="op" id="4001941">:</span>&nbsp;<span class="ident" id="4001943"><a href="/crypto/x509/pem_decrypt.go.html#4000767">aes</a></span><span class="op" id="4001946">.</span><span class="ident" id="4001947">NewCipher</span><span class="op" id="4001956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001959">keySize</span><span class="op" id="4001966">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4001971">24</span><span class="op" id="4001973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4001976">blockSize</span><span class="op" id="4001985">:</span>&nbsp;&nbsp;<span class="ident" id="4001988"><a href="/crypto/x509/pem_decrypt.go.html#4000767">aes</a></span><span class="op" id="4001991">.</span><span class="ident" id="4001992">BlockSize</span><span class="op" id="4002001">,</span><br>
<span class="lineno">70</span><span class="op" id="4002003">}</span><span class="op" id="4002004">,</span>&nbsp;<span class="op" id="4002006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002009">cipher</span><span class="op" id="4002015">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4002021"><a href="/crypto/x509/pem_decrypt.go.html#4001064">PEMCipherAES256</a></span><span class="op" id="4002036">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002039">name</span><span class="op" id="4002043">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4002051">&#34;AES-256-CBC&#34;</span><span class="op" id="4002064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002067">cipherFunc</span><span class="op" id="4002077">:</span>&nbsp;<span class="ident" id="4002079"><a href="/crypto/x509/pem_decrypt.go.html#4000767">aes</a></span><span class="op" id="4002082">.</span><span class="ident" id="4002083">NewCipher</span><span class="op" id="4002092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002095">keySize</span><span class="op" id="4002102">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4002107">32</span><span class="op" id="4002109">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002112">blockSize</span><span class="op" id="4002121">:</span>&nbsp;&nbsp;<span class="ident" id="4002124"><a href="/crypto/x509/pem_decrypt.go.html#4000767">aes</a></span><span class="op" id="4002127">.</span><span class="ident" id="4002128">BlockSize</span><span class="op" id="4002137">,</span><br>
<span class="lineno"></span><span class="op" id="4002139">}</span><span class="op" id="4002140">,</span><br>
<span class="lineno"></span><span class="op" id="4002142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4002145">//&nbsp;deriveKey&nbsp;uses&nbsp;a&nbsp;key&nbsp;derivation&nbsp;function&nbsp;to&nbsp;stretch&nbsp;the&nbsp;password&nbsp;into&nbsp;a&nbsp;key</span><br>
<span class="lineno">80</span><span class="comment" id="4002224">//&nbsp;with&nbsp;the&nbsp;number&nbsp;of&nbsp;bits&nbsp;our&nbsp;cipher&nbsp;requires.&nbsp;This&nbsp;algorithm&nbsp;was&nbsp;derived&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4002304">//&nbsp;the&nbsp;OpenSSL&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="4002327">func</span>&nbsp;<span class="op" id="4002332">(</span><span class="ident" id="4002333">c</span>&nbsp;<span class="ident" id="4002335"><a href="/crypto/x509/pem_decrypt.go.html#4001147">rfc1423Algo</a></span><span class="op" id="4002346">)</span>&nbsp;<span class="ident" id="4002348">deriveKey</span><span class="op" id="4002357">(</span><span class="ident" id="4002358">password</span><span class="op" id="4002366">,</span>&nbsp;<span class="ident" id="4002368">salt</span>&nbsp;<span class="op" id="4002373">[</span><span class="op" id="4002374">]</span><span class="builtintype" id="4002375">byte</span><span class="op" id="4002379">)</span>&nbsp;<span class="op" id="4002381">[</span><span class="op" id="4002382">]</span><span class="builtintype" id="4002383">byte</span>&nbsp;<span class="op" id="4002388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002391">hash</span>&nbsp;<span class="op" id="4002396">:=</span>&nbsp;<span class="ident" id="4002399"><a href="/crypto/x509/pem_decrypt.go.html#4000812">md5</a></span><span class="op" id="4002402">.</span><span class="ident" id="4002403">New</span><span class="op" id="4002406">(</span><span class="op" id="4002407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002410">out</span>&nbsp;<span class="op" id="4002414">:=</span>&nbsp;<span class="builtinfunc" id="4002417">make</span><span class="op" id="4002421">(</span><span class="op" id="4002422">[</span><span class="op" id="4002423">]</span><span class="builtintype" id="4002424">byte</span><span class="op" id="4002428">,</span>&nbsp;<span class="ident" id="4002430"><a href="/crypto/x509/pem_decrypt.go.html#4002333">c</a></span><span class="op" id="4002431">.</span><span class="ident" id="4002432">keySize</span><span class="op" id="4002439">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002442">var</span>&nbsp;<span class="ident" id="4002446">digest</span>&nbsp;<span class="op" id="4002453">[</span><span class="op" id="4002454">]</span><span class="builtintype" id="4002455">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002462">for</span>&nbsp;<span class="ident" id="4002466">i</span>&nbsp;<span class="op" id="4002468">:=</span>&nbsp;<span class="num" id="4002471">0</span><span class="op" id="4002472">;</span>&nbsp;<span class="ident" id="4002474"><a href="/crypto/x509/pem_decrypt.go.html#4002466">i</a></span>&nbsp;<span class="op" id="4002476">&lt;</span>&nbsp;<span class="builtinfunc" id="4002478">len</span><span class="op" id="4002481">(</span><span class="ident" id="4002482"><a href="/crypto/x509/pem_decrypt.go.html#4002410">out</a></span><span class="op" id="4002485">)</span><span class="op" id="4002486">;</span>&nbsp;<span class="ident" id="4002488"><a href="/crypto/x509/pem_decrypt.go.html#4002466">i</a></span>&nbsp;<span class="op" id="4002490">+=</span>&nbsp;<span class="builtinfunc" id="4002493">len</span><span class="op" id="4002496">(</span><span class="ident" id="4002497"><a href="/crypto/x509/pem_decrypt.go.html#4002446">digest</a></span><span class="op" id="4002503">)</span>&nbsp;<span class="op" id="4002505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002509"><a href="/crypto/x509/pem_decrypt.go.html#4002391">hash</a></span><span class="op" id="4002513">.</span><span class="ident" id="4002514">Reset</span><span class="op" id="4002519">(</span><span class="op" id="4002520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002524"><a href="/crypto/x509/pem_decrypt.go.html#4002391">hash</a></span><span class="op" id="4002528">.</span><span class="ident" id="4002529">Write</span><span class="op" id="4002534">(</span><span class="ident" id="4002535"><a href="/crypto/x509/pem_decrypt.go.html#4002446">digest</a></span><span class="op" id="4002541">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002545"><a href="/crypto/x509/pem_decrypt.go.html#4002391">hash</a></span><span class="op" id="4002549">.</span><span class="ident" id="4002550">Write</span><span class="op" id="4002555">(</span><span class="ident" id="4002556"><a href="/crypto/x509/pem_decrypt.go.html#4002358">password</a></span><span class="op" id="4002564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002568"><a href="/crypto/x509/pem_decrypt.go.html#4002391">hash</a></span><span class="op" id="4002572">.</span><span class="ident" id="4002573">Write</span><span class="op" id="4002578">(</span><span class="ident" id="4002579"><a href="/crypto/x509/pem_decrypt.go.html#4002368">salt</a></span><span class="op" id="4002583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002587"><a href="/crypto/x509/pem_decrypt.go.html#4002446">digest</a></span>&nbsp;<span class="op" id="4002594">=</span>&nbsp;<span class="ident" id="4002596"><a href="/crypto/x509/pem_decrypt.go.html#4002391">hash</a></span><span class="op" id="4002600">.</span><span class="ident" id="4002601">Sum</span><span class="op" id="4002604">(</span><span class="ident" id="4002605"><a href="/crypto/x509/pem_decrypt.go.html#4002446">digest</a></span><span class="op" id="4002611">[</span><span class="op" id="4002612">:</span><span class="num" id="4002613">0</span><span class="op" id="4002614">]</span><span class="op" id="4002615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4002619">copy</span><span class="op" id="4002623">(</span><span class="ident" id="4002624"><a href="/crypto/x509/pem_decrypt.go.html#4002410">out</a></span><span class="op" id="4002627">[</span><span class="ident" id="4002628"><a href="/crypto/x509/pem_decrypt.go.html#4002466">i</a></span><span class="op" id="4002629">:</span><span class="op" id="4002630">]</span><span class="op" id="4002631">,</span>&nbsp;<span class="ident" id="4002633"><a href="/crypto/x509/pem_decrypt.go.html#4002446">digest</a></span><span class="op" id="4002639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4002642">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002645">return</span>&nbsp;<span class="ident" id="4002652"><a href="/crypto/x509/pem_decrypt.go.html#4002410">out</a></span><br>
<span class="lineno"></span><span class="op" id="4002656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4002659">//&nbsp;IsEncryptedPEMBlock&nbsp;returns&nbsp;if&nbsp;the&nbsp;PEM&nbsp;block&nbsp;is&nbsp;password&nbsp;encrypted.</span><br>
<span class="lineno"></span><span class="keyword" id="4002730">func</span>&nbsp;<span class="ident" id="4002735">IsEncryptedPEMBlock</span><span class="op" id="4002754">(</span><span class="ident" id="4002755">b</span>&nbsp;<span class="op" id="4002757">*</span><span class="ident" id="4002758"><a href="/crypto/x509/pem_decrypt.go.html#4000842">pem</a></span><span class="op" id="4002761">.</span><span class="ident" id="4002762">Block</span><span class="op" id="4002767">)</span>&nbsp;<span class="builtintype" id="4002769">bool</span>&nbsp;<span class="op" id="4002774">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4002777">_</span><span class="op" id="4002778">,</span>&nbsp;<span class="ident" id="4002780">ok</span>&nbsp;<span class="op" id="4002783">:=</span>&nbsp;<span class="ident" id="4002786"><a href="/crypto/x509/pem_decrypt.go.html#4002755">b</a></span><span class="op" id="4002787">.</span><span class="ident" id="4002788">Headers</span><span class="op" id="4002795">[</span><span class="string" id="4002796">&#34;DEK-Info&#34;</span><span class="op" id="4002806">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4002809">return</span>&nbsp;<span class="ident" id="4002816"><a href="/crypto/x509/pem_decrypt.go.html#4002780">ok</a></span><br>
<span class="lineno"></span><span class="op" id="4002819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4002822">//&nbsp;IncorrectPasswordError&nbsp;is&nbsp;returned&nbsp;when&nbsp;an&nbsp;incorrect&nbsp;password&nbsp;is&nbsp;detected.</span><br>
<span class="lineno">105</span><span class="keyword" id="4002900">var</span>&nbsp;<span class="ident" id="4002904">IncorrectPasswordError</span>&nbsp;<span class="op" id="4002927">=</span>&nbsp;<span class="ident" id="4002929"><a href="/crypto/x509/pem_decrypt.go.html#4000858">errors</a></span><span class="op" id="4002935">.</span><span class="ident" id="4002936">New</span><span class="op" id="4002939">(</span><span class="string" id="4002940">&#34;x509:&nbsp;decryption&nbsp;password&nbsp;incorrect&#34;</span><span class="op" id="4002977">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4002980">//&nbsp;DecryptPEMBlock&nbsp;takes&nbsp;a&nbsp;password&nbsp;encrypted&nbsp;PEM&nbsp;block&nbsp;and&nbsp;the&nbsp;password&nbsp;used&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4003061">//&nbsp;encrypt&nbsp;it&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;decrypted&nbsp;DER&nbsp;encoded&nbsp;bytes.&nbsp;It&nbsp;inspects</span><br>
<span class="lineno"></span><span class="comment" id="4003139">//&nbsp;the&nbsp;DEK-Info&nbsp;header&nbsp;to&nbsp;determine&nbsp;the&nbsp;algorithm&nbsp;used&nbsp;for&nbsp;decryption.&nbsp;If&nbsp;no</span><br>
<span class="lineno">110</span><span class="comment" id="4003216">//&nbsp;DEK-Info&nbsp;header&nbsp;is&nbsp;present,&nbsp;an&nbsp;error&nbsp;is&nbsp;returned.&nbsp;If&nbsp;an&nbsp;incorrect&nbsp;password</span><br>
<span class="lineno"></span><span class="comment" id="4003294">//&nbsp;is&nbsp;detected&nbsp;an&nbsp;IncorrectPasswordError&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="keyword" id="4003348">func</span>&nbsp;<span class="ident" id="4003353">DecryptPEMBlock</span><span class="op" id="4003368">(</span><span class="ident" id="4003369">b</span>&nbsp;<span class="op" id="4003371">*</span><span class="ident" id="4003372"><a href="/crypto/x509/pem_decrypt.go.html#4000842">pem</a></span><span class="op" id="4003375">.</span><span class="ident" id="4003376">Block</span><span class="op" id="4003381">,</span>&nbsp;<span class="ident" id="4003383">password</span>&nbsp;<span class="op" id="4003392">[</span><span class="op" id="4003393">]</span><span class="builtintype" id="4003394">byte</span><span class="op" id="4003398">)</span>&nbsp;<span class="op" id="4003400">(</span><span class="op" id="4003401">[</span><span class="op" id="4003402">]</span><span class="builtintype" id="4003403">byte</span><span class="op" id="4003407">,</span>&nbsp;<span class="builtintype" id="4003409">error</span><span class="op" id="4003414">)</span>&nbsp;<span class="op" id="4003416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003419">dek</span><span class="op" id="4003422">,</span>&nbsp;<span class="ident" id="4003424">ok</span>&nbsp;<span class="op" id="4003427">:=</span>&nbsp;<span class="ident" id="4003430"><a href="/crypto/x509/pem_decrypt.go.html#4003369">b</a></span><span class="op" id="4003431">.</span><span class="ident" id="4003432">Headers</span><span class="op" id="4003439">[</span><span class="string" id="4003440">&#34;DEK-Info&#34;</span><span class="op" id="4003450">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003453">if</span>&nbsp;<span class="op" id="4003456">!</span><span class="ident" id="4003457"><a href="/crypto/x509/pem_decrypt.go.html#4003424">ok</a></span>&nbsp;<span class="op" id="4003460">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003464">return</span>&nbsp;<span class="ident" id="4003471">nil</span><span class="op" id="4003474">,</span>&nbsp;<span class="ident" id="4003476"><a href="/crypto/x509/pem_decrypt.go.html#4000858">errors</a></span><span class="op" id="4003482">.</span><span class="ident" id="4003483">New</span><span class="op" id="4003486">(</span><span class="string" id="4003487">&#34;x509:&nbsp;no&nbsp;DEK-Info&nbsp;header&nbsp;in&nbsp;block&#34;</span><span class="op" id="4003522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003529">idx</span>&nbsp;<span class="op" id="4003533">:=</span>&nbsp;<span class="ident" id="4003536"><a href="/crypto/x509/pem_decrypt.go.html#4000874">strings</a></span><span class="op" id="4003543">.</span><span class="ident" id="4003544">Index</span><span class="op" id="4003549">(</span><span class="ident" id="4003550"><a href="/crypto/x509/pem_decrypt.go.html#4003419">dek</a></span><span class="op" id="4003553">,</span>&nbsp;<span class="string" id="4003555">&#34;,&#34;</span><span class="op" id="4003558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003561">if</span>&nbsp;<span class="ident" id="4003564"><a href="/crypto/x509/pem_decrypt.go.html#4003529">idx</a></span>&nbsp;<span class="op" id="4003568">==</span>&nbsp;<span class="op" id="4003571">-</span><span class="num" id="4003572">1</span>&nbsp;<span class="op" id="4003574">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003578">return</span>&nbsp;<span class="ident" id="4003585">nil</span><span class="op" id="4003588">,</span>&nbsp;<span class="ident" id="4003590"><a href="/crypto/x509/pem_decrypt.go.html#4000858">errors</a></span><span class="op" id="4003596">.</span><span class="ident" id="4003597">New</span><span class="op" id="4003600">(</span><span class="string" id="4003601">&#34;x509:&nbsp;malformed&nbsp;DEK-Info&nbsp;header&#34;</span><span class="op" id="4003634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003641">mode</span><span class="op" id="4003645">,</span>&nbsp;<span class="ident" id="4003647">hexIV</span>&nbsp;<span class="op" id="4003653">:=</span>&nbsp;<span class="ident" id="4003656"><a href="/crypto/x509/pem_decrypt.go.html#4003419">dek</a></span><span class="op" id="4003659">[</span><span class="op" id="4003660">:</span><span class="ident" id="4003661"><a href="/crypto/x509/pem_decrypt.go.html#4003529">idx</a></span><span class="op" id="4003664">]</span><span class="op" id="4003665">,</span>&nbsp;<span class="ident" id="4003667"><a href="/crypto/x509/pem_decrypt.go.html#4003419">dek</a></span><span class="op" id="4003670">[</span><span class="ident" id="4003671"><a href="/crypto/x509/pem_decrypt.go.html#4003529">idx</a></span><span class="op" id="4003674">+</span><span class="num" id="4003675">1</span><span class="op" id="4003676">:</span><span class="op" id="4003677">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003680">ciph</span>&nbsp;<span class="op" id="4003685">:=</span>&nbsp;<span class="ident" id="4003688"><a href="/crypto/x509/pem_decrypt.go.html#4006404">cipherByName</a></span><span class="op" id="4003700">(</span><span class="ident" id="4003701"><a href="/crypto/x509/pem_decrypt.go.html#4003641">mode</a></span><span class="op" id="4003705">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003708">if</span>&nbsp;<span class="ident" id="4003711"><a href="/crypto/x509/pem_decrypt.go.html#4003680">ciph</a></span>&nbsp;<span class="op" id="4003716">==</span>&nbsp;<span class="ident" id="4003719">nil</span>&nbsp;<span class="op" id="4003723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003727">return</span>&nbsp;<span class="ident" id="4003734">nil</span><span class="op" id="4003737">,</span>&nbsp;<span class="ident" id="4003739"><a href="/crypto/x509/pem_decrypt.go.html#4000858">errors</a></span><span class="op" id="4003745">.</span><span class="ident" id="4003746">New</span><span class="op" id="4003749">(</span><span class="string" id="4003750">&#34;x509:&nbsp;unknown&nbsp;encryption&nbsp;mode&#34;</span><span class="op" id="4003781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4003787">iv</span><span class="op" id="4003789">,</span>&nbsp;<span class="ident" id="4003791">err</span>&nbsp;<span class="op" id="4003795">:=</span>&nbsp;<span class="ident" id="4003798"><a href="/crypto/x509/pem_decrypt.go.html#4000826">hex</a></span><span class="op" id="4003801">.</span><span class="ident" id="4003802">DecodeString</span><span class="op" id="4003814">(</span><span class="ident" id="4003815"><a href="/crypto/x509/pem_decrypt.go.html#4003647">hexIV</a></span><span class="op" id="4003820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003823">if</span>&nbsp;<span class="ident" id="4003826"><a href="/crypto/x509/pem_decrypt.go.html#4003791">err</a></span>&nbsp;<span class="op" id="4003830">!=</span>&nbsp;<span class="ident" id="4003833">nil</span>&nbsp;<span class="op" id="4003837">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003841">return</span>&nbsp;<span class="ident" id="4003848">nil</span><span class="op" id="4003851">,</span>&nbsp;<span class="ident" id="4003853"><a href="/crypto/x509/pem_decrypt.go.html#4003791">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003861">if</span>&nbsp;<span class="builtinfunc" id="4003864">len</span><span class="op" id="4003867">(</span><span class="ident" id="4003868"><a href="/crypto/x509/pem_decrypt.go.html#4003787">iv</a></span><span class="op" id="4003870">)</span>&nbsp;<span class="op" id="4003872">!=</span>&nbsp;<span class="ident" id="4003875"><a href="/crypto/x509/pem_decrypt.go.html#4003680">ciph</a></span><span class="op" id="4003879">.</span><span class="ident" id="4003880">blockSize</span>&nbsp;<span class="op" id="4003890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4003894">return</span>&nbsp;<span class="ident" id="4003901">nil</span><span class="op" id="4003904">,</span>&nbsp;<span class="ident" id="4003906"><a href="/crypto/x509/pem_decrypt.go.html#4000858">errors</a></span><span class="op" id="4003912">.</span><span class="ident" id="4003913">New</span><span class="op" id="4003916">(</span><span class="string" id="4003917">&#34;x509:&nbsp;incorrect&nbsp;IV&nbsp;size&#34;</span><span class="op" id="4003942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4003945">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4003949">//&nbsp;Based&nbsp;on&nbsp;the&nbsp;OpenSSL&nbsp;implementation.&nbsp;The&nbsp;salt&nbsp;is&nbsp;the&nbsp;first&nbsp;8&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4004020">//&nbsp;of&nbsp;the&nbsp;initialization&nbsp;vector.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004054">key</span>&nbsp;<span class="op" id="4004058">:=</span>&nbsp;<span class="ident" id="4004061"><a href="/crypto/x509/pem_decrypt.go.html#4003680">ciph</a></span><span class="op" id="4004065">.</span><span class="ident" id="4004066">deriveKey</span><span class="op" id="4004075">(</span><span class="ident" id="4004076"><a href="/crypto/x509/pem_decrypt.go.html#4003383">password</a></span><span class="op" id="4004084">,</span>&nbsp;<span class="ident" id="4004086"><a href="/crypto/x509/pem_decrypt.go.html#4003787">iv</a></span><span class="op" id="4004088">[</span><span class="op" id="4004089">:</span><span class="num" id="4004090">8</span><span class="op" id="4004091">]</span><span class="op" id="4004092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004095">block</span><span class="op" id="4004100">,</span>&nbsp;<span class="ident" id="4004102"><a href="/crypto/x509/pem_decrypt.go.html#4003791">err</a></span>&nbsp;<span class="op" id="4004106">:=</span>&nbsp;<span class="ident" id="4004109"><a href="/crypto/x509/pem_decrypt.go.html#4003680">ciph</a></span><span class="op" id="4004113">.</span><span class="ident" id="4004114">cipherFunc</span><span class="op" id="4004124">(</span><span class="ident" id="4004125"><a href="/crypto/x509/pem_decrypt.go.html#4004054">key</a></span><span class="op" id="4004128">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004131">if</span>&nbsp;<span class="ident" id="4004134"><a href="/crypto/x509/pem_decrypt.go.html#4003791">err</a></span>&nbsp;<span class="op" id="4004138">!=</span>&nbsp;<span class="ident" id="4004141">nil</span>&nbsp;<span class="op" id="4004145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004149">return</span>&nbsp;<span class="ident" id="4004156">nil</span><span class="op" id="4004159">,</span>&nbsp;<span class="ident" id="4004161"><a href="/crypto/x509/pem_decrypt.go.html#4003791">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004170">data</span>&nbsp;<span class="op" id="4004175">:=</span>&nbsp;<span class="builtinfunc" id="4004178">make</span><span class="op" id="4004182">(</span><span class="op" id="4004183">[</span><span class="op" id="4004184">]</span><span class="builtintype" id="4004185">byte</span><span class="op" id="4004189">,</span>&nbsp;<span class="builtinfunc" id="4004191">len</span><span class="op" id="4004194">(</span><span class="ident" id="4004195"><a href="/crypto/x509/pem_decrypt.go.html#4003369">b</a></span><span class="op" id="4004196">.</span><span class="ident" id="4004197">Bytes</span><span class="op" id="4004202">)</span><span class="op" id="4004203">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004206">dec</span>&nbsp;<span class="op" id="4004210">:=</span>&nbsp;<span class="ident" id="4004213"><a href="/crypto/x509/pem_decrypt.go.html#4000781">cipher</a></span><span class="op" id="4004219">.</span><span class="ident" id="4004220">NewCBCDecrypter</span><span class="op" id="4004235">(</span><span class="ident" id="4004236"><a href="/crypto/x509/pem_decrypt.go.html#4004095">block</a></span><span class="op" id="4004241">,</span>&nbsp;<span class="ident" id="4004243"><a href="/crypto/x509/pem_decrypt.go.html#4003787">iv</a></span><span class="op" id="4004245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004248"><a href="/crypto/x509/pem_decrypt.go.html#4004206">dec</a></span><span class="op" id="4004251">.</span><span class="ident" id="4004252">CryptBlocks</span><span class="op" id="4004263">(</span><span class="ident" id="4004264"><a href="/crypto/x509/pem_decrypt.go.html#4004170">data</a></span><span class="op" id="4004268">,</span>&nbsp;<span class="ident" id="4004270"><a href="/crypto/x509/pem_decrypt.go.html#4003369">b</a></span><span class="op" id="4004271">.</span><span class="ident" id="4004272">Bytes</span><span class="op" id="4004277">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4004281">//&nbsp;Blocks&nbsp;are&nbsp;padded&nbsp;using&nbsp;a&nbsp;scheme&nbsp;where&nbsp;the&nbsp;last&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding&nbsp;are&nbsp;all</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4004360">//&nbsp;equal&nbsp;to&nbsp;n.&nbsp;It&nbsp;can&nbsp;pad&nbsp;from&nbsp;1&nbsp;to&nbsp;blocksize&nbsp;bytes&nbsp;inclusive.&nbsp;See&nbsp;RFC&nbsp;1423.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4004438">//&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4004455">//&nbsp;&nbsp;&nbsp;&nbsp[x&nbsp;y&nbsp;z&nbsp;2&nbsp;2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4004471">//&nbsp;&nbsp;&nbsp;&nbsp[x&nbsp;y&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4004495">//&nbsp;If&nbsp;we&nbsp;detect&nbsp;a&nbsp;bad&nbsp;padding,&nbsp;we&nbsp;assume&nbsp;it&nbsp;is&nbsp;an&nbsp;invalid&nbsp;password.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004564">dlen</span>&nbsp;<span class="op" id="4004569">:=</span>&nbsp;<span class="builtinfunc" id="4004572">len</span><span class="op" id="4004575">(</span><span class="ident" id="4004576"><a href="/crypto/x509/pem_decrypt.go.html#4004170">data</a></span><span class="op" id="4004580">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004583">if</span>&nbsp;<span class="ident" id="4004586"><a href="/crypto/x509/pem_decrypt.go.html#4004564">dlen</a></span>&nbsp;<span class="op" id="4004591">==</span>&nbsp;<span class="num" id="4004594">0</span>&nbsp;<span class="op" id="4004596">||</span>&nbsp;<span class="ident" id="4004599"><a href="/crypto/x509/pem_decrypt.go.html#4004564">dlen</a></span><span class="op" id="4004603">%</span><span class="ident" id="4004604"><a href="/crypto/x509/pem_decrypt.go.html#4003680">ciph</a></span><span class="op" id="4004608">.</span><span class="ident" id="4004609">blockSize</span>&nbsp;<span class="op" id="4004619">!=</span>&nbsp;<span class="num" id="4004622">0</span>&nbsp;<span class="op" id="4004624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004628">return</span>&nbsp;<span class="ident" id="4004635">nil</span><span class="op" id="4004638">,</span>&nbsp;<span class="ident" id="4004640"><a href="/crypto/x509/pem_decrypt.go.html#4000858">errors</a></span><span class="op" id="4004646">.</span><span class="ident" id="4004647">New</span><span class="op" id="4004650">(</span><span class="string" id="4004651">&#34;x509:&nbsp;invalid&nbsp;padding&#34;</span><span class="op" id="4004674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4004680">last</span>&nbsp;<span class="op" id="4004685">:=</span>&nbsp;<span class="builtintype" id="4004688">int</span><span class="op" id="4004691">(</span><span class="ident" id="4004692"><a href="/crypto/x509/pem_decrypt.go.html#4004170">data</a></span><span class="op" id="4004696">[</span><span class="ident" id="4004697"><a href="/crypto/x509/pem_decrypt.go.html#4004564">dlen</a></span><span class="op" id="4004701">-</span><span class="num" id="4004702">1</span><span class="op" id="4004703">]</span><span class="op" id="4004704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004707">if</span>&nbsp;<span class="ident" id="4004710"><a href="/crypto/x509/pem_decrypt.go.html#4004564">dlen</a></span>&nbsp;<span class="op" id="4004715">&lt;</span>&nbsp;<span class="ident" id="4004717"><a href="/crypto/x509/pem_decrypt.go.html#4004680">last</a></span>&nbsp;<span class="op" id="4004722">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004726">return</span>&nbsp;<span class="ident" id="4004733">nil</span><span class="op" id="4004736">,</span>&nbsp;<span class="ident" id="4004738"><a href="/crypto/x509/pem_decrypt.go.html#4002904">IncorrectPasswordError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004765">if</span>&nbsp;<span class="ident" id="4004768"><a href="/crypto/x509/pem_decrypt.go.html#4004680">last</a></span>&nbsp;<span class="op" id="4004773">==</span>&nbsp;<span class="num" id="4004776">0</span>&nbsp;<span class="op" id="4004778">||</span>&nbsp;<span class="ident" id="4004781"><a href="/crypto/x509/pem_decrypt.go.html#4004680">last</a></span>&nbsp;<span class="op" id="4004786">&gt;</span>&nbsp;<span class="ident" id="4004788"><a href="/crypto/x509/pem_decrypt.go.html#4003680">ciph</a></span><span class="op" id="4004792">.</span><span class="ident" id="4004793">blockSize</span>&nbsp;<span class="op" id="4004803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004807">return</span>&nbsp;<span class="ident" id="4004814">nil</span><span class="op" id="4004817">,</span>&nbsp;<span class="ident" id="4004819"><a href="/crypto/x509/pem_decrypt.go.html#4002904">IncorrectPasswordError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004843">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004846">for</span>&nbsp;<span class="ident" id="4004850">_</span><span class="op" id="4004851">,</span>&nbsp;<span class="ident" id="4004853">val</span>&nbsp;<span class="op" id="4004857">:=</span>&nbsp;<span class="keyword" id="4004860">range</span>&nbsp;<span class="ident" id="4004866"><a href="/crypto/x509/pem_decrypt.go.html#4004170">data</a></span><span class="op" id="4004870">[</span><span class="ident" id="4004871"><a href="/crypto/x509/pem_decrypt.go.html#4004564">dlen</a></span><span class="op" id="4004875">-</span><span class="ident" id="4004876"><a href="/crypto/x509/pem_decrypt.go.html#4004680">last</a></span><span class="op" id="4004880">:</span><span class="op" id="4004881">]</span>&nbsp;<span class="op" id="4004883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004887">if</span>&nbsp;<span class="builtintype" id="4004890">int</span><span class="op" id="4004893">(</span><span class="ident" id="4004894"><a href="/crypto/x509/pem_decrypt.go.html#4004853">val</a></span><span class="op" id="4004897">)</span>&nbsp;<span class="op" id="4004899">!=</span>&nbsp;<span class="ident" id="4004902"><a href="/crypto/x509/pem_decrypt.go.html#4004680">last</a></span>&nbsp;<span class="op" id="4004907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004912">return</span>&nbsp;<span class="ident" id="4004919">nil</span><span class="op" id="4004922">,</span>&nbsp;<span class="ident" id="4004924"><a href="/crypto/x509/pem_decrypt.go.html#4002904">IncorrectPasswordError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4004952">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4004955">return</span>&nbsp;<span class="ident" id="4004962"><a href="/crypto/x509/pem_decrypt.go.html#4004170">data</a></span><span class="op" id="4004966">[</span><span class="op" id="4004967">:</span><span class="ident" id="4004968"><a href="/crypto/x509/pem_decrypt.go.html#4004564">dlen</a></span><span class="op" id="4004972">-</span><span class="ident" id="4004973"><a href="/crypto/x509/pem_decrypt.go.html#4004680">last</a></span><span class="op" id="4004977">]</span><span class="op" id="4004978">,</span>&nbsp;<span class="ident" id="4004980">nil</span><br>
<span class="lineno"></span><span class="op" id="4004984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4004987">//&nbsp;EncryptPEMBlock&nbsp;returns&nbsp;a&nbsp;PEM&nbsp;block&nbsp;of&nbsp;the&nbsp;specified&nbsp;type&nbsp;holding&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4005060">//&nbsp;given&nbsp;DER-encoded&nbsp;data&nbsp;encrypted&nbsp;with&nbsp;the&nbsp;specified&nbsp;algorithm&nbsp;and</span><br>
<span class="lineno">175</span><span class="comment" id="4005129">//&nbsp;password.</span><br>
<span class="lineno"></span><span class="keyword" id="4005142">func</span>&nbsp;<span class="ident" id="4005147">EncryptPEMBlock</span><span class="op" id="4005162">(</span><span class="ident" id="4005163">rand</span>&nbsp;<span class="ident" id="4005168"><a href="/crypto/x509/pem_decrypt.go.html#4000868">io</a></span><span class="op" id="4005170">.</span><span class="ident" id="4005171">Reader</span><span class="op" id="4005177">,</span>&nbsp;<span class="ident" id="4005179">blockType</span>&nbsp;<span class="builtintype" id="4005189">string</span><span class="op" id="4005195">,</span>&nbsp;<span class="ident" id="4005197">data</span><span class="op" id="4005201">,</span>&nbsp;<span class="ident" id="4005203">password</span>&nbsp;<span class="op" id="4005212">[</span><span class="op" id="4005213">]</span><span class="builtintype" id="4005214">byte</span><span class="op" id="4005218">,</span>&nbsp;<span class="ident" id="4005220">alg</span>&nbsp;<span class="ident" id="4005224"><a href="/crypto/x509/pem_decrypt.go.html#4000892">PEMCipher</a></span><span class="op" id="4005233">)</span>&nbsp;<span class="op" id="4005235">(</span><span class="op" id="4005236">*</span><span class="ident" id="4005237"><a href="/crypto/x509/pem_decrypt.go.html#4000842">pem</a></span><span class="op" id="4005240">.</span><span class="ident" id="4005241">Block</span><span class="op" id="4005246">,</span>&nbsp;<span class="builtintype" id="4005248">error</span><span class="op" id="4005253">)</span>&nbsp;<span class="op" id="4005255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005258">ciph</span>&nbsp;<span class="op" id="4005263">:=</span>&nbsp;<span class="ident" id="4005266"><a href="/crypto/x509/pem_decrypt.go.html#4006567">cipherByKey</a></span><span class="op" id="4005277">(</span><span class="ident" id="4005278"><a href="/crypto/x509/pem_decrypt.go.html#4005220">alg</a></span><span class="op" id="4005281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005284">if</span>&nbsp;<span class="ident" id="4005287"><a href="/crypto/x509/pem_decrypt.go.html#4005258">ciph</a></span>&nbsp;<span class="op" id="4005292">==</span>&nbsp;<span class="ident" id="4005295">nil</span>&nbsp;<span class="op" id="4005299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005303">return</span>&nbsp;<span class="ident" id="4005310">nil</span><span class="op" id="4005313">,</span>&nbsp;<span class="ident" id="4005315"><a href="/crypto/x509/pem_decrypt.go.html#4000858">errors</a></span><span class="op" id="4005321">.</span><span class="ident" id="4005322">New</span><span class="op" id="4005325">(</span><span class="string" id="4005326">&#34;x509:&nbsp;unknown&nbsp;encryption&nbsp;mode&#34;</span><span class="op" id="4005357">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005363">iv</span>&nbsp;<span class="op" id="4005366">:=</span>&nbsp;<span class="builtinfunc" id="4005369">make</span><span class="op" id="4005373">(</span><span class="op" id="4005374">[</span><span class="op" id="4005375">]</span><span class="builtintype" id="4005376">byte</span><span class="op" id="4005380">,</span>&nbsp;<span class="ident" id="4005382"><a href="/crypto/x509/pem_decrypt.go.html#4005258">ciph</a></span><span class="op" id="4005386">.</span><span class="ident" id="4005387">blockSize</span><span class="op" id="4005396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005399">if</span>&nbsp;<span class="ident" id="4005402">_</span><span class="op" id="4005403">,</span>&nbsp;<span class="ident" id="4005405">err</span>&nbsp;<span class="op" id="4005409">:=</span>&nbsp;<span class="ident" id="4005412"><a href="/crypto/x509/pem_decrypt.go.html#4000868">io</a></span><span class="op" id="4005414">.</span><span class="ident" id="4005415">ReadFull</span><span class="op" id="4005423">(</span><span class="ident" id="4005424"><a href="/crypto/x509/pem_decrypt.go.html#4005163">rand</a></span><span class="op" id="4005428">,</span>&nbsp;<span class="ident" id="4005430"><a href="/crypto/x509/pem_decrypt.go.html#4005363">iv</a></span><span class="op" id="4005432">)</span><span class="op" id="4005433">;</span>&nbsp;<span class="ident" id="4005435"><a href="/crypto/x509/pem_decrypt.go.html#4005405">err</a></span>&nbsp;<span class="op" id="4005439">!=</span>&nbsp;<span class="ident" id="4005442">nil</span>&nbsp;<span class="op" id="4005446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005450">return</span>&nbsp;<span class="ident" id="4005457">nil</span><span class="op" id="4005460">,</span>&nbsp;<span class="ident" id="4005462"><a href="/crypto/x509/pem_decrypt.go.html#4000858">errors</a></span><span class="op" id="4005468">.</span><span class="ident" id="4005469">New</span><span class="op" id="4005472">(</span><span class="string" id="4005473">&#34;x509:&nbsp;cannot&nbsp;generate&nbsp;IV:&nbsp;&#34;</span>&nbsp;<span class="op" id="4005502">+</span>&nbsp;<span class="ident" id="4005504"><a href="/crypto/x509/pem_decrypt.go.html#4005405">err</a></span><span class="op" id="4005507">.</span><span class="ident" id="4005508">Error</span><span class="op" id="4005513">(</span><span class="op" id="4005514">)</span><span class="op" id="4005515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005518">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4005521">//&nbsp;The&nbsp;salt&nbsp;is&nbsp;the&nbsp;first&nbsp;8&nbsp;bytes&nbsp;of&nbsp;the&nbsp;initialization&nbsp;vector,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4005585">//&nbsp;matching&nbsp;the&nbsp;key&nbsp;derivation&nbsp;in&nbsp;DecryptPEMBlock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005637">key</span>&nbsp;<span class="op" id="4005641">:=</span>&nbsp;<span class="ident" id="4005644"><a href="/crypto/x509/pem_decrypt.go.html#4005258">ciph</a></span><span class="op" id="4005648">.</span><span class="ident" id="4005649">deriveKey</span><span class="op" id="4005658">(</span><span class="ident" id="4005659"><a href="/crypto/x509/pem_decrypt.go.html#4005203">password</a></span><span class="op" id="4005667">,</span>&nbsp;<span class="ident" id="4005669"><a href="/crypto/x509/pem_decrypt.go.html#4005363">iv</a></span><span class="op" id="4005671">[</span><span class="op" id="4005672">:</span><span class="num" id="4005673">8</span><span class="op" id="4005674">]</span><span class="op" id="4005675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005678">block</span><span class="op" id="4005683">,</span>&nbsp;<span class="ident" id="4005685">err</span>&nbsp;<span class="op" id="4005689">:=</span>&nbsp;<span class="ident" id="4005692"><a href="/crypto/x509/pem_decrypt.go.html#4005258">ciph</a></span><span class="op" id="4005696">.</span><span class="ident" id="4005697">cipherFunc</span><span class="op" id="4005707">(</span><span class="ident" id="4005708"><a href="/crypto/x509/pem_decrypt.go.html#4005637">key</a></span><span class="op" id="4005711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005714">if</span>&nbsp;<span class="ident" id="4005717"><a href="/crypto/x509/pem_decrypt.go.html#4005685">err</a></span>&nbsp;<span class="op" id="4005721">!=</span>&nbsp;<span class="ident" id="4005724">nil</span>&nbsp;<span class="op" id="4005728">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4005732">return</span>&nbsp;<span class="ident" id="4005739">nil</span><span class="op" id="4005742">,</span>&nbsp;<span class="ident" id="4005744"><a href="/crypto/x509/pem_decrypt.go.html#4005685">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4005749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005752">enc</span>&nbsp;<span class="op" id="4005756">:=</span>&nbsp;<span class="ident" id="4005759"><a href="/crypto/x509/pem_decrypt.go.html#4000781">cipher</a></span><span class="op" id="4005765">.</span><span class="ident" id="4005766">NewCBCEncrypter</span><span class="op" id="4005781">(</span><span class="ident" id="4005782"><a href="/crypto/x509/pem_decrypt.go.html#4005678">block</a></span><span class="op" id="4005787">,</span>&nbsp;<span class="ident" id="4005789"><a href="/crypto/x509/pem_decrypt.go.html#4005363">iv</a></span><span class="op" id="4005791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005794">pad</span>&nbsp;<span class="op" id="4005798">:=</span>&nbsp;<span class="ident" id="4005801"><a href="/crypto/x509/pem_decrypt.go.html#4005258">ciph</a></span><span class="op" id="4005805">.</span><span class="ident" id="4005806">blockSize</span>&nbsp;<span class="op" id="4005816">-</span>&nbsp;<span class="builtinfunc" id="4005818">len</span><span class="op" id="4005821">(</span><span class="ident" id="4005822"><a href="/crypto/x509/pem_decrypt.go.html#4005197">data</a></span><span class="op" id="4005826">)</span><span class="op" id="4005827">%</span><span class="ident" id="4005828"><a href="/crypto/x509/pem_decrypt.go.html#4005258">ciph</a></span><span class="op" id="4005832">.</span><span class="ident" id="4005833">blockSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4005844">encrypted</span>&nbsp;<span class="op" id="4005854">:=</span>&nbsp;<span class="builtinfunc" id="4005857">make</span><span class="op" id="4005861">(</span><span class="op" id="4005862">[</span><span class="op" id="4005863">]</span><span class="builtintype" id="4005864">byte</span><span class="op" id="4005868">,</span>&nbsp;<span class="builtinfunc" id="4005870">len</span><span class="op" id="4005873">(</span><span class="ident" id="4005874"><a href="/crypto/x509/pem_decrypt.go.html#4005197">data</a></span><span class="op" id="4005878">)</span><span class="op" id="4005879">,</span>&nbsp;<span class="builtinfunc" id="4005881">len</span><span class="op" id="4005884">(</span><span class="ident" id="4005885"><a href="/crypto/x509/pem_decrypt.go.html#4005197">data</a></span><span class="op" id="4005889">)</span><span class="op" id="4005890">+</span><span class="ident" id="4005891"><a href="/crypto/x509/pem_decrypt.go.html#4005794">pad</a></span><span class="op" id="4005894">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4005897">//&nbsp;We&nbsp;could&nbsp;save&nbsp;this&nbsp;copy&nbsp;by&nbsp;encrypting&nbsp;all&nbsp;the&nbsp;whole&nbsp;blocks&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4005963">//&nbsp;the&nbsp;data&nbsp;separately,&nbsp;but&nbsp;it&nbsp;doesn&#39;t&nbsp;seem&nbsp;worth&nbsp;the&nbsp;additional</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4006029">//&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4006039">copy</span><span class="op" id="4006043">(</span><span class="ident" id="4006044"><a href="/crypto/x509/pem_decrypt.go.html#4005844">encrypted</a></span><span class="op" id="4006053">,</span>&nbsp;<span class="ident" id="4006055"><a href="/crypto/x509/pem_decrypt.go.html#4005197">data</a></span><span class="op" id="4006059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4006062">//&nbsp;See&nbsp;RFC&nbsp;1423,&nbsp;section&nbsp;1.1</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006092">for</span>&nbsp;<span class="ident" id="4006096">i</span>&nbsp;<span class="op" id="4006098">:=</span>&nbsp;<span class="num" id="4006101">0</span><span class="op" id="4006102">;</span>&nbsp;<span class="ident" id="4006104"><a href="/crypto/x509/pem_decrypt.go.html#4006096">i</a></span>&nbsp;<span class="op" id="4006106">&lt;</span>&nbsp;<span class="ident" id="4006108"><a href="/crypto/x509/pem_decrypt.go.html#4005794">pad</a></span><span class="op" id="4006111">;</span>&nbsp;<span class="ident" id="4006113"><a href="/crypto/x509/pem_decrypt.go.html#4006096">i</a></span><span class="op" id="4006114">++</span>&nbsp;<span class="op" id="4006117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006121"><a href="/crypto/x509/pem_decrypt.go.html#4005844">encrypted</a></span>&nbsp;<span class="op" id="4006131">=</span>&nbsp;<span class="builtinfunc" id="4006133">append</span><span class="op" id="4006139">(</span><span class="ident" id="4006140"><a href="/crypto/x509/pem_decrypt.go.html#4005844">encrypted</a></span><span class="op" id="4006149">,</span>&nbsp;<span class="builtintype" id="4006151">byte</span><span class="op" id="4006155">(</span><span class="ident" id="4006156"><a href="/crypto/x509/pem_decrypt.go.html#4005794">pad</a></span><span class="op" id="4006159">)</span><span class="op" id="4006160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006166"><a href="/crypto/x509/pem_decrypt.go.html#4005752">enc</a></span><span class="op" id="4006169">.</span><span class="ident" id="4006170">CryptBlocks</span><span class="op" id="4006181">(</span><span class="ident" id="4006182"><a href="/crypto/x509/pem_decrypt.go.html#4005844">encrypted</a></span><span class="op" id="4006191">,</span>&nbsp;<span class="ident" id="4006193"><a href="/crypto/x509/pem_decrypt.go.html#4005844">encrypted</a></span><span class="op" id="4006202">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006206">return</span>&nbsp;<span class="op" id="4006213">&amp;</span><span class="ident" id="4006214"><a href="/crypto/x509/pem_decrypt.go.html#4000842">pem</a></span><span class="op" id="4006217">.</span><span class="ident" id="4006218">Block</span><span class="op" id="4006223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006227">Type</span><span class="op" id="4006231">:</span>&nbsp;<span class="ident" id="4006233"><a href="/crypto/x509/pem_decrypt.go.html#4005179">blockType</a></span><span class="op" id="4006242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006246">Headers</span><span class="op" id="4006253">:</span>&nbsp;<span class="keyword" id="4006255">map</span><span class="op" id="4006258">[</span><span class="builtintype" id="4006259">string</span><span class="op" id="4006265">]</span><span class="builtintype" id="4006266">string</span><span class="op" id="4006272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4006277">&#34;Proc-Type&#34;</span><span class="op" id="4006288">:</span>&nbsp;<span class="string" id="4006290">&#34;4,ENCRYPTED&#34;</span><span class="op" id="4006303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4006308">&#34;DEK-Info&#34;</span><span class="op" id="4006318">:</span>&nbsp;&nbsp;<span class="ident" id="4006321"><a href="/crypto/x509/pem_decrypt.go.html#4005258">ciph</a></span><span class="op" id="4006325">.</span><span class="ident" id="4006326">name</span>&nbsp;<span class="op" id="4006331">+</span>&nbsp;<span class="string" id="4006333">&#34;,&#34;</span>&nbsp;<span class="op" id="4006337">+</span>&nbsp;<span class="ident" id="4006339"><a href="/crypto/x509/pem_decrypt.go.html#4000826">hex</a></span><span class="op" id="4006342">.</span><span class="ident" id="4006343">EncodeToString</span><span class="op" id="4006357">(</span><span class="ident" id="4006358"><a href="/crypto/x509/pem_decrypt.go.html#4005363">iv</a></span><span class="op" id="4006360">)</span><span class="op" id="4006361">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006365">}</span><span class="op" id="4006366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006370">Bytes</span><span class="op" id="4006375">:</span>&nbsp;<span class="ident" id="4006377"><a href="/crypto/x509/pem_decrypt.go.html#4005844">encrypted</a></span><span class="op" id="4006386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006389">}</span><span class="op" id="4006390">,</span>&nbsp;<span class="ident" id="4006392">nil</span><br>
<span class="lineno"></span><span class="op" id="4006396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="4006399">func</span>&nbsp;<span class="ident" id="4006404">cipherByName</span><span class="op" id="4006416">(</span><span class="ident" id="4006417">name</span>&nbsp;<span class="builtintype" id="4006422">string</span><span class="op" id="4006428">)</span>&nbsp;<span class="op" id="4006430">*</span><span class="ident" id="4006431"><a href="/crypto/x509/pem_decrypt.go.html#4001147">rfc1423Algo</a></span>&nbsp;<span class="op" id="4006443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006446">for</span>&nbsp;<span class="ident" id="4006450">i</span>&nbsp;<span class="op" id="4006452">:=</span>&nbsp;<span class="keyword" id="4006455">range</span>&nbsp;<span class="ident" id="4006461"><a href="/crypto/x509/pem_decrypt.go.html#4001433">rfc1423Algos</a></span>&nbsp;<span class="op" id="4006474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006478">alg</span>&nbsp;<span class="op" id="4006482">:=</span>&nbsp;<span class="op" id="4006485">&amp;</span><span class="ident" id="4006486"><a href="/crypto/x509/pem_decrypt.go.html#4001433">rfc1423Algos</a></span><span class="op" id="4006498">[</span><span class="ident" id="4006499"><a href="/crypto/x509/pem_decrypt.go.html#4006450">i</a></span><span class="op" id="4006500">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006504">if</span>&nbsp;<span class="ident" id="4006507"><a href="/crypto/x509/pem_decrypt.go.html#4006478">alg</a></span><span class="op" id="4006510">.</span><span class="ident" id="4006511">name</span>&nbsp;<span class="op" id="4006516">==</span>&nbsp;<span class="ident" id="4006519"><a href="/crypto/x509/pem_decrypt.go.html#4006417">name</a></span>&nbsp;<span class="op" id="4006524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006529">return</span>&nbsp;<span class="ident" id="4006536"><a href="/crypto/x509/pem_decrypt.go.html#4006478">alg</a></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006548">return</span>&nbsp;<span class="ident" id="4006555">nil</span><br>
<span class="lineno"></span><span class="op" id="4006559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="4006562">func</span>&nbsp;<span class="ident" id="4006567">cipherByKey</span><span class="op" id="4006578">(</span><span class="ident" id="4006579">key</span>&nbsp;<span class="ident" id="4006583"><a href="/crypto/x509/pem_decrypt.go.html#4000892">PEMCipher</a></span><span class="op" id="4006592">)</span>&nbsp;<span class="op" id="4006594">*</span><span class="ident" id="4006595"><a href="/crypto/x509/pem_decrypt.go.html#4001147">rfc1423Algo</a></span>&nbsp;<span class="op" id="4006607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006610">for</span>&nbsp;<span class="ident" id="4006614">i</span>&nbsp;<span class="op" id="4006616">:=</span>&nbsp;<span class="keyword" id="4006619">range</span>&nbsp;<span class="ident" id="4006625"><a href="/crypto/x509/pem_decrypt.go.html#4001433">rfc1423Algos</a></span>&nbsp;<span class="op" id="4006638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4006642">alg</span>&nbsp;<span class="op" id="4006646">:=</span>&nbsp;<span class="op" id="4006649">&amp;</span><span class="ident" id="4006650"><a href="/crypto/x509/pem_decrypt.go.html#4001433">rfc1423Algos</a></span><span class="op" id="4006662">[</span><span class="ident" id="4006663"><a href="/crypto/x509/pem_decrypt.go.html#4006614">i</a></span><span class="op" id="4006664">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006668">if</span>&nbsp;<span class="ident" id="4006671"><a href="/crypto/x509/pem_decrypt.go.html#4006642">alg</a></span><span class="op" id="4006674">.</span><span class="ident" id="4006675">cipher</span>&nbsp;<span class="op" id="4006682">==</span>&nbsp;<span class="ident" id="4006685"><a href="/crypto/x509/pem_decrypt.go.html#4006579">key</a></span>&nbsp;<span class="op" id="4006689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006694">return</span>&nbsp;<span class="ident" id="4006701"><a href="/crypto/x509/pem_decrypt.go.html#4006642">alg</a></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4006710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4006713">return</span>&nbsp;<span class="ident" id="4006720">nil</span><br>
<span class="lineno"></span><span class="op" id="4006724">}</span>
</div>
</body>
</html>
