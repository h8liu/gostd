<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8514593">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8514649">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8514703">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8514754">package</span>&nbsp;<span class="ident" id="8514762">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8514767">import</span>&nbsp;<span class="op" id="8514774">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514777">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514788">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514799">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514810">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8514821">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8514828">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="8514831">func</span>&nbsp;<span class="ident" id="8514836">TestResolveUDPAddr</span><span class="op" id="8514854">(</span><span class="ident" id="8514855">t</span>&nbsp;<span class="op" id="8514857">*</span><span class="ident" id="8514858">testing</span><span class="op" id="8514865">.</span><span class="ident" id="8514866">T</span><span class="op" id="8514867">)</span>&nbsp;<span class="op" id="8514869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8514872">for</span>&nbsp;<span class="ident" id="8514876">_</span><span class="op" id="8514877">,</span>&nbsp;<span class="ident" id="8514879">tt</span>&nbsp;<span class="op" id="8514882">:=</span>&nbsp;<span class="keyword" id="8514885">range</span>&nbsp;<span class="ident" id="8514891">resolveTCPAddrTests</span>&nbsp;<span class="op" id="8514911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514915">net</span>&nbsp;<span class="op" id="8514919">:=</span>&nbsp;<span class="ident" id="8514922">strings</span><span class="op" id="8514929">.</span><span class="ident" id="8514930">Replace</span><span class="op" id="8514937">(</span><span class="ident" id="8514938">tt</span><span class="op" id="8514940">.</span><span class="ident" id="8514941">net</span><span class="op" id="8514944">,</span>&nbsp;<span class="string" id="8514946">&#34;tcp&#34;</span><span class="op" id="8514951">,</span>&nbsp;<span class="string" id="8514953">&#34;udp&#34;</span><span class="op" id="8514958">,</span>&nbsp;<span class="op" id="8514960">-</span><span class="num" id="8514961">1</span><span class="op" id="8514962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8514966">addr</span><span class="op" id="8514970">,</span>&nbsp;<span class="ident" id="8514972">err</span>&nbsp;<span class="op" id="8514976">:=</span>&nbsp;<span class="ident" id="8514979">ResolveUDPAddr</span><span class="op" id="8514993">(</span><span class="ident" id="8514994">net</span><span class="op" id="8514997">,</span>&nbsp;<span class="ident" id="8514999">tt</span><span class="op" id="8515001">.</span><span class="ident" id="8515002">litAddrOrName</span><span class="op" id="8515015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8515019">if</span>&nbsp;<span class="ident" id="8515022">err</span>&nbsp;<span class="op" id="8515026">!=</span>&nbsp;<span class="ident" id="8515029">tt</span><span class="op" id="8515031">.</span><span class="ident" id="8515032">err</span>&nbsp;<span class="op" id="8515036">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515041">t</span><span class="op" id="8515042">.</span><span class="ident" id="8515043">Fatalf</span><span class="op" id="8515049">(</span><span class="string" id="8515050">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8515085">,</span>&nbsp;<span class="ident" id="8515087">net</span><span class="op" id="8515090">,</span>&nbsp;<span class="ident" id="8515092">tt</span><span class="op" id="8515094">.</span><span class="ident" id="8515095">litAddrOrName</span><span class="op" id="8515108">,</span>&nbsp;<span class="ident" id="8515110">err</span><span class="op" id="8515113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8515121">if</span>&nbsp;<span class="op" id="8515124">!</span><span class="ident" id="8515125">reflect</span><span class="op" id="8515132">.</span><span class="ident" id="8515133">DeepEqual</span><span class="op" id="8515142">(</span><span class="ident" id="8515143">addr</span><span class="op" id="8515147">,</span>&nbsp;<span class="op" id="8515149">(</span><span class="op" id="8515150">*</span><span class="ident" id="8515151">UDPAddr</span><span class="op" id="8515158">)</span><span class="op" id="8515159">(</span><span class="ident" id="8515160">tt</span><span class="op" id="8515162">.</span><span class="ident" id="8515163">addr</span><span class="op" id="8515167">)</span><span class="op" id="8515168">)</span>&nbsp;<span class="op" id="8515170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515175">t</span><span class="op" id="8515176">.</span><span class="ident" id="8515177">Fatalf</span><span class="op" id="8515183">(</span><span class="string" id="8515184">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8515224">,</span>&nbsp;<span class="ident" id="8515226">net</span><span class="op" id="8515229">,</span>&nbsp;<span class="ident" id="8515231">tt</span><span class="op" id="8515233">.</span><span class="ident" id="8515234">litAddrOrName</span><span class="op" id="8515247">,</span>&nbsp;<span class="ident" id="8515249">addr</span><span class="op" id="8515253">,</span>&nbsp;<span class="ident" id="8515255">tt</span><span class="op" id="8515257">.</span><span class="ident" id="8515258">addr</span><span class="op" id="8515262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515266">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8515270">if</span>&nbsp;<span class="ident" id="8515273">err</span>&nbsp;<span class="op" id="8515277">==</span>&nbsp;<span class="ident" id="8515280">nil</span>&nbsp;<span class="op" id="8515284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515289">str</span>&nbsp;<span class="op" id="8515293">:=</span>&nbsp;<span class="ident" id="8515296">addr</span><span class="op" id="8515300">.</span><span class="ident" id="8515301">String</span><span class="op" id="8515307">(</span><span class="op" id="8515308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515313">addr1</span><span class="op" id="8515318">,</span>&nbsp;<span class="ident" id="8515320">err</span>&nbsp;<span class="op" id="8515324">:=</span>&nbsp;<span class="ident" id="8515327">ResolveUDPAddr</span><span class="op" id="8515341">(</span><span class="ident" id="8515342">net</span><span class="op" id="8515345">,</span>&nbsp;<span class="ident" id="8515347">str</span><span class="op" id="8515350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8515355">if</span>&nbsp;<span class="ident" id="8515358">err</span>&nbsp;<span class="op" id="8515362">!=</span>&nbsp;<span class="ident" id="8515365">nil</span>&nbsp;<span class="op" id="8515369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515375">t</span><span class="op" id="8515376">.</span><span class="ident" id="8515377">Fatalf</span><span class="op" id="8515383">(</span><span class="string" id="8515384">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]:&nbsp;%v&#34;</span><span class="op" id="8515422">,</span>&nbsp;<span class="ident" id="8515424">net</span><span class="op" id="8515427">,</span>&nbsp;<span class="ident" id="8515429">str</span><span class="op" id="8515432">,</span>&nbsp;<span class="ident" id="8515434">tt</span><span class="op" id="8515436">.</span><span class="ident" id="8515437">litAddrOrName</span><span class="op" id="8515450">,</span>&nbsp;<span class="ident" id="8515452">err</span><span class="op" id="8515455">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8515465">if</span>&nbsp;<span class="op" id="8515468">!</span><span class="ident" id="8515469">reflect</span><span class="op" id="8515476">.</span><span class="ident" id="8515477">DeepEqual</span><span class="op" id="8515486">(</span><span class="ident" id="8515487">addr1</span><span class="op" id="8515492">,</span>&nbsp;<span class="ident" id="8515494">addr</span><span class="op" id="8515498">)</span>&nbsp;<span class="op" id="8515500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515506">t</span><span class="op" id="8515507">.</span><span class="ident" id="8515508">Fatalf</span><span class="op" id="8515514">(</span><span class="string" id="8515515">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="8515565">,</span>&nbsp;<span class="ident" id="8515567">net</span><span class="op" id="8515570">,</span>&nbsp;<span class="ident" id="8515572">str</span><span class="op" id="8515575">,</span>&nbsp;<span class="ident" id="8515577">tt</span><span class="op" id="8515579">.</span><span class="ident" id="8515580">litAddrOrName</span><span class="op" id="8515593">,</span>&nbsp;<span class="ident" id="8515595">addr1</span><span class="op" id="8515600">,</span>&nbsp;<span class="ident" id="8515602">addr</span><span class="op" id="8515606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515615">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515618">}</span><br>
<span class="lineno"></span><span class="op" id="8515620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8515623">func</span>&nbsp;<span class="ident" id="8515628">TestReadFromUDP</span><span class="op" id="8515643">(</span><span class="ident" id="8515644">t</span>&nbsp;<span class="op" id="8515646">*</span><span class="ident" id="8515647">testing</span><span class="op" id="8515654">.</span><span class="ident" id="8515655">T</span><span class="op" id="8515656">)</span>&nbsp;<span class="op" id="8515658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8515661">switch</span>&nbsp;<span class="ident" id="8515668">runtime</span><span class="op" id="8515675">.</span><span class="ident" id="8515676">GOOS</span>&nbsp;<span class="op" id="8515681">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8515684">case</span>&nbsp;<span class="string" id="8515689">&#34;nacl&#34;</span><span class="op" id="8515695">,</span>&nbsp;<span class="string" id="8515697">&#34;plan9&#34;</span><span class="op" id="8515704">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515708">t</span><span class="op" id="8515709">.</span><span class="ident" id="8515710">Skipf</span><span class="op" id="8515715">(</span><span class="string" id="8515716">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q,&nbsp;see&nbsp;issue&nbsp;8916&#34;</span><span class="op" id="8515753">,</span>&nbsp;<span class="ident" id="8515755">runtime</span><span class="op" id="8515762">.</span><span class="ident" id="8515763">GOOS</span><span class="op" id="8515767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515774">ra</span><span class="op" id="8515776">,</span>&nbsp;<span class="ident" id="8515778">err</span>&nbsp;<span class="op" id="8515782">:=</span>&nbsp;<span class="ident" id="8515785">ResolveUDPAddr</span><span class="op" id="8515799">(</span><span class="string" id="8515800">&#34;udp&#34;</span><span class="op" id="8515805">,</span>&nbsp;<span class="string" id="8515807">&#34;127.0.0.1:7&#34;</span><span class="op" id="8515820">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8515823">if</span>&nbsp;<span class="ident" id="8515826">err</span>&nbsp;<span class="op" id="8515830">!=</span>&nbsp;<span class="ident" id="8515833">nil</span>&nbsp;<span class="op" id="8515837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515841">t</span><span class="op" id="8515842">.</span><span class="ident" id="8515843">Fatal</span><span class="op" id="8515848">(</span><span class="ident" id="8515849">err</span><span class="op" id="8515852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515859">la</span><span class="op" id="8515861">,</span>&nbsp;<span class="ident" id="8515863">err</span>&nbsp;<span class="op" id="8515867">:=</span>&nbsp;<span class="ident" id="8515870">ResolveUDPAddr</span><span class="op" id="8515884">(</span><span class="string" id="8515885">&#34;udp&#34;</span><span class="op" id="8515890">,</span>&nbsp;<span class="string" id="8515892">&#34;127.0.0.1:0&#34;</span><span class="op" id="8515905">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8515908">if</span>&nbsp;<span class="ident" id="8515911">err</span>&nbsp;<span class="op" id="8515915">!=</span>&nbsp;<span class="ident" id="8515918">nil</span>&nbsp;<span class="op" id="8515922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515926">t</span><span class="op" id="8515927">.</span><span class="ident" id="8515928">Fatal</span><span class="op" id="8515933">(</span><span class="ident" id="8515934">err</span><span class="op" id="8515937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8515940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515944">c</span><span class="op" id="8515945">,</span>&nbsp;<span class="ident" id="8515947">err</span>&nbsp;<span class="op" id="8515951">:=</span>&nbsp;<span class="ident" id="8515954">ListenUDP</span><span class="op" id="8515963">(</span><span class="string" id="8515964">&#34;udp&#34;</span><span class="op" id="8515969">,</span>&nbsp;<span class="ident" id="8515971">la</span><span class="op" id="8515973">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8515976">if</span>&nbsp;<span class="ident" id="8515979">err</span>&nbsp;<span class="op" id="8515983">!=</span>&nbsp;<span class="ident" id="8515986">nil</span>&nbsp;<span class="op" id="8515990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8515994">t</span><span class="op" id="8515995">.</span><span class="ident" id="8515996">Fatal</span><span class="op" id="8516001">(</span><span class="ident" id="8516002">err</span><span class="op" id="8516005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516011">defer</span>&nbsp;<span class="ident" id="8516017">c</span><span class="op" id="8516018">.</span><span class="ident" id="8516019">Close</span><span class="op" id="8516024">(</span><span class="op" id="8516025">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516029">_</span><span class="op" id="8516030">,</span>&nbsp;<span class="ident" id="8516032">err</span>&nbsp;<span class="op" id="8516036">=</span>&nbsp;<span class="ident" id="8516038">c</span><span class="op" id="8516039">.</span><span class="ident" id="8516040">WriteToUDP</span><span class="op" id="8516050">(</span><span class="op" id="8516051">[</span><span class="op" id="8516052">]</span><span class="builtintype" id="8516053">byte</span><span class="op" id="8516057">(</span><span class="string" id="8516058">&#34;a&#34;</span><span class="op" id="8516061">)</span><span class="op" id="8516062">,</span>&nbsp;<span class="ident" id="8516064">ra</span><span class="op" id="8516066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516069">if</span>&nbsp;<span class="ident" id="8516072">err</span>&nbsp;<span class="op" id="8516076">!=</span>&nbsp;<span class="ident" id="8516079">nil</span>&nbsp;<span class="op" id="8516083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516087">t</span><span class="op" id="8516088">.</span><span class="ident" id="8516089">Fatal</span><span class="op" id="8516094">(</span><span class="ident" id="8516095">err</span><span class="op" id="8516098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516105">err</span>&nbsp;<span class="op" id="8516109">=</span>&nbsp;<span class="ident" id="8516111">c</span><span class="op" id="8516112">.</span><span class="ident" id="8516113">SetDeadline</span><span class="op" id="8516124">(</span><span class="ident" id="8516125">time</span><span class="op" id="8516129">.</span><span class="ident" id="8516130">Now</span><span class="op" id="8516133">(</span><span class="op" id="8516134">)</span><span class="op" id="8516135">.</span><span class="ident" id="8516136">Add</span><span class="op" id="8516139">(</span><span class="num" id="8516140">100</span>&nbsp;<span class="op" id="8516144">*</span>&nbsp;<span class="ident" id="8516146">time</span><span class="op" id="8516150">.</span><span class="ident" id="8516151">Millisecond</span><span class="op" id="8516162">)</span><span class="op" id="8516163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516166">if</span>&nbsp;<span class="ident" id="8516169">err</span>&nbsp;<span class="op" id="8516173">!=</span>&nbsp;<span class="ident" id="8516176">nil</span>&nbsp;<span class="op" id="8516180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516184">t</span><span class="op" id="8516185">.</span><span class="ident" id="8516186">Fatal</span><span class="op" id="8516191">(</span><span class="ident" id="8516192">err</span><span class="op" id="8516195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516201">b</span>&nbsp;<span class="op" id="8516203">:=</span>&nbsp;<span class="builtinfunc" id="8516206">make</span><span class="op" id="8516210">(</span><span class="op" id="8516211">[</span><span class="op" id="8516212">]</span><span class="builtintype" id="8516213">byte</span><span class="op" id="8516217">,</span>&nbsp;<span class="num" id="8516219">1</span><span class="op" id="8516220">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516223">_</span><span class="op" id="8516224">,</span>&nbsp;<span class="ident" id="8516226">_</span><span class="op" id="8516227">,</span>&nbsp;<span class="ident" id="8516229">err</span>&nbsp;<span class="op" id="8516233">=</span>&nbsp;<span class="ident" id="8516235">c</span><span class="op" id="8516236">.</span><span class="ident" id="8516237">ReadFromUDP</span><span class="op" id="8516248">(</span><span class="ident" id="8516249">b</span><span class="op" id="8516250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516253">if</span>&nbsp;<span class="ident" id="8516256">err</span>&nbsp;<span class="op" id="8516260">==</span>&nbsp;<span class="ident" id="8516263">nil</span>&nbsp;<span class="op" id="8516267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516271">t</span><span class="op" id="8516272">.</span><span class="ident" id="8516273">Fatal</span><span class="op" id="8516278">(</span><span class="string" id="8516279">&#34;ReadFromUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8516304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516307">}</span>&nbsp;<span class="keyword" id="8516309">else</span>&nbsp;<span class="keyword" id="8516314">if</span>&nbsp;<span class="op" id="8516317">!</span><span class="ident" id="8516318">isTimeout</span><span class="op" id="8516327">(</span><span class="ident" id="8516328">err</span><span class="op" id="8516331">)</span>&nbsp;<span class="op" id="8516333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516337">t</span><span class="op" id="8516338">.</span><span class="ident" id="8516339">Fatal</span><span class="op" id="8516344">(</span><span class="ident" id="8516345">err</span><span class="op" id="8516348">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516351">}</span><br>
<span class="lineno"></span><span class="op" id="8516353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8516356">func</span>&nbsp;<span class="ident" id="8516361">TestWriteToUDP</span><span class="op" id="8516375">(</span><span class="ident" id="8516376">t</span>&nbsp;<span class="op" id="8516378">*</span><span class="ident" id="8516379">testing</span><span class="op" id="8516386">.</span><span class="ident" id="8516387">T</span><span class="op" id="8516388">)</span>&nbsp;<span class="op" id="8516390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516393">switch</span>&nbsp;<span class="ident" id="8516400">runtime</span><span class="op" id="8516407">.</span><span class="ident" id="8516408">GOOS</span>&nbsp;<span class="op" id="8516413">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516416">case</span>&nbsp;<span class="string" id="8516421">&#34;plan9&#34;</span><span class="op" id="8516428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516432">t</span><span class="op" id="8516433">.</span><span class="ident" id="8516434">Skipf</span><span class="op" id="8516439">(</span><span class="string" id="8516440">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8516461">,</span>&nbsp;<span class="ident" id="8516463">runtime</span><span class="op" id="8516470">.</span><span class="ident" id="8516471">GOOS</span><span class="op" id="8516475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516482">l</span><span class="op" id="8516483">,</span>&nbsp;<span class="ident" id="8516485">err</span>&nbsp;<span class="op" id="8516489">:=</span>&nbsp;<span class="ident" id="8516492">ListenPacket</span><span class="op" id="8516504">(</span><span class="string" id="8516505">&#34;udp&#34;</span><span class="op" id="8516510">,</span>&nbsp;<span class="string" id="8516512">&#34;127.0.0.1:0&#34;</span><span class="op" id="8516525">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516528">if</span>&nbsp;<span class="ident" id="8516531">err</span>&nbsp;<span class="op" id="8516535">!=</span>&nbsp;<span class="ident" id="8516538">nil</span>&nbsp;<span class="op" id="8516542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516546">t</span><span class="op" id="8516547">.</span><span class="ident" id="8516548">Fatalf</span><span class="op" id="8516554">(</span><span class="string" id="8516555">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8516574">,</span>&nbsp;<span class="ident" id="8516576">err</span><span class="op" id="8516579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516585">defer</span>&nbsp;<span class="ident" id="8516591">l</span><span class="op" id="8516592">.</span><span class="ident" id="8516593">Close</span><span class="op" id="8516598">(</span><span class="op" id="8516599">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516603">testWriteToConn</span><span class="op" id="8516618">(</span><span class="ident" id="8516619">t</span><span class="op" id="8516620">,</span>&nbsp;<span class="ident" id="8516622">l</span><span class="op" id="8516623">.</span><span class="ident" id="8516624">LocalAddr</span><span class="op" id="8516633">(</span><span class="op" id="8516634">)</span><span class="op" id="8516635">.</span><span class="ident" id="8516636">String</span><span class="op" id="8516642">(</span><span class="op" id="8516643">)</span><span class="op" id="8516644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516647">testWriteToPacketConn</span><span class="op" id="8516668">(</span><span class="ident" id="8516669">t</span><span class="op" id="8516670">,</span>&nbsp;<span class="ident" id="8516672">l</span><span class="op" id="8516673">.</span><span class="ident" id="8516674">LocalAddr</span><span class="op" id="8516683">(</span><span class="op" id="8516684">)</span><span class="op" id="8516685">.</span><span class="ident" id="8516686">String</span><span class="op" id="8516692">(</span><span class="op" id="8516693">)</span><span class="op" id="8516694">)</span><br>
<span class="lineno"></span><span class="op" id="8516696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8516699">func</span>&nbsp;<span class="ident" id="8516704">testWriteToConn</span><span class="op" id="8516719">(</span><span class="ident" id="8516720">t</span>&nbsp;<span class="op" id="8516722">*</span><span class="ident" id="8516723">testing</span><span class="op" id="8516730">.</span><span class="ident" id="8516731">T</span><span class="op" id="8516732">,</span>&nbsp;<span class="ident" id="8516734">raddr</span>&nbsp;<span class="builtintype" id="8516740">string</span><span class="op" id="8516746">)</span>&nbsp;<span class="op" id="8516748">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516751">c</span><span class="op" id="8516752">,</span>&nbsp;<span class="ident" id="8516754">err</span>&nbsp;<span class="op" id="8516758">:=</span>&nbsp;<span class="ident" id="8516761">Dial</span><span class="op" id="8516765">(</span><span class="string" id="8516766">&#34;udp&#34;</span><span class="op" id="8516771">,</span>&nbsp;<span class="ident" id="8516773">raddr</span><span class="op" id="8516778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516781">if</span>&nbsp;<span class="ident" id="8516784">err</span>&nbsp;<span class="op" id="8516788">!=</span>&nbsp;<span class="ident" id="8516791">nil</span>&nbsp;<span class="op" id="8516795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516799">t</span><span class="op" id="8516800">.</span><span class="ident" id="8516801">Fatalf</span><span class="op" id="8516807">(</span><span class="string" id="8516808">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8516825">,</span>&nbsp;<span class="ident" id="8516827">err</span><span class="op" id="8516830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516836">defer</span>&nbsp;<span class="ident" id="8516842">c</span><span class="op" id="8516843">.</span><span class="ident" id="8516844">Close</span><span class="op" id="8516849">(</span><span class="op" id="8516850">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516854">ra</span><span class="op" id="8516856">,</span>&nbsp;<span class="ident" id="8516858">err</span>&nbsp;<span class="op" id="8516862">:=</span>&nbsp;<span class="ident" id="8516865">ResolveUDPAddr</span><span class="op" id="8516879">(</span><span class="string" id="8516880">&#34;udp&#34;</span><span class="op" id="8516885">,</span>&nbsp;<span class="ident" id="8516887">raddr</span><span class="op" id="8516892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8516895">if</span>&nbsp;<span class="ident" id="8516898">err</span>&nbsp;<span class="op" id="8516902">!=</span>&nbsp;<span class="ident" id="8516905">nil</span>&nbsp;<span class="op" id="8516909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516913">t</span><span class="op" id="8516914">.</span><span class="ident" id="8516915">Fatalf</span><span class="op" id="8516921">(</span><span class="string" id="8516922">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8516949">,</span>&nbsp;<span class="ident" id="8516951">err</span><span class="op" id="8516954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8516957">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516961">_</span><span class="op" id="8516962">,</span>&nbsp;<span class="ident" id="8516964">err</span>&nbsp;<span class="op" id="8516968">=</span>&nbsp;<span class="ident" id="8516970">c</span><span class="op" id="8516971">.</span><span class="op" id="8516972">(</span><span class="op" id="8516973">*</span><span class="ident" id="8516974">UDPConn</span><span class="op" id="8516981">)</span><span class="op" id="8516982">.</span><span class="ident" id="8516983">WriteToUDP</span><span class="op" id="8516993">(</span><span class="op" id="8516994">[</span><span class="op" id="8516995">]</span><span class="builtintype" id="8516996">byte</span><span class="op" id="8517000">(</span><span class="string" id="8517001">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8517034">)</span><span class="op" id="8517035">,</span>&nbsp;<span class="ident" id="8517037">ra</span><span class="op" id="8517039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517042">if</span>&nbsp;<span class="ident" id="8517045">err</span>&nbsp;<span class="op" id="8517049">==</span>&nbsp;<span class="ident" id="8517052">nil</span>&nbsp;<span class="op" id="8517056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517060">t</span><span class="op" id="8517061">.</span><span class="ident" id="8517062">Fatal</span><span class="op" id="8517067">(</span><span class="string" id="8517068">&#34;WriteToUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8517092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517095">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517098">if</span>&nbsp;<span class="ident" id="8517101">err</span>&nbsp;<span class="op" id="8517105">!=</span>&nbsp;<span class="ident" id="8517108">nil</span>&nbsp;<span class="op" id="8517112">&amp;&amp;</span>&nbsp;<span class="ident" id="8517115">err</span><span class="op" id="8517118">.</span><span class="op" id="8517119">(</span><span class="op" id="8517120">*</span><span class="ident" id="8517121">OpError</span><span class="op" id="8517128">)</span><span class="op" id="8517129">.</span><span class="ident" id="8517130">Err</span>&nbsp;<span class="op" id="8517134">!=</span>&nbsp;<span class="ident" id="8517137">ErrWriteToConnected</span>&nbsp;<span class="op" id="8517157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517161">t</span><span class="op" id="8517162">.</span><span class="ident" id="8517163">Fatalf</span><span class="op" id="8517169">(</span><span class="string" id="8517170">&#34;WriteToUDP&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="8517221">,</span>&nbsp;<span class="ident" id="8517223">err</span><span class="op" id="8517226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517233">_</span><span class="op" id="8517234">,</span>&nbsp;<span class="ident" id="8517236">err</span>&nbsp;<span class="op" id="8517240">=</span>&nbsp;<span class="ident" id="8517242">c</span><span class="op" id="8517243">.</span><span class="op" id="8517244">(</span><span class="op" id="8517245">*</span><span class="ident" id="8517246">UDPConn</span><span class="op" id="8517253">)</span><span class="op" id="8517254">.</span><span class="ident" id="8517255">WriteTo</span><span class="op" id="8517262">(</span><span class="op" id="8517263">[</span><span class="op" id="8517264">]</span><span class="builtintype" id="8517265">byte</span><span class="op" id="8517269">(</span><span class="string" id="8517270">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8517303">)</span><span class="op" id="8517304">,</span>&nbsp;<span class="ident" id="8517306">ra</span><span class="op" id="8517308">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517311">if</span>&nbsp;<span class="ident" id="8517314">err</span>&nbsp;<span class="op" id="8517318">==</span>&nbsp;<span class="ident" id="8517321">nil</span>&nbsp;<span class="op" id="8517325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517329">t</span><span class="op" id="8517330">.</span><span class="ident" id="8517331">Fatal</span><span class="op" id="8517336">(</span><span class="string" id="8517337">&#34;WriteTo&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8517358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517364">if</span>&nbsp;<span class="ident" id="8517367">err</span>&nbsp;<span class="op" id="8517371">!=</span>&nbsp;<span class="ident" id="8517374">nil</span>&nbsp;<span class="op" id="8517378">&amp;&amp;</span>&nbsp;<span class="ident" id="8517381">err</span><span class="op" id="8517384">.</span><span class="op" id="8517385">(</span><span class="op" id="8517386">*</span><span class="ident" id="8517387">OpError</span><span class="op" id="8517394">)</span><span class="op" id="8517395">.</span><span class="ident" id="8517396">Err</span>&nbsp;<span class="op" id="8517400">!=</span>&nbsp;<span class="ident" id="8517403">ErrWriteToConnected</span>&nbsp;<span class="op" id="8517423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517427">t</span><span class="op" id="8517428">.</span><span class="ident" id="8517429">Fatalf</span><span class="op" id="8517435">(</span><span class="string" id="8517436">&#34;WriteTo&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="8517484">,</span>&nbsp;<span class="ident" id="8517486">err</span><span class="op" id="8517489">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517496">_</span><span class="op" id="8517497">,</span>&nbsp;<span class="ident" id="8517499">err</span>&nbsp;<span class="op" id="8517503">=</span>&nbsp;<span class="ident" id="8517505">c</span><span class="op" id="8517506">.</span><span class="ident" id="8517507">Write</span><span class="op" id="8517512">(</span><span class="op" id="8517513">[</span><span class="op" id="8517514">]</span><span class="builtintype" id="8517515">byte</span><span class="op" id="8517519">(</span><span class="string" id="8517520">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8517553">)</span><span class="op" id="8517554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517557">if</span>&nbsp;<span class="ident" id="8517560">err</span>&nbsp;<span class="op" id="8517564">!=</span>&nbsp;<span class="ident" id="8517567">nil</span>&nbsp;<span class="op" id="8517571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517575">t</span><span class="op" id="8517576">.</span><span class="ident" id="8517577">Fatalf</span><span class="op" id="8517583">(</span><span class="string" id="8517584">&#34;Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8517602">,</span>&nbsp;<span class="ident" id="8517604">err</span><span class="op" id="8517607">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517610">}</span><br>
<span class="lineno"></span><span class="op" id="8517612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8517615">func</span>&nbsp;<span class="ident" id="8517620">testWriteToPacketConn</span><span class="op" id="8517641">(</span><span class="ident" id="8517642">t</span>&nbsp;<span class="op" id="8517644">*</span><span class="ident" id="8517645">testing</span><span class="op" id="8517652">.</span><span class="ident" id="8517653">T</span><span class="op" id="8517654">,</span>&nbsp;<span class="ident" id="8517656">raddr</span>&nbsp;<span class="builtintype" id="8517662">string</span><span class="op" id="8517668">)</span>&nbsp;<span class="op" id="8517670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517673">c</span><span class="op" id="8517674">,</span>&nbsp;<span class="ident" id="8517676">err</span>&nbsp;<span class="op" id="8517680">:=</span>&nbsp;<span class="ident" id="8517683">ListenPacket</span><span class="op" id="8517695">(</span><span class="string" id="8517696">&#34;udp&#34;</span><span class="op" id="8517701">,</span>&nbsp;<span class="string" id="8517703">&#34;127.0.0.1:0&#34;</span><span class="op" id="8517716">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517719">if</span>&nbsp;<span class="ident" id="8517722">err</span>&nbsp;<span class="op" id="8517726">!=</span>&nbsp;<span class="ident" id="8517729">nil</span>&nbsp;<span class="op" id="8517733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517737">t</span><span class="op" id="8517738">.</span><span class="ident" id="8517739">Fatalf</span><span class="op" id="8517745">(</span><span class="string" id="8517746">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8517771">,</span>&nbsp;<span class="ident" id="8517773">err</span><span class="op" id="8517776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517782">defer</span>&nbsp;<span class="ident" id="8517788">c</span><span class="op" id="8517789">.</span><span class="ident" id="8517790">Close</span><span class="op" id="8517795">(</span><span class="op" id="8517796">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517800">ra</span><span class="op" id="8517802">,</span>&nbsp;<span class="ident" id="8517804">err</span>&nbsp;<span class="op" id="8517808">:=</span>&nbsp;<span class="ident" id="8517811">ResolveUDPAddr</span><span class="op" id="8517825">(</span><span class="string" id="8517826">&#34;udp&#34;</span><span class="op" id="8517831">,</span>&nbsp;<span class="ident" id="8517833">raddr</span><span class="op" id="8517838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517841">if</span>&nbsp;<span class="ident" id="8517844">err</span>&nbsp;<span class="op" id="8517848">!=</span>&nbsp;<span class="ident" id="8517851">nil</span>&nbsp;<span class="op" id="8517855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517859">t</span><span class="op" id="8517860">.</span><span class="ident" id="8517861">Fatalf</span><span class="op" id="8517867">(</span><span class="string" id="8517868">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8517895">,</span>&nbsp;<span class="ident" id="8517897">err</span><span class="op" id="8517900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517907">_</span><span class="op" id="8517908">,</span>&nbsp;<span class="ident" id="8517910">err</span>&nbsp;<span class="op" id="8517914">=</span>&nbsp;<span class="ident" id="8517916">c</span><span class="op" id="8517917">.</span><span class="op" id="8517918">(</span><span class="op" id="8517919">*</span><span class="ident" id="8517920">UDPConn</span><span class="op" id="8517927">)</span><span class="op" id="8517928">.</span><span class="ident" id="8517929">WriteToUDP</span><span class="op" id="8517939">(</span><span class="op" id="8517940">[</span><span class="op" id="8517941">]</span><span class="builtintype" id="8517942">byte</span><span class="op" id="8517946">(</span><span class="string" id="8517947">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8517976">)</span><span class="op" id="8517977">,</span>&nbsp;<span class="ident" id="8517979">ra</span><span class="op" id="8517981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8517984">if</span>&nbsp;<span class="ident" id="8517987">err</span>&nbsp;<span class="op" id="8517991">!=</span>&nbsp;<span class="ident" id="8517994">nil</span>&nbsp;<span class="op" id="8517998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518002">t</span><span class="op" id="8518003">.</span><span class="ident" id="8518004">Fatalf</span><span class="op" id="8518010">(</span><span class="string" id="8518011">&#34;WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8518034">,</span>&nbsp;<span class="ident" id="8518036">err</span><span class="op" id="8518039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518046">_</span><span class="op" id="8518047">,</span>&nbsp;<span class="ident" id="8518049">err</span>&nbsp;<span class="op" id="8518053">=</span>&nbsp;<span class="ident" id="8518055">c</span><span class="op" id="8518056">.</span><span class="ident" id="8518057">WriteTo</span><span class="op" id="8518064">(</span><span class="op" id="8518065">[</span><span class="op" id="8518066">]</span><span class="builtintype" id="8518067">byte</span><span class="op" id="8518071">(</span><span class="string" id="8518072">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8518101">)</span><span class="op" id="8518102">,</span>&nbsp;<span class="ident" id="8518104">ra</span><span class="op" id="8518106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518109">if</span>&nbsp;<span class="ident" id="8518112">err</span>&nbsp;<span class="op" id="8518116">!=</span>&nbsp;<span class="ident" id="8518119">nil</span>&nbsp;<span class="op" id="8518123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518127">t</span><span class="op" id="8518128">.</span><span class="ident" id="8518129">Fatalf</span><span class="op" id="8518135">(</span><span class="string" id="8518136">&#34;WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8518156">,</span>&nbsp;<span class="ident" id="8518158">err</span><span class="op" id="8518161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518168">_</span><span class="op" id="8518169">,</span>&nbsp;<span class="ident" id="8518171">err</span>&nbsp;<span class="op" id="8518175">=</span>&nbsp;<span class="ident" id="8518177">c</span><span class="op" id="8518178">.</span><span class="op" id="8518179">(</span><span class="op" id="8518180">*</span><span class="ident" id="8518181">UDPConn</span><span class="op" id="8518188">)</span><span class="op" id="8518189">.</span><span class="ident" id="8518190">Write</span><span class="op" id="8518195">(</span><span class="op" id="8518196">[</span><span class="op" id="8518197">]</span><span class="builtintype" id="8518198">byte</span><span class="op" id="8518202">(</span><span class="string" id="8518203">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="8518232">)</span><span class="op" id="8518233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518236">if</span>&nbsp;<span class="ident" id="8518239">err</span>&nbsp;<span class="op" id="8518243">==</span>&nbsp;<span class="ident" id="8518246">nil</span>&nbsp;<span class="op" id="8518250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518254">t</span><span class="op" id="8518255">.</span><span class="ident" id="8518256">Fatal</span><span class="op" id="8518261">(</span><span class="string" id="8518262">&#34;Write&nbsp;should&nbsp;fail&#34;</span><span class="op" id="8518281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518284">}</span><br>
<span class="lineno"></span><span class="op" id="8518286">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="8518289">var</span>&nbsp;<span class="ident" id="8518293">udpConnLocalNameTests</span>&nbsp;<span class="op" id="8518315">=</span>&nbsp;<span class="op" id="8518317">[</span><span class="op" id="8518318">]</span><span class="keyword" id="8518319">struct</span>&nbsp;<span class="op" id="8518326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518329">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8518335">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518343">laddr</span>&nbsp;<span class="op" id="8518349">*</span><span class="ident" id="8518350">UDPAddr</span><br>
<span class="lineno"></span><span class="op" id="8518358">}</span><span class="op" id="8518359">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518362">{</span><span class="string" id="8518363">&#34;udp4&#34;</span><span class="op" id="8518369">,</span>&nbsp;<span class="op" id="8518371">&amp;</span><span class="ident" id="8518372">UDPAddr</span><span class="op" id="8518379">{</span><span class="ident" id="8518380">IP</span><span class="op" id="8518382">:</span>&nbsp;<span class="ident" id="8518384">IPv4</span><span class="op" id="8518388">(</span><span class="num" id="8518389">127</span><span class="op" id="8518392">,</span>&nbsp;<span class="num" id="8518394">0</span><span class="op" id="8518395">,</span>&nbsp;<span class="num" id="8518397">0</span><span class="op" id="8518398">,</span>&nbsp;<span class="num" id="8518400">1</span><span class="op" id="8518401">)</span><span class="op" id="8518402">}</span><span class="op" id="8518403">}</span><span class="op" id="8518404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518407">{</span><span class="string" id="8518408">&#34;udp4&#34;</span><span class="op" id="8518414">,</span>&nbsp;<span class="op" id="8518416">&amp;</span><span class="ident" id="8518417">UDPAddr</span><span class="op" id="8518424">{</span><span class="op" id="8518425">}</span><span class="op" id="8518426">}</span><span class="op" id="8518427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518430">{</span><span class="string" id="8518431">&#34;udp4&#34;</span><span class="op" id="8518437">,</span>&nbsp;<span class="ident" id="8518439">nil</span><span class="op" id="8518442">}</span><span class="op" id="8518443">,</span><br>
<span class="lineno"></span><span class="op" id="8518445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="8518448">func</span>&nbsp;<span class="ident" id="8518453">TestUDPConnLocalName</span><span class="op" id="8518473">(</span><span class="ident" id="8518474">t</span>&nbsp;<span class="op" id="8518476">*</span><span class="ident" id="8518477">testing</span><span class="op" id="8518484">.</span><span class="ident" id="8518485">T</span><span class="op" id="8518486">)</span>&nbsp;<span class="op" id="8518488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518491">if</span>&nbsp;<span class="ident" id="8518494">testing</span><span class="op" id="8518501">.</span><span class="ident" id="8518502">Short</span><span class="op" id="8518507">(</span><span class="op" id="8518508">)</span>&nbsp;<span class="op" id="8518510">||</span>&nbsp;<span class="op" id="8518513">!</span><span class="op" id="8518514">*</span><span class="ident" id="8518515">testExternal</span>&nbsp;<span class="op" id="8518528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518532">t</span><span class="op" id="8518533">.</span><span class="ident" id="8518534">Skip</span><span class="op" id="8518538">(</span><span class="string" id="8518539">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8518580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518587">for</span>&nbsp;<span class="ident" id="8518591">_</span><span class="op" id="8518592">,</span>&nbsp;<span class="ident" id="8518594">tt</span>&nbsp;<span class="op" id="8518597">:=</span>&nbsp;<span class="keyword" id="8518600">range</span>&nbsp;<span class="ident" id="8518606">udpConnLocalNameTests</span>&nbsp;<span class="op" id="8518628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518632">c</span><span class="op" id="8518633">,</span>&nbsp;<span class="ident" id="8518635">err</span>&nbsp;<span class="op" id="8518639">:=</span>&nbsp;<span class="ident" id="8518642">ListenUDP</span><span class="op" id="8518651">(</span><span class="ident" id="8518652">tt</span><span class="op" id="8518654">.</span><span class="ident" id="8518655">net</span><span class="op" id="8518658">,</span>&nbsp;<span class="ident" id="8518660">tt</span><span class="op" id="8518662">.</span><span class="ident" id="8518663">laddr</span><span class="op" id="8518668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518672">if</span>&nbsp;<span class="ident" id="8518675">err</span>&nbsp;<span class="op" id="8518679">!=</span>&nbsp;<span class="ident" id="8518682">nil</span>&nbsp;<span class="op" id="8518686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518691">t</span><span class="op" id="8518692">.</span><span class="ident" id="8518693">Fatalf</span><span class="op" id="8518699">(</span><span class="string" id="8518700">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8518722">,</span>&nbsp;<span class="ident" id="8518724">err</span><span class="op" id="8518727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518731">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518735">defer</span>&nbsp;<span class="ident" id="8518741">c</span><span class="op" id="8518742">.</span><span class="ident" id="8518743">Close</span><span class="op" id="8518748">(</span><span class="op" id="8518749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518753">la</span>&nbsp;<span class="op" id="8518756">:=</span>&nbsp;<span class="ident" id="8518759">c</span><span class="op" id="8518760">.</span><span class="ident" id="8518761">LocalAddr</span><span class="op" id="8518770">(</span><span class="op" id="8518771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518775">if</span>&nbsp;<span class="ident" id="8518778">a</span><span class="op" id="8518779">,</span>&nbsp;<span class="ident" id="8518781">ok</span>&nbsp;<span class="op" id="8518784">:=</span>&nbsp;<span class="ident" id="8518787">la</span><span class="op" id="8518789">.</span><span class="op" id="8518790">(</span><span class="op" id="8518791">*</span><span class="ident" id="8518792">UDPAddr</span><span class="op" id="8518799">)</span><span class="op" id="8518800">;</span>&nbsp;<span class="op" id="8518802">!</span><span class="ident" id="8518803">ok</span>&nbsp;<span class="op" id="8518806">||</span>&nbsp;<span class="ident" id="8518809">a</span><span class="op" id="8518810">.</span><span class="ident" id="8518811">Port</span>&nbsp;<span class="op" id="8518816">==</span>&nbsp;<span class="num" id="8518819">0</span>&nbsp;<span class="op" id="8518821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518826">t</span><span class="op" id="8518827">.</span><span class="ident" id="8518828">Fatalf</span><span class="op" id="8518834">(</span><span class="string" id="8518835">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="8518896">,</span>&nbsp;<span class="ident" id="8518898">la</span><span class="op" id="8518900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518904">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518907">}</span><br>
<span class="lineno"></span><span class="op" id="8518909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8518912">func</span>&nbsp;<span class="ident" id="8518917">TestUDPConnLocalAndRemoteNames</span><span class="op" id="8518947">(</span><span class="ident" id="8518948">t</span>&nbsp;<span class="op" id="8518950">*</span><span class="ident" id="8518951">testing</span><span class="op" id="8518958">.</span><span class="ident" id="8518959">T</span><span class="op" id="8518960">)</span>&nbsp;<span class="op" id="8518962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8518965">for</span>&nbsp;<span class="ident" id="8518969">_</span><span class="op" id="8518970">,</span>&nbsp;<span class="ident" id="8518972">laddr</span>&nbsp;<span class="op" id="8518978">:=</span>&nbsp;<span class="keyword" id="8518981">range</span>&nbsp;<span class="op" id="8518987">[</span><span class="op" id="8518988">]</span><span class="builtintype" id="8518989">string</span><span class="op" id="8518995">{</span><span class="string" id="8518996">&#34;&#34;</span><span class="op" id="8518998">,</span>&nbsp;<span class="string" id="8519000">&#34;127.0.0.1:0&#34;</span><span class="op" id="8519013">}</span>&nbsp;<span class="op" id="8519015">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519019">c1</span><span class="op" id="8519021">,</span>&nbsp;<span class="ident" id="8519023">err</span>&nbsp;<span class="op" id="8519027">:=</span>&nbsp;<span class="ident" id="8519030">ListenPacket</span><span class="op" id="8519042">(</span><span class="string" id="8519043">&#34;udp&#34;</span><span class="op" id="8519048">,</span>&nbsp;<span class="string" id="8519050">&#34;127.0.0.1:0&#34;</span><span class="op" id="8519063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519067">if</span>&nbsp;<span class="ident" id="8519070">err</span>&nbsp;<span class="op" id="8519074">!=</span>&nbsp;<span class="ident" id="8519077">nil</span>&nbsp;<span class="op" id="8519081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519086">t</span><span class="op" id="8519087">.</span><span class="ident" id="8519088">Fatalf</span><span class="op" id="8519094">(</span><span class="string" id="8519095">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8519117">,</span>&nbsp;<span class="ident" id="8519119">err</span><span class="op" id="8519122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519130">defer</span>&nbsp;<span class="ident" id="8519136">c1</span><span class="op" id="8519138">.</span><span class="ident" id="8519139">Close</span><span class="op" id="8519144">(</span><span class="op" id="8519145">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519150">var</span>&nbsp;<span class="ident" id="8519154">la</span>&nbsp;<span class="op" id="8519157">*</span><span class="ident" id="8519158">UDPAddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519168">if</span>&nbsp;<span class="ident" id="8519171">laddr</span>&nbsp;<span class="op" id="8519177">!=</span>&nbsp;<span class="string" id="8519180">&#34;&#34;</span>&nbsp;<span class="op" id="8519183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519188">var</span>&nbsp;<span class="ident" id="8519192">err</span>&nbsp;<span class="builtintype" id="8519196">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519205">if</span>&nbsp;<span class="ident" id="8519208">la</span><span class="op" id="8519210">,</span>&nbsp;<span class="ident" id="8519212">err</span>&nbsp;<span class="op" id="8519216">=</span>&nbsp;<span class="ident" id="8519218">ResolveUDPAddr</span><span class="op" id="8519232">(</span><span class="string" id="8519233">&#34;udp&#34;</span><span class="op" id="8519238">,</span>&nbsp;<span class="ident" id="8519240">laddr</span><span class="op" id="8519245">)</span><span class="op" id="8519246">;</span>&nbsp;<span class="ident" id="8519248">err</span>&nbsp;<span class="op" id="8519252">!=</span>&nbsp;<span class="ident" id="8519255">nil</span>&nbsp;<span class="op" id="8519259">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519265">t</span><span class="op" id="8519266">.</span><span class="ident" id="8519267">Fatalf</span><span class="op" id="8519273">(</span><span class="string" id="8519274">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8519301">,</span>&nbsp;<span class="ident" id="8519303">err</span><span class="op" id="8519306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519319">c2</span><span class="op" id="8519321">,</span>&nbsp;<span class="ident" id="8519323">err</span>&nbsp;<span class="op" id="8519327">:=</span>&nbsp;<span class="ident" id="8519330">DialUDP</span><span class="op" id="8519337">(</span><span class="string" id="8519338">&#34;udp&#34;</span><span class="op" id="8519343">,</span>&nbsp;<span class="ident" id="8519345">la</span><span class="op" id="8519347">,</span>&nbsp;<span class="ident" id="8519349">c1</span><span class="op" id="8519351">.</span><span class="ident" id="8519352">LocalAddr</span><span class="op" id="8519361">(</span><span class="op" id="8519362">)</span><span class="op" id="8519363">.</span><span class="op" id="8519364">(</span><span class="op" id="8519365">*</span><span class="ident" id="8519366">UDPAddr</span><span class="op" id="8519373">)</span><span class="op" id="8519374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519378">if</span>&nbsp;<span class="ident" id="8519381">err</span>&nbsp;<span class="op" id="8519385">!=</span>&nbsp;<span class="ident" id="8519388">nil</span>&nbsp;<span class="op" id="8519392">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519397">t</span><span class="op" id="8519398">.</span><span class="ident" id="8519399">Fatalf</span><span class="op" id="8519405">(</span><span class="string" id="8519406">&#34;DialUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8519426">,</span>&nbsp;<span class="ident" id="8519428">err</span><span class="op" id="8519431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519439">defer</span>&nbsp;<span class="ident" id="8519445">c2</span><span class="op" id="8519447">.</span><span class="ident" id="8519448">Close</span><span class="op" id="8519453">(</span><span class="op" id="8519454">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519459">var</span>&nbsp;<span class="ident" id="8519463">connAddrs</span>&nbsp;<span class="op" id="8519473">=</span>&nbsp;<span class="op" id="8519475">[</span><span class="num" id="8519476">4</span><span class="op" id="8519477">]</span><span class="keyword" id="8519478">struct</span>&nbsp;<span class="op" id="8519485">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519490">got</span>&nbsp;<span class="ident" id="8519494">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519502">ok</span>&nbsp;&nbsp;<span class="builtintype" id="8519506">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519513">}</span><span class="op" id="8519514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519519">{</span><span class="ident" id="8519520">c1</span><span class="op" id="8519522">.</span><span class="ident" id="8519523">LocalAddr</span><span class="op" id="8519532">(</span><span class="op" id="8519533">)</span><span class="op" id="8519534">,</span>&nbsp;<span class="builtintype" id="8519536">true</span><span class="op" id="8519540">}</span><span class="op" id="8519541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519546">{</span><span class="ident" id="8519547">c1</span><span class="op" id="8519549">.</span><span class="op" id="8519550">(</span><span class="op" id="8519551">*</span><span class="ident" id="8519552">UDPConn</span><span class="op" id="8519559">)</span><span class="op" id="8519560">.</span><span class="ident" id="8519561">RemoteAddr</span><span class="op" id="8519571">(</span><span class="op" id="8519572">)</span><span class="op" id="8519573">,</span>&nbsp;<span class="builtintype" id="8519575">false</span><span class="op" id="8519580">}</span><span class="op" id="8519581">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519586">{</span><span class="ident" id="8519587">c2</span><span class="op" id="8519589">.</span><span class="ident" id="8519590">LocalAddr</span><span class="op" id="8519599">(</span><span class="op" id="8519600">)</span><span class="op" id="8519601">,</span>&nbsp;<span class="builtintype" id="8519603">true</span><span class="op" id="8519607">}</span><span class="op" id="8519608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519613">{</span><span class="ident" id="8519614">c2</span><span class="op" id="8519616">.</span><span class="ident" id="8519617">RemoteAddr</span><span class="op" id="8519627">(</span><span class="op" id="8519628">)</span><span class="op" id="8519629">,</span>&nbsp;<span class="builtintype" id="8519631">true</span><span class="op" id="8519635">}</span><span class="op" id="8519636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519644">for</span>&nbsp;<span class="ident" id="8519648">_</span><span class="op" id="8519649">,</span>&nbsp;<span class="ident" id="8519651">ca</span>&nbsp;<span class="op" id="8519654">:=</span>&nbsp;<span class="keyword" id="8519657">range</span>&nbsp;<span class="ident" id="8519663">connAddrs</span>&nbsp;<span class="op" id="8519673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519678">if</span>&nbsp;<span class="ident" id="8519681">a</span><span class="op" id="8519682">,</span>&nbsp;<span class="ident" id="8519684">ok</span>&nbsp;<span class="op" id="8519687">:=</span>&nbsp;<span class="ident" id="8519690">ca</span><span class="op" id="8519692">.</span><span class="ident" id="8519693">got</span><span class="op" id="8519696">.</span><span class="op" id="8519697">(</span><span class="op" id="8519698">*</span><span class="ident" id="8519699">UDPAddr</span><span class="op" id="8519706">)</span><span class="op" id="8519707">;</span>&nbsp;<span class="ident" id="8519709">ok</span>&nbsp;<span class="op" id="8519712">!=</span>&nbsp;<span class="ident" id="8519715">ca</span><span class="op" id="8519717">.</span><span class="ident" id="8519718">ok</span>&nbsp;<span class="op" id="8519721">||</span>&nbsp;<span class="ident" id="8519724">ok</span>&nbsp;<span class="op" id="8519727">&amp;&amp;</span>&nbsp;<span class="ident" id="8519730">a</span><span class="op" id="8519731">.</span><span class="ident" id="8519732">Port</span>&nbsp;<span class="op" id="8519737">==</span>&nbsp;<span class="num" id="8519740">0</span>&nbsp;<span class="op" id="8519742">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519748">t</span><span class="op" id="8519749">.</span><span class="ident" id="8519750">Fatalf</span><span class="op" id="8519756">(</span><span class="string" id="8519757">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="8519818">,</span>&nbsp;<span class="ident" id="8519820">ca</span><span class="op" id="8519822">.</span><span class="ident" id="8519823">got</span><span class="op" id="8519826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519838">}</span><br>
<span class="lineno"></span><span class="op" id="8519840">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="8519843">func</span>&nbsp;<span class="ident" id="8519848">TestIPv6LinkLocalUnicastUDP</span><span class="op" id="8519875">(</span><span class="ident" id="8519876">t</span>&nbsp;<span class="op" id="8519878">*</span><span class="ident" id="8519879">testing</span><span class="op" id="8519886">.</span><span class="ident" id="8519887">T</span><span class="op" id="8519888">)</span>&nbsp;<span class="op" id="8519890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519893">if</span>&nbsp;<span class="ident" id="8519896">testing</span><span class="op" id="8519903">.</span><span class="ident" id="8519904">Short</span><span class="op" id="8519909">(</span><span class="op" id="8519910">)</span>&nbsp;<span class="op" id="8519912">||</span>&nbsp;<span class="op" id="8519915">!</span><span class="op" id="8519916">*</span><span class="ident" id="8519917">testExternal</span>&nbsp;<span class="op" id="8519930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519934">t</span><span class="op" id="8519935">.</span><span class="ident" id="8519936">Skip</span><span class="op" id="8519940">(</span><span class="string" id="8519941">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8519982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519985">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8519988">if</span>&nbsp;<span class="op" id="8519991">!</span><span class="ident" id="8519992">supportsIPv6</span>&nbsp;<span class="op" id="8520005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520009">t</span><span class="op" id="8520010">.</span><span class="ident" id="8520011">Skip</span><span class="op" id="8520015">(</span><span class="string" id="8520016">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="8520039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520045">ifi</span>&nbsp;<span class="op" id="8520049">:=</span>&nbsp;<span class="ident" id="8520052">loopbackInterface</span><span class="op" id="8520069">(</span><span class="op" id="8520070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520073">if</span>&nbsp;<span class="ident" id="8520076">ifi</span>&nbsp;<span class="op" id="8520080">==</span>&nbsp;<span class="ident" id="8520083">nil</span>&nbsp;<span class="op" id="8520087">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520091">t</span><span class="op" id="8520092">.</span><span class="ident" id="8520093">Skip</span><span class="op" id="8520097">(</span><span class="string" id="8520098">&#34;loopback&nbsp;interface&nbsp;not&nbsp;found&#34;</span><span class="op" id="8520128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520134">laddr</span>&nbsp;<span class="op" id="8520140">:=</span>&nbsp;<span class="ident" id="8520143">ipv6LinkLocalUnicastAddr</span><span class="op" id="8520167">(</span><span class="ident" id="8520168">ifi</span><span class="op" id="8520171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520174">if</span>&nbsp;<span class="ident" id="8520177">laddr</span>&nbsp;<span class="op" id="8520183">==</span>&nbsp;<span class="string" id="8520186">&#34;&#34;</span>&nbsp;<span class="op" id="8520189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520193">t</span><span class="op" id="8520194">.</span><span class="ident" id="8520195">Skip</span><span class="op" id="8520199">(</span><span class="string" id="8520200">&#34;ipv6&nbsp;unicast&nbsp;address&nbsp;on&nbsp;loopback&nbsp;not&nbsp;found&#34;</span><span class="op" id="8520244">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520251">type</span>&nbsp;<span class="ident" id="8520256">test</span>&nbsp;<span class="keyword" id="8520261">struct</span>&nbsp;<span class="op" id="8520268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520272">net</span><span class="op" id="8520275">,</span>&nbsp;<span class="ident" id="8520277">addr</span>&nbsp;&nbsp;<span class="builtintype" id="8520283">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520292">nameLookup</span>&nbsp;<span class="builtintype" id="8520303">bool</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520312">var</span>&nbsp;<span class="ident" id="8520316">tests</span>&nbsp;<span class="op" id="8520322">=</span>&nbsp;<span class="op" id="8520324">[</span><span class="op" id="8520325">]</span><span class="ident" id="8520326">test</span><span class="op" id="8520330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520334">{</span><span class="string" id="8520335">&#34;udp&#34;</span><span class="op" id="8520340">,</span>&nbsp;<span class="string" id="8520342">&#34;[&#34;</span>&nbsp;<span class="op" id="8520346">+</span>&nbsp;<span class="ident" id="8520348">laddr</span>&nbsp;<span class="op" id="8520354">+</span>&nbsp;<span class="string" id="8520356">&#34;%&#34;</span>&nbsp;<span class="op" id="8520360">+</span>&nbsp;<span class="ident" id="8520362">ifi</span><span class="op" id="8520365">.</span><span class="ident" id="8520366">Name</span>&nbsp;<span class="op" id="8520371">+</span>&nbsp;<span class="string" id="8520373">&#34;]:0&#34;</span><span class="op" id="8520378">,</span>&nbsp;<span class="builtintype" id="8520380">false</span><span class="op" id="8520385">}</span><span class="op" id="8520386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520390">{</span><span class="string" id="8520391">&#34;udp6&#34;</span><span class="op" id="8520397">,</span>&nbsp;<span class="string" id="8520399">&#34;[&#34;</span>&nbsp;<span class="op" id="8520403">+</span>&nbsp;<span class="ident" id="8520405">laddr</span>&nbsp;<span class="op" id="8520411">+</span>&nbsp;<span class="string" id="8520413">&#34;%&#34;</span>&nbsp;<span class="op" id="8520417">+</span>&nbsp;<span class="ident" id="8520419">ifi</span><span class="op" id="8520422">.</span><span class="ident" id="8520423">Name</span>&nbsp;<span class="op" id="8520428">+</span>&nbsp;<span class="string" id="8520430">&#34;]:0&#34;</span><span class="op" id="8520435">,</span>&nbsp;<span class="builtintype" id="8520437">false</span><span class="op" id="8520442">}</span><span class="op" id="8520443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520446">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8520449">//&nbsp;The&nbsp;first&nbsp;udp&nbsp;test&nbsp;fails&nbsp;on&nbsp;DragonFly&nbsp;-&nbsp;see&nbsp;issue&nbsp;7473.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520509">if</span>&nbsp;<span class="ident" id="8520512">runtime</span><span class="op" id="8520519">.</span><span class="ident" id="8520520">GOOS</span>&nbsp;<span class="op" id="8520525">==</span>&nbsp;<span class="string" id="8520528">&#34;dragonfly&#34;</span>&nbsp;<span class="op" id="8520540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520544">tests</span>&nbsp;<span class="op" id="8520550">=</span>&nbsp;<span class="ident" id="8520552">tests</span><span class="op" id="8520557">[</span><span class="num" id="8520558">1</span><span class="op" id="8520559">:</span><span class="op" id="8520560">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520566">switch</span>&nbsp;<span class="ident" id="8520573">runtime</span><span class="op" id="8520580">.</span><span class="ident" id="8520581">GOOS</span>&nbsp;<span class="op" id="8520586">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520589">case</span>&nbsp;<span class="string" id="8520594">&#34;darwin&#34;</span><span class="op" id="8520602">,</span>&nbsp;<span class="string" id="8520604">&#34;dragonfly&#34;</span><span class="op" id="8520615">,</span>&nbsp;<span class="string" id="8520617">&#34;freebsd&#34;</span><span class="op" id="8520626">,</span>&nbsp;<span class="string" id="8520628">&#34;openbsd&#34;</span><span class="op" id="8520637">,</span>&nbsp;<span class="string" id="8520639">&#34;netbsd&#34;</span><span class="op" id="8520647">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520651">tests</span>&nbsp;<span class="op" id="8520657">=</span>&nbsp;<span class="builtinfunc" id="8520659">append</span><span class="op" id="8520665">(</span><span class="ident" id="8520666">tests</span><span class="op" id="8520671">,</span>&nbsp;<span class="op" id="8520673">[</span><span class="op" id="8520674">]</span><span class="ident" id="8520675">test</span><span class="op" id="8520679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520684">{</span><span class="string" id="8520685">&#34;udp&#34;</span><span class="op" id="8520690">,</span>&nbsp;<span class="string" id="8520692">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="8520706">+</span>&nbsp;<span class="ident" id="8520708">ifi</span><span class="op" id="8520711">.</span><span class="ident" id="8520712">Name</span>&nbsp;<span class="op" id="8520717">+</span>&nbsp;<span class="string" id="8520719">&#34;]:0&#34;</span><span class="op" id="8520724">,</span>&nbsp;<span class="builtintype" id="8520726">true</span><span class="op" id="8520730">}</span><span class="op" id="8520731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520736">{</span><span class="string" id="8520737">&#34;udp6&#34;</span><span class="op" id="8520743">,</span>&nbsp;<span class="string" id="8520745">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="8520759">+</span>&nbsp;<span class="ident" id="8520761">ifi</span><span class="op" id="8520764">.</span><span class="ident" id="8520765">Name</span>&nbsp;<span class="op" id="8520770">+</span>&nbsp;<span class="string" id="8520772">&#34;]:0&#34;</span><span class="op" id="8520777">,</span>&nbsp;<span class="builtintype" id="8520779">true</span><span class="op" id="8520783">}</span><span class="op" id="8520784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520788">}</span><span class="op" id="8520789">...</span><span class="op" id="8520792">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520795">case</span>&nbsp;<span class="string" id="8520800">&#34;linux&#34;</span><span class="op" id="8520807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520811">tests</span>&nbsp;<span class="op" id="8520817">=</span>&nbsp;<span class="builtinfunc" id="8520819">append</span><span class="op" id="8520825">(</span><span class="ident" id="8520826">tests</span><span class="op" id="8520831">,</span>&nbsp;<span class="op" id="8520833">[</span><span class="op" id="8520834">]</span><span class="ident" id="8520835">test</span><span class="op" id="8520839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520844">{</span><span class="string" id="8520845">&#34;udp&#34;</span><span class="op" id="8520850">,</span>&nbsp;<span class="string" id="8520852">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="8520870">+</span>&nbsp;<span class="ident" id="8520872">ifi</span><span class="op" id="8520875">.</span><span class="ident" id="8520876">Name</span>&nbsp;<span class="op" id="8520881">+</span>&nbsp;<span class="string" id="8520883">&#34;]:0&#34;</span><span class="op" id="8520888">,</span>&nbsp;<span class="builtintype" id="8520890">true</span><span class="op" id="8520894">}</span><span class="op" id="8520895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520900">{</span><span class="string" id="8520901">&#34;udp6&#34;</span><span class="op" id="8520907">,</span>&nbsp;<span class="string" id="8520909">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="8520927">+</span>&nbsp;<span class="ident" id="8520929">ifi</span><span class="op" id="8520932">.</span><span class="ident" id="8520933">Name</span>&nbsp;<span class="op" id="8520938">+</span>&nbsp;<span class="string" id="8520940">&#34;]:0&#34;</span><span class="op" id="8520945">,</span>&nbsp;<span class="builtintype" id="8520947">true</span><span class="op" id="8520951">}</span><span class="op" id="8520952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520956">}</span><span class="op" id="8520957">...</span><span class="op" id="8520960">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8520966">for</span>&nbsp;<span class="ident" id="8520970">_</span><span class="op" id="8520971">,</span>&nbsp;<span class="ident" id="8520973">tt</span>&nbsp;<span class="op" id="8520976">:=</span>&nbsp;<span class="keyword" id="8520979">range</span>&nbsp;<span class="ident" id="8520985">tests</span>&nbsp;<span class="op" id="8520991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520995">c1</span><span class="op" id="8520997">,</span>&nbsp;<span class="ident" id="8520999">err</span>&nbsp;<span class="op" id="8521003">:=</span>&nbsp;<span class="ident" id="8521006">ListenPacket</span><span class="op" id="8521018">(</span><span class="ident" id="8521019">tt</span><span class="op" id="8521021">.</span><span class="ident" id="8521022">net</span><span class="op" id="8521025">,</span>&nbsp;<span class="ident" id="8521027">tt</span><span class="op" id="8521029">.</span><span class="ident" id="8521030">addr</span><span class="op" id="8521034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521038">if</span>&nbsp;<span class="ident" id="8521041">err</span>&nbsp;<span class="op" id="8521045">!=</span>&nbsp;<span class="ident" id="8521048">nil</span>&nbsp;<span class="op" id="8521052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8521057">//&nbsp;It&nbsp;might&nbsp;return&nbsp;&#34;LookupHost&nbsp;returned&nbsp;no</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8521103">//&nbsp;suitable&nbsp;address&#34;&nbsp;error&nbsp;on&nbsp;some&nbsp;platforms.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521152">t</span><span class="op" id="8521153">.</span><span class="ident" id="8521154">Logf</span><span class="op" id="8521158">(</span><span class="string" id="8521159">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8521184">,</span>&nbsp;<span class="ident" id="8521186">err</span><span class="op" id="8521189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521194">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521209">defer</span>&nbsp;<span class="ident" id="8521215">c1</span><span class="op" id="8521217">.</span><span class="ident" id="8521218">Close</span><span class="op" id="8521223">(</span><span class="op" id="8521224">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521228">if</span>&nbsp;<span class="ident" id="8521231">la</span><span class="op" id="8521233">,</span>&nbsp;<span class="ident" id="8521235">ok</span>&nbsp;<span class="op" id="8521238">:=</span>&nbsp;<span class="ident" id="8521241">c1</span><span class="op" id="8521243">.</span><span class="ident" id="8521244">LocalAddr</span><span class="op" id="8521253">(</span><span class="op" id="8521254">)</span><span class="op" id="8521255">.</span><span class="op" id="8521256">(</span><span class="op" id="8521257">*</span><span class="ident" id="8521258">UDPAddr</span><span class="op" id="8521265">)</span><span class="op" id="8521266">;</span>&nbsp;<span class="op" id="8521268">!</span><span class="ident" id="8521269">ok</span>&nbsp;<span class="op" id="8521272">||</span>&nbsp;<span class="op" id="8521275">!</span><span class="ident" id="8521276">tt</span><span class="op" id="8521278">.</span><span class="ident" id="8521279">nameLookup</span>&nbsp;<span class="op" id="8521290">&amp;&amp;</span>&nbsp;<span class="ident" id="8521293">la</span><span class="op" id="8521295">.</span><span class="ident" id="8521296">Zone</span>&nbsp;<span class="op" id="8521301">==</span>&nbsp;<span class="string" id="8521304">&#34;&#34;</span>&nbsp;<span class="op" id="8521307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521312">t</span><span class="op" id="8521313">.</span><span class="ident" id="8521314">Fatalf</span><span class="op" id="8521320">(</span><span class="string" id="8521321">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="8521377">,</span>&nbsp;<span class="ident" id="8521379">la</span><span class="op" id="8521381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521390">c2</span><span class="op" id="8521392">,</span>&nbsp;<span class="ident" id="8521394">err</span>&nbsp;<span class="op" id="8521398">:=</span>&nbsp;<span class="ident" id="8521401">Dial</span><span class="op" id="8521405">(</span><span class="ident" id="8521406">tt</span><span class="op" id="8521408">.</span><span class="ident" id="8521409">net</span><span class="op" id="8521412">,</span>&nbsp;<span class="ident" id="8521414">c1</span><span class="op" id="8521416">.</span><span class="ident" id="8521417">LocalAddr</span><span class="op" id="8521426">(</span><span class="op" id="8521427">)</span><span class="op" id="8521428">.</span><span class="ident" id="8521429">String</span><span class="op" id="8521435">(</span><span class="op" id="8521436">)</span><span class="op" id="8521437">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521441">if</span>&nbsp;<span class="ident" id="8521444">err</span>&nbsp;<span class="op" id="8521448">!=</span>&nbsp;<span class="ident" id="8521451">nil</span>&nbsp;<span class="op" id="8521455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521460">t</span><span class="op" id="8521461">.</span><span class="ident" id="8521462">Fatalf</span><span class="op" id="8521468">(</span><span class="string" id="8521469">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8521486">,</span>&nbsp;<span class="ident" id="8521488">err</span><span class="op" id="8521491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521499">defer</span>&nbsp;<span class="ident" id="8521505">c2</span><span class="op" id="8521507">.</span><span class="ident" id="8521508">Close</span><span class="op" id="8521513">(</span><span class="op" id="8521514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521518">if</span>&nbsp;<span class="ident" id="8521521">la</span><span class="op" id="8521523">,</span>&nbsp;<span class="ident" id="8521525">ok</span>&nbsp;<span class="op" id="8521528">:=</span>&nbsp;<span class="ident" id="8521531">c2</span><span class="op" id="8521533">.</span><span class="ident" id="8521534">LocalAddr</span><span class="op" id="8521543">(</span><span class="op" id="8521544">)</span><span class="op" id="8521545">.</span><span class="op" id="8521546">(</span><span class="op" id="8521547">*</span><span class="ident" id="8521548">UDPAddr</span><span class="op" id="8521555">)</span><span class="op" id="8521556">;</span>&nbsp;<span class="op" id="8521558">!</span><span class="ident" id="8521559">ok</span>&nbsp;<span class="op" id="8521562">||</span>&nbsp;<span class="op" id="8521565">!</span><span class="ident" id="8521566">tt</span><span class="op" id="8521568">.</span><span class="ident" id="8521569">nameLookup</span>&nbsp;<span class="op" id="8521580">&amp;&amp;</span>&nbsp;<span class="ident" id="8521583">la</span><span class="op" id="8521585">.</span><span class="ident" id="8521586">Zone</span>&nbsp;<span class="op" id="8521591">==</span>&nbsp;<span class="string" id="8521594">&#34;&#34;</span>&nbsp;<span class="op" id="8521597">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521602">t</span><span class="op" id="8521603">.</span><span class="ident" id="8521604">Fatalf</span><span class="op" id="8521610">(</span><span class="string" id="8521611">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="8521667">,</span>&nbsp;<span class="ident" id="8521669">la</span><span class="op" id="8521671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521679">if</span>&nbsp;<span class="ident" id="8521682">ra</span><span class="op" id="8521684">,</span>&nbsp;<span class="ident" id="8521686">ok</span>&nbsp;<span class="op" id="8521689">:=</span>&nbsp;<span class="ident" id="8521692">c2</span><span class="op" id="8521694">.</span><span class="ident" id="8521695">RemoteAddr</span><span class="op" id="8521705">(</span><span class="op" id="8521706">)</span><span class="op" id="8521707">.</span><span class="op" id="8521708">(</span><span class="op" id="8521709">*</span><span class="ident" id="8521710">UDPAddr</span><span class="op" id="8521717">)</span><span class="op" id="8521718">;</span>&nbsp;<span class="op" id="8521720">!</span><span class="ident" id="8521721">ok</span>&nbsp;<span class="op" id="8521724">||</span>&nbsp;<span class="op" id="8521727">!</span><span class="ident" id="8521728">tt</span><span class="op" id="8521730">.</span><span class="ident" id="8521731">nameLookup</span>&nbsp;<span class="op" id="8521742">&amp;&amp;</span>&nbsp;<span class="ident" id="8521745">ra</span><span class="op" id="8521747">.</span><span class="ident" id="8521748">Zone</span>&nbsp;<span class="op" id="8521753">==</span>&nbsp;<span class="string" id="8521756">&#34;&#34;</span>&nbsp;<span class="op" id="8521759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521764">t</span><span class="op" id="8521765">.</span><span class="ident" id="8521766">Fatalf</span><span class="op" id="8521772">(</span><span class="string" id="8521773">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="8521829">,</span>&nbsp;<span class="ident" id="8521831">ra</span><span class="op" id="8521833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521837">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521842">if</span>&nbsp;<span class="ident" id="8521845">_</span><span class="op" id="8521846">,</span>&nbsp;<span class="ident" id="8521848">err</span>&nbsp;<span class="op" id="8521852">:=</span>&nbsp;<span class="ident" id="8521855">c2</span><span class="op" id="8521857">.</span><span class="ident" id="8521858">Write</span><span class="op" id="8521863">(</span><span class="op" id="8521864">[</span><span class="op" id="8521865">]</span><span class="builtintype" id="8521866">byte</span><span class="op" id="8521870">(</span><span class="string" id="8521871">&#34;UDP&nbsp;OVER&nbsp;IPV6&nbsp;LINKLOCAL&nbsp;TEST&#34;</span><span class="op" id="8521901">)</span><span class="op" id="8521902">)</span><span class="op" id="8521903">;</span>&nbsp;<span class="ident" id="8521905">err</span>&nbsp;<span class="op" id="8521909">!=</span>&nbsp;<span class="ident" id="8521912">nil</span>&nbsp;<span class="op" id="8521916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521921">t</span><span class="op" id="8521922">.</span><span class="ident" id="8521923">Fatalf</span><span class="op" id="8521929">(</span><span class="string" id="8521930">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8521953">,</span>&nbsp;<span class="ident" id="8521955">err</span><span class="op" id="8521958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521966">b</span>&nbsp;<span class="op" id="8521968">:=</span>&nbsp;<span class="builtinfunc" id="8521971">make</span><span class="op" id="8521975">(</span><span class="op" id="8521976">[</span><span class="op" id="8521977">]</span><span class="builtintype" id="8521978">byte</span><span class="op" id="8521982">,</span>&nbsp;<span class="num" id="8521984">32</span><span class="op" id="8521986">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8521990">if</span>&nbsp;<span class="ident" id="8521993">_</span><span class="op" id="8521994">,</span>&nbsp;<span class="ident" id="8521996">from</span><span class="op" id="8522000">,</span>&nbsp;<span class="ident" id="8522002">err</span>&nbsp;<span class="op" id="8522006">:=</span>&nbsp;<span class="ident" id="8522009">c1</span><span class="op" id="8522011">.</span><span class="ident" id="8522012">ReadFrom</span><span class="op" id="8522020">(</span><span class="ident" id="8522021">b</span><span class="op" id="8522022">)</span><span class="op" id="8522023">;</span>&nbsp;<span class="ident" id="8522025">err</span>&nbsp;<span class="op" id="8522029">!=</span>&nbsp;<span class="ident" id="8522032">nil</span>&nbsp;<span class="op" id="8522036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522041">t</span><span class="op" id="8522042">.</span><span class="ident" id="8522043">Fatalf</span><span class="op" id="8522049">(</span><span class="string" id="8522050">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8522082">,</span>&nbsp;<span class="ident" id="8522084">err</span><span class="op" id="8522087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522091">}</span>&nbsp;<span class="keyword" id="8522093">else</span>&nbsp;<span class="op" id="8522098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8522103">if</span>&nbsp;<span class="ident" id="8522106">ra</span><span class="op" id="8522108">,</span>&nbsp;<span class="ident" id="8522110">ok</span>&nbsp;<span class="op" id="8522113">:=</span>&nbsp;<span class="ident" id="8522116">from</span><span class="op" id="8522120">.</span><span class="op" id="8522121">(</span><span class="op" id="8522122">*</span><span class="ident" id="8522123">UDPAddr</span><span class="op" id="8522130">)</span><span class="op" id="8522131">;</span>&nbsp;<span class="op" id="8522133">!</span><span class="ident" id="8522134">ok</span>&nbsp;<span class="op" id="8522137">||</span>&nbsp;<span class="op" id="8522140">!</span><span class="ident" id="8522141">tt</span><span class="op" id="8522143">.</span><span class="ident" id="8522144">nameLookup</span>&nbsp;<span class="op" id="8522155">&amp;&amp;</span>&nbsp;<span class="ident" id="8522158">ra</span><span class="op" id="8522160">.</span><span class="ident" id="8522161">Zone</span>&nbsp;<span class="op" id="8522166">==</span>&nbsp;<span class="string" id="8522169">&#34;&#34;</span>&nbsp;<span class="op" id="8522172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522178">t</span><span class="op" id="8522179">.</span><span class="ident" id="8522180">Fatalf</span><span class="op" id="8522186">(</span><span class="string" id="8522187">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="8522243">,</span>&nbsp;<span class="ident" id="8522245">ra</span><span class="op" id="8522247">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522259">}</span><br>
<span class="lineno"></span><span class="op" id="8522261">}</span>
</div>
</body>
</html>
