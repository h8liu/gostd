<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1356279">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1356334">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1356388">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1356439">package</span>&nbsp;<span class="ident" id="1356447">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1356453">import</span>&nbsp;<span class="op" id="1356460">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1356463">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1356470">&#34;io&#34;</span><br>
<span class="lineno">10</span><span class="op" id="1356475">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1356478">//&nbsp;fileTransport&nbsp;implements&nbsp;RoundTripper&nbsp;for&nbsp;the&nbsp;&#39;file&#39;&nbsp;protocol.</span><br>
<span class="lineno"></span><span class="keyword" id="1356544">type</span>&nbsp;<span class="ident" id="1356549">fileTransport</span>&nbsp;<span class="keyword" id="1356563">struct</span>&nbsp;<span class="op" id="1356570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1356573">fh</span>&nbsp;<span class="ident" id="1356576">fileHandler</span><br>
<span class="lineno">15</span><span class="op" id="1356588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1356591">//&nbsp;NewFileTransport&nbsp;returns&nbsp;a&nbsp;new&nbsp;RoundTripper,&nbsp;serving&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span><span class="comment" id="1356660">//&nbsp;FileSystem.&nbsp;The&nbsp;returned&nbsp;RoundTripper&nbsp;ignores&nbsp;the&nbsp;URL&nbsp;host&nbsp;in&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="1356729">//&nbsp;incoming&nbsp;requests,&nbsp;as&nbsp;well&nbsp;as&nbsp;most&nbsp;other&nbsp;properties&nbsp;of&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="1356791">//&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="1356803">//</span><br>
<span class="lineno"></span><span class="comment" id="1356806">//&nbsp;The&nbsp;typical&nbsp;use&nbsp;case&nbsp;for&nbsp;NewFileTransport&nbsp;is&nbsp;to&nbsp;register&nbsp;the&nbsp;&#34;file&#34;</span><br>
<span class="lineno"></span><span class="comment" id="1356877">//&nbsp;protocol&nbsp;with&nbsp;a&nbsp;Transport,&nbsp;as&nbsp;in:</span><br>
<span class="lineno"></span><span class="comment" id="1356914">//</span><br>
<span class="lineno">25</span><span class="comment" id="1356917">//&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;&amp;http.Transport{}</span><br>
<span class="lineno"></span><span class="comment" id="1356945">//&nbsp;&nbsp;&nbsp;t.RegisterProtocol(&#34;file&#34;,&nbsp;http.NewFileTransport(http.Dir(&#34;/&#34;)))</span><br>
<span class="lineno"></span><span class="comment" id="1357015">//&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;&amp;http.Client{Transport:&nbsp;t}</span><br>
<span class="lineno"></span><span class="comment" id="1357052">//&nbsp;&nbsp;&nbsp;res,&nbsp;err&nbsp;:=&nbsp;c.Get(&#34;file:///etc/passwd&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="1357097">//&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno">30</span><span class="keyword" id="1357106">func</span>&nbsp;<span class="ident" id="1357111">NewFileTransport</span><span class="op" id="1357127">(</span><span class="ident" id="1357128">fs</span>&nbsp;<span class="ident" id="1357131">FileSystem</span><span class="op" id="1357141">)</span>&nbsp;<span class="ident" id="1357143">RoundTripper</span>&nbsp;<span class="op" id="1357156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357159">return</span>&nbsp;<span class="ident" id="1357166">fileTransport</span><span class="op" id="1357179">{</span><span class="ident" id="1357180">fileHandler</span><span class="op" id="1357191">{</span><span class="ident" id="1357192">fs</span><span class="op" id="1357194">}</span><span class="op" id="1357195">}</span><br>
<span class="lineno"></span><span class="op" id="1357197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1357200">func</span>&nbsp;<span class="op" id="1357205">(</span><span class="ident" id="1357206">t</span>&nbsp;<span class="ident" id="1357208">fileTransport</span><span class="op" id="1357221">)</span>&nbsp;<span class="ident" id="1357223">RoundTrip</span><span class="op" id="1357232">(</span><span class="ident" id="1357233">req</span>&nbsp;<span class="op" id="1357237">*</span><span class="ident" id="1357238">Request</span><span class="op" id="1357245">)</span>&nbsp;<span class="op" id="1357247">(</span><span class="ident" id="1357248">resp</span>&nbsp;<span class="op" id="1357253">*</span><span class="ident" id="1357254">Response</span><span class="op" id="1357262">,</span>&nbsp;<span class="ident" id="1357264">err</span>&nbsp;<span class="builtintype" id="1357268">error</span><span class="op" id="1357273">)</span>&nbsp;<span class="op" id="1357275">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357278">//&nbsp;We&nbsp;start&nbsp;ServeHTTP&nbsp;in&nbsp;a&nbsp;goroutine,&nbsp;which&nbsp;may&nbsp;take&nbsp;a&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357339">//&nbsp;time&nbsp;if&nbsp;the&nbsp;file&nbsp;is&nbsp;large.&nbsp;&nbsp;The&nbsp;newPopulateResponseWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357401">//&nbsp;call&nbsp;returns&nbsp;a&nbsp;channel&nbsp;which&nbsp;either&nbsp;ServeHTTP&nbsp;or&nbsp;finish()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357463">//&nbsp;sends&nbsp;our&nbsp;*Response&nbsp;on,&nbsp;once&nbsp;the&nbsp;*Response&nbsp;itself&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357526">//&nbsp;populated&nbsp;(even&nbsp;if&nbsp;the&nbsp;body&nbsp;itself&nbsp;is&nbsp;still&nbsp;being</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1357580">//&nbsp;written&nbsp;to&nbsp;the&nbsp;res.Body,&nbsp;a&nbsp;pipe)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357617">rw</span><span class="op" id="1357619">,</span>&nbsp;<span class="ident" id="1357621">resc</span>&nbsp;<span class="op" id="1357626">:=</span>&nbsp;<span class="ident" id="1357629">newPopulateResponseWriter</span><span class="op" id="1357654">(</span><span class="op" id="1357655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357658">go</span>&nbsp;<span class="keyword" id="1357661">func</span><span class="op" id="1357665">(</span><span class="op" id="1357666">)</span>&nbsp;<span class="op" id="1357668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357672">t</span><span class="op" id="1357673">.</span><span class="ident" id="1357674">fh</span><span class="op" id="1357676">.</span><span class="ident" id="1357677">ServeHTTP</span><span class="op" id="1357686">(</span><span class="ident" id="1357687">rw</span><span class="op" id="1357689">,</span>&nbsp;<span class="ident" id="1357691">req</span><span class="op" id="1357694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357698">rw</span><span class="op" id="1357700">.</span><span class="ident" id="1357701">finish</span><span class="op" id="1357707">(</span><span class="op" id="1357708">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1357711">}</span><span class="op" id="1357712">(</span><span class="op" id="1357713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1357716">return</span>&nbsp;<span class="op" id="1357723">&lt;-</span><span class="ident" id="1357725">resc</span><span class="op" id="1357729">,</span>&nbsp;<span class="ident" id="1357731">nil</span><br>
<span class="lineno"></span><span class="op" id="1357735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1357738">func</span>&nbsp;<span class="ident" id="1357743">newPopulateResponseWriter</span><span class="op" id="1357768">(</span><span class="op" id="1357769">)</span>&nbsp;<span class="op" id="1357771">(</span><span class="op" id="1357772">*</span><span class="ident" id="1357773">populateResponse</span><span class="op" id="1357789">,</span>&nbsp;<span class="op" id="1357791">&lt;-</span><span class="keyword" id="1357793">chan</span>&nbsp;<span class="op" id="1357798">*</span><span class="ident" id="1357799">Response</span><span class="op" id="1357807">)</span>&nbsp;<span class="op" id="1357809">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357812">pr</span><span class="op" id="1357814">,</span>&nbsp;<span class="ident" id="1357816">pw</span>&nbsp;<span class="op" id="1357819">:=</span>&nbsp;<span class="ident" id="1357822">io</span><span class="op" id="1357824">.</span><span class="ident" id="1357825">Pipe</span><span class="op" id="1357829">(</span><span class="op" id="1357830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357833">rw</span>&nbsp;<span class="op" id="1357836">:=</span>&nbsp;<span class="op" id="1357839">&amp;</span><span class="ident" id="1357840">populateResponse</span><span class="op" id="1357856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357860">ch</span><span class="op" id="1357862">:</span>&nbsp;<span class="builtinfunc" id="1357864">make</span><span class="op" id="1357868">(</span><span class="keyword" id="1357869">chan</span>&nbsp;<span class="op" id="1357874">*</span><span class="ident" id="1357875">Response</span><span class="op" id="1357883">)</span><span class="op" id="1357884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357888">pw</span><span class="op" id="1357890">:</span>&nbsp;<span class="ident" id="1357892">pw</span><span class="op" id="1357894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357898">res</span><span class="op" id="1357901">:</span>&nbsp;<span class="op" id="1357903">&amp;</span><span class="ident" id="1357904">Response</span><span class="op" id="1357912">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357917">Proto</span><span class="op" id="1357922">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="1357929">&#34;HTTP/1.0&#34;</span><span class="op" id="1357939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357944">ProtoMajor</span><span class="op" id="1357954">:</span>&nbsp;<span class="num" id="1357956">1</span><span class="op" id="1357957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357962">Header</span><span class="op" id="1357968">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="1357974">make</span><span class="op" id="1357978">(</span><span class="ident" id="1357979">Header</span><span class="op" id="1357985">)</span><span class="op" id="1357986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1357991">Close</span><span class="op" id="1357996">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1358003">true</span><span class="op" id="1358007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358012">Body</span><span class="op" id="1358016">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1358024">pr</span><span class="op" id="1358026">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358030">}</span><span class="op" id="1358031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358037">return</span>&nbsp;<span class="ident" id="1358044">rw</span><span class="op" id="1358046">,</span>&nbsp;<span class="ident" id="1358048">rw</span><span class="op" id="1358050">.</span><span class="ident" id="1358051">ch</span><br>
<span class="lineno"></span><span class="op" id="1358054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="1358057">//&nbsp;populateResponse&nbsp;is&nbsp;a&nbsp;ResponseWriter&nbsp;that&nbsp;populates&nbsp;the&nbsp;*Response</span><br>
<span class="lineno"></span><span class="comment" id="1358126">//&nbsp;in&nbsp;res,&nbsp;and&nbsp;writes&nbsp;its&nbsp;body&nbsp;to&nbsp;a&nbsp;pipe&nbsp;connected&nbsp;to&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span><span class="comment" id="1358193">//&nbsp;body.&nbsp;Once&nbsp;writes&nbsp;begin&nbsp;or&nbsp;finish()&nbsp;is&nbsp;called,&nbsp;the&nbsp;response&nbsp;is&nbsp;sent</span><br>
<span class="lineno"></span><span class="comment" id="1358264">//&nbsp;on&nbsp;ch.</span><br>
<span class="lineno"></span><span class="keyword" id="1358274">type</span>&nbsp;<span class="ident" id="1358279">populateResponse</span>&nbsp;<span class="keyword" id="1358296">struct</span>&nbsp;<span class="op" id="1358303">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358306">res</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1358319">*</span><span class="ident" id="1358320">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358330">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1358343">chan</span>&nbsp;<span class="op" id="1358348">*</span><span class="ident" id="1358349">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358359">wroteHeader</span>&nbsp;&nbsp;<span class="builtintype" id="1358372">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358378">hasContent</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1358391">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358397">sentResponse</span>&nbsp;<span class="builtintype" id="1358410">bool</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358416">pw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1358429">*</span><span class="ident" id="1358430">io</span><span class="op" id="1358432">.</span><span class="ident" id="1358433">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="1358444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1358447">func</span>&nbsp;<span class="op" id="1358452">(</span><span class="ident" id="1358453">pr</span>&nbsp;<span class="op" id="1358456">*</span><span class="ident" id="1358457">populateResponse</span><span class="op" id="1358473">)</span>&nbsp;<span class="ident" id="1358475">finish</span><span class="op" id="1358481">(</span><span class="op" id="1358482">)</span>&nbsp;<span class="op" id="1358484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358487">if</span>&nbsp;<span class="op" id="1358490">!</span><span class="ident" id="1358491">pr</span><span class="op" id="1358493">.</span><span class="ident" id="1358494">wroteHeader</span>&nbsp;<span class="op" id="1358506">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358510">pr</span><span class="op" id="1358512">.</span><span class="ident" id="1358513">WriteHeader</span><span class="op" id="1358524">(</span><span class="num" id="1358525">500</span><span class="op" id="1358528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358534">if</span>&nbsp;<span class="op" id="1358537">!</span><span class="ident" id="1358538">pr</span><span class="op" id="1358540">.</span><span class="ident" id="1358541">sentResponse</span>&nbsp;<span class="op" id="1358554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358558">pr</span><span class="op" id="1358560">.</span><span class="ident" id="1358561">sendResponse</span><span class="op" id="1358573">(</span><span class="op" id="1358574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358577">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358580">pr</span><span class="op" id="1358582">.</span><span class="ident" id="1358583">pw</span><span class="op" id="1358585">.</span><span class="ident" id="1358586">Close</span><span class="op" id="1358591">(</span><span class="op" id="1358592">)</span><br>
<span class="lineno"></span><span class="op" id="1358594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1358597">func</span>&nbsp;<span class="op" id="1358602">(</span><span class="ident" id="1358603">pr</span>&nbsp;<span class="op" id="1358606">*</span><span class="ident" id="1358607">populateResponse</span><span class="op" id="1358623">)</span>&nbsp;<span class="ident" id="1358625">sendResponse</span><span class="op" id="1358637">(</span><span class="op" id="1358638">)</span>&nbsp;<span class="op" id="1358640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358643">if</span>&nbsp;<span class="ident" id="1358646">pr</span><span class="op" id="1358648">.</span><span class="ident" id="1358649">sentResponse</span>&nbsp;<span class="op" id="1358662">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358666">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358677">pr</span><span class="op" id="1358679">.</span><span class="ident" id="1358680">sentResponse</span>&nbsp;<span class="op" id="1358693">=</span>&nbsp;<span class="builtintype" id="1358695">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358702">if</span>&nbsp;<span class="ident" id="1358705">pr</span><span class="op" id="1358707">.</span><span class="ident" id="1358708">hasContent</span>&nbsp;<span class="op" id="1358719">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358723">pr</span><span class="op" id="1358725">.</span><span class="ident" id="1358726">res</span><span class="op" id="1358729">.</span><span class="ident" id="1358730">ContentLength</span>&nbsp;<span class="op" id="1358744">=</span>&nbsp;<span class="op" id="1358746">-</span><span class="num" id="1358747">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358753">pr</span><span class="op" id="1358755">.</span><span class="ident" id="1358756">ch</span>&nbsp;<span class="op" id="1358759">&lt;-</span>&nbsp;<span class="ident" id="1358762">pr</span><span class="op" id="1358764">.</span><span class="ident" id="1358765">res</span><br>
<span class="lineno"></span><span class="op" id="1358769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="1358772">func</span>&nbsp;<span class="op" id="1358777">(</span><span class="ident" id="1358778">pr</span>&nbsp;<span class="op" id="1358781">*</span><span class="ident" id="1358782">populateResponse</span><span class="op" id="1358798">)</span>&nbsp;<span class="ident" id="1358800">Header</span><span class="op" id="1358806">(</span><span class="op" id="1358807">)</span>&nbsp;<span class="ident" id="1358809">Header</span>&nbsp;<span class="op" id="1358816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358819">return</span>&nbsp;<span class="ident" id="1358826">pr</span><span class="op" id="1358828">.</span><span class="ident" id="1358829">res</span><span class="op" id="1358832">.</span><span class="ident" id="1358833">Header</span><br>
<span class="lineno"></span><span class="op" id="1358840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1358843">func</span>&nbsp;<span class="op" id="1358848">(</span><span class="ident" id="1358849">pr</span>&nbsp;<span class="op" id="1358852">*</span><span class="ident" id="1358853">populateResponse</span><span class="op" id="1358869">)</span>&nbsp;<span class="ident" id="1358871">WriteHeader</span><span class="op" id="1358882">(</span><span class="ident" id="1358883">code</span>&nbsp;<span class="builtintype" id="1358888">int</span><span class="op" id="1358891">)</span>&nbsp;<span class="op" id="1358893">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358896">if</span>&nbsp;<span class="ident" id="1358899">pr</span><span class="op" id="1358901">.</span><span class="ident" id="1358902">wroteHeader</span>&nbsp;<span class="op" id="1358914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1358918">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1358926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358929">pr</span><span class="op" id="1358931">.</span><span class="ident" id="1358932">wroteHeader</span>&nbsp;<span class="op" id="1358944">=</span>&nbsp;<span class="builtintype" id="1358946">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358953">pr</span><span class="op" id="1358955">.</span><span class="ident" id="1358956">res</span><span class="op" id="1358959">.</span><span class="ident" id="1358960">StatusCode</span>&nbsp;<span class="op" id="1358971">=</span>&nbsp;<span class="ident" id="1358973">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1358979">pr</span><span class="op" id="1358981">.</span><span class="ident" id="1358982">res</span><span class="op" id="1358985">.</span><span class="ident" id="1358986">Status</span>&nbsp;<span class="op" id="1358993">=</span>&nbsp;<span class="ident" id="1358995">fmt</span><span class="op" id="1358998">.</span><span class="ident" id="1358999">Sprintf</span><span class="op" id="1359006">(</span><span class="string" id="1359007">&#34;%d&nbsp;%s&#34;</span><span class="op" id="1359014">,</span>&nbsp;<span class="ident" id="1359016">code</span><span class="op" id="1359020">,</span>&nbsp;<span class="ident" id="1359022">StatusText</span><span class="op" id="1359032">(</span><span class="ident" id="1359033">code</span><span class="op" id="1359037">)</span><span class="op" id="1359038">)</span><br>
<span class="lineno"></span><span class="op" id="1359040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1359043">func</span>&nbsp;<span class="op" id="1359048">(</span><span class="ident" id="1359049">pr</span>&nbsp;<span class="op" id="1359052">*</span><span class="ident" id="1359053">populateResponse</span><span class="op" id="1359069">)</span>&nbsp;<span class="ident" id="1359071">Write</span><span class="op" id="1359076">(</span><span class="ident" id="1359077">p</span>&nbsp;<span class="op" id="1359079">[</span><span class="op" id="1359080">]</span><span class="builtintype" id="1359081">byte</span><span class="op" id="1359085">)</span>&nbsp;<span class="op" id="1359087">(</span><span class="ident" id="1359088">n</span>&nbsp;<span class="builtintype" id="1359090">int</span><span class="op" id="1359093">,</span>&nbsp;<span class="ident" id="1359095">err</span>&nbsp;<span class="builtintype" id="1359099">error</span><span class="op" id="1359104">)</span>&nbsp;<span class="op" id="1359106">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359109">if</span>&nbsp;<span class="op" id="1359112">!</span><span class="ident" id="1359113">pr</span><span class="op" id="1359115">.</span><span class="ident" id="1359116">wroteHeader</span>&nbsp;<span class="op" id="1359128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359132">pr</span><span class="op" id="1359134">.</span><span class="ident" id="1359135">WriteHeader</span><span class="op" id="1359146">(</span><span class="ident" id="1359147">StatusOK</span><span class="op" id="1359155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359161">pr</span><span class="op" id="1359163">.</span><span class="ident" id="1359164">hasContent</span>&nbsp;<span class="op" id="1359175">=</span>&nbsp;<span class="builtintype" id="1359177">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359183">if</span>&nbsp;<span class="op" id="1359186">!</span><span class="ident" id="1359187">pr</span><span class="op" id="1359189">.</span><span class="ident" id="1359190">sentResponse</span>&nbsp;<span class="op" id="1359203">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1359207">pr</span><span class="op" id="1359209">.</span><span class="ident" id="1359210">sendResponse</span><span class="op" id="1359222">(</span><span class="op" id="1359223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1359226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1359229">return</span>&nbsp;<span class="ident" id="1359236">pr</span><span class="op" id="1359238">.</span><span class="ident" id="1359239">pw</span><span class="op" id="1359241">.</span><span class="ident" id="1359242">Write</span><span class="op" id="1359247">(</span><span class="ident" id="1359248">p</span><span class="op" id="1359249">)</span><br>
<span class="lineno"></span><span class="op" id="1359251">}</span>
</div>
</body>
</html>
