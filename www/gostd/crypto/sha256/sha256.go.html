<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4217748">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4217803">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4217857">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4217908">//&nbsp;Package&nbsp;sha256&nbsp;implements&nbsp;the&nbsp;SHA224&nbsp;and&nbsp;SHA256&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4217986">//&nbsp;in&nbsp;FIPS&nbsp;180-4.</span><br>
<span class="lineno"></span><span class="keyword" id="4218004">package</span>&nbsp;<span class="ident" id="4218012">sha256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4218020">import</span>&nbsp;<span class="op" id="4218027">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4218030">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4218040">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4218047">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4218050">func</span>&nbsp;<span class="ident" id="4218055">init</span><span class="op" id="4218059">(</span><span class="op" id="4218060">)</span>&nbsp;<span class="op" id="4218062">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218065">crypto</span><span class="op" id="4218071">.</span><span class="ident" id="4218072">RegisterHash</span><span class="op" id="4218084">(</span><span class="ident" id="4218085">crypto</span><span class="op" id="4218091">.</span><span class="ident" id="4218092">SHA224</span><span class="op" id="4218098">,</span>&nbsp;<span class="ident" id="4218100">New224</span><span class="op" id="4218106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218109">crypto</span><span class="op" id="4218115">.</span><span class="ident" id="4218116">RegisterHash</span><span class="op" id="4218128">(</span><span class="ident" id="4218129">crypto</span><span class="op" id="4218135">.</span><span class="ident" id="4218136">SHA256</span><span class="op" id="4218142">,</span>&nbsp;<span class="ident" id="4218144">New</span><span class="op" id="4218147">)</span><br>
<span class="lineno"></span><span class="op" id="4218149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4218152">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA256&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4218195">const</span>&nbsp;<span class="ident" id="4218201">Size</span>&nbsp;<span class="op" id="4218206">=</span>&nbsp;<span class="num" id="4218208">32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4218212">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA224&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4218255">const</span>&nbsp;<span class="ident" id="4218261">Size224</span>&nbsp;<span class="op" id="4218269">=</span>&nbsp;<span class="num" id="4218271">28</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4218275">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA256&nbsp;and&nbsp;SHA224&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4218323">const</span>&nbsp;<span class="ident" id="4218329">BlockSize</span>&nbsp;<span class="op" id="4218339">=</span>&nbsp;<span class="num" id="4218341">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4218345">const</span>&nbsp;<span class="op" id="4218351">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218354">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4218364">=</span>&nbsp;<span class="num" id="4218366">64</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218370">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4218380">=</span>&nbsp;<span class="num" id="4218382">0x6A09E667</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218394">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4218404">=</span>&nbsp;<span class="num" id="4218406">0xBB67AE85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218418">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4218428">=</span>&nbsp;<span class="num" id="4218430">0x3C6EF372</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218442">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4218452">=</span>&nbsp;<span class="num" id="4218454">0xA54FF53A</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218466">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4218476">=</span>&nbsp;<span class="num" id="4218478">0x510E527F</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218490">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4218500">=</span>&nbsp;<span class="num" id="4218502">0x9B05688C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218514">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4218524">=</span>&nbsp;<span class="num" id="4218526">0x1F83D9AB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218538">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4218548">=</span>&nbsp;<span class="num" id="4218550">0x5BE0CD19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218562">init0_224</span>&nbsp;<span class="op" id="4218572">=</span>&nbsp;<span class="num" id="4218574">0xC1059ED8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218586">init1_224</span>&nbsp;<span class="op" id="4218596">=</span>&nbsp;<span class="num" id="4218598">0x367CD507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218610">init2_224</span>&nbsp;<span class="op" id="4218620">=</span>&nbsp;<span class="num" id="4218622">0x3070DD17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218634">init3_224</span>&nbsp;<span class="op" id="4218644">=</span>&nbsp;<span class="num" id="4218646">0xF70E5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218658">init4_224</span>&nbsp;<span class="op" id="4218668">=</span>&nbsp;<span class="num" id="4218670">0xFFC00B31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218682">init5_224</span>&nbsp;<span class="op" id="4218692">=</span>&nbsp;<span class="num" id="4218694">0x68581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218706">init6_224</span>&nbsp;<span class="op" id="4218716">=</span>&nbsp;<span class="num" id="4218718">0x64F98FA7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218730">init7_224</span>&nbsp;<span class="op" id="4218740">=</span>&nbsp;<span class="num" id="4218742">0xBEFA4FA4</span><br>
<span class="lineno"></span><span class="op" id="4218753">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4218756">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4218815">type</span>&nbsp;<span class="ident" id="4218820">digest</span>&nbsp;<span class="keyword" id="4218827">struct</span>&nbsp;<span class="op" id="4218834">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218837">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4218843">[</span><span class="num" id="4218844">8</span><span class="op" id="4218845">]</span><span class="builtintype" id="4218846">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218854">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4218860">[</span><span class="ident" id="4218861">chunk</span><span class="op" id="4218866">]</span><span class="builtintype" id="4218867">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218873">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4218879">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4218884">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4218890">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218898">is224</span>&nbsp;<span class="builtintype" id="4218904">bool</span>&nbsp;<span class="comment" id="4218909">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-224</span><br>
<span class="lineno">55</span><span class="op" id="4218943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4218946">func</span>&nbsp;<span class="op" id="4218951">(</span><span class="ident" id="4218952">d</span>&nbsp;<span class="op" id="4218954">*</span><span class="ident" id="4218955">digest</span><span class="op" id="4218961">)</span>&nbsp;<span class="ident" id="4218963">Reset</span><span class="op" id="4218968">(</span><span class="op" id="4218969">)</span>&nbsp;<span class="op" id="4218971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218974">if</span>&nbsp;<span class="op" id="4218977">!</span><span class="ident" id="4218978">d</span><span class="op" id="4218979">.</span><span class="ident" id="4218980">is224</span>&nbsp;<span class="op" id="4218986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218990">d</span><span class="op" id="4218991">.</span><span class="ident" id="4218992">h</span><span class="op" id="4218993">[</span><span class="num" id="4218994">0</span><span class="op" id="4218995">]</span>&nbsp;<span class="op" id="4218997">=</span>&nbsp;<span class="ident" id="4218999">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219007">d</span><span class="op" id="4219008">.</span><span class="ident" id="4219009">h</span><span class="op" id="4219010">[</span><span class="num" id="4219011">1</span><span class="op" id="4219012">]</span>&nbsp;<span class="op" id="4219014">=</span>&nbsp;<span class="ident" id="4219016">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219024">d</span><span class="op" id="4219025">.</span><span class="ident" id="4219026">h</span><span class="op" id="4219027">[</span><span class="num" id="4219028">2</span><span class="op" id="4219029">]</span>&nbsp;<span class="op" id="4219031">=</span>&nbsp;<span class="ident" id="4219033">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219041">d</span><span class="op" id="4219042">.</span><span class="ident" id="4219043">h</span><span class="op" id="4219044">[</span><span class="num" id="4219045">3</span><span class="op" id="4219046">]</span>&nbsp;<span class="op" id="4219048">=</span>&nbsp;<span class="ident" id="4219050">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219058">d</span><span class="op" id="4219059">.</span><span class="ident" id="4219060">h</span><span class="op" id="4219061">[</span><span class="num" id="4219062">4</span><span class="op" id="4219063">]</span>&nbsp;<span class="op" id="4219065">=</span>&nbsp;<span class="ident" id="4219067">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219075">d</span><span class="op" id="4219076">.</span><span class="ident" id="4219077">h</span><span class="op" id="4219078">[</span><span class="num" id="4219079">5</span><span class="op" id="4219080">]</span>&nbsp;<span class="op" id="4219082">=</span>&nbsp;<span class="ident" id="4219084">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219092">d</span><span class="op" id="4219093">.</span><span class="ident" id="4219094">h</span><span class="op" id="4219095">[</span><span class="num" id="4219096">6</span><span class="op" id="4219097">]</span>&nbsp;<span class="op" id="4219099">=</span>&nbsp;<span class="ident" id="4219101">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219109">d</span><span class="op" id="4219110">.</span><span class="ident" id="4219111">h</span><span class="op" id="4219112">[</span><span class="num" id="4219113">7</span><span class="op" id="4219114">]</span>&nbsp;<span class="op" id="4219116">=</span>&nbsp;<span class="ident" id="4219118">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219125">}</span>&nbsp;<span class="keyword" id="4219127">else</span>&nbsp;<span class="op" id="4219132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219136">d</span><span class="op" id="4219137">.</span><span class="ident" id="4219138">h</span><span class="op" id="4219139">[</span><span class="num" id="4219140">0</span><span class="op" id="4219141">]</span>&nbsp;<span class="op" id="4219143">=</span>&nbsp;<span class="ident" id="4219145">init0_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219157">d</span><span class="op" id="4219158">.</span><span class="ident" id="4219159">h</span><span class="op" id="4219160">[</span><span class="num" id="4219161">1</span><span class="op" id="4219162">]</span>&nbsp;<span class="op" id="4219164">=</span>&nbsp;<span class="ident" id="4219166">init1_224</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219178">d</span><span class="op" id="4219179">.</span><span class="ident" id="4219180">h</span><span class="op" id="4219181">[</span><span class="num" id="4219182">2</span><span class="op" id="4219183">]</span>&nbsp;<span class="op" id="4219185">=</span>&nbsp;<span class="ident" id="4219187">init2_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219199">d</span><span class="op" id="4219200">.</span><span class="ident" id="4219201">h</span><span class="op" id="4219202">[</span><span class="num" id="4219203">3</span><span class="op" id="4219204">]</span>&nbsp;<span class="op" id="4219206">=</span>&nbsp;<span class="ident" id="4219208">init3_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219220">d</span><span class="op" id="4219221">.</span><span class="ident" id="4219222">h</span><span class="op" id="4219223">[</span><span class="num" id="4219224">4</span><span class="op" id="4219225">]</span>&nbsp;<span class="op" id="4219227">=</span>&nbsp;<span class="ident" id="4219229">init4_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219241">d</span><span class="op" id="4219242">.</span><span class="ident" id="4219243">h</span><span class="op" id="4219244">[</span><span class="num" id="4219245">5</span><span class="op" id="4219246">]</span>&nbsp;<span class="op" id="4219248">=</span>&nbsp;<span class="ident" id="4219250">init5_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219262">d</span><span class="op" id="4219263">.</span><span class="ident" id="4219264">h</span><span class="op" id="4219265">[</span><span class="num" id="4219266">6</span><span class="op" id="4219267">]</span>&nbsp;<span class="op" id="4219269">=</span>&nbsp;<span class="ident" id="4219271">init6_224</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219283">d</span><span class="op" id="4219284">.</span><span class="ident" id="4219285">h</span><span class="op" id="4219286">[</span><span class="num" id="4219287">7</span><span class="op" id="4219288">]</span>&nbsp;<span class="op" id="4219290">=</span>&nbsp;<span class="ident" id="4219292">init7_224</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219306">d</span><span class="op" id="4219307">.</span><span class="ident" id="4219308">nx</span>&nbsp;<span class="op" id="4219311">=</span>&nbsp;<span class="num" id="4219313">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219316">d</span><span class="op" id="4219317">.</span><span class="builtinfunc" id="4219318">len</span>&nbsp;<span class="op" id="4219322">=</span>&nbsp;<span class="num" id="4219324">0</span><br>
<span class="lineno"></span><span class="op" id="4219326">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4219329">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA256&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4219391">func</span>&nbsp;<span class="ident" id="4219396">New</span><span class="op" id="4219399">(</span><span class="op" id="4219400">)</span>&nbsp;<span class="ident" id="4219402">hash</span><span class="op" id="4219406">.</span><span class="ident" id="4219407">Hash</span>&nbsp;<span class="op" id="4219412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219415">d</span>&nbsp;<span class="op" id="4219417">:=</span>&nbsp;<span class="builtinfunc" id="4219420">new</span><span class="op" id="4219423">(</span><span class="ident" id="4219424">digest</span><span class="op" id="4219430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219433">d</span><span class="op" id="4219434">.</span><span class="ident" id="4219435">Reset</span><span class="op" id="4219440">(</span><span class="op" id="4219441">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219444">return</span>&nbsp;<span class="ident" id="4219451">d</span><br>
<span class="lineno"></span><span class="op" id="4219453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4219456">//&nbsp;New224&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA224&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4219521">func</span>&nbsp;<span class="ident" id="4219526">New224</span><span class="op" id="4219532">(</span><span class="op" id="4219533">)</span>&nbsp;<span class="ident" id="4219535">hash</span><span class="op" id="4219539">.</span><span class="ident" id="4219540">Hash</span>&nbsp;<span class="op" id="4219545">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219548">d</span>&nbsp;<span class="op" id="4219550">:=</span>&nbsp;<span class="builtinfunc" id="4219553">new</span><span class="op" id="4219556">(</span><span class="ident" id="4219557">digest</span><span class="op" id="4219563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219566">d</span><span class="op" id="4219567">.</span><span class="ident" id="4219568">is224</span>&nbsp;<span class="op" id="4219574">=</span>&nbsp;<span class="builtintype" id="4219576">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219582">d</span><span class="op" id="4219583">.</span><span class="ident" id="4219584">Reset</span><span class="op" id="4219589">(</span><span class="op" id="4219590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219593">return</span>&nbsp;<span class="ident" id="4219600">d</span><br>
<span class="lineno"></span><span class="op" id="4219602">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4219605">func</span>&nbsp;<span class="op" id="4219610">(</span><span class="ident" id="4219611">d</span>&nbsp;<span class="op" id="4219613">*</span><span class="ident" id="4219614">digest</span><span class="op" id="4219620">)</span>&nbsp;<span class="ident" id="4219622">Size</span><span class="op" id="4219626">(</span><span class="op" id="4219627">)</span>&nbsp;<span class="builtintype" id="4219629">int</span>&nbsp;<span class="op" id="4219633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219636">if</span>&nbsp;<span class="op" id="4219639">!</span><span class="ident" id="4219640">d</span><span class="op" id="4219641">.</span><span class="ident" id="4219642">is224</span>&nbsp;<span class="op" id="4219648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219652">return</span>&nbsp;<span class="ident" id="4219659">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219665">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219668">return</span>&nbsp;<span class="ident" id="4219675">Size224</span><br>
<span class="lineno"></span><span class="op" id="4219683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4219686">func</span>&nbsp;<span class="op" id="4219691">(</span><span class="ident" id="4219692">d</span>&nbsp;<span class="op" id="4219694">*</span><span class="ident" id="4219695">digest</span><span class="op" id="4219701">)</span>&nbsp;<span class="ident" id="4219703">BlockSize</span><span class="op" id="4219712">(</span><span class="op" id="4219713">)</span>&nbsp;<span class="builtintype" id="4219715">int</span>&nbsp;<span class="op" id="4219719">{</span>&nbsp;<span class="keyword" id="4219721">return</span>&nbsp;<span class="ident" id="4219728">BlockSize</span>&nbsp;<span class="op" id="4219738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4219741">func</span>&nbsp;<span class="op" id="4219746">(</span><span class="ident" id="4219747">d</span>&nbsp;<span class="op" id="4219749">*</span><span class="ident" id="4219750">digest</span><span class="op" id="4219756">)</span>&nbsp;<span class="ident" id="4219758">Write</span><span class="op" id="4219763">(</span><span class="ident" id="4219764">p</span>&nbsp;<span class="op" id="4219766">[</span><span class="op" id="4219767">]</span><span class="builtintype" id="4219768">byte</span><span class="op" id="4219772">)</span>&nbsp;<span class="op" id="4219774">(</span><span class="ident" id="4219775">nn</span>&nbsp;<span class="builtintype" id="4219778">int</span><span class="op" id="4219781">,</span>&nbsp;<span class="ident" id="4219783">err</span>&nbsp;<span class="builtintype" id="4219787">error</span><span class="op" id="4219792">)</span>&nbsp;<span class="op" id="4219794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219797">nn</span>&nbsp;<span class="op" id="4219800">=</span>&nbsp;<span class="builtinfunc" id="4219802">len</span><span class="op" id="4219805">(</span><span class="ident" id="4219806">p</span><span class="op" id="4219807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219810">d</span><span class="op" id="4219811">.</span><span class="builtinfunc" id="4219812">len</span>&nbsp;<span class="op" id="4219816">+=</span>&nbsp;<span class="ident" id="4219819">uint64</span><span class="op" id="4219825">(</span><span class="ident" id="4219826">nn</span><span class="op" id="4219828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219831">if</span>&nbsp;<span class="ident" id="4219834">d</span><span class="op" id="4219835">.</span><span class="ident" id="4219836">nx</span>&nbsp;<span class="op" id="4219839">&gt;</span>&nbsp;<span class="num" id="4219841">0</span>&nbsp;<span class="op" id="4219843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219847">n</span>&nbsp;<span class="op" id="4219849">:=</span>&nbsp;<span class="builtinfunc" id="4219852">copy</span><span class="op" id="4219856">(</span><span class="ident" id="4219857">d</span><span class="op" id="4219858">.</span><span class="ident" id="4219859">x</span><span class="op" id="4219860">[</span><span class="ident" id="4219861">d</span><span class="op" id="4219862">.</span><span class="ident" id="4219863">nx</span><span class="op" id="4219865">:</span><span class="op" id="4219866">]</span><span class="op" id="4219867">,</span>&nbsp;<span class="ident" id="4219869">p</span><span class="op" id="4219870">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219874">d</span><span class="op" id="4219875">.</span><span class="ident" id="4219876">nx</span>&nbsp;<span class="op" id="4219879">+=</span>&nbsp;<span class="ident" id="4219882">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219886">if</span>&nbsp;<span class="ident" id="4219889">d</span><span class="op" id="4219890">.</span><span class="ident" id="4219891">nx</span>&nbsp;<span class="op" id="4219894">==</span>&nbsp;<span class="ident" id="4219897">chunk</span>&nbsp;<span class="op" id="4219903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219908">block</span><span class="op" id="4219913">(</span><span class="ident" id="4219914">d</span><span class="op" id="4219915">,</span>&nbsp;<span class="ident" id="4219917">d</span><span class="op" id="4219918">.</span><span class="ident" id="4219919">x</span><span class="op" id="4219920">[</span><span class="op" id="4219921">:</span><span class="op" id="4219922">]</span><span class="op" id="4219923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219928">d</span><span class="op" id="4219929">.</span><span class="ident" id="4219930">nx</span>&nbsp;<span class="op" id="4219933">=</span>&nbsp;<span class="num" id="4219935">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219939">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219943">p</span>&nbsp;<span class="op" id="4219945">=</span>&nbsp;<span class="ident" id="4219947">p</span><span class="op" id="4219948">[</span><span class="ident" id="4219949">n</span><span class="op" id="4219950">:</span><span class="op" id="4219951">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219957">if</span>&nbsp;<span class="builtinfunc" id="4219960">len</span><span class="op" id="4219963">(</span><span class="ident" id="4219964">p</span><span class="op" id="4219965">)</span>&nbsp;<span class="op" id="4219967">&gt;=</span>&nbsp;<span class="ident" id="4219970">chunk</span>&nbsp;<span class="op" id="4219976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219980">n</span>&nbsp;<span class="op" id="4219982">:=</span>&nbsp;<span class="builtinfunc" id="4219985">len</span><span class="op" id="4219988">(</span><span class="ident" id="4219989">p</span><span class="op" id="4219990">)</span>&nbsp;<span class="op" id="4219992">&amp;^</span>&nbsp;<span class="op" id="4219995">(</span><span class="ident" id="4219996">chunk</span>&nbsp;<span class="op" id="4220002">-</span>&nbsp;<span class="num" id="4220004">1</span><span class="op" id="4220005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220009">block</span><span class="op" id="4220014">(</span><span class="ident" id="4220015">d</span><span class="op" id="4220016">,</span>&nbsp;<span class="ident" id="4220018">p</span><span class="op" id="4220019">[</span><span class="op" id="4220020">:</span><span class="ident" id="4220021">n</span><span class="op" id="4220022">]</span><span class="op" id="4220023">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220027">p</span>&nbsp;<span class="op" id="4220029">=</span>&nbsp;<span class="ident" id="4220031">p</span><span class="op" id="4220032">[</span><span class="ident" id="4220033">n</span><span class="op" id="4220034">:</span><span class="op" id="4220035">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220041">if</span>&nbsp;<span class="builtinfunc" id="4220044">len</span><span class="op" id="4220047">(</span><span class="ident" id="4220048">p</span><span class="op" id="4220049">)</span>&nbsp;<span class="op" id="4220051">&gt;</span>&nbsp;<span class="num" id="4220053">0</span>&nbsp;<span class="op" id="4220055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220059">d</span><span class="op" id="4220060">.</span><span class="ident" id="4220061">nx</span>&nbsp;<span class="op" id="4220064">=</span>&nbsp;<span class="builtinfunc" id="4220066">copy</span><span class="op" id="4220070">(</span><span class="ident" id="4220071">d</span><span class="op" id="4220072">.</span><span class="ident" id="4220073">x</span><span class="op" id="4220074">[</span><span class="op" id="4220075">:</span><span class="op" id="4220076">]</span><span class="op" id="4220077">,</span>&nbsp;<span class="ident" id="4220079">p</span><span class="op" id="4220080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220083">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220086">return</span><br>
<span class="lineno"></span><span class="op" id="4220093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4220096">func</span>&nbsp;<span class="op" id="4220101">(</span><span class="ident" id="4220102">d0</span>&nbsp;<span class="op" id="4220105">*</span><span class="ident" id="4220106">digest</span><span class="op" id="4220112">)</span>&nbsp;<span class="ident" id="4220114">Sum</span><span class="op" id="4220117">(</span><span class="ident" id="4220118">in</span>&nbsp;<span class="op" id="4220121">[</span><span class="op" id="4220122">]</span><span class="builtintype" id="4220123">byte</span><span class="op" id="4220127">)</span>&nbsp;<span class="op" id="4220129">[</span><span class="op" id="4220130">]</span><span class="builtintype" id="4220131">byte</span>&nbsp;<span class="op" id="4220136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4220139">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220206">d</span>&nbsp;<span class="op" id="4220208">:=</span>&nbsp;<span class="op" id="4220211">*</span><span class="ident" id="4220212">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220216">hash</span>&nbsp;<span class="op" id="4220221">:=</span>&nbsp;<span class="ident" id="4220224">d</span><span class="op" id="4220225">.</span><span class="ident" id="4220226">checkSum</span><span class="op" id="4220234">(</span><span class="op" id="4220235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220238">if</span>&nbsp;<span class="ident" id="4220241">d</span><span class="op" id="4220242">.</span><span class="ident" id="4220243">is224</span>&nbsp;<span class="op" id="4220249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220253">return</span>&nbsp;<span class="builtinfunc" id="4220260">append</span><span class="op" id="4220266">(</span><span class="ident" id="4220267">in</span><span class="op" id="4220269">,</span>&nbsp;<span class="ident" id="4220271">hash</span><span class="op" id="4220275">[</span><span class="op" id="4220276">:</span><span class="ident" id="4220277">Size224</span><span class="op" id="4220284">]</span><span class="op" id="4220285">...</span><span class="op" id="4220288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220291">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220294">return</span>&nbsp;<span class="builtinfunc" id="4220301">append</span><span class="op" id="4220307">(</span><span class="ident" id="4220308">in</span><span class="op" id="4220310">,</span>&nbsp;<span class="ident" id="4220312">hash</span><span class="op" id="4220316">[</span><span class="op" id="4220317">:</span><span class="op" id="4220318">]</span><span class="op" id="4220319">...</span><span class="op" id="4220322">)</span><br>
<span class="lineno"></span><span class="op" id="4220324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4220327">func</span>&nbsp;<span class="op" id="4220332">(</span><span class="ident" id="4220333">d</span>&nbsp;<span class="op" id="4220335">*</span><span class="ident" id="4220336">digest</span><span class="op" id="4220342">)</span>&nbsp;<span class="ident" id="4220344">checkSum</span><span class="op" id="4220352">(</span><span class="op" id="4220353">)</span>&nbsp;<span class="op" id="4220355">[</span><span class="ident" id="4220356">Size</span><span class="op" id="4220360">]</span><span class="builtintype" id="4220361">byte</span>&nbsp;<span class="op" id="4220366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4220369">len</span>&nbsp;<span class="op" id="4220373">:=</span>&nbsp;<span class="ident" id="4220376">d</span><span class="op" id="4220377">.</span><span class="builtinfunc" id="4220378">len</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4220383">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220443">var</span>&nbsp;<span class="ident" id="4220447">tmp</span>&nbsp;<span class="op" id="4220451">[</span><span class="num" id="4220452">64</span><span class="op" id="4220454">]</span><span class="builtintype" id="4220455">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220461">tmp</span><span class="op" id="4220464">[</span><span class="num" id="4220465">0</span><span class="op" id="4220466">]</span>&nbsp;<span class="op" id="4220468">=</span>&nbsp;<span class="num" id="4220470">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220476">if</span>&nbsp;<span class="builtinfunc" id="4220479">len</span><span class="op" id="4220482">%</span><span class="num" id="4220483">64</span>&nbsp;<span class="op" id="4220486">&lt;</span>&nbsp;<span class="num" id="4220488">56</span>&nbsp;<span class="op" id="4220491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220495">d</span><span class="op" id="4220496">.</span><span class="ident" id="4220497">Write</span><span class="op" id="4220502">(</span><span class="ident" id="4220503">tmp</span><span class="op" id="4220506">[</span><span class="num" id="4220507">0</span>&nbsp;<span class="op" id="4220509">:</span>&nbsp;<span class="num" id="4220511">56</span><span class="op" id="4220513">-</span><span class="builtinfunc" id="4220514">len</span><span class="op" id="4220517">%</span><span class="num" id="4220518">64</span><span class="op" id="4220520">]</span><span class="op" id="4220521">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220524">}</span>&nbsp;<span class="keyword" id="4220526">else</span>&nbsp;<span class="op" id="4220531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220535">d</span><span class="op" id="4220536">.</span><span class="ident" id="4220537">Write</span><span class="op" id="4220542">(</span><span class="ident" id="4220543">tmp</span><span class="op" id="4220546">[</span><span class="num" id="4220547">0</span>&nbsp;<span class="op" id="4220549">:</span>&nbsp;<span class="num" id="4220551">64</span><span class="op" id="4220553">+</span><span class="num" id="4220554">56</span><span class="op" id="4220556">-</span><span class="builtinfunc" id="4220557">len</span><span class="op" id="4220560">%</span><span class="num" id="4220561">64</span><span class="op" id="4220563">]</span><span class="op" id="4220564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4220571">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4220591">len</span>&nbsp;<span class="op" id="4220595">&lt;&lt;=</span>&nbsp;<span class="num" id="4220599">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220602">for</span>&nbsp;<span class="ident" id="4220606">i</span>&nbsp;<span class="op" id="4220608">:=</span>&nbsp;<span class="builtintype" id="4220611">uint</span><span class="op" id="4220615">(</span><span class="num" id="4220616">0</span><span class="op" id="4220617">)</span><span class="op" id="4220618">;</span>&nbsp;<span class="ident" id="4220620">i</span>&nbsp;<span class="op" id="4220622">&lt;</span>&nbsp;<span class="num" id="4220624">8</span><span class="op" id="4220625">;</span>&nbsp;<span class="ident" id="4220627">i</span><span class="op" id="4220628">++</span>&nbsp;<span class="op" id="4220631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220635">tmp</span><span class="op" id="4220638">[</span><span class="ident" id="4220639">i</span><span class="op" id="4220640">]</span>&nbsp;<span class="op" id="4220642">=</span>&nbsp;<span class="builtintype" id="4220644">byte</span><span class="op" id="4220648">(</span><span class="builtinfunc" id="4220649">len</span>&nbsp;<span class="op" id="4220653">&gt;&gt;</span>&nbsp;<span class="op" id="4220656">(</span><span class="num" id="4220657">56</span>&nbsp;<span class="op" id="4220660">-</span>&nbsp;<span class="num" id="4220662">8</span><span class="op" id="4220663">*</span><span class="ident" id="4220664">i</span><span class="op" id="4220665">)</span><span class="op" id="4220666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220672">d</span><span class="op" id="4220673">.</span><span class="ident" id="4220674">Write</span><span class="op" id="4220679">(</span><span class="ident" id="4220680">tmp</span><span class="op" id="4220683">[</span><span class="num" id="4220684">0</span><span class="op" id="4220685">:</span><span class="num" id="4220686">8</span><span class="op" id="4220687">]</span><span class="op" id="4220688">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220692">if</span>&nbsp;<span class="ident" id="4220695">d</span><span class="op" id="4220696">.</span><span class="ident" id="4220697">nx</span>&nbsp;<span class="op" id="4220700">!=</span>&nbsp;<span class="num" id="4220703">0</span>&nbsp;<span class="op" id="4220705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4220709">panic</span><span class="op" id="4220714">(</span><span class="string" id="4220715">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4220726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220733">h</span>&nbsp;<span class="op" id="4220735">:=</span>&nbsp;<span class="ident" id="4220738">d</span><span class="op" id="4220739">.</span><span class="ident" id="4220740">h</span><span class="op" id="4220741">[</span><span class="op" id="4220742">:</span><span class="op" id="4220743">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220746">if</span>&nbsp;<span class="ident" id="4220749">d</span><span class="op" id="4220750">.</span><span class="ident" id="4220751">is224</span>&nbsp;<span class="op" id="4220757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220761">h</span>&nbsp;<span class="op" id="4220763">=</span>&nbsp;<span class="ident" id="4220765">d</span><span class="op" id="4220766">.</span><span class="ident" id="4220767">h</span><span class="op" id="4220768">[</span><span class="op" id="4220769">:</span><span class="num" id="4220770">7</span><span class="op" id="4220771">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220778">var</span>&nbsp;<span class="ident" id="4220782">digest</span>&nbsp;<span class="op" id="4220789">[</span><span class="ident" id="4220790">Size</span><span class="op" id="4220794">]</span><span class="builtintype" id="4220795">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220801">for</span>&nbsp;<span class="ident" id="4220805">i</span><span class="op" id="4220806">,</span>&nbsp;<span class="ident" id="4220808">s</span>&nbsp;<span class="op" id="4220810">:=</span>&nbsp;<span class="keyword" id="4220813">range</span>&nbsp;<span class="ident" id="4220819">h</span>&nbsp;<span class="op" id="4220821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220825">digest</span><span class="op" id="4220831">[</span><span class="ident" id="4220832">i</span><span class="op" id="4220833">*</span><span class="num" id="4220834">4</span><span class="op" id="4220835">]</span>&nbsp;<span class="op" id="4220837">=</span>&nbsp;<span class="builtintype" id="4220839">byte</span><span class="op" id="4220843">(</span><span class="ident" id="4220844">s</span>&nbsp;<span class="op" id="4220846">&gt;&gt;</span>&nbsp;<span class="num" id="4220849">24</span><span class="op" id="4220851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220855">digest</span><span class="op" id="4220861">[</span><span class="ident" id="4220862">i</span><span class="op" id="4220863">*</span><span class="num" id="4220864">4</span><span class="op" id="4220865">+</span><span class="num" id="4220866">1</span><span class="op" id="4220867">]</span>&nbsp;<span class="op" id="4220869">=</span>&nbsp;<span class="builtintype" id="4220871">byte</span><span class="op" id="4220875">(</span><span class="ident" id="4220876">s</span>&nbsp;<span class="op" id="4220878">&gt;&gt;</span>&nbsp;<span class="num" id="4220881">16</span><span class="op" id="4220883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220887">digest</span><span class="op" id="4220893">[</span><span class="ident" id="4220894">i</span><span class="op" id="4220895">*</span><span class="num" id="4220896">4</span><span class="op" id="4220897">+</span><span class="num" id="4220898">2</span><span class="op" id="4220899">]</span>&nbsp;<span class="op" id="4220901">=</span>&nbsp;<span class="builtintype" id="4220903">byte</span><span class="op" id="4220907">(</span><span class="ident" id="4220908">s</span>&nbsp;<span class="op" id="4220910">&gt;&gt;</span>&nbsp;<span class="num" id="4220913">8</span><span class="op" id="4220914">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220918">digest</span><span class="op" id="4220924">[</span><span class="ident" id="4220925">i</span><span class="op" id="4220926">*</span><span class="num" id="4220927">4</span><span class="op" id="4220928">+</span><span class="num" id="4220929">3</span><span class="op" id="4220930">]</span>&nbsp;<span class="op" id="4220932">=</span>&nbsp;<span class="builtintype" id="4220934">byte</span><span class="op" id="4220938">(</span><span class="ident" id="4220939">s</span><span class="op" id="4220940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220947">return</span>&nbsp;<span class="ident" id="4220954">digest</span><br>
<span class="lineno"></span><span class="op" id="4220961">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4220964">//&nbsp;Sum256&nbsp;returns&nbsp;the&nbsp;SHA256&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4221015">func</span>&nbsp;<span class="ident" id="4221020">Sum256</span><span class="op" id="4221026">(</span><span class="ident" id="4221027">data</span>&nbsp;<span class="op" id="4221032">[</span><span class="op" id="4221033">]</span><span class="builtintype" id="4221034">byte</span><span class="op" id="4221038">)</span>&nbsp;<span class="op" id="4221040">[</span><span class="ident" id="4221041">Size</span><span class="op" id="4221045">]</span><span class="builtintype" id="4221046">byte</span>&nbsp;<span class="op" id="4221051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221054">var</span>&nbsp;<span class="ident" id="4221058">d</span>&nbsp;<span class="ident" id="4221060">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221068">d</span><span class="op" id="4221069">.</span><span class="ident" id="4221070">Reset</span><span class="op" id="4221075">(</span><span class="op" id="4221076">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221079">d</span><span class="op" id="4221080">.</span><span class="ident" id="4221081">Write</span><span class="op" id="4221086">(</span><span class="ident" id="4221087">data</span><span class="op" id="4221091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221094">return</span>&nbsp;<span class="ident" id="4221101">d</span><span class="op" id="4221102">.</span><span class="ident" id="4221103">checkSum</span><span class="op" id="4221111">(</span><span class="op" id="4221112">)</span><br>
<span class="lineno"></span><span class="op" id="4221114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4221117">//&nbsp;Sum224&nbsp;returns&nbsp;the&nbsp;SHA224&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">185</span><span class="keyword" id="4221168">func</span>&nbsp;<span class="ident" id="4221173">Sum224</span><span class="op" id="4221179">(</span><span class="ident" id="4221180">data</span>&nbsp;<span class="op" id="4221185">[</span><span class="op" id="4221186">]</span><span class="builtintype" id="4221187">byte</span><span class="op" id="4221191">)</span>&nbsp;<span class="op" id="4221193">(</span><span class="ident" id="4221194">sum224</span>&nbsp;<span class="op" id="4221201">[</span><span class="ident" id="4221202">Size224</span><span class="op" id="4221209">]</span><span class="builtintype" id="4221210">byte</span><span class="op" id="4221214">)</span>&nbsp;<span class="op" id="4221216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221219">var</span>&nbsp;<span class="ident" id="4221223">d</span>&nbsp;<span class="ident" id="4221225">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221233">d</span><span class="op" id="4221234">.</span><span class="ident" id="4221235">is224</span>&nbsp;<span class="op" id="4221241">=</span>&nbsp;<span class="builtintype" id="4221243">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221249">d</span><span class="op" id="4221250">.</span><span class="ident" id="4221251">Reset</span><span class="op" id="4221256">(</span><span class="op" id="4221257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221260">d</span><span class="op" id="4221261">.</span><span class="ident" id="4221262">Write</span><span class="op" id="4221267">(</span><span class="ident" id="4221268">data</span><span class="op" id="4221272">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221275">sum</span>&nbsp;<span class="op" id="4221279">:=</span>&nbsp;<span class="ident" id="4221282">d</span><span class="op" id="4221283">.</span><span class="ident" id="4221284">checkSum</span><span class="op" id="4221292">(</span><span class="op" id="4221293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4221296">copy</span><span class="op" id="4221300">(</span><span class="ident" id="4221301">sum224</span><span class="op" id="4221307">[</span><span class="op" id="4221308">:</span><span class="op" id="4221309">]</span><span class="op" id="4221310">,</span>&nbsp;<span class="ident" id="4221312">sum</span><span class="op" id="4221315">[</span><span class="op" id="4221316">:</span><span class="ident" id="4221317">Size224</span><span class="op" id="4221324">]</span><span class="op" id="4221325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221328">return</span><br>
<span class="lineno"></span><span class="op" id="4221335">}</span>
</div>
</body>
</html>
