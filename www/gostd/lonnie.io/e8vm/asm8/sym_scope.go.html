<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/asm8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/asm8/bare_func.go.html">bare_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_file.go.html">build_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_func.go.html">build_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_lib.go.html">build_lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_var.go.html">build_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/builder.go.html">builder.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/check_type.go.html">check_type.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_hex.go.html">data_hex.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_nums.go.html">data_nums.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_str.go.html">data_str.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/file.go.html">file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_decl.go.html">func_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_stmt.go.html">func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst.go.html">inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all.go.html">lex_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all_test.go.html">lex_all_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_comment.go.html">lex_comment.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_operand.go.html">lex_operand.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_string.go.html">lex_string.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lib.go.html">lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/package.go.html">package.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_arg.go.html">parse_arg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_file.go.html">parse_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func.go.html">parse_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_stmt.go.html">parse_func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_test.go.html">parse_func_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_inst.go.html">parse_inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_label.go.html">parse_label.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_reg.go.html">parse_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_sym.go.html">parse_sym.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var.go.html">parse_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var_stmt.go.html">parse_var_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parser.go.html">parser.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/single_file.go.html">single_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/stmt_lexer.go.html">stmt_lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_scope.go.html">sym_scope.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_table.go.html">sym_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/symbol.go.html">symbol.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/token.go.html">token.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_decl.go.html">var_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_stmt.go.html">var_stmt.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="3662589">package</span>&nbsp;<span class="ident" id="3662597">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3662603">//&nbsp;SymScope&nbsp;is&nbsp;a&nbsp;stack&nbsp;of&nbsp;symbol&nbsp;tables.</span><br>
<span class="lineno"></span><span class="keyword" id="3662644">type</span>&nbsp;<span class="ident" id="3662649">symScope</span>&nbsp;<span class="keyword" id="3662658">struct</span>&nbsp;<span class="op" id="3662665">{</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662668">stack</span>&nbsp;<span class="op" id="3662674">[</span><span class="op" id="3662675">]</span><span class="op" id="3662676">*</span><span class="ident" id="3662677">symTabel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662687">top</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3662693">*</span><span class="ident" id="3662694">symTabel</span>&nbsp;<span class="comment" id="3662703">//&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="op" id="3662714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3662717">//&nbsp;NewSymScope&nbsp;creates&nbsp;a&nbsp;new&nbsp;symbole&nbsp;scope&nbsp;with&nbsp;one&nbsp;symbol&nbsp;table&nbsp;at&nbsp;the</span><br>
<span class="lineno">10</span><span class="comment" id="3662789">//&nbsp;bottom.</span><br>
<span class="lineno"></span><span class="keyword" id="3662800">func</span>&nbsp;<span class="ident" id="3662805">newSymScope</span><span class="op" id="3662816">(</span><span class="op" id="3662817">)</span>&nbsp;<span class="op" id="3662819">*</span><span class="ident" id="3662820">symScope</span>&nbsp;<span class="op" id="3662829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662832">ret</span>&nbsp;<span class="op" id="3662836">:=</span>&nbsp;<span class="builtinfunc" id="3662839">new</span><span class="op" id="3662842">(</span><span class="ident" id="3662843">symScope</span><span class="op" id="3662851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662854">ret</span><span class="op" id="3662857">.</span><span class="ident" id="3662858">Push</span><span class="op" id="3662862">(</span><span class="op" id="3662863">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3662867">return</span>&nbsp;<span class="ident" id="3662874">ret</span><br>
<span class="lineno"></span><span class="op" id="3662878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3662881">//&nbsp;Push&nbsp;adds&nbsp;a&nbsp;new&nbsp;symbol&nbsp;table&nbsp;on&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="3662938">func</span>&nbsp;<span class="op" id="3662943">(</span><span class="ident" id="3662944">s</span>&nbsp;<span class="op" id="3662946">*</span><span class="ident" id="3662947">symScope</span><span class="op" id="3662955">)</span>&nbsp;<span class="ident" id="3662957">Push</span><span class="op" id="3662961">(</span><span class="op" id="3662962">)</span>&nbsp;<span class="op" id="3662964">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662967">tab</span>&nbsp;<span class="op" id="3662971">:=</span>&nbsp;<span class="ident" id="3662974">newSymTable</span><span class="op" id="3662985">(</span><span class="op" id="3662986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3662989">s</span><span class="op" id="3662990">.</span><span class="ident" id="3662991">top</span>&nbsp;<span class="op" id="3662995">=</span>&nbsp;<span class="ident" id="3662997">tab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3663002">s</span><span class="op" id="3663003">.</span><span class="ident" id="3663004">stack</span>&nbsp;<span class="op" id="3663010">=</span>&nbsp;<span class="builtinfunc" id="3663012">append</span><span class="op" id="3663018">(</span><span class="ident" id="3663019">s</span><span class="op" id="3663020">.</span><span class="ident" id="3663021">stack</span><span class="op" id="3663026">,</span>&nbsp;<span class="ident" id="3663028">tab</span><span class="op" id="3663031">)</span><br>
<span class="lineno"></span><span class="op" id="3663033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3663036">//&nbsp;Pop&nbsp;removes&nbsp;a&nbsp;symbol&nbsp;table&nbsp;from&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="3663093">//&nbsp;It&nbsp;panics&nbsp;when&nbsp;the&nbsp;stack&nbsp;is&nbsp;empty&nbsp;after&nbsp;the&nbsp;pop.</span><br>
<span class="lineno"></span><span class="keyword" id="3663145">func</span>&nbsp;<span class="op" id="3663150">(</span><span class="ident" id="3663151">s</span>&nbsp;<span class="op" id="3663153">*</span><span class="ident" id="3663154">symScope</span><span class="op" id="3663162">)</span>&nbsp;<span class="ident" id="3663164">Pop</span><span class="op" id="3663167">(</span><span class="op" id="3663168">)</span>&nbsp;<span class="op" id="3663170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3663173">n</span>&nbsp;<span class="op" id="3663175">:=</span>&nbsp;<span class="builtinfunc" id="3663178">len</span><span class="op" id="3663181">(</span><span class="ident" id="3663182">s</span><span class="op" id="3663183">.</span><span class="ident" id="3663184">stack</span><span class="op" id="3663189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3663192">if</span>&nbsp;<span class="ident" id="3663195">n</span>&nbsp;<span class="op" id="3663197">&lt;</span>&nbsp;<span class="num" id="3663199">2</span>&nbsp;<span class="op" id="3663201">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3663205">panic</span><span class="op" id="3663210">(</span><span class="string" id="3663211">&#34;stack&nbsp;empty&nbsp;after&nbsp;pop&#34;</span><span class="op" id="3663234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3663237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3663241">s</span><span class="op" id="3663242">.</span><span class="ident" id="3663243">stack</span>&nbsp;<span class="op" id="3663249">=</span>&nbsp;<span class="ident" id="3663251">s</span><span class="op" id="3663252">.</span><span class="ident" id="3663253">stack</span><span class="op" id="3663258">[</span><span class="op" id="3663259">:</span><span class="ident" id="3663260">n</span><span class="op" id="3663261">-</span><span class="num" id="3663262">1</span><span class="op" id="3663263">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3663266">s</span><span class="op" id="3663267">.</span><span class="ident" id="3663268">top</span>&nbsp;<span class="op" id="3663272">=</span>&nbsp;<span class="ident" id="3663274">s</span><span class="op" id="3663275">.</span><span class="ident" id="3663276">stack</span><span class="op" id="3663281">[</span><span class="ident" id="3663282">n</span><span class="op" id="3663283">-</span><span class="num" id="3663284">2</span><span class="op" id="3663285">]</span><br>
<span class="lineno">35</span><span class="op" id="3663287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3663290">//&nbsp;Depth&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;scopes&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="3663342">func</span>&nbsp;<span class="op" id="3663347">(</span><span class="ident" id="3663348">s</span>&nbsp;<span class="op" id="3663350">*</span><span class="ident" id="3663351">symScope</span><span class="op" id="3663359">)</span>&nbsp;<span class="ident" id="3663361">Depth</span><span class="op" id="3663366">(</span><span class="op" id="3663367">)</span>&nbsp;<span class="builtintype" id="3663369">int</span>&nbsp;<span class="op" id="3663373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3663376">return</span>&nbsp;<span class="builtinfunc" id="3663383">len</span><span class="op" id="3663386">(</span><span class="ident" id="3663387">s</span><span class="op" id="3663388">.</span><span class="ident" id="3663389">stack</span><span class="op" id="3663394">)</span><br>
<span class="lineno">40</span><span class="op" id="3663396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3663399">//&nbsp;Query&nbsp;searches&nbsp;for&nbsp;the&nbsp;top&nbsp;visible&nbsp;symbol&nbsp;with&nbsp;a&nbsp;particular&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3663468">func</span>&nbsp;<span class="op" id="3663473">(</span><span class="ident" id="3663474">s</span>&nbsp;<span class="op" id="3663476">*</span><span class="ident" id="3663477">symScope</span><span class="op" id="3663485">)</span>&nbsp;<span class="ident" id="3663487">Query</span><span class="op" id="3663492">(</span><span class="ident" id="3663493">n</span>&nbsp;<span class="builtintype" id="3663495">string</span><span class="op" id="3663501">)</span>&nbsp;<span class="op" id="3663503">*</span><span class="ident" id="3663504">symbol</span>&nbsp;<span class="op" id="3663511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3663514">d</span>&nbsp;<span class="op" id="3663516">:=</span>&nbsp;<span class="builtinfunc" id="3663519">len</span><span class="op" id="3663522">(</span><span class="ident" id="3663523">s</span><span class="op" id="3663524">.</span><span class="ident" id="3663525">stack</span><span class="op" id="3663530">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3663534">for</span>&nbsp;<span class="ident" id="3663538">i</span>&nbsp;<span class="op" id="3663540">:=</span>&nbsp;<span class="ident" id="3663543">d</span>&nbsp;<span class="op" id="3663545">-</span>&nbsp;<span class="num" id="3663547">1</span><span class="op" id="3663548">;</span>&nbsp;<span class="ident" id="3663550">i</span>&nbsp;<span class="op" id="3663552">&gt;=</span>&nbsp;<span class="num" id="3663555">0</span><span class="op" id="3663556">;</span>&nbsp;<span class="ident" id="3663558">i</span><span class="op" id="3663559">--</span>&nbsp;<span class="op" id="3663562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3663566">tab</span>&nbsp;<span class="op" id="3663570">:=</span>&nbsp;<span class="ident" id="3663573">s</span><span class="op" id="3663574">.</span><span class="ident" id="3663575">stack</span><span class="op" id="3663580">[</span><span class="ident" id="3663581">i</span><span class="op" id="3663582">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3663586">ret</span>&nbsp;<span class="op" id="3663590">:=</span>&nbsp;<span class="ident" id="3663593">tab</span><span class="op" id="3663596">.</span><span class="ident" id="3663597">Query</span><span class="op" id="3663602">(</span><span class="ident" id="3663603">n</span><span class="op" id="3663604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3663608">if</span>&nbsp;<span class="ident" id="3663611">ret</span>&nbsp;<span class="op" id="3663615">!=</span>&nbsp;<span class="ident" id="3663618">nil</span>&nbsp;<span class="op" id="3663622">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3663627">return</span>&nbsp;<span class="ident" id="3663634">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3663640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3663643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3663647">return</span>&nbsp;<span class="ident" id="3663654">nil</span><br>
<span class="lineno">55</span><span class="op" id="3663658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3663661">//&nbsp;Declare&nbsp;declares&nbsp;a&nbsp;symbole&nbsp;on&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="3663729">//&nbsp;It&nbsp;returns&nbsp;nil&nbsp;on&nbsp;successful,&nbsp;and&nbsp;returns&nbsp;the&nbsp;conflict&nbsp;symbol&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="3663799">//&nbsp;it&nbsp;is&nbsp;already&nbsp;declared.</span><br>
<span class="lineno">60</span><span class="keyword" id="3663826">func</span>&nbsp;<span class="op" id="3663831">(</span><span class="ident" id="3663832">s</span>&nbsp;<span class="op" id="3663834">*</span><span class="ident" id="3663835">symScope</span><span class="op" id="3663843">)</span>&nbsp;<span class="ident" id="3663845">Declare</span><span class="op" id="3663852">(</span><span class="ident" id="3663853">sym</span>&nbsp;<span class="op" id="3663857">*</span><span class="ident" id="3663858">symbol</span><span class="op" id="3663864">)</span>&nbsp;<span class="op" id="3663866">*</span><span class="ident" id="3663867">symbol</span>&nbsp;<span class="op" id="3663874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3663877">return</span>&nbsp;<span class="ident" id="3663884">s</span><span class="op" id="3663885">.</span><span class="ident" id="3663886">top</span><span class="op" id="3663889">.</span><span class="ident" id="3663890">Declare</span><span class="op" id="3663897">(</span><span class="ident" id="3663898">sym</span><span class="op" id="3663901">)</span><br>
<span class="lineno"></span><span class="op" id="3663903">}</span>
</div>
</body>
</html>
