<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html" class="current">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3091477">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3091532">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3091586">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3091637">//&nbsp;IP&nbsp;address&nbsp;manipulations</span><br>
<span class="lineno"></span><span class="comment" id="3091665">//</span><br>
<span class="lineno"></span><span class="comment" id="3091668">//&nbsp;IPv4&nbsp;addresses&nbsp;are&nbsp;4&nbsp;bytes;&nbsp;IPv6&nbsp;addresses&nbsp;are&nbsp;16&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3091728">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3091786">//&nbsp;adding&nbsp;a&nbsp;canonical&nbsp;prefix&nbsp;(10&nbsp;zeros,&nbsp;2&nbsp;0xFFs).</span><br>
<span class="lineno">10</span><span class="comment" id="3091836">//&nbsp;This&nbsp;library&nbsp;accepts&nbsp;either&nbsp;size&nbsp;of&nbsp;byte&nbsp;slice&nbsp;but&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="3091897">//&nbsp;returns&nbsp;16-byte&nbsp;addresses.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3091928">package</span>&nbsp;<span class="ident" id="3091936">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3091941">import</span>&nbsp;<span class="string" id="3091948">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3091958">//&nbsp;IP&nbsp;address&nbsp;lengths&nbsp;(bytes).</span><br>
<span class="lineno"></span><span class="keyword" id="3091989">const</span>&nbsp;<span class="op" id="3091995">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3091998">IPv4len</span>&nbsp;<span class="op" id="3092006">=</span>&nbsp;<span class="num" id="3092008">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092011">IPv6len</span>&nbsp;<span class="op" id="3092019">=</span>&nbsp;<span class="num" id="3092021">16</span><br>
<span class="lineno"></span><span class="op" id="3092024">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3092027">//&nbsp;An&nbsp;IP&nbsp;is&nbsp;a&nbsp;single&nbsp;IP&nbsp;address,&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3092078">//&nbsp;Functions&nbsp;in&nbsp;this&nbsp;package&nbsp;accept&nbsp;either&nbsp;4-byte&nbsp;(IPv4)</span><br>
<span class="lineno">25</span><span class="comment" id="3092135">//&nbsp;or&nbsp;16-byte&nbsp;(IPv6)&nbsp;slices&nbsp;as&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3092173">//</span><br>
<span class="lineno"></span><span class="comment" id="3092176">//&nbsp;Note&nbsp;that&nbsp;in&nbsp;this&nbsp;documentation,&nbsp;referring&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3092228">//&nbsp;IP&nbsp;address&nbsp;as&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="3092280">//&nbsp;is&nbsp;a&nbsp;semantic&nbsp;property&nbsp;of&nbsp;the&nbsp;address,&nbsp;not&nbsp;just&nbsp;the</span><br>
<span class="lineno">30</span><span class="comment" id="3092335">//&nbsp;length&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice:&nbsp;a&nbsp;16-byte&nbsp;slice&nbsp;can&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="3092390">//&nbsp;be&nbsp;an&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3092413">type</span>&nbsp;<span class="ident" id="3092418">IP</span>&nbsp;<span class="op" id="3092421">[</span><span class="op" id="3092422">]</span><span class="builtintype" id="3092423">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3092429">//&nbsp;An&nbsp;IP&nbsp;mask&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">35</span><span class="keyword" id="3092461">type</span>&nbsp;<span class="ident" id="3092466">IPMask</span>&nbsp;<span class="op" id="3092473">[</span><span class="op" id="3092474">]</span><span class="builtintype" id="3092475">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3092481">//&nbsp;An&nbsp;IPNet&nbsp;represents&nbsp;an&nbsp;IP&nbsp;network.</span><br>
<span class="lineno"></span><span class="keyword" id="3092519">type</span>&nbsp;<span class="ident" id="3092524">IPNet</span>&nbsp;<span class="keyword" id="3092530">struct</span>&nbsp;<span class="op" id="3092537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092540">IP</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3092545">IP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3092552">//&nbsp;network&nbsp;number</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092571">Mask</span>&nbsp;<span class="ident" id="3092576">IPMask</span>&nbsp;<span class="comment" id="3092583">//&nbsp;network&nbsp;mask</span><br>
<span class="lineno"></span><span class="op" id="3092599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3092602">//&nbsp;IPv4&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;(in&nbsp;16-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3092658">//&nbsp;IPv4&nbsp;address&nbsp;a.b.c.d.</span><br>
<span class="lineno">45</span><span class="keyword" id="3092683">func</span>&nbsp;<span class="ident" id="3092688">IPv4</span><span class="op" id="3092692">(</span><span class="ident" id="3092693">a</span><span class="op" id="3092694">,</span>&nbsp;<span class="ident" id="3092696">b</span><span class="op" id="3092697">,</span>&nbsp;<span class="ident" id="3092699">c</span><span class="op" id="3092700">,</span>&nbsp;<span class="ident" id="3092702">d</span>&nbsp;<span class="builtintype" id="3092704">byte</span><span class="op" id="3092708">)</span>&nbsp;<span class="ident" id="3092710">IP</span>&nbsp;<span class="op" id="3092713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092716">p</span>&nbsp;<span class="op" id="3092718">:=</span>&nbsp;<span class="builtinfunc" id="3092721">make</span><span class="op" id="3092725">(</span><span class="ident" id="3092726">IP</span><span class="op" id="3092728">,</span>&nbsp;<span class="ident" id="3092730">IPv6len</span><span class="op" id="3092737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3092740">copy</span><span class="op" id="3092744">(</span><span class="ident" id="3092745">p</span><span class="op" id="3092746">,</span>&nbsp;<span class="ident" id="3092748">v4InV6Prefix</span><span class="op" id="3092760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092763">p</span><span class="op" id="3092764">[</span><span class="num" id="3092765">12</span><span class="op" id="3092767">]</span>&nbsp;<span class="op" id="3092769">=</span>&nbsp;<span class="ident" id="3092771">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092774">p</span><span class="op" id="3092775">[</span><span class="num" id="3092776">13</span><span class="op" id="3092778">]</span>&nbsp;<span class="op" id="3092780">=</span>&nbsp;<span class="ident" id="3092782">b</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092785">p</span><span class="op" id="3092786">[</span><span class="num" id="3092787">14</span><span class="op" id="3092789">]</span>&nbsp;<span class="op" id="3092791">=</span>&nbsp;<span class="ident" id="3092793">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3092796">p</span><span class="op" id="3092797">[</span><span class="num" id="3092798">15</span><span class="op" id="3092800">]</span>&nbsp;<span class="op" id="3092802">=</span>&nbsp;<span class="ident" id="3092804">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3092807">return</span>&nbsp;<span class="ident" id="3092814">p</span><br>
<span class="lineno"></span><span class="op" id="3092816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3092819">var</span>&nbsp;<span class="ident" id="3092823">v4InV6Prefix</span>&nbsp;<span class="op" id="3092836">=</span>&nbsp;<span class="op" id="3092838">[</span><span class="op" id="3092839">]</span><span class="builtintype" id="3092840">byte</span><span class="op" id="3092844">{</span><span class="num" id="3092845">0</span><span class="op" id="3092846">,</span>&nbsp;<span class="num" id="3092848">0</span><span class="op" id="3092849">,</span>&nbsp;<span class="num" id="3092851">0</span><span class="op" id="3092852">,</span>&nbsp;<span class="num" id="3092854">0</span><span class="op" id="3092855">,</span>&nbsp;<span class="num" id="3092857">0</span><span class="op" id="3092858">,</span>&nbsp;<span class="num" id="3092860">0</span><span class="op" id="3092861">,</span>&nbsp;<span class="num" id="3092863">0</span><span class="op" id="3092864">,</span>&nbsp;<span class="num" id="3092866">0</span><span class="op" id="3092867">,</span>&nbsp;<span class="num" id="3092869">0</span><span class="op" id="3092870">,</span>&nbsp;<span class="num" id="3092872">0</span><span class="op" id="3092873">,</span>&nbsp;<span class="num" id="3092875">0xff</span><span class="op" id="3092879">,</span>&nbsp;<span class="num" id="3092881">0xff</span><span class="op" id="3092885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3092888">//&nbsp;IPv4Mask&nbsp;returns&nbsp;the&nbsp;IP&nbsp;mask&nbsp;(in&nbsp;4-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3092944">//&nbsp;IPv4&nbsp;mask&nbsp;a.b.c.d.</span><br>
<span class="lineno"></span><span class="keyword" id="3092966">func</span>&nbsp;<span class="ident" id="3092971">IPv4Mask</span><span class="op" id="3092979">(</span><span class="ident" id="3092980">a</span><span class="op" id="3092981">,</span>&nbsp;<span class="ident" id="3092983">b</span><span class="op" id="3092984">,</span>&nbsp;<span class="ident" id="3092986">c</span><span class="op" id="3092987">,</span>&nbsp;<span class="ident" id="3092989">d</span>&nbsp;<span class="builtintype" id="3092991">byte</span><span class="op" id="3092995">)</span>&nbsp;<span class="ident" id="3092997">IPMask</span>&nbsp;<span class="op" id="3093004">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093007">p</span>&nbsp;<span class="op" id="3093009">:=</span>&nbsp;<span class="builtinfunc" id="3093012">make</span><span class="op" id="3093016">(</span><span class="ident" id="3093017">IPMask</span><span class="op" id="3093023">,</span>&nbsp;<span class="ident" id="3093025">IPv4len</span><span class="op" id="3093032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093035">p</span><span class="op" id="3093036">[</span><span class="num" id="3093037">0</span><span class="op" id="3093038">]</span>&nbsp;<span class="op" id="3093040">=</span>&nbsp;<span class="ident" id="3093042">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093045">p</span><span class="op" id="3093046">[</span><span class="num" id="3093047">1</span><span class="op" id="3093048">]</span>&nbsp;<span class="op" id="3093050">=</span>&nbsp;<span class="ident" id="3093052">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093055">p</span><span class="op" id="3093056">[</span><span class="num" id="3093057">2</span><span class="op" id="3093058">]</span>&nbsp;<span class="op" id="3093060">=</span>&nbsp;<span class="ident" id="3093062">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093065">p</span><span class="op" id="3093066">[</span><span class="num" id="3093067">3</span><span class="op" id="3093068">]</span>&nbsp;<span class="op" id="3093070">=</span>&nbsp;<span class="ident" id="3093072">d</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093075">return</span>&nbsp;<span class="ident" id="3093082">p</span><br>
<span class="lineno"></span><span class="op" id="3093084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3093087">//&nbsp;CIDRMask&nbsp;returns&nbsp;an&nbsp;IPMask&nbsp;consisting&nbsp;of&nbsp;`ones&#39;&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="3093145">//&nbsp;followed&nbsp;by&nbsp;0s&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;length&nbsp;of&nbsp;`bits&#39;&nbsp;bits.</span><br>
<span class="lineno">70</span><span class="comment" id="3093200">//&nbsp;For&nbsp;a&nbsp;mask&nbsp;of&nbsp;this&nbsp;form,&nbsp;CIDRMask&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;IPMask.Size.</span><br>
<span class="lineno"></span><span class="keyword" id="3093268">func</span>&nbsp;<span class="ident" id="3093273">CIDRMask</span><span class="op" id="3093281">(</span><span class="ident" id="3093282">ones</span><span class="op" id="3093286">,</span>&nbsp;<span class="ident" id="3093288">bits</span>&nbsp;<span class="builtintype" id="3093293">int</span><span class="op" id="3093296">)</span>&nbsp;<span class="ident" id="3093298">IPMask</span>&nbsp;<span class="op" id="3093305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093308">if</span>&nbsp;<span class="ident" id="3093311">bits</span>&nbsp;<span class="op" id="3093316">!=</span>&nbsp;<span class="num" id="3093319">8</span><span class="op" id="3093320">*</span><span class="ident" id="3093321">IPv4len</span>&nbsp;<span class="op" id="3093329">&amp;&amp;</span>&nbsp;<span class="ident" id="3093332">bits</span>&nbsp;<span class="op" id="3093337">!=</span>&nbsp;<span class="num" id="3093340">8</span><span class="op" id="3093341">*</span><span class="ident" id="3093342">IPv6len</span>&nbsp;<span class="op" id="3093350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093354">return</span>&nbsp;<span class="ident" id="3093361">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093366">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093369">if</span>&nbsp;<span class="ident" id="3093372">ones</span>&nbsp;<span class="op" id="3093377">&lt;</span>&nbsp;<span class="num" id="3093379">0</span>&nbsp;<span class="op" id="3093381">||</span>&nbsp;<span class="ident" id="3093384">ones</span>&nbsp;<span class="op" id="3093389">&gt;</span>&nbsp;<span class="ident" id="3093391">bits</span>&nbsp;<span class="op" id="3093396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093400">return</span>&nbsp;<span class="ident" id="3093407">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093415">l</span>&nbsp;<span class="op" id="3093417">:=</span>&nbsp;<span class="ident" id="3093420">bits</span>&nbsp;<span class="op" id="3093425">/</span>&nbsp;<span class="num" id="3093427">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093430">m</span>&nbsp;<span class="op" id="3093432">:=</span>&nbsp;<span class="builtinfunc" id="3093435">make</span><span class="op" id="3093439">(</span><span class="ident" id="3093440">IPMask</span><span class="op" id="3093446">,</span>&nbsp;<span class="ident" id="3093448">l</span><span class="op" id="3093449">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093452">n</span>&nbsp;<span class="op" id="3093454">:=</span>&nbsp;<span class="builtintype" id="3093457">uint</span><span class="op" id="3093461">(</span><span class="ident" id="3093462">ones</span><span class="op" id="3093466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093469">for</span>&nbsp;<span class="ident" id="3093473">i</span>&nbsp;<span class="op" id="3093475">:=</span>&nbsp;<span class="num" id="3093478">0</span><span class="op" id="3093479">;</span>&nbsp;<span class="ident" id="3093481">i</span>&nbsp;<span class="op" id="3093483">&lt;</span>&nbsp;<span class="ident" id="3093485">l</span><span class="op" id="3093486">;</span>&nbsp;<span class="ident" id="3093488">i</span><span class="op" id="3093489">++</span>&nbsp;<span class="op" id="3093492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093496">if</span>&nbsp;<span class="ident" id="3093499">n</span>&nbsp;<span class="op" id="3093501">&gt;=</span>&nbsp;<span class="num" id="3093504">8</span>&nbsp;<span class="op" id="3093506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093511">m</span><span class="op" id="3093512">[</span><span class="ident" id="3093513">i</span><span class="op" id="3093514">]</span>&nbsp;<span class="op" id="3093516">=</span>&nbsp;<span class="num" id="3093518">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093526">n</span>&nbsp;<span class="op" id="3093528">-=</span>&nbsp;<span class="num" id="3093531">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093536">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093551">m</span><span class="op" id="3093552">[</span><span class="ident" id="3093553">i</span><span class="op" id="3093554">]</span>&nbsp;<span class="op" id="3093556">=</span>&nbsp;<span class="op" id="3093558">^</span><span class="builtintype" id="3093559">byte</span><span class="op" id="3093563">(</span><span class="num" id="3093564">0xff</span>&nbsp;<span class="op" id="3093569">&gt;&gt;</span>&nbsp;<span class="ident" id="3093572">n</span><span class="op" id="3093573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093577">n</span>&nbsp;<span class="op" id="3093579">=</span>&nbsp;<span class="num" id="3093581">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093584">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3093587">return</span>&nbsp;<span class="ident" id="3093594">m</span><br>
<span class="lineno"></span><span class="op" id="3093596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3093599">//&nbsp;Well-known&nbsp;IPv4&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3093628">var</span>&nbsp;<span class="op" id="3093632">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093635">IPv4bcast</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093649">=</span>&nbsp;<span class="ident" id="3093651">IPv4</span><span class="op" id="3093655">(</span><span class="num" id="3093656">255</span><span class="op" id="3093659">,</span>&nbsp;<span class="num" id="3093661">255</span><span class="op" id="3093664">,</span>&nbsp;<span class="num" id="3093666">255</span><span class="op" id="3093669">,</span>&nbsp;<span class="num" id="3093671">255</span><span class="op" id="3093674">)</span>&nbsp;<span class="comment" id="3093676">//&nbsp;broadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093690">IPv4allsys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093704">=</span>&nbsp;<span class="ident" id="3093706">IPv4</span><span class="op" id="3093710">(</span><span class="num" id="3093711">224</span><span class="op" id="3093714">,</span>&nbsp;<span class="num" id="3093716">0</span><span class="op" id="3093717">,</span>&nbsp;<span class="num" id="3093719">0</span><span class="op" id="3093720">,</span>&nbsp;<span class="num" id="3093722">1</span><span class="op" id="3093723">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093731">//&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093747">IPv4allrouter</span>&nbsp;<span class="op" id="3093761">=</span>&nbsp;<span class="ident" id="3093763">IPv4</span><span class="op" id="3093767">(</span><span class="num" id="3093768">224</span><span class="op" id="3093771">,</span>&nbsp;<span class="num" id="3093773">0</span><span class="op" id="3093774">,</span>&nbsp;<span class="num" id="3093776">0</span><span class="op" id="3093777">,</span>&nbsp;<span class="num" id="3093779">2</span><span class="op" id="3093780">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093788">//&nbsp;all&nbsp;routers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093804">IPv4zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093818">=</span>&nbsp;<span class="ident" id="3093820">IPv4</span><span class="op" id="3093824">(</span><span class="num" id="3093825">0</span><span class="op" id="3093826">,</span>&nbsp;<span class="num" id="3093828">0</span><span class="op" id="3093829">,</span>&nbsp;<span class="num" id="3093831">0</span><span class="op" id="3093832">,</span>&nbsp;<span class="num" id="3093834">0</span><span class="op" id="3093835">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3093845">//&nbsp;all&nbsp;zeros</span><br>
<span class="lineno"></span><span class="op" id="3093858">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3093861">//&nbsp;Well-known&nbsp;IPv6&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3093890">var</span>&nbsp;<span class="op" id="3093894">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093897">IPv6zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3093924">=</span>&nbsp;<span class="ident" id="3093926">IP</span><span class="op" id="3093928">{</span><span class="num" id="3093929">0</span><span class="op" id="3093930">,</span>&nbsp;<span class="num" id="3093932">0</span><span class="op" id="3093933">,</span>&nbsp;<span class="num" id="3093935">0</span><span class="op" id="3093936">,</span>&nbsp;<span class="num" id="3093938">0</span><span class="op" id="3093939">,</span>&nbsp;<span class="num" id="3093941">0</span><span class="op" id="3093942">,</span>&nbsp;<span class="num" id="3093944">0</span><span class="op" id="3093945">,</span>&nbsp;<span class="num" id="3093947">0</span><span class="op" id="3093948">,</span>&nbsp;<span class="num" id="3093950">0</span><span class="op" id="3093951">,</span>&nbsp;<span class="num" id="3093953">0</span><span class="op" id="3093954">,</span>&nbsp;<span class="num" id="3093956">0</span><span class="op" id="3093957">,</span>&nbsp;<span class="num" id="3093959">0</span><span class="op" id="3093960">,</span>&nbsp;<span class="num" id="3093962">0</span><span class="op" id="3093963">,</span>&nbsp;<span class="num" id="3093965">0</span><span class="op" id="3093966">,</span>&nbsp;<span class="num" id="3093968">0</span><span class="op" id="3093969">,</span>&nbsp;<span class="num" id="3093971">0</span><span class="op" id="3093972">,</span>&nbsp;<span class="num" id="3093974">0</span><span class="op" id="3093975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3093978">IPv6unspecified</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094005">=</span>&nbsp;<span class="ident" id="3094007">IP</span><span class="op" id="3094009">{</span><span class="num" id="3094010">0</span><span class="op" id="3094011">,</span>&nbsp;<span class="num" id="3094013">0</span><span class="op" id="3094014">,</span>&nbsp;<span class="num" id="3094016">0</span><span class="op" id="3094017">,</span>&nbsp;<span class="num" id="3094019">0</span><span class="op" id="3094020">,</span>&nbsp;<span class="num" id="3094022">0</span><span class="op" id="3094023">,</span>&nbsp;<span class="num" id="3094025">0</span><span class="op" id="3094026">,</span>&nbsp;<span class="num" id="3094028">0</span><span class="op" id="3094029">,</span>&nbsp;<span class="num" id="3094031">0</span><span class="op" id="3094032">,</span>&nbsp;<span class="num" id="3094034">0</span><span class="op" id="3094035">,</span>&nbsp;<span class="num" id="3094037">0</span><span class="op" id="3094038">,</span>&nbsp;<span class="num" id="3094040">0</span><span class="op" id="3094041">,</span>&nbsp;<span class="num" id="3094043">0</span><span class="op" id="3094044">,</span>&nbsp;<span class="num" id="3094046">0</span><span class="op" id="3094047">,</span>&nbsp;<span class="num" id="3094049">0</span><span class="op" id="3094050">,</span>&nbsp;<span class="num" id="3094052">0</span><span class="op" id="3094053">,</span>&nbsp;<span class="num" id="3094055">0</span><span class="op" id="3094056">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094059">IPv6loopback</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094086">=</span>&nbsp;<span class="ident" id="3094088">IP</span><span class="op" id="3094090">{</span><span class="num" id="3094091">0</span><span class="op" id="3094092">,</span>&nbsp;<span class="num" id="3094094">0</span><span class="op" id="3094095">,</span>&nbsp;<span class="num" id="3094097">0</span><span class="op" id="3094098">,</span>&nbsp;<span class="num" id="3094100">0</span><span class="op" id="3094101">,</span>&nbsp;<span class="num" id="3094103">0</span><span class="op" id="3094104">,</span>&nbsp;<span class="num" id="3094106">0</span><span class="op" id="3094107">,</span>&nbsp;<span class="num" id="3094109">0</span><span class="op" id="3094110">,</span>&nbsp;<span class="num" id="3094112">0</span><span class="op" id="3094113">,</span>&nbsp;<span class="num" id="3094115">0</span><span class="op" id="3094116">,</span>&nbsp;<span class="num" id="3094118">0</span><span class="op" id="3094119">,</span>&nbsp;<span class="num" id="3094121">0</span><span class="op" id="3094122">,</span>&nbsp;<span class="num" id="3094124">0</span><span class="op" id="3094125">,</span>&nbsp;<span class="num" id="3094127">0</span><span class="op" id="3094128">,</span>&nbsp;<span class="num" id="3094130">0</span><span class="op" id="3094131">,</span>&nbsp;<span class="num" id="3094133">0</span><span class="op" id="3094134">,</span>&nbsp;<span class="num" id="3094136">1</span><span class="op" id="3094137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094140">IPv6interfacelocalallnodes</span>&nbsp;<span class="op" id="3094167">=</span>&nbsp;<span class="ident" id="3094169">IP</span><span class="op" id="3094171">{</span><span class="num" id="3094172">0xff</span><span class="op" id="3094176">,</span>&nbsp;<span class="num" id="3094178">0x01</span><span class="op" id="3094182">,</span>&nbsp;<span class="num" id="3094184">0</span><span class="op" id="3094185">,</span>&nbsp;<span class="num" id="3094187">0</span><span class="op" id="3094188">,</span>&nbsp;<span class="num" id="3094190">0</span><span class="op" id="3094191">,</span>&nbsp;<span class="num" id="3094193">0</span><span class="op" id="3094194">,</span>&nbsp;<span class="num" id="3094196">0</span><span class="op" id="3094197">,</span>&nbsp;<span class="num" id="3094199">0</span><span class="op" id="3094200">,</span>&nbsp;<span class="num" id="3094202">0</span><span class="op" id="3094203">,</span>&nbsp;<span class="num" id="3094205">0</span><span class="op" id="3094206">,</span>&nbsp;<span class="num" id="3094208">0</span><span class="op" id="3094209">,</span>&nbsp;<span class="num" id="3094211">0</span><span class="op" id="3094212">,</span>&nbsp;<span class="num" id="3094214">0</span><span class="op" id="3094215">,</span>&nbsp;<span class="num" id="3094217">0</span><span class="op" id="3094218">,</span>&nbsp;<span class="num" id="3094220">0</span><span class="op" id="3094221">,</span>&nbsp;<span class="num" id="3094223">0x01</span><span class="op" id="3094227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094230">IPv6linklocalallnodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094257">=</span>&nbsp;<span class="ident" id="3094259">IP</span><span class="op" id="3094261">{</span><span class="num" id="3094262">0xff</span><span class="op" id="3094266">,</span>&nbsp;<span class="num" id="3094268">0x02</span><span class="op" id="3094272">,</span>&nbsp;<span class="num" id="3094274">0</span><span class="op" id="3094275">,</span>&nbsp;<span class="num" id="3094277">0</span><span class="op" id="3094278">,</span>&nbsp;<span class="num" id="3094280">0</span><span class="op" id="3094281">,</span>&nbsp;<span class="num" id="3094283">0</span><span class="op" id="3094284">,</span>&nbsp;<span class="num" id="3094286">0</span><span class="op" id="3094287">,</span>&nbsp;<span class="num" id="3094289">0</span><span class="op" id="3094290">,</span>&nbsp;<span class="num" id="3094292">0</span><span class="op" id="3094293">,</span>&nbsp;<span class="num" id="3094295">0</span><span class="op" id="3094296">,</span>&nbsp;<span class="num" id="3094298">0</span><span class="op" id="3094299">,</span>&nbsp;<span class="num" id="3094301">0</span><span class="op" id="3094302">,</span>&nbsp;<span class="num" id="3094304">0</span><span class="op" id="3094305">,</span>&nbsp;<span class="num" id="3094307">0</span><span class="op" id="3094308">,</span>&nbsp;<span class="num" id="3094310">0</span><span class="op" id="3094311">,</span>&nbsp;<span class="num" id="3094313">0x01</span><span class="op" id="3094317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3094320">IPv6linklocalallrouters</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094347">=</span>&nbsp;<span class="ident" id="3094349">IP</span><span class="op" id="3094351">{</span><span class="num" id="3094352">0xff</span><span class="op" id="3094356">,</span>&nbsp;<span class="num" id="3094358">0x02</span><span class="op" id="3094362">,</span>&nbsp;<span class="num" id="3094364">0</span><span class="op" id="3094365">,</span>&nbsp;<span class="num" id="3094367">0</span><span class="op" id="3094368">,</span>&nbsp;<span class="num" id="3094370">0</span><span class="op" id="3094371">,</span>&nbsp;<span class="num" id="3094373">0</span><span class="op" id="3094374">,</span>&nbsp;<span class="num" id="3094376">0</span><span class="op" id="3094377">,</span>&nbsp;<span class="num" id="3094379">0</span><span class="op" id="3094380">,</span>&nbsp;<span class="num" id="3094382">0</span><span class="op" id="3094383">,</span>&nbsp;<span class="num" id="3094385">0</span><span class="op" id="3094386">,</span>&nbsp;<span class="num" id="3094388">0</span><span class="op" id="3094389">,</span>&nbsp;<span class="num" id="3094391">0</span><span class="op" id="3094392">,</span>&nbsp;<span class="num" id="3094394">0</span><span class="op" id="3094395">,</span>&nbsp;<span class="num" id="3094397">0</span><span class="op" id="3094398">,</span>&nbsp;<span class="num" id="3094400">0</span><span class="op" id="3094401">,</span>&nbsp;<span class="num" id="3094403">0x02</span><span class="op" id="3094407">}</span><br>
<span class="lineno"></span><span class="op" id="3094409">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="3094412">//&nbsp;IsUnspecified&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;an&nbsp;unspecified&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3094475">func</span>&nbsp;<span class="op" id="3094480">(</span><span class="ident" id="3094481">ip</span>&nbsp;<span class="ident" id="3094484">IP</span><span class="op" id="3094486">)</span>&nbsp;<span class="ident" id="3094488">IsUnspecified</span><span class="op" id="3094501">(</span><span class="op" id="3094502">)</span>&nbsp;<span class="builtintype" id="3094504">bool</span>&nbsp;<span class="op" id="3094509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094512">if</span>&nbsp;<span class="ident" id="3094515">ip</span><span class="op" id="3094517">.</span><span class="ident" id="3094518">Equal</span><span class="op" id="3094523">(</span><span class="ident" id="3094524">IPv4zero</span><span class="op" id="3094532">)</span>&nbsp;<span class="op" id="3094534">||</span>&nbsp;<span class="ident" id="3094537">ip</span><span class="op" id="3094539">.</span><span class="ident" id="3094540">Equal</span><span class="op" id="3094545">(</span><span class="ident" id="3094546">IPv6unspecified</span><span class="op" id="3094561">)</span>&nbsp;<span class="op" id="3094563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094567">return</span>&nbsp;<span class="builtintype" id="3094574">true</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094583">return</span>&nbsp;<span class="builtintype" id="3094590">false</span><br>
<span class="lineno"></span><span class="op" id="3094596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3094599">//&nbsp;IsLoopback&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;loopback&nbsp;address.</span><br>
<span class="lineno">120</span><span class="keyword" id="3094655">func</span>&nbsp;<span class="op" id="3094660">(</span><span class="ident" id="3094661">ip</span>&nbsp;<span class="ident" id="3094664">IP</span><span class="op" id="3094666">)</span>&nbsp;<span class="ident" id="3094668">IsLoopback</span><span class="op" id="3094678">(</span><span class="op" id="3094679">)</span>&nbsp;<span class="builtintype" id="3094681">bool</span>&nbsp;<span class="op" id="3094686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094689">if</span>&nbsp;<span class="ident" id="3094692">ip4</span>&nbsp;<span class="op" id="3094696">:=</span>&nbsp;<span class="ident" id="3094699">ip</span><span class="op" id="3094701">.</span><span class="ident" id="3094702">To4</span><span class="op" id="3094705">(</span><span class="op" id="3094706">)</span><span class="op" id="3094707">;</span>&nbsp;<span class="ident" id="3094709">ip4</span>&nbsp;<span class="op" id="3094713">!=</span>&nbsp;<span class="ident" id="3094716">nil</span>&nbsp;<span class="op" id="3094720">&amp;&amp;</span>&nbsp;<span class="ident" id="3094723">ip4</span><span class="op" id="3094726">[</span><span class="num" id="3094727">0</span><span class="op" id="3094728">]</span>&nbsp;<span class="op" id="3094730">==</span>&nbsp;<span class="num" id="3094733">127</span>&nbsp;<span class="op" id="3094737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094741">return</span>&nbsp;<span class="builtintype" id="3094748">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094757">return</span>&nbsp;<span class="ident" id="3094764">ip</span><span class="op" id="3094766">.</span><span class="ident" id="3094767">Equal</span><span class="op" id="3094772">(</span><span class="ident" id="3094773">IPv6loopback</span><span class="op" id="3094785">)</span><br>
<span class="lineno">125</span><span class="op" id="3094787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3094790">//&nbsp;IsMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3094848">func</span>&nbsp;<span class="op" id="3094853">(</span><span class="ident" id="3094854">ip</span>&nbsp;<span class="ident" id="3094857">IP</span><span class="op" id="3094859">)</span>&nbsp;<span class="ident" id="3094861">IsMulticast</span><span class="op" id="3094872">(</span><span class="op" id="3094873">)</span>&nbsp;<span class="builtintype" id="3094875">bool</span>&nbsp;<span class="op" id="3094880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094883">if</span>&nbsp;<span class="ident" id="3094886">ip4</span>&nbsp;<span class="op" id="3094890">:=</span>&nbsp;<span class="ident" id="3094893">ip</span><span class="op" id="3094895">.</span><span class="ident" id="3094896">To4</span><span class="op" id="3094899">(</span><span class="op" id="3094900">)</span><span class="op" id="3094901">;</span>&nbsp;<span class="ident" id="3094903">ip4</span>&nbsp;<span class="op" id="3094907">!=</span>&nbsp;<span class="ident" id="3094910">nil</span>&nbsp;<span class="op" id="3094914">&amp;&amp;</span>&nbsp;<span class="ident" id="3094917">ip4</span><span class="op" id="3094920">[</span><span class="num" id="3094921">0</span><span class="op" id="3094922">]</span><span class="op" id="3094923">&amp;</span><span class="num" id="3094924">0xf0</span>&nbsp;<span class="op" id="3094929">==</span>&nbsp;<span class="num" id="3094932">0xe0</span>&nbsp;<span class="op" id="3094937">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094941">return</span>&nbsp;<span class="builtintype" id="3094948">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3094954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3094957">return</span>&nbsp;<span class="ident" id="3094964">ip</span><span class="op" id="3094966">[</span><span class="num" id="3094967">0</span><span class="op" id="3094968">]</span>&nbsp;<span class="op" id="3094970">==</span>&nbsp;<span class="num" id="3094973">0xff</span><br>
<span class="lineno"></span><span class="op" id="3094978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3094981">//&nbsp;IsInterfaceLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3095036">//&nbsp;an&nbsp;interface-local&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3095077">func</span>&nbsp;<span class="op" id="3095082">(</span><span class="ident" id="3095083">ip</span>&nbsp;<span class="ident" id="3095086">IP</span><span class="op" id="3095088">)</span>&nbsp;<span class="ident" id="3095090">IsInterfaceLocalMulticast</span><span class="op" id="3095115">(</span><span class="op" id="3095116">)</span>&nbsp;<span class="builtintype" id="3095118">bool</span>&nbsp;<span class="op" id="3095123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095126">return</span>&nbsp;<span class="builtinfunc" id="3095133">len</span><span class="op" id="3095136">(</span><span class="ident" id="3095137">ip</span><span class="op" id="3095139">)</span>&nbsp;<span class="op" id="3095141">==</span>&nbsp;<span class="ident" id="3095144">IPv6len</span>&nbsp;<span class="op" id="3095152">&amp;&amp;</span>&nbsp;<span class="ident" id="3095155">ip</span><span class="op" id="3095157">[</span><span class="num" id="3095158">0</span><span class="op" id="3095159">]</span>&nbsp;<span class="op" id="3095161">==</span>&nbsp;<span class="num" id="3095164">0xff</span>&nbsp;<span class="op" id="3095169">&amp;&amp;</span>&nbsp;<span class="ident" id="3095172">ip</span><span class="op" id="3095174">[</span><span class="num" id="3095175">1</span><span class="op" id="3095176">]</span><span class="op" id="3095177">&amp;</span><span class="num" id="3095178">0x0f</span>&nbsp;<span class="op" id="3095183">==</span>&nbsp;<span class="num" id="3095186">0x01</span><br>
<span class="lineno"></span><span class="op" id="3095191">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="3095194">//&nbsp;IsLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3095253">//&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3095275">func</span>&nbsp;<span class="op" id="3095280">(</span><span class="ident" id="3095281">ip</span>&nbsp;<span class="ident" id="3095284">IP</span><span class="op" id="3095286">)</span>&nbsp;<span class="ident" id="3095288">IsLinkLocalMulticast</span><span class="op" id="3095308">(</span><span class="op" id="3095309">)</span>&nbsp;<span class="builtintype" id="3095311">bool</span>&nbsp;<span class="op" id="3095316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095319">if</span>&nbsp;<span class="ident" id="3095322">ip4</span>&nbsp;<span class="op" id="3095326">:=</span>&nbsp;<span class="ident" id="3095329">ip</span><span class="op" id="3095331">.</span><span class="ident" id="3095332">To4</span><span class="op" id="3095335">(</span><span class="op" id="3095336">)</span><span class="op" id="3095337">;</span>&nbsp;<span class="ident" id="3095339">ip4</span>&nbsp;<span class="op" id="3095343">!=</span>&nbsp;<span class="ident" id="3095346">nil</span>&nbsp;<span class="op" id="3095350">&amp;&amp;</span>&nbsp;<span class="ident" id="3095353">ip4</span><span class="op" id="3095356">[</span><span class="num" id="3095357">0</span><span class="op" id="3095358">]</span>&nbsp;<span class="op" id="3095360">==</span>&nbsp;<span class="num" id="3095363">224</span>&nbsp;<span class="op" id="3095367">&amp;&amp;</span>&nbsp;<span class="ident" id="3095370">ip4</span><span class="op" id="3095373">[</span><span class="num" id="3095374">1</span><span class="op" id="3095375">]</span>&nbsp;<span class="op" id="3095377">==</span>&nbsp;<span class="num" id="3095380">0</span>&nbsp;<span class="op" id="3095382">&amp;&amp;</span>&nbsp;<span class="ident" id="3095385">ip4</span><span class="op" id="3095388">[</span><span class="num" id="3095389">2</span><span class="op" id="3095390">]</span>&nbsp;<span class="op" id="3095392">==</span>&nbsp;<span class="num" id="3095395">0</span>&nbsp;<span class="op" id="3095397">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095401">return</span>&nbsp;<span class="builtintype" id="3095408">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095417">return</span>&nbsp;<span class="ident" id="3095424">ip</span><span class="op" id="3095426">[</span><span class="num" id="3095427">0</span><span class="op" id="3095428">]</span>&nbsp;<span class="op" id="3095430">==</span>&nbsp;<span class="num" id="3095433">0xff</span>&nbsp;<span class="op" id="3095438">&amp;&amp;</span>&nbsp;<span class="ident" id="3095441">ip</span><span class="op" id="3095443">[</span><span class="num" id="3095444">1</span><span class="op" id="3095445">]</span><span class="op" id="3095446">&amp;</span><span class="num" id="3095447">0x0f</span>&nbsp;<span class="op" id="3095452">==</span>&nbsp;<span class="num" id="3095455">0x02</span><br>
<span class="lineno"></span><span class="op" id="3095460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="3095463">//&nbsp;IsLinkLocalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3095520">//&nbsp;unicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3095540">func</span>&nbsp;<span class="op" id="3095545">(</span><span class="ident" id="3095546">ip</span>&nbsp;<span class="ident" id="3095549">IP</span><span class="op" id="3095551">)</span>&nbsp;<span class="ident" id="3095553">IsLinkLocalUnicast</span><span class="op" id="3095571">(</span><span class="op" id="3095572">)</span>&nbsp;<span class="builtintype" id="3095574">bool</span>&nbsp;<span class="op" id="3095579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095582">if</span>&nbsp;<span class="ident" id="3095585">ip4</span>&nbsp;<span class="op" id="3095589">:=</span>&nbsp;<span class="ident" id="3095592">ip</span><span class="op" id="3095594">.</span><span class="ident" id="3095595">To4</span><span class="op" id="3095598">(</span><span class="op" id="3095599">)</span><span class="op" id="3095600">;</span>&nbsp;<span class="ident" id="3095602">ip4</span>&nbsp;<span class="op" id="3095606">!=</span>&nbsp;<span class="ident" id="3095609">nil</span>&nbsp;<span class="op" id="3095613">&amp;&amp;</span>&nbsp;<span class="ident" id="3095616">ip4</span><span class="op" id="3095619">[</span><span class="num" id="3095620">0</span><span class="op" id="3095621">]</span>&nbsp;<span class="op" id="3095623">==</span>&nbsp;<span class="num" id="3095626">169</span>&nbsp;<span class="op" id="3095630">&amp;&amp;</span>&nbsp;<span class="ident" id="3095633">ip4</span><span class="op" id="3095636">[</span><span class="num" id="3095637">1</span><span class="op" id="3095638">]</span>&nbsp;<span class="op" id="3095640">==</span>&nbsp;<span class="num" id="3095643">254</span>&nbsp;<span class="op" id="3095647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095651">return</span>&nbsp;<span class="builtintype" id="3095658">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095667">return</span>&nbsp;<span class="ident" id="3095674">ip</span><span class="op" id="3095676">[</span><span class="num" id="3095677">0</span><span class="op" id="3095678">]</span>&nbsp;<span class="op" id="3095680">==</span>&nbsp;<span class="num" id="3095683">0xfe</span>&nbsp;<span class="op" id="3095688">&amp;&amp;</span>&nbsp;<span class="ident" id="3095691">ip</span><span class="op" id="3095693">[</span><span class="num" id="3095694">1</span><span class="op" id="3095695">]</span><span class="op" id="3095696">&amp;</span><span class="num" id="3095697">0xc0</span>&nbsp;<span class="op" id="3095702">==</span>&nbsp;<span class="num" id="3095705">0x80</span><br>
<span class="lineno"></span><span class="op" id="3095710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3095713">//&nbsp;IsGlobalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;global&nbsp;unicast</span><br>
<span class="lineno">160</span><span class="comment" id="3095771">//&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3095783">func</span>&nbsp;<span class="op" id="3095788">(</span><span class="ident" id="3095789">ip</span>&nbsp;<span class="ident" id="3095792">IP</span><span class="op" id="3095794">)</span>&nbsp;<span class="ident" id="3095796">IsGlobalUnicast</span><span class="op" id="3095811">(</span><span class="op" id="3095812">)</span>&nbsp;<span class="builtintype" id="3095814">bool</span>&nbsp;<span class="op" id="3095819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095822">return</span>&nbsp;<span class="op" id="3095829">!</span><span class="ident" id="3095830">ip</span><span class="op" id="3095832">.</span><span class="ident" id="3095833">IsUnspecified</span><span class="op" id="3095846">(</span><span class="op" id="3095847">)</span>&nbsp;<span class="op" id="3095849">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095854">!</span><span class="ident" id="3095855">ip</span><span class="op" id="3095857">.</span><span class="ident" id="3095858">IsLoopback</span><span class="op" id="3095868">(</span><span class="op" id="3095869">)</span>&nbsp;<span class="op" id="3095871">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095876">!</span><span class="ident" id="3095877">ip</span><span class="op" id="3095879">.</span><span class="ident" id="3095880">IsMulticast</span><span class="op" id="3095891">(</span><span class="op" id="3095892">)</span>&nbsp;<span class="op" id="3095894">&amp;&amp;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3095899">!</span><span class="ident" id="3095900">ip</span><span class="op" id="3095902">.</span><span class="ident" id="3095903">IsLinkLocalUnicast</span><span class="op" id="3095921">(</span><span class="op" id="3095922">)</span><br>
<span class="lineno"></span><span class="op" id="3095924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3095927">//&nbsp;Is&nbsp;p&nbsp;all&nbsp;zeros?</span><br>
<span class="lineno"></span><span class="keyword" id="3095946">func</span>&nbsp;<span class="ident" id="3095951">isZeros</span><span class="op" id="3095958">(</span><span class="ident" id="3095959">p</span>&nbsp;<span class="ident" id="3095961">IP</span><span class="op" id="3095963">)</span>&nbsp;<span class="builtintype" id="3095965">bool</span>&nbsp;<span class="op" id="3095970">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3095973">for</span>&nbsp;<span class="ident" id="3095977">i</span>&nbsp;<span class="op" id="3095979">:=</span>&nbsp;<span class="num" id="3095982">0</span><span class="op" id="3095983">;</span>&nbsp;<span class="ident" id="3095985">i</span>&nbsp;<span class="op" id="3095987">&lt;</span>&nbsp;<span class="builtinfunc" id="3095989">len</span><span class="op" id="3095992">(</span><span class="ident" id="3095993">p</span><span class="op" id="3095994">)</span><span class="op" id="3095995">;</span>&nbsp;<span class="ident" id="3095997">i</span><span class="op" id="3095998">++</span>&nbsp;<span class="op" id="3096001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096005">if</span>&nbsp;<span class="ident" id="3096008">p</span><span class="op" id="3096009">[</span><span class="ident" id="3096010">i</span><span class="op" id="3096011">]</span>&nbsp;<span class="op" id="3096013">!=</span>&nbsp;<span class="num" id="3096016">0</span>&nbsp;<span class="op" id="3096018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096023">return</span>&nbsp;<span class="builtintype" id="3096030">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3096038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3096041">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096044">return</span>&nbsp;<span class="builtintype" id="3096051">true</span><br>
<span class="lineno"></span><span class="op" id="3096056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3096059">//&nbsp;To4&nbsp;converts&nbsp;the&nbsp;IPv4&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;4-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3096123">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;To4&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">180</span><span class="keyword" id="3096173">func</span>&nbsp;<span class="op" id="3096178">(</span><span class="ident" id="3096179">ip</span>&nbsp;<span class="ident" id="3096182">IP</span><span class="op" id="3096184">)</span>&nbsp;<span class="ident" id="3096186">To4</span><span class="op" id="3096189">(</span><span class="op" id="3096190">)</span>&nbsp;<span class="ident" id="3096192">IP</span>&nbsp;<span class="op" id="3096195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096198">if</span>&nbsp;<span class="builtinfunc" id="3096201">len</span><span class="op" id="3096204">(</span><span class="ident" id="3096205">ip</span><span class="op" id="3096207">)</span>&nbsp;<span class="op" id="3096209">==</span>&nbsp;<span class="ident" id="3096212">IPv4len</span>&nbsp;<span class="op" id="3096220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096224">return</span>&nbsp;<span class="ident" id="3096231">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3096235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096238">if</span>&nbsp;<span class="builtinfunc" id="3096241">len</span><span class="op" id="3096244">(</span><span class="ident" id="3096245">ip</span><span class="op" id="3096247">)</span>&nbsp;<span class="op" id="3096249">==</span>&nbsp;<span class="ident" id="3096252">IPv6len</span>&nbsp;<span class="op" id="3096260">&amp;&amp;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096265">isZeros</span><span class="op" id="3096272">(</span><span class="ident" id="3096273">ip</span><span class="op" id="3096275">[</span><span class="num" id="3096276">0</span><span class="op" id="3096277">:</span><span class="num" id="3096278">10</span><span class="op" id="3096280">]</span><span class="op" id="3096281">)</span>&nbsp;<span class="op" id="3096283">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096288">ip</span><span class="op" id="3096290">[</span><span class="num" id="3096291">10</span><span class="op" id="3096293">]</span>&nbsp;<span class="op" id="3096295">==</span>&nbsp;<span class="num" id="3096298">0xff</span>&nbsp;<span class="op" id="3096303">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096308">ip</span><span class="op" id="3096310">[</span><span class="num" id="3096311">11</span><span class="op" id="3096313">]</span>&nbsp;<span class="op" id="3096315">==</span>&nbsp;<span class="num" id="3096318">0xff</span>&nbsp;<span class="op" id="3096323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096327">return</span>&nbsp;<span class="ident" id="3096334">ip</span><span class="op" id="3096336">[</span><span class="num" id="3096337">12</span><span class="op" id="3096339">:</span><span class="num" id="3096340">16</span><span class="op" id="3096342">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3096345">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096348">return</span>&nbsp;<span class="ident" id="3096355">nil</span><br>
<span class="lineno"></span><span class="op" id="3096359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3096362">//&nbsp;To16&nbsp;converts&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;16-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3096426">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IP&nbsp;address&nbsp;(it&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length),&nbsp;To16&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">195</span><span class="keyword" id="3096500">func</span>&nbsp;<span class="op" id="3096505">(</span><span class="ident" id="3096506">ip</span>&nbsp;<span class="ident" id="3096509">IP</span><span class="op" id="3096511">)</span>&nbsp;<span class="ident" id="3096513">To16</span><span class="op" id="3096517">(</span><span class="op" id="3096518">)</span>&nbsp;<span class="ident" id="3096520">IP</span>&nbsp;<span class="op" id="3096523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096526">if</span>&nbsp;<span class="builtinfunc" id="3096529">len</span><span class="op" id="3096532">(</span><span class="ident" id="3096533">ip</span><span class="op" id="3096535">)</span>&nbsp;<span class="op" id="3096537">==</span>&nbsp;<span class="ident" id="3096540">IPv4len</span>&nbsp;<span class="op" id="3096548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096552">return</span>&nbsp;<span class="ident" id="3096559">IPv4</span><span class="op" id="3096563">(</span><span class="ident" id="3096564">ip</span><span class="op" id="3096566">[</span><span class="num" id="3096567">0</span><span class="op" id="3096568">]</span><span class="op" id="3096569">,</span>&nbsp;<span class="ident" id="3096571">ip</span><span class="op" id="3096573">[</span><span class="num" id="3096574">1</span><span class="op" id="3096575">]</span><span class="op" id="3096576">,</span>&nbsp;<span class="ident" id="3096578">ip</span><span class="op" id="3096580">[</span><span class="num" id="3096581">2</span><span class="op" id="3096582">]</span><span class="op" id="3096583">,</span>&nbsp;<span class="ident" id="3096585">ip</span><span class="op" id="3096587">[</span><span class="num" id="3096588">3</span><span class="op" id="3096589">]</span><span class="op" id="3096590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3096593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096596">if</span>&nbsp;<span class="builtinfunc" id="3096599">len</span><span class="op" id="3096602">(</span><span class="ident" id="3096603">ip</span><span class="op" id="3096605">)</span>&nbsp;<span class="op" id="3096607">==</span>&nbsp;<span class="ident" id="3096610">IPv6len</span>&nbsp;<span class="op" id="3096618">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096622">return</span>&nbsp;<span class="ident" id="3096629">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3096633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3096636">return</span>&nbsp;<span class="ident" id="3096643">nil</span><br>
<span class="lineno"></span><span class="op" id="3096647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="3096650">//&nbsp;Default&nbsp;route&nbsp;masks&nbsp;for&nbsp;IPv4.</span><br>
<span class="lineno"></span><span class="keyword" id="3096683">var</span>&nbsp;<span class="op" id="3096687">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096690">classAMask</span>&nbsp;<span class="op" id="3096701">=</span>&nbsp;<span class="ident" id="3096703">IPv4Mask</span><span class="op" id="3096711">(</span><span class="num" id="3096712">0xff</span><span class="op" id="3096716">,</span>&nbsp;<span class="num" id="3096718">0</span><span class="op" id="3096719">,</span>&nbsp;<span class="num" id="3096721">0</span><span class="op" id="3096722">,</span>&nbsp;<span class="num" id="3096724">0</span><span class="op" id="3096725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096728">classBMask</span>&nbsp;<span class="op" id="3096739">=</span>&nbsp;<span class="ident" id="3096741">IPv4Mask</span><span class="op" id="3096749">(</span><span class="num" id="3096750">0xff</span><span class="op" id="3096754">,</span>&nbsp;<span class="num" id="3096756">0xff</span><span class="op" id="3096760">,</span>&nbsp;<span class="num" id="3096762">0</span><span class="op" id="3096763">,</span>&nbsp;<span class="num" id="3096765">0</span><span class="op" id="3096766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3096769">classCMask</span>&nbsp;<span class="op" id="3096780">=</span>&nbsp;<span class="ident" id="3096782">IPv4Mask</span><span class="op" id="3096790">(</span><span class="num" id="3096791">0xff</span><span class="op" id="3096795">,</span>&nbsp;<span class="num" id="3096797">0xff</span><span class="op" id="3096801">,</span>&nbsp;<span class="num" id="3096803">0xff</span><span class="op" id="3096807">,</span>&nbsp;<span class="num" id="3096809">0</span><span class="op" id="3096810">)</span><br>
<span class="lineno">210</span><span class="op" id="3096812">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3096815">//&nbsp;DefaultMask&nbsp;returns&nbsp;the&nbsp;default&nbsp;IP&nbsp;mask&nbsp;for&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3096881">//&nbsp;Only&nbsp;IPv4&nbsp;addresses&nbsp;have&nbsp;default&nbsp;masks;&nbsp;DefaultMask&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3096944">//&nbsp;nil&nbsp;if&nbsp;ip&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno">215</span><span class="keyword" id="3096986">func</span>&nbsp;<span class="op" id="3096991">(</span><span class="ident" id="3096992">ip</span>&nbsp;<span class="ident" id="3096995">IP</span><span class="op" id="3096997">)</span>&nbsp;<span class="ident" id="3096999">DefaultMask</span><span class="op" id="3097010">(</span><span class="op" id="3097011">)</span>&nbsp;<span class="ident" id="3097013">IPMask</span>&nbsp;<span class="op" id="3097020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097023">if</span>&nbsp;<span class="ident" id="3097026">ip</span>&nbsp;<span class="op" id="3097029">=</span>&nbsp;<span class="ident" id="3097031">ip</span><span class="op" id="3097033">.</span><span class="ident" id="3097034">To4</span><span class="op" id="3097037">(</span><span class="op" id="3097038">)</span><span class="op" id="3097039">;</span>&nbsp;<span class="ident" id="3097041">ip</span>&nbsp;<span class="op" id="3097044">==</span>&nbsp;<span class="ident" id="3097047">nil</span>&nbsp;<span class="op" id="3097051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097055">return</span>&nbsp;<span class="ident" id="3097062">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097070">switch</span>&nbsp;<span class="builtintype" id="3097077">true</span>&nbsp;<span class="op" id="3097082">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097085">case</span>&nbsp;<span class="ident" id="3097090">ip</span><span class="op" id="3097092">[</span><span class="num" id="3097093">0</span><span class="op" id="3097094">]</span>&nbsp;<span class="op" id="3097096">&lt;</span>&nbsp;<span class="num" id="3097098">0x80</span><span class="op" id="3097102">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097106">return</span>&nbsp;<span class="ident" id="3097113">classAMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097125">case</span>&nbsp;<span class="ident" id="3097130">ip</span><span class="op" id="3097132">[</span><span class="num" id="3097133">0</span><span class="op" id="3097134">]</span>&nbsp;<span class="op" id="3097136">&lt;</span>&nbsp;<span class="num" id="3097138">0xC0</span><span class="op" id="3097142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097146">return</span>&nbsp;<span class="ident" id="3097153">classBMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097165">default</span><span class="op" id="3097172">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097176">return</span>&nbsp;<span class="ident" id="3097183">classCMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097195">}</span><br>
<span class="lineno"></span><span class="op" id="3097197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3097200">func</span>&nbsp;<span class="ident" id="3097205">allFF</span><span class="op" id="3097210">(</span><span class="ident" id="3097211">b</span>&nbsp;<span class="op" id="3097213">[</span><span class="op" id="3097214">]</span><span class="builtintype" id="3097215">byte</span><span class="op" id="3097219">)</span>&nbsp;<span class="builtintype" id="3097221">bool</span>&nbsp;<span class="op" id="3097226">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097229">for</span>&nbsp;<span class="ident" id="3097233">_</span><span class="op" id="3097234">,</span>&nbsp;<span class="ident" id="3097236">c</span>&nbsp;<span class="op" id="3097238">:=</span>&nbsp;<span class="keyword" id="3097241">range</span>&nbsp;<span class="ident" id="3097247">b</span>&nbsp;<span class="op" id="3097249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097253">if</span>&nbsp;<span class="ident" id="3097256">c</span>&nbsp;<span class="op" id="3097258">!=</span>&nbsp;<span class="num" id="3097261">0xff</span>&nbsp;<span class="op" id="3097266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097271">return</span>&nbsp;<span class="builtintype" id="3097278">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097289">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097292">return</span>&nbsp;<span class="builtintype" id="3097299">true</span><br>
<span class="lineno"></span><span class="op" id="3097304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3097307">//&nbsp;Mask&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;masking&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;with&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="3097374">func</span>&nbsp;<span class="op" id="3097379">(</span><span class="ident" id="3097380">ip</span>&nbsp;<span class="ident" id="3097383">IP</span><span class="op" id="3097385">)</span>&nbsp;<span class="ident" id="3097387">Mask</span><span class="op" id="3097391">(</span><span class="ident" id="3097392">mask</span>&nbsp;<span class="ident" id="3097397">IPMask</span><span class="op" id="3097403">)</span>&nbsp;<span class="ident" id="3097405">IP</span>&nbsp;<span class="op" id="3097408">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097411">if</span>&nbsp;<span class="builtinfunc" id="3097414">len</span><span class="op" id="3097417">(</span><span class="ident" id="3097418">mask</span><span class="op" id="3097422">)</span>&nbsp;<span class="op" id="3097424">==</span>&nbsp;<span class="ident" id="3097427">IPv6len</span>&nbsp;<span class="op" id="3097435">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3097438">len</span><span class="op" id="3097441">(</span><span class="ident" id="3097442">ip</span><span class="op" id="3097444">)</span>&nbsp;<span class="op" id="3097446">==</span>&nbsp;<span class="ident" id="3097449">IPv4len</span>&nbsp;<span class="op" id="3097457">&amp;&amp;</span>&nbsp;<span class="ident" id="3097460">allFF</span><span class="op" id="3097465">(</span><span class="ident" id="3097466">mask</span><span class="op" id="3097470">[</span><span class="op" id="3097471">:</span><span class="num" id="3097472">12</span><span class="op" id="3097474">]</span><span class="op" id="3097475">)</span>&nbsp;<span class="op" id="3097477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097481">mask</span>&nbsp;<span class="op" id="3097486">=</span>&nbsp;<span class="ident" id="3097488">mask</span><span class="op" id="3097492">[</span><span class="num" id="3097493">12</span><span class="op" id="3097495">:</span><span class="op" id="3097496">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097502">if</span>&nbsp;<span class="builtinfunc" id="3097505">len</span><span class="op" id="3097508">(</span><span class="ident" id="3097509">mask</span><span class="op" id="3097513">)</span>&nbsp;<span class="op" id="3097515">==</span>&nbsp;<span class="ident" id="3097518">IPv4len</span>&nbsp;<span class="op" id="3097526">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3097529">len</span><span class="op" id="3097532">(</span><span class="ident" id="3097533">ip</span><span class="op" id="3097535">)</span>&nbsp;<span class="op" id="3097537">==</span>&nbsp;<span class="ident" id="3097540">IPv6len</span>&nbsp;<span class="op" id="3097548">&amp;&amp;</span>&nbsp;<span class="ident" id="3097551">bytesEqual</span><span class="op" id="3097561">(</span><span class="ident" id="3097562">ip</span><span class="op" id="3097564">[</span><span class="op" id="3097565">:</span><span class="num" id="3097566">12</span><span class="op" id="3097568">]</span><span class="op" id="3097569">,</span>&nbsp;<span class="ident" id="3097571">v4InV6Prefix</span><span class="op" id="3097583">)</span>&nbsp;<span class="op" id="3097585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097589">ip</span>&nbsp;<span class="op" id="3097592">=</span>&nbsp;<span class="ident" id="3097594">ip</span><span class="op" id="3097596">[</span><span class="num" id="3097597">12</span><span class="op" id="3097599">:</span><span class="op" id="3097600">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097606">n</span>&nbsp;<span class="op" id="3097608">:=</span>&nbsp;<span class="builtinfunc" id="3097611">len</span><span class="op" id="3097614">(</span><span class="ident" id="3097615">ip</span><span class="op" id="3097617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097620">if</span>&nbsp;<span class="ident" id="3097623">n</span>&nbsp;<span class="op" id="3097625">!=</span>&nbsp;<span class="builtinfunc" id="3097628">len</span><span class="op" id="3097631">(</span><span class="ident" id="3097632">mask</span><span class="op" id="3097636">)</span>&nbsp;<span class="op" id="3097638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097642">return</span>&nbsp;<span class="ident" id="3097649">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097654">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097657">out</span>&nbsp;<span class="op" id="3097661">:=</span>&nbsp;<span class="builtinfunc" id="3097664">make</span><span class="op" id="3097668">(</span><span class="ident" id="3097669">IP</span><span class="op" id="3097671">,</span>&nbsp;<span class="ident" id="3097673">n</span><span class="op" id="3097674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097677">for</span>&nbsp;<span class="ident" id="3097681">i</span>&nbsp;<span class="op" id="3097683">:=</span>&nbsp;<span class="num" id="3097686">0</span><span class="op" id="3097687">;</span>&nbsp;<span class="ident" id="3097689">i</span>&nbsp;<span class="op" id="3097691">&lt;</span>&nbsp;<span class="ident" id="3097693">n</span><span class="op" id="3097694">;</span>&nbsp;<span class="ident" id="3097696">i</span><span class="op" id="3097697">++</span>&nbsp;<span class="op" id="3097700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3097704">out</span><span class="op" id="3097707">[</span><span class="ident" id="3097708">i</span><span class="op" id="3097709">]</span>&nbsp;<span class="op" id="3097711">=</span>&nbsp;<span class="ident" id="3097713">ip</span><span class="op" id="3097715">[</span><span class="ident" id="3097716">i</span><span class="op" id="3097717">]</span>&nbsp;<span class="op" id="3097719">&amp;</span>&nbsp;<span class="ident" id="3097721">mask</span><span class="op" id="3097725">[</span><span class="ident" id="3097726">i</span><span class="op" id="3097727">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3097730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3097733">return</span>&nbsp;<span class="ident" id="3097740">out</span><br>
<span class="lineno">255</span><span class="op" id="3097744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3097747">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3097803">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;the&nbsp;string&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="3097867">//&nbsp;is&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;).&nbsp;&nbsp;Otherwise&nbsp;the&nbsp;representation</span><br>
<span class="lineno">260</span><span class="comment" id="3097936">//&nbsp;is&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;).</span><br>
<span class="lineno"></span><span class="keyword" id="3097973">func</span>&nbsp;<span class="op" id="3097978">(</span><span class="ident" id="3097979">ip</span>&nbsp;<span class="ident" id="3097982">IP</span><span class="op" id="3097984">)</span>&nbsp;<span class="ident" id="3097986">String</span><span class="op" id="3097992">(</span><span class="op" id="3097993">)</span>&nbsp;<span class="builtintype" id="3097995">string</span>&nbsp;<span class="op" id="3098002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098005">p</span>&nbsp;<span class="op" id="3098007">:=</span>&nbsp;<span class="ident" id="3098010">ip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098015">if</span>&nbsp;<span class="builtinfunc" id="3098018">len</span><span class="op" id="3098021">(</span><span class="ident" id="3098022">ip</span><span class="op" id="3098024">)</span>&nbsp;<span class="op" id="3098026">==</span>&nbsp;<span class="num" id="3098029">0</span>&nbsp;<span class="op" id="3098031">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098035">return</span>&nbsp;<span class="string" id="3098042">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3098055">//&nbsp;If&nbsp;IPv4,&nbsp;use&nbsp;dotted&nbsp;notation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098089">if</span>&nbsp;<span class="ident" id="3098092">p4</span>&nbsp;<span class="op" id="3098095">:=</span>&nbsp;<span class="ident" id="3098098">p</span><span class="op" id="3098099">.</span><span class="ident" id="3098100">To4</span><span class="op" id="3098103">(</span><span class="op" id="3098104">)</span><span class="op" id="3098105">;</span>&nbsp;<span class="builtinfunc" id="3098107">len</span><span class="op" id="3098110">(</span><span class="ident" id="3098111">p4</span><span class="op" id="3098113">)</span>&nbsp;<span class="op" id="3098115">==</span>&nbsp;<span class="ident" id="3098118">IPv4len</span>&nbsp;<span class="op" id="3098126">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098130">return</span>&nbsp;<span class="ident" id="3098137">itod</span><span class="op" id="3098141">(</span><span class="builtintype" id="3098142">uint</span><span class="op" id="3098146">(</span><span class="ident" id="3098147">p4</span><span class="op" id="3098149">[</span><span class="num" id="3098150">0</span><span class="op" id="3098151">]</span><span class="op" id="3098152">)</span><span class="op" id="3098153">)</span>&nbsp;<span class="op" id="3098155">+</span>&nbsp;<span class="string" id="3098157">&#34;.&#34;</span>&nbsp;<span class="op" id="3098161">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098166">itod</span><span class="op" id="3098170">(</span><span class="builtintype" id="3098171">uint</span><span class="op" id="3098175">(</span><span class="ident" id="3098176">p4</span><span class="op" id="3098178">[</span><span class="num" id="3098179">1</span><span class="op" id="3098180">]</span><span class="op" id="3098181">)</span><span class="op" id="3098182">)</span>&nbsp;<span class="op" id="3098184">+</span>&nbsp;<span class="string" id="3098186">&#34;.&#34;</span>&nbsp;<span class="op" id="3098190">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098195">itod</span><span class="op" id="3098199">(</span><span class="builtintype" id="3098200">uint</span><span class="op" id="3098204">(</span><span class="ident" id="3098205">p4</span><span class="op" id="3098207">[</span><span class="num" id="3098208">2</span><span class="op" id="3098209">]</span><span class="op" id="3098210">)</span><span class="op" id="3098211">)</span>&nbsp;<span class="op" id="3098213">+</span>&nbsp;<span class="string" id="3098215">&#34;.&#34;</span>&nbsp;<span class="op" id="3098219">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098224">itod</span><span class="op" id="3098228">(</span><span class="builtintype" id="3098229">uint</span><span class="op" id="3098233">(</span><span class="ident" id="3098234">p4</span><span class="op" id="3098236">[</span><span class="num" id="3098237">3</span><span class="op" id="3098238">]</span><span class="op" id="3098239">)</span><span class="op" id="3098240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098243">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098246">if</span>&nbsp;<span class="builtinfunc" id="3098249">len</span><span class="op" id="3098252">(</span><span class="ident" id="3098253">p</span><span class="op" id="3098254">)</span>&nbsp;<span class="op" id="3098256">!=</span>&nbsp;<span class="ident" id="3098259">IPv6len</span>&nbsp;<span class="op" id="3098267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098271">return</span>&nbsp;<span class="string" id="3098278">&#34;?&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3098287">//&nbsp;Find&nbsp;longest&nbsp;run&nbsp;of&nbsp;zeros.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098318">e0</span>&nbsp;<span class="op" id="3098321">:=</span>&nbsp;<span class="op" id="3098324">-</span><span class="num" id="3098325">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098328">e1</span>&nbsp;<span class="op" id="3098331">:=</span>&nbsp;<span class="op" id="3098334">-</span><span class="num" id="3098335">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098338">for</span>&nbsp;<span class="ident" id="3098342">i</span>&nbsp;<span class="op" id="3098344">:=</span>&nbsp;<span class="num" id="3098347">0</span><span class="op" id="3098348">;</span>&nbsp;<span class="ident" id="3098350">i</span>&nbsp;<span class="op" id="3098352">&lt;</span>&nbsp;<span class="ident" id="3098354">IPv6len</span><span class="op" id="3098361">;</span>&nbsp;<span class="ident" id="3098363">i</span>&nbsp;<span class="op" id="3098365">+=</span>&nbsp;<span class="num" id="3098368">2</span>&nbsp;<span class="op" id="3098370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098374">j</span>&nbsp;<span class="op" id="3098376">:=</span>&nbsp;<span class="ident" id="3098379">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098383">for</span>&nbsp;<span class="ident" id="3098387">j</span>&nbsp;<span class="op" id="3098389">&lt;</span>&nbsp;<span class="ident" id="3098391">IPv6len</span>&nbsp;<span class="op" id="3098399">&amp;&amp;</span>&nbsp;<span class="ident" id="3098402">p</span><span class="op" id="3098403">[</span><span class="ident" id="3098404">j</span><span class="op" id="3098405">]</span>&nbsp;<span class="op" id="3098407">==</span>&nbsp;<span class="num" id="3098410">0</span>&nbsp;<span class="op" id="3098412">&amp;&amp;</span>&nbsp;<span class="ident" id="3098415">p</span><span class="op" id="3098416">[</span><span class="ident" id="3098417">j</span><span class="op" id="3098418">+</span><span class="num" id="3098419">1</span><span class="op" id="3098420">]</span>&nbsp;<span class="op" id="3098422">==</span>&nbsp;<span class="num" id="3098425">0</span>&nbsp;<span class="op" id="3098427">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098432">j</span>&nbsp;<span class="op" id="3098434">+=</span>&nbsp;<span class="num" id="3098437">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098445">if</span>&nbsp;<span class="ident" id="3098448">j</span>&nbsp;<span class="op" id="3098450">&gt;</span>&nbsp;<span class="ident" id="3098452">i</span>&nbsp;<span class="op" id="3098454">&amp;&amp;</span>&nbsp;<span class="ident" id="3098457">j</span><span class="op" id="3098458">-</span><span class="ident" id="3098459">i</span>&nbsp;<span class="op" id="3098461">&gt;</span>&nbsp;<span class="ident" id="3098463">e1</span><span class="op" id="3098465">-</span><span class="ident" id="3098466">e0</span>&nbsp;<span class="op" id="3098469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098474">e0</span>&nbsp;<span class="op" id="3098477">=</span>&nbsp;<span class="ident" id="3098479">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098484">e1</span>&nbsp;<span class="op" id="3098487">=</span>&nbsp;<span class="ident" id="3098489">j</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098494">i</span>&nbsp;<span class="op" id="3098496">=</span>&nbsp;<span class="ident" id="3098498">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3098508">//&nbsp;The&nbsp;symbol&nbsp;&#34;::&#34;&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;shorten&nbsp;just&nbsp;one&nbsp;16&nbsp;bit&nbsp;0&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098581">if</span>&nbsp;<span class="ident" id="3098584">e1</span><span class="op" id="3098586">-</span><span class="ident" id="3098587">e0</span>&nbsp;<span class="op" id="3098590">&lt;=</span>&nbsp;<span class="num" id="3098593">2</span>&nbsp;<span class="op" id="3098595">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098599">e0</span>&nbsp;<span class="op" id="3098602">=</span>&nbsp;<span class="op" id="3098604">-</span><span class="num" id="3098605">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098609">e1</span>&nbsp;<span class="op" id="3098612">=</span>&nbsp;<span class="op" id="3098614">-</span><span class="num" id="3098615">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098622">const</span>&nbsp;<span class="ident" id="3098628">maxLen</span>&nbsp;<span class="op" id="3098635">=</span>&nbsp;<span class="builtinfunc" id="3098637">len</span><span class="op" id="3098640">(</span><span class="string" id="3098641">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op" id="3098682">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098685">b</span>&nbsp;<span class="op" id="3098687">:=</span>&nbsp;<span class="builtinfunc" id="3098690">make</span><span class="op" id="3098694">(</span><span class="op" id="3098695">[</span><span class="op" id="3098696">]</span><span class="builtintype" id="3098697">byte</span><span class="op" id="3098701">,</span>&nbsp;<span class="num" id="3098703">0</span><span class="op" id="3098704">,</span>&nbsp;<span class="ident" id="3098706">maxLen</span><span class="op" id="3098712">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3098716">//&nbsp;Print&nbsp;with&nbsp;possible&nbsp;::&nbsp;in&nbsp;place&nbsp;of&nbsp;run&nbsp;of&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098768">for</span>&nbsp;<span class="ident" id="3098772">i</span>&nbsp;<span class="op" id="3098774">:=</span>&nbsp;<span class="num" id="3098777">0</span><span class="op" id="3098778">;</span>&nbsp;<span class="ident" id="3098780">i</span>&nbsp;<span class="op" id="3098782">&lt;</span>&nbsp;<span class="ident" id="3098784">IPv6len</span><span class="op" id="3098791">;</span>&nbsp;<span class="ident" id="3098793">i</span>&nbsp;<span class="op" id="3098795">+=</span>&nbsp;<span class="num" id="3098798">2</span>&nbsp;<span class="op" id="3098800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098804">if</span>&nbsp;<span class="ident" id="3098807">i</span>&nbsp;<span class="op" id="3098809">==</span>&nbsp;<span class="ident" id="3098812">e0</span>&nbsp;<span class="op" id="3098815">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098820">b</span>&nbsp;<span class="op" id="3098822">=</span>&nbsp;<span class="builtinfunc" id="3098824">append</span><span class="op" id="3098830">(</span><span class="ident" id="3098831">b</span><span class="op" id="3098832">,</span>&nbsp;<span class="string" id="3098834">&#39;:&#39;</span><span class="op" id="3098837">,</span>&nbsp;<span class="string" id="3098839">&#39;:&#39;</span><span class="op" id="3098842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098847">i</span>&nbsp;<span class="op" id="3098849">=</span>&nbsp;<span class="ident" id="3098851">e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098857">if</span>&nbsp;<span class="ident" id="3098860">i</span>&nbsp;<span class="op" id="3098862">&gt;=</span>&nbsp;<span class="ident" id="3098865">IPv6len</span>&nbsp;<span class="op" id="3098873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098879">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098888">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098892">}</span>&nbsp;<span class="keyword" id="3098894">else</span>&nbsp;<span class="keyword" id="3098899">if</span>&nbsp;<span class="ident" id="3098902">i</span>&nbsp;<span class="op" id="3098904">&gt;</span>&nbsp;<span class="num" id="3098906">0</span>&nbsp;<span class="op" id="3098908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098913">b</span>&nbsp;<span class="op" id="3098915">=</span>&nbsp;<span class="builtinfunc" id="3098917">append</span><span class="op" id="3098923">(</span><span class="ident" id="3098924">b</span><span class="op" id="3098925">,</span>&nbsp;<span class="string" id="3098927">&#39;:&#39;</span><span class="op" id="3098930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3098938">b</span>&nbsp;<span class="op" id="3098940">=</span>&nbsp;<span class="ident" id="3098942">appendHex</span><span class="op" id="3098951">(</span><span class="ident" id="3098952">b</span><span class="op" id="3098953">,</span>&nbsp;<span class="op" id="3098955">(</span><span class="builtintype" id="3098956">uint32</span><span class="op" id="3098962">(</span><span class="ident" id="3098963">p</span><span class="op" id="3098964">[</span><span class="ident" id="3098965">i</span><span class="op" id="3098966">]</span><span class="op" id="3098967">)</span><span class="op" id="3098968">&lt;&lt;</span><span class="num" id="3098970">8</span><span class="op" id="3098971">)</span><span class="op" id="3098972">|</span><span class="builtintype" id="3098973">uint32</span><span class="op" id="3098979">(</span><span class="ident" id="3098980">p</span><span class="op" id="3098981">[</span><span class="ident" id="3098982">i</span><span class="op" id="3098983">+</span><span class="num" id="3098984">1</span><span class="op" id="3098985">]</span><span class="op" id="3098986">)</span><span class="op" id="3098987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3098990">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3098993">return</span>&nbsp;<span class="builtintype" id="3099000">string</span><span class="op" id="3099006">(</span><span class="ident" id="3099007">b</span><span class="op" id="3099008">)</span><br>
<span class="lineno"></span><span class="op" id="3099010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3099013">//&nbsp;ipEmptyString&nbsp;is&nbsp;like&nbsp;ip.String&nbsp;except&nbsp;that&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3099071">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;when&nbsp;ip&nbsp;is&nbsp;unset.</span><br>
<span class="lineno">320</span><span class="keyword" id="3099108">func</span>&nbsp;<span class="ident" id="3099113">ipEmptyString</span><span class="op" id="3099126">(</span><span class="ident" id="3099127">ip</span>&nbsp;<span class="ident" id="3099130">IP</span><span class="op" id="3099132">)</span>&nbsp;<span class="builtintype" id="3099134">string</span>&nbsp;<span class="op" id="3099141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099144">if</span>&nbsp;<span class="builtinfunc" id="3099147">len</span><span class="op" id="3099150">(</span><span class="ident" id="3099151">ip</span><span class="op" id="3099153">)</span>&nbsp;<span class="op" id="3099155">==</span>&nbsp;<span class="num" id="3099158">0</span>&nbsp;<span class="op" id="3099160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099164">return</span>&nbsp;<span class="string" id="3099171">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099178">return</span>&nbsp;<span class="ident" id="3099185">ip</span><span class="op" id="3099187">.</span><span class="ident" id="3099188">String</span><span class="op" id="3099194">(</span><span class="op" id="3099195">)</span><br>
<span class="lineno">325</span><span class="op" id="3099197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3099200">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3099264">//&nbsp;The&nbsp;encoding&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;returned&nbsp;by&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword" id="3099315">func</span>&nbsp;<span class="op" id="3099320">(</span><span class="ident" id="3099321">ip</span>&nbsp;<span class="ident" id="3099324">IP</span><span class="op" id="3099326">)</span>&nbsp;<span class="ident" id="3099328">MarshalText</span><span class="op" id="3099339">(</span><span class="op" id="3099340">)</span>&nbsp;<span class="op" id="3099342">(</span><span class="op" id="3099343">[</span><span class="op" id="3099344">]</span><span class="builtintype" id="3099345">byte</span><span class="op" id="3099349">,</span>&nbsp;<span class="builtintype" id="3099351">error</span><span class="op" id="3099356">)</span>&nbsp;<span class="op" id="3099358">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099361">if</span>&nbsp;<span class="builtinfunc" id="3099364">len</span><span class="op" id="3099367">(</span><span class="ident" id="3099368">ip</span><span class="op" id="3099370">)</span>&nbsp;<span class="op" id="3099372">==</span>&nbsp;<span class="num" id="3099375">0</span>&nbsp;<span class="op" id="3099377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099381">return</span>&nbsp;<span class="op" id="3099388">[</span><span class="op" id="3099389">]</span><span class="builtintype" id="3099390">byte</span><span class="op" id="3099394">(</span><span class="string" id="3099395">&#34;&#34;</span><span class="op" id="3099397">)</span><span class="op" id="3099398">,</span>&nbsp;<span class="ident" id="3099400">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099408">if</span>&nbsp;<span class="builtinfunc" id="3099411">len</span><span class="op" id="3099414">(</span><span class="ident" id="3099415">ip</span><span class="op" id="3099417">)</span>&nbsp;<span class="op" id="3099419">!=</span>&nbsp;<span class="ident" id="3099422">IPv4len</span>&nbsp;<span class="op" id="3099430">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3099433">len</span><span class="op" id="3099436">(</span><span class="ident" id="3099437">ip</span><span class="op" id="3099439">)</span>&nbsp;<span class="op" id="3099441">!=</span>&nbsp;<span class="ident" id="3099444">IPv6len</span>&nbsp;<span class="op" id="3099452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099456">return</span>&nbsp;<span class="ident" id="3099463">nil</span><span class="op" id="3099466">,</span>&nbsp;<span class="ident" id="3099468">errors</span><span class="op" id="3099474">.</span><span class="ident" id="3099475">New</span><span class="op" id="3099478">(</span><span class="string" id="3099479">&#34;invalid&nbsp;IP&nbsp;address&#34;</span><span class="op" id="3099499">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099505">return</span>&nbsp;<span class="op" id="3099512">[</span><span class="op" id="3099513">]</span><span class="builtintype" id="3099514">byte</span><span class="op" id="3099518">(</span><span class="ident" id="3099519">ip</span><span class="op" id="3099521">.</span><span class="ident" id="3099522">String</span><span class="op" id="3099528">(</span><span class="op" id="3099529">)</span><span class="op" id="3099530">)</span><span class="op" id="3099531">,</span>&nbsp;<span class="ident" id="3099533">nil</span><br>
<span class="lineno"></span><span class="op" id="3099537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3099540">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno">340</span><span class="comment" id="3099608">//&nbsp;The&nbsp;IP&nbsp;address&nbsp;is&nbsp;expected&nbsp;in&nbsp;a&nbsp;form&nbsp;accepted&nbsp;by&nbsp;ParseIP.</span><br>
<span class="lineno"></span><span class="keyword" id="3099669">func</span>&nbsp;<span class="op" id="3099674">(</span><span class="ident" id="3099675">ip</span>&nbsp;<span class="op" id="3099678">*</span><span class="ident" id="3099679">IP</span><span class="op" id="3099681">)</span>&nbsp;<span class="ident" id="3099683">UnmarshalText</span><span class="op" id="3099696">(</span><span class="ident" id="3099697">text</span>&nbsp;<span class="op" id="3099702">[</span><span class="op" id="3099703">]</span><span class="builtintype" id="3099704">byte</span><span class="op" id="3099708">)</span>&nbsp;<span class="builtintype" id="3099710">error</span>&nbsp;<span class="op" id="3099716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099719">if</span>&nbsp;<span class="builtinfunc" id="3099722">len</span><span class="op" id="3099725">(</span><span class="ident" id="3099726">text</span><span class="op" id="3099730">)</span>&nbsp;<span class="op" id="3099732">==</span>&nbsp;<span class="num" id="3099735">0</span>&nbsp;<span class="op" id="3099737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099741">*</span><span class="ident" id="3099742">ip</span>&nbsp;<span class="op" id="3099745">=</span>&nbsp;<span class="ident" id="3099747">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099753">return</span>&nbsp;<span class="ident" id="3099760">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099768">s</span>&nbsp;<span class="op" id="3099770">:=</span>&nbsp;<span class="builtintype" id="3099773">string</span><span class="op" id="3099779">(</span><span class="ident" id="3099780">text</span><span class="op" id="3099784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3099787">x</span>&nbsp;<span class="op" id="3099789">:=</span>&nbsp;<span class="ident" id="3099792">ParseIP</span><span class="op" id="3099799">(</span><span class="ident" id="3099800">s</span><span class="op" id="3099801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099804">if</span>&nbsp;<span class="ident" id="3099807">x</span>&nbsp;<span class="op" id="3099809">==</span>&nbsp;<span class="ident" id="3099812">nil</span>&nbsp;<span class="op" id="3099816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099820">return</span>&nbsp;<span class="op" id="3099827">&amp;</span><span class="ident" id="3099828">ParseError</span><span class="op" id="3099838">{</span><span class="string" id="3099839">&#34;IP&nbsp;address&#34;</span><span class="op" id="3099851">,</span>&nbsp;<span class="ident" id="3099853">s</span><span class="op" id="3099854">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3099860">*</span><span class="ident" id="3099861">ip</span>&nbsp;<span class="op" id="3099864">=</span>&nbsp;<span class="ident" id="3099866">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3099869">return</span>&nbsp;<span class="ident" id="3099876">nil</span><br>
<span class="lineno"></span><span class="op" id="3099880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3099883">//&nbsp;Equal&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;and&nbsp;x&nbsp;are&nbsp;the&nbsp;same&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="3099942">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;and&nbsp;that&nbsp;same&nbsp;address&nbsp;in&nbsp;IPv6&nbsp;form&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3100000">//&nbsp;considered&nbsp;to&nbsp;be&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="3100027">func</span>&nbsp;<span class="op" id="3100032">(</span><span class="ident" id="3100033">ip</span>&nbsp;<span class="ident" id="3100036">IP</span><span class="op" id="3100038">)</span>&nbsp;<span class="ident" id="3100040">Equal</span><span class="op" id="3100045">(</span><span class="ident" id="3100046">x</span>&nbsp;<span class="ident" id="3100048">IP</span><span class="op" id="3100050">)</span>&nbsp;<span class="builtintype" id="3100052">bool</span>&nbsp;<span class="op" id="3100057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100060">if</span>&nbsp;<span class="builtinfunc" id="3100063">len</span><span class="op" id="3100066">(</span><span class="ident" id="3100067">ip</span><span class="op" id="3100069">)</span>&nbsp;<span class="op" id="3100071">==</span>&nbsp;<span class="builtinfunc" id="3100074">len</span><span class="op" id="3100077">(</span><span class="ident" id="3100078">x</span><span class="op" id="3100079">)</span>&nbsp;<span class="op" id="3100081">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100085">return</span>&nbsp;<span class="ident" id="3100092">bytesEqual</span><span class="op" id="3100102">(</span><span class="ident" id="3100103">ip</span><span class="op" id="3100105">,</span>&nbsp;<span class="ident" id="3100107">x</span><span class="op" id="3100108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100114">if</span>&nbsp;<span class="builtinfunc" id="3100117">len</span><span class="op" id="3100120">(</span><span class="ident" id="3100121">ip</span><span class="op" id="3100123">)</span>&nbsp;<span class="op" id="3100125">==</span>&nbsp;<span class="ident" id="3100128">IPv4len</span>&nbsp;<span class="op" id="3100136">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3100139">len</span><span class="op" id="3100142">(</span><span class="ident" id="3100143">x</span><span class="op" id="3100144">)</span>&nbsp;<span class="op" id="3100146">==</span>&nbsp;<span class="ident" id="3100149">IPv6len</span>&nbsp;<span class="op" id="3100157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100161">return</span>&nbsp;<span class="ident" id="3100168">bytesEqual</span><span class="op" id="3100178">(</span><span class="ident" id="3100179">x</span><span class="op" id="3100180">[</span><span class="num" id="3100181">0</span><span class="op" id="3100182">:</span><span class="num" id="3100183">12</span><span class="op" id="3100185">]</span><span class="op" id="3100186">,</span>&nbsp;<span class="ident" id="3100188">v4InV6Prefix</span><span class="op" id="3100200">)</span>&nbsp;<span class="op" id="3100202">&amp;&amp;</span>&nbsp;<span class="ident" id="3100205">bytesEqual</span><span class="op" id="3100215">(</span><span class="ident" id="3100216">ip</span><span class="op" id="3100218">,</span>&nbsp;<span class="ident" id="3100220">x</span><span class="op" id="3100221">[</span><span class="num" id="3100222">12</span><span class="op" id="3100224">:</span><span class="op" id="3100225">]</span><span class="op" id="3100226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100229">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100232">if</span>&nbsp;<span class="builtinfunc" id="3100235">len</span><span class="op" id="3100238">(</span><span class="ident" id="3100239">ip</span><span class="op" id="3100241">)</span>&nbsp;<span class="op" id="3100243">==</span>&nbsp;<span class="ident" id="3100246">IPv6len</span>&nbsp;<span class="op" id="3100254">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3100257">len</span><span class="op" id="3100260">(</span><span class="ident" id="3100261">x</span><span class="op" id="3100262">)</span>&nbsp;<span class="op" id="3100264">==</span>&nbsp;<span class="ident" id="3100267">IPv4len</span>&nbsp;<span class="op" id="3100275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100279">return</span>&nbsp;<span class="ident" id="3100286">bytesEqual</span><span class="op" id="3100296">(</span><span class="ident" id="3100297">ip</span><span class="op" id="3100299">[</span><span class="num" id="3100300">0</span><span class="op" id="3100301">:</span><span class="num" id="3100302">12</span><span class="op" id="3100304">]</span><span class="op" id="3100305">,</span>&nbsp;<span class="ident" id="3100307">v4InV6Prefix</span><span class="op" id="3100319">)</span>&nbsp;<span class="op" id="3100321">&amp;&amp;</span>&nbsp;<span class="ident" id="3100324">bytesEqual</span><span class="op" id="3100334">(</span><span class="ident" id="3100335">ip</span><span class="op" id="3100337">[</span><span class="num" id="3100338">12</span><span class="op" id="3100340">:</span><span class="op" id="3100341">]</span><span class="op" id="3100342">,</span>&nbsp;<span class="ident" id="3100344">x</span><span class="op" id="3100345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100351">return</span>&nbsp;<span class="builtintype" id="3100358">false</span><br>
<span class="lineno"></span><span class="op" id="3100364">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="keyword" id="3100367">func</span>&nbsp;<span class="ident" id="3100372">bytesEqual</span><span class="op" id="3100382">(</span><span class="ident" id="3100383">x</span><span class="op" id="3100384">,</span>&nbsp;<span class="ident" id="3100386">y</span>&nbsp;<span class="op" id="3100388">[</span><span class="op" id="3100389">]</span><span class="builtintype" id="3100390">byte</span><span class="op" id="3100394">)</span>&nbsp;<span class="builtintype" id="3100396">bool</span>&nbsp;<span class="op" id="3100401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100404">if</span>&nbsp;<span class="builtinfunc" id="3100407">len</span><span class="op" id="3100410">(</span><span class="ident" id="3100411">x</span><span class="op" id="3100412">)</span>&nbsp;<span class="op" id="3100414">!=</span>&nbsp;<span class="builtinfunc" id="3100417">len</span><span class="op" id="3100420">(</span><span class="ident" id="3100421">y</span><span class="op" id="3100422">)</span>&nbsp;<span class="op" id="3100424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100428">return</span>&nbsp;<span class="builtintype" id="3100435">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100442">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100445">for</span>&nbsp;<span class="ident" id="3100449">i</span><span class="op" id="3100450">,</span>&nbsp;<span class="ident" id="3100452">b</span>&nbsp;<span class="op" id="3100454">:=</span>&nbsp;<span class="keyword" id="3100457">range</span>&nbsp;<span class="ident" id="3100463">x</span>&nbsp;<span class="op" id="3100465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100469">if</span>&nbsp;<span class="ident" id="3100472">y</span><span class="op" id="3100473">[</span><span class="ident" id="3100474">i</span><span class="op" id="3100475">]</span>&nbsp;<span class="op" id="3100477">!=</span>&nbsp;<span class="ident" id="3100480">b</span>&nbsp;<span class="op" id="3100482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100487">return</span>&nbsp;<span class="builtintype" id="3100494">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100505">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100508">return</span>&nbsp;<span class="builtintype" id="3100515">true</span><br>
<span class="lineno"></span><span class="op" id="3100520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3100523">//&nbsp;If&nbsp;mask&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;1&nbsp;bits&nbsp;followed&nbsp;by&nbsp;0&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3100578">//&nbsp;return&nbsp;the&nbsp;number&nbsp;of&nbsp;1&nbsp;bits.</span><br>
<span class="lineno">385</span><span class="keyword" id="3100610">func</span>&nbsp;<span class="ident" id="3100615">simpleMaskLength</span><span class="op" id="3100631">(</span><span class="ident" id="3100632">mask</span>&nbsp;<span class="ident" id="3100637">IPMask</span><span class="op" id="3100643">)</span>&nbsp;<span class="builtintype" id="3100645">int</span>&nbsp;<span class="op" id="3100649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100652">var</span>&nbsp;<span class="ident" id="3100656">n</span>&nbsp;<span class="builtintype" id="3100658">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100663">for</span>&nbsp;<span class="ident" id="3100667">i</span><span class="op" id="3100668">,</span>&nbsp;<span class="ident" id="3100670">v</span>&nbsp;<span class="op" id="3100672">:=</span>&nbsp;<span class="keyword" id="3100675">range</span>&nbsp;<span class="ident" id="3100681">mask</span>&nbsp;<span class="op" id="3100686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100690">if</span>&nbsp;<span class="ident" id="3100693">v</span>&nbsp;<span class="op" id="3100695">==</span>&nbsp;<span class="num" id="3100698">0xff</span>&nbsp;<span class="op" id="3100703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100708">n</span>&nbsp;<span class="op" id="3100710">+=</span>&nbsp;<span class="num" id="3100713">8</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100718">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3100733">//&nbsp;found&nbsp;non-ff&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3100756">//&nbsp;count&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100774">for</span>&nbsp;<span class="ident" id="3100778">v</span><span class="op" id="3100779">&amp;</span><span class="num" id="3100780">0x80</span>&nbsp;<span class="op" id="3100785">!=</span>&nbsp;<span class="num" id="3100788">0</span>&nbsp;<span class="op" id="3100790">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100795">n</span><span class="op" id="3100796">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3100802">v</span>&nbsp;<span class="op" id="3100804">&lt;&lt;=</span>&nbsp;<span class="num" id="3100808">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3100816">//&nbsp;rest&nbsp;must&nbsp;be&nbsp;0&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100841">if</span>&nbsp;<span class="ident" id="3100844">v</span>&nbsp;<span class="op" id="3100846">!=</span>&nbsp;<span class="num" id="3100849">0</span>&nbsp;<span class="op" id="3100851">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100856">return</span>&nbsp;<span class="op" id="3100863">-</span><span class="num" id="3100864">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100872">for</span>&nbsp;<span class="ident" id="3100876">i</span><span class="op" id="3100877">++</span><span class="op" id="3100879">;</span>&nbsp;<span class="ident" id="3100881">i</span>&nbsp;<span class="op" id="3100883">&lt;</span>&nbsp;<span class="builtinfunc" id="3100885">len</span><span class="op" id="3100888">(</span><span class="ident" id="3100889">mask</span><span class="op" id="3100893">)</span><span class="op" id="3100894">;</span>&nbsp;<span class="ident" id="3100896">i</span><span class="op" id="3100897">++</span>&nbsp;<span class="op" id="3100900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100905">if</span>&nbsp;<span class="ident" id="3100908">mask</span><span class="op" id="3100912">[</span><span class="ident" id="3100913">i</span><span class="op" id="3100914">]</span>&nbsp;<span class="op" id="3100916">!=</span>&nbsp;<span class="num" id="3100919">0</span>&nbsp;<span class="op" id="3100921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100927">return</span>&nbsp;<span class="op" id="3100934">-</span><span class="num" id="3100935">1</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100948">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3100955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3100958">return</span>&nbsp;<span class="ident" id="3100965">n</span><br>
<span class="lineno">410</span><span class="op" id="3100967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3100970">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;ones&nbsp;and&nbsp;total&nbsp;bits&nbsp;in&nbsp;the&nbsp;mask.</span><br>
<span class="lineno"></span><span class="comment" id="3101041">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form--ones&nbsp;followed&nbsp;by&nbsp;zeros--then</span><br>
<span class="lineno"></span><span class="comment" id="3101115">//&nbsp;Size&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">415</span><span class="keyword" id="3101137">func</span>&nbsp;<span class="op" id="3101142">(</span><span class="ident" id="3101143">m</span>&nbsp;<span class="ident" id="3101145">IPMask</span><span class="op" id="3101151">)</span>&nbsp;<span class="ident" id="3101153">Size</span><span class="op" id="3101157">(</span><span class="op" id="3101158">)</span>&nbsp;<span class="op" id="3101160">(</span><span class="ident" id="3101161">ones</span><span class="op" id="3101165">,</span>&nbsp;<span class="ident" id="3101167">bits</span>&nbsp;<span class="builtintype" id="3101172">int</span><span class="op" id="3101175">)</span>&nbsp;<span class="op" id="3101177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101180">ones</span><span class="op" id="3101184">,</span>&nbsp;<span class="ident" id="3101186">bits</span>&nbsp;<span class="op" id="3101191">=</span>&nbsp;<span class="ident" id="3101193">simpleMaskLength</span><span class="op" id="3101209">(</span><span class="ident" id="3101210">m</span><span class="op" id="3101211">)</span><span class="op" id="3101212">,</span>&nbsp;<span class="builtinfunc" id="3101214">len</span><span class="op" id="3101217">(</span><span class="ident" id="3101218">m</span><span class="op" id="3101219">)</span><span class="op" id="3101220">*</span><span class="num" id="3101221">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101224">if</span>&nbsp;<span class="ident" id="3101227">ones</span>&nbsp;<span class="op" id="3101232">==</span>&nbsp;<span class="op" id="3101235">-</span><span class="num" id="3101236">1</span>&nbsp;<span class="op" id="3101238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101242">return</span>&nbsp;<span class="num" id="3101249">0</span><span class="op" id="3101250">,</span>&nbsp;<span class="num" id="3101252">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101255">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101258">return</span><br>
<span class="lineno"></span><span class="op" id="3101265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3101268">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;hexadecimal&nbsp;form&nbsp;of&nbsp;m,&nbsp;with&nbsp;no&nbsp;punctuation.</span><br>
<span class="lineno"></span><span class="keyword" id="3101334">func</span>&nbsp;<span class="op" id="3101339">(</span><span class="ident" id="3101340">m</span>&nbsp;<span class="ident" id="3101342">IPMask</span><span class="op" id="3101348">)</span>&nbsp;<span class="ident" id="3101350">String</span><span class="op" id="3101356">(</span><span class="op" id="3101357">)</span>&nbsp;<span class="builtintype" id="3101359">string</span>&nbsp;<span class="op" id="3101366">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101369">if</span>&nbsp;<span class="builtinfunc" id="3101372">len</span><span class="op" id="3101375">(</span><span class="ident" id="3101376">m</span><span class="op" id="3101377">)</span>&nbsp;<span class="op" id="3101379">==</span>&nbsp;<span class="num" id="3101382">0</span>&nbsp;<span class="op" id="3101384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101388">return</span>&nbsp;<span class="string" id="3101395">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101407">buf</span>&nbsp;<span class="op" id="3101411">:=</span>&nbsp;<span class="builtinfunc" id="3101414">make</span><span class="op" id="3101418">(</span><span class="op" id="3101419">[</span><span class="op" id="3101420">]</span><span class="builtintype" id="3101421">byte</span><span class="op" id="3101425">,</span>&nbsp;<span class="builtinfunc" id="3101427">len</span><span class="op" id="3101430">(</span><span class="ident" id="3101431">m</span><span class="op" id="3101432">)</span><span class="op" id="3101433">*</span><span class="num" id="3101434">2</span><span class="op" id="3101435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101438">for</span>&nbsp;<span class="ident" id="3101442">i</span><span class="op" id="3101443">,</span>&nbsp;<span class="ident" id="3101445">b</span>&nbsp;<span class="op" id="3101447">:=</span>&nbsp;<span class="keyword" id="3101450">range</span>&nbsp;<span class="ident" id="3101456">m</span>&nbsp;<span class="op" id="3101458">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101462">buf</span><span class="op" id="3101465">[</span><span class="ident" id="3101466">i</span><span class="op" id="3101467">*</span><span class="num" id="3101468">2</span><span class="op" id="3101469">]</span><span class="op" id="3101470">,</span>&nbsp;<span class="ident" id="3101472">buf</span><span class="op" id="3101475">[</span><span class="ident" id="3101476">i</span><span class="op" id="3101477">*</span><span class="num" id="3101478">2</span><span class="op" id="3101479">+</span><span class="num" id="3101480">1</span><span class="op" id="3101481">]</span>&nbsp;<span class="op" id="3101483">=</span>&nbsp;<span class="ident" id="3101485">hexDigit</span><span class="op" id="3101493">[</span><span class="ident" id="3101494">b</span><span class="op" id="3101495">&gt;&gt;</span><span class="num" id="3101497">4</span><span class="op" id="3101498">]</span><span class="op" id="3101499">,</span>&nbsp;<span class="ident" id="3101501">hexDigit</span><span class="op" id="3101509">[</span><span class="ident" id="3101510">b</span><span class="op" id="3101511">&amp;</span><span class="num" id="3101512">0xf</span><span class="op" id="3101515">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101521">return</span>&nbsp;<span class="builtintype" id="3101528">string</span><span class="op" id="3101534">(</span><span class="ident" id="3101535">buf</span><span class="op" id="3101538">)</span><br>
<span class="lineno"></span><span class="op" id="3101540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="3101543">func</span>&nbsp;<span class="ident" id="3101548">networkNumberAndMask</span><span class="op" id="3101568">(</span><span class="ident" id="3101569">n</span>&nbsp;<span class="op" id="3101571">*</span><span class="ident" id="3101572">IPNet</span><span class="op" id="3101577">)</span>&nbsp;<span class="op" id="3101579">(</span><span class="ident" id="3101580">ip</span>&nbsp;<span class="ident" id="3101583">IP</span><span class="op" id="3101585">,</span>&nbsp;<span class="ident" id="3101587">m</span>&nbsp;<span class="ident" id="3101589">IPMask</span><span class="op" id="3101595">)</span>&nbsp;<span class="op" id="3101597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101600">if</span>&nbsp;<span class="ident" id="3101603">ip</span>&nbsp;<span class="op" id="3101606">=</span>&nbsp;<span class="ident" id="3101608">n</span><span class="op" id="3101609">.</span><span class="ident" id="3101610">IP</span><span class="op" id="3101612">.</span><span class="ident" id="3101613">To4</span><span class="op" id="3101616">(</span><span class="op" id="3101617">)</span><span class="op" id="3101618">;</span>&nbsp;<span class="ident" id="3101620">ip</span>&nbsp;<span class="op" id="3101623">==</span>&nbsp;<span class="ident" id="3101626">nil</span>&nbsp;<span class="op" id="3101630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101634">ip</span>&nbsp;<span class="op" id="3101637">=</span>&nbsp;<span class="ident" id="3101639">n</span><span class="op" id="3101640">.</span><span class="ident" id="3101641">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101646">if</span>&nbsp;<span class="builtinfunc" id="3101649">len</span><span class="op" id="3101652">(</span><span class="ident" id="3101653">ip</span><span class="op" id="3101655">)</span>&nbsp;<span class="op" id="3101657">!=</span>&nbsp;<span class="ident" id="3101660">IPv6len</span>&nbsp;<span class="op" id="3101668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101673">return</span>&nbsp;<span class="ident" id="3101680">nil</span><span class="op" id="3101683">,</span>&nbsp;<span class="ident" id="3101685">nil</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101697">m</span>&nbsp;<span class="op" id="3101699">=</span>&nbsp;<span class="ident" id="3101701">n</span><span class="op" id="3101702">.</span><span class="ident" id="3101703">Mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101709">switch</span>&nbsp;<span class="builtinfunc" id="3101716">len</span><span class="op" id="3101719">(</span><span class="ident" id="3101720">m</span><span class="op" id="3101721">)</span>&nbsp;<span class="op" id="3101723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101726">case</span>&nbsp;<span class="ident" id="3101731">IPv4len</span><span class="op" id="3101738">:</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101742">if</span>&nbsp;<span class="builtinfunc" id="3101745">len</span><span class="op" id="3101748">(</span><span class="ident" id="3101749">ip</span><span class="op" id="3101751">)</span>&nbsp;<span class="op" id="3101753">!=</span>&nbsp;<span class="ident" id="3101756">IPv4len</span>&nbsp;<span class="op" id="3101764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101769">return</span>&nbsp;<span class="ident" id="3101776">nil</span><span class="op" id="3101779">,</span>&nbsp;<span class="ident" id="3101781">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101790">case</span>&nbsp;<span class="ident" id="3101795">IPv6len</span><span class="op" id="3101802">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101806">if</span>&nbsp;<span class="builtinfunc" id="3101809">len</span><span class="op" id="3101812">(</span><span class="ident" id="3101813">ip</span><span class="op" id="3101815">)</span>&nbsp;<span class="op" id="3101817">==</span>&nbsp;<span class="ident" id="3101820">IPv4len</span>&nbsp;<span class="op" id="3101828">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101833">m</span>&nbsp;<span class="op" id="3101835">=</span>&nbsp;<span class="ident" id="3101837">m</span><span class="op" id="3101838">[</span><span class="num" id="3101839">12</span><span class="op" id="3101841">:</span><span class="op" id="3101842">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101849">default</span><span class="op" id="3101856">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101860">return</span>&nbsp;<span class="ident" id="3101867">nil</span><span class="op" id="3101870">,</span>&nbsp;<span class="ident" id="3101872">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3101877">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3101880">return</span><br>
<span class="lineno"></span><span class="op" id="3101887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3101890">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;network&nbsp;includes&nbsp;ip.</span><br>
<span class="lineno"></span><span class="keyword" id="3101943">func</span>&nbsp;<span class="op" id="3101948">(</span><span class="ident" id="3101949">n</span>&nbsp;<span class="op" id="3101951">*</span><span class="ident" id="3101952">IPNet</span><span class="op" id="3101957">)</span>&nbsp;<span class="ident" id="3101959">Contains</span><span class="op" id="3101967">(</span><span class="ident" id="3101968">ip</span>&nbsp;<span class="ident" id="3101971">IP</span><span class="op" id="3101973">)</span>&nbsp;<span class="builtintype" id="3101975">bool</span>&nbsp;<span class="op" id="3101980">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3101983">nn</span><span class="op" id="3101985">,</span>&nbsp;<span class="ident" id="3101987">m</span>&nbsp;<span class="op" id="3101989">:=</span>&nbsp;<span class="ident" id="3101992">networkNumberAndMask</span><span class="op" id="3102012">(</span><span class="ident" id="3102013">n</span><span class="op" id="3102014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102017">if</span>&nbsp;<span class="ident" id="3102020">x</span>&nbsp;<span class="op" id="3102022">:=</span>&nbsp;<span class="ident" id="3102025">ip</span><span class="op" id="3102027">.</span><span class="ident" id="3102028">To4</span><span class="op" id="3102031">(</span><span class="op" id="3102032">)</span><span class="op" id="3102033">;</span>&nbsp;<span class="ident" id="3102035">x</span>&nbsp;<span class="op" id="3102037">!=</span>&nbsp;<span class="ident" id="3102040">nil</span>&nbsp;<span class="op" id="3102044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102048">ip</span>&nbsp;<span class="op" id="3102051">=</span>&nbsp;<span class="ident" id="3102053">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102059">l</span>&nbsp;<span class="op" id="3102061">:=</span>&nbsp;<span class="builtinfunc" id="3102064">len</span><span class="op" id="3102067">(</span><span class="ident" id="3102068">ip</span><span class="op" id="3102070">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102073">if</span>&nbsp;<span class="ident" id="3102076">l</span>&nbsp;<span class="op" id="3102078">!=</span>&nbsp;<span class="builtinfunc" id="3102081">len</span><span class="op" id="3102084">(</span><span class="ident" id="3102085">nn</span><span class="op" id="3102087">)</span>&nbsp;<span class="op" id="3102089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102093">return</span>&nbsp;<span class="builtintype" id="3102100">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102110">for</span>&nbsp;<span class="ident" id="3102114">i</span>&nbsp;<span class="op" id="3102116">:=</span>&nbsp;<span class="num" id="3102119">0</span><span class="op" id="3102120">;</span>&nbsp;<span class="ident" id="3102122">i</span>&nbsp;<span class="op" id="3102124">&lt;</span>&nbsp;<span class="ident" id="3102126">l</span><span class="op" id="3102127">;</span>&nbsp;<span class="ident" id="3102129">i</span><span class="op" id="3102130">++</span>&nbsp;<span class="op" id="3102133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102137">if</span>&nbsp;<span class="ident" id="3102140">nn</span><span class="op" id="3102142">[</span><span class="ident" id="3102143">i</span><span class="op" id="3102144">]</span><span class="op" id="3102145">&amp;</span><span class="ident" id="3102146">m</span><span class="op" id="3102147">[</span><span class="ident" id="3102148">i</span><span class="op" id="3102149">]</span>&nbsp;<span class="op" id="3102151">!=</span>&nbsp;<span class="ident" id="3102154">ip</span><span class="op" id="3102156">[</span><span class="ident" id="3102157">i</span><span class="op" id="3102158">]</span><span class="op" id="3102159">&amp;</span><span class="ident" id="3102160">m</span><span class="op" id="3102161">[</span><span class="ident" id="3102162">i</span><span class="op" id="3102163">]</span>&nbsp;<span class="op" id="3102165">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102170">return</span>&nbsp;<span class="builtintype" id="3102177">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102191">return</span>&nbsp;<span class="builtintype" id="3102198">true</span><br>
<span class="lineno"></span><span class="op" id="3102203">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="3102206">//&nbsp;Network&nbsp;returns&nbsp;the&nbsp;address&#39;s&nbsp;network&nbsp;name,&nbsp;&#34;ip+net&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3102263">func</span>&nbsp;<span class="op" id="3102268">(</span><span class="ident" id="3102269">n</span>&nbsp;<span class="op" id="3102271">*</span><span class="ident" id="3102272">IPNet</span><span class="op" id="3102277">)</span>&nbsp;<span class="ident" id="3102279">Network</span><span class="op" id="3102286">(</span><span class="op" id="3102287">)</span>&nbsp;<span class="builtintype" id="3102289">string</span>&nbsp;<span class="op" id="3102296">{</span>&nbsp;<span class="keyword" id="3102298">return</span>&nbsp;<span class="string" id="3102305">&#34;ip+net&#34;</span>&nbsp;<span class="op" id="3102314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3102317">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;CIDR&nbsp;notation&nbsp;of&nbsp;n&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;</span><br>
<span class="lineno">480</span><span class="comment" id="3102382">//&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3102441">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form,&nbsp;it&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3102501">//&nbsp;string&nbsp;which&nbsp;consists&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,&nbsp;followed&nbsp;by&nbsp;a&nbsp;slash</span><br>
<span class="lineno"></span><span class="comment" id="3102564">//&nbsp;character&nbsp;and&nbsp;a&nbsp;mask&nbsp;expressed&nbsp;as&nbsp;hexadecimal&nbsp;form&nbsp;with&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3102626">//&nbsp;punctuation&nbsp;like&nbsp;&#34;192.168.100.1/c000ff00&#34;.</span><br>
<span class="lineno">485</span><span class="keyword" id="3102672">func</span>&nbsp;<span class="op" id="3102677">(</span><span class="ident" id="3102678">n</span>&nbsp;<span class="op" id="3102680">*</span><span class="ident" id="3102681">IPNet</span><span class="op" id="3102686">)</span>&nbsp;<span class="ident" id="3102688">String</span><span class="op" id="3102694">(</span><span class="op" id="3102695">)</span>&nbsp;<span class="builtintype" id="3102697">string</span>&nbsp;<span class="op" id="3102704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102707">nn</span><span class="op" id="3102709">,</span>&nbsp;<span class="ident" id="3102711">m</span>&nbsp;<span class="op" id="3102713">:=</span>&nbsp;<span class="ident" id="3102716">networkNumberAndMask</span><span class="op" id="3102736">(</span><span class="ident" id="3102737">n</span><span class="op" id="3102738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102741">if</span>&nbsp;<span class="ident" id="3102744">nn</span>&nbsp;<span class="op" id="3102747">==</span>&nbsp;<span class="ident" id="3102750">nil</span>&nbsp;<span class="op" id="3102754">||</span>&nbsp;<span class="ident" id="3102757">m</span>&nbsp;<span class="op" id="3102759">==</span>&nbsp;<span class="ident" id="3102762">nil</span>&nbsp;<span class="op" id="3102766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102770">return</span>&nbsp;<span class="string" id="3102777">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102786">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3102789">l</span>&nbsp;<span class="op" id="3102791">:=</span>&nbsp;<span class="ident" id="3102794">simpleMaskLength</span><span class="op" id="3102810">(</span><span class="ident" id="3102811">m</span><span class="op" id="3102812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102815">if</span>&nbsp;<span class="ident" id="3102818">l</span>&nbsp;<span class="op" id="3102820">==</span>&nbsp;<span class="op" id="3102823">-</span><span class="num" id="3102824">1</span>&nbsp;<span class="op" id="3102826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102830">return</span>&nbsp;<span class="ident" id="3102837">nn</span><span class="op" id="3102839">.</span><span class="ident" id="3102840">String</span><span class="op" id="3102846">(</span><span class="op" id="3102847">)</span>&nbsp;<span class="op" id="3102849">+</span>&nbsp;<span class="string" id="3102851">&#34;/&#34;</span>&nbsp;<span class="op" id="3102855">+</span>&nbsp;<span class="ident" id="3102857">m</span><span class="op" id="3102858">.</span><span class="ident" id="3102859">String</span><span class="op" id="3102865">(</span><span class="op" id="3102866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3102869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102872">return</span>&nbsp;<span class="ident" id="3102879">nn</span><span class="op" id="3102881">.</span><span class="ident" id="3102882">String</span><span class="op" id="3102888">(</span><span class="op" id="3102889">)</span>&nbsp;<span class="op" id="3102891">+</span>&nbsp;<span class="string" id="3102893">&#34;/&#34;</span>&nbsp;<span class="op" id="3102897">+</span>&nbsp;<span class="ident" id="3102899">itod</span><span class="op" id="3102903">(</span><span class="builtintype" id="3102904">uint</span><span class="op" id="3102908">(</span><span class="ident" id="3102909">l</span><span class="op" id="3102910">)</span><span class="op" id="3102911">)</span><br>
<span class="lineno">495</span><span class="op" id="3102913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3102916">//&nbsp;Parse&nbsp;IPv4&nbsp;address&nbsp;(d.d.d.d).</span><br>
<span class="lineno"></span><span class="keyword" id="3102949">func</span>&nbsp;<span class="ident" id="3102954">parseIPv4</span><span class="op" id="3102963">(</span><span class="ident" id="3102964">s</span>&nbsp;<span class="builtintype" id="3102966">string</span><span class="op" id="3102972">)</span>&nbsp;<span class="ident" id="3102974">IP</span>&nbsp;<span class="op" id="3102977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3102980">var</span>&nbsp;<span class="ident" id="3102984">p</span>&nbsp;<span class="op" id="3102986">[</span><span class="ident" id="3102987">IPv4len</span><span class="op" id="3102994">]</span><span class="builtintype" id="3102995">byte</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103001">i</span>&nbsp;<span class="op" id="3103003">:=</span>&nbsp;<span class="num" id="3103006">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103009">for</span>&nbsp;<span class="ident" id="3103013">j</span>&nbsp;<span class="op" id="3103015">:=</span>&nbsp;<span class="num" id="3103018">0</span><span class="op" id="3103019">;</span>&nbsp;<span class="ident" id="3103021">j</span>&nbsp;<span class="op" id="3103023">&lt;</span>&nbsp;<span class="ident" id="3103025">IPv4len</span><span class="op" id="3103032">;</span>&nbsp;<span class="ident" id="3103034">j</span><span class="op" id="3103035">++</span>&nbsp;<span class="op" id="3103038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103042">if</span>&nbsp;<span class="ident" id="3103045">i</span>&nbsp;<span class="op" id="3103047">&gt;=</span>&nbsp;<span class="builtinfunc" id="3103050">len</span><span class="op" id="3103053">(</span><span class="ident" id="3103054">s</span><span class="op" id="3103055">)</span>&nbsp;<span class="op" id="3103057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103062">//&nbsp;Missing&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103084">return</span>&nbsp;<span class="ident" id="3103091">nil</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103101">if</span>&nbsp;<span class="ident" id="3103104">j</span>&nbsp;<span class="op" id="3103106">&gt;</span>&nbsp;<span class="num" id="3103108">0</span>&nbsp;<span class="op" id="3103110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103115">if</span>&nbsp;<span class="ident" id="3103118">s</span><span class="op" id="3103119">[</span><span class="ident" id="3103120">i</span><span class="op" id="3103121">]</span>&nbsp;<span class="op" id="3103123">!=</span>&nbsp;<span class="string" id="3103126">&#39;.&#39;</span>&nbsp;<span class="op" id="3103130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103136">return</span>&nbsp;<span class="ident" id="3103143">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103150">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103155">i</span><span class="op" id="3103156">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103165">var</span>&nbsp;<span class="op" id="3103169">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103174">n</span>&nbsp;&nbsp;<span class="builtintype" id="3103177">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103184">ok</span>&nbsp;<span class="builtintype" id="3103187">bool</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103198">n</span><span class="op" id="3103199">,</span>&nbsp;<span class="ident" id="3103201">i</span><span class="op" id="3103202">,</span>&nbsp;<span class="ident" id="3103204">ok</span>&nbsp;<span class="op" id="3103207">=</span>&nbsp;<span class="ident" id="3103209">dtoi</span><span class="op" id="3103213">(</span><span class="ident" id="3103214">s</span><span class="op" id="3103215">,</span>&nbsp;<span class="ident" id="3103217">i</span><span class="op" id="3103218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103222">if</span>&nbsp;<span class="op" id="3103225">!</span><span class="ident" id="3103226">ok</span>&nbsp;<span class="op" id="3103229">||</span>&nbsp;<span class="ident" id="3103232">n</span>&nbsp;<span class="op" id="3103234">&gt;</span>&nbsp;<span class="num" id="3103236">0xFF</span>&nbsp;<span class="op" id="3103241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103246">return</span>&nbsp;<span class="ident" id="3103253">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103259">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103263">p</span><span class="op" id="3103264">[</span><span class="ident" id="3103265">j</span><span class="op" id="3103266">]</span>&nbsp;<span class="op" id="3103268">=</span>&nbsp;<span class="builtintype" id="3103270">byte</span><span class="op" id="3103274">(</span><span class="ident" id="3103275">n</span><span class="op" id="3103276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103282">if</span>&nbsp;<span class="ident" id="3103285">i</span>&nbsp;<span class="op" id="3103287">!=</span>&nbsp;<span class="builtinfunc" id="3103290">len</span><span class="op" id="3103293">(</span><span class="ident" id="3103294">s</span><span class="op" id="3103295">)</span>&nbsp;<span class="op" id="3103297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103301">return</span>&nbsp;<span class="ident" id="3103308">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103313">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103316">return</span>&nbsp;<span class="ident" id="3103323">IPv4</span><span class="op" id="3103327">(</span><span class="ident" id="3103328">p</span><span class="op" id="3103329">[</span><span class="num" id="3103330">0</span><span class="op" id="3103331">]</span><span class="op" id="3103332">,</span>&nbsp;<span class="ident" id="3103334">p</span><span class="op" id="3103335">[</span><span class="num" id="3103336">1</span><span class="op" id="3103337">]</span><span class="op" id="3103338">,</span>&nbsp;<span class="ident" id="3103340">p</span><span class="op" id="3103341">[</span><span class="num" id="3103342">2</span><span class="op" id="3103343">]</span><span class="op" id="3103344">,</span>&nbsp;<span class="ident" id="3103346">p</span><span class="op" id="3103347">[</span><span class="num" id="3103348">3</span><span class="op" id="3103349">]</span><span class="op" id="3103350">)</span><br>
<span class="lineno"></span><span class="op" id="3103352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3103355">//&nbsp;parseIPv6&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;literal&nbsp;IPv6&nbsp;address&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4291</span><br>
<span class="lineno"></span><span class="comment" id="3103425">//&nbsp;and&nbsp;RFC&nbsp;5952.&nbsp;&nbsp;It&nbsp;can&nbsp;also&nbsp;parse&nbsp;a&nbsp;literal&nbsp;scoped&nbsp;IPv6&nbsp;address&nbsp;with</span><br>
<span class="lineno">530</span><span class="comment" id="3103496">//&nbsp;zone&nbsp;identifier&nbsp;which&nbsp;is&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4007&nbsp;when&nbsp;zoneAllowed&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3103566">//&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3103575">func</span>&nbsp;<span class="ident" id="3103580">parseIPv6</span><span class="op" id="3103589">(</span><span class="ident" id="3103590">s</span>&nbsp;<span class="builtintype" id="3103592">string</span><span class="op" id="3103598">,</span>&nbsp;<span class="ident" id="3103600">zoneAllowed</span>&nbsp;<span class="builtintype" id="3103612">bool</span><span class="op" id="3103616">)</span>&nbsp;<span class="op" id="3103618">(</span><span class="ident" id="3103619">ip</span>&nbsp;<span class="ident" id="3103622">IP</span><span class="op" id="3103624">,</span>&nbsp;<span class="ident" id="3103626">zone</span>&nbsp;<span class="builtintype" id="3103631">string</span><span class="op" id="3103637">)</span>&nbsp;<span class="op" id="3103639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103642">ip</span>&nbsp;<span class="op" id="3103645">=</span>&nbsp;<span class="builtinfunc" id="3103647">make</span><span class="op" id="3103651">(</span><span class="ident" id="3103652">IP</span><span class="op" id="3103654">,</span>&nbsp;<span class="ident" id="3103656">IPv6len</span><span class="op" id="3103663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103666">ellipsis</span>&nbsp;<span class="op" id="3103675">:=</span>&nbsp;<span class="op" id="3103678">-</span><span class="num" id="3103679">1</span>&nbsp;<span class="comment" id="3103681">//&nbsp;position&nbsp;of&nbsp;ellipsis&nbsp;in&nbsp;p</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103711">i</span>&nbsp;<span class="op" id="3103713">:=</span>&nbsp;<span class="num" id="3103716">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103726">//&nbsp;index&nbsp;in&nbsp;string&nbsp;s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103749">if</span>&nbsp;<span class="ident" id="3103752">zoneAllowed</span>&nbsp;<span class="op" id="3103764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103768">s</span><span class="op" id="3103769">,</span>&nbsp;<span class="ident" id="3103771">zone</span>&nbsp;<span class="op" id="3103776">=</span>&nbsp;<span class="ident" id="3103778">splitHostZone</span><span class="op" id="3103791">(</span><span class="ident" id="3103792">s</span><span class="op" id="3103793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103796">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103800">//&nbsp;Might&nbsp;have&nbsp;leading&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103832">if</span>&nbsp;<span class="builtinfunc" id="3103835">len</span><span class="op" id="3103838">(</span><span class="ident" id="3103839">s</span><span class="op" id="3103840">)</span>&nbsp;<span class="op" id="3103842">&gt;=</span>&nbsp;<span class="num" id="3103845">2</span>&nbsp;<span class="op" id="3103847">&amp;&amp;</span>&nbsp;<span class="ident" id="3103850">s</span><span class="op" id="3103851">[</span><span class="num" id="3103852">0</span><span class="op" id="3103853">]</span>&nbsp;<span class="op" id="3103855">==</span>&nbsp;<span class="string" id="3103858">&#39;:&#39;</span>&nbsp;<span class="op" id="3103862">&amp;&amp;</span>&nbsp;<span class="ident" id="3103865">s</span><span class="op" id="3103866">[</span><span class="num" id="3103867">1</span><span class="op" id="3103868">]</span>&nbsp;<span class="op" id="3103870">==</span>&nbsp;<span class="string" id="3103873">&#39;:&#39;</span>&nbsp;<span class="op" id="3103877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103881">ellipsis</span>&nbsp;<span class="op" id="3103890">=</span>&nbsp;<span class="num" id="3103892">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3103896">i</span>&nbsp;<span class="op" id="3103898">=</span>&nbsp;<span class="num" id="3103900">2</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103904">//&nbsp;Might&nbsp;be&nbsp;only&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103932">if</span>&nbsp;<span class="ident" id="3103935">i</span>&nbsp;<span class="op" id="3103937">==</span>&nbsp;<span class="builtinfunc" id="3103940">len</span><span class="op" id="3103943">(</span><span class="ident" id="3103944">s</span><span class="op" id="3103945">)</span>&nbsp;<span class="op" id="3103947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3103952">return</span>&nbsp;<span class="ident" id="3103959">ip</span><span class="op" id="3103961">,</span>&nbsp;<span class="ident" id="3103963">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3103973">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3103977">//&nbsp;Loop,&nbsp;parsing&nbsp;hex&nbsp;numbers&nbsp;followed&nbsp;by&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104026">j</span>&nbsp;<span class="op" id="3104028">:=</span>&nbsp;<span class="num" id="3104031">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104034">for</span>&nbsp;<span class="ident" id="3104038">j</span>&nbsp;<span class="op" id="3104040">&lt;</span>&nbsp;<span class="ident" id="3104042">IPv6len</span>&nbsp;<span class="op" id="3104050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104054">//&nbsp;Hex&nbsp;number.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104071">n</span><span class="op" id="3104072">,</span>&nbsp;<span class="ident" id="3104074">i1</span><span class="op" id="3104076">,</span>&nbsp;<span class="ident" id="3104078">ok</span>&nbsp;<span class="op" id="3104081">:=</span>&nbsp;<span class="ident" id="3104084">xtoi</span><span class="op" id="3104088">(</span><span class="ident" id="3104089">s</span><span class="op" id="3104090">,</span>&nbsp;<span class="ident" id="3104092">i</span><span class="op" id="3104093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104097">if</span>&nbsp;<span class="op" id="3104100">!</span><span class="ident" id="3104101">ok</span>&nbsp;<span class="op" id="3104104">||</span>&nbsp;<span class="ident" id="3104107">n</span>&nbsp;<span class="op" id="3104109">&gt;</span>&nbsp;<span class="num" id="3104111">0xFFFF</span>&nbsp;<span class="op" id="3104118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104123">return</span>&nbsp;<span class="ident" id="3104130">nil</span><span class="op" id="3104133">,</span>&nbsp;<span class="ident" id="3104135">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104147">//&nbsp;If&nbsp;followed&nbsp;by&nbsp;dot,&nbsp;might&nbsp;be&nbsp;in&nbsp;trailing&nbsp;IPv4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104199">if</span>&nbsp;<span class="ident" id="3104202">i1</span>&nbsp;<span class="op" id="3104205">&lt;</span>&nbsp;<span class="builtinfunc" id="3104207">len</span><span class="op" id="3104210">(</span><span class="ident" id="3104211">s</span><span class="op" id="3104212">)</span>&nbsp;<span class="op" id="3104214">&amp;&amp;</span>&nbsp;<span class="ident" id="3104217">s</span><span class="op" id="3104218">[</span><span class="ident" id="3104219">i1</span><span class="op" id="3104221">]</span>&nbsp;<span class="op" id="3104223">==</span>&nbsp;<span class="string" id="3104226">&#39;.&#39;</span>&nbsp;<span class="op" id="3104230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104235">if</span>&nbsp;<span class="ident" id="3104238">ellipsis</span>&nbsp;<span class="op" id="3104247">&lt;</span>&nbsp;<span class="num" id="3104249">0</span>&nbsp;<span class="op" id="3104251">&amp;&amp;</span>&nbsp;<span class="ident" id="3104254">j</span>&nbsp;<span class="op" id="3104256">!=</span>&nbsp;<span class="ident" id="3104259">IPv6len</span><span class="op" id="3104266">-</span><span class="ident" id="3104267">IPv4len</span>&nbsp;<span class="op" id="3104275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104281">//&nbsp;Not&nbsp;the&nbsp;right&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104309">return</span>&nbsp;<span class="ident" id="3104316">nil</span><span class="op" id="3104319">,</span>&nbsp;<span class="ident" id="3104321">zone</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104334">if</span>&nbsp;<span class="ident" id="3104337">j</span><span class="op" id="3104338">+</span><span class="ident" id="3104339">IPv4len</span>&nbsp;<span class="op" id="3104347">&gt;</span>&nbsp;<span class="ident" id="3104349">IPv6len</span>&nbsp;<span class="op" id="3104357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104363">//&nbsp;Not&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104387">return</span>&nbsp;<span class="ident" id="3104394">nil</span><span class="op" id="3104397">,</span>&nbsp;<span class="ident" id="3104399">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104407">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104412">ip4</span>&nbsp;<span class="op" id="3104416">:=</span>&nbsp;<span class="ident" id="3104419">parseIPv4</span><span class="op" id="3104428">(</span><span class="ident" id="3104429">s</span><span class="op" id="3104430">[</span><span class="ident" id="3104431">i</span><span class="op" id="3104432">:</span><span class="op" id="3104433">]</span><span class="op" id="3104434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104439">if</span>&nbsp;<span class="ident" id="3104442">ip4</span>&nbsp;<span class="op" id="3104446">==</span>&nbsp;<span class="ident" id="3104449">nil</span>&nbsp;<span class="op" id="3104453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104459">return</span>&nbsp;<span class="ident" id="3104466">nil</span><span class="op" id="3104469">,</span>&nbsp;<span class="ident" id="3104471">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104484">ip</span><span class="op" id="3104486">[</span><span class="ident" id="3104487">j</span><span class="op" id="3104488">]</span>&nbsp;<span class="op" id="3104490">=</span>&nbsp;<span class="ident" id="3104492">ip4</span><span class="op" id="3104495">[</span><span class="num" id="3104496">12</span><span class="op" id="3104498">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104503">ip</span><span class="op" id="3104505">[</span><span class="ident" id="3104506">j</span><span class="op" id="3104507">+</span><span class="num" id="3104508">1</span><span class="op" id="3104509">]</span>&nbsp;<span class="op" id="3104511">=</span>&nbsp;<span class="ident" id="3104513">ip4</span><span class="op" id="3104516">[</span><span class="num" id="3104517">13</span><span class="op" id="3104519">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104524">ip</span><span class="op" id="3104526">[</span><span class="ident" id="3104527">j</span><span class="op" id="3104528">+</span><span class="num" id="3104529">2</span><span class="op" id="3104530">]</span>&nbsp;<span class="op" id="3104532">=</span>&nbsp;<span class="ident" id="3104534">ip4</span><span class="op" id="3104537">[</span><span class="num" id="3104538">14</span><span class="op" id="3104540">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104545">ip</span><span class="op" id="3104547">[</span><span class="ident" id="3104548">j</span><span class="op" id="3104549">+</span><span class="num" id="3104550">3</span><span class="op" id="3104551">]</span>&nbsp;<span class="op" id="3104553">=</span>&nbsp;<span class="ident" id="3104555">ip4</span><span class="op" id="3104558">[</span><span class="num" id="3104559">15</span><span class="op" id="3104561">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104566">i</span>&nbsp;<span class="op" id="3104568">=</span>&nbsp;<span class="builtinfunc" id="3104570">len</span><span class="op" id="3104573">(</span><span class="ident" id="3104574">s</span><span class="op" id="3104575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104580">j</span>&nbsp;<span class="op" id="3104582">+=</span>&nbsp;<span class="ident" id="3104585">IPv4len</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104596">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104609">//&nbsp;Save&nbsp;this&nbsp;16-bit&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104638">ip</span><span class="op" id="3104640">[</span><span class="ident" id="3104641">j</span><span class="op" id="3104642">]</span>&nbsp;<span class="op" id="3104644">=</span>&nbsp;<span class="builtintype" id="3104646">byte</span><span class="op" id="3104650">(</span><span class="ident" id="3104651">n</span>&nbsp;<span class="op" id="3104653">&gt;&gt;</span>&nbsp;<span class="num" id="3104656">8</span><span class="op" id="3104657">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104661">ip</span><span class="op" id="3104663">[</span><span class="ident" id="3104664">j</span><span class="op" id="3104665">+</span><span class="num" id="3104666">1</span><span class="op" id="3104667">]</span>&nbsp;<span class="op" id="3104669">=</span>&nbsp;<span class="builtintype" id="3104671">byte</span><span class="op" id="3104675">(</span><span class="ident" id="3104676">n</span><span class="op" id="3104677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104681">j</span>&nbsp;<span class="op" id="3104683">+=</span>&nbsp;<span class="num" id="3104686">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104691">//&nbsp;Stop&nbsp;at&nbsp;end&nbsp;of&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104719">i</span>&nbsp;<span class="op" id="3104721">=</span>&nbsp;<span class="ident" id="3104723">i1</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104728">if</span>&nbsp;<span class="ident" id="3104731">i</span>&nbsp;<span class="op" id="3104733">==</span>&nbsp;<span class="builtinfunc" id="3104736">len</span><span class="op" id="3104739">(</span><span class="ident" id="3104740">s</span><span class="op" id="3104741">)</span>&nbsp;<span class="op" id="3104743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104748">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104761">//&nbsp;Otherwise&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;colon&nbsp;and&nbsp;more.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104812">if</span>&nbsp;<span class="ident" id="3104815">s</span><span class="op" id="3104816">[</span><span class="ident" id="3104817">i</span><span class="op" id="3104818">]</span>&nbsp;<span class="op" id="3104820">!=</span>&nbsp;<span class="string" id="3104823">&#39;:&#39;</span>&nbsp;<span class="op" id="3104827">||</span>&nbsp;<span class="ident" id="3104830">i</span><span class="op" id="3104831">+</span><span class="num" id="3104832">1</span>&nbsp;<span class="op" id="3104834">==</span>&nbsp;<span class="builtinfunc" id="3104837">len</span><span class="op" id="3104840">(</span><span class="ident" id="3104841">s</span><span class="op" id="3104842">)</span>&nbsp;<span class="op" id="3104844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104849">return</span>&nbsp;<span class="ident" id="3104856">nil</span><span class="op" id="3104859">,</span>&nbsp;<span class="ident" id="3104861">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104872">i</span><span class="op" id="3104873">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3104879">//&nbsp;Look&nbsp;for&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104903">if</span>&nbsp;<span class="ident" id="3104906">s</span><span class="op" id="3104907">[</span><span class="ident" id="3104908">i</span><span class="op" id="3104909">]</span>&nbsp;<span class="op" id="3104911">==</span>&nbsp;<span class="string" id="3104914">&#39;:&#39;</span>&nbsp;<span class="op" id="3104918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104923">if</span>&nbsp;<span class="ident" id="3104926">ellipsis</span>&nbsp;<span class="op" id="3104935">&gt;=</span>&nbsp;<span class="num" id="3104938">0</span>&nbsp;<span class="op" id="3104940">{</span>&nbsp;<span class="comment" id="3104942">//&nbsp;already&nbsp;have&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3104966">return</span>&nbsp;<span class="ident" id="3104973">nil</span><span class="op" id="3104976">,</span>&nbsp;<span class="ident" id="3104978">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3104986">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3104991">ellipsis</span>&nbsp;<span class="op" id="3105000">=</span>&nbsp;<span class="ident" id="3105002">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105007">if</span>&nbsp;<span class="ident" id="3105010">i</span><span class="op" id="3105011">++</span><span class="op" id="3105013">;</span>&nbsp;<span class="ident" id="3105015">i</span>&nbsp;<span class="op" id="3105017">==</span>&nbsp;<span class="builtinfunc" id="3105020">len</span><span class="op" id="3105023">(</span><span class="ident" id="3105024">s</span><span class="op" id="3105025">)</span>&nbsp;<span class="op" id="3105027">{</span>&nbsp;<span class="comment" id="3105029">//&nbsp;can&nbsp;be&nbsp;at&nbsp;end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105050">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105063">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3105070">//&nbsp;Must&nbsp;have&nbsp;used&nbsp;entire&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105104">if</span>&nbsp;<span class="ident" id="3105107">i</span>&nbsp;<span class="op" id="3105109">!=</span>&nbsp;<span class="builtinfunc" id="3105112">len</span><span class="op" id="3105115">(</span><span class="ident" id="3105116">s</span><span class="op" id="3105117">)</span>&nbsp;<span class="op" id="3105119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105123">return</span>&nbsp;<span class="ident" id="3105130">nil</span><span class="op" id="3105133">,</span>&nbsp;<span class="ident" id="3105135">zone</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3105145">//&nbsp;If&nbsp;didn&#39;t&nbsp;parse&nbsp;enough,&nbsp;expand&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105190">if</span>&nbsp;<span class="ident" id="3105193">j</span>&nbsp;<span class="op" id="3105195">&lt;</span>&nbsp;<span class="ident" id="3105197">IPv6len</span>&nbsp;<span class="op" id="3105205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105209">if</span>&nbsp;<span class="ident" id="3105212">ellipsis</span>&nbsp;<span class="op" id="3105221">&lt;</span>&nbsp;<span class="num" id="3105223">0</span>&nbsp;<span class="op" id="3105225">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105230">return</span>&nbsp;<span class="ident" id="3105237">nil</span><span class="op" id="3105240">,</span>&nbsp;<span class="ident" id="3105242">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105253">n</span>&nbsp;<span class="op" id="3105255">:=</span>&nbsp;<span class="ident" id="3105258">IPv6len</span>&nbsp;<span class="op" id="3105266">-</span>&nbsp;<span class="ident" id="3105268">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105272">for</span>&nbsp;<span class="ident" id="3105276">k</span>&nbsp;<span class="op" id="3105278">:=</span>&nbsp;<span class="ident" id="3105281">j</span>&nbsp;<span class="op" id="3105283">-</span>&nbsp;<span class="num" id="3105285">1</span><span class="op" id="3105286">;</span>&nbsp;<span class="ident" id="3105288">k</span>&nbsp;<span class="op" id="3105290">&gt;=</span>&nbsp;<span class="ident" id="3105293">ellipsis</span><span class="op" id="3105301">;</span>&nbsp;<span class="ident" id="3105303">k</span><span class="op" id="3105304">--</span>&nbsp;<span class="op" id="3105307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105312">ip</span><span class="op" id="3105314">[</span><span class="ident" id="3105315">k</span><span class="op" id="3105316">+</span><span class="ident" id="3105317">n</span><span class="op" id="3105318">]</span>&nbsp;<span class="op" id="3105320">=</span>&nbsp;<span class="ident" id="3105322">ip</span><span class="op" id="3105324">[</span><span class="ident" id="3105325">k</span><span class="op" id="3105326">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105334">for</span>&nbsp;<span class="ident" id="3105338">k</span>&nbsp;<span class="op" id="3105340">:=</span>&nbsp;<span class="ident" id="3105343">ellipsis</span>&nbsp;<span class="op" id="3105352">+</span>&nbsp;<span class="ident" id="3105354">n</span>&nbsp;<span class="op" id="3105356">-</span>&nbsp;<span class="num" id="3105358">1</span><span class="op" id="3105359">;</span>&nbsp;<span class="ident" id="3105361">k</span>&nbsp;<span class="op" id="3105363">&gt;=</span>&nbsp;<span class="ident" id="3105366">ellipsis</span><span class="op" id="3105374">;</span>&nbsp;<span class="ident" id="3105376">k</span><span class="op" id="3105377">--</span>&nbsp;<span class="op" id="3105380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105385">ip</span><span class="op" id="3105387">[</span><span class="ident" id="3105388">k</span><span class="op" id="3105389">]</span>&nbsp;<span class="op" id="3105391">=</span>&nbsp;<span class="num" id="3105393">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105400">}</span>&nbsp;<span class="keyword" id="3105402">else</span>&nbsp;<span class="keyword" id="3105407">if</span>&nbsp;<span class="ident" id="3105410">ellipsis</span>&nbsp;<span class="op" id="3105419">&gt;=</span>&nbsp;<span class="num" id="3105422">0</span>&nbsp;<span class="op" id="3105424">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3105428">//&nbsp;Ellipsis&nbsp;must&nbsp;represent&nbsp;at&nbsp;least&nbsp;one&nbsp;0&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105479">return</span>&nbsp;<span class="ident" id="3105486">nil</span><span class="op" id="3105489">,</span>&nbsp;<span class="ident" id="3105491">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3105497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105500">return</span>&nbsp;<span class="ident" id="3105507">ip</span><span class="op" id="3105509">,</span>&nbsp;<span class="ident" id="3105511">zone</span><br>
<span class="lineno"></span><span class="op" id="3105516">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="3105519">//&nbsp;A&nbsp;ParseError&nbsp;represents&nbsp;a&nbsp;malformed&nbsp;text&nbsp;string&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;string&nbsp;that&nbsp;was&nbsp;expected.</span><br>
<span class="lineno"></span><span class="keyword" id="3105612">type</span>&nbsp;<span class="ident" id="3105617">ParseError</span>&nbsp;<span class="keyword" id="3105628">struct</span>&nbsp;<span class="op" id="3105635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105638">Type</span>&nbsp;<span class="builtintype" id="3105643">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3105651">Text</span>&nbsp;<span class="builtintype" id="3105656">string</span><br>
<span class="lineno">640</span><span class="op" id="3105663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3105666">func</span>&nbsp;<span class="op" id="3105671">(</span><span class="ident" id="3105672">e</span>&nbsp;<span class="op" id="3105674">*</span><span class="ident" id="3105675">ParseError</span><span class="op" id="3105685">)</span>&nbsp;<span class="ident" id="3105687">Error</span><span class="op" id="3105692">(</span><span class="op" id="3105693">)</span>&nbsp;<span class="builtintype" id="3105695">string</span>&nbsp;<span class="op" id="3105702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3105705">return</span>&nbsp;<span class="string" id="3105712">&#34;invalid&nbsp;&#34;</span>&nbsp;<span class="op" id="3105723">+</span>&nbsp;<span class="ident" id="3105725">e</span><span class="op" id="3105726">.</span><span class="ident" id="3105727">Type</span>&nbsp;<span class="op" id="3105732">+</span>&nbsp;<span class="string" id="3105734">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3105739">+</span>&nbsp;<span class="ident" id="3105741">e</span><span class="op" id="3105742">.</span><span class="ident" id="3105743">Text</span><br>
<span class="lineno"></span><span class="op" id="3105748">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment" id="3105751">//&nbsp;ParseIP&nbsp;parses&nbsp;s&nbsp;as&nbsp;an&nbsp;IP&nbsp;address,&nbsp;returning&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="3105811">//&nbsp;The&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;in&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3105869">//&nbsp;or&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;)&nbsp;form.</span><br>
<span class="lineno"></span><span class="comment" id="3105911">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;textual&nbsp;representation&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno">650</span><span class="comment" id="3105975">//&nbsp;ParseIP&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3105999">func</span>&nbsp;<span class="ident" id="3106004">ParseIP</span><span class="op" id="3106011">(</span><span class="ident" id="3106012">s</span>&nbsp;<span class="builtintype" id="3106014">string</span><span class="op" id="3106020">)</span>&nbsp;<span class="ident" id="3106022">IP</span>&nbsp;<span class="op" id="3106025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106028">for</span>&nbsp;<span class="ident" id="3106032">i</span>&nbsp;<span class="op" id="3106034">:=</span>&nbsp;<span class="num" id="3106037">0</span><span class="op" id="3106038">;</span>&nbsp;<span class="ident" id="3106040">i</span>&nbsp;<span class="op" id="3106042">&lt;</span>&nbsp;<span class="builtinfunc" id="3106044">len</span><span class="op" id="3106047">(</span><span class="ident" id="3106048">s</span><span class="op" id="3106049">)</span><span class="op" id="3106050">;</span>&nbsp;<span class="ident" id="3106052">i</span><span class="op" id="3106053">++</span>&nbsp;<span class="op" id="3106056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106060">switch</span>&nbsp;<span class="ident" id="3106067">s</span><span class="op" id="3106068">[</span><span class="ident" id="3106069">i</span><span class="op" id="3106070">]</span>&nbsp;<span class="op" id="3106072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106076">case</span>&nbsp;<span class="string" id="3106081">&#39;.&#39;</span><span class="op" id="3106084">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106089">return</span>&nbsp;<span class="ident" id="3106096">parseIPv4</span><span class="op" id="3106105">(</span><span class="ident" id="3106106">s</span><span class="op" id="3106107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106111">case</span>&nbsp;<span class="string" id="3106116">&#39;:&#39;</span><span class="op" id="3106119">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106124">ip</span><span class="op" id="3106126">,</span>&nbsp;<span class="ident" id="3106128">_</span>&nbsp;<span class="op" id="3106130">:=</span>&nbsp;<span class="ident" id="3106133">parseIPv6</span><span class="op" id="3106142">(</span><span class="ident" id="3106143">s</span><span class="op" id="3106144">,</span>&nbsp;<span class="builtintype" id="3106146">false</span><span class="op" id="3106151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106156">return</span>&nbsp;<span class="ident" id="3106163">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106168">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106174">return</span>&nbsp;<span class="ident" id="3106181">nil</span><br>
<span class="lineno"></span><span class="op" id="3106185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3106188">//&nbsp;ParseCIDR&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;CIDR&nbsp;notation&nbsp;IP&nbsp;address&nbsp;and&nbsp;mask,</span><br>
<span class="lineno">665</span><span class="comment" id="3106250">//&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3106311">//&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3106337">//</span><br>
<span class="lineno"></span><span class="comment" id="3106340">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;and&nbsp;the&nbsp;network&nbsp;implied&nbsp;by&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="3106403">//&nbsp;and&nbsp;mask.&nbsp;&nbsp;For&nbsp;example,&nbsp;ParseCIDR(&#34;192.168.100.1/16&#34;)&nbsp;returns</span><br>
<span class="lineno">670</span><span class="comment" id="3106468">//&nbsp;the&nbsp;IP&nbsp;address&nbsp;192.168.100.1&nbsp;and&nbsp;the&nbsp;network&nbsp;192.168.0.0/16.</span><br>
<span class="lineno"></span><span class="keyword" id="3106532">func</span>&nbsp;<span class="ident" id="3106537">ParseCIDR</span><span class="op" id="3106546">(</span><span class="ident" id="3106547">s</span>&nbsp;<span class="builtintype" id="3106549">string</span><span class="op" id="3106555">)</span>&nbsp;<span class="op" id="3106557">(</span><span class="ident" id="3106558">IP</span><span class="op" id="3106560">,</span>&nbsp;<span class="op" id="3106562">*</span><span class="ident" id="3106563">IPNet</span><span class="op" id="3106568">,</span>&nbsp;<span class="builtintype" id="3106570">error</span><span class="op" id="3106575">)</span>&nbsp;<span class="op" id="3106577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106580">i</span>&nbsp;<span class="op" id="3106582">:=</span>&nbsp;<span class="ident" id="3106585">byteIndex</span><span class="op" id="3106594">(</span><span class="ident" id="3106595">s</span><span class="op" id="3106596">,</span>&nbsp;<span class="string" id="3106598">&#39;/&#39;</span><span class="op" id="3106601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106604">if</span>&nbsp;<span class="ident" id="3106607">i</span>&nbsp;<span class="op" id="3106609">&lt;</span>&nbsp;<span class="num" id="3106611">0</span>&nbsp;<span class="op" id="3106613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106617">return</span>&nbsp;<span class="ident" id="3106624">nil</span><span class="op" id="3106627">,</span>&nbsp;<span class="ident" id="3106629">nil</span><span class="op" id="3106632">,</span>&nbsp;<span class="op" id="3106634">&amp;</span><span class="ident" id="3106635">ParseError</span><span class="op" id="3106645">{</span><span class="string" id="3106646">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3106660">,</span>&nbsp;<span class="ident" id="3106662">s</span><span class="op" id="3106663">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106669">addr</span><span class="op" id="3106673">,</span>&nbsp;<span class="ident" id="3106675">mask</span>&nbsp;<span class="op" id="3106680">:=</span>&nbsp;<span class="ident" id="3106683">s</span><span class="op" id="3106684">[</span><span class="op" id="3106685">:</span><span class="ident" id="3106686">i</span><span class="op" id="3106687">]</span><span class="op" id="3106688">,</span>&nbsp;<span class="ident" id="3106690">s</span><span class="op" id="3106691">[</span><span class="ident" id="3106692">i</span><span class="op" id="3106693">+</span><span class="num" id="3106694">1</span><span class="op" id="3106695">:</span><span class="op" id="3106696">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106699">iplen</span>&nbsp;<span class="op" id="3106705">:=</span>&nbsp;<span class="ident" id="3106708">IPv4len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106717">ip</span>&nbsp;<span class="op" id="3106720">:=</span>&nbsp;<span class="ident" id="3106723">parseIPv4</span><span class="op" id="3106732">(</span><span class="ident" id="3106733">addr</span><span class="op" id="3106737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106740">if</span>&nbsp;<span class="ident" id="3106743">ip</span>&nbsp;<span class="op" id="3106746">==</span>&nbsp;<span class="ident" id="3106749">nil</span>&nbsp;<span class="op" id="3106753">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106757">iplen</span>&nbsp;<span class="op" id="3106763">=</span>&nbsp;<span class="ident" id="3106765">IPv6len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106775">ip</span><span class="op" id="3106777">,</span>&nbsp;<span class="ident" id="3106779">_</span>&nbsp;<span class="op" id="3106781">=</span>&nbsp;<span class="ident" id="3106783">parseIPv6</span><span class="op" id="3106792">(</span><span class="ident" id="3106793">addr</span><span class="op" id="3106797">,</span>&nbsp;<span class="builtintype" id="3106799">false</span><span class="op" id="3106804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106810">n</span><span class="op" id="3106811">,</span>&nbsp;<span class="ident" id="3106813">i</span><span class="op" id="3106814">,</span>&nbsp;<span class="ident" id="3106816">ok</span>&nbsp;<span class="op" id="3106819">:=</span>&nbsp;<span class="ident" id="3106822">dtoi</span><span class="op" id="3106826">(</span><span class="ident" id="3106827">mask</span><span class="op" id="3106831">,</span>&nbsp;<span class="num" id="3106833">0</span><span class="op" id="3106834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106837">if</span>&nbsp;<span class="ident" id="3106840">ip</span>&nbsp;<span class="op" id="3106843">==</span>&nbsp;<span class="ident" id="3106846">nil</span>&nbsp;<span class="op" id="3106850">||</span>&nbsp;<span class="op" id="3106853">!</span><span class="ident" id="3106854">ok</span>&nbsp;<span class="op" id="3106857">||</span>&nbsp;<span class="ident" id="3106860">i</span>&nbsp;<span class="op" id="3106862">!=</span>&nbsp;<span class="builtinfunc" id="3106865">len</span><span class="op" id="3106868">(</span><span class="ident" id="3106869">mask</span><span class="op" id="3106873">)</span>&nbsp;<span class="op" id="3106875">||</span>&nbsp;<span class="ident" id="3106878">n</span>&nbsp;<span class="op" id="3106880">&lt;</span>&nbsp;<span class="num" id="3106882">0</span>&nbsp;<span class="op" id="3106884">||</span>&nbsp;<span class="ident" id="3106887">n</span>&nbsp;<span class="op" id="3106889">&gt;</span>&nbsp;<span class="num" id="3106891">8</span><span class="op" id="3106892">*</span><span class="ident" id="3106893">iplen</span>&nbsp;<span class="op" id="3106899">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106903">return</span>&nbsp;<span class="ident" id="3106910">nil</span><span class="op" id="3106913">,</span>&nbsp;<span class="ident" id="3106915">nil</span><span class="op" id="3106918">,</span>&nbsp;<span class="op" id="3106920">&amp;</span><span class="ident" id="3106921">ParseError</span><span class="op" id="3106931">{</span><span class="string" id="3106932">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3106946">,</span>&nbsp;<span class="ident" id="3106948">s</span><span class="op" id="3106949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3106952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3106955">m</span>&nbsp;<span class="op" id="3106957">:=</span>&nbsp;<span class="ident" id="3106960">CIDRMask</span><span class="op" id="3106968">(</span><span class="ident" id="3106969">n</span><span class="op" id="3106970">,</span>&nbsp;<span class="num" id="3106972">8</span><span class="op" id="3106973">*</span><span class="ident" id="3106974">iplen</span><span class="op" id="3106979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3106982">return</span>&nbsp;<span class="ident" id="3106989">ip</span><span class="op" id="3106991">,</span>&nbsp;<span class="op" id="3106993">&amp;</span><span class="ident" id="3106994">IPNet</span><span class="op" id="3106999">{</span><span class="ident" id="3107000">IP</span><span class="op" id="3107002">:</span>&nbsp;<span class="ident" id="3107004">ip</span><span class="op" id="3107006">.</span><span class="ident" id="3107007">Mask</span><span class="op" id="3107011">(</span><span class="ident" id="3107012">m</span><span class="op" id="3107013">)</span><span class="op" id="3107014">,</span>&nbsp;<span class="ident" id="3107016">Mask</span><span class="op" id="3107020">:</span>&nbsp;<span class="ident" id="3107022">m</span><span class="op" id="3107023">}</span><span class="op" id="3107024">,</span>&nbsp;<span class="ident" id="3107026">nil</span><br>
<span class="lineno"></span><span class="op" id="3107030">}</span>
</div>
</body>
</html>
