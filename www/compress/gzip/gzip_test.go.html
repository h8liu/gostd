<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8555724">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8555779">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8555833">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8555884">package</span>&nbsp;<span class="ident" id="8555892">gzip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8555898">import</span>&nbsp;<span class="op" id="8555905">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8555908">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8555917">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8555926">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8555939">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8555950">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8555957">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="8555960">//&nbsp;TestEmpty&nbsp;tests&nbsp;that&nbsp;an&nbsp;empty&nbsp;payload&nbsp;still&nbsp;forms&nbsp;a&nbsp;valid&nbsp;GZIP&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="8556034">func</span>&nbsp;<span class="ident" id="8556039">TestEmpty</span><span class="op" id="8556048">(</span><span class="ident" id="8556049">t</span>&nbsp;<span class="op" id="8556051">*</span><span class="ident" id="8556052"><a href="/compress/gzip/gzip_test.go.html#8555939">testing</a></span><span class="op" id="8556059">.</span><span class="ident" id="8556060">T</span><span class="op" id="8556061">)</span>&nbsp;<span class="op" id="8556063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556066">buf</span>&nbsp;<span class="op" id="8556070">:=</span>&nbsp;<span class="builtinfunc" id="8556073">new</span><span class="op" id="8556076">(</span><span class="ident" id="8556077"><a href="/compress/gzip/gzip_test.go.html#8555917">bytes</a></span><span class="op" id="8556082">.</span><span class="ident" id="8556083">Buffer</span><span class="op" id="8556089">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556093">if</span>&nbsp;<span class="ident" id="8556096">err</span>&nbsp;<span class="op" id="8556100">:=</span>&nbsp;<span class="ident" id="8556103"><a href="/compress/gzip/gzip.go.html#4546176">NewWriter</a></span><span class="op" id="8556112">(</span><span class="ident" id="8556113"><a href="/compress/gzip/gzip_test.go.html#8556066">buf</a></span><span class="op" id="8556116">)</span><span class="op" id="8556117">.</span><span class="ident" id="8556118">Close</span><span class="op" id="8556123">(</span><span class="op" id="8556124">)</span><span class="op" id="8556125">;</span>&nbsp;<span class="ident" id="8556127"><a href="/compress/gzip/gzip_test.go.html#8556096">err</a></span>&nbsp;<span class="op" id="8556131">!=</span>&nbsp;<span class="ident" id="8556134">nil</span>&nbsp;<span class="op" id="8556138">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556142"><a href="/compress/gzip/gzip_test.go.html#8556049">t</a></span><span class="op" id="8556143">.</span><span class="ident" id="8556144">Fatalf</span><span class="op" id="8556150">(</span><span class="string" id="8556151">&#34;Writer.Close:&nbsp;%v&#34;</span><span class="op" id="8556169">,</span>&nbsp;<span class="ident" id="8556171"><a href="/compress/gzip/gzip_test.go.html#8556096">err</a></span><span class="op" id="8556174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8556177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556181">r</span><span class="op" id="8556182">,</span>&nbsp;<span class="ident" id="8556184">err</span>&nbsp;<span class="op" id="8556188">:=</span>&nbsp;<span class="ident" id="8556191"><a href="/compress/gzip/gunzip.go.html#4539946">NewReader</a></span><span class="op" id="8556200">(</span><span class="ident" id="8556201"><a href="/compress/gzip/gzip_test.go.html#8556066">buf</a></span><span class="op" id="8556204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556207">if</span>&nbsp;<span class="ident" id="8556210"><a href="/compress/gzip/gzip_test.go.html#8556184">err</a></span>&nbsp;<span class="op" id="8556214">!=</span>&nbsp;<span class="ident" id="8556217">nil</span>&nbsp;<span class="op" id="8556221">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556225"><a href="/compress/gzip/gzip_test.go.html#8556049">t</a></span><span class="op" id="8556226">.</span><span class="ident" id="8556227">Fatalf</span><span class="op" id="8556233">(</span><span class="string" id="8556234">&#34;NewReader:&nbsp;%v&#34;</span><span class="op" id="8556249">,</span>&nbsp;<span class="ident" id="8556251"><a href="/compress/gzip/gzip_test.go.html#8556184">err</a></span><span class="op" id="8556254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8556257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556260">b</span><span class="op" id="8556261">,</span>&nbsp;<span class="ident" id="8556263"><a href="/compress/gzip/gzip_test.go.html#8556184">err</a></span>&nbsp;<span class="op" id="8556267">:=</span>&nbsp;<span class="ident" id="8556270"><a href="/compress/gzip/gzip_test.go.html#8555926">ioutil</a></span><span class="op" id="8556276">.</span><span class="ident" id="8556277">ReadAll</span><span class="op" id="8556284">(</span><span class="ident" id="8556285"><a href="/compress/gzip/gzip_test.go.html#8556181">r</a></span><span class="op" id="8556286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556289">if</span>&nbsp;<span class="ident" id="8556292"><a href="/compress/gzip/gzip_test.go.html#8556184">err</a></span>&nbsp;<span class="op" id="8556296">!=</span>&nbsp;<span class="ident" id="8556299">nil</span>&nbsp;<span class="op" id="8556303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556307"><a href="/compress/gzip/gzip_test.go.html#8556049">t</a></span><span class="op" id="8556308">.</span><span class="ident" id="8556309">Fatalf</span><span class="op" id="8556315">(</span><span class="string" id="8556316">&#34;ReadAll:&nbsp;%v&#34;</span><span class="op" id="8556329">,</span>&nbsp;<span class="ident" id="8556331"><a href="/compress/gzip/gzip_test.go.html#8556184">err</a></span><span class="op" id="8556334">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8556337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556340">if</span>&nbsp;<span class="builtinfunc" id="8556343">len</span><span class="op" id="8556346">(</span><span class="ident" id="8556347"><a href="/compress/gzip/gzip_test.go.html#8556260">b</a></span><span class="op" id="8556348">)</span>&nbsp;<span class="op" id="8556350">!=</span>&nbsp;<span class="num" id="8556353">0</span>&nbsp;<span class="op" id="8556355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556359"><a href="/compress/gzip/gzip_test.go.html#8556049">t</a></span><span class="op" id="8556360">.</span><span class="ident" id="8556361">Fatalf</span><span class="op" id="8556367">(</span><span class="string" id="8556368">&#34;got&nbsp;%d&nbsp;bytes,&nbsp;want&nbsp;0&#34;</span><span class="op" id="8556390">,</span>&nbsp;<span class="builtinfunc" id="8556392">len</span><span class="op" id="8556395">(</span><span class="ident" id="8556396"><a href="/compress/gzip/gzip_test.go.html#8556260">b</a></span><span class="op" id="8556397">)</span><span class="op" id="8556398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8556401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556404">if</span>&nbsp;<span class="ident" id="8556407">err</span>&nbsp;<span class="op" id="8556411">:=</span>&nbsp;<span class="ident" id="8556414"><a href="/compress/gzip/gzip_test.go.html#8556181">r</a></span><span class="op" id="8556415">.</span><span class="ident" id="8556416">Close</span><span class="op" id="8556421">(</span><span class="op" id="8556422">)</span><span class="op" id="8556423">;</span>&nbsp;<span class="ident" id="8556425"><a href="/compress/gzip/gzip_test.go.html#8556407">err</a></span>&nbsp;<span class="op" id="8556429">!=</span>&nbsp;<span class="ident" id="8556432">nil</span>&nbsp;<span class="op" id="8556436">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556440"><a href="/compress/gzip/gzip_test.go.html#8556049">t</a></span><span class="op" id="8556441">.</span><span class="ident" id="8556442">Fatalf</span><span class="op" id="8556448">(</span><span class="string" id="8556449">&#34;Reader.Close:&nbsp;%v&#34;</span><span class="op" id="8556467">,</span>&nbsp;<span class="ident" id="8556469"><a href="/compress/gzip/gzip_test.go.html#8556407">err</a></span><span class="op" id="8556472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8556475">}</span><br>
<span class="lineno"></span><span class="op" id="8556477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8556480">//&nbsp;TestRoundTrip&nbsp;tests&nbsp;that&nbsp;gzipping&nbsp;and&nbsp;then&nbsp;gunzipping&nbsp;is&nbsp;the&nbsp;identity</span><br>
<span class="lineno">40</span><span class="comment" id="8556553">//&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="8556566">func</span>&nbsp;<span class="ident" id="8556571">TestRoundTrip</span><span class="op" id="8556584">(</span><span class="ident" id="8556585">t</span>&nbsp;<span class="op" id="8556587">*</span><span class="ident" id="8556588"><a href="/compress/gzip/gzip_test.go.html#8555939">testing</a></span><span class="op" id="8556595">.</span><span class="ident" id="8556596">T</span><span class="op" id="8556597">)</span>&nbsp;<span class="op" id="8556599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556602">buf</span>&nbsp;<span class="op" id="8556606">:=</span>&nbsp;<span class="builtinfunc" id="8556609">new</span><span class="op" id="8556612">(</span><span class="ident" id="8556613"><a href="/compress/gzip/gzip_test.go.html#8555917">bytes</a></span><span class="op" id="8556618">.</span><span class="ident" id="8556619">Buffer</span><span class="op" id="8556625">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556629">w</span>&nbsp;<span class="op" id="8556631">:=</span>&nbsp;<span class="ident" id="8556634"><a href="/compress/gzip/gzip.go.html#4546176">NewWriter</a></span><span class="op" id="8556643">(</span><span class="ident" id="8556644"><a href="/compress/gzip/gzip_test.go.html#8556602">buf</a></span><span class="op" id="8556647">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556650"><a href="/compress/gzip/gzip_test.go.html#8556629">w</a></span><span class="op" id="8556651">.</span><span class="ident" id="8556652">Comment</span>&nbsp;<span class="op" id="8556660">=</span>&nbsp;<span class="string" id="8556662">&#34;comment&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556673"><a href="/compress/gzip/gzip_test.go.html#8556629">w</a></span><span class="op" id="8556674">.</span><span class="ident" id="8556675">Extra</span>&nbsp;<span class="op" id="8556681">=</span>&nbsp;<span class="op" id="8556683">[</span><span class="op" id="8556684">]</span><span class="builtintype" id="8556685">byte</span><span class="op" id="8556689">(</span><span class="string" id="8556690">&#34;extra&#34;</span><span class="op" id="8556697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556700"><a href="/compress/gzip/gzip_test.go.html#8556629">w</a></span><span class="op" id="8556701">.</span><span class="ident" id="8556702">ModTime</span>&nbsp;<span class="op" id="8556710">=</span>&nbsp;<span class="ident" id="8556712"><a href="/compress/gzip/gzip_test.go.html#8555950">time</a></span><span class="op" id="8556716">.</span><span class="ident" id="8556717">Unix</span><span class="op" id="8556721">(</span><span class="num" id="8556722">1e8</span><span class="op" id="8556725">,</span>&nbsp;<span class="num" id="8556727">0</span><span class="op" id="8556728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556731"><a href="/compress/gzip/gzip_test.go.html#8556629">w</a></span><span class="op" id="8556732">.</span><span class="ident" id="8556733">Name</span>&nbsp;<span class="op" id="8556738">=</span>&nbsp;<span class="string" id="8556740">&#34;name&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556748">if</span>&nbsp;<span class="ident" id="8556751">_</span><span class="op" id="8556752">,</span>&nbsp;<span class="ident" id="8556754">err</span>&nbsp;<span class="op" id="8556758">:=</span>&nbsp;<span class="ident" id="8556761"><a href="/compress/gzip/gzip_test.go.html#8556629">w</a></span><span class="op" id="8556762">.</span><span class="ident" id="8556763">Write</span><span class="op" id="8556768">(</span><span class="op" id="8556769">[</span><span class="op" id="8556770">]</span><span class="builtintype" id="8556771">byte</span><span class="op" id="8556775">(</span><span class="string" id="8556776">&#34;payload&#34;</span><span class="op" id="8556785">)</span><span class="op" id="8556786">)</span><span class="op" id="8556787">;</span>&nbsp;<span class="ident" id="8556789"><a href="/compress/gzip/gzip_test.go.html#8556754">err</a></span>&nbsp;<span class="op" id="8556793">!=</span>&nbsp;<span class="ident" id="8556796">nil</span>&nbsp;<span class="op" id="8556800">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556804"><a href="/compress/gzip/gzip_test.go.html#8556585">t</a></span><span class="op" id="8556805">.</span><span class="ident" id="8556806">Fatalf</span><span class="op" id="8556812">(</span><span class="string" id="8556813">&#34;Write:&nbsp;%v&#34;</span><span class="op" id="8556824">,</span>&nbsp;<span class="ident" id="8556826"><a href="/compress/gzip/gzip_test.go.html#8556754">err</a></span><span class="op" id="8556829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8556832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556835">if</span>&nbsp;<span class="ident" id="8556838">err</span>&nbsp;<span class="op" id="8556842">:=</span>&nbsp;<span class="ident" id="8556845"><a href="/compress/gzip/gzip_test.go.html#8556629">w</a></span><span class="op" id="8556846">.</span><span class="ident" id="8556847">Close</span><span class="op" id="8556852">(</span><span class="op" id="8556853">)</span><span class="op" id="8556854">;</span>&nbsp;<span class="ident" id="8556856"><a href="/compress/gzip/gzip_test.go.html#8556838">err</a></span>&nbsp;<span class="op" id="8556860">!=</span>&nbsp;<span class="ident" id="8556863">nil</span>&nbsp;<span class="op" id="8556867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556871"><a href="/compress/gzip/gzip_test.go.html#8556585">t</a></span><span class="op" id="8556872">.</span><span class="ident" id="8556873">Fatalf</span><span class="op" id="8556879">(</span><span class="string" id="8556880">&#34;Writer.Close:&nbsp;%v&#34;</span><span class="op" id="8556898">,</span>&nbsp;<span class="ident" id="8556900"><a href="/compress/gzip/gzip_test.go.html#8556838">err</a></span><span class="op" id="8556903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8556906">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556910">r</span><span class="op" id="8556911">,</span>&nbsp;<span class="ident" id="8556913">err</span>&nbsp;<span class="op" id="8556917">:=</span>&nbsp;<span class="ident" id="8556920"><a href="/compress/gzip/gunzip.go.html#4539946">NewReader</a></span><span class="op" id="8556929">(</span><span class="ident" id="8556930"><a href="/compress/gzip/gzip_test.go.html#8556602">buf</a></span><span class="op" id="8556933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8556936">if</span>&nbsp;<span class="ident" id="8556939"><a href="/compress/gzip/gzip_test.go.html#8556913">err</a></span>&nbsp;<span class="op" id="8556943">!=</span>&nbsp;<span class="ident" id="8556946">nil</span>&nbsp;<span class="op" id="8556950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556954"><a href="/compress/gzip/gzip_test.go.html#8556585">t</a></span><span class="op" id="8556955">.</span><span class="ident" id="8556956">Fatalf</span><span class="op" id="8556962">(</span><span class="string" id="8556963">&#34;NewReader:&nbsp;%v&#34;</span><span class="op" id="8556978">,</span>&nbsp;<span class="ident" id="8556980"><a href="/compress/gzip/gzip_test.go.html#8556913">err</a></span><span class="op" id="8556983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8556986">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8556989">b</span><span class="op" id="8556990">,</span>&nbsp;<span class="ident" id="8556992"><a href="/compress/gzip/gzip_test.go.html#8556913">err</a></span>&nbsp;<span class="op" id="8556996">:=</span>&nbsp;<span class="ident" id="8556999"><a href="/compress/gzip/gzip_test.go.html#8555926">ioutil</a></span><span class="op" id="8557005">.</span><span class="ident" id="8557006">ReadAll</span><span class="op" id="8557013">(</span><span class="ident" id="8557014"><a href="/compress/gzip/gzip_test.go.html#8556910">r</a></span><span class="op" id="8557015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557018">if</span>&nbsp;<span class="ident" id="8557021"><a href="/compress/gzip/gzip_test.go.html#8556913">err</a></span>&nbsp;<span class="op" id="8557025">!=</span>&nbsp;<span class="ident" id="8557028">nil</span>&nbsp;<span class="op" id="8557032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557036"><a href="/compress/gzip/gzip_test.go.html#8556585">t</a></span><span class="op" id="8557037">.</span><span class="ident" id="8557038">Fatalf</span><span class="op" id="8557044">(</span><span class="string" id="8557045">&#34;ReadAll:&nbsp;%v&#34;</span><span class="op" id="8557058">,</span>&nbsp;<span class="ident" id="8557060"><a href="/compress/gzip/gzip_test.go.html#8556913">err</a></span><span class="op" id="8557063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557069">if</span>&nbsp;<span class="builtintype" id="8557072">string</span><span class="op" id="8557078">(</span><span class="ident" id="8557079"><a href="/compress/gzip/gzip_test.go.html#8556989">b</a></span><span class="op" id="8557080">)</span>&nbsp;<span class="op" id="8557082">!=</span>&nbsp;<span class="string" id="8557085">&#34;payload&#34;</span>&nbsp;<span class="op" id="8557095">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557099"><a href="/compress/gzip/gzip_test.go.html#8556585">t</a></span><span class="op" id="8557100">.</span><span class="ident" id="8557101">Fatalf</span><span class="op" id="8557107">(</span><span class="string" id="8557108">&#34;payload&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8557132">,</span>&nbsp;<span class="builtintype" id="8557134">string</span><span class="op" id="8557140">(</span><span class="ident" id="8557141"><a href="/compress/gzip/gzip_test.go.html#8556989">b</a></span><span class="op" id="8557142">)</span><span class="op" id="8557143">,</span>&nbsp;<span class="string" id="8557145">&#34;payload&#34;</span><span class="op" id="8557154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557160">if</span>&nbsp;<span class="ident" id="8557163"><a href="/compress/gzip/gzip_test.go.html#8556910">r</a></span><span class="op" id="8557164">.</span><span class="ident" id="8557165">Comment</span>&nbsp;<span class="op" id="8557173">!=</span>&nbsp;<span class="string" id="8557176">&#34;comment&#34;</span>&nbsp;<span class="op" id="8557186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557190"><a href="/compress/gzip/gzip_test.go.html#8556585">t</a></span><span class="op" id="8557191">.</span><span class="ident" id="8557192">Fatalf</span><span class="op" id="8557198">(</span><span class="string" id="8557199">&#34;comment&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8557223">,</span>&nbsp;<span class="ident" id="8557225"><a href="/compress/gzip/gzip_test.go.html#8556910">r</a></span><span class="op" id="8557226">.</span><span class="ident" id="8557227">Comment</span><span class="op" id="8557234">,</span>&nbsp;<span class="string" id="8557236">&#34;comment&#34;</span><span class="op" id="8557245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557248">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557251">if</span>&nbsp;<span class="builtintype" id="8557254">string</span><span class="op" id="8557260">(</span><span class="ident" id="8557261"><a href="/compress/gzip/gzip_test.go.html#8556910">r</a></span><span class="op" id="8557262">.</span><span class="ident" id="8557263">Extra</span><span class="op" id="8557268">)</span>&nbsp;<span class="op" id="8557270">!=</span>&nbsp;<span class="string" id="8557273">&#34;extra&#34;</span>&nbsp;<span class="op" id="8557281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557285"><a href="/compress/gzip/gzip_test.go.html#8556585">t</a></span><span class="op" id="8557286">.</span><span class="ident" id="8557287">Fatalf</span><span class="op" id="8557293">(</span><span class="string" id="8557294">&#34;extra&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8557316">,</span>&nbsp;<span class="ident" id="8557318"><a href="/compress/gzip/gzip_test.go.html#8556910">r</a></span><span class="op" id="8557319">.</span><span class="ident" id="8557320">Extra</span><span class="op" id="8557325">,</span>&nbsp;<span class="string" id="8557327">&#34;extra&#34;</span><span class="op" id="8557334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557340">if</span>&nbsp;<span class="ident" id="8557343"><a href="/compress/gzip/gzip_test.go.html#8556910">r</a></span><span class="op" id="8557344">.</span><span class="ident" id="8557345">ModTime</span><span class="op" id="8557352">.</span><span class="ident" id="8557353">Unix</span><span class="op" id="8557357">(</span><span class="op" id="8557358">)</span>&nbsp;<span class="op" id="8557360">!=</span>&nbsp;<span class="num" id="8557363">1e8</span>&nbsp;<span class="op" id="8557367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557371"><a href="/compress/gzip/gzip_test.go.html#8556585">t</a></span><span class="op" id="8557372">.</span><span class="ident" id="8557373">Fatalf</span><span class="op" id="8557379">(</span><span class="string" id="8557380">&#34;mtime&nbsp;is&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8557402">,</span>&nbsp;<span class="ident" id="8557404"><a href="/compress/gzip/gzip_test.go.html#8556910">r</a></span><span class="op" id="8557405">.</span><span class="ident" id="8557406">ModTime</span><span class="op" id="8557413">.</span><span class="ident" id="8557414">Unix</span><span class="op" id="8557418">(</span><span class="op" id="8557419">)</span><span class="op" id="8557420">,</span>&nbsp;<span class="builtintype" id="8557422">uint32</span><span class="op" id="8557428">(</span><span class="num" id="8557429">1e8</span><span class="op" id="8557432">)</span><span class="op" id="8557433">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557439">if</span>&nbsp;<span class="ident" id="8557442"><a href="/compress/gzip/gzip_test.go.html#8556910">r</a></span><span class="op" id="8557443">.</span><span class="ident" id="8557444">Name</span>&nbsp;<span class="op" id="8557449">!=</span>&nbsp;<span class="string" id="8557452">&#34;name&#34;</span>&nbsp;<span class="op" id="8557459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557463"><a href="/compress/gzip/gzip_test.go.html#8556585">t</a></span><span class="op" id="8557464">.</span><span class="ident" id="8557465">Fatalf</span><span class="op" id="8557471">(</span><span class="string" id="8557472">&#34;name&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8557493">,</span>&nbsp;<span class="ident" id="8557495"><a href="/compress/gzip/gzip_test.go.html#8556910">r</a></span><span class="op" id="8557496">.</span><span class="ident" id="8557497">Name</span><span class="op" id="8557501">,</span>&nbsp;<span class="string" id="8557503">&#34;name&#34;</span><span class="op" id="8557509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557515">if</span>&nbsp;<span class="ident" id="8557518">err</span>&nbsp;<span class="op" id="8557522">:=</span>&nbsp;<span class="ident" id="8557525"><a href="/compress/gzip/gzip_test.go.html#8556910">r</a></span><span class="op" id="8557526">.</span><span class="ident" id="8557527">Close</span><span class="op" id="8557532">(</span><span class="op" id="8557533">)</span><span class="op" id="8557534">;</span>&nbsp;<span class="ident" id="8557536"><a href="/compress/gzip/gzip_test.go.html#8557518">err</a></span>&nbsp;<span class="op" id="8557540">!=</span>&nbsp;<span class="ident" id="8557543">nil</span>&nbsp;<span class="op" id="8557547">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557551"><a href="/compress/gzip/gzip_test.go.html#8556585">t</a></span><span class="op" id="8557552">.</span><span class="ident" id="8557553">Fatalf</span><span class="op" id="8557559">(</span><span class="string" id="8557560">&#34;Reader.Close:&nbsp;%v&#34;</span><span class="op" id="8557578">,</span>&nbsp;<span class="ident" id="8557580"><a href="/compress/gzip/gzip_test.go.html#8557518">err</a></span><span class="op" id="8557583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557586">}</span><br>
<span class="lineno"></span><span class="op" id="8557588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8557591">//&nbsp;TestLatin1&nbsp;tests&nbsp;the&nbsp;internal&nbsp;functions&nbsp;for&nbsp;converting&nbsp;to&nbsp;and&nbsp;from&nbsp;Latin-1.</span><br>
<span class="lineno">85</span><span class="keyword" id="8557670">func</span>&nbsp;<span class="ident" id="8557675">TestLatin1</span><span class="op" id="8557685">(</span><span class="ident" id="8557686">t</span>&nbsp;<span class="op" id="8557688">*</span><span class="ident" id="8557689"><a href="/compress/gzip/gzip_test.go.html#8555939">testing</a></span><span class="op" id="8557696">.</span><span class="ident" id="8557697">T</span><span class="op" id="8557698">)</span>&nbsp;<span class="op" id="8557700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557703">latin1</span>&nbsp;<span class="op" id="8557710">:=</span>&nbsp;<span class="op" id="8557713">[</span><span class="op" id="8557714">]</span><span class="builtintype" id="8557715">byte</span><span class="op" id="8557719">{</span><span class="num" id="8557720">0xc4</span><span class="op" id="8557724">,</span>&nbsp;<span class="string" id="8557726">&#39;u&#39;</span><span class="op" id="8557729">,</span>&nbsp;<span class="num" id="8557731">0xdf</span><span class="op" id="8557735">,</span>&nbsp;<span class="string" id="8557737">&#39;e&#39;</span><span class="op" id="8557740">,</span>&nbsp;<span class="string" id="8557742">&#39;r&#39;</span><span class="op" id="8557745">,</span>&nbsp;<span class="string" id="8557747">&#39;u&#39;</span><span class="op" id="8557750">,</span>&nbsp;<span class="string" id="8557752">&#39;n&#39;</span><span class="op" id="8557755">,</span>&nbsp;<span class="string" id="8557757">&#39;g&#39;</span><span class="op" id="8557760">,</span>&nbsp;<span class="num" id="8557762">0</span><span class="op" id="8557763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557766">utf8</span>&nbsp;<span class="op" id="8557771">:=</span>&nbsp;<span class="string" id="8557774">&#34;Äußerung&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557788">z</span>&nbsp;<span class="op" id="8557790">:=</span>&nbsp;<span class="ident" id="8557793"><a href="/compress/gzip/gunzip.go.html#4539485">Reader</a></span><span class="op" id="8557799">{</span><span class="ident" id="8557800">r</span><span class="op" id="8557801">:</span>&nbsp;<span class="ident" id="8557803"><a href="/compress/gzip/gzip_test.go.html#8555908">bufio</a></span><span class="op" id="8557808">.</span><span class="ident" id="8557809">NewReader</span><span class="op" id="8557818">(</span><span class="ident" id="8557819"><a href="/compress/gzip/gzip_test.go.html#8555917">bytes</a></span><span class="op" id="8557824">.</span><span class="ident" id="8557825">NewReader</span><span class="op" id="8557834">(</span><span class="ident" id="8557835"><a href="/compress/gzip/gzip_test.go.html#8557703">latin1</a></span><span class="op" id="8557841">)</span><span class="op" id="8557842">)</span><span class="op" id="8557843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557846">s</span><span class="op" id="8557847">,</span>&nbsp;<span class="ident" id="8557849">err</span>&nbsp;<span class="op" id="8557853">:=</span>&nbsp;<span class="ident" id="8557856"><a href="/compress/gzip/gzip_test.go.html#8557788">z</a></span><span class="op" id="8557857">.</span><span class="ident" id="8557858">readString</span><span class="op" id="8557868">(</span><span class="op" id="8557869">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557872">if</span>&nbsp;<span class="ident" id="8557875"><a href="/compress/gzip/gzip_test.go.html#8557849">err</a></span>&nbsp;<span class="op" id="8557879">!=</span>&nbsp;<span class="ident" id="8557882">nil</span>&nbsp;<span class="op" id="8557886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557890"><a href="/compress/gzip/gzip_test.go.html#8557686">t</a></span><span class="op" id="8557891">.</span><span class="ident" id="8557892">Fatalf</span><span class="op" id="8557898">(</span><span class="string" id="8557899">&#34;readString:&nbsp;%v&#34;</span><span class="op" id="8557915">,</span>&nbsp;<span class="ident" id="8557917"><a href="/compress/gzip/gzip_test.go.html#8557849">err</a></span><span class="op" id="8557920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8557926">if</span>&nbsp;<span class="ident" id="8557929"><a href="/compress/gzip/gzip_test.go.html#8557846">s</a></span>&nbsp;<span class="op" id="8557931">!=</span>&nbsp;<span class="ident" id="8557934"><a href="/compress/gzip/gzip_test.go.html#8557766">utf8</a></span>&nbsp;<span class="op" id="8557939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557943"><a href="/compress/gzip/gzip_test.go.html#8557686">t</a></span><span class="op" id="8557944">.</span><span class="ident" id="8557945">Fatalf</span><span class="op" id="8557951">(</span><span class="string" id="8557952">&#34;read&nbsp;latin-1:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8557983">,</span>&nbsp;<span class="ident" id="8557985"><a href="/compress/gzip/gzip_test.go.html#8557846">s</a></span><span class="op" id="8557986">,</span>&nbsp;<span class="ident" id="8557988"><a href="/compress/gzip/gzip_test.go.html#8557766">utf8</a></span><span class="op" id="8557992">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8557995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8557999">buf</span>&nbsp;<span class="op" id="8558003">:=</span>&nbsp;<span class="ident" id="8558006"><a href="/compress/gzip/gzip_test.go.html#8555917">bytes</a></span><span class="op" id="8558011">.</span><span class="ident" id="8558012">NewBuffer</span><span class="op" id="8558021">(</span><span class="builtinfunc" id="8558022">make</span><span class="op" id="8558026">(</span><span class="op" id="8558027">[</span><span class="op" id="8558028">]</span><span class="builtintype" id="8558029">byte</span><span class="op" id="8558033">,</span>&nbsp;<span class="num" id="8558035">0</span><span class="op" id="8558036">,</span>&nbsp;<span class="builtinfunc" id="8558038">len</span><span class="op" id="8558041">(</span><span class="ident" id="8558042"><a href="/compress/gzip/gzip_test.go.html#8557703">latin1</a></span><span class="op" id="8558048">)</span><span class="op" id="8558049">)</span><span class="op" id="8558050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558053">c</span>&nbsp;<span class="op" id="8558055">:=</span>&nbsp;<span class="ident" id="8558058"><a href="/compress/gzip/gzip.go.html#4545386">Writer</a></span><span class="op" id="8558064">{</span><span class="ident" id="8558065">w</span><span class="op" id="8558066">:</span>&nbsp;<span class="ident" id="8558068"><a href="/compress/gzip/gzip_test.go.html#8557999">buf</a></span><span class="op" id="8558071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8558074">if</span>&nbsp;<span class="ident" id="8558077"><a href="/compress/gzip/gzip_test.go.html#8557849">err</a></span>&nbsp;<span class="op" id="8558081">=</span>&nbsp;<span class="ident" id="8558083"><a href="/compress/gzip/gzip_test.go.html#8558053">c</a></span><span class="op" id="8558084">.</span><span class="ident" id="8558085">writeString</span><span class="op" id="8558096">(</span><span class="ident" id="8558097"><a href="/compress/gzip/gzip_test.go.html#8557766">utf8</a></span><span class="op" id="8558101">)</span><span class="op" id="8558102">;</span>&nbsp;<span class="ident" id="8558104"><a href="/compress/gzip/gzip_test.go.html#8557849">err</a></span>&nbsp;<span class="op" id="8558108">!=</span>&nbsp;<span class="ident" id="8558111">nil</span>&nbsp;<span class="op" id="8558115">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558119"><a href="/compress/gzip/gzip_test.go.html#8557686">t</a></span><span class="op" id="8558120">.</span><span class="ident" id="8558121">Fatalf</span><span class="op" id="8558127">(</span><span class="string" id="8558128">&#34;writeString:&nbsp;%v&#34;</span><span class="op" id="8558145">,</span>&nbsp;<span class="ident" id="8558147"><a href="/compress/gzip/gzip_test.go.html#8557849">err</a></span><span class="op" id="8558150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558156"><a href="/compress/gzip/gzip_test.go.html#8557846">s</a></span>&nbsp;<span class="op" id="8558158">=</span>&nbsp;<span class="ident" id="8558160"><a href="/compress/gzip/gzip_test.go.html#8557999">buf</a></span><span class="op" id="8558163">.</span><span class="ident" id="8558164">String</span><span class="op" id="8558170">(</span><span class="op" id="8558171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8558174">if</span>&nbsp;<span class="ident" id="8558177"><a href="/compress/gzip/gzip_test.go.html#8557846">s</a></span>&nbsp;<span class="op" id="8558179">!=</span>&nbsp;<span class="builtintype" id="8558182">string</span><span class="op" id="8558188">(</span><span class="ident" id="8558189"><a href="/compress/gzip/gzip_test.go.html#8557703">latin1</a></span><span class="op" id="8558195">)</span>&nbsp;<span class="op" id="8558197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558201"><a href="/compress/gzip/gzip_test.go.html#8557686">t</a></span><span class="op" id="8558202">.</span><span class="ident" id="8558203">Fatalf</span><span class="op" id="8558209">(</span><span class="string" id="8558210">&#34;write&nbsp;utf-8:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8558240">,</span>&nbsp;<span class="ident" id="8558242"><a href="/compress/gzip/gzip_test.go.html#8557846">s</a></span><span class="op" id="8558243">,</span>&nbsp;<span class="builtintype" id="8558245">string</span><span class="op" id="8558251">(</span><span class="ident" id="8558252"><a href="/compress/gzip/gzip_test.go.html#8557703">latin1</a></span><span class="op" id="8558258">)</span><span class="op" id="8558259">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558262">}</span><br>
<span class="lineno"></span><span class="op" id="8558264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8558267">//&nbsp;TestLatin1RoundTrip&nbsp;tests&nbsp;that&nbsp;metadata&nbsp;that&nbsp;is&nbsp;representable&nbsp;in&nbsp;Latin-1</span><br>
<span class="lineno"></span><span class="comment" id="8558343">//&nbsp;survives&nbsp;a&nbsp;round&nbsp;trip.</span><br>
<span class="lineno">110</span><span class="keyword" id="8558369">func</span>&nbsp;<span class="ident" id="8558374">TestLatin1RoundTrip</span><span class="op" id="8558393">(</span><span class="ident" id="8558394">t</span>&nbsp;<span class="op" id="8558396">*</span><span class="ident" id="8558397"><a href="/compress/gzip/gzip_test.go.html#8555939">testing</a></span><span class="op" id="8558404">.</span><span class="ident" id="8558405">T</span><span class="op" id="8558406">)</span>&nbsp;<span class="op" id="8558408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558411">testCases</span>&nbsp;<span class="op" id="8558421">:=</span>&nbsp;<span class="op" id="8558424">[</span><span class="op" id="8558425">]</span><span class="keyword" id="8558426">struct</span>&nbsp;<span class="op" id="8558433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558437">name</span>&nbsp;<span class="builtintype" id="8558442">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558451">ok</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8558456">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558462">}</span><span class="op" id="8558463">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558467">{</span><span class="string" id="8558468">&#34;&#34;</span><span class="op" id="8558470">,</span>&nbsp;<span class="ident" id="8558472">true</span><span class="op" id="8558476">}</span><span class="op" id="8558477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558481">{</span><span class="string" id="8558482">&#34;ASCII&nbsp;is&nbsp;OK&#34;</span><span class="op" id="8558495">,</span>&nbsp;<span class="ident" id="8558497">true</span><span class="op" id="8558501">}</span><span class="op" id="8558502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558506">{</span><span class="string" id="8558507">&#34;unless&nbsp;it&nbsp;contains&nbsp;a&nbsp;NUL\x00&#34;</span><span class="op" id="8558537">,</span>&nbsp;<span class="ident" id="8558539">false</span><span class="op" id="8558544">}</span><span class="op" id="8558545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558549">{</span><span class="string" id="8558550">&#34;no&nbsp;matter&nbsp;where&nbsp;\x00&nbsp;occurs&#34;</span><span class="op" id="8558579">,</span>&nbsp;<span class="ident" id="8558581">false</span><span class="op" id="8558586">}</span><span class="op" id="8558587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558591">{</span><span class="string" id="8558592">&#34;\x00\x00\x00&#34;</span><span class="op" id="8558606">,</span>&nbsp;<span class="ident" id="8558608">false</span><span class="op" id="8558613">}</span><span class="op" id="8558614">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558618">{</span><span class="string" id="8558619">&#34;Látin-1&nbsp;also&nbsp;passes&nbsp;(U+00E1)&#34;</span><span class="op" id="8558650">,</span>&nbsp;<span class="ident" id="8558652">true</span><span class="op" id="8558656">}</span><span class="op" id="8558657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558661">{</span><span class="string" id="8558662">&#34;but&nbsp;LĀtin&nbsp;Extended-A&nbsp;(U+0100)&nbsp;does&nbsp;not&#34;</span><span class="op" id="8558703">,</span>&nbsp;<span class="ident" id="8558705">false</span><span class="op" id="8558710">}</span><span class="op" id="8558711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558715">{</span><span class="string" id="8558716">&#34;neither&nbsp;does&nbsp;日本語&#34;</span><span class="op" id="8558740">,</span>&nbsp;<span class="ident" id="8558742">false</span><span class="op" id="8558747">}</span><span class="op" id="8558748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558752">{</span><span class="string" id="8558753">&#34;invalid&nbsp;UTF-8&nbsp;also&nbsp;\xffails&#34;</span><span class="op" id="8558782">,</span>&nbsp;<span class="ident" id="8558784">false</span><span class="op" id="8558789">}</span><span class="op" id="8558790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558794">{</span><span class="string" id="8558795">&#34;\x00&nbsp;as&nbsp;does&nbsp;Látin-1&nbsp;with&nbsp;NUL&#34;</span><span class="op" id="8558827">,</span>&nbsp;<span class="ident" id="8558829">false</span><span class="op" id="8558834">}</span><span class="op" id="8558835">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8558838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8558841">for</span>&nbsp;<span class="ident" id="8558845">_</span><span class="op" id="8558846">,</span>&nbsp;<span class="ident" id="8558848">tc</span>&nbsp;<span class="op" id="8558851">:=</span>&nbsp;<span class="keyword" id="8558854">range</span>&nbsp;<span class="ident" id="8558860"><a href="/compress/gzip/gzip_test.go.html#8558411">testCases</a></span>&nbsp;<span class="op" id="8558870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558874">buf</span>&nbsp;<span class="op" id="8558878">:=</span>&nbsp;<span class="builtinfunc" id="8558881">new</span><span class="op" id="8558884">(</span><span class="ident" id="8558885"><a href="/compress/gzip/gzip_test.go.html#8555917">bytes</a></span><span class="op" id="8558890">.</span><span class="ident" id="8558891">Buffer</span><span class="op" id="8558897">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558902">w</span>&nbsp;<span class="op" id="8558904">:=</span>&nbsp;<span class="ident" id="8558907"><a href="/compress/gzip/gzip.go.html#4546176">NewWriter</a></span><span class="op" id="8558916">(</span><span class="ident" id="8558917"><a href="/compress/gzip/gzip_test.go.html#8558874">buf</a></span><span class="op" id="8558920">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558924"><a href="/compress/gzip/gzip_test.go.html#8558902">w</a></span><span class="op" id="8558925">.</span><span class="ident" id="8558926">Name</span>&nbsp;<span class="op" id="8558931">=</span>&nbsp;<span class="ident" id="8558933"><a href="/compress/gzip/gzip_test.go.html#8558848">tc</a></span><span class="op" id="8558935">.</span><span class="ident" id="8558936">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558943">err</span>&nbsp;<span class="op" id="8558947">:=</span>&nbsp;<span class="ident" id="8558950"><a href="/compress/gzip/gzip_test.go.html#8558902">w</a></span><span class="op" id="8558951">.</span><span class="ident" id="8558952">Close</span><span class="op" id="8558957">(</span><span class="op" id="8558958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8558962">if</span>&nbsp;<span class="op" id="8558965">(</span><span class="ident" id="8558966"><a href="/compress/gzip/gzip_test.go.html#8558943">err</a></span>&nbsp;<span class="op" id="8558970">==</span>&nbsp;<span class="ident" id="8558973">nil</span><span class="op" id="8558976">)</span>&nbsp;<span class="op" id="8558978">!=</span>&nbsp;<span class="ident" id="8558981"><a href="/compress/gzip/gzip_test.go.html#8558848">tc</a></span><span class="op" id="8558983">.</span><span class="ident" id="8558984">ok</span>&nbsp;<span class="op" id="8558987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8558992"><a href="/compress/gzip/gzip_test.go.html#8558394">t</a></span><span class="op" id="8558993">.</span><span class="ident" id="8558994">Errorf</span><span class="op" id="8559000">(</span><span class="string" id="8559001">&#34;Writer.Close:&nbsp;name&nbsp;=&nbsp;%q,&nbsp;err&nbsp;=&nbsp;%v&#34;</span><span class="op" id="8559036">,</span>&nbsp;<span class="ident" id="8559038"><a href="/compress/gzip/gzip_test.go.html#8558848">tc</a></span><span class="op" id="8559040">.</span><span class="ident" id="8559041">name</span><span class="op" id="8559045">,</span>&nbsp;<span class="ident" id="8559047"><a href="/compress/gzip/gzip_test.go.html#8558943">err</a></span><span class="op" id="8559050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559055">continue</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559070">if</span>&nbsp;<span class="op" id="8559073">!</span><span class="ident" id="8559074"><a href="/compress/gzip/gzip_test.go.html#8558848">tc</a></span><span class="op" id="8559076">.</span><span class="ident" id="8559077">ok</span>&nbsp;<span class="op" id="8559080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559085">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559101">r</span><span class="op" id="8559102">,</span>&nbsp;<span class="ident" id="8559104"><a href="/compress/gzip/gzip_test.go.html#8558943">err</a></span>&nbsp;<span class="op" id="8559108">:=</span>&nbsp;<span class="ident" id="8559111"><a href="/compress/gzip/gunzip.go.html#4539946">NewReader</a></span><span class="op" id="8559120">(</span><span class="ident" id="8559121"><a href="/compress/gzip/gzip_test.go.html#8558874">buf</a></span><span class="op" id="8559124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559128">if</span>&nbsp;<span class="ident" id="8559131"><a href="/compress/gzip/gzip_test.go.html#8558943">err</a></span>&nbsp;<span class="op" id="8559135">!=</span>&nbsp;<span class="ident" id="8559138">nil</span>&nbsp;<span class="op" id="8559142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559147"><a href="/compress/gzip/gzip_test.go.html#8558394">t</a></span><span class="op" id="8559148">.</span><span class="ident" id="8559149">Errorf</span><span class="op" id="8559155">(</span><span class="string" id="8559156">&#34;NewReader:&nbsp;%v&#34;</span><span class="op" id="8559171">,</span>&nbsp;<span class="ident" id="8559173"><a href="/compress/gzip/gzip_test.go.html#8558943">err</a></span><span class="op" id="8559176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559181">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559192">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559196">_</span><span class="op" id="8559197">,</span>&nbsp;<span class="ident" id="8559199"><a href="/compress/gzip/gzip_test.go.html#8558943">err</a></span>&nbsp;<span class="op" id="8559203">=</span>&nbsp;<span class="ident" id="8559205"><a href="/compress/gzip/gzip_test.go.html#8555926">ioutil</a></span><span class="op" id="8559211">.</span><span class="ident" id="8559212">ReadAll</span><span class="op" id="8559219">(</span><span class="ident" id="8559220"><a href="/compress/gzip/gzip_test.go.html#8559101">r</a></span><span class="op" id="8559221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559225">if</span>&nbsp;<span class="ident" id="8559228"><a href="/compress/gzip/gzip_test.go.html#8558943">err</a></span>&nbsp;<span class="op" id="8559232">!=</span>&nbsp;<span class="ident" id="8559235">nil</span>&nbsp;<span class="op" id="8559239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559244"><a href="/compress/gzip/gzip_test.go.html#8558394">t</a></span><span class="op" id="8559245">.</span><span class="ident" id="8559246">Errorf</span><span class="op" id="8559252">(</span><span class="string" id="8559253">&#34;ReadAll:&nbsp;%v&#34;</span><span class="op" id="8559266">,</span>&nbsp;<span class="ident" id="8559268"><a href="/compress/gzip/gzip_test.go.html#8558943">err</a></span><span class="op" id="8559271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559276">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559287">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559291">if</span>&nbsp;<span class="ident" id="8559294"><a href="/compress/gzip/gzip_test.go.html#8559101">r</a></span><span class="op" id="8559295">.</span><span class="ident" id="8559296">Name</span>&nbsp;<span class="op" id="8559301">!=</span>&nbsp;<span class="ident" id="8559304"><a href="/compress/gzip/gzip_test.go.html#8558848">tc</a></span><span class="op" id="8559306">.</span><span class="ident" id="8559307">name</span>&nbsp;<span class="op" id="8559312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559317"><a href="/compress/gzip/gzip_test.go.html#8558394">t</a></span><span class="op" id="8559318">.</span><span class="ident" id="8559319">Errorf</span><span class="op" id="8559325">(</span><span class="string" id="8559326">&#34;name&nbsp;is&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8559347">,</span>&nbsp;<span class="ident" id="8559349"><a href="/compress/gzip/gzip_test.go.html#8559101">r</a></span><span class="op" id="8559350">.</span><span class="ident" id="8559351">Name</span><span class="op" id="8559355">,</span>&nbsp;<span class="ident" id="8559357"><a href="/compress/gzip/gzip_test.go.html#8558848">tc</a></span><span class="op" id="8559359">.</span><span class="ident" id="8559360">name</span><span class="op" id="8559364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559369">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559384">if</span>&nbsp;<span class="ident" id="8559387">err</span>&nbsp;<span class="op" id="8559391">:=</span>&nbsp;<span class="ident" id="8559394"><a href="/compress/gzip/gzip_test.go.html#8559101">r</a></span><span class="op" id="8559395">.</span><span class="ident" id="8559396">Close</span><span class="op" id="8559401">(</span><span class="op" id="8559402">)</span><span class="op" id="8559403">;</span>&nbsp;<span class="ident" id="8559405"><a href="/compress/gzip/gzip_test.go.html#8559387">err</a></span>&nbsp;<span class="op" id="8559409">!=</span>&nbsp;<span class="ident" id="8559412">nil</span>&nbsp;<span class="op" id="8559416">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559421"><a href="/compress/gzip/gzip_test.go.html#8558394">t</a></span><span class="op" id="8559422">.</span><span class="ident" id="8559423">Errorf</span><span class="op" id="8559429">(</span><span class="string" id="8559430">&#34;Reader.Close:&nbsp;%v&#34;</span><span class="op" id="8559448">,</span>&nbsp;<span class="ident" id="8559450"><a href="/compress/gzip/gzip_test.go.html#8559387">err</a></span><span class="op" id="8559453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559458">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559472">}</span><br>
<span class="lineno"></span><span class="op" id="8559474">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="8559477">func</span>&nbsp;<span class="ident" id="8559482">TestWriterFlush</span><span class="op" id="8559497">(</span><span class="ident" id="8559498">t</span>&nbsp;<span class="op" id="8559500">*</span><span class="ident" id="8559501"><a href="/compress/gzip/gzip_test.go.html#8555939">testing</a></span><span class="op" id="8559508">.</span><span class="ident" id="8559509">T</span><span class="op" id="8559510">)</span>&nbsp;<span class="op" id="8559512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559515">buf</span>&nbsp;<span class="op" id="8559519">:=</span>&nbsp;<span class="builtinfunc" id="8559522">new</span><span class="op" id="8559525">(</span><span class="ident" id="8559526"><a href="/compress/gzip/gzip_test.go.html#8555917">bytes</a></span><span class="op" id="8559531">.</span><span class="ident" id="8559532">Buffer</span><span class="op" id="8559538">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559542">w</span>&nbsp;<span class="op" id="8559544">:=</span>&nbsp;<span class="ident" id="8559547"><a href="/compress/gzip/gzip.go.html#4546176">NewWriter</a></span><span class="op" id="8559556">(</span><span class="ident" id="8559557"><a href="/compress/gzip/gzip_test.go.html#8559515">buf</a></span><span class="op" id="8559560">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559563"><a href="/compress/gzip/gzip_test.go.html#8559542">w</a></span><span class="op" id="8559564">.</span><span class="ident" id="8559565">Comment</span>&nbsp;<span class="op" id="8559573">=</span>&nbsp;<span class="string" id="8559575">&#34;comment&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559586"><a href="/compress/gzip/gzip_test.go.html#8559542">w</a></span><span class="op" id="8559587">.</span><span class="ident" id="8559588">Extra</span>&nbsp;<span class="op" id="8559594">=</span>&nbsp;<span class="op" id="8559596">[</span><span class="op" id="8559597">]</span><span class="builtintype" id="8559598">byte</span><span class="op" id="8559602">(</span><span class="string" id="8559603">&#34;extra&#34;</span><span class="op" id="8559610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559613"><a href="/compress/gzip/gzip_test.go.html#8559542">w</a></span><span class="op" id="8559614">.</span><span class="ident" id="8559615">ModTime</span>&nbsp;<span class="op" id="8559623">=</span>&nbsp;<span class="ident" id="8559625"><a href="/compress/gzip/gzip_test.go.html#8555950">time</a></span><span class="op" id="8559629">.</span><span class="ident" id="8559630">Unix</span><span class="op" id="8559634">(</span><span class="num" id="8559635">1e8</span><span class="op" id="8559638">,</span>&nbsp;<span class="num" id="8559640">0</span><span class="op" id="8559641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559644"><a href="/compress/gzip/gzip_test.go.html#8559542">w</a></span><span class="op" id="8559645">.</span><span class="ident" id="8559646">Name</span>&nbsp;<span class="op" id="8559651">=</span>&nbsp;<span class="string" id="8559653">&#34;name&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559662">n0</span>&nbsp;<span class="op" id="8559665">:=</span>&nbsp;<span class="ident" id="8559668"><a href="/compress/gzip/gzip_test.go.html#8559515">buf</a></span><span class="op" id="8559671">.</span><span class="ident" id="8559672">Len</span><span class="op" id="8559675">(</span><span class="op" id="8559676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559679">if</span>&nbsp;<span class="ident" id="8559682"><a href="/compress/gzip/gzip_test.go.html#8559662">n0</a></span>&nbsp;<span class="op" id="8559685">!=</span>&nbsp;<span class="num" id="8559688">0</span>&nbsp;<span class="op" id="8559690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559694"><a href="/compress/gzip/gzip_test.go.html#8559498">t</a></span><span class="op" id="8559695">.</span><span class="ident" id="8559696">Fatalf</span><span class="op" id="8559702">(</span><span class="string" id="8559703">&#34;buffer&nbsp;size&nbsp;=&nbsp;%d&nbsp;before&nbsp;writes;&nbsp;want&nbsp;0&#34;</span><span class="op" id="8559743">,</span>&nbsp;<span class="ident" id="8559745"><a href="/compress/gzip/gzip_test.go.html#8559662">n0</a></span><span class="op" id="8559747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559750">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559754">if</span>&nbsp;<span class="ident" id="8559757">err</span>&nbsp;<span class="op" id="8559761">:=</span>&nbsp;<span class="ident" id="8559764"><a href="/compress/gzip/gzip_test.go.html#8559542">w</a></span><span class="op" id="8559765">.</span><span class="ident" id="8559766">Flush</span><span class="op" id="8559771">(</span><span class="op" id="8559772">)</span><span class="op" id="8559773">;</span>&nbsp;<span class="ident" id="8559775"><a href="/compress/gzip/gzip_test.go.html#8559757">err</a></span>&nbsp;<span class="op" id="8559779">!=</span>&nbsp;<span class="ident" id="8559782">nil</span>&nbsp;<span class="op" id="8559786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559790"><a href="/compress/gzip/gzip_test.go.html#8559498">t</a></span><span class="op" id="8559791">.</span><span class="ident" id="8559792">Fatal</span><span class="op" id="8559797">(</span><span class="ident" id="8559798"><a href="/compress/gzip/gzip_test.go.html#8559757">err</a></span><span class="op" id="8559801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559808">n1</span>&nbsp;<span class="op" id="8559811">:=</span>&nbsp;<span class="ident" id="8559814"><a href="/compress/gzip/gzip_test.go.html#8559515">buf</a></span><span class="op" id="8559817">.</span><span class="ident" id="8559818">Len</span><span class="op" id="8559821">(</span><span class="op" id="8559822">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559825">if</span>&nbsp;<span class="ident" id="8559828"><a href="/compress/gzip/gzip_test.go.html#8559808">n1</a></span>&nbsp;<span class="op" id="8559831">==</span>&nbsp;<span class="num" id="8559834">0</span>&nbsp;<span class="op" id="8559836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559840"><a href="/compress/gzip/gzip_test.go.html#8559498">t</a></span><span class="op" id="8559841">.</span><span class="ident" id="8559842">Fatal</span><span class="op" id="8559847">(</span><span class="string" id="8559848">&#34;no&nbsp;data&nbsp;after&nbsp;first&nbsp;flush&#34;</span><span class="op" id="8559875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8559878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559882"><a href="/compress/gzip/gzip_test.go.html#8559542">w</a></span><span class="op" id="8559883">.</span><span class="ident" id="8559884">Write</span><span class="op" id="8559889">(</span><span class="op" id="8559890">[</span><span class="op" id="8559891">]</span><span class="builtintype" id="8559892">byte</span><span class="op" id="8559896">(</span><span class="string" id="8559897">&#34;x&#34;</span><span class="op" id="8559900">)</span><span class="op" id="8559901">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559905">n2</span>&nbsp;<span class="op" id="8559908">:=</span>&nbsp;<span class="ident" id="8559911"><a href="/compress/gzip/gzip_test.go.html#8559515">buf</a></span><span class="op" id="8559914">.</span><span class="ident" id="8559915">Len</span><span class="op" id="8559918">(</span><span class="op" id="8559919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8559922">if</span>&nbsp;<span class="ident" id="8559925"><a href="/compress/gzip/gzip_test.go.html#8559808">n1</a></span>&nbsp;<span class="op" id="8559928">!=</span>&nbsp;<span class="ident" id="8559931"><a href="/compress/gzip/gzip_test.go.html#8559905">n2</a></span>&nbsp;<span class="op" id="8559934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8559938"><a href="/compress/gzip/gzip_test.go.html#8559498">t</a></span><span class="op" id="8559939">.</span><span class="ident" id="8559940">Fatalf</span><span class="op" id="8559946">(</span><span class="string" id="8559947">&#34;after&nbsp;writing&nbsp;a&nbsp;single&nbsp;byte,&nbsp;size&nbsp;changed&nbsp;from&nbsp;%d&nbsp;to&nbsp;%d;&nbsp;want&nbsp;no&nbsp;change&#34;</span><span class="op" id="8560020">,</span>&nbsp;<span class="ident" id="8560022"><a href="/compress/gzip/gzip_test.go.html#8559808">n1</a></span><span class="op" id="8560024">,</span>&nbsp;<span class="ident" id="8560026"><a href="/compress/gzip/gzip_test.go.html#8559905">n2</a></span><span class="op" id="8560028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8560031">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8560035">if</span>&nbsp;<span class="ident" id="8560038">err</span>&nbsp;<span class="op" id="8560042">:=</span>&nbsp;<span class="ident" id="8560045"><a href="/compress/gzip/gzip_test.go.html#8559542">w</a></span><span class="op" id="8560046">.</span><span class="ident" id="8560047">Flush</span><span class="op" id="8560052">(</span><span class="op" id="8560053">)</span><span class="op" id="8560054">;</span>&nbsp;<span class="ident" id="8560056"><a href="/compress/gzip/gzip_test.go.html#8560038">err</a></span>&nbsp;<span class="op" id="8560060">!=</span>&nbsp;<span class="ident" id="8560063">nil</span>&nbsp;<span class="op" id="8560067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560071"><a href="/compress/gzip/gzip_test.go.html#8559498">t</a></span><span class="op" id="8560072">.</span><span class="ident" id="8560073">Fatal</span><span class="op" id="8560078">(</span><span class="ident" id="8560079"><a href="/compress/gzip/gzip_test.go.html#8560038">err</a></span><span class="op" id="8560082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8560085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560089">n3</span>&nbsp;<span class="op" id="8560092">:=</span>&nbsp;<span class="ident" id="8560095"><a href="/compress/gzip/gzip_test.go.html#8559515">buf</a></span><span class="op" id="8560098">.</span><span class="ident" id="8560099">Len</span><span class="op" id="8560102">(</span><span class="op" id="8560103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8560106">if</span>&nbsp;<span class="ident" id="8560109"><a href="/compress/gzip/gzip_test.go.html#8559905">n2</a></span>&nbsp;<span class="op" id="8560112">==</span>&nbsp;<span class="ident" id="8560115"><a href="/compress/gzip/gzip_test.go.html#8560089">n3</a></span>&nbsp;<span class="op" id="8560118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560122"><a href="/compress/gzip/gzip_test.go.html#8559498">t</a></span><span class="op" id="8560123">.</span><span class="ident" id="8560124">Fatal</span><span class="op" id="8560129">(</span><span class="string" id="8560130">&#34;Flush&nbsp;didn&#39;t&nbsp;flush&nbsp;any&nbsp;data&#34;</span><span class="op" id="8560159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8560162">}</span><br>
<span class="lineno"></span><span class="op" id="8560164">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="comment" id="8560167">//&nbsp;Multiple&nbsp;gzip&nbsp;files&nbsp;concatenated&nbsp;form&nbsp;a&nbsp;valid&nbsp;gzip&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="8560227">func</span>&nbsp;<span class="ident" id="8560232">TestConcat</span><span class="op" id="8560242">(</span><span class="ident" id="8560243">t</span>&nbsp;<span class="op" id="8560245">*</span><span class="ident" id="8560246"><a href="/compress/gzip/gzip_test.go.html#8555939">testing</a></span><span class="op" id="8560253">.</span><span class="ident" id="8560254">T</span><span class="op" id="8560255">)</span>&nbsp;<span class="op" id="8560257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8560260">var</span>&nbsp;<span class="ident" id="8560264">buf</span>&nbsp;<span class="ident" id="8560268"><a href="/compress/gzip/gzip_test.go.html#8555917">bytes</a></span><span class="op" id="8560273">.</span><span class="ident" id="8560274">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560282">w</span>&nbsp;<span class="op" id="8560284">:=</span>&nbsp;<span class="ident" id="8560287"><a href="/compress/gzip/gzip.go.html#4546176">NewWriter</a></span><span class="op" id="8560296">(</span><span class="op" id="8560297">&amp;</span><span class="ident" id="8560298"><a href="/compress/gzip/gzip_test.go.html#8560264">buf</a></span><span class="op" id="8560301">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560304"><a href="/compress/gzip/gzip_test.go.html#8560282">w</a></span><span class="op" id="8560305">.</span><span class="ident" id="8560306">Write</span><span class="op" id="8560311">(</span><span class="op" id="8560312">[</span><span class="op" id="8560313">]</span><span class="builtintype" id="8560314">byte</span><span class="op" id="8560318">(</span><span class="string" id="8560319">&#34;hello&nbsp;&#34;</span><span class="op" id="8560327">)</span><span class="op" id="8560328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560331"><a href="/compress/gzip/gzip_test.go.html#8560282">w</a></span><span class="op" id="8560332">.</span><span class="ident" id="8560333">Close</span><span class="op" id="8560338">(</span><span class="op" id="8560339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560342"><a href="/compress/gzip/gzip_test.go.html#8560282">w</a></span>&nbsp;<span class="op" id="8560344">=</span>&nbsp;<span class="ident" id="8560346"><a href="/compress/gzip/gzip.go.html#4546176">NewWriter</a></span><span class="op" id="8560355">(</span><span class="op" id="8560356">&amp;</span><span class="ident" id="8560357"><a href="/compress/gzip/gzip_test.go.html#8560264">buf</a></span><span class="op" id="8560360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560363"><a href="/compress/gzip/gzip_test.go.html#8560282">w</a></span><span class="op" id="8560364">.</span><span class="ident" id="8560365">Write</span><span class="op" id="8560370">(</span><span class="op" id="8560371">[</span><span class="op" id="8560372">]</span><span class="builtintype" id="8560373">byte</span><span class="op" id="8560377">(</span><span class="string" id="8560378">&#34;world\n&#34;</span><span class="op" id="8560387">)</span><span class="op" id="8560388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560391"><a href="/compress/gzip/gzip_test.go.html#8560282">w</a></span><span class="op" id="8560392">.</span><span class="ident" id="8560393">Close</span><span class="op" id="8560398">(</span><span class="op" id="8560399">)</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560403">r</span><span class="op" id="8560404">,</span>&nbsp;<span class="ident" id="8560406">err</span>&nbsp;<span class="op" id="8560410">:=</span>&nbsp;<span class="ident" id="8560413"><a href="/compress/gzip/gunzip.go.html#4539946">NewReader</a></span><span class="op" id="8560422">(</span><span class="op" id="8560423">&amp;</span><span class="ident" id="8560424"><a href="/compress/gzip/gzip_test.go.html#8560264">buf</a></span><span class="op" id="8560427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560430">data</span><span class="op" id="8560434">,</span>&nbsp;<span class="ident" id="8560436"><a href="/compress/gzip/gzip_test.go.html#8560406">err</a></span>&nbsp;<span class="op" id="8560440">:=</span>&nbsp;<span class="ident" id="8560443"><a href="/compress/gzip/gzip_test.go.html#8555926">ioutil</a></span><span class="op" id="8560449">.</span><span class="ident" id="8560450">ReadAll</span><span class="op" id="8560457">(</span><span class="ident" id="8560458"><a href="/compress/gzip/gzip_test.go.html#8560403">r</a></span><span class="op" id="8560459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8560462">if</span>&nbsp;<span class="builtintype" id="8560465">string</span><span class="op" id="8560471">(</span><span class="ident" id="8560472"><a href="/compress/gzip/gzip_test.go.html#8560430">data</a></span><span class="op" id="8560476">)</span>&nbsp;<span class="op" id="8560478">!=</span>&nbsp;<span class="string" id="8560481">&#34;hello&nbsp;world\n&#34;</span>&nbsp;<span class="op" id="8560497">||</span>&nbsp;<span class="ident" id="8560500"><a href="/compress/gzip/gzip_test.go.html#8560406">err</a></span>&nbsp;<span class="op" id="8560504">!=</span>&nbsp;<span class="ident" id="8560507">nil</span>&nbsp;<span class="op" id="8560511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560515"><a href="/compress/gzip/gzip_test.go.html#8560243">t</a></span><span class="op" id="8560516">.</span><span class="ident" id="8560517">Fatalf</span><span class="op" id="8560523">(</span><span class="string" id="8560524">&#34;ReadAll&nbsp;=&nbsp;%q,&nbsp;%v,&nbsp;want&nbsp;%q,&nbsp;nil&#34;</span><span class="op" id="8560556">,</span>&nbsp;<span class="ident" id="8560558"><a href="/compress/gzip/gzip_test.go.html#8560430">data</a></span><span class="op" id="8560562">,</span>&nbsp;<span class="ident" id="8560564"><a href="/compress/gzip/gzip_test.go.html#8560406">err</a></span><span class="op" id="8560567">,</span>&nbsp;<span class="string" id="8560569">&#34;hello&nbsp;world&#34;</span><span class="op" id="8560582">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8560585">}</span><br>
<span class="lineno"></span><span class="op" id="8560587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8560590">func</span>&nbsp;<span class="ident" id="8560595">TestWriterReset</span><span class="op" id="8560610">(</span><span class="ident" id="8560611">t</span>&nbsp;<span class="op" id="8560613">*</span><span class="ident" id="8560614"><a href="/compress/gzip/gzip_test.go.html#8555939">testing</a></span><span class="op" id="8560621">.</span><span class="ident" id="8560622">T</span><span class="op" id="8560623">)</span>&nbsp;<span class="op" id="8560625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560628">buf</span>&nbsp;<span class="op" id="8560632">:=</span>&nbsp;<span class="builtinfunc" id="8560635">new</span><span class="op" id="8560638">(</span><span class="ident" id="8560639"><a href="/compress/gzip/gzip_test.go.html#8555917">bytes</a></span><span class="op" id="8560644">.</span><span class="ident" id="8560645">Buffer</span><span class="op" id="8560651">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560654">buf2</span>&nbsp;<span class="op" id="8560659">:=</span>&nbsp;<span class="builtinfunc" id="8560662">new</span><span class="op" id="8560665">(</span><span class="ident" id="8560666"><a href="/compress/gzip/gzip_test.go.html#8555917">bytes</a></span><span class="op" id="8560671">.</span><span class="ident" id="8560672">Buffer</span><span class="op" id="8560678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560681">z</span>&nbsp;<span class="op" id="8560683">:=</span>&nbsp;<span class="ident" id="8560686"><a href="/compress/gzip/gzip.go.html#4546176">NewWriter</a></span><span class="op" id="8560695">(</span><span class="ident" id="8560696"><a href="/compress/gzip/gzip_test.go.html#8560628">buf</a></span><span class="op" id="8560699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560702">msg</span>&nbsp;<span class="op" id="8560706">:=</span>&nbsp;<span class="op" id="8560709">[</span><span class="op" id="8560710">]</span><span class="builtintype" id="8560711">byte</span><span class="op" id="8560715">(</span><span class="string" id="8560716">&#34;hello&nbsp;world&#34;</span><span class="op" id="8560729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560732"><a href="/compress/gzip/gzip_test.go.html#8560681">z</a></span><span class="op" id="8560733">.</span><span class="ident" id="8560734">Write</span><span class="op" id="8560739">(</span><span class="ident" id="8560740"><a href="/compress/gzip/gzip_test.go.html#8560702">msg</a></span><span class="op" id="8560743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560746"><a href="/compress/gzip/gzip_test.go.html#8560681">z</a></span><span class="op" id="8560747">.</span><span class="ident" id="8560748">Close</span><span class="op" id="8560753">(</span><span class="op" id="8560754">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560757"><a href="/compress/gzip/gzip_test.go.html#8560681">z</a></span><span class="op" id="8560758">.</span><span class="ident" id="8560759">Reset</span><span class="op" id="8560764">(</span><span class="ident" id="8560765"><a href="/compress/gzip/gzip_test.go.html#8560654">buf2</a></span><span class="op" id="8560769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560772"><a href="/compress/gzip/gzip_test.go.html#8560681">z</a></span><span class="op" id="8560773">.</span><span class="ident" id="8560774">Write</span><span class="op" id="8560779">(</span><span class="ident" id="8560780"><a href="/compress/gzip/gzip_test.go.html#8560702">msg</a></span><span class="op" id="8560783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560786"><a href="/compress/gzip/gzip_test.go.html#8560681">z</a></span><span class="op" id="8560787">.</span><span class="ident" id="8560788">Close</span><span class="op" id="8560793">(</span><span class="op" id="8560794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8560797">if</span>&nbsp;<span class="ident" id="8560800"><a href="/compress/gzip/gzip_test.go.html#8560628">buf</a></span><span class="op" id="8560803">.</span><span class="ident" id="8560804">String</span><span class="op" id="8560810">(</span><span class="op" id="8560811">)</span>&nbsp;<span class="op" id="8560813">!=</span>&nbsp;<span class="ident" id="8560816"><a href="/compress/gzip/gzip_test.go.html#8560654">buf2</a></span><span class="op" id="8560820">.</span><span class="ident" id="8560821">String</span><span class="op" id="8560827">(</span><span class="op" id="8560828">)</span>&nbsp;<span class="op" id="8560830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8560834"><a href="/compress/gzip/gzip_test.go.html#8560611">t</a></span><span class="op" id="8560835">.</span><span class="ident" id="8560836">Errorf</span><span class="op" id="8560842">(</span><span class="string" id="8560843">&#34;buf2&nbsp;%q&nbsp;!=&nbsp;original&nbsp;buf&nbsp;of&nbsp;%q&#34;</span><span class="op" id="8560874">,</span>&nbsp;<span class="ident" id="8560876"><a href="/compress/gzip/gzip_test.go.html#8560654">buf2</a></span><span class="op" id="8560880">.</span><span class="ident" id="8560881">String</span><span class="op" id="8560887">(</span><span class="op" id="8560888">)</span><span class="op" id="8560889">,</span>&nbsp;<span class="ident" id="8560891"><a href="/compress/gzip/gzip_test.go.html#8560628">buf</a></span><span class="op" id="8560894">.</span><span class="ident" id="8560895">String</span><span class="op" id="8560901">(</span><span class="op" id="8560902">)</span><span class="op" id="8560903">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8560906">}</span><br>
<span class="lineno"></span><span class="op" id="8560908">}</span>
</div>
</body>
</html>
