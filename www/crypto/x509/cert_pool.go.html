<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3997615">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3997670">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3997724">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3997775">package</span>&nbsp;<span class="ident" id="3997783">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3997789">import</span>&nbsp;<span class="op" id="3997796">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3997799">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span><span class="op" id="3997814">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3997817">//&nbsp;CertPool&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="3997855">type</span>&nbsp;<span class="ident" id="3997860">CertPool</span>&nbsp;<span class="keyword" id="3997869">struct</span>&nbsp;<span class="op" id="3997876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3997879">bySubjectKeyId</span>&nbsp;<span class="keyword" id="3997894">map</span><span class="op" id="3997897">[</span><span class="builtintype" id="3997898">string</span><span class="op" id="3997904">]</span><span class="op" id="3997905">[</span><span class="op" id="3997906">]</span><span class="builtintype" id="3997907">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3997912">byName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3997927">map</span><span class="op" id="3997930">[</span><span class="builtintype" id="3997931">string</span><span class="op" id="3997937">]</span><span class="op" id="3997938">[</span><span class="op" id="3997939">]</span><span class="builtintype" id="3997940">int</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3997945">certs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3997960">[</span><span class="op" id="3997961">]</span><span class="op" id="3997962">*</span><span class="ident" id="3997963"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><br>
<span class="lineno"></span><span class="op" id="3997975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3997978">//&nbsp;NewCertPool&nbsp;returns&nbsp;a&nbsp;new,&nbsp;empty&nbsp;CertPool.</span><br>
<span class="lineno"></span><span class="keyword" id="3998024">func</span>&nbsp;<span class="ident" id="3998029">NewCertPool</span><span class="op" id="3998040">(</span><span class="op" id="3998041">)</span>&nbsp;<span class="op" id="3998043">*</span><span class="ident" id="3998044"><a href="/crypto/x509/cert_pool.go.html#3997860">CertPool</a></span>&nbsp;<span class="op" id="3998053">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998056">return</span>&nbsp;<span class="op" id="3998063">&amp;</span><span class="ident" id="3998064"><a href="/crypto/x509/cert_pool.go.html#3997860">CertPool</a></span><span class="op" id="3998072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3998076">make</span><span class="op" id="3998080">(</span><span class="keyword" id="3998081">map</span><span class="op" id="3998084">[</span><span class="builtintype" id="3998085">string</span><span class="op" id="3998091">]</span><span class="op" id="3998092">[</span><span class="op" id="3998093">]</span><span class="builtintype" id="3998094">int</span><span class="op" id="3998097">)</span><span class="op" id="3998098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3998102">make</span><span class="op" id="3998106">(</span><span class="keyword" id="3998107">map</span><span class="op" id="3998110">[</span><span class="builtintype" id="3998111">string</span><span class="op" id="3998117">]</span><span class="op" id="3998118">[</span><span class="op" id="3998119">]</span><span class="builtintype" id="3998120">int</span><span class="op" id="3998123">)</span><span class="op" id="3998124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998128">nil</span><span class="op" id="3998131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998134">}</span><br>
<span class="lineno">25</span><span class="op" id="3998136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3998139">//&nbsp;findVerifiedParents&nbsp;attempts&nbsp;to&nbsp;find&nbsp;certificates&nbsp;in&nbsp;s&nbsp;which&nbsp;have&nbsp;signed&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3998219">//&nbsp;given&nbsp;certificate.&nbsp;If&nbsp;any&nbsp;candidates&nbsp;were&nbsp;rejected&nbsp;then&nbsp;errCert&nbsp;will&nbsp;be&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="3998298">//&nbsp;to&nbsp;one&nbsp;of&nbsp;them,&nbsp;arbitrarily,&nbsp;and&nbsp;err&nbsp;will&nbsp;contain&nbsp;the&nbsp;reason&nbsp;that&nbsp;it&nbsp;was</span><br>
<span class="lineno">30</span><span class="comment" id="3998374">//&nbsp;rejected.</span><br>
<span class="lineno"></span><span class="keyword" id="3998387">func</span>&nbsp;<span class="op" id="3998392">(</span><span class="ident" id="3998393">s</span>&nbsp;<span class="op" id="3998395">*</span><span class="ident" id="3998396"><a href="/crypto/x509/cert_pool.go.html#3997860">CertPool</a></span><span class="op" id="3998404">)</span>&nbsp;<span class="ident" id="3998406">findVerifiedParents</span><span class="op" id="3998425">(</span><span class="ident" id="3998426">cert</span>&nbsp;<span class="op" id="3998431">*</span><span class="ident" id="3998432"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="3998443">)</span>&nbsp;<span class="op" id="3998445">(</span><span class="ident" id="3998446">parents</span>&nbsp;<span class="op" id="3998454">[</span><span class="op" id="3998455">]</span><span class="builtintype" id="3998456">int</span><span class="op" id="3998459">,</span>&nbsp;<span class="ident" id="3998461">errCert</span>&nbsp;<span class="op" id="3998469">*</span><span class="ident" id="3998470"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="3998481">,</span>&nbsp;<span class="ident" id="3998483">err</span>&nbsp;<span class="builtintype" id="3998487">error</span><span class="op" id="3998492">)</span>&nbsp;<span class="op" id="3998494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998497">if</span>&nbsp;<span class="ident" id="3998500"><a href="/crypto/x509/cert_pool.go.html#3998393">s</a></span>&nbsp;<span class="op" id="3998502">==</span>&nbsp;<span class="ident" id="3998505">nil</span>&nbsp;<span class="op" id="3998509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998513">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998521">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998524">var</span>&nbsp;<span class="ident" id="3998528">candidates</span>&nbsp;<span class="op" id="3998539">[</span><span class="op" id="3998540">]</span><span class="builtintype" id="3998541">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998547">if</span>&nbsp;<span class="builtinfunc" id="3998550">len</span><span class="op" id="3998553">(</span><span class="ident" id="3998554"><a href="/crypto/x509/cert_pool.go.html#3998426">cert</a></span><span class="op" id="3998558">.</span><span class="ident" id="3998559">AuthorityKeyId</span><span class="op" id="3998573">)</span>&nbsp;<span class="op" id="3998575">&gt;</span>&nbsp;<span class="num" id="3998577">0</span>&nbsp;<span class="op" id="3998579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998583"><a href="/crypto/x509/cert_pool.go.html#3998528">candidates</a></span>&nbsp;<span class="op" id="3998594">=</span>&nbsp;<span class="ident" id="3998596"><a href="/crypto/x509/cert_pool.go.html#3998393">s</a></span><span class="op" id="3998597">.</span><span class="ident" id="3998598">bySubjectKeyId</span><span class="op" id="3998612">[</span><span class="builtintype" id="3998613">string</span><span class="op" id="3998619">(</span><span class="ident" id="3998620"><a href="/crypto/x509/cert_pool.go.html#3998426">cert</a></span><span class="op" id="3998624">.</span><span class="ident" id="3998625">AuthorityKeyId</span><span class="op" id="3998639">)</span><span class="op" id="3998640">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998643">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998646">if</span>&nbsp;<span class="builtinfunc" id="3998649">len</span><span class="op" id="3998652">(</span><span class="ident" id="3998653"><a href="/crypto/x509/cert_pool.go.html#3998528">candidates</a></span><span class="op" id="3998663">)</span>&nbsp;<span class="op" id="3998665">==</span>&nbsp;<span class="num" id="3998668">0</span>&nbsp;<span class="op" id="3998670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998674"><a href="/crypto/x509/cert_pool.go.html#3998528">candidates</a></span>&nbsp;<span class="op" id="3998685">=</span>&nbsp;<span class="ident" id="3998687"><a href="/crypto/x509/cert_pool.go.html#3998393">s</a></span><span class="op" id="3998688">.</span><span class="ident" id="3998689">byName</span><span class="op" id="3998695">[</span><span class="builtintype" id="3998696">string</span><span class="op" id="3998702">(</span><span class="ident" id="3998703"><a href="/crypto/x509/cert_pool.go.html#3998426">cert</a></span><span class="op" id="3998707">.</span><span class="ident" id="3998708">RawIssuer</span><span class="op" id="3998717">)</span><span class="op" id="3998718">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998725">for</span>&nbsp;<span class="ident" id="3998729">_</span><span class="op" id="3998730">,</span>&nbsp;<span class="ident" id="3998732">c</span>&nbsp;<span class="op" id="3998734">:=</span>&nbsp;<span class="keyword" id="3998737">range</span>&nbsp;<span class="ident" id="3998743"><a href="/crypto/x509/cert_pool.go.html#3998528">candidates</a></span>&nbsp;<span class="op" id="3998754">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998758">if</span>&nbsp;<span class="ident" id="3998761"><a href="/crypto/x509/cert_pool.go.html#3998483">err</a></span>&nbsp;<span class="op" id="3998765">=</span>&nbsp;<span class="ident" id="3998767"><a href="/crypto/x509/cert_pool.go.html#3998426">cert</a></span><span class="op" id="3998771">.</span><span class="ident" id="3998772">CheckSignatureFrom</span><span class="op" id="3998790">(</span><span class="ident" id="3998791"><a href="/crypto/x509/cert_pool.go.html#3998393">s</a></span><span class="op" id="3998792">.</span><span class="ident" id="3998793">certs</span><span class="op" id="3998798">[</span><span class="ident" id="3998799"><a href="/crypto/x509/cert_pool.go.html#3998732">c</a></span><span class="op" id="3998800">]</span><span class="op" id="3998801">)</span><span class="op" id="3998802">;</span>&nbsp;<span class="ident" id="3998804"><a href="/crypto/x509/cert_pool.go.html#3998483">err</a></span>&nbsp;<span class="op" id="3998808">==</span>&nbsp;<span class="ident" id="3998811">nil</span>&nbsp;<span class="op" id="3998815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998820"><a href="/crypto/x509/cert_pool.go.html#3998446">parents</a></span>&nbsp;<span class="op" id="3998828">=</span>&nbsp;<span class="builtinfunc" id="3998830">append</span><span class="op" id="3998836">(</span><span class="ident" id="3998837"><a href="/crypto/x509/cert_pool.go.html#3998446">parents</a></span><span class="op" id="3998844">,</span>&nbsp;<span class="ident" id="3998846"><a href="/crypto/x509/cert_pool.go.html#3998732">c</a></span><span class="op" id="3998847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998851">}</span>&nbsp;<span class="keyword" id="3998853">else</span>&nbsp;<span class="op" id="3998858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3998863"><a href="/crypto/x509/cert_pool.go.html#3998461">errCert</a></span>&nbsp;<span class="op" id="3998871">=</span>&nbsp;<span class="ident" id="3998873"><a href="/crypto/x509/cert_pool.go.html#3998393">s</a></span><span class="op" id="3998874">.</span><span class="ident" id="3998875">certs</span><span class="op" id="3998880">[</span><span class="ident" id="3998881"><a href="/crypto/x509/cert_pool.go.html#3998732">c</a></span><span class="op" id="3998882">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998886">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3998889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998893">return</span><br>
<span class="lineno"></span><span class="op" id="3998900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="3998903">//&nbsp;AddCert&nbsp;adds&nbsp;a&nbsp;certificate&nbsp;to&nbsp;a&nbsp;pool.</span><br>
<span class="lineno"></span><span class="keyword" id="3998944">func</span>&nbsp;<span class="op" id="3998949">(</span><span class="ident" id="3998950">s</span>&nbsp;<span class="op" id="3998952">*</span><span class="ident" id="3998953"><a href="/crypto/x509/cert_pool.go.html#3997860">CertPool</a></span><span class="op" id="3998961">)</span>&nbsp;<span class="ident" id="3998963">AddCert</span><span class="op" id="3998970">(</span><span class="ident" id="3998971">cert</span>&nbsp;<span class="op" id="3998976">*</span><span class="ident" id="3998977"><a href="/crypto/x509/x509.go.html#4044200">Certificate</a></span><span class="op" id="3998988">)</span>&nbsp;<span class="op" id="3998990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3998993">if</span>&nbsp;<span class="ident" id="3998996"><a href="/crypto/x509/cert_pool.go.html#3998971">cert</a></span>&nbsp;<span class="op" id="3999001">==</span>&nbsp;<span class="ident" id="3999004">nil</span>&nbsp;<span class="op" id="3999008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3999012">panic</span><span class="op" id="3999017">(</span><span class="string" id="3999018">&#34;adding&nbsp;nil&nbsp;Certificate&nbsp;to&nbsp;CertPool&#34;</span><span class="op" id="3999054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3999057">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3999061">//&nbsp;Check&nbsp;that&nbsp;the&nbsp;certificate&nbsp;isn&#39;t&nbsp;being&nbsp;added&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999117">for</span>&nbsp;<span class="ident" id="3999121">_</span><span class="op" id="3999122">,</span>&nbsp;<span class="ident" id="3999124">c</span>&nbsp;<span class="op" id="3999126">:=</span>&nbsp;<span class="keyword" id="3999129">range</span>&nbsp;<span class="ident" id="3999135"><a href="/crypto/x509/cert_pool.go.html#3998950">s</a></span><span class="op" id="3999136">.</span><span class="ident" id="3999137">certs</span>&nbsp;<span class="op" id="3999143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999147">if</span>&nbsp;<span class="ident" id="3999150"><a href="/crypto/x509/cert_pool.go.html#3999124">c</a></span><span class="op" id="3999151">.</span><span class="ident" id="3999152">Equal</span><span class="op" id="3999157">(</span><span class="ident" id="3999158"><a href="/crypto/x509/cert_pool.go.html#3998971">cert</a></span><span class="op" id="3999162">)</span>&nbsp;<span class="op" id="3999164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999169">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3999178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3999181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999185">n</span>&nbsp;<span class="op" id="3999187">:=</span>&nbsp;<span class="builtinfunc" id="3999190">len</span><span class="op" id="3999193">(</span><span class="ident" id="3999194"><a href="/crypto/x509/cert_pool.go.html#3998950">s</a></span><span class="op" id="3999195">.</span><span class="ident" id="3999196">certs</span><span class="op" id="3999201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999204"><a href="/crypto/x509/cert_pool.go.html#3998950">s</a></span><span class="op" id="3999205">.</span><span class="ident" id="3999206">certs</span>&nbsp;<span class="op" id="3999212">=</span>&nbsp;<span class="builtinfunc" id="3999214">append</span><span class="op" id="3999220">(</span><span class="ident" id="3999221"><a href="/crypto/x509/cert_pool.go.html#3998950">s</a></span><span class="op" id="3999222">.</span><span class="ident" id="3999223">certs</span><span class="op" id="3999228">,</span>&nbsp;<span class="ident" id="3999230"><a href="/crypto/x509/cert_pool.go.html#3998971">cert</a></span><span class="op" id="3999234">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999238">if</span>&nbsp;<span class="builtinfunc" id="3999241">len</span><span class="op" id="3999244">(</span><span class="ident" id="3999245"><a href="/crypto/x509/cert_pool.go.html#3998971">cert</a></span><span class="op" id="3999249">.</span><span class="ident" id="3999250">SubjectKeyId</span><span class="op" id="3999262">)</span>&nbsp;<span class="op" id="3999264">&gt;</span>&nbsp;<span class="num" id="3999266">0</span>&nbsp;<span class="op" id="3999268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999272">keyId</span>&nbsp;<span class="op" id="3999278">:=</span>&nbsp;<span class="builtintype" id="3999281">string</span><span class="op" id="3999287">(</span><span class="ident" id="3999288"><a href="/crypto/x509/cert_pool.go.html#3998971">cert</a></span><span class="op" id="3999292">.</span><span class="ident" id="3999293">SubjectKeyId</span><span class="op" id="3999305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999309"><a href="/crypto/x509/cert_pool.go.html#3998950">s</a></span><span class="op" id="3999310">.</span><span class="ident" id="3999311">bySubjectKeyId</span><span class="op" id="3999325">[</span><span class="ident" id="3999326"><a href="/crypto/x509/cert_pool.go.html#3999272">keyId</a></span><span class="op" id="3999331">]</span>&nbsp;<span class="op" id="3999333">=</span>&nbsp;<span class="builtinfunc" id="3999335">append</span><span class="op" id="3999341">(</span><span class="ident" id="3999342"><a href="/crypto/x509/cert_pool.go.html#3998950">s</a></span><span class="op" id="3999343">.</span><span class="ident" id="3999344">bySubjectKeyId</span><span class="op" id="3999358">[</span><span class="ident" id="3999359"><a href="/crypto/x509/cert_pool.go.html#3999272">keyId</a></span><span class="op" id="3999364">]</span><span class="op" id="3999365">,</span>&nbsp;<span class="ident" id="3999367"><a href="/crypto/x509/cert_pool.go.html#3999185">n</a></span><span class="op" id="3999368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3999371">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999374">name</span>&nbsp;<span class="op" id="3999379">:=</span>&nbsp;<span class="builtintype" id="3999382">string</span><span class="op" id="3999388">(</span><span class="ident" id="3999389"><a href="/crypto/x509/cert_pool.go.html#3998971">cert</a></span><span class="op" id="3999393">.</span><span class="ident" id="3999394">RawSubject</span><span class="op" id="3999404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999407"><a href="/crypto/x509/cert_pool.go.html#3998950">s</a></span><span class="op" id="3999408">.</span><span class="ident" id="3999409">byName</span><span class="op" id="3999415">[</span><span class="ident" id="3999416"><a href="/crypto/x509/cert_pool.go.html#3999374">name</a></span><span class="op" id="3999420">]</span>&nbsp;<span class="op" id="3999422">=</span>&nbsp;<span class="builtinfunc" id="3999424">append</span><span class="op" id="3999430">(</span><span class="ident" id="3999431"><a href="/crypto/x509/cert_pool.go.html#3998950">s</a></span><span class="op" id="3999432">.</span><span class="ident" id="3999433">byName</span><span class="op" id="3999439">[</span><span class="ident" id="3999440"><a href="/crypto/x509/cert_pool.go.html#3999374">name</a></span><span class="op" id="3999444">]</span><span class="op" id="3999445">,</span>&nbsp;<span class="ident" id="3999447"><a href="/crypto/x509/cert_pool.go.html#3999185">n</a></span><span class="op" id="3999448">)</span><br>
<span class="lineno"></span><span class="op" id="3999450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3999453">//&nbsp;AppendCertsFromPEM&nbsp;attempts&nbsp;to&nbsp;parse&nbsp;a&nbsp;series&nbsp;of&nbsp;PEM&nbsp;encoded&nbsp;certificates.</span><br>
<span class="lineno">80</span><span class="comment" id="3999531">//&nbsp;It&nbsp;appends&nbsp;any&nbsp;certificates&nbsp;found&nbsp;to&nbsp;s&nbsp;and&nbsp;returns&nbsp;true&nbsp;if&nbsp;any&nbsp;certificates</span><br>
<span class="lineno"></span><span class="comment" id="3999610">//&nbsp;were&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="comment" id="3999639">//</span><br>
<span class="lineno"></span><span class="comment" id="3999642">//&nbsp;On&nbsp;many&nbsp;Linux&nbsp;systems,&nbsp;/etc/ssl/cert.pem&nbsp;will&nbsp;contain&nbsp;the&nbsp;system&nbsp;wide&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="3999719">//&nbsp;of&nbsp;root&nbsp;CAs&nbsp;in&nbsp;a&nbsp;format&nbsp;suitable&nbsp;for&nbsp;this&nbsp;function.</span><br>
<span class="lineno">85</span><span class="keyword" id="3999774">func</span>&nbsp;<span class="op" id="3999779">(</span><span class="ident" id="3999780">s</span>&nbsp;<span class="op" id="3999782">*</span><span class="ident" id="3999783"><a href="/crypto/x509/cert_pool.go.html#3997860">CertPool</a></span><span class="op" id="3999791">)</span>&nbsp;<span class="ident" id="3999793">AppendCertsFromPEM</span><span class="op" id="3999811">(</span><span class="ident" id="3999812">pemCerts</span>&nbsp;<span class="op" id="3999821">[</span><span class="op" id="3999822">]</span><span class="builtintype" id="3999823">byte</span><span class="op" id="3999827">)</span>&nbsp;<span class="op" id="3999829">(</span><span class="ident" id="3999830">ok</span>&nbsp;<span class="builtintype" id="3999833">bool</span><span class="op" id="3999837">)</span>&nbsp;<span class="op" id="3999839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999842">for</span>&nbsp;<span class="builtinfunc" id="3999846">len</span><span class="op" id="3999849">(</span><span class="ident" id="3999850"><a href="/crypto/x509/cert_pool.go.html#3999812">pemCerts</a></span><span class="op" id="3999858">)</span>&nbsp;<span class="op" id="3999860">&gt;</span>&nbsp;<span class="num" id="3999862">0</span>&nbsp;<span class="op" id="3999864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999868">var</span>&nbsp;<span class="ident" id="3999872">block</span>&nbsp;<span class="op" id="3999878">*</span><span class="ident" id="3999879"><a href="/crypto/x509/cert_pool.go.html#3997799">pem</a></span><span class="op" id="3999882">.</span><span class="ident" id="3999883">Block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3999891"><a href="/crypto/x509/cert_pool.go.html#3999872">block</a></span><span class="op" id="3999896">,</span>&nbsp;<span class="ident" id="3999898"><a href="/crypto/x509/cert_pool.go.html#3999812">pemCerts</a></span>&nbsp;<span class="op" id="3999907">=</span>&nbsp;<span class="ident" id="3999909"><a href="/crypto/x509/cert_pool.go.html#3997799">pem</a></span><span class="op" id="3999912">.</span><span class="ident" id="3999913">Decode</span><span class="op" id="3999919">(</span><span class="ident" id="3999920"><a href="/crypto/x509/cert_pool.go.html#3999812">pemCerts</a></span><span class="op" id="3999928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999932">if</span>&nbsp;<span class="ident" id="3999935"><a href="/crypto/x509/cert_pool.go.html#3999872">block</a></span>&nbsp;<span class="op" id="3999941">==</span>&nbsp;<span class="ident" id="3999944">nil</span>&nbsp;<span class="op" id="3999948">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999953">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3999961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3999965">if</span>&nbsp;<span class="ident" id="3999968"><a href="/crypto/x509/cert_pool.go.html#3999872">block</a></span><span class="op" id="3999973">.</span><span class="ident" id="3999974">Type</span>&nbsp;<span class="op" id="3999979">!=</span>&nbsp;<span class="string" id="3999982">&#34;CERTIFICATE&#34;</span>&nbsp;<span class="op" id="3999996">||</span>&nbsp;<span class="builtinfunc" id="3999999">len</span><span class="op" id="4000002">(</span><span class="ident" id="4000003"><a href="/crypto/x509/cert_pool.go.html#3999872">block</a></span><span class="op" id="4000008">.</span><span class="ident" id="4000009">Headers</span><span class="op" id="4000016">)</span>&nbsp;<span class="op" id="4000018">!=</span>&nbsp;<span class="num" id="4000021">0</span>&nbsp;<span class="op" id="4000023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000028">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4000039">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000044">cert</span><span class="op" id="4000048">,</span>&nbsp;<span class="ident" id="4000050">err</span>&nbsp;<span class="op" id="4000054">:=</span>&nbsp;<span class="ident" id="4000057"><a href="/crypto/x509/x509.go.html#4063943">ParseCertificate</a></span><span class="op" id="4000073">(</span><span class="ident" id="4000074"><a href="/crypto/x509/cert_pool.go.html#3999872">block</a></span><span class="op" id="4000079">.</span><span class="ident" id="4000080">Bytes</span><span class="op" id="4000085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000089">if</span>&nbsp;<span class="ident" id="4000092"><a href="/crypto/x509/cert_pool.go.html#4000050">err</a></span>&nbsp;<span class="op" id="4000096">!=</span>&nbsp;<span class="ident" id="4000099">nil</span>&nbsp;<span class="op" id="4000103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000108">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4000119">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000124"><a href="/crypto/x509/cert_pool.go.html#3999780">s</a></span><span class="op" id="4000125">.</span><span class="ident" id="4000126">AddCert</span><span class="op" id="4000133">(</span><span class="ident" id="4000134"><a href="/crypto/x509/cert_pool.go.html#4000044">cert</a></span><span class="op" id="4000138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000142"><a href="/crypto/x509/cert_pool.go.html#3999830">ok</a></span>&nbsp;<span class="op" id="4000145">=</span>&nbsp;<span class="builtintype" id="4000147">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4000153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000157">return</span><br>
<span class="lineno"></span><span class="op" id="4000164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4000167">//&nbsp;Subjects&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;the&nbsp;DER-encoded&nbsp;subjects&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4000225">//&nbsp;all&nbsp;of&nbsp;the&nbsp;certificates&nbsp;in&nbsp;the&nbsp;pool.</span><br>
<span class="lineno">110</span><span class="keyword" id="4000265">func</span>&nbsp;<span class="op" id="4000270">(</span><span class="ident" id="4000271">s</span>&nbsp;<span class="op" id="4000273">*</span><span class="ident" id="4000274"><a href="/crypto/x509/cert_pool.go.html#3997860">CertPool</a></span><span class="op" id="4000282">)</span>&nbsp;<span class="ident" id="4000284">Subjects</span><span class="op" id="4000292">(</span><span class="op" id="4000293">)</span>&nbsp;<span class="op" id="4000295">(</span><span class="ident" id="4000296">res</span>&nbsp;<span class="op" id="4000300">[</span><span class="op" id="4000301">]</span><span class="op" id="4000302">[</span><span class="op" id="4000303">]</span><span class="builtintype" id="4000304">byte</span><span class="op" id="4000308">)</span>&nbsp;<span class="op" id="4000310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000313"><a href="/crypto/x509/cert_pool.go.html#4000296">res</a></span>&nbsp;<span class="op" id="4000317">=</span>&nbsp;<span class="builtinfunc" id="4000319">make</span><span class="op" id="4000323">(</span><span class="op" id="4000324">[</span><span class="op" id="4000325">]</span><span class="op" id="4000326">[</span><span class="op" id="4000327">]</span><span class="builtintype" id="4000328">byte</span><span class="op" id="4000332">,</span>&nbsp;<span class="builtinfunc" id="4000334">len</span><span class="op" id="4000337">(</span><span class="ident" id="4000338"><a href="/crypto/x509/cert_pool.go.html#4000271">s</a></span><span class="op" id="4000339">.</span><span class="ident" id="4000340">certs</span><span class="op" id="4000345">)</span><span class="op" id="4000346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000349">for</span>&nbsp;<span class="ident" id="4000353">i</span><span class="op" id="4000354">,</span>&nbsp;<span class="ident" id="4000356">c</span>&nbsp;<span class="op" id="4000358">:=</span>&nbsp;<span class="keyword" id="4000361">range</span>&nbsp;<span class="ident" id="4000367"><a href="/crypto/x509/cert_pool.go.html#4000271">s</a></span><span class="op" id="4000368">.</span><span class="ident" id="4000369">certs</span>&nbsp;<span class="op" id="4000375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4000379"><a href="/crypto/x509/cert_pool.go.html#4000296">res</a></span><span class="op" id="4000382">[</span><span class="ident" id="4000383"><a href="/crypto/x509/cert_pool.go.html#4000353">i</a></span><span class="op" id="4000384">]</span>&nbsp;<span class="op" id="4000386">=</span>&nbsp;<span class="ident" id="4000388"><a href="/crypto/x509/cert_pool.go.html#4000356">c</a></span><span class="op" id="4000389">.</span><span class="ident" id="4000390">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4000402">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4000405">return</span><br>
<span class="lineno"></span><span class="op" id="4000412">}</span>
</div>
</body>
</html>
