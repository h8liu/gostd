<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>index/suffixarray</h2>
<ul>
<li><a href="/gostd/index/suffixarray/qsufsort.go.html">qsufsort.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray.go.html">suffixarray.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray_test.go.html">suffixarray_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7598835">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7598890">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7598944">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7598995">package</span>&nbsp;<span class="ident" id="7599003">suffixarray</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7599016">import</span>&nbsp;<span class="op" id="7599023">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599026">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599035">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599048">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599058">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599066">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599077">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7599087">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7599090">type</span>&nbsp;<span class="ident" id="7599095">testCase</span>&nbsp;<span class="keyword" id="7599104">struct</span>&nbsp;<span class="op" id="7599111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7599114">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7599123">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7599132">//&nbsp;name&nbsp;of&nbsp;test&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7599154">source</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7599163">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7599172">//&nbsp;source&nbsp;to&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7599192">patterns</span>&nbsp;<span class="op" id="7599201">[</span><span class="op" id="7599202">]</span><span class="builtintype" id="7599203">string</span>&nbsp;<span class="comment" id="7599210">//&nbsp;patterns&nbsp;to&nbsp;lookup</span><br>
<span class="lineno">20</span><span class="op" id="7599232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7599235">var</span>&nbsp;<span class="ident" id="7599239">testCases</span>&nbsp;<span class="op" id="7599249">=</span>&nbsp;<span class="op" id="7599251">[</span><span class="op" id="7599252">]</span><span class="ident" id="7599253">testCase</span><span class="op" id="7599261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599268">&#34;empty&nbsp;string&#34;</span><span class="op" id="7599282">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599286">&#34;&#34;</span><span class="op" id="7599288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599292">[</span><span class="op" id="7599293">]</span><span class="builtintype" id="7599294">string</span><span class="op" id="7599300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599305">&#34;&#34;</span><span class="op" id="7599307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599312">&#34;foo&#34;</span><span class="op" id="7599317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599322">&#34;(foo)&#34;</span><span class="op" id="7599329">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599334">&#34;.*&#34;</span><span class="op" id="7599338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599343">&#34;a*&#34;</span><span class="op" id="7599347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599351">}</span><span class="op" id="7599352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599355">}</span><span class="op" id="7599356">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599364">&#34;all&nbsp;a&#39;s&#34;</span><span class="op" id="7599373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599377">&#34;aaaaaaaaaa&#34;</span><span class="op" id="7599389">,</span>&nbsp;<span class="comment" id="7599391">//&nbsp;10&nbsp;a&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599403">[</span><span class="op" id="7599404">]</span><span class="builtintype" id="7599405">string</span><span class="op" id="7599411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599416">&#34;&#34;</span><span class="op" id="7599418">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599423">&#34;a&#34;</span><span class="op" id="7599426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599431">&#34;aa&#34;</span><span class="op" id="7599435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599440">&#34;aaa&#34;</span><span class="op" id="7599445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599450">&#34;aaaa&#34;</span><span class="op" id="7599456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599461">&#34;aaaaa&#34;</span><span class="op" id="7599468">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599473">&#34;aaaaaa&#34;</span><span class="op" id="7599481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599486">&#34;aaaaaaa&#34;</span><span class="op" id="7599495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599500">&#34;aaaaaaaa&#34;</span><span class="op" id="7599510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599515">&#34;aaaaaaaaa&#34;</span><span class="op" id="7599526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599531">&#34;aaaaaaaaaa&#34;</span><span class="op" id="7599543">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599548">&#34;aaaaaaaaaaa&#34;</span><span class="op" id="7599561">,</span>&nbsp;<span class="comment" id="7599563">//&nbsp;11&nbsp;a&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599576">&#34;.&#34;</span><span class="op" id="7599579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599584">&#34;.*&#34;</span><span class="op" id="7599588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599593">&#34;a+&#34;</span><span class="op" id="7599597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599602">&#34;aa+&#34;</span><span class="op" id="7599607">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599612">&#34;aaaa[b]?&#34;</span><span class="op" id="7599622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599627">&#34;aaa*&#34;</span><span class="op" id="7599633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599637">}</span><span class="op" id="7599638">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599641">}</span><span class="op" id="7599642">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599650">&#34;abc&#34;</span><span class="op" id="7599655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599659">&#34;abc&#34;</span><span class="op" id="7599664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599668">[</span><span class="op" id="7599669">]</span><span class="builtintype" id="7599670">string</span><span class="op" id="7599676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599681">&#34;a&#34;</span><span class="op" id="7599684">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599689">&#34;b&#34;</span><span class="op" id="7599692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599697">&#34;c&#34;</span><span class="op" id="7599700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599705">&#34;ab&#34;</span><span class="op" id="7599709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599714">&#34;bc&#34;</span><span class="op" id="7599718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599723">&#34;abc&#34;</span><span class="op" id="7599728">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599733">&#34;a.c&#34;</span><span class="op" id="7599738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599743">&#34;a(b|c)&#34;</span><span class="op" id="7599751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599756">&#34;abc?&#34;</span><span class="op" id="7599762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599766">}</span><span class="op" id="7599767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599770">}</span><span class="op" id="7599771">,</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599779">&#34;barbara*3&#34;</span><span class="op" id="7599790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599794">&#34;barbarabarbarabarbara&#34;</span><span class="op" id="7599817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599821">[</span><span class="op" id="7599822">]</span><span class="builtintype" id="7599823">string</span><span class="op" id="7599829">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599834">&#34;a&#34;</span><span class="op" id="7599837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599842">&#34;bar&#34;</span><span class="op" id="7599847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599852">&#34;rab&#34;</span><span class="op" id="7599857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599862">&#34;arab&#34;</span><span class="op" id="7599868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599873">&#34;barbar&#34;</span><span class="op" id="7599881">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599886">&#34;bara?bar&#34;</span><span class="op" id="7599896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599900">}</span><span class="op" id="7599901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599904">}</span><span class="op" id="7599905">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7599909">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599913">&#34;typing&nbsp;drill&#34;</span><span class="op" id="7599927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7599931">&#34;Now&nbsp;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="7600002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7600006">[</span><span class="op" id="7600007">]</span><span class="builtintype" id="7600008">string</span><span class="op" id="7600014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7600019">&#34;Now&#34;</span><span class="op" id="7600024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7600029">&#34;the&nbsp;time&#34;</span><span class="op" id="7600039">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7600044">&#34;to&nbsp;come&nbsp;the&nbsp;aid&#34;</span><span class="op" id="7600061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7600066">&#34;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&#34;</span><span class="op" id="7600124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7600129">&#34;to&nbsp;(come|the)?&#34;</span><span class="op" id="7600145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7600149">}</span><span class="op" id="7600150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7600153">}</span><span class="op" id="7600154">,</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7600158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7600162">&#34;godoc&nbsp;simulation&#34;</span><span class="op" id="7600180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7600184">&#34;package&nbsp;main\n\nimport(\n&nbsp;&nbsp;&nbsp;&nbsp;\&#34;rand\&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7600229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7600233">[</span><span class="op" id="7600234">]</span><span class="builtintype" id="7600235">string</span><span class="op" id="7600241">{</span><span class="op" id="7600242">}</span><span class="op" id="7600243">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7600246">}</span><span class="op" id="7600247">,</span><br>
<span class="lineno"></span><span class="op" id="7600249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7600252">//&nbsp;find&nbsp;all&nbsp;occurrences&nbsp;of&nbsp;s&nbsp;in&nbsp;source;&nbsp;report&nbsp;at&nbsp;most&nbsp;n&nbsp;occurrences</span><br>
<span class="lineno"></span><span class="keyword" id="7600321">func</span>&nbsp;<span class="ident" id="7600326">find</span><span class="op" id="7600330">(</span><span class="ident" id="7600331">src</span><span class="op" id="7600334">,</span>&nbsp;<span class="ident" id="7600336">s</span>&nbsp;<span class="builtintype" id="7600338">string</span><span class="op" id="7600344">,</span>&nbsp;<span class="ident" id="7600346">n</span>&nbsp;<span class="builtintype" id="7600348">int</span><span class="op" id="7600351">)</span>&nbsp;<span class="op" id="7600353">[</span><span class="op" id="7600354">]</span><span class="builtintype" id="7600355">int</span>&nbsp;<span class="op" id="7600359">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7600362">var</span>&nbsp;<span class="ident" id="7600366">res</span>&nbsp;<span class="op" id="7600370">[</span><span class="op" id="7600371">]</span><span class="builtintype" id="7600372">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7600377">if</span>&nbsp;<span class="ident" id="7600380">s</span>&nbsp;<span class="op" id="7600382">!=</span>&nbsp;<span class="string" id="7600385">&#34;&#34;</span>&nbsp;<span class="op" id="7600388">&amp;&amp;</span>&nbsp;<span class="ident" id="7600391">n</span>&nbsp;<span class="op" id="7600393">!=</span>&nbsp;<span class="num" id="7600396">0</span>&nbsp;<span class="op" id="7600398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7600402">//&nbsp;find&nbsp;at&nbsp;most&nbsp;n&nbsp;occurrences&nbsp;of&nbsp;s&nbsp;in&nbsp;src</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7600446">for</span>&nbsp;<span class="ident" id="7600450">i</span>&nbsp;<span class="op" id="7600452">:=</span>&nbsp;<span class="op" id="7600455">-</span><span class="num" id="7600456">1</span><span class="op" id="7600457">;</span>&nbsp;<span class="ident" id="7600459">n</span>&nbsp;<span class="op" id="7600461">&lt;</span>&nbsp;<span class="num" id="7600463">0</span>&nbsp;<span class="op" id="7600465">||</span>&nbsp;<span class="builtinfunc" id="7600468">len</span><span class="op" id="7600471">(</span><span class="ident" id="7600472">res</span><span class="op" id="7600475">)</span>&nbsp;<span class="op" id="7600477">&lt;</span>&nbsp;<span class="ident" id="7600479">n</span><span class="op" id="7600480">;</span>&nbsp;<span class="op" id="7600482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7600487">j</span>&nbsp;<span class="op" id="7600489">:=</span>&nbsp;<span class="ident" id="7600492">strings</span><span class="op" id="7600499">.</span><span class="ident" id="7600500">Index</span><span class="op" id="7600505">(</span><span class="ident" id="7600506">src</span><span class="op" id="7600509">[</span><span class="ident" id="7600510">i</span><span class="op" id="7600511">+</span><span class="num" id="7600512">1</span><span class="op" id="7600513">:</span><span class="op" id="7600514">]</span><span class="op" id="7600515">,</span>&nbsp;<span class="ident" id="7600517">s</span><span class="op" id="7600518">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7600523">if</span>&nbsp;<span class="ident" id="7600526">j</span>&nbsp;<span class="op" id="7600528">&lt;</span>&nbsp;<span class="num" id="7600530">0</span>&nbsp;<span class="op" id="7600532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7600538">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7600547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7600552">i</span>&nbsp;<span class="op" id="7600554">+=</span>&nbsp;<span class="ident" id="7600557">j</span>&nbsp;<span class="op" id="7600559">+</span>&nbsp;<span class="num" id="7600561">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7600566">res</span>&nbsp;<span class="op" id="7600570">=</span>&nbsp;<span class="builtinfunc" id="7600572">append</span><span class="op" id="7600578">(</span><span class="ident" id="7600579">res</span><span class="op" id="7600582">,</span>&nbsp;<span class="ident" id="7600584">i</span><span class="op" id="7600585">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7600589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7600592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7600595">return</span>&nbsp;<span class="ident" id="7600602">res</span><br>
<span class="lineno"></span><span class="op" id="7600606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="7600609">func</span>&nbsp;<span class="ident" id="7600614">testLookup</span><span class="op" id="7600624">(</span><span class="ident" id="7600625">t</span>&nbsp;<span class="op" id="7600627">*</span><span class="ident" id="7600628">testing</span><span class="op" id="7600635">.</span><span class="ident" id="7600636">T</span><span class="op" id="7600637">,</span>&nbsp;<span class="ident" id="7600639">tc</span>&nbsp;<span class="op" id="7600642">*</span><span class="ident" id="7600643">testCase</span><span class="op" id="7600651">,</span>&nbsp;<span class="ident" id="7600653">x</span>&nbsp;<span class="op" id="7600655">*</span><span class="ident" id="7600656">Index</span><span class="op" id="7600661">,</span>&nbsp;<span class="ident" id="7600663">s</span>&nbsp;<span class="builtintype" id="7600665">string</span><span class="op" id="7600671">,</span>&nbsp;<span class="ident" id="7600673">n</span>&nbsp;<span class="builtintype" id="7600675">int</span><span class="op" id="7600678">)</span>&nbsp;<span class="op" id="7600680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7600683">res</span>&nbsp;<span class="op" id="7600687">:=</span>&nbsp;<span class="ident" id="7600690">x</span><span class="op" id="7600691">.</span><span class="ident" id="7600692">Lookup</span><span class="op" id="7600698">(</span><span class="op" id="7600699">[</span><span class="op" id="7600700">]</span><span class="builtintype" id="7600701">byte</span><span class="op" id="7600705">(</span><span class="ident" id="7600706">s</span><span class="op" id="7600707">)</span><span class="op" id="7600708">,</span>&nbsp;<span class="ident" id="7600710">n</span><span class="op" id="7600711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7600714">exp</span>&nbsp;<span class="op" id="7600718">:=</span>&nbsp;<span class="ident" id="7600721">find</span><span class="op" id="7600725">(</span><span class="ident" id="7600726">tc</span><span class="op" id="7600728">.</span><span class="ident" id="7600729">source</span><span class="op" id="7600735">,</span>&nbsp;<span class="ident" id="7600737">s</span><span class="op" id="7600738">,</span>&nbsp;<span class="ident" id="7600740">n</span><span class="op" id="7600741">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7600745">//&nbsp;check&nbsp;that&nbsp;the&nbsp;lengths&nbsp;match</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7600778">if</span>&nbsp;<span class="builtinfunc" id="7600781">len</span><span class="op" id="7600784">(</span><span class="ident" id="7600785">res</span><span class="op" id="7600788">)</span>&nbsp;<span class="op" id="7600790">!=</span>&nbsp;<span class="builtinfunc" id="7600793">len</span><span class="op" id="7600796">(</span><span class="ident" id="7600797">exp</span><span class="op" id="7600800">)</span>&nbsp;<span class="op" id="7600802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7600806">t</span><span class="op" id="7600807">.</span><span class="ident" id="7600808">Errorf</span><span class="op" id="7600814">(</span><span class="string" id="7600815">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;expected&nbsp;%d&nbsp;results;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7600873">,</span>&nbsp;<span class="ident" id="7600875">tc</span><span class="op" id="7600877">.</span><span class="ident" id="7600878">name</span><span class="op" id="7600882">,</span>&nbsp;<span class="ident" id="7600884">s</span><span class="op" id="7600885">,</span>&nbsp;<span class="ident" id="7600887">n</span><span class="op" id="7600888">,</span>&nbsp;<span class="builtinfunc" id="7600890">len</span><span class="op" id="7600893">(</span><span class="ident" id="7600894">exp</span><span class="op" id="7600897">)</span><span class="op" id="7600898">,</span>&nbsp;<span class="builtinfunc" id="7600900">len</span><span class="op" id="7600903">(</span><span class="ident" id="7600904">res</span><span class="op" id="7600907">)</span><span class="op" id="7600908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7600911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7600915">//&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;the&nbsp;number&nbsp;of&nbsp;results&nbsp;is&nbsp;limited&nbsp;---&nbsp;unless&nbsp;n&nbsp;&gt;=&nbsp;all&nbsp;results,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7600991">//&nbsp;we&nbsp;may&nbsp;obtain&nbsp;different&nbsp;positions&nbsp;from&nbsp;the&nbsp;Index&nbsp;and&nbsp;from&nbsp;find&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7601067">//&nbsp;Index&nbsp;may&nbsp;not&nbsp;find&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;as&nbsp;find)&nbsp;=&gt;&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7601143">//&nbsp;we&nbsp;cannot&nbsp;simply&nbsp;check&nbsp;that&nbsp;the&nbsp;res&nbsp;and&nbsp;exp&nbsp;lists&nbsp;are&nbsp;equal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7601208">//&nbsp;check&nbsp;that&nbsp;each&nbsp;result&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;correct&nbsp;match&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;duplicates</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7601290">sort</span><span class="op" id="7601294">.</span><span class="ident" id="7601295">Ints</span><span class="op" id="7601299">(</span><span class="ident" id="7601300">res</span><span class="op" id="7601303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7601306">for</span>&nbsp;<span class="ident" id="7601310">i</span><span class="op" id="7601311">,</span>&nbsp;<span class="ident" id="7601313">r</span>&nbsp;<span class="op" id="7601315">:=</span>&nbsp;<span class="keyword" id="7601318">range</span>&nbsp;<span class="ident" id="7601324">res</span>&nbsp;<span class="op" id="7601328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7601332">if</span>&nbsp;<span class="ident" id="7601335">r</span>&nbsp;<span class="op" id="7601337">&lt;</span>&nbsp;<span class="num" id="7601339">0</span>&nbsp;<span class="op" id="7601341">||</span>&nbsp;<span class="builtinfunc" id="7601344">len</span><span class="op" id="7601347">(</span><span class="ident" id="7601348">tc</span><span class="op" id="7601350">.</span><span class="ident" id="7601351">source</span><span class="op" id="7601357">)</span>&nbsp;<span class="op" id="7601359">&lt;=</span>&nbsp;<span class="ident" id="7601362">r</span>&nbsp;<span class="op" id="7601364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7601369">t</span><span class="op" id="7601370">.</span><span class="ident" id="7601371">Errorf</span><span class="op" id="7601377">(</span><span class="string" id="7601378">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;index&nbsp;%d&nbsp;out&nbsp;of&nbsp;range&nbsp;[0,&nbsp;%d[&#34;</span><span class="op" id="7601449">,</span>&nbsp;<span class="ident" id="7601451">tc</span><span class="op" id="7601453">.</span><span class="ident" id="7601454">name</span><span class="op" id="7601458">,</span>&nbsp;<span class="ident" id="7601460">s</span><span class="op" id="7601461">,</span>&nbsp;<span class="ident" id="7601463">i</span><span class="op" id="7601464">,</span>&nbsp;<span class="ident" id="7601466">n</span><span class="op" id="7601467">,</span>&nbsp;<span class="ident" id="7601469">r</span><span class="op" id="7601470">,</span>&nbsp;<span class="builtinfunc" id="7601472">len</span><span class="op" id="7601475">(</span><span class="ident" id="7601476">tc</span><span class="op" id="7601478">.</span><span class="ident" id="7601479">source</span><span class="op" id="7601485">)</span><span class="op" id="7601486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7601490">}</span>&nbsp;<span class="keyword" id="7601492">else</span>&nbsp;<span class="keyword" id="7601497">if</span>&nbsp;<span class="op" id="7601500">!</span><span class="ident" id="7601501">strings</span><span class="op" id="7601508">.</span><span class="ident" id="7601509">HasPrefix</span><span class="op" id="7601518">(</span><span class="ident" id="7601519">tc</span><span class="op" id="7601521">.</span><span class="ident" id="7601522">source</span><span class="op" id="7601528">[</span><span class="ident" id="7601529">r</span><span class="op" id="7601530">:</span><span class="op" id="7601531">]</span><span class="op" id="7601532">,</span>&nbsp;<span class="ident" id="7601534">s</span><span class="op" id="7601535">)</span>&nbsp;<span class="op" id="7601537">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7601542">t</span><span class="op" id="7601543">.</span><span class="ident" id="7601544">Errorf</span><span class="op" id="7601550">(</span><span class="string" id="7601551">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;index&nbsp;%d&nbsp;not&nbsp;a&nbsp;match&#34;</span><span class="op" id="7601613">,</span>&nbsp;<span class="ident" id="7601615">tc</span><span class="op" id="7601617">.</span><span class="ident" id="7601618">name</span><span class="op" id="7601622">,</span>&nbsp;<span class="ident" id="7601624">s</span><span class="op" id="7601625">,</span>&nbsp;<span class="ident" id="7601627">i</span><span class="op" id="7601628">,</span>&nbsp;<span class="ident" id="7601630">n</span><span class="op" id="7601631">,</span>&nbsp;<span class="ident" id="7601633">r</span><span class="op" id="7601634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7601638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7601642">if</span>&nbsp;<span class="ident" id="7601645">i</span>&nbsp;<span class="op" id="7601647">&gt;</span>&nbsp;<span class="num" id="7601649">0</span>&nbsp;<span class="op" id="7601651">&amp;&amp;</span>&nbsp;<span class="ident" id="7601654">res</span><span class="op" id="7601657">[</span><span class="ident" id="7601658">i</span><span class="op" id="7601659">-</span><span class="num" id="7601660">1</span><span class="op" id="7601661">]</span>&nbsp;<span class="op" id="7601663">==</span>&nbsp;<span class="ident" id="7601666">r</span>&nbsp;<span class="op" id="7601668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7601673">t</span><span class="op" id="7601674">.</span><span class="ident" id="7601675">Errorf</span><span class="op" id="7601681">(</span><span class="string" id="7601682">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;found&nbsp;duplicate&nbsp;index&nbsp;%d&#34;</span><span class="op" id="7601748">,</span>&nbsp;<span class="ident" id="7601750">tc</span><span class="op" id="7601752">.</span><span class="ident" id="7601753">name</span><span class="op" id="7601757">,</span>&nbsp;<span class="ident" id="7601759">s</span><span class="op" id="7601760">,</span>&nbsp;<span class="ident" id="7601762">i</span><span class="op" id="7601763">,</span>&nbsp;<span class="ident" id="7601765">n</span><span class="op" id="7601766">,</span>&nbsp;<span class="ident" id="7601768">r</span><span class="op" id="7601769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7601773">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7601776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7601780">if</span>&nbsp;<span class="ident" id="7601783">n</span>&nbsp;<span class="op" id="7601785">&lt;</span>&nbsp;<span class="num" id="7601787">0</span>&nbsp;<span class="op" id="7601789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7601793">//&nbsp;all&nbsp;results&nbsp;computed&nbsp;-&nbsp;sorted&nbsp;res&nbsp;and&nbsp;exp&nbsp;must&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7601854">for</span>&nbsp;<span class="ident" id="7601858">i</span><span class="op" id="7601859">,</span>&nbsp;<span class="ident" id="7601861">r</span>&nbsp;<span class="op" id="7601863">:=</span>&nbsp;<span class="keyword" id="7601866">range</span>&nbsp;<span class="ident" id="7601872">res</span>&nbsp;<span class="op" id="7601876">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7601881">e</span>&nbsp;<span class="op" id="7601883">:=</span>&nbsp;<span class="ident" id="7601886">exp</span><span class="op" id="7601889">[</span><span class="ident" id="7601890">i</span><span class="op" id="7601891">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7601896">if</span>&nbsp;<span class="ident" id="7601899">r</span>&nbsp;<span class="op" id="7601901">!=</span>&nbsp;<span class="ident" id="7601904">e</span>&nbsp;<span class="op" id="7601906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7601912">t</span><span class="op" id="7601913">.</span><span class="ident" id="7601914">Errorf</span><span class="op" id="7601920">(</span><span class="string" id="7601921">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d:&nbsp;expected&nbsp;index&nbsp;%d;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7601979">,</span>&nbsp;<span class="ident" id="7601981">tc</span><span class="op" id="7601983">.</span><span class="ident" id="7601984">name</span><span class="op" id="7601988">,</span>&nbsp;<span class="ident" id="7601990">s</span><span class="op" id="7601991">,</span>&nbsp;<span class="ident" id="7601993">i</span><span class="op" id="7601994">,</span>&nbsp;<span class="ident" id="7601996">e</span><span class="op" id="7601997">,</span>&nbsp;<span class="ident" id="7601999">r</span><span class="op" id="7602000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7602005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7602009">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7602012">}</span><br>
<span class="lineno"></span><span class="op" id="7602014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7602017">func</span>&nbsp;<span class="ident" id="7602022">testFindAllIndex</span><span class="op" id="7602038">(</span><span class="ident" id="7602039">t</span>&nbsp;<span class="op" id="7602041">*</span><span class="ident" id="7602042">testing</span><span class="op" id="7602049">.</span><span class="ident" id="7602050">T</span><span class="op" id="7602051">,</span>&nbsp;<span class="ident" id="7602053">tc</span>&nbsp;<span class="op" id="7602056">*</span><span class="ident" id="7602057">testCase</span><span class="op" id="7602065">,</span>&nbsp;<span class="ident" id="7602067">x</span>&nbsp;<span class="op" id="7602069">*</span><span class="ident" id="7602070">Index</span><span class="op" id="7602075">,</span>&nbsp;<span class="ident" id="7602077">rx</span>&nbsp;<span class="op" id="7602080">*</span><span class="ident" id="7602081">regexp</span><span class="op" id="7602087">.</span><span class="ident" id="7602088">Regexp</span><span class="op" id="7602094">,</span>&nbsp;<span class="ident" id="7602096">n</span>&nbsp;<span class="builtintype" id="7602098">int</span><span class="op" id="7602101">)</span>&nbsp;<span class="op" id="7602103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7602106">res</span>&nbsp;<span class="op" id="7602110">:=</span>&nbsp;<span class="ident" id="7602113">x</span><span class="op" id="7602114">.</span><span class="ident" id="7602115">FindAllIndex</span><span class="op" id="7602127">(</span><span class="ident" id="7602128">rx</span><span class="op" id="7602130">,</span>&nbsp;<span class="ident" id="7602132">n</span><span class="op" id="7602133">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7602136">exp</span>&nbsp;<span class="op" id="7602140">:=</span>&nbsp;<span class="ident" id="7602143">rx</span><span class="op" id="7602145">.</span><span class="ident" id="7602146">FindAllStringIndex</span><span class="op" id="7602164">(</span><span class="ident" id="7602165">tc</span><span class="op" id="7602167">.</span><span class="ident" id="7602168">source</span><span class="op" id="7602174">,</span>&nbsp;<span class="ident" id="7602176">n</span><span class="op" id="7602177">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7602181">//&nbsp;check&nbsp;that&nbsp;the&nbsp;lengths&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7602214">if</span>&nbsp;<span class="builtinfunc" id="7602217">len</span><span class="op" id="7602220">(</span><span class="ident" id="7602221">res</span><span class="op" id="7602224">)</span>&nbsp;<span class="op" id="7602226">!=</span>&nbsp;<span class="builtinfunc" id="7602229">len</span><span class="op" id="7602232">(</span><span class="ident" id="7602233">exp</span><span class="op" id="7602236">)</span>&nbsp;<span class="op" id="7602238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7602242">t</span><span class="op" id="7602243">.</span><span class="ident" id="7602244">Errorf</span><span class="op" id="7602250">(</span><span class="string" id="7602251">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;expected&nbsp;%d&nbsp;results;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7602315">,</span>&nbsp;<span class="ident" id="7602317">tc</span><span class="op" id="7602319">.</span><span class="ident" id="7602320">name</span><span class="op" id="7602324">,</span>&nbsp;<span class="ident" id="7602326">rx</span><span class="op" id="7602328">,</span>&nbsp;<span class="ident" id="7602330">n</span><span class="op" id="7602331">,</span>&nbsp;<span class="builtinfunc" id="7602333">len</span><span class="op" id="7602336">(</span><span class="ident" id="7602337">exp</span><span class="op" id="7602340">)</span><span class="op" id="7602341">,</span>&nbsp;<span class="builtinfunc" id="7602343">len</span><span class="op" id="7602346">(</span><span class="ident" id="7602347">res</span><span class="op" id="7602350">)</span><span class="op" id="7602351">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7602354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7602358">//&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;the&nbsp;number&nbsp;of&nbsp;results&nbsp;is&nbsp;limited&nbsp;---&nbsp;unless&nbsp;n&nbsp;&gt;=&nbsp;all&nbsp;results,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7602434">//&nbsp;we&nbsp;may&nbsp;obtain&nbsp;different&nbsp;positions&nbsp;from&nbsp;the&nbsp;Index&nbsp;and&nbsp;from&nbsp;regexp&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7602512">//&nbsp;Index&nbsp;may&nbsp;not&nbsp;find&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;as&nbsp;regexp)&nbsp;=&gt;&nbsp;in&nbsp;general</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7602590">//&nbsp;we&nbsp;cannot&nbsp;simply&nbsp;check&nbsp;that&nbsp;the&nbsp;res&nbsp;and&nbsp;exp&nbsp;lists&nbsp;are&nbsp;equal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7602655">//&nbsp;check&nbsp;that&nbsp;each&nbsp;result&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;correct&nbsp;match&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;sorted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7602734">for</span>&nbsp;<span class="ident" id="7602738">i</span><span class="op" id="7602739">,</span>&nbsp;<span class="ident" id="7602741">r</span>&nbsp;<span class="op" id="7602743">:=</span>&nbsp;<span class="keyword" id="7602746">range</span>&nbsp;<span class="ident" id="7602752">res</span>&nbsp;<span class="op" id="7602756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7602760">if</span>&nbsp;<span class="ident" id="7602763">r</span><span class="op" id="7602764">[</span><span class="num" id="7602765">0</span><span class="op" id="7602766">]</span>&nbsp;<span class="op" id="7602768">&lt;</span>&nbsp;<span class="num" id="7602770">0</span>&nbsp;<span class="op" id="7602772">||</span>&nbsp;<span class="ident" id="7602775">r</span><span class="op" id="7602776">[</span><span class="num" id="7602777">0</span><span class="op" id="7602778">]</span>&nbsp;<span class="op" id="7602780">&gt;</span>&nbsp;<span class="ident" id="7602782">r</span><span class="op" id="7602783">[</span><span class="num" id="7602784">1</span><span class="op" id="7602785">]</span>&nbsp;<span class="op" id="7602787">||</span>&nbsp;<span class="builtinfunc" id="7602790">len</span><span class="op" id="7602793">(</span><span class="ident" id="7602794">tc</span><span class="op" id="7602796">.</span><span class="ident" id="7602797">source</span><span class="op" id="7602803">)</span>&nbsp;<span class="op" id="7602805">&lt;</span>&nbsp;<span class="ident" id="7602807">r</span><span class="op" id="7602808">[</span><span class="num" id="7602809">1</span><span class="op" id="7602810">]</span>&nbsp;<span class="op" id="7602812">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7602817">t</span><span class="op" id="7602818">.</span><span class="ident" id="7602819">Errorf</span><span class="op" id="7602825">(</span><span class="string" id="7602826">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;==&nbsp;%d):&nbsp;illegal&nbsp;match&nbsp;[%d,&nbsp;%d]&#34;</span><span class="op" id="7602897">,</span>&nbsp;<span class="ident" id="7602899">tc</span><span class="op" id="7602901">.</span><span class="ident" id="7602902">name</span><span class="op" id="7602906">,</span>&nbsp;<span class="ident" id="7602908">rx</span><span class="op" id="7602910">,</span>&nbsp;<span class="ident" id="7602912">i</span><span class="op" id="7602913">,</span>&nbsp;<span class="ident" id="7602915">n</span><span class="op" id="7602916">,</span>&nbsp;<span class="ident" id="7602918">r</span><span class="op" id="7602919">[</span><span class="num" id="7602920">0</span><span class="op" id="7602921">]</span><span class="op" id="7602922">,</span>&nbsp;<span class="ident" id="7602924">r</span><span class="op" id="7602925">[</span><span class="num" id="7602926">1</span><span class="op" id="7602927">]</span><span class="op" id="7602928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7602932">}</span>&nbsp;<span class="keyword" id="7602934">else</span>&nbsp;<span class="keyword" id="7602939">if</span>&nbsp;<span class="op" id="7602942">!</span><span class="ident" id="7602943">rx</span><span class="op" id="7602945">.</span><span class="ident" id="7602946">MatchString</span><span class="op" id="7602957">(</span><span class="ident" id="7602958">tc</span><span class="op" id="7602960">.</span><span class="ident" id="7602961">source</span><span class="op" id="7602967">[</span><span class="ident" id="7602968">r</span><span class="op" id="7602969">[</span><span class="num" id="7602970">0</span><span class="op" id="7602971">]</span><span class="op" id="7602972">:</span><span class="ident" id="7602973">r</span><span class="op" id="7602974">[</span><span class="num" id="7602975">1</span><span class="op" id="7602976">]</span><span class="op" id="7602977">]</span><span class="op" id="7602978">)</span>&nbsp;<span class="op" id="7602980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7602985">t</span><span class="op" id="7602986">.</span><span class="ident" id="7602987">Errorf</span><span class="op" id="7602993">(</span><span class="string" id="7602994">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;[%d,&nbsp;%d]&nbsp;not&nbsp;a&nbsp;match&#34;</span><span class="op" id="7603062">,</span>&nbsp;<span class="ident" id="7603064">tc</span><span class="op" id="7603066">.</span><span class="ident" id="7603067">name</span><span class="op" id="7603071">,</span>&nbsp;<span class="ident" id="7603073">rx</span><span class="op" id="7603075">,</span>&nbsp;<span class="ident" id="7603077">i</span><span class="op" id="7603078">,</span>&nbsp;<span class="ident" id="7603080">n</span><span class="op" id="7603081">,</span>&nbsp;<span class="ident" id="7603083">r</span><span class="op" id="7603084">[</span><span class="num" id="7603085">0</span><span class="op" id="7603086">]</span><span class="op" id="7603087">,</span>&nbsp;<span class="ident" id="7603089">r</span><span class="op" id="7603090">[</span><span class="num" id="7603091">1</span><span class="op" id="7603092">]</span><span class="op" id="7603093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7603097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7603100">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7603104">if</span>&nbsp;<span class="ident" id="7603107">n</span>&nbsp;<span class="op" id="7603109">&lt;</span>&nbsp;<span class="num" id="7603111">0</span>&nbsp;<span class="op" id="7603113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7603117">//&nbsp;all&nbsp;results&nbsp;computed&nbsp;-&nbsp;sorted&nbsp;res&nbsp;and&nbsp;exp&nbsp;must&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7603178">for</span>&nbsp;<span class="ident" id="7603182">i</span><span class="op" id="7603183">,</span>&nbsp;<span class="ident" id="7603185">r</span>&nbsp;<span class="op" id="7603187">:=</span>&nbsp;<span class="keyword" id="7603190">range</span>&nbsp;<span class="ident" id="7603196">res</span>&nbsp;<span class="op" id="7603200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7603205">e</span>&nbsp;<span class="op" id="7603207">:=</span>&nbsp;<span class="ident" id="7603210">exp</span><span class="op" id="7603213">[</span><span class="ident" id="7603214">i</span><span class="op" id="7603215">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7603220">if</span>&nbsp;<span class="ident" id="7603223">r</span><span class="op" id="7603224">[</span><span class="num" id="7603225">0</span><span class="op" id="7603226">]</span>&nbsp;<span class="op" id="7603228">!=</span>&nbsp;<span class="ident" id="7603231">e</span><span class="op" id="7603232">[</span><span class="num" id="7603233">0</span><span class="op" id="7603234">]</span>&nbsp;<span class="op" id="7603236">||</span>&nbsp;<span class="ident" id="7603239">r</span><span class="op" id="7603240">[</span><span class="num" id="7603241">1</span><span class="op" id="7603242">]</span>&nbsp;<span class="op" id="7603244">!=</span>&nbsp;<span class="ident" id="7603247">e</span><span class="op" id="7603248">[</span><span class="num" id="7603249">1</span><span class="op" id="7603250">]</span>&nbsp;<span class="op" id="7603252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7603258">t</span><span class="op" id="7603259">.</span><span class="ident" id="7603260">Errorf</span><span class="op" id="7603266">(</span><span class="string" id="7603267">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d:&nbsp;expected&nbsp;match&nbsp;[%d,&nbsp;%d];&nbsp;got&nbsp;[%d,&nbsp;%d]&#34;</span><span class="op" id="7603343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7603350">tc</span><span class="op" id="7603352">.</span><span class="ident" id="7603353">name</span><span class="op" id="7603357">,</span>&nbsp;<span class="ident" id="7603359">rx</span><span class="op" id="7603361">,</span>&nbsp;<span class="ident" id="7603363">i</span><span class="op" id="7603364">,</span>&nbsp;<span class="ident" id="7603366">e</span><span class="op" id="7603367">[</span><span class="num" id="7603368">0</span><span class="op" id="7603369">]</span><span class="op" id="7603370">,</span>&nbsp;<span class="ident" id="7603372">e</span><span class="op" id="7603373">[</span><span class="num" id="7603374">1</span><span class="op" id="7603375">]</span><span class="op" id="7603376">,</span>&nbsp;<span class="ident" id="7603378">r</span><span class="op" id="7603379">[</span><span class="num" id="7603380">0</span><span class="op" id="7603381">]</span><span class="op" id="7603382">,</span>&nbsp;<span class="ident" id="7603384">r</span><span class="op" id="7603385">[</span><span class="num" id="7603386">1</span><span class="op" id="7603387">]</span><span class="op" id="7603388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7603393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7603397">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7603400">}</span><br>
<span class="lineno"></span><span class="op" id="7603402">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7603405">func</span>&nbsp;<span class="ident" id="7603410">testLookups</span><span class="op" id="7603421">(</span><span class="ident" id="7603422">t</span>&nbsp;<span class="op" id="7603424">*</span><span class="ident" id="7603425">testing</span><span class="op" id="7603432">.</span><span class="ident" id="7603433">T</span><span class="op" id="7603434">,</span>&nbsp;<span class="ident" id="7603436">tc</span>&nbsp;<span class="op" id="7603439">*</span><span class="ident" id="7603440">testCase</span><span class="op" id="7603448">,</span>&nbsp;<span class="ident" id="7603450">x</span>&nbsp;<span class="op" id="7603452">*</span><span class="ident" id="7603453">Index</span><span class="op" id="7603458">,</span>&nbsp;<span class="ident" id="7603460">n</span>&nbsp;<span class="builtintype" id="7603462">int</span><span class="op" id="7603465">)</span>&nbsp;<span class="op" id="7603467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7603470">for</span>&nbsp;<span class="ident" id="7603474">_</span><span class="op" id="7603475">,</span>&nbsp;<span class="ident" id="7603477">pat</span>&nbsp;<span class="op" id="7603481">:=</span>&nbsp;<span class="keyword" id="7603484">range</span>&nbsp;<span class="ident" id="7603490">tc</span><span class="op" id="7603492">.</span><span class="ident" id="7603493">patterns</span>&nbsp;<span class="op" id="7603502">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7603506">testLookup</span><span class="op" id="7603516">(</span><span class="ident" id="7603517">t</span><span class="op" id="7603518">,</span>&nbsp;<span class="ident" id="7603520">tc</span><span class="op" id="7603522">,</span>&nbsp;<span class="ident" id="7603524">x</span><span class="op" id="7603525">,</span>&nbsp;<span class="ident" id="7603527">pat</span><span class="op" id="7603530">,</span>&nbsp;<span class="ident" id="7603532">n</span><span class="op" id="7603533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7603537">if</span>&nbsp;<span class="ident" id="7603540">rx</span><span class="op" id="7603542">,</span>&nbsp;<span class="ident" id="7603544">err</span>&nbsp;<span class="op" id="7603548">:=</span>&nbsp;<span class="ident" id="7603551">regexp</span><span class="op" id="7603557">.</span><span class="ident" id="7603558">Compile</span><span class="op" id="7603565">(</span><span class="ident" id="7603566">pat</span><span class="op" id="7603569">)</span><span class="op" id="7603570">;</span>&nbsp;<span class="ident" id="7603572">err</span>&nbsp;<span class="op" id="7603576">==</span>&nbsp;<span class="ident" id="7603579">nil</span>&nbsp;<span class="op" id="7603583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7603588">testFindAllIndex</span><span class="op" id="7603604">(</span><span class="ident" id="7603605">t</span><span class="op" id="7603606">,</span>&nbsp;<span class="ident" id="7603608">tc</span><span class="op" id="7603610">,</span>&nbsp;<span class="ident" id="7603612">x</span><span class="op" id="7603613">,</span>&nbsp;<span class="ident" id="7603615">rx</span><span class="op" id="7603617">,</span>&nbsp;<span class="ident" id="7603619">n</span><span class="op" id="7603620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7603624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7603627">}</span><br>
<span class="lineno">205</span><span class="op" id="7603629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7603632">//&nbsp;index&nbsp;is&nbsp;used&nbsp;to&nbsp;hide&nbsp;the&nbsp;sort.Interface</span><br>
<span class="lineno"></span><span class="keyword" id="7603676">type</span>&nbsp;<span class="ident" id="7603681">index</span>&nbsp;<span class="ident" id="7603687">Index</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="7603694">func</span>&nbsp;<span class="op" id="7603699">(</span><span class="ident" id="7603700">x</span>&nbsp;<span class="op" id="7603702">*</span><span class="ident" id="7603703">index</span><span class="op" id="7603708">)</span>&nbsp;<span class="ident" id="7603710">Len</span><span class="op" id="7603713">(</span><span class="op" id="7603714">)</span>&nbsp;<span class="builtintype" id="7603716">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7603730">{</span>&nbsp;<span class="keyword" id="7603732">return</span>&nbsp;<span class="builtinfunc" id="7603739">len</span><span class="op" id="7603742">(</span><span class="ident" id="7603743">x</span><span class="op" id="7603744">.</span><span class="ident" id="7603745">sa</span><span class="op" id="7603747">)</span>&nbsp;<span class="op" id="7603749">}</span><br>
<span class="lineno"></span><span class="keyword" id="7603751">func</span>&nbsp;<span class="op" id="7603756">(</span><span class="ident" id="7603757">x</span>&nbsp;<span class="op" id="7603759">*</span><span class="ident" id="7603760">index</span><span class="op" id="7603765">)</span>&nbsp;<span class="ident" id="7603767">Less</span><span class="op" id="7603771">(</span><span class="ident" id="7603772">i</span><span class="op" id="7603773">,</span>&nbsp;<span class="ident" id="7603775">j</span>&nbsp;<span class="builtintype" id="7603777">int</span><span class="op" id="7603780">)</span>&nbsp;<span class="builtintype" id="7603782">bool</span>&nbsp;<span class="op" id="7603787">{</span>&nbsp;<span class="keyword" id="7603789">return</span>&nbsp;<span class="ident" id="7603796">bytes</span><span class="op" id="7603801">.</span><span class="ident" id="7603802">Compare</span><span class="op" id="7603809">(</span><span class="ident" id="7603810">x</span><span class="op" id="7603811">.</span><span class="ident" id="7603812">at</span><span class="op" id="7603814">(</span><span class="ident" id="7603815">i</span><span class="op" id="7603816">)</span><span class="op" id="7603817">,</span>&nbsp;<span class="ident" id="7603819">x</span><span class="op" id="7603820">.</span><span class="ident" id="7603821">at</span><span class="op" id="7603823">(</span><span class="ident" id="7603824">j</span><span class="op" id="7603825">)</span><span class="op" id="7603826">)</span>&nbsp;<span class="op" id="7603828">&lt;</span>&nbsp;<span class="num" id="7603830">0</span>&nbsp;<span class="op" id="7603832">}</span><br>
<span class="lineno"></span><span class="keyword" id="7603834">func</span>&nbsp;<span class="op" id="7603839">(</span><span class="ident" id="7603840">x</span>&nbsp;<span class="op" id="7603842">*</span><span class="ident" id="7603843">index</span><span class="op" id="7603848">)</span>&nbsp;<span class="ident" id="7603850">Swap</span><span class="op" id="7603854">(</span><span class="ident" id="7603855">i</span><span class="op" id="7603856">,</span>&nbsp;<span class="ident" id="7603858">j</span>&nbsp;<span class="builtintype" id="7603860">int</span><span class="op" id="7603863">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7603870">{</span>&nbsp;<span class="ident" id="7603872">x</span><span class="op" id="7603873">.</span><span class="ident" id="7603874">sa</span><span class="op" id="7603876">[</span><span class="ident" id="7603877">i</span><span class="op" id="7603878">]</span><span class="op" id="7603879">,</span>&nbsp;<span class="ident" id="7603881">x</span><span class="op" id="7603882">.</span><span class="ident" id="7603883">sa</span><span class="op" id="7603885">[</span><span class="ident" id="7603886">j</span><span class="op" id="7603887">]</span>&nbsp;<span class="op" id="7603889">=</span>&nbsp;<span class="ident" id="7603891">x</span><span class="op" id="7603892">.</span><span class="ident" id="7603893">sa</span><span class="op" id="7603895">[</span><span class="ident" id="7603896">j</span><span class="op" id="7603897">]</span><span class="op" id="7603898">,</span>&nbsp;<span class="ident" id="7603900">x</span><span class="op" id="7603901">.</span><span class="ident" id="7603902">sa</span><span class="op" id="7603904">[</span><span class="ident" id="7603905">i</span><span class="op" id="7603906">]</span>&nbsp;<span class="op" id="7603908">}</span><br>
<span class="lineno"></span><span class="keyword" id="7603910">func</span>&nbsp;<span class="op" id="7603915">(</span><span class="ident" id="7603916">a</span>&nbsp;<span class="op" id="7603918">*</span><span class="ident" id="7603919">index</span><span class="op" id="7603924">)</span>&nbsp;<span class="ident" id="7603926">at</span><span class="op" id="7603928">(</span><span class="ident" id="7603929">i</span>&nbsp;<span class="builtintype" id="7603931">int</span><span class="op" id="7603934">)</span>&nbsp;<span class="op" id="7603936">[</span><span class="op" id="7603937">]</span><span class="builtintype" id="7603938">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7603946">{</span>&nbsp;<span class="keyword" id="7603948">return</span>&nbsp;<span class="ident" id="7603955">a</span><span class="op" id="7603956">.</span><span class="ident" id="7603957">data</span><span class="op" id="7603961">[</span><span class="ident" id="7603962">a</span><span class="op" id="7603963">.</span><span class="ident" id="7603964">sa</span><span class="op" id="7603966">[</span><span class="ident" id="7603967">i</span><span class="op" id="7603968">]</span><span class="op" id="7603969">:</span><span class="op" id="7603970">]</span>&nbsp;<span class="op" id="7603972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="7603975">func</span>&nbsp;<span class="ident" id="7603980">testConstruction</span><span class="op" id="7603996">(</span><span class="ident" id="7603997">t</span>&nbsp;<span class="op" id="7603999">*</span><span class="ident" id="7604000">testing</span><span class="op" id="7604007">.</span><span class="ident" id="7604008">T</span><span class="op" id="7604009">,</span>&nbsp;<span class="ident" id="7604011">tc</span>&nbsp;<span class="op" id="7604014">*</span><span class="ident" id="7604015">testCase</span><span class="op" id="7604023">,</span>&nbsp;<span class="ident" id="7604025">x</span>&nbsp;<span class="op" id="7604027">*</span><span class="ident" id="7604028">Index</span><span class="op" id="7604033">)</span>&nbsp;<span class="op" id="7604035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604038">if</span>&nbsp;<span class="op" id="7604041">!</span><span class="ident" id="7604042">sort</span><span class="op" id="7604046">.</span><span class="ident" id="7604047">IsSorted</span><span class="op" id="7604055">(</span><span class="op" id="7604056">(</span><span class="op" id="7604057">*</span><span class="ident" id="7604058">index</span><span class="op" id="7604063">)</span><span class="op" id="7604064">(</span><span class="ident" id="7604065">x</span><span class="op" id="7604066">)</span><span class="op" id="7604067">)</span>&nbsp;<span class="op" id="7604069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7604073">t</span><span class="op" id="7604074">.</span><span class="ident" id="7604075">Errorf</span><span class="op" id="7604081">(</span><span class="string" id="7604082">&#34;failed&nbsp;testConstruction&nbsp;%s&#34;</span><span class="op" id="7604110">,</span>&nbsp;<span class="ident" id="7604112">tc</span><span class="op" id="7604114">.</span><span class="ident" id="7604115">name</span><span class="op" id="7604119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7604122">}</span><br>
<span class="lineno"></span><span class="op" id="7604124">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="7604127">func</span>&nbsp;<span class="ident" id="7604132">equal</span><span class="op" id="7604137">(</span><span class="ident" id="7604138">x</span><span class="op" id="7604139">,</span>&nbsp;<span class="ident" id="7604141">y</span>&nbsp;<span class="op" id="7604143">*</span><span class="ident" id="7604144">Index</span><span class="op" id="7604149">)</span>&nbsp;<span class="builtintype" id="7604151">bool</span>&nbsp;<span class="op" id="7604156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604159">if</span>&nbsp;<span class="op" id="7604162">!</span><span class="ident" id="7604163">bytes</span><span class="op" id="7604168">.</span><span class="ident" id="7604169">Equal</span><span class="op" id="7604174">(</span><span class="ident" id="7604175">x</span><span class="op" id="7604176">.</span><span class="ident" id="7604177">data</span><span class="op" id="7604181">,</span>&nbsp;<span class="ident" id="7604183">y</span><span class="op" id="7604184">.</span><span class="ident" id="7604185">data</span><span class="op" id="7604189">)</span>&nbsp;<span class="op" id="7604191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604195">return</span>&nbsp;<span class="builtintype" id="7604202">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7604209">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604212">for</span>&nbsp;<span class="ident" id="7604216">i</span><span class="op" id="7604217">,</span>&nbsp;<span class="ident" id="7604219">j</span>&nbsp;<span class="op" id="7604221">:=</span>&nbsp;<span class="keyword" id="7604224">range</span>&nbsp;<span class="ident" id="7604230">x</span><span class="op" id="7604231">.</span><span class="ident" id="7604232">sa</span>&nbsp;<span class="op" id="7604235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604239">if</span>&nbsp;<span class="ident" id="7604242">j</span>&nbsp;<span class="op" id="7604244">!=</span>&nbsp;<span class="ident" id="7604247">y</span><span class="op" id="7604248">.</span><span class="ident" id="7604249">sa</span><span class="op" id="7604251">[</span><span class="ident" id="7604252">i</span><span class="op" id="7604253">]</span>&nbsp;<span class="op" id="7604255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604260">return</span>&nbsp;<span class="builtintype" id="7604267">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7604275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7604278">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604281">return</span>&nbsp;<span class="builtintype" id="7604288">true</span><br>
<span class="lineno"></span><span class="op" id="7604293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7604296">//&nbsp;returns&nbsp;the&nbsp;serialized&nbsp;index&nbsp;size</span><br>
<span class="lineno"></span><span class="keyword" id="7604333">func</span>&nbsp;<span class="ident" id="7604338">testSaveRestore</span><span class="op" id="7604353">(</span><span class="ident" id="7604354">t</span>&nbsp;<span class="op" id="7604356">*</span><span class="ident" id="7604357">testing</span><span class="op" id="7604364">.</span><span class="ident" id="7604365">T</span><span class="op" id="7604366">,</span>&nbsp;<span class="ident" id="7604368">tc</span>&nbsp;<span class="op" id="7604371">*</span><span class="ident" id="7604372">testCase</span><span class="op" id="7604380">,</span>&nbsp;<span class="ident" id="7604382">x</span>&nbsp;<span class="op" id="7604384">*</span><span class="ident" id="7604385">Index</span><span class="op" id="7604390">)</span>&nbsp;<span class="builtintype" id="7604392">int</span>&nbsp;<span class="op" id="7604396">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604399">var</span>&nbsp;<span class="ident" id="7604403">buf</span>&nbsp;<span class="ident" id="7604407">bytes</span><span class="op" id="7604412">.</span><span class="ident" id="7604413">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604421">if</span>&nbsp;<span class="ident" id="7604424">err</span>&nbsp;<span class="op" id="7604428">:=</span>&nbsp;<span class="ident" id="7604431">x</span><span class="op" id="7604432">.</span><span class="ident" id="7604433">Write</span><span class="op" id="7604438">(</span><span class="op" id="7604439">&amp;</span><span class="ident" id="7604440">buf</span><span class="op" id="7604443">)</span><span class="op" id="7604444">;</span>&nbsp;<span class="ident" id="7604446">err</span>&nbsp;<span class="op" id="7604450">!=</span>&nbsp;<span class="ident" id="7604453">nil</span>&nbsp;<span class="op" id="7604457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7604461">t</span><span class="op" id="7604462">.</span><span class="ident" id="7604463">Errorf</span><span class="op" id="7604469">(</span><span class="string" id="7604470">&#34;failed&nbsp;writing&nbsp;index&nbsp;%s&nbsp;(%s)&#34;</span><span class="op" id="7604500">,</span>&nbsp;<span class="ident" id="7604502">tc</span><span class="op" id="7604504">.</span><span class="ident" id="7604505">name</span><span class="op" id="7604509">,</span>&nbsp;<span class="ident" id="7604511">err</span><span class="op" id="7604514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7604517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7604520">size</span>&nbsp;<span class="op" id="7604525">:=</span>&nbsp;<span class="ident" id="7604528">buf</span><span class="op" id="7604531">.</span><span class="ident" id="7604532">Len</span><span class="op" id="7604535">(</span><span class="op" id="7604536">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604539">var</span>&nbsp;<span class="ident" id="7604543">y</span>&nbsp;<span class="ident" id="7604545">Index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604552">if</span>&nbsp;<span class="ident" id="7604555">err</span>&nbsp;<span class="op" id="7604559">:=</span>&nbsp;<span class="ident" id="7604562">y</span><span class="op" id="7604563">.</span><span class="ident" id="7604564">Read</span><span class="op" id="7604568">(</span><span class="op" id="7604569">&amp;</span><span class="ident" id="7604570">buf</span><span class="op" id="7604573">)</span><span class="op" id="7604574">;</span>&nbsp;<span class="ident" id="7604576">err</span>&nbsp;<span class="op" id="7604580">!=</span>&nbsp;<span class="ident" id="7604583">nil</span>&nbsp;<span class="op" id="7604587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7604591">t</span><span class="op" id="7604592">.</span><span class="ident" id="7604593">Errorf</span><span class="op" id="7604599">(</span><span class="string" id="7604600">&#34;failed&nbsp;reading&nbsp;index&nbsp;%s&nbsp;(%s)&#34;</span><span class="op" id="7604630">,</span>&nbsp;<span class="ident" id="7604632">tc</span><span class="op" id="7604634">.</span><span class="ident" id="7604635">name</span><span class="op" id="7604639">,</span>&nbsp;<span class="ident" id="7604641">err</span><span class="op" id="7604644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7604647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604650">if</span>&nbsp;<span class="op" id="7604653">!</span><span class="ident" id="7604654">equal</span><span class="op" id="7604659">(</span><span class="ident" id="7604660">x</span><span class="op" id="7604661">,</span>&nbsp;<span class="op" id="7604663">&amp;</span><span class="ident" id="7604664">y</span><span class="op" id="7604665">)</span>&nbsp;<span class="op" id="7604667">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7604671">t</span><span class="op" id="7604672">.</span><span class="ident" id="7604673">Errorf</span><span class="op" id="7604679">(</span><span class="string" id="7604680">&#34;restored&nbsp;index&nbsp;doesn&#39;t&nbsp;match&nbsp;saved&nbsp;index&nbsp;%s&#34;</span><span class="op" id="7604725">,</span>&nbsp;<span class="ident" id="7604727">tc</span><span class="op" id="7604729">.</span><span class="ident" id="7604730">name</span><span class="op" id="7604734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7604737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604740">return</span>&nbsp;<span class="ident" id="7604747">size</span><br>
<span class="lineno"></span><span class="op" id="7604752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="7604755">func</span>&nbsp;<span class="ident" id="7604760">TestIndex</span><span class="op" id="7604769">(</span><span class="ident" id="7604770">t</span>&nbsp;<span class="op" id="7604772">*</span><span class="ident" id="7604773">testing</span><span class="op" id="7604780">.</span><span class="ident" id="7604781">T</span><span class="op" id="7604782">)</span>&nbsp;<span class="op" id="7604784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7604787">for</span>&nbsp;<span class="ident" id="7604791">_</span><span class="op" id="7604792">,</span>&nbsp;<span class="ident" id="7604794">tc</span>&nbsp;<span class="op" id="7604797">:=</span>&nbsp;<span class="keyword" id="7604800">range</span>&nbsp;<span class="ident" id="7604806">testCases</span>&nbsp;<span class="op" id="7604816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7604820">x</span>&nbsp;<span class="op" id="7604822">:=</span>&nbsp;<span class="ident" id="7604825">New</span><span class="op" id="7604828">(</span><span class="op" id="7604829">[</span><span class="op" id="7604830">]</span><span class="builtintype" id="7604831">byte</span><span class="op" id="7604835">(</span><span class="ident" id="7604836">tc</span><span class="op" id="7604838">.</span><span class="ident" id="7604839">source</span><span class="op" id="7604845">)</span><span class="op" id="7604846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7604850">testConstruction</span><span class="op" id="7604866">(</span><span class="ident" id="7604867">t</span><span class="op" id="7604868">,</span>&nbsp;<span class="op" id="7604870">&amp;</span><span class="ident" id="7604871">tc</span><span class="op" id="7604873">,</span>&nbsp;<span class="ident" id="7604875">x</span><span class="op" id="7604876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7604880">testSaveRestore</span><span class="op" id="7604895">(</span><span class="ident" id="7604896">t</span><span class="op" id="7604897">,</span>&nbsp;<span class="op" id="7604899">&amp;</span><span class="ident" id="7604900">tc</span><span class="op" id="7604902">,</span>&nbsp;<span class="ident" id="7604904">x</span><span class="op" id="7604905">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7604909">testLookups</span><span class="op" id="7604920">(</span><span class="ident" id="7604921">t</span><span class="op" id="7604922">,</span>&nbsp;<span class="op" id="7604924">&amp;</span><span class="ident" id="7604925">tc</span><span class="op" id="7604927">,</span>&nbsp;<span class="ident" id="7604929">x</span><span class="op" id="7604930">,</span>&nbsp;<span class="num" id="7604932">0</span><span class="op" id="7604933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7604937">testLookups</span><span class="op" id="7604948">(</span><span class="ident" id="7604949">t</span><span class="op" id="7604950">,</span>&nbsp;<span class="op" id="7604952">&amp;</span><span class="ident" id="7604953">tc</span><span class="op" id="7604955">,</span>&nbsp;<span class="ident" id="7604957">x</span><span class="op" id="7604958">,</span>&nbsp;<span class="num" id="7604960">1</span><span class="op" id="7604961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7604965">testLookups</span><span class="op" id="7604976">(</span><span class="ident" id="7604977">t</span><span class="op" id="7604978">,</span>&nbsp;<span class="op" id="7604980">&amp;</span><span class="ident" id="7604981">tc</span><span class="op" id="7604983">,</span>&nbsp;<span class="ident" id="7604985">x</span><span class="op" id="7604986">,</span>&nbsp;<span class="num" id="7604988">10</span><span class="op" id="7604990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7604994">testLookups</span><span class="op" id="7605005">(</span><span class="ident" id="7605006">t</span><span class="op" id="7605007">,</span>&nbsp;<span class="op" id="7605009">&amp;</span><span class="ident" id="7605010">tc</span><span class="op" id="7605012">,</span>&nbsp;<span class="ident" id="7605014">x</span><span class="op" id="7605015">,</span>&nbsp;<span class="num" id="7605017">2e9</span><span class="op" id="7605020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605024">testLookups</span><span class="op" id="7605035">(</span><span class="ident" id="7605036">t</span><span class="op" id="7605037">,</span>&nbsp;<span class="op" id="7605039">&amp;</span><span class="ident" id="7605040">tc</span><span class="op" id="7605042">,</span>&nbsp;<span class="ident" id="7605044">x</span><span class="op" id="7605045">,</span>&nbsp;<span class="op" id="7605047">-</span><span class="num" id="7605048">1</span><span class="op" id="7605049">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7605052">}</span><br>
<span class="lineno"></span><span class="op" id="7605054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7605057">//&nbsp;Of&nbsp;all&nbsp;possible&nbsp;inputs,&nbsp;the&nbsp;random&nbsp;bytes&nbsp;have&nbsp;the&nbsp;least&nbsp;amount&nbsp;of&nbsp;substring</span><br>
<span class="lineno"></span><span class="comment" id="7605136">//&nbsp;repetition,&nbsp;and&nbsp;the&nbsp;repeated&nbsp;bytes&nbsp;have&nbsp;the&nbsp;most.&nbsp;For&nbsp;most&nbsp;algorithms,</span><br>
<span class="lineno">265</span><span class="comment" id="7605210">//&nbsp;the&nbsp;running&nbsp;time&nbsp;of&nbsp;every&nbsp;input&nbsp;will&nbsp;be&nbsp;between&nbsp;these&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="7605272">func</span>&nbsp;<span class="ident" id="7605277">benchmarkNew</span><span class="op" id="7605289">(</span><span class="ident" id="7605290">b</span>&nbsp;<span class="op" id="7605292">*</span><span class="ident" id="7605293">testing</span><span class="op" id="7605300">.</span><span class="ident" id="7605301">B</span><span class="op" id="7605302">,</span>&nbsp;<span class="ident" id="7605304">random</span>&nbsp;<span class="builtintype" id="7605311">bool</span><span class="op" id="7605315">)</span>&nbsp;<span class="op" id="7605317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605320">b</span><span class="op" id="7605321">.</span><span class="ident" id="7605322">StopTimer</span><span class="op" id="7605331">(</span><span class="op" id="7605332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605335">data</span>&nbsp;<span class="op" id="7605340">:=</span>&nbsp;<span class="builtinfunc" id="7605343">make</span><span class="op" id="7605347">(</span><span class="op" id="7605348">[</span><span class="op" id="7605349">]</span><span class="builtintype" id="7605350">byte</span><span class="op" id="7605354">,</span>&nbsp;<span class="num" id="7605356">1e6</span><span class="op" id="7605359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7605362">if</span>&nbsp;<span class="ident" id="7605365">random</span>&nbsp;<span class="op" id="7605372">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7605376">for</span>&nbsp;<span class="ident" id="7605380">i</span>&nbsp;<span class="op" id="7605382">:=</span>&nbsp;<span class="keyword" id="7605385">range</span>&nbsp;<span class="ident" id="7605391">data</span>&nbsp;<span class="op" id="7605396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605401">data</span><span class="op" id="7605405">[</span><span class="ident" id="7605406">i</span><span class="op" id="7605407">]</span>&nbsp;<span class="op" id="7605409">=</span>&nbsp;<span class="builtintype" id="7605411">byte</span><span class="op" id="7605415">(</span><span class="ident" id="7605416">rand</span><span class="op" id="7605420">.</span><span class="ident" id="7605421">Intn</span><span class="op" id="7605425">(</span><span class="num" id="7605426">256</span><span class="op" id="7605429">)</span><span class="op" id="7605430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7605434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7605437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605440">b</span><span class="op" id="7605441">.</span><span class="ident" id="7605442">StartTimer</span><span class="op" id="7605452">(</span><span class="op" id="7605453">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7605456">for</span>&nbsp;<span class="ident" id="7605460">i</span>&nbsp;<span class="op" id="7605462">:=</span>&nbsp;<span class="num" id="7605465">0</span><span class="op" id="7605466">;</span>&nbsp;<span class="ident" id="7605468">i</span>&nbsp;<span class="op" id="7605470">&lt;</span>&nbsp;<span class="ident" id="7605472">b</span><span class="op" id="7605473">.</span><span class="ident" id="7605474">N</span><span class="op" id="7605475">;</span>&nbsp;<span class="ident" id="7605477">i</span><span class="op" id="7605478">++</span>&nbsp;<span class="op" id="7605481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605485">New</span><span class="op" id="7605488">(</span><span class="ident" id="7605489">data</span><span class="op" id="7605493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7605496">}</span><br>
<span class="lineno"></span><span class="op" id="7605498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="7605501">func</span>&nbsp;<span class="ident" id="7605506">BenchmarkNewIndexRandom</span><span class="op" id="7605529">(</span><span class="ident" id="7605530">b</span>&nbsp;<span class="op" id="7605532">*</span><span class="ident" id="7605533">testing</span><span class="op" id="7605540">.</span><span class="ident" id="7605541">B</span><span class="op" id="7605542">)</span>&nbsp;<span class="op" id="7605544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605547">benchmarkNew</span><span class="op" id="7605559">(</span><span class="ident" id="7605560">b</span><span class="op" id="7605561">,</span>&nbsp;<span class="builtintype" id="7605563">true</span><span class="op" id="7605567">)</span><br>
<span class="lineno"></span><span class="op" id="7605569">}</span><br>
<span class="lineno"></span><span class="keyword" id="7605571">func</span>&nbsp;<span class="ident" id="7605576">BenchmarkNewIndexRepeat</span><span class="op" id="7605599">(</span><span class="ident" id="7605600">b</span>&nbsp;<span class="op" id="7605602">*</span><span class="ident" id="7605603">testing</span><span class="op" id="7605610">.</span><span class="ident" id="7605611">B</span><span class="op" id="7605612">)</span>&nbsp;<span class="op" id="7605614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605617">benchmarkNew</span><span class="op" id="7605629">(</span><span class="ident" id="7605630">b</span><span class="op" id="7605631">,</span>&nbsp;<span class="builtintype" id="7605633">false</span><span class="op" id="7605638">)</span><br>
<span class="lineno">285</span><span class="op" id="7605640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7605643">func</span>&nbsp;<span class="ident" id="7605648">BenchmarkSaveRestore</span><span class="op" id="7605668">(</span><span class="ident" id="7605669">b</span>&nbsp;<span class="op" id="7605671">*</span><span class="ident" id="7605672">testing</span><span class="op" id="7605679">.</span><span class="ident" id="7605680">B</span><span class="op" id="7605681">)</span>&nbsp;<span class="op" id="7605683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605686">b</span><span class="op" id="7605687">.</span><span class="ident" id="7605688">StopTimer</span><span class="op" id="7605697">(</span><span class="op" id="7605698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605701">r</span>&nbsp;<span class="op" id="7605703">:=</span>&nbsp;<span class="ident" id="7605706">rand</span><span class="op" id="7605710">.</span><span class="ident" id="7605711">New</span><span class="op" id="7605714">(</span><span class="ident" id="7605715">rand</span><span class="op" id="7605719">.</span><span class="ident" id="7605720">NewSource</span><span class="op" id="7605729">(</span><span class="num" id="7605730">0x5a77a1</span><span class="op" id="7605738">)</span><span class="op" id="7605739">)</span>&nbsp;<span class="comment" id="7605741">//&nbsp;guarantee&nbsp;always&nbsp;same&nbsp;sequence</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605776">data</span>&nbsp;<span class="op" id="7605781">:=</span>&nbsp;<span class="builtinfunc" id="7605784">make</span><span class="op" id="7605788">(</span><span class="op" id="7605789">[</span><span class="op" id="7605790">]</span><span class="builtintype" id="7605791">byte</span><span class="op" id="7605795">,</span>&nbsp;<span class="num" id="7605797">1</span><span class="op" id="7605798">&lt;&lt;</span><span class="num" id="7605800">20</span><span class="op" id="7605802">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7605816">//&nbsp;1MB&nbsp;of&nbsp;data&nbsp;to&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7605841">for</span>&nbsp;<span class="ident" id="7605845">i</span>&nbsp;<span class="op" id="7605847">:=</span>&nbsp;<span class="keyword" id="7605850">range</span>&nbsp;<span class="ident" id="7605856">data</span>&nbsp;<span class="op" id="7605861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605865">data</span><span class="op" id="7605869">[</span><span class="ident" id="7605870">i</span><span class="op" id="7605871">]</span>&nbsp;<span class="op" id="7605873">=</span>&nbsp;<span class="builtintype" id="7605875">byte</span><span class="op" id="7605879">(</span><span class="ident" id="7605880">r</span><span class="op" id="7605881">.</span><span class="ident" id="7605882">Intn</span><span class="op" id="7605886">(</span><span class="num" id="7605887">256</span><span class="op" id="7605890">)</span><span class="op" id="7605891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7605894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605897">x</span>&nbsp;<span class="op" id="7605899">:=</span>&nbsp;<span class="ident" id="7605902">New</span><span class="op" id="7605905">(</span><span class="ident" id="7605906">data</span><span class="op" id="7605910">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605913">size</span>&nbsp;<span class="op" id="7605918">:=</span>&nbsp;<span class="ident" id="7605921">testSaveRestore</span><span class="op" id="7605936">(</span><span class="ident" id="7605937">nil</span><span class="op" id="7605940">,</span>&nbsp;<span class="ident" id="7605942">nil</span><span class="op" id="7605945">,</span>&nbsp;<span class="ident" id="7605947">x</span><span class="op" id="7605948">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7605956">//&nbsp;verify&nbsp;correctness</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7605979">buf</span>&nbsp;<span class="op" id="7605983">:=</span>&nbsp;<span class="ident" id="7605986">bytes</span><span class="op" id="7605991">.</span><span class="ident" id="7605992">NewBuffer</span><span class="op" id="7606001">(</span><span class="builtinfunc" id="7606002">make</span><span class="op" id="7606006">(</span><span class="op" id="7606007">[</span><span class="op" id="7606008">]</span><span class="builtintype" id="7606009">byte</span><span class="op" id="7606013">,</span>&nbsp;<span class="ident" id="7606015">size</span><span class="op" id="7606019">)</span><span class="op" id="7606020">)</span>&nbsp;<span class="comment" id="7606022">//&nbsp;avoid&nbsp;growing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7606040">b</span><span class="op" id="7606041">.</span><span class="ident" id="7606042">SetBytes</span><span class="op" id="7606050">(</span><span class="ident" id="7606051">int64</span><span class="op" id="7606056">(</span><span class="ident" id="7606057">size</span><span class="op" id="7606061">)</span><span class="op" id="7606062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7606065">b</span><span class="op" id="7606066">.</span><span class="ident" id="7606067">StartTimer</span><span class="op" id="7606077">(</span><span class="op" id="7606078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7606081">for</span>&nbsp;<span class="ident" id="7606085">i</span>&nbsp;<span class="op" id="7606087">:=</span>&nbsp;<span class="num" id="7606090">0</span><span class="op" id="7606091">;</span>&nbsp;<span class="ident" id="7606093">i</span>&nbsp;<span class="op" id="7606095">&lt;</span>&nbsp;<span class="ident" id="7606097">b</span><span class="op" id="7606098">.</span><span class="ident" id="7606099">N</span><span class="op" id="7606100">;</span>&nbsp;<span class="ident" id="7606102">i</span><span class="op" id="7606103">++</span>&nbsp;<span class="op" id="7606106">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7606110">x</span><span class="op" id="7606111">.</span><span class="ident" id="7606112">Write</span><span class="op" id="7606117">(</span><span class="ident" id="7606118">buf</span><span class="op" id="7606121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7606125">var</span>&nbsp;<span class="ident" id="7606129">y</span>&nbsp;<span class="ident" id="7606131">Index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7606139">y</span><span class="op" id="7606140">.</span><span class="ident" id="7606141">Read</span><span class="op" id="7606145">(</span><span class="ident" id="7606146">buf</span><span class="op" id="7606149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7606152">}</span><br>
<span class="lineno"></span><span class="op" id="7606154">}</span>
</div>
</body>
</html>
