<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4756979">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4757034">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4757088">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4757139">package</span>&nbsp;<span class="ident" id="4757147">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4757153">import</span>&nbsp;<span class="op" id="4757160">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4757163">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4757170">&#34;io&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4757175">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4757178">//&nbsp;fileTransport&nbsp;implements&nbsp;RoundTripper&nbsp;for&nbsp;the&nbsp;&#39;file&#39;&nbsp;protocol.</span><br>
<span class="lineno"></span><span class="keyword" id="4757244">type</span>&nbsp;<span class="ident" id="4757249">fileTransport</span>&nbsp;<span class="keyword" id="4757263">struct</span>&nbsp;<span class="op" id="4757270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4757273">fh</span>&nbsp;<span class="ident" id="4757276">fileHandler</span><br>
<span class="lineno">15</span><span class="op" id="4757288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4757291">//&nbsp;NewFileTransport&nbsp;returns&nbsp;a&nbsp;new&nbsp;RoundTripper,&nbsp;serving&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span><span class="comment" id="4757360">//&nbsp;FileSystem.&nbsp;The&nbsp;returned&nbsp;RoundTripper&nbsp;ignores&nbsp;the&nbsp;URL&nbsp;host&nbsp;in&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="4757429">//&nbsp;incoming&nbsp;requests,&nbsp;as&nbsp;well&nbsp;as&nbsp;most&nbsp;other&nbsp;properties&nbsp;of&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="4757491">//&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="4757503">//</span><br>
<span class="lineno"></span><span class="comment" id="4757506">//&nbsp;The&nbsp;typical&nbsp;use&nbsp;case&nbsp;for&nbsp;NewFileTransport&nbsp;is&nbsp;to&nbsp;register&nbsp;the&nbsp;&#34;file&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4757577">//&nbsp;protocol&nbsp;with&nbsp;a&nbsp;Transport,&nbsp;as&nbsp;in:</span><br>
<span class="lineno"></span><span class="comment" id="4757614">//</span><br>
<span class="lineno">25</span><span class="comment" id="4757617">//&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;&amp;http.Transport{}</span><br>
<span class="lineno"></span><span class="comment" id="4757645">//&nbsp;&nbsp;&nbsp;t.RegisterProtocol(&#34;file&#34;,&nbsp;http.NewFileTransport(http.Dir(&#34;/&#34;)))</span><br>
<span class="lineno"></span><span class="comment" id="4757715">//&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;&amp;http.Client{Transport:&nbsp;t}</span><br>
<span class="lineno"></span><span class="comment" id="4757752">//&nbsp;&nbsp;&nbsp;res,&nbsp;err&nbsp;:=&nbsp;c.Get(&#34;file:///etc/passwd&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="4757797">//&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno">30</span><span class="keyword" id="4757806">func</span>&nbsp;<span class="ident" id="4757811">NewFileTransport</span><span class="op" id="4757827">(</span><span class="ident" id="4757828">fs</span>&nbsp;<span class="ident" id="4757831">FileSystem</span><span class="op" id="4757841">)</span>&nbsp;<span class="ident" id="4757843">RoundTripper</span>&nbsp;<span class="op" id="4757856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4757859">return</span>&nbsp;<span class="ident" id="4757866">fileTransport</span><span class="op" id="4757879">{</span><span class="ident" id="4757880">fileHandler</span><span class="op" id="4757891">{</span><span class="ident" id="4757892">fs</span><span class="op" id="4757894">}</span><span class="op" id="4757895">}</span><br>
<span class="lineno"></span><span class="op" id="4757897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4757900">func</span>&nbsp;<span class="op" id="4757905">(</span><span class="ident" id="4757906">t</span>&nbsp;<span class="ident" id="4757908">fileTransport</span><span class="op" id="4757921">)</span>&nbsp;<span class="ident" id="4757923">RoundTrip</span><span class="op" id="4757932">(</span><span class="ident" id="4757933">req</span>&nbsp;<span class="op" id="4757937">*</span><span class="ident" id="4757938">Request</span><span class="op" id="4757945">)</span>&nbsp;<span class="op" id="4757947">(</span><span class="ident" id="4757948">resp</span>&nbsp;<span class="op" id="4757953">*</span><span class="ident" id="4757954">Response</span><span class="op" id="4757962">,</span>&nbsp;<span class="ident" id="4757964">err</span>&nbsp;<span class="builtintype" id="4757968">error</span><span class="op" id="4757973">)</span>&nbsp;<span class="op" id="4757975">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4757978">//&nbsp;We&nbsp;start&nbsp;ServeHTTP&nbsp;in&nbsp;a&nbsp;goroutine,&nbsp;which&nbsp;may&nbsp;take&nbsp;a&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758039">//&nbsp;time&nbsp;if&nbsp;the&nbsp;file&nbsp;is&nbsp;large.&nbsp;&nbsp;The&nbsp;newPopulateResponseWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758101">//&nbsp;call&nbsp;returns&nbsp;a&nbsp;channel&nbsp;which&nbsp;either&nbsp;ServeHTTP&nbsp;or&nbsp;finish()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758163">//&nbsp;sends&nbsp;our&nbsp;*Response&nbsp;on,&nbsp;once&nbsp;the&nbsp;*Response&nbsp;itself&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758226">//&nbsp;populated&nbsp;(even&nbsp;if&nbsp;the&nbsp;body&nbsp;itself&nbsp;is&nbsp;still&nbsp;being</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4758280">//&nbsp;written&nbsp;to&nbsp;the&nbsp;res.Body,&nbsp;a&nbsp;pipe)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758317">rw</span><span class="op" id="4758319">,</span>&nbsp;<span class="ident" id="4758321">resc</span>&nbsp;<span class="op" id="4758326">:=</span>&nbsp;<span class="ident" id="4758329">newPopulateResponseWriter</span><span class="op" id="4758354">(</span><span class="op" id="4758355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758358">go</span>&nbsp;<span class="keyword" id="4758361">func</span><span class="op" id="4758365">(</span><span class="op" id="4758366">)</span>&nbsp;<span class="op" id="4758368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758372">t</span><span class="op" id="4758373">.</span><span class="ident" id="4758374">fh</span><span class="op" id="4758376">.</span><span class="ident" id="4758377">ServeHTTP</span><span class="op" id="4758386">(</span><span class="ident" id="4758387">rw</span><span class="op" id="4758389">,</span>&nbsp;<span class="ident" id="4758391">req</span><span class="op" id="4758394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758398">rw</span><span class="op" id="4758400">.</span><span class="ident" id="4758401">finish</span><span class="op" id="4758407">(</span><span class="op" id="4758408">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758411">}</span><span class="op" id="4758412">(</span><span class="op" id="4758413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758416">return</span>&nbsp;<span class="op" id="4758423">&lt;-</span><span class="ident" id="4758425">resc</span><span class="op" id="4758429">,</span>&nbsp;<span class="ident" id="4758431">nil</span><br>
<span class="lineno"></span><span class="op" id="4758435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4758438">func</span>&nbsp;<span class="ident" id="4758443">newPopulateResponseWriter</span><span class="op" id="4758468">(</span><span class="op" id="4758469">)</span>&nbsp;<span class="op" id="4758471">(</span><span class="op" id="4758472">*</span><span class="ident" id="4758473">populateResponse</span><span class="op" id="4758489">,</span>&nbsp;<span class="op" id="4758491">&lt;-</span><span class="keyword" id="4758493">chan</span>&nbsp;<span class="op" id="4758498">*</span><span class="ident" id="4758499">Response</span><span class="op" id="4758507">)</span>&nbsp;<span class="op" id="4758509">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758512">pr</span><span class="op" id="4758514">,</span>&nbsp;<span class="ident" id="4758516">pw</span>&nbsp;<span class="op" id="4758519">:=</span>&nbsp;<span class="ident" id="4758522">io</span><span class="op" id="4758524">.</span><span class="ident" id="4758525">Pipe</span><span class="op" id="4758529">(</span><span class="op" id="4758530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758533">rw</span>&nbsp;<span class="op" id="4758536">:=</span>&nbsp;<span class="op" id="4758539">&amp;</span><span class="ident" id="4758540">populateResponse</span><span class="op" id="4758556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758560">ch</span><span class="op" id="4758562">:</span>&nbsp;<span class="builtinfunc" id="4758564">make</span><span class="op" id="4758568">(</span><span class="keyword" id="4758569">chan</span>&nbsp;<span class="op" id="4758574">*</span><span class="ident" id="4758575">Response</span><span class="op" id="4758583">)</span><span class="op" id="4758584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758588">pw</span><span class="op" id="4758590">:</span>&nbsp;<span class="ident" id="4758592">pw</span><span class="op" id="4758594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758598">res</span><span class="op" id="4758601">:</span>&nbsp;<span class="op" id="4758603">&amp;</span><span class="ident" id="4758604">Response</span><span class="op" id="4758612">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758617">Proto</span><span class="op" id="4758622">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4758629">&#34;HTTP/1.0&#34;</span><span class="op" id="4758639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758644">ProtoMajor</span><span class="op" id="4758654">:</span>&nbsp;<span class="num" id="4758656">1</span><span class="op" id="4758657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758662">Header</span><span class="op" id="4758668">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4758674">make</span><span class="op" id="4758678">(</span><span class="ident" id="4758679">Header</span><span class="op" id="4758685">)</span><span class="op" id="4758686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758691">Close</span><span class="op" id="4758696">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4758703">true</span><span class="op" id="4758707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4758712">Body</span><span class="op" id="4758716">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758724">pr</span><span class="op" id="4758726">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758730">}</span><span class="op" id="4758731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4758734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4758737">return</span>&nbsp;<span class="ident" id="4758744">rw</span><span class="op" id="4758746">,</span>&nbsp;<span class="ident" id="4758748">rw</span><span class="op" id="4758750">.</span><span class="ident" id="4758751">ch</span><br>
<span class="lineno"></span><span class="op" id="4758754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="4758757">//&nbsp;populateResponse&nbsp;is&nbsp;a&nbsp;ResponseWriter&nbsp;that&nbsp;populates&nbsp;the&nbsp;*Response</span><br>
<span class="lineno"></span><span class="comment" id="4758826">//&nbsp;in&nbsp;res,&nbsp;and&nbsp;writes&nbsp;its&nbsp;body&nbsp;to&nbsp;a&nbsp;pipe&nbsp;connected&nbsp;to&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span><span class="comment" id="4758893">//&nbsp;body.&nbsp;Once&nbsp;writes&nbsp;begin&nbsp;or&nbsp;finish()&nbsp;is&nbsp;called,&nbsp;the&nbsp;response&nbsp;is&nbsp;sent</span><br>
<span class="lineno"></span><span class="comment" id="4758964">//&nbsp;on&nbsp;ch.</span><br>
<span class="lineno"></span><span class="keyword" id="4758974">type</span>&nbsp;<span class="ident" id="4758979">populateResponse</span>&nbsp;<span class="keyword" id="4758996">struct</span>&nbsp;<span class="op" id="4759003">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759006">res</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759019">*</span><span class="ident" id="4759020">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759030">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759043">chan</span>&nbsp;<span class="op" id="4759048">*</span><span class="ident" id="4759049">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759059">wroteHeader</span>&nbsp;&nbsp;<span class="builtintype" id="4759072">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759078">hasContent</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4759091">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759097">sentResponse</span>&nbsp;<span class="builtintype" id="4759110">bool</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759116">pw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759129">*</span><span class="ident" id="4759130">io</span><span class="op" id="4759132">.</span><span class="ident" id="4759133">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="4759144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4759147">func</span>&nbsp;<span class="op" id="4759152">(</span><span class="ident" id="4759153">pr</span>&nbsp;<span class="op" id="4759156">*</span><span class="ident" id="4759157">populateResponse</span><span class="op" id="4759173">)</span>&nbsp;<span class="ident" id="4759175">finish</span><span class="op" id="4759181">(</span><span class="op" id="4759182">)</span>&nbsp;<span class="op" id="4759184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759187">if</span>&nbsp;<span class="op" id="4759190">!</span><span class="ident" id="4759191">pr</span><span class="op" id="4759193">.</span><span class="ident" id="4759194">wroteHeader</span>&nbsp;<span class="op" id="4759206">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759210">pr</span><span class="op" id="4759212">.</span><span class="ident" id="4759213">WriteHeader</span><span class="op" id="4759224">(</span><span class="num" id="4759225">500</span><span class="op" id="4759228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759234">if</span>&nbsp;<span class="op" id="4759237">!</span><span class="ident" id="4759238">pr</span><span class="op" id="4759240">.</span><span class="ident" id="4759241">sentResponse</span>&nbsp;<span class="op" id="4759254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759258">pr</span><span class="op" id="4759260">.</span><span class="ident" id="4759261">sendResponse</span><span class="op" id="4759273">(</span><span class="op" id="4759274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759277">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759280">pr</span><span class="op" id="4759282">.</span><span class="ident" id="4759283">pw</span><span class="op" id="4759285">.</span><span class="ident" id="4759286">Close</span><span class="op" id="4759291">(</span><span class="op" id="4759292">)</span><br>
<span class="lineno"></span><span class="op" id="4759294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4759297">func</span>&nbsp;<span class="op" id="4759302">(</span><span class="ident" id="4759303">pr</span>&nbsp;<span class="op" id="4759306">*</span><span class="ident" id="4759307">populateResponse</span><span class="op" id="4759323">)</span>&nbsp;<span class="ident" id="4759325">sendResponse</span><span class="op" id="4759337">(</span><span class="op" id="4759338">)</span>&nbsp;<span class="op" id="4759340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759343">if</span>&nbsp;<span class="ident" id="4759346">pr</span><span class="op" id="4759348">.</span><span class="ident" id="4759349">sentResponse</span>&nbsp;<span class="op" id="4759362">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759366">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759377">pr</span><span class="op" id="4759379">.</span><span class="ident" id="4759380">sentResponse</span>&nbsp;<span class="op" id="4759393">=</span>&nbsp;<span class="builtintype" id="4759395">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759402">if</span>&nbsp;<span class="ident" id="4759405">pr</span><span class="op" id="4759407">.</span><span class="ident" id="4759408">hasContent</span>&nbsp;<span class="op" id="4759419">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759423">pr</span><span class="op" id="4759425">.</span><span class="ident" id="4759426">res</span><span class="op" id="4759429">.</span><span class="ident" id="4759430">ContentLength</span>&nbsp;<span class="op" id="4759444">=</span>&nbsp;<span class="op" id="4759446">-</span><span class="num" id="4759447">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759453">pr</span><span class="op" id="4759455">.</span><span class="ident" id="4759456">ch</span>&nbsp;<span class="op" id="4759459">&lt;-</span>&nbsp;<span class="ident" id="4759462">pr</span><span class="op" id="4759464">.</span><span class="ident" id="4759465">res</span><br>
<span class="lineno"></span><span class="op" id="4759469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4759472">func</span>&nbsp;<span class="op" id="4759477">(</span><span class="ident" id="4759478">pr</span>&nbsp;<span class="op" id="4759481">*</span><span class="ident" id="4759482">populateResponse</span><span class="op" id="4759498">)</span>&nbsp;<span class="ident" id="4759500">Header</span><span class="op" id="4759506">(</span><span class="op" id="4759507">)</span>&nbsp;<span class="ident" id="4759509">Header</span>&nbsp;<span class="op" id="4759516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759519">return</span>&nbsp;<span class="ident" id="4759526">pr</span><span class="op" id="4759528">.</span><span class="ident" id="4759529">res</span><span class="op" id="4759532">.</span><span class="ident" id="4759533">Header</span><br>
<span class="lineno"></span><span class="op" id="4759540">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4759543">func</span>&nbsp;<span class="op" id="4759548">(</span><span class="ident" id="4759549">pr</span>&nbsp;<span class="op" id="4759552">*</span><span class="ident" id="4759553">populateResponse</span><span class="op" id="4759569">)</span>&nbsp;<span class="ident" id="4759571">WriteHeader</span><span class="op" id="4759582">(</span><span class="ident" id="4759583">code</span>&nbsp;<span class="builtintype" id="4759588">int</span><span class="op" id="4759591">)</span>&nbsp;<span class="op" id="4759593">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759596">if</span>&nbsp;<span class="ident" id="4759599">pr</span><span class="op" id="4759601">.</span><span class="ident" id="4759602">wroteHeader</span>&nbsp;<span class="op" id="4759614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759618">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759629">pr</span><span class="op" id="4759631">.</span><span class="ident" id="4759632">wroteHeader</span>&nbsp;<span class="op" id="4759644">=</span>&nbsp;<span class="builtintype" id="4759646">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759653">pr</span><span class="op" id="4759655">.</span><span class="ident" id="4759656">res</span><span class="op" id="4759659">.</span><span class="ident" id="4759660">StatusCode</span>&nbsp;<span class="op" id="4759671">=</span>&nbsp;<span class="ident" id="4759673">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759679">pr</span><span class="op" id="4759681">.</span><span class="ident" id="4759682">res</span><span class="op" id="4759685">.</span><span class="ident" id="4759686">Status</span>&nbsp;<span class="op" id="4759693">=</span>&nbsp;<span class="ident" id="4759695">fmt</span><span class="op" id="4759698">.</span><span class="ident" id="4759699">Sprintf</span><span class="op" id="4759706">(</span><span class="string" id="4759707">&#34;%d&nbsp;%s&#34;</span><span class="op" id="4759714">,</span>&nbsp;<span class="ident" id="4759716">code</span><span class="op" id="4759720">,</span>&nbsp;<span class="ident" id="4759722">StatusText</span><span class="op" id="4759732">(</span><span class="ident" id="4759733">code</span><span class="op" id="4759737">)</span><span class="op" id="4759738">)</span><br>
<span class="lineno"></span><span class="op" id="4759740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4759743">func</span>&nbsp;<span class="op" id="4759748">(</span><span class="ident" id="4759749">pr</span>&nbsp;<span class="op" id="4759752">*</span><span class="ident" id="4759753">populateResponse</span><span class="op" id="4759769">)</span>&nbsp;<span class="ident" id="4759771">Write</span><span class="op" id="4759776">(</span><span class="ident" id="4759777">p</span>&nbsp;<span class="op" id="4759779">[</span><span class="op" id="4759780">]</span><span class="builtintype" id="4759781">byte</span><span class="op" id="4759785">)</span>&nbsp;<span class="op" id="4759787">(</span><span class="ident" id="4759788">n</span>&nbsp;<span class="builtintype" id="4759790">int</span><span class="op" id="4759793">,</span>&nbsp;<span class="ident" id="4759795">err</span>&nbsp;<span class="builtintype" id="4759799">error</span><span class="op" id="4759804">)</span>&nbsp;<span class="op" id="4759806">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759809">if</span>&nbsp;<span class="op" id="4759812">!</span><span class="ident" id="4759813">pr</span><span class="op" id="4759815">.</span><span class="ident" id="4759816">wroteHeader</span>&nbsp;<span class="op" id="4759828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759832">pr</span><span class="op" id="4759834">.</span><span class="ident" id="4759835">WriteHeader</span><span class="op" id="4759846">(</span><span class="ident" id="4759847">StatusOK</span><span class="op" id="4759855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759861">pr</span><span class="op" id="4759863">.</span><span class="ident" id="4759864">hasContent</span>&nbsp;<span class="op" id="4759875">=</span>&nbsp;<span class="builtintype" id="4759877">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759883">if</span>&nbsp;<span class="op" id="4759886">!</span><span class="ident" id="4759887">pr</span><span class="op" id="4759889">.</span><span class="ident" id="4759890">sentResponse</span>&nbsp;<span class="op" id="4759903">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4759907">pr</span><span class="op" id="4759909">.</span><span class="ident" id="4759910">sendResponse</span><span class="op" id="4759922">(</span><span class="op" id="4759923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4759926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4759929">return</span>&nbsp;<span class="ident" id="4759936">pr</span><span class="op" id="4759938">.</span><span class="ident" id="4759939">pw</span><span class="op" id="4759941">.</span><span class="ident" id="4759942">Write</span><span class="op" id="4759947">(</span><span class="ident" id="4759948">p</span><span class="op" id="4759949">)</span><br>
<span class="lineno"></span><span class="op" id="4759951">}</span>
</div>
</body>
</html>
