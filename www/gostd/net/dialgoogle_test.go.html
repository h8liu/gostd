<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html" class="current">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6632640">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6632695">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6632749">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6632800">package</span>&nbsp;<span class="ident" id="6632808">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6632813">import</span>&nbsp;<span class="op" id="6632820">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6632823">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6632831">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6632838">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6632844">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6632855">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6632866">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6632876">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6632879">//&nbsp;If&nbsp;an&nbsp;IPv6&nbsp;tunnel&nbsp;is&nbsp;running,&nbsp;we&nbsp;can&nbsp;try&nbsp;dialing&nbsp;a&nbsp;real&nbsp;IPv6&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="6632952">var</span>&nbsp;<span class="ident" id="6632956">testIPv6</span>&nbsp;<span class="op" id="6632965">=</span>&nbsp;<span class="ident" id="6632967">flag</span><span class="op" id="6632971">.</span><span class="ident" id="6632972">Bool</span><span class="op" id="6632976">(</span><span class="string" id="6632977">&#34;ipv6&#34;</span><span class="op" id="6632983">,</span>&nbsp;<span class="builtintype" id="6632985">false</span><span class="op" id="6632990">,</span>&nbsp;<span class="string" id="6632992">&#34;assume&nbsp;ipv6&nbsp;tunnel&nbsp;is&nbsp;present&#34;</span><span class="op" id="6633023">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6633026">func</span>&nbsp;<span class="ident" id="6633031">TestResolveGoogle</span><span class="op" id="6633048">(</span><span class="ident" id="6633049">t</span>&nbsp;<span class="op" id="6633051">*</span><span class="ident" id="6633052">testing</span><span class="op" id="6633059">.</span><span class="ident" id="6633060">T</span><span class="op" id="6633061">)</span>&nbsp;<span class="op" id="6633063">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6633066">if</span>&nbsp;<span class="ident" id="6633069">testing</span><span class="op" id="6633076">.</span><span class="ident" id="6633077">Short</span><span class="op" id="6633082">(</span><span class="op" id="6633083">)</span>&nbsp;<span class="op" id="6633085">||</span>&nbsp;<span class="op" id="6633088">!</span><span class="op" id="6633089">*</span><span class="ident" id="6633090">testExternal</span>&nbsp;<span class="op" id="6633103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6633107">t</span><span class="op" id="6633108">.</span><span class="ident" id="6633109">Skip</span><span class="op" id="6633113">(</span><span class="string" id="6633114">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6633155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6633158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6633162">for</span>&nbsp;<span class="ident" id="6633166">_</span><span class="op" id="6633167">,</span>&nbsp;<span class="ident" id="6633169">network</span>&nbsp;<span class="op" id="6633177">:=</span>&nbsp;<span class="keyword" id="6633180">range</span>&nbsp;<span class="op" id="6633186">[</span><span class="op" id="6633187">]</span><span class="builtintype" id="6633188">string</span><span class="op" id="6633194">{</span><span class="string" id="6633195">&#34;tcp&#34;</span><span class="op" id="6633200">,</span>&nbsp;<span class="string" id="6633202">&#34;tcp4&#34;</span><span class="op" id="6633208">,</span>&nbsp;<span class="string" id="6633210">&#34;tcp6&#34;</span><span class="op" id="6633216">}</span>&nbsp;<span class="op" id="6633218">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6633222">addr</span><span class="op" id="6633226">,</span>&nbsp;<span class="ident" id="6633228">err</span>&nbsp;<span class="op" id="6633232">:=</span>&nbsp;<span class="ident" id="6633235">ResolveTCPAddr</span><span class="op" id="6633249">(</span><span class="ident" id="6633250">network</span><span class="op" id="6633257">,</span>&nbsp;<span class="string" id="6633259">&#34;www.google.com:http&#34;</span><span class="op" id="6633280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6633284">if</span>&nbsp;<span class="ident" id="6633287">err</span>&nbsp;<span class="op" id="6633291">!=</span>&nbsp;<span class="builtintype" id="6633294">nil</span>&nbsp;<span class="op" id="6633298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6633303">if</span>&nbsp;<span class="op" id="6633306">(</span><span class="ident" id="6633307">network</span>&nbsp;<span class="op" id="6633315">==</span>&nbsp;<span class="string" id="6633318">&#34;tcp&#34;</span>&nbsp;<span class="op" id="6633324">||</span>&nbsp;<span class="ident" id="6633327">network</span>&nbsp;<span class="op" id="6633335">==</span>&nbsp;<span class="string" id="6633338">&#34;tcp4&#34;</span><span class="op" id="6633344">)</span>&nbsp;<span class="op" id="6633346">&amp;&amp;</span>&nbsp;<span class="op" id="6633349">!</span><span class="ident" id="6633350">supportsIPv4</span>&nbsp;<span class="op" id="6633363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6633369">t</span><span class="op" id="6633370">.</span><span class="ident" id="6633371">Logf</span><span class="op" id="6633375">(</span><span class="string" id="6633376">&#34;ipv4&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="6633403">,</span>&nbsp;<span class="ident" id="6633405">err</span><span class="op" id="6633408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6633413">}</span>&nbsp;<span class="keyword" id="6633415">else</span>&nbsp;<span class="keyword" id="6633420">if</span>&nbsp;<span class="ident" id="6633423">network</span>&nbsp;<span class="op" id="6633431">==</span>&nbsp;<span class="string" id="6633434">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="6633441">&amp;&amp;</span>&nbsp;<span class="op" id="6633444">!</span><span class="ident" id="6633445">supportsIPv6</span>&nbsp;<span class="op" id="6633458">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6633464">t</span><span class="op" id="6633465">.</span><span class="ident" id="6633466">Logf</span><span class="op" id="6633470">(</span><span class="string" id="6633471">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="6633498">,</span>&nbsp;<span class="ident" id="6633500">err</span><span class="op" id="6633503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6633508">}</span>&nbsp;<span class="keyword" id="6633510">else</span>&nbsp;<span class="op" id="6633515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6633521">t</span><span class="op" id="6633522">.</span><span class="ident" id="6633523">Errorf</span><span class="op" id="6633529">(</span><span class="string" id="6633530">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6633557">,</span>&nbsp;<span class="ident" id="6633559">err</span><span class="op" id="6633562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6633567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6633572">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6633583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6633587">if</span>&nbsp;<span class="op" id="6633590">(</span><span class="ident" id="6633591">network</span>&nbsp;<span class="op" id="6633599">==</span>&nbsp;<span class="string" id="6633602">&#34;tcp&#34;</span>&nbsp;<span class="op" id="6633608">||</span>&nbsp;<span class="ident" id="6633611">network</span>&nbsp;<span class="op" id="6633619">==</span>&nbsp;<span class="string" id="6633622">&#34;tcp4&#34;</span><span class="op" id="6633628">)</span>&nbsp;<span class="op" id="6633630">&amp;&amp;</span>&nbsp;<span class="ident" id="6633633">addr</span><span class="op" id="6633637">.</span><span class="ident" id="6633638">IP</span><span class="op" id="6633640">.</span><span class="ident" id="6633641">To4</span><span class="op" id="6633644">(</span><span class="op" id="6633645">)</span>&nbsp;<span class="op" id="6633647">==</span>&nbsp;<span class="builtintype" id="6633650">nil</span>&nbsp;<span class="op" id="6633654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6633659">t</span><span class="op" id="6633660">.</span><span class="ident" id="6633661">Errorf</span><span class="op" id="6633667">(</span><span class="string" id="6633668">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="6633708">,</span>&nbsp;<span class="ident" id="6633710">addr</span><span class="op" id="6633714">,</span>&nbsp;<span class="ident" id="6633716">network</span><span class="op" id="6633723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6633727">}</span>&nbsp;<span class="keyword" id="6633729">else</span>&nbsp;<span class="keyword" id="6633734">if</span>&nbsp;<span class="ident" id="6633737">network</span>&nbsp;<span class="op" id="6633745">==</span>&nbsp;<span class="string" id="6633748">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="6633755">&amp;&amp;</span>&nbsp;<span class="op" id="6633758">(</span><span class="ident" id="6633759">addr</span><span class="op" id="6633763">.</span><span class="ident" id="6633764">IP</span><span class="op" id="6633766">.</span><span class="ident" id="6633767">To16</span><span class="op" id="6633771">(</span><span class="op" id="6633772">)</span>&nbsp;<span class="op" id="6633774">==</span>&nbsp;<span class="builtintype" id="6633777">nil</span>&nbsp;<span class="op" id="6633781">||</span>&nbsp;<span class="ident" id="6633784">addr</span><span class="op" id="6633788">.</span><span class="ident" id="6633789">IP</span><span class="op" id="6633791">.</span><span class="ident" id="6633792">To4</span><span class="op" id="6633795">(</span><span class="op" id="6633796">)</span>&nbsp;<span class="op" id="6633798">!=</span>&nbsp;<span class="builtintype" id="6633801">nil</span><span class="op" id="6633804">)</span>&nbsp;<span class="op" id="6633806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6633811">t</span><span class="op" id="6633812">.</span><span class="ident" id="6633813">Errorf</span><span class="op" id="6633819">(</span><span class="string" id="6633820">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="6633860">,</span>&nbsp;<span class="ident" id="6633862">addr</span><span class="op" id="6633866">,</span>&nbsp;<span class="ident" id="6633868">network</span><span class="op" id="6633875">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6633879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6633882">}</span><br>
<span class="lineno"></span><span class="op" id="6633884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6633887">func</span>&nbsp;<span class="ident" id="6633892">TestDialGoogle</span><span class="op" id="6633906">(</span><span class="ident" id="6633907">t</span>&nbsp;<span class="op" id="6633909">*</span><span class="ident" id="6633910">testing</span><span class="op" id="6633917">.</span><span class="ident" id="6633918">T</span><span class="op" id="6633919">)</span>&nbsp;<span class="op" id="6633921">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6633924">if</span>&nbsp;<span class="ident" id="6633927">testing</span><span class="op" id="6633934">.</span><span class="ident" id="6633935">Short</span><span class="op" id="6633940">(</span><span class="op" id="6633941">)</span>&nbsp;<span class="op" id="6633943">||</span>&nbsp;<span class="op" id="6633946">!</span><span class="op" id="6633947">*</span><span class="ident" id="6633948">testExternal</span>&nbsp;<span class="op" id="6633961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6633965">t</span><span class="op" id="6633966">.</span><span class="ident" id="6633967">Skip</span><span class="op" id="6633971">(</span><span class="string" id="6633972">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6634013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6634016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6634020">d</span>&nbsp;<span class="op" id="6634022">:=</span>&nbsp;<span class="op" id="6634025">&amp;</span><span class="ident" id="6634026">Dialer</span><span class="op" id="6634032">{</span><span class="ident" id="6634033">DualStack</span><span class="op" id="6634042">:</span>&nbsp;<span class="builtintype" id="6634044">true</span><span class="op" id="6634048">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6634051">for</span>&nbsp;<span class="ident" id="6634055">_</span><span class="op" id="6634056">,</span>&nbsp;<span class="ident" id="6634058">network</span>&nbsp;<span class="op" id="6634066">:=</span>&nbsp;<span class="keyword" id="6634069">range</span>&nbsp;<span class="op" id="6634075">[</span><span class="op" id="6634076">]</span><span class="builtintype" id="6634077">string</span><span class="op" id="6634083">{</span><span class="string" id="6634084">&#34;tcp&#34;</span><span class="op" id="6634089">,</span>&nbsp;<span class="string" id="6634091">&#34;tcp4&#34;</span><span class="op" id="6634097">,</span>&nbsp;<span class="string" id="6634099">&#34;tcp6&#34;</span><span class="op" id="6634105">}</span>&nbsp;<span class="op" id="6634107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6634111">if</span>&nbsp;<span class="ident" id="6634114">network</span>&nbsp;<span class="op" id="6634122">==</span>&nbsp;<span class="string" id="6634125">&#34;tcp&#34;</span>&nbsp;<span class="op" id="6634131">&amp;&amp;</span>&nbsp;<span class="op" id="6634134">!</span><span class="ident" id="6634135">supportsIPv4</span>&nbsp;<span class="op" id="6634148">&amp;&amp;</span>&nbsp;<span class="op" id="6634151">!</span><span class="ident" id="6634152">supportsIPv6</span>&nbsp;<span class="op" id="6634165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6634170">t</span><span class="op" id="6634171">.</span><span class="ident" id="6634172">Logf</span><span class="op" id="6634176">(</span><span class="string" id="6634177">&#34;skipping&nbsp;test;&nbsp;both&nbsp;ipv4&nbsp;and&nbsp;ipv6&nbsp;are&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6634230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6634235">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6634246">}</span>&nbsp;<span class="keyword" id="6634248">else</span>&nbsp;<span class="keyword" id="6634253">if</span>&nbsp;<span class="ident" id="6634256">network</span>&nbsp;<span class="op" id="6634264">==</span>&nbsp;<span class="string" id="6634267">&#34;tcp4&#34;</span>&nbsp;<span class="op" id="6634274">&amp;&amp;</span>&nbsp;<span class="op" id="6634277">!</span><span class="ident" id="6634278">supportsIPv4</span>&nbsp;<span class="op" id="6634291">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6634296">t</span><span class="op" id="6634297">.</span><span class="ident" id="6634298">Logf</span><span class="op" id="6634302">(</span><span class="string" id="6634303">&#34;skipping&nbsp;test;&nbsp;ipv4&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6634341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6634346">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6634357">}</span>&nbsp;<span class="keyword" id="6634359">else</span>&nbsp;<span class="keyword" id="6634364">if</span>&nbsp;<span class="ident" id="6634367">network</span>&nbsp;<span class="op" id="6634375">==</span>&nbsp;<span class="string" id="6634378">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="6634385">&amp;&amp;</span>&nbsp;<span class="op" id="6634388">!</span><span class="ident" id="6634389">supportsIPv6</span>&nbsp;<span class="op" id="6634402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6634407">t</span><span class="op" id="6634408">.</span><span class="ident" id="6634409">Logf</span><span class="op" id="6634413">(</span><span class="string" id="6634414">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6634452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6634457">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6634468">}</span>&nbsp;<span class="keyword" id="6634470">else</span>&nbsp;<span class="keyword" id="6634475">if</span>&nbsp;<span class="ident" id="6634478">network</span>&nbsp;<span class="op" id="6634486">==</span>&nbsp;<span class="string" id="6634489">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="6634496">&amp;&amp;</span>&nbsp;<span class="op" id="6634499">!</span><span class="op" id="6634500">*</span><span class="ident" id="6634501">testIPv6</span>&nbsp;<span class="op" id="6634510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6634515">t</span><span class="op" id="6634516">.</span><span class="ident" id="6634517">Logf</span><span class="op" id="6634521">(</span><span class="string" id="6634522">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="6634558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6634563">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6634574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6634578">if</span>&nbsp;<span class="ident" id="6634581">c</span><span class="op" id="6634582">,</span>&nbsp;<span class="ident" id="6634584">err</span>&nbsp;<span class="op" id="6634588">:=</span>&nbsp;<span class="ident" id="6634591">d</span><span class="op" id="6634592">.</span><span class="ident" id="6634593">Dial</span><span class="op" id="6634597">(</span><span class="ident" id="6634598">network</span><span class="op" id="6634605">,</span>&nbsp;<span class="string" id="6634607">&#34;www.google.com:http&#34;</span><span class="op" id="6634628">)</span><span class="op" id="6634629">;</span>&nbsp;<span class="ident" id="6634631">err</span>&nbsp;<span class="op" id="6634635">!=</span>&nbsp;<span class="builtintype" id="6634638">nil</span>&nbsp;<span class="op" id="6634642">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6634647">t</span><span class="op" id="6634648">.</span><span class="ident" id="6634649">Errorf</span><span class="op" id="6634655">(</span><span class="string" id="6634656">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6634673">,</span>&nbsp;<span class="ident" id="6634675">err</span><span class="op" id="6634678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6634682">}</span>&nbsp;<span class="keyword" id="6634684">else</span>&nbsp;<span class="op" id="6634689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6634694">c</span><span class="op" id="6634695">.</span><span class="ident" id="6634696">Close</span><span class="op" id="6634701">(</span><span class="op" id="6634702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6634706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6634709">}</span><br>
<span class="lineno">70</span><span class="op" id="6634711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6634714">//&nbsp;fd&nbsp;is&nbsp;already&nbsp;connected&nbsp;to&nbsp;the&nbsp;destination,&nbsp;port&nbsp;80.</span><br>
<span class="lineno"></span><span class="comment" id="6634770">//&nbsp;Run&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;fetch&nbsp;the&nbsp;appropriate&nbsp;page.</span><br>
<span class="lineno"></span><span class="keyword" id="6634824">func</span>&nbsp;<span class="ident" id="6634829">fetchGoogle</span><span class="op" id="6634840">(</span><span class="ident" id="6634841">t</span>&nbsp;<span class="op" id="6634843">*</span><span class="ident" id="6634844">testing</span><span class="op" id="6634851">.</span><span class="ident" id="6634852">T</span><span class="op" id="6634853">,</span>&nbsp;<span class="ident" id="6634855">fd</span>&nbsp;<span class="ident" id="6634858">Conn</span><span class="op" id="6634862">,</span>&nbsp;<span class="ident" id="6634864">network</span><span class="op" id="6634871">,</span>&nbsp;<span class="ident" id="6634873">addr</span>&nbsp;<span class="builtintype" id="6634878">string</span><span class="op" id="6634884">)</span>&nbsp;<span class="op" id="6634886">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6634889">req</span>&nbsp;<span class="op" id="6634893">:=</span>&nbsp;<span class="op" id="6634896">[</span><span class="op" id="6634897">]</span><span class="builtintype" id="6634898">byte</span><span class="op" id="6634902">(</span><span class="string" id="6634903">&#34;GET&nbsp;/robots.txt&nbsp;HTTP/1.0\r\nHost:&nbsp;www.google.com\r\n\r\n&#34;</span><span class="op" id="6634961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6634964">n</span><span class="op" id="6634965">,</span>&nbsp;<span class="ident" id="6634967">err</span>&nbsp;<span class="op" id="6634971">:=</span>&nbsp;<span class="ident" id="6634974">fd</span><span class="op" id="6634976">.</span><span class="ident" id="6634977">Write</span><span class="op" id="6634982">(</span><span class="ident" id="6634983">req</span><span class="op" id="6634986">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6634990">buf</span>&nbsp;<span class="op" id="6634994">:=</span>&nbsp;<span class="builtinfunc" id="6634997">make</span><span class="op" id="6635001">(</span><span class="op" id="6635002">[</span><span class="op" id="6635003">]</span><span class="builtintype" id="6635004">byte</span><span class="op" id="6635008">,</span>&nbsp;<span class="num" id="6635010">1000</span><span class="op" id="6635014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6635017">n</span><span class="op" id="6635018">,</span>&nbsp;<span class="ident" id="6635020">err</span>&nbsp;<span class="op" id="6635024">=</span>&nbsp;<span class="ident" id="6635026">io</span><span class="op" id="6635028">.</span><span class="ident" id="6635029">ReadFull</span><span class="op" id="6635037">(</span><span class="ident" id="6635038">fd</span><span class="op" id="6635040">,</span>&nbsp;<span class="ident" id="6635042">buf</span><span class="op" id="6635045">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6635049">if</span>&nbsp;<span class="ident" id="6635052">n</span>&nbsp;<span class="op" id="6635054">&lt;</span>&nbsp;<span class="num" id="6635056">1000</span>&nbsp;<span class="op" id="6635061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6635065">t</span><span class="op" id="6635066">.</span><span class="ident" id="6635067">Errorf</span><span class="op" id="6635073">(</span><span class="string" id="6635074">&#34;fetchGoogle:&nbsp;short&nbsp;HTTP&nbsp;read&nbsp;from&nbsp;%s&nbsp;%s&nbsp;-&nbsp;%v&#34;</span><span class="op" id="6635120">,</span>&nbsp;<span class="ident" id="6635122">network</span><span class="op" id="6635129">,</span>&nbsp;<span class="ident" id="6635131">addr</span><span class="op" id="6635135">,</span>&nbsp;<span class="ident" id="6635137">err</span><span class="op" id="6635140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6635144">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6635152">}</span><br>
<span class="lineno">85</span><span class="op" id="6635154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6635157">func</span>&nbsp;<span class="ident" id="6635162">doDial</span><span class="op" id="6635168">(</span><span class="ident" id="6635169">t</span>&nbsp;<span class="op" id="6635171">*</span><span class="ident" id="6635172">testing</span><span class="op" id="6635179">.</span><span class="ident" id="6635180">T</span><span class="op" id="6635181">,</span>&nbsp;<span class="ident" id="6635183">network</span><span class="op" id="6635190">,</span>&nbsp;<span class="ident" id="6635192">addr</span>&nbsp;<span class="builtintype" id="6635197">string</span><span class="op" id="6635203">)</span>&nbsp;<span class="op" id="6635205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6635208">fd</span><span class="op" id="6635210">,</span>&nbsp;<span class="ident" id="6635212">err</span>&nbsp;<span class="op" id="6635216">:=</span>&nbsp;<span class="ident" id="6635219">Dial</span><span class="op" id="6635223">(</span><span class="ident" id="6635224">network</span><span class="op" id="6635231">,</span>&nbsp;<span class="ident" id="6635233">addr</span><span class="op" id="6635237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6635240">if</span>&nbsp;<span class="ident" id="6635243">err</span>&nbsp;<span class="op" id="6635247">!=</span>&nbsp;<span class="builtintype" id="6635250">nil</span>&nbsp;<span class="op" id="6635254">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6635258">t</span><span class="op" id="6635259">.</span><span class="ident" id="6635260">Errorf</span><span class="op" id="6635266">(</span><span class="string" id="6635267">&#34;Dial(%q,&nbsp;%q,&nbsp;%q)&nbsp;=&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="6635293">,</span>&nbsp;<span class="ident" id="6635295">network</span><span class="op" id="6635302">,</span>&nbsp;<span class="string" id="6635304">&#34;&#34;</span><span class="op" id="6635306">,</span>&nbsp;<span class="ident" id="6635308">addr</span><span class="op" id="6635312">,</span>&nbsp;<span class="ident" id="6635314">err</span><span class="op" id="6635317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6635321">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6635329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6635332">fetchGoogle</span><span class="op" id="6635343">(</span><span class="ident" id="6635344">t</span><span class="op" id="6635345">,</span>&nbsp;<span class="ident" id="6635347">fd</span><span class="op" id="6635349">,</span>&nbsp;<span class="ident" id="6635351">network</span><span class="op" id="6635358">,</span>&nbsp;<span class="ident" id="6635360">addr</span><span class="op" id="6635364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6635367">fd</span><span class="op" id="6635369">.</span><span class="ident" id="6635370">Close</span><span class="op" id="6635375">(</span><span class="op" id="6635376">)</span><br>
<span class="lineno">95</span><span class="op" id="6635378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6635381">var</span>&nbsp;<span class="ident" id="6635385">googleaddrsipv4</span>&nbsp;<span class="op" id="6635401">=</span>&nbsp;<span class="op" id="6635403">[</span><span class="op" id="6635404">]</span><span class="builtintype" id="6635405">string</span><span class="op" id="6635411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6635414">&#34;%d.%d.%d.%d:80&#34;</span><span class="op" id="6635430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6635433">&#34;www.google.com:80&#34;</span><span class="op" id="6635452">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6635455">&#34;%d.%d.%d.%d:http&#34;</span><span class="op" id="6635473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6635476">&#34;www.google.com:http&#34;</span><span class="op" id="6635497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6635500">&#34;%03d.%03d.%03d.%03d:0080&#34;</span><span class="op" id="6635526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6635529">&#34;[::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="6635554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6635557">&#34;[::ffff:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="6635588">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6635591">&#34;[0:0:0:0:0000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="6635627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6635630">&#34;[0:0:0:0:000000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="6635668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6635671">&#34;[0:0:0:0::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="6635703">,</span><br>
<span class="lineno"></span><span class="op" id="6635705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="6635708">func</span>&nbsp;<span class="ident" id="6635713">TestDialGoogleIPv4</span><span class="op" id="6635731">(</span><span class="ident" id="6635732">t</span>&nbsp;<span class="op" id="6635734">*</span><span class="ident" id="6635735">testing</span><span class="op" id="6635742">.</span><span class="ident" id="6635743">T</span><span class="op" id="6635744">)</span>&nbsp;<span class="op" id="6635746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6635749">if</span>&nbsp;<span class="ident" id="6635752">testing</span><span class="op" id="6635759">.</span><span class="ident" id="6635760">Short</span><span class="op" id="6635765">(</span><span class="op" id="6635766">)</span>&nbsp;<span class="op" id="6635768">||</span>&nbsp;<span class="op" id="6635771">!</span><span class="op" id="6635772">*</span><span class="ident" id="6635773">testExternal</span>&nbsp;<span class="op" id="6635786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6635790">t</span><span class="op" id="6635791">.</span><span class="ident" id="6635792">Skip</span><span class="op" id="6635796">(</span><span class="string" id="6635797">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6635838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6635841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6635845">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv4&nbsp;address&nbsp;for&nbsp;google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6635894">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6635914">addrs</span><span class="op" id="6635919">,</span>&nbsp;<span class="ident" id="6635921">err</span>&nbsp;<span class="op" id="6635925">:=</span>&nbsp;<span class="ident" id="6635928">LookupIP</span><span class="op" id="6635936">(</span><span class="string" id="6635937">&#34;www.google.com&#34;</span><span class="op" id="6635953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6635956">if</span>&nbsp;<span class="ident" id="6635959">err</span>&nbsp;<span class="op" id="6635963">!=</span>&nbsp;<span class="builtintype" id="6635966">nil</span>&nbsp;<span class="op" id="6635970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6635974">t</span><span class="op" id="6635975">.</span><span class="ident" id="6635976">Fatalf</span><span class="op" id="6635982">(</span><span class="string" id="6635983">&#34;lookup&nbsp;www.google.com:&nbsp;%v&#34;</span><span class="op" id="6636010">,</span>&nbsp;<span class="ident" id="6636012">err</span><span class="op" id="6636015">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6636018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6636021">var</span>&nbsp;<span class="ident" id="6636025">ip</span>&nbsp;<span class="ident" id="6636028">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6636032">for</span>&nbsp;<span class="ident" id="6636036">_</span><span class="op" id="6636037">,</span>&nbsp;<span class="ident" id="6636039">addr</span>&nbsp;<span class="op" id="6636044">:=</span>&nbsp;<span class="keyword" id="6636047">range</span>&nbsp;<span class="ident" id="6636053">addrs</span>&nbsp;<span class="op" id="6636059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6636063">if</span>&nbsp;<span class="ident" id="6636066">x</span>&nbsp;<span class="op" id="6636068">:=</span>&nbsp;<span class="ident" id="6636071">addr</span><span class="op" id="6636075">.</span><span class="ident" id="6636076">To4</span><span class="op" id="6636079">(</span><span class="op" id="6636080">)</span><span class="op" id="6636081">;</span>&nbsp;<span class="ident" id="6636083">x</span>&nbsp;<span class="op" id="6636085">!=</span>&nbsp;<span class="builtintype" id="6636088">nil</span>&nbsp;<span class="op" id="6636092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6636097">ip</span>&nbsp;<span class="op" id="6636100">=</span>&nbsp;<span class="ident" id="6636102">x</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6636107">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6636115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6636118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6636121">if</span>&nbsp;<span class="ident" id="6636124">ip</span>&nbsp;<span class="op" id="6636127">==</span>&nbsp;<span class="builtintype" id="6636130">nil</span>&nbsp;<span class="op" id="6636134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6636138">t</span><span class="op" id="6636139">.</span><span class="ident" id="6636140">Fatalf</span><span class="op" id="6636146">(</span><span class="string" id="6636147">&#34;no&nbsp;IPv4&nbsp;addresses&nbsp;for&nbsp;www.google.com&#34;</span><span class="op" id="6636185">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6636188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6636192">for</span>&nbsp;<span class="ident" id="6636196">i</span><span class="op" id="6636197">,</span>&nbsp;<span class="ident" id="6636199">s</span>&nbsp;<span class="op" id="6636201">:=</span>&nbsp;<span class="keyword" id="6636204">range</span>&nbsp;<span class="ident" id="6636210">googleaddrsipv4</span>&nbsp;<span class="op" id="6636226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6636230">if</span>&nbsp;<span class="ident" id="6636233">strings</span><span class="op" id="6636240">.</span><span class="ident" id="6636241">Contains</span><span class="op" id="6636249">(</span><span class="ident" id="6636250">s</span><span class="op" id="6636251">,</span>&nbsp;<span class="string" id="6636253">&#34;%&#34;</span><span class="op" id="6636256">)</span>&nbsp;<span class="op" id="6636258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6636263">googleaddrsipv4</span><span class="op" id="6636278">[</span><span class="ident" id="6636279">i</span><span class="op" id="6636280">]</span>&nbsp;<span class="op" id="6636282">=</span>&nbsp;<span class="ident" id="6636284">fmt</span><span class="op" id="6636287">.</span><span class="ident" id="6636288">Sprintf</span><span class="op" id="6636295">(</span><span class="ident" id="6636296">s</span><span class="op" id="6636297">,</span>&nbsp;<span class="ident" id="6636299">ip</span><span class="op" id="6636301">[</span><span class="num" id="6636302">0</span><span class="op" id="6636303">]</span><span class="op" id="6636304">,</span>&nbsp;<span class="ident" id="6636306">ip</span><span class="op" id="6636308">[</span><span class="num" id="6636309">1</span><span class="op" id="6636310">]</span><span class="op" id="6636311">,</span>&nbsp;<span class="ident" id="6636313">ip</span><span class="op" id="6636315">[</span><span class="num" id="6636316">2</span><span class="op" id="6636317">]</span><span class="op" id="6636318">,</span>&nbsp;<span class="ident" id="6636320">ip</span><span class="op" id="6636322">[</span><span class="num" id="6636323">3</span><span class="op" id="6636324">]</span><span class="op" id="6636325">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6636329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6636332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6636336">for</span>&nbsp;<span class="ident" id="6636340">i</span>&nbsp;<span class="op" id="6636342">:=</span>&nbsp;<span class="num" id="6636345">0</span><span class="op" id="6636346">;</span>&nbsp;<span class="ident" id="6636348">i</span>&nbsp;<span class="op" id="6636350">&lt;</span>&nbsp;<span class="builtinfunc" id="6636352">len</span><span class="op" id="6636355">(</span><span class="ident" id="6636356">googleaddrsipv4</span><span class="op" id="6636371">)</span><span class="op" id="6636372">;</span>&nbsp;<span class="ident" id="6636374">i</span><span class="op" id="6636375">++</span>&nbsp;<span class="op" id="6636378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6636382">addr</span>&nbsp;<span class="op" id="6636387">:=</span>&nbsp;<span class="ident" id="6636390">googleaddrsipv4</span><span class="op" id="6636405">[</span><span class="ident" id="6636406">i</span><span class="op" id="6636407">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6636411">if</span>&nbsp;<span class="ident" id="6636414">addr</span>&nbsp;<span class="op" id="6636419">==</span>&nbsp;<span class="string" id="6636422">&#34;&#34;</span>&nbsp;<span class="op" id="6636425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6636430">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6636441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6636445">t</span><span class="op" id="6636446">.</span><span class="ident" id="6636447">Logf</span><span class="op" id="6636451">(</span><span class="string" id="6636452">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="6636462">,</span>&nbsp;<span class="ident" id="6636464">addr</span><span class="op" id="6636468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6636472">doDial</span><span class="op" id="6636478">(</span><span class="ident" id="6636479">t</span><span class="op" id="6636480">,</span>&nbsp;<span class="string" id="6636482">&#34;tcp&#34;</span><span class="op" id="6636487">,</span>&nbsp;<span class="ident" id="6636489">addr</span><span class="op" id="6636493">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6636497">if</span>&nbsp;<span class="ident" id="6636500">addr</span><span class="op" id="6636504">[</span><span class="num" id="6636505">0</span><span class="op" id="6636506">]</span>&nbsp;<span class="op" id="6636508">!=</span>&nbsp;<span class="string" id="6636511">&#39;[&#39;</span>&nbsp;<span class="op" id="6636515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6636520">doDial</span><span class="op" id="6636526">(</span><span class="ident" id="6636527">t</span><span class="op" id="6636528">,</span>&nbsp;<span class="string" id="6636530">&#34;tcp4&#34;</span><span class="op" id="6636536">,</span>&nbsp;<span class="ident" id="6636538">addr</span><span class="op" id="6636542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6636547">if</span>&nbsp;<span class="ident" id="6636550">supportsIPv6</span>&nbsp;<span class="op" id="6636563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6636569">//&nbsp;make&nbsp;sure&nbsp;syscall.SocketDisableIPv6&nbsp;flag&nbsp;works.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6636624">syscall</span><span class="op" id="6636631">.</span><span class="ident" id="6636632">SocketDisableIPv6</span>&nbsp;<span class="op" id="6636650">=</span>&nbsp;<span class="builtintype" id="6636652">true</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6636661">doDial</span><span class="op" id="6636667">(</span><span class="ident" id="6636668">t</span><span class="op" id="6636669">,</span>&nbsp;<span class="string" id="6636671">&#34;tcp&#34;</span><span class="op" id="6636676">,</span>&nbsp;<span class="ident" id="6636678">addr</span><span class="op" id="6636682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6636688">doDial</span><span class="op" id="6636694">(</span><span class="ident" id="6636695">t</span><span class="op" id="6636696">,</span>&nbsp;<span class="string" id="6636698">&#34;tcp4&#34;</span><span class="op" id="6636704">,</span>&nbsp;<span class="ident" id="6636706">addr</span><span class="op" id="6636710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6636716">syscall</span><span class="op" id="6636723">.</span><span class="ident" id="6636724">SocketDisableIPv6</span>&nbsp;<span class="op" id="6636742">=</span>&nbsp;<span class="builtintype" id="6636744">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6636753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6636757">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6636760">}</span><br>
<span class="lineno"></span><span class="op" id="6636762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6636765">var</span>&nbsp;<span class="ident" id="6636769">googleaddrsipv6</span>&nbsp;<span class="op" id="6636785">=</span>&nbsp;<span class="op" id="6636787">[</span><span class="op" id="6636788">]</span><span class="builtintype" id="6636789">string</span><span class="op" id="6636795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6636798">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="6636876">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6636879">&#34;ipv6.google.com:80&#34;</span><span class="op" id="6636899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6636902">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:http&#34;</span><span class="op" id="6636982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6636985">&#34;ipv6.google.com:http&#34;</span><span class="op" id="6637007">,</span><br>
<span class="lineno"></span><span class="op" id="6637009">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="6637012">func</span>&nbsp;<span class="ident" id="6637017">TestDialGoogleIPv6</span><span class="op" id="6637035">(</span><span class="ident" id="6637036">t</span>&nbsp;<span class="op" id="6637038">*</span><span class="ident" id="6637039">testing</span><span class="op" id="6637046">.</span><span class="ident" id="6637047">T</span><span class="op" id="6637048">)</span>&nbsp;<span class="op" id="6637050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637053">if</span>&nbsp;<span class="ident" id="6637056">testing</span><span class="op" id="6637063">.</span><span class="ident" id="6637064">Short</span><span class="op" id="6637069">(</span><span class="op" id="6637070">)</span>&nbsp;<span class="op" id="6637072">||</span>&nbsp;<span class="op" id="6637075">!</span><span class="op" id="6637076">*</span><span class="ident" id="6637077">testExternal</span>&nbsp;<span class="op" id="6637090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6637094">t</span><span class="op" id="6637095">.</span><span class="ident" id="6637096">Skip</span><span class="op" id="6637100">(</span><span class="string" id="6637101">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6637142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6637145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6637148">//&nbsp;Only&nbsp;run&nbsp;tcp6&nbsp;if&nbsp;the&nbsp;kernel&nbsp;will&nbsp;take&nbsp;it.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637194">if</span>&nbsp;<span class="op" id="6637197">!</span><span class="ident" id="6637198">supportsIPv6</span>&nbsp;<span class="op" id="6637211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6637215">t</span><span class="op" id="6637216">.</span><span class="ident" id="6637217">Skip</span><span class="op" id="6637221">(</span><span class="string" id="6637222">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6637260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6637263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637266">if</span>&nbsp;<span class="op" id="6637269">!</span><span class="op" id="6637270">*</span><span class="ident" id="6637271">testIPv6</span>&nbsp;<span class="op" id="6637280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6637284">t</span><span class="op" id="6637285">.</span><span class="ident" id="6637286">Skip</span><span class="op" id="6637290">(</span><span class="string" id="6637291">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="6637327">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6637330">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6637334">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv6&nbsp;address&nbsp;for&nbsp;ipv6.google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6637388">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6637408">addrs</span><span class="op" id="6637413">,</span>&nbsp;<span class="ident" id="6637415">err</span>&nbsp;<span class="op" id="6637419">:=</span>&nbsp;<span class="ident" id="6637422">LookupIP</span><span class="op" id="6637430">(</span><span class="string" id="6637431">&#34;ipv6.google.com&#34;</span><span class="op" id="6637448">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637451">if</span>&nbsp;<span class="ident" id="6637454">err</span>&nbsp;<span class="op" id="6637458">!=</span>&nbsp;<span class="builtintype" id="6637461">nil</span>&nbsp;<span class="op" id="6637465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6637469">t</span><span class="op" id="6637470">.</span><span class="ident" id="6637471">Fatalf</span><span class="op" id="6637477">(</span><span class="string" id="6637478">&#34;lookup&nbsp;ipv6.google.com:&nbsp;%v&#34;</span><span class="op" id="6637506">,</span>&nbsp;<span class="ident" id="6637508">err</span><span class="op" id="6637511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6637514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637517">var</span>&nbsp;<span class="ident" id="6637521">ip</span>&nbsp;<span class="ident" id="6637524">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637528">for</span>&nbsp;<span class="ident" id="6637532">_</span><span class="op" id="6637533">,</span>&nbsp;<span class="ident" id="6637535">addr</span>&nbsp;<span class="op" id="6637540">:=</span>&nbsp;<span class="keyword" id="6637543">range</span>&nbsp;<span class="ident" id="6637549">addrs</span>&nbsp;<span class="op" id="6637555">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637559">if</span>&nbsp;<span class="ident" id="6637562">x</span>&nbsp;<span class="op" id="6637564">:=</span>&nbsp;<span class="ident" id="6637567">addr</span><span class="op" id="6637571">.</span><span class="ident" id="6637572">To16</span><span class="op" id="6637576">(</span><span class="op" id="6637577">)</span><span class="op" id="6637578">;</span>&nbsp;<span class="ident" id="6637580">x</span>&nbsp;<span class="op" id="6637582">!=</span>&nbsp;<span class="builtintype" id="6637585">nil</span>&nbsp;<span class="op" id="6637589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6637594">ip</span>&nbsp;<span class="op" id="6637597">=</span>&nbsp;<span class="ident" id="6637599">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637604">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6637612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6637615">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637618">if</span>&nbsp;<span class="ident" id="6637621">ip</span>&nbsp;<span class="op" id="6637624">==</span>&nbsp;<span class="builtintype" id="6637627">nil</span>&nbsp;<span class="op" id="6637631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6637635">t</span><span class="op" id="6637636">.</span><span class="ident" id="6637637">Fatalf</span><span class="op" id="6637643">(</span><span class="string" id="6637644">&#34;no&nbsp;IPv6&nbsp;addresses&nbsp;for&nbsp;ipv6.google.com&#34;</span><span class="op" id="6637683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6637686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637690">for</span>&nbsp;<span class="ident" id="6637694">i</span><span class="op" id="6637695">,</span>&nbsp;<span class="ident" id="6637697">s</span>&nbsp;<span class="op" id="6637699">:=</span>&nbsp;<span class="keyword" id="6637702">range</span>&nbsp;<span class="ident" id="6637708">googleaddrsipv6</span>&nbsp;<span class="op" id="6637724">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637728">if</span>&nbsp;<span class="ident" id="6637731">strings</span><span class="op" id="6637738">.</span><span class="ident" id="6637739">Contains</span><span class="op" id="6637747">(</span><span class="ident" id="6637748">s</span><span class="op" id="6637749">,</span>&nbsp;<span class="string" id="6637751">&#34;%&#34;</span><span class="op" id="6637754">)</span>&nbsp;<span class="op" id="6637756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6637761">googleaddrsipv6</span><span class="op" id="6637776">[</span><span class="ident" id="6637777">i</span><span class="op" id="6637778">]</span>&nbsp;<span class="op" id="6637780">=</span>&nbsp;<span class="ident" id="6637782">fmt</span><span class="op" id="6637785">.</span><span class="ident" id="6637786">Sprintf</span><span class="op" id="6637793">(</span><span class="ident" id="6637794">s</span><span class="op" id="6637795">,</span>&nbsp;<span class="ident" id="6637797">ip</span><span class="op" id="6637799">[</span><span class="num" id="6637800">0</span><span class="op" id="6637801">]</span><span class="op" id="6637802">,</span>&nbsp;<span class="ident" id="6637804">ip</span><span class="op" id="6637806">[</span><span class="num" id="6637807">1</span><span class="op" id="6637808">]</span><span class="op" id="6637809">,</span>&nbsp;<span class="ident" id="6637811">ip</span><span class="op" id="6637813">[</span><span class="num" id="6637814">2</span><span class="op" id="6637815">]</span><span class="op" id="6637816">,</span>&nbsp;<span class="ident" id="6637818">ip</span><span class="op" id="6637820">[</span><span class="num" id="6637821">3</span><span class="op" id="6637822">]</span><span class="op" id="6637823">,</span>&nbsp;<span class="ident" id="6637825">ip</span><span class="op" id="6637827">[</span><span class="num" id="6637828">4</span><span class="op" id="6637829">]</span><span class="op" id="6637830">,</span>&nbsp;<span class="ident" id="6637832">ip</span><span class="op" id="6637834">[</span><span class="num" id="6637835">5</span><span class="op" id="6637836">]</span><span class="op" id="6637837">,</span>&nbsp;<span class="ident" id="6637839">ip</span><span class="op" id="6637841">[</span><span class="num" id="6637842">6</span><span class="op" id="6637843">]</span><span class="op" id="6637844">,</span>&nbsp;<span class="ident" id="6637846">ip</span><span class="op" id="6637848">[</span><span class="num" id="6637849">7</span><span class="op" id="6637850">]</span><span class="op" id="6637851">,</span>&nbsp;<span class="ident" id="6637853">ip</span><span class="op" id="6637855">[</span><span class="num" id="6637856">8</span><span class="op" id="6637857">]</span><span class="op" id="6637858">,</span>&nbsp;<span class="ident" id="6637860">ip</span><span class="op" id="6637862">[</span><span class="num" id="6637863">9</span><span class="op" id="6637864">]</span><span class="op" id="6637865">,</span>&nbsp;<span class="ident" id="6637867">ip</span><span class="op" id="6637869">[</span><span class="num" id="6637870">10</span><span class="op" id="6637872">]</span><span class="op" id="6637873">,</span>&nbsp;<span class="ident" id="6637875">ip</span><span class="op" id="6637877">[</span><span class="num" id="6637878">11</span><span class="op" id="6637880">]</span><span class="op" id="6637881">,</span>&nbsp;<span class="ident" id="6637883">ip</span><span class="op" id="6637885">[</span><span class="num" id="6637886">12</span><span class="op" id="6637888">]</span><span class="op" id="6637889">,</span>&nbsp;<span class="ident" id="6637891">ip</span><span class="op" id="6637893">[</span><span class="num" id="6637894">13</span><span class="op" id="6637896">]</span><span class="op" id="6637897">,</span>&nbsp;<span class="ident" id="6637899">ip</span><span class="op" id="6637901">[</span><span class="num" id="6637902">14</span><span class="op" id="6637904">]</span><span class="op" id="6637905">,</span>&nbsp;<span class="ident" id="6637907">ip</span><span class="op" id="6637909">[</span><span class="num" id="6637910">15</span><span class="op" id="6637912">]</span><span class="op" id="6637913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6637917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6637920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637924">for</span>&nbsp;<span class="ident" id="6637928">i</span>&nbsp;<span class="op" id="6637930">:=</span>&nbsp;<span class="num" id="6637933">0</span><span class="op" id="6637934">;</span>&nbsp;<span class="ident" id="6637936">i</span>&nbsp;<span class="op" id="6637938">&lt;</span>&nbsp;<span class="builtinfunc" id="6637940">len</span><span class="op" id="6637943">(</span><span class="ident" id="6637944">googleaddrsipv6</span><span class="op" id="6637959">)</span><span class="op" id="6637960">;</span>&nbsp;<span class="ident" id="6637962">i</span><span class="op" id="6637963">++</span>&nbsp;<span class="op" id="6637966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6637970">addr</span>&nbsp;<span class="op" id="6637975">:=</span>&nbsp;<span class="ident" id="6637978">googleaddrsipv6</span><span class="op" id="6637993">[</span><span class="ident" id="6637994">i</span><span class="op" id="6637995">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6637999">if</span>&nbsp;<span class="ident" id="6638002">addr</span>&nbsp;<span class="op" id="6638007">==</span>&nbsp;<span class="string" id="6638010">&#34;&#34;</span>&nbsp;<span class="op" id="6638013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6638018">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6638029">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6638033">t</span><span class="op" id="6638034">.</span><span class="ident" id="6638035">Logf</span><span class="op" id="6638039">(</span><span class="string" id="6638040">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="6638050">,</span>&nbsp;<span class="ident" id="6638052">addr</span><span class="op" id="6638056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6638060">doDial</span><span class="op" id="6638066">(</span><span class="ident" id="6638067">t</span><span class="op" id="6638068">,</span>&nbsp;<span class="string" id="6638070">&#34;tcp&#34;</span><span class="op" id="6638075">,</span>&nbsp;<span class="ident" id="6638077">addr</span><span class="op" id="6638081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6638085">doDial</span><span class="op" id="6638091">(</span><span class="ident" id="6638092">t</span><span class="op" id="6638093">,</span>&nbsp;<span class="string" id="6638095">&#34;tcp6&#34;</span><span class="op" id="6638101">,</span>&nbsp;<span class="ident" id="6638103">addr</span><span class="op" id="6638107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6638110">}</span><br>
<span class="lineno"></span><span class="op" id="6638112">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
