<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode</h2>
<ul>
<li><a href="/gostd/unicode/casetables.go.html">casetables.go</a></li>
<li><a href="/gostd/unicode/digit.go.html">digit.go</a></li>
<li><a href="/gostd/unicode/digit_test.go.html">digit_test.go</a></li>
<li><a href="/gostd/unicode/graphic.go.html">graphic.go</a></li>
<li><a href="/gostd/unicode/graphic_test.go.html">graphic_test.go</a></li>
<li><a href="/gostd/unicode/letter.go.html" class="current">letter.go</a></li>
<li><a href="/gostd/unicode/letter_test.go.html">letter_test.go</a></li>
<li><a href="/gostd/unicode/script_test.go.html">script_test.go</a></li>
<li><a href="/gostd/unicode/tables.go.html">tables.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1780502">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1780557">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1780611">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1780662">//&nbsp;Package&nbsp;unicode&nbsp;provides&nbsp;data&nbsp;and&nbsp;functions&nbsp;to&nbsp;test&nbsp;some&nbsp;properties&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1780736">//&nbsp;Unicode&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="1780760">package</span>&nbsp;<span class="ident" id="1780768">unicode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1780777">//&nbsp;Tables&nbsp;are&nbsp;regenerated&nbsp;each&nbsp;time&nbsp;we&nbsp;update&nbsp;the&nbsp;Unicode&nbsp;version.</span><br>
<span class="lineno">10</span><span class="comment" id="1780844">//go:generate&nbsp;go&nbsp;run&nbsp;maketables.go&nbsp;-tables=all&nbsp;-output&nbsp;tables.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1780910">const</span>&nbsp;<span class="op" id="1780916">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1780919">MaxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1780935">=</span>&nbsp;<span class="string" id="1780937">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="1780950">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1780988">ReplacementChar</span>&nbsp;<span class="op" id="1781004">=</span>&nbsp;<span class="string" id="1781006">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1781019">//&nbsp;Represents&nbsp;invalid&nbsp;code&nbsp;points.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1781055">MaxASCII</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1781071">=</span>&nbsp;<span class="string" id="1781073">&#39;\u007F&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1781086">//&nbsp;maximum&nbsp;ASCII&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1781111">MaxLatin1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1781127">=</span>&nbsp;<span class="string" id="1781129">&#39;\u00FF&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1781142">//&nbsp;maximum&nbsp;Latin-1&nbsp;value.</span><br>
<span class="lineno"></span><span class="op" id="1781168">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1781171">//&nbsp;RangeTable&nbsp;defines&nbsp;a&nbsp;set&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;by&nbsp;listing&nbsp;the&nbsp;ranges&nbsp;of</span><br>
<span class="lineno">20</span><span class="comment" id="1781247">//&nbsp;code&nbsp;points&nbsp;within&nbsp;the&nbsp;set.&nbsp;The&nbsp;ranges&nbsp;are&nbsp;listed&nbsp;in&nbsp;two&nbsp;slices</span><br>
<span class="lineno"></span><span class="comment" id="1781314">//&nbsp;to&nbsp;save&nbsp;space:&nbsp;a&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges&nbsp;and&nbsp;a&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="comment" id="1781387">//&nbsp;The&nbsp;two&nbsp;slices&nbsp;must&nbsp;be&nbsp;in&nbsp;sorted&nbsp;order&nbsp;and&nbsp;non-overlapping.</span><br>
<span class="lineno"></span><span class="comment" id="1781450">//&nbsp;Also,&nbsp;R32&nbsp;should&nbsp;contain&nbsp;only&nbsp;values&nbsp;&gt;=&nbsp;0x10000&nbsp;(1&lt;&lt;16).</span><br>
<span class="lineno"></span><span class="keyword" id="1781510">type</span>&nbsp;<span class="ident" id="1781515">RangeTable</span>&nbsp;<span class="keyword" id="1781526">struct</span>&nbsp;<span class="op" id="1781533">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1781536">R16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1781548">[</span><span class="op" id="1781549">]</span><span class="ident" id="1781550">Range16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1781559">R32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1781571">[</span><span class="op" id="1781572">]</span><span class="ident" id="1781573">Range32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1781582">LatinOffset</span>&nbsp;<span class="builtintype" id="1781594">int</span>&nbsp;<span class="comment" id="1781598">//&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;R16&nbsp;with&nbsp;Hi&nbsp;&lt;=&nbsp;MaxLatin1</span><br>
<span class="lineno"></span><span class="op" id="1781647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="1781650">//&nbsp;Range16&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;16-bit&nbsp;Unicode&nbsp;code&nbsp;points.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno"></span><span class="comment" id="1781744">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.</span><br>
<span class="lineno"></span><span class="keyword" id="1781787">type</span>&nbsp;<span class="ident" id="1781792">Range16</span>&nbsp;<span class="keyword" id="1781800">struct</span>&nbsp;<span class="op" id="1781807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1781810">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1781817">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1781825">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1781832">uint16</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1781840">Stride</span>&nbsp;<span class="builtintype" id="1781847">uint16</span><br>
<span class="lineno"></span><span class="op" id="1781854">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1781857">//&nbsp;Range32&nbsp;represents&nbsp;of&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;and&nbsp;is&nbsp;used&nbsp;when&nbsp;one&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1781937">//&nbsp;more&nbsp;of&nbsp;the&nbsp;values&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;16&nbsp;bits.&nbsp;&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi</span><br>
<span class="lineno">40</span><span class="comment" id="1782014">//&nbsp;inclusive&nbsp;and&nbsp;has&nbsp;the&nbsp;specified&nbsp;stride.&nbsp;Lo&nbsp;and&nbsp;Hi&nbsp;must&nbsp;always&nbsp;be&nbsp;&gt;=&nbsp;1&lt;&lt;16.</span><br>
<span class="lineno"></span><span class="keyword" id="1782092">type</span>&nbsp;<span class="ident" id="1782097">Range32</span>&nbsp;<span class="keyword" id="1782105">struct</span>&nbsp;<span class="op" id="1782112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1782115">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1782122">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1782130">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1782137">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1782145">Stride</span>&nbsp;<span class="builtintype" id="1782152">uint32</span><br>
<span class="lineno">45</span><span class="op" id="1782159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1782162">//&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;range&nbsp;of&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;for&nbsp;simple&nbsp;(one</span><br>
<span class="lineno"></span><span class="comment" id="1782233">//&nbsp;code&nbsp;point&nbsp;to&nbsp;one&nbsp;code&nbsp;point)&nbsp;case&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="1782283">//&nbsp;The&nbsp;range&nbsp;runs&nbsp;from&nbsp;Lo&nbsp;to&nbsp;Hi&nbsp;inclusive,&nbsp;with&nbsp;a&nbsp;fixed&nbsp;stride&nbsp;of&nbsp;1.&nbsp;&nbsp;Deltas</span><br>
<span class="lineno">50</span><span class="comment" id="1782360">//&nbsp;are&nbsp;the&nbsp;number&nbsp;to&nbsp;add&nbsp;to&nbsp;the&nbsp;code&nbsp;point&nbsp;to&nbsp;reach&nbsp;the&nbsp;code&nbsp;point&nbsp;for&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1782433">//&nbsp;different&nbsp;case&nbsp;for&nbsp;that&nbsp;character.&nbsp;&nbsp;They&nbsp;may&nbsp;be&nbsp;negative.&nbsp;&nbsp;If&nbsp;zero,&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="1782507">//&nbsp;means&nbsp;the&nbsp;character&nbsp;is&nbsp;in&nbsp;the&nbsp;corresponding&nbsp;case.&nbsp;There&nbsp;is&nbsp;a&nbsp;special</span><br>
<span class="lineno"></span><span class="comment" id="1782579">//&nbsp;case&nbsp;representing&nbsp;sequences&nbsp;of&nbsp;alternating&nbsp;corresponding&nbsp;Upper&nbsp;and&nbsp;Lower</span><br>
<span class="lineno"></span><span class="comment" id="1782655">//&nbsp;pairs.&nbsp;&nbsp;It&nbsp;appears&nbsp;with&nbsp;a&nbsp;fixed&nbsp;Delta&nbsp;of</span><br>
<span class="lineno">55</span><span class="comment" id="1782699">//&nbsp;&nbsp;&nbsp;&nbsp;{UpperLower,&nbsp;UpperLower,&nbsp;UpperLower}</span><br>
<span class="lineno"></span><span class="comment" id="1782739">//&nbsp;The&nbsp;constant&nbsp;UpperLower&nbsp;has&nbsp;an&nbsp;otherwise&nbsp;impossible&nbsp;delta&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="1782807">type</span>&nbsp;<span class="ident" id="1782812">CaseRange</span>&nbsp;<span class="keyword" id="1782822">struct</span>&nbsp;<span class="op" id="1782829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1782832">Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1782838">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1782846">Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1782852">uint32</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1782860">Delta</span>&nbsp;<span class="ident" id="1782866">d</span><br>
<span class="lineno"></span><span class="op" id="1782868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1782871">//&nbsp;SpecialCase&nbsp;represents&nbsp;language-specific&nbsp;case&nbsp;mappings&nbsp;such&nbsp;as&nbsp;Turkish.</span><br>
<span class="lineno"></span><span class="comment" id="1782946">//&nbsp;Methods&nbsp;of&nbsp;SpecialCase&nbsp;customize&nbsp;(by&nbsp;overriding)&nbsp;the&nbsp;standard&nbsp;mappings.</span><br>
<span class="lineno">65</span><span class="keyword" id="1783021">type</span>&nbsp;<span class="ident" id="1783026">SpecialCase</span>&nbsp;<span class="op" id="1783038">[</span><span class="op" id="1783039">]</span><span class="ident" id="1783040">CaseRange</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1783051">//&nbsp;BUG(r):&nbsp;There&nbsp;is&nbsp;no&nbsp;mechanism&nbsp;for&nbsp;full&nbsp;case&nbsp;folding,&nbsp;that&nbsp;is,&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="1783120">//&nbsp;characters&nbsp;that&nbsp;involve&nbsp;multiple&nbsp;runes&nbsp;in&nbsp;the&nbsp;input&nbsp;or&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="1783187">//&nbsp;Indices&nbsp;into&nbsp;the&nbsp;Delta&nbsp;arrays&nbsp;inside&nbsp;CaseRanges&nbsp;for&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1783256">const</span>&nbsp;<span class="op" id="1783262">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1783265">UpperCase</span>&nbsp;<span class="op" id="1783275">=</span>&nbsp;<span class="ident" id="1783277">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1783283">LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1783294">TitleCase</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1783305">MaxCase</span><br>
<span class="lineno"></span><span class="op" id="1783313">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1783316">type</span>&nbsp;<span class="ident" id="1783321">d</span>&nbsp;<span class="op" id="1783323">[</span><span class="ident" id="1783324">MaxCase</span><span class="op" id="1783331">]</span><span class="builtintype" id="1783332">rune</span>&nbsp;<span class="comment" id="1783337">//&nbsp;to&nbsp;make&nbsp;the&nbsp;CaseRanges&nbsp;text&nbsp;shorter</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="1783377">//&nbsp;If&nbsp;the&nbsp;Delta&nbsp;field&nbsp;of&nbsp;a&nbsp;CaseRange&nbsp;is&nbsp;UpperLower,&nbsp;it&nbsp;means</span><br>
<span class="lineno"></span><span class="comment" id="1783438">//&nbsp;this&nbsp;CaseRange&nbsp;represents&nbsp;a&nbsp;sequence&nbsp;of&nbsp;the&nbsp;form&nbsp;(say)</span><br>
<span class="lineno"></span><span class="comment" id="1783496">//&nbsp;Upper&nbsp;Lower&nbsp;Upper&nbsp;Lower.</span><br>
<span class="lineno"></span><span class="keyword" id="1783524">const</span>&nbsp;<span class="op" id="1783530">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1783533">UpperLower</span>&nbsp;<span class="op" id="1783544">=</span>&nbsp;<span class="ident" id="1783546">MaxRune</span>&nbsp;<span class="op" id="1783554">+</span>&nbsp;<span class="num" id="1783556">1</span>&nbsp;<span class="comment" id="1783558">//&nbsp;(Cannot&nbsp;be&nbsp;a&nbsp;valid&nbsp;delta.)</span><br>
<span class="lineno">85</span><span class="op" id="1783588">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1783591">//&nbsp;linearMax&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;table&nbsp;for&nbsp;linear&nbsp;search&nbsp;for&nbsp;non-Latin1&nbsp;rune.</span><br>
<span class="lineno"></span><span class="comment" id="1783669">//&nbsp;Derived&nbsp;by&nbsp;running&nbsp;&#39;go&nbsp;test&nbsp;-calibrate&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="1783713">const</span>&nbsp;<span class="ident" id="1783719">linearMax</span>&nbsp;<span class="op" id="1783729">=</span>&nbsp;<span class="num" id="1783731">18</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="1783735">//&nbsp;is16&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;16-bit&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1783802">func</span>&nbsp;<span class="ident" id="1783807">is16</span><span class="op" id="1783811">(</span><span class="ident" id="1783812">ranges</span>&nbsp;<span class="op" id="1783819">[</span><span class="op" id="1783820">]</span><span class="ident" id="1783821">Range16</span><span class="op" id="1783828">,</span>&nbsp;<span class="ident" id="1783830">r</span>&nbsp;<span class="builtintype" id="1783832">uint16</span><span class="op" id="1783838">)</span>&nbsp;<span class="builtintype" id="1783840">bool</span>&nbsp;<span class="op" id="1783845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1783848">if</span>&nbsp;<span class="builtinfunc" id="1783851">len</span><span class="op" id="1783854">(</span><span class="ident" id="1783855">ranges</span><span class="op" id="1783861">)</span>&nbsp;<span class="op" id="1783863">&lt;=</span>&nbsp;<span class="ident" id="1783866">linearMax</span>&nbsp;<span class="op" id="1783876">||</span>&nbsp;<span class="ident" id="1783879">r</span>&nbsp;<span class="op" id="1783881">&lt;=</span>&nbsp;<span class="ident" id="1783884">MaxLatin1</span>&nbsp;<span class="op" id="1783894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1783898">for</span>&nbsp;<span class="ident" id="1783902">i</span>&nbsp;<span class="op" id="1783904">:=</span>&nbsp;<span class="keyword" id="1783907">range</span>&nbsp;<span class="ident" id="1783913">ranges</span>&nbsp;<span class="op" id="1783920">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1783925">range_</span>&nbsp;<span class="op" id="1783932">:=</span>&nbsp;<span class="op" id="1783935">&amp;</span><span class="ident" id="1783936">ranges</span><span class="op" id="1783942">[</span><span class="ident" id="1783943">i</span><span class="op" id="1783944">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1783949">if</span>&nbsp;<span class="ident" id="1783952">r</span>&nbsp;<span class="op" id="1783954">&lt;</span>&nbsp;<span class="ident" id="1783956">range_</span><span class="op" id="1783962">.</span><span class="ident" id="1783963">Lo</span>&nbsp;<span class="op" id="1783966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1783972">return</span>&nbsp;<span class="builtintype" id="1783979">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1783988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1783993">if</span>&nbsp;<span class="ident" id="1783996">r</span>&nbsp;<span class="op" id="1783998">&lt;=</span>&nbsp;<span class="ident" id="1784001">range_</span><span class="op" id="1784007">.</span><span class="ident" id="1784008">Hi</span>&nbsp;<span class="op" id="1784011">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784017">return</span>&nbsp;<span class="op" id="1784024">(</span><span class="ident" id="1784025">r</span><span class="op" id="1784026">-</span><span class="ident" id="1784027">range_</span><span class="op" id="1784033">.</span><span class="ident" id="1784034">Lo</span><span class="op" id="1784036">)</span><span class="op" id="1784037">%</span><span class="ident" id="1784038">range_</span><span class="op" id="1784044">.</span><span class="ident" id="1784045">Stride</span>&nbsp;<span class="op" id="1784052">==</span>&nbsp;<span class="num" id="1784055">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784068">return</span>&nbsp;<span class="builtintype" id="1784075">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784082">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1784086">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784116">lo</span>&nbsp;<span class="op" id="1784119">:=</span>&nbsp;<span class="num" id="1784122">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784125">hi</span>&nbsp;<span class="op" id="1784128">:=</span>&nbsp;<span class="builtinfunc" id="1784131">len</span><span class="op" id="1784134">(</span><span class="ident" id="1784135">ranges</span><span class="op" id="1784141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784144">for</span>&nbsp;<span class="ident" id="1784148">lo</span>&nbsp;<span class="op" id="1784151">&lt;</span>&nbsp;<span class="ident" id="1784153">hi</span>&nbsp;<span class="op" id="1784156">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784160">m</span>&nbsp;<span class="op" id="1784162">:=</span>&nbsp;<span class="ident" id="1784165">lo</span>&nbsp;<span class="op" id="1784168">+</span>&nbsp;<span class="op" id="1784170">(</span><span class="ident" id="1784171">hi</span><span class="op" id="1784173">-</span><span class="ident" id="1784174">lo</span><span class="op" id="1784176">)</span><span class="op" id="1784177">/</span><span class="num" id="1784178">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784182">range_</span>&nbsp;<span class="op" id="1784189">:=</span>&nbsp;<span class="op" id="1784192">&amp;</span><span class="ident" id="1784193">ranges</span><span class="op" id="1784199">[</span><span class="ident" id="1784200">m</span><span class="op" id="1784201">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784205">if</span>&nbsp;<span class="ident" id="1784208">range_</span><span class="op" id="1784214">.</span><span class="ident" id="1784215">Lo</span>&nbsp;<span class="op" id="1784218">&lt;=</span>&nbsp;<span class="ident" id="1784221">r</span>&nbsp;<span class="op" id="1784223">&amp;&amp;</span>&nbsp;<span class="ident" id="1784226">r</span>&nbsp;<span class="op" id="1784228">&lt;=</span>&nbsp;<span class="ident" id="1784231">range_</span><span class="op" id="1784237">.</span><span class="ident" id="1784238">Hi</span>&nbsp;<span class="op" id="1784241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784246">return</span>&nbsp;<span class="op" id="1784253">(</span><span class="ident" id="1784254">r</span><span class="op" id="1784255">-</span><span class="ident" id="1784256">range_</span><span class="op" id="1784262">.</span><span class="ident" id="1784263">Lo</span><span class="op" id="1784265">)</span><span class="op" id="1784266">%</span><span class="ident" id="1784267">range_</span><span class="op" id="1784273">.</span><span class="ident" id="1784274">Stride</span>&nbsp;<span class="op" id="1784281">==</span>&nbsp;<span class="num" id="1784284">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784288">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784292">if</span>&nbsp;<span class="ident" id="1784295">r</span>&nbsp;<span class="op" id="1784297">&lt;</span>&nbsp;<span class="ident" id="1784299">range_</span><span class="op" id="1784305">.</span><span class="ident" id="1784306">Lo</span>&nbsp;<span class="op" id="1784309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784314">hi</span>&nbsp;<span class="op" id="1784317">=</span>&nbsp;<span class="ident" id="1784319">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784323">}</span>&nbsp;<span class="keyword" id="1784325">else</span>&nbsp;<span class="op" id="1784330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784335">lo</span>&nbsp;<span class="op" id="1784338">=</span>&nbsp;<span class="ident" id="1784340">m</span>&nbsp;<span class="op" id="1784342">+</span>&nbsp;<span class="num" id="1784344">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784348">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784354">return</span>&nbsp;<span class="builtintype" id="1784361">false</span><br>
<span class="lineno"></span><span class="op" id="1784367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1784370">//&nbsp;is32&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;in&nbsp;the&nbsp;sorted&nbsp;slice&nbsp;of&nbsp;32-bit&nbsp;ranges.</span><br>
<span class="lineno">125</span><span class="keyword" id="1784437">func</span>&nbsp;<span class="ident" id="1784442">is32</span><span class="op" id="1784446">(</span><span class="ident" id="1784447">ranges</span>&nbsp;<span class="op" id="1784454">[</span><span class="op" id="1784455">]</span><span class="ident" id="1784456">Range32</span><span class="op" id="1784463">,</span>&nbsp;<span class="ident" id="1784465">r</span>&nbsp;<span class="builtintype" id="1784467">uint32</span><span class="op" id="1784473">)</span>&nbsp;<span class="builtintype" id="1784475">bool</span>&nbsp;<span class="op" id="1784480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784483">if</span>&nbsp;<span class="builtinfunc" id="1784486">len</span><span class="op" id="1784489">(</span><span class="ident" id="1784490">ranges</span><span class="op" id="1784496">)</span>&nbsp;<span class="op" id="1784498">&lt;=</span>&nbsp;<span class="ident" id="1784501">linearMax</span>&nbsp;<span class="op" id="1784511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784515">for</span>&nbsp;<span class="ident" id="1784519">i</span>&nbsp;<span class="op" id="1784521">:=</span>&nbsp;<span class="keyword" id="1784524">range</span>&nbsp;<span class="ident" id="1784530">ranges</span>&nbsp;<span class="op" id="1784537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784542">range_</span>&nbsp;<span class="op" id="1784549">:=</span>&nbsp;<span class="op" id="1784552">&amp;</span><span class="ident" id="1784553">ranges</span><span class="op" id="1784559">[</span><span class="ident" id="1784560">i</span><span class="op" id="1784561">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784566">if</span>&nbsp;<span class="ident" id="1784569">r</span>&nbsp;<span class="op" id="1784571">&lt;</span>&nbsp;<span class="ident" id="1784573">range_</span><span class="op" id="1784579">.</span><span class="ident" id="1784580">Lo</span>&nbsp;<span class="op" id="1784583">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784589">return</span>&nbsp;<span class="builtintype" id="1784596">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784610">if</span>&nbsp;<span class="ident" id="1784613">r</span>&nbsp;<span class="op" id="1784615">&lt;=</span>&nbsp;<span class="ident" id="1784618">range_</span><span class="op" id="1784624">.</span><span class="ident" id="1784625">Hi</span>&nbsp;<span class="op" id="1784628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784634">return</span>&nbsp;<span class="op" id="1784641">(</span><span class="ident" id="1784642">r</span><span class="op" id="1784643">-</span><span class="ident" id="1784644">range_</span><span class="op" id="1784650">.</span><span class="ident" id="1784651">Lo</span><span class="op" id="1784653">)</span><span class="op" id="1784654">%</span><span class="ident" id="1784655">range_</span><span class="op" id="1784661">.</span><span class="ident" id="1784662">Stride</span>&nbsp;<span class="op" id="1784669">==</span>&nbsp;<span class="num" id="1784672">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784677">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784685">return</span>&nbsp;<span class="builtintype" id="1784692">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1784703">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784733">lo</span>&nbsp;<span class="op" id="1784736">:=</span>&nbsp;<span class="num" id="1784739">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784742">hi</span>&nbsp;<span class="op" id="1784745">:=</span>&nbsp;<span class="builtinfunc" id="1784748">len</span><span class="op" id="1784751">(</span><span class="ident" id="1784752">ranges</span><span class="op" id="1784758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784761">for</span>&nbsp;<span class="ident" id="1784765">lo</span>&nbsp;<span class="op" id="1784768">&lt;</span>&nbsp;<span class="ident" id="1784770">hi</span>&nbsp;<span class="op" id="1784773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784777">m</span>&nbsp;<span class="op" id="1784779">:=</span>&nbsp;<span class="ident" id="1784782">lo</span>&nbsp;<span class="op" id="1784785">+</span>&nbsp;<span class="op" id="1784787">(</span><span class="ident" id="1784788">hi</span><span class="op" id="1784790">-</span><span class="ident" id="1784791">lo</span><span class="op" id="1784793">)</span><span class="op" id="1784794">/</span><span class="num" id="1784795">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784799">range_</span>&nbsp;<span class="op" id="1784806">:=</span>&nbsp;<span class="ident" id="1784809">ranges</span><span class="op" id="1784815">[</span><span class="ident" id="1784816">m</span><span class="op" id="1784817">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784821">if</span>&nbsp;<span class="ident" id="1784824">range_</span><span class="op" id="1784830">.</span><span class="ident" id="1784831">Lo</span>&nbsp;<span class="op" id="1784834">&lt;=</span>&nbsp;<span class="ident" id="1784837">r</span>&nbsp;<span class="op" id="1784839">&amp;&amp;</span>&nbsp;<span class="ident" id="1784842">r</span>&nbsp;<span class="op" id="1784844">&lt;=</span>&nbsp;<span class="ident" id="1784847">range_</span><span class="op" id="1784853">.</span><span class="ident" id="1784854">Hi</span>&nbsp;<span class="op" id="1784857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784862">return</span>&nbsp;<span class="op" id="1784869">(</span><span class="ident" id="1784870">r</span><span class="op" id="1784871">-</span><span class="ident" id="1784872">range_</span><span class="op" id="1784878">.</span><span class="ident" id="1784879">Lo</span><span class="op" id="1784881">)</span><span class="op" id="1784882">%</span><span class="ident" id="1784883">range_</span><span class="op" id="1784889">.</span><span class="ident" id="1784890">Stride</span>&nbsp;<span class="op" id="1784897">==</span>&nbsp;<span class="num" id="1784900">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784908">if</span>&nbsp;<span class="ident" id="1784911">r</span>&nbsp;<span class="op" id="1784913">&lt;</span>&nbsp;<span class="ident" id="1784915">range_</span><span class="op" id="1784921">.</span><span class="ident" id="1784922">Lo</span>&nbsp;<span class="op" id="1784925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784930">hi</span>&nbsp;<span class="op" id="1784933">=</span>&nbsp;<span class="ident" id="1784935">m</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784939">}</span>&nbsp;<span class="keyword" id="1784941">else</span>&nbsp;<span class="op" id="1784946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1784951">lo</span>&nbsp;<span class="op" id="1784954">=</span>&nbsp;<span class="ident" id="1784956">m</span>&nbsp;<span class="op" id="1784958">+</span>&nbsp;<span class="num" id="1784960">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1784967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1784970">return</span>&nbsp;<span class="builtintype" id="1784977">false</span><br>
<span class="lineno">155</span><span class="op" id="1784983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1784986">//&nbsp;Is&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;in&nbsp;the&nbsp;specified&nbsp;table&nbsp;of&nbsp;ranges.</span><br>
<span class="lineno"></span><span class="keyword" id="1785054">func</span>&nbsp;<span class="ident" id="1785059">Is</span><span class="op" id="1785061">(</span><span class="ident" id="1785062">rangeTab</span>&nbsp;<span class="op" id="1785071">*</span><span class="ident" id="1785072">RangeTable</span><span class="op" id="1785082">,</span>&nbsp;<span class="ident" id="1785084">r</span>&nbsp;<span class="builtintype" id="1785086">rune</span><span class="op" id="1785090">)</span>&nbsp;<span class="builtintype" id="1785092">bool</span>&nbsp;<span class="op" id="1785097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1785100">r16</span>&nbsp;<span class="op" id="1785104">:=</span>&nbsp;<span class="ident" id="1785107">rangeTab</span><span class="op" id="1785115">.</span><span class="ident" id="1785116">R16</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785121">if</span>&nbsp;<span class="builtinfunc" id="1785124">len</span><span class="op" id="1785127">(</span><span class="ident" id="1785128">r16</span><span class="op" id="1785131">)</span>&nbsp;<span class="op" id="1785133">&gt;</span>&nbsp;<span class="num" id="1785135">0</span>&nbsp;<span class="op" id="1785137">&amp;&amp;</span>&nbsp;<span class="ident" id="1785140">r</span>&nbsp;<span class="op" id="1785142">&lt;=</span>&nbsp;<span class="builtintype" id="1785145">rune</span><span class="op" id="1785149">(</span><span class="ident" id="1785150">r16</span><span class="op" id="1785153">[</span><span class="builtinfunc" id="1785154">len</span><span class="op" id="1785157">(</span><span class="ident" id="1785158">r16</span><span class="op" id="1785161">)</span><span class="op" id="1785162">-</span><span class="num" id="1785163">1</span><span class="op" id="1785164">]</span><span class="op" id="1785165">.</span><span class="ident" id="1785166">Hi</span><span class="op" id="1785168">)</span>&nbsp;<span class="op" id="1785170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785174">return</span>&nbsp;<span class="ident" id="1785181">is16</span><span class="op" id="1785185">(</span><span class="ident" id="1785186">r16</span><span class="op" id="1785189">,</span>&nbsp;<span class="builtintype" id="1785191">uint16</span><span class="op" id="1785197">(</span><span class="ident" id="1785198">r</span><span class="op" id="1785199">)</span><span class="op" id="1785200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1785203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1785206">r32</span>&nbsp;<span class="op" id="1785210">:=</span>&nbsp;<span class="ident" id="1785213">rangeTab</span><span class="op" id="1785221">.</span><span class="ident" id="1785222">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785227">if</span>&nbsp;<span class="builtinfunc" id="1785230">len</span><span class="op" id="1785233">(</span><span class="ident" id="1785234">r32</span><span class="op" id="1785237">)</span>&nbsp;<span class="op" id="1785239">&gt;</span>&nbsp;<span class="num" id="1785241">0</span>&nbsp;<span class="op" id="1785243">&amp;&amp;</span>&nbsp;<span class="ident" id="1785246">r</span>&nbsp;<span class="op" id="1785248">&gt;=</span>&nbsp;<span class="builtintype" id="1785251">rune</span><span class="op" id="1785255">(</span><span class="ident" id="1785256">r32</span><span class="op" id="1785259">[</span><span class="num" id="1785260">0</span><span class="op" id="1785261">]</span><span class="op" id="1785262">.</span><span class="ident" id="1785263">Lo</span><span class="op" id="1785265">)</span>&nbsp;<span class="op" id="1785267">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785271">return</span>&nbsp;<span class="ident" id="1785278">is32</span><span class="op" id="1785282">(</span><span class="ident" id="1785283">r32</span><span class="op" id="1785286">,</span>&nbsp;<span class="builtintype" id="1785288">uint32</span><span class="op" id="1785294">(</span><span class="ident" id="1785295">r</span><span class="op" id="1785296">)</span><span class="op" id="1785297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1785300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785303">return</span>&nbsp;<span class="builtintype" id="1785310">false</span><br>
<span class="lineno"></span><span class="op" id="1785316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="1785319">func</span>&nbsp;<span class="ident" id="1785324">isExcludingLatin</span><span class="op" id="1785340">(</span><span class="ident" id="1785341">rangeTab</span>&nbsp;<span class="op" id="1785350">*</span><span class="ident" id="1785351">RangeTable</span><span class="op" id="1785361">,</span>&nbsp;<span class="ident" id="1785363">r</span>&nbsp;<span class="builtintype" id="1785365">rune</span><span class="op" id="1785369">)</span>&nbsp;<span class="builtintype" id="1785371">bool</span>&nbsp;<span class="op" id="1785376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1785379">r16</span>&nbsp;<span class="op" id="1785383">:=</span>&nbsp;<span class="ident" id="1785386">rangeTab</span><span class="op" id="1785394">.</span><span class="ident" id="1785395">R16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785400">if</span>&nbsp;<span class="ident" id="1785403">off</span>&nbsp;<span class="op" id="1785407">:=</span>&nbsp;<span class="ident" id="1785410">rangeTab</span><span class="op" id="1785418">.</span><span class="ident" id="1785419">LatinOffset</span><span class="op" id="1785430">;</span>&nbsp;<span class="builtinfunc" id="1785432">len</span><span class="op" id="1785435">(</span><span class="ident" id="1785436">r16</span><span class="op" id="1785439">)</span>&nbsp;<span class="op" id="1785441">&gt;</span>&nbsp;<span class="ident" id="1785443">off</span>&nbsp;<span class="op" id="1785447">&amp;&amp;</span>&nbsp;<span class="ident" id="1785450">r</span>&nbsp;<span class="op" id="1785452">&lt;=</span>&nbsp;<span class="builtintype" id="1785455">rune</span><span class="op" id="1785459">(</span><span class="ident" id="1785460">r16</span><span class="op" id="1785463">[</span><span class="builtinfunc" id="1785464">len</span><span class="op" id="1785467">(</span><span class="ident" id="1785468">r16</span><span class="op" id="1785471">)</span><span class="op" id="1785472">-</span><span class="num" id="1785473">1</span><span class="op" id="1785474">]</span><span class="op" id="1785475">.</span><span class="ident" id="1785476">Hi</span><span class="op" id="1785478">)</span>&nbsp;<span class="op" id="1785480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785484">return</span>&nbsp;<span class="ident" id="1785491">is16</span><span class="op" id="1785495">(</span><span class="ident" id="1785496">r16</span><span class="op" id="1785499">[</span><span class="ident" id="1785500">off</span><span class="op" id="1785503">:</span><span class="op" id="1785504">]</span><span class="op" id="1785505">,</span>&nbsp;<span class="builtintype" id="1785507">uint16</span><span class="op" id="1785513">(</span><span class="ident" id="1785514">r</span><span class="op" id="1785515">)</span><span class="op" id="1785516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1785519">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1785522">r32</span>&nbsp;<span class="op" id="1785526">:=</span>&nbsp;<span class="ident" id="1785529">rangeTab</span><span class="op" id="1785537">.</span><span class="ident" id="1785538">R32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785543">if</span>&nbsp;<span class="builtinfunc" id="1785546">len</span><span class="op" id="1785549">(</span><span class="ident" id="1785550">r32</span><span class="op" id="1785553">)</span>&nbsp;<span class="op" id="1785555">&gt;</span>&nbsp;<span class="num" id="1785557">0</span>&nbsp;<span class="op" id="1785559">&amp;&amp;</span>&nbsp;<span class="ident" id="1785562">r</span>&nbsp;<span class="op" id="1785564">&gt;=</span>&nbsp;<span class="builtintype" id="1785567">rune</span><span class="op" id="1785571">(</span><span class="ident" id="1785572">r32</span><span class="op" id="1785575">[</span><span class="num" id="1785576">0</span><span class="op" id="1785577">]</span><span class="op" id="1785578">.</span><span class="ident" id="1785579">Lo</span><span class="op" id="1785581">)</span>&nbsp;<span class="op" id="1785583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785587">return</span>&nbsp;<span class="ident" id="1785594">is32</span><span class="op" id="1785598">(</span><span class="ident" id="1785599">r32</span><span class="op" id="1785602">,</span>&nbsp;<span class="builtintype" id="1785604">uint32</span><span class="op" id="1785610">(</span><span class="ident" id="1785611">r</span><span class="op" id="1785612">)</span><span class="op" id="1785613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1785616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785619">return</span>&nbsp;<span class="builtintype" id="1785626">false</span><br>
<span class="lineno">180</span><span class="op" id="1785632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1785635">//&nbsp;IsUpper&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;an&nbsp;upper&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1785696">func</span>&nbsp;<span class="ident" id="1785701">IsUpper</span><span class="op" id="1785708">(</span><span class="ident" id="1785709">r</span>&nbsp;<span class="builtintype" id="1785711">rune</span><span class="op" id="1785715">)</span>&nbsp;<span class="builtintype" id="1785717">bool</span>&nbsp;<span class="op" id="1785722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1785725">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785755">if</span>&nbsp;<span class="builtintype" id="1785758">uint32</span><span class="op" id="1785764">(</span><span class="ident" id="1785765">r</span><span class="op" id="1785766">)</span>&nbsp;<span class="op" id="1785768">&lt;=</span>&nbsp;<span class="ident" id="1785771">MaxLatin1</span>&nbsp;<span class="op" id="1785781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785785">return</span>&nbsp;<span class="ident" id="1785792">properties</span><span class="op" id="1785802">[</span><span class="builtintype" id="1785803">uint8</span><span class="op" id="1785808">(</span><span class="ident" id="1785809">r</span><span class="op" id="1785810">)</span><span class="op" id="1785811">]</span><span class="op" id="1785812">&amp;</span><span class="ident" id="1785813">pLmask</span>&nbsp;<span class="op" id="1785820">==</span>&nbsp;<span class="ident" id="1785823">pLu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1785828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785831">return</span>&nbsp;<span class="ident" id="1785838">isExcludingLatin</span><span class="op" id="1785854">(</span><span class="ident" id="1785855">Upper</span><span class="op" id="1785860">,</span>&nbsp;<span class="ident" id="1785862">r</span><span class="op" id="1785863">)</span><br>
<span class="lineno"></span><span class="op" id="1785865">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="1785868">//&nbsp;IsLower&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;lower&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1785928">func</span>&nbsp;<span class="ident" id="1785933">IsLower</span><span class="op" id="1785940">(</span><span class="ident" id="1785941">r</span>&nbsp;<span class="builtintype" id="1785943">rune</span><span class="op" id="1785947">)</span>&nbsp;<span class="builtintype" id="1785949">bool</span>&nbsp;<span class="op" id="1785954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1785957">//&nbsp;See&nbsp;comment&nbsp;in&nbsp;IsGraphic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1785987">if</span>&nbsp;<span class="builtintype" id="1785990">uint32</span><span class="op" id="1785996">(</span><span class="ident" id="1785997">r</span><span class="op" id="1785998">)</span>&nbsp;<span class="op" id="1786000">&lt;=</span>&nbsp;<span class="ident" id="1786003">MaxLatin1</span>&nbsp;<span class="op" id="1786013">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1786017">return</span>&nbsp;<span class="ident" id="1786024">properties</span><span class="op" id="1786034">[</span><span class="builtintype" id="1786035">uint8</span><span class="op" id="1786040">(</span><span class="ident" id="1786041">r</span><span class="op" id="1786042">)</span><span class="op" id="1786043">]</span><span class="op" id="1786044">&amp;</span><span class="ident" id="1786045">pLmask</span>&nbsp;<span class="op" id="1786052">==</span>&nbsp;<span class="ident" id="1786055">pLl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1786060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1786063">return</span>&nbsp;<span class="ident" id="1786070">isExcludingLatin</span><span class="op" id="1786086">(</span><span class="ident" id="1786087">Lower</span><span class="op" id="1786092">,</span>&nbsp;<span class="ident" id="1786094">r</span><span class="op" id="1786095">)</span><br>
<span class="lineno"></span><span class="op" id="1786097">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="1786100">//&nbsp;IsTitle&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;a&nbsp;title&nbsp;case&nbsp;letter.</span><br>
<span class="lineno"></span><span class="keyword" id="1786160">func</span>&nbsp;<span class="ident" id="1786165">IsTitle</span><span class="op" id="1786172">(</span><span class="ident" id="1786173">r</span>&nbsp;<span class="builtintype" id="1786175">rune</span><span class="op" id="1786179">)</span>&nbsp;<span class="builtintype" id="1786181">bool</span>&nbsp;<span class="op" id="1786186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1786189">if</span>&nbsp;<span class="ident" id="1786192">r</span>&nbsp;<span class="op" id="1786194">&lt;=</span>&nbsp;<span class="ident" id="1786197">MaxLatin1</span>&nbsp;<span class="op" id="1786207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1786211">return</span>&nbsp;<span class="builtintype" id="1786218">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1786225">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1786228">return</span>&nbsp;<span class="ident" id="1786235">isExcludingLatin</span><span class="op" id="1786251">(</span><span class="ident" id="1786252">Title</span><span class="op" id="1786257">,</span>&nbsp;<span class="ident" id="1786259">r</span><span class="op" id="1786260">)</span><br>
<span class="lineno"></span><span class="op" id="1786262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1786265">//&nbsp;to&nbsp;maps&nbsp;the&nbsp;rune&nbsp;using&nbsp;the&nbsp;specified&nbsp;case&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1786319">func</span>&nbsp;<span class="ident" id="1786324">to</span><span class="op" id="1786326">(</span><span class="ident" id="1786327">_case</span>&nbsp;<span class="builtintype" id="1786333">int</span><span class="op" id="1786336">,</span>&nbsp;<span class="ident" id="1786338">r</span>&nbsp;<span class="builtintype" id="1786340">rune</span><span class="op" id="1786344">,</span>&nbsp;<span class="ident" id="1786346">caseRange</span>&nbsp;<span class="op" id="1786356">[</span><span class="op" id="1786357">]</span><span class="ident" id="1786358">CaseRange</span><span class="op" id="1786367">)</span>&nbsp;<span class="builtintype" id="1786369">rune</span>&nbsp;<span class="op" id="1786374">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1786377">if</span>&nbsp;<span class="ident" id="1786380">_case</span>&nbsp;<span class="op" id="1786386">&lt;</span>&nbsp;<span class="num" id="1786388">0</span>&nbsp;<span class="op" id="1786390">||</span>&nbsp;<span class="ident" id="1786393">MaxCase</span>&nbsp;<span class="op" id="1786401">&lt;=</span>&nbsp;<span class="ident" id="1786404">_case</span>&nbsp;<span class="op" id="1786410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1786414">return</span>&nbsp;<span class="ident" id="1786421">ReplacementChar</span>&nbsp;<span class="comment" id="1786437">//&nbsp;as&nbsp;reasonable&nbsp;an&nbsp;error&nbsp;as&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1786471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1786474">//&nbsp;binary&nbsp;search&nbsp;over&nbsp;ranges</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1786504">lo</span>&nbsp;<span class="op" id="1786507">:=</span>&nbsp;<span class="num" id="1786510">0</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1786513">hi</span>&nbsp;<span class="op" id="1786516">:=</span>&nbsp;<span class="builtinfunc" id="1786519">len</span><span class="op" id="1786522">(</span><span class="ident" id="1786523">caseRange</span><span class="op" id="1786532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1786535">for</span>&nbsp;<span class="ident" id="1786539">lo</span>&nbsp;<span class="op" id="1786542">&lt;</span>&nbsp;<span class="ident" id="1786544">hi</span>&nbsp;<span class="op" id="1786547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1786551">m</span>&nbsp;<span class="op" id="1786553">:=</span>&nbsp;<span class="ident" id="1786556">lo</span>&nbsp;<span class="op" id="1786559">+</span>&nbsp;<span class="op" id="1786561">(</span><span class="ident" id="1786562">hi</span><span class="op" id="1786564">-</span><span class="ident" id="1786565">lo</span><span class="op" id="1786567">)</span><span class="op" id="1786568">/</span><span class="num" id="1786569">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1786573">cr</span>&nbsp;<span class="op" id="1786576">:=</span>&nbsp;<span class="ident" id="1786579">caseRange</span><span class="op" id="1786588">[</span><span class="ident" id="1786589">m</span><span class="op" id="1786590">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1786594">if</span>&nbsp;<span class="builtintype" id="1786597">rune</span><span class="op" id="1786601">(</span><span class="ident" id="1786602">cr</span><span class="op" id="1786604">.</span><span class="ident" id="1786605">Lo</span><span class="op" id="1786607">)</span>&nbsp;<span class="op" id="1786609">&lt;=</span>&nbsp;<span class="ident" id="1786612">r</span>&nbsp;<span class="op" id="1786614">&amp;&amp;</span>&nbsp;<span class="ident" id="1786617">r</span>&nbsp;<span class="op" id="1786619">&lt;=</span>&nbsp;<span class="builtintype" id="1786622">rune</span><span class="op" id="1786626">(</span><span class="ident" id="1786627">cr</span><span class="op" id="1786629">.</span><span class="ident" id="1786630">Hi</span><span class="op" id="1786632">)</span>&nbsp;<span class="op" id="1786634">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1786639">delta</span>&nbsp;<span class="op" id="1786645">:=</span>&nbsp;<span class="builtintype" id="1786648">rune</span><span class="op" id="1786652">(</span><span class="ident" id="1786653">cr</span><span class="op" id="1786655">.</span><span class="ident" id="1786656">Delta</span><span class="op" id="1786661">[</span><span class="ident" id="1786662">_case</span><span class="op" id="1786667">]</span><span class="op" id="1786668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1786673">if</span>&nbsp;<span class="ident" id="1786676">delta</span>&nbsp;<span class="op" id="1786682">&gt;</span>&nbsp;<span class="ident" id="1786684">MaxRune</span>&nbsp;<span class="op" id="1786692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1786698">//&nbsp;In&nbsp;an&nbsp;Upper-Lower&nbsp;sequence,&nbsp;which&nbsp;always&nbsp;starts&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1786758">//&nbsp;an&nbsp;UpperCase&nbsp;letter,&nbsp;the&nbsp;real&nbsp;deltas&nbsp;always&nbsp;look&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1786820">//&nbsp;&nbsp;&nbsp;&nbsp;{0,&nbsp;1,&nbsp;0}&nbsp;&nbsp;&nbsp;&nbsp;UpperCase&nbsp;(Lower&nbsp;is&nbsp;next)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1786866">//&nbsp;&nbsp;&nbsp;&nbsp;{-1,&nbsp;0,&nbsp;-1}&nbsp;&nbsp;LowerCase&nbsp;(Upper,&nbsp;Title&nbsp;are&nbsp;previous)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1786924">//&nbsp;The&nbsp;characters&nbsp;at&nbsp;even&nbsp;offsets&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1786988">//&nbsp;sequence&nbsp;are&nbsp;upper&nbsp;case;&nbsp;the&nbsp;ones&nbsp;at&nbsp;odd&nbsp;offsets&nbsp;are&nbsp;lower.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1787055">//&nbsp;The&nbsp;correct&nbsp;mapping&nbsp;can&nbsp;be&nbsp;done&nbsp;by&nbsp;clearing&nbsp;or&nbsp;setting&nbsp;the&nbsp;low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1787125">//&nbsp;bit&nbsp;in&nbsp;the&nbsp;sequence&nbsp;offset.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1787160">//&nbsp;The&nbsp;constants&nbsp;UpperCase&nbsp;and&nbsp;TitleCase&nbsp;are&nbsp;even&nbsp;while&nbsp;LowerCase</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1787230">//&nbsp;is&nbsp;odd&nbsp;so&nbsp;we&nbsp;take&nbsp;the&nbsp;low&nbsp;bit&nbsp;from&nbsp;_case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787279">return</span>&nbsp;<span class="builtintype" id="1787286">rune</span><span class="op" id="1787290">(</span><span class="ident" id="1787291">cr</span><span class="op" id="1787293">.</span><span class="ident" id="1787294">Lo</span><span class="op" id="1787296">)</span>&nbsp;<span class="op" id="1787298">+</span>&nbsp;<span class="op" id="1787300">(</span><span class="op" id="1787301">(</span><span class="ident" id="1787302">r</span><span class="op" id="1787303">-</span><span class="builtintype" id="1787304">rune</span><span class="op" id="1787308">(</span><span class="ident" id="1787309">cr</span><span class="op" id="1787311">.</span><span class="ident" id="1787312">Lo</span><span class="op" id="1787314">)</span><span class="op" id="1787315">)</span><span class="op" id="1787316">&amp;^</span><span class="num" id="1787318">1</span>&nbsp;<span class="op" id="1787320">|</span>&nbsp;<span class="builtintype" id="1787322">rune</span><span class="op" id="1787326">(</span><span class="ident" id="1787327">_case</span><span class="op" id="1787332">&amp;</span><span class="num" id="1787333">1</span><span class="op" id="1787334">)</span><span class="op" id="1787335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1787340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787345">return</span>&nbsp;<span class="ident" id="1787352">r</span>&nbsp;<span class="op" id="1787354">+</span>&nbsp;<span class="ident" id="1787356">delta</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1787364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787368">if</span>&nbsp;<span class="ident" id="1787371">r</span>&nbsp;<span class="op" id="1787373">&lt;</span>&nbsp;<span class="builtintype" id="1787375">rune</span><span class="op" id="1787379">(</span><span class="ident" id="1787380">cr</span><span class="op" id="1787382">.</span><span class="ident" id="1787383">Lo</span><span class="op" id="1787385">)</span>&nbsp;<span class="op" id="1787387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787392">hi</span>&nbsp;<span class="op" id="1787395">=</span>&nbsp;<span class="ident" id="1787397">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1787401">}</span>&nbsp;<span class="keyword" id="1787403">else</span>&nbsp;<span class="op" id="1787408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787413">lo</span>&nbsp;<span class="op" id="1787416">=</span>&nbsp;<span class="ident" id="1787418">m</span>&nbsp;<span class="op" id="1787420">+</span>&nbsp;<span class="num" id="1787422">1</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1787426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1787429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787432">return</span>&nbsp;<span class="ident" id="1787439">r</span><br>
<span class="lineno"></span><span class="op" id="1787441">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="1787444">//&nbsp;To&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;the&nbsp;specified&nbsp;case:&nbsp;UpperCase,&nbsp;LowerCase,&nbsp;or&nbsp;TitleCase.</span><br>
<span class="lineno"></span><span class="keyword" id="1787523">func</span>&nbsp;<span class="ident" id="1787528">To</span><span class="op" id="1787530">(</span><span class="ident" id="1787531">_case</span>&nbsp;<span class="builtintype" id="1787537">int</span><span class="op" id="1787540">,</span>&nbsp;<span class="ident" id="1787542">r</span>&nbsp;<span class="builtintype" id="1787544">rune</span><span class="op" id="1787548">)</span>&nbsp;<span class="builtintype" id="1787550">rune</span>&nbsp;<span class="op" id="1787555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787558">return</span>&nbsp;<span class="ident" id="1787565">to</span><span class="op" id="1787567">(</span><span class="ident" id="1787568">_case</span><span class="op" id="1787573">,</span>&nbsp;<span class="ident" id="1787575">r</span><span class="op" id="1787576">,</span>&nbsp;<span class="ident" id="1787578">CaseRanges</span><span class="op" id="1787588">)</span><br>
<span class="lineno"></span><span class="op" id="1787590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1787593">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1787633">func</span>&nbsp;<span class="ident" id="1787638">ToUpper</span><span class="op" id="1787645">(</span><span class="ident" id="1787646">r</span>&nbsp;<span class="builtintype" id="1787648">rune</span><span class="op" id="1787652">)</span>&nbsp;<span class="builtintype" id="1787654">rune</span>&nbsp;<span class="op" id="1787659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787662">if</span>&nbsp;<span class="ident" id="1787665">r</span>&nbsp;<span class="op" id="1787667">&lt;=</span>&nbsp;<span class="ident" id="1787670">MaxASCII</span>&nbsp;<span class="op" id="1787679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787683">if</span>&nbsp;<span class="string" id="1787686">&#39;a&#39;</span>&nbsp;<span class="op" id="1787690">&lt;=</span>&nbsp;<span class="ident" id="1787693">r</span>&nbsp;<span class="op" id="1787695">&amp;&amp;</span>&nbsp;<span class="ident" id="1787698">r</span>&nbsp;<span class="op" id="1787700">&lt;=</span>&nbsp;<span class="string" id="1787703">&#39;z&#39;</span>&nbsp;<span class="op" id="1787707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787712">r</span>&nbsp;<span class="op" id="1787714">-=</span>&nbsp;<span class="string" id="1787717">&#39;a&#39;</span>&nbsp;<span class="op" id="1787721">-</span>&nbsp;<span class="string" id="1787723">&#39;A&#39;</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1787729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787733">return</span>&nbsp;<span class="ident" id="1787740">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1787743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787746">return</span>&nbsp;<span class="ident" id="1787753">To</span><span class="op" id="1787755">(</span><span class="ident" id="1787756">UpperCase</span><span class="op" id="1787765">,</span>&nbsp;<span class="ident" id="1787767">r</span><span class="op" id="1787768">)</span><br>
<span class="lineno"></span><span class="op" id="1787770">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="1787773">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1787813">func</span>&nbsp;<span class="ident" id="1787818">ToLower</span><span class="op" id="1787825">(</span><span class="ident" id="1787826">r</span>&nbsp;<span class="builtintype" id="1787828">rune</span><span class="op" id="1787832">)</span>&nbsp;<span class="builtintype" id="1787834">rune</span>&nbsp;<span class="op" id="1787839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787842">if</span>&nbsp;<span class="ident" id="1787845">r</span>&nbsp;<span class="op" id="1787847">&lt;=</span>&nbsp;<span class="ident" id="1787850">MaxASCII</span>&nbsp;<span class="op" id="1787859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787863">if</span>&nbsp;<span class="string" id="1787866">&#39;A&#39;</span>&nbsp;<span class="op" id="1787870">&lt;=</span>&nbsp;<span class="ident" id="1787873">r</span>&nbsp;<span class="op" id="1787875">&amp;&amp;</span>&nbsp;<span class="ident" id="1787878">r</span>&nbsp;<span class="op" id="1787880">&lt;=</span>&nbsp;<span class="string" id="1787883">&#39;Z&#39;</span>&nbsp;<span class="op" id="1787887">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1787892">r</span>&nbsp;<span class="op" id="1787894">+=</span>&nbsp;<span class="string" id="1787897">&#39;a&#39;</span>&nbsp;<span class="op" id="1787901">-</span>&nbsp;<span class="string" id="1787903">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1787909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787913">return</span>&nbsp;<span class="ident" id="1787920">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1787923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1787926">return</span>&nbsp;<span class="ident" id="1787933">To</span><span class="op" id="1787935">(</span><span class="ident" id="1787936">LowerCase</span><span class="op" id="1787945">,</span>&nbsp;<span class="ident" id="1787947">r</span><span class="op" id="1787948">)</span><br>
<span class="lineno">270</span><span class="op" id="1787950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1787953">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case.</span><br>
<span class="lineno"></span><span class="keyword" id="1787993">func</span>&nbsp;<span class="ident" id="1787998">ToTitle</span><span class="op" id="1788005">(</span><span class="ident" id="1788006">r</span>&nbsp;<span class="builtintype" id="1788008">rune</span><span class="op" id="1788012">)</span>&nbsp;<span class="builtintype" id="1788014">rune</span>&nbsp;<span class="op" id="1788019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1788022">if</span>&nbsp;<span class="ident" id="1788025">r</span>&nbsp;<span class="op" id="1788027">&lt;=</span>&nbsp;<span class="ident" id="1788030">MaxASCII</span>&nbsp;<span class="op" id="1788039">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1788043">if</span>&nbsp;<span class="string" id="1788046">&#39;a&#39;</span>&nbsp;<span class="op" id="1788050">&lt;=</span>&nbsp;<span class="ident" id="1788053">r</span>&nbsp;<span class="op" id="1788055">&amp;&amp;</span>&nbsp;<span class="ident" id="1788058">r</span>&nbsp;<span class="op" id="1788060">&lt;=</span>&nbsp;<span class="string" id="1788063">&#39;z&#39;</span>&nbsp;<span class="op" id="1788067">{</span>&nbsp;<span class="comment" id="1788069">//&nbsp;title&nbsp;case&nbsp;is&nbsp;upper&nbsp;case&nbsp;for&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1788110">r</span>&nbsp;<span class="op" id="1788112">-=</span>&nbsp;<span class="string" id="1788115">&#39;a&#39;</span>&nbsp;<span class="op" id="1788119">-</span>&nbsp;<span class="string" id="1788121">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1788127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1788131">return</span>&nbsp;<span class="ident" id="1788138">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1788141">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1788144">return</span>&nbsp;<span class="ident" id="1788151">To</span><span class="op" id="1788153">(</span><span class="ident" id="1788154">TitleCase</span><span class="op" id="1788163">,</span>&nbsp;<span class="ident" id="1788165">r</span><span class="op" id="1788166">)</span><br>
<span class="lineno"></span><span class="op" id="1788168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1788171">//&nbsp;ToUpper&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;upper&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1788250">func</span>&nbsp;<span class="op" id="1788255">(</span><span class="ident" id="1788256">special</span>&nbsp;<span class="ident" id="1788264">SpecialCase</span><span class="op" id="1788275">)</span>&nbsp;<span class="ident" id="1788277">ToUpper</span><span class="op" id="1788284">(</span><span class="ident" id="1788285">r</span>&nbsp;<span class="builtintype" id="1788287">rune</span><span class="op" id="1788291">)</span>&nbsp;<span class="builtintype" id="1788293">rune</span>&nbsp;<span class="op" id="1788298">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1788301">r1</span>&nbsp;<span class="op" id="1788304">:=</span>&nbsp;<span class="ident" id="1788307">to</span><span class="op" id="1788309">(</span><span class="ident" id="1788310">UpperCase</span><span class="op" id="1788319">,</span>&nbsp;<span class="ident" id="1788321">r</span><span class="op" id="1788322">,</span>&nbsp;<span class="op" id="1788324">[</span><span class="op" id="1788325">]</span><span class="ident" id="1788326">CaseRange</span><span class="op" id="1788335">(</span><span class="ident" id="1788336">special</span><span class="op" id="1788343">)</span><span class="op" id="1788344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1788347">if</span>&nbsp;<span class="ident" id="1788350">r1</span>&nbsp;<span class="op" id="1788353">==</span>&nbsp;<span class="ident" id="1788356">r</span>&nbsp;<span class="op" id="1788358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1788362">r1</span>&nbsp;<span class="op" id="1788365">=</span>&nbsp;<span class="ident" id="1788367">ToUpper</span><span class="op" id="1788374">(</span><span class="ident" id="1788375">r</span><span class="op" id="1788376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1788379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1788382">return</span>&nbsp;<span class="ident" id="1788389">r1</span><br>
<span class="lineno">290</span><span class="op" id="1788392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1788395">//&nbsp;ToTitle&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;title&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1788474">func</span>&nbsp;<span class="op" id="1788479">(</span><span class="ident" id="1788480">special</span>&nbsp;<span class="ident" id="1788488">SpecialCase</span><span class="op" id="1788499">)</span>&nbsp;<span class="ident" id="1788501">ToTitle</span><span class="op" id="1788508">(</span><span class="ident" id="1788509">r</span>&nbsp;<span class="builtintype" id="1788511">rune</span><span class="op" id="1788515">)</span>&nbsp;<span class="builtintype" id="1788517">rune</span>&nbsp;<span class="op" id="1788522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1788525">r1</span>&nbsp;<span class="op" id="1788528">:=</span>&nbsp;<span class="ident" id="1788531">to</span><span class="op" id="1788533">(</span><span class="ident" id="1788534">TitleCase</span><span class="op" id="1788543">,</span>&nbsp;<span class="ident" id="1788545">r</span><span class="op" id="1788546">,</span>&nbsp;<span class="op" id="1788548">[</span><span class="op" id="1788549">]</span><span class="ident" id="1788550">CaseRange</span><span class="op" id="1788559">(</span><span class="ident" id="1788560">special</span><span class="op" id="1788567">)</span><span class="op" id="1788568">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1788571">if</span>&nbsp;<span class="ident" id="1788574">r1</span>&nbsp;<span class="op" id="1788577">==</span>&nbsp;<span class="ident" id="1788580">r</span>&nbsp;<span class="op" id="1788582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1788586">r1</span>&nbsp;<span class="op" id="1788589">=</span>&nbsp;<span class="ident" id="1788591">ToTitle</span><span class="op" id="1788598">(</span><span class="ident" id="1788599">r</span><span class="op" id="1788600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1788603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1788606">return</span>&nbsp;<span class="ident" id="1788613">r1</span><br>
<span class="lineno"></span><span class="op" id="1788616">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="1788619">//&nbsp;ToLower&nbsp;maps&nbsp;the&nbsp;rune&nbsp;to&nbsp;lower&nbsp;case&nbsp;giving&nbsp;priority&nbsp;to&nbsp;the&nbsp;special&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="1788698">func</span>&nbsp;<span class="op" id="1788703">(</span><span class="ident" id="1788704">special</span>&nbsp;<span class="ident" id="1788712">SpecialCase</span><span class="op" id="1788723">)</span>&nbsp;<span class="ident" id="1788725">ToLower</span><span class="op" id="1788732">(</span><span class="ident" id="1788733">r</span>&nbsp;<span class="builtintype" id="1788735">rune</span><span class="op" id="1788739">)</span>&nbsp;<span class="builtintype" id="1788741">rune</span>&nbsp;<span class="op" id="1788746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1788749">r1</span>&nbsp;<span class="op" id="1788752">:=</span>&nbsp;<span class="ident" id="1788755">to</span><span class="op" id="1788757">(</span><span class="ident" id="1788758">LowerCase</span><span class="op" id="1788767">,</span>&nbsp;<span class="ident" id="1788769">r</span><span class="op" id="1788770">,</span>&nbsp;<span class="op" id="1788772">[</span><span class="op" id="1788773">]</span><span class="ident" id="1788774">CaseRange</span><span class="op" id="1788783">(</span><span class="ident" id="1788784">special</span><span class="op" id="1788791">)</span><span class="op" id="1788792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1788795">if</span>&nbsp;<span class="ident" id="1788798">r1</span>&nbsp;<span class="op" id="1788801">==</span>&nbsp;<span class="ident" id="1788804">r</span>&nbsp;<span class="op" id="1788806">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1788810">r1</span>&nbsp;<span class="op" id="1788813">=</span>&nbsp;<span class="ident" id="1788815">ToLower</span><span class="op" id="1788822">(</span><span class="ident" id="1788823">r</span><span class="op" id="1788824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1788827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1788830">return</span>&nbsp;<span class="ident" id="1788837">r1</span><br>
<span class="lineno"></span><span class="op" id="1788840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="1788843">//&nbsp;caseOrbit&nbsp;is&nbsp;defined&nbsp;in&nbsp;tables.go&nbsp;as&nbsp;[]foldPair.&nbsp;&nbsp;Right&nbsp;now&nbsp;all&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1788914">//&nbsp;entries&nbsp;fit&nbsp;in&nbsp;uint16,&nbsp;so&nbsp;use&nbsp;uint16.&nbsp;&nbsp;If&nbsp;that&nbsp;changes,&nbsp;compilation</span><br>
<span class="lineno"></span><span class="comment" id="1788985">//&nbsp;will&nbsp;fail&nbsp;(the&nbsp;constants&nbsp;in&nbsp;the&nbsp;composite&nbsp;literal&nbsp;will&nbsp;not&nbsp;fit&nbsp;in&nbsp;uint16)</span><br>
<span class="lineno"></span><span class="comment" id="1789062">//&nbsp;and&nbsp;the&nbsp;types&nbsp;here&nbsp;can&nbsp;change&nbsp;to&nbsp;uint32.</span><br>
<span class="lineno"></span><span class="keyword" id="1789106">type</span>&nbsp;<span class="ident" id="1789111">foldPair</span>&nbsp;<span class="keyword" id="1789120">struct</span>&nbsp;<span class="op" id="1789127">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789130">From</span>&nbsp;<span class="builtintype" id="1789135">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789143">To</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1789148">uint16</span><br>
<span class="lineno"></span><span class="op" id="1789155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1789158">//&nbsp;SimpleFold&nbsp;iterates&nbsp;over&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;equivalent&nbsp;under</span><br>
<span class="lineno">320</span><span class="comment" id="1789223">//&nbsp;the&nbsp;Unicode-defined&nbsp;simple&nbsp;case&nbsp;folding.&nbsp;&nbsp;Among&nbsp;the&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="1789290">//&nbsp;equivalent&nbsp;to&nbsp;rune&nbsp;(including&nbsp;rune&nbsp;itself),&nbsp;SimpleFold&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1789360">//&nbsp;smallest&nbsp;rune&nbsp;&gt;&nbsp;r&nbsp;if&nbsp;one&nbsp;exists,&nbsp;or&nbsp;else&nbsp;the&nbsp;smallest&nbsp;rune&nbsp;&gt;=&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="1789428">//</span><br>
<span class="lineno"></span><span class="comment" id="1789431">//&nbsp;For&nbsp;example:</span><br>
<span class="lineno">325</span><span class="comment" id="1789447">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;A&#39;)&nbsp;=&nbsp;&#39;a&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1789472">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;a&#39;)&nbsp;=&nbsp;&#39;A&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1789497">//</span><br>
<span class="lineno"></span><span class="comment" id="1789500">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;K&#39;)&nbsp;=&nbsp;&#39;k&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1789525">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;k&#39;)&nbsp;=&nbsp;&#39;\u212A&#39;&nbsp;(Kelvin&nbsp;symbol,&nbsp;)</span><br>
<span class="lineno">330</span><span class="comment" id="1789576">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;\u212A&#39;)&nbsp;=&nbsp;&#39;K&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1789606">//</span><br>
<span class="lineno"></span><span class="comment" id="1789609">//&nbsp;&nbsp;&nbsp;&nbsp;SimpleFold(&#39;1&#39;)&nbsp;=&nbsp;&#39;1&#39;</span><br>
<span class="lineno"></span><span class="comment" id="1789634">//</span><br>
<span class="lineno"></span><span class="keyword" id="1789637">func</span>&nbsp;<span class="ident" id="1789642">SimpleFold</span><span class="op" id="1789652">(</span><span class="ident" id="1789653">r</span>&nbsp;<span class="builtintype" id="1789655">rune</span><span class="op" id="1789659">)</span>&nbsp;<span class="builtintype" id="1789661">rune</span>&nbsp;<span class="op" id="1789666">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1789669">//&nbsp;Consult&nbsp;caseOrbit&nbsp;table&nbsp;for&nbsp;special&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789716">lo</span>&nbsp;<span class="op" id="1789719">:=</span>&nbsp;<span class="num" id="1789722">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789725">hi</span>&nbsp;<span class="op" id="1789728">:=</span>&nbsp;<span class="builtinfunc" id="1789731">len</span><span class="op" id="1789734">(</span><span class="ident" id="1789735">caseOrbit</span><span class="op" id="1789744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789747">for</span>&nbsp;<span class="ident" id="1789751">lo</span>&nbsp;<span class="op" id="1789754">&lt;</span>&nbsp;<span class="ident" id="1789756">hi</span>&nbsp;<span class="op" id="1789759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789763">m</span>&nbsp;<span class="op" id="1789765">:=</span>&nbsp;<span class="ident" id="1789768">lo</span>&nbsp;<span class="op" id="1789771">+</span>&nbsp;<span class="op" id="1789773">(</span><span class="ident" id="1789774">hi</span><span class="op" id="1789776">-</span><span class="ident" id="1789777">lo</span><span class="op" id="1789779">)</span><span class="op" id="1789780">/</span><span class="num" id="1789781">2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789785">if</span>&nbsp;<span class="builtintype" id="1789788">rune</span><span class="op" id="1789792">(</span><span class="ident" id="1789793">caseOrbit</span><span class="op" id="1789802">[</span><span class="ident" id="1789803">m</span><span class="op" id="1789804">]</span><span class="op" id="1789805">.</span><span class="ident" id="1789806">From</span><span class="op" id="1789810">)</span>&nbsp;<span class="op" id="1789812">&lt;</span>&nbsp;<span class="ident" id="1789814">r</span>&nbsp;<span class="op" id="1789816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789821">lo</span>&nbsp;<span class="op" id="1789824">=</span>&nbsp;<span class="ident" id="1789826">m</span>&nbsp;<span class="op" id="1789828">+</span>&nbsp;<span class="num" id="1789830">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1789834">}</span>&nbsp;<span class="keyword" id="1789836">else</span>&nbsp;<span class="op" id="1789841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1789846">hi</span>&nbsp;<span class="op" id="1789849">=</span>&nbsp;<span class="ident" id="1789851">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1789855">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1789858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789861">if</span>&nbsp;<span class="ident" id="1789864">lo</span>&nbsp;<span class="op" id="1789867">&lt;</span>&nbsp;<span class="builtinfunc" id="1789869">len</span><span class="op" id="1789872">(</span><span class="ident" id="1789873">caseOrbit</span><span class="op" id="1789882">)</span>&nbsp;<span class="op" id="1789884">&amp;&amp;</span>&nbsp;<span class="builtintype" id="1789887">rune</span><span class="op" id="1789891">(</span><span class="ident" id="1789892">caseOrbit</span><span class="op" id="1789901">[</span><span class="ident" id="1789902">lo</span><span class="op" id="1789904">]</span><span class="op" id="1789905">.</span><span class="ident" id="1789906">From</span><span class="op" id="1789910">)</span>&nbsp;<span class="op" id="1789912">==</span>&nbsp;<span class="ident" id="1789915">r</span>&nbsp;<span class="op" id="1789917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1789921">return</span>&nbsp;<span class="builtintype" id="1789928">rune</span><span class="op" id="1789932">(</span><span class="ident" id="1789933">caseOrbit</span><span class="op" id="1789942">[</span><span class="ident" id="1789943">lo</span><span class="op" id="1789945">]</span><span class="op" id="1789946">.</span><span class="ident" id="1789947">To</span><span class="op" id="1789949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1789952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1789956">//&nbsp;No&nbsp;folding&nbsp;specified.&nbsp;&nbsp;This&nbsp;is&nbsp;a&nbsp;one-&nbsp;or&nbsp;two-element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1790013">//&nbsp;equivalence&nbsp;class&nbsp;containing&nbsp;rune&nbsp;and&nbsp;ToLower(rune)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1790069">//&nbsp;and&nbsp;ToUpper(rune)&nbsp;if&nbsp;they&nbsp;are&nbsp;different&nbsp;from&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790124">if</span>&nbsp;<span class="ident" id="1790127">l</span>&nbsp;<span class="op" id="1790129">:=</span>&nbsp;<span class="ident" id="1790132">ToLower</span><span class="op" id="1790139">(</span><span class="ident" id="1790140">r</span><span class="op" id="1790141">)</span><span class="op" id="1790142">;</span>&nbsp;<span class="ident" id="1790144">l</span>&nbsp;<span class="op" id="1790146">!=</span>&nbsp;<span class="ident" id="1790149">r</span>&nbsp;<span class="op" id="1790151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790155">return</span>&nbsp;<span class="ident" id="1790162">l</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1790165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1790168">return</span>&nbsp;<span class="ident" id="1790175">ToUpper</span><span class="op" id="1790182">(</span><span class="ident" id="1790183">r</span><span class="op" id="1790184">)</span><br>
<span class="lineno"></span><span class="op" id="1790186">}</span>
</div>
</body>
</html>
