<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html" class="current">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5017954">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5018009">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5018063">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5018114">package</span>&nbsp;<span class="ident" id="5018122">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5018132">import</span>&nbsp;<span class="op" id="5018139">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5018142">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="5018148">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="5018151">//&nbsp;context&nbsp;describes&nbsp;the&nbsp;state&nbsp;an&nbsp;HTML&nbsp;parser&nbsp;must&nbsp;be&nbsp;in&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5018228">//&nbsp;portion&nbsp;of&nbsp;HTML&nbsp;produced&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;particular&nbsp;template&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="5018298">//</span><br>
<span class="lineno"></span><span class="comment" id="5018301">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;context&nbsp;is&nbsp;the&nbsp;start&nbsp;context&nbsp;for&nbsp;a&nbsp;template&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="5018376">//&nbsp;produces&nbsp;an&nbsp;HTML&nbsp;fragment&nbsp;as&nbsp;defined&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="5018419">//&nbsp;http://www.w3.org/TR/html5/syntax.html#the-end</span><br>
<span class="lineno"></span><span class="comment" id="5018469">//&nbsp;where&nbsp;the&nbsp;context&nbsp;element&nbsp;is&nbsp;null.</span><br>
<span class="lineno"></span><span class="keyword" id="5018507">type</span>&nbsp;<span class="ident" id="5018512">context</span>&nbsp;<span class="keyword" id="5018520">struct</span>&nbsp;<span class="op" id="5018527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5018530">state</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5018538">state</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5018545">delim</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5018553">delim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5018560">urlPart</span>&nbsp;<span class="ident" id="5018568">urlPart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5018577">jsCtx</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5018585">jsCtx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5018592">attr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5018600">attr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5018606">element</span>&nbsp;<span class="ident" id="5018614">element</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5018623">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5018631">*</span><span class="ident" id="5018632">Error</span><br>
<span class="lineno"></span><span class="op" id="5018638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5018641">func</span>&nbsp;<span class="op" id="5018646">(</span><span class="ident" id="5018647">c</span>&nbsp;<span class="ident" id="5018649">context</span><span class="op" id="5018656">)</span>&nbsp;<span class="ident" id="5018658">String</span><span class="op" id="5018664">(</span><span class="op" id="5018665">)</span>&nbsp;<span class="builtintype" id="5018667">string</span>&nbsp;<span class="op" id="5018674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5018677">return</span>&nbsp;<span class="ident" id="5018684">fmt</span><span class="op" id="5018687">.</span><span class="ident" id="5018688">Sprintf</span><span class="op" id="5018695">(</span><span class="string" id="5018696">&#34;{%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v}&#34;</span><span class="op" id="5018720">,</span>&nbsp;<span class="ident" id="5018722">c</span><span class="op" id="5018723">.</span><span class="ident" id="5018724">state</span><span class="op" id="5018729">,</span>&nbsp;<span class="ident" id="5018731">c</span><span class="op" id="5018732">.</span><span class="ident" id="5018733">delim</span><span class="op" id="5018738">,</span>&nbsp;<span class="ident" id="5018740">c</span><span class="op" id="5018741">.</span><span class="ident" id="5018742">urlPart</span><span class="op" id="5018749">,</span>&nbsp;<span class="ident" id="5018751">c</span><span class="op" id="5018752">.</span><span class="ident" id="5018753">jsCtx</span><span class="op" id="5018758">,</span>&nbsp;<span class="ident" id="5018760">c</span><span class="op" id="5018761">.</span><span class="ident" id="5018762">attr</span><span class="op" id="5018766">,</span>&nbsp;<span class="ident" id="5018768">c</span><span class="op" id="5018769">.</span><span class="ident" id="5018770">element</span><span class="op" id="5018777">,</span>&nbsp;<span class="ident" id="5018779">c</span><span class="op" id="5018780">.</span><span class="ident" id="5018781">err</span><span class="op" id="5018784">)</span><br>
<span class="lineno">30</span><span class="op" id="5018786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5018789">//&nbsp;eq&nbsp;reports&nbsp;whether&nbsp;two&nbsp;contexts&nbsp;are&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="5018835">func</span>&nbsp;<span class="op" id="5018840">(</span><span class="ident" id="5018841">c</span>&nbsp;<span class="ident" id="5018843">context</span><span class="op" id="5018850">)</span>&nbsp;<span class="ident" id="5018852">eq</span><span class="op" id="5018854">(</span><span class="ident" id="5018855">d</span>&nbsp;<span class="ident" id="5018857">context</span><span class="op" id="5018864">)</span>&nbsp;<span class="builtintype" id="5018866">bool</span>&nbsp;<span class="op" id="5018871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5018874">return</span>&nbsp;<span class="ident" id="5018881">c</span><span class="op" id="5018882">.</span><span class="ident" id="5018883">state</span>&nbsp;<span class="op" id="5018889">==</span>&nbsp;<span class="ident" id="5018892">d</span><span class="op" id="5018893">.</span><span class="ident" id="5018894">state</span>&nbsp;<span class="op" id="5018900">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5018905">c</span><span class="op" id="5018906">.</span><span class="ident" id="5018907">delim</span>&nbsp;<span class="op" id="5018913">==</span>&nbsp;<span class="ident" id="5018916">d</span><span class="op" id="5018917">.</span><span class="ident" id="5018918">delim</span>&nbsp;<span class="op" id="5018924">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5018929">c</span><span class="op" id="5018930">.</span><span class="ident" id="5018931">urlPart</span>&nbsp;<span class="op" id="5018939">==</span>&nbsp;<span class="ident" id="5018942">d</span><span class="op" id="5018943">.</span><span class="ident" id="5018944">urlPart</span>&nbsp;<span class="op" id="5018952">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5018957">c</span><span class="op" id="5018958">.</span><span class="ident" id="5018959">jsCtx</span>&nbsp;<span class="op" id="5018965">==</span>&nbsp;<span class="ident" id="5018968">d</span><span class="op" id="5018969">.</span><span class="ident" id="5018970">jsCtx</span>&nbsp;<span class="op" id="5018976">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5018981">c</span><span class="op" id="5018982">.</span><span class="ident" id="5018983">attr</span>&nbsp;<span class="op" id="5018988">==</span>&nbsp;<span class="ident" id="5018991">d</span><span class="op" id="5018992">.</span><span class="ident" id="5018993">attr</span>&nbsp;<span class="op" id="5018998">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5019003">c</span><span class="op" id="5019004">.</span><span class="ident" id="5019005">element</span>&nbsp;<span class="op" id="5019013">==</span>&nbsp;<span class="ident" id="5019016">d</span><span class="op" id="5019017">.</span><span class="ident" id="5019018">element</span>&nbsp;<span class="op" id="5019026">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5019031">c</span><span class="op" id="5019032">.</span><span class="ident" id="5019033">err</span>&nbsp;<span class="op" id="5019037">==</span>&nbsp;<span class="ident" id="5019040">d</span><span class="op" id="5019041">.</span><span class="ident" id="5019042">err</span><br>
<span class="lineno"></span><span class="op" id="5019046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5019049">//&nbsp;mangle&nbsp;produces&nbsp;an&nbsp;identifier&nbsp;that&nbsp;includes&nbsp;a&nbsp;suffix&nbsp;that&nbsp;distinguishes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="5019127">//&nbsp;from&nbsp;template&nbsp;names&nbsp;mangled&nbsp;with&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno">45</span><span class="keyword" id="5019183">func</span>&nbsp;<span class="op" id="5019188">(</span><span class="ident" id="5019189">c</span>&nbsp;<span class="ident" id="5019191">context</span><span class="op" id="5019198">)</span>&nbsp;<span class="ident" id="5019200">mangle</span><span class="op" id="5019206">(</span><span class="ident" id="5019207">templateName</span>&nbsp;<span class="builtintype" id="5019220">string</span><span class="op" id="5019226">)</span>&nbsp;<span class="builtintype" id="5019228">string</span>&nbsp;<span class="op" id="5019235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5019238">//&nbsp;The&nbsp;mangled&nbsp;name&nbsp;for&nbsp;the&nbsp;default&nbsp;context&nbsp;is&nbsp;the&nbsp;input&nbsp;templateName.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5019310">if</span>&nbsp;<span class="ident" id="5019313">c</span><span class="op" id="5019314">.</span><span class="ident" id="5019315">state</span>&nbsp;<span class="op" id="5019321">==</span>&nbsp;<span class="ident" id="5019324">stateText</span>&nbsp;<span class="op" id="5019334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5019338">return</span>&nbsp;<span class="ident" id="5019345">templateName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5019359">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5019362">s</span>&nbsp;<span class="op" id="5019364">:=</span>&nbsp;<span class="ident" id="5019367">templateName</span>&nbsp;<span class="op" id="5019380">+</span>&nbsp;<span class="string" id="5019382">&#34;$htmltemplate_&#34;</span>&nbsp;<span class="op" id="5019399">+</span>&nbsp;<span class="ident" id="5019401">c</span><span class="op" id="5019402">.</span><span class="ident" id="5019403">state</span><span class="op" id="5019408">.</span><span class="ident" id="5019409">String</span><span class="op" id="5019415">(</span><span class="op" id="5019416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5019419">if</span>&nbsp;<span class="ident" id="5019422">c</span><span class="op" id="5019423">.</span><span class="ident" id="5019424">delim</span>&nbsp;<span class="op" id="5019430">!=</span>&nbsp;<span class="num" id="5019433">0</span>&nbsp;<span class="op" id="5019435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5019439">s</span>&nbsp;<span class="op" id="5019441">+=</span>&nbsp;<span class="string" id="5019444">&#34;_&#34;</span>&nbsp;<span class="op" id="5019448">+</span>&nbsp;<span class="ident" id="5019450">c</span><span class="op" id="5019451">.</span><span class="ident" id="5019452">delim</span><span class="op" id="5019457">.</span><span class="ident" id="5019458">String</span><span class="op" id="5019464">(</span><span class="op" id="5019465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5019468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5019471">if</span>&nbsp;<span class="ident" id="5019474">c</span><span class="op" id="5019475">.</span><span class="ident" id="5019476">urlPart</span>&nbsp;<span class="op" id="5019484">!=</span>&nbsp;<span class="num" id="5019487">0</span>&nbsp;<span class="op" id="5019489">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5019493">s</span>&nbsp;<span class="op" id="5019495">+=</span>&nbsp;<span class="string" id="5019498">&#34;_&#34;</span>&nbsp;<span class="op" id="5019502">+</span>&nbsp;<span class="ident" id="5019504">c</span><span class="op" id="5019505">.</span><span class="ident" id="5019506">urlPart</span><span class="op" id="5019513">.</span><span class="ident" id="5019514">String</span><span class="op" id="5019520">(</span><span class="op" id="5019521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5019524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5019527">if</span>&nbsp;<span class="ident" id="5019530">c</span><span class="op" id="5019531">.</span><span class="ident" id="5019532">jsCtx</span>&nbsp;<span class="op" id="5019538">!=</span>&nbsp;<span class="num" id="5019541">0</span>&nbsp;<span class="op" id="5019543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5019547">s</span>&nbsp;<span class="op" id="5019549">+=</span>&nbsp;<span class="string" id="5019552">&#34;_&#34;</span>&nbsp;<span class="op" id="5019556">+</span>&nbsp;<span class="ident" id="5019558">c</span><span class="op" id="5019559">.</span><span class="ident" id="5019560">jsCtx</span><span class="op" id="5019565">.</span><span class="ident" id="5019566">String</span><span class="op" id="5019572">(</span><span class="op" id="5019573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5019576">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5019579">if</span>&nbsp;<span class="ident" id="5019582">c</span><span class="op" id="5019583">.</span><span class="ident" id="5019584">attr</span>&nbsp;<span class="op" id="5019589">!=</span>&nbsp;<span class="num" id="5019592">0</span>&nbsp;<span class="op" id="5019594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5019598">s</span>&nbsp;<span class="op" id="5019600">+=</span>&nbsp;<span class="string" id="5019603">&#34;_&#34;</span>&nbsp;<span class="op" id="5019607">+</span>&nbsp;<span class="ident" id="5019609">c</span><span class="op" id="5019610">.</span><span class="ident" id="5019611">attr</span><span class="op" id="5019615">.</span><span class="ident" id="5019616">String</span><span class="op" id="5019622">(</span><span class="op" id="5019623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5019626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5019629">if</span>&nbsp;<span class="ident" id="5019632">c</span><span class="op" id="5019633">.</span><span class="ident" id="5019634">element</span>&nbsp;<span class="op" id="5019642">!=</span>&nbsp;<span class="num" id="5019645">0</span>&nbsp;<span class="op" id="5019647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5019651">s</span>&nbsp;<span class="op" id="5019653">+=</span>&nbsp;<span class="string" id="5019656">&#34;_&#34;</span>&nbsp;<span class="op" id="5019660">+</span>&nbsp;<span class="ident" id="5019662">c</span><span class="op" id="5019663">.</span><span class="ident" id="5019664">element</span><span class="op" id="5019671">.</span><span class="ident" id="5019672">String</span><span class="op" id="5019678">(</span><span class="op" id="5019679">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5019682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5019685">return</span>&nbsp;<span class="ident" id="5019692">s</span><br>
<span class="lineno"></span><span class="op" id="5019694">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5019697">//&nbsp;state&nbsp;describes&nbsp;a&nbsp;high-level&nbsp;HTML&nbsp;parser&nbsp;state.</span><br>
<span class="lineno">70</span><span class="comment" id="5019748">//</span><br>
<span class="lineno"></span><span class="comment" id="5019751">//&nbsp;It&nbsp;bounds&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;element&nbsp;stack,&nbsp;and&nbsp;by&nbsp;extension&nbsp;the&nbsp;HTML&nbsp;insertion</span><br>
<span class="lineno"></span><span class="comment" id="5019830">//&nbsp;mode,&nbsp;but&nbsp;also&nbsp;contains&nbsp;state&nbsp;that&nbsp;does&nbsp;not&nbsp;correspond&nbsp;to&nbsp;anything&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5019907">//&nbsp;HTML5&nbsp;parsing&nbsp;algorithm&nbsp;because&nbsp;a&nbsp;single&nbsp;token&nbsp;production&nbsp;in&nbsp;the&nbsp;HTML</span><br>
<span class="lineno"></span><span class="comment" id="5019980">//&nbsp;grammar&nbsp;may&nbsp;contain&nbsp;embedded&nbsp;actions&nbsp;in&nbsp;a&nbsp;template.&nbsp;For&nbsp;instance,&nbsp;the&nbsp;quoted</span><br>
<span class="lineno">75</span><span class="comment" id="5020060">//&nbsp;HTML&nbsp;attribute&nbsp;produced&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5020090">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;title=&#34;Hello&nbsp;{{.World}}&#34;&gt;</span><br>
<span class="lineno"></span><span class="comment" id="5020128">//&nbsp;is&nbsp;a&nbsp;single&nbsp;token&nbsp;in&nbsp;HTML&#39;s&nbsp;grammar&nbsp;but&nbsp;in&nbsp;a&nbsp;template&nbsp;spans&nbsp;several&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="5020206">type</span>&nbsp;<span class="ident" id="5020211">state</span>&nbsp;<span class="builtintype" id="5020217">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="5020224">const</span>&nbsp;<span class="op" id="5020230">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5020233">//&nbsp;stateText&nbsp;is&nbsp;parsed&nbsp;character&nbsp;data.&nbsp;An&nbsp;HTML&nbsp;parser&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5020294">//&nbsp;this&nbsp;state&nbsp;when&nbsp;its&nbsp;parse&nbsp;position&nbsp;is&nbsp;outside&nbsp;an&nbsp;HTML&nbsp;tag,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5020357">//&nbsp;directive,&nbsp;comment,&nbsp;and&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5020407">stateText</span>&nbsp;<span class="ident" id="5020417">state</span>&nbsp;<span class="op" id="5020423">=</span>&nbsp;<span class="ident" id="5020425">iota</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5020431">//&nbsp;stateTag&nbsp;occurs&nbsp;before&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;or&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5020497">stateTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5020507">//&nbsp;stateAttrName&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;attribute&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5020558">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;^name^&nbsp;=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5020610">stateAttrName</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5020625">//&nbsp;stateAfterName&nbsp;occurs&nbsp;after&nbsp;an&nbsp;attr&nbsp;name&nbsp;has&nbsp;ended&nbsp;but&nbsp;before&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5020695">//&nbsp;equals&nbsp;sign.&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name^&nbsp;^=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5020760">stateAfterName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5020776">//&nbsp;stateBeforeValue&nbsp;occurs&nbsp;after&nbsp;the&nbsp;equals&nbsp;sign&nbsp;but&nbsp;before&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5020848">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name&nbsp;=^&nbsp;^value`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5020900">stateBeforeValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5020918">//&nbsp;stateHTMLCmt&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;&lt;!--&nbsp;HTML&nbsp;comment&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5020975">stateHTMLCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5020989">//&nbsp;stateRCDATA&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;RCDATA&nbsp;element&nbsp;(&lt;textarea&gt;&nbsp;or&nbsp;&lt;title&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021061">//&nbsp;as&nbsp;described&nbsp;at&nbsp;http://www.w3.org/TR/html5/syntax.html#elements-0</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021131">stateRCDATA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021144">//&nbsp;stateAttr&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021213">stateAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021224">//&nbsp;stateURL&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021293">stateURL</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021303">//&nbsp;stateJS&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;script&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021365">stateJS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021374">//&nbsp;stateJSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021440">stateJSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021454">//&nbsp;stateJSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021520">stateJSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021534">//&nbsp;stateJSRegexp&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021595">stateJSRegexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021610">//&nbsp;stateJSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021678">stateJSBlockCmt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021695">//&nbsp;stateJSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021758">stateJSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021774">//&nbsp;stateCSS&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;&lt;style&gt;&nbsp;element&nbsp;or&nbsp;style&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021839">stateCSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021849">//&nbsp;stateCSSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021909">stateCSSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021924">//&nbsp;stateCSSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5021984">stateCSSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5021999">//&nbsp;stateCSSDqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;url(&#34;...&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022063">stateCSSDqURL</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5022078">//&nbsp;stateCSSSqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;url(&#39;...&#39;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022142">stateCSSSqURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5022157">//&nbsp;stateCSSURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;unquoted&nbsp;url(...).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022212">stateCSSURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5022225">//&nbsp;stateCSSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022287">stateCSSBlockCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5022305">//&nbsp;stateCSSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022362">stateCSSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5022379">//&nbsp;stateError&nbsp;is&nbsp;an&nbsp;infectious&nbsp;error&nbsp;state&nbsp;outside&nbsp;any&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5022441">//&nbsp;HTML/CSS/JS&nbsp;construct.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022468">stateError</span><br>
<span class="lineno"></span><span class="op" id="5022479">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5022482">var</span>&nbsp;<span class="ident" id="5022486">stateNames</span>&nbsp;<span class="op" id="5022497">=</span>&nbsp;<span class="op" id="5022499">[</span><span class="op" id="5022500">...</span><span class="op" id="5022503">]</span><span class="builtintype" id="5022504">string</span><span class="op" id="5022510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022513">stateText</span><span class="op" id="5022522">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5022531">&#34;stateText&#34;</span><span class="op" id="5022542">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022545">stateTag</span><span class="op" id="5022553">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5022563">&#34;stateTag&#34;</span><span class="op" id="5022573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022576">stateAttrName</span><span class="op" id="5022589">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5022594">&#34;stateAttrName&#34;</span><span class="op" id="5022609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022612">stateAfterName</span><span class="op" id="5022626">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5022630">&#34;stateAfterName&#34;</span><span class="op" id="5022646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022649">stateBeforeValue</span><span class="op" id="5022665">:</span>&nbsp;<span class="string" id="5022667">&#34;stateBeforeValue&#34;</span><span class="op" id="5022685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022688">stateHTMLCmt</span><span class="op" id="5022700">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5022706">&#34;stateHTMLCmt&#34;</span><span class="op" id="5022720">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022723">stateRCDATA</span><span class="op" id="5022734">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5022741">&#34;stateRCDATA&#34;</span><span class="op" id="5022754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022757">stateAttr</span><span class="op" id="5022766">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5022775">&#34;stateAttr&#34;</span><span class="op" id="5022786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022789">stateURL</span><span class="op" id="5022797">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5022807">&#34;stateURL&#34;</span><span class="op" id="5022817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022820">stateJS</span><span class="op" id="5022827">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5022838">&#34;stateJS&#34;</span><span class="op" id="5022847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022850">stateJSDqStr</span><span class="op" id="5022862">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5022868">&#34;stateJSDqStr&#34;</span><span class="op" id="5022882">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022885">stateJSSqStr</span><span class="op" id="5022897">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5022903">&#34;stateJSSqStr&#34;</span><span class="op" id="5022917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022920">stateJSRegexp</span><span class="op" id="5022933">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5022938">&#34;stateJSRegexp&#34;</span><span class="op" id="5022953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022956">stateJSBlockCmt</span><span class="op" id="5022971">:</span>&nbsp;&nbsp;<span class="string" id="5022974">&#34;stateJSBlockCmt&#34;</span><span class="op" id="5022991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5022994">stateJSLineCmt</span><span class="op" id="5023008">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5023012">&#34;stateJSLineCmt&#34;</span><span class="op" id="5023028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023031">stateCSS</span><span class="op" id="5023039">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5023049">&#34;stateCSS&#34;</span><span class="op" id="5023059">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023062">stateCSSDqStr</span><span class="op" id="5023075">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5023080">&#34;stateCSSDqStr&#34;</span><span class="op" id="5023095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023098">stateCSSSqStr</span><span class="op" id="5023111">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5023116">&#34;stateCSSSqStr&#34;</span><span class="op" id="5023131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023134">stateCSSDqURL</span><span class="op" id="5023147">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5023152">&#34;stateCSSDqURL&#34;</span><span class="op" id="5023167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023170">stateCSSSqURL</span><span class="op" id="5023183">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5023188">&#34;stateCSSSqURL&#34;</span><span class="op" id="5023203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023206">stateCSSURL</span><span class="op" id="5023217">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5023224">&#34;stateCSSURL&#34;</span><span class="op" id="5023237">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023240">stateCSSBlockCmt</span><span class="op" id="5023256">:</span>&nbsp;<span class="string" id="5023258">&#34;stateCSSBlockCmt&#34;</span><span class="op" id="5023276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023279">stateCSSLineCmt</span><span class="op" id="5023294">:</span>&nbsp;&nbsp;<span class="string" id="5023297">&#34;stateCSSLineCmt&#34;</span><span class="op" id="5023314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5023317">stateError</span><span class="op" id="5023327">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5023335">&#34;stateError&#34;</span><span class="op" id="5023347">,</span><br>
<span class="lineno"></span><span class="op" id="5023349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="5023352">func</span>&nbsp;<span class="op" id="5023357">(</span><span class="ident" id="5023358">s</span>&nbsp;<span class="ident" id="5023360">state</span><span class="op" id="5023365">)</span>&nbsp;<span class="ident" id="5023367">String</span><span class="op" id="5023373">(</span><span class="op" id="5023374">)</span>&nbsp;<span class="builtintype" id="5023376">string</span>&nbsp;<span class="op" id="5023383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023386">if</span>&nbsp;<span class="builtintype" id="5023389">int</span><span class="op" id="5023392">(</span><span class="ident" id="5023393">s</span><span class="op" id="5023394">)</span>&nbsp;<span class="op" id="5023396">&lt;</span>&nbsp;<span class="builtinfunc" id="5023398">len</span><span class="op" id="5023401">(</span><span class="ident" id="5023402">stateNames</span><span class="op" id="5023412">)</span>&nbsp;<span class="op" id="5023414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023418">return</span>&nbsp;<span class="ident" id="5023425">stateNames</span><span class="op" id="5023435">[</span><span class="ident" id="5023436">s</span><span class="op" id="5023437">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5023440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023443">return</span>&nbsp;<span class="ident" id="5023450">fmt</span><span class="op" id="5023453">.</span><span class="ident" id="5023454">Sprintf</span><span class="op" id="5023461">(</span><span class="string" id="5023462">&#34;illegal&nbsp;state&nbsp;%d&#34;</span><span class="op" id="5023480">,</span>&nbsp;<span class="builtintype" id="5023482">int</span><span class="op" id="5023485">(</span><span class="ident" id="5023486">s</span><span class="op" id="5023487">)</span><span class="op" id="5023488">)</span><br>
<span class="lineno">170</span><span class="op" id="5023490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5023493">//&nbsp;isComment&nbsp;is&nbsp;true&nbsp;for&nbsp;any&nbsp;state&nbsp;that&nbsp;contains&nbsp;content&nbsp;meant&nbsp;for&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="5023569">//&nbsp;authors&nbsp;&amp;&nbsp;maintainers,&nbsp;not&nbsp;for&nbsp;end-users&nbsp;or&nbsp;machines.</span><br>
<span class="lineno"></span><span class="keyword" id="5023626">func</span>&nbsp;<span class="ident" id="5023631">isComment</span><span class="op" id="5023640">(</span><span class="ident" id="5023641">s</span>&nbsp;<span class="ident" id="5023643">state</span><span class="op" id="5023648">)</span>&nbsp;<span class="builtintype" id="5023650">bool</span>&nbsp;<span class="op" id="5023655">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023658">switch</span>&nbsp;<span class="ident" id="5023665">s</span>&nbsp;<span class="op" id="5023667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023670">case</span>&nbsp;<span class="ident" id="5023675">stateHTMLCmt</span><span class="op" id="5023687">,</span>&nbsp;<span class="ident" id="5023689">stateJSBlockCmt</span><span class="op" id="5023704">,</span>&nbsp;<span class="ident" id="5023706">stateJSLineCmt</span><span class="op" id="5023720">,</span>&nbsp;<span class="ident" id="5023722">stateCSSBlockCmt</span><span class="op" id="5023738">,</span>&nbsp;<span class="ident" id="5023740">stateCSSLineCmt</span><span class="op" id="5023755">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023759">return</span>&nbsp;<span class="builtintype" id="5023766">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5023772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023775">return</span>&nbsp;<span class="builtintype" id="5023782">false</span><br>
<span class="lineno">180</span><span class="op" id="5023788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5023791">//&nbsp;isInTag&nbsp;return&nbsp;whether&nbsp;s&nbsp;occurs&nbsp;solely&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5023853">func</span>&nbsp;<span class="ident" id="5023858">isInTag</span><span class="op" id="5023865">(</span><span class="ident" id="5023866">s</span>&nbsp;<span class="ident" id="5023868">state</span><span class="op" id="5023873">)</span>&nbsp;<span class="builtintype" id="5023875">bool</span>&nbsp;<span class="op" id="5023880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023883">switch</span>&nbsp;<span class="ident" id="5023890">s</span>&nbsp;<span class="op" id="5023892">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023895">case</span>&nbsp;<span class="ident" id="5023900">stateTag</span><span class="op" id="5023908">,</span>&nbsp;<span class="ident" id="5023910">stateAttrName</span><span class="op" id="5023923">,</span>&nbsp;<span class="ident" id="5023925">stateAfterName</span><span class="op" id="5023939">,</span>&nbsp;<span class="ident" id="5023941">stateBeforeValue</span><span class="op" id="5023957">,</span>&nbsp;<span class="ident" id="5023959">stateAttr</span><span class="op" id="5023968">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023972">return</span>&nbsp;<span class="builtintype" id="5023979">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5023985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5023988">return</span>&nbsp;<span class="builtintype" id="5023995">false</span><br>
<span class="lineno"></span><span class="op" id="5024001">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5024004">//&nbsp;delim&nbsp;is&nbsp;the&nbsp;delimiter&nbsp;that&nbsp;will&nbsp;end&nbsp;the&nbsp;current&nbsp;HTML&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="5024072">type</span>&nbsp;<span class="ident" id="5024077">delim</span>&nbsp;<span class="builtintype" id="5024083">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5024090">const</span>&nbsp;<span class="op" id="5024096">(</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5024099">//&nbsp;delimNone&nbsp;occurs&nbsp;outside&nbsp;any&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024143">delimNone</span>&nbsp;<span class="ident" id="5024153">delim</span>&nbsp;<span class="op" id="5024159">=</span>&nbsp;<span class="ident" id="5024161">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5024167">//&nbsp;delimDoubleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;double&nbsp;quote&nbsp;(&#34;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024241">delimDoubleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5024259">//&nbsp;delimSingleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;single&nbsp;quote&nbsp;(&#39;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024333">delimSingleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5024351">//&nbsp;delimSpaceOrTagEnd&nbsp;occurs&nbsp;when&nbsp;a&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket&nbsp;(&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5024421">//&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024447">delimSpaceOrTagEnd</span><br>
<span class="lineno"></span><span class="op" id="5024466">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="5024469">var</span>&nbsp;<span class="ident" id="5024473">delimNames</span>&nbsp;<span class="op" id="5024484">=</span>&nbsp;<span class="op" id="5024486">[</span><span class="op" id="5024487">...</span><span class="op" id="5024490">]</span><span class="builtintype" id="5024491">string</span><span class="op" id="5024497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024500">delimNone</span><span class="op" id="5024509">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5024520">&#34;delimNone&#34;</span><span class="op" id="5024531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024534">delimDoubleQuote</span><span class="op" id="5024550">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5024554">&#34;delimDoubleQuote&#34;</span><span class="op" id="5024572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024575">delimSingleQuote</span><span class="op" id="5024591">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5024595">&#34;delimSingleQuote&#34;</span><span class="op" id="5024613">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5024616">delimSpaceOrTagEnd</span><span class="op" id="5024634">:</span>&nbsp;<span class="string" id="5024636">&#34;delimSpaceOrTagEnd&#34;</span><span class="op" id="5024656">,</span><br>
<span class="lineno"></span><span class="op" id="5024658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5024661">func</span>&nbsp;<span class="op" id="5024666">(</span><span class="ident" id="5024667">d</span>&nbsp;<span class="ident" id="5024669">delim</span><span class="op" id="5024674">)</span>&nbsp;<span class="ident" id="5024676">String</span><span class="op" id="5024682">(</span><span class="op" id="5024683">)</span>&nbsp;<span class="builtintype" id="5024685">string</span>&nbsp;<span class="op" id="5024692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5024695">if</span>&nbsp;<span class="builtintype" id="5024698">int</span><span class="op" id="5024701">(</span><span class="ident" id="5024702">d</span><span class="op" id="5024703">)</span>&nbsp;<span class="op" id="5024705">&lt;</span>&nbsp;<span class="builtinfunc" id="5024707">len</span><span class="op" id="5024710">(</span><span class="ident" id="5024711">delimNames</span><span class="op" id="5024721">)</span>&nbsp;<span class="op" id="5024723">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5024727">return</span>&nbsp;<span class="ident" id="5024734">delimNames</span><span class="op" id="5024744">[</span><span class="ident" id="5024745">d</span><span class="op" id="5024746">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5024749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5024752">return</span>&nbsp;<span class="ident" id="5024759">fmt</span><span class="op" id="5024762">.</span><span class="ident" id="5024763">Sprintf</span><span class="op" id="5024770">(</span><span class="string" id="5024771">&#34;illegal&nbsp;delim&nbsp;%d&#34;</span><span class="op" id="5024789">,</span>&nbsp;<span class="builtintype" id="5024791">int</span><span class="op" id="5024794">(</span><span class="ident" id="5024795">d</span><span class="op" id="5024796">)</span><span class="op" id="5024797">)</span><br>
<span class="lineno"></span><span class="op" id="5024799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5024802">//&nbsp;urlPart&nbsp;identifies&nbsp;a&nbsp;part&nbsp;in&nbsp;an&nbsp;RFC&nbsp;3986&nbsp;hierarchical&nbsp;URL&nbsp;to&nbsp;allow&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="5024882">//&nbsp;encoding&nbsp;strategies.</span><br>
<span class="lineno"></span><span class="keyword" id="5024906">type</span>&nbsp;<span class="ident" id="5024911">urlPart</span>&nbsp;<span class="builtintype" id="5024919">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5024926">const</span>&nbsp;<span class="op" id="5024932">(</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5024935">//&nbsp;urlPartNone&nbsp;occurs&nbsp;when&nbsp;not&nbsp;in&nbsp;a&nbsp;URL,&nbsp;or&nbsp;possibly&nbsp;at&nbsp;the&nbsp;start:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5025003">//&nbsp;^&nbsp;in&nbsp;&#34;^http://auth/path?k=v#frag&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025042">urlPartNone</span>&nbsp;<span class="ident" id="5025054">urlPart</span>&nbsp;<span class="op" id="5025062">=</span>&nbsp;<span class="ident" id="5025064">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5025070">//&nbsp;urlPartPreQuery&nbsp;occurs&nbsp;in&nbsp;the&nbsp;scheme,&nbsp;authority,&nbsp;or&nbsp;path;&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5025144">//&nbsp;^s&nbsp;in&nbsp;&#34;h^ttp://auth/path^?k=v#frag&#34;.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025185">urlPartPreQuery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5025202">//&nbsp;urlPartQueryOrFrag&nbsp;occurs&nbsp;in&nbsp;the&nbsp;query&nbsp;portion&nbsp;between&nbsp;the&nbsp;^s&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5025271">//&nbsp;&#34;http://auth/path?^k=v#frag^&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025306">urlPartQueryOrFrag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5025326">//&nbsp;urlPartUnknown&nbsp;occurs&nbsp;due&nbsp;to&nbsp;joining&nbsp;of&nbsp;contexts&nbsp;both&nbsp;before&nbsp;and</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5025395">//&nbsp;after&nbsp;the&nbsp;query&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025426">urlPartUnknown</span><br>
<span class="lineno"></span><span class="op" id="5025441">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5025444">var</span>&nbsp;<span class="ident" id="5025448">urlPartNames</span>&nbsp;<span class="op" id="5025461">=</span>&nbsp;<span class="op" id="5025463">[</span><span class="op" id="5025464">...</span><span class="op" id="5025467">]</span><span class="builtintype" id="5025468">string</span><span class="op" id="5025474">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025477">urlPartNone</span><span class="op" id="5025488">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5025497">&#34;urlPartNone&#34;</span><span class="op" id="5025510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025513">urlPartPreQuery</span><span class="op" id="5025528">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5025533">&#34;urlPartPreQuery&#34;</span><span class="op" id="5025550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025553">urlPartQueryOrFrag</span><span class="op" id="5025571">:</span>&nbsp;<span class="string" id="5025573">&#34;urlPartQueryOrFrag&#34;</span><span class="op" id="5025593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025596">urlPartUnknown</span><span class="op" id="5025610">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5025616">&#34;urlPartUnknown&#34;</span><span class="op" id="5025632">,</span><br>
<span class="lineno"></span><span class="op" id="5025634">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="5025637">func</span>&nbsp;<span class="op" id="5025642">(</span><span class="ident" id="5025643">u</span>&nbsp;<span class="ident" id="5025645">urlPart</span><span class="op" id="5025652">)</span>&nbsp;<span class="ident" id="5025654">String</span><span class="op" id="5025660">(</span><span class="op" id="5025661">)</span>&nbsp;<span class="builtintype" id="5025663">string</span>&nbsp;<span class="op" id="5025670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025673">if</span>&nbsp;<span class="builtintype" id="5025676">int</span><span class="op" id="5025679">(</span><span class="ident" id="5025680">u</span><span class="op" id="5025681">)</span>&nbsp;<span class="op" id="5025683">&lt;</span>&nbsp;<span class="builtinfunc" id="5025685">len</span><span class="op" id="5025688">(</span><span class="ident" id="5025689">urlPartNames</span><span class="op" id="5025701">)</span>&nbsp;<span class="op" id="5025703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025707">return</span>&nbsp;<span class="ident" id="5025714">urlPartNames</span><span class="op" id="5025726">[</span><span class="ident" id="5025727">u</span><span class="op" id="5025728">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5025731">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5025734">return</span>&nbsp;<span class="ident" id="5025741">fmt</span><span class="op" id="5025744">.</span><span class="ident" id="5025745">Sprintf</span><span class="op" id="5025752">(</span><span class="string" id="5025753">&#34;illegal&nbsp;urlPart&nbsp;%d&#34;</span><span class="op" id="5025773">,</span>&nbsp;<span class="builtintype" id="5025775">int</span><span class="op" id="5025778">(</span><span class="ident" id="5025779">u</span><span class="op" id="5025780">)</span><span class="op" id="5025781">)</span><br>
<span class="lineno"></span><span class="op" id="5025783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5025786">//&nbsp;jsCtx&nbsp;determines&nbsp;whether&nbsp;a&nbsp;&#39;/&#39;&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5025861">//&nbsp;division&nbsp;operator.</span><br>
<span class="lineno">255</span><span class="keyword" id="5025883">type</span>&nbsp;<span class="ident" id="5025888">jsCtx</span>&nbsp;<span class="builtintype" id="5025894">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5025901">const</span>&nbsp;<span class="op" id="5025907">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5025910">//&nbsp;jsCtxRegexp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5025975">jsCtxRegexp</span>&nbsp;<span class="ident" id="5025987">jsCtx</span>&nbsp;<span class="op" id="5025993">=</span>&nbsp;<span class="ident" id="5025995">iota</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5026001">//&nbsp;jsCtxDivOp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;division&nbsp;operator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5026068">jsCtxDivOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5026080">//&nbsp;jsCtxUnknown&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;is&nbsp;ambiguous&nbsp;due&nbsp;to&nbsp;context&nbsp;joining.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5026153">jsCtxUnknown</span><br>
<span class="lineno"></span><span class="op" id="5026166">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="5026169">func</span>&nbsp;<span class="op" id="5026174">(</span><span class="ident" id="5026175">c</span>&nbsp;<span class="ident" id="5026177">jsCtx</span><span class="op" id="5026182">)</span>&nbsp;<span class="ident" id="5026184">String</span><span class="op" id="5026190">(</span><span class="op" id="5026191">)</span>&nbsp;<span class="builtintype" id="5026193">string</span>&nbsp;<span class="op" id="5026200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026203">switch</span>&nbsp;<span class="ident" id="5026210">c</span>&nbsp;<span class="op" id="5026212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026215">case</span>&nbsp;<span class="ident" id="5026220">jsCtxRegexp</span><span class="op" id="5026231">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026235">return</span>&nbsp;<span class="string" id="5026242">&#34;jsCtxRegexp&#34;</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026257">case</span>&nbsp;<span class="ident" id="5026262">jsCtxDivOp</span><span class="op" id="5026272">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026276">return</span>&nbsp;<span class="string" id="5026283">&#34;jsCtxDivOp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026297">case</span>&nbsp;<span class="ident" id="5026302">jsCtxUnknown</span><span class="op" id="5026314">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026318">return</span>&nbsp;<span class="string" id="5026325">&#34;jsCtxUnknown&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5026341">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5026344">return</span>&nbsp;<span class="ident" id="5026351">fmt</span><span class="op" id="5026354">.</span><span class="ident" id="5026355">Sprintf</span><span class="op" id="5026362">(</span><span class="string" id="5026363">&#34;illegal&nbsp;jsCtx&nbsp;%d&#34;</span><span class="op" id="5026381">,</span>&nbsp;<span class="builtintype" id="5026383">int</span><span class="op" id="5026386">(</span><span class="ident" id="5026387">c</span><span class="op" id="5026388">)</span><span class="op" id="5026389">)</span><br>
<span class="lineno"></span><span class="op" id="5026391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5026394">//&nbsp;element&nbsp;identifies&nbsp;the&nbsp;HTML&nbsp;element&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag&nbsp;or&nbsp;special&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="5026474">//&nbsp;Certain&nbsp;HTML&nbsp;element&nbsp;(for&nbsp;example&nbsp;&lt;script&gt;&nbsp;and&nbsp;&lt;style&gt;)&nbsp;have&nbsp;bodies&nbsp;that&nbsp;are</span><br>
<span class="lineno">280</span><span class="comment" id="5026554">//&nbsp;treated&nbsp;differently&nbsp;from&nbsp;stateText&nbsp;so&nbsp;the&nbsp;element&nbsp;type&nbsp;is&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5026628">//&nbsp;transition&nbsp;into&nbsp;the&nbsp;correct&nbsp;context&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag&nbsp;and&nbsp;to&nbsp;identify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5026707">//&nbsp;end&nbsp;delimiter&nbsp;for&nbsp;the&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5026738">type</span>&nbsp;<span class="ident" id="5026743">element</span>&nbsp;<span class="builtintype" id="5026751">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="5026758">const</span>&nbsp;<span class="op" id="5026764">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5026767">//&nbsp;elementNone&nbsp;occurs&nbsp;outside&nbsp;a&nbsp;special&nbsp;tag&nbsp;or&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5026837">elementNone</span>&nbsp;<span class="ident" id="5026849">element</span>&nbsp;<span class="op" id="5026857">=</span>&nbsp;<span class="ident" id="5026859">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5026865">//&nbsp;elementScript&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;script&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5026929">elementScript</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5026944">//&nbsp;elementStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;style&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027006">elementStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5027020">//&nbsp;elementTextarea&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;textarea&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027086">elementTextarea</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5027103">//&nbsp;elementTitle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;title&gt;&nbsp;element.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027163">elementTitle</span><br>
<span class="lineno"></span><span class="op" id="5027176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5027179">var</span>&nbsp;<span class="ident" id="5027183">elementNames</span>&nbsp;<span class="op" id="5027196">=</span>&nbsp;<span class="op" id="5027198">[</span><span class="op" id="5027199">...</span><span class="op" id="5027202">]</span><span class="builtintype" id="5027203">string</span><span class="op" id="5027209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027212">elementNone</span><span class="op" id="5027223">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5027229">&#34;elementNone&#34;</span><span class="op" id="5027242">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027245">elementScript</span><span class="op" id="5027258">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5027262">&#34;elementScript&#34;</span><span class="op" id="5027277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027280">elementStyle</span><span class="op" id="5027292">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5027297">&#34;elementStyle&#34;</span><span class="op" id="5027311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027314">elementTextarea</span><span class="op" id="5027329">:</span>&nbsp;<span class="string" id="5027331">&#34;elementTextarea&#34;</span><span class="op" id="5027348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027351">elementTitle</span><span class="op" id="5027363">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5027368">&#34;elementTitle&#34;</span><span class="op" id="5027382">,</span><br>
<span class="lineno"></span><span class="op" id="5027384">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="5027387">func</span>&nbsp;<span class="op" id="5027392">(</span><span class="ident" id="5027393">e</span>&nbsp;<span class="ident" id="5027395">element</span><span class="op" id="5027402">)</span>&nbsp;<span class="ident" id="5027404">String</span><span class="op" id="5027410">(</span><span class="op" id="5027411">)</span>&nbsp;<span class="builtintype" id="5027413">string</span>&nbsp;<span class="op" id="5027420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027423">if</span>&nbsp;<span class="builtintype" id="5027426">int</span><span class="op" id="5027429">(</span><span class="ident" id="5027430">e</span><span class="op" id="5027431">)</span>&nbsp;<span class="op" id="5027433">&lt;</span>&nbsp;<span class="builtinfunc" id="5027435">len</span><span class="op" id="5027438">(</span><span class="ident" id="5027439">elementNames</span><span class="op" id="5027451">)</span>&nbsp;<span class="op" id="5027453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027457">return</span>&nbsp;<span class="ident" id="5027464">elementNames</span><span class="op" id="5027476">[</span><span class="ident" id="5027477">e</span><span class="op" id="5027478">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5027481">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5027484">return</span>&nbsp;<span class="ident" id="5027491">fmt</span><span class="op" id="5027494">.</span><span class="ident" id="5027495">Sprintf</span><span class="op" id="5027502">(</span><span class="string" id="5027503">&#34;illegal&nbsp;element&nbsp;%d&#34;</span><span class="op" id="5027523">,</span>&nbsp;<span class="builtintype" id="5027525">int</span><span class="op" id="5027528">(</span><span class="ident" id="5027529">e</span><span class="op" id="5027530">)</span><span class="op" id="5027531">)</span><br>
<span class="lineno"></span><span class="op" id="5027533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5027536">//&nbsp;attr&nbsp;identifies&nbsp;the&nbsp;most&nbsp;recent&nbsp;HTML&nbsp;attribute&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="5027611">type</span>&nbsp;<span class="ident" id="5027616">attr</span>&nbsp;<span class="builtintype" id="5027621">uint8</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="5027628">const</span>&nbsp;<span class="op" id="5027634">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5027637">//&nbsp;attrNone&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;normal&nbsp;attribute&nbsp;or&nbsp;no&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027701">attrNone</span>&nbsp;<span class="ident" id="5027710">attr</span>&nbsp;<span class="op" id="5027715">=</span>&nbsp;<span class="ident" id="5027717">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5027723">//&nbsp;attrScript&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;event&nbsp;handler&nbsp;attribute.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027781">attrScript</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5027793">//&nbsp;attrStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;style&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;CSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027862">attrStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5027873">//&nbsp;attrURL&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027935">attrURL</span><br>
<span class="lineno">325</span><span class="op" id="5027943">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5027946">var</span>&nbsp;<span class="ident" id="5027950">attrNames</span>&nbsp;<span class="op" id="5027960">=</span>&nbsp;<span class="op" id="5027962">[</span><span class="op" id="5027963">...</span><span class="op" id="5027966">]</span><span class="builtintype" id="5027967">string</span><span class="op" id="5027973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5027976">attrNone</span><span class="op" id="5027984">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5027988">&#34;attrNone&#34;</span><span class="op" id="5027998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5028001">attrScript</span><span class="op" id="5028011">:</span>&nbsp;<span class="string" id="5028013">&#34;attrScript&#34;</span><span class="op" id="5028025">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5028028">attrStyle</span><span class="op" id="5028037">:</span>&nbsp;&nbsp;<span class="string" id="5028040">&#34;attrStyle&#34;</span><span class="op" id="5028051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5028054">attrURL</span><span class="op" id="5028061">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5028066">&#34;attrURL&#34;</span><span class="op" id="5028075">,</span><br>
<span class="lineno"></span><span class="op" id="5028077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5028080">func</span>&nbsp;<span class="op" id="5028085">(</span><span class="ident" id="5028086">a</span>&nbsp;<span class="ident" id="5028088">attr</span><span class="op" id="5028092">)</span>&nbsp;<span class="ident" id="5028094">String</span><span class="op" id="5028100">(</span><span class="op" id="5028101">)</span>&nbsp;<span class="builtintype" id="5028103">string</span>&nbsp;<span class="op" id="5028110">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028113">if</span>&nbsp;<span class="builtintype" id="5028116">int</span><span class="op" id="5028119">(</span><span class="ident" id="5028120">a</span><span class="op" id="5028121">)</span>&nbsp;<span class="op" id="5028123">&lt;</span>&nbsp;<span class="builtinfunc" id="5028125">len</span><span class="op" id="5028128">(</span><span class="ident" id="5028129">attrNames</span><span class="op" id="5028138">)</span>&nbsp;<span class="op" id="5028140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028144">return</span>&nbsp;<span class="ident" id="5028151">attrNames</span><span class="op" id="5028160">[</span><span class="ident" id="5028161">a</span><span class="op" id="5028162">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5028165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5028168">return</span>&nbsp;<span class="ident" id="5028175">fmt</span><span class="op" id="5028178">.</span><span class="ident" id="5028179">Sprintf</span><span class="op" id="5028186">(</span><span class="string" id="5028187">&#34;illegal&nbsp;attr&nbsp;%d&#34;</span><span class="op" id="5028204">,</span>&nbsp;<span class="builtintype" id="5028206">int</span><span class="op" id="5028209">(</span><span class="ident" id="5028210">a</span><span class="op" id="5028211">)</span><span class="op" id="5028212">)</span><br>
<span class="lineno"></span><span class="op" id="5028214">}</span>
</div>
</body>
</html>
