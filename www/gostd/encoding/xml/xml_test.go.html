<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7470484">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7470540">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7470594">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7470645">package</span>&nbsp;<span class="ident" id="7470653">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7470658">import</span>&nbsp;<span class="op" id="7470665">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7470668">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7470677">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7470684">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7470690">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7470701">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7470712">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7470723">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7470738">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7470741">const</span>&nbsp;<span class="ident" id="7470747">testInput</span>&nbsp;<span class="op" id="7470757">=</span>&nbsp;<span class="string" id="7470759">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="7470976">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7470979">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="7470988">+</span>&nbsp;<span class="string" id="7470990">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7471280">var</span>&nbsp;<span class="ident" id="7471284">testEntity</span>&nbsp;<span class="op" id="7471295">=</span>&nbsp;<span class="keyword" id="7471297">map</span><span class="op" id="7471300">[</span><span class="builtintype" id="7471301">string</span><span class="op" id="7471307">]</span><span class="builtintype" id="7471308">string</span><span class="op" id="7471314">{</span><span class="string" id="7471315">&#34;何&#34;</span><span class="op" id="7471320">:</span>&nbsp;<span class="string" id="7471322">&#34;What&#34;</span><span class="op" id="7471328">,</span>&nbsp;<span class="string" id="7471330">&#34;is-it&#34;</span><span class="op" id="7471337">:</span>&nbsp;<span class="string" id="7471339">&#34;is&nbsp;it?&#34;</span><span class="op" id="7471347">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="7471350">var</span>&nbsp;<span class="ident" id="7471354">rawTokens</span>&nbsp;<span class="op" id="7471364">=</span>&nbsp;<span class="op" id="7471366">[</span><span class="op" id="7471367">]</span><span class="ident" id="7471368">Token</span><span class="op" id="7471373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471376">CharData</span><span class="op" id="7471384">(</span><span class="string" id="7471385">&#34;\n&#34;</span><span class="op" id="7471389">)</span><span class="op" id="7471390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471393">ProcInst</span><span class="op" id="7471401">{</span><span class="string" id="7471402">&#34;xml&#34;</span><span class="op" id="7471407">,</span>&nbsp;<span class="op" id="7471409">[</span><span class="op" id="7471410">]</span><span class="builtintype" id="7471411">byte</span><span class="op" id="7471415">(</span><span class="string" id="7471416">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="7471448">)</span><span class="op" id="7471449">}</span><span class="op" id="7471450">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471453">CharData</span><span class="op" id="7471461">(</span><span class="string" id="7471462">&#34;\n&#34;</span><span class="op" id="7471466">)</span><span class="op" id="7471467">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471470">Directive</span><span class="op" id="7471479">(</span><span class="string" id="7471480">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="7471602">)</span><span class="op" id="7471603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471606">CharData</span><span class="op" id="7471614">(</span><span class="string" id="7471615">&#34;\n&#34;</span><span class="op" id="7471619">)</span><span class="op" id="7471620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471623">StartElement</span><span class="op" id="7471635">{</span><span class="ident" id="7471636">Name</span><span class="op" id="7471640">{</span><span class="string" id="7471641">&#34;&#34;</span><span class="op" id="7471643">,</span>&nbsp;<span class="string" id="7471645">&#34;body&#34;</span><span class="op" id="7471651">}</span><span class="op" id="7471652">,</span>&nbsp;<span class="op" id="7471654">[</span><span class="op" id="7471655">]</span><span class="ident" id="7471656">Attr</span><span class="op" id="7471660">{</span><span class="op" id="7471661">{</span><span class="ident" id="7471662">Name</span><span class="op" id="7471666">{</span><span class="string" id="7471667">&#34;xmlns&#34;</span><span class="op" id="7471674">,</span>&nbsp;<span class="string" id="7471676">&#34;foo&#34;</span><span class="op" id="7471681">}</span><span class="op" id="7471682">,</span>&nbsp;<span class="string" id="7471684">&#34;ns1&#34;</span><span class="op" id="7471689">}</span><span class="op" id="7471690">,</span>&nbsp;<span class="op" id="7471692">{</span><span class="ident" id="7471693">Name</span><span class="op" id="7471697">{</span><span class="string" id="7471698">&#34;&#34;</span><span class="op" id="7471700">,</span>&nbsp;<span class="string" id="7471702">&#34;xmlns&#34;</span><span class="op" id="7471709">}</span><span class="op" id="7471710">,</span>&nbsp;<span class="string" id="7471712">&#34;ns2&#34;</span><span class="op" id="7471717">}</span><span class="op" id="7471718">,</span>&nbsp;<span class="op" id="7471720">{</span><span class="ident" id="7471721">Name</span><span class="op" id="7471725">{</span><span class="string" id="7471726">&#34;xmlns&#34;</span><span class="op" id="7471733">,</span>&nbsp;<span class="string" id="7471735">&#34;tag&#34;</span><span class="op" id="7471740">}</span><span class="op" id="7471741">,</span>&nbsp;<span class="string" id="7471743">&#34;ns3&#34;</span><span class="op" id="7471748">}</span><span class="op" id="7471749">}</span><span class="op" id="7471750">}</span><span class="op" id="7471751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471754">CharData</span><span class="op" id="7471762">(</span><span class="string" id="7471763">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7471769">)</span><span class="op" id="7471770">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471773">StartElement</span><span class="op" id="7471785">{</span><span class="ident" id="7471786">Name</span><span class="op" id="7471790">{</span><span class="string" id="7471791">&#34;&#34;</span><span class="op" id="7471793">,</span>&nbsp;<span class="string" id="7471795">&#34;hello&#34;</span><span class="op" id="7471802">}</span><span class="op" id="7471803">,</span>&nbsp;<span class="op" id="7471805">[</span><span class="op" id="7471806">]</span><span class="ident" id="7471807">Attr</span><span class="op" id="7471811">{</span><span class="op" id="7471812">{</span><span class="ident" id="7471813">Name</span><span class="op" id="7471817">{</span><span class="string" id="7471818">&#34;&#34;</span><span class="op" id="7471820">,</span>&nbsp;<span class="string" id="7471822">&#34;lang&#34;</span><span class="op" id="7471828">}</span><span class="op" id="7471829">,</span>&nbsp;<span class="string" id="7471831">&#34;en&#34;</span><span class="op" id="7471835">}</span><span class="op" id="7471836">}</span><span class="op" id="7471837">}</span><span class="op" id="7471838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471841">CharData</span><span class="op" id="7471849">(</span><span class="string" id="7471850">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="7471873">)</span><span class="op" id="7471874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471877">EndElement</span><span class="op" id="7471887">{</span><span class="ident" id="7471888">Name</span><span class="op" id="7471892">{</span><span class="string" id="7471893">&#34;&#34;</span><span class="op" id="7471895">,</span>&nbsp;<span class="string" id="7471897">&#34;hello&#34;</span><span class="op" id="7471904">}</span><span class="op" id="7471905">}</span><span class="op" id="7471906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471909">CharData</span><span class="op" id="7471917">(</span><span class="string" id="7471918">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7471924">)</span><span class="op" id="7471925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471928">StartElement</span><span class="op" id="7471940">{</span><span class="ident" id="7471941">Name</span><span class="op" id="7471945">{</span><span class="string" id="7471946">&#34;&#34;</span><span class="op" id="7471948">,</span>&nbsp;<span class="string" id="7471950">&#34;query&#34;</span><span class="op" id="7471957">}</span><span class="op" id="7471958">,</span>&nbsp;<span class="op" id="7471960">[</span><span class="op" id="7471961">]</span><span class="ident" id="7471962">Attr</span><span class="op" id="7471966">{</span><span class="op" id="7471967">}</span><span class="op" id="7471968">}</span><span class="op" id="7471969">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471972">CharData</span><span class="op" id="7471980">(</span><span class="string" id="7471981">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="7471994">)</span><span class="op" id="7471995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7471998">EndElement</span><span class="op" id="7472008">{</span><span class="ident" id="7472009">Name</span><span class="op" id="7472013">{</span><span class="string" id="7472014">&#34;&#34;</span><span class="op" id="7472016">,</span>&nbsp;<span class="string" id="7472018">&#34;query&#34;</span><span class="op" id="7472025">}</span><span class="op" id="7472026">}</span><span class="op" id="7472027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472030">CharData</span><span class="op" id="7472038">(</span><span class="string" id="7472039">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7472045">)</span><span class="op" id="7472046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472049">StartElement</span><span class="op" id="7472061">{</span><span class="ident" id="7472062">Name</span><span class="op" id="7472066">{</span><span class="string" id="7472067">&#34;&#34;</span><span class="op" id="7472069">,</span>&nbsp;<span class="string" id="7472071">&#34;goodbye&#34;</span><span class="op" id="7472080">}</span><span class="op" id="7472081">,</span>&nbsp;<span class="op" id="7472083">[</span><span class="op" id="7472084">]</span><span class="ident" id="7472085">Attr</span><span class="op" id="7472089">{</span><span class="op" id="7472090">}</span><span class="op" id="7472091">}</span><span class="op" id="7472092">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472095">EndElement</span><span class="op" id="7472105">{</span><span class="ident" id="7472106">Name</span><span class="op" id="7472110">{</span><span class="string" id="7472111">&#34;&#34;</span><span class="op" id="7472113">,</span>&nbsp;<span class="string" id="7472115">&#34;goodbye&#34;</span><span class="op" id="7472124">}</span><span class="op" id="7472125">}</span><span class="op" id="7472126">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472129">CharData</span><span class="op" id="7472137">(</span><span class="string" id="7472138">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7472144">)</span><span class="op" id="7472145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472148">StartElement</span><span class="op" id="7472160">{</span><span class="ident" id="7472161">Name</span><span class="op" id="7472165">{</span><span class="string" id="7472166">&#34;&#34;</span><span class="op" id="7472168">,</span>&nbsp;<span class="string" id="7472170">&#34;outer&#34;</span><span class="op" id="7472177">}</span><span class="op" id="7472178">,</span>&nbsp;<span class="op" id="7472180">[</span><span class="op" id="7472181">]</span><span class="ident" id="7472182">Attr</span><span class="op" id="7472186">{</span><span class="op" id="7472187">{</span><span class="ident" id="7472188">Name</span><span class="op" id="7472192">{</span><span class="string" id="7472193">&#34;foo&#34;</span><span class="op" id="7472198">,</span>&nbsp;<span class="string" id="7472200">&#34;attr&#34;</span><span class="op" id="7472206">}</span><span class="op" id="7472207">,</span>&nbsp;<span class="string" id="7472209">&#34;value&#34;</span><span class="op" id="7472216">}</span><span class="op" id="7472217">,</span>&nbsp;<span class="op" id="7472219">{</span><span class="ident" id="7472220">Name</span><span class="op" id="7472224">{</span><span class="string" id="7472225">&#34;xmlns&#34;</span><span class="op" id="7472232">,</span>&nbsp;<span class="string" id="7472234">&#34;tag&#34;</span><span class="op" id="7472239">}</span><span class="op" id="7472240">,</span>&nbsp;<span class="string" id="7472242">&#34;ns4&#34;</span><span class="op" id="7472247">}</span><span class="op" id="7472248">}</span><span class="op" id="7472249">}</span><span class="op" id="7472250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472253">CharData</span><span class="op" id="7472261">(</span><span class="string" id="7472262">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7472270">)</span><span class="op" id="7472271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472274">StartElement</span><span class="op" id="7472286">{</span><span class="ident" id="7472287">Name</span><span class="op" id="7472291">{</span><span class="string" id="7472292">&#34;&#34;</span><span class="op" id="7472294">,</span>&nbsp;<span class="string" id="7472296">&#34;inner&#34;</span><span class="op" id="7472303">}</span><span class="op" id="7472304">,</span>&nbsp;<span class="op" id="7472306">[</span><span class="op" id="7472307">]</span><span class="ident" id="7472308">Attr</span><span class="op" id="7472312">{</span><span class="op" id="7472313">}</span><span class="op" id="7472314">}</span><span class="op" id="7472315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472318">EndElement</span><span class="op" id="7472328">{</span><span class="ident" id="7472329">Name</span><span class="op" id="7472333">{</span><span class="string" id="7472334">&#34;&#34;</span><span class="op" id="7472336">,</span>&nbsp;<span class="string" id="7472338">&#34;inner&#34;</span><span class="op" id="7472345">}</span><span class="op" id="7472346">}</span><span class="op" id="7472347">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472350">CharData</span><span class="op" id="7472358">(</span><span class="string" id="7472359">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7472365">)</span><span class="op" id="7472366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472369">EndElement</span><span class="op" id="7472379">{</span><span class="ident" id="7472380">Name</span><span class="op" id="7472384">{</span><span class="string" id="7472385">&#34;&#34;</span><span class="op" id="7472387">,</span>&nbsp;<span class="string" id="7472389">&#34;outer&#34;</span><span class="op" id="7472396">}</span><span class="op" id="7472397">}</span><span class="op" id="7472398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472401">CharData</span><span class="op" id="7472409">(</span><span class="string" id="7472410">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7472416">)</span><span class="op" id="7472417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472420">StartElement</span><span class="op" id="7472432">{</span><span class="ident" id="7472433">Name</span><span class="op" id="7472437">{</span><span class="string" id="7472438">&#34;tag&#34;</span><span class="op" id="7472443">,</span>&nbsp;<span class="string" id="7472445">&#34;name&#34;</span><span class="op" id="7472451">}</span><span class="op" id="7472452">,</span>&nbsp;<span class="op" id="7472454">[</span><span class="op" id="7472455">]</span><span class="ident" id="7472456">Attr</span><span class="op" id="7472460">{</span><span class="op" id="7472461">}</span><span class="op" id="7472462">}</span><span class="op" id="7472463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472466">CharData</span><span class="op" id="7472474">(</span><span class="string" id="7472475">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7472483">)</span><span class="op" id="7472484">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472487">CharData</span><span class="op" id="7472495">(</span><span class="string" id="7472496">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="7472513">)</span><span class="op" id="7472514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472517">CharData</span><span class="op" id="7472525">(</span><span class="string" id="7472526">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7472532">)</span><span class="op" id="7472533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472536">EndElement</span><span class="op" id="7472546">{</span><span class="ident" id="7472547">Name</span><span class="op" id="7472551">{</span><span class="string" id="7472552">&#34;tag&#34;</span><span class="op" id="7472557">,</span>&nbsp;<span class="string" id="7472559">&#34;name&#34;</span><span class="op" id="7472565">}</span><span class="op" id="7472566">}</span><span class="op" id="7472567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472570">CharData</span><span class="op" id="7472578">(</span><span class="string" id="7472579">&#34;\n&#34;</span><span class="op" id="7472583">)</span><span class="op" id="7472584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472587">EndElement</span><span class="op" id="7472597">{</span><span class="ident" id="7472598">Name</span><span class="op" id="7472602">{</span><span class="string" id="7472603">&#34;&#34;</span><span class="op" id="7472605">,</span>&nbsp;<span class="string" id="7472607">&#34;body&#34;</span><span class="op" id="7472613">}</span><span class="op" id="7472614">}</span><span class="op" id="7472615">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472618">Comment</span><span class="op" id="7472625">(</span><span class="string" id="7472626">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="7472651">)</span><span class="op" id="7472652">,</span><br>
<span class="lineno"></span><span class="op" id="7472654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7472657">var</span>&nbsp;<span class="ident" id="7472661">cookedTokens</span>&nbsp;<span class="op" id="7472674">=</span>&nbsp;<span class="op" id="7472676">[</span><span class="op" id="7472677">]</span><span class="ident" id="7472678">Token</span><span class="op" id="7472683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472686">CharData</span><span class="op" id="7472694">(</span><span class="string" id="7472695">&#34;\n&#34;</span><span class="op" id="7472699">)</span><span class="op" id="7472700">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472703">ProcInst</span><span class="op" id="7472711">{</span><span class="string" id="7472712">&#34;xml&#34;</span><span class="op" id="7472717">,</span>&nbsp;<span class="op" id="7472719">[</span><span class="op" id="7472720">]</span><span class="builtintype" id="7472721">byte</span><span class="op" id="7472725">(</span><span class="string" id="7472726">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="7472758">)</span><span class="op" id="7472759">}</span><span class="op" id="7472760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472763">CharData</span><span class="op" id="7472771">(</span><span class="string" id="7472772">&#34;\n&#34;</span><span class="op" id="7472776">)</span><span class="op" id="7472777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472780">Directive</span><span class="op" id="7472789">(</span><span class="string" id="7472790">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="7472912">)</span><span class="op" id="7472913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472916">CharData</span><span class="op" id="7472924">(</span><span class="string" id="7472925">&#34;\n&#34;</span><span class="op" id="7472929">)</span><span class="op" id="7472930">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7472933">StartElement</span><span class="op" id="7472945">{</span><span class="ident" id="7472946">Name</span><span class="op" id="7472950">{</span><span class="string" id="7472951">&#34;ns2&#34;</span><span class="op" id="7472956">,</span>&nbsp;<span class="string" id="7472958">&#34;body&#34;</span><span class="op" id="7472964">}</span><span class="op" id="7472965">,</span>&nbsp;<span class="op" id="7472967">[</span><span class="op" id="7472968">]</span><span class="ident" id="7472969">Attr</span><span class="op" id="7472973">{</span><span class="op" id="7472974">{</span><span class="ident" id="7472975">Name</span><span class="op" id="7472979">{</span><span class="string" id="7472980">&#34;xmlns&#34;</span><span class="op" id="7472987">,</span>&nbsp;<span class="string" id="7472989">&#34;foo&#34;</span><span class="op" id="7472994">}</span><span class="op" id="7472995">,</span>&nbsp;<span class="string" id="7472997">&#34;ns1&#34;</span><span class="op" id="7473002">}</span><span class="op" id="7473003">,</span>&nbsp;<span class="op" id="7473005">{</span><span class="ident" id="7473006">Name</span><span class="op" id="7473010">{</span><span class="string" id="7473011">&#34;&#34;</span><span class="op" id="7473013">,</span>&nbsp;<span class="string" id="7473015">&#34;xmlns&#34;</span><span class="op" id="7473022">}</span><span class="op" id="7473023">,</span>&nbsp;<span class="string" id="7473025">&#34;ns2&#34;</span><span class="op" id="7473030">}</span><span class="op" id="7473031">,</span>&nbsp;<span class="op" id="7473033">{</span><span class="ident" id="7473034">Name</span><span class="op" id="7473038">{</span><span class="string" id="7473039">&#34;xmlns&#34;</span><span class="op" id="7473046">,</span>&nbsp;<span class="string" id="7473048">&#34;tag&#34;</span><span class="op" id="7473053">}</span><span class="op" id="7473054">,</span>&nbsp;<span class="string" id="7473056">&#34;ns3&#34;</span><span class="op" id="7473061">}</span><span class="op" id="7473062">}</span><span class="op" id="7473063">}</span><span class="op" id="7473064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473067">CharData</span><span class="op" id="7473075">(</span><span class="string" id="7473076">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7473082">)</span><span class="op" id="7473083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473086">StartElement</span><span class="op" id="7473098">{</span><span class="ident" id="7473099">Name</span><span class="op" id="7473103">{</span><span class="string" id="7473104">&#34;ns2&#34;</span><span class="op" id="7473109">,</span>&nbsp;<span class="string" id="7473111">&#34;hello&#34;</span><span class="op" id="7473118">}</span><span class="op" id="7473119">,</span>&nbsp;<span class="op" id="7473121">[</span><span class="op" id="7473122">]</span><span class="ident" id="7473123">Attr</span><span class="op" id="7473127">{</span><span class="op" id="7473128">{</span><span class="ident" id="7473129">Name</span><span class="op" id="7473133">{</span><span class="string" id="7473134">&#34;&#34;</span><span class="op" id="7473136">,</span>&nbsp;<span class="string" id="7473138">&#34;lang&#34;</span><span class="op" id="7473144">}</span><span class="op" id="7473145">,</span>&nbsp;<span class="string" id="7473147">&#34;en&#34;</span><span class="op" id="7473151">}</span><span class="op" id="7473152">}</span><span class="op" id="7473153">}</span><span class="op" id="7473154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473157">CharData</span><span class="op" id="7473165">(</span><span class="string" id="7473166">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="7473189">)</span><span class="op" id="7473190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473193">EndElement</span><span class="op" id="7473203">{</span><span class="ident" id="7473204">Name</span><span class="op" id="7473208">{</span><span class="string" id="7473209">&#34;ns2&#34;</span><span class="op" id="7473214">,</span>&nbsp;<span class="string" id="7473216">&#34;hello&#34;</span><span class="op" id="7473223">}</span><span class="op" id="7473224">}</span><span class="op" id="7473225">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473228">CharData</span><span class="op" id="7473236">(</span><span class="string" id="7473237">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7473243">)</span><span class="op" id="7473244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473247">StartElement</span><span class="op" id="7473259">{</span><span class="ident" id="7473260">Name</span><span class="op" id="7473264">{</span><span class="string" id="7473265">&#34;ns2&#34;</span><span class="op" id="7473270">,</span>&nbsp;<span class="string" id="7473272">&#34;query&#34;</span><span class="op" id="7473279">}</span><span class="op" id="7473280">,</span>&nbsp;<span class="op" id="7473282">[</span><span class="op" id="7473283">]</span><span class="ident" id="7473284">Attr</span><span class="op" id="7473288">{</span><span class="op" id="7473289">}</span><span class="op" id="7473290">}</span><span class="op" id="7473291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473294">CharData</span><span class="op" id="7473302">(</span><span class="string" id="7473303">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="7473316">)</span><span class="op" id="7473317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473320">EndElement</span><span class="op" id="7473330">{</span><span class="ident" id="7473331">Name</span><span class="op" id="7473335">{</span><span class="string" id="7473336">&#34;ns2&#34;</span><span class="op" id="7473341">,</span>&nbsp;<span class="string" id="7473343">&#34;query&#34;</span><span class="op" id="7473350">}</span><span class="op" id="7473351">}</span><span class="op" id="7473352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473355">CharData</span><span class="op" id="7473363">(</span><span class="string" id="7473364">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7473370">)</span><span class="op" id="7473371">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473374">StartElement</span><span class="op" id="7473386">{</span><span class="ident" id="7473387">Name</span><span class="op" id="7473391">{</span><span class="string" id="7473392">&#34;ns2&#34;</span><span class="op" id="7473397">,</span>&nbsp;<span class="string" id="7473399">&#34;goodbye&#34;</span><span class="op" id="7473408">}</span><span class="op" id="7473409">,</span>&nbsp;<span class="op" id="7473411">[</span><span class="op" id="7473412">]</span><span class="ident" id="7473413">Attr</span><span class="op" id="7473417">{</span><span class="op" id="7473418">}</span><span class="op" id="7473419">}</span><span class="op" id="7473420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473423">EndElement</span><span class="op" id="7473433">{</span><span class="ident" id="7473434">Name</span><span class="op" id="7473438">{</span><span class="string" id="7473439">&#34;ns2&#34;</span><span class="op" id="7473444">,</span>&nbsp;<span class="string" id="7473446">&#34;goodbye&#34;</span><span class="op" id="7473455">}</span><span class="op" id="7473456">}</span><span class="op" id="7473457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473460">CharData</span><span class="op" id="7473468">(</span><span class="string" id="7473469">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7473475">)</span><span class="op" id="7473476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473479">StartElement</span><span class="op" id="7473491">{</span><span class="ident" id="7473492">Name</span><span class="op" id="7473496">{</span><span class="string" id="7473497">&#34;ns2&#34;</span><span class="op" id="7473502">,</span>&nbsp;<span class="string" id="7473504">&#34;outer&#34;</span><span class="op" id="7473511">}</span><span class="op" id="7473512">,</span>&nbsp;<span class="op" id="7473514">[</span><span class="op" id="7473515">]</span><span class="ident" id="7473516">Attr</span><span class="op" id="7473520">{</span><span class="op" id="7473521">{</span><span class="ident" id="7473522">Name</span><span class="op" id="7473526">{</span><span class="string" id="7473527">&#34;ns1&#34;</span><span class="op" id="7473532">,</span>&nbsp;<span class="string" id="7473534">&#34;attr&#34;</span><span class="op" id="7473540">}</span><span class="op" id="7473541">,</span>&nbsp;<span class="string" id="7473543">&#34;value&#34;</span><span class="op" id="7473550">}</span><span class="op" id="7473551">,</span>&nbsp;<span class="op" id="7473553">{</span><span class="ident" id="7473554">Name</span><span class="op" id="7473558">{</span><span class="string" id="7473559">&#34;xmlns&#34;</span><span class="op" id="7473566">,</span>&nbsp;<span class="string" id="7473568">&#34;tag&#34;</span><span class="op" id="7473573">}</span><span class="op" id="7473574">,</span>&nbsp;<span class="string" id="7473576">&#34;ns4&#34;</span><span class="op" id="7473581">}</span><span class="op" id="7473582">}</span><span class="op" id="7473583">}</span><span class="op" id="7473584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473587">CharData</span><span class="op" id="7473595">(</span><span class="string" id="7473596">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7473604">)</span><span class="op" id="7473605">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473608">StartElement</span><span class="op" id="7473620">{</span><span class="ident" id="7473621">Name</span><span class="op" id="7473625">{</span><span class="string" id="7473626">&#34;ns2&#34;</span><span class="op" id="7473631">,</span>&nbsp;<span class="string" id="7473633">&#34;inner&#34;</span><span class="op" id="7473640">}</span><span class="op" id="7473641">,</span>&nbsp;<span class="op" id="7473643">[</span><span class="op" id="7473644">]</span><span class="ident" id="7473645">Attr</span><span class="op" id="7473649">{</span><span class="op" id="7473650">}</span><span class="op" id="7473651">}</span><span class="op" id="7473652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473655">EndElement</span><span class="op" id="7473665">{</span><span class="ident" id="7473666">Name</span><span class="op" id="7473670">{</span><span class="string" id="7473671">&#34;ns2&#34;</span><span class="op" id="7473676">,</span>&nbsp;<span class="string" id="7473678">&#34;inner&#34;</span><span class="op" id="7473685">}</span><span class="op" id="7473686">}</span><span class="op" id="7473687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473690">CharData</span><span class="op" id="7473698">(</span><span class="string" id="7473699">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7473705">)</span><span class="op" id="7473706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473709">EndElement</span><span class="op" id="7473719">{</span><span class="ident" id="7473720">Name</span><span class="op" id="7473724">{</span><span class="string" id="7473725">&#34;ns2&#34;</span><span class="op" id="7473730">,</span>&nbsp;<span class="string" id="7473732">&#34;outer&#34;</span><span class="op" id="7473739">}</span><span class="op" id="7473740">}</span><span class="op" id="7473741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473744">CharData</span><span class="op" id="7473752">(</span><span class="string" id="7473753">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7473759">)</span><span class="op" id="7473760">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473763">StartElement</span><span class="op" id="7473775">{</span><span class="ident" id="7473776">Name</span><span class="op" id="7473780">{</span><span class="string" id="7473781">&#34;ns3&#34;</span><span class="op" id="7473786">,</span>&nbsp;<span class="string" id="7473788">&#34;name&#34;</span><span class="op" id="7473794">}</span><span class="op" id="7473795">,</span>&nbsp;<span class="op" id="7473797">[</span><span class="op" id="7473798">]</span><span class="ident" id="7473799">Attr</span><span class="op" id="7473803">{</span><span class="op" id="7473804">}</span><span class="op" id="7473805">}</span><span class="op" id="7473806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473809">CharData</span><span class="op" id="7473817">(</span><span class="string" id="7473818">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7473826">)</span><span class="op" id="7473827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473830">CharData</span><span class="op" id="7473838">(</span><span class="string" id="7473839">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="7473856">)</span><span class="op" id="7473857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473860">CharData</span><span class="op" id="7473868">(</span><span class="string" id="7473869">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="7473875">)</span><span class="op" id="7473876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473879">EndElement</span><span class="op" id="7473889">{</span><span class="ident" id="7473890">Name</span><span class="op" id="7473894">{</span><span class="string" id="7473895">&#34;ns3&#34;</span><span class="op" id="7473900">,</span>&nbsp;<span class="string" id="7473902">&#34;name&#34;</span><span class="op" id="7473908">}</span><span class="op" id="7473909">}</span><span class="op" id="7473910">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473913">CharData</span><span class="op" id="7473921">(</span><span class="string" id="7473922">&#34;\n&#34;</span><span class="op" id="7473926">)</span><span class="op" id="7473927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473930">EndElement</span><span class="op" id="7473940">{</span><span class="ident" id="7473941">Name</span><span class="op" id="7473945">{</span><span class="string" id="7473946">&#34;ns2&#34;</span><span class="op" id="7473951">,</span>&nbsp;<span class="string" id="7473953">&#34;body&#34;</span><span class="op" id="7473959">}</span><span class="op" id="7473960">}</span><span class="op" id="7473961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7473964">Comment</span><span class="op" id="7473971">(</span><span class="string" id="7473972">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="7473997">)</span><span class="op" id="7473998">,</span><br>
<span class="lineno"></span><span class="op" id="7474000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7474003">const</span>&nbsp;<span class="ident" id="7474009">testInputAltEncoding</span>&nbsp;<span class="op" id="7474030">=</span>&nbsp;<span class="string" id="7474032">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7474106">var</span>&nbsp;<span class="ident" id="7474110">rawTokensAltEncoding</span>&nbsp;<span class="op" id="7474131">=</span>&nbsp;<span class="op" id="7474133">[</span><span class="op" id="7474134">]</span><span class="ident" id="7474135">Token</span><span class="op" id="7474140">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474143">CharData</span><span class="op" id="7474151">(</span><span class="string" id="7474152">&#34;\n&#34;</span><span class="op" id="7474156">)</span><span class="op" id="7474157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474160">ProcInst</span><span class="op" id="7474168">{</span><span class="string" id="7474169">&#34;xml&#34;</span><span class="op" id="7474174">,</span>&nbsp;<span class="op" id="7474176">[</span><span class="op" id="7474177">]</span><span class="builtintype" id="7474178">byte</span><span class="op" id="7474182">(</span><span class="string" id="7474183">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="7474229">)</span><span class="op" id="7474230">}</span><span class="op" id="7474231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474234">CharData</span><span class="op" id="7474242">(</span><span class="string" id="7474243">&#34;\n&#34;</span><span class="op" id="7474247">)</span><span class="op" id="7474248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474251">StartElement</span><span class="op" id="7474263">{</span><span class="ident" id="7474264">Name</span><span class="op" id="7474268">{</span><span class="string" id="7474269">&#34;&#34;</span><span class="op" id="7474271">,</span>&nbsp;<span class="string" id="7474273">&#34;tag&#34;</span><span class="op" id="7474278">}</span><span class="op" id="7474279">,</span>&nbsp;<span class="op" id="7474281">[</span><span class="op" id="7474282">]</span><span class="ident" id="7474283">Attr</span><span class="op" id="7474287">{</span><span class="op" id="7474288">}</span><span class="op" id="7474289">}</span><span class="op" id="7474290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474293">CharData</span><span class="op" id="7474301">(</span><span class="string" id="7474302">&#34;value&#34;</span><span class="op" id="7474309">)</span><span class="op" id="7474310">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474313">EndElement</span><span class="op" id="7474323">{</span><span class="ident" id="7474324">Name</span><span class="op" id="7474328">{</span><span class="string" id="7474329">&#34;&#34;</span><span class="op" id="7474331">,</span>&nbsp;<span class="string" id="7474333">&#34;tag&#34;</span><span class="op" id="7474338">}</span><span class="op" id="7474339">}</span><span class="op" id="7474340">,</span><br>
<span class="lineno"></span><span class="op" id="7474342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7474345">var</span>&nbsp;<span class="ident" id="7474349">xmlInput</span>&nbsp;<span class="op" id="7474358">=</span>&nbsp;<span class="op" id="7474360">[</span><span class="op" id="7474361">]</span><span class="builtintype" id="7474362">string</span><span class="op" id="7474368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7474371">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474396">&#34;&lt;&#34;</span><span class="op" id="7474399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474402">&#34;&lt;t&#34;</span><span class="op" id="7474406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474409">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="7474414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474417">&#34;&lt;t/&#34;</span><span class="op" id="7474422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474425">&#34;&lt;!&#34;</span><span class="op" id="7474429">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474432">&#34;&lt;!-&#34;</span><span class="op" id="7474437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474440">&#34;&lt;!--&#34;</span><span class="op" id="7474446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474449">&#34;&lt;!--c-&#34;</span><span class="op" id="7474457">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474460">&#34;&lt;!--c--&#34;</span><span class="op" id="7474469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474472">&#34;&lt;!d&#34;</span><span class="op" id="7474477">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474480">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="7474487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474490">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="7474498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474501">&#34;&lt;?&#34;</span><span class="op" id="7474505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474508">&#34;&lt;?p&#34;</span><span class="op" id="7474513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474516">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="7474522">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474525">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="7474532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474535">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="7474543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474546">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="7474555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474558">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="7474567">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474570">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="7474580">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474583">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="7474599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474602">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="7474619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474622">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="7474640">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7474644">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474668">&#34;&lt;&gt;&#34;</span><span class="op" id="7474672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474675">&#34;&lt;t/a&#34;</span><span class="op" id="7474681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474684">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="7474691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474694">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="7474701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7474704">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474750">&#34;&lt;/0&gt;&#34;</span><span class="op" id="7474756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474759">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="7474769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474772">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="7474783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474786">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="7474797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474800">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="7474816">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474819">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="7474826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474829">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="7474837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474840">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="7474849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7474852">//&nbsp;&nbsp;&nbsp;&nbsp&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474906">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="7474915">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474918">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="7474926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474929">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="7474938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7474941">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="7474958">,</span><br>
<span class="lineno"></span><span class="op" id="7474960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="7474963">func</span>&nbsp;<span class="ident" id="7474968">TestRawToken</span><span class="op" id="7474980">(</span><span class="ident" id="7474981">t</span>&nbsp;<span class="op" id="7474983">*</span><span class="ident" id="7474984">testing</span><span class="op" id="7474991">.</span><span class="ident" id="7474992">T</span><span class="op" id="7474993">)</span>&nbsp;<span class="op" id="7474995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7474998">d</span>&nbsp;<span class="op" id="7475000">:=</span>&nbsp;<span class="ident" id="7475003">NewDecoder</span><span class="op" id="7475013">(</span><span class="ident" id="7475014">strings</span><span class="op" id="7475021">.</span><span class="ident" id="7475022">NewReader</span><span class="op" id="7475031">(</span><span class="ident" id="7475032">testInput</span><span class="op" id="7475041">)</span><span class="op" id="7475042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475045">d</span><span class="op" id="7475046">.</span><span class="ident" id="7475047">Entity</span>&nbsp;<span class="op" id="7475054">=</span>&nbsp;<span class="ident" id="7475056">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475068">testRawToken</span><span class="op" id="7475080">(</span><span class="ident" id="7475081">t</span><span class="op" id="7475082">,</span>&nbsp;<span class="ident" id="7475084">d</span><span class="op" id="7475085">,</span>&nbsp;<span class="ident" id="7475087">testInput</span><span class="op" id="7475096">,</span>&nbsp;<span class="ident" id="7475098">rawTokens</span><span class="op" id="7475107">)</span><br>
<span class="lineno"></span><span class="op" id="7475109">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7475112">const</span>&nbsp;<span class="ident" id="7475118">nonStrictInput</span>&nbsp;<span class="op" id="7475133">=</span>&nbsp;<span class="string" id="7475135">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7475297">var</span>&nbsp;<span class="ident" id="7475301">nonStringEntity</span>&nbsp;<span class="op" id="7475317">=</span>&nbsp;<span class="keyword" id="7475319">map</span><span class="op" id="7475322">[</span><span class="builtintype" id="7475323">string</span><span class="op" id="7475329">]</span><span class="builtintype" id="7475330">string</span><span class="op" id="7475336">{</span><span class="string" id="7475337">&#34;&#34;</span><span class="op" id="7475339">:</span>&nbsp;<span class="string" id="7475341">&#34;oops!&#34;</span><span class="op" id="7475348">,</span>&nbsp;<span class="string" id="7475350">&#34;0a&#34;</span><span class="op" id="7475354">:</span>&nbsp;<span class="string" id="7475356">&#34;oops!&#34;</span><span class="op" id="7475363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7475366">var</span>&nbsp;<span class="ident" id="7475370">nonStrictTokens</span>&nbsp;<span class="op" id="7475386">=</span>&nbsp;<span class="op" id="7475388">[</span><span class="op" id="7475389">]</span><span class="ident" id="7475390">Token</span><span class="op" id="7475395">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475398">CharData</span><span class="op" id="7475406">(</span><span class="string" id="7475407">&#34;\n&#34;</span><span class="op" id="7475411">)</span><span class="op" id="7475412">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475415">StartElement</span><span class="op" id="7475427">{</span><span class="ident" id="7475428">Name</span><span class="op" id="7475432">{</span><span class="string" id="7475433">&#34;&#34;</span><span class="op" id="7475435">,</span>&nbsp;<span class="string" id="7475437">&#34;tag&#34;</span><span class="op" id="7475442">}</span><span class="op" id="7475443">,</span>&nbsp;<span class="op" id="7475445">[</span><span class="op" id="7475446">]</span><span class="ident" id="7475447">Attr</span><span class="op" id="7475451">{</span><span class="op" id="7475452">}</span><span class="op" id="7475453">}</span><span class="op" id="7475454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475457">CharData</span><span class="op" id="7475465">(</span><span class="string" id="7475466">&#34;non&amp;entity&#34;</span><span class="op" id="7475478">)</span><span class="op" id="7475479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475482">EndElement</span><span class="op" id="7475492">{</span><span class="ident" id="7475493">Name</span><span class="op" id="7475497">{</span><span class="string" id="7475498">&#34;&#34;</span><span class="op" id="7475500">,</span>&nbsp;<span class="string" id="7475502">&#34;tag&#34;</span><span class="op" id="7475507">}</span><span class="op" id="7475508">}</span><span class="op" id="7475509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475512">CharData</span><span class="op" id="7475520">(</span><span class="string" id="7475521">&#34;\n&#34;</span><span class="op" id="7475525">)</span><span class="op" id="7475526">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475529">StartElement</span><span class="op" id="7475541">{</span><span class="ident" id="7475542">Name</span><span class="op" id="7475546">{</span><span class="string" id="7475547">&#34;&#34;</span><span class="op" id="7475549">,</span>&nbsp;<span class="string" id="7475551">&#34;tag&#34;</span><span class="op" id="7475556">}</span><span class="op" id="7475557">,</span>&nbsp;<span class="op" id="7475559">[</span><span class="op" id="7475560">]</span><span class="ident" id="7475561">Attr</span><span class="op" id="7475565">{</span><span class="op" id="7475566">}</span><span class="op" id="7475567">}</span><span class="op" id="7475568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475571">CharData</span><span class="op" id="7475579">(</span><span class="string" id="7475580">&#34;&amp;unknown;entity&#34;</span><span class="op" id="7475597">)</span><span class="op" id="7475598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475601">EndElement</span><span class="op" id="7475611">{</span><span class="ident" id="7475612">Name</span><span class="op" id="7475616">{</span><span class="string" id="7475617">&#34;&#34;</span><span class="op" id="7475619">,</span>&nbsp;<span class="string" id="7475621">&#34;tag&#34;</span><span class="op" id="7475626">}</span><span class="op" id="7475627">}</span><span class="op" id="7475628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475631">CharData</span><span class="op" id="7475639">(</span><span class="string" id="7475640">&#34;\n&#34;</span><span class="op" id="7475644">)</span><span class="op" id="7475645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475648">StartElement</span><span class="op" id="7475660">{</span><span class="ident" id="7475661">Name</span><span class="op" id="7475665">{</span><span class="string" id="7475666">&#34;&#34;</span><span class="op" id="7475668">,</span>&nbsp;<span class="string" id="7475670">&#34;tag&#34;</span><span class="op" id="7475675">}</span><span class="op" id="7475676">,</span>&nbsp;<span class="op" id="7475678">[</span><span class="op" id="7475679">]</span><span class="ident" id="7475680">Attr</span><span class="op" id="7475684">{</span><span class="op" id="7475685">}</span><span class="op" id="7475686">}</span><span class="op" id="7475687">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475690">CharData</span><span class="op" id="7475698">(</span><span class="string" id="7475699">&#34;&amp;#123&#34;</span><span class="op" id="7475706">)</span><span class="op" id="7475707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475710">EndElement</span><span class="op" id="7475720">{</span><span class="ident" id="7475721">Name</span><span class="op" id="7475725">{</span><span class="string" id="7475726">&#34;&#34;</span><span class="op" id="7475728">,</span>&nbsp;<span class="string" id="7475730">&#34;tag&#34;</span><span class="op" id="7475735">}</span><span class="op" id="7475736">}</span><span class="op" id="7475737">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475740">CharData</span><span class="op" id="7475748">(</span><span class="string" id="7475749">&#34;\n&#34;</span><span class="op" id="7475753">)</span><span class="op" id="7475754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475757">StartElement</span><span class="op" id="7475769">{</span><span class="ident" id="7475770">Name</span><span class="op" id="7475774">{</span><span class="string" id="7475775">&#34;&#34;</span><span class="op" id="7475777">,</span>&nbsp;<span class="string" id="7475779">&#34;tag&#34;</span><span class="op" id="7475784">}</span><span class="op" id="7475785">,</span>&nbsp;<span class="op" id="7475787">[</span><span class="op" id="7475788">]</span><span class="ident" id="7475789">Attr</span><span class="op" id="7475793">{</span><span class="op" id="7475794">}</span><span class="op" id="7475795">}</span><span class="op" id="7475796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475799">CharData</span><span class="op" id="7475807">(</span><span class="string" id="7475808">&#34;&amp;#zzz;&#34;</span><span class="op" id="7475816">)</span><span class="op" id="7475817">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475820">EndElement</span><span class="op" id="7475830">{</span><span class="ident" id="7475831">Name</span><span class="op" id="7475835">{</span><span class="string" id="7475836">&#34;&#34;</span><span class="op" id="7475838">,</span>&nbsp;<span class="string" id="7475840">&#34;tag&#34;</span><span class="op" id="7475845">}</span><span class="op" id="7475846">}</span><span class="op" id="7475847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475850">CharData</span><span class="op" id="7475858">(</span><span class="string" id="7475859">&#34;\n&#34;</span><span class="op" id="7475863">)</span><span class="op" id="7475864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475867">StartElement</span><span class="op" id="7475879">{</span><span class="ident" id="7475880">Name</span><span class="op" id="7475884">{</span><span class="string" id="7475885">&#34;&#34;</span><span class="op" id="7475887">,</span>&nbsp;<span class="string" id="7475889">&#34;tag&#34;</span><span class="op" id="7475894">}</span><span class="op" id="7475895">,</span>&nbsp;<span class="op" id="7475897">[</span><span class="op" id="7475898">]</span><span class="ident" id="7475899">Attr</span><span class="op" id="7475903">{</span><span class="op" id="7475904">}</span><span class="op" id="7475905">}</span><span class="op" id="7475906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475909">CharData</span><span class="op" id="7475917">(</span><span class="string" id="7475918">&#34;&amp;なまえ3;&#34;</span><span class="op" id="7475932">)</span><span class="op" id="7475933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475936">EndElement</span><span class="op" id="7475946">{</span><span class="ident" id="7475947">Name</span><span class="op" id="7475951">{</span><span class="string" id="7475952">&#34;&#34;</span><span class="op" id="7475954">,</span>&nbsp;<span class="string" id="7475956">&#34;tag&#34;</span><span class="op" id="7475961">}</span><span class="op" id="7475962">}</span><span class="op" id="7475963">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475966">CharData</span><span class="op" id="7475974">(</span><span class="string" id="7475975">&#34;\n&#34;</span><span class="op" id="7475979">)</span><span class="op" id="7475980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7475983">StartElement</span><span class="op" id="7475995">{</span><span class="ident" id="7475996">Name</span><span class="op" id="7476000">{</span><span class="string" id="7476001">&#34;&#34;</span><span class="op" id="7476003">,</span>&nbsp;<span class="string" id="7476005">&#34;tag&#34;</span><span class="op" id="7476010">}</span><span class="op" id="7476011">,</span>&nbsp;<span class="op" id="7476013">[</span><span class="op" id="7476014">]</span><span class="ident" id="7476015">Attr</span><span class="op" id="7476019">{</span><span class="op" id="7476020">}</span><span class="op" id="7476021">}</span><span class="op" id="7476022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476025">CharData</span><span class="op" id="7476033">(</span><span class="string" id="7476034">&#34;&amp;lt-gt;&#34;</span><span class="op" id="7476043">)</span><span class="op" id="7476044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476047">EndElement</span><span class="op" id="7476057">{</span><span class="ident" id="7476058">Name</span><span class="op" id="7476062">{</span><span class="string" id="7476063">&#34;&#34;</span><span class="op" id="7476065">,</span>&nbsp;<span class="string" id="7476067">&#34;tag&#34;</span><span class="op" id="7476072">}</span><span class="op" id="7476073">}</span><span class="op" id="7476074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476077">CharData</span><span class="op" id="7476085">(</span><span class="string" id="7476086">&#34;\n&#34;</span><span class="op" id="7476090">)</span><span class="op" id="7476091">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476094">StartElement</span><span class="op" id="7476106">{</span><span class="ident" id="7476107">Name</span><span class="op" id="7476111">{</span><span class="string" id="7476112">&#34;&#34;</span><span class="op" id="7476114">,</span>&nbsp;<span class="string" id="7476116">&#34;tag&#34;</span><span class="op" id="7476121">}</span><span class="op" id="7476122">,</span>&nbsp;<span class="op" id="7476124">[</span><span class="op" id="7476125">]</span><span class="ident" id="7476126">Attr</span><span class="op" id="7476130">{</span><span class="op" id="7476131">}</span><span class="op" id="7476132">}</span><span class="op" id="7476133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476136">CharData</span><span class="op" id="7476144">(</span><span class="string" id="7476145">&#34;&amp;;&#34;</span><span class="op" id="7476149">)</span><span class="op" id="7476150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476153">EndElement</span><span class="op" id="7476163">{</span><span class="ident" id="7476164">Name</span><span class="op" id="7476168">{</span><span class="string" id="7476169">&#34;&#34;</span><span class="op" id="7476171">,</span>&nbsp;<span class="string" id="7476173">&#34;tag&#34;</span><span class="op" id="7476178">}</span><span class="op" id="7476179">}</span><span class="op" id="7476180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476183">CharData</span><span class="op" id="7476191">(</span><span class="string" id="7476192">&#34;\n&#34;</span><span class="op" id="7476196">)</span><span class="op" id="7476197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476200">StartElement</span><span class="op" id="7476212">{</span><span class="ident" id="7476213">Name</span><span class="op" id="7476217">{</span><span class="string" id="7476218">&#34;&#34;</span><span class="op" id="7476220">,</span>&nbsp;<span class="string" id="7476222">&#34;tag&#34;</span><span class="op" id="7476227">}</span><span class="op" id="7476228">,</span>&nbsp;<span class="op" id="7476230">[</span><span class="op" id="7476231">]</span><span class="ident" id="7476232">Attr</span><span class="op" id="7476236">{</span><span class="op" id="7476237">}</span><span class="op" id="7476238">}</span><span class="op" id="7476239">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476242">CharData</span><span class="op" id="7476250">(</span><span class="string" id="7476251">&#34;&amp;0a;&#34;</span><span class="op" id="7476257">)</span><span class="op" id="7476258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476261">EndElement</span><span class="op" id="7476271">{</span><span class="ident" id="7476272">Name</span><span class="op" id="7476276">{</span><span class="string" id="7476277">&#34;&#34;</span><span class="op" id="7476279">,</span>&nbsp;<span class="string" id="7476281">&#34;tag&#34;</span><span class="op" id="7476286">}</span><span class="op" id="7476287">}</span><span class="op" id="7476288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476291">CharData</span><span class="op" id="7476299">(</span><span class="string" id="7476300">&#34;\n&#34;</span><span class="op" id="7476304">)</span><span class="op" id="7476305">,</span><br>
<span class="lineno"></span><span class="op" id="7476307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="7476310">func</span>&nbsp;<span class="ident" id="7476315">TestNonStrictRawToken</span><span class="op" id="7476336">(</span><span class="ident" id="7476337">t</span>&nbsp;<span class="op" id="7476339">*</span><span class="ident" id="7476340">testing</span><span class="op" id="7476347">.</span><span class="ident" id="7476348">T</span><span class="op" id="7476349">)</span>&nbsp;<span class="op" id="7476351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476354">d</span>&nbsp;<span class="op" id="7476356">:=</span>&nbsp;<span class="ident" id="7476359">NewDecoder</span><span class="op" id="7476369">(</span><span class="ident" id="7476370">strings</span><span class="op" id="7476377">.</span><span class="ident" id="7476378">NewReader</span><span class="op" id="7476387">(</span><span class="ident" id="7476388">nonStrictInput</span><span class="op" id="7476402">)</span><span class="op" id="7476403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476406">d</span><span class="op" id="7476407">.</span><span class="ident" id="7476408">Strict</span>&nbsp;<span class="op" id="7476415">=</span>&nbsp;<span class="builtintype" id="7476417">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476424">testRawToken</span><span class="op" id="7476436">(</span><span class="ident" id="7476437">t</span><span class="op" id="7476438">,</span>&nbsp;<span class="ident" id="7476440">d</span><span class="op" id="7476441">,</span>&nbsp;<span class="ident" id="7476443">nonStrictInput</span><span class="op" id="7476457">,</span>&nbsp;<span class="ident" id="7476459">nonStrictTokens</span><span class="op" id="7476474">)</span><br>
<span class="lineno"></span><span class="op" id="7476476">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="7476479">type</span>&nbsp;<span class="ident" id="7476484">downCaser</span>&nbsp;<span class="keyword" id="7476494">struct</span>&nbsp;<span class="op" id="7476501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476504">t</span>&nbsp;<span class="op" id="7476506">*</span><span class="ident" id="7476507">testing</span><span class="op" id="7476514">.</span><span class="ident" id="7476515">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476518">r</span>&nbsp;<span class="ident" id="7476520">io</span><span class="op" id="7476522">.</span><span class="ident" id="7476523">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="7476534">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="7476537">func</span>&nbsp;<span class="op" id="7476542">(</span><span class="ident" id="7476543">d</span>&nbsp;<span class="op" id="7476545">*</span><span class="ident" id="7476546">downCaser</span><span class="op" id="7476555">)</span>&nbsp;<span class="ident" id="7476557">ReadByte</span><span class="op" id="7476565">(</span><span class="op" id="7476566">)</span>&nbsp;<span class="op" id="7476568">(</span><span class="ident" id="7476569">c</span>&nbsp;<span class="builtintype" id="7476571">byte</span><span class="op" id="7476575">,</span>&nbsp;<span class="ident" id="7476577">err</span>&nbsp;<span class="builtintype" id="7476581">error</span><span class="op" id="7476586">)</span>&nbsp;<span class="op" id="7476588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476591">c</span><span class="op" id="7476592">,</span>&nbsp;<span class="ident" id="7476594">err</span>&nbsp;<span class="op" id="7476598">=</span>&nbsp;<span class="ident" id="7476600">d</span><span class="op" id="7476601">.</span><span class="ident" id="7476602">r</span><span class="op" id="7476603">.</span><span class="ident" id="7476604">ReadByte</span><span class="op" id="7476612">(</span><span class="op" id="7476613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7476616">if</span>&nbsp;<span class="ident" id="7476619">c</span>&nbsp;<span class="op" id="7476621">&gt;=</span>&nbsp;<span class="string" id="7476624">&#39;A&#39;</span>&nbsp;<span class="op" id="7476628">&amp;&amp;</span>&nbsp;<span class="ident" id="7476631">c</span>&nbsp;<span class="op" id="7476633">&lt;=</span>&nbsp;<span class="string" id="7476636">&#39;Z&#39;</span>&nbsp;<span class="op" id="7476640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476644">c</span>&nbsp;<span class="op" id="7476646">+=</span>&nbsp;<span class="string" id="7476649">&#39;a&#39;</span>&nbsp;<span class="op" id="7476653">-</span>&nbsp;<span class="string" id="7476655">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7476660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7476663">return</span><br>
<span class="lineno"></span><span class="op" id="7476670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7476673">func</span>&nbsp;<span class="op" id="7476678">(</span><span class="ident" id="7476679">d</span>&nbsp;<span class="op" id="7476681">*</span><span class="ident" id="7476682">downCaser</span><span class="op" id="7476691">)</span>&nbsp;<span class="ident" id="7476693">Read</span><span class="op" id="7476697">(</span><span class="ident" id="7476698">p</span>&nbsp;<span class="op" id="7476700">[</span><span class="op" id="7476701">]</span><span class="builtintype" id="7476702">byte</span><span class="op" id="7476706">)</span>&nbsp;<span class="op" id="7476708">(</span><span class="builtintype" id="7476709">int</span><span class="op" id="7476712">,</span>&nbsp;<span class="builtintype" id="7476714">error</span><span class="op" id="7476719">)</span>&nbsp;<span class="op" id="7476721">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476724">d</span><span class="op" id="7476725">.</span><span class="ident" id="7476726">t</span><span class="op" id="7476727">.</span><span class="ident" id="7476728">Fatalf</span><span class="op" id="7476734">(</span><span class="string" id="7476735">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="7476777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7476780">panic</span><span class="op" id="7476785">(</span><span class="string" id="7476786">&#34;unreachable&#34;</span><span class="op" id="7476799">)</span><br>
<span class="lineno"></span><span class="op" id="7476801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7476804">func</span>&nbsp;<span class="ident" id="7476809">TestRawTokenAltEncoding</span><span class="op" id="7476832">(</span><span class="ident" id="7476833">t</span>&nbsp;<span class="op" id="7476835">*</span><span class="ident" id="7476836">testing</span><span class="op" id="7476843">.</span><span class="ident" id="7476844">T</span><span class="op" id="7476845">)</span>&nbsp;<span class="op" id="7476847">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476850">d</span>&nbsp;<span class="op" id="7476852">:=</span>&nbsp;<span class="ident" id="7476855">NewDecoder</span><span class="op" id="7476865">(</span><span class="ident" id="7476866">strings</span><span class="op" id="7476873">.</span><span class="ident" id="7476874">NewReader</span><span class="op" id="7476883">(</span><span class="ident" id="7476884">testInputAltEncoding</span><span class="op" id="7476904">)</span><span class="op" id="7476905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7476908">d</span><span class="op" id="7476909">.</span><span class="ident" id="7476910">CharsetReader</span>&nbsp;<span class="op" id="7476924">=</span>&nbsp;<span class="keyword" id="7476926">func</span><span class="op" id="7476930">(</span><span class="ident" id="7476931">charset</span>&nbsp;<span class="builtintype" id="7476939">string</span><span class="op" id="7476945">,</span>&nbsp;<span class="ident" id="7476947">input</span>&nbsp;<span class="ident" id="7476953">io</span><span class="op" id="7476955">.</span><span class="ident" id="7476956">Reader</span><span class="op" id="7476962">)</span>&nbsp;<span class="op" id="7476964">(</span><span class="ident" id="7476965">io</span><span class="op" id="7476967">.</span><span class="ident" id="7476968">Reader</span><span class="op" id="7476974">,</span>&nbsp;<span class="builtintype" id="7476976">error</span><span class="op" id="7476981">)</span>&nbsp;<span class="op" id="7476983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7476987">if</span>&nbsp;<span class="ident" id="7476990">charset</span>&nbsp;<span class="op" id="7476998">!=</span>&nbsp;<span class="string" id="7477001">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="7477023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477028">t</span><span class="op" id="7477029">.</span><span class="ident" id="7477030">Fatalf</span><span class="op" id="7477036">(</span><span class="string" id="7477037">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="7477060">,</span>&nbsp;<span class="ident" id="7477062">charset</span><span class="op" id="7477069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7477073">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7477077">return</span>&nbsp;<span class="op" id="7477084">&amp;</span><span class="ident" id="7477085">downCaser</span><span class="op" id="7477094">{</span><span class="ident" id="7477095">t</span><span class="op" id="7477096">,</span>&nbsp;<span class="ident" id="7477098">input</span><span class="op" id="7477103">.</span><span class="op" id="7477104">(</span><span class="ident" id="7477105">io</span><span class="op" id="7477107">.</span><span class="ident" id="7477108">ByteReader</span><span class="op" id="7477118">)</span><span class="op" id="7477119">}</span><span class="op" id="7477120">,</span>&nbsp;<span class="ident" id="7477122">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7477127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477130">testRawToken</span><span class="op" id="7477142">(</span><span class="ident" id="7477143">t</span><span class="op" id="7477144">,</span>&nbsp;<span class="ident" id="7477146">d</span><span class="op" id="7477147">,</span>&nbsp;<span class="ident" id="7477149">testInputAltEncoding</span><span class="op" id="7477169">,</span>&nbsp;<span class="ident" id="7477171">rawTokensAltEncoding</span><span class="op" id="7477191">)</span><br>
<span class="lineno"></span><span class="op" id="7477193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="7477196">func</span>&nbsp;<span class="ident" id="7477201">TestRawTokenAltEncodingNoConverter</span><span class="op" id="7477235">(</span><span class="ident" id="7477236">t</span>&nbsp;<span class="op" id="7477238">*</span><span class="ident" id="7477239">testing</span><span class="op" id="7477246">.</span><span class="ident" id="7477247">T</span><span class="op" id="7477248">)</span>&nbsp;<span class="op" id="7477250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477253">d</span>&nbsp;<span class="op" id="7477255">:=</span>&nbsp;<span class="ident" id="7477258">NewDecoder</span><span class="op" id="7477268">(</span><span class="ident" id="7477269">strings</span><span class="op" id="7477276">.</span><span class="ident" id="7477277">NewReader</span><span class="op" id="7477286">(</span><span class="ident" id="7477287">testInputAltEncoding</span><span class="op" id="7477307">)</span><span class="op" id="7477308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477311">token</span><span class="op" id="7477316">,</span>&nbsp;<span class="ident" id="7477318">err</span>&nbsp;<span class="op" id="7477322">:=</span>&nbsp;<span class="ident" id="7477325">d</span><span class="op" id="7477326">.</span><span class="ident" id="7477327">RawToken</span><span class="op" id="7477335">(</span><span class="op" id="7477336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7477339">if</span>&nbsp;<span class="ident" id="7477342">token</span>&nbsp;<span class="op" id="7477348">==</span>&nbsp;<span class="ident" id="7477351">nil</span>&nbsp;<span class="op" id="7477355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477359">t</span><span class="op" id="7477360">.</span><span class="ident" id="7477361">Fatalf</span><span class="op" id="7477367">(</span><span class="string" id="7477368">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="7477409">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7477412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7477415">if</span>&nbsp;<span class="ident" id="7477418">err</span>&nbsp;<span class="op" id="7477422">!=</span>&nbsp;<span class="ident" id="7477425">nil</span>&nbsp;<span class="op" id="7477429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477433">t</span><span class="op" id="7477434">.</span><span class="ident" id="7477435">Fatal</span><span class="op" id="7477440">(</span><span class="ident" id="7477441">err</span><span class="op" id="7477444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7477447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477450">token</span><span class="op" id="7477455">,</span>&nbsp;<span class="ident" id="7477457">err</span>&nbsp;<span class="op" id="7477461">=</span>&nbsp;<span class="ident" id="7477463">d</span><span class="op" id="7477464">.</span><span class="ident" id="7477465">RawToken</span><span class="op" id="7477473">(</span><span class="op" id="7477474">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7477477">if</span>&nbsp;<span class="ident" id="7477480">token</span>&nbsp;<span class="op" id="7477486">!=</span>&nbsp;<span class="ident" id="7477489">nil</span>&nbsp;<span class="op" id="7477493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477497">t</span><span class="op" id="7477498">.</span><span class="ident" id="7477499">Errorf</span><span class="op" id="7477505">(</span><span class="string" id="7477506">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="7477537">,</span>&nbsp;<span class="ident" id="7477539">token</span><span class="op" id="7477544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7477547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7477550">if</span>&nbsp;<span class="ident" id="7477553">err</span>&nbsp;<span class="op" id="7477557">==</span>&nbsp;<span class="ident" id="7477560">nil</span>&nbsp;<span class="op" id="7477564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477568">t</span><span class="op" id="7477569">.</span><span class="ident" id="7477570">Fatalf</span><span class="op" id="7477576">(</span><span class="string" id="7477577">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="7477620">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7477623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7477626">const</span>&nbsp;<span class="ident" id="7477632">encoding</span>&nbsp;<span class="op" id="7477641">=</span>&nbsp;<span class="string" id="7477643">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7477666">if</span>&nbsp;<span class="op" id="7477669">!</span><span class="ident" id="7477670">strings</span><span class="op" id="7477677">.</span><span class="ident" id="7477678">Contains</span><span class="op" id="7477686">(</span><span class="ident" id="7477687">err</span><span class="op" id="7477690">.</span><span class="ident" id="7477691">Error</span><span class="op" id="7477696">(</span><span class="op" id="7477697">)</span><span class="op" id="7477698">,</span>&nbsp;<span class="ident" id="7477700">encoding</span><span class="op" id="7477708">)</span>&nbsp;<span class="op" id="7477710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477714">t</span><span class="op" id="7477715">.</span><span class="ident" id="7477716">Errorf</span><span class="op" id="7477722">(</span><span class="string" id="7477723">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7477768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477773">encoding</span><span class="op" id="7477781">,</span>&nbsp;<span class="ident" id="7477783">err</span><span class="op" id="7477786">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7477789">}</span><br>
<span class="lineno"></span><span class="op" id="7477791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7477794">func</span>&nbsp;<span class="ident" id="7477799">testRawToken</span><span class="op" id="7477811">(</span><span class="ident" id="7477812">t</span>&nbsp;<span class="op" id="7477814">*</span><span class="ident" id="7477815">testing</span><span class="op" id="7477822">.</span><span class="ident" id="7477823">T</span><span class="op" id="7477824">,</span>&nbsp;<span class="ident" id="7477826">d</span>&nbsp;<span class="op" id="7477828">*</span><span class="ident" id="7477829">Decoder</span><span class="op" id="7477836">,</span>&nbsp;<span class="ident" id="7477838">raw</span>&nbsp;<span class="builtintype" id="7477842">string</span><span class="op" id="7477848">,</span>&nbsp;<span class="ident" id="7477850">rawTokens</span>&nbsp;<span class="op" id="7477860">[</span><span class="op" id="7477861">]</span><span class="ident" id="7477862">Token</span><span class="op" id="7477867">)</span>&nbsp;<span class="op" id="7477869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477872">lastEnd</span>&nbsp;<span class="op" id="7477880">:=</span>&nbsp;<span class="ident" id="7477883">int64</span><span class="op" id="7477888">(</span><span class="num" id="7477889">0</span><span class="op" id="7477890">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7477893">for</span>&nbsp;<span class="ident" id="7477897">i</span><span class="op" id="7477898">,</span>&nbsp;<span class="ident" id="7477900">want</span>&nbsp;<span class="op" id="7477905">:=</span>&nbsp;<span class="keyword" id="7477908">range</span>&nbsp;<span class="ident" id="7477914">rawTokens</span>&nbsp;<span class="op" id="7477924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477928">start</span>&nbsp;<span class="op" id="7477934">:=</span>&nbsp;<span class="ident" id="7477937">d</span><span class="op" id="7477938">.</span><span class="ident" id="7477939">InputOffset</span><span class="op" id="7477950">(</span><span class="op" id="7477951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477955">have</span><span class="op" id="7477959">,</span>&nbsp;<span class="ident" id="7477961">err</span>&nbsp;<span class="op" id="7477965">:=</span>&nbsp;<span class="ident" id="7477968">d</span><span class="op" id="7477969">.</span><span class="ident" id="7477970">RawToken</span><span class="op" id="7477978">(</span><span class="op" id="7477979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7477983">end</span>&nbsp;<span class="op" id="7477987">:=</span>&nbsp;<span class="ident" id="7477990">d</span><span class="op" id="7477991">.</span><span class="ident" id="7477992">InputOffset</span><span class="op" id="7478003">(</span><span class="op" id="7478004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7478008">if</span>&nbsp;<span class="ident" id="7478011">err</span>&nbsp;<span class="op" id="7478015">!=</span>&nbsp;<span class="ident" id="7478018">nil</span>&nbsp;<span class="op" id="7478022">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7478027">t</span><span class="op" id="7478028">.</span><span class="ident" id="7478029">Fatalf</span><span class="op" id="7478035">(</span><span class="string" id="7478036">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7478068">,</span>&nbsp;<span class="ident" id="7478070">i</span><span class="op" id="7478071">,</span>&nbsp;<span class="ident" id="7478073">err</span><span class="op" id="7478076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7478080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7478084">if</span>&nbsp;<span class="op" id="7478087">!</span><span class="ident" id="7478088">reflect</span><span class="op" id="7478095">.</span><span class="ident" id="7478096">DeepEqual</span><span class="op" id="7478105">(</span><span class="ident" id="7478106">have</span><span class="op" id="7478110">,</span>&nbsp;<span class="ident" id="7478112">want</span><span class="op" id="7478116">)</span>&nbsp;<span class="op" id="7478118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7478123">var</span>&nbsp;<span class="ident" id="7478127">shave</span><span class="op" id="7478132">,</span>&nbsp;<span class="ident" id="7478134">swant</span>&nbsp;<span class="builtintype" id="7478140">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7478150">if</span>&nbsp;<span class="ident" id="7478153">_</span><span class="op" id="7478154">,</span>&nbsp;<span class="ident" id="7478156">ok</span>&nbsp;<span class="op" id="7478159">:=</span>&nbsp;<span class="ident" id="7478162">have</span><span class="op" id="7478166">.</span><span class="op" id="7478167">(</span><span class="ident" id="7478168">CharData</span><span class="op" id="7478176">)</span><span class="op" id="7478177">;</span>&nbsp;<span class="ident" id="7478179">ok</span>&nbsp;<span class="op" id="7478182">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7478188">shave</span>&nbsp;<span class="op" id="7478194">=</span>&nbsp;<span class="ident" id="7478196">fmt</span><span class="op" id="7478199">.</span><span class="ident" id="7478200">Sprintf</span><span class="op" id="7478207">(</span><span class="string" id="7478208">&#34;CharData(%q)&#34;</span><span class="op" id="7478222">,</span>&nbsp;<span class="ident" id="7478224">have</span><span class="op" id="7478228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7478233">}</span>&nbsp;<span class="keyword" id="7478235">else</span>&nbsp;<span class="op" id="7478240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7478246">shave</span>&nbsp;<span class="op" id="7478252">=</span>&nbsp;<span class="ident" id="7478254">fmt</span><span class="op" id="7478257">.</span><span class="ident" id="7478258">Sprintf</span><span class="op" id="7478265">(</span><span class="string" id="7478266">&#34;%#v&#34;</span><span class="op" id="7478271">,</span>&nbsp;<span class="ident" id="7478273">have</span><span class="op" id="7478277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7478282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7478287">if</span>&nbsp;<span class="ident" id="7478290">_</span><span class="op" id="7478291">,</span>&nbsp;<span class="ident" id="7478293">ok</span>&nbsp;<span class="op" id="7478296">:=</span>&nbsp;<span class="ident" id="7478299">want</span><span class="op" id="7478303">.</span><span class="op" id="7478304">(</span><span class="ident" id="7478305">CharData</span><span class="op" id="7478313">)</span><span class="op" id="7478314">;</span>&nbsp;<span class="ident" id="7478316">ok</span>&nbsp;<span class="op" id="7478319">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7478325">swant</span>&nbsp;<span class="op" id="7478331">=</span>&nbsp;<span class="ident" id="7478333">fmt</span><span class="op" id="7478336">.</span><span class="ident" id="7478337">Sprintf</span><span class="op" id="7478344">(</span><span class="string" id="7478345">&#34;CharData(%q)&#34;</span><span class="op" id="7478359">,</span>&nbsp;<span class="ident" id="7478361">want</span><span class="op" id="7478365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7478370">}</span>&nbsp;<span class="keyword" id="7478372">else</span>&nbsp;<span class="op" id="7478377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7478383">swant</span>&nbsp;<span class="op" id="7478389">=</span>&nbsp;<span class="ident" id="7478391">fmt</span><span class="op" id="7478394">.</span><span class="ident" id="7478395">Sprintf</span><span class="op" id="7478402">(</span><span class="string" id="7478403">&#34;%#v&#34;</span><span class="op" id="7478408">,</span>&nbsp;<span class="ident" id="7478410">want</span><span class="op" id="7478414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7478419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7478424">t</span><span class="op" id="7478425">.</span><span class="ident" id="7478426">Errorf</span><span class="op" id="7478432">(</span><span class="string" id="7478433">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7478457">,</span>&nbsp;<span class="ident" id="7478459">i</span><span class="op" id="7478460">,</span>&nbsp;<span class="ident" id="7478462">shave</span><span class="op" id="7478467">,</span>&nbsp;<span class="ident" id="7478469">swant</span><span class="op" id="7478474">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7478478">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7478483">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7478534">switch</span>&nbsp;<span class="op" id="7478541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7478545">case</span>&nbsp;<span class="ident" id="7478550">start</span>&nbsp;<span class="op" id="7478556">&lt;</span>&nbsp;<span class="ident" id="7478558">lastEnd</span><span class="op" id="7478565">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7478570">t</span><span class="op" id="7478571">.</span><span class="ident" id="7478572">Errorf</span><span class="op" id="7478578">(</span><span class="string" id="7478579">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="7478639">,</span>&nbsp;<span class="ident" id="7478641">i</span><span class="op" id="7478642">,</span>&nbsp;<span class="ident" id="7478644">start</span><span class="op" id="7478649">,</span>&nbsp;<span class="ident" id="7478651">end</span><span class="op" id="7478654">,</span>&nbsp;<span class="ident" id="7478656">have</span><span class="op" id="7478660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7478664">case</span>&nbsp;<span class="ident" id="7478669">start</span>&nbsp;<span class="op" id="7478675">&gt;=</span>&nbsp;<span class="ident" id="7478678">end</span><span class="op" id="7478681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7478686">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7478737">if</span>&nbsp;<span class="ident" id="7478740">start</span>&nbsp;<span class="op" id="7478746">==</span>&nbsp;<span class="ident" id="7478749">end</span>&nbsp;<span class="op" id="7478753">&amp;&amp;</span>&nbsp;<span class="ident" id="7478756">end</span>&nbsp;<span class="op" id="7478760">==</span>&nbsp;<span class="ident" id="7478763">lastEnd</span>&nbsp;<span class="op" id="7478771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7478777">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7478786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7478791">t</span><span class="op" id="7478792">.</span><span class="ident" id="7478793">Errorf</span><span class="op" id="7478799">(</span><span class="string" id="7478800">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="7478844">,</span>&nbsp;<span class="ident" id="7478846">i</span><span class="op" id="7478847">,</span>&nbsp;<span class="ident" id="7478849">start</span><span class="op" id="7478854">,</span>&nbsp;<span class="ident" id="7478856">end</span><span class="op" id="7478859">,</span>&nbsp;<span class="ident" id="7478861">have</span><span class="op" id="7478865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7478869">case</span>&nbsp;<span class="ident" id="7478874">end</span>&nbsp;<span class="op" id="7478878">&gt;</span>&nbsp;<span class="ident" id="7478880">int64</span><span class="op" id="7478885">(</span><span class="builtinfunc" id="7478886">len</span><span class="op" id="7478889">(</span><span class="ident" id="7478890">raw</span><span class="op" id="7478893">)</span><span class="op" id="7478894">)</span><span class="op" id="7478895">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7478900">t</span><span class="op" id="7478901">.</span><span class="ident" id="7478902">Errorf</span><span class="op" id="7478908">(</span><span class="string" id="7478909">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="7478965">,</span>&nbsp;<span class="ident" id="7478967">i</span><span class="op" id="7478968">,</span>&nbsp;<span class="ident" id="7478970">start</span><span class="op" id="7478975">,</span>&nbsp;<span class="ident" id="7478977">end</span><span class="op" id="7478980">,</span>&nbsp;<span class="ident" id="7478982">have</span><span class="op" id="7478986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7478990">default</span><span class="op" id="7478997">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479002">text</span>&nbsp;<span class="op" id="7479007">:=</span>&nbsp;<span class="ident" id="7479010">raw</span><span class="op" id="7479013">[</span><span class="ident" id="7479014">start</span><span class="op" id="7479019">:</span><span class="ident" id="7479020">end</span><span class="op" id="7479023">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7479028">if</span>&nbsp;<span class="ident" id="7479031">strings</span><span class="op" id="7479038">.</span><span class="ident" id="7479039">ContainsAny</span><span class="op" id="7479050">(</span><span class="ident" id="7479051">text</span><span class="op" id="7479055">,</span>&nbsp;<span class="string" id="7479057">&#34;&lt;&gt;&#34;</span><span class="op" id="7479061">)</span>&nbsp;<span class="op" id="7479063">&amp;&amp;</span>&nbsp;<span class="op" id="7479066">(</span><span class="op" id="7479067">!</span><span class="ident" id="7479068">strings</span><span class="op" id="7479075">.</span><span class="ident" id="7479076">HasPrefix</span><span class="op" id="7479085">(</span><span class="ident" id="7479086">text</span><span class="op" id="7479090">,</span>&nbsp;<span class="string" id="7479092">&#34;&lt;&#34;</span><span class="op" id="7479095">)</span>&nbsp;<span class="op" id="7479097">||</span>&nbsp;<span class="op" id="7479100">!</span><span class="ident" id="7479101">strings</span><span class="op" id="7479108">.</span><span class="ident" id="7479109">HasSuffix</span><span class="op" id="7479118">(</span><span class="ident" id="7479119">text</span><span class="op" id="7479123">,</span>&nbsp;<span class="string" id="7479125">&#34;&gt;&#34;</span><span class="op" id="7479128">)</span><span class="op" id="7479129">)</span>&nbsp;<span class="op" id="7479131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479137">t</span><span class="op" id="7479138">.</span><span class="ident" id="7479139">Errorf</span><span class="op" id="7479145">(</span><span class="string" id="7479146">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="7479189">,</span>&nbsp;<span class="ident" id="7479191">i</span><span class="op" id="7479192">,</span>&nbsp;<span class="ident" id="7479194">text</span><span class="op" id="7479198">,</span>&nbsp;<span class="ident" id="7479200">have</span><span class="op" id="7479204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7479209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7479213">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479217">lastEnd</span>&nbsp;<span class="op" id="7479225">=</span>&nbsp;<span class="ident" id="7479227">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7479232">}</span><br>
<span class="lineno"></span><span class="op" id="7479234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7479237">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="7479308">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="7479376">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7479434">var</span>&nbsp;<span class="ident" id="7479438">nestedDirectivesInput</span>&nbsp;<span class="op" id="7479460">=</span>&nbsp;<span class="string" id="7479462">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7479728">var</span>&nbsp;<span class="ident" id="7479732">nestedDirectivesTokens</span>&nbsp;<span class="op" id="7479755">=</span>&nbsp;<span class="op" id="7479757">[</span><span class="op" id="7479758">]</span><span class="ident" id="7479759">Token</span><span class="op" id="7479764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479767">CharData</span><span class="op" id="7479775">(</span><span class="string" id="7479776">&#34;\n&#34;</span><span class="op" id="7479780">)</span><span class="op" id="7479781">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479784">Directive</span><span class="op" id="7479793">(</span><span class="string" id="7479794">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="7479865">)</span><span class="op" id="7479866">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479869">CharData</span><span class="op" id="7479877">(</span><span class="string" id="7479878">&#34;\n&#34;</span><span class="op" id="7479882">)</span><span class="op" id="7479883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479886">Directive</span><span class="op" id="7479895">(</span><span class="string" id="7479896">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="7479925">)</span><span class="op" id="7479926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479929">CharData</span><span class="op" id="7479937">(</span><span class="string" id="7479938">&#34;\n&#34;</span><span class="op" id="7479942">)</span><span class="op" id="7479943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479946">Directive</span><span class="op" id="7479955">(</span><span class="string" id="7479956">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="7479985">)</span><span class="op" id="7479986">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7479989">CharData</span><span class="op" id="7479997">(</span><span class="string" id="7479998">&#34;\n&#34;</span><span class="op" id="7480002">)</span><span class="op" id="7480003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480006">Directive</span><span class="op" id="7480015">(</span><span class="string" id="7480016">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="7480045">)</span><span class="op" id="7480046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480049">CharData</span><span class="op" id="7480057">(</span><span class="string" id="7480058">&#34;\n&#34;</span><span class="op" id="7480062">)</span><span class="op" id="7480063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480066">Directive</span><span class="op" id="7480075">(</span><span class="string" id="7480076">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="7480105">)</span><span class="op" id="7480106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480109">CharData</span><span class="op" id="7480117">(</span><span class="string" id="7480118">&#34;\n&#34;</span><span class="op" id="7480122">)</span><span class="op" id="7480123">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480126">Directive</span><span class="op" id="7480135">(</span><span class="string" id="7480136">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="7480166">)</span><span class="op" id="7480167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480170">CharData</span><span class="op" id="7480178">(</span><span class="string" id="7480179">&#34;\n&#34;</span><span class="op" id="7480183">)</span><span class="op" id="7480184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480187">Directive</span><span class="op" id="7480196">(</span><span class="string" id="7480197">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="7480227">)</span><span class="op" id="7480228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480231">CharData</span><span class="op" id="7480239">(</span><span class="string" id="7480240">&#34;\n&#34;</span><span class="op" id="7480244">)</span><span class="op" id="7480245">,</span><br>
<span class="lineno"></span><span class="op" id="7480247">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="7480250">func</span>&nbsp;<span class="ident" id="7480255">TestNestedDirectives</span><span class="op" id="7480275">(</span><span class="ident" id="7480276">t</span>&nbsp;<span class="op" id="7480278">*</span><span class="ident" id="7480279">testing</span><span class="op" id="7480286">.</span><span class="ident" id="7480287">T</span><span class="op" id="7480288">)</span>&nbsp;<span class="op" id="7480290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480293">d</span>&nbsp;<span class="op" id="7480295">:=</span>&nbsp;<span class="ident" id="7480298">NewDecoder</span><span class="op" id="7480308">(</span><span class="ident" id="7480309">strings</span><span class="op" id="7480316">.</span><span class="ident" id="7480317">NewReader</span><span class="op" id="7480326">(</span><span class="ident" id="7480327">nestedDirectivesInput</span><span class="op" id="7480348">)</span><span class="op" id="7480349">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480353">for</span>&nbsp;<span class="ident" id="7480357">i</span><span class="op" id="7480358">,</span>&nbsp;<span class="ident" id="7480360">want</span>&nbsp;<span class="op" id="7480365">:=</span>&nbsp;<span class="keyword" id="7480368">range</span>&nbsp;<span class="ident" id="7480374">nestedDirectivesTokens</span>&nbsp;<span class="op" id="7480397">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480401">have</span><span class="op" id="7480405">,</span>&nbsp;<span class="ident" id="7480407">err</span>&nbsp;<span class="op" id="7480411">:=</span>&nbsp;<span class="ident" id="7480414">d</span><span class="op" id="7480415">.</span><span class="ident" id="7480416">Token</span><span class="op" id="7480421">(</span><span class="op" id="7480422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480426">if</span>&nbsp;<span class="ident" id="7480429">err</span>&nbsp;<span class="op" id="7480433">!=</span>&nbsp;<span class="ident" id="7480436">nil</span>&nbsp;<span class="op" id="7480440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480445">t</span><span class="op" id="7480446">.</span><span class="ident" id="7480447">Fatalf</span><span class="op" id="7480453">(</span><span class="string" id="7480454">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7480486">,</span>&nbsp;<span class="ident" id="7480488">i</span><span class="op" id="7480489">,</span>&nbsp;<span class="ident" id="7480491">err</span><span class="op" id="7480494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480502">if</span>&nbsp;<span class="op" id="7480505">!</span><span class="ident" id="7480506">reflect</span><span class="op" id="7480513">.</span><span class="ident" id="7480514">DeepEqual</span><span class="op" id="7480523">(</span><span class="ident" id="7480524">have</span><span class="op" id="7480528">,</span>&nbsp;<span class="ident" id="7480530">want</span><span class="op" id="7480534">)</span>&nbsp;<span class="op" id="7480536">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480541">t</span><span class="op" id="7480542">.</span><span class="ident" id="7480543">Errorf</span><span class="op" id="7480549">(</span><span class="string" id="7480550">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7480575">,</span>&nbsp;<span class="ident" id="7480577">i</span><span class="op" id="7480578">,</span>&nbsp;<span class="ident" id="7480580">have</span><span class="op" id="7480584">,</span>&nbsp;<span class="ident" id="7480586">want</span><span class="op" id="7480590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480597">}</span><br>
<span class="lineno"></span><span class="op" id="7480599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="7480602">func</span>&nbsp;<span class="ident" id="7480607">TestToken</span><span class="op" id="7480616">(</span><span class="ident" id="7480617">t</span>&nbsp;<span class="op" id="7480619">*</span><span class="ident" id="7480620">testing</span><span class="op" id="7480627">.</span><span class="ident" id="7480628">T</span><span class="op" id="7480629">)</span>&nbsp;<span class="op" id="7480631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480634">d</span>&nbsp;<span class="op" id="7480636">:=</span>&nbsp;<span class="ident" id="7480639">NewDecoder</span><span class="op" id="7480649">(</span><span class="ident" id="7480650">strings</span><span class="op" id="7480657">.</span><span class="ident" id="7480658">NewReader</span><span class="op" id="7480667">(</span><span class="ident" id="7480668">testInput</span><span class="op" id="7480677">)</span><span class="op" id="7480678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480681">d</span><span class="op" id="7480682">.</span><span class="ident" id="7480683">Entity</span>&nbsp;<span class="op" id="7480690">=</span>&nbsp;<span class="ident" id="7480692">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480705">for</span>&nbsp;<span class="ident" id="7480709">i</span><span class="op" id="7480710">,</span>&nbsp;<span class="ident" id="7480712">want</span>&nbsp;<span class="op" id="7480717">:=</span>&nbsp;<span class="keyword" id="7480720">range</span>&nbsp;<span class="ident" id="7480726">cookedTokens</span>&nbsp;<span class="op" id="7480739">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480743">have</span><span class="op" id="7480747">,</span>&nbsp;<span class="ident" id="7480749">err</span>&nbsp;<span class="op" id="7480753">:=</span>&nbsp;<span class="ident" id="7480756">d</span><span class="op" id="7480757">.</span><span class="ident" id="7480758">Token</span><span class="op" id="7480763">(</span><span class="op" id="7480764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480768">if</span>&nbsp;<span class="ident" id="7480771">err</span>&nbsp;<span class="op" id="7480775">!=</span>&nbsp;<span class="ident" id="7480778">nil</span>&nbsp;<span class="op" id="7480782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480787">t</span><span class="op" id="7480788">.</span><span class="ident" id="7480789">Fatalf</span><span class="op" id="7480795">(</span><span class="string" id="7480796">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7480828">,</span>&nbsp;<span class="ident" id="7480830">i</span><span class="op" id="7480831">,</span>&nbsp;<span class="ident" id="7480833">err</span><span class="op" id="7480836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480844">if</span>&nbsp;<span class="op" id="7480847">!</span><span class="ident" id="7480848">reflect</span><span class="op" id="7480855">.</span><span class="ident" id="7480856">DeepEqual</span><span class="op" id="7480865">(</span><span class="ident" id="7480866">have</span><span class="op" id="7480870">,</span>&nbsp;<span class="ident" id="7480872">want</span><span class="op" id="7480876">)</span>&nbsp;<span class="op" id="7480878">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7480883">t</span><span class="op" id="7480884">.</span><span class="ident" id="7480885">Errorf</span><span class="op" id="7480891">(</span><span class="string" id="7480892">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7480917">,</span>&nbsp;<span class="ident" id="7480919">i</span><span class="op" id="7480920">,</span>&nbsp;<span class="ident" id="7480922">have</span><span class="op" id="7480926">,</span>&nbsp;<span class="ident" id="7480928">want</span><span class="op" id="7480932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7480939">}</span><br>
<span class="lineno"></span><span class="op" id="7480941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="7480944">func</span>&nbsp;<span class="ident" id="7480949">TestSyntax</span><span class="op" id="7480959">(</span><span class="ident" id="7480960">t</span>&nbsp;<span class="op" id="7480962">*</span><span class="ident" id="7480963">testing</span><span class="op" id="7480970">.</span><span class="ident" id="7480971">T</span><span class="op" id="7480972">)</span>&nbsp;<span class="op" id="7480974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7480977">for</span>&nbsp;<span class="ident" id="7480981">i</span>&nbsp;<span class="op" id="7480983">:=</span>&nbsp;<span class="keyword" id="7480986">range</span>&nbsp;<span class="ident" id="7480992">xmlInput</span>&nbsp;<span class="op" id="7481001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481005">d</span>&nbsp;<span class="op" id="7481007">:=</span>&nbsp;<span class="ident" id="7481010">NewDecoder</span><span class="op" id="7481020">(</span><span class="ident" id="7481021">strings</span><span class="op" id="7481028">.</span><span class="ident" id="7481029">NewReader</span><span class="op" id="7481038">(</span><span class="ident" id="7481039">xmlInput</span><span class="op" id="7481047">[</span><span class="ident" id="7481048">i</span><span class="op" id="7481049">]</span><span class="op" id="7481050">)</span><span class="op" id="7481051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7481055">var</span>&nbsp;<span class="ident" id="7481059">err</span>&nbsp;<span class="builtintype" id="7481063">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7481071">for</span>&nbsp;<span class="ident" id="7481075">_</span><span class="op" id="7481076">,</span>&nbsp;<span class="ident" id="7481078">err</span>&nbsp;<span class="op" id="7481082">=</span>&nbsp;<span class="ident" id="7481084">d</span><span class="op" id="7481085">.</span><span class="ident" id="7481086">Token</span><span class="op" id="7481091">(</span><span class="op" id="7481092">)</span><span class="op" id="7481093">;</span>&nbsp;<span class="ident" id="7481095">err</span>&nbsp;<span class="op" id="7481099">==</span>&nbsp;<span class="ident" id="7481102">nil</span><span class="op" id="7481105">;</span>&nbsp;<span class="ident" id="7481107">_</span><span class="op" id="7481108">,</span>&nbsp;<span class="ident" id="7481110">err</span>&nbsp;<span class="op" id="7481114">=</span>&nbsp;<span class="ident" id="7481116">d</span><span class="op" id="7481117">.</span><span class="ident" id="7481118">Token</span><span class="op" id="7481123">(</span><span class="op" id="7481124">)</span>&nbsp;<span class="op" id="7481126">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7481130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7481134">if</span>&nbsp;<span class="ident" id="7481137">_</span><span class="op" id="7481138">,</span>&nbsp;<span class="ident" id="7481140">ok</span>&nbsp;<span class="op" id="7481143">:=</span>&nbsp;<span class="ident" id="7481146">err</span><span class="op" id="7481149">.</span><span class="op" id="7481150">(</span><span class="op" id="7481151">*</span><span class="ident" id="7481152">SyntaxError</span><span class="op" id="7481163">)</span><span class="op" id="7481164">;</span>&nbsp;<span class="op" id="7481166">!</span><span class="ident" id="7481167">ok</span>&nbsp;<span class="op" id="7481170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481175">t</span><span class="op" id="7481176">.</span><span class="ident" id="7481177">Fatalf</span><span class="op" id="7481183">(</span><span class="string" id="7481184">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="7481234">,</span>&nbsp;<span class="ident" id="7481236">xmlInput</span><span class="op" id="7481244">[</span><span class="ident" id="7481245">i</span><span class="op" id="7481246">]</span><span class="op" id="7481247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7481251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7481254">}</span><br>
<span class="lineno">400</span><span class="op" id="7481256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7481259">type</span>&nbsp;<span class="ident" id="7481264">allScalars</span>&nbsp;<span class="keyword" id="7481275">struct</span>&nbsp;<span class="op" id="7481282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481285">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481295">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481301">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481311">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481317">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481327">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481333">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481343">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481349">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481359">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481364">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481374">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481380">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481390">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481397">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481407">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481414">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481424">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481431">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481441">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481446">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481456">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481463">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481473">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481481">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481491">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481499">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7481509">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481517">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481527">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481536">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481546">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481555">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481565">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481574">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481584">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481592">PtrString</span>&nbsp;<span class="op" id="7481602">*</span><span class="builtintype" id="7481603">string</span><br>
<span class="lineno"></span><span class="op" id="7481610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7481613">var</span>&nbsp;<span class="ident" id="7481617">all</span>&nbsp;<span class="op" id="7481621">=</span>&nbsp;<span class="ident" id="7481623">allScalars</span><span class="op" id="7481633">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481636">True1</span><span class="op" id="7481641">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481647">true</span><span class="op" id="7481651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481654">True2</span><span class="op" id="7481659">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481665">true</span><span class="op" id="7481669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481672">False1</span><span class="op" id="7481678">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481683">false</span><span class="op" id="7481688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481691">False2</span><span class="op" id="7481697">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7481702">false</span><span class="op" id="7481707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481710">Int</span><span class="op" id="7481713">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7481721">1</span><span class="op" id="7481722">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481725">Int8</span><span class="op" id="7481729">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7481736">-</span><span class="num" id="7481737">2</span><span class="op" id="7481738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481741">Int16</span><span class="op" id="7481746">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7481752">3</span><span class="op" id="7481753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481756">Int32</span><span class="op" id="7481761">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7481767">-</span><span class="num" id="7481768">4</span><span class="op" id="7481769">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481772">Int64</span><span class="op" id="7481777">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7481783">5</span><span class="op" id="7481784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481787">Uint</span><span class="op" id="7481791">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7481798">6</span><span class="op" id="7481799">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481802">Uint8</span><span class="op" id="7481807">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7481813">7</span><span class="op" id="7481814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481817">Uint16</span><span class="op" id="7481823">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7481828">8</span><span class="op" id="7481829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481832">Uint32</span><span class="op" id="7481838">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7481843">9</span><span class="op" id="7481844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481847">Uint64</span><span class="op" id="7481853">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7481858">10</span><span class="op" id="7481860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481863">Uintptr</span><span class="op" id="7481870">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7481874">11</span><span class="op" id="7481876">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481879">Float32</span><span class="op" id="7481886">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7481890">13.0</span><span class="op" id="7481894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481897">Float64</span><span class="op" id="7481904">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7481908">14.0</span><span class="op" id="7481912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481915">String</span><span class="op" id="7481921">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7481926">&#34;15&#34;</span><span class="op" id="7481930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7481933">PtrString</span><span class="op" id="7481942">:</span>&nbsp;<span class="op" id="7481944">&amp;</span><span class="ident" id="7481945">sixteen</span><span class="op" id="7481952">,</span><br>
<span class="lineno"></span><span class="op" id="7481954">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="7481957">var</span>&nbsp;<span class="ident" id="7481961">sixteen</span>&nbsp;<span class="op" id="7481969">=</span>&nbsp;<span class="string" id="7481971">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7481977">const</span>&nbsp;<span class="ident" id="7481983">testScalarsInput</span>&nbsp;<span class="op" id="7482000">=</span>&nbsp;<span class="string" id="7482002">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="7482438">func</span>&nbsp;<span class="ident" id="7482443">TestAllScalars</span><span class="op" id="7482457">(</span><span class="ident" id="7482458">t</span>&nbsp;<span class="op" id="7482460">*</span><span class="ident" id="7482461">testing</span><span class="op" id="7482468">.</span><span class="ident" id="7482469">T</span><span class="op" id="7482470">)</span>&nbsp;<span class="op" id="7482472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7482475">var</span>&nbsp;<span class="ident" id="7482479">a</span>&nbsp;<span class="ident" id="7482481">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7482493">err</span>&nbsp;<span class="op" id="7482497">:=</span>&nbsp;<span class="ident" id="7482500">Unmarshal</span><span class="op" id="7482509">(</span><span class="op" id="7482510">[</span><span class="op" id="7482511">]</span><span class="builtintype" id="7482512">byte</span><span class="op" id="7482516">(</span><span class="ident" id="7482517">testScalarsInput</span><span class="op" id="7482533">)</span><span class="op" id="7482534">,</span>&nbsp;<span class="op" id="7482536">&amp;</span><span class="ident" id="7482537">a</span><span class="op" id="7482538">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7482542">if</span>&nbsp;<span class="ident" id="7482545">err</span>&nbsp;<span class="op" id="7482549">!=</span>&nbsp;<span class="ident" id="7482552">nil</span>&nbsp;<span class="op" id="7482556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7482560">t</span><span class="op" id="7482561">.</span><span class="ident" id="7482562">Fatal</span><span class="op" id="7482567">(</span><span class="ident" id="7482568">err</span><span class="op" id="7482571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7482574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7482577">if</span>&nbsp;<span class="op" id="7482580">!</span><span class="ident" id="7482581">reflect</span><span class="op" id="7482588">.</span><span class="ident" id="7482589">DeepEqual</span><span class="op" id="7482598">(</span><span class="ident" id="7482599">a</span><span class="op" id="7482600">,</span>&nbsp;<span class="ident" id="7482602">all</span><span class="op" id="7482605">)</span>&nbsp;<span class="op" id="7482607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7482611">t</span><span class="op" id="7482612">.</span><span class="ident" id="7482613">Errorf</span><span class="op" id="7482619">(</span><span class="string" id="7482620">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="7482639">,</span>&nbsp;<span class="ident" id="7482641">a</span><span class="op" id="7482642">,</span>&nbsp;<span class="ident" id="7482644">all</span><span class="op" id="7482647">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7482650">}</span><br>
<span class="lineno"></span><span class="op" id="7482652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7482655">type</span>&nbsp;<span class="ident" id="7482660">item</span>&nbsp;<span class="keyword" id="7482665">struct</span>&nbsp;<span class="op" id="7482672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7482675">Field_a</span>&nbsp;<span class="builtintype" id="7482683">string</span><br>
<span class="lineno">485</span><span class="op" id="7482690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7482693">func</span>&nbsp;<span class="ident" id="7482698">TestIssue569</span><span class="op" id="7482710">(</span><span class="ident" id="7482711">t</span>&nbsp;<span class="op" id="7482713">*</span><span class="ident" id="7482714">testing</span><span class="op" id="7482721">.</span><span class="ident" id="7482722">T</span><span class="op" id="7482723">)</span>&nbsp;<span class="op" id="7482725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7482728">data</span>&nbsp;<span class="op" id="7482733">:=</span>&nbsp;<span class="string" id="7482736">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7482776">var</span>&nbsp;<span class="ident" id="7482780">i</span>&nbsp;<span class="ident" id="7482782">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7482788">err</span>&nbsp;<span class="op" id="7482792">:=</span>&nbsp;<span class="ident" id="7482795">Unmarshal</span><span class="op" id="7482804">(</span><span class="op" id="7482805">[</span><span class="op" id="7482806">]</span><span class="builtintype" id="7482807">byte</span><span class="op" id="7482811">(</span><span class="ident" id="7482812">data</span><span class="op" id="7482816">)</span><span class="op" id="7482817">,</span>&nbsp;<span class="op" id="7482819">&amp;</span><span class="ident" id="7482820">i</span><span class="op" id="7482821">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7482825">if</span>&nbsp;<span class="ident" id="7482828">err</span>&nbsp;<span class="op" id="7482832">!=</span>&nbsp;<span class="ident" id="7482835">nil</span>&nbsp;<span class="op" id="7482839">||</span>&nbsp;<span class="ident" id="7482842">i</span><span class="op" id="7482843">.</span><span class="ident" id="7482844">Field_a</span>&nbsp;<span class="op" id="7482852">!=</span>&nbsp;<span class="string" id="7482855">&#34;abcd&#34;</span>&nbsp;<span class="op" id="7482862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7482866">t</span><span class="op" id="7482867">.</span><span class="ident" id="7482868">Fatal</span><span class="op" id="7482873">(</span><span class="string" id="7482874">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="7482890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7482893">}</span><br>
<span class="lineno">495</span><span class="op" id="7482895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7482898">func</span>&nbsp;<span class="ident" id="7482903">TestUnquotedAttrs</span><span class="op" id="7482920">(</span><span class="ident" id="7482921">t</span>&nbsp;<span class="op" id="7482923">*</span><span class="ident" id="7482924">testing</span><span class="op" id="7482931">.</span><span class="ident" id="7482932">T</span><span class="op" id="7482933">)</span>&nbsp;<span class="op" id="7482935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7482938">data</span>&nbsp;<span class="op" id="7482943">:=</span>&nbsp;<span class="string" id="7482946">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7482972">d</span>&nbsp;<span class="op" id="7482974">:=</span>&nbsp;<span class="ident" id="7482977">NewDecoder</span><span class="op" id="7482987">(</span><span class="ident" id="7482988">strings</span><span class="op" id="7482995">.</span><span class="ident" id="7482996">NewReader</span><span class="op" id="7483005">(</span><span class="ident" id="7483006">data</span><span class="op" id="7483010">)</span><span class="op" id="7483011">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483014">d</span><span class="op" id="7483015">.</span><span class="ident" id="7483016">Strict</span>&nbsp;<span class="op" id="7483023">=</span>&nbsp;<span class="builtintype" id="7483025">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483032">token</span><span class="op" id="7483037">,</span>&nbsp;<span class="ident" id="7483039">err</span>&nbsp;<span class="op" id="7483043">:=</span>&nbsp;<span class="ident" id="7483046">d</span><span class="op" id="7483047">.</span><span class="ident" id="7483048">Token</span><span class="op" id="7483053">(</span><span class="op" id="7483054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7483057">if</span>&nbsp;<span class="ident" id="7483060">_</span><span class="op" id="7483061">,</span>&nbsp;<span class="ident" id="7483063">ok</span>&nbsp;<span class="op" id="7483066">:=</span>&nbsp;<span class="ident" id="7483069">err</span><span class="op" id="7483072">.</span><span class="op" id="7483073">(</span><span class="op" id="7483074">*</span><span class="ident" id="7483075">SyntaxError</span><span class="op" id="7483086">)</span><span class="op" id="7483087">;</span>&nbsp;<span class="ident" id="7483089">ok</span>&nbsp;<span class="op" id="7483092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483096">t</span><span class="op" id="7483097">.</span><span class="ident" id="7483098">Errorf</span><span class="op" id="7483104">(</span><span class="string" id="7483105">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7483127">,</span>&nbsp;<span class="ident" id="7483129">err</span><span class="op" id="7483132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7483135">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7483138">if</span>&nbsp;<span class="ident" id="7483141">token</span><span class="op" id="7483146">.</span><span class="op" id="7483147">(</span><span class="ident" id="7483148">StartElement</span><span class="op" id="7483160">)</span><span class="op" id="7483161">.</span><span class="ident" id="7483162">Name</span><span class="op" id="7483166">.</span><span class="ident" id="7483167">Local</span>&nbsp;<span class="op" id="7483173">!=</span>&nbsp;<span class="string" id="7483176">&#34;tag&#34;</span>&nbsp;<span class="op" id="7483182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483186">t</span><span class="op" id="7483187">.</span><span class="ident" id="7483188">Errorf</span><span class="op" id="7483194">(</span><span class="string" id="7483195">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7483220">,</span>&nbsp;<span class="ident" id="7483222">token</span><span class="op" id="7483227">.</span><span class="op" id="7483228">(</span><span class="ident" id="7483229">StartElement</span><span class="op" id="7483241">)</span><span class="op" id="7483242">.</span><span class="ident" id="7483243">Name</span><span class="op" id="7483247">.</span><span class="ident" id="7483248">Local</span><span class="op" id="7483253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7483256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483259">attr</span>&nbsp;<span class="op" id="7483264">:=</span>&nbsp;<span class="ident" id="7483267">token</span><span class="op" id="7483272">.</span><span class="op" id="7483273">(</span><span class="ident" id="7483274">StartElement</span><span class="op" id="7483286">)</span><span class="op" id="7483287">.</span><span class="ident" id="7483288">Attr</span><span class="op" id="7483292">[</span><span class="num" id="7483293">0</span><span class="op" id="7483294">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7483297">if</span>&nbsp;<span class="ident" id="7483300">attr</span><span class="op" id="7483304">.</span><span class="ident" id="7483305">Value</span>&nbsp;<span class="op" id="7483311">!=</span>&nbsp;<span class="string" id="7483314">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="7483326">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483330">t</span><span class="op" id="7483331">.</span><span class="ident" id="7483332">Errorf</span><span class="op" id="7483338">(</span><span class="string" id="7483339">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="7483371">,</span>&nbsp;<span class="ident" id="7483373">attr</span><span class="op" id="7483377">.</span><span class="ident" id="7483378">Value</span><span class="op" id="7483383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7483386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7483389">if</span>&nbsp;<span class="ident" id="7483392">attr</span><span class="op" id="7483396">.</span><span class="ident" id="7483397">Name</span><span class="op" id="7483401">.</span><span class="ident" id="7483402">Local</span>&nbsp;<span class="op" id="7483408">!=</span>&nbsp;<span class="string" id="7483411">&#34;attr&#34;</span>&nbsp;<span class="op" id="7483418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483422">t</span><span class="op" id="7483423">.</span><span class="ident" id="7483424">Errorf</span><span class="op" id="7483430">(</span><span class="string" id="7483431">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7483462">,</span>&nbsp;<span class="ident" id="7483464">attr</span><span class="op" id="7483468">.</span><span class="ident" id="7483469">Name</span><span class="op" id="7483473">.</span><span class="ident" id="7483474">Local</span><span class="op" id="7483479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7483482">}</span><br>
<span class="lineno">515</span><span class="op" id="7483484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7483487">func</span>&nbsp;<span class="ident" id="7483492">TestValuelessAttrs</span><span class="op" id="7483510">(</span><span class="ident" id="7483511">t</span>&nbsp;<span class="op" id="7483513">*</span><span class="ident" id="7483514">testing</span><span class="op" id="7483521">.</span><span class="ident" id="7483522">T</span><span class="op" id="7483523">)</span>&nbsp;<span class="op" id="7483525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483528">tests</span>&nbsp;<span class="op" id="7483534">:=</span>&nbsp;<span class="op" id="7483537">[</span><span class="op" id="7483538">]</span><span class="op" id="7483539">[</span><span class="num" id="7483540">3</span><span class="op" id="7483541">]</span><span class="builtintype" id="7483542">string</span><span class="op" id="7483548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7483552">{</span><span class="string" id="7483553">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="7483565">,</span>&nbsp;<span class="string" id="7483567">&#34;p&#34;</span><span class="op" id="7483570">,</span>&nbsp;<span class="string" id="7483572">&#34;nowrap&#34;</span><span class="op" id="7483580">}</span><span class="op" id="7483581">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7483585">{</span><span class="string" id="7483586">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="7483599">,</span>&nbsp;<span class="string" id="7483601">&#34;p&#34;</span><span class="op" id="7483604">,</span>&nbsp;<span class="string" id="7483606">&#34;nowrap&#34;</span><span class="op" id="7483614">}</span><span class="op" id="7483615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7483619">{</span><span class="string" id="7483620">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="7483638">,</span>&nbsp;<span class="string" id="7483640">&#34;input&#34;</span><span class="op" id="7483647">,</span>&nbsp;<span class="string" id="7483649">&#34;checked&#34;</span><span class="op" id="7483658">}</span><span class="op" id="7483659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7483663">{</span><span class="string" id="7483664">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="7483683">,</span>&nbsp;<span class="string" id="7483685">&#34;input&#34;</span><span class="op" id="7483692">,</span>&nbsp;<span class="string" id="7483694">&#34;checked&#34;</span><span class="op" id="7483703">}</span><span class="op" id="7483704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7483707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7483710">for</span>&nbsp;<span class="ident" id="7483714">_</span><span class="op" id="7483715">,</span>&nbsp;<span class="ident" id="7483717">test</span>&nbsp;<span class="op" id="7483722">:=</span>&nbsp;<span class="keyword" id="7483725">range</span>&nbsp;<span class="ident" id="7483731">tests</span>&nbsp;<span class="op" id="7483737">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483741">d</span>&nbsp;<span class="op" id="7483743">:=</span>&nbsp;<span class="ident" id="7483746">NewDecoder</span><span class="op" id="7483756">(</span><span class="ident" id="7483757">strings</span><span class="op" id="7483764">.</span><span class="ident" id="7483765">NewReader</span><span class="op" id="7483774">(</span><span class="ident" id="7483775">test</span><span class="op" id="7483779">[</span><span class="num" id="7483780">0</span><span class="op" id="7483781">]</span><span class="op" id="7483782">)</span><span class="op" id="7483783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483787">d</span><span class="op" id="7483788">.</span><span class="ident" id="7483789">Strict</span>&nbsp;<span class="op" id="7483796">=</span>&nbsp;<span class="builtintype" id="7483798">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483806">token</span><span class="op" id="7483811">,</span>&nbsp;<span class="ident" id="7483813">err</span>&nbsp;<span class="op" id="7483817">:=</span>&nbsp;<span class="ident" id="7483820">d</span><span class="op" id="7483821">.</span><span class="ident" id="7483822">Token</span><span class="op" id="7483827">(</span><span class="op" id="7483828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7483832">if</span>&nbsp;<span class="ident" id="7483835">_</span><span class="op" id="7483836">,</span>&nbsp;<span class="ident" id="7483838">ok</span>&nbsp;<span class="op" id="7483841">:=</span>&nbsp;<span class="ident" id="7483844">err</span><span class="op" id="7483847">.</span><span class="op" id="7483848">(</span><span class="op" id="7483849">*</span><span class="ident" id="7483850">SyntaxError</span><span class="op" id="7483861">)</span><span class="op" id="7483862">;</span>&nbsp;<span class="ident" id="7483864">ok</span>&nbsp;<span class="op" id="7483867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483872">t</span><span class="op" id="7483873">.</span><span class="ident" id="7483874">Errorf</span><span class="op" id="7483880">(</span><span class="string" id="7483881">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7483903">,</span>&nbsp;<span class="ident" id="7483905">err</span><span class="op" id="7483908">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7483912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7483916">if</span>&nbsp;<span class="ident" id="7483919">token</span><span class="op" id="7483924">.</span><span class="op" id="7483925">(</span><span class="ident" id="7483926">StartElement</span><span class="op" id="7483938">)</span><span class="op" id="7483939">.</span><span class="ident" id="7483940">Name</span><span class="op" id="7483944">.</span><span class="ident" id="7483945">Local</span>&nbsp;<span class="op" id="7483951">!=</span>&nbsp;<span class="ident" id="7483954">test</span><span class="op" id="7483958">[</span><span class="num" id="7483959">1</span><span class="op" id="7483960">]</span>&nbsp;<span class="op" id="7483962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7483967">t</span><span class="op" id="7483968">.</span><span class="ident" id="7483969">Errorf</span><span class="op" id="7483975">(</span><span class="string" id="7483976">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7484001">,</span>&nbsp;<span class="ident" id="7484003">token</span><span class="op" id="7484008">.</span><span class="op" id="7484009">(</span><span class="ident" id="7484010">StartElement</span><span class="op" id="7484022">)</span><span class="op" id="7484023">.</span><span class="ident" id="7484024">Name</span><span class="op" id="7484028">.</span><span class="ident" id="7484029">Local</span><span class="op" id="7484034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7484038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484042">attr</span>&nbsp;<span class="op" id="7484047">:=</span>&nbsp;<span class="ident" id="7484050">token</span><span class="op" id="7484055">.</span><span class="op" id="7484056">(</span><span class="ident" id="7484057">StartElement</span><span class="op" id="7484069">)</span><span class="op" id="7484070">.</span><span class="ident" id="7484071">Attr</span><span class="op" id="7484075">[</span><span class="num" id="7484076">0</span><span class="op" id="7484077">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7484081">if</span>&nbsp;<span class="ident" id="7484084">attr</span><span class="op" id="7484088">.</span><span class="ident" id="7484089">Value</span>&nbsp;<span class="op" id="7484095">!=</span>&nbsp;<span class="ident" id="7484098">test</span><span class="op" id="7484102">[</span><span class="num" id="7484103">2</span><span class="op" id="7484104">]</span>&nbsp;<span class="op" id="7484106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484111">t</span><span class="op" id="7484112">.</span><span class="ident" id="7484113">Errorf</span><span class="op" id="7484119">(</span><span class="string" id="7484120">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="7484152">,</span>&nbsp;<span class="ident" id="7484154">attr</span><span class="op" id="7484158">.</span><span class="ident" id="7484159">Value</span><span class="op" id="7484164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7484168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7484172">if</span>&nbsp;<span class="ident" id="7484175">attr</span><span class="op" id="7484179">.</span><span class="ident" id="7484180">Name</span><span class="op" id="7484184">.</span><span class="ident" id="7484185">Local</span>&nbsp;<span class="op" id="7484191">!=</span>&nbsp;<span class="ident" id="7484194">test</span><span class="op" id="7484198">[</span><span class="num" id="7484199">2</span><span class="op" id="7484200">]</span>&nbsp;<span class="op" id="7484202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484207">t</span><span class="op" id="7484208">.</span><span class="ident" id="7484209">Errorf</span><span class="op" id="7484215">(</span><span class="string" id="7484216">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7484247">,</span>&nbsp;<span class="ident" id="7484249">attr</span><span class="op" id="7484253">.</span><span class="ident" id="7484254">Name</span><span class="op" id="7484258">.</span><span class="ident" id="7484259">Local</span><span class="op" id="7484264">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7484268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7484271">}</span><br>
<span class="lineno"></span><span class="op" id="7484273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7484276">func</span>&nbsp;<span class="ident" id="7484281">TestCopyTokenCharData</span><span class="op" id="7484302">(</span><span class="ident" id="7484303">t</span>&nbsp;<span class="op" id="7484305">*</span><span class="ident" id="7484306">testing</span><span class="op" id="7484313">.</span><span class="ident" id="7484314">T</span><span class="op" id="7484315">)</span>&nbsp;<span class="op" id="7484317">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484320">data</span>&nbsp;<span class="op" id="7484325">:=</span>&nbsp;<span class="op" id="7484328">[</span><span class="op" id="7484329">]</span><span class="builtintype" id="7484330">byte</span><span class="op" id="7484334">(</span><span class="string" id="7484335">&#34;same&nbsp;data&#34;</span><span class="op" id="7484346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7484349">var</span>&nbsp;<span class="ident" id="7484353">tok1</span>&nbsp;<span class="ident" id="7484358">Token</span>&nbsp;<span class="op" id="7484364">=</span>&nbsp;<span class="ident" id="7484366">CharData</span><span class="op" id="7484374">(</span><span class="ident" id="7484375">data</span><span class="op" id="7484379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484382">tok2</span>&nbsp;<span class="op" id="7484387">:=</span>&nbsp;<span class="ident" id="7484390">CopyToken</span><span class="op" id="7484399">(</span><span class="ident" id="7484400">tok1</span><span class="op" id="7484404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7484407">if</span>&nbsp;<span class="op" id="7484410">!</span><span class="ident" id="7484411">reflect</span><span class="op" id="7484418">.</span><span class="ident" id="7484419">DeepEqual</span><span class="op" id="7484428">(</span><span class="ident" id="7484429">tok1</span><span class="op" id="7484433">,</span>&nbsp;<span class="ident" id="7484435">tok2</span><span class="op" id="7484439">)</span>&nbsp;<span class="op" id="7484441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484445">t</span><span class="op" id="7484446">.</span><span class="ident" id="7484447">Error</span><span class="op" id="7484452">(</span><span class="string" id="7484453">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="7484486">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7484489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484492">data</span><span class="op" id="7484496">[</span><span class="num" id="7484497">1</span><span class="op" id="7484498">]</span>&nbsp;<span class="op" id="7484500">=</span>&nbsp;<span class="string" id="7484502">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7484507">if</span>&nbsp;<span class="ident" id="7484510">reflect</span><span class="op" id="7484517">.</span><span class="ident" id="7484518">DeepEqual</span><span class="op" id="7484527">(</span><span class="ident" id="7484528">tok1</span><span class="op" id="7484532">,</span>&nbsp;<span class="ident" id="7484534">tok2</span><span class="op" id="7484538">)</span>&nbsp;<span class="op" id="7484540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484544">t</span><span class="op" id="7484545">.</span><span class="ident" id="7484546">Error</span><span class="op" id="7484551">(</span><span class="string" id="7484552">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="7484591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7484594">}</span><br>
<span class="lineno">555</span><span class="op" id="7484596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7484599">func</span>&nbsp;<span class="ident" id="7484604">TestCopyTokenStartElement</span><span class="op" id="7484629">(</span><span class="ident" id="7484630">t</span>&nbsp;<span class="op" id="7484632">*</span><span class="ident" id="7484633">testing</span><span class="op" id="7484640">.</span><span class="ident" id="7484641">T</span><span class="op" id="7484642">)</span>&nbsp;<span class="op" id="7484644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484647">elt</span>&nbsp;<span class="op" id="7484651">:=</span>&nbsp;<span class="ident" id="7484654">StartElement</span><span class="op" id="7484666">{</span><span class="ident" id="7484667">Name</span><span class="op" id="7484671">{</span><span class="string" id="7484672">&#34;&#34;</span><span class="op" id="7484674">,</span>&nbsp;<span class="string" id="7484676">&#34;hello&#34;</span><span class="op" id="7484683">}</span><span class="op" id="7484684">,</span>&nbsp;<span class="op" id="7484686">[</span><span class="op" id="7484687">]</span><span class="ident" id="7484688">Attr</span><span class="op" id="7484692">{</span><span class="op" id="7484693">{</span><span class="ident" id="7484694">Name</span><span class="op" id="7484698">{</span><span class="string" id="7484699">&#34;&#34;</span><span class="op" id="7484701">,</span>&nbsp;<span class="string" id="7484703">&#34;lang&#34;</span><span class="op" id="7484709">}</span><span class="op" id="7484710">,</span>&nbsp;<span class="string" id="7484712">&#34;en&#34;</span><span class="op" id="7484716">}</span><span class="op" id="7484717">}</span><span class="op" id="7484718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7484721">var</span>&nbsp;<span class="ident" id="7484725">tok1</span>&nbsp;<span class="ident" id="7484730">Token</span>&nbsp;<span class="op" id="7484736">=</span>&nbsp;<span class="ident" id="7484738">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484743">tok2</span>&nbsp;<span class="op" id="7484748">:=</span>&nbsp;<span class="ident" id="7484751">CopyToken</span><span class="op" id="7484760">(</span><span class="ident" id="7484761">tok1</span><span class="op" id="7484765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7484768">if</span>&nbsp;<span class="ident" id="7484771">tok1</span><span class="op" id="7484775">.</span><span class="op" id="7484776">(</span><span class="ident" id="7484777">StartElement</span><span class="op" id="7484789">)</span><span class="op" id="7484790">.</span><span class="ident" id="7484791">Attr</span><span class="op" id="7484795">[</span><span class="num" id="7484796">0</span><span class="op" id="7484797">]</span><span class="op" id="7484798">.</span><span class="ident" id="7484799">Value</span>&nbsp;<span class="op" id="7484805">!=</span>&nbsp;<span class="string" id="7484808">&#34;en&#34;</span>&nbsp;<span class="op" id="7484813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484817">t</span><span class="op" id="7484818">.</span><span class="ident" id="7484819">Error</span><span class="op" id="7484824">(</span><span class="string" id="7484825">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="7484854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7484857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7484860">if</span>&nbsp;<span class="op" id="7484863">!</span><span class="ident" id="7484864">reflect</span><span class="op" id="7484871">.</span><span class="ident" id="7484872">DeepEqual</span><span class="op" id="7484881">(</span><span class="ident" id="7484882">tok1</span><span class="op" id="7484886">,</span>&nbsp;<span class="ident" id="7484888">tok2</span><span class="op" id="7484892">)</span>&nbsp;<span class="op" id="7484894">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484898">t</span><span class="op" id="7484899">.</span><span class="ident" id="7484900">Error</span><span class="op" id="7484905">(</span><span class="string" id="7484906">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="7484947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7484950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7484953">tok1</span><span class="op" id="7484957">.</span><span class="op" id="7484958">(</span><span class="ident" id="7484959">StartElement</span><span class="op" id="7484971">)</span><span class="op" id="7484972">.</span><span class="ident" id="7484973">Attr</span><span class="op" id="7484977">[</span><span class="num" id="7484978">0</span><span class="op" id="7484979">]</span>&nbsp;<span class="op" id="7484981">=</span>&nbsp;<span class="ident" id="7484983">Attr</span><span class="op" id="7484987">{</span><span class="ident" id="7484988">Name</span><span class="op" id="7484992">{</span><span class="string" id="7484993">&#34;&#34;</span><span class="op" id="7484995">,</span>&nbsp;<span class="string" id="7484997">&#34;lang&#34;</span><span class="op" id="7485003">}</span><span class="op" id="7485004">,</span>&nbsp;<span class="string" id="7485006">&#34;de&#34;</span><span class="op" id="7485010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7485013">if</span>&nbsp;<span class="ident" id="7485016">reflect</span><span class="op" id="7485023">.</span><span class="ident" id="7485024">DeepEqual</span><span class="op" id="7485033">(</span><span class="ident" id="7485034">tok1</span><span class="op" id="7485038">,</span>&nbsp;<span class="ident" id="7485040">tok2</span><span class="op" id="7485044">)</span>&nbsp;<span class="op" id="7485046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7485050">t</span><span class="op" id="7485051">.</span><span class="ident" id="7485052">Error</span><span class="op" id="7485057">(</span><span class="string" id="7485058">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="7485097">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7485100">}</span><br>
<span class="lineno"></span><span class="op" id="7485102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7485105">func</span>&nbsp;<span class="ident" id="7485110">TestSyntaxErrorLineNum</span><span class="op" id="7485132">(</span><span class="ident" id="7485133">t</span>&nbsp;<span class="op" id="7485135">*</span><span class="ident" id="7485136">testing</span><span class="op" id="7485143">.</span><span class="ident" id="7485144">T</span><span class="op" id="7485145">)</span>&nbsp;<span class="op" id="7485147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7485150">testInput</span>&nbsp;<span class="op" id="7485160">:=</span>&nbsp;<span class="string" id="7485163">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7485191">d</span>&nbsp;<span class="op" id="7485193">:=</span>&nbsp;<span class="ident" id="7485196">NewDecoder</span><span class="op" id="7485206">(</span><span class="ident" id="7485207">strings</span><span class="op" id="7485214">.</span><span class="ident" id="7485215">NewReader</span><span class="op" id="7485224">(</span><span class="ident" id="7485225">testInput</span><span class="op" id="7485234">)</span><span class="op" id="7485235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7485238">var</span>&nbsp;<span class="ident" id="7485242">err</span>&nbsp;<span class="builtintype" id="7485246">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7485253">for</span>&nbsp;<span class="ident" id="7485257">_</span><span class="op" id="7485258">,</span>&nbsp;<span class="ident" id="7485260">err</span>&nbsp;<span class="op" id="7485264">=</span>&nbsp;<span class="ident" id="7485266">d</span><span class="op" id="7485267">.</span><span class="ident" id="7485268">Token</span><span class="op" id="7485273">(</span><span class="op" id="7485274">)</span><span class="op" id="7485275">;</span>&nbsp;<span class="ident" id="7485277">err</span>&nbsp;<span class="op" id="7485281">==</span>&nbsp;<span class="ident" id="7485284">nil</span><span class="op" id="7485287">;</span>&nbsp;<span class="ident" id="7485289">_</span><span class="op" id="7485290">,</span>&nbsp;<span class="ident" id="7485292">err</span>&nbsp;<span class="op" id="7485296">=</span>&nbsp;<span class="ident" id="7485298">d</span><span class="op" id="7485299">.</span><span class="ident" id="7485300">Token</span><span class="op" id="7485305">(</span><span class="op" id="7485306">)</span>&nbsp;<span class="op" id="7485308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7485311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7485314">synerr</span><span class="op" id="7485320">,</span>&nbsp;<span class="ident" id="7485322">ok</span>&nbsp;<span class="op" id="7485325">:=</span>&nbsp;<span class="ident" id="7485328">err</span><span class="op" id="7485331">.</span><span class="op" id="7485332">(</span><span class="op" id="7485333">*</span><span class="ident" id="7485334">SyntaxError</span><span class="op" id="7485345">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7485348">if</span>&nbsp;<span class="op" id="7485351">!</span><span class="ident" id="7485352">ok</span>&nbsp;<span class="op" id="7485355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7485359">t</span><span class="op" id="7485360">.</span><span class="ident" id="7485361">Error</span><span class="op" id="7485366">(</span><span class="string" id="7485367">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="7485390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7485393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7485396">if</span>&nbsp;<span class="ident" id="7485399">synerr</span><span class="op" id="7485405">.</span><span class="ident" id="7485406">Line</span>&nbsp;<span class="op" id="7485411">!=</span>&nbsp;<span class="num" id="7485414">3</span>&nbsp;<span class="op" id="7485416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7485420">t</span><span class="op" id="7485421">.</span><span class="ident" id="7485422">Error</span><span class="op" id="7485427">(</span><span class="string" id="7485428">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="7485474">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7485477">}</span><br>
<span class="lineno"></span><span class="op" id="7485479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7485482">func</span>&nbsp;<span class="ident" id="7485487">TestTrailingRawToken</span><span class="op" id="7485507">(</span><span class="ident" id="7485508">t</span>&nbsp;<span class="op" id="7485510">*</span><span class="ident" id="7485511">testing</span><span class="op" id="7485518">.</span><span class="ident" id="7485519">T</span><span class="op" id="7485520">)</span>&nbsp;<span class="op" id="7485522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7485525">input</span>&nbsp;<span class="op" id="7485531">:=</span>&nbsp;<span class="string" id="7485534">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7485551">d</span>&nbsp;<span class="op" id="7485553">:=</span>&nbsp;<span class="ident" id="7485556">NewDecoder</span><span class="op" id="7485566">(</span><span class="ident" id="7485567">strings</span><span class="op" id="7485574">.</span><span class="ident" id="7485575">NewReader</span><span class="op" id="7485584">(</span><span class="ident" id="7485585">input</span><span class="op" id="7485590">)</span><span class="op" id="7485591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7485594">var</span>&nbsp;<span class="ident" id="7485598">err</span>&nbsp;<span class="builtintype" id="7485602">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7485609">for</span>&nbsp;<span class="ident" id="7485613">_</span><span class="op" id="7485614">,</span>&nbsp;<span class="ident" id="7485616">err</span>&nbsp;<span class="op" id="7485620">=</span>&nbsp;<span class="ident" id="7485622">d</span><span class="op" id="7485623">.</span><span class="ident" id="7485624">RawToken</span><span class="op" id="7485632">(</span><span class="op" id="7485633">)</span><span class="op" id="7485634">;</span>&nbsp;<span class="ident" id="7485636">err</span>&nbsp;<span class="op" id="7485640">==</span>&nbsp;<span class="ident" id="7485643">nil</span><span class="op" id="7485646">;</span>&nbsp;<span class="ident" id="7485648">_</span><span class="op" id="7485649">,</span>&nbsp;<span class="ident" id="7485651">err</span>&nbsp;<span class="op" id="7485655">=</span>&nbsp;<span class="ident" id="7485657">d</span><span class="op" id="7485658">.</span><span class="ident" id="7485659">RawToken</span><span class="op" id="7485667">(</span><span class="op" id="7485668">)</span>&nbsp;<span class="op" id="7485670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7485673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7485676">if</span>&nbsp;<span class="ident" id="7485679">err</span>&nbsp;<span class="op" id="7485683">!=</span>&nbsp;<span class="ident" id="7485686">io</span><span class="op" id="7485688">.</span><span class="ident" id="7485689">EOF</span>&nbsp;<span class="op" id="7485693">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7485697">t</span><span class="op" id="7485698">.</span><span class="ident" id="7485699">Fatalf</span><span class="op" id="7485705">(</span><span class="string" id="7485706">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7485744">,</span>&nbsp;<span class="ident" id="7485746">err</span><span class="op" id="7485749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7485752">}</span><br>
<span class="lineno"></span><span class="op" id="7485754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7485757">func</span>&nbsp;<span class="ident" id="7485762">TestTrailingToken</span><span class="op" id="7485779">(</span><span class="ident" id="7485780">t</span>&nbsp;<span class="op" id="7485782">*</span><span class="ident" id="7485783">testing</span><span class="op" id="7485790">.</span><span class="ident" id="7485791">T</span><span class="op" id="7485792">)</span>&nbsp;<span class="op" id="7485794">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7485797">input</span>&nbsp;<span class="op" id="7485803">:=</span>&nbsp;<span class="string" id="7485806">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7485823">d</span>&nbsp;<span class="op" id="7485825">:=</span>&nbsp;<span class="ident" id="7485828">NewDecoder</span><span class="op" id="7485838">(</span><span class="ident" id="7485839">strings</span><span class="op" id="7485846">.</span><span class="ident" id="7485847">NewReader</span><span class="op" id="7485856">(</span><span class="ident" id="7485857">input</span><span class="op" id="7485862">)</span><span class="op" id="7485863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7485866">var</span>&nbsp;<span class="ident" id="7485870">err</span>&nbsp;<span class="builtintype" id="7485874">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7485881">for</span>&nbsp;<span class="ident" id="7485885">_</span><span class="op" id="7485886">,</span>&nbsp;<span class="ident" id="7485888">err</span>&nbsp;<span class="op" id="7485892">=</span>&nbsp;<span class="ident" id="7485894">d</span><span class="op" id="7485895">.</span><span class="ident" id="7485896">Token</span><span class="op" id="7485901">(</span><span class="op" id="7485902">)</span><span class="op" id="7485903">;</span>&nbsp;<span class="ident" id="7485905">err</span>&nbsp;<span class="op" id="7485909">==</span>&nbsp;<span class="ident" id="7485912">nil</span><span class="op" id="7485915">;</span>&nbsp;<span class="ident" id="7485917">_</span><span class="op" id="7485918">,</span>&nbsp;<span class="ident" id="7485920">err</span>&nbsp;<span class="op" id="7485924">=</span>&nbsp;<span class="ident" id="7485926">d</span><span class="op" id="7485927">.</span><span class="ident" id="7485928">Token</span><span class="op" id="7485933">(</span><span class="op" id="7485934">)</span>&nbsp;<span class="op" id="7485936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7485939">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7485942">if</span>&nbsp;<span class="ident" id="7485945">err</span>&nbsp;<span class="op" id="7485949">!=</span>&nbsp;<span class="ident" id="7485952">io</span><span class="op" id="7485954">.</span><span class="ident" id="7485955">EOF</span>&nbsp;<span class="op" id="7485959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7485963">t</span><span class="op" id="7485964">.</span><span class="ident" id="7485965">Fatalf</span><span class="op" id="7485971">(</span><span class="string" id="7485972">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7486007">,</span>&nbsp;<span class="ident" id="7486009">err</span><span class="op" id="7486012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7486015">}</span><br>
<span class="lineno"></span><span class="op" id="7486017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="7486020">func</span>&nbsp;<span class="ident" id="7486025">TestEntityInsideCDATA</span><span class="op" id="7486046">(</span><span class="ident" id="7486047">t</span>&nbsp;<span class="op" id="7486049">*</span><span class="ident" id="7486050">testing</span><span class="op" id="7486057">.</span><span class="ident" id="7486058">T</span><span class="op" id="7486059">)</span>&nbsp;<span class="op" id="7486061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7486064">input</span>&nbsp;<span class="op" id="7486070">:=</span>&nbsp;<span class="string" id="7486073">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7486112">d</span>&nbsp;<span class="op" id="7486114">:=</span>&nbsp;<span class="ident" id="7486117">NewDecoder</span><span class="op" id="7486127">(</span><span class="ident" id="7486128">strings</span><span class="op" id="7486135">.</span><span class="ident" id="7486136">NewReader</span><span class="op" id="7486145">(</span><span class="ident" id="7486146">input</span><span class="op" id="7486151">)</span><span class="op" id="7486152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7486155">var</span>&nbsp;<span class="ident" id="7486159">err</span>&nbsp;<span class="builtintype" id="7486163">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7486170">for</span>&nbsp;<span class="ident" id="7486174">_</span><span class="op" id="7486175">,</span>&nbsp;<span class="ident" id="7486177">err</span>&nbsp;<span class="op" id="7486181">=</span>&nbsp;<span class="ident" id="7486183">d</span><span class="op" id="7486184">.</span><span class="ident" id="7486185">Token</span><span class="op" id="7486190">(</span><span class="op" id="7486191">)</span><span class="op" id="7486192">;</span>&nbsp;<span class="ident" id="7486194">err</span>&nbsp;<span class="op" id="7486198">==</span>&nbsp;<span class="ident" id="7486201">nil</span><span class="op" id="7486204">;</span>&nbsp;<span class="ident" id="7486206">_</span><span class="op" id="7486207">,</span>&nbsp;<span class="ident" id="7486209">err</span>&nbsp;<span class="op" id="7486213">=</span>&nbsp;<span class="ident" id="7486215">d</span><span class="op" id="7486216">.</span><span class="ident" id="7486217">Token</span><span class="op" id="7486222">(</span><span class="op" id="7486223">)</span>&nbsp;<span class="op" id="7486225">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7486228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7486231">if</span>&nbsp;<span class="ident" id="7486234">err</span>&nbsp;<span class="op" id="7486238">!=</span>&nbsp;<span class="ident" id="7486241">io</span><span class="op" id="7486243">.</span><span class="ident" id="7486244">EOF</span>&nbsp;<span class="op" id="7486248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7486252">t</span><span class="op" id="7486253">.</span><span class="ident" id="7486254">Fatalf</span><span class="op" id="7486260">(</span><span class="string" id="7486261">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="7486296">,</span>&nbsp;<span class="ident" id="7486298">err</span><span class="op" id="7486301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7486304">}</span><br>
<span class="lineno"></span><span class="op" id="7486306">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="7486309">var</span>&nbsp;<span class="ident" id="7486313">characterTests</span>&nbsp;<span class="op" id="7486328">=</span>&nbsp;<span class="op" id="7486330">[</span><span class="op" id="7486331">]</span><span class="keyword" id="7486332">struct</span>&nbsp;<span class="op" id="7486339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7486342">in</span>&nbsp;&nbsp;<span class="builtintype" id="7486346">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7486354">err</span>&nbsp;<span class="builtintype" id="7486358">string</span><br>
<span class="lineno"></span><span class="op" id="7486365">}</span><span class="op" id="7486366">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7486369">{</span><span class="string" id="7486370">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="7486382">,</span>&nbsp;<span class="string" id="7486384">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="7486415">}</span><span class="op" id="7486416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7486419">{</span><span class="string" id="7486420">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="7486455">,</span>&nbsp;<span class="string" id="7486457">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="7486488">}</span><span class="op" id="7486489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7486492">{</span><span class="string" id="7486493">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="7486513">,</span>&nbsp;<span class="string" id="7486515">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="7486546">}</span><span class="op" id="7486547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7486550">{</span><span class="string" id="7486551">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="7486610">,</span>&nbsp;<span class="string" id="7486612">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="7486643">}</span><span class="op" id="7486644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7486647">{</span><span class="string" id="7486648">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="7486706">,</span>&nbsp;<span class="string" id="7486708">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="7486744">}</span><span class="op" id="7486745">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7486748">{</span><span class="string" id="7486749">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="7486771">,</span>&nbsp;<span class="string" id="7486773">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="7486819">}</span><span class="op" id="7486820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7486823">{</span><span class="string" id="7486824">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="7486843">,</span>&nbsp;<span class="string" id="7486845">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="7486888">}</span><span class="op" id="7486889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7486892">{</span><span class="string" id="7486893">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="7486920">,</span>&nbsp;<span class="string" id="7486922">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="7486957">}</span><span class="op" id="7486958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7486961">{</span><span class="string" id="7486962">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="7486982">,</span>&nbsp;<span class="string" id="7486984">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="7487018">}</span><span class="op" id="7487019">,</span><br>
<span class="lineno"></span><span class="op" id="7487021">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="7487024">func</span>&nbsp;<span class="ident" id="7487029">TestDisallowedCharacters</span><span class="op" id="7487053">(</span><span class="ident" id="7487054">t</span>&nbsp;<span class="op" id="7487056">*</span><span class="ident" id="7487057">testing</span><span class="op" id="7487064">.</span><span class="ident" id="7487065">T</span><span class="op" id="7487066">)</span>&nbsp;<span class="op" id="7487068">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7487072">for</span>&nbsp;<span class="ident" id="7487076">i</span><span class="op" id="7487077">,</span>&nbsp;<span class="ident" id="7487079">tt</span>&nbsp;<span class="op" id="7487082">:=</span>&nbsp;<span class="keyword" id="7487085">range</span>&nbsp;<span class="ident" id="7487091">characterTests</span>&nbsp;<span class="op" id="7487106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487110">d</span>&nbsp;<span class="op" id="7487112">:=</span>&nbsp;<span class="ident" id="7487115">NewDecoder</span><span class="op" id="7487125">(</span><span class="ident" id="7487126">strings</span><span class="op" id="7487133">.</span><span class="ident" id="7487134">NewReader</span><span class="op" id="7487143">(</span><span class="ident" id="7487144">tt</span><span class="op" id="7487146">.</span><span class="ident" id="7487147">in</span><span class="op" id="7487149">)</span><span class="op" id="7487150">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7487154">var</span>&nbsp;<span class="ident" id="7487158">err</span>&nbsp;<span class="builtintype" id="7487162">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7487171">for</span>&nbsp;<span class="ident" id="7487175">err</span>&nbsp;<span class="op" id="7487179">==</span>&nbsp;<span class="ident" id="7487182">nil</span>&nbsp;<span class="op" id="7487186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487191">_</span><span class="op" id="7487192">,</span>&nbsp;<span class="ident" id="7487194">err</span>&nbsp;<span class="op" id="7487198">=</span>&nbsp;<span class="ident" id="7487200">d</span><span class="op" id="7487201">.</span><span class="ident" id="7487202">Token</span><span class="op" id="7487207">(</span><span class="op" id="7487208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487212">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487216">synerr</span><span class="op" id="7487222">,</span>&nbsp;<span class="ident" id="7487224">ok</span>&nbsp;<span class="op" id="7487227">:=</span>&nbsp;<span class="ident" id="7487230">err</span><span class="op" id="7487233">.</span><span class="op" id="7487234">(</span><span class="op" id="7487235">*</span><span class="ident" id="7487236">SyntaxError</span><span class="op" id="7487247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7487251">if</span>&nbsp;<span class="op" id="7487254">!</span><span class="ident" id="7487255">ok</span>&nbsp;<span class="op" id="7487258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487263">t</span><span class="op" id="7487264">.</span><span class="ident" id="7487265">Fatalf</span><span class="op" id="7487271">(</span><span class="string" id="7487272">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="7487322">,</span>&nbsp;<span class="ident" id="7487324">i</span><span class="op" id="7487325">,</span>&nbsp;<span class="ident" id="7487327">err</span><span class="op" id="7487330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7487338">if</span>&nbsp;<span class="ident" id="7487341">synerr</span><span class="op" id="7487347">.</span><span class="ident" id="7487348">Msg</span>&nbsp;<span class="op" id="7487352">!=</span>&nbsp;<span class="ident" id="7487355">tt</span><span class="op" id="7487357">.</span><span class="ident" id="7487358">err</span>&nbsp;<span class="op" id="7487362">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487367">t</span><span class="op" id="7487368">.</span><span class="ident" id="7487369">Fatalf</span><span class="op" id="7487375">(</span><span class="string" id="7487376">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7487420">,</span>&nbsp;<span class="ident" id="7487422">i</span><span class="op" id="7487423">,</span>&nbsp;<span class="ident" id="7487425">tt</span><span class="op" id="7487427">.</span><span class="ident" id="7487428">err</span><span class="op" id="7487431">,</span>&nbsp;<span class="ident" id="7487433">synerr</span><span class="op" id="7487439">.</span><span class="ident" id="7487440">Msg</span><span class="op" id="7487443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487450">}</span><br>
<span class="lineno"></span><span class="op" id="7487452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="7487455">type</span>&nbsp;<span class="ident" id="7487460">procInstEncodingTest</span>&nbsp;<span class="keyword" id="7487481">struct</span>&nbsp;<span class="op" id="7487488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487491">expect</span><span class="op" id="7487497">,</span>&nbsp;<span class="ident" id="7487499">got</span>&nbsp;<span class="builtintype" id="7487503">string</span><br>
<span class="lineno"></span><span class="op" id="7487510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7487513">var</span>&nbsp;<span class="ident" id="7487517">procInstTests</span>&nbsp;<span class="op" id="7487531">=</span>&nbsp;<span class="op" id="7487533">[</span><span class="op" id="7487534">]</span><span class="keyword" id="7487535">struct</span>&nbsp;<span class="op" id="7487542">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487545">input</span><span class="op" id="7487550">,</span>&nbsp;<span class="ident" id="7487552">expect</span>&nbsp;<span class="builtintype" id="7487559">string</span><br>
<span class="lineno"></span><span class="op" id="7487566">}</span><span class="op" id="7487567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487570">{</span><span class="string" id="7487571">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="7487603">,</span>&nbsp;<span class="string" id="7487605">&#34;utf-8&#34;</span><span class="op" id="7487612">}</span><span class="op" id="7487613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487616">{</span><span class="string" id="7487617">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="7487649">,</span>&nbsp;<span class="string" id="7487651">&#34;utf-8&#34;</span><span class="op" id="7487658">}</span><span class="op" id="7487659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487662">{</span><span class="string" id="7487663">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="7487696">,</span>&nbsp;<span class="string" id="7487698">&#34;utf-8&#34;</span><span class="op" id="7487705">}</span><span class="op" id="7487706">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487709">{</span><span class="string" id="7487710">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="7487740">,</span>&nbsp;<span class="string" id="7487742">&#34;&#34;</span><span class="op" id="7487744">}</span><span class="op" id="7487745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7487748">{</span><span class="string" id="7487749">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="7487766">,</span>&nbsp;<span class="string" id="7487768">&#34;FOO&#34;</span><span class="op" id="7487773">}</span><span class="op" id="7487774">,</span><br>
<span class="lineno"></span><span class="op" id="7487776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7487779">func</span>&nbsp;<span class="ident" id="7487784">TestProcInstEncoding</span><span class="op" id="7487804">(</span><span class="ident" id="7487805">t</span>&nbsp;<span class="op" id="7487807">*</span><span class="ident" id="7487808">testing</span><span class="op" id="7487815">.</span><span class="ident" id="7487816">T</span><span class="op" id="7487817">)</span>&nbsp;<span class="op" id="7487819">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7487822">for</span>&nbsp;<span class="ident" id="7487826">_</span><span class="op" id="7487827">,</span>&nbsp;<span class="ident" id="7487829">test</span>&nbsp;<span class="op" id="7487834">:=</span>&nbsp;<span class="keyword" id="7487837">range</span>&nbsp;<span class="ident" id="7487843">procInstTests</span>&nbsp;<span class="op" id="7487857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487861">got</span>&nbsp;<span class="op" id="7487865">:=</span>&nbsp;<span class="ident" id="7487868">procInstEncoding</span><span class="op" id="7487884">(</span><span class="ident" id="7487885">test</span><span class="op" id="7487889">.</span><span class="ident" id="7487890">input</span><span class="op" id="7487895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7487899">if</span>&nbsp;<span class="ident" id="7487902">got</span>&nbsp;<span class="op" id="7487906">!=</span>&nbsp;<span class="ident" id="7487909">test</span><span class="op" id="7487913">.</span><span class="ident" id="7487914">expect</span>&nbsp;<span class="op" id="7487921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7487926">t</span><span class="op" id="7487927">.</span><span class="ident" id="7487928">Errorf</span><span class="op" id="7487934">(</span><span class="string" id="7487935">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7487971">,</span>&nbsp;<span class="ident" id="7487973">test</span><span class="op" id="7487977">.</span><span class="ident" id="7487978">input</span><span class="op" id="7487983">,</span>&nbsp;<span class="ident" id="7487985">got</span><span class="op" id="7487988">,</span>&nbsp;<span class="ident" id="7487990">test</span><span class="op" id="7487994">.</span><span class="ident" id="7487995">expect</span><span class="op" id="7488001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7488005">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7488008">}</span><br>
<span class="lineno"></span><span class="op" id="7488010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7488013">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="7488074">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7488109">var</span>&nbsp;<span class="ident" id="7488113">directivesWithCommentsInput</span>&nbsp;<span class="op" id="7488141">=</span>&nbsp;<span class="string" id="7488143">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7488379">var</span>&nbsp;<span class="ident" id="7488383">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="7488412">=</span>&nbsp;<span class="op" id="7488414">[</span><span class="op" id="7488415">]</span><span class="ident" id="7488416">Token</span><span class="op" id="7488421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488424">CharData</span><span class="op" id="7488432">(</span><span class="string" id="7488433">&#34;\n&#34;</span><span class="op" id="7488437">)</span><span class="op" id="7488438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488441">Directive</span><span class="op" id="7488450">(</span><span class="string" id="7488451">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="7488522">)</span><span class="op" id="7488523">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488526">CharData</span><span class="op" id="7488534">(</span><span class="string" id="7488535">&#34;\n&#34;</span><span class="op" id="7488539">)</span><span class="op" id="7488540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488543">Directive</span><span class="op" id="7488552">(</span><span class="string" id="7488553">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="7488586">)</span><span class="op" id="7488587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488590">CharData</span><span class="op" id="7488598">(</span><span class="string" id="7488599">&#34;\n&#34;</span><span class="op" id="7488603">)</span><span class="op" id="7488604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488607">Directive</span><span class="op" id="7488616">(</span><span class="string" id="7488617">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="7488662">)</span><span class="op" id="7488663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488666">CharData</span><span class="op" id="7488674">(</span><span class="string" id="7488675">&#34;\n&#34;</span><span class="op" id="7488679">)</span><span class="op" id="7488680">,</span><br>
<span class="lineno">695</span><span class="op" id="7488682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7488685">func</span>&nbsp;<span class="ident" id="7488690">TestDirectivesWithComments</span><span class="op" id="7488716">(</span><span class="ident" id="7488717">t</span>&nbsp;<span class="op" id="7488719">*</span><span class="ident" id="7488720">testing</span><span class="op" id="7488727">.</span><span class="ident" id="7488728">T</span><span class="op" id="7488729">)</span>&nbsp;<span class="op" id="7488731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488734">d</span>&nbsp;<span class="op" id="7488736">:=</span>&nbsp;<span class="ident" id="7488739">NewDecoder</span><span class="op" id="7488749">(</span><span class="ident" id="7488750">strings</span><span class="op" id="7488757">.</span><span class="ident" id="7488758">NewReader</span><span class="op" id="7488767">(</span><span class="ident" id="7488768">directivesWithCommentsInput</span><span class="op" id="7488795">)</span><span class="op" id="7488796">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488800">for</span>&nbsp;<span class="ident" id="7488804">i</span><span class="op" id="7488805">,</span>&nbsp;<span class="ident" id="7488807">want</span>&nbsp;<span class="op" id="7488812">:=</span>&nbsp;<span class="keyword" id="7488815">range</span>&nbsp;<span class="ident" id="7488821">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="7488850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488854">have</span><span class="op" id="7488858">,</span>&nbsp;<span class="ident" id="7488860">err</span>&nbsp;<span class="op" id="7488864">:=</span>&nbsp;<span class="ident" id="7488867">d</span><span class="op" id="7488868">.</span><span class="ident" id="7488869">Token</span><span class="op" id="7488874">(</span><span class="op" id="7488875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488879">if</span>&nbsp;<span class="ident" id="7488882">err</span>&nbsp;<span class="op" id="7488886">!=</span>&nbsp;<span class="ident" id="7488889">nil</span>&nbsp;<span class="op" id="7488893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488898">t</span><span class="op" id="7488899">.</span><span class="ident" id="7488900">Fatalf</span><span class="op" id="7488906">(</span><span class="string" id="7488907">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="7488939">,</span>&nbsp;<span class="ident" id="7488941">i</span><span class="op" id="7488942">,</span>&nbsp;<span class="ident" id="7488944">err</span><span class="op" id="7488947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7488951">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7488955">if</span>&nbsp;<span class="op" id="7488958">!</span><span class="ident" id="7488959">reflect</span><span class="op" id="7488966">.</span><span class="ident" id="7488967">DeepEqual</span><span class="op" id="7488976">(</span><span class="ident" id="7488977">have</span><span class="op" id="7488981">,</span>&nbsp;<span class="ident" id="7488983">want</span><span class="op" id="7488987">)</span>&nbsp;<span class="op" id="7488989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7488994">t</span><span class="op" id="7488995">.</span><span class="ident" id="7488996">Errorf</span><span class="op" id="7489002">(</span><span class="string" id="7489003">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="7489028">,</span>&nbsp;<span class="ident" id="7489030">i</span><span class="op" id="7489031">,</span>&nbsp;<span class="ident" id="7489033">have</span><span class="op" id="7489037">,</span>&nbsp;<span class="ident" id="7489039">want</span><span class="op" id="7489043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7489047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7489050">}</span><br>
<span class="lineno"></span><span class="op" id="7489052">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="7489055">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="7489109">type</span>&nbsp;<span class="ident" id="7489114">errWriter</span>&nbsp;<span class="keyword" id="7489124">struct</span><span class="op" id="7489130">{</span><span class="op" id="7489131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7489134">func</span>&nbsp;<span class="op" id="7489139">(</span><span class="ident" id="7489140">errWriter</span><span class="op" id="7489149">)</span>&nbsp;<span class="ident" id="7489151">Write</span><span class="op" id="7489156">(</span><span class="ident" id="7489157">p</span>&nbsp;<span class="op" id="7489159">[</span><span class="op" id="7489160">]</span><span class="builtintype" id="7489161">byte</span><span class="op" id="7489165">)</span>&nbsp;<span class="op" id="7489167">(</span><span class="ident" id="7489168">n</span>&nbsp;<span class="builtintype" id="7489170">int</span><span class="op" id="7489173">,</span>&nbsp;<span class="ident" id="7489175">err</span>&nbsp;<span class="builtintype" id="7489179">error</span><span class="op" id="7489184">)</span>&nbsp;<span class="op" id="7489186">{</span>&nbsp;<span class="keyword" id="7489188">return</span>&nbsp;<span class="num" id="7489195">0</span><span class="op" id="7489196">,</span>&nbsp;<span class="ident" id="7489198">fmt</span><span class="op" id="7489201">.</span><span class="ident" id="7489202">Errorf</span><span class="op" id="7489208">(</span><span class="string" id="7489209">&#34;unwritable&#34;</span><span class="op" id="7489221">)</span>&nbsp;<span class="op" id="7489223">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="7489226">func</span>&nbsp;<span class="ident" id="7489231">TestEscapeTextIOErrors</span><span class="op" id="7489253">(</span><span class="ident" id="7489254">t</span>&nbsp;<span class="op" id="7489256">*</span><span class="ident" id="7489257">testing</span><span class="op" id="7489264">.</span><span class="ident" id="7489265">T</span><span class="op" id="7489266">)</span>&nbsp;<span class="op" id="7489268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489271">expectErr</span>&nbsp;<span class="op" id="7489281">:=</span>&nbsp;<span class="string" id="7489284">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489298">err</span>&nbsp;<span class="op" id="7489302">:=</span>&nbsp;<span class="ident" id="7489305">EscapeText</span><span class="op" id="7489315">(</span><span class="ident" id="7489316">errWriter</span><span class="op" id="7489325">{</span><span class="op" id="7489326">}</span><span class="op" id="7489327">,</span>&nbsp;<span class="op" id="7489329">[</span><span class="op" id="7489330">]</span><span class="builtintype" id="7489331">byte</span><span class="op" id="7489335">{</span><span class="string" id="7489336">&#39;A&#39;</span><span class="op" id="7489339">}</span><span class="op" id="7489340">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7489344">if</span>&nbsp;<span class="ident" id="7489347">err</span>&nbsp;<span class="op" id="7489351">==</span>&nbsp;<span class="ident" id="7489354">nil</span>&nbsp;<span class="op" id="7489358">||</span>&nbsp;<span class="ident" id="7489361">err</span><span class="op" id="7489364">.</span><span class="ident" id="7489365">Error</span><span class="op" id="7489370">(</span><span class="op" id="7489371">)</span>&nbsp;<span class="op" id="7489373">!=</span>&nbsp;<span class="ident" id="7489376">expectErr</span>&nbsp;<span class="op" id="7489386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489390">t</span><span class="op" id="7489391">.</span><span class="ident" id="7489392">Errorf</span><span class="op" id="7489398">(</span><span class="string" id="7489399">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7489417">,</span>&nbsp;<span class="ident" id="7489419">err</span><span class="op" id="7489422">,</span>&nbsp;<span class="ident" id="7489424">expectErr</span><span class="op" id="7489433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7489436">}</span><br>
<span class="lineno"></span><span class="op" id="7489438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="7489441">func</span>&nbsp;<span class="ident" id="7489446">TestEscapeTextInvalidChar</span><span class="op" id="7489471">(</span><span class="ident" id="7489472">t</span>&nbsp;<span class="op" id="7489474">*</span><span class="ident" id="7489475">testing</span><span class="op" id="7489482">.</span><span class="ident" id="7489483">T</span><span class="op" id="7489484">)</span>&nbsp;<span class="op" id="7489486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489489">input</span>&nbsp;<span class="op" id="7489495">:=</span>&nbsp;<span class="op" id="7489498">[</span><span class="op" id="7489499">]</span><span class="builtintype" id="7489500">byte</span><span class="op" id="7489504">(</span><span class="string" id="7489505">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="7489532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489535">expected</span>&nbsp;<span class="op" id="7489544">:=</span>&nbsp;<span class="string" id="7489547">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489579">buff</span>&nbsp;<span class="op" id="7489584">:=</span>&nbsp;<span class="builtinfunc" id="7489587">new</span><span class="op" id="7489590">(</span><span class="ident" id="7489591">bytes</span><span class="op" id="7489596">.</span><span class="ident" id="7489597">Buffer</span><span class="op" id="7489603">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7489606">if</span>&nbsp;<span class="ident" id="7489609">err</span>&nbsp;<span class="op" id="7489613">:=</span>&nbsp;<span class="ident" id="7489616">EscapeText</span><span class="op" id="7489626">(</span><span class="ident" id="7489627">buff</span><span class="op" id="7489631">,</span>&nbsp;<span class="ident" id="7489633">input</span><span class="op" id="7489638">)</span><span class="op" id="7489639">;</span>&nbsp;<span class="ident" id="7489641">err</span>&nbsp;<span class="op" id="7489645">!=</span>&nbsp;<span class="ident" id="7489648">nil</span>&nbsp;<span class="op" id="7489652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489656">t</span><span class="op" id="7489657">.</span><span class="ident" id="7489658">Fatalf</span><span class="op" id="7489664">(</span><span class="string" id="7489665">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="7489684">,</span>&nbsp;<span class="ident" id="7489686">err</span><span class="op" id="7489689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7489692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489695">text</span>&nbsp;<span class="op" id="7489700">:=</span>&nbsp;<span class="ident" id="7489703">buff</span><span class="op" id="7489707">.</span><span class="ident" id="7489708">String</span><span class="op" id="7489714">(</span><span class="op" id="7489715">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7489719">if</span>&nbsp;<span class="ident" id="7489722">text</span>&nbsp;<span class="op" id="7489727">!=</span>&nbsp;<span class="ident" id="7489730">expected</span>&nbsp;<span class="op" id="7489739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489743">t</span><span class="op" id="7489744">.</span><span class="ident" id="7489745">Errorf</span><span class="op" id="7489751">(</span><span class="string" id="7489752">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7489770">,</span>&nbsp;<span class="ident" id="7489772">text</span><span class="op" id="7489776">,</span>&nbsp;<span class="ident" id="7489778">expected</span><span class="op" id="7489786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7489789">}</span><br>
<span class="lineno"></span><span class="op" id="7489791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="7489794">func</span>&nbsp;<span class="ident" id="7489799">TestIssue5880</span><span class="op" id="7489812">(</span><span class="ident" id="7489813">t</span>&nbsp;<span class="op" id="7489815">*</span><span class="ident" id="7489816">testing</span><span class="op" id="7489823">.</span><span class="ident" id="7489824">T</span><span class="op" id="7489825">)</span>&nbsp;<span class="op" id="7489827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7489830">type</span>&nbsp;<span class="ident" id="7489835">T</span>&nbsp;<span class="op" id="7489837">[</span><span class="op" id="7489838">]</span><span class="builtintype" id="7489839">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489845">data</span><span class="op" id="7489849">,</span>&nbsp;<span class="ident" id="7489851">err</span>&nbsp;<span class="op" id="7489855">:=</span>&nbsp;<span class="ident" id="7489858">Marshal</span><span class="op" id="7489865">(</span><span class="ident" id="7489866">T</span><span class="op" id="7489867">{</span><span class="num" id="7489868">192</span><span class="op" id="7489871">,</span>&nbsp;<span class="num" id="7489873">168</span><span class="op" id="7489876">,</span>&nbsp;<span class="num" id="7489878">0</span><span class="op" id="7489879">,</span>&nbsp;<span class="num" id="7489881">1</span><span class="op" id="7489882">}</span><span class="op" id="7489883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7489886">if</span>&nbsp;<span class="ident" id="7489889">err</span>&nbsp;<span class="op" id="7489893">!=</span>&nbsp;<span class="ident" id="7489896">nil</span>&nbsp;<span class="op" id="7489900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489904">t</span><span class="op" id="7489905">.</span><span class="ident" id="7489906">Errorf</span><span class="op" id="7489912">(</span><span class="string" id="7489913">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7489932">,</span>&nbsp;<span class="ident" id="7489934">err</span><span class="op" id="7489937">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7489940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7489943">if</span>&nbsp;<span class="op" id="7489946">!</span><span class="ident" id="7489947">utf8</span><span class="op" id="7489951">.</span><span class="ident" id="7489952">Valid</span><span class="op" id="7489957">(</span><span class="ident" id="7489958">data</span><span class="op" id="7489962">)</span>&nbsp;<span class="op" id="7489964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7489968">t</span><span class="op" id="7489969">.</span><span class="ident" id="7489970">Errorf</span><span class="op" id="7489976">(</span><span class="string" id="7489977">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="7490014">,</span>&nbsp;<span class="ident" id="7490016">data</span><span class="op" id="7490020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7490023">}</span><br>
<span class="lineno"></span><span class="op" id="7490025">}</span>
</div>
</body>
</html>
