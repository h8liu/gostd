<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html" class="current">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2753058">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2753113">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2753167">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2753218">//&nbsp;Parse&nbsp;&#34;zoneinfo&#34;&nbsp;time&nbsp;zone&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2753254">//&nbsp;This&nbsp;is&nbsp;a&nbsp;fairly&nbsp;standard&nbsp;file&nbsp;format&nbsp;used&nbsp;on&nbsp;OS&nbsp;X,&nbsp;Linux,&nbsp;BSD,&nbsp;Sun,&nbsp;and&nbsp;others.</span><br>
<span class="lineno"></span><span class="comment" id="2753338">//&nbsp;See&nbsp;tzfile(5),&nbsp;http://en.wikipedia.org/wiki/Zoneinfo,</span><br>
<span class="lineno"></span><span class="comment" id="2753395">//&nbsp;and&nbsp;ftp://munnari.oz.au/pub/oldtz/</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2753434">package</span>&nbsp;<span class="ident" id="2753442">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2753448">import</span>&nbsp;<span class="string" id="2753455">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2753465">//&nbsp;Simple&nbsp;I/O&nbsp;interface&nbsp;to&nbsp;binary&nbsp;blob&nbsp;of&nbsp;data.</span><br>
<span class="lineno">15</span><span class="keyword" id="2753513">type</span>&nbsp;<span class="ident" id="2753518">data</span>&nbsp;<span class="keyword" id="2753523">struct</span>&nbsp;<span class="op" id="2753530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2753533">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2753539">[</span><span class="op" id="2753540">]</span><span class="builtintype" id="2753541">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2753547">error</span>&nbsp;<span class="builtintype" id="2753553">bool</span><br>
<span class="lineno"></span><span class="op" id="2753558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="2753561">func</span>&nbsp;<span class="op" id="2753566">(</span><span class="ident" id="2753567">d</span>&nbsp;<span class="op" id="2753569">*</span><span class="ident" id="2753570">data</span><span class="op" id="2753574">)</span>&nbsp;<span class="ident" id="2753576">read</span><span class="op" id="2753580">(</span><span class="ident" id="2753581">n</span>&nbsp;<span class="builtintype" id="2753583">int</span><span class="op" id="2753586">)</span>&nbsp;<span class="op" id="2753588">[</span><span class="op" id="2753589">]</span><span class="builtintype" id="2753590">byte</span>&nbsp;<span class="op" id="2753595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2753598">if</span>&nbsp;<span class="builtinfunc" id="2753601">len</span><span class="op" id="2753604">(</span><span class="ident" id="2753605">d</span><span class="op" id="2753606">.</span><span class="ident" id="2753607">p</span><span class="op" id="2753608">)</span>&nbsp;<span class="op" id="2753610">&lt;</span>&nbsp;<span class="ident" id="2753612">n</span>&nbsp;<span class="op" id="2753614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2753618">d</span><span class="op" id="2753619">.</span><span class="ident" id="2753620">p</span>&nbsp;<span class="op" id="2753622">=</span>&nbsp;<span class="builtintype" id="2753624">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2753630">d</span><span class="op" id="2753631">.</span><span class="builtintype" id="2753632">error</span>&nbsp;<span class="op" id="2753638">=</span>&nbsp;<span class="builtintype" id="2753640">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2753647">return</span>&nbsp;<span class="builtintype" id="2753654">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2753659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2753662">p</span>&nbsp;<span class="op" id="2753664">:=</span>&nbsp;<span class="ident" id="2753667">d</span><span class="op" id="2753668">.</span><span class="ident" id="2753669">p</span><span class="op" id="2753670">[</span><span class="num" id="2753671">0</span><span class="op" id="2753672">:</span><span class="ident" id="2753673">n</span><span class="op" id="2753674">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2753677">d</span><span class="op" id="2753678">.</span><span class="ident" id="2753679">p</span>&nbsp;<span class="op" id="2753681">=</span>&nbsp;<span class="ident" id="2753683">d</span><span class="op" id="2753684">.</span><span class="ident" id="2753685">p</span><span class="op" id="2753686">[</span><span class="ident" id="2753687">n</span><span class="op" id="2753688">:</span><span class="op" id="2753689">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2753692">return</span>&nbsp;<span class="ident" id="2753699">p</span><br>
<span class="lineno"></span><span class="op" id="2753701">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2753704">func</span>&nbsp;<span class="op" id="2753709">(</span><span class="ident" id="2753710">d</span>&nbsp;<span class="op" id="2753712">*</span><span class="ident" id="2753713">data</span><span class="op" id="2753717">)</span>&nbsp;<span class="ident" id="2753719">big4</span><span class="op" id="2753723">(</span><span class="op" id="2753724">)</span>&nbsp;<span class="op" id="2753726">(</span><span class="ident" id="2753727">n</span>&nbsp;<span class="builtintype" id="2753729">uint32</span><span class="op" id="2753735">,</span>&nbsp;<span class="ident" id="2753737">ok</span>&nbsp;<span class="builtintype" id="2753740">bool</span><span class="op" id="2753744">)</span>&nbsp;<span class="op" id="2753746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2753749">p</span>&nbsp;<span class="op" id="2753751">:=</span>&nbsp;<span class="ident" id="2753754">d</span><span class="op" id="2753755">.</span><span class="ident" id="2753756">read</span><span class="op" id="2753760">(</span><span class="num" id="2753761">4</span><span class="op" id="2753762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2753765">if</span>&nbsp;<span class="builtinfunc" id="2753768">len</span><span class="op" id="2753771">(</span><span class="ident" id="2753772">p</span><span class="op" id="2753773">)</span>&nbsp;<span class="op" id="2753775">&lt;</span>&nbsp;<span class="num" id="2753777">4</span>&nbsp;<span class="op" id="2753779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2753783">d</span><span class="op" id="2753784">.</span><span class="builtintype" id="2753785">error</span>&nbsp;<span class="op" id="2753791">=</span>&nbsp;<span class="builtintype" id="2753793">true</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2753800">return</span>&nbsp;<span class="num" id="2753807">0</span><span class="op" id="2753808">,</span>&nbsp;<span class="builtintype" id="2753810">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2753817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2753820">return</span>&nbsp;<span class="builtintype" id="2753827">uint32</span><span class="op" id="2753833">(</span><span class="ident" id="2753834">p</span><span class="op" id="2753835">[</span><span class="num" id="2753836">0</span><span class="op" id="2753837">]</span><span class="op" id="2753838">)</span><span class="op" id="2753839">&lt;&lt;</span><span class="num" id="2753841">24</span>&nbsp;<span class="op" id="2753844">|</span>&nbsp;<span class="builtintype" id="2753846">uint32</span><span class="op" id="2753852">(</span><span class="ident" id="2753853">p</span><span class="op" id="2753854">[</span><span class="num" id="2753855">1</span><span class="op" id="2753856">]</span><span class="op" id="2753857">)</span><span class="op" id="2753858">&lt;&lt;</span><span class="num" id="2753860">16</span>&nbsp;<span class="op" id="2753863">|</span>&nbsp;<span class="builtintype" id="2753865">uint32</span><span class="op" id="2753871">(</span><span class="ident" id="2753872">p</span><span class="op" id="2753873">[</span><span class="num" id="2753874">2</span><span class="op" id="2753875">]</span><span class="op" id="2753876">)</span><span class="op" id="2753877">&lt;&lt;</span><span class="num" id="2753879">8</span>&nbsp;<span class="op" id="2753881">|</span>&nbsp;<span class="builtintype" id="2753883">uint32</span><span class="op" id="2753889">(</span><span class="ident" id="2753890">p</span><span class="op" id="2753891">[</span><span class="num" id="2753892">3</span><span class="op" id="2753893">]</span><span class="op" id="2753894">)</span><span class="op" id="2753895">,</span>&nbsp;<span class="builtintype" id="2753897">true</span><br>
<span class="lineno"></span><span class="op" id="2753902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2753905">func</span>&nbsp;<span class="op" id="2753910">(</span><span class="ident" id="2753911">d</span>&nbsp;<span class="op" id="2753913">*</span><span class="ident" id="2753914">data</span><span class="op" id="2753918">)</span>&nbsp;<span class="builtintype" id="2753920">byte</span><span class="op" id="2753924">(</span><span class="op" id="2753925">)</span>&nbsp;<span class="op" id="2753927">(</span><span class="ident" id="2753928">n</span>&nbsp;<span class="builtintype" id="2753930">byte</span><span class="op" id="2753934">,</span>&nbsp;<span class="ident" id="2753936">ok</span>&nbsp;<span class="builtintype" id="2753939">bool</span><span class="op" id="2753943">)</span>&nbsp;<span class="op" id="2753945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2753948">p</span>&nbsp;<span class="op" id="2753950">:=</span>&nbsp;<span class="ident" id="2753953">d</span><span class="op" id="2753954">.</span><span class="ident" id="2753955">read</span><span class="op" id="2753959">(</span><span class="num" id="2753960">1</span><span class="op" id="2753961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2753964">if</span>&nbsp;<span class="builtinfunc" id="2753967">len</span><span class="op" id="2753970">(</span><span class="ident" id="2753971">p</span><span class="op" id="2753972">)</span>&nbsp;<span class="op" id="2753974">&lt;</span>&nbsp;<span class="num" id="2753976">1</span>&nbsp;<span class="op" id="2753978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2753982">d</span><span class="op" id="2753983">.</span><span class="builtintype" id="2753984">error</span>&nbsp;<span class="op" id="2753990">=</span>&nbsp;<span class="builtintype" id="2753992">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2753999">return</span>&nbsp;<span class="num" id="2754006">0</span><span class="op" id="2754007">,</span>&nbsp;<span class="builtintype" id="2754009">false</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2754016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754019">return</span>&nbsp;<span class="ident" id="2754026">p</span><span class="op" id="2754027">[</span><span class="num" id="2754028">0</span><span class="op" id="2754029">]</span><span class="op" id="2754030">,</span>&nbsp;<span class="builtintype" id="2754032">true</span><br>
<span class="lineno"></span><span class="op" id="2754037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2754040">//&nbsp;Make&nbsp;a&nbsp;string&nbsp;by&nbsp;stopping&nbsp;at&nbsp;the&nbsp;first&nbsp;NUL</span><br>
<span class="lineno">50</span><span class="keyword" id="2754086">func</span>&nbsp;<span class="ident" id="2754091">byteString</span><span class="op" id="2754101">(</span><span class="ident" id="2754102">p</span>&nbsp;<span class="op" id="2754104">[</span><span class="op" id="2754105">]</span><span class="builtintype" id="2754106">byte</span><span class="op" id="2754110">)</span>&nbsp;<span class="builtintype" id="2754112">string</span>&nbsp;<span class="op" id="2754119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754122">for</span>&nbsp;<span class="ident" id="2754126">i</span>&nbsp;<span class="op" id="2754128">:=</span>&nbsp;<span class="num" id="2754131">0</span><span class="op" id="2754132">;</span>&nbsp;<span class="ident" id="2754134">i</span>&nbsp;<span class="op" id="2754136">&lt;</span>&nbsp;<span class="builtinfunc" id="2754138">len</span><span class="op" id="2754141">(</span><span class="ident" id="2754142">p</span><span class="op" id="2754143">)</span><span class="op" id="2754144">;</span>&nbsp;<span class="ident" id="2754146">i</span><span class="op" id="2754147">++</span>&nbsp;<span class="op" id="2754150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754154">if</span>&nbsp;<span class="ident" id="2754157">p</span><span class="op" id="2754158">[</span><span class="ident" id="2754159">i</span><span class="op" id="2754160">]</span>&nbsp;<span class="op" id="2754162">==</span>&nbsp;<span class="num" id="2754165">0</span>&nbsp;<span class="op" id="2754167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754172">return</span>&nbsp;<span class="builtintype" id="2754179">string</span><span class="op" id="2754185">(</span><span class="ident" id="2754186">p</span><span class="op" id="2754187">[</span><span class="num" id="2754188">0</span><span class="op" id="2754189">:</span><span class="ident" id="2754190">i</span><span class="op" id="2754191">]</span><span class="op" id="2754192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2754196">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2754199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754202">return</span>&nbsp;<span class="builtintype" id="2754209">string</span><span class="op" id="2754215">(</span><span class="ident" id="2754216">p</span><span class="op" id="2754217">)</span><br>
<span class="lineno"></span><span class="op" id="2754219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2754222">var</span>&nbsp;<span class="ident" id="2754226">badData</span>&nbsp;<span class="op" id="2754234">=</span>&nbsp;<span class="ident" id="2754236">errors</span><span class="op" id="2754242">.</span><span class="ident" id="2754243">New</span><span class="op" id="2754246">(</span><span class="string" id="2754247">&#34;malformed&nbsp;time&nbsp;zone&nbsp;information&#34;</span><span class="op" id="2754280">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2754283">func</span>&nbsp;<span class="ident" id="2754288">loadZoneData</span><span class="op" id="2754300">(</span><span class="ident" id="2754301">bytes</span>&nbsp;<span class="op" id="2754307">[</span><span class="op" id="2754308">]</span><span class="builtintype" id="2754309">byte</span><span class="op" id="2754313">)</span>&nbsp;<span class="op" id="2754315">(</span><span class="ident" id="2754316">l</span>&nbsp;<span class="op" id="2754318">*</span><span class="ident" id="2754319">Location</span><span class="op" id="2754327">,</span>&nbsp;<span class="ident" id="2754329">err</span>&nbsp;<span class="builtintype" id="2754333">error</span><span class="op" id="2754338">)</span>&nbsp;<span class="op" id="2754340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2754343">d</span>&nbsp;<span class="op" id="2754345">:=</span>&nbsp;<span class="ident" id="2754348">data</span><span class="op" id="2754352">{</span><span class="ident" id="2754353">bytes</span><span class="op" id="2754358">,</span>&nbsp;<span class="builtintype" id="2754360">false</span><span class="op" id="2754365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2754369">//&nbsp;4-byte&nbsp;magic&nbsp;&#34;TZif&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754393">if</span>&nbsp;<span class="ident" id="2754396">magic</span>&nbsp;<span class="op" id="2754402">:=</span>&nbsp;<span class="ident" id="2754405">d</span><span class="op" id="2754406">.</span><span class="ident" id="2754407">read</span><span class="op" id="2754411">(</span><span class="num" id="2754412">4</span><span class="op" id="2754413">)</span><span class="op" id="2754414">;</span>&nbsp;<span class="builtintype" id="2754416">string</span><span class="op" id="2754422">(</span><span class="ident" id="2754423">magic</span><span class="op" id="2754428">)</span>&nbsp;<span class="op" id="2754430">!=</span>&nbsp;<span class="string" id="2754433">&#34;TZif&#34;</span>&nbsp;<span class="op" id="2754440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754444">return</span>&nbsp;<span class="builtintype" id="2754451">nil</span><span class="op" id="2754454">,</span>&nbsp;<span class="ident" id="2754456">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2754465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2754469">//&nbsp;1-byte&nbsp;version,&nbsp;then&nbsp;15&nbsp;bytes&nbsp;of&nbsp;padding</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754514">var</span>&nbsp;<span class="ident" id="2754518">p</span>&nbsp;<span class="op" id="2754520">[</span><span class="op" id="2754521">]</span><span class="builtintype" id="2754522">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754528">if</span>&nbsp;<span class="ident" id="2754531">p</span>&nbsp;<span class="op" id="2754533">=</span>&nbsp;<span class="ident" id="2754535">d</span><span class="op" id="2754536">.</span><span class="ident" id="2754537">read</span><span class="op" id="2754541">(</span><span class="num" id="2754542">16</span><span class="op" id="2754544">)</span><span class="op" id="2754545">;</span>&nbsp;<span class="builtinfunc" id="2754547">len</span><span class="op" id="2754550">(</span><span class="ident" id="2754551">p</span><span class="op" id="2754552">)</span>&nbsp;<span class="op" id="2754554">!=</span>&nbsp;<span class="num" id="2754557">16</span>&nbsp;<span class="op" id="2754560">||</span>&nbsp;<span class="ident" id="2754563">p</span><span class="op" id="2754564">[</span><span class="num" id="2754565">0</span><span class="op" id="2754566">]</span>&nbsp;<span class="op" id="2754568">!=</span>&nbsp;<span class="num" id="2754571">0</span>&nbsp;<span class="op" id="2754573">&amp;&amp;</span>&nbsp;<span class="ident" id="2754576">p</span><span class="op" id="2754577">[</span><span class="num" id="2754578">0</span><span class="op" id="2754579">]</span>&nbsp;<span class="op" id="2754581">!=</span>&nbsp;<span class="string" id="2754584">&#39;2&#39;</span>&nbsp;<span class="op" id="2754588">&amp;&amp;</span>&nbsp;<span class="ident" id="2754591">p</span><span class="op" id="2754592">[</span><span class="num" id="2754593">0</span><span class="op" id="2754594">]</span>&nbsp;<span class="op" id="2754596">!=</span>&nbsp;<span class="string" id="2754599">&#39;3&#39;</span>&nbsp;<span class="op" id="2754603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754607">return</span>&nbsp;<span class="builtintype" id="2754614">nil</span><span class="op" id="2754617">,</span>&nbsp;<span class="ident" id="2754619">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2754628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2754632">//&nbsp;six&nbsp;big-endian&nbsp;32-bit&nbsp;integers:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2754668">//&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;UTC/local&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2754703">//&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;standard/wall&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2754742">//&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;leap&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2754769">//&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;transition&nbsp;times</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2754800">//&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;local&nbsp;time&nbsp;zones</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2754831">//&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;characters&nbsp;of&nbsp;time&nbsp;zone&nbsp;abbrev&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754884">const</span>&nbsp;<span class="op" id="2754890">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2754894">NUTCLocal</span>&nbsp;<span class="op" id="2754904">=</span>&nbsp;<span class="ident" id="2754906">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2754913">NStdWall</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2754924">NLeap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2754932">NTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2754940">NZone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2754948">NChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2754955">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754958">var</span>&nbsp;<span class="ident" id="2754962">n</span>&nbsp;<span class="op" id="2754964">[</span><span class="num" id="2754965">6</span><span class="op" id="2754966">]</span><span class="builtintype" id="2754967">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2754972">for</span>&nbsp;<span class="ident" id="2754976">i</span>&nbsp;<span class="op" id="2754978">:=</span>&nbsp;<span class="num" id="2754981">0</span><span class="op" id="2754982">;</span>&nbsp;<span class="ident" id="2754984">i</span>&nbsp;<span class="op" id="2754986">&lt;</span>&nbsp;<span class="num" id="2754988">6</span><span class="op" id="2754989">;</span>&nbsp;<span class="ident" id="2754991">i</span><span class="op" id="2754992">++</span>&nbsp;<span class="op" id="2754995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2754999">nn</span><span class="op" id="2755001">,</span>&nbsp;<span class="ident" id="2755003">ok</span>&nbsp;<span class="op" id="2755006">:=</span>&nbsp;<span class="ident" id="2755009">d</span><span class="op" id="2755010">.</span><span class="ident" id="2755011">big4</span><span class="op" id="2755015">(</span><span class="op" id="2755016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2755020">if</span>&nbsp;<span class="op" id="2755023">!</span><span class="ident" id="2755024">ok</span>&nbsp;<span class="op" id="2755027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2755032">return</span>&nbsp;<span class="builtintype" id="2755039">nil</span><span class="op" id="2755042">,</span>&nbsp;<span class="ident" id="2755044">badData</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2755054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2755058">n</span><span class="op" id="2755059">[</span><span class="ident" id="2755060">i</span><span class="op" id="2755061">]</span>&nbsp;<span class="op" id="2755063">=</span>&nbsp;<span class="builtintype" id="2755065">int</span><span class="op" id="2755068">(</span><span class="ident" id="2755069">nn</span><span class="op" id="2755071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2755074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755078">//&nbsp;Transition&nbsp;times.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2755100">txtimes</span>&nbsp;<span class="op" id="2755108">:=</span>&nbsp;<span class="ident" id="2755111">data</span><span class="op" id="2755115">{</span><span class="ident" id="2755116">d</span><span class="op" id="2755117">.</span><span class="ident" id="2755118">read</span><span class="op" id="2755122">(</span><span class="ident" id="2755123">n</span><span class="op" id="2755124">[</span><span class="ident" id="2755125">NTime</span><span class="op" id="2755130">]</span>&nbsp;<span class="op" id="2755132">*</span>&nbsp;<span class="num" id="2755134">4</span><span class="op" id="2755135">)</span><span class="op" id="2755136">,</span>&nbsp;<span class="builtintype" id="2755138">false</span><span class="op" id="2755143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755147">//&nbsp;Time&nbsp;zone&nbsp;indices&nbsp;for&nbsp;transition&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2755191">txzones</span>&nbsp;<span class="op" id="2755199">:=</span>&nbsp;<span class="ident" id="2755202">d</span><span class="op" id="2755203">.</span><span class="ident" id="2755204">read</span><span class="op" id="2755208">(</span><span class="ident" id="2755209">n</span><span class="op" id="2755210">[</span><span class="ident" id="2755211">NTime</span><span class="op" id="2755216">]</span><span class="op" id="2755217">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755221">//&nbsp;Zone&nbsp;info&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2755246">zonedata</span>&nbsp;<span class="op" id="2755255">:=</span>&nbsp;<span class="ident" id="2755258">data</span><span class="op" id="2755262">{</span><span class="ident" id="2755263">d</span><span class="op" id="2755264">.</span><span class="ident" id="2755265">read</span><span class="op" id="2755269">(</span><span class="ident" id="2755270">n</span><span class="op" id="2755271">[</span><span class="ident" id="2755272">NZone</span><span class="op" id="2755277">]</span>&nbsp;<span class="op" id="2755279">*</span>&nbsp;<span class="num" id="2755281">6</span><span class="op" id="2755282">)</span><span class="op" id="2755283">,</span>&nbsp;<span class="builtintype" id="2755285">false</span><span class="op" id="2755290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755294">//&nbsp;Time&nbsp;zone&nbsp;abbreviations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2755323">abbrev</span>&nbsp;<span class="op" id="2755330">:=</span>&nbsp;<span class="ident" id="2755333">d</span><span class="op" id="2755334">.</span><span class="ident" id="2755335">read</span><span class="op" id="2755339">(</span><span class="ident" id="2755340">n</span><span class="op" id="2755341">[</span><span class="ident" id="2755342">NChar</span><span class="op" id="2755347">]</span><span class="op" id="2755348">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755352">//&nbsp;Leap-second&nbsp;time&nbsp;pairs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2755379">d</span><span class="op" id="2755380">.</span><span class="ident" id="2755381">read</span><span class="op" id="2755385">(</span><span class="ident" id="2755386">n</span><span class="op" id="2755387">[</span><span class="ident" id="2755388">NLeap</span><span class="op" id="2755393">]</span>&nbsp;<span class="op" id="2755395">*</span>&nbsp;<span class="num" id="2755397">8</span><span class="op" id="2755398">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755402">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755456">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;standard&nbsp;time&nbsp;or&nbsp;wall&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2755505">isstd</span>&nbsp;<span class="op" id="2755511">:=</span>&nbsp;<span class="ident" id="2755514">d</span><span class="op" id="2755515">.</span><span class="ident" id="2755516">read</span><span class="op" id="2755520">(</span><span class="ident" id="2755521">n</span><span class="op" id="2755522">[</span><span class="ident" id="2755523">NStdWall</span><span class="op" id="2755531">]</span><span class="op" id="2755532">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755536">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755590">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;UTC&nbsp;or&nbsp;local&nbsp;time.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2755630">isutc</span>&nbsp;<span class="op" id="2755636">:=</span>&nbsp;<span class="ident" id="2755639">d</span><span class="op" id="2755640">.</span><span class="ident" id="2755641">read</span><span class="op" id="2755645">(</span><span class="ident" id="2755646">n</span><span class="op" id="2755647">[</span><span class="ident" id="2755648">NUTCLocal</span><span class="op" id="2755657">]</span><span class="op" id="2755658">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2755662">if</span>&nbsp;<span class="ident" id="2755665">d</span><span class="op" id="2755666">.</span><span class="builtintype" id="2755667">error</span>&nbsp;<span class="op" id="2755673">{</span>&nbsp;<span class="comment" id="2755675">//&nbsp;ran&nbsp;out&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2755696">return</span>&nbsp;<span class="builtintype" id="2755703">nil</span><span class="op" id="2755706">,</span>&nbsp;<span class="ident" id="2755708">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2755717">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755721">//&nbsp;If&nbsp;version&nbsp;==&nbsp;2&nbsp;or&nbsp;3,&nbsp;the&nbsp;entire&nbsp;file&nbsp;repeats,&nbsp;this&nbsp;time&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755788">//&nbsp;8-byte&nbsp;ints&nbsp;for&nbsp;txtimes&nbsp;and&nbsp;leap&nbsp;seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755834">//&nbsp;We&nbsp;won&#39;t&nbsp;need&nbsp;those&nbsp;until&nbsp;2106.</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755871">//&nbsp;Now&nbsp;we&nbsp;can&nbsp;build&nbsp;up&nbsp;a&nbsp;useful&nbsp;data&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755920">//&nbsp;First&nbsp;the&nbsp;zone&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2755952">//&nbsp;&nbsp;&nbsp;&nbsp;utcoff[4]&nbsp;isdst[1]&nbsp;nameindex[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2755988">zone</span>&nbsp;<span class="op" id="2755993">:=</span>&nbsp;<span class="builtinfunc" id="2755996">make</span><span class="op" id="2756000">(</span><span class="op" id="2756001">[</span><span class="op" id="2756002">]</span><span class="ident" id="2756003">zone</span><span class="op" id="2756007">,</span>&nbsp;<span class="ident" id="2756009">n</span><span class="op" id="2756010">[</span><span class="ident" id="2756011">NZone</span><span class="op" id="2756016">]</span><span class="op" id="2756017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756020">for</span>&nbsp;<span class="ident" id="2756024">i</span>&nbsp;<span class="op" id="2756026">:=</span>&nbsp;<span class="keyword" id="2756029">range</span>&nbsp;<span class="ident" id="2756035">zone</span>&nbsp;<span class="op" id="2756040">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756044">var</span>&nbsp;<span class="ident" id="2756048">ok</span>&nbsp;<span class="builtintype" id="2756051">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756058">var</span>&nbsp;<span class="ident" id="2756062">n</span>&nbsp;<span class="builtintype" id="2756064">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756073">if</span>&nbsp;<span class="ident" id="2756076">n</span><span class="op" id="2756077">,</span>&nbsp;<span class="ident" id="2756079">ok</span>&nbsp;<span class="op" id="2756082">=</span>&nbsp;<span class="ident" id="2756084">zonedata</span><span class="op" id="2756092">.</span><span class="ident" id="2756093">big4</span><span class="op" id="2756097">(</span><span class="op" id="2756098">)</span><span class="op" id="2756099">;</span>&nbsp;<span class="op" id="2756101">!</span><span class="ident" id="2756102">ok</span>&nbsp;<span class="op" id="2756105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756110">return</span>&nbsp;<span class="builtintype" id="2756117">nil</span><span class="op" id="2756120">,</span>&nbsp;<span class="ident" id="2756122">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2756132">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2756136">zone</span><span class="op" id="2756140">[</span><span class="ident" id="2756141">i</span><span class="op" id="2756142">]</span><span class="op" id="2756143">.</span><span class="ident" id="2756144">offset</span>&nbsp;<span class="op" id="2756151">=</span>&nbsp;<span class="builtintype" id="2756153">int</span><span class="op" id="2756156">(</span><span class="builtintype" id="2756157">int32</span><span class="op" id="2756162">(</span><span class="ident" id="2756163">n</span><span class="op" id="2756164">)</span><span class="op" id="2756165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756169">var</span>&nbsp;<span class="ident" id="2756173">b</span>&nbsp;<span class="builtintype" id="2756175">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756182">if</span>&nbsp;<span class="ident" id="2756185">b</span><span class="op" id="2756186">,</span>&nbsp;<span class="ident" id="2756188">ok</span>&nbsp;<span class="op" id="2756191">=</span>&nbsp;<span class="ident" id="2756193">zonedata</span><span class="op" id="2756201">.</span><span class="builtintype" id="2756202">byte</span><span class="op" id="2756206">(</span><span class="op" id="2756207">)</span><span class="op" id="2756208">;</span>&nbsp;<span class="op" id="2756210">!</span><span class="ident" id="2756211">ok</span>&nbsp;<span class="op" id="2756214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756219">return</span>&nbsp;<span class="builtintype" id="2756226">nil</span><span class="op" id="2756229">,</span>&nbsp;<span class="ident" id="2756231">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2756241">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2756245">zone</span><span class="op" id="2756249">[</span><span class="ident" id="2756250">i</span><span class="op" id="2756251">]</span><span class="op" id="2756252">.</span><span class="ident" id="2756253">isDST</span>&nbsp;<span class="op" id="2756259">=</span>&nbsp;<span class="ident" id="2756261">b</span>&nbsp;<span class="op" id="2756263">!=</span>&nbsp;<span class="num" id="2756266">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756270">if</span>&nbsp;<span class="ident" id="2756273">b</span><span class="op" id="2756274">,</span>&nbsp;<span class="ident" id="2756276">ok</span>&nbsp;<span class="op" id="2756279">=</span>&nbsp;<span class="ident" id="2756281">zonedata</span><span class="op" id="2756289">.</span><span class="builtintype" id="2756290">byte</span><span class="op" id="2756294">(</span><span class="op" id="2756295">)</span><span class="op" id="2756296">;</span>&nbsp;<span class="op" id="2756298">!</span><span class="ident" id="2756299">ok</span>&nbsp;<span class="op" id="2756302">||</span>&nbsp;<span class="builtintype" id="2756305">int</span><span class="op" id="2756308">(</span><span class="ident" id="2756309">b</span><span class="op" id="2756310">)</span>&nbsp;<span class="op" id="2756312">&gt;=</span>&nbsp;<span class="builtinfunc" id="2756315">len</span><span class="op" id="2756318">(</span><span class="ident" id="2756319">abbrev</span><span class="op" id="2756325">)</span>&nbsp;<span class="op" id="2756327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756332">return</span>&nbsp;<span class="builtintype" id="2756339">nil</span><span class="op" id="2756342">,</span>&nbsp;<span class="ident" id="2756344">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2756354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2756358">zone</span><span class="op" id="2756362">[</span><span class="ident" id="2756363">i</span><span class="op" id="2756364">]</span><span class="op" id="2756365">.</span><span class="ident" id="2756366">name</span>&nbsp;<span class="op" id="2756371">=</span>&nbsp;<span class="ident" id="2756373">byteString</span><span class="op" id="2756383">(</span><span class="ident" id="2756384">abbrev</span><span class="op" id="2756390">[</span><span class="ident" id="2756391">b</span><span class="op" id="2756392">:</span><span class="op" id="2756393">]</span><span class="op" id="2756394">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2756397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2756401">//&nbsp;Now&nbsp;the&nbsp;transition&nbsp;time&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2756435">tx</span>&nbsp;<span class="op" id="2756438">:=</span>&nbsp;<span class="builtinfunc" id="2756441">make</span><span class="op" id="2756445">(</span><span class="op" id="2756446">[</span><span class="op" id="2756447">]</span><span class="ident" id="2756448">zoneTrans</span><span class="op" id="2756457">,</span>&nbsp;<span class="ident" id="2756459">n</span><span class="op" id="2756460">[</span><span class="ident" id="2756461">NTime</span><span class="op" id="2756466">]</span><span class="op" id="2756467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756470">for</span>&nbsp;<span class="ident" id="2756474">i</span>&nbsp;<span class="op" id="2756476">:=</span>&nbsp;<span class="keyword" id="2756479">range</span>&nbsp;<span class="ident" id="2756485">tx</span>&nbsp;<span class="op" id="2756488">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756492">var</span>&nbsp;<span class="ident" id="2756496">ok</span>&nbsp;<span class="builtintype" id="2756499">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756506">var</span>&nbsp;<span class="ident" id="2756510">n</span>&nbsp;<span class="builtintype" id="2756512">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756521">if</span>&nbsp;<span class="ident" id="2756524">n</span><span class="op" id="2756525">,</span>&nbsp;<span class="ident" id="2756527">ok</span>&nbsp;<span class="op" id="2756530">=</span>&nbsp;<span class="ident" id="2756532">txtimes</span><span class="op" id="2756539">.</span><span class="ident" id="2756540">big4</span><span class="op" id="2756544">(</span><span class="op" id="2756545">)</span><span class="op" id="2756546">;</span>&nbsp;<span class="op" id="2756548">!</span><span class="ident" id="2756549">ok</span>&nbsp;<span class="op" id="2756552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756557">return</span>&nbsp;<span class="builtintype" id="2756564">nil</span><span class="op" id="2756567">,</span>&nbsp;<span class="ident" id="2756569">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2756579">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2756583">tx</span><span class="op" id="2756585">[</span><span class="ident" id="2756586">i</span><span class="op" id="2756587">]</span><span class="op" id="2756588">.</span><span class="ident" id="2756589">when</span>&nbsp;<span class="op" id="2756594">=</span>&nbsp;<span class="ident" id="2756596">int64</span><span class="op" id="2756601">(</span><span class="builtintype" id="2756602">int32</span><span class="op" id="2756607">(</span><span class="ident" id="2756608">n</span><span class="op" id="2756609">)</span><span class="op" id="2756610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756614">if</span>&nbsp;<span class="builtintype" id="2756617">int</span><span class="op" id="2756620">(</span><span class="ident" id="2756621">txzones</span><span class="op" id="2756628">[</span><span class="ident" id="2756629">i</span><span class="op" id="2756630">]</span><span class="op" id="2756631">)</span>&nbsp;<span class="op" id="2756633">&gt;=</span>&nbsp;<span class="builtinfunc" id="2756636">len</span><span class="op" id="2756639">(</span><span class="ident" id="2756640">zone</span><span class="op" id="2756644">)</span>&nbsp;<span class="op" id="2756646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756651">return</span>&nbsp;<span class="builtintype" id="2756658">nil</span><span class="op" id="2756661">,</span>&nbsp;<span class="ident" id="2756663">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2756673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2756677">tx</span><span class="op" id="2756679">[</span><span class="ident" id="2756680">i</span><span class="op" id="2756681">]</span><span class="op" id="2756682">.</span><span class="ident" id="2756683">index</span>&nbsp;<span class="op" id="2756689">=</span>&nbsp;<span class="ident" id="2756691">txzones</span><span class="op" id="2756698">[</span><span class="ident" id="2756699">i</span><span class="op" id="2756700">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756704">if</span>&nbsp;<span class="ident" id="2756707">i</span>&nbsp;<span class="op" id="2756709">&lt;</span>&nbsp;<span class="builtinfunc" id="2756711">len</span><span class="op" id="2756714">(</span><span class="ident" id="2756715">isstd</span><span class="op" id="2756720">)</span>&nbsp;<span class="op" id="2756722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2756727">tx</span><span class="op" id="2756729">[</span><span class="ident" id="2756730">i</span><span class="op" id="2756731">]</span><span class="op" id="2756732">.</span><span class="ident" id="2756733">isstd</span>&nbsp;<span class="op" id="2756739">=</span>&nbsp;<span class="ident" id="2756741">isstd</span><span class="op" id="2756746">[</span><span class="ident" id="2756747">i</span><span class="op" id="2756748">]</span>&nbsp;<span class="op" id="2756750">!=</span>&nbsp;<span class="num" id="2756753">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2756757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756761">if</span>&nbsp;<span class="ident" id="2756764">i</span>&nbsp;<span class="op" id="2756766">&lt;</span>&nbsp;<span class="builtinfunc" id="2756768">len</span><span class="op" id="2756771">(</span><span class="ident" id="2756772">isutc</span><span class="op" id="2756777">)</span>&nbsp;<span class="op" id="2756779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2756784">tx</span><span class="op" id="2756786">[</span><span class="ident" id="2756787">i</span><span class="op" id="2756788">]</span><span class="op" id="2756789">.</span><span class="ident" id="2756790">isutc</span>&nbsp;<span class="op" id="2756796">=</span>&nbsp;<span class="ident" id="2756798">isutc</span><span class="op" id="2756803">[</span><span class="ident" id="2756804">i</span><span class="op" id="2756805">]</span>&nbsp;<span class="op" id="2756807">!=</span>&nbsp;<span class="num" id="2756810">0</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2756814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2756817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2756821">if</span>&nbsp;<span class="builtinfunc" id="2756824">len</span><span class="op" id="2756827">(</span><span class="ident" id="2756828">tx</span><span class="op" id="2756830">)</span>&nbsp;<span class="op" id="2756832">==</span>&nbsp;<span class="num" id="2756835">0</span>&nbsp;<span class="op" id="2756837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2756841">//&nbsp;Build&nbsp;fake&nbsp;transition&nbsp;to&nbsp;cover&nbsp;all&nbsp;time.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2756887">//&nbsp;This&nbsp;happens&nbsp;in&nbsp;fixed&nbsp;locations&nbsp;like&nbsp;&#34;Etc/GMT0&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2756941">tx</span>&nbsp;<span class="op" id="2756944">=</span>&nbsp;<span class="builtinfunc" id="2756946">append</span><span class="op" id="2756952">(</span><span class="ident" id="2756953">tx</span><span class="op" id="2756955">,</span>&nbsp;<span class="ident" id="2756957">zoneTrans</span><span class="op" id="2756966">{</span><span class="ident" id="2756967">when</span><span class="op" id="2756971">:</span>&nbsp;<span class="ident" id="2756973">alpha</span><span class="op" id="2756978">,</span>&nbsp;<span class="ident" id="2756980">index</span><span class="op" id="2756985">:</span>&nbsp;<span class="num" id="2756987">0</span><span class="op" id="2756988">}</span><span class="op" id="2756989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2756992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2756996">//&nbsp;Committed&nbsp;to&nbsp;succeed.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2757022">l</span>&nbsp;<span class="op" id="2757024">=</span>&nbsp;<span class="op" id="2757026">&amp;</span><span class="ident" id="2757027">Location</span><span class="op" id="2757035">{</span><span class="ident" id="2757036">zone</span><span class="op" id="2757040">:</span>&nbsp;<span class="ident" id="2757042">zone</span><span class="op" id="2757046">,</span>&nbsp;<span class="ident" id="2757048">tx</span><span class="op" id="2757050">:</span>&nbsp;<span class="ident" id="2757052">tx</span><span class="op" id="2757054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2757058">//&nbsp;Fill&nbsp;in&nbsp;the&nbsp;cache&nbsp;with&nbsp;information&nbsp;about&nbsp;right&nbsp;now,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2757114">//&nbsp;since&nbsp;that&nbsp;will&nbsp;be&nbsp;the&nbsp;most&nbsp;common&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2757161">sec</span><span class="op" id="2757164">,</span>&nbsp;<span class="ident" id="2757166">_</span>&nbsp;<span class="op" id="2757168">:=</span>&nbsp;<span class="ident" id="2757171">now</span><span class="op" id="2757174">(</span><span class="op" id="2757175">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2757178">for</span>&nbsp;<span class="ident" id="2757182">i</span>&nbsp;<span class="op" id="2757184">:=</span>&nbsp;<span class="keyword" id="2757187">range</span>&nbsp;<span class="ident" id="2757193">tx</span>&nbsp;<span class="op" id="2757196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2757200">if</span>&nbsp;<span class="ident" id="2757203">tx</span><span class="op" id="2757205">[</span><span class="ident" id="2757206">i</span><span class="op" id="2757207">]</span><span class="op" id="2757208">.</span><span class="ident" id="2757209">when</span>&nbsp;<span class="op" id="2757214">&lt;=</span>&nbsp;<span class="ident" id="2757217">sec</span>&nbsp;<span class="op" id="2757221">&amp;&amp;</span>&nbsp;<span class="op" id="2757224">(</span><span class="ident" id="2757225">i</span><span class="op" id="2757226">+</span><span class="num" id="2757227">1</span>&nbsp;<span class="op" id="2757229">==</span>&nbsp;<span class="builtinfunc" id="2757232">len</span><span class="op" id="2757235">(</span><span class="ident" id="2757236">tx</span><span class="op" id="2757238">)</span>&nbsp;<span class="op" id="2757240">||</span>&nbsp;<span class="ident" id="2757243">sec</span>&nbsp;<span class="op" id="2757247">&lt;</span>&nbsp;<span class="ident" id="2757249">tx</span><span class="op" id="2757251">[</span><span class="ident" id="2757252">i</span><span class="op" id="2757253">+</span><span class="num" id="2757254">1</span><span class="op" id="2757255">]</span><span class="op" id="2757256">.</span><span class="ident" id="2757257">when</span><span class="op" id="2757261">)</span>&nbsp;<span class="op" id="2757263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2757268">l</span><span class="op" id="2757269">.</span><span class="ident" id="2757270">cacheStart</span>&nbsp;<span class="op" id="2757281">=</span>&nbsp;<span class="ident" id="2757283">tx</span><span class="op" id="2757285">[</span><span class="ident" id="2757286">i</span><span class="op" id="2757287">]</span><span class="op" id="2757288">.</span><span class="ident" id="2757289">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2757297">l</span><span class="op" id="2757298">.</span><span class="ident" id="2757299">cacheEnd</span>&nbsp;<span class="op" id="2757308">=</span>&nbsp;<span class="ident" id="2757310">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2757319">if</span>&nbsp;<span class="ident" id="2757322">i</span><span class="op" id="2757323">+</span><span class="num" id="2757324">1</span>&nbsp;<span class="op" id="2757326">&lt;</span>&nbsp;<span class="builtinfunc" id="2757328">len</span><span class="op" id="2757331">(</span><span class="ident" id="2757332">tx</span><span class="op" id="2757334">)</span>&nbsp;<span class="op" id="2757336">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2757342">l</span><span class="op" id="2757343">.</span><span class="ident" id="2757344">cacheEnd</span>&nbsp;<span class="op" id="2757353">=</span>&nbsp;<span class="ident" id="2757355">tx</span><span class="op" id="2757357">[</span><span class="ident" id="2757358">i</span><span class="op" id="2757359">+</span><span class="num" id="2757360">1</span><span class="op" id="2757361">]</span><span class="op" id="2757362">.</span><span class="ident" id="2757363">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2757371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2757376">l</span><span class="op" id="2757377">.</span><span class="ident" id="2757378">cacheZone</span>&nbsp;<span class="op" id="2757388">=</span>&nbsp;<span class="op" id="2757390">&amp;</span><span class="ident" id="2757391">l</span><span class="op" id="2757392">.</span><span class="ident" id="2757393">zone</span><span class="op" id="2757397">[</span><span class="ident" id="2757398">tx</span><span class="op" id="2757400">[</span><span class="ident" id="2757401">i</span><span class="op" id="2757402">]</span><span class="op" id="2757403">.</span><span class="ident" id="2757404">index</span><span class="op" id="2757409">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2757413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2757416">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2757420">return</span>&nbsp;<span class="ident" id="2757427">l</span><span class="op" id="2757428">,</span>&nbsp;<span class="builtintype" id="2757430">nil</span><br>
<span class="lineno"></span><span class="op" id="2757434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2757437">func</span>&nbsp;<span class="ident" id="2757442">loadZoneFile</span><span class="op" id="2757454">(</span><span class="ident" id="2757455">dir</span><span class="op" id="2757458">,</span>&nbsp;<span class="ident" id="2757460">name</span>&nbsp;<span class="builtintype" id="2757465">string</span><span class="op" id="2757471">)</span>&nbsp;<span class="op" id="2757473">(</span><span class="ident" id="2757474">l</span>&nbsp;<span class="op" id="2757476">*</span><span class="ident" id="2757477">Location</span><span class="op" id="2757485">,</span>&nbsp;<span class="ident" id="2757487">err</span>&nbsp;<span class="builtintype" id="2757491">error</span><span class="op" id="2757496">)</span>&nbsp;<span class="op" id="2757498">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2757501">if</span>&nbsp;<span class="builtinfunc" id="2757504">len</span><span class="op" id="2757507">(</span><span class="ident" id="2757508">dir</span><span class="op" id="2757511">)</span>&nbsp;<span class="op" id="2757513">&gt;</span>&nbsp;<span class="num" id="2757515">4</span>&nbsp;<span class="op" id="2757517">&amp;&amp;</span>&nbsp;<span class="ident" id="2757520">dir</span><span class="op" id="2757523">[</span><span class="builtinfunc" id="2757524">len</span><span class="op" id="2757527">(</span><span class="ident" id="2757528">dir</span><span class="op" id="2757531">)</span><span class="op" id="2757532">-</span><span class="num" id="2757533">4</span><span class="op" id="2757534">:</span><span class="op" id="2757535">]</span>&nbsp;<span class="op" id="2757537">==</span>&nbsp;<span class="string" id="2757540">&#34;.zip&#34;</span>&nbsp;<span class="op" id="2757547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2757551">return</span>&nbsp;<span class="ident" id="2757558">loadZoneZip</span><span class="op" id="2757569">(</span><span class="ident" id="2757570">dir</span><span class="op" id="2757573">,</span>&nbsp;<span class="ident" id="2757575">name</span><span class="op" id="2757579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2757582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2757585">if</span>&nbsp;<span class="ident" id="2757588">dir</span>&nbsp;<span class="op" id="2757592">!=</span>&nbsp;<span class="string" id="2757595">&#34;&#34;</span>&nbsp;<span class="op" id="2757598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2757602">name</span>&nbsp;<span class="op" id="2757607">=</span>&nbsp;<span class="ident" id="2757609">dir</span>&nbsp;<span class="op" id="2757613">+</span>&nbsp;<span class="string" id="2757615">&#34;/&#34;</span>&nbsp;<span class="op" id="2757619">+</span>&nbsp;<span class="ident" id="2757621">name</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2757627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2757630">buf</span><span class="op" id="2757633">,</span>&nbsp;<span class="ident" id="2757635">err</span>&nbsp;<span class="op" id="2757639">:=</span>&nbsp;<span class="ident" id="2757642">readFile</span><span class="op" id="2757650">(</span><span class="ident" id="2757651">name</span><span class="op" id="2757655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2757658">if</span>&nbsp;<span class="ident" id="2757661">err</span>&nbsp;<span class="op" id="2757665">!=</span>&nbsp;<span class="builtintype" id="2757668">nil</span>&nbsp;<span class="op" id="2757672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2757676">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2757684">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2757687">return</span>&nbsp;<span class="ident" id="2757694">loadZoneData</span><span class="op" id="2757706">(</span><span class="ident" id="2757707">buf</span><span class="op" id="2757710">)</span><br>
<span class="lineno"></span><span class="op" id="2757712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2757715">//&nbsp;There&nbsp;are&nbsp;500+&nbsp;zoneinfo&nbsp;files.&nbsp;&nbsp;Rather&nbsp;than&nbsp;distribute&nbsp;them&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2757782">//&nbsp;individually,&nbsp;we&nbsp;ship&nbsp;them&nbsp;in&nbsp;an&nbsp;uncompressed&nbsp;zip&nbsp;file.</span><br>
<span class="lineno">215</span><span class="comment" id="2757841">//&nbsp;Used&nbsp;this&nbsp;way,&nbsp;the&nbsp;zip&nbsp;file&nbsp;format&nbsp;serves&nbsp;as&nbsp;a&nbsp;commonly&nbsp;readable</span><br>
<span class="lineno"></span><span class="comment" id="2757909">//&nbsp;container&nbsp;for&nbsp;the&nbsp;individual&nbsp;small&nbsp;files.&nbsp;&nbsp;We&nbsp;choose&nbsp;zip&nbsp;over&nbsp;tar</span><br>
<span class="lineno"></span><span class="comment" id="2757978">//&nbsp;because&nbsp;zip&nbsp;files&nbsp;have&nbsp;a&nbsp;contiguous&nbsp;table&nbsp;of&nbsp;contents,&nbsp;making</span><br>
<span class="lineno"></span><span class="comment" id="2758043">//&nbsp;individual&nbsp;file&nbsp;lookups&nbsp;faster,&nbsp;and&nbsp;because&nbsp;the&nbsp;per-file&nbsp;overhead</span><br>
<span class="lineno"></span><span class="comment" id="2758112">//&nbsp;in&nbsp;a&nbsp;zip&nbsp;file&nbsp;is&nbsp;considerably&nbsp;less&nbsp;than&nbsp;tar&#39;s&nbsp;512&nbsp;bytes.</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="2758173">//&nbsp;get4&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;32-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="2758226">func</span>&nbsp;<span class="ident" id="2758231">get4</span><span class="op" id="2758235">(</span><span class="ident" id="2758236">b</span>&nbsp;<span class="op" id="2758238">[</span><span class="op" id="2758239">]</span><span class="builtintype" id="2758240">byte</span><span class="op" id="2758244">)</span>&nbsp;<span class="builtintype" id="2758246">int</span>&nbsp;<span class="op" id="2758250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2758253">if</span>&nbsp;<span class="builtinfunc" id="2758256">len</span><span class="op" id="2758259">(</span><span class="ident" id="2758260">b</span><span class="op" id="2758261">)</span>&nbsp;<span class="op" id="2758263">&lt;</span>&nbsp;<span class="num" id="2758265">4</span>&nbsp;<span class="op" id="2758267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2758271">return</span>&nbsp;<span class="num" id="2758278">0</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2758281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2758284">return</span>&nbsp;<span class="builtintype" id="2758291">int</span><span class="op" id="2758294">(</span><span class="ident" id="2758295">b</span><span class="op" id="2758296">[</span><span class="num" id="2758297">0</span><span class="op" id="2758298">]</span><span class="op" id="2758299">)</span>&nbsp;<span class="op" id="2758301">|</span>&nbsp;<span class="builtintype" id="2758303">int</span><span class="op" id="2758306">(</span><span class="ident" id="2758307">b</span><span class="op" id="2758308">[</span><span class="num" id="2758309">1</span><span class="op" id="2758310">]</span><span class="op" id="2758311">)</span><span class="op" id="2758312">&lt;&lt;</span><span class="num" id="2758314">8</span>&nbsp;<span class="op" id="2758316">|</span>&nbsp;<span class="builtintype" id="2758318">int</span><span class="op" id="2758321">(</span><span class="ident" id="2758322">b</span><span class="op" id="2758323">[</span><span class="num" id="2758324">2</span><span class="op" id="2758325">]</span><span class="op" id="2758326">)</span><span class="op" id="2758327">&lt;&lt;</span><span class="num" id="2758329">16</span>&nbsp;<span class="op" id="2758332">|</span>&nbsp;<span class="builtintype" id="2758334">int</span><span class="op" id="2758337">(</span><span class="ident" id="2758338">b</span><span class="op" id="2758339">[</span><span class="num" id="2758340">3</span><span class="op" id="2758341">]</span><span class="op" id="2758342">)</span><span class="op" id="2758343">&lt;&lt;</span><span class="num" id="2758345">24</span><br>
<span class="lineno"></span><span class="op" id="2758348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2758351">//&nbsp;get2&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;16-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno">230</span><span class="keyword" id="2758404">func</span>&nbsp;<span class="ident" id="2758409">get2</span><span class="op" id="2758413">(</span><span class="ident" id="2758414">b</span>&nbsp;<span class="op" id="2758416">[</span><span class="op" id="2758417">]</span><span class="builtintype" id="2758418">byte</span><span class="op" id="2758422">)</span>&nbsp;<span class="builtintype" id="2758424">int</span>&nbsp;<span class="op" id="2758428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2758431">if</span>&nbsp;<span class="builtinfunc" id="2758434">len</span><span class="op" id="2758437">(</span><span class="ident" id="2758438">b</span><span class="op" id="2758439">)</span>&nbsp;<span class="op" id="2758441">&lt;</span>&nbsp;<span class="num" id="2758443">2</span>&nbsp;<span class="op" id="2758445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2758449">return</span>&nbsp;<span class="num" id="2758456">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2758459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2758462">return</span>&nbsp;<span class="builtintype" id="2758469">int</span><span class="op" id="2758472">(</span><span class="ident" id="2758473">b</span><span class="op" id="2758474">[</span><span class="num" id="2758475">0</span><span class="op" id="2758476">]</span><span class="op" id="2758477">)</span>&nbsp;<span class="op" id="2758479">|</span>&nbsp;<span class="builtintype" id="2758481">int</span><span class="op" id="2758484">(</span><span class="ident" id="2758485">b</span><span class="op" id="2758486">[</span><span class="num" id="2758487">1</span><span class="op" id="2758488">]</span><span class="op" id="2758489">)</span><span class="op" id="2758490">&lt;&lt;</span><span class="num" id="2758492">8</span><br>
<span class="lineno">235</span><span class="op" id="2758494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2758497">func</span>&nbsp;<span class="ident" id="2758502">loadZoneZip</span><span class="op" id="2758513">(</span><span class="ident" id="2758514">zipfile</span><span class="op" id="2758521">,</span>&nbsp;<span class="ident" id="2758523">name</span>&nbsp;<span class="builtintype" id="2758528">string</span><span class="op" id="2758534">)</span>&nbsp;<span class="op" id="2758536">(</span><span class="ident" id="2758537">l</span>&nbsp;<span class="op" id="2758539">*</span><span class="ident" id="2758540">Location</span><span class="op" id="2758548">,</span>&nbsp;<span class="ident" id="2758550">err</span>&nbsp;<span class="builtintype" id="2758554">error</span><span class="op" id="2758559">)</span>&nbsp;<span class="op" id="2758561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2758564">fd</span><span class="op" id="2758566">,</span>&nbsp;<span class="ident" id="2758568">err</span>&nbsp;<span class="op" id="2758572">:=</span>&nbsp;<span class="ident" id="2758575">open</span><span class="op" id="2758579">(</span><span class="ident" id="2758580">zipfile</span><span class="op" id="2758587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2758590">if</span>&nbsp;<span class="ident" id="2758593">err</span>&nbsp;<span class="op" id="2758597">!=</span>&nbsp;<span class="builtintype" id="2758600">nil</span>&nbsp;<span class="op" id="2758604">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2758608">return</span>&nbsp;<span class="builtintype" id="2758615">nil</span><span class="op" id="2758618">,</span>&nbsp;<span class="ident" id="2758620">errors</span><span class="op" id="2758626">.</span><span class="ident" id="2758627">New</span><span class="op" id="2758630">(</span><span class="string" id="2758631">&#34;open&nbsp;&#34;</span>&nbsp;<span class="op" id="2758639">+</span>&nbsp;<span class="ident" id="2758641">zipfile</span>&nbsp;<span class="op" id="2758649">+</span>&nbsp;<span class="string" id="2758651">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="2758656">+</span>&nbsp;<span class="ident" id="2758658">err</span><span class="op" id="2758661">.</span><span class="ident" id="2758662">Error</span><span class="op" id="2758667">(</span><span class="op" id="2758668">)</span><span class="op" id="2758669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2758672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2758675">defer</span>&nbsp;<span class="ident" id="2758681">closefd</span><span class="op" id="2758688">(</span><span class="ident" id="2758689">fd</span><span class="op" id="2758691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2758695">const</span>&nbsp;<span class="op" id="2758701">(</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2758705">zecheader</span>&nbsp;<span class="op" id="2758715">=</span>&nbsp;<span class="num" id="2758717">0x06054b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2758730">zcheader</span>&nbsp;&nbsp;<span class="op" id="2758740">=</span>&nbsp;<span class="num" id="2758742">0x02014b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2758755">ztailsize</span>&nbsp;<span class="op" id="2758765">=</span>&nbsp;<span class="num" id="2758767">22</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2758773">zheadersize</span>&nbsp;<span class="op" id="2758785">=</span>&nbsp;<span class="num" id="2758787">30</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2758792">zheader</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2758804">=</span>&nbsp;<span class="num" id="2758806">0x04034b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2758818">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2758822">buf</span>&nbsp;<span class="op" id="2758826">:=</span>&nbsp;<span class="builtinfunc" id="2758829">make</span><span class="op" id="2758833">(</span><span class="op" id="2758834">[</span><span class="op" id="2758835">]</span><span class="builtintype" id="2758836">byte</span><span class="op" id="2758840">,</span>&nbsp;<span class="ident" id="2758842">ztailsize</span><span class="op" id="2758851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2758854">if</span>&nbsp;<span class="ident" id="2758857">err</span>&nbsp;<span class="op" id="2758861">:=</span>&nbsp;<span class="ident" id="2758864">preadn</span><span class="op" id="2758870">(</span><span class="ident" id="2758871">fd</span><span class="op" id="2758873">,</span>&nbsp;<span class="ident" id="2758875">buf</span><span class="op" id="2758878">,</span>&nbsp;<span class="op" id="2758880">-</span><span class="ident" id="2758881">ztailsize</span><span class="op" id="2758890">)</span><span class="op" id="2758891">;</span>&nbsp;<span class="ident" id="2758893">err</span>&nbsp;<span class="op" id="2758897">!=</span>&nbsp;<span class="builtintype" id="2758900">nil</span>&nbsp;<span class="op" id="2758904">||</span>&nbsp;<span class="ident" id="2758907">get4</span><span class="op" id="2758911">(</span><span class="ident" id="2758912">buf</span><span class="op" id="2758915">)</span>&nbsp;<span class="op" id="2758917">!=</span>&nbsp;<span class="ident" id="2758920">zecheader</span>&nbsp;<span class="op" id="2758930">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2758934">return</span>&nbsp;<span class="builtintype" id="2758941">nil</span><span class="op" id="2758944">,</span>&nbsp;<span class="ident" id="2758946">errors</span><span class="op" id="2758952">.</span><span class="ident" id="2758953">New</span><span class="op" id="2758956">(</span><span class="string" id="2758957">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2758977">+</span>&nbsp;<span class="ident" id="2758979">zipfile</span><span class="op" id="2758986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2758989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2758992">n</span>&nbsp;<span class="op" id="2758994">:=</span>&nbsp;<span class="ident" id="2758997">get2</span><span class="op" id="2759001">(</span><span class="ident" id="2759002">buf</span><span class="op" id="2759005">[</span><span class="num" id="2759006">10</span><span class="op" id="2759008">:</span><span class="op" id="2759009">]</span><span class="op" id="2759010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2759013">size</span>&nbsp;<span class="op" id="2759018">:=</span>&nbsp;<span class="ident" id="2759021">get4</span><span class="op" id="2759025">(</span><span class="ident" id="2759026">buf</span><span class="op" id="2759029">[</span><span class="num" id="2759030">12</span><span class="op" id="2759032">:</span><span class="op" id="2759033">]</span><span class="op" id="2759034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2759037">off</span>&nbsp;<span class="op" id="2759041">:=</span>&nbsp;<span class="ident" id="2759044">get4</span><span class="op" id="2759048">(</span><span class="ident" id="2759049">buf</span><span class="op" id="2759052">[</span><span class="num" id="2759053">16</span><span class="op" id="2759055">:</span><span class="op" id="2759056">]</span><span class="op" id="2759057">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2759061">buf</span>&nbsp;<span class="op" id="2759065">=</span>&nbsp;<span class="builtinfunc" id="2759067">make</span><span class="op" id="2759071">(</span><span class="op" id="2759072">[</span><span class="op" id="2759073">]</span><span class="builtintype" id="2759074">byte</span><span class="op" id="2759078">,</span>&nbsp;<span class="ident" id="2759080">size</span><span class="op" id="2759084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2759087">if</span>&nbsp;<span class="ident" id="2759090">err</span>&nbsp;<span class="op" id="2759094">:=</span>&nbsp;<span class="ident" id="2759097">preadn</span><span class="op" id="2759103">(</span><span class="ident" id="2759104">fd</span><span class="op" id="2759106">,</span>&nbsp;<span class="ident" id="2759108">buf</span><span class="op" id="2759111">,</span>&nbsp;<span class="ident" id="2759113">off</span><span class="op" id="2759116">)</span><span class="op" id="2759117">;</span>&nbsp;<span class="ident" id="2759119">err</span>&nbsp;<span class="op" id="2759123">!=</span>&nbsp;<span class="builtintype" id="2759126">nil</span>&nbsp;<span class="op" id="2759130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2759134">return</span>&nbsp;<span class="builtintype" id="2759141">nil</span><span class="op" id="2759144">,</span>&nbsp;<span class="ident" id="2759146">errors</span><span class="op" id="2759152">.</span><span class="ident" id="2759153">New</span><span class="op" id="2759156">(</span><span class="string" id="2759157">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2759177">+</span>&nbsp;<span class="ident" id="2759179">zipfile</span><span class="op" id="2759186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2759189">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2759193">for</span>&nbsp;<span class="ident" id="2759197">i</span>&nbsp;<span class="op" id="2759199">:=</span>&nbsp;<span class="num" id="2759202">0</span><span class="op" id="2759203">;</span>&nbsp;<span class="ident" id="2759205">i</span>&nbsp;<span class="op" id="2759207">&lt;</span>&nbsp;<span class="ident" id="2759209">n</span><span class="op" id="2759210">;</span>&nbsp;<span class="ident" id="2759212">i</span><span class="op" id="2759213">++</span>&nbsp;<span class="op" id="2759216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759220">//&nbsp;zip&nbsp;entry&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759243">//&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;magic[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759259">//&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;madevers[1]</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759278">//&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;madeos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759295">//&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;extvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759313">//&nbsp;&nbsp;&nbsp;&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;extos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759329">//&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;flags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759345">//&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;meth[2]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759361">//&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;modtime[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759380">//&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;moddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759399">//&nbsp;&nbsp;&nbsp;&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;crc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759414">//&nbsp;&nbsp;&nbsp;&nbsp;20&nbsp;&nbsp;&nbsp;&nbsp;csize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759431">//&nbsp;&nbsp;&nbsp;&nbsp;24&nbsp;&nbsp;&nbsp;&nbsp;uncsize[4]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759450">//&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;&nbsp;&nbsp;namelen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759469">//&nbsp;&nbsp;&nbsp;&nbsp;30&nbsp;&nbsp;&nbsp;&nbsp;xlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759485">//&nbsp;&nbsp;&nbsp;&nbsp;32&nbsp;&nbsp;&nbsp;&nbsp;fclen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759502">//&nbsp;&nbsp;&nbsp;&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;disknum[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759521">//&nbsp;&nbsp;&nbsp;&nbsp;36&nbsp;&nbsp;&nbsp;&nbsp;iattr[2]</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759538">//&nbsp;&nbsp;&nbsp;&nbsp;38&nbsp;&nbsp;&nbsp;&nbsp;eattr[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759555">//&nbsp;&nbsp;&nbsp;&nbsp;42&nbsp;&nbsp;&nbsp;&nbsp;off[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759570">//&nbsp;&nbsp;&nbsp;&nbsp;46&nbsp;&nbsp;&nbsp;&nbsp;name[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759592">//&nbsp;&nbsp;&nbsp;&nbsp;46+namelen+xlen+fclen&nbsp;-&nbsp;next&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2759633">//</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2759638">if</span>&nbsp;<span class="ident" id="2759641">get4</span><span class="op" id="2759645">(</span><span class="ident" id="2759646">buf</span><span class="op" id="2759649">)</span>&nbsp;<span class="op" id="2759651">!=</span>&nbsp;<span class="ident" id="2759654">zcheader</span>&nbsp;<span class="op" id="2759663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2759668">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2759676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2759680">meth</span>&nbsp;<span class="op" id="2759685">:=</span>&nbsp;<span class="ident" id="2759688">get2</span><span class="op" id="2759692">(</span><span class="ident" id="2759693">buf</span><span class="op" id="2759696">[</span><span class="num" id="2759697">10</span><span class="op" id="2759699">:</span><span class="op" id="2759700">]</span><span class="op" id="2759701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2759705">size</span>&nbsp;<span class="op" id="2759710">:=</span>&nbsp;<span class="ident" id="2759713">get4</span><span class="op" id="2759717">(</span><span class="ident" id="2759718">buf</span><span class="op" id="2759721">[</span><span class="num" id="2759722">24</span><span class="op" id="2759724">:</span><span class="op" id="2759725">]</span><span class="op" id="2759726">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2759730">namelen</span>&nbsp;<span class="op" id="2759738">:=</span>&nbsp;<span class="ident" id="2759741">get2</span><span class="op" id="2759745">(</span><span class="ident" id="2759746">buf</span><span class="op" id="2759749">[</span><span class="num" id="2759750">28</span><span class="op" id="2759752">:</span><span class="op" id="2759753">]</span><span class="op" id="2759754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2759758">xlen</span>&nbsp;<span class="op" id="2759763">:=</span>&nbsp;<span class="ident" id="2759766">get2</span><span class="op" id="2759770">(</span><span class="ident" id="2759771">buf</span><span class="op" id="2759774">[</span><span class="num" id="2759775">30</span><span class="op" id="2759777">:</span><span class="op" id="2759778">]</span><span class="op" id="2759779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2759783">fclen</span>&nbsp;<span class="op" id="2759789">:=</span>&nbsp;<span class="ident" id="2759792">get2</span><span class="op" id="2759796">(</span><span class="ident" id="2759797">buf</span><span class="op" id="2759800">[</span><span class="num" id="2759801">32</span><span class="op" id="2759803">:</span><span class="op" id="2759804">]</span><span class="op" id="2759805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2759809">off</span>&nbsp;<span class="op" id="2759813">:=</span>&nbsp;<span class="ident" id="2759816">get4</span><span class="op" id="2759820">(</span><span class="ident" id="2759821">buf</span><span class="op" id="2759824">[</span><span class="num" id="2759825">42</span><span class="op" id="2759827">:</span><span class="op" id="2759828">]</span><span class="op" id="2759829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2759833">zname</span>&nbsp;<span class="op" id="2759839">:=</span>&nbsp;<span class="ident" id="2759842">buf</span><span class="op" id="2759845">[</span><span class="num" id="2759846">46</span>&nbsp;<span class="op" id="2759849">:</span>&nbsp;<span class="num" id="2759851">46</span><span class="op" id="2759853">+</span><span class="ident" id="2759854">namelen</span><span class="op" id="2759861">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2759865">buf</span>&nbsp;<span class="op" id="2759869">=</span>&nbsp;<span class="ident" id="2759871">buf</span><span class="op" id="2759874">[</span><span class="num" id="2759875">46</span><span class="op" id="2759877">+</span><span class="ident" id="2759878">namelen</span><span class="op" id="2759885">+</span><span class="ident" id="2759886">xlen</span><span class="op" id="2759890">+</span><span class="ident" id="2759891">fclen</span><span class="op" id="2759896">:</span><span class="op" id="2759897">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2759901">if</span>&nbsp;<span class="builtintype" id="2759904">string</span><span class="op" id="2759910">(</span><span class="ident" id="2759911">zname</span><span class="op" id="2759916">)</span>&nbsp;<span class="op" id="2759918">!=</span>&nbsp;<span class="ident" id="2759921">name</span>&nbsp;<span class="op" id="2759926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2759931">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2759942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2759946">if</span>&nbsp;<span class="ident" id="2759949">meth</span>&nbsp;<span class="op" id="2759954">!=</span>&nbsp;<span class="num" id="2759957">0</span>&nbsp;<span class="op" id="2759959">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2759964">return</span>&nbsp;<span class="builtintype" id="2759971">nil</span><span class="op" id="2759974">,</span>&nbsp;<span class="ident" id="2759976">errors</span><span class="op" id="2759982">.</span><span class="ident" id="2759983">New</span><span class="op" id="2759986">(</span><span class="string" id="2759987">&#34;unsupported&nbsp;compression&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2760018">+</span>&nbsp;<span class="ident" id="2760020">name</span>&nbsp;<span class="op" id="2760025">+</span>&nbsp;<span class="string" id="2760027">&#34;&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="2760034">+</span>&nbsp;<span class="ident" id="2760036">zipfile</span><span class="op" id="2760043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2760047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760052">//&nbsp;zip&nbsp;per-file&nbsp;header&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760085">//&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;magic[4]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760101">//&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;extvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760119">//&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;extos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760135">//&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;flags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760151">//&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;meth[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760166">//&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;modtime[2]</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760185">//&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;moddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760204">//&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;crc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760219">//&nbsp;&nbsp;&nbsp;&nbsp;18&nbsp;&nbsp;&nbsp;&nbsp;csize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760236">//&nbsp;&nbsp;&nbsp;&nbsp;22&nbsp;&nbsp;&nbsp;&nbsp;uncsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760255">//&nbsp;&nbsp;&nbsp;&nbsp;26&nbsp;&nbsp;&nbsp;&nbsp;namelen[2]</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760274">//&nbsp;&nbsp;&nbsp;&nbsp;28&nbsp;&nbsp;&nbsp;&nbsp;xlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760290">//&nbsp;&nbsp;&nbsp;&nbsp;30&nbsp;&nbsp;&nbsp;&nbsp;name[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760312">//&nbsp;&nbsp;&nbsp;&nbsp;30+namelen+xlen&nbsp;-&nbsp;file&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2760345">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2760350">buf</span>&nbsp;<span class="op" id="2760354">=</span>&nbsp;<span class="builtinfunc" id="2760356">make</span><span class="op" id="2760360">(</span><span class="op" id="2760361">[</span><span class="op" id="2760362">]</span><span class="builtintype" id="2760363">byte</span><span class="op" id="2760367">,</span>&nbsp;<span class="ident" id="2760369">zheadersize</span><span class="op" id="2760380">+</span><span class="ident" id="2760381">namelen</span><span class="op" id="2760388">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2760392">if</span>&nbsp;<span class="ident" id="2760395">err</span>&nbsp;<span class="op" id="2760399">:=</span>&nbsp;<span class="ident" id="2760402">preadn</span><span class="op" id="2760408">(</span><span class="ident" id="2760409">fd</span><span class="op" id="2760411">,</span>&nbsp;<span class="ident" id="2760413">buf</span><span class="op" id="2760416">,</span>&nbsp;<span class="ident" id="2760418">off</span><span class="op" id="2760421">)</span><span class="op" id="2760422">;</span>&nbsp;<span class="ident" id="2760424">err</span>&nbsp;<span class="op" id="2760428">!=</span>&nbsp;<span class="builtintype" id="2760431">nil</span>&nbsp;<span class="op" id="2760435">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2760441">get4</span><span class="op" id="2760445">(</span><span class="ident" id="2760446">buf</span><span class="op" id="2760449">)</span>&nbsp;<span class="op" id="2760451">!=</span>&nbsp;<span class="ident" id="2760454">zheader</span>&nbsp;<span class="op" id="2760462">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2760468">get2</span><span class="op" id="2760472">(</span><span class="ident" id="2760473">buf</span><span class="op" id="2760476">[</span><span class="num" id="2760477">8</span><span class="op" id="2760478">:</span><span class="op" id="2760479">]</span><span class="op" id="2760480">)</span>&nbsp;<span class="op" id="2760482">!=</span>&nbsp;<span class="ident" id="2760485">meth</span>&nbsp;<span class="op" id="2760490">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2760496">get2</span><span class="op" id="2760500">(</span><span class="ident" id="2760501">buf</span><span class="op" id="2760504">[</span><span class="num" id="2760505">26</span><span class="op" id="2760507">:</span><span class="op" id="2760508">]</span><span class="op" id="2760509">)</span>&nbsp;<span class="op" id="2760511">!=</span>&nbsp;<span class="ident" id="2760514">namelen</span>&nbsp;<span class="op" id="2760522">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2760528">string</span><span class="op" id="2760534">(</span><span class="ident" id="2760535">buf</span><span class="op" id="2760538">[</span><span class="num" id="2760539">30</span><span class="op" id="2760541">:</span><span class="num" id="2760542">30</span><span class="op" id="2760544">+</span><span class="ident" id="2760545">namelen</span><span class="op" id="2760552">]</span><span class="op" id="2760553">)</span>&nbsp;<span class="op" id="2760555">!=</span>&nbsp;<span class="ident" id="2760558">name</span>&nbsp;<span class="op" id="2760563">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2760568">return</span>&nbsp;<span class="builtintype" id="2760575">nil</span><span class="op" id="2760578">,</span>&nbsp;<span class="ident" id="2760580">errors</span><span class="op" id="2760586">.</span><span class="ident" id="2760587">New</span><span class="op" id="2760590">(</span><span class="string" id="2760591">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2760611">+</span>&nbsp;<span class="ident" id="2760613">zipfile</span><span class="op" id="2760620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2760624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2760628">xlen</span>&nbsp;<span class="op" id="2760633">=</span>&nbsp;<span class="ident" id="2760635">get2</span><span class="op" id="2760639">(</span><span class="ident" id="2760640">buf</span><span class="op" id="2760643">[</span><span class="num" id="2760644">28</span><span class="op" id="2760646">:</span><span class="op" id="2760647">]</span><span class="op" id="2760648">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2760653">buf</span>&nbsp;<span class="op" id="2760657">=</span>&nbsp;<span class="builtinfunc" id="2760659">make</span><span class="op" id="2760663">(</span><span class="op" id="2760664">[</span><span class="op" id="2760665">]</span><span class="builtintype" id="2760666">byte</span><span class="op" id="2760670">,</span>&nbsp;<span class="ident" id="2760672">size</span><span class="op" id="2760676">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2760680">if</span>&nbsp;<span class="ident" id="2760683">err</span>&nbsp;<span class="op" id="2760687">:=</span>&nbsp;<span class="ident" id="2760690">preadn</span><span class="op" id="2760696">(</span><span class="ident" id="2760697">fd</span><span class="op" id="2760699">,</span>&nbsp;<span class="ident" id="2760701">buf</span><span class="op" id="2760704">,</span>&nbsp;<span class="ident" id="2760706">off</span><span class="op" id="2760709">+</span><span class="num" id="2760710">30</span><span class="op" id="2760712">+</span><span class="ident" id="2760713">namelen</span><span class="op" id="2760720">+</span><span class="ident" id="2760721">xlen</span><span class="op" id="2760725">)</span><span class="op" id="2760726">;</span>&nbsp;<span class="ident" id="2760728">err</span>&nbsp;<span class="op" id="2760732">!=</span>&nbsp;<span class="builtintype" id="2760735">nil</span>&nbsp;<span class="op" id="2760739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2760744">return</span>&nbsp;<span class="builtintype" id="2760751">nil</span><span class="op" id="2760754">,</span>&nbsp;<span class="ident" id="2760756">errors</span><span class="op" id="2760762">.</span><span class="ident" id="2760763">New</span><span class="op" id="2760766">(</span><span class="string" id="2760767">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2760787">+</span>&nbsp;<span class="ident" id="2760789">zipfile</span><span class="op" id="2760796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2760800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2760805">return</span>&nbsp;<span class="ident" id="2760812">loadZoneData</span><span class="op" id="2760824">(</span><span class="ident" id="2760825">buf</span><span class="op" id="2760828">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2760831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2760835">return</span>&nbsp;<span class="builtintype" id="2760842">nil</span><span class="op" id="2760845">,</span>&nbsp;<span class="ident" id="2760847">errors</span><span class="op" id="2760853">.</span><span class="ident" id="2760854">New</span><span class="op" id="2760857">(</span><span class="string" id="2760858">&#34;cannot&nbsp;find&nbsp;&#34;</span>&nbsp;<span class="op" id="2760873">+</span>&nbsp;<span class="ident" id="2760875">name</span>&nbsp;<span class="op" id="2760880">+</span>&nbsp;<span class="string" id="2760882">&#34;&nbsp;in&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2760898">+</span>&nbsp;<span class="ident" id="2760900">zipfile</span><span class="op" id="2760907">)</span><br>
<span class="lineno"></span><span class="op" id="2760909">}</span>
</div>
</body>
</html>
