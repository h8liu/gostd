<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html" class="current">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6124580">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6124636">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6124690">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6124741">package</span>&nbsp;<span class="ident" id="6124749">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6124756">import</span>&nbsp;<span class="op" id="6124763">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6124766">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6124777">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6124785">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6124792">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6124795">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="6124860">type</span>&nbsp;<span class="ident" id="6124865">GCStats</span>&nbsp;<span class="keyword" id="6124873">struct</span>&nbsp;<span class="op" id="6124880">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6124883">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6124898">time</span><span class="op" id="6124902">.</span><span class="ident" id="6124903">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6124914">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6124942">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6124957">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6124973">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125007">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125022">time</span><span class="op" id="6125026">.</span><span class="ident" id="6125027">Duration</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6125038">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125074">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6125089">[</span><span class="op" id="6125090">]</span><span class="ident" id="6125091">time</span><span class="op" id="6125095">.</span><span class="ident" id="6125096">Duration</span>&nbsp;<span class="comment" id="6125105">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125142">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6125157">[</span><span class="op" id="6125158">]</span><span class="ident" id="6125159">time</span><span class="op" id="6125163">.</span><span class="ident" id="6125164">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6125173">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6125220">PauseQuantiles</span>&nbsp;<span class="op" id="6125235">[</span><span class="op" id="6125236">]</span><span class="ident" id="6125237">time</span><span class="op" id="6125241">.</span><span class="ident" id="6125242">Duration</span><br>
<span class="lineno"></span><span class="op" id="6125251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6125254">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="6125323">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="6125390">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="6125466">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="6125533">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="6125610">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="6125673">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="6125744">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="6125787">func</span>&nbsp;<span class="ident" id="6125792">ReadGCStats</span><span class="op" id="6125803">(</span><span class="ident" id="6125804">stats</span>&nbsp;<span class="op" id="6125810">*</span><span class="ident" id="6125811">GCStats</span><span class="op" id="6125818">)</span>&nbsp;<span class="op" id="6125820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6125823">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6125885">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6125948">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126012">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126068">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126093">const</span>&nbsp;<span class="ident" id="6126099">maxPause</span>&nbsp;<span class="op" id="6126108">=</span>&nbsp;<span class="builtinfunc" id="6126110">len</span><span class="op" id="6126113">(</span><span class="op" id="6126114">(</span><span class="op" id="6126115">(</span><span class="op" id="6126116">*</span><span class="ident" id="6126117">runtime</span><span class="op" id="6126124">.</span><span class="ident" id="6126125">MemStats</span><span class="op" id="6126133">)</span><span class="op" id="6126134">(</span><span class="builtintype" id="6126135">nil</span><span class="op" id="6126138">)</span><span class="op" id="6126139">)</span><span class="op" id="6126140">.</span><span class="ident" id="6126141">PauseNs</span><span class="op" id="6126148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126151">if</span>&nbsp;<span class="builtinfunc" id="6126154">cap</span><span class="op" id="6126157">(</span><span class="ident" id="6126158">stats</span><span class="op" id="6126163">.</span><span class="ident" id="6126164">Pause</span><span class="op" id="6126169">)</span>&nbsp;<span class="op" id="6126171">&lt;</span>&nbsp;<span class="num" id="6126173">2</span><span class="op" id="6126174">*</span><span class="ident" id="6126175">maxPause</span><span class="op" id="6126183">+</span><span class="num" id="6126184">3</span>&nbsp;<span class="op" id="6126186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126190">stats</span><span class="op" id="6126195">.</span><span class="ident" id="6126196">Pause</span>&nbsp;<span class="op" id="6126202">=</span>&nbsp;<span class="builtinfunc" id="6126204">make</span><span class="op" id="6126208">(</span><span class="op" id="6126209">[</span><span class="op" id="6126210">]</span><span class="ident" id="6126211">time</span><span class="op" id="6126215">.</span><span class="ident" id="6126216">Duration</span><span class="op" id="6126224">,</span>&nbsp;<span class="num" id="6126226">2</span><span class="op" id="6126227">*</span><span class="ident" id="6126228">maxPause</span><span class="op" id="6126236">+</span><span class="num" id="6126237">3</span><span class="op" id="6126238">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6126241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126245">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126311">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126379">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126442">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126501">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6126569">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126589">readGCStats</span><span class="op" id="6126600">(</span><span class="op" id="6126601">&amp;</span><span class="ident" id="6126602">stats</span><span class="op" id="6126607">.</span><span class="ident" id="6126608">Pause</span><span class="op" id="6126613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126616">n</span>&nbsp;<span class="op" id="6126618">:=</span>&nbsp;<span class="builtinfunc" id="6126621">len</span><span class="op" id="6126624">(</span><span class="ident" id="6126625">stats</span><span class="op" id="6126630">.</span><span class="ident" id="6126631">Pause</span><span class="op" id="6126636">)</span>&nbsp;<span class="op" id="6126638">-</span>&nbsp;<span class="num" id="6126640">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126643">stats</span><span class="op" id="6126648">.</span><span class="ident" id="6126649">LastGC</span>&nbsp;<span class="op" id="6126656">=</span>&nbsp;<span class="ident" id="6126658">time</span><span class="op" id="6126662">.</span><span class="ident" id="6126663">Unix</span><span class="op" id="6126667">(</span><span class="num" id="6126668">0</span><span class="op" id="6126669">,</span>&nbsp;<span class="ident" id="6126671">int64</span><span class="op" id="6126676">(</span><span class="ident" id="6126677">stats</span><span class="op" id="6126682">.</span><span class="ident" id="6126683">Pause</span><span class="op" id="6126688">[</span><span class="ident" id="6126689">n</span><span class="op" id="6126690">]</span><span class="op" id="6126691">)</span><span class="op" id="6126692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126695">stats</span><span class="op" id="6126700">.</span><span class="ident" id="6126701">NumGC</span>&nbsp;<span class="op" id="6126707">=</span>&nbsp;<span class="ident" id="6126709">int64</span><span class="op" id="6126714">(</span><span class="ident" id="6126715">stats</span><span class="op" id="6126720">.</span><span class="ident" id="6126721">Pause</span><span class="op" id="6126726">[</span><span class="ident" id="6126727">n</span><span class="op" id="6126728">+</span><span class="num" id="6126729">1</span><span class="op" id="6126730">]</span><span class="op" id="6126731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126734">stats</span><span class="op" id="6126739">.</span><span class="ident" id="6126740">PauseTotal</span>&nbsp;<span class="op" id="6126751">=</span>&nbsp;<span class="ident" id="6126753">stats</span><span class="op" id="6126758">.</span><span class="ident" id="6126759">Pause</span><span class="op" id="6126764">[</span><span class="ident" id="6126765">n</span><span class="op" id="6126766">+</span><span class="num" id="6126767">2</span><span class="op" id="6126768">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126771">n</span>&nbsp;<span class="op" id="6126773">/=</span>&nbsp;<span class="num" id="6126776">2</span>&nbsp;<span class="comment" id="6126778">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126816">stats</span><span class="op" id="6126821">.</span><span class="ident" id="6126822">Pause</span>&nbsp;<span class="op" id="6126828">=</span>&nbsp;<span class="ident" id="6126830">stats</span><span class="op" id="6126835">.</span><span class="ident" id="6126836">Pause</span><span class="op" id="6126841">[</span><span class="op" id="6126842">:</span><span class="ident" id="6126843">n</span><span class="op" id="6126844">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126848">if</span>&nbsp;<span class="builtinfunc" id="6126851">cap</span><span class="op" id="6126854">(</span><span class="ident" id="6126855">stats</span><span class="op" id="6126860">.</span><span class="ident" id="6126861">PauseEnd</span><span class="op" id="6126869">)</span>&nbsp;<span class="op" id="6126871">&lt;</span>&nbsp;<span class="ident" id="6126873">maxPause</span>&nbsp;<span class="op" id="6126882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126886">stats</span><span class="op" id="6126891">.</span><span class="ident" id="6126892">PauseEnd</span>&nbsp;<span class="op" id="6126901">=</span>&nbsp;<span class="builtinfunc" id="6126903">make</span><span class="op" id="6126907">(</span><span class="op" id="6126908">[</span><span class="op" id="6126909">]</span><span class="ident" id="6126910">time</span><span class="op" id="6126914">.</span><span class="ident" id="6126915">Time</span><span class="op" id="6126919">,</span>&nbsp;<span class="num" id="6126921">0</span><span class="op" id="6126922">,</span>&nbsp;<span class="ident" id="6126924">maxPause</span><span class="op" id="6126932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6126935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6126938">stats</span><span class="op" id="6126943">.</span><span class="ident" id="6126944">PauseEnd</span>&nbsp;<span class="op" id="6126953">=</span>&nbsp;<span class="ident" id="6126955">stats</span><span class="op" id="6126960">.</span><span class="ident" id="6126961">PauseEnd</span><span class="op" id="6126969">[</span><span class="op" id="6126970">:</span><span class="num" id="6126971">0</span><span class="op" id="6126972">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6126975">for</span>&nbsp;<span class="ident" id="6126979">_</span><span class="op" id="6126980">,</span>&nbsp;<span class="ident" id="6126982">ns</span>&nbsp;<span class="op" id="6126985">:=</span>&nbsp;<span class="keyword" id="6126988">range</span>&nbsp;<span class="ident" id="6126994">stats</span><span class="op" id="6126999">.</span><span class="ident" id="6127000">Pause</span><span class="op" id="6127005">[</span><span class="ident" id="6127006">n</span>&nbsp;<span class="op" id="6127008">:</span>&nbsp;<span class="ident" id="6127010">n</span><span class="op" id="6127011">+</span><span class="ident" id="6127012">n</span><span class="op" id="6127013">]</span>&nbsp;<span class="op" id="6127015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6127019">stats</span><span class="op" id="6127024">.</span><span class="ident" id="6127025">PauseEnd</span>&nbsp;<span class="op" id="6127034">=</span>&nbsp;<span class="builtinfunc" id="6127036">append</span><span class="op" id="6127042">(</span><span class="ident" id="6127043">stats</span><span class="op" id="6127048">.</span><span class="ident" id="6127049">PauseEnd</span><span class="op" id="6127057">,</span>&nbsp;<span class="ident" id="6127059">time</span><span class="op" id="6127063">.</span><span class="ident" id="6127064">Unix</span><span class="op" id="6127068">(</span><span class="num" id="6127069">0</span><span class="op" id="6127070">,</span>&nbsp;<span class="ident" id="6127072">int64</span><span class="op" id="6127077">(</span><span class="ident" id="6127078">ns</span><span class="op" id="6127080">)</span><span class="op" id="6127081">)</span><span class="op" id="6127082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6127085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6127089">if</span>&nbsp;<span class="builtinfunc" id="6127092">len</span><span class="op" id="6127095">(</span><span class="ident" id="6127096">stats</span><span class="op" id="6127101">.</span><span class="ident" id="6127102">PauseQuantiles</span><span class="op" id="6127116">)</span>&nbsp;<span class="op" id="6127118">&gt;</span>&nbsp;<span class="num" id="6127120">0</span>&nbsp;<span class="op" id="6127122">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6127126">if</span>&nbsp;<span class="ident" id="6127129">n</span>&nbsp;<span class="op" id="6127131">==</span>&nbsp;<span class="num" id="6127134">0</span>&nbsp;<span class="op" id="6127136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6127141">for</span>&nbsp;<span class="ident" id="6127145">i</span>&nbsp;<span class="op" id="6127147">:=</span>&nbsp;<span class="keyword" id="6127150">range</span>&nbsp;<span class="ident" id="6127156">stats</span><span class="op" id="6127161">.</span><span class="ident" id="6127162">PauseQuantiles</span>&nbsp;<span class="op" id="6127177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6127183">stats</span><span class="op" id="6127188">.</span><span class="ident" id="6127189">PauseQuantiles</span><span class="op" id="6127203">[</span><span class="ident" id="6127204">i</span><span class="op" id="6127205">]</span>&nbsp;<span class="op" id="6127207">=</span>&nbsp;<span class="num" id="6127209">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6127214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6127218">}</span>&nbsp;<span class="keyword" id="6127220">else</span>&nbsp;<span class="op" id="6127225">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6127230">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6127295">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6127348">sorted</span>&nbsp;<span class="op" id="6127355">:=</span>&nbsp;<span class="ident" id="6127358">stats</span><span class="op" id="6127363">.</span><span class="ident" id="6127364">Pause</span><span class="op" id="6127369">[</span><span class="ident" id="6127370">n</span>&nbsp;<span class="op" id="6127372">:</span>&nbsp;<span class="ident" id="6127374">n</span><span class="op" id="6127375">+</span><span class="ident" id="6127376">n</span><span class="op" id="6127377">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6127382">copy</span><span class="op" id="6127386">(</span><span class="ident" id="6127387">sorted</span><span class="op" id="6127393">,</span>&nbsp;<span class="ident" id="6127395">stats</span><span class="op" id="6127400">.</span><span class="ident" id="6127401">Pause</span><span class="op" id="6127406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6127411">sort</span><span class="op" id="6127415">.</span><span class="ident" id="6127416">Sort</span><span class="op" id="6127420">(</span><span class="ident" id="6127421">byDuration</span><span class="op" id="6127431">(</span><span class="ident" id="6127432">sorted</span><span class="op" id="6127438">)</span><span class="op" id="6127439">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6127444">nq</span>&nbsp;<span class="op" id="6127447">:=</span>&nbsp;<span class="builtinfunc" id="6127450">len</span><span class="op" id="6127453">(</span><span class="ident" id="6127454">stats</span><span class="op" id="6127459">.</span><span class="ident" id="6127460">PauseQuantiles</span><span class="op" id="6127474">)</span>&nbsp;<span class="op" id="6127476">-</span>&nbsp;<span class="num" id="6127478">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6127483">for</span>&nbsp;<span class="ident" id="6127487">i</span>&nbsp;<span class="op" id="6127489">:=</span>&nbsp;<span class="num" id="6127492">0</span><span class="op" id="6127493">;</span>&nbsp;<span class="ident" id="6127495">i</span>&nbsp;<span class="op" id="6127497">&lt;</span>&nbsp;<span class="ident" id="6127499">nq</span><span class="op" id="6127501">;</span>&nbsp;<span class="ident" id="6127503">i</span><span class="op" id="6127504">++</span>&nbsp;<span class="op" id="6127507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6127513">stats</span><span class="op" id="6127518">.</span><span class="ident" id="6127519">PauseQuantiles</span><span class="op" id="6127533">[</span><span class="ident" id="6127534">i</span><span class="op" id="6127535">]</span>&nbsp;<span class="op" id="6127537">=</span>&nbsp;<span class="ident" id="6127539">sorted</span><span class="op" id="6127545">[</span><span class="builtinfunc" id="6127546">len</span><span class="op" id="6127549">(</span><span class="ident" id="6127550">sorted</span><span class="op" id="6127556">)</span><span class="op" id="6127557">*</span><span class="ident" id="6127558">i</span><span class="op" id="6127559">/</span><span class="ident" id="6127560">nq</span><span class="op" id="6127562">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6127567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6127572">stats</span><span class="op" id="6127577">.</span><span class="ident" id="6127578">PauseQuantiles</span><span class="op" id="6127592">[</span><span class="ident" id="6127593">nq</span><span class="op" id="6127595">]</span>&nbsp;<span class="op" id="6127597">=</span>&nbsp;<span class="ident" id="6127599">sorted</span><span class="op" id="6127605">[</span><span class="builtinfunc" id="6127606">len</span><span class="op" id="6127609">(</span><span class="ident" id="6127610">sorted</span><span class="op" id="6127616">)</span><span class="op" id="6127617">-</span><span class="num" id="6127618">1</span><span class="op" id="6127619">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6127623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6127626">}</span><br>
<span class="lineno"></span><span class="op" id="6127628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6127631">type</span>&nbsp;<span class="ident" id="6127636">byDuration</span>&nbsp;<span class="op" id="6127647">[</span><span class="op" id="6127648">]</span><span class="ident" id="6127649">time</span><span class="op" id="6127653">.</span><span class="ident" id="6127654">Duration</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="6127664">func</span>&nbsp;<span class="op" id="6127669">(</span><span class="ident" id="6127670">x</span>&nbsp;<span class="ident" id="6127672">byDuration</span><span class="op" id="6127682">)</span>&nbsp;<span class="ident" id="6127684">Len</span><span class="op" id="6127687">(</span><span class="op" id="6127688">)</span>&nbsp;<span class="builtintype" id="6127690">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6127704">{</span>&nbsp;<span class="keyword" id="6127706">return</span>&nbsp;<span class="builtinfunc" id="6127713">len</span><span class="op" id="6127716">(</span><span class="ident" id="6127717">x</span><span class="op" id="6127718">)</span>&nbsp;<span class="op" id="6127720">}</span><br>
<span class="lineno"></span><span class="keyword" id="6127722">func</span>&nbsp;<span class="op" id="6127727">(</span><span class="ident" id="6127728">x</span>&nbsp;<span class="ident" id="6127730">byDuration</span><span class="op" id="6127740">)</span>&nbsp;<span class="ident" id="6127742">Swap</span><span class="op" id="6127746">(</span><span class="ident" id="6127747">i</span><span class="op" id="6127748">,</span>&nbsp;<span class="ident" id="6127750">j</span>&nbsp;<span class="builtintype" id="6127752">int</span><span class="op" id="6127755">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6127762">{</span>&nbsp;<span class="ident" id="6127764">x</span><span class="op" id="6127765">[</span><span class="ident" id="6127766">i</span><span class="op" id="6127767">]</span><span class="op" id="6127768">,</span>&nbsp;<span class="ident" id="6127770">x</span><span class="op" id="6127771">[</span><span class="ident" id="6127772">j</span><span class="op" id="6127773">]</span>&nbsp;<span class="op" id="6127775">=</span>&nbsp;<span class="ident" id="6127777">x</span><span class="op" id="6127778">[</span><span class="ident" id="6127779">j</span><span class="op" id="6127780">]</span><span class="op" id="6127781">,</span>&nbsp;<span class="ident" id="6127783">x</span><span class="op" id="6127784">[</span><span class="ident" id="6127785">i</span><span class="op" id="6127786">]</span>&nbsp;<span class="op" id="6127788">}</span><br>
<span class="lineno"></span><span class="keyword" id="6127790">func</span>&nbsp;<span class="op" id="6127795">(</span><span class="ident" id="6127796">x</span>&nbsp;<span class="ident" id="6127798">byDuration</span><span class="op" id="6127808">)</span>&nbsp;<span class="ident" id="6127810">Less</span><span class="op" id="6127814">(</span><span class="ident" id="6127815">i</span><span class="op" id="6127816">,</span>&nbsp;<span class="ident" id="6127818">j</span>&nbsp;<span class="builtintype" id="6127820">int</span><span class="op" id="6127823">)</span>&nbsp;<span class="builtintype" id="6127825">bool</span>&nbsp;<span class="op" id="6127830">{</span>&nbsp;<span class="keyword" id="6127832">return</span>&nbsp;<span class="ident" id="6127839">x</span><span class="op" id="6127840">[</span><span class="ident" id="6127841">i</span><span class="op" id="6127842">]</span>&nbsp;<span class="op" id="6127844">&lt;</span>&nbsp;<span class="ident" id="6127846">x</span><span class="op" id="6127847">[</span><span class="ident" id="6127848">j</span><span class="op" id="6127849">]</span>&nbsp;<span class="op" id="6127851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="6127854">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="6127917">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6127987">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="6128068">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="6128114">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="6128183">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="6128233">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="6128287">func</span>&nbsp;<span class="ident" id="6128292">SetGCPercent</span><span class="op" id="6128304">(</span><span class="ident" id="6128305">percent</span>&nbsp;<span class="builtintype" id="6128313">int</span><span class="op" id="6128316">)</span>&nbsp;<span class="builtintype" id="6128318">int</span>&nbsp;<span class="op" id="6128322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6128325">old</span>&nbsp;<span class="op" id="6128329">:=</span>&nbsp;<span class="ident" id="6128332">setGCPercent</span><span class="op" id="6128344">(</span><span class="builtintype" id="6128345">int32</span><span class="op" id="6128350">(</span><span class="ident" id="6128351">percent</span><span class="op" id="6128358">)</span><span class="op" id="6128359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6128362">runtime</span><span class="op" id="6128369">.</span><span class="ident" id="6128370">GC</span><span class="op" id="6128372">(</span><span class="op" id="6128373">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6128376">return</span>&nbsp;<span class="builtintype" id="6128383">int</span><span class="op" id="6128386">(</span><span class="ident" id="6128387">old</span><span class="op" id="6128390">)</span><br>
<span class="lineno"></span><span class="op" id="6128392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6128395">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="6128454">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="6128514">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="6128581">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="6128646">func</span>&nbsp;<span class="ident" id="6128651">FreeOSMemory</span><span class="op" id="6128663">(</span><span class="op" id="6128664">)</span>&nbsp;<span class="op" id="6128666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6128669">freeOSMemory</span><span class="op" id="6128681">(</span><span class="op" id="6128682">)</span><br>
<span class="lineno"></span><span class="op" id="6128684">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="6128687">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="6128741">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="6128785">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="6128849">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="6128873">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="6128918">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="6128994">//</span><br>
<span class="lineno"></span><span class="comment" id="6128997">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6129061">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="6129131">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="6129148">func</span>&nbsp;<span class="ident" id="6129153">SetMaxStack</span><span class="op" id="6129164">(</span><span class="ident" id="6129165">bytes</span>&nbsp;<span class="builtintype" id="6129171">int</span><span class="op" id="6129174">)</span>&nbsp;<span class="builtintype" id="6129176">int</span>&nbsp;<span class="op" id="6129180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6129183">return</span>&nbsp;<span class="ident" id="6129190">setMaxStack</span><span class="op" id="6129201">(</span><span class="ident" id="6129202">bytes</span><span class="op" id="6129207">)</span><br>
<span class="lineno"></span><span class="op" id="6129209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6129212">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="6129273">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="6129345">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="6129380">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="6129427">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="6129469">//</span><br>
<span class="lineno"></span><span class="comment" id="6129472">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="6129549">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="6129623">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="6129711">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="6129784">//</span><br>
<span class="lineno"></span><span class="comment" id="6129787">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6129853">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="6129921">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="6129992">func</span>&nbsp;<span class="ident" id="6129997">SetMaxThreads</span><span class="op" id="6130010">(</span><span class="ident" id="6130011">threads</span>&nbsp;<span class="builtintype" id="6130019">int</span><span class="op" id="6130022">)</span>&nbsp;<span class="builtintype" id="6130024">int</span>&nbsp;<span class="op" id="6130028">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6130031">return</span>&nbsp;<span class="ident" id="6130038">setMaxThreads</span><span class="op" id="6130051">(</span><span class="ident" id="6130052">threads</span><span class="op" id="6130059">)</span><br>
<span class="lineno"></span><span class="op" id="6130061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6130064">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="6130137">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="6130212">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="6130291">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="6130359">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="6130431">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="6130503">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="6130558">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="6130616">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="6130652">func</span>&nbsp;<span class="ident" id="6130657">SetPanicOnFault</span><span class="op" id="6130672">(</span><span class="ident" id="6130673">enabled</span>&nbsp;<span class="builtintype" id="6130681">bool</span><span class="op" id="6130685">)</span>&nbsp;<span class="builtintype" id="6130687">bool</span>&nbsp;<span class="op" id="6130692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6130695">return</span>&nbsp;<span class="ident" id="6130702">setPanicOnFault</span><span class="op" id="6130717">(</span><span class="ident" id="6130718">enabled</span><span class="op" id="6130725">)</span><br>
<span class="lineno"></span><span class="op" id="6130727">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="6130730">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="6130799">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="6130835">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="6130907">func</span>&nbsp;<span class="ident" id="6130912">WriteHeapDump</span><span class="op" id="6130925">(</span><span class="ident" id="6130926">fd</span>&nbsp;<span class="builtintype" id="6130929">uintptr</span><span class="op" id="6130936">)</span>
</div>
</body>
</html>
