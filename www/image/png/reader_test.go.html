<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8117638">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8117693">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8117747">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8117798">package</span>&nbsp;<span class="ident" id="8117806">png</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8117811">import</span>&nbsp;<span class="op" id="8117818">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117821">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117830">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117837">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117846">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117861">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117867">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117880">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117886">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117897">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8117907">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8117910">var</span>&nbsp;<span class="ident" id="8117914">filenames</span>&nbsp;<span class="op" id="8117924">=</span>&nbsp;<span class="op" id="8117926">[</span><span class="op" id="8117927">]</span><span class="builtintype" id="8117928">string</span><span class="op" id="8117934">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117937">&#34;basn0g01&#34;</span><span class="op" id="8117947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117950">&#34;basn0g01-30&#34;</span><span class="op" id="8117963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117966">&#34;basn0g02&#34;</span><span class="op" id="8117976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117979">&#34;basn0g02-29&#34;</span><span class="op" id="8117992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8117995">&#34;basn0g04&#34;</span><span class="op" id="8118005">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118008">&#34;basn0g04-31&#34;</span><span class="op" id="8118021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118024">&#34;basn0g08&#34;</span><span class="op" id="8118034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118037">&#34;basn0g16&#34;</span><span class="op" id="8118047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118050">&#34;basn2c08&#34;</span><span class="op" id="8118060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118063">&#34;basn2c16&#34;</span><span class="op" id="8118073">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118076">&#34;basn3p01&#34;</span><span class="op" id="8118086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118089">&#34;basn3p02&#34;</span><span class="op" id="8118099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118102">&#34;basn3p04&#34;</span><span class="op" id="8118112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118115">&#34;basn3p04-31i&#34;</span><span class="op" id="8118129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118132">&#34;basn3p08&#34;</span><span class="op" id="8118142">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118145">&#34;basn3p08-trns&#34;</span><span class="op" id="8118160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118163">&#34;basn4a08&#34;</span><span class="op" id="8118173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118176">&#34;basn4a16&#34;</span><span class="op" id="8118186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118189">&#34;basn6a08&#34;</span><span class="op" id="8118199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118202">&#34;basn6a16&#34;</span><span class="op" id="8118212">,</span><br>
<span class="lineno">40</span><span class="op" id="8118214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8118217">var</span>&nbsp;<span class="ident" id="8118221">filenamesPaletted</span>&nbsp;<span class="op" id="8118239">=</span>&nbsp;<span class="op" id="8118241">[</span><span class="op" id="8118242">]</span><span class="builtintype" id="8118243">string</span><span class="op" id="8118249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118252">&#34;basn3p01&#34;</span><span class="op" id="8118262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118265">&#34;basn3p02&#34;</span><span class="op" id="8118275">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118278">&#34;basn3p04&#34;</span><span class="op" id="8118288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118291">&#34;basn3p08&#34;</span><span class="op" id="8118301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118304">&#34;basn3p08-trns&#34;</span><span class="op" id="8118319">,</span><br>
<span class="lineno"></span><span class="op" id="8118321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="8118324">var</span>&nbsp;<span class="ident" id="8118328">filenamesShort</span>&nbsp;<span class="op" id="8118343">=</span>&nbsp;<span class="op" id="8118345">[</span><span class="op" id="8118346">]</span><span class="builtintype" id="8118347">string</span><span class="op" id="8118353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118356">&#34;basn0g01&#34;</span><span class="op" id="8118366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118369">&#34;basn0g04-31&#34;</span><span class="op" id="8118382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8118385">&#34;basn6a16&#34;</span><span class="op" id="8118395">,</span><br>
<span class="lineno"></span><span class="op" id="8118397">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="8118400">func</span>&nbsp;<span class="ident" id="8118405">readPNG</span><span class="op" id="8118412">(</span><span class="ident" id="8118413">filename</span>&nbsp;<span class="builtintype" id="8118422">string</span><span class="op" id="8118428">)</span>&nbsp;<span class="op" id="8118430">(</span><span class="ident" id="8118431"><a href="/image/png/reader_test.go.html#8117837">image</a></span><span class="op" id="8118436">.</span><span class="ident" id="8118437">Image</span><span class="op" id="8118442">,</span>&nbsp;<span class="builtintype" id="8118444">error</span><span class="op" id="8118449">)</span>&nbsp;<span class="op" id="8118451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118454">f</span><span class="op" id="8118455">,</span>&nbsp;<span class="ident" id="8118457">err</span>&nbsp;<span class="op" id="8118461">:=</span>&nbsp;<span class="ident" id="8118464"><a href="/image/png/reader_test.go.html#8117880">os</a></span><span class="op" id="8118466">.</span><span class="ident" id="8118467">Open</span><span class="op" id="8118471">(</span><span class="ident" id="8118472"><a href="/image/png/reader_test.go.html#8118413">filename</a></span><span class="op" id="8118480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118483">if</span>&nbsp;<span class="ident" id="8118486"><a href="/image/png/reader_test.go.html#8118457">err</a></span>&nbsp;<span class="op" id="8118490">!=</span>&nbsp;<span class="ident" id="8118493">nil</span>&nbsp;<span class="op" id="8118497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118501">return</span>&nbsp;<span class="ident" id="8118508">nil</span><span class="op" id="8118511">,</span>&nbsp;<span class="ident" id="8118513"><a href="/image/png/reader_test.go.html#8118457">err</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118521">defer</span>&nbsp;<span class="ident" id="8118527"><a href="/image/png/reader_test.go.html#8118454">f</a></span><span class="op" id="8118528">.</span><span class="ident" id="8118529">Close</span><span class="op" id="8118534">(</span><span class="op" id="8118535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118538">return</span>&nbsp;<span class="ident" id="8118545"><a href="/image/png/reader.go.html#4879689">Decode</a></span><span class="op" id="8118551">(</span><span class="ident" id="8118552"><a href="/image/png/reader_test.go.html#8118454">f</a></span><span class="op" id="8118553">)</span><br>
<span class="lineno"></span><span class="op" id="8118555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="8118558">//&nbsp;An&nbsp;approximation&nbsp;of&nbsp;the&nbsp;sng&nbsp;command-line&nbsp;tool.</span><br>
<span class="lineno"></span><span class="keyword" id="8118608">func</span>&nbsp;<span class="ident" id="8118613">sng</span><span class="op" id="8118616">(</span><span class="ident" id="8118617">w</span>&nbsp;<span class="ident" id="8118619"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8118621">.</span><span class="ident" id="8118622">WriteCloser</span><span class="op" id="8118633">,</span>&nbsp;<span class="ident" id="8118635">filename</span>&nbsp;<span class="builtintype" id="8118644">string</span><span class="op" id="8118650">,</span>&nbsp;<span class="ident" id="8118652">png</span>&nbsp;<span class="ident" id="8118656"><a href="/image/png/reader_test.go.html#8117837">image</a></span><span class="op" id="8118661">.</span><span class="ident" id="8118662">Image</span><span class="op" id="8118667">)</span>&nbsp;<span class="op" id="8118669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118672">defer</span>&nbsp;<span class="ident" id="8118678"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8118679">.</span><span class="ident" id="8118680">Close</span><span class="op" id="8118685">(</span><span class="op" id="8118686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118689">bounds</span>&nbsp;<span class="op" id="8118696">:=</span>&nbsp;<span class="ident" id="8118699"><a href="/image/png/reader_test.go.html#8118652">png</a></span><span class="op" id="8118702">.</span><span class="ident" id="8118703">Bounds</span><span class="op" id="8118709">(</span><span class="op" id="8118710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118713">cm</span>&nbsp;<span class="op" id="8118716">:=</span>&nbsp;<span class="ident" id="8118719"><a href="/image/png/reader_test.go.html#8118652">png</a></span><span class="op" id="8118722">.</span><span class="ident" id="8118723">ColorModel</span><span class="op" id="8118733">(</span><span class="op" id="8118734">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118737">var</span>&nbsp;<span class="ident" id="8118741">bitdepth</span>&nbsp;<span class="builtintype" id="8118750">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118755">switch</span>&nbsp;<span class="ident" id="8118762"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8118765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118768">case</span>&nbsp;<span class="ident" id="8118773"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8118778">.</span><span class="ident" id="8118779">RGBAModel</span><span class="op" id="8118788">,</span>&nbsp;<span class="ident" id="8118790"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8118795">.</span><span class="ident" id="8118796">NRGBAModel</span><span class="op" id="8118806">,</span>&nbsp;<span class="ident" id="8118808"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8118813">.</span><span class="ident" id="8118814">AlphaModel</span><span class="op" id="8118824">,</span>&nbsp;<span class="ident" id="8118826"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8118831">.</span><span class="ident" id="8118832">GrayModel</span><span class="op" id="8118841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118845"><a href="/image/png/reader_test.go.html#8118741">bitdepth</a></span>&nbsp;<span class="op" id="8118854">=</span>&nbsp;<span class="num" id="8118856">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118859">default</span><span class="op" id="8118866">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118870"><a href="/image/png/reader_test.go.html#8118741">bitdepth</a></span>&nbsp;<span class="op" id="8118879">=</span>&nbsp;<span class="num" id="8118881">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8118885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8118888">cpm</span><span class="op" id="8118891">,</span>&nbsp;<span class="ident" id="8118893">_</span>&nbsp;<span class="op" id="8118895">:=</span>&nbsp;<span class="ident" id="8118898"><a href="/image/png/reader_test.go.html#8118713">cm</a></span><span class="op" id="8118900">.</span><span class="op" id="8118901">(</span><span class="ident" id="8118902"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8118907">.</span><span class="ident" id="8118908">Palette</span><span class="op" id="8118915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118918">var</span>&nbsp;<span class="ident" id="8118922">paletted</span>&nbsp;<span class="op" id="8118931">*</span><span class="ident" id="8118932"><a href="/image/png/reader_test.go.html#8117837">image</a></span><span class="op" id="8118937">.</span><span class="ident" id="8118938">Paletted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118948">if</span>&nbsp;<span class="ident" id="8118951"><a href="/image/png/reader_test.go.html#8118888">cpm</a></span>&nbsp;<span class="op" id="8118955">!=</span>&nbsp;<span class="ident" id="8118958">nil</span>&nbsp;<span class="op" id="8118962">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118966">switch</span>&nbsp;<span class="op" id="8118973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8118977">case</span>&nbsp;<span class="builtinfunc" id="8118982">len</span><span class="op" id="8118985">(</span><span class="ident" id="8118986"><a href="/image/png/reader_test.go.html#8118888">cpm</a></span><span class="op" id="8118989">)</span>&nbsp;<span class="op" id="8118991">&lt;=</span>&nbsp;<span class="num" id="8118994">2</span><span class="op" id="8118995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119000"><a href="/image/png/reader_test.go.html#8118741">bitdepth</a></span>&nbsp;<span class="op" id="8119009">=</span>&nbsp;<span class="num" id="8119011">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119015">case</span>&nbsp;<span class="builtinfunc" id="8119020">len</span><span class="op" id="8119023">(</span><span class="ident" id="8119024"><a href="/image/png/reader_test.go.html#8118888">cpm</a></span><span class="op" id="8119027">)</span>&nbsp;<span class="op" id="8119029">&lt;=</span>&nbsp;<span class="num" id="8119032">4</span><span class="op" id="8119033">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119038"><a href="/image/png/reader_test.go.html#8118741">bitdepth</a></span>&nbsp;<span class="op" id="8119047">=</span>&nbsp;<span class="num" id="8119049">2</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119053">case</span>&nbsp;<span class="builtinfunc" id="8119058">len</span><span class="op" id="8119061">(</span><span class="ident" id="8119062"><a href="/image/png/reader_test.go.html#8118888">cpm</a></span><span class="op" id="8119065">)</span>&nbsp;<span class="op" id="8119067">&lt;=</span>&nbsp;<span class="num" id="8119070">16</span><span class="op" id="8119072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119077"><a href="/image/png/reader_test.go.html#8118741">bitdepth</a></span>&nbsp;<span class="op" id="8119086">=</span>&nbsp;<span class="num" id="8119088">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119092">default</span><span class="op" id="8119099">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119104"><a href="/image/png/reader_test.go.html#8118741">bitdepth</a></span>&nbsp;<span class="op" id="8119113">=</span>&nbsp;<span class="num" id="8119115">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8119119">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119123"><a href="/image/png/reader_test.go.html#8118922">paletted</a></span>&nbsp;<span class="op" id="8119132">=</span>&nbsp;<span class="ident" id="8119134"><a href="/image/png/reader_test.go.html#8118652">png</a></span><span class="op" id="8119137">.</span><span class="op" id="8119138">(</span><span class="op" id="8119139">*</span><span class="ident" id="8119140"><a href="/image/png/reader_test.go.html#8117837">image</a></span><span class="op" id="8119145">.</span><span class="ident" id="8119146">Paletted</span><span class="op" id="8119154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8119157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8119161">//&nbsp;Write&nbsp;the&nbsp;filename&nbsp;and&nbsp;IHDR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119194"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8119196">.</span><span class="ident" id="8119197">WriteString</span><span class="op" id="8119208">(</span><span class="ident" id="8119209"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8119210">,</span>&nbsp;<span class="string" id="8119212">&#34;#SNG:&nbsp;from&nbsp;&#34;</span><span class="op" id="8119225">+</span><span class="ident" id="8119226"><a href="/image/png/reader_test.go.html#8118635">filename</a></span><span class="op" id="8119234">+</span><span class="string" id="8119235">&#34;.png\nIHDR&nbsp;{\n&#34;</span><span class="op" id="8119251">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119254"><a href="/image/png/reader_test.go.html#8117830">fmt</a></span><span class="op" id="8119257">.</span><span class="ident" id="8119258">Fprintf</span><span class="op" id="8119265">(</span><span class="ident" id="8119266"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8119267">,</span>&nbsp;<span class="string" id="8119269">&#34;&nbsp;&nbsp;&nbsp;&nbsp;width:&nbsp;%d;&nbsp;height:&nbsp;%d;&nbsp;bitdepth:&nbsp;%d;\n&#34;</span><span class="op" id="8119313">,</span>&nbsp;<span class="ident" id="8119315"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8119321">.</span><span class="ident" id="8119322">Dx</span><span class="op" id="8119324">(</span><span class="op" id="8119325">)</span><span class="op" id="8119326">,</span>&nbsp;<span class="ident" id="8119328"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8119334">.</span><span class="ident" id="8119335">Dy</span><span class="op" id="8119337">(</span><span class="op" id="8119338">)</span><span class="op" id="8119339">,</span>&nbsp;<span class="ident" id="8119341"><a href="/image/png/reader_test.go.html#8118741">bitdepth</a></span><span class="op" id="8119349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119352">switch</span>&nbsp;<span class="op" id="8119359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119362">case</span>&nbsp;<span class="ident" id="8119367"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8119370">==</span>&nbsp;<span class="ident" id="8119373"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8119378">.</span><span class="ident" id="8119379">RGBAModel</span><span class="op" id="8119388">,</span>&nbsp;<span class="ident" id="8119390"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8119393">==</span>&nbsp;<span class="ident" id="8119396"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8119401">.</span><span class="ident" id="8119402">RGBA64Model</span><span class="op" id="8119413">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119417"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8119419">.</span><span class="ident" id="8119420">WriteString</span><span class="op" id="8119431">(</span><span class="ident" id="8119432"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8119433">,</span>&nbsp;<span class="string" id="8119435">&#34;&nbsp;&nbsp;&nbsp;&nbsp;using&nbsp;color;\n&#34;</span><span class="op" id="8119455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119458">case</span>&nbsp;<span class="ident" id="8119463"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8119466">==</span>&nbsp;<span class="ident" id="8119469"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8119474">.</span><span class="ident" id="8119475">NRGBAModel</span><span class="op" id="8119485">,</span>&nbsp;<span class="ident" id="8119487"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8119490">==</span>&nbsp;<span class="ident" id="8119493"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8119498">.</span><span class="ident" id="8119499">NRGBA64Model</span><span class="op" id="8119511">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119515"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8119517">.</span><span class="ident" id="8119518">WriteString</span><span class="op" id="8119529">(</span><span class="ident" id="8119530"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8119531">,</span>&nbsp;<span class="string" id="8119533">&#34;&nbsp;&nbsp;&nbsp;&nbsp;using&nbsp;color&nbsp;alpha;\n&#34;</span><span class="op" id="8119559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119562">case</span>&nbsp;<span class="ident" id="8119567"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8119570">==</span>&nbsp;<span class="ident" id="8119573"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8119578">.</span><span class="ident" id="8119579">GrayModel</span><span class="op" id="8119588">,</span>&nbsp;<span class="ident" id="8119590"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8119593">==</span>&nbsp;<span class="ident" id="8119596"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8119601">.</span><span class="ident" id="8119602">Gray16Model</span><span class="op" id="8119613">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119617"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8119619">.</span><span class="ident" id="8119620">WriteString</span><span class="op" id="8119631">(</span><span class="ident" id="8119632"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8119633">,</span>&nbsp;<span class="string" id="8119635">&#34;&nbsp;&nbsp;&nbsp;&nbsp;using&nbsp;grayscale;\n&#34;</span><span class="op" id="8119659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119662">case</span>&nbsp;<span class="ident" id="8119667"><a href="/image/png/reader_test.go.html#8118888">cpm</a></span>&nbsp;<span class="op" id="8119671">!=</span>&nbsp;<span class="ident" id="8119674">nil</span><span class="op" id="8119677">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119681"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8119683">.</span><span class="ident" id="8119684">WriteString</span><span class="op" id="8119695">(</span><span class="ident" id="8119696"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8119697">,</span>&nbsp;<span class="string" id="8119699">&#34;&nbsp;&nbsp;&nbsp;&nbsp;using&nbsp;color&nbsp;palette;\n&#34;</span><span class="op" id="8119727">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8119730">default</span><span class="op" id="8119737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119741"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8119743">.</span><span class="ident" id="8119744">WriteString</span><span class="op" id="8119755">(</span><span class="ident" id="8119756"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8119757">,</span>&nbsp;<span class="string" id="8119759">&#34;unknown&nbsp;PNG&nbsp;decoder&nbsp;color&nbsp;model\n&#34;</span><span class="op" id="8119794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8119797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8119800"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8119802">.</span><span class="ident" id="8119803">WriteString</span><span class="op" id="8119814">(</span><span class="ident" id="8119815"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8119816">,</span>&nbsp;<span class="string" id="8119818">&#34;}\n&#34;</span><span class="op" id="8119823">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8119827">//&nbsp;We&nbsp;fake&nbsp;a&nbsp;gAMA&nbsp;output.&nbsp;The&nbsp;test&nbsp;files&nbsp;have&nbsp;a&nbsp;gAMA&nbsp;chunk&nbsp;but&nbsp;the&nbsp;go&nbsp;PNG&nbsp;parser&nbsp;ignores&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8119920">//&nbsp;(the&nbsp;PNG&nbsp;spec&nbsp;section&nbsp;11.3&nbsp;says&nbsp;&#34;Ancillary&nbsp;chunks&nbsp;may&nbsp;be&nbsp;ignored&nbsp;by&nbsp;a&nbsp;decoder&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120005"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8120007">.</span><span class="ident" id="8120008">WriteString</span><span class="op" id="8120019">(</span><span class="ident" id="8120020"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8120021">,</span>&nbsp;<span class="string" id="8120023">&#34;gAMA&nbsp;{1.0000}\n&#34;</span><span class="op" id="8120040">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8120044">//&nbsp;Write&nbsp;the&nbsp;PLTE&nbsp;and&nbsp;tRNS&nbsp;(if&nbsp;applicable).</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120089">if</span>&nbsp;<span class="ident" id="8120092"><a href="/image/png/reader_test.go.html#8118888">cpm</a></span>&nbsp;<span class="op" id="8120096">!=</span>&nbsp;<span class="ident" id="8120099">nil</span>&nbsp;<span class="op" id="8120103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120107">lastAlpha</span>&nbsp;<span class="op" id="8120117">:=</span>&nbsp;<span class="op" id="8120120">-</span><span class="num" id="8120121">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120125"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8120127">.</span><span class="ident" id="8120128">WriteString</span><span class="op" id="8120139">(</span><span class="ident" id="8120140"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8120141">,</span>&nbsp;<span class="string" id="8120143">&#34;PLTE&nbsp;{\n&#34;</span><span class="op" id="8120153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120157">for</span>&nbsp;<span class="ident" id="8120161">i</span><span class="op" id="8120162">,</span>&nbsp;<span class="ident" id="8120164">c</span>&nbsp;<span class="op" id="8120166">:=</span>&nbsp;<span class="keyword" id="8120169">range</span>&nbsp;<span class="ident" id="8120175"><a href="/image/png/reader_test.go.html#8118888">cpm</a></span>&nbsp;<span class="op" id="8120179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120184">var</span>&nbsp;<span class="ident" id="8120188">r</span><span class="op" id="8120189">,</span>&nbsp;<span class="ident" id="8120191">g</span><span class="op" id="8120192">,</span>&nbsp;<span class="ident" id="8120194">b</span><span class="op" id="8120195">,</span>&nbsp;<span class="ident" id="8120197">a</span>&nbsp;<span class="builtintype" id="8120199">uint8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120208">switch</span>&nbsp;<span class="ident" id="8120215">c</span>&nbsp;<span class="op" id="8120217">:=</span>&nbsp;<span class="ident" id="8120220"><a href="/image/png/reader_test.go.html#8120164">c</a></span><span class="op" id="8120221">.</span><span class="op" id="8120222">(</span><span class="keyword" id="8120223">type</span><span class="op" id="8120227">)</span>&nbsp;<span class="op" id="8120229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120234">case</span>&nbsp;<span class="ident" id="8120239"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8120244">.</span><span class="ident" id="8120245">RGBA</span><span class="op" id="8120249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120255"><a href="/image/png/reader_test.go.html#8120188">r</a></span><span class="op" id="8120256">,</span>&nbsp;<span class="ident" id="8120258"><a href="/image/png/reader_test.go.html#8120191">g</a></span><span class="op" id="8120259">,</span>&nbsp;<span class="ident" id="8120261"><a href="/image/png/reader_test.go.html#8120194">b</a></span><span class="op" id="8120262">,</span>&nbsp;<span class="ident" id="8120264"><a href="/image/png/reader_test.go.html#8120197">a</a></span>&nbsp;<span class="op" id="8120266">=</span>&nbsp;<span class="ident" id="8120268"><a href="/image/png/reader_test.go.html#8120215">c</a></span><span class="op" id="8120269">.</span><span class="ident" id="8120270">R</span><span class="op" id="8120271">,</span>&nbsp;<span class="ident" id="8120273"><a href="/image/png/reader_test.go.html#8120215">c</a></span><span class="op" id="8120274">.</span><span class="ident" id="8120275">G</span><span class="op" id="8120276">,</span>&nbsp;<span class="ident" id="8120278"><a href="/image/png/reader_test.go.html#8120215">c</a></span><span class="op" id="8120279">.</span><span class="ident" id="8120280">B</span><span class="op" id="8120281">,</span>&nbsp;<span class="num" id="8120283">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120291">case</span>&nbsp;<span class="ident" id="8120296"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8120301">.</span><span class="ident" id="8120302">NRGBA</span><span class="op" id="8120307">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120313"><a href="/image/png/reader_test.go.html#8120188">r</a></span><span class="op" id="8120314">,</span>&nbsp;<span class="ident" id="8120316"><a href="/image/png/reader_test.go.html#8120191">g</a></span><span class="op" id="8120317">,</span>&nbsp;<span class="ident" id="8120319"><a href="/image/png/reader_test.go.html#8120194">b</a></span><span class="op" id="8120320">,</span>&nbsp;<span class="ident" id="8120322"><a href="/image/png/reader_test.go.html#8120197">a</a></span>&nbsp;<span class="op" id="8120324">=</span>&nbsp;<span class="ident" id="8120326"><a href="/image/png/reader_test.go.html#8120215">c</a></span><span class="op" id="8120327">.</span><span class="ident" id="8120328">R</span><span class="op" id="8120329">,</span>&nbsp;<span class="ident" id="8120331"><a href="/image/png/reader_test.go.html#8120215">c</a></span><span class="op" id="8120332">.</span><span class="ident" id="8120333">G</span><span class="op" id="8120334">,</span>&nbsp;<span class="ident" id="8120336"><a href="/image/png/reader_test.go.html#8120215">c</a></span><span class="op" id="8120337">.</span><span class="ident" id="8120338">B</span><span class="op" id="8120339">,</span>&nbsp;<span class="ident" id="8120341"><a href="/image/png/reader_test.go.html#8120215">c</a></span><span class="op" id="8120342">.</span><span class="ident" id="8120343">A</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120348">default</span><span class="op" id="8120355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8120361">panic</span><span class="op" id="8120366">(</span><span class="string" id="8120367">&#34;unknown&nbsp;palette&nbsp;color&nbsp;type&#34;</span><span class="op" id="8120395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120405">if</span>&nbsp;<span class="ident" id="8120408"><a href="/image/png/reader_test.go.html#8120197">a</a></span>&nbsp;<span class="op" id="8120410">!=</span>&nbsp;<span class="num" id="8120413">0xff</span>&nbsp;<span class="op" id="8120418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120424"><a href="/image/png/reader_test.go.html#8120107">lastAlpha</a></span>&nbsp;<span class="op" id="8120434">=</span>&nbsp;<span class="ident" id="8120436"><a href="/image/png/reader_test.go.html#8120161">i</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120446"><a href="/image/png/reader_test.go.html#8117830">fmt</a></span><span class="op" id="8120449">.</span><span class="ident" id="8120450">Fprintf</span><span class="op" id="8120457">(</span><span class="ident" id="8120458"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8120459">,</span>&nbsp;<span class="string" id="8120461">&#34;&nbsp;&nbsp;&nbsp;&nbsp;(%3d,%3d,%3d)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;rgb&nbsp;=&nbsp;(0x%02x,0x%02x,0x%02x)\n&#34;</span><span class="op" id="8120517">,</span>&nbsp;<span class="ident" id="8120519"><a href="/image/png/reader_test.go.html#8120188">r</a></span><span class="op" id="8120520">,</span>&nbsp;<span class="ident" id="8120522"><a href="/image/png/reader_test.go.html#8120191">g</a></span><span class="op" id="8120523">,</span>&nbsp;<span class="ident" id="8120525"><a href="/image/png/reader_test.go.html#8120194">b</a></span><span class="op" id="8120526">,</span>&nbsp;<span class="ident" id="8120528"><a href="/image/png/reader_test.go.html#8120188">r</a></span><span class="op" id="8120529">,</span>&nbsp;<span class="ident" id="8120531"><a href="/image/png/reader_test.go.html#8120191">g</a></span><span class="op" id="8120532">,</span>&nbsp;<span class="ident" id="8120534"><a href="/image/png/reader_test.go.html#8120194">b</a></span><span class="op" id="8120535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120543"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8120545">.</span><span class="ident" id="8120546">WriteString</span><span class="op" id="8120557">(</span><span class="ident" id="8120558"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8120559">,</span>&nbsp;<span class="string" id="8120561">&#34;}\n&#34;</span><span class="op" id="8120566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120570">if</span>&nbsp;<span class="ident" id="8120573"><a href="/image/png/reader_test.go.html#8120107">lastAlpha</a></span>&nbsp;<span class="op" id="8120583">!=</span>&nbsp;<span class="op" id="8120586">-</span><span class="num" id="8120587">1</span>&nbsp;<span class="op" id="8120589">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120594"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8120596">.</span><span class="ident" id="8120597">WriteString</span><span class="op" id="8120608">(</span><span class="ident" id="8120609"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8120610">,</span>&nbsp;<span class="string" id="8120612">&#34;tRNS&nbsp;{\n&#34;</span><span class="op" id="8120622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120627">for</span>&nbsp;<span class="ident" id="8120631">i</span>&nbsp;<span class="op" id="8120633">:=</span>&nbsp;<span class="num" id="8120636">0</span><span class="op" id="8120637">;</span>&nbsp;<span class="ident" id="8120639"><a href="/image/png/reader_test.go.html#8120631">i</a></span>&nbsp;<span class="op" id="8120641">&lt;=</span>&nbsp;<span class="ident" id="8120644"><a href="/image/png/reader_test.go.html#8120107">lastAlpha</a></span><span class="op" id="8120653">;</span>&nbsp;<span class="ident" id="8120655"><a href="/image/png/reader_test.go.html#8120631">i</a></span><span class="op" id="8120656">++</span>&nbsp;<span class="op" id="8120659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120665">_</span><span class="op" id="8120666">,</span>&nbsp;<span class="ident" id="8120668">_</span><span class="op" id="8120669">,</span>&nbsp;<span class="ident" id="8120671">_</span><span class="op" id="8120672">,</span>&nbsp;<span class="ident" id="8120674">a</span>&nbsp;<span class="op" id="8120676">:=</span>&nbsp;<span class="ident" id="8120679"><a href="/image/png/reader_test.go.html#8118888">cpm</a></span><span class="op" id="8120682">[</span><span class="ident" id="8120683"><a href="/image/png/reader_test.go.html#8120631">i</a></span><span class="op" id="8120684">]</span><span class="op" id="8120685">.</span><span class="ident" id="8120686">RGBA</span><span class="op" id="8120690">(</span><span class="op" id="8120691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120697"><a href="/image/png/reader_test.go.html#8120674">a</a></span>&nbsp;<span class="op" id="8120699">&gt;&gt;=</span>&nbsp;<span class="num" id="8120703">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120709"><a href="/image/png/reader_test.go.html#8117830">fmt</a></span><span class="op" id="8120712">.</span><span class="ident" id="8120713">Fprintf</span><span class="op" id="8120720">(</span><span class="ident" id="8120721"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8120722">,</span>&nbsp;<span class="string" id="8120724">&#34;&nbsp;%d&#34;</span><span class="op" id="8120729">,</span>&nbsp;<span class="ident" id="8120731"><a href="/image/png/reader_test.go.html#8120674">a</a></span><span class="op" id="8120732">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120742"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8120744">.</span><span class="ident" id="8120745">WriteString</span><span class="op" id="8120756">(</span><span class="ident" id="8120757"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8120758">,</span>&nbsp;<span class="string" id="8120760">&#34;}\n&#34;</span><span class="op" id="8120765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8120772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8120776">//&nbsp;Write&nbsp;the&nbsp;IMAGE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120797"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8120799">.</span><span class="ident" id="8120800">WriteString</span><span class="op" id="8120811">(</span><span class="ident" id="8120812"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8120813">,</span>&nbsp;<span class="string" id="8120815">&#34;IMAGE&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;pixels&nbsp;hex\n&#34;</span><span class="op" id="8120842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120845">for</span>&nbsp;<span class="ident" id="8120849">y</span>&nbsp;<span class="op" id="8120851">:=</span>&nbsp;<span class="ident" id="8120854"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8120860">.</span><span class="ident" id="8120861">Min</span><span class="op" id="8120864">.</span><span class="ident" id="8120865">Y</span><span class="op" id="8120866">;</span>&nbsp;<span class="ident" id="8120868"><a href="/image/png/reader_test.go.html#8120849">y</a></span>&nbsp;<span class="op" id="8120870">&lt;</span>&nbsp;<span class="ident" id="8120872"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8120878">.</span><span class="ident" id="8120879">Max</span><span class="op" id="8120882">.</span><span class="ident" id="8120883">Y</span><span class="op" id="8120884">;</span>&nbsp;<span class="ident" id="8120886"><a href="/image/png/reader_test.go.html#8120849">y</a></span><span class="op" id="8120887">++</span>&nbsp;<span class="op" id="8120890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120894">switch</span>&nbsp;<span class="op" id="8120901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120905">case</span>&nbsp;<span class="ident" id="8120910"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8120913">==</span>&nbsp;<span class="ident" id="8120916"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8120921">.</span><span class="ident" id="8120922">GrayModel</span><span class="op" id="8120931">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8120936">for</span>&nbsp;<span class="ident" id="8120940">x</span>&nbsp;<span class="op" id="8120942">:=</span>&nbsp;<span class="ident" id="8120945"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8120951">.</span><span class="ident" id="8120952">Min</span><span class="op" id="8120955">.</span><span class="ident" id="8120956">X</span><span class="op" id="8120957">;</span>&nbsp;<span class="ident" id="8120959"><a href="/image/png/reader_test.go.html#8120940">x</a></span>&nbsp;<span class="op" id="8120961">&lt;</span>&nbsp;<span class="ident" id="8120963"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8120969">.</span><span class="ident" id="8120970">Max</span><span class="op" id="8120973">.</span><span class="ident" id="8120974">X</span><span class="op" id="8120975">;</span>&nbsp;<span class="ident" id="8120977"><a href="/image/png/reader_test.go.html#8120940">x</a></span><span class="op" id="8120978">++</span>&nbsp;<span class="op" id="8120981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8120987">gray</span>&nbsp;<span class="op" id="8120992">:=</span>&nbsp;<span class="ident" id="8120995"><a href="/image/png/reader_test.go.html#8118652">png</a></span><span class="op" id="8120998">.</span><span class="ident" id="8120999">At</span><span class="op" id="8121001">(</span><span class="ident" id="8121002"><a href="/image/png/reader_test.go.html#8120940">x</a></span><span class="op" id="8121003">,</span>&nbsp;<span class="ident" id="8121005"><a href="/image/png/reader_test.go.html#8120849">y</a></span><span class="op" id="8121006">)</span><span class="op" id="8121007">.</span><span class="op" id="8121008">(</span><span class="ident" id="8121009"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8121014">.</span><span class="ident" id="8121015">Gray</span><span class="op" id="8121019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121025"><a href="/image/png/reader_test.go.html#8117830">fmt</a></span><span class="op" id="8121028">.</span><span class="ident" id="8121029">Fprintf</span><span class="op" id="8121036">(</span><span class="ident" id="8121037"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8121038">,</span>&nbsp;<span class="string" id="8121040">&#34;%02x&#34;</span><span class="op" id="8121046">,</span>&nbsp;<span class="ident" id="8121048"><a href="/image/png/reader_test.go.html#8120987">gray</a></span><span class="op" id="8121052">.</span><span class="ident" id="8121053">Y</span><span class="op" id="8121054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8121059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121063">case</span>&nbsp;<span class="ident" id="8121068"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8121071">==</span>&nbsp;<span class="ident" id="8121074"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8121079">.</span><span class="ident" id="8121080">Gray16Model</span><span class="op" id="8121091">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121096">for</span>&nbsp;<span class="ident" id="8121100">x</span>&nbsp;<span class="op" id="8121102">:=</span>&nbsp;<span class="ident" id="8121105"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8121111">.</span><span class="ident" id="8121112">Min</span><span class="op" id="8121115">.</span><span class="ident" id="8121116">X</span><span class="op" id="8121117">;</span>&nbsp;<span class="ident" id="8121119"><a href="/image/png/reader_test.go.html#8121100">x</a></span>&nbsp;<span class="op" id="8121121">&lt;</span>&nbsp;<span class="ident" id="8121123"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8121129">.</span><span class="ident" id="8121130">Max</span><span class="op" id="8121133">.</span><span class="ident" id="8121134">X</span><span class="op" id="8121135">;</span>&nbsp;<span class="ident" id="8121137"><a href="/image/png/reader_test.go.html#8121100">x</a></span><span class="op" id="8121138">++</span>&nbsp;<span class="op" id="8121141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121147">gray16</span>&nbsp;<span class="op" id="8121154">:=</span>&nbsp;<span class="ident" id="8121157"><a href="/image/png/reader_test.go.html#8118652">png</a></span><span class="op" id="8121160">.</span><span class="ident" id="8121161">At</span><span class="op" id="8121163">(</span><span class="ident" id="8121164"><a href="/image/png/reader_test.go.html#8121100">x</a></span><span class="op" id="8121165">,</span>&nbsp;<span class="ident" id="8121167"><a href="/image/png/reader_test.go.html#8120849">y</a></span><span class="op" id="8121168">)</span><span class="op" id="8121169">.</span><span class="op" id="8121170">(</span><span class="ident" id="8121171"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8121176">.</span><span class="ident" id="8121177">Gray16</span><span class="op" id="8121183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121189"><a href="/image/png/reader_test.go.html#8117830">fmt</a></span><span class="op" id="8121192">.</span><span class="ident" id="8121193">Fprintf</span><span class="op" id="8121200">(</span><span class="ident" id="8121201"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8121202">,</span>&nbsp;<span class="string" id="8121204">&#34;%04x&nbsp;&#34;</span><span class="op" id="8121211">,</span>&nbsp;<span class="ident" id="8121213"><a href="/image/png/reader_test.go.html#8121147">gray16</a></span><span class="op" id="8121219">.</span><span class="ident" id="8121220">Y</span><span class="op" id="8121221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8121226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121230">case</span>&nbsp;<span class="ident" id="8121235"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8121238">==</span>&nbsp;<span class="ident" id="8121241"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8121246">.</span><span class="ident" id="8121247">RGBAModel</span><span class="op" id="8121256">:</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121261">for</span>&nbsp;<span class="ident" id="8121265">x</span>&nbsp;<span class="op" id="8121267">:=</span>&nbsp;<span class="ident" id="8121270"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8121276">.</span><span class="ident" id="8121277">Min</span><span class="op" id="8121280">.</span><span class="ident" id="8121281">X</span><span class="op" id="8121282">;</span>&nbsp;<span class="ident" id="8121284"><a href="/image/png/reader_test.go.html#8121265">x</a></span>&nbsp;<span class="op" id="8121286">&lt;</span>&nbsp;<span class="ident" id="8121288"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8121294">.</span><span class="ident" id="8121295">Max</span><span class="op" id="8121298">.</span><span class="ident" id="8121299">X</span><span class="op" id="8121300">;</span>&nbsp;<span class="ident" id="8121302"><a href="/image/png/reader_test.go.html#8121265">x</a></span><span class="op" id="8121303">++</span>&nbsp;<span class="op" id="8121306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121312">rgba</span>&nbsp;<span class="op" id="8121317">:=</span>&nbsp;<span class="ident" id="8121320"><a href="/image/png/reader_test.go.html#8118652">png</a></span><span class="op" id="8121323">.</span><span class="ident" id="8121324">At</span><span class="op" id="8121326">(</span><span class="ident" id="8121327"><a href="/image/png/reader_test.go.html#8121265">x</a></span><span class="op" id="8121328">,</span>&nbsp;<span class="ident" id="8121330"><a href="/image/png/reader_test.go.html#8120849">y</a></span><span class="op" id="8121331">)</span><span class="op" id="8121332">.</span><span class="op" id="8121333">(</span><span class="ident" id="8121334"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8121339">.</span><span class="ident" id="8121340">RGBA</span><span class="op" id="8121344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121350"><a href="/image/png/reader_test.go.html#8117830">fmt</a></span><span class="op" id="8121353">.</span><span class="ident" id="8121354">Fprintf</span><span class="op" id="8121361">(</span><span class="ident" id="8121362"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8121363">,</span>&nbsp;<span class="string" id="8121365">&#34;%02x%02x%02x&nbsp;&#34;</span><span class="op" id="8121380">,</span>&nbsp;<span class="ident" id="8121382"><a href="/image/png/reader_test.go.html#8121312">rgba</a></span><span class="op" id="8121386">.</span><span class="ident" id="8121387">R</span><span class="op" id="8121388">,</span>&nbsp;<span class="ident" id="8121390"><a href="/image/png/reader_test.go.html#8121312">rgba</a></span><span class="op" id="8121394">.</span><span class="ident" id="8121395">G</span><span class="op" id="8121396">,</span>&nbsp;<span class="ident" id="8121398"><a href="/image/png/reader_test.go.html#8121312">rgba</a></span><span class="op" id="8121402">.</span><span class="ident" id="8121403">B</span><span class="op" id="8121404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8121409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121413">case</span>&nbsp;<span class="ident" id="8121418"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8121421">==</span>&nbsp;<span class="ident" id="8121424"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8121429">.</span><span class="ident" id="8121430">RGBA64Model</span><span class="op" id="8121441">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121446">for</span>&nbsp;<span class="ident" id="8121450">x</span>&nbsp;<span class="op" id="8121452">:=</span>&nbsp;<span class="ident" id="8121455"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8121461">.</span><span class="ident" id="8121462">Min</span><span class="op" id="8121465">.</span><span class="ident" id="8121466">X</span><span class="op" id="8121467">;</span>&nbsp;<span class="ident" id="8121469"><a href="/image/png/reader_test.go.html#8121450">x</a></span>&nbsp;<span class="op" id="8121471">&lt;</span>&nbsp;<span class="ident" id="8121473"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8121479">.</span><span class="ident" id="8121480">Max</span><span class="op" id="8121483">.</span><span class="ident" id="8121484">X</span><span class="op" id="8121485">;</span>&nbsp;<span class="ident" id="8121487"><a href="/image/png/reader_test.go.html#8121450">x</a></span><span class="op" id="8121488">++</span>&nbsp;<span class="op" id="8121491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121497">rgba64</span>&nbsp;<span class="op" id="8121504">:=</span>&nbsp;<span class="ident" id="8121507"><a href="/image/png/reader_test.go.html#8118652">png</a></span><span class="op" id="8121510">.</span><span class="ident" id="8121511">At</span><span class="op" id="8121513">(</span><span class="ident" id="8121514"><a href="/image/png/reader_test.go.html#8121450">x</a></span><span class="op" id="8121515">,</span>&nbsp;<span class="ident" id="8121517"><a href="/image/png/reader_test.go.html#8120849">y</a></span><span class="op" id="8121518">)</span><span class="op" id="8121519">.</span><span class="op" id="8121520">(</span><span class="ident" id="8121521"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8121526">.</span><span class="ident" id="8121527">RGBA64</span><span class="op" id="8121533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121539"><a href="/image/png/reader_test.go.html#8117830">fmt</a></span><span class="op" id="8121542">.</span><span class="ident" id="8121543">Fprintf</span><span class="op" id="8121550">(</span><span class="ident" id="8121551"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8121552">,</span>&nbsp;<span class="string" id="8121554">&#34;%04x%04x%04x&nbsp;&#34;</span><span class="op" id="8121569">,</span>&nbsp;<span class="ident" id="8121571"><a href="/image/png/reader_test.go.html#8121497">rgba64</a></span><span class="op" id="8121577">.</span><span class="ident" id="8121578">R</span><span class="op" id="8121579">,</span>&nbsp;<span class="ident" id="8121581"><a href="/image/png/reader_test.go.html#8121497">rgba64</a></span><span class="op" id="8121587">.</span><span class="ident" id="8121588">G</span><span class="op" id="8121589">,</span>&nbsp;<span class="ident" id="8121591"><a href="/image/png/reader_test.go.html#8121497">rgba64</a></span><span class="op" id="8121597">.</span><span class="ident" id="8121598">B</span><span class="op" id="8121599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8121604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121608">case</span>&nbsp;<span class="ident" id="8121613"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8121616">==</span>&nbsp;<span class="ident" id="8121619"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8121624">.</span><span class="ident" id="8121625">NRGBAModel</span><span class="op" id="8121635">:</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121640">for</span>&nbsp;<span class="ident" id="8121644">x</span>&nbsp;<span class="op" id="8121646">:=</span>&nbsp;<span class="ident" id="8121649"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8121655">.</span><span class="ident" id="8121656">Min</span><span class="op" id="8121659">.</span><span class="ident" id="8121660">X</span><span class="op" id="8121661">;</span>&nbsp;<span class="ident" id="8121663"><a href="/image/png/reader_test.go.html#8121644">x</a></span>&nbsp;<span class="op" id="8121665">&lt;</span>&nbsp;<span class="ident" id="8121667"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8121673">.</span><span class="ident" id="8121674">Max</span><span class="op" id="8121677">.</span><span class="ident" id="8121678">X</span><span class="op" id="8121679">;</span>&nbsp;<span class="ident" id="8121681"><a href="/image/png/reader_test.go.html#8121644">x</a></span><span class="op" id="8121682">++</span>&nbsp;<span class="op" id="8121685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121691">nrgba</span>&nbsp;<span class="op" id="8121697">:=</span>&nbsp;<span class="ident" id="8121700"><a href="/image/png/reader_test.go.html#8118652">png</a></span><span class="op" id="8121703">.</span><span class="ident" id="8121704">At</span><span class="op" id="8121706">(</span><span class="ident" id="8121707"><a href="/image/png/reader_test.go.html#8121644">x</a></span><span class="op" id="8121708">,</span>&nbsp;<span class="ident" id="8121710"><a href="/image/png/reader_test.go.html#8120849">y</a></span><span class="op" id="8121711">)</span><span class="op" id="8121712">.</span><span class="op" id="8121713">(</span><span class="ident" id="8121714"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8121719">.</span><span class="ident" id="8121720">NRGBA</span><span class="op" id="8121725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121731"><a href="/image/png/reader_test.go.html#8117830">fmt</a></span><span class="op" id="8121734">.</span><span class="ident" id="8121735">Fprintf</span><span class="op" id="8121742">(</span><span class="ident" id="8121743"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8121744">,</span>&nbsp;<span class="string" id="8121746">&#34;%02x%02x%02x%02x&nbsp;&#34;</span><span class="op" id="8121765">,</span>&nbsp;<span class="ident" id="8121767"><a href="/image/png/reader_test.go.html#8121691">nrgba</a></span><span class="op" id="8121772">.</span><span class="ident" id="8121773">R</span><span class="op" id="8121774">,</span>&nbsp;<span class="ident" id="8121776"><a href="/image/png/reader_test.go.html#8121691">nrgba</a></span><span class="op" id="8121781">.</span><span class="ident" id="8121782">G</span><span class="op" id="8121783">,</span>&nbsp;<span class="ident" id="8121785"><a href="/image/png/reader_test.go.html#8121691">nrgba</a></span><span class="op" id="8121790">.</span><span class="ident" id="8121791">B</span><span class="op" id="8121792">,</span>&nbsp;<span class="ident" id="8121794"><a href="/image/png/reader_test.go.html#8121691">nrgba</a></span><span class="op" id="8121799">.</span><span class="ident" id="8121800">A</span><span class="op" id="8121801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8121806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121810">case</span>&nbsp;<span class="ident" id="8121815"><a href="/image/png/reader_test.go.html#8118713">cm</a></span>&nbsp;<span class="op" id="8121818">==</span>&nbsp;<span class="ident" id="8121821"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8121826">.</span><span class="ident" id="8121827">NRGBA64Model</span><span class="op" id="8121839">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8121844">for</span>&nbsp;<span class="ident" id="8121848">x</span>&nbsp;<span class="op" id="8121850">:=</span>&nbsp;<span class="ident" id="8121853"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8121859">.</span><span class="ident" id="8121860">Min</span><span class="op" id="8121863">.</span><span class="ident" id="8121864">X</span><span class="op" id="8121865">;</span>&nbsp;<span class="ident" id="8121867"><a href="/image/png/reader_test.go.html#8121848">x</a></span>&nbsp;<span class="op" id="8121869">&lt;</span>&nbsp;<span class="ident" id="8121871"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8121877">.</span><span class="ident" id="8121878">Max</span><span class="op" id="8121881">.</span><span class="ident" id="8121882">X</span><span class="op" id="8121883">;</span>&nbsp;<span class="ident" id="8121885"><a href="/image/png/reader_test.go.html#8121848">x</a></span><span class="op" id="8121886">++</span>&nbsp;<span class="op" id="8121889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121895">nrgba64</span>&nbsp;<span class="op" id="8121903">:=</span>&nbsp;<span class="ident" id="8121906"><a href="/image/png/reader_test.go.html#8118652">png</a></span><span class="op" id="8121909">.</span><span class="ident" id="8121910">At</span><span class="op" id="8121912">(</span><span class="ident" id="8121913"><a href="/image/png/reader_test.go.html#8121848">x</a></span><span class="op" id="8121914">,</span>&nbsp;<span class="ident" id="8121916"><a href="/image/png/reader_test.go.html#8120849">y</a></span><span class="op" id="8121917">)</span><span class="op" id="8121918">.</span><span class="op" id="8121919">(</span><span class="ident" id="8121920"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8121925">.</span><span class="ident" id="8121926">NRGBA64</span><span class="op" id="8121933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8121939"><a href="/image/png/reader_test.go.html#8117830">fmt</a></span><span class="op" id="8121942">.</span><span class="ident" id="8121943">Fprintf</span><span class="op" id="8121950">(</span><span class="ident" id="8121951"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8121952">,</span>&nbsp;<span class="string" id="8121954">&#34;%04x%04x%04x%04x&nbsp;&#34;</span><span class="op" id="8121973">,</span>&nbsp;<span class="ident" id="8121975"><a href="/image/png/reader_test.go.html#8121895">nrgba64</a></span><span class="op" id="8121982">.</span><span class="ident" id="8121983">R</span><span class="op" id="8121984">,</span>&nbsp;<span class="ident" id="8121986"><a href="/image/png/reader_test.go.html#8121895">nrgba64</a></span><span class="op" id="8121993">.</span><span class="ident" id="8121994">G</span><span class="op" id="8121995">,</span>&nbsp;<span class="ident" id="8121997"><a href="/image/png/reader_test.go.html#8121895">nrgba64</a></span><span class="op" id="8122004">.</span><span class="ident" id="8122005">B</span><span class="op" id="8122006">,</span>&nbsp;<span class="ident" id="8122008"><a href="/image/png/reader_test.go.html#8121895">nrgba64</a></span><span class="op" id="8122015">.</span><span class="ident" id="8122016">A</span><span class="op" id="8122017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122026">case</span>&nbsp;<span class="ident" id="8122031"><a href="/image/png/reader_test.go.html#8118888">cpm</a></span>&nbsp;<span class="op" id="8122035">!=</span>&nbsp;<span class="ident" id="8122038">nil</span><span class="op" id="8122041">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122046">var</span>&nbsp;<span class="ident" id="8122050">b</span><span class="op" id="8122051">,</span>&nbsp;<span class="ident" id="8122053">c</span>&nbsp;<span class="builtintype" id="8122055">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122062">for</span>&nbsp;<span class="ident" id="8122066">x</span>&nbsp;<span class="op" id="8122068">:=</span>&nbsp;<span class="ident" id="8122071"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8122077">.</span><span class="ident" id="8122078">Min</span><span class="op" id="8122081">.</span><span class="ident" id="8122082">X</span><span class="op" id="8122083">;</span>&nbsp;<span class="ident" id="8122085"><a href="/image/png/reader_test.go.html#8122066">x</a></span>&nbsp;<span class="op" id="8122087">&lt;</span>&nbsp;<span class="ident" id="8122089"><a href="/image/png/reader_test.go.html#8118689">bounds</a></span><span class="op" id="8122095">.</span><span class="ident" id="8122096">Max</span><span class="op" id="8122099">.</span><span class="ident" id="8122100">X</span><span class="op" id="8122101">;</span>&nbsp;<span class="ident" id="8122103"><a href="/image/png/reader_test.go.html#8122066">x</a></span><span class="op" id="8122104">++</span>&nbsp;<span class="op" id="8122107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122113"><a href="/image/png/reader_test.go.html#8122050">b</a></span>&nbsp;<span class="op" id="8122115">=</span>&nbsp;<span class="ident" id="8122117"><a href="/image/png/reader_test.go.html#8122050">b</a></span><span class="op" id="8122118">&lt;&lt;</span><span class="builtintype" id="8122120">uint</span><span class="op" id="8122124">(</span><span class="ident" id="8122125"><a href="/image/png/reader_test.go.html#8118741">bitdepth</a></span><span class="op" id="8122133">)</span>&nbsp;<span class="op" id="8122135">|</span>&nbsp;<span class="builtintype" id="8122137">int</span><span class="op" id="8122140">(</span><span class="ident" id="8122141"><a href="/image/png/reader_test.go.html#8118922">paletted</a></span><span class="op" id="8122149">.</span><span class="ident" id="8122150">ColorIndexAt</span><span class="op" id="8122162">(</span><span class="ident" id="8122163"><a href="/image/png/reader_test.go.html#8122066">x</a></span><span class="op" id="8122164">,</span>&nbsp;<span class="ident" id="8122166"><a href="/image/png/reader_test.go.html#8120849">y</a></span><span class="op" id="8122167">)</span><span class="op" id="8122168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122174"><a href="/image/png/reader_test.go.html#8122053">c</a></span><span class="op" id="8122175">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122182">if</span>&nbsp;<span class="ident" id="8122185"><a href="/image/png/reader_test.go.html#8122053">c</a></span>&nbsp;<span class="op" id="8122187">==</span>&nbsp;<span class="num" id="8122190">8</span><span class="op" id="8122191">/</span><span class="ident" id="8122192"><a href="/image/png/reader_test.go.html#8118741">bitdepth</a></span>&nbsp;<span class="op" id="8122201">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122208"><a href="/image/png/reader_test.go.html#8117830">fmt</a></span><span class="op" id="8122211">.</span><span class="ident" id="8122212">Fprintf</span><span class="op" id="8122219">(</span><span class="ident" id="8122220"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8122221">,</span>&nbsp;<span class="string" id="8122223">&#34;%02x&#34;</span><span class="op" id="8122229">,</span>&nbsp;<span class="ident" id="8122231"><a href="/image/png/reader_test.go.html#8122050">b</a></span><span class="op" id="8122232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122239"><a href="/image/png/reader_test.go.html#8122050">b</a></span>&nbsp;<span class="op" id="8122241">=</span>&nbsp;<span class="num" id="8122243">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122250"><a href="/image/png/reader_test.go.html#8122053">c</a></span>&nbsp;<span class="op" id="8122252">=</span>&nbsp;<span class="num" id="8122254">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122265">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122270">if</span>&nbsp;<span class="ident" id="8122273"><a href="/image/png/reader_test.go.html#8122053">c</a></span>&nbsp;<span class="op" id="8122275">!=</span>&nbsp;<span class="num" id="8122278">0</span>&nbsp;<span class="op" id="8122280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122286">for</span>&nbsp;<span class="ident" id="8122290"><a href="/image/png/reader_test.go.html#8122053">c</a></span>&nbsp;<span class="op" id="8122292">!=</span>&nbsp;<span class="num" id="8122295">8</span><span class="op" id="8122296">/</span><span class="ident" id="8122297"><a href="/image/png/reader_test.go.html#8118741">bitdepth</a></span>&nbsp;<span class="op" id="8122306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122313"><a href="/image/png/reader_test.go.html#8122050">b</a></span>&nbsp;<span class="op" id="8122315">=</span>&nbsp;<span class="ident" id="8122317"><a href="/image/png/reader_test.go.html#8122050">b</a></span>&nbsp;<span class="op" id="8122319">&lt;&lt;</span>&nbsp;<span class="builtintype" id="8122322">uint</span><span class="op" id="8122326">(</span><span class="ident" id="8122327"><a href="/image/png/reader_test.go.html#8118741">bitdepth</a></span><span class="op" id="8122335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122342"><a href="/image/png/reader_test.go.html#8122053">c</a></span><span class="op" id="8122343">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122350">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122356"><a href="/image/png/reader_test.go.html#8117830">fmt</a></span><span class="op" id="8122359">.</span><span class="ident" id="8122360">Fprintf</span><span class="op" id="8122367">(</span><span class="ident" id="8122368"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8122369">,</span>&nbsp;<span class="string" id="8122371">&#34;%02x&#34;</span><span class="op" id="8122377">,</span>&nbsp;<span class="ident" id="8122379"><a href="/image/png/reader_test.go.html#8122050">b</a></span><span class="op" id="8122380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122393"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8122395">.</span><span class="ident" id="8122396">WriteString</span><span class="op" id="8122407">(</span><span class="ident" id="8122408"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8122409">,</span>&nbsp;<span class="string" id="8122411">&#34;\n&#34;</span><span class="op" id="8122415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122418">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122421"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8122423">.</span><span class="ident" id="8122424">WriteString</span><span class="op" id="8122435">(</span><span class="ident" id="8122436"><a href="/image/png/reader_test.go.html#8118617">w</a></span><span class="op" id="8122437">,</span>&nbsp;<span class="string" id="8122439">&#34;}\n&#34;</span><span class="op" id="8122444">)</span><br>
<span class="lineno"></span><span class="op" id="8122446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8122449">func</span>&nbsp;<span class="ident" id="8122454">TestReader</span><span class="op" id="8122464">(</span><span class="ident" id="8122465">t</span>&nbsp;<span class="op" id="8122467">*</span><span class="ident" id="8122468"><a href="/image/png/reader_test.go.html#8117897">testing</a></span><span class="op" id="8122475">.</span><span class="ident" id="8122476">T</span><span class="op" id="8122477">)</span>&nbsp;<span class="op" id="8122479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122482">names</span>&nbsp;<span class="op" id="8122488">:=</span>&nbsp;<span class="ident" id="8122491"><a href="/image/png/reader_test.go.html#8117914">filenames</a></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122502">if</span>&nbsp;<span class="ident" id="8122505"><a href="/image/png/reader_test.go.html#8117897">testing</a></span><span class="op" id="8122512">.</span><span class="ident" id="8122513">Short</span><span class="op" id="8122518">(</span><span class="op" id="8122519">)</span>&nbsp;<span class="op" id="8122521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122525"><a href="/image/png/reader_test.go.html#8122482">names</a></span>&nbsp;<span class="op" id="8122531">=</span>&nbsp;<span class="ident" id="8122533"><a href="/image/png/reader_test.go.html#8118328">filenamesShort</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122552">for</span>&nbsp;<span class="ident" id="8122556">_</span><span class="op" id="8122557">,</span>&nbsp;<span class="ident" id="8122559">fn</span>&nbsp;<span class="op" id="8122562">:=</span>&nbsp;<span class="keyword" id="8122565">range</span>&nbsp;<span class="ident" id="8122571"><a href="/image/png/reader_test.go.html#8122482">names</a></span>&nbsp;<span class="op" id="8122577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8122581">//&nbsp;Read&nbsp;the&nbsp;.png&nbsp;file.</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122606">img</span><span class="op" id="8122609">,</span>&nbsp;<span class="ident" id="8122611">err</span>&nbsp;<span class="op" id="8122615">:=</span>&nbsp;<span class="ident" id="8122618"><a href="/image/png/reader_test.go.html#8118405">readPNG</a></span><span class="op" id="8122625">(</span><span class="string" id="8122626">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="8122647">+</span>&nbsp;<span class="ident" id="8122649"><a href="/image/png/reader_test.go.html#8122559">fn</a></span>&nbsp;<span class="op" id="8122652">+</span>&nbsp;<span class="string" id="8122654">&#34;.png&#34;</span><span class="op" id="8122660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122664">if</span>&nbsp;<span class="ident" id="8122667"><a href="/image/png/reader_test.go.html#8122611">err</a></span>&nbsp;<span class="op" id="8122671">!=</span>&nbsp;<span class="ident" id="8122674">nil</span>&nbsp;<span class="op" id="8122678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122683"><a href="/image/png/reader_test.go.html#8122465">t</a></span><span class="op" id="8122684">.</span><span class="ident" id="8122685">Error</span><span class="op" id="8122690">(</span><span class="ident" id="8122691"><a href="/image/png/reader_test.go.html#8122559">fn</a></span><span class="op" id="8122693">,</span>&nbsp;<span class="ident" id="8122695"><a href="/image/png/reader_test.go.html#8122611">err</a></span><span class="op" id="8122698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122703">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8122714">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122719">if</span>&nbsp;<span class="ident" id="8122722"><a href="/image/png/reader_test.go.html#8122559">fn</a></span>&nbsp;<span class="op" id="8122725">==</span>&nbsp;<span class="string" id="8122728">&#34;basn4a16&#34;</span>&nbsp;<span class="op" id="8122739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8122744">//&nbsp;basn4a16.sng&nbsp;is&nbsp;gray&nbsp;+&nbsp;alpha&nbsp;but&nbsp;sng()&nbsp;will&nbsp;produce&nbsp;true&nbsp;color&nbsp;+&nbsp;alpha</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8122821">//&nbsp;so&nbsp;we&nbsp;just&nbsp;check&nbsp;a&nbsp;single&nbsp;random&nbsp;pixel.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122867">c</span>&nbsp;<span class="op" id="8122869">:=</span>&nbsp;<span class="ident" id="8122872"><a href="/image/png/reader_test.go.html#8122606">img</a></span><span class="op" id="8122875">.</span><span class="ident" id="8122876">At</span><span class="op" id="8122878">(</span><span class="num" id="8122879">2</span><span class="op" id="8122880">,</span>&nbsp;<span class="num" id="8122882">1</span><span class="op" id="8122883">)</span><span class="op" id="8122884">.</span><span class="op" id="8122885">(</span><span class="ident" id="8122886"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8122891">.</span><span class="ident" id="8122892">NRGBA64</span><span class="op" id="8122899">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8122904">if</span>&nbsp;<span class="ident" id="8122907"><a href="/image/png/reader_test.go.html#8122867">c</a></span><span class="op" id="8122908">.</span><span class="ident" id="8122909">R</span>&nbsp;<span class="op" id="8122911">!=</span>&nbsp;<span class="num" id="8122914">0x11a7</span>&nbsp;<span class="op" id="8122921">||</span>&nbsp;<span class="ident" id="8122924"><a href="/image/png/reader_test.go.html#8122867">c</a></span><span class="op" id="8122925">.</span><span class="ident" id="8122926">G</span>&nbsp;<span class="op" id="8122928">!=</span>&nbsp;<span class="num" id="8122931">0x11a7</span>&nbsp;<span class="op" id="8122938">||</span>&nbsp;<span class="ident" id="8122941"><a href="/image/png/reader_test.go.html#8122867">c</a></span><span class="op" id="8122942">.</span><span class="ident" id="8122943">B</span>&nbsp;<span class="op" id="8122945">!=</span>&nbsp;<span class="num" id="8122948">0x11a7</span>&nbsp;<span class="op" id="8122955">||</span>&nbsp;<span class="ident" id="8122958"><a href="/image/png/reader_test.go.html#8122867">c</a></span><span class="op" id="8122959">.</span><span class="ident" id="8122960">A</span>&nbsp;<span class="op" id="8122962">!=</span>&nbsp;<span class="num" id="8122965">0x1085</span>&nbsp;<span class="op" id="8122972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8122978"><a href="/image/png/reader_test.go.html#8122465">t</a></span><span class="op" id="8122979">.</span><span class="ident" id="8122980">Error</span><span class="op" id="8122985">(</span><span class="ident" id="8122986"><a href="/image/png/reader_test.go.html#8122559">fn</a></span><span class="op" id="8122988">,</span>&nbsp;<span class="ident" id="8122990"><a href="/image/png/reader_test.go.html#8117830">fmt</a></span><span class="op" id="8122993">.</span><span class="ident" id="8122994">Errorf</span><span class="op" id="8123000">(</span><span class="string" id="8123001">&#34;wrong&nbsp;pixel&nbsp;value&nbsp;at&nbsp;(2,&nbsp;1):&nbsp;%x&#34;</span><span class="op" id="8123034">,</span>&nbsp;<span class="ident" id="8123036"><a href="/image/png/reader_test.go.html#8122867">c</a></span><span class="op" id="8123037">)</span><span class="op" id="8123038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123048">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123059">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123064">piper</span><span class="op" id="8123069">,</span>&nbsp;<span class="ident" id="8123071">pipew</span>&nbsp;<span class="op" id="8123077">:=</span>&nbsp;<span class="ident" id="8123080"><a href="/image/png/reader_test.go.html#8117861">io</a></span><span class="op" id="8123082">.</span><span class="ident" id="8123083">Pipe</span><span class="op" id="8123087">(</span><span class="op" id="8123088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123092">pb</span>&nbsp;<span class="op" id="8123095">:=</span>&nbsp;<span class="ident" id="8123098"><a href="/image/png/reader_test.go.html#8117821">bufio</a></span><span class="op" id="8123103">.</span><span class="ident" id="8123104">NewScanner</span><span class="op" id="8123114">(</span><span class="ident" id="8123115"><a href="/image/png/reader_test.go.html#8123064">piper</a></span><span class="op" id="8123120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123124">go</span>&nbsp;<span class="ident" id="8123127"><a href="/image/png/reader_test.go.html#8118613">sng</a></span><span class="op" id="8123130">(</span><span class="ident" id="8123131"><a href="/image/png/reader_test.go.html#8123071">pipew</a></span><span class="op" id="8123136">,</span>&nbsp;<span class="ident" id="8123138"><a href="/image/png/reader_test.go.html#8122559">fn</a></span><span class="op" id="8123140">,</span>&nbsp;<span class="ident" id="8123142"><a href="/image/png/reader_test.go.html#8122606">img</a></span><span class="op" id="8123145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123149">defer</span>&nbsp;<span class="ident" id="8123155"><a href="/image/png/reader_test.go.html#8123064">piper</a></span><span class="op" id="8123160">.</span><span class="ident" id="8123161">Close</span><span class="op" id="8123166">(</span><span class="op" id="8123167">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8123172">//&nbsp;Read&nbsp;the&nbsp;.sng&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123197">sf</span><span class="op" id="8123199">,</span>&nbsp;<span class="ident" id="8123201"><a href="/image/png/reader_test.go.html#8122611">err</a></span>&nbsp;<span class="op" id="8123205">:=</span>&nbsp;<span class="ident" id="8123208"><a href="/image/png/reader_test.go.html#8117880">os</a></span><span class="op" id="8123210">.</span><span class="ident" id="8123211">Open</span><span class="op" id="8123215">(</span><span class="string" id="8123216">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="8123237">+</span>&nbsp;<span class="ident" id="8123239"><a href="/image/png/reader_test.go.html#8122559">fn</a></span>&nbsp;<span class="op" id="8123242">+</span>&nbsp;<span class="string" id="8123244">&#34;.sng&#34;</span><span class="op" id="8123250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123254">if</span>&nbsp;<span class="ident" id="8123257"><a href="/image/png/reader_test.go.html#8122611">err</a></span>&nbsp;<span class="op" id="8123261">!=</span>&nbsp;<span class="ident" id="8123264">nil</span>&nbsp;<span class="op" id="8123268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123273"><a href="/image/png/reader_test.go.html#8122465">t</a></span><span class="op" id="8123274">.</span><span class="ident" id="8123275">Error</span><span class="op" id="8123280">(</span><span class="ident" id="8123281"><a href="/image/png/reader_test.go.html#8122559">fn</a></span><span class="op" id="8123283">,</span>&nbsp;<span class="ident" id="8123285"><a href="/image/png/reader_test.go.html#8122611">err</a></span><span class="op" id="8123288">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123293">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123308">defer</span>&nbsp;<span class="ident" id="8123314"><a href="/image/png/reader_test.go.html#8123197">sf</a></span><span class="op" id="8123316">.</span><span class="ident" id="8123317">Close</span><span class="op" id="8123322">(</span><span class="op" id="8123323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123327">sb</span>&nbsp;<span class="op" id="8123330">:=</span>&nbsp;<span class="ident" id="8123333"><a href="/image/png/reader_test.go.html#8117821">bufio</a></span><span class="op" id="8123338">.</span><span class="ident" id="8123339">NewScanner</span><span class="op" id="8123349">(</span><span class="ident" id="8123350"><a href="/image/png/reader_test.go.html#8123197">sf</a></span><span class="op" id="8123352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123356">if</span>&nbsp;<span class="ident" id="8123359"><a href="/image/png/reader_test.go.html#8122611">err</a></span>&nbsp;<span class="op" id="8123363">!=</span>&nbsp;<span class="ident" id="8123366">nil</span>&nbsp;<span class="op" id="8123370">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123375"><a href="/image/png/reader_test.go.html#8122465">t</a></span><span class="op" id="8123376">.</span><span class="ident" id="8123377">Error</span><span class="op" id="8123382">(</span><span class="ident" id="8123383"><a href="/image/png/reader_test.go.html#8122559">fn</a></span><span class="op" id="8123385">,</span>&nbsp;<span class="ident" id="8123387"><a href="/image/png/reader_test.go.html#8122611">err</a></span><span class="op" id="8123390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123395">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8123411">//&nbsp;Compare&nbsp;the&nbsp;two,&nbsp;in&nbsp;SNG&nbsp;format,&nbsp;line&nbsp;by&nbsp;line.</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123462">for</span>&nbsp;<span class="op" id="8123466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123471">pdone</span>&nbsp;<span class="op" id="8123477">:=</span>&nbsp;<span class="op" id="8123480">!</span><span class="ident" id="8123481"><a href="/image/png/reader_test.go.html#8123092">pb</a></span><span class="op" id="8123483">.</span><span class="ident" id="8123484">Scan</span><span class="op" id="8123488">(</span><span class="op" id="8123489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123494">sdone</span>&nbsp;<span class="op" id="8123500">:=</span>&nbsp;<span class="op" id="8123503">!</span><span class="ident" id="8123504"><a href="/image/png/reader_test.go.html#8123327">sb</a></span><span class="op" id="8123506">.</span><span class="ident" id="8123507">Scan</span><span class="op" id="8123511">(</span><span class="op" id="8123512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123517">if</span>&nbsp;<span class="ident" id="8123520"><a href="/image/png/reader_test.go.html#8123471">pdone</a></span>&nbsp;<span class="op" id="8123526">&amp;&amp;</span>&nbsp;<span class="ident" id="8123529"><a href="/image/png/reader_test.go.html#8123494">sdone</a></span>&nbsp;<span class="op" id="8123535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123541">break</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123555">if</span>&nbsp;<span class="ident" id="8123558"><a href="/image/png/reader_test.go.html#8123471">pdone</a></span>&nbsp;<span class="op" id="8123564">||</span>&nbsp;<span class="ident" id="8123567"><a href="/image/png/reader_test.go.html#8123494">sdone</a></span>&nbsp;<span class="op" id="8123573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123579"><a href="/image/png/reader_test.go.html#8122465">t</a></span><span class="op" id="8123580">.</span><span class="ident" id="8123581">Errorf</span><span class="op" id="8123587">(</span><span class="string" id="8123588">&#34;%s:&nbsp;Different&nbsp;sizes&#34;</span><span class="op" id="8123609">,</span>&nbsp;<span class="ident" id="8123611"><a href="/image/png/reader_test.go.html#8122559">fn</a></span><span class="op" id="8123613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123619">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123628">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123633">ps</span>&nbsp;<span class="op" id="8123636">:=</span>&nbsp;<span class="ident" id="8123639"><a href="/image/png/reader_test.go.html#8123092">pb</a></span><span class="op" id="8123641">.</span><span class="ident" id="8123642">Text</span><span class="op" id="8123646">(</span><span class="op" id="8123647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123652">ss</span>&nbsp;<span class="op" id="8123655">:=</span>&nbsp;<span class="ident" id="8123658"><a href="/image/png/reader_test.go.html#8123327">sb</a></span><span class="op" id="8123660">.</span><span class="ident" id="8123661">Text</span><span class="op" id="8123665">(</span><span class="op" id="8123666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123671">if</span>&nbsp;<span class="ident" id="8123674"><a href="/image/png/reader_test.go.html#8123633">ps</a></span>&nbsp;<span class="op" id="8123677">!=</span>&nbsp;<span class="ident" id="8123680"><a href="/image/png/reader_test.go.html#8123652">ss</a></span>&nbsp;<span class="op" id="8123683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123689"><a href="/image/png/reader_test.go.html#8122465">t</a></span><span class="op" id="8123690">.</span><span class="ident" id="8123691">Errorf</span><span class="op" id="8123697">(</span><span class="string" id="8123698">&#34;%s:&nbsp;Mismatch\n%sversus\n%s\n&#34;</span><span class="op" id="8123728">,</span>&nbsp;<span class="ident" id="8123730"><a href="/image/png/reader_test.go.html#8122559">fn</a></span><span class="op" id="8123732">,</span>&nbsp;<span class="ident" id="8123734"><a href="/image/png/reader_test.go.html#8123633">ps</a></span><span class="op" id="8123736">,</span>&nbsp;<span class="ident" id="8123738"><a href="/image/png/reader_test.go.html#8123652">ss</a></span><span class="op" id="8123740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123746">break</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123763">if</span>&nbsp;<span class="ident" id="8123766"><a href="/image/png/reader_test.go.html#8123092">pb</a></span><span class="op" id="8123768">.</span><span class="ident" id="8123769">Err</span><span class="op" id="8123772">(</span><span class="op" id="8123773">)</span>&nbsp;<span class="op" id="8123775">!=</span>&nbsp;<span class="ident" id="8123778">nil</span>&nbsp;<span class="op" id="8123782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123787"><a href="/image/png/reader_test.go.html#8122465">t</a></span><span class="op" id="8123788">.</span><span class="ident" id="8123789">Error</span><span class="op" id="8123794">(</span><span class="ident" id="8123795"><a href="/image/png/reader_test.go.html#8122559">fn</a></span><span class="op" id="8123797">,</span>&nbsp;<span class="ident" id="8123799"><a href="/image/png/reader_test.go.html#8123092">pb</a></span><span class="op" id="8123801">.</span><span class="ident" id="8123802">Err</span><span class="op" id="8123805">(</span><span class="op" id="8123806">)</span><span class="op" id="8123807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123811">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8123815">if</span>&nbsp;<span class="ident" id="8123818"><a href="/image/png/reader_test.go.html#8123327">sb</a></span><span class="op" id="8123820">.</span><span class="ident" id="8123821">Err</span><span class="op" id="8123824">(</span><span class="op" id="8123825">)</span>&nbsp;<span class="op" id="8123827">!=</span>&nbsp;<span class="ident" id="8123830">nil</span>&nbsp;<span class="op" id="8123834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123839"><a href="/image/png/reader_test.go.html#8122465">t</a></span><span class="op" id="8123840">.</span><span class="ident" id="8123841">Error</span><span class="op" id="8123846">(</span><span class="ident" id="8123847"><a href="/image/png/reader_test.go.html#8122559">fn</a></span><span class="op" id="8123849">,</span>&nbsp;<span class="ident" id="8123851"><a href="/image/png/reader_test.go.html#8123327">sb</a></span><span class="op" id="8123853">.</span><span class="ident" id="8123854">Err</span><span class="op" id="8123857">(</span><span class="op" id="8123858">)</span><span class="op" id="8123859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123866">}</span><br>
<span class="lineno"></span><span class="op" id="8123868">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="8123871">var</span>&nbsp;<span class="ident" id="8123875">readerErrors</span>&nbsp;<span class="op" id="8123888">=</span>&nbsp;<span class="op" id="8123890">[</span><span class="op" id="8123891">]</span><span class="keyword" id="8123892">struct</span>&nbsp;<span class="op" id="8123899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123902">file</span>&nbsp;<span class="builtintype" id="8123907">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8123915">err</span>&nbsp;&nbsp;<span class="builtintype" id="8123920">string</span><br>
<span class="lineno"></span><span class="op" id="8123927">}</span><span class="op" id="8123928">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123931">{</span><span class="string" id="8123932">&#34;invalid-zlib.png&#34;</span><span class="op" id="8123950">,</span>&nbsp;<span class="string" id="8123952">&#34;zlib:&nbsp;invalid&nbsp;checksum&#34;</span><span class="op" id="8123976">}</span><span class="op" id="8123977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8123980">{</span><span class="string" id="8123981">&#34;invalid-crc32.png&#34;</span><span class="op" id="8124000">,</span>&nbsp;<span class="string" id="8124002">&#34;invalid&nbsp;checksum&#34;</span><span class="op" id="8124020">}</span><span class="op" id="8124021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8124024">{</span><span class="string" id="8124025">&#34;invalid-noend.png&#34;</span><span class="op" id="8124044">,</span>&nbsp;<span class="string" id="8124046">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="8124062">}</span><span class="op" id="8124063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8124066">{</span><span class="string" id="8124067">&#34;invalid-trunc.png&#34;</span><span class="op" id="8124086">,</span>&nbsp;<span class="string" id="8124088">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="8124104">}</span><span class="op" id="8124105">,</span><br>
<span class="lineno"></span><span class="op" id="8124107">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="8124110">func</span>&nbsp;<span class="ident" id="8124115">TestReaderError</span><span class="op" id="8124130">(</span><span class="ident" id="8124131">t</span>&nbsp;<span class="op" id="8124133">*</span><span class="ident" id="8124134"><a href="/image/png/reader_test.go.html#8117897">testing</a></span><span class="op" id="8124141">.</span><span class="ident" id="8124142">T</span><span class="op" id="8124143">)</span>&nbsp;<span class="op" id="8124145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124148">for</span>&nbsp;<span class="ident" id="8124152">_</span><span class="op" id="8124153">,</span>&nbsp;<span class="ident" id="8124155">tt</span>&nbsp;<span class="op" id="8124158">:=</span>&nbsp;<span class="keyword" id="8124161">range</span>&nbsp;<span class="ident" id="8124167"><a href="/image/png/reader_test.go.html#8123875">readerErrors</a></span>&nbsp;<span class="op" id="8124180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8124184">img</span><span class="op" id="8124187">,</span>&nbsp;<span class="ident" id="8124189">err</span>&nbsp;<span class="op" id="8124193">:=</span>&nbsp;<span class="ident" id="8124196"><a href="/image/png/reader_test.go.html#8118405">readPNG</a></span><span class="op" id="8124203">(</span><span class="string" id="8124204">&#34;testdata/&#34;</span>&nbsp;<span class="op" id="8124216">+</span>&nbsp;<span class="ident" id="8124218"><a href="/image/png/reader_test.go.html#8124155">tt</a></span><span class="op" id="8124220">.</span><span class="ident" id="8124221">file</span><span class="op" id="8124225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124229">if</span>&nbsp;<span class="ident" id="8124232"><a href="/image/png/reader_test.go.html#8124189">err</a></span>&nbsp;<span class="op" id="8124236">==</span>&nbsp;<span class="ident" id="8124239">nil</span>&nbsp;<span class="op" id="8124243">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8124248"><a href="/image/png/reader_test.go.html#8124131">t</a></span><span class="op" id="8124249">.</span><span class="ident" id="8124250">Errorf</span><span class="op" id="8124256">(</span><span class="string" id="8124257">&#34;decoding&nbsp;%s:&nbsp;missing&nbsp;error&#34;</span><span class="op" id="8124285">,</span>&nbsp;<span class="ident" id="8124287"><a href="/image/png/reader_test.go.html#8124155">tt</a></span><span class="op" id="8124289">.</span><span class="ident" id="8124290">file</span><span class="op" id="8124294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124299">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8124310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124314">if</span>&nbsp;<span class="op" id="8124317">!</span><span class="ident" id="8124318"><a href="/image/png/reader_test.go.html#8117886">strings</a></span><span class="op" id="8124325">.</span><span class="ident" id="8124326">Contains</span><span class="op" id="8124334">(</span><span class="ident" id="8124335"><a href="/image/png/reader_test.go.html#8124189">err</a></span><span class="op" id="8124338">.</span><span class="ident" id="8124339">Error</span><span class="op" id="8124344">(</span><span class="op" id="8124345">)</span><span class="op" id="8124346">,</span>&nbsp;<span class="ident" id="8124348"><a href="/image/png/reader_test.go.html#8124155">tt</a></span><span class="op" id="8124350">.</span><span class="ident" id="8124351">err</span><span class="op" id="8124354">)</span>&nbsp;<span class="op" id="8124356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8124361"><a href="/image/png/reader_test.go.html#8124131">t</a></span><span class="op" id="8124362">.</span><span class="ident" id="8124363">Errorf</span><span class="op" id="8124369">(</span><span class="string" id="8124370">&#34;decoding&nbsp;%s:&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8124396">,</span>&nbsp;<span class="ident" id="8124398"><a href="/image/png/reader_test.go.html#8124155">tt</a></span><span class="op" id="8124400">.</span><span class="ident" id="8124401">file</span><span class="op" id="8124405">,</span>&nbsp;<span class="ident" id="8124407"><a href="/image/png/reader_test.go.html#8124189">err</a></span><span class="op" id="8124410">,</span>&nbsp;<span class="ident" id="8124412"><a href="/image/png/reader_test.go.html#8124155">tt</a></span><span class="op" id="8124414">.</span><span class="ident" id="8124415">err</span><span class="op" id="8124418">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8124422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124426">if</span>&nbsp;<span class="ident" id="8124429"><a href="/image/png/reader_test.go.html#8124184">img</a></span>&nbsp;<span class="op" id="8124433">!=</span>&nbsp;<span class="ident" id="8124436">nil</span>&nbsp;<span class="op" id="8124440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8124445"><a href="/image/png/reader_test.go.html#8124131">t</a></span><span class="op" id="8124446">.</span><span class="ident" id="8124447">Errorf</span><span class="op" id="8124453">(</span><span class="string" id="8124454">&#34;decoding&nbsp;%s:&nbsp;have&nbsp;image&nbsp;+&nbsp;error&#34;</span><span class="op" id="8124487">,</span>&nbsp;<span class="ident" id="8124489"><a href="/image/png/reader_test.go.html#8124155">tt</a></span><span class="op" id="8124491">.</span><span class="ident" id="8124492">file</span><span class="op" id="8124496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8124500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8124503">}</span><br>
<span class="lineno">295</span><span class="op" id="8124505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8124508">func</span>&nbsp;<span class="ident" id="8124513">TestPalettedDecodeConfig</span><span class="op" id="8124537">(</span><span class="ident" id="8124538">t</span>&nbsp;<span class="op" id="8124540">*</span><span class="ident" id="8124541"><a href="/image/png/reader_test.go.html#8117897">testing</a></span><span class="op" id="8124548">.</span><span class="ident" id="8124549">T</span><span class="op" id="8124550">)</span>&nbsp;<span class="op" id="8124552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124555">for</span>&nbsp;<span class="ident" id="8124559">_</span><span class="op" id="8124560">,</span>&nbsp;<span class="ident" id="8124562">fn</span>&nbsp;<span class="op" id="8124565">:=</span>&nbsp;<span class="keyword" id="8124568">range</span>&nbsp;<span class="ident" id="8124574"><a href="/image/png/reader_test.go.html#8118221">filenamesPaletted</a></span>&nbsp;<span class="op" id="8124592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8124596">f</span><span class="op" id="8124597">,</span>&nbsp;<span class="ident" id="8124599">err</span>&nbsp;<span class="op" id="8124603">:=</span>&nbsp;<span class="ident" id="8124606"><a href="/image/png/reader_test.go.html#8117880">os</a></span><span class="op" id="8124608">.</span><span class="ident" id="8124609">Open</span><span class="op" id="8124613">(</span><span class="string" id="8124614">&#34;testdata/pngsuite/&#34;</span>&nbsp;<span class="op" id="8124635">+</span>&nbsp;<span class="ident" id="8124637"><a href="/image/png/reader_test.go.html#8124562">fn</a></span>&nbsp;<span class="op" id="8124640">+</span>&nbsp;<span class="string" id="8124642">&#34;.png&#34;</span><span class="op" id="8124648">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124652">if</span>&nbsp;<span class="ident" id="8124655"><a href="/image/png/reader_test.go.html#8124599">err</a></span>&nbsp;<span class="op" id="8124659">!=</span>&nbsp;<span class="ident" id="8124662">nil</span>&nbsp;<span class="op" id="8124666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8124671"><a href="/image/png/reader_test.go.html#8124538">t</a></span><span class="op" id="8124672">.</span><span class="ident" id="8124673">Errorf</span><span class="op" id="8124679">(</span><span class="string" id="8124680">&#34;%s:&nbsp;open&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8124701">,</span>&nbsp;<span class="ident" id="8124703"><a href="/image/png/reader_test.go.html#8124562">fn</a></span><span class="op" id="8124705">,</span>&nbsp;<span class="ident" id="8124707"><a href="/image/png/reader_test.go.html#8124599">err</a></span><span class="op" id="8124710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124715">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8124726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124730">defer</span>&nbsp;<span class="ident" id="8124736"><a href="/image/png/reader_test.go.html#8124596">f</a></span><span class="op" id="8124737">.</span><span class="ident" id="8124738">Close</span><span class="op" id="8124743">(</span><span class="op" id="8124744">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8124748">cfg</span><span class="op" id="8124751">,</span>&nbsp;<span class="ident" id="8124753"><a href="/image/png/reader_test.go.html#8124599">err</a></span>&nbsp;<span class="op" id="8124757">:=</span>&nbsp;<span class="ident" id="8124760"><a href="/image/png/reader.go.html#4880189">DecodeConfig</a></span><span class="op" id="8124772">(</span><span class="ident" id="8124773"><a href="/image/png/reader_test.go.html#8124596">f</a></span><span class="op" id="8124774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124778">if</span>&nbsp;<span class="ident" id="8124781"><a href="/image/png/reader_test.go.html#8124599">err</a></span>&nbsp;<span class="op" id="8124785">!=</span>&nbsp;<span class="ident" id="8124788">nil</span>&nbsp;<span class="op" id="8124792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8124797"><a href="/image/png/reader_test.go.html#8124538">t</a></span><span class="op" id="8124798">.</span><span class="ident" id="8124799">Errorf</span><span class="op" id="8124805">(</span><span class="string" id="8124806">&#34;%s:&nbsp;%v&#34;</span><span class="op" id="8124814">,</span>&nbsp;<span class="ident" id="8124816"><a href="/image/png/reader_test.go.html#8124562">fn</a></span><span class="op" id="8124818">,</span>&nbsp;<span class="ident" id="8124820"><a href="/image/png/reader_test.go.html#8124599">err</a></span><span class="op" id="8124823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124828">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8124839">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8124843">pal</span><span class="op" id="8124846">,</span>&nbsp;<span class="ident" id="8124848">ok</span>&nbsp;<span class="op" id="8124851">:=</span>&nbsp;<span class="ident" id="8124854"><a href="/image/png/reader_test.go.html#8124748">cfg</a></span><span class="op" id="8124857">.</span><span class="ident" id="8124858">ColorModel</span><span class="op" id="8124868">.</span><span class="op" id="8124869">(</span><span class="ident" id="8124870"><a href="/image/png/reader_test.go.html#8117846">color</a></span><span class="op" id="8124875">.</span><span class="ident" id="8124876">Palette</span><span class="op" id="8124883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124887">if</span>&nbsp;<span class="op" id="8124890">!</span><span class="ident" id="8124891"><a href="/image/png/reader_test.go.html#8124848">ok</a></span>&nbsp;<span class="op" id="8124894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8124899"><a href="/image/png/reader_test.go.html#8124538">t</a></span><span class="op" id="8124900">.</span><span class="ident" id="8124901">Errorf</span><span class="op" id="8124907">(</span><span class="string" id="8124908">&#34;%s:&nbsp;expected&nbsp;paletted&nbsp;color&nbsp;model&#34;</span><span class="op" id="8124943">,</span>&nbsp;<span class="ident" id="8124945"><a href="/image/png/reader_test.go.html#8124562">fn</a></span><span class="op" id="8124947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124952">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8124963">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8124967">if</span>&nbsp;<span class="ident" id="8124970"><a href="/image/png/reader_test.go.html#8124843">pal</a></span>&nbsp;<span class="op" id="8124974">==</span>&nbsp;<span class="ident" id="8124977">nil</span>&nbsp;<span class="op" id="8124981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8124986"><a href="/image/png/reader_test.go.html#8124538">t</a></span><span class="op" id="8124987">.</span><span class="ident" id="8124988">Errorf</span><span class="op" id="8124994">(</span><span class="string" id="8124995">&#34;%s:&nbsp;palette&nbsp;not&nbsp;initialized&#34;</span><span class="op" id="8125024">,</span>&nbsp;<span class="ident" id="8125026"><a href="/image/png/reader_test.go.html#8124562">fn</a></span><span class="op" id="8125028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8125033">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8125044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8125047">}</span><br>
<span class="lineno">320</span><span class="op" id="8125049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8125052">func</span>&nbsp;<span class="ident" id="8125057">benchmarkDecode</span><span class="op" id="8125072">(</span><span class="ident" id="8125073">b</span>&nbsp;<span class="op" id="8125075">*</span><span class="ident" id="8125076"><a href="/image/png/reader_test.go.html#8117897">testing</a></span><span class="op" id="8125083">.</span><span class="ident" id="8125084">B</span><span class="op" id="8125085">,</span>&nbsp;<span class="ident" id="8125087">filename</span>&nbsp;<span class="builtintype" id="8125096">string</span><span class="op" id="8125102">,</span>&nbsp;<span class="ident" id="8125104">bytesPerPixel</span>&nbsp;<span class="builtintype" id="8125118">int</span><span class="op" id="8125121">)</span>&nbsp;<span class="op" id="8125123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125126"><a href="/image/png/reader_test.go.html#8125073">b</a></span><span class="op" id="8125127">.</span><span class="ident" id="8125128">StopTimer</span><span class="op" id="8125137">(</span><span class="op" id="8125138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125141">data</span><span class="op" id="8125145">,</span>&nbsp;<span class="ident" id="8125147">err</span>&nbsp;<span class="op" id="8125151">:=</span>&nbsp;<span class="ident" id="8125154"><a href="/image/png/reader_test.go.html#8117867">ioutil</a></span><span class="op" id="8125160">.</span><span class="ident" id="8125161">ReadFile</span><span class="op" id="8125169">(</span><span class="ident" id="8125170"><a href="/image/png/reader_test.go.html#8125087">filename</a></span><span class="op" id="8125178">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8125181">if</span>&nbsp;<span class="ident" id="8125184"><a href="/image/png/reader_test.go.html#8125147">err</a></span>&nbsp;<span class="op" id="8125188">!=</span>&nbsp;<span class="ident" id="8125191">nil</span>&nbsp;<span class="op" id="8125195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125199"><a href="/image/png/reader_test.go.html#8125073">b</a></span><span class="op" id="8125200">.</span><span class="ident" id="8125201">Fatal</span><span class="op" id="8125206">(</span><span class="ident" id="8125207"><a href="/image/png/reader_test.go.html#8125147">err</a></span><span class="op" id="8125210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8125213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125216">s</span>&nbsp;<span class="op" id="8125218">:=</span>&nbsp;<span class="builtintype" id="8125221">string</span><span class="op" id="8125227">(</span><span class="ident" id="8125228"><a href="/image/png/reader_test.go.html#8125141">data</a></span><span class="op" id="8125232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125235">cfg</span><span class="op" id="8125238">,</span>&nbsp;<span class="ident" id="8125240"><a href="/image/png/reader_test.go.html#8125147">err</a></span>&nbsp;<span class="op" id="8125244">:=</span>&nbsp;<span class="ident" id="8125247"><a href="/image/png/reader.go.html#4880189">DecodeConfig</a></span><span class="op" id="8125259">(</span><span class="ident" id="8125260"><a href="/image/png/reader_test.go.html#8117886">strings</a></span><span class="op" id="8125267">.</span><span class="ident" id="8125268">NewReader</span><span class="op" id="8125277">(</span><span class="ident" id="8125278"><a href="/image/png/reader_test.go.html#8125216">s</a></span><span class="op" id="8125279">)</span><span class="op" id="8125280">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8125283">if</span>&nbsp;<span class="ident" id="8125286"><a href="/image/png/reader_test.go.html#8125147">err</a></span>&nbsp;<span class="op" id="8125290">!=</span>&nbsp;<span class="ident" id="8125293">nil</span>&nbsp;<span class="op" id="8125297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125301"><a href="/image/png/reader_test.go.html#8125073">b</a></span><span class="op" id="8125302">.</span><span class="ident" id="8125303">Fatal</span><span class="op" id="8125308">(</span><span class="ident" id="8125309"><a href="/image/png/reader_test.go.html#8125147">err</a></span><span class="op" id="8125312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8125315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125318"><a href="/image/png/reader_test.go.html#8125073">b</a></span><span class="op" id="8125319">.</span><span class="ident" id="8125320">SetBytes</span><span class="op" id="8125328">(</span><span class="ident" id="8125329">int64</span><span class="op" id="8125334">(</span><span class="ident" id="8125335"><a href="/image/png/reader_test.go.html#8125235">cfg</a></span><span class="op" id="8125338">.</span><span class="ident" id="8125339">Width</span>&nbsp;<span class="op" id="8125345">*</span>&nbsp;<span class="ident" id="8125347"><a href="/image/png/reader_test.go.html#8125235">cfg</a></span><span class="op" id="8125350">.</span><span class="ident" id="8125351">Height</span>&nbsp;<span class="op" id="8125358">*</span>&nbsp;<span class="ident" id="8125360"><a href="/image/png/reader_test.go.html#8125104">bytesPerPixel</a></span><span class="op" id="8125373">)</span><span class="op" id="8125374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125377"><a href="/image/png/reader_test.go.html#8125073">b</a></span><span class="op" id="8125378">.</span><span class="ident" id="8125379">StartTimer</span><span class="op" id="8125389">(</span><span class="op" id="8125390">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8125393">for</span>&nbsp;<span class="ident" id="8125397">i</span>&nbsp;<span class="op" id="8125399">:=</span>&nbsp;<span class="num" id="8125402">0</span><span class="op" id="8125403">;</span>&nbsp;<span class="ident" id="8125405"><a href="/image/png/reader_test.go.html#8125397">i</a></span>&nbsp;<span class="op" id="8125407">&lt;</span>&nbsp;<span class="ident" id="8125409"><a href="/image/png/reader_test.go.html#8125073">b</a></span><span class="op" id="8125410">.</span><span class="ident" id="8125411">N</span><span class="op" id="8125412">;</span>&nbsp;<span class="ident" id="8125414"><a href="/image/png/reader_test.go.html#8125397">i</a></span><span class="op" id="8125415">++</span>&nbsp;<span class="op" id="8125418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125422"><a href="/image/png/reader.go.html#4879689">Decode</a></span><span class="op" id="8125428">(</span><span class="ident" id="8125429"><a href="/image/png/reader_test.go.html#8117886">strings</a></span><span class="op" id="8125436">.</span><span class="ident" id="8125437">NewReader</span><span class="op" id="8125446">(</span><span class="ident" id="8125447"><a href="/image/png/reader_test.go.html#8125216">s</a></span><span class="op" id="8125448">)</span><span class="op" id="8125449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8125452">}</span><br>
<span class="lineno"></span><span class="op" id="8125454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="keyword" id="8125457">func</span>&nbsp;<span class="ident" id="8125462">BenchmarkDecodeGray</span><span class="op" id="8125481">(</span><span class="ident" id="8125482">b</span>&nbsp;<span class="op" id="8125484">*</span><span class="ident" id="8125485"><a href="/image/png/reader_test.go.html#8117897">testing</a></span><span class="op" id="8125492">.</span><span class="ident" id="8125493">B</span><span class="op" id="8125494">)</span>&nbsp;<span class="op" id="8125496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125499"><a href="/image/png/reader_test.go.html#8125057">benchmarkDecode</a></span><span class="op" id="8125514">(</span><span class="ident" id="8125515"><a href="/image/png/reader_test.go.html#8125482">b</a></span><span class="op" id="8125516">,</span>&nbsp;<span class="string" id="8125518">&#34;testdata/benchGray.png&#34;</span><span class="op" id="8125542">,</span>&nbsp;<span class="num" id="8125544">1</span><span class="op" id="8125545">)</span><br>
<span class="lineno"></span><span class="op" id="8125547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8125550">func</span>&nbsp;<span class="ident" id="8125555">BenchmarkDecodeNRGBAGradient</span><span class="op" id="8125583">(</span><span class="ident" id="8125584">b</span>&nbsp;<span class="op" id="8125586">*</span><span class="ident" id="8125587"><a href="/image/png/reader_test.go.html#8117897">testing</a></span><span class="op" id="8125594">.</span><span class="ident" id="8125595">B</span><span class="op" id="8125596">)</span>&nbsp;<span class="op" id="8125598">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125601"><a href="/image/png/reader_test.go.html#8125057">benchmarkDecode</a></span><span class="op" id="8125616">(</span><span class="ident" id="8125617"><a href="/image/png/reader_test.go.html#8125584">b</a></span><span class="op" id="8125618">,</span>&nbsp;<span class="string" id="8125620">&#34;testdata/benchNRGBA-gradient.png&#34;</span><span class="op" id="8125654">,</span>&nbsp;<span class="num" id="8125656">4</span><span class="op" id="8125657">)</span><br>
<span class="lineno"></span><span class="op" id="8125659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8125662">func</span>&nbsp;<span class="ident" id="8125667">BenchmarkDecodeNRGBAOpaque</span><span class="op" id="8125693">(</span><span class="ident" id="8125694">b</span>&nbsp;<span class="op" id="8125696">*</span><span class="ident" id="8125697"><a href="/image/png/reader_test.go.html#8117897">testing</a></span><span class="op" id="8125704">.</span><span class="ident" id="8125705">B</span><span class="op" id="8125706">)</span>&nbsp;<span class="op" id="8125708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125711"><a href="/image/png/reader_test.go.html#8125057">benchmarkDecode</a></span><span class="op" id="8125726">(</span><span class="ident" id="8125727"><a href="/image/png/reader_test.go.html#8125694">b</a></span><span class="op" id="8125728">,</span>&nbsp;<span class="string" id="8125730">&#34;testdata/benchNRGBA-opaque.png&#34;</span><span class="op" id="8125762">,</span>&nbsp;<span class="num" id="8125764">4</span><span class="op" id="8125765">)</span><br>
<span class="lineno">350</span><span class="op" id="8125767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8125770">func</span>&nbsp;<span class="ident" id="8125775">BenchmarkDecodePaletted</span><span class="op" id="8125798">(</span><span class="ident" id="8125799">b</span>&nbsp;<span class="op" id="8125801">*</span><span class="ident" id="8125802"><a href="/image/png/reader_test.go.html#8117897">testing</a></span><span class="op" id="8125809">.</span><span class="ident" id="8125810">B</span><span class="op" id="8125811">)</span>&nbsp;<span class="op" id="8125813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125816"><a href="/image/png/reader_test.go.html#8125057">benchmarkDecode</a></span><span class="op" id="8125831">(</span><span class="ident" id="8125832"><a href="/image/png/reader_test.go.html#8125799">b</a></span><span class="op" id="8125833">,</span>&nbsp;<span class="string" id="8125835">&#34;testdata/benchPaletted.png&#34;</span><span class="op" id="8125863">,</span>&nbsp;<span class="num" id="8125865">1</span><span class="op" id="8125866">)</span><br>
<span class="lineno"></span><span class="op" id="8125868">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="keyword" id="8125871">func</span>&nbsp;<span class="ident" id="8125876">BenchmarkDecodeRGB</span><span class="op" id="8125894">(</span><span class="ident" id="8125895">b</span>&nbsp;<span class="op" id="8125897">*</span><span class="ident" id="8125898"><a href="/image/png/reader_test.go.html#8117897">testing</a></span><span class="op" id="8125905">.</span><span class="ident" id="8125906">B</span><span class="op" id="8125907">)</span>&nbsp;<span class="op" id="8125909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8125912"><a href="/image/png/reader_test.go.html#8125057">benchmarkDecode</a></span><span class="op" id="8125927">(</span><span class="ident" id="8125928"><a href="/image/png/reader_test.go.html#8125895">b</a></span><span class="op" id="8125929">,</span>&nbsp;<span class="string" id="8125931">&#34;testdata/benchRGB.png&#34;</span><span class="op" id="8125954">,</span>&nbsp;<span class="num" id="8125956">4</span><span class="op" id="8125957">)</span><br>
<span class="lineno"></span><span class="op" id="8125959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="keyword" id="8125962">func</span>&nbsp;<span class="ident" id="8125967">BenchmarkDecodeInterlacing</span><span class="op" id="8125993">(</span><span class="ident" id="8125994">b</span>&nbsp;<span class="op" id="8125996">*</span><span class="ident" id="8125997"><a href="/image/png/reader_test.go.html#8117897">testing</a></span><span class="op" id="8126004">.</span><span class="ident" id="8126005">B</span><span class="op" id="8126006">)</span>&nbsp;<span class="op" id="8126008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8126011"><a href="/image/png/reader_test.go.html#8125057">benchmarkDecode</a></span><span class="op" id="8126026">(</span><span class="ident" id="8126027"><a href="/image/png/reader_test.go.html#8125994">b</a></span><span class="op" id="8126028">,</span>&nbsp;<span class="string" id="8126030">&#34;testdata/benchRGB-interlace.png&#34;</span><span class="op" id="8126063">,</span>&nbsp;<span class="num" id="8126065">4</span><span class="op" id="8126066">)</span><br>
<span class="lineno"></span><span class="op" id="8126068">}</span>
</div>
</body>
</html>
