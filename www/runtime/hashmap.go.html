<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1926910">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1926965">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1927019">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1927070">package</span>&nbsp;<span class="ident" id="1927078">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1927087">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;the&nbsp;implementation&nbsp;of&nbsp;Go&#39;s&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="1927146">//</span><br>
<span class="lineno"></span><span class="comment" id="1927149">//&nbsp;A&nbsp;map&nbsp;is&nbsp;just&nbsp;a&nbsp;hash&nbsp;table.&nbsp;&nbsp;The&nbsp;data&nbsp;is&nbsp;arranged</span><br>
<span class="lineno">10</span><span class="comment" id="1927202">//&nbsp;into&nbsp;an&nbsp;array&nbsp;of&nbsp;buckets.&nbsp;&nbsp;Each&nbsp;bucket&nbsp;contains&nbsp;up&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1927259">//&nbsp;8&nbsp;key/value&nbsp;pairs.&nbsp;&nbsp;The&nbsp;low-order&nbsp;bits&nbsp;of&nbsp;the&nbsp;hash&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1927317">//&nbsp;used&nbsp;to&nbsp;select&nbsp;a&nbsp;bucket.&nbsp;&nbsp;Each&nbsp;bucket&nbsp;contains&nbsp;a&nbsp;few</span><br>
<span class="lineno"></span><span class="comment" id="1927373">//&nbsp;high-order&nbsp;bits&nbsp;of&nbsp;each&nbsp;hash&nbsp;to&nbsp;distinguish&nbsp;the&nbsp;entries</span><br>
<span class="lineno"></span><span class="comment" id="1927432">//&nbsp;within&nbsp;a&nbsp;single&nbsp;bucket.</span><br>
<span class="lineno">15</span><span class="comment" id="1927459">//</span><br>
<span class="lineno"></span><span class="comment" id="1927462">//&nbsp;If&nbsp;more&nbsp;than&nbsp;8&nbsp;keys&nbsp;hash&nbsp;to&nbsp;a&nbsp;bucket,&nbsp;we&nbsp;chain&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="1927515">//&nbsp;extra&nbsp;buckets.</span><br>
<span class="lineno"></span><span class="comment" id="1927533">//</span><br>
<span class="lineno"></span><span class="comment" id="1927536">//&nbsp;When&nbsp;the&nbsp;hashtable&nbsp;grows,&nbsp;we&nbsp;allocate&nbsp;a&nbsp;new&nbsp;array</span><br>
<span class="lineno">20</span><span class="comment" id="1927589">//&nbsp;of&nbsp;buckets&nbsp;twice&nbsp;as&nbsp;big.&nbsp;&nbsp;Buckets&nbsp;are&nbsp;incrementally</span><br>
<span class="lineno"></span><span class="comment" id="1927644">//&nbsp;copied&nbsp;from&nbsp;the&nbsp;old&nbsp;bucket&nbsp;array&nbsp;to&nbsp;the&nbsp;new&nbsp;bucket&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment" id="1927705">//</span><br>
<span class="lineno"></span><span class="comment" id="1927708">//&nbsp;Map&nbsp;iterators&nbsp;walk&nbsp;through&nbsp;the&nbsp;array&nbsp;of&nbsp;buckets&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1927763">//&nbsp;return&nbsp;the&nbsp;keys&nbsp;in&nbsp;walk&nbsp;order&nbsp;(bucket&nbsp;#,&nbsp;then&nbsp;overflow</span><br>
<span class="lineno">25</span><span class="comment" id="1927821">//&nbsp;chain&nbsp;order,&nbsp;then&nbsp;bucket&nbsp;index).&nbsp;&nbsp;To&nbsp;maintain&nbsp;iteration</span><br>
<span class="lineno"></span><span class="comment" id="1927880">//&nbsp;semantics,&nbsp;we&nbsp;never&nbsp;move&nbsp;keys&nbsp;within&nbsp;their&nbsp;bucket&nbsp;(if</span><br>
<span class="lineno"></span><span class="comment" id="1927937">//&nbsp;we&nbsp;did,&nbsp;keys&nbsp;might&nbsp;be&nbsp;returned&nbsp;0&nbsp;or&nbsp;2&nbsp;times).&nbsp;&nbsp;When</span><br>
<span class="lineno"></span><span class="comment" id="1927992">//&nbsp;growing&nbsp;the&nbsp;table,&nbsp;iterators&nbsp;remain&nbsp;iterating&nbsp;through&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1928053">//&nbsp;old&nbsp;table&nbsp;and&nbsp;must&nbsp;check&nbsp;the&nbsp;new&nbsp;table&nbsp;if&nbsp;the&nbsp;bucket</span><br>
<span class="lineno">30</span><span class="comment" id="1928109">//&nbsp;they&nbsp;are&nbsp;iterating&nbsp;through&nbsp;has&nbsp;been&nbsp;moved&nbsp;(&#34;evacuated&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="1928168">//&nbsp;to&nbsp;the&nbsp;new&nbsp;table.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1928190">//&nbsp;Picking&nbsp;loadFactor:&nbsp;too&nbsp;large&nbsp;and&nbsp;we&nbsp;have&nbsp;lots&nbsp;of&nbsp;overflow</span><br>
<span class="lineno"></span><span class="comment" id="1928252">//&nbsp;buckets,&nbsp;too&nbsp;small&nbsp;and&nbsp;we&nbsp;waste&nbsp;a&nbsp;lot&nbsp;of&nbsp;space.&nbsp;&nbsp;I&nbsp;wrote</span><br>
<span class="lineno">35</span><span class="comment" id="1928312">//&nbsp;a&nbsp;simple&nbsp;program&nbsp;to&nbsp;check&nbsp;some&nbsp;stats&nbsp;for&nbsp;different&nbsp;loads:</span><br>
<span class="lineno"></span><span class="comment" id="1928373">//&nbsp;(64-bit,&nbsp;8&nbsp;byte&nbsp;keys&nbsp;and&nbsp;values)</span><br>
<span class="lineno"></span><span class="comment" id="1928409">//&nbsp;&nbsp;loadFactor&nbsp;&nbsp;&nbsp;&nbsp;%overflow&nbsp;&nbsp;bytes/entry&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hitprobe&nbsp;&nbsp;&nbsp;&nbsp;missprobe</span><br>
<span class="lineno"></span><span class="comment" id="1928476">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20.77&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.00</span><br>
<span class="lineno"></span><span class="comment" id="1928543">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;17.30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.50</span><br>
<span class="lineno">40</span><span class="comment" id="1928610">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.85&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14.77&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.00</span><br>
<span class="lineno"></span><span class="comment" id="1928677">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12.94&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.75&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.50</span><br>
<span class="lineno"></span><span class="comment" id="1928744">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15.27&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11.67&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.00</span><br>
<span class="lineno"></span><span class="comment" id="1928811">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20.90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.79&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.50</span><br>
<span class="lineno"></span><span class="comment" id="1928878">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;27.14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10.15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.00</span><br>
<span class="lineno">45</span><span class="comment" id="1928945">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;34.03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.73&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.75&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.50</span><br>
<span class="lineno"></span><span class="comment" id="1929012">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;41.10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8.00</span><br>
<span class="lineno"></span><span class="comment" id="1929079">//</span><br>
<span class="lineno"></span><span class="comment" id="1929082">//&nbsp;%overflow&nbsp;&nbsp;&nbsp;=&nbsp;percentage&nbsp;of&nbsp;buckets&nbsp;which&nbsp;have&nbsp;an&nbsp;overflow&nbsp;bucket</span><br>
<span class="lineno"></span><span class="comment" id="1929151">//&nbsp;bytes/entry&nbsp;=&nbsp;overhead&nbsp;bytes&nbsp;used&nbsp;per&nbsp;key/value&nbsp;pair</span><br>
<span class="lineno">50</span><span class="comment" id="1929207">//&nbsp;hitprobe&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;#&nbsp;of&nbsp;entries&nbsp;to&nbsp;check&nbsp;when&nbsp;looking&nbsp;up&nbsp;a&nbsp;present&nbsp;key</span><br>
<span class="lineno"></span><span class="comment" id="1929276">//&nbsp;missprobe&nbsp;&nbsp;&nbsp;=&nbsp;#&nbsp;of&nbsp;entries&nbsp;to&nbsp;check&nbsp;when&nbsp;looking&nbsp;up&nbsp;an&nbsp;absent&nbsp;key</span><br>
<span class="lineno"></span><span class="comment" id="1929345">//</span><br>
<span class="lineno"></span><span class="comment" id="1929348">//&nbsp;Keep&nbsp;in&nbsp;mind&nbsp;this&nbsp;data&nbsp;is&nbsp;for&nbsp;maximally&nbsp;loaded&nbsp;tables,&nbsp;i.e.&nbsp;just</span><br>
<span class="lineno"></span><span class="comment" id="1929416">//&nbsp;before&nbsp;the&nbsp;table&nbsp;grows.&nbsp;&nbsp;Typical&nbsp;tables&nbsp;will&nbsp;be&nbsp;somewhat&nbsp;less&nbsp;loaded.</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="1929490">import</span>&nbsp;<span class="op" id="1929497">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1929500">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="1929509">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="1929512">const</span>&nbsp;<span class="op" id="1929518">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929521">//&nbsp;Maximum&nbsp;number&nbsp;of&nbsp;key/value&nbsp;pairs&nbsp;a&nbsp;bucket&nbsp;can&nbsp;hold.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929578">bucketCntBits</span>&nbsp;<span class="op" id="1929592">=</span>&nbsp;<span class="num" id="1929594">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929597">bucketCnt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1929611">=</span>&nbsp;<span class="num" id="1929613">1</span>&nbsp;<span class="op" id="1929615">&lt;&lt;</span>&nbsp;<span class="ident" id="1929618"><a href="/runtime/hashmap.go.html#1929578">bucketCntBits</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929634">//&nbsp;Maximum&nbsp;average&nbsp;load&nbsp;of&nbsp;a&nbsp;bucket&nbsp;that&nbsp;triggers&nbsp;growth.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929693">loadFactor</span>&nbsp;<span class="op" id="1929704">=</span>&nbsp;<span class="num" id="1929706">6.5</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929712">//&nbsp;Maximum&nbsp;key&nbsp;or&nbsp;value&nbsp;size&nbsp;to&nbsp;keep&nbsp;inline&nbsp;(instead&nbsp;of&nbsp;mallocing&nbsp;per&nbsp;element).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929793">//&nbsp;Must&nbsp;fit&nbsp;in&nbsp;a&nbsp;uint8.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929818">//&nbsp;Fast&nbsp;versions&nbsp;cannot&nbsp;handle&nbsp;big&nbsp;values&nbsp;-&nbsp;the&nbsp;cutoff&nbsp;size&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929883">//&nbsp;fast&nbsp;versions&nbsp;in&nbsp;../../cmd/gc/walk.c&nbsp;must&nbsp;be&nbsp;at&nbsp;most&nbsp;this&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929952">maxKeySize</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1929965">=</span>&nbsp;<span class="num" id="1929967">128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1929972">maxValueSize</span>&nbsp;<span class="op" id="1929985">=</span>&nbsp;<span class="num" id="1929987">128</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1929993">//&nbsp;data&nbsp;offset&nbsp;should&nbsp;be&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;bmap&nbsp;struct,&nbsp;but&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930064">//&nbsp;aligned&nbsp;correctly.&nbsp;&nbsp;For&nbsp;amd64p32&nbsp;this&nbsp;means&nbsp;64-bit&nbsp;alignment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930129">//&nbsp;even&nbsp;though&nbsp;pointers&nbsp;are&nbsp;32&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930166">dataOffset</span>&nbsp;<span class="op" id="1930177">=</span>&nbsp;<span class="ident" id="1930179"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1930185">.</span><span class="ident" id="1930186">Offsetof</span><span class="op" id="1930194">(</span><span class="keyword" id="1930195">struct</span>&nbsp;<span class="op" id="1930202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930206">b</span>&nbsp;<span class="ident" id="1930208"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930215">v</span>&nbsp;<span class="ident" id="1930217">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1930224">}</span><span class="op" id="1930225">{</span><span class="op" id="1930226">}</span><span class="op" id="1930227">.</span><span class="ident" id="1930228">v</span><span class="op" id="1930229">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930233">//&nbsp;Possible&nbsp;tophash&nbsp;values.&nbsp;&nbsp;We&nbsp;reserve&nbsp;a&nbsp;few&nbsp;possibilities&nbsp;for&nbsp;special&nbsp;marks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930313">//&nbsp;Each&nbsp;bucket&nbsp;(including&nbsp;its&nbsp;overflow&nbsp;buckets,&nbsp;if&nbsp;any)&nbsp;will&nbsp;have&nbsp;either&nbsp;all&nbsp;or&nbsp;none&nbsp;of&nbsp;its</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930406">//&nbsp;entries&nbsp;in&nbsp;the&nbsp;evacuated*&nbsp;states&nbsp;(except&nbsp;during&nbsp;the&nbsp;evacuate()&nbsp;method,&nbsp;which&nbsp;only&nbsp;happens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930500">//&nbsp;during&nbsp;map&nbsp;writes&nbsp;and&nbsp;thus&nbsp;no&nbsp;one&nbsp;else&nbsp;can&nbsp;observe&nbsp;the&nbsp;map&nbsp;during&nbsp;that&nbsp;time).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930582">empty</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1930597">=</span>&nbsp;<span class="num" id="1930599">0</span>&nbsp;<span class="comment" id="1930601">//&nbsp;cell&nbsp;is&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930619">evacuatedEmpty</span>&nbsp;<span class="op" id="1930634">=</span>&nbsp;<span class="num" id="1930636">1</span>&nbsp;<span class="comment" id="1930638">//&nbsp;cell&nbsp;is&nbsp;empty,&nbsp;bucket&nbsp;is&nbsp;evacuated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930678">evacuatedX</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1930693">=</span>&nbsp;<span class="num" id="1930695">2</span>&nbsp;<span class="comment" id="1930697">//&nbsp;key/value&nbsp;is&nbsp;valid.&nbsp;&nbsp;Entry&nbsp;has&nbsp;been&nbsp;evacuated&nbsp;to&nbsp;first&nbsp;half&nbsp;of&nbsp;larger&nbsp;table.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930778">evacuatedY</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1930793">=</span>&nbsp;<span class="num" id="1930795">3</span>&nbsp;<span class="comment" id="1930797">//&nbsp;same&nbsp;as&nbsp;above,&nbsp;but&nbsp;evacuated&nbsp;to&nbsp;second&nbsp;half&nbsp;of&nbsp;larger&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930862">minTopHash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1930877">=</span>&nbsp;<span class="num" id="1930879">4</span>&nbsp;<span class="comment" id="1930881">//&nbsp;minimum&nbsp;tophash&nbsp;for&nbsp;a&nbsp;normal&nbsp;filled&nbsp;cell.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1930928">//&nbsp;flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930938">iterator</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1930950">=</span>&nbsp;<span class="num" id="1930952">1</span>&nbsp;<span class="comment" id="1930954">//&nbsp;there&nbsp;may&nbsp;be&nbsp;an&nbsp;iterator&nbsp;using&nbsp;buckets</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1930997">oldIterator</span>&nbsp;<span class="op" id="1931009">=</span>&nbsp;<span class="num" id="1931011">2</span>&nbsp;<span class="comment" id="1931013">//&nbsp;there&nbsp;may&nbsp;be&nbsp;an&nbsp;iterator&nbsp;using&nbsp;oldbuckets</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931060">//&nbsp;sentinel&nbsp;bucket&nbsp;ID&nbsp;for&nbsp;iterator&nbsp;checks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931103">noCheck</span>&nbsp;<span class="op" id="1931111">=</span>&nbsp;<span class="num" id="1931113">1</span><span class="op" id="1931114">&lt;&lt;</span><span class="op" id="1931116">(</span><span class="num" id="1931117">8</span><span class="op" id="1931118">*</span><span class="ident" id="1931119"><a href="/runtime/stubs.go.html#2131510">ptrSize</a></span><span class="op" id="1931126">)</span>&nbsp;<span class="op" id="1931128">-</span>&nbsp;<span class="num" id="1931130">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931134">//&nbsp;trigger&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;at&nbsp;every&nbsp;alloc&nbsp;called&nbsp;from&nbsp;this&nbsp;code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931204">checkgc</span>&nbsp;<span class="op" id="1931212">=</span>&nbsp;<span class="builtintype" id="1931214">false</span><br>
<span class="lineno"></span><span class="op" id="1931220">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1931223">//&nbsp;A&nbsp;header&nbsp;for&nbsp;a&nbsp;Go&nbsp;map.</span><br>
<span class="lineno">105</span><span class="keyword" id="1931249">type</span>&nbsp;<span class="ident" id="1931254">hmap</span>&nbsp;<span class="keyword" id="1931259">struct</span>&nbsp;<span class="op" id="1931266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931269">//&nbsp;Note:&nbsp;the&nbsp;format&nbsp;of&nbsp;the&nbsp;Hmap&nbsp;is&nbsp;encoded&nbsp;in&nbsp;../../cmd/gc/reflect.c&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1931343">//&nbsp;../reflect/type.go.&nbsp;&nbsp;Don&#39;t&nbsp;change&nbsp;this&nbsp;structure&nbsp;without&nbsp;also&nbsp;changing&nbsp;that&nbsp;code!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931429">count</span>&nbsp;<span class="builtintype" id="1931435">int</span>&nbsp;<span class="comment" id="1931439">//&nbsp;#&nbsp;live&nbsp;cells&nbsp;==&nbsp;size&nbsp;of&nbsp;map.&nbsp;&nbsp;Must&nbsp;be&nbsp;first&nbsp;(used&nbsp;by&nbsp;len()&nbsp;builtin)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931511">flags</span>&nbsp;<span class="builtintype" id="1931517">uint32</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931525">hash0</span>&nbsp;<span class="builtintype" id="1931531">uint32</span>&nbsp;<span class="comment" id="1931538">//&nbsp;hash&nbsp;seed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931552">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1931558">uint8</span>&nbsp;&nbsp;<span class="comment" id="1931565">//&nbsp;log_2&nbsp;of&nbsp;#&nbsp;of&nbsp;buckets&nbsp;(can&nbsp;hold&nbsp;up&nbsp;to&nbsp;loadFactor&nbsp;*&nbsp;2^B&nbsp;items)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931632">buckets</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1931643"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1931649">.</span><span class="ident" id="1931650">Pointer</span>&nbsp;<span class="comment" id="1931658">//&nbsp;array&nbsp;of&nbsp;2^B&nbsp;Buckets.&nbsp;may&nbsp;be&nbsp;nil&nbsp;if&nbsp;count==0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931708">oldbuckets</span>&nbsp;<span class="ident" id="1931719"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1931725">.</span><span class="ident" id="1931726">Pointer</span>&nbsp;<span class="comment" id="1931734">//&nbsp;previous&nbsp;bucket&nbsp;array&nbsp;of&nbsp;half&nbsp;the&nbsp;size,&nbsp;non-nil&nbsp;only&nbsp;when&nbsp;growing</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931804">nevacuate</span>&nbsp;&nbsp;<span class="builtintype" id="1931815">uintptr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1931830">//&nbsp;progress&nbsp;counter&nbsp;for&nbsp;evacuation&nbsp;(buckets&nbsp;less&nbsp;than&nbsp;this&nbsp;have&nbsp;been&nbsp;evacuated)</span><br>
<span class="lineno"></span><span class="op" id="1931910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1931913">//&nbsp;A&nbsp;bucket&nbsp;for&nbsp;a&nbsp;Go&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="1931939">type</span>&nbsp;<span class="ident" id="1931944">bmap</span>&nbsp;<span class="keyword" id="1931949">struct</span>&nbsp;<span class="op" id="1931956">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931959">tophash</span>&nbsp;&nbsp;<span class="op" id="1931968">[</span><span class="ident" id="1931969"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1931978">]</span><span class="builtintype" id="1931979">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1931986">overflow</span>&nbsp;<span class="op" id="1931995">*</span><span class="ident" id="1931996"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1932002">//&nbsp;Followed&nbsp;by&nbsp;bucketCnt&nbsp;keys&nbsp;and&nbsp;then&nbsp;bucketCnt&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1932060">//&nbsp;NOTE:&nbsp;packing&nbsp;all&nbsp;the&nbsp;keys&nbsp;together&nbsp;and&nbsp;then&nbsp;all&nbsp;the&nbsp;values&nbsp;together&nbsp;makes&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1932143">//&nbsp;code&nbsp;a&nbsp;bit&nbsp;more&nbsp;complicated&nbsp;than&nbsp;alternating&nbsp;key/value/key/value/...&nbsp;but&nbsp;it&nbsp;allows</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1932230">//&nbsp;us&nbsp;to&nbsp;eliminate&nbsp;padding&nbsp;which&nbsp;would&nbsp;be&nbsp;needed&nbsp;for,&nbsp;e.g.,&nbsp;map[int64]int8.</span><br>
<span class="lineno"></span><span class="op" id="1932306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1932309">//&nbsp;A&nbsp;hash&nbsp;iteration&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1932340">//&nbsp;If&nbsp;you&nbsp;modify&nbsp;hiter,&nbsp;also&nbsp;change&nbsp;cmd/gc/reflect.c&nbsp;to&nbsp;indicate</span><br>
<span class="lineno">130</span><span class="comment" id="1932405">//&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="1932438">type</span>&nbsp;<span class="ident" id="1932443">hiter</span>&nbsp;<span class="keyword" id="1932449">struct</span>&nbsp;<span class="op" id="1932456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932459">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1932471"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1932477">.</span><span class="ident" id="1932478">Pointer</span>&nbsp;<span class="comment" id="1932486">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;first&nbsp;position.&nbsp;&nbsp;Write&nbsp;nil&nbsp;to&nbsp;indicate&nbsp;iteration&nbsp;end&nbsp;(see&nbsp;cmd/gc/range.c).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932576">value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1932588"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1932594">.</span><span class="ident" id="1932595">Pointer</span>&nbsp;<span class="comment" id="1932603">//&nbsp;Must&nbsp;be&nbsp;in&nbsp;second&nbsp;position&nbsp;(see&nbsp;cmd/gc/range.c).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932656">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1932668">*</span><span class="ident" id="1932669"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932678">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1932690">*</span><span class="ident" id="1932691"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932697">buckets</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1932709"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1932715">.</span><span class="ident" id="1932716">Pointer</span>&nbsp;<span class="comment" id="1932724">//&nbsp;bucket&nbsp;ptr&nbsp;at&nbsp;hash_iter&nbsp;initialization&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932772">bptr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1932784">*</span><span class="ident" id="1932785"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1932799">//&nbsp;current&nbsp;bucket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932818">startBucket</span>&nbsp;<span class="builtintype" id="1932830">uintptr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1932845">//&nbsp;bucket&nbsp;iteration&nbsp;started&nbsp;at</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1932877">offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1932889">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1932904">//&nbsp;intra-bucket&nbsp;offset&nbsp;to&nbsp;start&nbsp;from&nbsp;during&nbsp;iteration&nbsp;(should&nbsp;be&nbsp;big&nbsp;enough&nbsp;to&nbsp;hold&nbsp;bucketCnt-1)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933002">wrapped</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1933014">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1933029">//&nbsp;already&nbsp;wrapped&nbsp;around&nbsp;from&nbsp;end&nbsp;of&nbsp;bucket&nbsp;array&nbsp;to&nbsp;beginning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933094">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1933106">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933113">i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1933125">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933132">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1933144">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933153">checkBucket</span>&nbsp;<span class="builtintype" id="1933165">uintptr</span><br>
<span class="lineno">145</span><span class="op" id="1933173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1933176">func</span>&nbsp;<span class="ident" id="1933181">evacuated</span><span class="op" id="1933190">(</span><span class="ident" id="1933191">b</span>&nbsp;<span class="op" id="1933193">*</span><span class="ident" id="1933194"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1933198">)</span>&nbsp;<span class="builtintype" id="1933200">bool</span>&nbsp;<span class="op" id="1933205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933208">h</span>&nbsp;<span class="op" id="1933210">:=</span>&nbsp;<span class="ident" id="1933213"><a href="/runtime/hashmap.go.html#1933191">b</a></span><span class="op" id="1933214">.</span><span class="ident" id="1933215">tophash</span><span class="op" id="1933222">[</span><span class="num" id="1933223">0</span><span class="op" id="1933224">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933227">return</span>&nbsp;<span class="ident" id="1933234"><a href="/runtime/hashmap.go.html#1933208">h</a></span>&nbsp;<span class="op" id="1933236">&gt;</span>&nbsp;<span class="ident" id="1933238"><a href="/runtime/hashmap.go.html#1930582">empty</a></span>&nbsp;<span class="op" id="1933244">&amp;&amp;</span>&nbsp;<span class="ident" id="1933247"><a href="/runtime/hashmap.go.html#1933208">h</a></span>&nbsp;<span class="op" id="1933249">&lt;</span>&nbsp;<span class="ident" id="1933251"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span><br>
<span class="lineno">150</span><span class="op" id="1933262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1933265">func</span>&nbsp;<span class="ident" id="1933270">makemap</span><span class="op" id="1933277">(</span><span class="ident" id="1933278">t</span>&nbsp;<span class="op" id="1933280">*</span><span class="ident" id="1933281"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1933288">,</span>&nbsp;<span class="ident" id="1933290">hint</span>&nbsp;<span class="ident" id="1933295">int64</span><span class="op" id="1933300">)</span>&nbsp;<span class="op" id="1933302">*</span><span class="ident" id="1933303"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span>&nbsp;<span class="op" id="1933308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933311">if</span>&nbsp;<span class="ident" id="1933314">sz</span>&nbsp;<span class="op" id="1933317">:=</span>&nbsp;<span class="ident" id="1933320"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1933326">.</span><span class="ident" id="1933327">Sizeof</span><span class="op" id="1933333">(</span><span class="ident" id="1933334"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1933338">{</span><span class="op" id="1933339">}</span><span class="op" id="1933340">)</span><span class="op" id="1933341">;</span>&nbsp;<span class="ident" id="1933343"><a href="/runtime/hashmap.go.html#1933314">sz</a></span>&nbsp;<span class="op" id="1933346">&gt;</span>&nbsp;<span class="num" id="1933348">48</span>&nbsp;<span class="op" id="1933351">||</span>&nbsp;<span class="ident" id="1933354"><a href="/runtime/hashmap.go.html#1933314">sz</a></span>&nbsp;<span class="op" id="1933357">!=</span>&nbsp;<span class="builtintype" id="1933360">uintptr</span><span class="op" id="1933367">(</span><span class="ident" id="1933368"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933369">.</span><span class="ident" id="1933370">hmap</span><span class="op" id="1933374">.</span><span class="ident" id="1933375">size</span><span class="op" id="1933379">)</span>&nbsp;<span class="op" id="1933381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933385"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1933392">(</span><span class="string" id="1933393">&#34;bad&nbsp;hmap&nbsp;size&#34;</span><span class="op" id="1933408">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1933411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933415">if</span>&nbsp;<span class="ident" id="1933418"><a href="/runtime/hashmap.go.html#1933290">hint</a></span>&nbsp;<span class="op" id="1933423">&lt;</span>&nbsp;<span class="num" id="1933425">0</span>&nbsp;<span class="op" id="1933427">||</span>&nbsp;<span class="ident" id="1933430">int64</span><span class="op" id="1933435">(</span><span class="builtintype" id="1933436">int32</span><span class="op" id="1933441">(</span><span class="ident" id="1933442"><a href="/runtime/hashmap.go.html#1933290">hint</a></span><span class="op" id="1933446">)</span><span class="op" id="1933447">)</span>&nbsp;<span class="op" id="1933449">!=</span>&nbsp;<span class="ident" id="1933452"><a href="/runtime/hashmap.go.html#1933290">hint</a></span>&nbsp;<span class="op" id="1933457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1933461">panic</span><span class="op" id="1933466">(</span><span class="string" id="1933467">&#34;makemap:&nbsp;size&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="1933495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1933499">//&nbsp;TODO:&nbsp;make&nbsp;hint&nbsp;an&nbsp;int,&nbsp;then&nbsp;none&nbsp;of&nbsp;this&nbsp;nonsense</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1933554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933558">if</span>&nbsp;<span class="op" id="1933561">!</span><span class="ident" id="1933562"><a href="/runtime/hashmap.go.html#1954495">ismapkey</a></span><span class="op" id="1933570">(</span><span class="ident" id="1933571"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933572">.</span><span class="ident" id="1933573">key</span><span class="op" id="1933576">)</span>&nbsp;<span class="op" id="1933578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933582"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1933589">(</span><span class="string" id="1933590">&#34;runtime.makemap:&nbsp;unsupported&nbsp;map&nbsp;key&nbsp;type&#34;</span><span class="op" id="1933633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1933636">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1933640">//&nbsp;check&nbsp;compiler&#39;s&nbsp;and&nbsp;reflect&#39;s&nbsp;math</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933680">if</span>&nbsp;<span class="ident" id="1933683"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933684">.</span><span class="ident" id="1933685">key</span><span class="op" id="1933688">.</span><span class="ident" id="1933689">size</span>&nbsp;<span class="op" id="1933694">&gt;</span>&nbsp;<span class="ident" id="1933696"><a href="/runtime/hashmap.go.html#1929952">maxKeySize</a></span>&nbsp;<span class="op" id="1933707">&amp;&amp;</span>&nbsp;<span class="op" id="1933710">(</span><span class="op" id="1933711">!</span><span class="ident" id="1933712"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933713">.</span><span class="ident" id="1933714">indirectkey</span>&nbsp;<span class="op" id="1933726">||</span>&nbsp;<span class="ident" id="1933729"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933730">.</span><span class="ident" id="1933731">keysize</span>&nbsp;<span class="op" id="1933739">!=</span>&nbsp;<span class="builtintype" id="1933742">uint8</span><span class="op" id="1933747">(</span><span class="ident" id="1933748"><a href="/runtime/stubs.go.html#2131510">ptrSize</a></span><span class="op" id="1933755">)</span><span class="op" id="1933756">)</span>&nbsp;<span class="op" id="1933758">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933763"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933764">.</span><span class="ident" id="1933765">key</span><span class="op" id="1933768">.</span><span class="ident" id="1933769">size</span>&nbsp;<span class="op" id="1933774">&lt;=</span>&nbsp;<span class="ident" id="1933777"><a href="/runtime/hashmap.go.html#1929952">maxKeySize</a></span>&nbsp;<span class="op" id="1933788">&amp;&amp;</span>&nbsp;<span class="op" id="1933791">(</span><span class="ident" id="1933792"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933793">.</span><span class="ident" id="1933794">indirectkey</span>&nbsp;<span class="op" id="1933806">||</span>&nbsp;<span class="ident" id="1933809"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933810">.</span><span class="ident" id="1933811">keysize</span>&nbsp;<span class="op" id="1933819">!=</span>&nbsp;<span class="builtintype" id="1933822">uint8</span><span class="op" id="1933827">(</span><span class="ident" id="1933828"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933829">.</span><span class="ident" id="1933830">key</span><span class="op" id="1933833">.</span><span class="ident" id="1933834">size</span><span class="op" id="1933838">)</span><span class="op" id="1933839">)</span>&nbsp;<span class="op" id="1933841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933845"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1933852">(</span><span class="string" id="1933853">&#34;key&nbsp;size&nbsp;wrong&#34;</span><span class="op" id="1933869">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1933872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1933875">if</span>&nbsp;<span class="ident" id="1933878"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933879">.</span><span class="ident" id="1933880">elem</span><span class="op" id="1933884">.</span><span class="ident" id="1933885">size</span>&nbsp;<span class="op" id="1933890">&gt;</span>&nbsp;<span class="ident" id="1933892"><a href="/runtime/hashmap.go.html#1929972">maxValueSize</a></span>&nbsp;<span class="op" id="1933905">&amp;&amp;</span>&nbsp;<span class="op" id="1933908">(</span><span class="op" id="1933909">!</span><span class="ident" id="1933910"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933911">.</span><span class="ident" id="1933912">indirectvalue</span>&nbsp;<span class="op" id="1933926">||</span>&nbsp;<span class="ident" id="1933929"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933930">.</span><span class="ident" id="1933931">valuesize</span>&nbsp;<span class="op" id="1933941">!=</span>&nbsp;<span class="builtintype" id="1933944">uint8</span><span class="op" id="1933949">(</span><span class="ident" id="1933950"><a href="/runtime/stubs.go.html#2131510">ptrSize</a></span><span class="op" id="1933957">)</span><span class="op" id="1933958">)</span>&nbsp;<span class="op" id="1933960">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1933965"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933966">.</span><span class="ident" id="1933967">elem</span><span class="op" id="1933971">.</span><span class="ident" id="1933972">size</span>&nbsp;<span class="op" id="1933977">&lt;=</span>&nbsp;<span class="ident" id="1933980"><a href="/runtime/hashmap.go.html#1929972">maxValueSize</a></span>&nbsp;<span class="op" id="1933993">&amp;&amp;</span>&nbsp;<span class="op" id="1933996">(</span><span class="ident" id="1933997"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1933998">.</span><span class="ident" id="1933999">indirectvalue</span>&nbsp;<span class="op" id="1934013">||</span>&nbsp;<span class="ident" id="1934016"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1934017">.</span><span class="ident" id="1934018">valuesize</span>&nbsp;<span class="op" id="1934028">!=</span>&nbsp;<span class="builtintype" id="1934031">uint8</span><span class="op" id="1934036">(</span><span class="ident" id="1934037"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1934038">.</span><span class="ident" id="1934039">elem</span><span class="op" id="1934043">.</span><span class="ident" id="1934044">size</span><span class="op" id="1934048">)</span><span class="op" id="1934049">)</span>&nbsp;<span class="op" id="1934051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1934055"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1934062">(</span><span class="string" id="1934063">&#34;value&nbsp;size&nbsp;wrong&#34;</span><span class="op" id="1934081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1934084">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1934088">//&nbsp;invariants&nbsp;we&nbsp;depend&nbsp;on.&nbsp;&nbsp;We&nbsp;should&nbsp;probably&nbsp;check&nbsp;these&nbsp;at&nbsp;compile&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1934165">//&nbsp;somewhere,&nbsp;but&nbsp;for&nbsp;now&nbsp;we&#39;ll&nbsp;do&nbsp;it&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1934210">if</span>&nbsp;<span class="ident" id="1934213"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1934214">.</span><span class="ident" id="1934215">key</span><span class="op" id="1934218">.</span><span class="ident" id="1934219">align</span>&nbsp;<span class="op" id="1934225">&gt;</span>&nbsp;<span class="ident" id="1934227"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span>&nbsp;<span class="op" id="1934237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1934241"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1934248">(</span><span class="string" id="1934249">&#34;key&nbsp;align&nbsp;too&nbsp;big&#34;</span><span class="op" id="1934268">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1934271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1934274">if</span>&nbsp;<span class="ident" id="1934277"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1934278">.</span><span class="ident" id="1934279">elem</span><span class="op" id="1934283">.</span><span class="ident" id="1934284">align</span>&nbsp;<span class="op" id="1934290">&gt;</span>&nbsp;<span class="ident" id="1934292"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span>&nbsp;<span class="op" id="1934302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1934306"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1934313">(</span><span class="string" id="1934314">&#34;value&nbsp;align&nbsp;too&nbsp;big&#34;</span><span class="op" id="1934335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1934338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1934341">if</span>&nbsp;<span class="builtintype" id="1934344">uintptr</span><span class="op" id="1934351">(</span><span class="ident" id="1934352"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1934353">.</span><span class="ident" id="1934354">key</span><span class="op" id="1934357">.</span><span class="ident" id="1934358">size</span><span class="op" id="1934362">)</span><span class="op" id="1934363">%</span><span class="builtintype" id="1934364">uintptr</span><span class="op" id="1934371">(</span><span class="ident" id="1934372"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1934373">.</span><span class="ident" id="1934374">key</span><span class="op" id="1934377">.</span><span class="ident" id="1934378">align</span><span class="op" id="1934383">)</span>&nbsp;<span class="op" id="1934385">!=</span>&nbsp;<span class="num" id="1934388">0</span>&nbsp;<span class="op" id="1934390">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1934394"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1934401">(</span><span class="string" id="1934402">&#34;key&nbsp;size&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;key&nbsp;align&#34;</span><span class="op" id="1934440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1934443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1934446">if</span>&nbsp;<span class="builtintype" id="1934449">uintptr</span><span class="op" id="1934456">(</span><span class="ident" id="1934457"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1934458">.</span><span class="ident" id="1934459">elem</span><span class="op" id="1934463">.</span><span class="ident" id="1934464">size</span><span class="op" id="1934468">)</span><span class="op" id="1934469">%</span><span class="builtintype" id="1934470">uintptr</span><span class="op" id="1934477">(</span><span class="ident" id="1934478"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1934479">.</span><span class="ident" id="1934480">elem</span><span class="op" id="1934484">.</span><span class="ident" id="1934485">align</span><span class="op" id="1934490">)</span>&nbsp;<span class="op" id="1934492">!=</span>&nbsp;<span class="num" id="1934495">0</span>&nbsp;<span class="op" id="1934497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1934501"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1934508">(</span><span class="string" id="1934509">&#34;value&nbsp;size&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;value&nbsp;align&#34;</span><span class="op" id="1934551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1934554">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1934557">if</span>&nbsp;<span class="ident" id="1934560"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span>&nbsp;<span class="op" id="1934570">&lt;</span>&nbsp;<span class="num" id="1934572">8</span>&nbsp;<span class="op" id="1934574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1934578"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1934585">(</span><span class="string" id="1934586">&#34;bucketsize&nbsp;too&nbsp;small&nbsp;for&nbsp;proper&nbsp;alignment&#34;</span><span class="op" id="1934629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1934632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1934635">if</span>&nbsp;<span class="ident" id="1934638"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1934648">%</span><span class="builtintype" id="1934649">uintptr</span><span class="op" id="1934656">(</span><span class="ident" id="1934657"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1934658">.</span><span class="ident" id="1934659">key</span><span class="op" id="1934662">.</span><span class="ident" id="1934663">align</span><span class="op" id="1934668">)</span>&nbsp;<span class="op" id="1934670">!=</span>&nbsp;<span class="num" id="1934673">0</span>&nbsp;<span class="op" id="1934675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1934679"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1934686">(</span><span class="string" id="1934687">&#34;need&nbsp;padding&nbsp;in&nbsp;bucket&nbsp;(key)&#34;</span><span class="op" id="1934717">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1934720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1934723">if</span>&nbsp;<span class="ident" id="1934726"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1934736">%</span><span class="builtintype" id="1934737">uintptr</span><span class="op" id="1934744">(</span><span class="ident" id="1934745"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1934746">.</span><span class="ident" id="1934747">elem</span><span class="op" id="1934751">.</span><span class="ident" id="1934752">align</span><span class="op" id="1934757">)</span>&nbsp;<span class="op" id="1934759">!=</span>&nbsp;<span class="num" id="1934762">0</span>&nbsp;<span class="op" id="1934764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1934768"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1934775">(</span><span class="string" id="1934776">&#34;need&nbsp;padding&nbsp;in&nbsp;bucket&nbsp;(value)&#34;</span><span class="op" id="1934808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1934811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1934815">//&nbsp;find&nbsp;size&nbsp;parameter&nbsp;which&nbsp;will&nbsp;hold&nbsp;the&nbsp;requested&nbsp;#&nbsp;of&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1934883">B</span>&nbsp;<span class="op" id="1934885">:=</span>&nbsp;<span class="builtintype" id="1934888">uint8</span><span class="op" id="1934893">(</span><span class="num" id="1934894">0</span><span class="op" id="1934895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1934898">for</span>&nbsp;<span class="op" id="1934902">;</span>&nbsp;<span class="ident" id="1934904"><a href="/runtime/hashmap.go.html#1933290">hint</a></span>&nbsp;<span class="op" id="1934909">&gt;</span>&nbsp;<span class="ident" id="1934911"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span>&nbsp;<span class="op" id="1934921">&amp;&amp;</span>&nbsp;<span class="builtintype" id="1934924">float32</span><span class="op" id="1934931">(</span><span class="ident" id="1934932"><a href="/runtime/hashmap.go.html#1933290">hint</a></span><span class="op" id="1934936">)</span>&nbsp;<span class="op" id="1934938">&gt;</span>&nbsp;<span class="ident" id="1934940"><a href="/runtime/hashmap.go.html#1929693">loadFactor</a></span><span class="op" id="1934950">*</span><span class="builtintype" id="1934951">float32</span><span class="op" id="1934958">(</span><span class="builtintype" id="1934959">uintptr</span><span class="op" id="1934966">(</span><span class="num" id="1934967">1</span><span class="op" id="1934968">)</span><span class="op" id="1934969">&lt;&lt;</span><span class="ident" id="1934971"><a href="/runtime/hashmap.go.html#1934883">B</a></span><span class="op" id="1934972">)</span><span class="op" id="1934973">;</span>&nbsp;<span class="ident" id="1934975"><a href="/runtime/hashmap.go.html#1934883">B</a></span><span class="op" id="1934976">++</span>&nbsp;<span class="op" id="1934979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1934982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1934986">//&nbsp;allocate&nbsp;initial&nbsp;hash&nbsp;table</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1935018">//&nbsp;if&nbsp;B&nbsp;==&nbsp;0,&nbsp;the&nbsp;buckets&nbsp;field&nbsp;is&nbsp;allocated&nbsp;lazily&nbsp;later&nbsp;(in&nbsp;mapassign)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1935092">//&nbsp;If&nbsp;hint&nbsp;is&nbsp;large&nbsp;zeroing&nbsp;this&nbsp;memory&nbsp;could&nbsp;take&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1935153">var</span>&nbsp;<span class="ident" id="1935157">buckets</span>&nbsp;<span class="ident" id="1935165"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1935171">.</span><span class="ident" id="1935172">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1935181">if</span>&nbsp;<span class="ident" id="1935184"><a href="/runtime/hashmap.go.html#1934883">B</a></span>&nbsp;<span class="op" id="1935186">!=</span>&nbsp;<span class="num" id="1935189">0</span>&nbsp;<span class="op" id="1935191">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1935195">if</span>&nbsp;<span class="ident" id="1935198"><a href="/runtime/hashmap.go.html#1931204">checkgc</a></span>&nbsp;<span class="op" id="1935206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935211"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1935219">.</span><span class="ident" id="1935220">next_gc</span>&nbsp;<span class="op" id="1935228">=</span>&nbsp;<span class="ident" id="1935230"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1935238">.</span><span class="ident" id="1935239">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1935252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935256"><a href="/runtime/hashmap.go.html#1935157">buckets</a></span>&nbsp;<span class="op" id="1935264">=</span>&nbsp;<span class="ident" id="1935266"><a href="/runtime/malloc.go.html#1991870">newarray</a></span><span class="op" id="1935274">(</span><span class="ident" id="1935275"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1935276">.</span><span class="ident" id="1935277">bucket</span><span class="op" id="1935283">,</span>&nbsp;<span class="builtintype" id="1935285">uintptr</span><span class="op" id="1935292">(</span><span class="num" id="1935293">1</span><span class="op" id="1935294">)</span><span class="op" id="1935295">&lt;&lt;</span><span class="ident" id="1935297"><a href="/runtime/hashmap.go.html#1934883">B</a></span><span class="op" id="1935298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1935301">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1935305">//&nbsp;initialize&nbsp;Hmap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1935325">if</span>&nbsp;<span class="ident" id="1935328"><a href="/runtime/hashmap.go.html#1931204">checkgc</a></span>&nbsp;<span class="op" id="1935336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935340"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1935348">.</span><span class="ident" id="1935349">next_gc</span>&nbsp;<span class="op" id="1935357">=</span>&nbsp;<span class="ident" id="1935359"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1935367">.</span><span class="ident" id="1935368">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1935380">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935383">h</span>&nbsp;<span class="op" id="1935385">:=</span>&nbsp;<span class="op" id="1935388">(</span><span class="op" id="1935389">*</span><span class="ident" id="1935390"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1935394">)</span><span class="op" id="1935395">(</span><span class="ident" id="1935396"><a href="/runtime/malloc.go.html#1991650">newobject</a></span><span class="op" id="1935405">(</span><span class="ident" id="1935406"><a href="/runtime/hashmap.go.html#1933278">t</a></span><span class="op" id="1935407">.</span><span class="ident" id="1935408">hmap</span><span class="op" id="1935412">)</span><span class="op" id="1935413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935416"><a href="/runtime/hashmap.go.html#1935383">h</a></span><span class="op" id="1935417">.</span><span class="ident" id="1935418">count</span>&nbsp;<span class="op" id="1935424">=</span>&nbsp;<span class="num" id="1935426">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935429"><a href="/runtime/hashmap.go.html#1935383">h</a></span><span class="op" id="1935430">.</span><span class="ident" id="1935431">B</span>&nbsp;<span class="op" id="1935433">=</span>&nbsp;<span class="ident" id="1935435"><a href="/runtime/hashmap.go.html#1934883">B</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935438"><a href="/runtime/hashmap.go.html#1935383">h</a></span><span class="op" id="1935439">.</span><span class="ident" id="1935440">flags</span>&nbsp;<span class="op" id="1935446">=</span>&nbsp;<span class="num" id="1935448">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935451"><a href="/runtime/hashmap.go.html#1935383">h</a></span><span class="op" id="1935452">.</span><span class="ident" id="1935453">hash0</span>&nbsp;<span class="op" id="1935459">=</span>&nbsp;<span class="ident" id="1935461"><a href="/runtime/stubs.go.html#2136047">fastrand1</a></span><span class="op" id="1935470">(</span><span class="op" id="1935471">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935474"><a href="/runtime/hashmap.go.html#1935383">h</a></span><span class="op" id="1935475">.</span><span class="ident" id="1935476">buckets</span>&nbsp;<span class="op" id="1935484">=</span>&nbsp;<span class="ident" id="1935486"><a href="/runtime/hashmap.go.html#1935157">buckets</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935495"><a href="/runtime/hashmap.go.html#1935383">h</a></span><span class="op" id="1935496">.</span><span class="ident" id="1935497">oldbuckets</span>&nbsp;<span class="op" id="1935508">=</span>&nbsp;<span class="ident" id="1935510">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935515"><a href="/runtime/hashmap.go.html#1935383">h</a></span><span class="op" id="1935516">.</span><span class="ident" id="1935517">nevacuate</span>&nbsp;<span class="op" id="1935527">=</span>&nbsp;<span class="num" id="1935529">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1935533">return</span>&nbsp;<span class="ident" id="1935540"><a href="/runtime/hashmap.go.html#1935383">h</a></span><br>
<span class="lineno">230</span><span class="op" id="1935542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1935545">//&nbsp;mapaccess1&nbsp;returns&nbsp;a&nbsp;pointer&nbsp;to&nbsp;h[key].&nbsp;&nbsp;Never&nbsp;returns&nbsp;nil,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="1935616">//&nbsp;it&nbsp;will&nbsp;return&nbsp;a&nbsp;reference&nbsp;to&nbsp;the&nbsp;zero&nbsp;object&nbsp;for&nbsp;the&nbsp;value&nbsp;type&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1935687">//&nbsp;the&nbsp;key&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;map.</span><br>
<span class="lineno">235</span><span class="comment" id="1935717">//&nbsp;NOTE:&nbsp;The&nbsp;returned&nbsp;pointer&nbsp;may&nbsp;keep&nbsp;the&nbsp;whole&nbsp;map&nbsp;live,&nbsp;so&nbsp;don&#39;t</span><br>
<span class="lineno"></span><span class="comment" id="1935785">//&nbsp;hold&nbsp;onto&nbsp;it&nbsp;for&nbsp;very&nbsp;long.</span><br>
<span class="lineno"></span><span class="keyword" id="1935816">func</span>&nbsp;<span class="ident" id="1935821">mapaccess1</span><span class="op" id="1935831">(</span><span class="ident" id="1935832">t</span>&nbsp;<span class="op" id="1935834">*</span><span class="ident" id="1935835"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1935842">,</span>&nbsp;<span class="ident" id="1935844">h</span>&nbsp;<span class="op" id="1935846">*</span><span class="ident" id="1935847"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1935851">,</span>&nbsp;<span class="ident" id="1935853">key</span>&nbsp;<span class="ident" id="1935857"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1935863">.</span><span class="ident" id="1935864">Pointer</span><span class="op" id="1935871">)</span>&nbsp;<span class="ident" id="1935873"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1935879">.</span><span class="ident" id="1935880">Pointer</span>&nbsp;<span class="op" id="1935888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1935891">if</span>&nbsp;<span class="ident" id="1935894"><a href="/runtime/race0.go.html#2069616">raceenabled</a></span>&nbsp;<span class="op" id="1935906">&amp;&amp;</span>&nbsp;<span class="ident" id="1935909"><a href="/runtime/hashmap.go.html#1935844">h</a></span>&nbsp;<span class="op" id="1935911">!=</span>&nbsp;<span class="ident" id="1935914">nil</span>&nbsp;<span class="op" id="1935918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935922">callerpc</span>&nbsp;<span class="op" id="1935931">:=</span>&nbsp;<span class="ident" id="1935934"><a href="/runtime/stubs.go.html#2139499">getcallerpc</a></span><span class="op" id="1935945">(</span><span class="ident" id="1935946"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1935952">.</span><span class="ident" id="1935953">Pointer</span><span class="op" id="1935960">(</span><span class="op" id="1935961">&amp;</span><span class="ident" id="1935962"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1935963">)</span><span class="op" id="1935964">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935968">pc</span>&nbsp;<span class="op" id="1935971">:=</span>&nbsp;<span class="ident" id="1935974"><a href="/runtime/proc.go.html#2068560">funcPC</a></span><span class="op" id="1935980">(</span><span class="ident" id="1935981"><a href="/runtime/hashmap.go.html#1935821">mapaccess1</a></span><span class="op" id="1935991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1935995"><a href="/runtime/race0.go.html#2070294">racereadpc</a></span><span class="op" id="1936005">(</span><span class="ident" id="1936006"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1936012">.</span><span class="ident" id="1936013">Pointer</span><span class="op" id="1936020">(</span><span class="ident" id="1936021"><a href="/runtime/hashmap.go.html#1935844">h</a></span><span class="op" id="1936022">)</span><span class="op" id="1936023">,</span>&nbsp;<span class="ident" id="1936025"><a href="/runtime/hashmap.go.html#1935922">callerpc</a></span><span class="op" id="1936033">,</span>&nbsp;<span class="ident" id="1936035"><a href="/runtime/hashmap.go.html#1935968">pc</a></span><span class="op" id="1936037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936041"><a href="/runtime/race0.go.html#2069718">raceReadObjectPC</a></span><span class="op" id="1936057">(</span><span class="ident" id="1936058"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1936059">.</span><span class="ident" id="1936060">key</span><span class="op" id="1936063">,</span>&nbsp;<span class="ident" id="1936065"><a href="/runtime/hashmap.go.html#1935853">key</a></span><span class="op" id="1936068">,</span>&nbsp;<span class="ident" id="1936070"><a href="/runtime/hashmap.go.html#1935922">callerpc</a></span><span class="op" id="1936078">,</span>&nbsp;<span class="ident" id="1936080"><a href="/runtime/hashmap.go.html#1935968">pc</a></span><span class="op" id="1936082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1936085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936088">if</span>&nbsp;<span class="ident" id="1936091"><a href="/runtime/hashmap.go.html#1935844">h</a></span>&nbsp;<span class="op" id="1936093">==</span>&nbsp;<span class="ident" id="1936096">nil</span>&nbsp;<span class="op" id="1936100">||</span>&nbsp;<span class="ident" id="1936103"><a href="/runtime/hashmap.go.html#1935844">h</a></span><span class="op" id="1936104">.</span><span class="ident" id="1936105">count</span>&nbsp;<span class="op" id="1936111">==</span>&nbsp;<span class="num" id="1936114">0</span>&nbsp;<span class="op" id="1936116">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936120">return</span>&nbsp;<span class="ident" id="1936127"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1936133">.</span><span class="ident" id="1936134">Pointer</span><span class="op" id="1936141">(</span><span class="ident" id="1936142"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1936143">.</span><span class="ident" id="1936144">elem</span><span class="op" id="1936148">.</span><span class="ident" id="1936149">zero</span><span class="op" id="1936153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1936156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936159">alg</span>&nbsp;<span class="op" id="1936163">:=</span>&nbsp;<span class="ident" id="1936166"><a href="/runtime/alg.go.html#1872365">goalg</a></span><span class="op" id="1936171">(</span><span class="ident" id="1936172"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1936173">.</span><span class="ident" id="1936174">key</span><span class="op" id="1936177">.</span><span class="ident" id="1936178">alg</span><span class="op" id="1936181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936184">hash</span>&nbsp;<span class="op" id="1936189">:=</span>&nbsp;<span class="ident" id="1936192"><a href="/runtime/hashmap.go.html#1936159">alg</a></span><span class="op" id="1936195">.</span><span class="ident" id="1936196">hash</span><span class="op" id="1936200">(</span><span class="ident" id="1936201"><a href="/runtime/hashmap.go.html#1935853">key</a></span><span class="op" id="1936204">,</span>&nbsp;<span class="builtintype" id="1936206">uintptr</span><span class="op" id="1936213">(</span><span class="ident" id="1936214"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1936215">.</span><span class="ident" id="1936216">key</span><span class="op" id="1936219">.</span><span class="ident" id="1936220">size</span><span class="op" id="1936224">)</span><span class="op" id="1936225">,</span>&nbsp;<span class="builtintype" id="1936227">uintptr</span><span class="op" id="1936234">(</span><span class="ident" id="1936235"><a href="/runtime/hashmap.go.html#1935844">h</a></span><span class="op" id="1936236">.</span><span class="ident" id="1936237">hash0</span><span class="op" id="1936242">)</span><span class="op" id="1936243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936246">m</span>&nbsp;<span class="op" id="1936248">:=</span>&nbsp;<span class="builtintype" id="1936251">uintptr</span><span class="op" id="1936258">(</span><span class="num" id="1936259">1</span><span class="op" id="1936260">)</span><span class="op" id="1936261">&lt;&lt;</span><span class="ident" id="1936263"><a href="/runtime/hashmap.go.html#1935844">h</a></span><span class="op" id="1936264">.</span><span class="ident" id="1936265">B</span>&nbsp;<span class="op" id="1936267">-</span>&nbsp;<span class="num" id="1936269">1</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936272">b</span>&nbsp;<span class="op" id="1936274">:=</span>&nbsp;<span class="op" id="1936277">(</span><span class="op" id="1936278">*</span><span class="ident" id="1936279"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1936283">)</span><span class="op" id="1936284">(</span><span class="ident" id="1936285"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1936288">(</span><span class="ident" id="1936289"><a href="/runtime/hashmap.go.html#1935844">h</a></span><span class="op" id="1936290">.</span><span class="ident" id="1936291">buckets</span><span class="op" id="1936298">,</span>&nbsp;<span class="op" id="1936300">(</span><span class="ident" id="1936301"><a href="/runtime/hashmap.go.html#1936184">hash</a></span><span class="op" id="1936305">&amp;</span><span class="ident" id="1936306"><a href="/runtime/hashmap.go.html#1936246">m</a></span><span class="op" id="1936307">)</span><span class="op" id="1936308">*</span><span class="builtintype" id="1936309">uintptr</span><span class="op" id="1936316">(</span><span class="ident" id="1936317"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1936318">.</span><span class="ident" id="1936319">bucketsize</span><span class="op" id="1936329">)</span><span class="op" id="1936330">)</span><span class="op" id="1936331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936334">if</span>&nbsp;<span class="ident" id="1936337">c</span>&nbsp;<span class="op" id="1936339">:=</span>&nbsp;<span class="ident" id="1936342"><a href="/runtime/hashmap.go.html#1935844">h</a></span><span class="op" id="1936343">.</span><span class="ident" id="1936344">oldbuckets</span><span class="op" id="1936354">;</span>&nbsp;<span class="ident" id="1936356"><a href="/runtime/hashmap.go.html#1936337">c</a></span>&nbsp;<span class="op" id="1936358">!=</span>&nbsp;<span class="ident" id="1936361">nil</span>&nbsp;<span class="op" id="1936365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936369">oldb</span>&nbsp;<span class="op" id="1936374">:=</span>&nbsp;<span class="op" id="1936377">(</span><span class="op" id="1936378">*</span><span class="ident" id="1936379"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1936383">)</span><span class="op" id="1936384">(</span><span class="ident" id="1936385"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1936388">(</span><span class="ident" id="1936389"><a href="/runtime/hashmap.go.html#1936337">c</a></span><span class="op" id="1936390">,</span>&nbsp;<span class="op" id="1936392">(</span><span class="ident" id="1936393"><a href="/runtime/hashmap.go.html#1936184">hash</a></span><span class="op" id="1936397">&amp;</span><span class="op" id="1936398">(</span><span class="ident" id="1936399"><a href="/runtime/hashmap.go.html#1936246">m</a></span><span class="op" id="1936400">&gt;&gt;</span><span class="num" id="1936402">1</span><span class="op" id="1936403">)</span><span class="op" id="1936404">)</span><span class="op" id="1936405">*</span><span class="builtintype" id="1936406">uintptr</span><span class="op" id="1936413">(</span><span class="ident" id="1936414"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1936415">.</span><span class="ident" id="1936416">bucketsize</span><span class="op" id="1936426">)</span><span class="op" id="1936427">)</span><span class="op" id="1936428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936432">if</span>&nbsp;<span class="op" id="1936435">!</span><span class="ident" id="1936436"><a href="/runtime/hashmap.go.html#1933181">evacuated</a></span><span class="op" id="1936445">(</span><span class="ident" id="1936446"><a href="/runtime/hashmap.go.html#1936369">oldb</a></span><span class="op" id="1936450">)</span>&nbsp;<span class="op" id="1936452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936457"><a href="/runtime/hashmap.go.html#1936272">b</a></span>&nbsp;<span class="op" id="1936459">=</span>&nbsp;<span class="ident" id="1936461"><a href="/runtime/hashmap.go.html#1936369">oldb</a></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1936468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1936471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936474">top</span>&nbsp;<span class="op" id="1936478">:=</span>&nbsp;<span class="builtintype" id="1936481">uint8</span><span class="op" id="1936486">(</span><span class="ident" id="1936487"><a href="/runtime/hashmap.go.html#1936184">hash</a></span>&nbsp;<span class="op" id="1936492">&gt;&gt;</span>&nbsp;<span class="op" id="1936495">(</span><span class="ident" id="1936496"><a href="/runtime/stubs.go.html#2131510">ptrSize</a></span><span class="op" id="1936503">*</span><span class="num" id="1936504">8</span>&nbsp;<span class="op" id="1936506">-</span>&nbsp;<span class="num" id="1936508">8</span><span class="op" id="1936509">)</span><span class="op" id="1936510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936513">if</span>&nbsp;<span class="ident" id="1936516"><a href="/runtime/hashmap.go.html#1936474">top</a></span>&nbsp;<span class="op" id="1936520">&lt;</span>&nbsp;<span class="ident" id="1936522"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span>&nbsp;<span class="op" id="1936533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936537"><a href="/runtime/hashmap.go.html#1936474">top</a></span>&nbsp;<span class="op" id="1936541">+=</span>&nbsp;<span class="ident" id="1936544"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1936556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936559">for</span>&nbsp;<span class="op" id="1936563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936567">for</span>&nbsp;<span class="ident" id="1936571">i</span>&nbsp;<span class="op" id="1936573">:=</span>&nbsp;<span class="builtintype" id="1936576">uintptr</span><span class="op" id="1936583">(</span><span class="num" id="1936584">0</span><span class="op" id="1936585">)</span><span class="op" id="1936586">;</span>&nbsp;<span class="ident" id="1936588"><a href="/runtime/hashmap.go.html#1936571">i</a></span>&nbsp;<span class="op" id="1936590">&lt;</span>&nbsp;<span class="ident" id="1936592"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1936601">;</span>&nbsp;<span class="ident" id="1936603"><a href="/runtime/hashmap.go.html#1936571">i</a></span><span class="op" id="1936604">++</span>&nbsp;<span class="op" id="1936607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936612">if</span>&nbsp;<span class="ident" id="1936615"><a href="/runtime/hashmap.go.html#1936272">b</a></span><span class="op" id="1936616">.</span><span class="ident" id="1936617">tophash</span><span class="op" id="1936624">[</span><span class="ident" id="1936625"><a href="/runtime/hashmap.go.html#1936571">i</a></span><span class="op" id="1936626">]</span>&nbsp;<span class="op" id="1936628">!=</span>&nbsp;<span class="ident" id="1936631"><a href="/runtime/hashmap.go.html#1936474">top</a></span>&nbsp;<span class="op" id="1936635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936641">continue</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1936653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936658">k</span>&nbsp;<span class="op" id="1936660">:=</span>&nbsp;<span class="ident" id="1936663"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1936666">(</span><span class="ident" id="1936667"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1936673">.</span><span class="ident" id="1936674">Pointer</span><span class="op" id="1936681">(</span><span class="ident" id="1936682"><a href="/runtime/hashmap.go.html#1936272">b</a></span><span class="op" id="1936683">)</span><span class="op" id="1936684">,</span>&nbsp;<span class="ident" id="1936686"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1936696">+</span><span class="ident" id="1936697"><a href="/runtime/hashmap.go.html#1936571">i</a></span><span class="op" id="1936698">*</span><span class="builtintype" id="1936699">uintptr</span><span class="op" id="1936706">(</span><span class="ident" id="1936707"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1936708">.</span><span class="ident" id="1936709">keysize</span><span class="op" id="1936716">)</span><span class="op" id="1936717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936722">if</span>&nbsp;<span class="ident" id="1936725"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1936726">.</span><span class="ident" id="1936727">indirectkey</span>&nbsp;<span class="op" id="1936739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936745"><a href="/runtime/hashmap.go.html#1936658">k</a></span>&nbsp;<span class="op" id="1936747">=</span>&nbsp;<span class="op" id="1936749">*</span><span class="op" id="1936750">(</span><span class="op" id="1936751">(</span><span class="op" id="1936752">*</span><span class="ident" id="1936753"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1936759">.</span><span class="ident" id="1936760">Pointer</span><span class="op" id="1936767">)</span><span class="op" id="1936768">(</span><span class="ident" id="1936769"><a href="/runtime/hashmap.go.html#1936658">k</a></span><span class="op" id="1936770">)</span><span class="op" id="1936771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1936776">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936781">if</span>&nbsp;<span class="ident" id="1936784"><a href="/runtime/hashmap.go.html#1936159">alg</a></span><span class="op" id="1936787">.</span><span class="ident" id="1936788">equal</span><span class="op" id="1936793">(</span><span class="ident" id="1936794"><a href="/runtime/hashmap.go.html#1935853">key</a></span><span class="op" id="1936797">,</span>&nbsp;<span class="ident" id="1936799"><a href="/runtime/hashmap.go.html#1936658">k</a></span><span class="op" id="1936800">,</span>&nbsp;<span class="builtintype" id="1936802">uintptr</span><span class="op" id="1936809">(</span><span class="ident" id="1936810"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1936811">.</span><span class="ident" id="1936812">key</span><span class="op" id="1936815">.</span><span class="ident" id="1936816">size</span><span class="op" id="1936820">)</span><span class="op" id="1936821">)</span>&nbsp;<span class="op" id="1936823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936829">v</span>&nbsp;<span class="op" id="1936831">:=</span>&nbsp;<span class="ident" id="1936834"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1936837">(</span><span class="ident" id="1936838"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1936844">.</span><span class="ident" id="1936845">Pointer</span><span class="op" id="1936852">(</span><span class="ident" id="1936853"><a href="/runtime/hashmap.go.html#1936272">b</a></span><span class="op" id="1936854">)</span><span class="op" id="1936855">,</span>&nbsp;<span class="ident" id="1936857"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1936867">+</span><span class="ident" id="1936868"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1936877">*</span><span class="builtintype" id="1936878">uintptr</span><span class="op" id="1936885">(</span><span class="ident" id="1936886"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1936887">.</span><span class="ident" id="1936888">keysize</span><span class="op" id="1936895">)</span><span class="op" id="1936896">+</span><span class="ident" id="1936897"><a href="/runtime/hashmap.go.html#1936571">i</a></span><span class="op" id="1936898">*</span><span class="builtintype" id="1936899">uintptr</span><span class="op" id="1936906">(</span><span class="ident" id="1936907"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1936908">.</span><span class="ident" id="1936909">valuesize</span><span class="op" id="1936918">)</span><span class="op" id="1936919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936925">if</span>&nbsp;<span class="ident" id="1936928"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1936929">.</span><span class="ident" id="1936930">indirectvalue</span>&nbsp;<span class="op" id="1936944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1936951"><a href="/runtime/hashmap.go.html#1936829">v</a></span>&nbsp;<span class="op" id="1936953">=</span>&nbsp;<span class="op" id="1936955">*</span><span class="op" id="1936956">(</span><span class="op" id="1936957">(</span><span class="op" id="1936958">*</span><span class="ident" id="1936959"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1936965">.</span><span class="ident" id="1936966">Pointer</span><span class="op" id="1936973">)</span><span class="op" id="1936974">(</span><span class="ident" id="1936975"><a href="/runtime/hashmap.go.html#1936829">v</a></span><span class="op" id="1936976">)</span><span class="op" id="1936977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1936983">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1936989">return</span>&nbsp;<span class="ident" id="1936996"><a href="/runtime/hashmap.go.html#1936829">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937009"><a href="/runtime/hashmap.go.html#1936272">b</a></span>&nbsp;<span class="op" id="1937011">=</span>&nbsp;<span class="ident" id="1937013"><a href="/runtime/hashmap.go.html#1936272">b</a></span><span class="op" id="1937014">.</span><span class="ident" id="1937015">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937026">if</span>&nbsp;<span class="ident" id="1937029"><a href="/runtime/hashmap.go.html#1936272">b</a></span>&nbsp;<span class="op" id="1937031">==</span>&nbsp;<span class="ident" id="1937034">nil</span>&nbsp;<span class="op" id="1937038">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937043">return</span>&nbsp;<span class="ident" id="1937050"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1937056">.</span><span class="ident" id="1937057">Pointer</span><span class="op" id="1937064">(</span><span class="ident" id="1937065"><a href="/runtime/hashmap.go.html#1935832">t</a></span><span class="op" id="1937066">.</span><span class="ident" id="1937067">elem</span><span class="op" id="1937071">.</span><span class="ident" id="1937072">zero</span><span class="op" id="1937076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937083">}</span><br>
<span class="lineno"></span><span class="op" id="1937085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="1937088">func</span>&nbsp;<span class="ident" id="1937093">mapaccess2</span><span class="op" id="1937103">(</span><span class="ident" id="1937104">t</span>&nbsp;<span class="op" id="1937106">*</span><span class="ident" id="1937107"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1937114">,</span>&nbsp;<span class="ident" id="1937116">h</span>&nbsp;<span class="op" id="1937118">*</span><span class="ident" id="1937119"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1937123">,</span>&nbsp;<span class="ident" id="1937125">key</span>&nbsp;<span class="ident" id="1937129"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1937135">.</span><span class="ident" id="1937136">Pointer</span><span class="op" id="1937143">)</span>&nbsp;<span class="op" id="1937145">(</span><span class="ident" id="1937146"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1937152">.</span><span class="ident" id="1937153">Pointer</span><span class="op" id="1937160">,</span>&nbsp;<span class="builtintype" id="1937162">bool</span><span class="op" id="1937166">)</span>&nbsp;<span class="op" id="1937168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937171">if</span>&nbsp;<span class="ident" id="1937174"><a href="/runtime/race0.go.html#2069616">raceenabled</a></span>&nbsp;<span class="op" id="1937186">&amp;&amp;</span>&nbsp;<span class="ident" id="1937189"><a href="/runtime/hashmap.go.html#1937116">h</a></span>&nbsp;<span class="op" id="1937191">!=</span>&nbsp;<span class="ident" id="1937194">nil</span>&nbsp;<span class="op" id="1937198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937202">callerpc</span>&nbsp;<span class="op" id="1937211">:=</span>&nbsp;<span class="ident" id="1937214"><a href="/runtime/stubs.go.html#2139499">getcallerpc</a></span><span class="op" id="1937225">(</span><span class="ident" id="1937226"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1937232">.</span><span class="ident" id="1937233">Pointer</span><span class="op" id="1937240">(</span><span class="op" id="1937241">&amp;</span><span class="ident" id="1937242"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1937243">)</span><span class="op" id="1937244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937248">pc</span>&nbsp;<span class="op" id="1937251">:=</span>&nbsp;<span class="ident" id="1937254"><a href="/runtime/proc.go.html#2068560">funcPC</a></span><span class="op" id="1937260">(</span><span class="ident" id="1937261"><a href="/runtime/hashmap.go.html#1937093">mapaccess2</a></span><span class="op" id="1937271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937275"><a href="/runtime/race0.go.html#2070294">racereadpc</a></span><span class="op" id="1937285">(</span><span class="ident" id="1937286"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1937292">.</span><span class="ident" id="1937293">Pointer</span><span class="op" id="1937300">(</span><span class="ident" id="1937301"><a href="/runtime/hashmap.go.html#1937116">h</a></span><span class="op" id="1937302">)</span><span class="op" id="1937303">,</span>&nbsp;<span class="ident" id="1937305"><a href="/runtime/hashmap.go.html#1937202">callerpc</a></span><span class="op" id="1937313">,</span>&nbsp;<span class="ident" id="1937315"><a href="/runtime/hashmap.go.html#1937248">pc</a></span><span class="op" id="1937317">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937321"><a href="/runtime/race0.go.html#2069718">raceReadObjectPC</a></span><span class="op" id="1937337">(</span><span class="ident" id="1937338"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1937339">.</span><span class="ident" id="1937340">key</span><span class="op" id="1937343">,</span>&nbsp;<span class="ident" id="1937345"><a href="/runtime/hashmap.go.html#1937125">key</a></span><span class="op" id="1937348">,</span>&nbsp;<span class="ident" id="1937350"><a href="/runtime/hashmap.go.html#1937202">callerpc</a></span><span class="op" id="1937358">,</span>&nbsp;<span class="ident" id="1937360"><a href="/runtime/hashmap.go.html#1937248">pc</a></span><span class="op" id="1937362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937368">if</span>&nbsp;<span class="ident" id="1937371"><a href="/runtime/hashmap.go.html#1937116">h</a></span>&nbsp;<span class="op" id="1937373">==</span>&nbsp;<span class="ident" id="1937376">nil</span>&nbsp;<span class="op" id="1937380">||</span>&nbsp;<span class="ident" id="1937383"><a href="/runtime/hashmap.go.html#1937116">h</a></span><span class="op" id="1937384">.</span><span class="ident" id="1937385">count</span>&nbsp;<span class="op" id="1937391">==</span>&nbsp;<span class="num" id="1937394">0</span>&nbsp;<span class="op" id="1937396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937400">return</span>&nbsp;<span class="ident" id="1937407"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1937413">.</span><span class="ident" id="1937414">Pointer</span><span class="op" id="1937421">(</span><span class="ident" id="1937422"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1937423">.</span><span class="ident" id="1937424">elem</span><span class="op" id="1937428">.</span><span class="ident" id="1937429">zero</span><span class="op" id="1937433">)</span><span class="op" id="1937434">,</span>&nbsp;<span class="builtintype" id="1937436">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937443">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937446">alg</span>&nbsp;<span class="op" id="1937450">:=</span>&nbsp;<span class="ident" id="1937453"><a href="/runtime/alg.go.html#1872365">goalg</a></span><span class="op" id="1937458">(</span><span class="ident" id="1937459"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1937460">.</span><span class="ident" id="1937461">key</span><span class="op" id="1937464">.</span><span class="ident" id="1937465">alg</span><span class="op" id="1937468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937471">hash</span>&nbsp;<span class="op" id="1937476">:=</span>&nbsp;<span class="ident" id="1937479"><a href="/runtime/hashmap.go.html#1937446">alg</a></span><span class="op" id="1937482">.</span><span class="ident" id="1937483">hash</span><span class="op" id="1937487">(</span><span class="ident" id="1937488"><a href="/runtime/hashmap.go.html#1937125">key</a></span><span class="op" id="1937491">,</span>&nbsp;<span class="builtintype" id="1937493">uintptr</span><span class="op" id="1937500">(</span><span class="ident" id="1937501"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1937502">.</span><span class="ident" id="1937503">key</span><span class="op" id="1937506">.</span><span class="ident" id="1937507">size</span><span class="op" id="1937511">)</span><span class="op" id="1937512">,</span>&nbsp;<span class="builtintype" id="1937514">uintptr</span><span class="op" id="1937521">(</span><span class="ident" id="1937522"><a href="/runtime/hashmap.go.html#1937116">h</a></span><span class="op" id="1937523">.</span><span class="ident" id="1937524">hash0</span><span class="op" id="1937529">)</span><span class="op" id="1937530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937533">m</span>&nbsp;<span class="op" id="1937535">:=</span>&nbsp;<span class="builtintype" id="1937538">uintptr</span><span class="op" id="1937545">(</span><span class="num" id="1937546">1</span><span class="op" id="1937547">)</span><span class="op" id="1937548">&lt;&lt;</span><span class="ident" id="1937550"><a href="/runtime/hashmap.go.html#1937116">h</a></span><span class="op" id="1937551">.</span><span class="ident" id="1937552">B</span>&nbsp;<span class="op" id="1937554">-</span>&nbsp;<span class="num" id="1937556">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937559">b</span>&nbsp;<span class="op" id="1937561">:=</span>&nbsp;<span class="op" id="1937564">(</span><span class="op" id="1937565">*</span><span class="ident" id="1937566"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1937570">)</span><span class="op" id="1937571">(</span><span class="ident" id="1937572"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1937578">.</span><span class="ident" id="1937579">Pointer</span><span class="op" id="1937586">(</span><span class="builtintype" id="1937587">uintptr</span><span class="op" id="1937594">(</span><span class="ident" id="1937595"><a href="/runtime/hashmap.go.html#1937116">h</a></span><span class="op" id="1937596">.</span><span class="ident" id="1937597">buckets</span><span class="op" id="1937604">)</span>&nbsp;<span class="op" id="1937606">+</span>&nbsp;<span class="op" id="1937608">(</span><span class="ident" id="1937609"><a href="/runtime/hashmap.go.html#1937471">hash</a></span><span class="op" id="1937613">&amp;</span><span class="ident" id="1937614"><a href="/runtime/hashmap.go.html#1937533">m</a></span><span class="op" id="1937615">)</span><span class="op" id="1937616">*</span><span class="builtintype" id="1937617">uintptr</span><span class="op" id="1937624">(</span><span class="ident" id="1937625"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1937626">.</span><span class="ident" id="1937627">bucketsize</span><span class="op" id="1937637">)</span><span class="op" id="1937638">)</span><span class="op" id="1937639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937642">if</span>&nbsp;<span class="ident" id="1937645">c</span>&nbsp;<span class="op" id="1937647">:=</span>&nbsp;<span class="ident" id="1937650"><a href="/runtime/hashmap.go.html#1937116">h</a></span><span class="op" id="1937651">.</span><span class="ident" id="1937652">oldbuckets</span><span class="op" id="1937662">;</span>&nbsp;<span class="ident" id="1937664"><a href="/runtime/hashmap.go.html#1937645">c</a></span>&nbsp;<span class="op" id="1937666">!=</span>&nbsp;<span class="ident" id="1937669">nil</span>&nbsp;<span class="op" id="1937673">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937677">oldb</span>&nbsp;<span class="op" id="1937682">:=</span>&nbsp;<span class="op" id="1937685">(</span><span class="op" id="1937686">*</span><span class="ident" id="1937687"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1937691">)</span><span class="op" id="1937692">(</span><span class="ident" id="1937693"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1937699">.</span><span class="ident" id="1937700">Pointer</span><span class="op" id="1937707">(</span><span class="builtintype" id="1937708">uintptr</span><span class="op" id="1937715">(</span><span class="ident" id="1937716"><a href="/runtime/hashmap.go.html#1937645">c</a></span><span class="op" id="1937717">)</span>&nbsp;<span class="op" id="1937719">+</span>&nbsp;<span class="op" id="1937721">(</span><span class="ident" id="1937722"><a href="/runtime/hashmap.go.html#1937471">hash</a></span><span class="op" id="1937726">&amp;</span><span class="op" id="1937727">(</span><span class="ident" id="1937728"><a href="/runtime/hashmap.go.html#1937533">m</a></span><span class="op" id="1937729">&gt;&gt;</span><span class="num" id="1937731">1</span><span class="op" id="1937732">)</span><span class="op" id="1937733">)</span><span class="op" id="1937734">*</span><span class="builtintype" id="1937735">uintptr</span><span class="op" id="1937742">(</span><span class="ident" id="1937743"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1937744">.</span><span class="ident" id="1937745">bucketsize</span><span class="op" id="1937755">)</span><span class="op" id="1937756">)</span><span class="op" id="1937757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937761">if</span>&nbsp;<span class="op" id="1937764">!</span><span class="ident" id="1937765"><a href="/runtime/hashmap.go.html#1933181">evacuated</a></span><span class="op" id="1937774">(</span><span class="ident" id="1937775"><a href="/runtime/hashmap.go.html#1937677">oldb</a></span><span class="op" id="1937779">)</span>&nbsp;<span class="op" id="1937781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937786"><a href="/runtime/hashmap.go.html#1937559">b</a></span>&nbsp;<span class="op" id="1937788">=</span>&nbsp;<span class="ident" id="1937790"><a href="/runtime/hashmap.go.html#1937677">oldb</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937800">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937803">top</span>&nbsp;<span class="op" id="1937807">:=</span>&nbsp;<span class="builtintype" id="1937810">uint8</span><span class="op" id="1937815">(</span><span class="ident" id="1937816"><a href="/runtime/hashmap.go.html#1937471">hash</a></span>&nbsp;<span class="op" id="1937821">&gt;&gt;</span>&nbsp;<span class="op" id="1937824">(</span><span class="ident" id="1937825"><a href="/runtime/stubs.go.html#2131510">ptrSize</a></span><span class="op" id="1937832">*</span><span class="num" id="1937833">8</span>&nbsp;<span class="op" id="1937835">-</span>&nbsp;<span class="num" id="1937837">8</span><span class="op" id="1937838">)</span><span class="op" id="1937839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937842">if</span>&nbsp;<span class="ident" id="1937845"><a href="/runtime/hashmap.go.html#1937803">top</a></span>&nbsp;<span class="op" id="1937849">&lt;</span>&nbsp;<span class="ident" id="1937851"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span>&nbsp;<span class="op" id="1937862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937866"><a href="/runtime/hashmap.go.html#1937803">top</a></span>&nbsp;<span class="op" id="1937870">+=</span>&nbsp;<span class="ident" id="1937873"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937888">for</span>&nbsp;<span class="op" id="1937892">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937896">for</span>&nbsp;<span class="ident" id="1937900">i</span>&nbsp;<span class="op" id="1937902">:=</span>&nbsp;<span class="builtintype" id="1937905">uintptr</span><span class="op" id="1937912">(</span><span class="num" id="1937913">0</span><span class="op" id="1937914">)</span><span class="op" id="1937915">;</span>&nbsp;<span class="ident" id="1937917"><a href="/runtime/hashmap.go.html#1937900">i</a></span>&nbsp;<span class="op" id="1937919">&lt;</span>&nbsp;<span class="ident" id="1937921"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1937930">;</span>&nbsp;<span class="ident" id="1937932"><a href="/runtime/hashmap.go.html#1937900">i</a></span><span class="op" id="1937933">++</span>&nbsp;<span class="op" id="1937936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937941">if</span>&nbsp;<span class="ident" id="1937944"><a href="/runtime/hashmap.go.html#1937559">b</a></span><span class="op" id="1937945">.</span><span class="ident" id="1937946">tophash</span><span class="op" id="1937953">[</span><span class="ident" id="1937954"><a href="/runtime/hashmap.go.html#1937900">i</a></span><span class="op" id="1937955">]</span>&nbsp;<span class="op" id="1937957">!=</span>&nbsp;<span class="ident" id="1937960"><a href="/runtime/hashmap.go.html#1937803">top</a></span>&nbsp;<span class="op" id="1937964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1937970">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1937982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1937987">k</span>&nbsp;<span class="op" id="1937989">:=</span>&nbsp;<span class="ident" id="1937992"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1937995">(</span><span class="ident" id="1937996"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1938002">.</span><span class="ident" id="1938003">Pointer</span><span class="op" id="1938010">(</span><span class="ident" id="1938011"><a href="/runtime/hashmap.go.html#1937559">b</a></span><span class="op" id="1938012">)</span><span class="op" id="1938013">,</span>&nbsp;<span class="ident" id="1938015"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1938025">+</span><span class="ident" id="1938026"><a href="/runtime/hashmap.go.html#1937900">i</a></span><span class="op" id="1938027">*</span><span class="builtintype" id="1938028">uintptr</span><span class="op" id="1938035">(</span><span class="ident" id="1938036"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1938037">.</span><span class="ident" id="1938038">keysize</span><span class="op" id="1938045">)</span><span class="op" id="1938046">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938051">if</span>&nbsp;<span class="ident" id="1938054"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1938055">.</span><span class="ident" id="1938056">indirectkey</span>&nbsp;<span class="op" id="1938068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938074"><a href="/runtime/hashmap.go.html#1937987">k</a></span>&nbsp;<span class="op" id="1938076">=</span>&nbsp;<span class="op" id="1938078">*</span><span class="op" id="1938079">(</span><span class="op" id="1938080">(</span><span class="op" id="1938081">*</span><span class="ident" id="1938082"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1938088">.</span><span class="ident" id="1938089">Pointer</span><span class="op" id="1938096">)</span><span class="op" id="1938097">(</span><span class="ident" id="1938098"><a href="/runtime/hashmap.go.html#1937987">k</a></span><span class="op" id="1938099">)</span><span class="op" id="1938100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938110">if</span>&nbsp;<span class="ident" id="1938113"><a href="/runtime/hashmap.go.html#1937446">alg</a></span><span class="op" id="1938116">.</span><span class="ident" id="1938117">equal</span><span class="op" id="1938122">(</span><span class="ident" id="1938123"><a href="/runtime/hashmap.go.html#1937125">key</a></span><span class="op" id="1938126">,</span>&nbsp;<span class="ident" id="1938128"><a href="/runtime/hashmap.go.html#1937987">k</a></span><span class="op" id="1938129">,</span>&nbsp;<span class="builtintype" id="1938131">uintptr</span><span class="op" id="1938138">(</span><span class="ident" id="1938139"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1938140">.</span><span class="ident" id="1938141">key</span><span class="op" id="1938144">.</span><span class="ident" id="1938145">size</span><span class="op" id="1938149">)</span><span class="op" id="1938150">)</span>&nbsp;<span class="op" id="1938152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938158">v</span>&nbsp;<span class="op" id="1938160">:=</span>&nbsp;<span class="ident" id="1938163"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1938166">(</span><span class="ident" id="1938167"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1938173">.</span><span class="ident" id="1938174">Pointer</span><span class="op" id="1938181">(</span><span class="ident" id="1938182"><a href="/runtime/hashmap.go.html#1937559">b</a></span><span class="op" id="1938183">)</span><span class="op" id="1938184">,</span>&nbsp;<span class="ident" id="1938186"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1938196">+</span><span class="ident" id="1938197"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1938206">*</span><span class="builtintype" id="1938207">uintptr</span><span class="op" id="1938214">(</span><span class="ident" id="1938215"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1938216">.</span><span class="ident" id="1938217">keysize</span><span class="op" id="1938224">)</span><span class="op" id="1938225">+</span><span class="ident" id="1938226"><a href="/runtime/hashmap.go.html#1937900">i</a></span><span class="op" id="1938227">*</span><span class="builtintype" id="1938228">uintptr</span><span class="op" id="1938235">(</span><span class="ident" id="1938236"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1938237">.</span><span class="ident" id="1938238">valuesize</span><span class="op" id="1938247">)</span><span class="op" id="1938248">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938254">if</span>&nbsp;<span class="ident" id="1938257"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1938258">.</span><span class="ident" id="1938259">indirectvalue</span>&nbsp;<span class="op" id="1938273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938280"><a href="/runtime/hashmap.go.html#1938158">v</a></span>&nbsp;<span class="op" id="1938282">=</span>&nbsp;<span class="op" id="1938284">*</span><span class="op" id="1938285">(</span><span class="op" id="1938286">(</span><span class="op" id="1938287">*</span><span class="ident" id="1938288"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1938294">.</span><span class="ident" id="1938295">Pointer</span><span class="op" id="1938302">)</span><span class="op" id="1938303">(</span><span class="ident" id="1938304"><a href="/runtime/hashmap.go.html#1938158">v</a></span><span class="op" id="1938305">)</span><span class="op" id="1938306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938318">return</span>&nbsp;<span class="ident" id="1938325"><a href="/runtime/hashmap.go.html#1938158">v</a></span><span class="op" id="1938326">,</span>&nbsp;<span class="builtintype" id="1938328">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938336">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938344"><a href="/runtime/hashmap.go.html#1937559">b</a></span>&nbsp;<span class="op" id="1938346">=</span>&nbsp;<span class="ident" id="1938348"><a href="/runtime/hashmap.go.html#1937559">b</a></span><span class="op" id="1938349">.</span><span class="ident" id="1938350">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938361">if</span>&nbsp;<span class="ident" id="1938364"><a href="/runtime/hashmap.go.html#1937559">b</a></span>&nbsp;<span class="op" id="1938366">==</span>&nbsp;<span class="ident" id="1938369">nil</span>&nbsp;<span class="op" id="1938373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938378">return</span>&nbsp;<span class="ident" id="1938385"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1938391">.</span><span class="ident" id="1938392">Pointer</span><span class="op" id="1938399">(</span><span class="ident" id="1938400"><a href="/runtime/hashmap.go.html#1937104">t</a></span><span class="op" id="1938401">.</span><span class="ident" id="1938402">elem</span><span class="op" id="1938406">.</span><span class="ident" id="1938407">zero</span><span class="op" id="1938411">)</span><span class="op" id="1938412">,</span>&nbsp;<span class="builtintype" id="1938414">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938422">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938425">}</span><br>
<span class="lineno"></span><span class="op" id="1938427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1938430">//&nbsp;returns&nbsp;both&nbsp;key&nbsp;and&nbsp;value.&nbsp;&nbsp;Used&nbsp;by&nbsp;map&nbsp;iterator</span><br>
<span class="lineno"></span><span class="keyword" id="1938483">func</span>&nbsp;<span class="ident" id="1938488">mapaccessK</span><span class="op" id="1938498">(</span><span class="ident" id="1938499">t</span>&nbsp;<span class="op" id="1938501">*</span><span class="ident" id="1938502"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1938509">,</span>&nbsp;<span class="ident" id="1938511">h</span>&nbsp;<span class="op" id="1938513">*</span><span class="ident" id="1938514"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1938518">,</span>&nbsp;<span class="ident" id="1938520">key</span>&nbsp;<span class="ident" id="1938524"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1938530">.</span><span class="ident" id="1938531">Pointer</span><span class="op" id="1938538">)</span>&nbsp;<span class="op" id="1938540">(</span><span class="ident" id="1938541"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1938547">.</span><span class="ident" id="1938548">Pointer</span><span class="op" id="1938555">,</span>&nbsp;<span class="ident" id="1938557"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1938563">.</span><span class="ident" id="1938564">Pointer</span><span class="op" id="1938571">)</span>&nbsp;<span class="op" id="1938573">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938576">if</span>&nbsp;<span class="ident" id="1938579"><a href="/runtime/hashmap.go.html#1938511">h</a></span>&nbsp;<span class="op" id="1938581">==</span>&nbsp;<span class="ident" id="1938584">nil</span>&nbsp;<span class="op" id="1938588">||</span>&nbsp;<span class="ident" id="1938591"><a href="/runtime/hashmap.go.html#1938511">h</a></span><span class="op" id="1938592">.</span><span class="ident" id="1938593">count</span>&nbsp;<span class="op" id="1938599">==</span>&nbsp;<span class="num" id="1938602">0</span>&nbsp;<span class="op" id="1938604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938608">return</span>&nbsp;<span class="ident" id="1938615">nil</span><span class="op" id="1938618">,</span>&nbsp;<span class="ident" id="1938620">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938628">alg</span>&nbsp;<span class="op" id="1938632">:=</span>&nbsp;<span class="ident" id="1938635"><a href="/runtime/alg.go.html#1872365">goalg</a></span><span class="op" id="1938640">(</span><span class="ident" id="1938641"><a href="/runtime/hashmap.go.html#1938499">t</a></span><span class="op" id="1938642">.</span><span class="ident" id="1938643">key</span><span class="op" id="1938646">.</span><span class="ident" id="1938647">alg</span><span class="op" id="1938650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938653">hash</span>&nbsp;<span class="op" id="1938658">:=</span>&nbsp;<span class="ident" id="1938661"><a href="/runtime/hashmap.go.html#1938628">alg</a></span><span class="op" id="1938664">.</span><span class="ident" id="1938665">hash</span><span class="op" id="1938669">(</span><span class="ident" id="1938670"><a href="/runtime/hashmap.go.html#1938520">key</a></span><span class="op" id="1938673">,</span>&nbsp;<span class="builtintype" id="1938675">uintptr</span><span class="op" id="1938682">(</span><span class="ident" id="1938683"><a href="/runtime/hashmap.go.html#1938499">t</a></span><span class="op" id="1938684">.</span><span class="ident" id="1938685">key</span><span class="op" id="1938688">.</span><span class="ident" id="1938689">size</span><span class="op" id="1938693">)</span><span class="op" id="1938694">,</span>&nbsp;<span class="builtintype" id="1938696">uintptr</span><span class="op" id="1938703">(</span><span class="ident" id="1938704"><a href="/runtime/hashmap.go.html#1938511">h</a></span><span class="op" id="1938705">.</span><span class="ident" id="1938706">hash0</span><span class="op" id="1938711">)</span><span class="op" id="1938712">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938715">m</span>&nbsp;<span class="op" id="1938717">:=</span>&nbsp;<span class="builtintype" id="1938720">uintptr</span><span class="op" id="1938727">(</span><span class="num" id="1938728">1</span><span class="op" id="1938729">)</span><span class="op" id="1938730">&lt;&lt;</span><span class="ident" id="1938732"><a href="/runtime/hashmap.go.html#1938511">h</a></span><span class="op" id="1938733">.</span><span class="ident" id="1938734">B</span>&nbsp;<span class="op" id="1938736">-</span>&nbsp;<span class="num" id="1938738">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938741">b</span>&nbsp;<span class="op" id="1938743">:=</span>&nbsp;<span class="op" id="1938746">(</span><span class="op" id="1938747">*</span><span class="ident" id="1938748"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1938752">)</span><span class="op" id="1938753">(</span><span class="ident" id="1938754"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1938760">.</span><span class="ident" id="1938761">Pointer</span><span class="op" id="1938768">(</span><span class="builtintype" id="1938769">uintptr</span><span class="op" id="1938776">(</span><span class="ident" id="1938777"><a href="/runtime/hashmap.go.html#1938511">h</a></span><span class="op" id="1938778">.</span><span class="ident" id="1938779">buckets</span><span class="op" id="1938786">)</span>&nbsp;<span class="op" id="1938788">+</span>&nbsp;<span class="op" id="1938790">(</span><span class="ident" id="1938791"><a href="/runtime/hashmap.go.html#1938653">hash</a></span><span class="op" id="1938795">&amp;</span><span class="ident" id="1938796"><a href="/runtime/hashmap.go.html#1938715">m</a></span><span class="op" id="1938797">)</span><span class="op" id="1938798">*</span><span class="builtintype" id="1938799">uintptr</span><span class="op" id="1938806">(</span><span class="ident" id="1938807"><a href="/runtime/hashmap.go.html#1938499">t</a></span><span class="op" id="1938808">.</span><span class="ident" id="1938809">bucketsize</span><span class="op" id="1938819">)</span><span class="op" id="1938820">)</span><span class="op" id="1938821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938824">if</span>&nbsp;<span class="ident" id="1938827">c</span>&nbsp;<span class="op" id="1938829">:=</span>&nbsp;<span class="ident" id="1938832"><a href="/runtime/hashmap.go.html#1938511">h</a></span><span class="op" id="1938833">.</span><span class="ident" id="1938834">oldbuckets</span><span class="op" id="1938844">;</span>&nbsp;<span class="ident" id="1938846"><a href="/runtime/hashmap.go.html#1938827">c</a></span>&nbsp;<span class="op" id="1938848">!=</span>&nbsp;<span class="ident" id="1938851">nil</span>&nbsp;<span class="op" id="1938855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938859">oldb</span>&nbsp;<span class="op" id="1938864">:=</span>&nbsp;<span class="op" id="1938867">(</span><span class="op" id="1938868">*</span><span class="ident" id="1938869"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1938873">)</span><span class="op" id="1938874">(</span><span class="ident" id="1938875"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1938881">.</span><span class="ident" id="1938882">Pointer</span><span class="op" id="1938889">(</span><span class="builtintype" id="1938890">uintptr</span><span class="op" id="1938897">(</span><span class="ident" id="1938898"><a href="/runtime/hashmap.go.html#1938827">c</a></span><span class="op" id="1938899">)</span>&nbsp;<span class="op" id="1938901">+</span>&nbsp;<span class="op" id="1938903">(</span><span class="ident" id="1938904"><a href="/runtime/hashmap.go.html#1938653">hash</a></span><span class="op" id="1938908">&amp;</span><span class="op" id="1938909">(</span><span class="ident" id="1938910"><a href="/runtime/hashmap.go.html#1938715">m</a></span><span class="op" id="1938911">&gt;&gt;</span><span class="num" id="1938913">1</span><span class="op" id="1938914">)</span><span class="op" id="1938915">)</span><span class="op" id="1938916">*</span><span class="builtintype" id="1938917">uintptr</span><span class="op" id="1938924">(</span><span class="ident" id="1938925"><a href="/runtime/hashmap.go.html#1938499">t</a></span><span class="op" id="1938926">.</span><span class="ident" id="1938927">bucketsize</span><span class="op" id="1938937">)</span><span class="op" id="1938938">)</span><span class="op" id="1938939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1938943">if</span>&nbsp;<span class="op" id="1938946">!</span><span class="ident" id="1938947"><a href="/runtime/hashmap.go.html#1933181">evacuated</a></span><span class="op" id="1938956">(</span><span class="ident" id="1938957"><a href="/runtime/hashmap.go.html#1938859">oldb</a></span><span class="op" id="1938961">)</span>&nbsp;<span class="op" id="1938963">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938968"><a href="/runtime/hashmap.go.html#1938741">b</a></span>&nbsp;<span class="op" id="1938970">=</span>&nbsp;<span class="ident" id="1938972"><a href="/runtime/hashmap.go.html#1938859">oldb</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1938982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1938985">top</span>&nbsp;<span class="op" id="1938989">:=</span>&nbsp;<span class="builtintype" id="1938992">uint8</span><span class="op" id="1938997">(</span><span class="ident" id="1938998"><a href="/runtime/hashmap.go.html#1938653">hash</a></span>&nbsp;<span class="op" id="1939003">&gt;&gt;</span>&nbsp;<span class="op" id="1939006">(</span><span class="ident" id="1939007"><a href="/runtime/stubs.go.html#2131510">ptrSize</a></span><span class="op" id="1939014">*</span><span class="num" id="1939015">8</span>&nbsp;<span class="op" id="1939017">-</span>&nbsp;<span class="num" id="1939019">8</span><span class="op" id="1939020">)</span><span class="op" id="1939021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939024">if</span>&nbsp;<span class="ident" id="1939027"><a href="/runtime/hashmap.go.html#1938985">top</a></span>&nbsp;<span class="op" id="1939031">&lt;</span>&nbsp;<span class="ident" id="1939033"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span>&nbsp;<span class="op" id="1939044">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939048"><a href="/runtime/hashmap.go.html#1938985">top</a></span>&nbsp;<span class="op" id="1939052">+=</span>&nbsp;<span class="ident" id="1939055"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939070">for</span>&nbsp;<span class="op" id="1939074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939078">for</span>&nbsp;<span class="ident" id="1939082">i</span>&nbsp;<span class="op" id="1939084">:=</span>&nbsp;<span class="builtintype" id="1939087">uintptr</span><span class="op" id="1939094">(</span><span class="num" id="1939095">0</span><span class="op" id="1939096">)</span><span class="op" id="1939097">;</span>&nbsp;<span class="ident" id="1939099"><a href="/runtime/hashmap.go.html#1939082">i</a></span>&nbsp;<span class="op" id="1939101">&lt;</span>&nbsp;<span class="ident" id="1939103"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1939112">;</span>&nbsp;<span class="ident" id="1939114"><a href="/runtime/hashmap.go.html#1939082">i</a></span><span class="op" id="1939115">++</span>&nbsp;<span class="op" id="1939118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939123">if</span>&nbsp;<span class="ident" id="1939126"><a href="/runtime/hashmap.go.html#1938741">b</a></span><span class="op" id="1939127">.</span><span class="ident" id="1939128">tophash</span><span class="op" id="1939135">[</span><span class="ident" id="1939136"><a href="/runtime/hashmap.go.html#1939082">i</a></span><span class="op" id="1939137">]</span>&nbsp;<span class="op" id="1939139">!=</span>&nbsp;<span class="ident" id="1939142"><a href="/runtime/hashmap.go.html#1938985">top</a></span>&nbsp;<span class="op" id="1939146">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939152">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939169">k</span>&nbsp;<span class="op" id="1939171">:=</span>&nbsp;<span class="ident" id="1939174"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1939177">(</span><span class="ident" id="1939178"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1939184">.</span><span class="ident" id="1939185">Pointer</span><span class="op" id="1939192">(</span><span class="ident" id="1939193"><a href="/runtime/hashmap.go.html#1938741">b</a></span><span class="op" id="1939194">)</span><span class="op" id="1939195">,</span>&nbsp;<span class="ident" id="1939197"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1939207">+</span><span class="ident" id="1939208"><a href="/runtime/hashmap.go.html#1939082">i</a></span><span class="op" id="1939209">*</span><span class="builtintype" id="1939210">uintptr</span><span class="op" id="1939217">(</span><span class="ident" id="1939218"><a href="/runtime/hashmap.go.html#1938499">t</a></span><span class="op" id="1939219">.</span><span class="ident" id="1939220">keysize</span><span class="op" id="1939227">)</span><span class="op" id="1939228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939233">if</span>&nbsp;<span class="ident" id="1939236"><a href="/runtime/hashmap.go.html#1938499">t</a></span><span class="op" id="1939237">.</span><span class="ident" id="1939238">indirectkey</span>&nbsp;<span class="op" id="1939250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939256"><a href="/runtime/hashmap.go.html#1939169">k</a></span>&nbsp;<span class="op" id="1939258">=</span>&nbsp;<span class="op" id="1939260">*</span><span class="op" id="1939261">(</span><span class="op" id="1939262">(</span><span class="op" id="1939263">*</span><span class="ident" id="1939264"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1939270">.</span><span class="ident" id="1939271">Pointer</span><span class="op" id="1939278">)</span><span class="op" id="1939279">(</span><span class="ident" id="1939280"><a href="/runtime/hashmap.go.html#1939169">k</a></span><span class="op" id="1939281">)</span><span class="op" id="1939282">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939292">if</span>&nbsp;<span class="ident" id="1939295"><a href="/runtime/hashmap.go.html#1938628">alg</a></span><span class="op" id="1939298">.</span><span class="ident" id="1939299">equal</span><span class="op" id="1939304">(</span><span class="ident" id="1939305"><a href="/runtime/hashmap.go.html#1938520">key</a></span><span class="op" id="1939308">,</span>&nbsp;<span class="ident" id="1939310"><a href="/runtime/hashmap.go.html#1939169">k</a></span><span class="op" id="1939311">,</span>&nbsp;<span class="builtintype" id="1939313">uintptr</span><span class="op" id="1939320">(</span><span class="ident" id="1939321"><a href="/runtime/hashmap.go.html#1938499">t</a></span><span class="op" id="1939322">.</span><span class="ident" id="1939323">key</span><span class="op" id="1939326">.</span><span class="ident" id="1939327">size</span><span class="op" id="1939331">)</span><span class="op" id="1939332">)</span>&nbsp;<span class="op" id="1939334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939340">v</span>&nbsp;<span class="op" id="1939342">:=</span>&nbsp;<span class="ident" id="1939345"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1939348">(</span><span class="ident" id="1939349"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1939355">.</span><span class="ident" id="1939356">Pointer</span><span class="op" id="1939363">(</span><span class="ident" id="1939364"><a href="/runtime/hashmap.go.html#1938741">b</a></span><span class="op" id="1939365">)</span><span class="op" id="1939366">,</span>&nbsp;<span class="ident" id="1939368"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1939378">+</span><span class="ident" id="1939379"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1939388">*</span><span class="builtintype" id="1939389">uintptr</span><span class="op" id="1939396">(</span><span class="ident" id="1939397"><a href="/runtime/hashmap.go.html#1938499">t</a></span><span class="op" id="1939398">.</span><span class="ident" id="1939399">keysize</span><span class="op" id="1939406">)</span><span class="op" id="1939407">+</span><span class="ident" id="1939408"><a href="/runtime/hashmap.go.html#1939082">i</a></span><span class="op" id="1939409">*</span><span class="builtintype" id="1939410">uintptr</span><span class="op" id="1939417">(</span><span class="ident" id="1939418"><a href="/runtime/hashmap.go.html#1938499">t</a></span><span class="op" id="1939419">.</span><span class="ident" id="1939420">valuesize</span><span class="op" id="1939429">)</span><span class="op" id="1939430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939436">if</span>&nbsp;<span class="ident" id="1939439"><a href="/runtime/hashmap.go.html#1938499">t</a></span><span class="op" id="1939440">.</span><span class="ident" id="1939441">indirectvalue</span>&nbsp;<span class="op" id="1939455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939462"><a href="/runtime/hashmap.go.html#1939340">v</a></span>&nbsp;<span class="op" id="1939464">=</span>&nbsp;<span class="op" id="1939466">*</span><span class="op" id="1939467">(</span><span class="op" id="1939468">(</span><span class="op" id="1939469">*</span><span class="ident" id="1939470"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1939476">.</span><span class="ident" id="1939477">Pointer</span><span class="op" id="1939484">)</span><span class="op" id="1939485">(</span><span class="ident" id="1939486"><a href="/runtime/hashmap.go.html#1939340">v</a></span><span class="op" id="1939487">)</span><span class="op" id="1939488">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939500">return</span>&nbsp;<span class="ident" id="1939507"><a href="/runtime/hashmap.go.html#1939169">k</a></span><span class="op" id="1939508">,</span>&nbsp;<span class="ident" id="1939510"><a href="/runtime/hashmap.go.html#1939340">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939523"><a href="/runtime/hashmap.go.html#1938741">b</a></span>&nbsp;<span class="op" id="1939525">=</span>&nbsp;<span class="ident" id="1939527"><a href="/runtime/hashmap.go.html#1938741">b</a></span><span class="op" id="1939528">.</span><span class="ident" id="1939529">overflow</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939540">if</span>&nbsp;<span class="ident" id="1939543"><a href="/runtime/hashmap.go.html#1938741">b</a></span>&nbsp;<span class="op" id="1939545">==</span>&nbsp;<span class="ident" id="1939548">nil</span>&nbsp;<span class="op" id="1939552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939557">return</span>&nbsp;<span class="ident" id="1939564">nil</span><span class="op" id="1939567">,</span>&nbsp;<span class="ident" id="1939569">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939578">}</span><br>
<span class="lineno"></span><span class="op" id="1939580">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="1939583">func</span>&nbsp;<span class="ident" id="1939588">mapassign1</span><span class="op" id="1939598">(</span><span class="ident" id="1939599">t</span>&nbsp;<span class="op" id="1939601">*</span><span class="ident" id="1939602"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1939609">,</span>&nbsp;<span class="ident" id="1939611">h</span>&nbsp;<span class="op" id="1939613">*</span><span class="ident" id="1939614"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1939618">,</span>&nbsp;<span class="ident" id="1939620">key</span>&nbsp;<span class="ident" id="1939624"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1939630">.</span><span class="ident" id="1939631">Pointer</span><span class="op" id="1939638">,</span>&nbsp;<span class="ident" id="1939640">val</span>&nbsp;<span class="ident" id="1939644"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1939650">.</span><span class="ident" id="1939651">Pointer</span><span class="op" id="1939658">)</span>&nbsp;<span class="op" id="1939660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939663">if</span>&nbsp;<span class="ident" id="1939666"><a href="/runtime/hashmap.go.html#1939611">h</a></span>&nbsp;<span class="op" id="1939668">==</span>&nbsp;<span class="ident" id="1939671">nil</span>&nbsp;<span class="op" id="1939675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1939679">panic</span><span class="op" id="1939684">(</span><span class="string" id="1939685">&#34;assignment&nbsp;to&nbsp;entry&nbsp;in&nbsp;nil&nbsp;map&#34;</span><span class="op" id="1939717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939720">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1939723">if</span>&nbsp;<span class="ident" id="1939726"><a href="/runtime/race0.go.html#2069616">raceenabled</a></span>&nbsp;<span class="op" id="1939738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939742">callerpc</span>&nbsp;<span class="op" id="1939751">:=</span>&nbsp;<span class="ident" id="1939754"><a href="/runtime/stubs.go.html#2139499">getcallerpc</a></span><span class="op" id="1939765">(</span><span class="ident" id="1939766"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1939772">.</span><span class="ident" id="1939773">Pointer</span><span class="op" id="1939780">(</span><span class="op" id="1939781">&amp;</span><span class="ident" id="1939782"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1939783">)</span><span class="op" id="1939784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939788">pc</span>&nbsp;<span class="op" id="1939791">:=</span>&nbsp;<span class="ident" id="1939794"><a href="/runtime/proc.go.html#2068560">funcPC</a></span><span class="op" id="1939800">(</span><span class="ident" id="1939801"><a href="/runtime/hashmap.go.html#1939588">mapassign1</a></span><span class="op" id="1939811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939815"><a href="/runtime/race0.go.html#2070198">racewritepc</a></span><span class="op" id="1939826">(</span><span class="ident" id="1939827"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1939833">.</span><span class="ident" id="1939834">Pointer</span><span class="op" id="1939841">(</span><span class="ident" id="1939842"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1939843">)</span><span class="op" id="1939844">,</span>&nbsp;<span class="ident" id="1939846"><a href="/runtime/hashmap.go.html#1939742">callerpc</a></span><span class="op" id="1939854">,</span>&nbsp;<span class="ident" id="1939856"><a href="/runtime/hashmap.go.html#1939788">pc</a></span><span class="op" id="1939858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939862"><a href="/runtime/race0.go.html#2069718">raceReadObjectPC</a></span><span class="op" id="1939878">(</span><span class="ident" id="1939879"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1939880">.</span><span class="ident" id="1939881">key</span><span class="op" id="1939884">,</span>&nbsp;<span class="ident" id="1939886"><a href="/runtime/hashmap.go.html#1939620">key</a></span><span class="op" id="1939889">,</span>&nbsp;<span class="ident" id="1939891"><a href="/runtime/hashmap.go.html#1939742">callerpc</a></span><span class="op" id="1939899">,</span>&nbsp;<span class="ident" id="1939901"><a href="/runtime/hashmap.go.html#1939788">pc</a></span><span class="op" id="1939903">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939907"><a href="/runtime/race0.go.html#2069718">raceReadObjectPC</a></span><span class="op" id="1939923">(</span><span class="ident" id="1939924"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1939925">.</span><span class="ident" id="1939926">elem</span><span class="op" id="1939930">,</span>&nbsp;<span class="ident" id="1939932"><a href="/runtime/hashmap.go.html#1939640">val</a></span><span class="op" id="1939935">,</span>&nbsp;<span class="ident" id="1939937"><a href="/runtime/hashmap.go.html#1939742">callerpc</a></span><span class="op" id="1939945">,</span>&nbsp;<span class="ident" id="1939947"><a href="/runtime/hashmap.go.html#1939788">pc</a></span><span class="op" id="1939949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1939952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939956">alg</span>&nbsp;<span class="op" id="1939960">:=</span>&nbsp;<span class="ident" id="1939963"><a href="/runtime/alg.go.html#1872365">goalg</a></span><span class="op" id="1939968">(</span><span class="ident" id="1939969"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1939970">.</span><span class="ident" id="1939971">key</span><span class="op" id="1939974">.</span><span class="ident" id="1939975">alg</span><span class="op" id="1939978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1939981">hash</span>&nbsp;<span class="op" id="1939986">:=</span>&nbsp;<span class="ident" id="1939989"><a href="/runtime/hashmap.go.html#1939956">alg</a></span><span class="op" id="1939992">.</span><span class="ident" id="1939993">hash</span><span class="op" id="1939997">(</span><span class="ident" id="1939998"><a href="/runtime/hashmap.go.html#1939620">key</a></span><span class="op" id="1940001">,</span>&nbsp;<span class="builtintype" id="1940003">uintptr</span><span class="op" id="1940010">(</span><span class="ident" id="1940011"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1940012">.</span><span class="ident" id="1940013">key</span><span class="op" id="1940016">.</span><span class="ident" id="1940017">size</span><span class="op" id="1940021">)</span><span class="op" id="1940022">,</span>&nbsp;<span class="builtintype" id="1940024">uintptr</span><span class="op" id="1940031">(</span><span class="ident" id="1940032"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1940033">.</span><span class="ident" id="1940034">hash0</span><span class="op" id="1940039">)</span><span class="op" id="1940040">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940044">if</span>&nbsp;<span class="ident" id="1940047"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1940048">.</span><span class="ident" id="1940049">buckets</span>&nbsp;<span class="op" id="1940057">==</span>&nbsp;<span class="ident" id="1940060">nil</span>&nbsp;<span class="op" id="1940064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940068">if</span>&nbsp;<span class="ident" id="1940071"><a href="/runtime/hashmap.go.html#1931204">checkgc</a></span>&nbsp;<span class="op" id="1940079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940084"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1940092">.</span><span class="ident" id="1940093">next_gc</span>&nbsp;<span class="op" id="1940101">=</span>&nbsp;<span class="ident" id="1940103"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1940111">.</span><span class="ident" id="1940112">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1940125">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940129"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1940130">.</span><span class="ident" id="1940131">buckets</span>&nbsp;<span class="op" id="1940139">=</span>&nbsp;<span class="ident" id="1940141"><a href="/runtime/malloc.go.html#1991870">newarray</a></span><span class="op" id="1940149">(</span><span class="ident" id="1940150"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1940151">.</span><span class="ident" id="1940152">bucket</span><span class="op" id="1940158">,</span>&nbsp;<span class="num" id="1940160">1</span><span class="op" id="1940161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1940164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="1940167">again</span><span class="op" id="1940172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940175">bucket</span>&nbsp;<span class="op" id="1940182">:=</span>&nbsp;<span class="ident" id="1940185"><a href="/runtime/hashmap.go.html#1939981">hash</a></span>&nbsp;<span class="op" id="1940190">&amp;</span>&nbsp;<span class="op" id="1940192">(</span><span class="builtintype" id="1940193">uintptr</span><span class="op" id="1940200">(</span><span class="num" id="1940201">1</span><span class="op" id="1940202">)</span><span class="op" id="1940203">&lt;&lt;</span><span class="ident" id="1940205"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1940206">.</span><span class="ident" id="1940207">B</span>&nbsp;<span class="op" id="1940209">-</span>&nbsp;<span class="num" id="1940211">1</span><span class="op" id="1940212">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940215">if</span>&nbsp;<span class="ident" id="1940218"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1940219">.</span><span class="ident" id="1940220">oldbuckets</span>&nbsp;<span class="op" id="1940231">!=</span>&nbsp;<span class="ident" id="1940234">nil</span>&nbsp;<span class="op" id="1940238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940242"><a href="/runtime/hashmap.go.html#1949839">growWork</a></span><span class="op" id="1940250">(</span><span class="ident" id="1940251"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1940252">,</span>&nbsp;<span class="ident" id="1940254"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1940255">,</span>&nbsp;<span class="ident" id="1940257"><a href="/runtime/hashmap.go.html#1940175">bucket</a></span><span class="op" id="1940263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1940266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940269">b</span>&nbsp;<span class="op" id="1940271">:=</span>&nbsp;<span class="op" id="1940274">(</span><span class="op" id="1940275">*</span><span class="ident" id="1940276"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1940280">)</span><span class="op" id="1940281">(</span><span class="ident" id="1940282"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1940288">.</span><span class="ident" id="1940289">Pointer</span><span class="op" id="1940296">(</span><span class="builtintype" id="1940297">uintptr</span><span class="op" id="1940304">(</span><span class="ident" id="1940305"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1940306">.</span><span class="ident" id="1940307">buckets</span><span class="op" id="1940314">)</span>&nbsp;<span class="op" id="1940316">+</span>&nbsp;<span class="ident" id="1940318"><a href="/runtime/hashmap.go.html#1940175">bucket</a></span><span class="op" id="1940324">*</span><span class="builtintype" id="1940325">uintptr</span><span class="op" id="1940332">(</span><span class="ident" id="1940333"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1940334">.</span><span class="ident" id="1940335">bucketsize</span><span class="op" id="1940345">)</span><span class="op" id="1940346">)</span><span class="op" id="1940347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940350">top</span>&nbsp;<span class="op" id="1940354">:=</span>&nbsp;<span class="builtintype" id="1940357">uint8</span><span class="op" id="1940362">(</span><span class="ident" id="1940363"><a href="/runtime/hashmap.go.html#1939981">hash</a></span>&nbsp;<span class="op" id="1940368">&gt;&gt;</span>&nbsp;<span class="op" id="1940371">(</span><span class="ident" id="1940372"><a href="/runtime/stubs.go.html#2131510">ptrSize</a></span><span class="op" id="1940379">*</span><span class="num" id="1940380">8</span>&nbsp;<span class="op" id="1940382">-</span>&nbsp;<span class="num" id="1940384">8</span><span class="op" id="1940385">)</span><span class="op" id="1940386">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940389">if</span>&nbsp;<span class="ident" id="1940392"><a href="/runtime/hashmap.go.html#1940350">top</a></span>&nbsp;<span class="op" id="1940396">&lt;</span>&nbsp;<span class="ident" id="1940398"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span>&nbsp;<span class="op" id="1940409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940413"><a href="/runtime/hashmap.go.html#1940350">top</a></span>&nbsp;<span class="op" id="1940417">+=</span>&nbsp;<span class="ident" id="1940420"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1940432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940436">var</span>&nbsp;<span class="ident" id="1940440">inserti</span>&nbsp;<span class="op" id="1940448">*</span><span class="builtintype" id="1940449">uint8</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940456">var</span>&nbsp;<span class="ident" id="1940460">insertk</span>&nbsp;<span class="ident" id="1940468"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1940474">.</span><span class="ident" id="1940475">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940484">var</span>&nbsp;<span class="ident" id="1940488">insertv</span>&nbsp;<span class="ident" id="1940496"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1940502">.</span><span class="ident" id="1940503">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940512">for</span>&nbsp;<span class="op" id="1940516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940520">for</span>&nbsp;<span class="ident" id="1940524">i</span>&nbsp;<span class="op" id="1940526">:=</span>&nbsp;<span class="builtintype" id="1940529">uintptr</span><span class="op" id="1940536">(</span><span class="num" id="1940537">0</span><span class="op" id="1940538">)</span><span class="op" id="1940539">;</span>&nbsp;<span class="ident" id="1940541"><a href="/runtime/hashmap.go.html#1940524">i</a></span>&nbsp;<span class="op" id="1940543">&lt;</span>&nbsp;<span class="ident" id="1940545"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1940554">;</span>&nbsp;<span class="ident" id="1940556"><a href="/runtime/hashmap.go.html#1940524">i</a></span><span class="op" id="1940557">++</span>&nbsp;<span class="op" id="1940560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940565">if</span>&nbsp;<span class="ident" id="1940568"><a href="/runtime/hashmap.go.html#1940269">b</a></span><span class="op" id="1940569">.</span><span class="ident" id="1940570">tophash</span><span class="op" id="1940577">[</span><span class="ident" id="1940578"><a href="/runtime/hashmap.go.html#1940524">i</a></span><span class="op" id="1940579">]</span>&nbsp;<span class="op" id="1940581">!=</span>&nbsp;<span class="ident" id="1940584"><a href="/runtime/hashmap.go.html#1940350">top</a></span>&nbsp;<span class="op" id="1940588">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940594">if</span>&nbsp;<span class="ident" id="1940597"><a href="/runtime/hashmap.go.html#1940269">b</a></span><span class="op" id="1940598">.</span><span class="ident" id="1940599">tophash</span><span class="op" id="1940606">[</span><span class="ident" id="1940607"><a href="/runtime/hashmap.go.html#1940524">i</a></span><span class="op" id="1940608">]</span>&nbsp;<span class="op" id="1940610">==</span>&nbsp;<span class="ident" id="1940613"><a href="/runtime/hashmap.go.html#1930582">empty</a></span>&nbsp;<span class="op" id="1940619">&amp;&amp;</span>&nbsp;<span class="ident" id="1940622"><a href="/runtime/hashmap.go.html#1940440">inserti</a></span>&nbsp;<span class="op" id="1940630">==</span>&nbsp;<span class="ident" id="1940633">nil</span>&nbsp;<span class="op" id="1940637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940644"><a href="/runtime/hashmap.go.html#1940440">inserti</a></span>&nbsp;<span class="op" id="1940652">=</span>&nbsp;<span class="op" id="1940654">&amp;</span><span class="ident" id="1940655"><a href="/runtime/hashmap.go.html#1940269">b</a></span><span class="op" id="1940656">.</span><span class="ident" id="1940657">tophash</span><span class="op" id="1940664">[</span><span class="ident" id="1940665"><a href="/runtime/hashmap.go.html#1940524">i</a></span><span class="op" id="1940666">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940673"><a href="/runtime/hashmap.go.html#1940460">insertk</a></span>&nbsp;<span class="op" id="1940681">=</span>&nbsp;<span class="ident" id="1940683"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1940686">(</span><span class="ident" id="1940687"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1940693">.</span><span class="ident" id="1940694">Pointer</span><span class="op" id="1940701">(</span><span class="ident" id="1940702"><a href="/runtime/hashmap.go.html#1940269">b</a></span><span class="op" id="1940703">)</span><span class="op" id="1940704">,</span>&nbsp;<span class="ident" id="1940706"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1940716">+</span><span class="ident" id="1940717"><a href="/runtime/hashmap.go.html#1940524">i</a></span><span class="op" id="1940718">*</span><span class="builtintype" id="1940719">uintptr</span><span class="op" id="1940726">(</span><span class="ident" id="1940727"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1940728">.</span><span class="ident" id="1940729">keysize</span><span class="op" id="1940736">)</span><span class="op" id="1940737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940744"><a href="/runtime/hashmap.go.html#1940488">insertv</a></span>&nbsp;<span class="op" id="1940752">=</span>&nbsp;<span class="ident" id="1940754"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1940757">(</span><span class="ident" id="1940758"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1940764">.</span><span class="ident" id="1940765">Pointer</span><span class="op" id="1940772">(</span><span class="ident" id="1940773"><a href="/runtime/hashmap.go.html#1940269">b</a></span><span class="op" id="1940774">)</span><span class="op" id="1940775">,</span>&nbsp;<span class="ident" id="1940777"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1940787">+</span><span class="ident" id="1940788"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1940797">*</span><span class="builtintype" id="1940798">uintptr</span><span class="op" id="1940805">(</span><span class="ident" id="1940806"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1940807">.</span><span class="ident" id="1940808">keysize</span><span class="op" id="1940815">)</span><span class="op" id="1940816">+</span><span class="ident" id="1940817"><a href="/runtime/hashmap.go.html#1940524">i</a></span><span class="op" id="1940818">*</span><span class="builtintype" id="1940819">uintptr</span><span class="op" id="1940826">(</span><span class="ident" id="1940827"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1940828">.</span><span class="ident" id="1940829">valuesize</span><span class="op" id="1940838">)</span><span class="op" id="1940839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1940845">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940851">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1940863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940868">k</span>&nbsp;<span class="op" id="1940870">:=</span>&nbsp;<span class="ident" id="1940873"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1940876">(</span><span class="ident" id="1940877"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1940883">.</span><span class="ident" id="1940884">Pointer</span><span class="op" id="1940891">(</span><span class="ident" id="1940892"><a href="/runtime/hashmap.go.html#1940269">b</a></span><span class="op" id="1940893">)</span><span class="op" id="1940894">,</span>&nbsp;<span class="ident" id="1940896"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1940906">+</span><span class="ident" id="1940907"><a href="/runtime/hashmap.go.html#1940524">i</a></span><span class="op" id="1940908">*</span><span class="builtintype" id="1940909">uintptr</span><span class="op" id="1940916">(</span><span class="ident" id="1940917"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1940918">.</span><span class="ident" id="1940919">keysize</span><span class="op" id="1940926">)</span><span class="op" id="1940927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940932">k2</span>&nbsp;<span class="op" id="1940935">:=</span>&nbsp;<span class="ident" id="1940938"><a href="/runtime/hashmap.go.html#1940868">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1940943">if</span>&nbsp;<span class="ident" id="1940946"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1940947">.</span><span class="ident" id="1940948">indirectkey</span>&nbsp;<span class="op" id="1940960">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1940966"><a href="/runtime/hashmap.go.html#1940932">k2</a></span>&nbsp;<span class="op" id="1940969">=</span>&nbsp;<span class="op" id="1940971">*</span><span class="op" id="1940972">(</span><span class="op" id="1940973">(</span><span class="op" id="1940974">*</span><span class="ident" id="1940975"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1940981">.</span><span class="ident" id="1940982">Pointer</span><span class="op" id="1940989">)</span><span class="op" id="1940990">(</span><span class="ident" id="1940991"><a href="/runtime/hashmap.go.html#1940932">k2</a></span><span class="op" id="1940993">)</span><span class="op" id="1940994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1940999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941004">if</span>&nbsp;<span class="op" id="1941007">!</span><span class="ident" id="1941008"><a href="/runtime/hashmap.go.html#1939956">alg</a></span><span class="op" id="1941011">.</span><span class="ident" id="1941012">equal</span><span class="op" id="1941017">(</span><span class="ident" id="1941018"><a href="/runtime/hashmap.go.html#1939620">key</a></span><span class="op" id="1941021">,</span>&nbsp;<span class="ident" id="1941023"><a href="/runtime/hashmap.go.html#1940932">k2</a></span><span class="op" id="1941025">,</span>&nbsp;<span class="builtintype" id="1941027">uintptr</span><span class="op" id="1941034">(</span><span class="ident" id="1941035"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1941036">.</span><span class="ident" id="1941037">key</span><span class="op" id="1941040">.</span><span class="ident" id="1941041">size</span><span class="op" id="1941045">)</span><span class="op" id="1941046">)</span>&nbsp;<span class="op" id="1941048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941054">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941066">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1941071">//&nbsp;already&nbsp;have&nbsp;a&nbsp;mapping&nbsp;for&nbsp;key.&nbsp;&nbsp;Update&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941121"><a href="/runtime/stubs.go.html#2135810">memmove</a></span><span class="op" id="1941128">(</span><span class="ident" id="1941129"><a href="/runtime/hashmap.go.html#1940932">k2</a></span><span class="op" id="1941131">,</span>&nbsp;<span class="ident" id="1941133"><a href="/runtime/hashmap.go.html#1939620">key</a></span><span class="op" id="1941136">,</span>&nbsp;<span class="builtintype" id="1941138">uintptr</span><span class="op" id="1941145">(</span><span class="ident" id="1941146"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1941147">.</span><span class="ident" id="1941148">key</span><span class="op" id="1941151">.</span><span class="ident" id="1941152">size</span><span class="op" id="1941156">)</span><span class="op" id="1941157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941162">v</span>&nbsp;<span class="op" id="1941164">:=</span>&nbsp;<span class="ident" id="1941167"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1941170">(</span><span class="ident" id="1941171"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1941177">.</span><span class="ident" id="1941178">Pointer</span><span class="op" id="1941185">(</span><span class="ident" id="1941186"><a href="/runtime/hashmap.go.html#1940269">b</a></span><span class="op" id="1941187">)</span><span class="op" id="1941188">,</span>&nbsp;<span class="ident" id="1941190"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1941200">+</span><span class="ident" id="1941201"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1941210">*</span><span class="builtintype" id="1941211">uintptr</span><span class="op" id="1941218">(</span><span class="ident" id="1941219"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1941220">.</span><span class="ident" id="1941221">keysize</span><span class="op" id="1941228">)</span><span class="op" id="1941229">+</span><span class="ident" id="1941230"><a href="/runtime/hashmap.go.html#1940524">i</a></span><span class="op" id="1941231">*</span><span class="builtintype" id="1941232">uintptr</span><span class="op" id="1941239">(</span><span class="ident" id="1941240"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1941241">.</span><span class="ident" id="1941242">valuesize</span><span class="op" id="1941251">)</span><span class="op" id="1941252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941257">v2</span>&nbsp;<span class="op" id="1941260">:=</span>&nbsp;<span class="ident" id="1941263"><a href="/runtime/hashmap.go.html#1941162">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941268">if</span>&nbsp;<span class="ident" id="1941271"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1941272">.</span><span class="ident" id="1941273">indirectvalue</span>&nbsp;<span class="op" id="1941287">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941293"><a href="/runtime/hashmap.go.html#1941257">v2</a></span>&nbsp;<span class="op" id="1941296">=</span>&nbsp;<span class="op" id="1941298">*</span><span class="op" id="1941299">(</span><span class="op" id="1941300">(</span><span class="op" id="1941301">*</span><span class="ident" id="1941302"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1941308">.</span><span class="ident" id="1941309">Pointer</span><span class="op" id="1941316">)</span><span class="op" id="1941317">(</span><span class="ident" id="1941318"><a href="/runtime/hashmap.go.html#1941257">v2</a></span><span class="op" id="1941320">)</span><span class="op" id="1941321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941331"><a href="/runtime/stubs.go.html#2135810">memmove</a></span><span class="op" id="1941338">(</span><span class="ident" id="1941339"><a href="/runtime/hashmap.go.html#1941257">v2</a></span><span class="op" id="1941341">,</span>&nbsp;<span class="ident" id="1941343"><a href="/runtime/hashmap.go.html#1939640">val</a></span><span class="op" id="1941346">,</span>&nbsp;<span class="builtintype" id="1941348">uintptr</span><span class="op" id="1941355">(</span><span class="ident" id="1941356"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1941357">.</span><span class="ident" id="1941358">elem</span><span class="op" id="1941362">.</span><span class="ident" id="1941363">size</span><span class="op" id="1941367">)</span><span class="op" id="1941368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941373">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941382">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941386">if</span>&nbsp;<span class="ident" id="1941389"><a href="/runtime/hashmap.go.html#1940269">b</a></span><span class="op" id="1941390">.</span><span class="ident" id="1941391">overflow</span>&nbsp;<span class="op" id="1941400">==</span>&nbsp;<span class="ident" id="1941403">nil</span>&nbsp;<span class="op" id="1941407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941412">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941424"><a href="/runtime/hashmap.go.html#1940269">b</a></span>&nbsp;<span class="op" id="1941426">=</span>&nbsp;<span class="ident" id="1941428"><a href="/runtime/hashmap.go.html#1940269">b</a></span><span class="op" id="1941429">.</span><span class="ident" id="1941430">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941440">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1941444">//&nbsp;did&nbsp;not&nbsp;find&nbsp;mapping&nbsp;for&nbsp;key.&nbsp;&nbsp;Allocate&nbsp;new&nbsp;cell&nbsp;&amp;&nbsp;add&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941510">if</span>&nbsp;<span class="builtintype" id="1941513">float32</span><span class="op" id="1941520">(</span><span class="ident" id="1941521"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1941522">.</span><span class="ident" id="1941523">count</span><span class="op" id="1941528">)</span>&nbsp;<span class="op" id="1941530">&gt;=</span>&nbsp;<span class="ident" id="1941533"><a href="/runtime/hashmap.go.html#1929693">loadFactor</a></span><span class="op" id="1941543">*</span><span class="builtintype" id="1941544">float32</span><span class="op" id="1941551">(</span><span class="op" id="1941552">(</span><span class="builtintype" id="1941553">uintptr</span><span class="op" id="1941560">(</span><span class="num" id="1941561">1</span><span class="op" id="1941562">)</span><span class="op" id="1941563">&lt;&lt;</span><span class="ident" id="1941565"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1941566">.</span><span class="ident" id="1941567">B</span><span class="op" id="1941568">)</span><span class="op" id="1941569">)</span>&nbsp;<span class="op" id="1941571">&amp;&amp;</span>&nbsp;<span class="ident" id="1941574"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1941575">.</span><span class="ident" id="1941576">count</span>&nbsp;<span class="op" id="1941582">&gt;=</span>&nbsp;<span class="ident" id="1941585"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span>&nbsp;<span class="op" id="1941595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941599"><a href="/runtime/hashmap.go.html#1949260">hashGrow</a></span><span class="op" id="1941607">(</span><span class="ident" id="1941608"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1941609">,</span>&nbsp;<span class="ident" id="1941611"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1941612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941616">goto</span>&nbsp;<span class="ident" id="1941621">again</span>&nbsp;<span class="comment" id="1941627">//&nbsp;Growing&nbsp;the&nbsp;table&nbsp;invalidates&nbsp;everything,&nbsp;so&nbsp;try&nbsp;again</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941690">if</span>&nbsp;<span class="ident" id="1941693"><a href="/runtime/hashmap.go.html#1940440">inserti</a></span>&nbsp;<span class="op" id="1941701">==</span>&nbsp;<span class="ident" id="1941704">nil</span>&nbsp;<span class="op" id="1941708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1941712">//&nbsp;all&nbsp;current&nbsp;buckets&nbsp;are&nbsp;full,&nbsp;allocate&nbsp;a&nbsp;new&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1941767">if</span>&nbsp;<span class="ident" id="1941770"><a href="/runtime/hashmap.go.html#1931204">checkgc</a></span>&nbsp;<span class="op" id="1941778">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941783"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1941791">.</span><span class="ident" id="1941792">next_gc</span>&nbsp;<span class="op" id="1941800">=</span>&nbsp;<span class="ident" id="1941802"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1941810">.</span><span class="ident" id="1941811">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1941824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941828">newb</span>&nbsp;<span class="op" id="1941833">:=</span>&nbsp;<span class="op" id="1941836">(</span><span class="op" id="1941837">*</span><span class="ident" id="1941838"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1941842">)</span><span class="op" id="1941843">(</span><span class="ident" id="1941844"><a href="/runtime/malloc.go.html#1991650">newobject</a></span><span class="op" id="1941853">(</span><span class="ident" id="1941854"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1941855">.</span><span class="ident" id="1941856">bucket</span><span class="op" id="1941862">)</span><span class="op" id="1941863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941867"><a href="/runtime/hashmap.go.html#1940269">b</a></span><span class="op" id="1941868">.</span><span class="ident" id="1941869">overflow</span>&nbsp;<span class="op" id="1941878">=</span>&nbsp;<span class="ident" id="1941880"><a href="/runtime/hashmap.go.html#1941828">newb</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941887"><a href="/runtime/hashmap.go.html#1940440">inserti</a></span>&nbsp;<span class="op" id="1941895">=</span>&nbsp;<span class="op" id="1941897">&amp;</span><span class="ident" id="1941898"><a href="/runtime/hashmap.go.html#1941828">newb</a></span><span class="op" id="1941902">.</span><span class="ident" id="1941903">tophash</span><span class="op" id="1941910">[</span><span class="num" id="1941911">0</span><span class="op" id="1941912">]</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941916"><a href="/runtime/hashmap.go.html#1940460">insertk</a></span>&nbsp;<span class="op" id="1941924">=</span>&nbsp;<span class="ident" id="1941926"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1941929">(</span><span class="ident" id="1941930"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1941936">.</span><span class="ident" id="1941937">Pointer</span><span class="op" id="1941944">(</span><span class="ident" id="1941945"><a href="/runtime/hashmap.go.html#1941828">newb</a></span><span class="op" id="1941949">)</span><span class="op" id="1941950">,</span>&nbsp;<span class="ident" id="1941952"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1941962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1941966"><a href="/runtime/hashmap.go.html#1940488">insertv</a></span>&nbsp;<span class="op" id="1941974">=</span>&nbsp;<span class="ident" id="1941976"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1941979">(</span><span class="ident" id="1941980"><a href="/runtime/hashmap.go.html#1940460">insertk</a></span><span class="op" id="1941987">,</span>&nbsp;<span class="ident" id="1941989"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1941998">*</span><span class="builtintype" id="1941999">uintptr</span><span class="op" id="1942006">(</span><span class="ident" id="1942007"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1942008">.</span><span class="ident" id="1942009">keysize</span><span class="op" id="1942016">)</span><span class="op" id="1942017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1942024">//&nbsp;store&nbsp;new&nbsp;key/value&nbsp;at&nbsp;insert&nbsp;position</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942067">if</span>&nbsp;<span class="ident" id="1942070"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1942071">.</span><span class="ident" id="1942072">indirectkey</span>&nbsp;<span class="op" id="1942084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942088">if</span>&nbsp;<span class="ident" id="1942091"><a href="/runtime/hashmap.go.html#1931204">checkgc</a></span>&nbsp;<span class="op" id="1942099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942104"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1942112">.</span><span class="ident" id="1942113">next_gc</span>&nbsp;<span class="op" id="1942121">=</span>&nbsp;<span class="ident" id="1942123"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1942131">.</span><span class="ident" id="1942132">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942149">kmem</span>&nbsp;<span class="op" id="1942154">:=</span>&nbsp;<span class="ident" id="1942157"><a href="/runtime/malloc.go.html#1991650">newobject</a></span><span class="op" id="1942166">(</span><span class="ident" id="1942167"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1942168">.</span><span class="ident" id="1942169">key</span><span class="op" id="1942172">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942176">*</span><span class="op" id="1942177">(</span><span class="op" id="1942178">*</span><span class="ident" id="1942179"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1942185">.</span><span class="ident" id="1942186">Pointer</span><span class="op" id="1942193">)</span><span class="op" id="1942194">(</span><span class="ident" id="1942195"><a href="/runtime/hashmap.go.html#1940460">insertk</a></span><span class="op" id="1942202">)</span>&nbsp;<span class="op" id="1942204">=</span>&nbsp;<span class="ident" id="1942206"><a href="/runtime/hashmap.go.html#1942149">kmem</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942213"><a href="/runtime/hashmap.go.html#1940460">insertk</a></span>&nbsp;<span class="op" id="1942221">=</span>&nbsp;<span class="ident" id="1942223"><a href="/runtime/hashmap.go.html#1942149">kmem</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942232">if</span>&nbsp;<span class="ident" id="1942235"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1942236">.</span><span class="ident" id="1942237">indirectvalue</span>&nbsp;<span class="op" id="1942251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942255">if</span>&nbsp;<span class="ident" id="1942258"><a href="/runtime/hashmap.go.html#1931204">checkgc</a></span>&nbsp;<span class="op" id="1942266">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942271"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1942279">.</span><span class="ident" id="1942280">next_gc</span>&nbsp;<span class="op" id="1942288">=</span>&nbsp;<span class="ident" id="1942290"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1942298">.</span><span class="ident" id="1942299">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942316">vmem</span>&nbsp;<span class="op" id="1942321">:=</span>&nbsp;<span class="ident" id="1942324"><a href="/runtime/malloc.go.html#1991650">newobject</a></span><span class="op" id="1942333">(</span><span class="ident" id="1942334"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1942335">.</span><span class="ident" id="1942336">elem</span><span class="op" id="1942340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942344">*</span><span class="op" id="1942345">(</span><span class="op" id="1942346">*</span><span class="ident" id="1942347"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1942353">.</span><span class="ident" id="1942354">Pointer</span><span class="op" id="1942361">)</span><span class="op" id="1942362">(</span><span class="ident" id="1942363"><a href="/runtime/hashmap.go.html#1940488">insertv</a></span><span class="op" id="1942370">)</span>&nbsp;<span class="op" id="1942372">=</span>&nbsp;<span class="ident" id="1942374"><a href="/runtime/hashmap.go.html#1942316">vmem</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942381"><a href="/runtime/hashmap.go.html#1940488">insertv</a></span>&nbsp;<span class="op" id="1942389">=</span>&nbsp;<span class="ident" id="1942391"><a href="/runtime/hashmap.go.html#1942316">vmem</a></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942400"><a href="/runtime/stubs.go.html#2135810">memmove</a></span><span class="op" id="1942407">(</span><span class="ident" id="1942408"><a href="/runtime/hashmap.go.html#1940460">insertk</a></span><span class="op" id="1942415">,</span>&nbsp;<span class="ident" id="1942417"><a href="/runtime/hashmap.go.html#1939620">key</a></span><span class="op" id="1942420">,</span>&nbsp;<span class="builtintype" id="1942422">uintptr</span><span class="op" id="1942429">(</span><span class="ident" id="1942430"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1942431">.</span><span class="ident" id="1942432">key</span><span class="op" id="1942435">.</span><span class="ident" id="1942436">size</span><span class="op" id="1942440">)</span><span class="op" id="1942441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942444"><a href="/runtime/stubs.go.html#2135810">memmove</a></span><span class="op" id="1942451">(</span><span class="ident" id="1942452"><a href="/runtime/hashmap.go.html#1940488">insertv</a></span><span class="op" id="1942459">,</span>&nbsp;<span class="ident" id="1942461"><a href="/runtime/hashmap.go.html#1939640">val</a></span><span class="op" id="1942464">,</span>&nbsp;<span class="builtintype" id="1942466">uintptr</span><span class="op" id="1942473">(</span><span class="ident" id="1942474"><a href="/runtime/hashmap.go.html#1939599">t</a></span><span class="op" id="1942475">.</span><span class="ident" id="1942476">elem</span><span class="op" id="1942480">.</span><span class="ident" id="1942481">size</span><span class="op" id="1942485">)</span><span class="op" id="1942486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942489">*</span><span class="ident" id="1942490"><a href="/runtime/hashmap.go.html#1940440">inserti</a></span>&nbsp;<span class="op" id="1942498">=</span>&nbsp;<span class="ident" id="1942500"><a href="/runtime/hashmap.go.html#1940350">top</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942505"><a href="/runtime/hashmap.go.html#1939611">h</a></span><span class="op" id="1942506">.</span><span class="ident" id="1942507">count</span><span class="op" id="1942512">++</span><br>
<span class="lineno">485</span><span class="op" id="1942515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1942518">func</span>&nbsp;<span class="ident" id="1942523">mapdelete</span><span class="op" id="1942532">(</span><span class="ident" id="1942533">t</span>&nbsp;<span class="op" id="1942535">*</span><span class="ident" id="1942536"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1942543">,</span>&nbsp;<span class="ident" id="1942545">h</span>&nbsp;<span class="op" id="1942547">*</span><span class="ident" id="1942548"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1942552">,</span>&nbsp;<span class="ident" id="1942554">key</span>&nbsp;<span class="ident" id="1942558"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1942564">.</span><span class="ident" id="1942565">Pointer</span><span class="op" id="1942572">)</span>&nbsp;<span class="op" id="1942574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942577">if</span>&nbsp;<span class="ident" id="1942580"><a href="/runtime/race0.go.html#2069616">raceenabled</a></span>&nbsp;<span class="op" id="1942592">&amp;&amp;</span>&nbsp;<span class="ident" id="1942595"><a href="/runtime/hashmap.go.html#1942545">h</a></span>&nbsp;<span class="op" id="1942597">!=</span>&nbsp;<span class="ident" id="1942600">nil</span>&nbsp;<span class="op" id="1942604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942608">callerpc</span>&nbsp;<span class="op" id="1942617">:=</span>&nbsp;<span class="ident" id="1942620"><a href="/runtime/stubs.go.html#2139499">getcallerpc</a></span><span class="op" id="1942631">(</span><span class="ident" id="1942632"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1942638">.</span><span class="ident" id="1942639">Pointer</span><span class="op" id="1942646">(</span><span class="op" id="1942647">&amp;</span><span class="ident" id="1942648"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1942649">)</span><span class="op" id="1942650">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942654">pc</span>&nbsp;<span class="op" id="1942657">:=</span>&nbsp;<span class="ident" id="1942660"><a href="/runtime/proc.go.html#2068560">funcPC</a></span><span class="op" id="1942666">(</span><span class="ident" id="1942667"><a href="/runtime/hashmap.go.html#1942523">mapdelete</a></span><span class="op" id="1942676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942680"><a href="/runtime/race0.go.html#2070198">racewritepc</a></span><span class="op" id="1942691">(</span><span class="ident" id="1942692"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1942698">.</span><span class="ident" id="1942699">Pointer</span><span class="op" id="1942706">(</span><span class="ident" id="1942707"><a href="/runtime/hashmap.go.html#1942545">h</a></span><span class="op" id="1942708">)</span><span class="op" id="1942709">,</span>&nbsp;<span class="ident" id="1942711"><a href="/runtime/hashmap.go.html#1942608">callerpc</a></span><span class="op" id="1942719">,</span>&nbsp;<span class="ident" id="1942721"><a href="/runtime/hashmap.go.html#1942654">pc</a></span><span class="op" id="1942723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942727"><a href="/runtime/race0.go.html#2069718">raceReadObjectPC</a></span><span class="op" id="1942743">(</span><span class="ident" id="1942744"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1942745">.</span><span class="ident" id="1942746">key</span><span class="op" id="1942749">,</span>&nbsp;<span class="ident" id="1942751"><a href="/runtime/hashmap.go.html#1942554">key</a></span><span class="op" id="1942754">,</span>&nbsp;<span class="ident" id="1942756"><a href="/runtime/hashmap.go.html#1942608">callerpc</a></span><span class="op" id="1942764">,</span>&nbsp;<span class="ident" id="1942766"><a href="/runtime/hashmap.go.html#1942654">pc</a></span><span class="op" id="1942768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942774">if</span>&nbsp;<span class="ident" id="1942777"><a href="/runtime/hashmap.go.html#1942545">h</a></span>&nbsp;<span class="op" id="1942779">==</span>&nbsp;<span class="ident" id="1942782">nil</span>&nbsp;<span class="op" id="1942786">||</span>&nbsp;<span class="ident" id="1942789"><a href="/runtime/hashmap.go.html#1942545">h</a></span><span class="op" id="1942790">.</span><span class="ident" id="1942791">count</span>&nbsp;<span class="op" id="1942797">==</span>&nbsp;<span class="num" id="1942800">0</span>&nbsp;<span class="op" id="1942802">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942806">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942817">alg</span>&nbsp;<span class="op" id="1942821">:=</span>&nbsp;<span class="ident" id="1942824"><a href="/runtime/alg.go.html#1872365">goalg</a></span><span class="op" id="1942829">(</span><span class="ident" id="1942830"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1942831">.</span><span class="ident" id="1942832">key</span><span class="op" id="1942835">.</span><span class="ident" id="1942836">alg</span><span class="op" id="1942839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942842">hash</span>&nbsp;<span class="op" id="1942847">:=</span>&nbsp;<span class="ident" id="1942850"><a href="/runtime/hashmap.go.html#1942817">alg</a></span><span class="op" id="1942853">.</span><span class="ident" id="1942854">hash</span><span class="op" id="1942858">(</span><span class="ident" id="1942859"><a href="/runtime/hashmap.go.html#1942554">key</a></span><span class="op" id="1942862">,</span>&nbsp;<span class="builtintype" id="1942864">uintptr</span><span class="op" id="1942871">(</span><span class="ident" id="1942872"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1942873">.</span><span class="ident" id="1942874">key</span><span class="op" id="1942877">.</span><span class="ident" id="1942878">size</span><span class="op" id="1942882">)</span><span class="op" id="1942883">,</span>&nbsp;<span class="builtintype" id="1942885">uintptr</span><span class="op" id="1942892">(</span><span class="ident" id="1942893"><a href="/runtime/hashmap.go.html#1942545">h</a></span><span class="op" id="1942894">.</span><span class="ident" id="1942895">hash0</span><span class="op" id="1942900">)</span><span class="op" id="1942901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942904">bucket</span>&nbsp;<span class="op" id="1942911">:=</span>&nbsp;<span class="ident" id="1942914"><a href="/runtime/hashmap.go.html#1942842">hash</a></span>&nbsp;<span class="op" id="1942919">&amp;</span>&nbsp;<span class="op" id="1942921">(</span><span class="builtintype" id="1942922">uintptr</span><span class="op" id="1942929">(</span><span class="num" id="1942930">1</span><span class="op" id="1942931">)</span><span class="op" id="1942932">&lt;&lt;</span><span class="ident" id="1942934"><a href="/runtime/hashmap.go.html#1942545">h</a></span><span class="op" id="1942935">.</span><span class="ident" id="1942936">B</span>&nbsp;<span class="op" id="1942938">-</span>&nbsp;<span class="num" id="1942940">1</span><span class="op" id="1942941">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1942944">if</span>&nbsp;<span class="ident" id="1942947"><a href="/runtime/hashmap.go.html#1942545">h</a></span><span class="op" id="1942948">.</span><span class="ident" id="1942949">oldbuckets</span>&nbsp;<span class="op" id="1942960">!=</span>&nbsp;<span class="ident" id="1942963">nil</span>&nbsp;<span class="op" id="1942967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942971"><a href="/runtime/hashmap.go.html#1949839">growWork</a></span><span class="op" id="1942979">(</span><span class="ident" id="1942980"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1942981">,</span>&nbsp;<span class="ident" id="1942983"><a href="/runtime/hashmap.go.html#1942545">h</a></span><span class="op" id="1942984">,</span>&nbsp;<span class="ident" id="1942986"><a href="/runtime/hashmap.go.html#1942904">bucket</a></span><span class="op" id="1942992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1942995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1942998">b</span>&nbsp;<span class="op" id="1943000">:=</span>&nbsp;<span class="op" id="1943003">(</span><span class="op" id="1943004">*</span><span class="ident" id="1943005"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1943009">)</span><span class="op" id="1943010">(</span><span class="ident" id="1943011"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1943017">.</span><span class="ident" id="1943018">Pointer</span><span class="op" id="1943025">(</span><span class="builtintype" id="1943026">uintptr</span><span class="op" id="1943033">(</span><span class="ident" id="1943034"><a href="/runtime/hashmap.go.html#1942545">h</a></span><span class="op" id="1943035">.</span><span class="ident" id="1943036">buckets</span><span class="op" id="1943043">)</span>&nbsp;<span class="op" id="1943045">+</span>&nbsp;<span class="ident" id="1943047"><a href="/runtime/hashmap.go.html#1942904">bucket</a></span><span class="op" id="1943053">*</span><span class="builtintype" id="1943054">uintptr</span><span class="op" id="1943061">(</span><span class="ident" id="1943062"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1943063">.</span><span class="ident" id="1943064">bucketsize</span><span class="op" id="1943074">)</span><span class="op" id="1943075">)</span><span class="op" id="1943076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943079">top</span>&nbsp;<span class="op" id="1943083">:=</span>&nbsp;<span class="builtintype" id="1943086">uint8</span><span class="op" id="1943091">(</span><span class="ident" id="1943092"><a href="/runtime/hashmap.go.html#1942842">hash</a></span>&nbsp;<span class="op" id="1943097">&gt;&gt;</span>&nbsp;<span class="op" id="1943100">(</span><span class="ident" id="1943101"><a href="/runtime/stubs.go.html#2131510">ptrSize</a></span><span class="op" id="1943108">*</span><span class="num" id="1943109">8</span>&nbsp;<span class="op" id="1943111">-</span>&nbsp;<span class="num" id="1943113">8</span><span class="op" id="1943114">)</span><span class="op" id="1943115">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943118">if</span>&nbsp;<span class="ident" id="1943121"><a href="/runtime/hashmap.go.html#1943079">top</a></span>&nbsp;<span class="op" id="1943125">&lt;</span>&nbsp;<span class="ident" id="1943127"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span>&nbsp;<span class="op" id="1943138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943142"><a href="/runtime/hashmap.go.html#1943079">top</a></span>&nbsp;<span class="op" id="1943146">+=</span>&nbsp;<span class="ident" id="1943149"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943164">for</span>&nbsp;<span class="op" id="1943168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943172">for</span>&nbsp;<span class="ident" id="1943176">i</span>&nbsp;<span class="op" id="1943178">:=</span>&nbsp;<span class="builtintype" id="1943181">uintptr</span><span class="op" id="1943188">(</span><span class="num" id="1943189">0</span><span class="op" id="1943190">)</span><span class="op" id="1943191">;</span>&nbsp;<span class="ident" id="1943193"><a href="/runtime/hashmap.go.html#1943176">i</a></span>&nbsp;<span class="op" id="1943195">&lt;</span>&nbsp;<span class="ident" id="1943197"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1943206">;</span>&nbsp;<span class="ident" id="1943208"><a href="/runtime/hashmap.go.html#1943176">i</a></span><span class="op" id="1943209">++</span>&nbsp;<span class="op" id="1943212">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943217">if</span>&nbsp;<span class="ident" id="1943220"><a href="/runtime/hashmap.go.html#1942998">b</a></span><span class="op" id="1943221">.</span><span class="ident" id="1943222">tophash</span><span class="op" id="1943229">[</span><span class="ident" id="1943230"><a href="/runtime/hashmap.go.html#1943176">i</a></span><span class="op" id="1943231">]</span>&nbsp;<span class="op" id="1943233">!=</span>&nbsp;<span class="ident" id="1943236"><a href="/runtime/hashmap.go.html#1943079">top</a></span>&nbsp;<span class="op" id="1943240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943246">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943263">k</span>&nbsp;<span class="op" id="1943265">:=</span>&nbsp;<span class="ident" id="1943268"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1943271">(</span><span class="ident" id="1943272"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1943278">.</span><span class="ident" id="1943279">Pointer</span><span class="op" id="1943286">(</span><span class="ident" id="1943287"><a href="/runtime/hashmap.go.html#1942998">b</a></span><span class="op" id="1943288">)</span><span class="op" id="1943289">,</span>&nbsp;<span class="ident" id="1943291"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1943301">+</span><span class="ident" id="1943302"><a href="/runtime/hashmap.go.html#1943176">i</a></span><span class="op" id="1943303">*</span><span class="builtintype" id="1943304">uintptr</span><span class="op" id="1943311">(</span><span class="ident" id="1943312"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1943313">.</span><span class="ident" id="1943314">keysize</span><span class="op" id="1943321">)</span><span class="op" id="1943322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943327">k2</span>&nbsp;<span class="op" id="1943330">:=</span>&nbsp;<span class="ident" id="1943333"><a href="/runtime/hashmap.go.html#1943263">k</a></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943338">if</span>&nbsp;<span class="ident" id="1943341"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1943342">.</span><span class="ident" id="1943343">indirectkey</span>&nbsp;<span class="op" id="1943355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943361"><a href="/runtime/hashmap.go.html#1943327">k2</a></span>&nbsp;<span class="op" id="1943364">=</span>&nbsp;<span class="op" id="1943366">*</span><span class="op" id="1943367">(</span><span class="op" id="1943368">(</span><span class="op" id="1943369">*</span><span class="ident" id="1943370"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1943376">.</span><span class="ident" id="1943377">Pointer</span><span class="op" id="1943384">)</span><span class="op" id="1943385">(</span><span class="ident" id="1943386"><a href="/runtime/hashmap.go.html#1943327">k2</a></span><span class="op" id="1943388">)</span><span class="op" id="1943389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943399">if</span>&nbsp;<span class="op" id="1943402">!</span><span class="ident" id="1943403"><a href="/runtime/hashmap.go.html#1942817">alg</a></span><span class="op" id="1943406">.</span><span class="ident" id="1943407">equal</span><span class="op" id="1943412">(</span><span class="ident" id="1943413"><a href="/runtime/hashmap.go.html#1942554">key</a></span><span class="op" id="1943416">,</span>&nbsp;<span class="ident" id="1943418"><a href="/runtime/hashmap.go.html#1943327">k2</a></span><span class="op" id="1943420">,</span>&nbsp;<span class="builtintype" id="1943422">uintptr</span><span class="op" id="1943429">(</span><span class="ident" id="1943430"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1943431">.</span><span class="ident" id="1943432">key</span><span class="op" id="1943435">.</span><span class="ident" id="1943436">size</span><span class="op" id="1943440">)</span><span class="op" id="1943441">)</span>&nbsp;<span class="op" id="1943443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943449">continue</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943466"><a href="/runtime/stubs.go.html#2135687">memclr</a></span><span class="op" id="1943472">(</span><span class="ident" id="1943473"><a href="/runtime/hashmap.go.html#1943263">k</a></span><span class="op" id="1943474">,</span>&nbsp;<span class="builtintype" id="1943476">uintptr</span><span class="op" id="1943483">(</span><span class="ident" id="1943484"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1943485">.</span><span class="ident" id="1943486">keysize</span><span class="op" id="1943493">)</span><span class="op" id="1943494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943499">v</span>&nbsp;<span class="op" id="1943501">:=</span>&nbsp;<span class="ident" id="1943504"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1943510">.</span><span class="ident" id="1943511">Pointer</span><span class="op" id="1943518">(</span><span class="builtintype" id="1943519">uintptr</span><span class="op" id="1943526">(</span><span class="ident" id="1943527"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1943533">.</span><span class="ident" id="1943534">Pointer</span><span class="op" id="1943541">(</span><span class="ident" id="1943542"><a href="/runtime/hashmap.go.html#1942998">b</a></span><span class="op" id="1943543">)</span><span class="op" id="1943544">)</span>&nbsp;<span class="op" id="1943546">+</span>&nbsp;<span class="ident" id="1943548"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span>&nbsp;<span class="op" id="1943559">+</span>&nbsp;<span class="ident" id="1943561"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1943570">*</span><span class="builtintype" id="1943571">uintptr</span><span class="op" id="1943578">(</span><span class="ident" id="1943579"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1943580">.</span><span class="ident" id="1943581">keysize</span><span class="op" id="1943588">)</span>&nbsp;<span class="op" id="1943590">+</span>&nbsp;<span class="ident" id="1943592"><a href="/runtime/hashmap.go.html#1943176">i</a></span><span class="op" id="1943593">*</span><span class="builtintype" id="1943594">uintptr</span><span class="op" id="1943601">(</span><span class="ident" id="1943602"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1943603">.</span><span class="ident" id="1943604">valuesize</span><span class="op" id="1943613">)</span><span class="op" id="1943614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943619"><a href="/runtime/stubs.go.html#2135687">memclr</a></span><span class="op" id="1943625">(</span><span class="ident" id="1943626"><a href="/runtime/hashmap.go.html#1943499">v</a></span><span class="op" id="1943627">,</span>&nbsp;<span class="builtintype" id="1943629">uintptr</span><span class="op" id="1943636">(</span><span class="ident" id="1943637"><a href="/runtime/hashmap.go.html#1942533">t</a></span><span class="op" id="1943638">.</span><span class="ident" id="1943639">valuesize</span><span class="op" id="1943648">)</span><span class="op" id="1943649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943654"><a href="/runtime/hashmap.go.html#1942998">b</a></span><span class="op" id="1943655">.</span><span class="ident" id="1943656">tophash</span><span class="op" id="1943663">[</span><span class="ident" id="1943664"><a href="/runtime/hashmap.go.html#1943176">i</a></span><span class="op" id="1943665">]</span>&nbsp;<span class="op" id="1943667">=</span>&nbsp;<span class="ident" id="1943669"><a href="/runtime/hashmap.go.html#1930582">empty</a></span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943678"><a href="/runtime/hashmap.go.html#1942545">h</a></span><span class="op" id="1943679">.</span><span class="ident" id="1943680">count</span><span class="op" id="1943685">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943691">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943704"><a href="/runtime/hashmap.go.html#1942998">b</a></span>&nbsp;<span class="op" id="1943706">=</span>&nbsp;<span class="ident" id="1943708"><a href="/runtime/hashmap.go.html#1942998">b</a></span><span class="op" id="1943709">.</span><span class="ident" id="1943710">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943721">if</span>&nbsp;<span class="ident" id="1943724"><a href="/runtime/hashmap.go.html#1942998">b</a></span>&nbsp;<span class="op" id="1943726">==</span>&nbsp;<span class="ident" id="1943729">nil</span>&nbsp;<span class="op" id="1943733">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943738">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1943750">}</span><br>
<span class="lineno"></span><span class="op" id="1943752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="keyword" id="1943755">func</span>&nbsp;<span class="ident" id="1943760">mapiterinit</span><span class="op" id="1943771">(</span><span class="ident" id="1943772">t</span>&nbsp;<span class="op" id="1943774">*</span><span class="ident" id="1943775"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1943782">,</span>&nbsp;<span class="ident" id="1943784">h</span>&nbsp;<span class="op" id="1943786">*</span><span class="ident" id="1943787"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1943791">,</span>&nbsp;<span class="ident" id="1943793">it</span>&nbsp;<span class="op" id="1943796">*</span><span class="ident" id="1943797"><a href="/runtime/hashmap.go.html#1932443">hiter</a></span><span class="op" id="1943802">)</span>&nbsp;<span class="op" id="1943804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1943807">//&nbsp;Clear&nbsp;pointer&nbsp;fields&nbsp;so&nbsp;garbage&nbsp;collector&nbsp;does&nbsp;not&nbsp;complain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943872"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1943874">.</span><span class="ident" id="1943875">key</span>&nbsp;<span class="op" id="1943879">=</span>&nbsp;<span class="ident" id="1943881">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943886"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1943888">.</span><span class="ident" id="1943889">value</span>&nbsp;<span class="op" id="1943895">=</span>&nbsp;<span class="ident" id="1943897">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943902"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1943904">.</span><span class="ident" id="1943905">t</span>&nbsp;<span class="op" id="1943907">=</span>&nbsp;<span class="ident" id="1943909">nil</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943914"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1943916">.</span><span class="ident" id="1943917">h</span>&nbsp;<span class="op" id="1943919">=</span>&nbsp;<span class="ident" id="1943921">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943926"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1943928">.</span><span class="ident" id="1943929">buckets</span>&nbsp;<span class="op" id="1943937">=</span>&nbsp;<span class="ident" id="1943939">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943944"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1943946">.</span><span class="ident" id="1943947">bptr</span>&nbsp;<span class="op" id="1943952">=</span>&nbsp;<span class="ident" id="1943954">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1943960">if</span>&nbsp;<span class="ident" id="1943963"><a href="/runtime/race0.go.html#2069616">raceenabled</a></span>&nbsp;<span class="op" id="1943975">&amp;&amp;</span>&nbsp;<span class="ident" id="1943978"><a href="/runtime/hashmap.go.html#1943784">h</a></span>&nbsp;<span class="op" id="1943980">!=</span>&nbsp;<span class="ident" id="1943983">nil</span>&nbsp;<span class="op" id="1943987">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1943991">callerpc</span>&nbsp;<span class="op" id="1944000">:=</span>&nbsp;<span class="ident" id="1944003"><a href="/runtime/stubs.go.html#2139499">getcallerpc</a></span><span class="op" id="1944014">(</span><span class="ident" id="1944015"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1944021">.</span><span class="ident" id="1944022">Pointer</span><span class="op" id="1944029">(</span><span class="op" id="1944030">&amp;</span><span class="ident" id="1944031"><a href="/runtime/hashmap.go.html#1943772">t</a></span><span class="op" id="1944032">)</span><span class="op" id="1944033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944037"><a href="/runtime/race0.go.html#2070294">racereadpc</a></span><span class="op" id="1944047">(</span><span class="ident" id="1944048"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1944054">.</span><span class="ident" id="1944055">Pointer</span><span class="op" id="1944062">(</span><span class="ident" id="1944063"><a href="/runtime/hashmap.go.html#1943784">h</a></span><span class="op" id="1944064">)</span><span class="op" id="1944065">,</span>&nbsp;<span class="ident" id="1944067"><a href="/runtime/hashmap.go.html#1943991">callerpc</a></span><span class="op" id="1944075">,</span>&nbsp;<span class="ident" id="1944077"><a href="/runtime/proc.go.html#2068560">funcPC</a></span><span class="op" id="1944083">(</span><span class="ident" id="1944084"><a href="/runtime/hashmap.go.html#1943760">mapiterinit</a></span><span class="op" id="1944095">)</span><span class="op" id="1944096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1944099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944103">if</span>&nbsp;<span class="ident" id="1944106"><a href="/runtime/hashmap.go.html#1943784">h</a></span>&nbsp;<span class="op" id="1944108">==</span>&nbsp;<span class="ident" id="1944111">nil</span>&nbsp;<span class="op" id="1944115">||</span>&nbsp;<span class="ident" id="1944118"><a href="/runtime/hashmap.go.html#1943784">h</a></span><span class="op" id="1944119">.</span><span class="ident" id="1944120">count</span>&nbsp;<span class="op" id="1944126">==</span>&nbsp;<span class="num" id="1944129">0</span>&nbsp;<span class="op" id="1944131">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944135"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944137">.</span><span class="ident" id="1944138">key</span>&nbsp;<span class="op" id="1944142">=</span>&nbsp;<span class="ident" id="1944144">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944150"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944152">.</span><span class="ident" id="1944153">value</span>&nbsp;<span class="op" id="1944159">=</span>&nbsp;<span class="ident" id="1944161">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944167">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1944175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944179">if</span>&nbsp;<span class="ident" id="1944182"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1944188">.</span><span class="ident" id="1944189">Sizeof</span><span class="op" id="1944195">(</span><span class="ident" id="1944196"><a href="/runtime/hashmap.go.html#1932443">hiter</a></span><span class="op" id="1944201">{</span><span class="op" id="1944202">}</span><span class="op" id="1944203">)</span><span class="op" id="1944204">/</span><span class="ident" id="1944205"><a href="/runtime/stubs.go.html#2131510">ptrSize</a></span>&nbsp;<span class="op" id="1944213">!=</span>&nbsp;<span class="num" id="1944216">10</span>&nbsp;<span class="op" id="1944219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944223"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1944230">(</span><span class="string" id="1944231">&#34;hash_iter&nbsp;size&nbsp;incorrect&#34;</span><span class="op" id="1944257">)</span>&nbsp;<span class="comment" id="1944259">//&nbsp;see&nbsp;../../cmd/gc/reflect.c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1944290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944293"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944295">.</span><span class="ident" id="1944296">t</span>&nbsp;<span class="op" id="1944298">=</span>&nbsp;<span class="ident" id="1944300"><a href="/runtime/hashmap.go.html#1943772">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944303"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944305">.</span><span class="ident" id="1944306">h</span>&nbsp;<span class="op" id="1944308">=</span>&nbsp;<span class="ident" id="1944310"><a href="/runtime/hashmap.go.html#1943784">h</a></span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1944314">//&nbsp;grab&nbsp;snapshot&nbsp;of&nbsp;bucket&nbsp;state</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944348"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944350">.</span><span class="ident" id="1944351">B</span>&nbsp;<span class="op" id="1944353">=</span>&nbsp;<span class="ident" id="1944355"><a href="/runtime/hashmap.go.html#1943784">h</a></span><span class="op" id="1944356">.</span><span class="ident" id="1944357">B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944360"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944362">.</span><span class="ident" id="1944363">buckets</span>&nbsp;<span class="op" id="1944371">=</span>&nbsp;<span class="ident" id="1944373"><a href="/runtime/hashmap.go.html#1943784">h</a></span><span class="op" id="1944374">.</span><span class="ident" id="1944375">buckets</span><br>
<span class="lineno"></span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1944385">//&nbsp;decide&nbsp;where&nbsp;to&nbsp;start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944411">r</span>&nbsp;<span class="op" id="1944413">:=</span>&nbsp;<span class="builtintype" id="1944416">uintptr</span><span class="op" id="1944423">(</span><span class="ident" id="1944424"><a href="/runtime/stubs.go.html#2136047">fastrand1</a></span><span class="op" id="1944433">(</span><span class="op" id="1944434">)</span><span class="op" id="1944435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944438">if</span>&nbsp;<span class="ident" id="1944441"><a href="/runtime/hashmap.go.html#1943784">h</a></span><span class="op" id="1944442">.</span><span class="ident" id="1944443">B</span>&nbsp;<span class="op" id="1944445">&gt;</span>&nbsp;<span class="num" id="1944447">31</span><span class="op" id="1944449">-</span><span class="ident" id="1944450"><a href="/runtime/hashmap.go.html#1929578">bucketCntBits</a></span>&nbsp;<span class="op" id="1944464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944468"><a href="/runtime/hashmap.go.html#1944411">r</a></span>&nbsp;<span class="op" id="1944470">+=</span>&nbsp;<span class="builtintype" id="1944473">uintptr</span><span class="op" id="1944480">(</span><span class="ident" id="1944481"><a href="/runtime/stubs.go.html#2136047">fastrand1</a></span><span class="op" id="1944490">(</span><span class="op" id="1944491">)</span><span class="op" id="1944492">)</span>&nbsp;<span class="op" id="1944494">&lt;&lt;</span>&nbsp;<span class="num" id="1944497">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1944501">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944504"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944506">.</span><span class="ident" id="1944507">startBucket</span>&nbsp;<span class="op" id="1944519">=</span>&nbsp;<span class="ident" id="1944521"><a href="/runtime/hashmap.go.html#1944411">r</a></span>&nbsp;<span class="op" id="1944523">&amp;</span>&nbsp;<span class="op" id="1944525">(</span><span class="builtintype" id="1944526">uintptr</span><span class="op" id="1944533">(</span><span class="num" id="1944534">1</span><span class="op" id="1944535">)</span><span class="op" id="1944536">&lt;&lt;</span><span class="ident" id="1944538"><a href="/runtime/hashmap.go.html#1943784">h</a></span><span class="op" id="1944539">.</span><span class="ident" id="1944540">B</span>&nbsp;<span class="op" id="1944542">-</span>&nbsp;<span class="num" id="1944544">1</span><span class="op" id="1944545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944548"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944550">.</span><span class="ident" id="1944551">offset</span>&nbsp;<span class="op" id="1944558">=</span>&nbsp;<span class="builtintype" id="1944560">uint8</span><span class="op" id="1944565">(</span><span class="ident" id="1944566"><a href="/runtime/hashmap.go.html#1944411">r</a></span>&nbsp;<span class="op" id="1944568">&gt;&gt;</span>&nbsp;<span class="ident" id="1944571"><a href="/runtime/hashmap.go.html#1943784">h</a></span><span class="op" id="1944572">.</span><span class="ident" id="1944573">B</span>&nbsp;<span class="op" id="1944575">&amp;</span>&nbsp;<span class="op" id="1944577">(</span><span class="ident" id="1944578"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span>&nbsp;<span class="op" id="1944588">-</span>&nbsp;<span class="num" id="1944590">1</span><span class="op" id="1944591">)</span><span class="op" id="1944592">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1944596">//&nbsp;iterator&nbsp;state</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944615"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944617">.</span><span class="ident" id="1944618">bucket</span>&nbsp;<span class="op" id="1944625">=</span>&nbsp;<span class="ident" id="1944627"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944629">.</span><span class="ident" id="1944630">startBucket</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944643"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944645">.</span><span class="ident" id="1944646">wrapped</span>&nbsp;<span class="op" id="1944654">=</span>&nbsp;<span class="builtintype" id="1944656">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944663"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944665">.</span><span class="ident" id="1944666">bptr</span>&nbsp;<span class="op" id="1944671">=</span>&nbsp;<span class="ident" id="1944673">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1944679">//&nbsp;Remember&nbsp;we&nbsp;have&nbsp;an&nbsp;iterator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1944713">//&nbsp;Can&nbsp;run&nbsp;concurrently&nbsp;with&nbsp;another&nbsp;hash_iter_init().</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944769">for</span>&nbsp;<span class="op" id="1944773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944777">old</span>&nbsp;<span class="op" id="1944781">:=</span>&nbsp;<span class="ident" id="1944784"><a href="/runtime/hashmap.go.html#1943784">h</a></span><span class="op" id="1944785">.</span><span class="ident" id="1944786">flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944794">if</span>&nbsp;<span class="ident" id="1944797"><a href="/runtime/hashmap.go.html#1944777">old</a></span>&nbsp;<span class="op" id="1944801">==</span>&nbsp;<span class="ident" id="1944804"><a href="/runtime/hashmap.go.html#1944777">old</a></span><span class="op" id="1944807">|</span><span class="ident" id="1944808"><a href="/runtime/hashmap.go.html#1930938">iterator</a></span><span class="op" id="1944816">|</span><span class="ident" id="1944817"><a href="/runtime/hashmap.go.html#1930997">oldIterator</a></span>&nbsp;<span class="op" id="1944829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944834">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1944842">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944846">if</span>&nbsp;<span class="ident" id="1944849"><a href="/runtime/stubs.go.html#2137846">cas</a></span><span class="op" id="1944852">(</span><span class="op" id="1944853">&amp;</span><span class="ident" id="1944854"><a href="/runtime/hashmap.go.html#1943784">h</a></span><span class="op" id="1944855">.</span><span class="ident" id="1944856">flags</span><span class="op" id="1944861">,</span>&nbsp;<span class="ident" id="1944863"><a href="/runtime/hashmap.go.html#1944777">old</a></span><span class="op" id="1944866">,</span>&nbsp;<span class="ident" id="1944868"><a href="/runtime/hashmap.go.html#1944777">old</a></span><span class="op" id="1944871">|</span><span class="ident" id="1944872"><a href="/runtime/hashmap.go.html#1930938">iterator</a></span><span class="op" id="1944880">|</span><span class="ident" id="1944881"><a href="/runtime/hashmap.go.html#1930997">oldIterator</a></span><span class="op" id="1944892">)</span>&nbsp;<span class="op" id="1944894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944899">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1944907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1944910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944914"><a href="/runtime/hashmap.go.html#1944938">mapiternext</a></span><span class="op" id="1944925">(</span><span class="ident" id="1944926"><a href="/runtime/hashmap.go.html#1943793">it</a></span><span class="op" id="1944928">)</span><br>
<span class="lineno"></span><span class="op" id="1944930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1944933">func</span>&nbsp;<span class="ident" id="1944938">mapiternext</span><span class="op" id="1944949">(</span><span class="ident" id="1944950">it</span>&nbsp;<span class="op" id="1944953">*</span><span class="ident" id="1944954"><a href="/runtime/hashmap.go.html#1932443">hiter</a></span><span class="op" id="1944959">)</span>&nbsp;<span class="op" id="1944961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944964">h</span>&nbsp;<span class="op" id="1944966">:=</span>&nbsp;<span class="ident" id="1944969"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1944971">.</span><span class="ident" id="1944972">h</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1944975">if</span>&nbsp;<span class="ident" id="1944978"><a href="/runtime/race0.go.html#2069616">raceenabled</a></span>&nbsp;<span class="op" id="1944990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1944994">callerpc</span>&nbsp;<span class="op" id="1945003">:=</span>&nbsp;<span class="ident" id="1945006"><a href="/runtime/stubs.go.html#2139499">getcallerpc</a></span><span class="op" id="1945017">(</span><span class="ident" id="1945018"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1945024">.</span><span class="ident" id="1945025">Pointer</span><span class="op" id="1945032">(</span><span class="op" id="1945033">&amp;</span><span class="ident" id="1945034"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945036">)</span><span class="op" id="1945037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945041"><a href="/runtime/race0.go.html#2070294">racereadpc</a></span><span class="op" id="1945051">(</span><span class="ident" id="1945052"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1945058">.</span><span class="ident" id="1945059">Pointer</span><span class="op" id="1945066">(</span><span class="ident" id="1945067"><a href="/runtime/hashmap.go.html#1944964">h</a></span><span class="op" id="1945068">)</span><span class="op" id="1945069">,</span>&nbsp;<span class="ident" id="1945071"><a href="/runtime/hashmap.go.html#1944994">callerpc</a></span><span class="op" id="1945079">,</span>&nbsp;<span class="ident" id="1945081"><a href="/runtime/proc.go.html#2068560">funcPC</a></span><span class="op" id="1945087">(</span><span class="ident" id="1945088"><a href="/runtime/hashmap.go.html#1944938">mapiternext</a></span><span class="op" id="1945099">)</span><span class="op" id="1945100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1945103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945106">t</span>&nbsp;<span class="op" id="1945108">:=</span>&nbsp;<span class="ident" id="1945111"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945113">.</span><span class="ident" id="1945114">t</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945117">bucket</span>&nbsp;<span class="op" id="1945124">:=</span>&nbsp;<span class="ident" id="1945127"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945129">.</span><span class="ident" id="1945130">bucket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945138">b</span>&nbsp;<span class="op" id="1945140">:=</span>&nbsp;<span class="ident" id="1945143"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945145">.</span><span class="ident" id="1945146">bptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945152">i</span>&nbsp;<span class="op" id="1945154">:=</span>&nbsp;<span class="ident" id="1945157"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945159">.</span><span class="ident" id="1945160">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945163">checkBucket</span>&nbsp;<span class="op" id="1945175">:=</span>&nbsp;<span class="ident" id="1945178"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945180">.</span><span class="ident" id="1945181">checkBucket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945194">alg</span>&nbsp;<span class="op" id="1945198">:=</span>&nbsp;<span class="ident" id="1945201"><a href="/runtime/alg.go.html#1872365">goalg</a></span><span class="op" id="1945206">(</span><span class="ident" id="1945207"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1945208">.</span><span class="ident" id="1945209">key</span><span class="op" id="1945212">.</span><span class="ident" id="1945213">alg</span><span class="op" id="1945216">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span><span class="ident" id="1945219">next</span><span class="op" id="1945223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945226">if</span>&nbsp;<span class="ident" id="1945229"><a href="/runtime/hashmap.go.html#1945138">b</a></span>&nbsp;<span class="op" id="1945231">==</span>&nbsp;<span class="ident" id="1945234">nil</span>&nbsp;<span class="op" id="1945238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945242">if</span>&nbsp;<span class="ident" id="1945245"><a href="/runtime/hashmap.go.html#1945117">bucket</a></span>&nbsp;<span class="op" id="1945252">==</span>&nbsp;<span class="ident" id="1945255"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945257">.</span><span class="ident" id="1945258">startBucket</span>&nbsp;<span class="op" id="1945270">&amp;&amp;</span>&nbsp;<span class="ident" id="1945273"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945275">.</span><span class="ident" id="1945276">wrapped</span>&nbsp;<span class="op" id="1945284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1945289">//&nbsp;end&nbsp;of&nbsp;iteration</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945312"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945314">.</span><span class="ident" id="1945315">key</span>&nbsp;<span class="op" id="1945319">=</span>&nbsp;<span class="ident" id="1945321">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945328"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945330">.</span><span class="ident" id="1945331">value</span>&nbsp;<span class="op" id="1945337">=</span>&nbsp;<span class="ident" id="1945339">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945346">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1945355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945359">if</span>&nbsp;<span class="ident" id="1945362"><a href="/runtime/hashmap.go.html#1944964">h</a></span><span class="op" id="1945363">.</span><span class="ident" id="1945364">oldbuckets</span>&nbsp;<span class="op" id="1945375">!=</span>&nbsp;<span class="ident" id="1945378">nil</span>&nbsp;<span class="op" id="1945382">&amp;&amp;</span>&nbsp;<span class="ident" id="1945385"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945387">.</span><span class="ident" id="1945388">B</span>&nbsp;<span class="op" id="1945390">==</span>&nbsp;<span class="ident" id="1945393"><a href="/runtime/hashmap.go.html#1944964">h</a></span><span class="op" id="1945394">.</span><span class="ident" id="1945395">B</span>&nbsp;<span class="op" id="1945397">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1945402">//&nbsp;Iterator&nbsp;was&nbsp;started&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;a&nbsp;grow,&nbsp;and&nbsp;the&nbsp;grow&nbsp;isn&#39;t&nbsp;done&nbsp;yet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1945483">//&nbsp;If&nbsp;the&nbsp;bucket&nbsp;we&#39;re&nbsp;looking&nbsp;at&nbsp;hasn&#39;t&nbsp;been&nbsp;filled&nbsp;in&nbsp;yet&nbsp;(i.e.&nbsp;the&nbsp;old</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1945560">//&nbsp;bucket&nbsp;hasn&#39;t&nbsp;been&nbsp;evacuated)&nbsp;then&nbsp;we&nbsp;need&nbsp;to&nbsp;iterate&nbsp;through&nbsp;the&nbsp;old</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1945636">//&nbsp;bucket&nbsp;and&nbsp;only&nbsp;return&nbsp;the&nbsp;ones&nbsp;that&nbsp;will&nbsp;be&nbsp;migrated&nbsp;to&nbsp;this&nbsp;bucket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945712">oldbucket</span>&nbsp;<span class="op" id="1945722">:=</span>&nbsp;<span class="ident" id="1945725"><a href="/runtime/hashmap.go.html#1945117">bucket</a></span>&nbsp;<span class="op" id="1945732">&amp;</span>&nbsp;<span class="op" id="1945734">(</span><span class="builtintype" id="1945735">uintptr</span><span class="op" id="1945742">(</span><span class="num" id="1945743">1</span><span class="op" id="1945744">)</span><span class="op" id="1945745">&lt;&lt;</span><span class="op" id="1945747">(</span><span class="ident" id="1945748"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945750">.</span><span class="ident" id="1945751">B</span><span class="op" id="1945752">-</span><span class="num" id="1945753">1</span><span class="op" id="1945754">)</span>&nbsp;<span class="op" id="1945756">-</span>&nbsp;<span class="num" id="1945758">1</span><span class="op" id="1945759">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945764"><a href="/runtime/hashmap.go.html#1945138">b</a></span>&nbsp;<span class="op" id="1945766">=</span>&nbsp;<span class="op" id="1945768">(</span><span class="op" id="1945769">*</span><span class="ident" id="1945770"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1945774">)</span><span class="op" id="1945775">(</span><span class="ident" id="1945776"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1945779">(</span><span class="ident" id="1945780"><a href="/runtime/hashmap.go.html#1944964">h</a></span><span class="op" id="1945781">.</span><span class="ident" id="1945782">oldbuckets</span><span class="op" id="1945792">,</span>&nbsp;<span class="ident" id="1945794"><a href="/runtime/hashmap.go.html#1945712">oldbucket</a></span><span class="op" id="1945803">*</span><span class="builtintype" id="1945804">uintptr</span><span class="op" id="1945811">(</span><span class="ident" id="1945812"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1945813">.</span><span class="ident" id="1945814">bucketsize</span><span class="op" id="1945824">)</span><span class="op" id="1945825">)</span><span class="op" id="1945826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1945831">if</span>&nbsp;<span class="op" id="1945834">!</span><span class="ident" id="1945835"><a href="/runtime/hashmap.go.html#1933181">evacuated</a></span><span class="op" id="1945844">(</span><span class="ident" id="1945845"><a href="/runtime/hashmap.go.html#1945138">b</a></span><span class="op" id="1945846">)</span>&nbsp;<span class="op" id="1945848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945854"><a href="/runtime/hashmap.go.html#1945163">checkBucket</a></span>&nbsp;<span class="op" id="1945866">=</span>&nbsp;<span class="ident" id="1945868"><a href="/runtime/hashmap.go.html#1945117">bucket</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1945878">}</span>&nbsp;<span class="keyword" id="1945880">else</span>&nbsp;<span class="op" id="1945885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945891"><a href="/runtime/hashmap.go.html#1945138">b</a></span>&nbsp;<span class="op" id="1945893">=</span>&nbsp;<span class="op" id="1945895">(</span><span class="op" id="1945896">*</span><span class="ident" id="1945897"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1945901">)</span><span class="op" id="1945902">(</span><span class="ident" id="1945903"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1945906">(</span><span class="ident" id="1945907"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1945909">.</span><span class="ident" id="1945910">buckets</span><span class="op" id="1945917">,</span>&nbsp;<span class="ident" id="1945919"><a href="/runtime/hashmap.go.html#1945117">bucket</a></span><span class="op" id="1945925">*</span><span class="builtintype" id="1945926">uintptr</span><span class="op" id="1945933">(</span><span class="ident" id="1945934"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1945935">.</span><span class="ident" id="1945936">bucketsize</span><span class="op" id="1945946">)</span><span class="op" id="1945947">)</span><span class="op" id="1945948">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945954"><a href="/runtime/hashmap.go.html#1945163">checkBucket</a></span>&nbsp;<span class="op" id="1945966">=</span>&nbsp;<span class="ident" id="1945968"><a href="/runtime/hashmap.go.html#1931103">noCheck</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1945979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1945983">}</span>&nbsp;<span class="keyword" id="1945985">else</span>&nbsp;<span class="op" id="1945990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1945995"><a href="/runtime/hashmap.go.html#1945138">b</a></span>&nbsp;<span class="op" id="1945997">=</span>&nbsp;<span class="op" id="1945999">(</span><span class="op" id="1946000">*</span><span class="ident" id="1946001"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1946005">)</span><span class="op" id="1946006">(</span><span class="ident" id="1946007"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1946010">(</span><span class="ident" id="1946011"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1946013">.</span><span class="ident" id="1946014">buckets</span><span class="op" id="1946021">,</span>&nbsp;<span class="ident" id="1946023"><a href="/runtime/hashmap.go.html#1945117">bucket</a></span><span class="op" id="1946029">*</span><span class="builtintype" id="1946030">uintptr</span><span class="op" id="1946037">(</span><span class="ident" id="1946038"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1946039">.</span><span class="ident" id="1946040">bucketsize</span><span class="op" id="1946050">)</span><span class="op" id="1946051">)</span><span class="op" id="1946052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946057"><a href="/runtime/hashmap.go.html#1945163">checkBucket</a></span>&nbsp;<span class="op" id="1946069">=</span>&nbsp;<span class="ident" id="1946071"><a href="/runtime/hashmap.go.html#1931103">noCheck</a></span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1946081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946085"><a href="/runtime/hashmap.go.html#1945117">bucket</a></span><span class="op" id="1946091">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946096">if</span>&nbsp;<span class="ident" id="1946099"><a href="/runtime/hashmap.go.html#1945117">bucket</a></span>&nbsp;<span class="op" id="1946106">==</span>&nbsp;<span class="builtintype" id="1946109">uintptr</span><span class="op" id="1946116">(</span><span class="num" id="1946117">1</span><span class="op" id="1946118">)</span><span class="op" id="1946119">&lt;&lt;</span><span class="ident" id="1946121"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1946123">.</span><span class="ident" id="1946124">B</span>&nbsp;<span class="op" id="1946126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946131"><a href="/runtime/hashmap.go.html#1945117">bucket</a></span>&nbsp;<span class="op" id="1946138">=</span>&nbsp;<span class="num" id="1946140">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946145"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1946147">.</span><span class="ident" id="1946148">wrapped</span>&nbsp;<span class="op" id="1946156">=</span>&nbsp;<span class="builtintype" id="1946158">true</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1946165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946169"><a href="/runtime/hashmap.go.html#1945152">i</a></span>&nbsp;<span class="op" id="1946171">=</span>&nbsp;<span class="num" id="1946173">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1946176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946179">for</span>&nbsp;<span class="op" id="1946183">;</span>&nbsp;<span class="ident" id="1946185"><a href="/runtime/hashmap.go.html#1945152">i</a></span>&nbsp;<span class="op" id="1946187">&lt;</span>&nbsp;<span class="ident" id="1946189"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1946198">;</span>&nbsp;<span class="ident" id="1946200"><a href="/runtime/hashmap.go.html#1945152">i</a></span><span class="op" id="1946201">++</span>&nbsp;<span class="op" id="1946204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946208">offi</span>&nbsp;<span class="op" id="1946213">:=</span>&nbsp;<span class="op" id="1946216">(</span><span class="ident" id="1946217"><a href="/runtime/hashmap.go.html#1945152">i</a></span>&nbsp;<span class="op" id="1946219">+</span>&nbsp;<span class="ident" id="1946221"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1946223">.</span><span class="ident" id="1946224">offset</span><span class="op" id="1946230">)</span>&nbsp;<span class="op" id="1946232">&amp;</span>&nbsp;<span class="op" id="1946234">(</span><span class="ident" id="1946235"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span>&nbsp;<span class="op" id="1946245">-</span>&nbsp;<span class="num" id="1946247">1</span><span class="op" id="1946248">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946252">k</span>&nbsp;<span class="op" id="1946254">:=</span>&nbsp;<span class="ident" id="1946257"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1946260">(</span><span class="ident" id="1946261"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1946267">.</span><span class="ident" id="1946268">Pointer</span><span class="op" id="1946275">(</span><span class="ident" id="1946276"><a href="/runtime/hashmap.go.html#1945138">b</a></span><span class="op" id="1946277">)</span><span class="op" id="1946278">,</span>&nbsp;<span class="ident" id="1946280"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1946290">+</span><span class="builtintype" id="1946291">uintptr</span><span class="op" id="1946298">(</span><span class="ident" id="1946299"><a href="/runtime/hashmap.go.html#1946208">offi</a></span><span class="op" id="1946303">)</span><span class="op" id="1946304">*</span><span class="builtintype" id="1946305">uintptr</span><span class="op" id="1946312">(</span><span class="ident" id="1946313"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1946314">.</span><span class="ident" id="1946315">keysize</span><span class="op" id="1946322">)</span><span class="op" id="1946323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946327">v</span>&nbsp;<span class="op" id="1946329">:=</span>&nbsp;<span class="ident" id="1946332"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1946335">(</span><span class="ident" id="1946336"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1946342">.</span><span class="ident" id="1946343">Pointer</span><span class="op" id="1946350">(</span><span class="ident" id="1946351"><a href="/runtime/hashmap.go.html#1945138">b</a></span><span class="op" id="1946352">)</span><span class="op" id="1946353">,</span>&nbsp;<span class="ident" id="1946355"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1946365">+</span><span class="ident" id="1946366"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1946375">*</span><span class="builtintype" id="1946376">uintptr</span><span class="op" id="1946383">(</span><span class="ident" id="1946384"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1946385">.</span><span class="ident" id="1946386">keysize</span><span class="op" id="1946393">)</span><span class="op" id="1946394">+</span><span class="builtintype" id="1946395">uintptr</span><span class="op" id="1946402">(</span><span class="ident" id="1946403"><a href="/runtime/hashmap.go.html#1946208">offi</a></span><span class="op" id="1946407">)</span><span class="op" id="1946408">*</span><span class="builtintype" id="1946409">uintptr</span><span class="op" id="1946416">(</span><span class="ident" id="1946417"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1946418">.</span><span class="ident" id="1946419">valuesize</span><span class="op" id="1946428">)</span><span class="op" id="1946429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946433">if</span>&nbsp;<span class="ident" id="1946436"><a href="/runtime/hashmap.go.html#1945138">b</a></span><span class="op" id="1946437">.</span><span class="ident" id="1946438">tophash</span><span class="op" id="1946445">[</span><span class="ident" id="1946446"><a href="/runtime/hashmap.go.html#1946208">offi</a></span><span class="op" id="1946450">]</span>&nbsp;<span class="op" id="1946452">!=</span>&nbsp;<span class="ident" id="1946455"><a href="/runtime/hashmap.go.html#1930582">empty</a></span>&nbsp;<span class="op" id="1946461">&amp;&amp;</span>&nbsp;<span class="ident" id="1946464"><a href="/runtime/hashmap.go.html#1945138">b</a></span><span class="op" id="1946465">.</span><span class="ident" id="1946466">tophash</span><span class="op" id="1946473">[</span><span class="ident" id="1946474"><a href="/runtime/hashmap.go.html#1946208">offi</a></span><span class="op" id="1946478">]</span>&nbsp;<span class="op" id="1946480">!=</span>&nbsp;<span class="ident" id="1946483"><a href="/runtime/hashmap.go.html#1930619">evacuatedEmpty</a></span>&nbsp;<span class="op" id="1946498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946503">if</span>&nbsp;<span class="ident" id="1946506"><a href="/runtime/hashmap.go.html#1945163">checkBucket</a></span>&nbsp;<span class="op" id="1946518">!=</span>&nbsp;<span class="ident" id="1946521"><a href="/runtime/hashmap.go.html#1931103">noCheck</a></span>&nbsp;<span class="op" id="1946529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1946535">//&nbsp;Special&nbsp;case:&nbsp;iterator&nbsp;was&nbsp;started&nbsp;during&nbsp;a&nbsp;grow&nbsp;and&nbsp;the</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1946599">//&nbsp;grow&nbsp;is&nbsp;not&nbsp;done&nbsp;yet.&nbsp;&nbsp;We&#39;re&nbsp;working&nbsp;on&nbsp;a&nbsp;bucket&nbsp;whose</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1946661">//&nbsp;oldbucket&nbsp;has&nbsp;not&nbsp;been&nbsp;evacuated&nbsp;yet.&nbsp;&nbsp;Or&nbsp;at&nbsp;least,&nbsp;it&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1946730">//&nbsp;evacuated&nbsp;when&nbsp;we&nbsp;started&nbsp;the&nbsp;bucket.&nbsp;&nbsp;So&nbsp;we&#39;re&nbsp;iterating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1946795">//&nbsp;through&nbsp;the&nbsp;oldbucket,&nbsp;skipping&nbsp;any&nbsp;keys&nbsp;that&nbsp;will&nbsp;go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1946856">//&nbsp;to&nbsp;the&nbsp;other&nbsp;new&nbsp;bucket&nbsp;(each&nbsp;oldbucket&nbsp;expands&nbsp;to&nbsp;two</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1946918">//&nbsp;buckets&nbsp;during&nbsp;a&nbsp;grow).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946949">k2</span>&nbsp;<span class="op" id="1946952">:=</span>&nbsp;<span class="ident" id="1946955"><a href="/runtime/hashmap.go.html#1946252">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1946961">if</span>&nbsp;<span class="ident" id="1946964"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1946965">.</span><span class="ident" id="1946966">indirectkey</span>&nbsp;<span class="op" id="1946978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1946985"><a href="/runtime/hashmap.go.html#1946949">k2</a></span>&nbsp;<span class="op" id="1946988">=</span>&nbsp;<span class="op" id="1946990">*</span><span class="op" id="1946991">(</span><span class="op" id="1946992">(</span><span class="op" id="1946993">*</span><span class="ident" id="1946994"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1947000">.</span><span class="ident" id="1947001">Pointer</span><span class="op" id="1947008">)</span><span class="op" id="1947009">(</span><span class="ident" id="1947010"><a href="/runtime/hashmap.go.html#1946949">k2</a></span><span class="op" id="1947012">)</span><span class="op" id="1947013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947019">}</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947025">if</span>&nbsp;<span class="ident" id="1947028"><a href="/runtime/hashmap.go.html#1945194">alg</a></span><span class="op" id="1947031">.</span><span class="ident" id="1947032">equal</span><span class="op" id="1947037">(</span><span class="ident" id="1947038"><a href="/runtime/hashmap.go.html#1946949">k2</a></span><span class="op" id="1947040">,</span>&nbsp;<span class="ident" id="1947042"><a href="/runtime/hashmap.go.html#1946949">k2</a></span><span class="op" id="1947044">,</span>&nbsp;<span class="builtintype" id="1947046">uintptr</span><span class="op" id="1947053">(</span><span class="ident" id="1947054"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1947055">.</span><span class="ident" id="1947056">key</span><span class="op" id="1947059">.</span><span class="ident" id="1947060">size</span><span class="op" id="1947064">)</span><span class="op" id="1947065">)</span>&nbsp;<span class="op" id="1947067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1947074">//&nbsp;If&nbsp;the&nbsp;item&nbsp;in&nbsp;the&nbsp;oldbucket&nbsp;is&nbsp;not&nbsp;destined&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1947131">//&nbsp;the&nbsp;current&nbsp;new&nbsp;bucket&nbsp;in&nbsp;the&nbsp;iteration,&nbsp;skip&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947189">hash</span>&nbsp;<span class="op" id="1947194">:=</span>&nbsp;<span class="ident" id="1947197"><a href="/runtime/hashmap.go.html#1945194">alg</a></span><span class="op" id="1947200">.</span><span class="ident" id="1947201">hash</span><span class="op" id="1947205">(</span><span class="ident" id="1947206"><a href="/runtime/hashmap.go.html#1946949">k2</a></span><span class="op" id="1947208">,</span>&nbsp;<span class="builtintype" id="1947210">uintptr</span><span class="op" id="1947217">(</span><span class="ident" id="1947218"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1947219">.</span><span class="ident" id="1947220">key</span><span class="op" id="1947223">.</span><span class="ident" id="1947224">size</span><span class="op" id="1947228">)</span><span class="op" id="1947229">,</span>&nbsp;<span class="builtintype" id="1947231">uintptr</span><span class="op" id="1947238">(</span><span class="ident" id="1947239"><a href="/runtime/hashmap.go.html#1944964">h</a></span><span class="op" id="1947240">.</span><span class="ident" id="1947241">hash0</span><span class="op" id="1947246">)</span><span class="op" id="1947247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947254">if</span>&nbsp;<span class="ident" id="1947257"><a href="/runtime/hashmap.go.html#1947189">hash</a></span><span class="op" id="1947261">&amp;</span><span class="op" id="1947262">(</span><span class="builtintype" id="1947263">uintptr</span><span class="op" id="1947270">(</span><span class="num" id="1947271">1</span><span class="op" id="1947272">)</span><span class="op" id="1947273">&lt;&lt;</span><span class="ident" id="1947275"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1947277">.</span><span class="ident" id="1947278">B</span><span class="op" id="1947279">-</span><span class="num" id="1947280">1</span><span class="op" id="1947281">)</span>&nbsp;<span class="op" id="1947283">!=</span>&nbsp;<span class="ident" id="1947286"><a href="/runtime/hashmap.go.html#1945163">checkBucket</a></span>&nbsp;<span class="op" id="1947298">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947306">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947326">}</span>&nbsp;<span class="keyword" id="1947328">else</span>&nbsp;<span class="op" id="1947333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1947340">//&nbsp;Hash&nbsp;isn&#39;t&nbsp;repeatable&nbsp;if&nbsp;k&nbsp;!=&nbsp;k&nbsp;(NaNs).&nbsp;&nbsp;We&nbsp;need&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1947399">//&nbsp;repeatable&nbsp;and&nbsp;randomish&nbsp;choice&nbsp;of&nbsp;which&nbsp;direction</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1947458">//&nbsp;to&nbsp;send&nbsp;NaNs&nbsp;during&nbsp;evacuation.&nbsp;&nbsp;We&#39;ll&nbsp;use&nbsp;the&nbsp;low</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1947517">//&nbsp;bit&nbsp;of&nbsp;tophash&nbsp;to&nbsp;decide&nbsp;which&nbsp;way&nbsp;NaNs&nbsp;go.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1947569">//&nbsp;NOTE:&nbsp;this&nbsp;case&nbsp;is&nbsp;why&nbsp;we&nbsp;need&nbsp;two&nbsp;evacuate&nbsp;tophash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1947629">//&nbsp;values,&nbsp;evacuatedX&nbsp;and&nbsp;evacuatedY,&nbsp;that&nbsp;differ&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1947687">//&nbsp;their&nbsp;low&nbsp;bit.</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947710">if</span>&nbsp;<span class="ident" id="1947713"><a href="/runtime/hashmap.go.html#1945163">checkBucket</a></span><span class="op" id="1947724">&gt;&gt;</span><span class="op" id="1947726">(</span><span class="ident" id="1947727"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1947729">.</span><span class="ident" id="1947730">B</span><span class="op" id="1947731">-</span><span class="num" id="1947732">1</span><span class="op" id="1947733">)</span>&nbsp;<span class="op" id="1947735">!=</span>&nbsp;<span class="builtintype" id="1947738">uintptr</span><span class="op" id="1947745">(</span><span class="ident" id="1947746"><a href="/runtime/hashmap.go.html#1945138">b</a></span><span class="op" id="1947747">.</span><span class="ident" id="1947748">tophash</span><span class="op" id="1947755">[</span><span class="ident" id="1947756"><a href="/runtime/hashmap.go.html#1946208">offi</a></span><span class="op" id="1947760">]</span><span class="op" id="1947761">&amp;</span><span class="num" id="1947762">1</span><span class="op" id="1947763">)</span>&nbsp;<span class="op" id="1947765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947773">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947798">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947803">if</span>&nbsp;<span class="ident" id="1947806"><a href="/runtime/hashmap.go.html#1945138">b</a></span><span class="op" id="1947807">.</span><span class="ident" id="1947808">tophash</span><span class="op" id="1947815">[</span><span class="ident" id="1947816"><a href="/runtime/hashmap.go.html#1946208">offi</a></span><span class="op" id="1947820">]</span>&nbsp;<span class="op" id="1947822">!=</span>&nbsp;<span class="ident" id="1947825"><a href="/runtime/hashmap.go.html#1930678">evacuatedX</a></span>&nbsp;<span class="op" id="1947836">&amp;&amp;</span>&nbsp;<span class="ident" id="1947839"><a href="/runtime/hashmap.go.html#1945138">b</a></span><span class="op" id="1947840">.</span><span class="ident" id="1947841">tophash</span><span class="op" id="1947848">[</span><span class="ident" id="1947849"><a href="/runtime/hashmap.go.html#1946208">offi</a></span><span class="op" id="1947853">]</span>&nbsp;<span class="op" id="1947855">!=</span>&nbsp;<span class="ident" id="1947858"><a href="/runtime/hashmap.go.html#1930778">evacuatedY</a></span>&nbsp;<span class="op" id="1947869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1947875">//&nbsp;this&nbsp;is&nbsp;the&nbsp;golden&nbsp;data,&nbsp;we&nbsp;can&nbsp;return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1947925">if</span>&nbsp;<span class="ident" id="1947928"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1947929">.</span><span class="ident" id="1947930">indirectkey</span>&nbsp;<span class="op" id="1947942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947949"><a href="/runtime/hashmap.go.html#1946252">k</a></span>&nbsp;<span class="op" id="1947951">=</span>&nbsp;<span class="op" id="1947953">*</span><span class="op" id="1947954">(</span><span class="op" id="1947955">(</span><span class="op" id="1947956">*</span><span class="ident" id="1947957"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1947963">.</span><span class="ident" id="1947964">Pointer</span><span class="op" id="1947971">)</span><span class="op" id="1947972">(</span><span class="ident" id="1947973"><a href="/runtime/hashmap.go.html#1946252">k</a></span><span class="op" id="1947974">)</span><span class="op" id="1947975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1947981">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1947987"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1947989">.</span><span class="ident" id="1947990">key</span>&nbsp;<span class="op" id="1947994">=</span>&nbsp;<span class="ident" id="1947996"><a href="/runtime/hashmap.go.html#1946252">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948002">if</span>&nbsp;<span class="ident" id="1948005"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1948006">.</span><span class="ident" id="1948007">indirectvalue</span>&nbsp;<span class="op" id="1948021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948028"><a href="/runtime/hashmap.go.html#1946327">v</a></span>&nbsp;<span class="op" id="1948030">=</span>&nbsp;<span class="op" id="1948032">*</span><span class="op" id="1948033">(</span><span class="op" id="1948034">(</span><span class="op" id="1948035">*</span><span class="ident" id="1948036"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1948042">.</span><span class="ident" id="1948043">Pointer</span><span class="op" id="1948050">)</span><span class="op" id="1948051">(</span><span class="ident" id="1948052"><a href="/runtime/hashmap.go.html#1946327">v</a></span><span class="op" id="1948053">)</span><span class="op" id="1948054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1948060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948066"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1948068">.</span><span class="ident" id="1948069">value</span>&nbsp;<span class="op" id="1948075">=</span>&nbsp;<span class="ident" id="1948077"><a href="/runtime/hashmap.go.html#1946327">v</a></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1948082">}</span>&nbsp;<span class="keyword" id="1948084">else</span>&nbsp;<span class="op" id="1948089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1948095">//&nbsp;The&nbsp;hash&nbsp;table&nbsp;has&nbsp;grown&nbsp;since&nbsp;the&nbsp;iterator&nbsp;was&nbsp;started.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1948159">//&nbsp;The&nbsp;golden&nbsp;data&nbsp;for&nbsp;this&nbsp;key&nbsp;is&nbsp;now&nbsp;somewhere&nbsp;else.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948218">k2</span>&nbsp;<span class="op" id="1948221">:=</span>&nbsp;<span class="ident" id="1948224"><a href="/runtime/hashmap.go.html#1946252">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948230">if</span>&nbsp;<span class="ident" id="1948233"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1948234">.</span><span class="ident" id="1948235">indirectkey</span>&nbsp;<span class="op" id="1948247">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948254"><a href="/runtime/hashmap.go.html#1948218">k2</a></span>&nbsp;<span class="op" id="1948257">=</span>&nbsp;<span class="op" id="1948259">*</span><span class="op" id="1948260">(</span><span class="op" id="1948261">(</span><span class="op" id="1948262">*</span><span class="ident" id="1948263"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1948269">.</span><span class="ident" id="1948270">Pointer</span><span class="op" id="1948277">)</span><span class="op" id="1948278">(</span><span class="ident" id="1948279"><a href="/runtime/hashmap.go.html#1948218">k2</a></span><span class="op" id="1948281">)</span><span class="op" id="1948282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1948288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948294">if</span>&nbsp;<span class="ident" id="1948297"><a href="/runtime/hashmap.go.html#1945194">alg</a></span><span class="op" id="1948300">.</span><span class="ident" id="1948301">equal</span><span class="op" id="1948306">(</span><span class="ident" id="1948307"><a href="/runtime/hashmap.go.html#1948218">k2</a></span><span class="op" id="1948309">,</span>&nbsp;<span class="ident" id="1948311"><a href="/runtime/hashmap.go.html#1948218">k2</a></span><span class="op" id="1948313">,</span>&nbsp;<span class="builtintype" id="1948315">uintptr</span><span class="op" id="1948322">(</span><span class="ident" id="1948323"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1948324">.</span><span class="ident" id="1948325">key</span><span class="op" id="1948328">.</span><span class="ident" id="1948329">size</span><span class="op" id="1948333">)</span><span class="op" id="1948334">)</span>&nbsp;<span class="op" id="1948336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1948343">//&nbsp;Check&nbsp;the&nbsp;current&nbsp;hash&nbsp;table&nbsp;for&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1948394">//&nbsp;This&nbsp;code&nbsp;handles&nbsp;the&nbsp;case&nbsp;where&nbsp;the&nbsp;key</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1948443">//&nbsp;has&nbsp;been&nbsp;deleted,&nbsp;updated,&nbsp;or&nbsp;deleted&nbsp;and&nbsp;reinserted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1948505">//&nbsp;NOTE:&nbsp;we&nbsp;need&nbsp;to&nbsp;regrab&nbsp;the&nbsp;key&nbsp;as&nbsp;it&nbsp;has&nbsp;potentially&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1948572">//&nbsp;updated&nbsp;to&nbsp;an&nbsp;equal()&nbsp;but&nbsp;not&nbsp;identical&nbsp;key&nbsp;(e.g.&nbsp;+0.0&nbsp;vs&nbsp;-0.0).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948645">rk</span><span class="op" id="1948647">,</span>&nbsp;<span class="ident" id="1948649">rv</span>&nbsp;<span class="op" id="1948652">:=</span>&nbsp;<span class="ident" id="1948655"><a href="/runtime/hashmap.go.html#1938488">mapaccessK</a></span><span class="op" id="1948665">(</span><span class="ident" id="1948666"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1948667">,</span>&nbsp;<span class="ident" id="1948669"><a href="/runtime/hashmap.go.html#1944964">h</a></span><span class="op" id="1948670">,</span>&nbsp;<span class="ident" id="1948672"><a href="/runtime/hashmap.go.html#1948218">k2</a></span><span class="op" id="1948674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948681">if</span>&nbsp;<span class="ident" id="1948684"><a href="/runtime/hashmap.go.html#1948645">rk</a></span>&nbsp;<span class="op" id="1948687">==</span>&nbsp;<span class="ident" id="1948690">nil</span>&nbsp;<span class="op" id="1948694">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1948702">continue</span>&nbsp;<span class="comment" id="1948711">//&nbsp;key&nbsp;has&nbsp;been&nbsp;deleted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1948740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948747"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1948749">.</span><span class="ident" id="1948750">key</span>&nbsp;<span class="op" id="1948754">=</span>&nbsp;<span class="ident" id="1948756"><a href="/runtime/hashmap.go.html#1948645">rk</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1948764"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1948766">.</span><span class="ident" id="1948767">value</span>&nbsp;<span class="op" id="1948773">=</span>&nbsp;<span class="ident" id="1948775"><a href="/runtime/hashmap.go.html#1948649">rv</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1948782">}</span>&nbsp;<span class="keyword" id="1948784">else</span>&nbsp;<span class="op" id="1948789">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1948796">//&nbsp;if&nbsp;key!=key&nbsp;then&nbsp;the&nbsp;entry&nbsp;can&#39;t&nbsp;be&nbsp;deleted&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1948851">//&nbsp;updated,&nbsp;so&nbsp;we&nbsp;can&nbsp;just&nbsp;return&nbsp;it.&nbsp;&nbsp;That&#39;s&nbsp;lucky&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1948912">//&nbsp;us&nbsp;because&nbsp;when&nbsp;key!=key&nbsp;we&nbsp;can&#39;t&nbsp;look&nbsp;it&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1948965">//&nbsp;successfully&nbsp;in&nbsp;the&nbsp;current&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949008"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1949010">.</span><span class="ident" id="1949011">key</span>&nbsp;<span class="op" id="1949015">=</span>&nbsp;<span class="ident" id="1949017"><a href="/runtime/hashmap.go.html#1948218">k2</a></span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949025">if</span>&nbsp;<span class="ident" id="1949028"><a href="/runtime/hashmap.go.html#1945106">t</a></span><span class="op" id="1949029">.</span><span class="ident" id="1949030">indirectvalue</span>&nbsp;<span class="op" id="1949044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949052"><a href="/runtime/hashmap.go.html#1946327">v</a></span>&nbsp;<span class="op" id="1949054">=</span>&nbsp;<span class="op" id="1949056">*</span><span class="op" id="1949057">(</span><span class="op" id="1949058">(</span><span class="op" id="1949059">*</span><span class="ident" id="1949060"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1949066">.</span><span class="ident" id="1949067">Pointer</span><span class="op" id="1949074">)</span><span class="op" id="1949075">(</span><span class="ident" id="1949076"><a href="/runtime/hashmap.go.html#1946327">v</a></span><span class="op" id="1949077">)</span><span class="op" id="1949078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949092"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1949094">.</span><span class="ident" id="1949095">value</span>&nbsp;<span class="op" id="1949101">=</span>&nbsp;<span class="ident" id="1949103"><a href="/runtime/hashmap.go.html#1946327">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949109">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949119"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1949121">.</span><span class="ident" id="1949122">bucket</span>&nbsp;<span class="op" id="1949129">=</span>&nbsp;<span class="ident" id="1949131"><a href="/runtime/hashmap.go.html#1945117">bucket</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949141"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1949143">.</span><span class="ident" id="1949144">bptr</span>&nbsp;<span class="op" id="1949149">=</span>&nbsp;<span class="ident" id="1949151"><a href="/runtime/hashmap.go.html#1945138">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949156"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1949158">.</span><span class="ident" id="1949159">i</span>&nbsp;<span class="op" id="1949161">=</span>&nbsp;<span class="ident" id="1949163"><a href="/runtime/hashmap.go.html#1945152">i</a></span>&nbsp;<span class="op" id="1949165">+</span>&nbsp;<span class="num" id="1949167">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949172"><a href="/runtime/hashmap.go.html#1944950">it</a></span><span class="op" id="1949174">.</span><span class="ident" id="1949175">checkBucket</span>&nbsp;<span class="op" id="1949187">=</span>&nbsp;<span class="ident" id="1949189"><a href="/runtime/hashmap.go.html#1945163">checkBucket</a></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949204">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949219"><a href="/runtime/hashmap.go.html#1945138">b</a></span>&nbsp;<span class="op" id="1949221">=</span>&nbsp;<span class="ident" id="1949223"><a href="/runtime/hashmap.go.html#1945138">b</a></span><span class="op" id="1949224">.</span><span class="ident" id="1949225">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949235"><a href="/runtime/hashmap.go.html#1945152">i</a></span>&nbsp;<span class="op" id="1949237">=</span>&nbsp;<span class="num" id="1949239">0</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949242">goto</span>&nbsp;<span class="ident" id="1949247">next</span><br>
<span class="lineno"></span><span class="op" id="1949252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1949255">func</span>&nbsp;<span class="ident" id="1949260">hashGrow</span><span class="op" id="1949268">(</span><span class="ident" id="1949269">t</span>&nbsp;<span class="op" id="1949271">*</span><span class="ident" id="1949272"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1949279">,</span>&nbsp;<span class="ident" id="1949281">h</span>&nbsp;<span class="op" id="1949283">*</span><span class="ident" id="1949284"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1949288">)</span>&nbsp;<span class="op" id="1949290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949293">if</span>&nbsp;<span class="ident" id="1949296"><a href="/runtime/hashmap.go.html#1949281">h</a></span><span class="op" id="1949297">.</span><span class="ident" id="1949298">oldbuckets</span>&nbsp;<span class="op" id="1949309">!=</span>&nbsp;<span class="ident" id="1949312">nil</span>&nbsp;<span class="op" id="1949316">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949320"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1949327">(</span><span class="string" id="1949328">&#34;evacuation&nbsp;not&nbsp;done&nbsp;in&nbsp;time&#34;</span><span class="op" id="1949357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949363">oldbuckets</span>&nbsp;<span class="op" id="1949374">:=</span>&nbsp;<span class="ident" id="1949377"><a href="/runtime/hashmap.go.html#1949281">h</a></span><span class="op" id="1949378">.</span><span class="ident" id="1949379">buckets</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949388">if</span>&nbsp;<span class="ident" id="1949391"><a href="/runtime/hashmap.go.html#1931204">checkgc</a></span>&nbsp;<span class="op" id="1949399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949403"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1949411">.</span><span class="ident" id="1949412">next_gc</span>&nbsp;<span class="op" id="1949420">=</span>&nbsp;<span class="ident" id="1949422"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1949430">.</span><span class="ident" id="1949431">heap_alloc</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949446">newbuckets</span>&nbsp;<span class="op" id="1949457">:=</span>&nbsp;<span class="ident" id="1949460"><a href="/runtime/malloc.go.html#1991870">newarray</a></span><span class="op" id="1949468">(</span><span class="ident" id="1949469"><a href="/runtime/hashmap.go.html#1949269">t</a></span><span class="op" id="1949470">.</span><span class="ident" id="1949471">bucket</span><span class="op" id="1949477">,</span>&nbsp;<span class="builtintype" id="1949479">uintptr</span><span class="op" id="1949486">(</span><span class="num" id="1949487">1</span><span class="op" id="1949488">)</span><span class="op" id="1949489">&lt;&lt;</span><span class="op" id="1949491">(</span><span class="ident" id="1949492"><a href="/runtime/hashmap.go.html#1949281">h</a></span><span class="op" id="1949493">.</span><span class="ident" id="1949494">B</span><span class="op" id="1949495">+</span><span class="num" id="1949496">1</span><span class="op" id="1949497">)</span><span class="op" id="1949498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949501">flags</span>&nbsp;<span class="op" id="1949507">:=</span>&nbsp;<span class="ident" id="1949510"><a href="/runtime/hashmap.go.html#1949281">h</a></span><span class="op" id="1949511">.</span><span class="ident" id="1949512">flags</span>&nbsp;<span class="op" id="1949518">&amp;^</span>&nbsp;<span class="op" id="1949521">(</span><span class="ident" id="1949522"><a href="/runtime/hashmap.go.html#1930938">iterator</a></span>&nbsp;<span class="op" id="1949531">|</span>&nbsp;<span class="ident" id="1949533"><a href="/runtime/hashmap.go.html#1930997">oldIterator</a></span><span class="op" id="1949544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1949547">if</span>&nbsp;<span class="ident" id="1949550"><a href="/runtime/hashmap.go.html#1949281">h</a></span><span class="op" id="1949551">.</span><span class="ident" id="1949552">flags</span><span class="op" id="1949557">&amp;</span><span class="ident" id="1949558"><a href="/runtime/hashmap.go.html#1930938">iterator</a></span>&nbsp;<span class="op" id="1949567">!=</span>&nbsp;<span class="num" id="1949570">0</span>&nbsp;<span class="op" id="1949572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949576"><a href="/runtime/hashmap.go.html#1949501">flags</a></span>&nbsp;<span class="op" id="1949582">|=</span>&nbsp;<span class="ident" id="1949585"><a href="/runtime/hashmap.go.html#1930997">oldIterator</a></span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1949598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949601">//&nbsp;commit&nbsp;the&nbsp;grow&nbsp;(atomic&nbsp;wrt&nbsp;gc)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949637"><a href="/runtime/hashmap.go.html#1949281">h</a></span><span class="op" id="1949638">.</span><span class="ident" id="1949639">B</span><span class="op" id="1949640">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949644"><a href="/runtime/hashmap.go.html#1949281">h</a></span><span class="op" id="1949645">.</span><span class="ident" id="1949646">flags</span>&nbsp;<span class="op" id="1949652">=</span>&nbsp;<span class="ident" id="1949654"><a href="/runtime/hashmap.go.html#1949501">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949661"><a href="/runtime/hashmap.go.html#1949281">h</a></span><span class="op" id="1949662">.</span><span class="ident" id="1949663">oldbuckets</span>&nbsp;<span class="op" id="1949674">=</span>&nbsp;<span class="ident" id="1949676"><a href="/runtime/hashmap.go.html#1949363">oldbuckets</a></span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949688"><a href="/runtime/hashmap.go.html#1949281">h</a></span><span class="op" id="1949689">.</span><span class="ident" id="1949690">buckets</span>&nbsp;<span class="op" id="1949698">=</span>&nbsp;<span class="ident" id="1949700"><a href="/runtime/hashmap.go.html#1949446">newbuckets</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949712"><a href="/runtime/hashmap.go.html#1949281">h</a></span><span class="op" id="1949713">.</span><span class="ident" id="1949714">nevacuate</span>&nbsp;<span class="op" id="1949724">=</span>&nbsp;<span class="num" id="1949726">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949730">//&nbsp;the&nbsp;actual&nbsp;copying&nbsp;of&nbsp;the&nbsp;hash&nbsp;table&nbsp;data&nbsp;is&nbsp;done&nbsp;incrementally</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949798">//&nbsp;by&nbsp;growWork()&nbsp;and&nbsp;evacuate().</span><br>
<span class="lineno">750</span><span class="op" id="1949831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1949834">func</span>&nbsp;<span class="ident" id="1949839">growWork</span><span class="op" id="1949847">(</span><span class="ident" id="1949848">t</span>&nbsp;<span class="op" id="1949850">*</span><span class="ident" id="1949851"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1949858">,</span>&nbsp;<span class="ident" id="1949860">h</span>&nbsp;<span class="op" id="1949862">*</span><span class="ident" id="1949863"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1949867">,</span>&nbsp;<span class="ident" id="1949869">bucket</span>&nbsp;<span class="builtintype" id="1949876">uintptr</span><span class="op" id="1949883">)</span>&nbsp;<span class="op" id="1949885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1949888">noldbuckets</span>&nbsp;<span class="op" id="1949900">:=</span>&nbsp;<span class="builtintype" id="1949903">uintptr</span><span class="op" id="1949910">(</span><span class="num" id="1949911">1</span><span class="op" id="1949912">)</span>&nbsp;<span class="op" id="1949914">&lt;&lt;</span>&nbsp;<span class="op" id="1949917">(</span><span class="ident" id="1949918"><a href="/runtime/hashmap.go.html#1949860">h</a></span><span class="op" id="1949919">.</span><span class="ident" id="1949920">B</span>&nbsp;<span class="op" id="1949922">-</span>&nbsp;<span class="num" id="1949924">1</span><span class="op" id="1949925">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949929">//&nbsp;make&nbsp;sure&nbsp;we&nbsp;evacuate&nbsp;the&nbsp;oldbucket&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1949983">//&nbsp;to&nbsp;the&nbsp;bucket&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950020"><a href="/runtime/hashmap.go.html#1950187">evacuate</a></span><span class="op" id="1950028">(</span><span class="ident" id="1950029"><a href="/runtime/hashmap.go.html#1949848">t</a></span><span class="op" id="1950030">,</span>&nbsp;<span class="ident" id="1950032"><a href="/runtime/hashmap.go.html#1949860">h</a></span><span class="op" id="1950033">,</span>&nbsp;<span class="ident" id="1950035"><a href="/runtime/hashmap.go.html#1949869">bucket</a></span><span class="op" id="1950041">&amp;</span><span class="op" id="1950042">(</span><span class="ident" id="1950043"><a href="/runtime/hashmap.go.html#1949888">noldbuckets</a></span><span class="op" id="1950054">-</span><span class="num" id="1950055">1</span><span class="op" id="1950056">)</span><span class="op" id="1950057">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1950061">//&nbsp;evacuate&nbsp;one&nbsp;more&nbsp;oldbucket&nbsp;to&nbsp;make&nbsp;progress&nbsp;on&nbsp;growing</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950121">if</span>&nbsp;<span class="ident" id="1950124"><a href="/runtime/hashmap.go.html#1949860">h</a></span><span class="op" id="1950125">.</span><span class="ident" id="1950126">oldbuckets</span>&nbsp;<span class="op" id="1950137">!=</span>&nbsp;<span class="ident" id="1950140">nil</span>&nbsp;<span class="op" id="1950144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950148"><a href="/runtime/hashmap.go.html#1950187">evacuate</a></span><span class="op" id="1950156">(</span><span class="ident" id="1950157"><a href="/runtime/hashmap.go.html#1949848">t</a></span><span class="op" id="1950158">,</span>&nbsp;<span class="ident" id="1950160"><a href="/runtime/hashmap.go.html#1949860">h</a></span><span class="op" id="1950161">,</span>&nbsp;<span class="ident" id="1950163"><a href="/runtime/hashmap.go.html#1949860">h</a></span><span class="op" id="1950164">.</span><span class="ident" id="1950165">nevacuate</span><span class="op" id="1950174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1950177">}</span><br>
<span class="lineno"></span><span class="op" id="1950179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span><span class="keyword" id="1950182">func</span>&nbsp;<span class="ident" id="1950187">evacuate</span><span class="op" id="1950195">(</span><span class="ident" id="1950196">t</span>&nbsp;<span class="op" id="1950198">*</span><span class="ident" id="1950199"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1950206">,</span>&nbsp;<span class="ident" id="1950208">h</span>&nbsp;<span class="op" id="1950210">*</span><span class="ident" id="1950211"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1950215">,</span>&nbsp;<span class="ident" id="1950217">oldbucket</span>&nbsp;<span class="builtintype" id="1950227">uintptr</span><span class="op" id="1950234">)</span>&nbsp;<span class="op" id="1950236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950239">b</span>&nbsp;<span class="op" id="1950241">:=</span>&nbsp;<span class="op" id="1950244">(</span><span class="op" id="1950245">*</span><span class="ident" id="1950246"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1950250">)</span><span class="op" id="1950251">(</span><span class="ident" id="1950252"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1950255">(</span><span class="ident" id="1950256"><a href="/runtime/hashmap.go.html#1950208">h</a></span><span class="op" id="1950257">.</span><span class="ident" id="1950258">oldbuckets</span><span class="op" id="1950268">,</span>&nbsp;<span class="ident" id="1950270"><a href="/runtime/hashmap.go.html#1950217">oldbucket</a></span><span class="op" id="1950279">*</span><span class="builtintype" id="1950280">uintptr</span><span class="op" id="1950287">(</span><span class="ident" id="1950288"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1950289">.</span><span class="ident" id="1950290">bucketsize</span><span class="op" id="1950300">)</span><span class="op" id="1950301">)</span><span class="op" id="1950302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950305">newbit</span>&nbsp;<span class="op" id="1950312">:=</span>&nbsp;<span class="builtintype" id="1950315">uintptr</span><span class="op" id="1950322">(</span><span class="num" id="1950323">1</span><span class="op" id="1950324">)</span>&nbsp;<span class="op" id="1950326">&lt;&lt;</span>&nbsp;<span class="op" id="1950329">(</span><span class="ident" id="1950330"><a href="/runtime/hashmap.go.html#1950208">h</a></span><span class="op" id="1950331">.</span><span class="ident" id="1950332">B</span>&nbsp;<span class="op" id="1950334">-</span>&nbsp;<span class="num" id="1950336">1</span><span class="op" id="1950337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950340">alg</span>&nbsp;<span class="op" id="1950344">:=</span>&nbsp;<span class="ident" id="1950347"><a href="/runtime/alg.go.html#1872365">goalg</a></span><span class="op" id="1950352">(</span><span class="ident" id="1950353"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1950354">.</span><span class="ident" id="1950355">key</span><span class="op" id="1950358">.</span><span class="ident" id="1950359">alg</span><span class="op" id="1950362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950365">if</span>&nbsp;<span class="op" id="1950368">!</span><span class="ident" id="1950369"><a href="/runtime/hashmap.go.html#1933181">evacuated</a></span><span class="op" id="1950378">(</span><span class="ident" id="1950379"><a href="/runtime/hashmap.go.html#1950239">b</a></span><span class="op" id="1950380">)</span>&nbsp;<span class="op" id="1950382">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1950386">//&nbsp;TODO:&nbsp;reuse&nbsp;overflow&nbsp;buckets&nbsp;instead&nbsp;of&nbsp;using&nbsp;new&nbsp;ones,&nbsp;if&nbsp;there</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1950456">//&nbsp;is&nbsp;no&nbsp;iterator&nbsp;using&nbsp;the&nbsp;old&nbsp;buckets.&nbsp;&nbsp;(If&nbsp;!oldIterator.)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950520">x</span>&nbsp;<span class="op" id="1950522">:=</span>&nbsp;<span class="op" id="1950525">(</span><span class="op" id="1950526">*</span><span class="ident" id="1950527"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1950531">)</span><span class="op" id="1950532">(</span><span class="ident" id="1950533"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1950536">(</span><span class="ident" id="1950537"><a href="/runtime/hashmap.go.html#1950208">h</a></span><span class="op" id="1950538">.</span><span class="ident" id="1950539">buckets</span><span class="op" id="1950546">,</span>&nbsp;<span class="ident" id="1950548"><a href="/runtime/hashmap.go.html#1950217">oldbucket</a></span><span class="op" id="1950557">*</span><span class="builtintype" id="1950558">uintptr</span><span class="op" id="1950565">(</span><span class="ident" id="1950566"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1950567">.</span><span class="ident" id="1950568">bucketsize</span><span class="op" id="1950578">)</span><span class="op" id="1950579">)</span><span class="op" id="1950580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950584">y</span>&nbsp;<span class="op" id="1950586">:=</span>&nbsp;<span class="op" id="1950589">(</span><span class="op" id="1950590">*</span><span class="ident" id="1950591"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1950595">)</span><span class="op" id="1950596">(</span><span class="ident" id="1950597"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1950600">(</span><span class="ident" id="1950601"><a href="/runtime/hashmap.go.html#1950208">h</a></span><span class="op" id="1950602">.</span><span class="ident" id="1950603">buckets</span><span class="op" id="1950610">,</span>&nbsp;<span class="op" id="1950612">(</span><span class="ident" id="1950613"><a href="/runtime/hashmap.go.html#1950217">oldbucket</a></span><span class="op" id="1950622">+</span><span class="ident" id="1950623"><a href="/runtime/hashmap.go.html#1950305">newbit</a></span><span class="op" id="1950629">)</span><span class="op" id="1950630">*</span><span class="builtintype" id="1950631">uintptr</span><span class="op" id="1950638">(</span><span class="ident" id="1950639"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1950640">.</span><span class="ident" id="1950641">bucketsize</span><span class="op" id="1950651">)</span><span class="op" id="1950652">)</span><span class="op" id="1950653">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950657">xi</span>&nbsp;<span class="op" id="1950660">:=</span>&nbsp;<span class="num" id="1950663">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950667">yi</span>&nbsp;<span class="op" id="1950670">:=</span>&nbsp;<span class="num" id="1950673">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950677">xk</span>&nbsp;<span class="op" id="1950680">:=</span>&nbsp;<span class="ident" id="1950683"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1950686">(</span><span class="ident" id="1950687"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1950693">.</span><span class="ident" id="1950694">Pointer</span><span class="op" id="1950701">(</span><span class="ident" id="1950702"><a href="/runtime/hashmap.go.html#1950520">x</a></span><span class="op" id="1950703">)</span><span class="op" id="1950704">,</span>&nbsp;<span class="ident" id="1950706"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1950716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950720">yk</span>&nbsp;<span class="op" id="1950723">:=</span>&nbsp;<span class="ident" id="1950726"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1950729">(</span><span class="ident" id="1950730"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1950736">.</span><span class="ident" id="1950737">Pointer</span><span class="op" id="1950744">(</span><span class="ident" id="1950745"><a href="/runtime/hashmap.go.html#1950584">y</a></span><span class="op" id="1950746">)</span><span class="op" id="1950747">,</span>&nbsp;<span class="ident" id="1950749"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1950759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950763">xv</span>&nbsp;<span class="op" id="1950766">:=</span>&nbsp;<span class="ident" id="1950769"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1950772">(</span><span class="ident" id="1950773"><a href="/runtime/hashmap.go.html#1950677">xk</a></span><span class="op" id="1950775">,</span>&nbsp;<span class="ident" id="1950777"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1950786">*</span><span class="builtintype" id="1950787">uintptr</span><span class="op" id="1950794">(</span><span class="ident" id="1950795"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1950796">.</span><span class="ident" id="1950797">keysize</span><span class="op" id="1950804">)</span><span class="op" id="1950805">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950809">yv</span>&nbsp;<span class="op" id="1950812">:=</span>&nbsp;<span class="ident" id="1950815"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1950818">(</span><span class="ident" id="1950819"><a href="/runtime/hashmap.go.html#1950720">yk</a></span><span class="op" id="1950821">,</span>&nbsp;<span class="ident" id="1950823"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1950832">*</span><span class="builtintype" id="1950833">uintptr</span><span class="op" id="1950840">(</span><span class="ident" id="1950841"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1950842">.</span><span class="ident" id="1950843">keysize</span><span class="op" id="1950850">)</span><span class="op" id="1950851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950855">for</span>&nbsp;<span class="op" id="1950859">;</span>&nbsp;<span class="ident" id="1950861"><a href="/runtime/hashmap.go.html#1950239">b</a></span>&nbsp;<span class="op" id="1950863">!=</span>&nbsp;<span class="ident" id="1950866">nil</span><span class="op" id="1950869">;</span>&nbsp;<span class="ident" id="1950871"><a href="/runtime/hashmap.go.html#1950239">b</a></span>&nbsp;<span class="op" id="1950873">=</span>&nbsp;<span class="ident" id="1950875"><a href="/runtime/hashmap.go.html#1950239">b</a></span><span class="op" id="1950876">.</span><span class="ident" id="1950877">overflow</span>&nbsp;<span class="op" id="1950886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950891">k</span>&nbsp;<span class="op" id="1950893">:=</span>&nbsp;<span class="ident" id="1950896"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1950899">(</span><span class="ident" id="1950900"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1950906">.</span><span class="ident" id="1950907">Pointer</span><span class="op" id="1950914">(</span><span class="ident" id="1950915"><a href="/runtime/hashmap.go.html#1950239">b</a></span><span class="op" id="1950916">)</span><span class="op" id="1950917">,</span>&nbsp;<span class="ident" id="1950919"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1950929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1950934">v</span>&nbsp;<span class="op" id="1950936">:=</span>&nbsp;<span class="ident" id="1950939"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1950942">(</span><span class="ident" id="1950943"><a href="/runtime/hashmap.go.html#1950891">k</a></span><span class="op" id="1950944">,</span>&nbsp;<span class="ident" id="1950946"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1950955">*</span><span class="builtintype" id="1950956">uintptr</span><span class="op" id="1950963">(</span><span class="ident" id="1950964"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1950965">.</span><span class="ident" id="1950966">keysize</span><span class="op" id="1950973">)</span><span class="op" id="1950974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1950979">for</span>&nbsp;<span class="ident" id="1950983">i</span>&nbsp;<span class="op" id="1950985">:=</span>&nbsp;<span class="num" id="1950988">0</span><span class="op" id="1950989">;</span>&nbsp;<span class="ident" id="1950991"><a href="/runtime/hashmap.go.html#1950983">i</a></span>&nbsp;<span class="op" id="1950993">&lt;</span>&nbsp;<span class="ident" id="1950995"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1951004">;</span>&nbsp;<span class="ident" id="1951006"><a href="/runtime/hashmap.go.html#1950983">i</a></span><span class="op" id="1951007">,</span>&nbsp;<span class="ident" id="1951009"><a href="/runtime/hashmap.go.html#1950891">k</a></span><span class="op" id="1951010">,</span>&nbsp;<span class="ident" id="1951012"><a href="/runtime/hashmap.go.html#1950934">v</a></span>&nbsp;<span class="op" id="1951014">=</span>&nbsp;<span class="ident" id="1951016"><a href="/runtime/hashmap.go.html#1950983">i</a></span><span class="op" id="1951017">+</span><span class="num" id="1951018">1</span><span class="op" id="1951019">,</span>&nbsp;<span class="ident" id="1951021"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1951024">(</span><span class="ident" id="1951025"><a href="/runtime/hashmap.go.html#1950891">k</a></span><span class="op" id="1951026">,</span>&nbsp;<span class="builtintype" id="1951028">uintptr</span><span class="op" id="1951035">(</span><span class="ident" id="1951036"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1951037">.</span><span class="ident" id="1951038">keysize</span><span class="op" id="1951045">)</span><span class="op" id="1951046">)</span><span class="op" id="1951047">,</span>&nbsp;<span class="ident" id="1951049"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1951052">(</span><span class="ident" id="1951053"><a href="/runtime/hashmap.go.html#1950934">v</a></span><span class="op" id="1951054">,</span>&nbsp;<span class="builtintype" id="1951056">uintptr</span><span class="op" id="1951063">(</span><span class="ident" id="1951064"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1951065">.</span><span class="ident" id="1951066">valuesize</span><span class="op" id="1951075">)</span><span class="op" id="1951076">)</span>&nbsp;<span class="op" id="1951078">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951084">top</span>&nbsp;<span class="op" id="1951088">:=</span>&nbsp;<span class="ident" id="1951091"><a href="/runtime/hashmap.go.html#1950239">b</a></span><span class="op" id="1951092">.</span><span class="ident" id="1951093">tophash</span><span class="op" id="1951100">[</span><span class="ident" id="1951101"><a href="/runtime/hashmap.go.html#1950983">i</a></span><span class="op" id="1951102">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951108">if</span>&nbsp;<span class="ident" id="1951111"><a href="/runtime/hashmap.go.html#1951084">top</a></span>&nbsp;<span class="op" id="1951115">==</span>&nbsp;<span class="ident" id="1951118"><a href="/runtime/hashmap.go.html#1930582">empty</a></span>&nbsp;<span class="op" id="1951124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951131"><a href="/runtime/hashmap.go.html#1950239">b</a></span><span class="op" id="1951132">.</span><span class="ident" id="1951133">tophash</span><span class="op" id="1951140">[</span><span class="ident" id="1951141"><a href="/runtime/hashmap.go.html#1950983">i</a></span><span class="op" id="1951142">]</span>&nbsp;<span class="op" id="1951144">=</span>&nbsp;<span class="ident" id="1951146"><a href="/runtime/hashmap.go.html#1930619">evacuatedEmpty</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951166">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1951179">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951185">if</span>&nbsp;<span class="ident" id="1951188"><a href="/runtime/hashmap.go.html#1951084">top</a></span>&nbsp;<span class="op" id="1951192">&lt;</span>&nbsp;<span class="ident" id="1951194"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span>&nbsp;<span class="op" id="1951205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951212"><a href="/runtime/panic.go.html#2057429">gothrow</a></span><span class="op" id="1951219">(</span><span class="string" id="1951220">&#34;bad&nbsp;map&nbsp;state&#34;</span><span class="op" id="1951235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1951241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951247">k2</span>&nbsp;<span class="op" id="1951250">:=</span>&nbsp;<span class="ident" id="1951253"><a href="/runtime/hashmap.go.html#1950891">k</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951259">if</span>&nbsp;<span class="ident" id="1951262"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1951263">.</span><span class="ident" id="1951264">indirectkey</span>&nbsp;<span class="op" id="1951276">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951283"><a href="/runtime/hashmap.go.html#1951247">k2</a></span>&nbsp;<span class="op" id="1951286">=</span>&nbsp;<span class="op" id="1951288">*</span><span class="op" id="1951289">(</span><span class="op" id="1951290">(</span><span class="op" id="1951291">*</span><span class="ident" id="1951292"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1951298">.</span><span class="ident" id="1951299">Pointer</span><span class="op" id="1951306">)</span><span class="op" id="1951307">(</span><span class="ident" id="1951308"><a href="/runtime/hashmap.go.html#1951247">k2</a></span><span class="op" id="1951310">)</span><span class="op" id="1951311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1951317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1951323">//&nbsp;Compute&nbsp;hash&nbsp;to&nbsp;make&nbsp;our&nbsp;evacuation&nbsp;decision&nbsp;(whether&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1951392">//&nbsp;to&nbsp;send&nbsp;this&nbsp;key/value&nbsp;to&nbsp;bucket&nbsp;x&nbsp;or&nbsp;bucket&nbsp;y).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1951448">hash</span>&nbsp;<span class="op" id="1951453">:=</span>&nbsp;<span class="ident" id="1951456"><a href="/runtime/hashmap.go.html#1950340">alg</a></span><span class="op" id="1951459">.</span><span class="ident" id="1951460">hash</span><span class="op" id="1951464">(</span><span class="ident" id="1951465"><a href="/runtime/hashmap.go.html#1951247">k2</a></span><span class="op" id="1951467">,</span>&nbsp;<span class="builtintype" id="1951469">uintptr</span><span class="op" id="1951476">(</span><span class="ident" id="1951477"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1951478">.</span><span class="ident" id="1951479">key</span><span class="op" id="1951482">.</span><span class="ident" id="1951483">size</span><span class="op" id="1951487">)</span><span class="op" id="1951488">,</span>&nbsp;<span class="builtintype" id="1951490">uintptr</span><span class="op" id="1951497">(</span><span class="ident" id="1951498"><a href="/runtime/hashmap.go.html#1950208">h</a></span><span class="op" id="1951499">.</span><span class="ident" id="1951500">hash0</span><span class="op" id="1951505">)</span><span class="op" id="1951506">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951512">if</span>&nbsp;<span class="ident" id="1951515"><a href="/runtime/hashmap.go.html#1950208">h</a></span><span class="op" id="1951516">.</span><span class="ident" id="1951517">flags</span><span class="op" id="1951522">&amp;</span><span class="ident" id="1951523"><a href="/runtime/hashmap.go.html#1930938">iterator</a></span>&nbsp;<span class="op" id="1951532">!=</span>&nbsp;<span class="num" id="1951535">0</span>&nbsp;<span class="op" id="1951537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1951544">if</span>&nbsp;<span class="op" id="1951547">!</span><span class="ident" id="1951548"><a href="/runtime/hashmap.go.html#1950340">alg</a></span><span class="op" id="1951551">.</span><span class="ident" id="1951552">equal</span><span class="op" id="1951557">(</span><span class="ident" id="1951558"><a href="/runtime/hashmap.go.html#1951247">k2</a></span><span class="op" id="1951560">,</span>&nbsp;<span class="ident" id="1951562"><a href="/runtime/hashmap.go.html#1951247">k2</a></span><span class="op" id="1951564">,</span>&nbsp;<span class="builtintype" id="1951566">uintptr</span><span class="op" id="1951573">(</span><span class="ident" id="1951574"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1951575">.</span><span class="ident" id="1951576">key</span><span class="op" id="1951579">.</span><span class="ident" id="1951580">size</span><span class="op" id="1951584">)</span><span class="op" id="1951585">)</span>&nbsp;<span class="op" id="1951587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1951595">//&nbsp;If&nbsp;key&nbsp;!=&nbsp;key&nbsp;(NaNs),&nbsp;then&nbsp;the&nbsp;hash&nbsp;could&nbsp;be&nbsp;(and&nbsp;probably</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1951663">//&nbsp;will&nbsp;be)&nbsp;entirely&nbsp;different&nbsp;from&nbsp;the&nbsp;old&nbsp;hash.&nbsp;&nbsp;Moreover,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1951730">//&nbsp;it&nbsp;isn&#39;t&nbsp;reproducible.&nbsp;&nbsp;Reproducibility&nbsp;is&nbsp;required&nbsp;in&nbsp;the</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1951798">//&nbsp;presence&nbsp;of&nbsp;iterators,&nbsp;as&nbsp;our&nbsp;evacuation&nbsp;decision&nbsp;must</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1951862">//&nbsp;match&nbsp;whatever&nbsp;decision&nbsp;the&nbsp;iterator&nbsp;made.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1951914">//&nbsp;Fortunately,&nbsp;we&nbsp;have&nbsp;the&nbsp;freedom&nbsp;to&nbsp;send&nbsp;these&nbsp;keys&nbsp;either</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1951982">//&nbsp;way.&nbsp;&nbsp;Also,&nbsp;tophash&nbsp;is&nbsp;meaningless&nbsp;for&nbsp;these&nbsp;kinds&nbsp;of&nbsp;keys.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1952051">//&nbsp;We&nbsp;let&nbsp;the&nbsp;low&nbsp;bit&nbsp;of&nbsp;tophash&nbsp;drive&nbsp;the&nbsp;evacuation&nbsp;decision.</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1952121">//&nbsp;We&nbsp;recompute&nbsp;a&nbsp;new&nbsp;random&nbsp;tophash&nbsp;for&nbsp;the&nbsp;next&nbsp;level&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1952186">//&nbsp;these&nbsp;keys&nbsp;will&nbsp;get&nbsp;evenly&nbsp;distributed&nbsp;across&nbsp;all&nbsp;buckets</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1952253">//&nbsp;after&nbsp;multiple&nbsp;grows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952284">if</span>&nbsp;<span class="op" id="1952287">(</span><span class="ident" id="1952288"><a href="/runtime/hashmap.go.html#1951084">top</a></span>&nbsp;<span class="op" id="1952292">&amp;</span>&nbsp;<span class="num" id="1952294">1</span><span class="op" id="1952295">)</span>&nbsp;<span class="op" id="1952297">!=</span>&nbsp;<span class="num" id="1952300">0</span>&nbsp;<span class="op" id="1952302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952311"><a href="/runtime/hashmap.go.html#1951448">hash</a></span>&nbsp;<span class="op" id="1952316">|=</span>&nbsp;<span class="ident" id="1952319"><a href="/runtime/hashmap.go.html#1950305">newbit</a></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952332">}</span>&nbsp;<span class="keyword" id="1952334">else</span>&nbsp;<span class="op" id="1952339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952348"><a href="/runtime/hashmap.go.html#1951448">hash</a></span>&nbsp;<span class="op" id="1952353">&amp;^=</span>&nbsp;<span class="ident" id="1952357"><a href="/runtime/hashmap.go.html#1950305">newbit</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952378"><a href="/runtime/hashmap.go.html#1951084">top</a></span>&nbsp;<span class="op" id="1952382">=</span>&nbsp;<span class="builtintype" id="1952384">uint8</span><span class="op" id="1952389">(</span><span class="ident" id="1952390"><a href="/runtime/hashmap.go.html#1951448">hash</a></span>&nbsp;<span class="op" id="1952395">&gt;&gt;</span>&nbsp;<span class="op" id="1952398">(</span><span class="ident" id="1952399"><a href="/runtime/stubs.go.html#2131510">ptrSize</a></span><span class="op" id="1952406">*</span><span class="num" id="1952407">8</span>&nbsp;<span class="op" id="1952409">-</span>&nbsp;<span class="num" id="1952411">8</span><span class="op" id="1952412">)</span><span class="op" id="1952413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952421">if</span>&nbsp;<span class="ident" id="1952424"><a href="/runtime/hashmap.go.html#1951084">top</a></span>&nbsp;<span class="op" id="1952428">&lt;</span>&nbsp;<span class="ident" id="1952430"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span>&nbsp;<span class="op" id="1952441">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952450"><a href="/runtime/hashmap.go.html#1951084">top</a></span>&nbsp;<span class="op" id="1952454">+=</span>&nbsp;<span class="ident" id="1952457"><a href="/runtime/hashmap.go.html#1930862">minTopHash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952493">if</span>&nbsp;<span class="op" id="1952496">(</span><span class="ident" id="1952497"><a href="/runtime/hashmap.go.html#1951448">hash</a></span>&nbsp;<span class="op" id="1952502">&amp;</span>&nbsp;<span class="ident" id="1952504"><a href="/runtime/hashmap.go.html#1950305">newbit</a></span><span class="op" id="1952510">)</span>&nbsp;<span class="op" id="1952512">==</span>&nbsp;<span class="num" id="1952515">0</span>&nbsp;<span class="op" id="1952517">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952524"><a href="/runtime/hashmap.go.html#1950239">b</a></span><span class="op" id="1952525">.</span><span class="ident" id="1952526">tophash</span><span class="op" id="1952533">[</span><span class="ident" id="1952534"><a href="/runtime/hashmap.go.html#1950983">i</a></span><span class="op" id="1952535">]</span>&nbsp;<span class="op" id="1952537">=</span>&nbsp;<span class="ident" id="1952539"><a href="/runtime/hashmap.go.html#1930678">evacuatedX</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952555">if</span>&nbsp;<span class="ident" id="1952558"><a href="/runtime/hashmap.go.html#1950657">xi</a></span>&nbsp;<span class="op" id="1952561">==</span>&nbsp;<span class="ident" id="1952564"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span>&nbsp;<span class="op" id="1952574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952582">if</span>&nbsp;<span class="ident" id="1952585"><a href="/runtime/hashmap.go.html#1931204">checkgc</a></span>&nbsp;<span class="op" id="1952593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952602"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1952610">.</span><span class="ident" id="1952611">next_gc</span>&nbsp;<span class="op" id="1952619">=</span>&nbsp;<span class="ident" id="1952621"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1952629">.</span><span class="ident" id="1952630">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952647">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952655">newx</span>&nbsp;<span class="op" id="1952660">:=</span>&nbsp;<span class="op" id="1952663">(</span><span class="op" id="1952664">*</span><span class="ident" id="1952665"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1952669">)</span><span class="op" id="1952670">(</span><span class="ident" id="1952671"><a href="/runtime/malloc.go.html#1991650">newobject</a></span><span class="op" id="1952680">(</span><span class="ident" id="1952681"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1952682">.</span><span class="ident" id="1952683">bucket</span><span class="op" id="1952689">)</span><span class="op" id="1952690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952698"><a href="/runtime/hashmap.go.html#1950520">x</a></span><span class="op" id="1952699">.</span><span class="ident" id="1952700">overflow</span>&nbsp;<span class="op" id="1952709">=</span>&nbsp;<span class="ident" id="1952711"><a href="/runtime/hashmap.go.html#1952655">newx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952722"><a href="/runtime/hashmap.go.html#1950520">x</a></span>&nbsp;<span class="op" id="1952724">=</span>&nbsp;<span class="ident" id="1952726"><a href="/runtime/hashmap.go.html#1952655">newx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952737"><a href="/runtime/hashmap.go.html#1950657">xi</a></span>&nbsp;<span class="op" id="1952740">=</span>&nbsp;<span class="num" id="1952742">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952750"><a href="/runtime/hashmap.go.html#1950677">xk</a></span>&nbsp;<span class="op" id="1952753">=</span>&nbsp;<span class="ident" id="1952755"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1952758">(</span><span class="ident" id="1952759"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1952765">.</span><span class="ident" id="1952766">Pointer</span><span class="op" id="1952773">(</span><span class="ident" id="1952774"><a href="/runtime/hashmap.go.html#1950520">x</a></span><span class="op" id="1952775">)</span><span class="op" id="1952776">,</span>&nbsp;<span class="ident" id="1952778"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1952788">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952796"><a href="/runtime/hashmap.go.html#1950763">xv</a></span>&nbsp;<span class="op" id="1952799">=</span>&nbsp;<span class="ident" id="1952801"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1952804">(</span><span class="ident" id="1952805"><a href="/runtime/hashmap.go.html#1950677">xk</a></span><span class="op" id="1952807">,</span>&nbsp;<span class="ident" id="1952809"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1952818">*</span><span class="builtintype" id="1952819">uintptr</span><span class="op" id="1952826">(</span><span class="ident" id="1952827"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1952828">.</span><span class="ident" id="1952829">keysize</span><span class="op" id="1952836">)</span><span class="op" id="1952837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952851"><a href="/runtime/hashmap.go.html#1950520">x</a></span><span class="op" id="1952852">.</span><span class="ident" id="1952853">tophash</span><span class="op" id="1952860">[</span><span class="ident" id="1952861"><a href="/runtime/hashmap.go.html#1950657">xi</a></span><span class="op" id="1952863">]</span>&nbsp;<span class="op" id="1952865">=</span>&nbsp;<span class="ident" id="1952867"><a href="/runtime/hashmap.go.html#1951084">top</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1952876">if</span>&nbsp;<span class="ident" id="1952879"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1952880">.</span><span class="ident" id="1952881">indirectkey</span>&nbsp;<span class="op" id="1952893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952901">*</span><span class="op" id="1952902">(</span><span class="op" id="1952903">*</span><span class="ident" id="1952904"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1952910">.</span><span class="ident" id="1952911">Pointer</span><span class="op" id="1952918">)</span><span class="op" id="1952919">(</span><span class="ident" id="1952920"><a href="/runtime/hashmap.go.html#1950677">xk</a></span><span class="op" id="1952922">)</span>&nbsp;<span class="op" id="1952924">=</span>&nbsp;<span class="ident" id="1952926"><a href="/runtime/hashmap.go.html#1951247">k2</a></span>&nbsp;<span class="comment" id="1952929">//&nbsp;copy&nbsp;pointer</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1952950">}</span>&nbsp;<span class="keyword" id="1952952">else</span>&nbsp;<span class="op" id="1952957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1952965"><a href="/runtime/stubs.go.html#2135810">memmove</a></span><span class="op" id="1952972">(</span><span class="ident" id="1952973"><a href="/runtime/hashmap.go.html#1950677">xk</a></span><span class="op" id="1952975">,</span>&nbsp;<span class="ident" id="1952977"><a href="/runtime/hashmap.go.html#1950891">k</a></span><span class="op" id="1952978">,</span>&nbsp;<span class="builtintype" id="1952980">uintptr</span><span class="op" id="1952987">(</span><span class="ident" id="1952988"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1952989">.</span><span class="ident" id="1952990">key</span><span class="op" id="1952993">.</span><span class="ident" id="1952994">size</span><span class="op" id="1952998">)</span><span class="op" id="1952999">)</span>&nbsp;<span class="comment" id="1953001">//&nbsp;copy&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953027">if</span>&nbsp;<span class="ident" id="1953030"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1953031">.</span><span class="ident" id="1953032">indirectvalue</span>&nbsp;<span class="op" id="1953046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953054">*</span><span class="op" id="1953055">(</span><span class="op" id="1953056">*</span><span class="ident" id="1953057"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1953063">.</span><span class="ident" id="1953064">Pointer</span><span class="op" id="1953071">)</span><span class="op" id="1953072">(</span><span class="ident" id="1953073"><a href="/runtime/hashmap.go.html#1950763">xv</a></span><span class="op" id="1953075">)</span>&nbsp;<span class="op" id="1953077">=</span>&nbsp;<span class="op" id="1953079">*</span><span class="op" id="1953080">(</span><span class="op" id="1953081">*</span><span class="ident" id="1953082"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1953088">.</span><span class="ident" id="1953089">Pointer</span><span class="op" id="1953096">)</span><span class="op" id="1953097">(</span><span class="ident" id="1953098"><a href="/runtime/hashmap.go.html#1950934">v</a></span><span class="op" id="1953099">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953106">}</span>&nbsp;<span class="keyword" id="1953108">else</span>&nbsp;<span class="op" id="1953113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953121"><a href="/runtime/stubs.go.html#2135810">memmove</a></span><span class="op" id="1953128">(</span><span class="ident" id="1953129"><a href="/runtime/hashmap.go.html#1950763">xv</a></span><span class="op" id="1953131">,</span>&nbsp;<span class="ident" id="1953133"><a href="/runtime/hashmap.go.html#1950934">v</a></span><span class="op" id="1953134">,</span>&nbsp;<span class="builtintype" id="1953136">uintptr</span><span class="op" id="1953143">(</span><span class="ident" id="1953144"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1953145">.</span><span class="ident" id="1953146">elem</span><span class="op" id="1953150">.</span><span class="ident" id="1953151">size</span><span class="op" id="1953155">)</span><span class="op" id="1953156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953170"><a href="/runtime/hashmap.go.html#1950657">xi</a></span><span class="op" id="1953172">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953180"><a href="/runtime/hashmap.go.html#1950677">xk</a></span>&nbsp;<span class="op" id="1953183">=</span>&nbsp;<span class="ident" id="1953185"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1953188">(</span><span class="ident" id="1953189"><a href="/runtime/hashmap.go.html#1950677">xk</a></span><span class="op" id="1953191">,</span>&nbsp;<span class="builtintype" id="1953193">uintptr</span><span class="op" id="1953200">(</span><span class="ident" id="1953201"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1953202">.</span><span class="ident" id="1953203">keysize</span><span class="op" id="1953210">)</span><span class="op" id="1953211">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953218"><a href="/runtime/hashmap.go.html#1950763">xv</a></span>&nbsp;<span class="op" id="1953221">=</span>&nbsp;<span class="ident" id="1953223"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1953226">(</span><span class="ident" id="1953227"><a href="/runtime/hashmap.go.html#1950763">xv</a></span><span class="op" id="1953229">,</span>&nbsp;<span class="builtintype" id="1953231">uintptr</span><span class="op" id="1953238">(</span><span class="ident" id="1953239"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1953240">.</span><span class="ident" id="1953241">valuesize</span><span class="op" id="1953250">)</span><span class="op" id="1953251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953257">}</span>&nbsp;<span class="keyword" id="1953259">else</span>&nbsp;<span class="op" id="1953264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953271"><a href="/runtime/hashmap.go.html#1950239">b</a></span><span class="op" id="1953272">.</span><span class="ident" id="1953273">tophash</span><span class="op" id="1953280">[</span><span class="ident" id="1953281"><a href="/runtime/hashmap.go.html#1950983">i</a></span><span class="op" id="1953282">]</span>&nbsp;<span class="op" id="1953284">=</span>&nbsp;<span class="ident" id="1953286"><a href="/runtime/hashmap.go.html#1930778">evacuatedY</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953302">if</span>&nbsp;<span class="ident" id="1953305"><a href="/runtime/hashmap.go.html#1950667">yi</a></span>&nbsp;<span class="op" id="1953308">==</span>&nbsp;<span class="ident" id="1953311"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span>&nbsp;<span class="op" id="1953321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953329">if</span>&nbsp;<span class="ident" id="1953332"><a href="/runtime/hashmap.go.html#1931204">checkgc</a></span>&nbsp;<span class="op" id="1953340">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953349"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1953357">.</span><span class="ident" id="1953358">next_gc</span>&nbsp;<span class="op" id="1953366">=</span>&nbsp;<span class="ident" id="1953368"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2186172">memstats</a></span><span class="op" id="1953376">.</span><span class="ident" id="1953377">heap_alloc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953402">newy</span>&nbsp;<span class="op" id="1953407">:=</span>&nbsp;<span class="op" id="1953410">(</span><span class="op" id="1953411">*</span><span class="ident" id="1953412"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1953416">)</span><span class="op" id="1953417">(</span><span class="ident" id="1953418"><a href="/runtime/malloc.go.html#1991650">newobject</a></span><span class="op" id="1953427">(</span><span class="ident" id="1953428"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1953429">.</span><span class="ident" id="1953430">bucket</span><span class="op" id="1953436">)</span><span class="op" id="1953437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953445"><a href="/runtime/hashmap.go.html#1950584">y</a></span><span class="op" id="1953446">.</span><span class="ident" id="1953447">overflow</span>&nbsp;<span class="op" id="1953456">=</span>&nbsp;<span class="ident" id="1953458"><a href="/runtime/hashmap.go.html#1953402">newy</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953469"><a href="/runtime/hashmap.go.html#1950584">y</a></span>&nbsp;<span class="op" id="1953471">=</span>&nbsp;<span class="ident" id="1953473"><a href="/runtime/hashmap.go.html#1953402">newy</a></span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953484"><a href="/runtime/hashmap.go.html#1950667">yi</a></span>&nbsp;<span class="op" id="1953487">=</span>&nbsp;<span class="num" id="1953489">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953497"><a href="/runtime/hashmap.go.html#1950720">yk</a></span>&nbsp;<span class="op" id="1953500">=</span>&nbsp;<span class="ident" id="1953502"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1953505">(</span><span class="ident" id="1953506"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1953512">.</span><span class="ident" id="1953513">Pointer</span><span class="op" id="1953520">(</span><span class="ident" id="1953521"><a href="/runtime/hashmap.go.html#1950584">y</a></span><span class="op" id="1953522">)</span><span class="op" id="1953523">,</span>&nbsp;<span class="ident" id="1953525"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1953535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953543"><a href="/runtime/hashmap.go.html#1950809">yv</a></span>&nbsp;<span class="op" id="1953546">=</span>&nbsp;<span class="ident" id="1953548"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1953551">(</span><span class="ident" id="1953552"><a href="/runtime/hashmap.go.html#1950720">yk</a></span><span class="op" id="1953554">,</span>&nbsp;<span class="ident" id="1953556"><a href="/runtime/hashmap.go.html#1929597">bucketCnt</a></span><span class="op" id="1953565">*</span><span class="builtintype" id="1953566">uintptr</span><span class="op" id="1953573">(</span><span class="ident" id="1953574"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1953575">.</span><span class="ident" id="1953576">keysize</span><span class="op" id="1953583">)</span><span class="op" id="1953584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953598"><a href="/runtime/hashmap.go.html#1950584">y</a></span><span class="op" id="1953599">.</span><span class="ident" id="1953600">tophash</span><span class="op" id="1953607">[</span><span class="ident" id="1953608"><a href="/runtime/hashmap.go.html#1950667">yi</a></span><span class="op" id="1953610">]</span>&nbsp;<span class="op" id="1953612">=</span>&nbsp;<span class="ident" id="1953614"><a href="/runtime/hashmap.go.html#1951084">top</a></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953623">if</span>&nbsp;<span class="ident" id="1953626"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1953627">.</span><span class="ident" id="1953628">indirectkey</span>&nbsp;<span class="op" id="1953640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953648">*</span><span class="op" id="1953649">(</span><span class="op" id="1953650">*</span><span class="ident" id="1953651"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1953657">.</span><span class="ident" id="1953658">Pointer</span><span class="op" id="1953665">)</span><span class="op" id="1953666">(</span><span class="ident" id="1953667"><a href="/runtime/hashmap.go.html#1950720">yk</a></span><span class="op" id="1953669">)</span>&nbsp;<span class="op" id="1953671">=</span>&nbsp;<span class="ident" id="1953673"><a href="/runtime/hashmap.go.html#1951247">k2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953681">}</span>&nbsp;<span class="keyword" id="1953683">else</span>&nbsp;<span class="op" id="1953688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953696"><a href="/runtime/stubs.go.html#2135810">memmove</a></span><span class="op" id="1953703">(</span><span class="ident" id="1953704"><a href="/runtime/hashmap.go.html#1950720">yk</a></span><span class="op" id="1953706">,</span>&nbsp;<span class="ident" id="1953708"><a href="/runtime/hashmap.go.html#1950891">k</a></span><span class="op" id="1953709">,</span>&nbsp;<span class="builtintype" id="1953711">uintptr</span><span class="op" id="1953718">(</span><span class="ident" id="1953719"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1953720">.</span><span class="ident" id="1953721">key</span><span class="op" id="1953724">.</span><span class="ident" id="1953725">size</span><span class="op" id="1953729">)</span><span class="op" id="1953730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953737">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1953744">if</span>&nbsp;<span class="ident" id="1953747"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1953748">.</span><span class="ident" id="1953749">indirectvalue</span>&nbsp;<span class="op" id="1953763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953771">*</span><span class="op" id="1953772">(</span><span class="op" id="1953773">*</span><span class="ident" id="1953774"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1953780">.</span><span class="ident" id="1953781">Pointer</span><span class="op" id="1953788">)</span><span class="op" id="1953789">(</span><span class="ident" id="1953790"><a href="/runtime/hashmap.go.html#1950809">yv</a></span><span class="op" id="1953792">)</span>&nbsp;<span class="op" id="1953794">=</span>&nbsp;<span class="op" id="1953796">*</span><span class="op" id="1953797">(</span><span class="op" id="1953798">*</span><span class="ident" id="1953799"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1953805">.</span><span class="ident" id="1953806">Pointer</span><span class="op" id="1953813">)</span><span class="op" id="1953814">(</span><span class="ident" id="1953815"><a href="/runtime/hashmap.go.html#1950934">v</a></span><span class="op" id="1953816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953823">}</span>&nbsp;<span class="keyword" id="1953825">else</span>&nbsp;<span class="op" id="1953830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953838"><a href="/runtime/stubs.go.html#2135810">memmove</a></span><span class="op" id="1953845">(</span><span class="ident" id="1953846"><a href="/runtime/hashmap.go.html#1950809">yv</a></span><span class="op" id="1953848">,</span>&nbsp;<span class="ident" id="1953850"><a href="/runtime/hashmap.go.html#1950934">v</a></span><span class="op" id="1953851">,</span>&nbsp;<span class="builtintype" id="1953853">uintptr</span><span class="op" id="1953860">(</span><span class="ident" id="1953861"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1953862">.</span><span class="ident" id="1953863">elem</span><span class="op" id="1953867">.</span><span class="ident" id="1953868">size</span><span class="op" id="1953872">)</span><span class="op" id="1953873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953880">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953887"><a href="/runtime/hashmap.go.html#1950667">yi</a></span><span class="op" id="1953889">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953897"><a href="/runtime/hashmap.go.html#1950720">yk</a></span>&nbsp;<span class="op" id="1953900">=</span>&nbsp;<span class="ident" id="1953902"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1953905">(</span><span class="ident" id="1953906"><a href="/runtime/hashmap.go.html#1950720">yk</a></span><span class="op" id="1953908">,</span>&nbsp;<span class="builtintype" id="1953910">uintptr</span><span class="op" id="1953917">(</span><span class="ident" id="1953918"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1953919">.</span><span class="ident" id="1953920">keysize</span><span class="op" id="1953927">)</span><span class="op" id="1953928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1953935"><a href="/runtime/hashmap.go.html#1950809">yv</a></span>&nbsp;<span class="op" id="1953938">=</span>&nbsp;<span class="ident" id="1953940"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1953943">(</span><span class="ident" id="1953944"><a href="/runtime/hashmap.go.html#1950809">yv</a></span><span class="op" id="1953946">,</span>&nbsp;<span class="builtintype" id="1953948">uintptr</span><span class="op" id="1953955">(</span><span class="ident" id="1953956"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1953957">.</span><span class="ident" id="1953958">valuesize</span><span class="op" id="1953967">)</span><span class="op" id="1953968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953979">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1953983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1953987">//&nbsp;Unlink&nbsp;the&nbsp;overflow&nbsp;buckets&nbsp;&amp;&nbsp;clear&nbsp;key/value&nbsp;to&nbsp;help&nbsp;GC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954050">if</span>&nbsp;<span class="ident" id="1954053"><a href="/runtime/hashmap.go.html#1950208">h</a></span><span class="op" id="1954054">.</span><span class="ident" id="1954055">flags</span><span class="op" id="1954060">&amp;</span><span class="ident" id="1954061"><a href="/runtime/hashmap.go.html#1930997">oldIterator</a></span>&nbsp;<span class="op" id="1954073">==</span>&nbsp;<span class="num" id="1954076">0</span>&nbsp;<span class="op" id="1954078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1954083"><a href="/runtime/hashmap.go.html#1950239">b</a></span>&nbsp;<span class="op" id="1954085">=</span>&nbsp;<span class="op" id="1954087">(</span><span class="op" id="1954088">*</span><span class="ident" id="1954089"><a href="/runtime/hashmap.go.html#1931944">bmap</a></span><span class="op" id="1954093">)</span><span class="op" id="1954094">(</span><span class="ident" id="1954095"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1954098">(</span><span class="ident" id="1954099"><a href="/runtime/hashmap.go.html#1950208">h</a></span><span class="op" id="1954100">.</span><span class="ident" id="1954101">oldbuckets</span><span class="op" id="1954111">,</span>&nbsp;<span class="ident" id="1954113"><a href="/runtime/hashmap.go.html#1950217">oldbucket</a></span><span class="op" id="1954122">*</span><span class="builtintype" id="1954123">uintptr</span><span class="op" id="1954130">(</span><span class="ident" id="1954131"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1954132">.</span><span class="ident" id="1954133">bucketsize</span><span class="op" id="1954143">)</span><span class="op" id="1954144">)</span><span class="op" id="1954145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1954150"><a href="/runtime/hashmap.go.html#1950239">b</a></span><span class="op" id="1954151">.</span><span class="ident" id="1954152">overflow</span>&nbsp;<span class="op" id="1954161">=</span>&nbsp;<span class="ident" id="1954163">nil</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1954170"><a href="/runtime/stubs.go.html#2135687">memclr</a></span><span class="op" id="1954176">(</span><span class="ident" id="1954177"><a href="/runtime/stubs.go.html#2131745">add</a></span><span class="op" id="1954180">(</span><span class="ident" id="1954181"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1954187">.</span><span class="ident" id="1954188">Pointer</span><span class="op" id="1954195">(</span><span class="ident" id="1954196"><a href="/runtime/hashmap.go.html#1950239">b</a></span><span class="op" id="1954197">)</span><span class="op" id="1954198">,</span>&nbsp;<span class="ident" id="1954200"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1954210">)</span><span class="op" id="1954211">,</span>&nbsp;<span class="builtintype" id="1954213">uintptr</span><span class="op" id="1954220">(</span><span class="ident" id="1954221"><a href="/runtime/hashmap.go.html#1950196">t</a></span><span class="op" id="1954222">.</span><span class="ident" id="1954223">bucketsize</span><span class="op" id="1954233">)</span><span class="op" id="1954234">-</span><span class="ident" id="1954235"><a href="/runtime/hashmap.go.html#1930166">dataOffset</a></span><span class="op" id="1954245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1954256">//&nbsp;Advance&nbsp;evacuation&nbsp;mark</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954284">if</span>&nbsp;<span class="ident" id="1954287"><a href="/runtime/hashmap.go.html#1950217">oldbucket</a></span>&nbsp;<span class="op" id="1954297">==</span>&nbsp;<span class="ident" id="1954300"><a href="/runtime/hashmap.go.html#1950208">h</a></span><span class="op" id="1954301">.</span><span class="ident" id="1954302">nevacuate</span>&nbsp;<span class="op" id="1954312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1954316"><a href="/runtime/hashmap.go.html#1950208">h</a></span><span class="op" id="1954317">.</span><span class="ident" id="1954318">nevacuate</span>&nbsp;<span class="op" id="1954328">=</span>&nbsp;<span class="ident" id="1954330"><a href="/runtime/hashmap.go.html#1950217">oldbucket</a></span>&nbsp;<span class="op" id="1954340">+</span>&nbsp;<span class="num" id="1954342">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954346">if</span>&nbsp;<span class="ident" id="1954349"><a href="/runtime/hashmap.go.html#1950217">oldbucket</a></span><span class="op" id="1954358">+</span><span class="num" id="1954359">1</span>&nbsp;<span class="op" id="1954361">==</span>&nbsp;<span class="ident" id="1954364"><a href="/runtime/hashmap.go.html#1950305">newbit</a></span>&nbsp;<span class="op" id="1954371">{</span>&nbsp;<span class="comment" id="1954373">//&nbsp;newbit&nbsp;==&nbsp;#&nbsp;of&nbsp;oldbuckets</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1954405">//&nbsp;Growing&nbsp;is&nbsp;all&nbsp;done.&nbsp;&nbsp;Free&nbsp;old&nbsp;main&nbsp;bucket&nbsp;array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1954461"><a href="/runtime/hashmap.go.html#1950208">h</a></span><span class="op" id="1954462">.</span><span class="ident" id="1954463">oldbuckets</span>&nbsp;<span class="op" id="1954474">=</span>&nbsp;<span class="ident" id="1954476">nil</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954485">}</span><br>
<span class="lineno"></span><span class="op" id="1954487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1954490">func</span>&nbsp;<span class="ident" id="1954495">ismapkey</span><span class="op" id="1954503">(</span><span class="ident" id="1954504">t</span>&nbsp;<span class="op" id="1954506">*</span><span class="ident" id="1954507"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2188707">_type</a></span><span class="op" id="1954512">)</span>&nbsp;<span class="builtintype" id="1954514">bool</span>&nbsp;<span class="op" id="1954519">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954522">return</span>&nbsp;<span class="ident" id="1954529"><a href="/runtime/alg.go.html#1872365">goalg</a></span><span class="op" id="1954534">(</span><span class="ident" id="1954535"><a href="/runtime/hashmap.go.html#1954504">t</a></span><span class="op" id="1954536">.</span><span class="ident" id="1954537">alg</span><span class="op" id="1954540">)</span><span class="op" id="1954541">.</span><span class="ident" id="1954542">hash</span>&nbsp;<span class="op" id="1954547">!=</span>&nbsp;<span class="ident" id="1954550">nil</span><br>
<span class="lineno"></span><span class="op" id="1954554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1954557">//&nbsp;Reflect&nbsp;stubs.&nbsp;&nbsp;Called&nbsp;from&nbsp;../reflect/asm_*.s</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span><span class="keyword" id="1954608">func</span>&nbsp;<span class="ident" id="1954613">reflect_makemap</span><span class="op" id="1954628">(</span><span class="ident" id="1954629">t</span>&nbsp;<span class="op" id="1954631">*</span><span class="ident" id="1954632"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1954639">)</span>&nbsp;<span class="op" id="1954641">*</span><span class="ident" id="1954642"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span>&nbsp;<span class="op" id="1954647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954650">return</span>&nbsp;<span class="ident" id="1954657"><a href="/runtime/hashmap.go.html#1933270">makemap</a></span><span class="op" id="1954664">(</span><span class="ident" id="1954665"><a href="/runtime/hashmap.go.html#1954629">t</a></span><span class="op" id="1954666">,</span>&nbsp;<span class="num" id="1954668">0</span><span class="op" id="1954669">)</span><br>
<span class="lineno"></span><span class="op" id="1954671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1954674">func</span>&nbsp;<span class="ident" id="1954679">reflect_mapaccess</span><span class="op" id="1954696">(</span><span class="ident" id="1954697">t</span>&nbsp;<span class="op" id="1954699">*</span><span class="ident" id="1954700"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1954707">,</span>&nbsp;<span class="ident" id="1954709">h</span>&nbsp;<span class="op" id="1954711">*</span><span class="ident" id="1954712"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1954716">,</span>&nbsp;<span class="ident" id="1954718">key</span>&nbsp;<span class="ident" id="1954722"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1954728">.</span><span class="ident" id="1954729">Pointer</span><span class="op" id="1954736">)</span>&nbsp;<span class="ident" id="1954738"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1954744">.</span><span class="ident" id="1954745">Pointer</span>&nbsp;<span class="op" id="1954753">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1954756">val</span><span class="op" id="1954759">,</span>&nbsp;<span class="ident" id="1954761">ok</span>&nbsp;<span class="op" id="1954764">:=</span>&nbsp;<span class="ident" id="1954767"><a href="/runtime/hashmap.go.html#1937093">mapaccess2</a></span><span class="op" id="1954777">(</span><span class="ident" id="1954778"><a href="/runtime/hashmap.go.html#1954697">t</a></span><span class="op" id="1954779">,</span>&nbsp;<span class="ident" id="1954781"><a href="/runtime/hashmap.go.html#1954709">h</a></span><span class="op" id="1954782">,</span>&nbsp;<span class="ident" id="1954784"><a href="/runtime/hashmap.go.html#1954718">key</a></span><span class="op" id="1954787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954790">if</span>&nbsp;<span class="op" id="1954793">!</span><span class="ident" id="1954794"><a href="/runtime/hashmap.go.html#1954761">ok</a></span>&nbsp;<span class="op" id="1954797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1954801">//&nbsp;reflect&nbsp;wants&nbsp;nil&nbsp;for&nbsp;a&nbsp;missing&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1954846"><a href="/runtime/hashmap.go.html#1954756">val</a></span>&nbsp;<span class="op" id="1954850">=</span>&nbsp;<span class="ident" id="1954852">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1954857">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1954860">return</span>&nbsp;<span class="ident" id="1954867"><a href="/runtime/hashmap.go.html#1954756">val</a></span><br>
<span class="lineno"></span><span class="op" id="1954871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1954874">func</span>&nbsp;<span class="ident" id="1954879">reflect_mapassign</span><span class="op" id="1954896">(</span><span class="ident" id="1954897">t</span>&nbsp;<span class="op" id="1954899">*</span><span class="ident" id="1954900"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1954907">,</span>&nbsp;<span class="ident" id="1954909">h</span>&nbsp;<span class="op" id="1954911">*</span><span class="ident" id="1954912"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1954916">,</span>&nbsp;<span class="ident" id="1954918">key</span>&nbsp;<span class="ident" id="1954922"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1954928">.</span><span class="ident" id="1954929">Pointer</span><span class="op" id="1954936">,</span>&nbsp;<span class="ident" id="1954938">val</span>&nbsp;<span class="ident" id="1954942"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1954948">.</span><span class="ident" id="1954949">Pointer</span><span class="op" id="1954956">)</span>&nbsp;<span class="op" id="1954958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1954961"><a href="/runtime/hashmap.go.html#1939588">mapassign1</a></span><span class="op" id="1954971">(</span><span class="ident" id="1954972"><a href="/runtime/hashmap.go.html#1954897">t</a></span><span class="op" id="1954973">,</span>&nbsp;<span class="ident" id="1954975"><a href="/runtime/hashmap.go.html#1954909">h</a></span><span class="op" id="1954976">,</span>&nbsp;<span class="ident" id="1954978"><a href="/runtime/hashmap.go.html#1954918">key</a></span><span class="op" id="1954981">,</span>&nbsp;<span class="ident" id="1954983"><a href="/runtime/hashmap.go.html#1954938">val</a></span><span class="op" id="1954986">)</span><br>
<span class="lineno">920</span><span class="op" id="1954988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1954991">func</span>&nbsp;<span class="ident" id="1954996">reflect_mapdelete</span><span class="op" id="1955013">(</span><span class="ident" id="1955014">t</span>&nbsp;<span class="op" id="1955016">*</span><span class="ident" id="1955017"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1955024">,</span>&nbsp;<span class="ident" id="1955026">h</span>&nbsp;<span class="op" id="1955028">*</span><span class="ident" id="1955029"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1955033">,</span>&nbsp;<span class="ident" id="1955035">key</span>&nbsp;<span class="ident" id="1955039"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1955045">.</span><span class="ident" id="1955046">Pointer</span><span class="op" id="1955053">)</span>&nbsp;<span class="op" id="1955055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955058"><a href="/runtime/hashmap.go.html#1942523">mapdelete</a></span><span class="op" id="1955067">(</span><span class="ident" id="1955068"><a href="/runtime/hashmap.go.html#1955014">t</a></span><span class="op" id="1955069">,</span>&nbsp;<span class="ident" id="1955071"><a href="/runtime/hashmap.go.html#1955026">h</a></span><span class="op" id="1955072">,</span>&nbsp;<span class="ident" id="1955074"><a href="/runtime/hashmap.go.html#1955035">key</a></span><span class="op" id="1955077">)</span><br>
<span class="lineno"></span><span class="op" id="1955079">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="1955082">func</span>&nbsp;<span class="ident" id="1955087">reflect_mapiterinit</span><span class="op" id="1955106">(</span><span class="ident" id="1955107">t</span>&nbsp;<span class="op" id="1955109">*</span><span class="ident" id="1955110"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2189256">maptype</a></span><span class="op" id="1955117">,</span>&nbsp;<span class="ident" id="1955119">h</span>&nbsp;<span class="op" id="1955121">*</span><span class="ident" id="1955122"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1955126">)</span>&nbsp;<span class="op" id="1955128">*</span><span class="ident" id="1955129"><a href="/runtime/hashmap.go.html#1932443">hiter</a></span>&nbsp;<span class="op" id="1955135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955138">it</span>&nbsp;<span class="op" id="1955141">:=</span>&nbsp;<span class="builtinfunc" id="1955144">new</span><span class="op" id="1955147">(</span><span class="ident" id="1955148"><a href="/runtime/hashmap.go.html#1932443">hiter</a></span><span class="op" id="1955153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955156"><a href="/runtime/hashmap.go.html#1943760">mapiterinit</a></span><span class="op" id="1955167">(</span><span class="ident" id="1955168"><a href="/runtime/hashmap.go.html#1955107">t</a></span><span class="op" id="1955169">,</span>&nbsp;<span class="ident" id="1955171"><a href="/runtime/hashmap.go.html#1955119">h</a></span><span class="op" id="1955172">,</span>&nbsp;<span class="ident" id="1955174"><a href="/runtime/hashmap.go.html#1955138">it</a></span><span class="op" id="1955176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955179">return</span>&nbsp;<span class="ident" id="1955186"><a href="/runtime/hashmap.go.html#1955138">it</a></span><br>
<span class="lineno">930</span><span class="op" id="1955189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1955192">func</span>&nbsp;<span class="ident" id="1955197">reflect_mapiternext</span><span class="op" id="1955216">(</span><span class="ident" id="1955217">it</span>&nbsp;<span class="op" id="1955220">*</span><span class="ident" id="1955221"><a href="/runtime/hashmap.go.html#1932443">hiter</a></span><span class="op" id="1955226">)</span>&nbsp;<span class="op" id="1955228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955231"><a href="/runtime/hashmap.go.html#1944938">mapiternext</a></span><span class="op" id="1955242">(</span><span class="ident" id="1955243"><a href="/runtime/hashmap.go.html#1955217">it</a></span><span class="op" id="1955245">)</span><br>
<span class="lineno"></span><span class="op" id="1955247">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span><span class="keyword" id="1955250">func</span>&nbsp;<span class="ident" id="1955255">reflect_mapiterkey</span><span class="op" id="1955273">(</span><span class="ident" id="1955274">it</span>&nbsp;<span class="op" id="1955277">*</span><span class="ident" id="1955278"><a href="/runtime/hashmap.go.html#1932443">hiter</a></span><span class="op" id="1955283">)</span>&nbsp;<span class="ident" id="1955285"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1955291">.</span><span class="ident" id="1955292">Pointer</span>&nbsp;<span class="op" id="1955300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955303">return</span>&nbsp;<span class="ident" id="1955310"><a href="/runtime/hashmap.go.html#1955274">it</a></span><span class="op" id="1955312">.</span><span class="ident" id="1955313">key</span><br>
<span class="lineno"></span><span class="op" id="1955317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span><span class="keyword" id="1955320">func</span>&nbsp;<span class="ident" id="1955325">reflect_maplen</span><span class="op" id="1955339">(</span><span class="ident" id="1955340">h</span>&nbsp;<span class="op" id="1955342">*</span><span class="ident" id="1955343"><a href="/runtime/hashmap.go.html#1931254">hmap</a></span><span class="op" id="1955347">)</span>&nbsp;<span class="builtintype" id="1955349">int</span>&nbsp;<span class="op" id="1955353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955356">if</span>&nbsp;<span class="ident" id="1955359"><a href="/runtime/hashmap.go.html#1955340">h</a></span>&nbsp;<span class="op" id="1955361">==</span>&nbsp;<span class="ident" id="1955364">nil</span>&nbsp;<span class="op" id="1955368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955372">return</span>&nbsp;<span class="num" id="1955379">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1955382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955385">if</span>&nbsp;<span class="ident" id="1955388"><a href="/runtime/race0.go.html#2069616">raceenabled</a></span>&nbsp;<span class="op" id="1955400">{</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955404">callerpc</span>&nbsp;<span class="op" id="1955413">:=</span>&nbsp;<span class="ident" id="1955416"><a href="/runtime/stubs.go.html#2139499">getcallerpc</a></span><span class="op" id="1955427">(</span><span class="ident" id="1955428"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1955434">.</span><span class="ident" id="1955435">Pointer</span><span class="op" id="1955442">(</span><span class="op" id="1955443">&amp;</span><span class="ident" id="1955444"><a href="/runtime/hashmap.go.html#1955340">h</a></span><span class="op" id="1955445">)</span><span class="op" id="1955446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1955450"><a href="/runtime/race0.go.html#2070294">racereadpc</a></span><span class="op" id="1955460">(</span><span class="ident" id="1955461"><a href="/runtime/hashmap.go.html#1929500">unsafe</a></span><span class="op" id="1955467">.</span><span class="ident" id="1955468">Pointer</span><span class="op" id="1955475">(</span><span class="ident" id="1955476"><a href="/runtime/hashmap.go.html#1955340">h</a></span><span class="op" id="1955477">)</span><span class="op" id="1955478">,</span>&nbsp;<span class="ident" id="1955480"><a href="/runtime/hashmap.go.html#1955404">callerpc</a></span><span class="op" id="1955488">,</span>&nbsp;<span class="ident" id="1955490"><a href="/runtime/proc.go.html#2068560">funcPC</a></span><span class="op" id="1955496">(</span><span class="ident" id="1955497"><a href="/runtime/hashmap.go.html#1955325">reflect_maplen</a></span><span class="op" id="1955511">)</span><span class="op" id="1955512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1955515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955518">return</span>&nbsp;<span class="ident" id="1955525"><a href="/runtime/hashmap.go.html#1955340">h</a></span><span class="op" id="1955526">.</span><span class="ident" id="1955527">count</span><br>
<span class="lineno"></span><span class="op" id="1955533">}</span><br>
<span class="lineno">950</span><br>
<span class="lineno"></span><span class="keyword" id="1955536">func</span>&nbsp;<span class="ident" id="1955541">reflect_ismapkey</span><span class="op" id="1955557">(</span><span class="ident" id="1955558">t</span>&nbsp;<span class="op" id="1955560">*</span><span class="ident" id="1955561"><a href="/runtime/zruntime_defs_linux_amd64.go.html#2188707">_type</a></span><span class="op" id="1955566">)</span>&nbsp;<span class="builtintype" id="1955568">bool</span>&nbsp;<span class="op" id="1955573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1955576">return</span>&nbsp;<span class="ident" id="1955583"><a href="/runtime/hashmap.go.html#1954495">ismapkey</a></span><span class="op" id="1955591">(</span><span class="ident" id="1955592"><a href="/runtime/hashmap.go.html#1955558">t</a></span><span class="op" id="1955593">)</span><br>
<span class="lineno"></span><span class="op" id="1955595">}</span>
</div>
</body>
</html>
