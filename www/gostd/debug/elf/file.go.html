<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/elf</h2>
<ul>
<li><a href="/gostd/debug/elf/elf.go.html">elf.go</a></li>
<li><a href="/gostd/debug/elf/elf_test.go.html">elf_test.go</a></li>
<li><a href="/gostd/debug/elf/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/elf/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/elf/symbols_test.go.html">symbols_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4693219">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4693275">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4693329">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4693380">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="4693434">package</span>&nbsp;<span class="ident" id="4693442">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4693447">import</span>&nbsp;<span class="op" id="4693454">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693457">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693466">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693481">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693500">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693510">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693517">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4693523">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="4693528">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4693531">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4693564">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4693603">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="4693650">type</span>&nbsp;<span class="ident" id="4693655">FileHeader</span>&nbsp;<span class="keyword" id="4693666">struct</span>&nbsp;<span class="op" id="4693673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693676">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693687">Class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693694">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693705">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693711">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693722">Version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693731">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693742">OSABI</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693749">ABIVersion</span>&nbsp;<span class="builtintype" id="4693760">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693767">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="4693778">binary</span><span class="op" id="4693784">.</span><span class="ident" id="4693785">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693796">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693807">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693813">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693824">Machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693833">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693844">uint64</span><br>
<span class="lineno">35</span><span class="op" id="4693851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4693854">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4693893">type</span>&nbsp;<span class="ident" id="4693898">File</span>&nbsp;<span class="keyword" id="4693903">struct</span>&nbsp;<span class="op" id="4693910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693913">FileHeader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693925">Sections</span>&nbsp;&nbsp;<span class="op" id="4693935">[</span><span class="op" id="4693936">]</span><span class="op" id="4693937">*</span><span class="ident" id="4693938">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693947">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4693957">[</span><span class="op" id="4693958">]</span><span class="op" id="4693959">*</span><span class="ident" id="4693960">Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693966">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693976">io</span><span class="op" id="4693978">.</span><span class="ident" id="4693979">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4693987">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4693997">[</span><span class="op" id="4693998">]</span><span class="ident" id="4693999">verneed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694008">gnuVersym</span>&nbsp;<span class="op" id="4694018">[</span><span class="op" id="4694019">]</span><span class="builtintype" id="4694020">byte</span><br>
<span class="lineno">45</span><span class="op" id="4694025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4694028">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="4694087">type</span>&nbsp;<span class="ident" id="4694092">SectionHeader</span>&nbsp;<span class="keyword" id="4694106">struct</span>&nbsp;<span class="op" id="4694113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694116">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4694126">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694134">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694144">SectionType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694157">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694167">SectionFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694180">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694190">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694198">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694208">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694216">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694226">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694234">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4694244">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694252">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4694262">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694270">Addralign</span>&nbsp;<span class="ident" id="4694280">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694288">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4694298">uint64</span><br>
<span class="lineno"></span><span class="op" id="4694305">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4694308">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4694365">type</span>&nbsp;<span class="ident" id="4694370">Section</span>&nbsp;<span class="keyword" id="4694378">struct</span>&nbsp;<span class="op" id="4694385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694388">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694404">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694442">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694482">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694517">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694565">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4694615">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694639">io</span><span class="op" id="4694641">.</span><span class="ident" id="4694642">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694652">sr</span>&nbsp;<span class="op" id="4694655">*</span><span class="ident" id="4694656">io</span><span class="op" id="4694658">.</span><span class="ident" id="4694659">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="4694673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="4694676">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4694735">func</span>&nbsp;<span class="op" id="4694740">(</span><span class="ident" id="4694741">s</span>&nbsp;<span class="op" id="4694743">*</span><span class="ident" id="4694744">Section</span><span class="op" id="4694751">)</span>&nbsp;<span class="ident" id="4694753">Data</span><span class="op" id="4694757">(</span><span class="op" id="4694758">)</span>&nbsp;<span class="op" id="4694760">(</span><span class="op" id="4694761">[</span><span class="op" id="4694762">]</span><span class="builtintype" id="4694763">byte</span><span class="op" id="4694767">,</span>&nbsp;<span class="builtintype" id="4694769">error</span><span class="op" id="4694774">)</span>&nbsp;<span class="op" id="4694776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694779">dat</span>&nbsp;<span class="op" id="4694783">:=</span>&nbsp;<span class="builtinfunc" id="4694786">make</span><span class="op" id="4694790">(</span><span class="op" id="4694791">[</span><span class="op" id="4694792">]</span><span class="builtintype" id="4694793">byte</span><span class="op" id="4694797">,</span>&nbsp;<span class="ident" id="4694799">s</span><span class="op" id="4694800">.</span><span class="ident" id="4694801">sr</span><span class="op" id="4694803">.</span><span class="ident" id="4694804">Size</span><span class="op" id="4694808">(</span><span class="op" id="4694809">)</span><span class="op" id="4694810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694813">n</span><span class="op" id="4694814">,</span>&nbsp;<span class="ident" id="4694816">err</span>&nbsp;<span class="op" id="4694820">:=</span>&nbsp;<span class="ident" id="4694823">s</span><span class="op" id="4694824">.</span><span class="ident" id="4694825">sr</span><span class="op" id="4694827">.</span><span class="ident" id="4694828">ReadAt</span><span class="op" id="4694834">(</span><span class="ident" id="4694835">dat</span><span class="op" id="4694838">,</span>&nbsp;<span class="num" id="4694840">0</span><span class="op" id="4694841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4694844">if</span>&nbsp;<span class="ident" id="4694847">n</span>&nbsp;<span class="op" id="4694849">==</span>&nbsp;<span class="builtinfunc" id="4694852">len</span><span class="op" id="4694855">(</span><span class="ident" id="4694856">dat</span><span class="op" id="4694859">)</span>&nbsp;<span class="op" id="4694861">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4694865">err</span>&nbsp;<span class="op" id="4694869">=</span>&nbsp;<span class="ident" id="4694871">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4694876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4694879">return</span>&nbsp;<span class="ident" id="4694886">dat</span><span class="op" id="4694889">[</span><span class="num" id="4694890">0</span><span class="op" id="4694891">:</span><span class="ident" id="4694892">n</span><span class="op" id="4694893">]</span><span class="op" id="4694894">,</span>&nbsp;<span class="ident" id="4694896">err</span><br>
<span class="lineno"></span><span class="op" id="4694900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4694903">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4694966">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4694991">func</span>&nbsp;<span class="op" id="4694996">(</span><span class="ident" id="4694997">f</span>&nbsp;<span class="op" id="4694999">*</span><span class="ident" id="4695000">File</span><span class="op" id="4695004">)</span>&nbsp;<span class="ident" id="4695006">stringTable</span><span class="op" id="4695017">(</span><span class="ident" id="4695018">link</span>&nbsp;<span class="builtintype" id="4695023">uint32</span><span class="op" id="4695029">)</span>&nbsp;<span class="op" id="4695031">(</span><span class="op" id="4695032">[</span><span class="op" id="4695033">]</span><span class="builtintype" id="4695034">byte</span><span class="op" id="4695038">,</span>&nbsp;<span class="builtintype" id="4695040">error</span><span class="op" id="4695045">)</span>&nbsp;<span class="op" id="4695047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695050">if</span>&nbsp;<span class="ident" id="4695053">link</span>&nbsp;<span class="op" id="4695058">&lt;=</span>&nbsp;<span class="num" id="4695061">0</span>&nbsp;<span class="op" id="4695063">||</span>&nbsp;<span class="ident" id="4695066">link</span>&nbsp;<span class="op" id="4695071">&gt;=</span>&nbsp;<span class="builtintype" id="4695074">uint32</span><span class="op" id="4695080">(</span><span class="builtinfunc" id="4695081">len</span><span class="op" id="4695084">(</span><span class="ident" id="4695085">f</span><span class="op" id="4695086">.</span><span class="ident" id="4695087">Sections</span><span class="op" id="4695095">)</span><span class="op" id="4695096">)</span>&nbsp;<span class="op" id="4695098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695102">return</span>&nbsp;<span class="ident" id="4695109">nil</span><span class="op" id="4695112">,</span>&nbsp;<span class="ident" id="4695114">errors</span><span class="op" id="4695120">.</span><span class="ident" id="4695121">New</span><span class="op" id="4695124">(</span><span class="string" id="4695125">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="4695164">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4695167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4695170">return</span>&nbsp;<span class="ident" id="4695177">f</span><span class="op" id="4695178">.</span><span class="ident" id="4695179">Sections</span><span class="op" id="4695187">[</span><span class="ident" id="4695188">link</span><span class="op" id="4695192">]</span><span class="op" id="4695193">.</span><span class="ident" id="4695194">Data</span><span class="op" id="4695198">(</span><span class="op" id="4695199">)</span><br>
<span class="lineno"></span><span class="op" id="4695201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4695204">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="4695262">func</span>&nbsp;<span class="op" id="4695267">(</span><span class="ident" id="4695268">s</span>&nbsp;<span class="op" id="4695270">*</span><span class="ident" id="4695271">Section</span><span class="op" id="4695278">)</span>&nbsp;<span class="ident" id="4695280">Open</span><span class="op" id="4695284">(</span><span class="op" id="4695285">)</span>&nbsp;<span class="ident" id="4695287">io</span><span class="op" id="4695289">.</span><span class="ident" id="4695290">ReadSeeker</span>&nbsp;<span class="op" id="4695301">{</span>&nbsp;<span class="keyword" id="4695303">return</span>&nbsp;<span class="ident" id="4695310">io</span><span class="op" id="4695312">.</span><span class="ident" id="4695313">NewSectionReader</span><span class="op" id="4695329">(</span><span class="ident" id="4695330">s</span><span class="op" id="4695331">.</span><span class="ident" id="4695332">sr</span><span class="op" id="4695334">,</span>&nbsp;<span class="num" id="4695336">0</span><span class="op" id="4695337">,</span>&nbsp;<span class="num" id="4695339">1</span><span class="op" id="4695340">&lt;&lt;</span><span class="num" id="4695342">63</span><span class="op" id="4695344">-</span><span class="num" id="4695345">1</span><span class="op" id="4695346">)</span>&nbsp;<span class="op" id="4695348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4695351">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="4695407">type</span>&nbsp;<span class="ident" id="4695412">ProgHeader</span>&nbsp;<span class="keyword" id="4695423">struct</span>&nbsp;<span class="op" id="4695430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695433">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4695440">ProgType</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695450">Flags</span>&nbsp;&nbsp;<span class="ident" id="4695457">ProgFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695467">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695474">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695482">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="4695489">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695497">Paddr</span>&nbsp;&nbsp;<span class="ident" id="4695504">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695512">Filesz</span>&nbsp;<span class="ident" id="4695519">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695527">Memsz</span>&nbsp;&nbsp;<span class="ident" id="4695534">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695542">Align</span>&nbsp;&nbsp;<span class="ident" id="4695549">uint64</span><br>
<span class="lineno"></span><span class="op" id="4695556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4695559">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="4695626">type</span>&nbsp;<span class="ident" id="4695631">Prog</span>&nbsp;<span class="keyword" id="4695636">struct</span>&nbsp;<span class="op" id="4695643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695646">ProgHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695659">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695697">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695737">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695772">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695820">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4695870">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695894">io</span><span class="op" id="4695896">.</span><span class="ident" id="4695897">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4695907">sr</span>&nbsp;<span class="op" id="4695910">*</span><span class="ident" id="4695911">io</span><span class="op" id="4695913">.</span><span class="ident" id="4695914">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="4695928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4695931">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="4695994">func</span>&nbsp;<span class="op" id="4695999">(</span><span class="ident" id="4696000">p</span>&nbsp;<span class="op" id="4696002">*</span><span class="ident" id="4696003">Prog</span><span class="op" id="4696007">)</span>&nbsp;<span class="ident" id="4696009">Open</span><span class="op" id="4696013">(</span><span class="op" id="4696014">)</span>&nbsp;<span class="ident" id="4696016">io</span><span class="op" id="4696018">.</span><span class="ident" id="4696019">ReadSeeker</span>&nbsp;<span class="op" id="4696030">{</span>&nbsp;<span class="keyword" id="4696032">return</span>&nbsp;<span class="ident" id="4696039">io</span><span class="op" id="4696041">.</span><span class="ident" id="4696042">NewSectionReader</span><span class="op" id="4696058">(</span><span class="ident" id="4696059">p</span><span class="op" id="4696060">.</span><span class="ident" id="4696061">sr</span><span class="op" id="4696063">,</span>&nbsp;<span class="num" id="4696065">0</span><span class="op" id="4696066">,</span>&nbsp;<span class="num" id="4696068">1</span><span class="op" id="4696069">&lt;&lt;</span><span class="num" id="4696071">63</span><span class="op" id="4696073">-</span><span class="num" id="4696074">1</span><span class="op" id="4696075">)</span>&nbsp;<span class="op" id="4696077">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4696080">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4696144">type</span>&nbsp;<span class="ident" id="4696149">Symbol</span>&nbsp;<span class="keyword" id="4696156">struct</span>&nbsp;<span class="op" id="4696163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696166">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4696178">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696186">Info</span><span class="op" id="4696190">,</span>&nbsp;<span class="ident" id="4696192">Other</span>&nbsp;<span class="builtintype" id="4696198">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696204">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696216">SectionIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696230">Value</span><span class="op" id="4696235">,</span>&nbsp;<span class="ident" id="4696237">Size</span>&nbsp;<span class="ident" id="4696242">uint64</span><br>
<span class="lineno"></span><span class="op" id="4696249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4696252">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4696274">type</span>&nbsp;<span class="ident" id="4696279">FormatError</span>&nbsp;<span class="keyword" id="4696291">struct</span>&nbsp;<span class="op" id="4696298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696301">off</span>&nbsp;<span class="ident" id="4696305">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696312">msg</span>&nbsp;<span class="builtintype" id="4696316">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696324">val</span>&nbsp;<span class="keyword" id="4696328">interface</span><span class="op" id="4696337">{</span><span class="op" id="4696338">}</span><br>
<span class="lineno"></span><span class="op" id="4696340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4696343">func</span>&nbsp;<span class="op" id="4696348">(</span><span class="ident" id="4696349">e</span>&nbsp;<span class="op" id="4696351">*</span><span class="ident" id="4696352">FormatError</span><span class="op" id="4696363">)</span>&nbsp;<span class="ident" id="4696365">Error</span><span class="op" id="4696370">(</span><span class="op" id="4696371">)</span>&nbsp;<span class="builtintype" id="4696373">string</span>&nbsp;<span class="op" id="4696380">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696383">msg</span>&nbsp;<span class="op" id="4696387">:=</span>&nbsp;<span class="ident" id="4696390">e</span><span class="op" id="4696391">.</span><span class="ident" id="4696392">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696397">if</span>&nbsp;<span class="ident" id="4696400">e</span><span class="op" id="4696401">.</span><span class="ident" id="4696402">val</span>&nbsp;<span class="op" id="4696406">!=</span>&nbsp;<span class="ident" id="4696409">nil</span>&nbsp;<span class="op" id="4696413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696417">msg</span>&nbsp;<span class="op" id="4696421">+=</span>&nbsp;<span class="ident" id="4696424">fmt</span><span class="op" id="4696427">.</span><span class="ident" id="4696428">Sprintf</span><span class="op" id="4696435">(</span><span class="string" id="4696436">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="4696444">,</span>&nbsp;<span class="ident" id="4696446">e</span><span class="op" id="4696447">.</span><span class="ident" id="4696448">val</span><span class="op" id="4696451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4696454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696457">msg</span>&nbsp;<span class="op" id="4696461">+=</span>&nbsp;<span class="ident" id="4696464">fmt</span><span class="op" id="4696467">.</span><span class="ident" id="4696468">Sprintf</span><span class="op" id="4696475">(</span><span class="string" id="4696476">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="4696499">,</span>&nbsp;<span class="ident" id="4696501">e</span><span class="op" id="4696502">.</span><span class="ident" id="4696503">off</span><span class="op" id="4696506">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696509">return</span>&nbsp;<span class="ident" id="4696516">msg</span><br>
<span class="lineno"></span><span class="op" id="4696520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4696523">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="4696608">func</span>&nbsp;<span class="ident" id="4696613">Open</span><span class="op" id="4696617">(</span><span class="ident" id="4696618">name</span>&nbsp;<span class="builtintype" id="4696623">string</span><span class="op" id="4696629">)</span>&nbsp;<span class="op" id="4696631">(</span><span class="op" id="4696632">*</span><span class="ident" id="4696633">File</span><span class="op" id="4696637">,</span>&nbsp;<span class="builtintype" id="4696639">error</span><span class="op" id="4696644">)</span>&nbsp;<span class="op" id="4696646">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696649">f</span><span class="op" id="4696650">,</span>&nbsp;<span class="ident" id="4696652">err</span>&nbsp;<span class="op" id="4696656">:=</span>&nbsp;<span class="ident" id="4696659">os</span><span class="op" id="4696661">.</span><span class="ident" id="4696662">Open</span><span class="op" id="4696666">(</span><span class="ident" id="4696667">name</span><span class="op" id="4696671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696674">if</span>&nbsp;<span class="ident" id="4696677">err</span>&nbsp;<span class="op" id="4696681">!=</span>&nbsp;<span class="ident" id="4696684">nil</span>&nbsp;<span class="op" id="4696688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696692">return</span>&nbsp;<span class="ident" id="4696699">nil</span><span class="op" id="4696702">,</span>&nbsp;<span class="ident" id="4696704">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4696709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696712">ff</span><span class="op" id="4696714">,</span>&nbsp;<span class="ident" id="4696716">err</span>&nbsp;<span class="op" id="4696720">:=</span>&nbsp;<span class="ident" id="4696723">NewFile</span><span class="op" id="4696730">(</span><span class="ident" id="4696731">f</span><span class="op" id="4696732">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696735">if</span>&nbsp;<span class="ident" id="4696738">err</span>&nbsp;<span class="op" id="4696742">!=</span>&nbsp;<span class="ident" id="4696745">nil</span>&nbsp;<span class="op" id="4696749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696753">f</span><span class="op" id="4696754">.</span><span class="ident" id="4696755">Close</span><span class="op" id="4696760">(</span><span class="op" id="4696761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696765">return</span>&nbsp;<span class="ident" id="4696772">nil</span><span class="op" id="4696775">,</span>&nbsp;<span class="ident" id="4696777">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4696782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4696785">ff</span><span class="op" id="4696787">.</span><span class="ident" id="4696788">closer</span>&nbsp;<span class="op" id="4696795">=</span>&nbsp;<span class="ident" id="4696797">f</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696800">return</span>&nbsp;<span class="ident" id="4696807">ff</span><span class="op" id="4696809">,</span>&nbsp;<span class="ident" id="4696811">nil</span><br>
<span class="lineno"></span><span class="op" id="4696815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4696818">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="4696844">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="4696911">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="4696935">func</span>&nbsp;<span class="op" id="4696940">(</span><span class="ident" id="4696941">f</span>&nbsp;<span class="op" id="4696943">*</span><span class="ident" id="4696944">File</span><span class="op" id="4696948">)</span>&nbsp;<span class="ident" id="4696950">Close</span><span class="op" id="4696955">(</span><span class="op" id="4696956">)</span>&nbsp;<span class="builtintype" id="4696958">error</span>&nbsp;<span class="op" id="4696964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696967">var</span>&nbsp;<span class="ident" id="4696971">err</span>&nbsp;<span class="builtintype" id="4696975">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4696982">if</span>&nbsp;<span class="ident" id="4696985">f</span><span class="op" id="4696986">.</span><span class="ident" id="4696987">closer</span>&nbsp;<span class="op" id="4696994">!=</span>&nbsp;<span class="ident" id="4696997">nil</span>&nbsp;<span class="op" id="4697001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697005">err</span>&nbsp;<span class="op" id="4697009">=</span>&nbsp;<span class="ident" id="4697011">f</span><span class="op" id="4697012">.</span><span class="ident" id="4697013">closer</span><span class="op" id="4697019">.</span><span class="ident" id="4697020">Close</span><span class="op" id="4697025">(</span><span class="op" id="4697026">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697030">f</span><span class="op" id="4697031">.</span><span class="ident" id="4697032">closer</span>&nbsp;<span class="op" id="4697039">=</span>&nbsp;<span class="ident" id="4697041">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697049">return</span>&nbsp;<span class="ident" id="4697056">err</span><br>
<span class="lineno"></span><span class="op" id="4697060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="4697063">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4697120">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4697171">func</span>&nbsp;<span class="op" id="4697176">(</span><span class="ident" id="4697177">f</span>&nbsp;<span class="op" id="4697179">*</span><span class="ident" id="4697180">File</span><span class="op" id="4697184">)</span>&nbsp;<span class="ident" id="4697186">SectionByType</span><span class="op" id="4697199">(</span><span class="ident" id="4697200">typ</span>&nbsp;<span class="ident" id="4697204">SectionType</span><span class="op" id="4697215">)</span>&nbsp;<span class="op" id="4697217">*</span><span class="ident" id="4697218">Section</span>&nbsp;<span class="op" id="4697226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697229">for</span>&nbsp;<span class="ident" id="4697233">_</span><span class="op" id="4697234">,</span>&nbsp;<span class="ident" id="4697236">s</span>&nbsp;<span class="op" id="4697238">:=</span>&nbsp;<span class="keyword" id="4697241">range</span>&nbsp;<span class="ident" id="4697247">f</span><span class="op" id="4697248">.</span><span class="ident" id="4697249">Sections</span>&nbsp;<span class="op" id="4697258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697262">if</span>&nbsp;<span class="ident" id="4697265">s</span><span class="op" id="4697266">.</span><span class="ident" id="4697267">Type</span>&nbsp;<span class="op" id="4697272">==</span>&nbsp;<span class="ident" id="4697275">typ</span>&nbsp;<span class="op" id="4697279">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697284">return</span>&nbsp;<span class="ident" id="4697291">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697301">return</span>&nbsp;<span class="ident" id="4697308">nil</span><br>
<span class="lineno"></span><span class="op" id="4697312">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4697315">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="4697398">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="4697468">func</span>&nbsp;<span class="ident" id="4697473">NewFile</span><span class="op" id="4697480">(</span><span class="ident" id="4697481">r</span>&nbsp;<span class="ident" id="4697483">io</span><span class="op" id="4697485">.</span><span class="ident" id="4697486">ReaderAt</span><span class="op" id="4697494">)</span>&nbsp;<span class="op" id="4697496">(</span><span class="op" id="4697497">*</span><span class="ident" id="4697498">File</span><span class="op" id="4697502">,</span>&nbsp;<span class="builtintype" id="4697504">error</span><span class="op" id="4697509">)</span>&nbsp;<span class="op" id="4697511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697514">sr</span>&nbsp;<span class="op" id="4697517">:=</span>&nbsp;<span class="ident" id="4697520">io</span><span class="op" id="4697522">.</span><span class="ident" id="4697523">NewSectionReader</span><span class="op" id="4697539">(</span><span class="ident" id="4697540">r</span><span class="op" id="4697541">,</span>&nbsp;<span class="num" id="4697543">0</span><span class="op" id="4697544">,</span>&nbsp;<span class="num" id="4697546">1</span><span class="op" id="4697547">&lt;&lt;</span><span class="num" id="4697549">63</span><span class="op" id="4697551">-</span><span class="num" id="4697552">1</span><span class="op" id="4697553">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4697556">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697591">var</span>&nbsp;<span class="ident" id="4697595">ident</span>&nbsp;<span class="op" id="4697601">[</span><span class="num" id="4697602">16</span><span class="op" id="4697604">]</span><span class="builtintype" id="4697605">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697612">if</span>&nbsp;<span class="ident" id="4697615">_</span><span class="op" id="4697616">,</span>&nbsp;<span class="ident" id="4697618">err</span>&nbsp;<span class="op" id="4697622">:=</span>&nbsp;<span class="ident" id="4697625">r</span><span class="op" id="4697626">.</span><span class="ident" id="4697627">ReadAt</span><span class="op" id="4697633">(</span><span class="ident" id="4697634">ident</span><span class="op" id="4697639">[</span><span class="num" id="4697640">0</span><span class="op" id="4697641">:</span><span class="op" id="4697642">]</span><span class="op" id="4697643">,</span>&nbsp;<span class="num" id="4697645">0</span><span class="op" id="4697646">)</span><span class="op" id="4697647">;</span>&nbsp;<span class="ident" id="4697649">err</span>&nbsp;<span class="op" id="4697653">!=</span>&nbsp;<span class="ident" id="4697656">nil</span>&nbsp;<span class="op" id="4697660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697664">return</span>&nbsp;<span class="ident" id="4697671">nil</span><span class="op" id="4697674">,</span>&nbsp;<span class="ident" id="4697676">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697681">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697684">if</span>&nbsp;<span class="ident" id="4697687">ident</span><span class="op" id="4697692">[</span><span class="num" id="4697693">0</span><span class="op" id="4697694">]</span>&nbsp;<span class="op" id="4697696">!=</span>&nbsp;<span class="string" id="4697699">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="4697706">||</span>&nbsp;<span class="ident" id="4697709">ident</span><span class="op" id="4697714">[</span><span class="num" id="4697715">1</span><span class="op" id="4697716">]</span>&nbsp;<span class="op" id="4697718">!=</span>&nbsp;<span class="string" id="4697721">&#39;E&#39;</span>&nbsp;<span class="op" id="4697725">||</span>&nbsp;<span class="ident" id="4697728">ident</span><span class="op" id="4697733">[</span><span class="num" id="4697734">2</span><span class="op" id="4697735">]</span>&nbsp;<span class="op" id="4697737">!=</span>&nbsp;<span class="string" id="4697740">&#39;L&#39;</span>&nbsp;<span class="op" id="4697744">||</span>&nbsp;<span class="ident" id="4697747">ident</span><span class="op" id="4697752">[</span><span class="num" id="4697753">3</span><span class="op" id="4697754">]</span>&nbsp;<span class="op" id="4697756">!=</span>&nbsp;<span class="string" id="4697759">&#39;F&#39;</span>&nbsp;<span class="op" id="4697763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697767">return</span>&nbsp;<span class="ident" id="4697774">nil</span><span class="op" id="4697777">,</span>&nbsp;<span class="op" id="4697779">&amp;</span><span class="ident" id="4697780">FormatError</span><span class="op" id="4697791">{</span><span class="num" id="4697792">0</span><span class="op" id="4697793">,</span>&nbsp;<span class="string" id="4697795">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="4697813">,</span>&nbsp;<span class="ident" id="4697815">ident</span><span class="op" id="4697820">[</span><span class="num" id="4697821">0</span><span class="op" id="4697822">:</span><span class="num" id="4697823">4</span><span class="op" id="4697824">]</span><span class="op" id="4697825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4697828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697832">f</span>&nbsp;<span class="op" id="4697834">:=</span>&nbsp;<span class="builtinfunc" id="4697837">new</span><span class="op" id="4697840">(</span><span class="ident" id="4697841">File</span><span class="op" id="4697845">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4697848">f</span><span class="op" id="4697849">.</span><span class="ident" id="4697850">Class</span>&nbsp;<span class="op" id="4697856">=</span>&nbsp;<span class="ident" id="4697858">Class</span><span class="op" id="4697863">(</span><span class="ident" id="4697864">ident</span><span class="op" id="4697869">[</span><span class="ident" id="4697870">EI_CLASS</span><span class="op" id="4697878">]</span><span class="op" id="4697879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697882">switch</span>&nbsp;<span class="ident" id="4697889">f</span><span class="op" id="4697890">.</span><span class="ident" id="4697891">Class</span>&nbsp;<span class="op" id="4697897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697900">case</span>&nbsp;<span class="ident" id="4697905">ELFCLASS32</span><span class="op" id="4697915">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697918">case</span>&nbsp;<span class="ident" id="4697923">ELFCLASS64</span><span class="op" id="4697933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4697937">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697944">default</span><span class="op" id="4697951">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4697955">return</span>&nbsp;<span class="ident" id="4697962">nil</span><span class="op" id="4697965">,</span>&nbsp;<span class="op" id="4697967">&amp;</span><span class="ident" id="4697968">FormatError</span><span class="op" id="4697979">{</span><span class="num" id="4697980">0</span><span class="op" id="4697981">,</span>&nbsp;<span class="string" id="4697983">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="4698002">,</span>&nbsp;<span class="ident" id="4698004">f</span><span class="op" id="4698005">.</span><span class="ident" id="4698006">Class</span><span class="op" id="4698011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698018">f</span><span class="op" id="4698019">.</span><span class="ident" id="4698020">Data</span>&nbsp;<span class="op" id="4698025">=</span>&nbsp;<span class="ident" id="4698027">Data</span><span class="op" id="4698031">(</span><span class="ident" id="4698032">ident</span><span class="op" id="4698037">[</span><span class="ident" id="4698038">EI_DATA</span><span class="op" id="4698045">]</span><span class="op" id="4698046">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698049">switch</span>&nbsp;<span class="ident" id="4698056">f</span><span class="op" id="4698057">.</span><span class="ident" id="4698058">Data</span>&nbsp;<span class="op" id="4698063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698066">case</span>&nbsp;<span class="ident" id="4698071">ELFDATA2LSB</span><span class="op" id="4698082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698086">f</span><span class="op" id="4698087">.</span><span class="ident" id="4698088">ByteOrder</span>&nbsp;<span class="op" id="4698098">=</span>&nbsp;<span class="ident" id="4698100">binary</span><span class="op" id="4698106">.</span><span class="ident" id="4698107">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698121">case</span>&nbsp;<span class="ident" id="4698126">ELFDATA2MSB</span><span class="op" id="4698137">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698141">f</span><span class="op" id="4698142">.</span><span class="ident" id="4698143">ByteOrder</span>&nbsp;<span class="op" id="4698153">=</span>&nbsp;<span class="ident" id="4698155">binary</span><span class="op" id="4698161">.</span><span class="ident" id="4698162">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698173">default</span><span class="op" id="4698180">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698184">return</span>&nbsp;<span class="ident" id="4698191">nil</span><span class="op" id="4698194">,</span>&nbsp;<span class="op" id="4698196">&amp;</span><span class="ident" id="4698197">FormatError</span><span class="op" id="4698208">{</span><span class="num" id="4698209">0</span><span class="op" id="4698210">,</span>&nbsp;<span class="string" id="4698212">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="4698239">,</span>&nbsp;<span class="ident" id="4698241">f</span><span class="op" id="4698242">.</span><span class="ident" id="4698243">Data</span><span class="op" id="4698247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698254">f</span><span class="op" id="4698255">.</span><span class="ident" id="4698256">Version</span>&nbsp;<span class="op" id="4698264">=</span>&nbsp;<span class="ident" id="4698266">Version</span><span class="op" id="4698273">(</span><span class="ident" id="4698274">ident</span><span class="op" id="4698279">[</span><span class="ident" id="4698280">EI_VERSION</span><span class="op" id="4698290">]</span><span class="op" id="4698291">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698294">if</span>&nbsp;<span class="ident" id="4698297">f</span><span class="op" id="4698298">.</span><span class="ident" id="4698299">Version</span>&nbsp;<span class="op" id="4698307">!=</span>&nbsp;<span class="ident" id="4698310">EV_CURRENT</span>&nbsp;<span class="op" id="4698321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698325">return</span>&nbsp;<span class="ident" id="4698332">nil</span><span class="op" id="4698335">,</span>&nbsp;<span class="op" id="4698337">&amp;</span><span class="ident" id="4698338">FormatError</span><span class="op" id="4698349">{</span><span class="num" id="4698350">0</span><span class="op" id="4698351">,</span>&nbsp;<span class="string" id="4698353">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="4698374">,</span>&nbsp;<span class="ident" id="4698376">f</span><span class="op" id="4698377">.</span><span class="ident" id="4698378">Version</span><span class="op" id="4698385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698392">f</span><span class="op" id="4698393">.</span><span class="ident" id="4698394">OSABI</span>&nbsp;<span class="op" id="4698400">=</span>&nbsp;<span class="ident" id="4698402">OSABI</span><span class="op" id="4698407">(</span><span class="ident" id="4698408">ident</span><span class="op" id="4698413">[</span><span class="ident" id="4698414">EI_OSABI</span><span class="op" id="4698422">]</span><span class="op" id="4698423">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698426">f</span><span class="op" id="4698427">.</span><span class="ident" id="4698428">ABIVersion</span>&nbsp;<span class="op" id="4698439">=</span>&nbsp;<span class="ident" id="4698441">ident</span><span class="op" id="4698446">[</span><span class="ident" id="4698447">EI_ABIVERSION</span><span class="op" id="4698460">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4698464">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698489">var</span>&nbsp;<span class="ident" id="4698493">phoff</span>&nbsp;<span class="ident" id="4698499">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698506">var</span>&nbsp;<span class="ident" id="4698510">phentsize</span><span class="op" id="4698519">,</span>&nbsp;<span class="ident" id="4698521">phnum</span>&nbsp;<span class="builtintype" id="4698527">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698532">var</span>&nbsp;<span class="ident" id="4698536">shoff</span>&nbsp;<span class="ident" id="4698542">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698549">var</span>&nbsp;<span class="ident" id="4698553">shentsize</span><span class="op" id="4698562">,</span>&nbsp;<span class="ident" id="4698564">shnum</span><span class="op" id="4698569">,</span>&nbsp;<span class="ident" id="4698571">shstrndx</span>&nbsp;<span class="builtintype" id="4698580">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698585">shstrndx</span>&nbsp;<span class="op" id="4698594">=</span>&nbsp;<span class="op" id="4698596">-</span><span class="num" id="4698597">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698600">switch</span>&nbsp;<span class="ident" id="4698607">f</span><span class="op" id="4698608">.</span><span class="ident" id="4698609">Class</span>&nbsp;<span class="op" id="4698615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698618">case</span>&nbsp;<span class="ident" id="4698623">ELFCLASS32</span><span class="op" id="4698633">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698637">hdr</span>&nbsp;<span class="op" id="4698641">:=</span>&nbsp;<span class="builtinfunc" id="4698644">new</span><span class="op" id="4698647">(</span><span class="ident" id="4698648">Header32</span><span class="op" id="4698656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698660">sr</span><span class="op" id="4698662">.</span><span class="ident" id="4698663">Seek</span><span class="op" id="4698667">(</span><span class="num" id="4698668">0</span><span class="op" id="4698669">,</span>&nbsp;<span class="ident" id="4698671">os</span><span class="op" id="4698673">.</span><span class="ident" id="4698674">SEEK_SET</span><span class="op" id="4698682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698686">if</span>&nbsp;<span class="ident" id="4698689">err</span>&nbsp;<span class="op" id="4698693">:=</span>&nbsp;<span class="ident" id="4698696">binary</span><span class="op" id="4698702">.</span><span class="ident" id="4698703">Read</span><span class="op" id="4698707">(</span><span class="ident" id="4698708">sr</span><span class="op" id="4698710">,</span>&nbsp;<span class="ident" id="4698712">f</span><span class="op" id="4698713">.</span><span class="ident" id="4698714">ByteOrder</span><span class="op" id="4698723">,</span>&nbsp;<span class="ident" id="4698725">hdr</span><span class="op" id="4698728">)</span><span class="op" id="4698729">;</span>&nbsp;<span class="ident" id="4698731">err</span>&nbsp;<span class="op" id="4698735">!=</span>&nbsp;<span class="ident" id="4698738">nil</span>&nbsp;<span class="op" id="4698742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698747">return</span>&nbsp;<span class="ident" id="4698754">nil</span><span class="op" id="4698757">,</span>&nbsp;<span class="ident" id="4698759">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698765">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698769">f</span><span class="op" id="4698770">.</span><span class="ident" id="4698771">Type</span>&nbsp;<span class="op" id="4698776">=</span>&nbsp;<span class="ident" id="4698778">Type</span><span class="op" id="4698782">(</span><span class="ident" id="4698783">hdr</span><span class="op" id="4698786">.</span><span class="ident" id="4698787">Type</span><span class="op" id="4698791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698795">f</span><span class="op" id="4698796">.</span><span class="ident" id="4698797">Machine</span>&nbsp;<span class="op" id="4698805">=</span>&nbsp;<span class="ident" id="4698807">Machine</span><span class="op" id="4698814">(</span><span class="ident" id="4698815">hdr</span><span class="op" id="4698818">.</span><span class="ident" id="4698819">Machine</span><span class="op" id="4698826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698830">f</span><span class="op" id="4698831">.</span><span class="ident" id="4698832">Entry</span>&nbsp;<span class="op" id="4698838">=</span>&nbsp;<span class="ident" id="4698840">uint64</span><span class="op" id="4698846">(</span><span class="ident" id="4698847">hdr</span><span class="op" id="4698850">.</span><span class="ident" id="4698851">Entry</span><span class="op" id="4698856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698860">if</span>&nbsp;<span class="ident" id="4698863">v</span>&nbsp;<span class="op" id="4698865">:=</span>&nbsp;<span class="ident" id="4698868">Version</span><span class="op" id="4698875">(</span><span class="ident" id="4698876">hdr</span><span class="op" id="4698879">.</span><span class="ident" id="4698880">Version</span><span class="op" id="4698887">)</span><span class="op" id="4698888">;</span>&nbsp;<span class="ident" id="4698890">v</span>&nbsp;<span class="op" id="4698892">!=</span>&nbsp;<span class="ident" id="4698895">f</span><span class="op" id="4698896">.</span><span class="ident" id="4698897">Version</span>&nbsp;<span class="op" id="4698905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4698910">return</span>&nbsp;<span class="ident" id="4698917">nil</span><span class="op" id="4698920">,</span>&nbsp;<span class="op" id="4698922">&amp;</span><span class="ident" id="4698923">FormatError</span><span class="op" id="4698934">{</span><span class="num" id="4698935">0</span><span class="op" id="4698936">,</span>&nbsp;<span class="string" id="4698938">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="4698962">,</span>&nbsp;<span class="ident" id="4698964">v</span><span class="op" id="4698965">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4698969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4698973">phoff</span>&nbsp;<span class="op" id="4698979">=</span>&nbsp;<span class="ident" id="4698981">int64</span><span class="op" id="4698986">(</span><span class="ident" id="4698987">hdr</span><span class="op" id="4698990">.</span><span class="ident" id="4698991">Phoff</span><span class="op" id="4698996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699000">phentsize</span>&nbsp;<span class="op" id="4699010">=</span>&nbsp;<span class="builtintype" id="4699012">int</span><span class="op" id="4699015">(</span><span class="ident" id="4699016">hdr</span><span class="op" id="4699019">.</span><span class="ident" id="4699020">Phentsize</span><span class="op" id="4699029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699033">phnum</span>&nbsp;<span class="op" id="4699039">=</span>&nbsp;<span class="builtintype" id="4699041">int</span><span class="op" id="4699044">(</span><span class="ident" id="4699045">hdr</span><span class="op" id="4699048">.</span><span class="ident" id="4699049">Phnum</span><span class="op" id="4699054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699058">shoff</span>&nbsp;<span class="op" id="4699064">=</span>&nbsp;<span class="ident" id="4699066">int64</span><span class="op" id="4699071">(</span><span class="ident" id="4699072">hdr</span><span class="op" id="4699075">.</span><span class="ident" id="4699076">Shoff</span><span class="op" id="4699081">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699085">shentsize</span>&nbsp;<span class="op" id="4699095">=</span>&nbsp;<span class="builtintype" id="4699097">int</span><span class="op" id="4699100">(</span><span class="ident" id="4699101">hdr</span><span class="op" id="4699104">.</span><span class="ident" id="4699105">Shentsize</span><span class="op" id="4699114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699118">shnum</span>&nbsp;<span class="op" id="4699124">=</span>&nbsp;<span class="builtintype" id="4699126">int</span><span class="op" id="4699129">(</span><span class="ident" id="4699130">hdr</span><span class="op" id="4699133">.</span><span class="ident" id="4699134">Shnum</span><span class="op" id="4699139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699143">shstrndx</span>&nbsp;<span class="op" id="4699152">=</span>&nbsp;<span class="builtintype" id="4699154">int</span><span class="op" id="4699157">(</span><span class="ident" id="4699158">hdr</span><span class="op" id="4699161">.</span><span class="ident" id="4699162">Shstrndx</span><span class="op" id="4699170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699173">case</span>&nbsp;<span class="ident" id="4699178">ELFCLASS64</span><span class="op" id="4699188">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699192">hdr</span>&nbsp;<span class="op" id="4699196">:=</span>&nbsp;<span class="builtinfunc" id="4699199">new</span><span class="op" id="4699202">(</span><span class="ident" id="4699203">Header64</span><span class="op" id="4699211">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699215">sr</span><span class="op" id="4699217">.</span><span class="ident" id="4699218">Seek</span><span class="op" id="4699222">(</span><span class="num" id="4699223">0</span><span class="op" id="4699224">,</span>&nbsp;<span class="ident" id="4699226">os</span><span class="op" id="4699228">.</span><span class="ident" id="4699229">SEEK_SET</span><span class="op" id="4699237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699241">if</span>&nbsp;<span class="ident" id="4699244">err</span>&nbsp;<span class="op" id="4699248">:=</span>&nbsp;<span class="ident" id="4699251">binary</span><span class="op" id="4699257">.</span><span class="ident" id="4699258">Read</span><span class="op" id="4699262">(</span><span class="ident" id="4699263">sr</span><span class="op" id="4699265">,</span>&nbsp;<span class="ident" id="4699267">f</span><span class="op" id="4699268">.</span><span class="ident" id="4699269">ByteOrder</span><span class="op" id="4699278">,</span>&nbsp;<span class="ident" id="4699280">hdr</span><span class="op" id="4699283">)</span><span class="op" id="4699284">;</span>&nbsp;<span class="ident" id="4699286">err</span>&nbsp;<span class="op" id="4699290">!=</span>&nbsp;<span class="ident" id="4699293">nil</span>&nbsp;<span class="op" id="4699297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699302">return</span>&nbsp;<span class="ident" id="4699309">nil</span><span class="op" id="4699312">,</span>&nbsp;<span class="ident" id="4699314">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699324">f</span><span class="op" id="4699325">.</span><span class="ident" id="4699326">Type</span>&nbsp;<span class="op" id="4699331">=</span>&nbsp;<span class="ident" id="4699333">Type</span><span class="op" id="4699337">(</span><span class="ident" id="4699338">hdr</span><span class="op" id="4699341">.</span><span class="ident" id="4699342">Type</span><span class="op" id="4699346">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699350">f</span><span class="op" id="4699351">.</span><span class="ident" id="4699352">Machine</span>&nbsp;<span class="op" id="4699360">=</span>&nbsp;<span class="ident" id="4699362">Machine</span><span class="op" id="4699369">(</span><span class="ident" id="4699370">hdr</span><span class="op" id="4699373">.</span><span class="ident" id="4699374">Machine</span><span class="op" id="4699381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699385">f</span><span class="op" id="4699386">.</span><span class="ident" id="4699387">Entry</span>&nbsp;<span class="op" id="4699393">=</span>&nbsp;<span class="ident" id="4699395">uint64</span><span class="op" id="4699401">(</span><span class="ident" id="4699402">hdr</span><span class="op" id="4699405">.</span><span class="ident" id="4699406">Entry</span><span class="op" id="4699411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699415">if</span>&nbsp;<span class="ident" id="4699418">v</span>&nbsp;<span class="op" id="4699420">:=</span>&nbsp;<span class="ident" id="4699423">Version</span><span class="op" id="4699430">(</span><span class="ident" id="4699431">hdr</span><span class="op" id="4699434">.</span><span class="ident" id="4699435">Version</span><span class="op" id="4699442">)</span><span class="op" id="4699443">;</span>&nbsp;<span class="ident" id="4699445">v</span>&nbsp;<span class="op" id="4699447">!=</span>&nbsp;<span class="ident" id="4699450">f</span><span class="op" id="4699451">.</span><span class="ident" id="4699452">Version</span>&nbsp;<span class="op" id="4699460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699465">return</span>&nbsp;<span class="ident" id="4699472">nil</span><span class="op" id="4699475">,</span>&nbsp;<span class="op" id="4699477">&amp;</span><span class="ident" id="4699478">FormatError</span><span class="op" id="4699489">{</span><span class="num" id="4699490">0</span><span class="op" id="4699491">,</span>&nbsp;<span class="string" id="4699493">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="4699517">,</span>&nbsp;<span class="ident" id="4699519">v</span><span class="op" id="4699520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699524">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699528">phoff</span>&nbsp;<span class="op" id="4699534">=</span>&nbsp;<span class="ident" id="4699536">int64</span><span class="op" id="4699541">(</span><span class="ident" id="4699542">hdr</span><span class="op" id="4699545">.</span><span class="ident" id="4699546">Phoff</span><span class="op" id="4699551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699555">phentsize</span>&nbsp;<span class="op" id="4699565">=</span>&nbsp;<span class="builtintype" id="4699567">int</span><span class="op" id="4699570">(</span><span class="ident" id="4699571">hdr</span><span class="op" id="4699574">.</span><span class="ident" id="4699575">Phentsize</span><span class="op" id="4699584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699588">phnum</span>&nbsp;<span class="op" id="4699594">=</span>&nbsp;<span class="builtintype" id="4699596">int</span><span class="op" id="4699599">(</span><span class="ident" id="4699600">hdr</span><span class="op" id="4699603">.</span><span class="ident" id="4699604">Phnum</span><span class="op" id="4699609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699613">shoff</span>&nbsp;<span class="op" id="4699619">=</span>&nbsp;<span class="ident" id="4699621">int64</span><span class="op" id="4699626">(</span><span class="ident" id="4699627">hdr</span><span class="op" id="4699630">.</span><span class="ident" id="4699631">Shoff</span><span class="op" id="4699636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699640">shentsize</span>&nbsp;<span class="op" id="4699650">=</span>&nbsp;<span class="builtintype" id="4699652">int</span><span class="op" id="4699655">(</span><span class="ident" id="4699656">hdr</span><span class="op" id="4699659">.</span><span class="ident" id="4699660">Shentsize</span><span class="op" id="4699669">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699673">shnum</span>&nbsp;<span class="op" id="4699679">=</span>&nbsp;<span class="builtintype" id="4699681">int</span><span class="op" id="4699684">(</span><span class="ident" id="4699685">hdr</span><span class="op" id="4699688">.</span><span class="ident" id="4699689">Shnum</span><span class="op" id="4699694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699698">shstrndx</span>&nbsp;<span class="op" id="4699707">=</span>&nbsp;<span class="builtintype" id="4699709">int</span><span class="op" id="4699712">(</span><span class="ident" id="4699713">hdr</span><span class="op" id="4699716">.</span><span class="ident" id="4699717">Shstrndx</span><span class="op" id="4699725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699732">if</span>&nbsp;<span class="ident" id="4699735">shnum</span>&nbsp;<span class="op" id="4699741">&gt;</span>&nbsp;<span class="num" id="4699743">0</span>&nbsp;<span class="op" id="4699745">&amp;&amp;</span>&nbsp;<span class="ident" id="4699748">shoff</span>&nbsp;<span class="op" id="4699754">&gt;</span>&nbsp;<span class="num" id="4699756">0</span>&nbsp;<span class="op" id="4699758">&amp;&amp;</span>&nbsp;<span class="op" id="4699761">(</span><span class="ident" id="4699762">shstrndx</span>&nbsp;<span class="op" id="4699771">&lt;</span>&nbsp;<span class="num" id="4699773">0</span>&nbsp;<span class="op" id="4699775">||</span>&nbsp;<span class="ident" id="4699778">shstrndx</span>&nbsp;<span class="op" id="4699787">&gt;=</span>&nbsp;<span class="ident" id="4699790">shnum</span><span class="op" id="4699795">)</span>&nbsp;<span class="op" id="4699797">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699801">return</span>&nbsp;<span class="ident" id="4699808">nil</span><span class="op" id="4699811">,</span>&nbsp;<span class="op" id="4699813">&amp;</span><span class="ident" id="4699814">FormatError</span><span class="op" id="4699825">{</span><span class="num" id="4699826">0</span><span class="op" id="4699827">,</span>&nbsp;<span class="string" id="4699829">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="4699851">,</span>&nbsp;<span class="ident" id="4699853">shstrndx</span><span class="op" id="4699861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4699864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4699868">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699893">f</span><span class="op" id="4699894">.</span><span class="ident" id="4699895">Progs</span>&nbsp;<span class="op" id="4699901">=</span>&nbsp;<span class="builtinfunc" id="4699903">make</span><span class="op" id="4699907">(</span><span class="op" id="4699908">[</span><span class="op" id="4699909">]</span><span class="op" id="4699910">*</span><span class="ident" id="4699911">Prog</span><span class="op" id="4699915">,</span>&nbsp;<span class="ident" id="4699917">phnum</span><span class="op" id="4699922">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4699925">for</span>&nbsp;<span class="ident" id="4699929">i</span>&nbsp;<span class="op" id="4699931">:=</span>&nbsp;<span class="num" id="4699934">0</span><span class="op" id="4699935">;</span>&nbsp;<span class="ident" id="4699937">i</span>&nbsp;<span class="op" id="4699939">&lt;</span>&nbsp;<span class="ident" id="4699941">phnum</span><span class="op" id="4699946">;</span>&nbsp;<span class="ident" id="4699948">i</span><span class="op" id="4699949">++</span>&nbsp;<span class="op" id="4699952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699956">off</span>&nbsp;<span class="op" id="4699960">:=</span>&nbsp;<span class="ident" id="4699963">phoff</span>&nbsp;<span class="op" id="4699969">+</span>&nbsp;<span class="ident" id="4699971">int64</span><span class="op" id="4699976">(</span><span class="ident" id="4699977">i</span><span class="op" id="4699978">)</span><span class="op" id="4699979">*</span><span class="ident" id="4699980">int64</span><span class="op" id="4699985">(</span><span class="ident" id="4699986">phentsize</span><span class="op" id="4699995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4699999">sr</span><span class="op" id="4700001">.</span><span class="ident" id="4700002">Seek</span><span class="op" id="4700006">(</span><span class="ident" id="4700007">off</span><span class="op" id="4700010">,</span>&nbsp;<span class="ident" id="4700012">os</span><span class="op" id="4700014">.</span><span class="ident" id="4700015">SEEK_SET</span><span class="op" id="4700023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700027">p</span>&nbsp;<span class="op" id="4700029">:=</span>&nbsp;<span class="builtinfunc" id="4700032">new</span><span class="op" id="4700035">(</span><span class="ident" id="4700036">Prog</span><span class="op" id="4700040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700044">switch</span>&nbsp;<span class="ident" id="4700051">f</span><span class="op" id="4700052">.</span><span class="ident" id="4700053">Class</span>&nbsp;<span class="op" id="4700059">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700063">case</span>&nbsp;<span class="ident" id="4700068">ELFCLASS32</span><span class="op" id="4700078">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700083">ph</span>&nbsp;<span class="op" id="4700086">:=</span>&nbsp;<span class="builtinfunc" id="4700089">new</span><span class="op" id="4700092">(</span><span class="ident" id="4700093">Prog32</span><span class="op" id="4700099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700104">if</span>&nbsp;<span class="ident" id="4700107">err</span>&nbsp;<span class="op" id="4700111">:=</span>&nbsp;<span class="ident" id="4700114">binary</span><span class="op" id="4700120">.</span><span class="ident" id="4700121">Read</span><span class="op" id="4700125">(</span><span class="ident" id="4700126">sr</span><span class="op" id="4700128">,</span>&nbsp;<span class="ident" id="4700130">f</span><span class="op" id="4700131">.</span><span class="ident" id="4700132">ByteOrder</span><span class="op" id="4700141">,</span>&nbsp;<span class="ident" id="4700143">ph</span><span class="op" id="4700145">)</span><span class="op" id="4700146">;</span>&nbsp;<span class="ident" id="4700148">err</span>&nbsp;<span class="op" id="4700152">!=</span>&nbsp;<span class="ident" id="4700155">nil</span>&nbsp;<span class="op" id="4700159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700165">return</span>&nbsp;<span class="ident" id="4700172">nil</span><span class="op" id="4700175">,</span>&nbsp;<span class="ident" id="4700177">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700184">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700189">p</span><span class="op" id="4700190">.</span><span class="ident" id="4700191">ProgHeader</span>&nbsp;<span class="op" id="4700202">=</span>&nbsp;<span class="ident" id="4700204">ProgHeader</span><span class="op" id="4700214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700220">Type</span><span class="op" id="4700224">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4700228">ProgType</span><span class="op" id="4700236">(</span><span class="ident" id="4700237">ph</span><span class="op" id="4700239">.</span><span class="ident" id="4700240">Type</span><span class="op" id="4700244">)</span><span class="op" id="4700245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700251">Flags</span><span class="op" id="4700256">:</span>&nbsp;&nbsp;<span class="ident" id="4700259">ProgFlag</span><span class="op" id="4700267">(</span><span class="ident" id="4700268">ph</span><span class="op" id="4700270">.</span><span class="ident" id="4700271">Flags</span><span class="op" id="4700276">)</span><span class="op" id="4700277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700283">Off</span><span class="op" id="4700286">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700291">uint64</span><span class="op" id="4700297">(</span><span class="ident" id="4700298">ph</span><span class="op" id="4700300">.</span><span class="ident" id="4700301">Off</span><span class="op" id="4700304">)</span><span class="op" id="4700305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700311">Vaddr</span><span class="op" id="4700316">:</span>&nbsp;&nbsp;<span class="ident" id="4700319">uint64</span><span class="op" id="4700325">(</span><span class="ident" id="4700326">ph</span><span class="op" id="4700328">.</span><span class="ident" id="4700329">Vaddr</span><span class="op" id="4700334">)</span><span class="op" id="4700335">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700341">Paddr</span><span class="op" id="4700346">:</span>&nbsp;&nbsp;<span class="ident" id="4700349">uint64</span><span class="op" id="4700355">(</span><span class="ident" id="4700356">ph</span><span class="op" id="4700358">.</span><span class="ident" id="4700359">Paddr</span><span class="op" id="4700364">)</span><span class="op" id="4700365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700371">Filesz</span><span class="op" id="4700377">:</span>&nbsp;<span class="ident" id="4700379">uint64</span><span class="op" id="4700385">(</span><span class="ident" id="4700386">ph</span><span class="op" id="4700388">.</span><span class="ident" id="4700389">Filesz</span><span class="op" id="4700395">)</span><span class="op" id="4700396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700402">Memsz</span><span class="op" id="4700407">:</span>&nbsp;&nbsp;<span class="ident" id="4700410">uint64</span><span class="op" id="4700416">(</span><span class="ident" id="4700417">ph</span><span class="op" id="4700419">.</span><span class="ident" id="4700420">Memsz</span><span class="op" id="4700425">)</span><span class="op" id="4700426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700432">Align</span><span class="op" id="4700437">:</span>&nbsp;&nbsp;<span class="ident" id="4700440">uint64</span><span class="op" id="4700446">(</span><span class="ident" id="4700447">ph</span><span class="op" id="4700449">.</span><span class="ident" id="4700450">Align</span><span class="op" id="4700455">)</span><span class="op" id="4700456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700461">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700465">case</span>&nbsp;<span class="ident" id="4700470">ELFCLASS64</span><span class="op" id="4700480">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700485">ph</span>&nbsp;<span class="op" id="4700488">:=</span>&nbsp;<span class="builtinfunc" id="4700491">new</span><span class="op" id="4700494">(</span><span class="ident" id="4700495">Prog64</span><span class="op" id="4700501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700506">if</span>&nbsp;<span class="ident" id="4700509">err</span>&nbsp;<span class="op" id="4700513">:=</span>&nbsp;<span class="ident" id="4700516">binary</span><span class="op" id="4700522">.</span><span class="ident" id="4700523">Read</span><span class="op" id="4700527">(</span><span class="ident" id="4700528">sr</span><span class="op" id="4700530">,</span>&nbsp;<span class="ident" id="4700532">f</span><span class="op" id="4700533">.</span><span class="ident" id="4700534">ByteOrder</span><span class="op" id="4700543">,</span>&nbsp;<span class="ident" id="4700545">ph</span><span class="op" id="4700547">)</span><span class="op" id="4700548">;</span>&nbsp;<span class="ident" id="4700550">err</span>&nbsp;<span class="op" id="4700554">!=</span>&nbsp;<span class="ident" id="4700557">nil</span>&nbsp;<span class="op" id="4700561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4700567">return</span>&nbsp;<span class="ident" id="4700574">nil</span><span class="op" id="4700577">,</span>&nbsp;<span class="ident" id="4700579">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700586">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700591">p</span><span class="op" id="4700592">.</span><span class="ident" id="4700593">ProgHeader</span>&nbsp;<span class="op" id="4700604">=</span>&nbsp;<span class="ident" id="4700606">ProgHeader</span><span class="op" id="4700616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700622">Type</span><span class="op" id="4700626">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4700630">ProgType</span><span class="op" id="4700638">(</span><span class="ident" id="4700639">ph</span><span class="op" id="4700641">.</span><span class="ident" id="4700642">Type</span><span class="op" id="4700646">)</span><span class="op" id="4700647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700653">Flags</span><span class="op" id="4700658">:</span>&nbsp;&nbsp;<span class="ident" id="4700661">ProgFlag</span><span class="op" id="4700669">(</span><span class="ident" id="4700670">ph</span><span class="op" id="4700672">.</span><span class="ident" id="4700673">Flags</span><span class="op" id="4700678">)</span><span class="op" id="4700679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700685">Off</span><span class="op" id="4700688">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700693">uint64</span><span class="op" id="4700699">(</span><span class="ident" id="4700700">ph</span><span class="op" id="4700702">.</span><span class="ident" id="4700703">Off</span><span class="op" id="4700706">)</span><span class="op" id="4700707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700713">Vaddr</span><span class="op" id="4700718">:</span>&nbsp;&nbsp;<span class="ident" id="4700721">uint64</span><span class="op" id="4700727">(</span><span class="ident" id="4700728">ph</span><span class="op" id="4700730">.</span><span class="ident" id="4700731">Vaddr</span><span class="op" id="4700736">)</span><span class="op" id="4700737">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700743">Paddr</span><span class="op" id="4700748">:</span>&nbsp;&nbsp;<span class="ident" id="4700751">uint64</span><span class="op" id="4700757">(</span><span class="ident" id="4700758">ph</span><span class="op" id="4700760">.</span><span class="ident" id="4700761">Paddr</span><span class="op" id="4700766">)</span><span class="op" id="4700767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700773">Filesz</span><span class="op" id="4700779">:</span>&nbsp;<span class="ident" id="4700781">uint64</span><span class="op" id="4700787">(</span><span class="ident" id="4700788">ph</span><span class="op" id="4700790">.</span><span class="ident" id="4700791">Filesz</span><span class="op" id="4700797">)</span><span class="op" id="4700798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700804">Memsz</span><span class="op" id="4700809">:</span>&nbsp;&nbsp;<span class="ident" id="4700812">uint64</span><span class="op" id="4700818">(</span><span class="ident" id="4700819">ph</span><span class="op" id="4700821">.</span><span class="ident" id="4700822">Memsz</span><span class="op" id="4700827">)</span><span class="op" id="4700828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700834">Align</span><span class="op" id="4700839">:</span>&nbsp;&nbsp;<span class="ident" id="4700842">uint64</span><span class="op" id="4700848">(</span><span class="ident" id="4700849">ph</span><span class="op" id="4700851">.</span><span class="ident" id="4700852">Align</span><span class="op" id="4700857">)</span><span class="op" id="4700858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700863">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700871">p</span><span class="op" id="4700872">.</span><span class="ident" id="4700873">sr</span>&nbsp;<span class="op" id="4700876">=</span>&nbsp;<span class="ident" id="4700878">io</span><span class="op" id="4700880">.</span><span class="ident" id="4700881">NewSectionReader</span><span class="op" id="4700897">(</span><span class="ident" id="4700898">r</span><span class="op" id="4700899">,</span>&nbsp;<span class="ident" id="4700901">int64</span><span class="op" id="4700906">(</span><span class="ident" id="4700907">p</span><span class="op" id="4700908">.</span><span class="ident" id="4700909">Off</span><span class="op" id="4700912">)</span><span class="op" id="4700913">,</span>&nbsp;<span class="ident" id="4700915">int64</span><span class="op" id="4700920">(</span><span class="ident" id="4700921">p</span><span class="op" id="4700922">.</span><span class="ident" id="4700923">Filesz</span><span class="op" id="4700929">)</span><span class="op" id="4700930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700934">p</span><span class="op" id="4700935">.</span><span class="ident" id="4700936">ReaderAt</span>&nbsp;<span class="op" id="4700945">=</span>&nbsp;<span class="ident" id="4700947">p</span><span class="op" id="4700948">.</span><span class="ident" id="4700949">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700954">f</span><span class="op" id="4700955">.</span><span class="ident" id="4700956">Progs</span><span class="op" id="4700961">[</span><span class="ident" id="4700962">i</span><span class="op" id="4700963">]</span>&nbsp;<span class="op" id="4700965">=</span>&nbsp;<span class="ident" id="4700967">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4700970">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4700974">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4700999">f</span><span class="op" id="4701000">.</span><span class="ident" id="4701001">Sections</span>&nbsp;<span class="op" id="4701010">=</span>&nbsp;<span class="builtinfunc" id="4701012">make</span><span class="op" id="4701016">(</span><span class="op" id="4701017">[</span><span class="op" id="4701018">]</span><span class="op" id="4701019">*</span><span class="ident" id="4701020">Section</span><span class="op" id="4701027">,</span>&nbsp;<span class="ident" id="4701029">shnum</span><span class="op" id="4701034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701037">names</span>&nbsp;<span class="op" id="4701043">:=</span>&nbsp;<span class="builtinfunc" id="4701046">make</span><span class="op" id="4701050">(</span><span class="op" id="4701051">[</span><span class="op" id="4701052">]</span><span class="builtintype" id="4701053">uint32</span><span class="op" id="4701059">,</span>&nbsp;<span class="ident" id="4701061">shnum</span><span class="op" id="4701066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701069">for</span>&nbsp;<span class="ident" id="4701073">i</span>&nbsp;<span class="op" id="4701075">:=</span>&nbsp;<span class="num" id="4701078">0</span><span class="op" id="4701079">;</span>&nbsp;<span class="ident" id="4701081">i</span>&nbsp;<span class="op" id="4701083">&lt;</span>&nbsp;<span class="ident" id="4701085">shnum</span><span class="op" id="4701090">;</span>&nbsp;<span class="ident" id="4701092">i</span><span class="op" id="4701093">++</span>&nbsp;<span class="op" id="4701096">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701100">off</span>&nbsp;<span class="op" id="4701104">:=</span>&nbsp;<span class="ident" id="4701107">shoff</span>&nbsp;<span class="op" id="4701113">+</span>&nbsp;<span class="ident" id="4701115">int64</span><span class="op" id="4701120">(</span><span class="ident" id="4701121">i</span><span class="op" id="4701122">)</span><span class="op" id="4701123">*</span><span class="ident" id="4701124">int64</span><span class="op" id="4701129">(</span><span class="ident" id="4701130">shentsize</span><span class="op" id="4701139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701143">sr</span><span class="op" id="4701145">.</span><span class="ident" id="4701146">Seek</span><span class="op" id="4701150">(</span><span class="ident" id="4701151">off</span><span class="op" id="4701154">,</span>&nbsp;<span class="ident" id="4701156">os</span><span class="op" id="4701158">.</span><span class="ident" id="4701159">SEEK_SET</span><span class="op" id="4701167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701171">s</span>&nbsp;<span class="op" id="4701173">:=</span>&nbsp;<span class="builtinfunc" id="4701176">new</span><span class="op" id="4701179">(</span><span class="ident" id="4701180">Section</span><span class="op" id="4701187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701191">switch</span>&nbsp;<span class="ident" id="4701198">f</span><span class="op" id="4701199">.</span><span class="ident" id="4701200">Class</span>&nbsp;<span class="op" id="4701206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701210">case</span>&nbsp;<span class="ident" id="4701215">ELFCLASS32</span><span class="op" id="4701225">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701230">sh</span>&nbsp;<span class="op" id="4701233">:=</span>&nbsp;<span class="builtinfunc" id="4701236">new</span><span class="op" id="4701239">(</span><span class="ident" id="4701240">Section32</span><span class="op" id="4701249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701254">if</span>&nbsp;<span class="ident" id="4701257">err</span>&nbsp;<span class="op" id="4701261">:=</span>&nbsp;<span class="ident" id="4701264">binary</span><span class="op" id="4701270">.</span><span class="ident" id="4701271">Read</span><span class="op" id="4701275">(</span><span class="ident" id="4701276">sr</span><span class="op" id="4701278">,</span>&nbsp;<span class="ident" id="4701280">f</span><span class="op" id="4701281">.</span><span class="ident" id="4701282">ByteOrder</span><span class="op" id="4701291">,</span>&nbsp;<span class="ident" id="4701293">sh</span><span class="op" id="4701295">)</span><span class="op" id="4701296">;</span>&nbsp;<span class="ident" id="4701298">err</span>&nbsp;<span class="op" id="4701302">!=</span>&nbsp;<span class="ident" id="4701305">nil</span>&nbsp;<span class="op" id="4701309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701315">return</span>&nbsp;<span class="ident" id="4701322">nil</span><span class="op" id="4701325">,</span>&nbsp;<span class="ident" id="4701327">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4701334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701339">names</span><span class="op" id="4701344">[</span><span class="ident" id="4701345">i</span><span class="op" id="4701346">]</span>&nbsp;<span class="op" id="4701348">=</span>&nbsp;<span class="ident" id="4701350">sh</span><span class="op" id="4701352">.</span><span class="ident" id="4701353">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701361">s</span><span class="op" id="4701362">.</span><span class="ident" id="4701363">SectionHeader</span>&nbsp;<span class="op" id="4701377">=</span>&nbsp;<span class="ident" id="4701379">SectionHeader</span><span class="op" id="4701392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701398">Type</span><span class="op" id="4701402">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701409">SectionType</span><span class="op" id="4701420">(</span><span class="ident" id="4701421">sh</span><span class="op" id="4701423">.</span><span class="ident" id="4701424">Type</span><span class="op" id="4701428">)</span><span class="op" id="4701429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701435">Flags</span><span class="op" id="4701440">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701446">SectionFlag</span><span class="op" id="4701457">(</span><span class="ident" id="4701458">sh</span><span class="op" id="4701460">.</span><span class="ident" id="4701461">Flags</span><span class="op" id="4701466">)</span><span class="op" id="4701467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701473">Addr</span><span class="op" id="4701477">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701484">uint64</span><span class="op" id="4701490">(</span><span class="ident" id="4701491">sh</span><span class="op" id="4701493">.</span><span class="ident" id="4701494">Addr</span><span class="op" id="4701498">)</span><span class="op" id="4701499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701505">Offset</span><span class="op" id="4701511">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701516">uint64</span><span class="op" id="4701522">(</span><span class="ident" id="4701523">sh</span><span class="op" id="4701525">.</span><span class="ident" id="4701526">Off</span><span class="op" id="4701529">)</span><span class="op" id="4701530">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701536">Size</span><span class="op" id="4701540">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701547">uint64</span><span class="op" id="4701553">(</span><span class="ident" id="4701554">sh</span><span class="op" id="4701556">.</span><span class="ident" id="4701557">Size</span><span class="op" id="4701561">)</span><span class="op" id="4701562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701568">Link</span><span class="op" id="4701572">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4701579">uint32</span><span class="op" id="4701585">(</span><span class="ident" id="4701586">sh</span><span class="op" id="4701588">.</span><span class="ident" id="4701589">Link</span><span class="op" id="4701593">)</span><span class="op" id="4701594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701600">Info</span><span class="op" id="4701604">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4701611">uint32</span><span class="op" id="4701617">(</span><span class="ident" id="4701618">sh</span><span class="op" id="4701620">.</span><span class="ident" id="4701621">Info</span><span class="op" id="4701625">)</span><span class="op" id="4701626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701632">Addralign</span><span class="op" id="4701641">:</span>&nbsp;<span class="ident" id="4701643">uint64</span><span class="op" id="4701649">(</span><span class="ident" id="4701650">sh</span><span class="op" id="4701652">.</span><span class="ident" id="4701653">Addralign</span><span class="op" id="4701662">)</span><span class="op" id="4701663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701669">Entsize</span><span class="op" id="4701676">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4701680">uint64</span><span class="op" id="4701686">(</span><span class="ident" id="4701687">sh</span><span class="op" id="4701689">.</span><span class="ident" id="4701690">Entsize</span><span class="op" id="4701697">)</span><span class="op" id="4701698">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4701703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701707">case</span>&nbsp;<span class="ident" id="4701712">ELFCLASS64</span><span class="op" id="4701722">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701727">sh</span>&nbsp;<span class="op" id="4701730">:=</span>&nbsp;<span class="builtinfunc" id="4701733">new</span><span class="op" id="4701736">(</span><span class="ident" id="4701737">Section64</span><span class="op" id="4701746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701751">if</span>&nbsp;<span class="ident" id="4701754">err</span>&nbsp;<span class="op" id="4701758">:=</span>&nbsp;<span class="ident" id="4701761">binary</span><span class="op" id="4701767">.</span><span class="ident" id="4701768">Read</span><span class="op" id="4701772">(</span><span class="ident" id="4701773">sr</span><span class="op" id="4701775">,</span>&nbsp;<span class="ident" id="4701777">f</span><span class="op" id="4701778">.</span><span class="ident" id="4701779">ByteOrder</span><span class="op" id="4701788">,</span>&nbsp;<span class="ident" id="4701790">sh</span><span class="op" id="4701792">)</span><span class="op" id="4701793">;</span>&nbsp;<span class="ident" id="4701795">err</span>&nbsp;<span class="op" id="4701799">!=</span>&nbsp;<span class="ident" id="4701802">nil</span>&nbsp;<span class="op" id="4701806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4701812">return</span>&nbsp;<span class="ident" id="4701819">nil</span><span class="op" id="4701822">,</span>&nbsp;<span class="ident" id="4701824">err</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4701831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701836">names</span><span class="op" id="4701841">[</span><span class="ident" id="4701842">i</span><span class="op" id="4701843">]</span>&nbsp;<span class="op" id="4701845">=</span>&nbsp;<span class="ident" id="4701847">sh</span><span class="op" id="4701849">.</span><span class="ident" id="4701850">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701858">s</span><span class="op" id="4701859">.</span><span class="ident" id="4701860">SectionHeader</span>&nbsp;<span class="op" id="4701874">=</span>&nbsp;<span class="ident" id="4701876">SectionHeader</span><span class="op" id="4701889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701895">Type</span><span class="op" id="4701899">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701906">SectionType</span><span class="op" id="4701917">(</span><span class="ident" id="4701918">sh</span><span class="op" id="4701920">.</span><span class="ident" id="4701921">Type</span><span class="op" id="4701925">)</span><span class="op" id="4701926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701932">Flags</span><span class="op" id="4701937">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701943">SectionFlag</span><span class="op" id="4701954">(</span><span class="ident" id="4701955">sh</span><span class="op" id="4701957">.</span><span class="ident" id="4701958">Flags</span><span class="op" id="4701963">)</span><span class="op" id="4701964">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701970">Offset</span><span class="op" id="4701976">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4701981">uint64</span><span class="op" id="4701987">(</span><span class="ident" id="4701988">sh</span><span class="op" id="4701990">.</span><span class="ident" id="4701991">Off</span><span class="op" id="4701994">)</span><span class="op" id="4701995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702001">Size</span><span class="op" id="4702005">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702012">uint64</span><span class="op" id="4702018">(</span><span class="ident" id="4702019">sh</span><span class="op" id="4702021">.</span><span class="ident" id="4702022">Size</span><span class="op" id="4702026">)</span><span class="op" id="4702027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702033">Addr</span><span class="op" id="4702037">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702044">uint64</span><span class="op" id="4702050">(</span><span class="ident" id="4702051">sh</span><span class="op" id="4702053">.</span><span class="ident" id="4702054">Addr</span><span class="op" id="4702058">)</span><span class="op" id="4702059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702065">Link</span><span class="op" id="4702069">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4702076">uint32</span><span class="op" id="4702082">(</span><span class="ident" id="4702083">sh</span><span class="op" id="4702085">.</span><span class="ident" id="4702086">Link</span><span class="op" id="4702090">)</span><span class="op" id="4702091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702097">Info</span><span class="op" id="4702101">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4702108">uint32</span><span class="op" id="4702114">(</span><span class="ident" id="4702115">sh</span><span class="op" id="4702117">.</span><span class="ident" id="4702118">Info</span><span class="op" id="4702122">)</span><span class="op" id="4702123">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702129">Addralign</span><span class="op" id="4702138">:</span>&nbsp;<span class="ident" id="4702140">uint64</span><span class="op" id="4702146">(</span><span class="ident" id="4702147">sh</span><span class="op" id="4702149">.</span><span class="ident" id="4702150">Addralign</span><span class="op" id="4702159">)</span><span class="op" id="4702160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702166">Entsize</span><span class="op" id="4702173">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4702177">uint64</span><span class="op" id="4702183">(</span><span class="ident" id="4702184">sh</span><span class="op" id="4702186">.</span><span class="ident" id="4702187">Entsize</span><span class="op" id="4702194">)</span><span class="op" id="4702195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702208">s</span><span class="op" id="4702209">.</span><span class="ident" id="4702210">sr</span>&nbsp;<span class="op" id="4702213">=</span>&nbsp;<span class="ident" id="4702215">io</span><span class="op" id="4702217">.</span><span class="ident" id="4702218">NewSectionReader</span><span class="op" id="4702234">(</span><span class="ident" id="4702235">r</span><span class="op" id="4702236">,</span>&nbsp;<span class="ident" id="4702238">int64</span><span class="op" id="4702243">(</span><span class="ident" id="4702244">s</span><span class="op" id="4702245">.</span><span class="ident" id="4702246">Offset</span><span class="op" id="4702252">)</span><span class="op" id="4702253">,</span>&nbsp;<span class="ident" id="4702255">int64</span><span class="op" id="4702260">(</span><span class="ident" id="4702261">s</span><span class="op" id="4702262">.</span><span class="ident" id="4702263">Size</span><span class="op" id="4702267">)</span><span class="op" id="4702268">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702272">s</span><span class="op" id="4702273">.</span><span class="ident" id="4702274">ReaderAt</span>&nbsp;<span class="op" id="4702283">=</span>&nbsp;<span class="ident" id="4702285">s</span><span class="op" id="4702286">.</span><span class="ident" id="4702287">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702292">f</span><span class="op" id="4702293">.</span><span class="ident" id="4702294">Sections</span><span class="op" id="4702302">[</span><span class="ident" id="4702303">i</span><span class="op" id="4702304">]</span>&nbsp;<span class="op" id="4702306">=</span>&nbsp;<span class="ident" id="4702308">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702315">if</span>&nbsp;<span class="builtinfunc" id="4702318">len</span><span class="op" id="4702321">(</span><span class="ident" id="4702322">f</span><span class="op" id="4702323">.</span><span class="ident" id="4702324">Sections</span><span class="op" id="4702332">)</span>&nbsp;<span class="op" id="4702334">==</span>&nbsp;<span class="num" id="4702337">0</span>&nbsp;<span class="op" id="4702339">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702343">return</span>&nbsp;<span class="ident" id="4702350">f</span><span class="op" id="4702351">,</span>&nbsp;<span class="ident" id="4702353">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4702362">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702400">shstrtab</span><span class="op" id="4702408">,</span>&nbsp;<span class="ident" id="4702410">err</span>&nbsp;<span class="op" id="4702414">:=</span>&nbsp;<span class="ident" id="4702417">f</span><span class="op" id="4702418">.</span><span class="ident" id="4702419">Sections</span><span class="op" id="4702427">[</span><span class="ident" id="4702428">shstrndx</span><span class="op" id="4702436">]</span><span class="op" id="4702437">.</span><span class="ident" id="4702438">Data</span><span class="op" id="4702442">(</span><span class="op" id="4702443">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702446">if</span>&nbsp;<span class="ident" id="4702449">err</span>&nbsp;<span class="op" id="4702453">!=</span>&nbsp;<span class="ident" id="4702456">nil</span>&nbsp;<span class="op" id="4702460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702464">return</span>&nbsp;<span class="ident" id="4702471">nil</span><span class="op" id="4702474">,</span>&nbsp;<span class="ident" id="4702476">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702484">for</span>&nbsp;<span class="ident" id="4702488">i</span><span class="op" id="4702489">,</span>&nbsp;<span class="ident" id="4702491">s</span>&nbsp;<span class="op" id="4702493">:=</span>&nbsp;<span class="keyword" id="4702496">range</span>&nbsp;<span class="ident" id="4702502">f</span><span class="op" id="4702503">.</span><span class="ident" id="4702504">Sections</span>&nbsp;<span class="op" id="4702513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702517">var</span>&nbsp;<span class="ident" id="4702521">ok</span>&nbsp;<span class="builtintype" id="4702524">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4702531">s</span><span class="op" id="4702532">.</span><span class="ident" id="4702533">Name</span><span class="op" id="4702537">,</span>&nbsp;<span class="ident" id="4702539">ok</span>&nbsp;<span class="op" id="4702542">=</span>&nbsp;<span class="ident" id="4702544">getString</span><span class="op" id="4702553">(</span><span class="ident" id="4702554">shstrtab</span><span class="op" id="4702562">,</span>&nbsp;<span class="builtintype" id="4702564">int</span><span class="op" id="4702567">(</span><span class="ident" id="4702568">names</span><span class="op" id="4702573">[</span><span class="ident" id="4702574">i</span><span class="op" id="4702575">]</span><span class="op" id="4702576">)</span><span class="op" id="4702577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702581">if</span>&nbsp;<span class="op" id="4702584">!</span><span class="ident" id="4702585">ok</span>&nbsp;<span class="op" id="4702588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702593">return</span>&nbsp;<span class="ident" id="4702600">nil</span><span class="op" id="4702603">,</span>&nbsp;<span class="op" id="4702605">&amp;</span><span class="ident" id="4702606">FormatError</span><span class="op" id="4702617">{</span><span class="ident" id="4702618">shoff</span>&nbsp;<span class="op" id="4702624">+</span>&nbsp;<span class="ident" id="4702626">int64</span><span class="op" id="4702631">(</span><span class="ident" id="4702632">i</span><span class="op" id="4702633">*</span><span class="ident" id="4702634">shentsize</span><span class="op" id="4702643">)</span><span class="op" id="4702644">,</span>&nbsp;<span class="string" id="4702646">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="4702670">,</span>&nbsp;<span class="ident" id="4702672">names</span><span class="op" id="4702677">[</span><span class="ident" id="4702678">i</span><span class="op" id="4702679">]</span><span class="op" id="4702680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4702687">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702691">return</span>&nbsp;<span class="ident" id="4702698">f</span><span class="op" id="4702699">,</span>&nbsp;<span class="ident" id="4702701">nil</span><br>
<span class="lineno"></span><span class="op" id="4702705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4702708">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="4702779">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="4702843">func</span>&nbsp;<span class="op" id="4702848">(</span><span class="ident" id="4702849">f</span>&nbsp;<span class="op" id="4702851">*</span><span class="ident" id="4702852">File</span><span class="op" id="4702856">)</span>&nbsp;<span class="ident" id="4702858">getSymbols</span><span class="op" id="4702868">(</span><span class="ident" id="4702869">typ</span>&nbsp;<span class="ident" id="4702873">SectionType</span><span class="op" id="4702884">)</span>&nbsp;<span class="op" id="4702886">(</span><span class="op" id="4702887">[</span><span class="op" id="4702888">]</span><span class="ident" id="4702889">Symbol</span><span class="op" id="4702895">,</span>&nbsp;<span class="op" id="4702897">[</span><span class="op" id="4702898">]</span><span class="builtintype" id="4702899">byte</span><span class="op" id="4702903">,</span>&nbsp;<span class="builtintype" id="4702905">error</span><span class="op" id="4702910">)</span>&nbsp;<span class="op" id="4702912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702915">switch</span>&nbsp;<span class="ident" id="4702922">f</span><span class="op" id="4702923">.</span><span class="ident" id="4702924">Class</span>&nbsp;<span class="op" id="4702930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702933">case</span>&nbsp;<span class="ident" id="4702938">ELFCLASS64</span><span class="op" id="4702948">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702952">return</span>&nbsp;<span class="ident" id="4702959">f</span><span class="op" id="4702960">.</span><span class="ident" id="4702961">getSymbols64</span><span class="op" id="4702973">(</span><span class="ident" id="4702974">typ</span><span class="op" id="4702977">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4702981">case</span>&nbsp;<span class="ident" id="4702986">ELFCLASS32</span><span class="op" id="4702996">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703000">return</span>&nbsp;<span class="ident" id="4703007">f</span><span class="op" id="4703008">.</span><span class="ident" id="4703009">getSymbols32</span><span class="op" id="4703021">(</span><span class="ident" id="4703022">typ</span><span class="op" id="4703025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703032">return</span>&nbsp;<span class="ident" id="4703039">nil</span><span class="op" id="4703042">,</span>&nbsp;<span class="ident" id="4703044">nil</span><span class="op" id="4703047">,</span>&nbsp;<span class="ident" id="4703049">errors</span><span class="op" id="4703055">.</span><span class="ident" id="4703056">New</span><span class="op" id="4703059">(</span><span class="string" id="4703060">&#34;not&nbsp;implemented&#34;</span><span class="op" id="4703077">)</span><br>
<span class="lineno"></span><span class="op" id="4703079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4703082">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="4703150">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="4703194">var</span>&nbsp;<span class="ident" id="4703198">ErrNoSymbols</span>&nbsp;<span class="op" id="4703211">=</span>&nbsp;<span class="ident" id="4703213">errors</span><span class="op" id="4703219">.</span><span class="ident" id="4703220">New</span><span class="op" id="4703223">(</span><span class="string" id="4703224">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="4703243">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4703246">func</span>&nbsp;<span class="op" id="4703251">(</span><span class="ident" id="4703252">f</span>&nbsp;<span class="op" id="4703254">*</span><span class="ident" id="4703255">File</span><span class="op" id="4703259">)</span>&nbsp;<span class="ident" id="4703261">getSymbols32</span><span class="op" id="4703273">(</span><span class="ident" id="4703274">typ</span>&nbsp;<span class="ident" id="4703278">SectionType</span><span class="op" id="4703289">)</span>&nbsp;<span class="op" id="4703291">(</span><span class="op" id="4703292">[</span><span class="op" id="4703293">]</span><span class="ident" id="4703294">Symbol</span><span class="op" id="4703300">,</span>&nbsp;<span class="op" id="4703302">[</span><span class="op" id="4703303">]</span><span class="builtintype" id="4703304">byte</span><span class="op" id="4703308">,</span>&nbsp;<span class="builtintype" id="4703310">error</span><span class="op" id="4703315">)</span>&nbsp;<span class="op" id="4703317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4703320">symtabSection</span>&nbsp;<span class="op" id="4703334">:=</span>&nbsp;<span class="ident" id="4703337">f</span><span class="op" id="4703338">.</span><span class="ident" id="4703339">SectionByType</span><span class="op" id="4703352">(</span><span class="ident" id="4703353">typ</span><span class="op" id="4703356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703359">if</span>&nbsp;<span class="ident" id="4703362">symtabSection</span>&nbsp;<span class="op" id="4703376">==</span>&nbsp;<span class="ident" id="4703379">nil</span>&nbsp;<span class="op" id="4703383">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703387">return</span>&nbsp;<span class="ident" id="4703394">nil</span><span class="op" id="4703397">,</span>&nbsp;<span class="ident" id="4703399">nil</span><span class="op" id="4703402">,</span>&nbsp;<span class="ident" id="4703404">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4703422">data</span><span class="op" id="4703426">,</span>&nbsp;<span class="ident" id="4703428">err</span>&nbsp;<span class="op" id="4703432">:=</span>&nbsp;<span class="ident" id="4703435">symtabSection</span><span class="op" id="4703448">.</span><span class="ident" id="4703449">Data</span><span class="op" id="4703453">(</span><span class="op" id="4703454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703457">if</span>&nbsp;<span class="ident" id="4703460">err</span>&nbsp;<span class="op" id="4703464">!=</span>&nbsp;<span class="ident" id="4703467">nil</span>&nbsp;<span class="op" id="4703471">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703475">return</span>&nbsp;<span class="ident" id="4703482">nil</span><span class="op" id="4703485">,</span>&nbsp;<span class="ident" id="4703487">nil</span><span class="op" id="4703490">,</span>&nbsp;<span class="ident" id="4703492">errors</span><span class="op" id="4703498">.</span><span class="ident" id="4703499">New</span><span class="op" id="4703502">(</span><span class="string" id="4703503">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="4703531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4703537">symtab</span>&nbsp;<span class="op" id="4703544">:=</span>&nbsp;<span class="ident" id="4703547">bytes</span><span class="op" id="4703552">.</span><span class="ident" id="4703553">NewReader</span><span class="op" id="4703562">(</span><span class="ident" id="4703563">data</span><span class="op" id="4703567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703570">if</span>&nbsp;<span class="ident" id="4703573">symtab</span><span class="op" id="4703579">.</span><span class="ident" id="4703580">Len</span><span class="op" id="4703583">(</span><span class="op" id="4703584">)</span><span class="op" id="4703585">%</span><span class="ident" id="4703586">Sym32Size</span>&nbsp;<span class="op" id="4703596">!=</span>&nbsp;<span class="num" id="4703599">0</span>&nbsp;<span class="op" id="4703601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703605">return</span>&nbsp;<span class="ident" id="4703612">nil</span><span class="op" id="4703615">,</span>&nbsp;<span class="ident" id="4703617">nil</span><span class="op" id="4703620">,</span>&nbsp;<span class="ident" id="4703622">errors</span><span class="op" id="4703628">.</span><span class="ident" id="4703629">New</span><span class="op" id="4703632">(</span><span class="string" id="4703633">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="4703688">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4703695">strdata</span><span class="op" id="4703702">,</span>&nbsp;<span class="ident" id="4703704">err</span>&nbsp;<span class="op" id="4703708">:=</span>&nbsp;<span class="ident" id="4703711">f</span><span class="op" id="4703712">.</span><span class="ident" id="4703713">stringTable</span><span class="op" id="4703724">(</span><span class="ident" id="4703725">symtabSection</span><span class="op" id="4703738">.</span><span class="ident" id="4703739">Link</span><span class="op" id="4703743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703746">if</span>&nbsp;<span class="ident" id="4703749">err</span>&nbsp;<span class="op" id="4703753">!=</span>&nbsp;<span class="ident" id="4703756">nil</span>&nbsp;<span class="op" id="4703760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703764">return</span>&nbsp;<span class="ident" id="4703771">nil</span><span class="op" id="4703774">,</span>&nbsp;<span class="ident" id="4703776">nil</span><span class="op" id="4703779">,</span>&nbsp;<span class="ident" id="4703781">errors</span><span class="op" id="4703787">.</span><span class="ident" id="4703788">New</span><span class="op" id="4703791">(</span><span class="string" id="4703792">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="4703826">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4703829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4703833">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703867">var</span>&nbsp;<span class="ident" id="4703871">skip</span>&nbsp;<span class="op" id="4703876">[</span><span class="ident" id="4703877">Sym32Size</span><span class="op" id="4703886">]</span><span class="builtintype" id="4703887">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4703893">symtab</span><span class="op" id="4703899">.</span><span class="ident" id="4703900">Read</span><span class="op" id="4703904">(</span><span class="ident" id="4703905">skip</span><span class="op" id="4703909">[</span><span class="op" id="4703910">:</span><span class="op" id="4703911">]</span><span class="op" id="4703912">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4703916">symbols</span>&nbsp;<span class="op" id="4703924">:=</span>&nbsp;<span class="builtinfunc" id="4703927">make</span><span class="op" id="4703931">(</span><span class="op" id="4703932">[</span><span class="op" id="4703933">]</span><span class="ident" id="4703934">Symbol</span><span class="op" id="4703940">,</span>&nbsp;<span class="ident" id="4703942">symtab</span><span class="op" id="4703948">.</span><span class="ident" id="4703949">Len</span><span class="op" id="4703952">(</span><span class="op" id="4703953">)</span><span class="op" id="4703954">/</span><span class="ident" id="4703955">Sym32Size</span><span class="op" id="4703964">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4703968">i</span>&nbsp;<span class="op" id="4703970">:=</span>&nbsp;<span class="num" id="4703973">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703976">var</span>&nbsp;<span class="ident" id="4703980">sym</span>&nbsp;<span class="ident" id="4703984">Sym32</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4703991">for</span>&nbsp;<span class="ident" id="4703995">symtab</span><span class="op" id="4704001">.</span><span class="ident" id="4704002">Len</span><span class="op" id="4704005">(</span><span class="op" id="4704006">)</span>&nbsp;<span class="op" id="4704008">&gt;</span>&nbsp;<span class="num" id="4704010">0</span>&nbsp;<span class="op" id="4704012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704016">binary</span><span class="op" id="4704022">.</span><span class="ident" id="4704023">Read</span><span class="op" id="4704027">(</span><span class="ident" id="4704028">symtab</span><span class="op" id="4704034">,</span>&nbsp;<span class="ident" id="4704036">f</span><span class="op" id="4704037">.</span><span class="ident" id="4704038">ByteOrder</span><span class="op" id="4704047">,</span>&nbsp;<span class="op" id="4704049">&amp;</span><span class="ident" id="4704050">sym</span><span class="op" id="4704053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704057">str</span><span class="op" id="4704060">,</span>&nbsp;<span class="ident" id="4704062">_</span>&nbsp;<span class="op" id="4704064">:=</span>&nbsp;<span class="ident" id="4704067">getString</span><span class="op" id="4704076">(</span><span class="ident" id="4704077">strdata</span><span class="op" id="4704084">,</span>&nbsp;<span class="builtintype" id="4704086">int</span><span class="op" id="4704089">(</span><span class="ident" id="4704090">sym</span><span class="op" id="4704093">.</span><span class="ident" id="4704094">Name</span><span class="op" id="4704098">)</span><span class="op" id="4704099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704103">symbols</span><span class="op" id="4704110">[</span><span class="ident" id="4704111">i</span><span class="op" id="4704112">]</span><span class="op" id="4704113">.</span><span class="ident" id="4704114">Name</span>&nbsp;<span class="op" id="4704119">=</span>&nbsp;<span class="ident" id="4704121">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704127">symbols</span><span class="op" id="4704134">[</span><span class="ident" id="4704135">i</span><span class="op" id="4704136">]</span><span class="op" id="4704137">.</span><span class="ident" id="4704138">Info</span>&nbsp;<span class="op" id="4704143">=</span>&nbsp;<span class="ident" id="4704145">sym</span><span class="op" id="4704148">.</span><span class="ident" id="4704149">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704156">symbols</span><span class="op" id="4704163">[</span><span class="ident" id="4704164">i</span><span class="op" id="4704165">]</span><span class="op" id="4704166">.</span><span class="ident" id="4704167">Other</span>&nbsp;<span class="op" id="4704173">=</span>&nbsp;<span class="ident" id="4704175">sym</span><span class="op" id="4704178">.</span><span class="ident" id="4704179">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704187">symbols</span><span class="op" id="4704194">[</span><span class="ident" id="4704195">i</span><span class="op" id="4704196">]</span><span class="op" id="4704197">.</span><span class="ident" id="4704198">Section</span>&nbsp;<span class="op" id="4704206">=</span>&nbsp;<span class="ident" id="4704208">SectionIndex</span><span class="op" id="4704220">(</span><span class="ident" id="4704221">sym</span><span class="op" id="4704224">.</span><span class="ident" id="4704225">Shndx</span><span class="op" id="4704230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704234">symbols</span><span class="op" id="4704241">[</span><span class="ident" id="4704242">i</span><span class="op" id="4704243">]</span><span class="op" id="4704244">.</span><span class="ident" id="4704245">Value</span>&nbsp;<span class="op" id="4704251">=</span>&nbsp;<span class="ident" id="4704253">uint64</span><span class="op" id="4704259">(</span><span class="ident" id="4704260">sym</span><span class="op" id="4704263">.</span><span class="ident" id="4704264">Value</span><span class="op" id="4704269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704273">symbols</span><span class="op" id="4704280">[</span><span class="ident" id="4704281">i</span><span class="op" id="4704282">]</span><span class="op" id="4704283">.</span><span class="ident" id="4704284">Size</span>&nbsp;<span class="op" id="4704289">=</span>&nbsp;<span class="ident" id="4704291">uint64</span><span class="op" id="4704297">(</span><span class="ident" id="4704298">sym</span><span class="op" id="4704301">.</span><span class="ident" id="4704302">Size</span><span class="op" id="4704306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704310">i</span><span class="op" id="4704311">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4704315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704319">return</span>&nbsp;<span class="ident" id="4704326">symbols</span><span class="op" id="4704333">,</span>&nbsp;<span class="ident" id="4704335">strdata</span><span class="op" id="4704342">,</span>&nbsp;<span class="ident" id="4704344">nil</span><br>
<span class="lineno"></span><span class="op" id="4704348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="4704351">func</span>&nbsp;<span class="op" id="4704356">(</span><span class="ident" id="4704357">f</span>&nbsp;<span class="op" id="4704359">*</span><span class="ident" id="4704360">File</span><span class="op" id="4704364">)</span>&nbsp;<span class="ident" id="4704366">getSymbols64</span><span class="op" id="4704378">(</span><span class="ident" id="4704379">typ</span>&nbsp;<span class="ident" id="4704383">SectionType</span><span class="op" id="4704394">)</span>&nbsp;<span class="op" id="4704396">(</span><span class="op" id="4704397">[</span><span class="op" id="4704398">]</span><span class="ident" id="4704399">Symbol</span><span class="op" id="4704405">,</span>&nbsp;<span class="op" id="4704407">[</span><span class="op" id="4704408">]</span><span class="builtintype" id="4704409">byte</span><span class="op" id="4704413">,</span>&nbsp;<span class="builtintype" id="4704415">error</span><span class="op" id="4704420">)</span>&nbsp;<span class="op" id="4704422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704425">symtabSection</span>&nbsp;<span class="op" id="4704439">:=</span>&nbsp;<span class="ident" id="4704442">f</span><span class="op" id="4704443">.</span><span class="ident" id="4704444">SectionByType</span><span class="op" id="4704457">(</span><span class="ident" id="4704458">typ</span><span class="op" id="4704461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704464">if</span>&nbsp;<span class="ident" id="4704467">symtabSection</span>&nbsp;<span class="op" id="4704481">==</span>&nbsp;<span class="ident" id="4704484">nil</span>&nbsp;<span class="op" id="4704488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704492">return</span>&nbsp;<span class="ident" id="4704499">nil</span><span class="op" id="4704502">,</span>&nbsp;<span class="ident" id="4704504">nil</span><span class="op" id="4704507">,</span>&nbsp;<span class="ident" id="4704509">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4704523">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704527">data</span><span class="op" id="4704531">,</span>&nbsp;<span class="ident" id="4704533">err</span>&nbsp;<span class="op" id="4704537">:=</span>&nbsp;<span class="ident" id="4704540">symtabSection</span><span class="op" id="4704553">.</span><span class="ident" id="4704554">Data</span><span class="op" id="4704558">(</span><span class="op" id="4704559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704562">if</span>&nbsp;<span class="ident" id="4704565">err</span>&nbsp;<span class="op" id="4704569">!=</span>&nbsp;<span class="ident" id="4704572">nil</span>&nbsp;<span class="op" id="4704576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704580">return</span>&nbsp;<span class="ident" id="4704587">nil</span><span class="op" id="4704590">,</span>&nbsp;<span class="ident" id="4704592">nil</span><span class="op" id="4704595">,</span>&nbsp;<span class="ident" id="4704597">errors</span><span class="op" id="4704603">.</span><span class="ident" id="4704604">New</span><span class="op" id="4704607">(</span><span class="string" id="4704608">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="4704636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4704639">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704642">symtab</span>&nbsp;<span class="op" id="4704649">:=</span>&nbsp;<span class="ident" id="4704652">bytes</span><span class="op" id="4704657">.</span><span class="ident" id="4704658">NewReader</span><span class="op" id="4704667">(</span><span class="ident" id="4704668">data</span><span class="op" id="4704672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704675">if</span>&nbsp;<span class="ident" id="4704678">symtab</span><span class="op" id="4704684">.</span><span class="ident" id="4704685">Len</span><span class="op" id="4704688">(</span><span class="op" id="4704689">)</span><span class="op" id="4704690">%</span><span class="ident" id="4704691">Sym64Size</span>&nbsp;<span class="op" id="4704701">!=</span>&nbsp;<span class="num" id="4704704">0</span>&nbsp;<span class="op" id="4704706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704710">return</span>&nbsp;<span class="ident" id="4704717">nil</span><span class="op" id="4704720">,</span>&nbsp;<span class="ident" id="4704722">nil</span><span class="op" id="4704725">,</span>&nbsp;<span class="ident" id="4704727">errors</span><span class="op" id="4704733">.</span><span class="ident" id="4704734">New</span><span class="op" id="4704737">(</span><span class="string" id="4704738">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="4704795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4704798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4704802">strdata</span><span class="op" id="4704809">,</span>&nbsp;<span class="ident" id="4704811">err</span>&nbsp;<span class="op" id="4704815">:=</span>&nbsp;<span class="ident" id="4704818">f</span><span class="op" id="4704819">.</span><span class="ident" id="4704820">stringTable</span><span class="op" id="4704831">(</span><span class="ident" id="4704832">symtabSection</span><span class="op" id="4704845">.</span><span class="ident" id="4704846">Link</span><span class="op" id="4704850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704853">if</span>&nbsp;<span class="ident" id="4704856">err</span>&nbsp;<span class="op" id="4704860">!=</span>&nbsp;<span class="ident" id="4704863">nil</span>&nbsp;<span class="op" id="4704867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704871">return</span>&nbsp;<span class="ident" id="4704878">nil</span><span class="op" id="4704881">,</span>&nbsp;<span class="ident" id="4704883">nil</span><span class="op" id="4704886">,</span>&nbsp;<span class="ident" id="4704888">errors</span><span class="op" id="4704894">.</span><span class="ident" id="4704895">New</span><span class="op" id="4704898">(</span><span class="string" id="4704899">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="4704933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4704936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4704940">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4704974">var</span>&nbsp;<span class="ident" id="4704978">skip</span>&nbsp;<span class="op" id="4704983">[</span><span class="ident" id="4704984">Sym64Size</span><span class="op" id="4704993">]</span><span class="builtintype" id="4704994">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705000">symtab</span><span class="op" id="4705006">.</span><span class="ident" id="4705007">Read</span><span class="op" id="4705011">(</span><span class="ident" id="4705012">skip</span><span class="op" id="4705016">[</span><span class="op" id="4705017">:</span><span class="op" id="4705018">]</span><span class="op" id="4705019">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705023">symbols</span>&nbsp;<span class="op" id="4705031">:=</span>&nbsp;<span class="builtinfunc" id="4705034">make</span><span class="op" id="4705038">(</span><span class="op" id="4705039">[</span><span class="op" id="4705040">]</span><span class="ident" id="4705041">Symbol</span><span class="op" id="4705047">,</span>&nbsp;<span class="ident" id="4705049">symtab</span><span class="op" id="4705055">.</span><span class="ident" id="4705056">Len</span><span class="op" id="4705059">(</span><span class="op" id="4705060">)</span><span class="op" id="4705061">/</span><span class="ident" id="4705062">Sym64Size</span><span class="op" id="4705071">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705075">i</span>&nbsp;<span class="op" id="4705077">:=</span>&nbsp;<span class="num" id="4705080">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705083">var</span>&nbsp;<span class="ident" id="4705087">sym</span>&nbsp;<span class="ident" id="4705091">Sym64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705098">for</span>&nbsp;<span class="ident" id="4705102">symtab</span><span class="op" id="4705108">.</span><span class="ident" id="4705109">Len</span><span class="op" id="4705112">(</span><span class="op" id="4705113">)</span>&nbsp;<span class="op" id="4705115">&gt;</span>&nbsp;<span class="num" id="4705117">0</span>&nbsp;<span class="op" id="4705119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705123">binary</span><span class="op" id="4705129">.</span><span class="ident" id="4705130">Read</span><span class="op" id="4705134">(</span><span class="ident" id="4705135">symtab</span><span class="op" id="4705141">,</span>&nbsp;<span class="ident" id="4705143">f</span><span class="op" id="4705144">.</span><span class="ident" id="4705145">ByteOrder</span><span class="op" id="4705154">,</span>&nbsp;<span class="op" id="4705156">&amp;</span><span class="ident" id="4705157">sym</span><span class="op" id="4705160">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705164">str</span><span class="op" id="4705167">,</span>&nbsp;<span class="ident" id="4705169">_</span>&nbsp;<span class="op" id="4705171">:=</span>&nbsp;<span class="ident" id="4705174">getString</span><span class="op" id="4705183">(</span><span class="ident" id="4705184">strdata</span><span class="op" id="4705191">,</span>&nbsp;<span class="builtintype" id="4705193">int</span><span class="op" id="4705196">(</span><span class="ident" id="4705197">sym</span><span class="op" id="4705200">.</span><span class="ident" id="4705201">Name</span><span class="op" id="4705205">)</span><span class="op" id="4705206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705210">symbols</span><span class="op" id="4705217">[</span><span class="ident" id="4705218">i</span><span class="op" id="4705219">]</span><span class="op" id="4705220">.</span><span class="ident" id="4705221">Name</span>&nbsp;<span class="op" id="4705226">=</span>&nbsp;<span class="ident" id="4705228">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705234">symbols</span><span class="op" id="4705241">[</span><span class="ident" id="4705242">i</span><span class="op" id="4705243">]</span><span class="op" id="4705244">.</span><span class="ident" id="4705245">Info</span>&nbsp;<span class="op" id="4705250">=</span>&nbsp;<span class="ident" id="4705252">sym</span><span class="op" id="4705255">.</span><span class="ident" id="4705256">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705263">symbols</span><span class="op" id="4705270">[</span><span class="ident" id="4705271">i</span><span class="op" id="4705272">]</span><span class="op" id="4705273">.</span><span class="ident" id="4705274">Other</span>&nbsp;<span class="op" id="4705280">=</span>&nbsp;<span class="ident" id="4705282">sym</span><span class="op" id="4705285">.</span><span class="ident" id="4705286">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705294">symbols</span><span class="op" id="4705301">[</span><span class="ident" id="4705302">i</span><span class="op" id="4705303">]</span><span class="op" id="4705304">.</span><span class="ident" id="4705305">Section</span>&nbsp;<span class="op" id="4705313">=</span>&nbsp;<span class="ident" id="4705315">SectionIndex</span><span class="op" id="4705327">(</span><span class="ident" id="4705328">sym</span><span class="op" id="4705331">.</span><span class="ident" id="4705332">Shndx</span><span class="op" id="4705337">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705341">symbols</span><span class="op" id="4705348">[</span><span class="ident" id="4705349">i</span><span class="op" id="4705350">]</span><span class="op" id="4705351">.</span><span class="ident" id="4705352">Value</span>&nbsp;<span class="op" id="4705358">=</span>&nbsp;<span class="ident" id="4705360">sym</span><span class="op" id="4705363">.</span><span class="ident" id="4705364">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705372">symbols</span><span class="op" id="4705379">[</span><span class="ident" id="4705380">i</span><span class="op" id="4705381">]</span><span class="op" id="4705382">.</span><span class="ident" id="4705383">Size</span>&nbsp;<span class="op" id="4705388">=</span>&nbsp;<span class="ident" id="4705390">sym</span><span class="op" id="4705393">.</span><span class="ident" id="4705394">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4705401">i</span><span class="op" id="4705402">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4705406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705410">return</span>&nbsp;<span class="ident" id="4705417">symbols</span><span class="op" id="4705424">,</span>&nbsp;<span class="ident" id="4705426">strdata</span><span class="op" id="4705433">,</span>&nbsp;<span class="ident" id="4705435">nil</span><br>
<span class="lineno"></span><span class="op" id="4705439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4705442">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="4705499">func</span>&nbsp;<span class="ident" id="4705504">getString</span><span class="op" id="4705513">(</span><span class="ident" id="4705514">section</span>&nbsp;<span class="op" id="4705522">[</span><span class="op" id="4705523">]</span><span class="builtintype" id="4705524">byte</span><span class="op" id="4705528">,</span>&nbsp;<span class="ident" id="4705530">start</span>&nbsp;<span class="builtintype" id="4705536">int</span><span class="op" id="4705539">)</span>&nbsp;<span class="op" id="4705541">(</span><span class="builtintype" id="4705542">string</span><span class="op" id="4705548">,</span>&nbsp;<span class="builtintype" id="4705550">bool</span><span class="op" id="4705554">)</span>&nbsp;<span class="op" id="4705556">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705559">if</span>&nbsp;<span class="ident" id="4705562">start</span>&nbsp;<span class="op" id="4705568">&lt;</span>&nbsp;<span class="num" id="4705570">0</span>&nbsp;<span class="op" id="4705572">||</span>&nbsp;<span class="ident" id="4705575">start</span>&nbsp;<span class="op" id="4705581">&gt;=</span>&nbsp;<span class="builtinfunc" id="4705584">len</span><span class="op" id="4705587">(</span><span class="ident" id="4705588">section</span><span class="op" id="4705595">)</span>&nbsp;<span class="op" id="4705597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705601">return</span>&nbsp;<span class="string" id="4705608">&#34;&#34;</span><span class="op" id="4705610">,</span>&nbsp;<span class="builtintype" id="4705612">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4705619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705623">for</span>&nbsp;<span class="ident" id="4705627">end</span>&nbsp;<span class="op" id="4705631">:=</span>&nbsp;<span class="ident" id="4705634">start</span><span class="op" id="4705639">;</span>&nbsp;<span class="ident" id="4705641">end</span>&nbsp;<span class="op" id="4705645">&lt;</span>&nbsp;<span class="builtinfunc" id="4705647">len</span><span class="op" id="4705650">(</span><span class="ident" id="4705651">section</span><span class="op" id="4705658">)</span><span class="op" id="4705659">;</span>&nbsp;<span class="ident" id="4705661">end</span><span class="op" id="4705664">++</span>&nbsp;<span class="op" id="4705667">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705671">if</span>&nbsp;<span class="ident" id="4705674">section</span><span class="op" id="4705681">[</span><span class="ident" id="4705682">end</span><span class="op" id="4705685">]</span>&nbsp;<span class="op" id="4705687">==</span>&nbsp;<span class="num" id="4705690">0</span>&nbsp;<span class="op" id="4705692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705697">return</span>&nbsp;<span class="builtintype" id="4705704">string</span><span class="op" id="4705710">(</span><span class="ident" id="4705711">section</span><span class="op" id="4705718">[</span><span class="ident" id="4705719">start</span><span class="op" id="4705724">:</span><span class="ident" id="4705725">end</span><span class="op" id="4705728">]</span><span class="op" id="4705729">)</span><span class="op" id="4705730">,</span>&nbsp;<span class="builtintype" id="4705732">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4705739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4705742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705745">return</span>&nbsp;<span class="string" id="4705752">&#34;&#34;</span><span class="op" id="4705754">,</span>&nbsp;<span class="builtintype" id="4705756">false</span><br>
<span class="lineno">510</span><span class="op" id="4705762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4705765">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="4705833">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="4705852">func</span>&nbsp;<span class="op" id="4705857">(</span><span class="ident" id="4705858">f</span>&nbsp;<span class="op" id="4705860">*</span><span class="ident" id="4705861">File</span><span class="op" id="4705865">)</span>&nbsp;<span class="ident" id="4705867">Section</span><span class="op" id="4705874">(</span><span class="ident" id="4705875">name</span>&nbsp;<span class="builtintype" id="4705880">string</span><span class="op" id="4705886">)</span>&nbsp;<span class="op" id="4705888">*</span><span class="ident" id="4705889">Section</span>&nbsp;<span class="op" id="4705897">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705900">for</span>&nbsp;<span class="ident" id="4705904">_</span><span class="op" id="4705905">,</span>&nbsp;<span class="ident" id="4705907">s</span>&nbsp;<span class="op" id="4705909">:=</span>&nbsp;<span class="keyword" id="4705912">range</span>&nbsp;<span class="ident" id="4705918">f</span><span class="op" id="4705919">.</span><span class="ident" id="4705920">Sections</span>&nbsp;<span class="op" id="4705929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705933">if</span>&nbsp;<span class="ident" id="4705936">s</span><span class="op" id="4705937">.</span><span class="ident" id="4705938">Name</span>&nbsp;<span class="op" id="4705943">==</span>&nbsp;<span class="ident" id="4705946">name</span>&nbsp;<span class="op" id="4705951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705956">return</span>&nbsp;<span class="ident" id="4705963">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4705967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4705970">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4705973">return</span>&nbsp;<span class="ident" id="4705980">nil</span><br>
<span class="lineno"></span><span class="op" id="4705984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4705987">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="4706065">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="4706084">func</span>&nbsp;<span class="op" id="4706089">(</span><span class="ident" id="4706090">f</span>&nbsp;<span class="op" id="4706092">*</span><span class="ident" id="4706093">File</span><span class="op" id="4706097">)</span>&nbsp;<span class="ident" id="4706099">applyRelocations</span><span class="op" id="4706115">(</span><span class="ident" id="4706116">dst</span>&nbsp;<span class="op" id="4706120">[</span><span class="op" id="4706121">]</span><span class="builtintype" id="4706122">byte</span><span class="op" id="4706126">,</span>&nbsp;<span class="ident" id="4706128">rels</span>&nbsp;<span class="op" id="4706133">[</span><span class="op" id="4706134">]</span><span class="builtintype" id="4706135">byte</span><span class="op" id="4706139">)</span>&nbsp;<span class="builtintype" id="4706141">error</span>&nbsp;<span class="op" id="4706147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706150">if</span>&nbsp;<span class="ident" id="4706153">f</span><span class="op" id="4706154">.</span><span class="ident" id="4706155">Class</span>&nbsp;<span class="op" id="4706161">==</span>&nbsp;<span class="ident" id="4706164">ELFCLASS64</span>&nbsp;<span class="op" id="4706175">&amp;&amp;</span>&nbsp;<span class="ident" id="4706178">f</span><span class="op" id="4706179">.</span><span class="ident" id="4706180">Machine</span>&nbsp;<span class="op" id="4706188">==</span>&nbsp;<span class="ident" id="4706191">EM_X86_64</span>&nbsp;<span class="op" id="4706201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706205">return</span>&nbsp;<span class="ident" id="4706212">f</span><span class="op" id="4706213">.</span><span class="ident" id="4706214">applyRelocationsAMD64</span><span class="op" id="4706235">(</span><span class="ident" id="4706236">dst</span><span class="op" id="4706239">,</span>&nbsp;<span class="ident" id="4706241">rels</span><span class="op" id="4706245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4706248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706251">if</span>&nbsp;<span class="ident" id="4706254">f</span><span class="op" id="4706255">.</span><span class="ident" id="4706256">Class</span>&nbsp;<span class="op" id="4706262">==</span>&nbsp;<span class="ident" id="4706265">ELFCLASS32</span>&nbsp;<span class="op" id="4706276">&amp;&amp;</span>&nbsp;<span class="ident" id="4706279">f</span><span class="op" id="4706280">.</span><span class="ident" id="4706281">Machine</span>&nbsp;<span class="op" id="4706289">==</span>&nbsp;<span class="ident" id="4706292">EM_386</span>&nbsp;<span class="op" id="4706299">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706303">return</span>&nbsp;<span class="ident" id="4706310">f</span><span class="op" id="4706311">.</span><span class="ident" id="4706312">applyRelocations386</span><span class="op" id="4706331">(</span><span class="ident" id="4706332">dst</span><span class="op" id="4706335">,</span>&nbsp;<span class="ident" id="4706337">rels</span><span class="op" id="4706341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4706344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706347">if</span>&nbsp;<span class="ident" id="4706350">f</span><span class="op" id="4706351">.</span><span class="ident" id="4706352">Class</span>&nbsp;<span class="op" id="4706358">==</span>&nbsp;<span class="ident" id="4706361">ELFCLASS64</span>&nbsp;<span class="op" id="4706372">&amp;&amp;</span>&nbsp;<span class="ident" id="4706375">f</span><span class="op" id="4706376">.</span><span class="ident" id="4706377">Machine</span>&nbsp;<span class="op" id="4706385">==</span>&nbsp;<span class="ident" id="4706388">EM_AARCH64</span>&nbsp;<span class="op" id="4706399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706403">return</span>&nbsp;<span class="ident" id="4706410">f</span><span class="op" id="4706411">.</span><span class="ident" id="4706412">applyRelocationsARM64</span><span class="op" id="4706433">(</span><span class="ident" id="4706434">dst</span><span class="op" id="4706437">,</span>&nbsp;<span class="ident" id="4706439">rels</span><span class="op" id="4706443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4706446">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706450">return</span>&nbsp;<span class="ident" id="4706457">errors</span><span class="op" id="4706463">.</span><span class="ident" id="4706464">New</span><span class="op" id="4706467">(</span><span class="string" id="4706468">&#34;not&nbsp;implemented&#34;</span><span class="op" id="4706485">)</span><br>
<span class="lineno"></span><span class="op" id="4706487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4706490">func</span>&nbsp;<span class="op" id="4706495">(</span><span class="ident" id="4706496">f</span>&nbsp;<span class="op" id="4706498">*</span><span class="ident" id="4706499">File</span><span class="op" id="4706503">)</span>&nbsp;<span class="ident" id="4706505">applyRelocationsAMD64</span><span class="op" id="4706526">(</span><span class="ident" id="4706527">dst</span>&nbsp;<span class="op" id="4706531">[</span><span class="op" id="4706532">]</span><span class="builtintype" id="4706533">byte</span><span class="op" id="4706537">,</span>&nbsp;<span class="ident" id="4706539">rels</span>&nbsp;<span class="op" id="4706544">[</span><span class="op" id="4706545">]</span><span class="builtintype" id="4706546">byte</span><span class="op" id="4706550">)</span>&nbsp;<span class="builtintype" id="4706552">error</span>&nbsp;<span class="op" id="4706558">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4706561">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706591">if</span>&nbsp;<span class="builtinfunc" id="4706594">len</span><span class="op" id="4706597">(</span><span class="ident" id="4706598">rels</span><span class="op" id="4706602">)</span><span class="op" id="4706603">%</span><span class="num" id="4706604">24</span>&nbsp;<span class="op" id="4706607">!=</span>&nbsp;<span class="num" id="4706610">0</span>&nbsp;<span class="op" id="4706612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706616">return</span>&nbsp;<span class="ident" id="4706623">errors</span><span class="op" id="4706629">.</span><span class="ident" id="4706630">New</span><span class="op" id="4706633">(</span><span class="string" id="4706634">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="4706688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4706691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706695">symbols</span><span class="op" id="4706702">,</span>&nbsp;<span class="ident" id="4706704">_</span><span class="op" id="4706705">,</span>&nbsp;<span class="ident" id="4706707">err</span>&nbsp;<span class="op" id="4706711">:=</span>&nbsp;<span class="ident" id="4706714">f</span><span class="op" id="4706715">.</span><span class="ident" id="4706716">getSymbols</span><span class="op" id="4706726">(</span><span class="ident" id="4706727">SHT_SYMTAB</span><span class="op" id="4706737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706740">if</span>&nbsp;<span class="ident" id="4706743">err</span>&nbsp;<span class="op" id="4706747">!=</span>&nbsp;<span class="ident" id="4706750">nil</span>&nbsp;<span class="op" id="4706754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706758">return</span>&nbsp;<span class="ident" id="4706765">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4706770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706774">b</span>&nbsp;<span class="op" id="4706776">:=</span>&nbsp;<span class="ident" id="4706779">bytes</span><span class="op" id="4706784">.</span><span class="ident" id="4706785">NewReader</span><span class="op" id="4706794">(</span><span class="ident" id="4706795">rels</span><span class="op" id="4706799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706802">var</span>&nbsp;<span class="ident" id="4706806">rela</span>&nbsp;<span class="ident" id="4706811">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706820">for</span>&nbsp;<span class="ident" id="4706824">b</span><span class="op" id="4706825">.</span><span class="ident" id="4706826">Len</span><span class="op" id="4706829">(</span><span class="op" id="4706830">)</span>&nbsp;<span class="op" id="4706832">&gt;</span>&nbsp;<span class="num" id="4706834">0</span>&nbsp;<span class="op" id="4706836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706840">binary</span><span class="op" id="4706846">.</span><span class="ident" id="4706847">Read</span><span class="op" id="4706851">(</span><span class="ident" id="4706852">b</span><span class="op" id="4706853">,</span>&nbsp;<span class="ident" id="4706855">f</span><span class="op" id="4706856">.</span><span class="ident" id="4706857">ByteOrder</span><span class="op" id="4706866">,</span>&nbsp;<span class="op" id="4706868">&amp;</span><span class="ident" id="4706869">rela</span><span class="op" id="4706873">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706877">symNo</span>&nbsp;<span class="op" id="4706883">:=</span>&nbsp;<span class="ident" id="4706886">rela</span><span class="op" id="4706890">.</span><span class="ident" id="4706891">Info</span>&nbsp;<span class="op" id="4706896">&gt;&gt;</span>&nbsp;<span class="num" id="4706899">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4706904">t</span>&nbsp;<span class="op" id="4706906">:=</span>&nbsp;<span class="ident" id="4706909">R_X86_64</span><span class="op" id="4706917">(</span><span class="ident" id="4706918">rela</span><span class="op" id="4706922">.</span><span class="ident" id="4706923">Info</span>&nbsp;<span class="op" id="4706928">&amp;</span>&nbsp;<span class="num" id="4706930">0xffff</span><span class="op" id="4706936">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706941">if</span>&nbsp;<span class="ident" id="4706944">symNo</span>&nbsp;<span class="op" id="4706950">==</span>&nbsp;<span class="num" id="4706953">0</span>&nbsp;<span class="op" id="4706955">||</span>&nbsp;<span class="ident" id="4706958">symNo</span>&nbsp;<span class="op" id="4706964">&gt;</span>&nbsp;<span class="ident" id="4706966">uint64</span><span class="op" id="4706972">(</span><span class="builtinfunc" id="4706973">len</span><span class="op" id="4706976">(</span><span class="ident" id="4706977">symbols</span><span class="op" id="4706984">)</span><span class="op" id="4706985">)</span>&nbsp;<span class="op" id="4706987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4706992">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4707003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4707007">sym</span>&nbsp;<span class="op" id="4707011">:=</span>&nbsp;<span class="op" id="4707014">&amp;</span><span class="ident" id="4707015">symbols</span><span class="op" id="4707022">[</span><span class="ident" id="4707023">symNo</span><span class="op" id="4707028">-</span><span class="num" id="4707029">1</span><span class="op" id="4707030">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707034">if</span>&nbsp;<span class="ident" id="4707037">SymType</span><span class="op" id="4707044">(</span><span class="ident" id="4707045">sym</span><span class="op" id="4707048">.</span><span class="ident" id="4707049">Info</span><span class="op" id="4707053">&amp;</span><span class="num" id="4707054">0xf</span><span class="op" id="4707057">)</span>&nbsp;<span class="op" id="4707059">!=</span>&nbsp;<span class="ident" id="4707062">STT_SECTION</span>&nbsp;<span class="op" id="4707074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707079">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707134">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4707145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707150">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707203">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707258">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707305">switch</span>&nbsp;<span class="ident" id="4707312">t</span>&nbsp;<span class="op" id="4707314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707318">case</span>&nbsp;<span class="ident" id="4707323">R_X86_64_64</span><span class="op" id="4707334">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707339">if</span>&nbsp;<span class="ident" id="4707342">rela</span><span class="op" id="4707346">.</span><span class="ident" id="4707347">Off</span><span class="op" id="4707350">+</span><span class="num" id="4707351">8</span>&nbsp;<span class="op" id="4707353">&gt;=</span>&nbsp;<span class="ident" id="4707356">uint64</span><span class="op" id="4707362">(</span><span class="builtinfunc" id="4707363">len</span><span class="op" id="4707366">(</span><span class="ident" id="4707367">dst</span><span class="op" id="4707370">)</span><span class="op" id="4707371">)</span>&nbsp;<span class="op" id="4707373">||</span>&nbsp;<span class="ident" id="4707376">rela</span><span class="op" id="4707380">.</span><span class="ident" id="4707381">Addend</span>&nbsp;<span class="op" id="4707388">&lt;</span>&nbsp;<span class="num" id="4707390">0</span>&nbsp;<span class="op" id="4707392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707398">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4707410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4707415">f</span><span class="op" id="4707416">.</span><span class="ident" id="4707417">ByteOrder</span><span class="op" id="4707426">.</span><span class="ident" id="4707427">PutUint64</span><span class="op" id="4707436">(</span><span class="ident" id="4707437">dst</span><span class="op" id="4707440">[</span><span class="ident" id="4707441">rela</span><span class="op" id="4707445">.</span><span class="ident" id="4707446">Off</span><span class="op" id="4707449">:</span><span class="ident" id="4707450">rela</span><span class="op" id="4707454">.</span><span class="ident" id="4707455">Off</span><span class="op" id="4707458">+</span><span class="num" id="4707459">8</span><span class="op" id="4707460">]</span><span class="op" id="4707461">,</span>&nbsp;<span class="ident" id="4707463">uint64</span><span class="op" id="4707469">(</span><span class="ident" id="4707470">rela</span><span class="op" id="4707474">.</span><span class="ident" id="4707475">Addend</span><span class="op" id="4707481">)</span><span class="op" id="4707482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707486">case</span>&nbsp;<span class="ident" id="4707491">R_X86_64_32</span><span class="op" id="4707502">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707507">if</span>&nbsp;<span class="ident" id="4707510">rela</span><span class="op" id="4707514">.</span><span class="ident" id="4707515">Off</span><span class="op" id="4707518">+</span><span class="num" id="4707519">4</span>&nbsp;<span class="op" id="4707521">&gt;=</span>&nbsp;<span class="ident" id="4707524">uint64</span><span class="op" id="4707530">(</span><span class="builtinfunc" id="4707531">len</span><span class="op" id="4707534">(</span><span class="ident" id="4707535">dst</span><span class="op" id="4707538">)</span><span class="op" id="4707539">)</span>&nbsp;<span class="op" id="4707541">||</span>&nbsp;<span class="ident" id="4707544">rela</span><span class="op" id="4707548">.</span><span class="ident" id="4707549">Addend</span>&nbsp;<span class="op" id="4707556">&lt;</span>&nbsp;<span class="num" id="4707558">0</span>&nbsp;<span class="op" id="4707560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707566">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4707578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4707583">f</span><span class="op" id="4707584">.</span><span class="ident" id="4707585">ByteOrder</span><span class="op" id="4707594">.</span><span class="ident" id="4707595">PutUint32</span><span class="op" id="4707604">(</span><span class="ident" id="4707605">dst</span><span class="op" id="4707608">[</span><span class="ident" id="4707609">rela</span><span class="op" id="4707613">.</span><span class="ident" id="4707614">Off</span><span class="op" id="4707617">:</span><span class="ident" id="4707618">rela</span><span class="op" id="4707622">.</span><span class="ident" id="4707623">Off</span><span class="op" id="4707626">+</span><span class="num" id="4707627">4</span><span class="op" id="4707628">]</span><span class="op" id="4707629">,</span>&nbsp;<span class="builtintype" id="4707631">uint32</span><span class="op" id="4707637">(</span><span class="ident" id="4707638">rela</span><span class="op" id="4707642">.</span><span class="ident" id="4707643">Addend</span><span class="op" id="4707649">)</span><span class="op" id="4707650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4707654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4707657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707661">return</span>&nbsp;<span class="ident" id="4707668">nil</span><br>
<span class="lineno"></span><span class="op" id="4707672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4707675">func</span>&nbsp;<span class="op" id="4707680">(</span><span class="ident" id="4707681">f</span>&nbsp;<span class="op" id="4707683">*</span><span class="ident" id="4707684">File</span><span class="op" id="4707688">)</span>&nbsp;<span class="ident" id="4707690">applyRelocations386</span><span class="op" id="4707709">(</span><span class="ident" id="4707710">dst</span>&nbsp;<span class="op" id="4707714">[</span><span class="op" id="4707715">]</span><span class="builtintype" id="4707716">byte</span><span class="op" id="4707720">,</span>&nbsp;<span class="ident" id="4707722">rels</span>&nbsp;<span class="op" id="4707727">[</span><span class="op" id="4707728">]</span><span class="builtintype" id="4707729">byte</span><span class="op" id="4707733">)</span>&nbsp;<span class="builtintype" id="4707735">error</span>&nbsp;<span class="op" id="4707741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4707744">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707772">if</span>&nbsp;<span class="builtinfunc" id="4707775">len</span><span class="op" id="4707778">(</span><span class="ident" id="4707779">rels</span><span class="op" id="4707783">)</span><span class="op" id="4707784">%</span><span class="num" id="4707785">8</span>&nbsp;<span class="op" id="4707787">!=</span>&nbsp;<span class="num" id="4707790">0</span>&nbsp;<span class="op" id="4707792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707796">return</span>&nbsp;<span class="ident" id="4707803">errors</span><span class="op" id="4707809">.</span><span class="ident" id="4707810">New</span><span class="op" id="4707813">(</span><span class="string" id="4707814">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="4707867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4707870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4707874">symbols</span><span class="op" id="4707881">,</span>&nbsp;<span class="ident" id="4707883">_</span><span class="op" id="4707884">,</span>&nbsp;<span class="ident" id="4707886">err</span>&nbsp;<span class="op" id="4707890">:=</span>&nbsp;<span class="ident" id="4707893">f</span><span class="op" id="4707894">.</span><span class="ident" id="4707895">getSymbols</span><span class="op" id="4707905">(</span><span class="ident" id="4707906">SHT_SYMTAB</span><span class="op" id="4707916">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707919">if</span>&nbsp;<span class="ident" id="4707922">err</span>&nbsp;<span class="op" id="4707926">!=</span>&nbsp;<span class="ident" id="4707929">nil</span>&nbsp;<span class="op" id="4707933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707937">return</span>&nbsp;<span class="ident" id="4707944">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4707949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4707953">b</span>&nbsp;<span class="op" id="4707955">:=</span>&nbsp;<span class="ident" id="4707958">bytes</span><span class="op" id="4707963">.</span><span class="ident" id="4707964">NewReader</span><span class="op" id="4707973">(</span><span class="ident" id="4707974">rels</span><span class="op" id="4707978">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707981">var</span>&nbsp;<span class="ident" id="4707985">rel</span>&nbsp;<span class="ident" id="4707989">Rel32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4707997">for</span>&nbsp;<span class="ident" id="4708001">b</span><span class="op" id="4708002">.</span><span class="ident" id="4708003">Len</span><span class="op" id="4708006">(</span><span class="op" id="4708007">)</span>&nbsp;<span class="op" id="4708009">&gt;</span>&nbsp;<span class="num" id="4708011">0</span>&nbsp;<span class="op" id="4708013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708017">binary</span><span class="op" id="4708023">.</span><span class="ident" id="4708024">Read</span><span class="op" id="4708028">(</span><span class="ident" id="4708029">b</span><span class="op" id="4708030">,</span>&nbsp;<span class="ident" id="4708032">f</span><span class="op" id="4708033">.</span><span class="ident" id="4708034">ByteOrder</span><span class="op" id="4708043">,</span>&nbsp;<span class="op" id="4708045">&amp;</span><span class="ident" id="4708046">rel</span><span class="op" id="4708049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708053">symNo</span>&nbsp;<span class="op" id="4708059">:=</span>&nbsp;<span class="ident" id="4708062">rel</span><span class="op" id="4708065">.</span><span class="ident" id="4708066">Info</span>&nbsp;<span class="op" id="4708071">&gt;&gt;</span>&nbsp;<span class="num" id="4708074">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708078">t</span>&nbsp;<span class="op" id="4708080">:=</span>&nbsp;<span class="ident" id="4708083">R_386</span><span class="op" id="4708088">(</span><span class="ident" id="4708089">rel</span><span class="op" id="4708092">.</span><span class="ident" id="4708093">Info</span>&nbsp;<span class="op" id="4708098">&amp;</span>&nbsp;<span class="num" id="4708100">0xff</span><span class="op" id="4708104">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708109">if</span>&nbsp;<span class="ident" id="4708112">symNo</span>&nbsp;<span class="op" id="4708118">==</span>&nbsp;<span class="num" id="4708121">0</span>&nbsp;<span class="op" id="4708123">||</span>&nbsp;<span class="ident" id="4708126">symNo</span>&nbsp;<span class="op" id="4708132">&gt;</span>&nbsp;<span class="builtintype" id="4708134">uint32</span><span class="op" id="4708140">(</span><span class="builtinfunc" id="4708141">len</span><span class="op" id="4708144">(</span><span class="ident" id="4708145">symbols</span><span class="op" id="4708152">)</span><span class="op" id="4708153">)</span>&nbsp;<span class="op" id="4708155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708160">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708171">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708175">sym</span>&nbsp;<span class="op" id="4708179">:=</span>&nbsp;<span class="op" id="4708182">&amp;</span><span class="ident" id="4708183">symbols</span><span class="op" id="4708190">[</span><span class="ident" id="4708191">symNo</span><span class="op" id="4708196">-</span><span class="num" id="4708197">1</span><span class="op" id="4708198">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708203">if</span>&nbsp;<span class="ident" id="4708206">t</span>&nbsp;<span class="op" id="4708208">==</span>&nbsp;<span class="ident" id="4708211">R_386_32</span>&nbsp;<span class="op" id="4708220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708225">if</span>&nbsp;<span class="ident" id="4708228">rel</span><span class="op" id="4708231">.</span><span class="ident" id="4708232">Off</span><span class="op" id="4708235">+</span><span class="num" id="4708236">4</span>&nbsp;<span class="op" id="4708238">&gt;=</span>&nbsp;<span class="builtintype" id="4708241">uint32</span><span class="op" id="4708247">(</span><span class="builtinfunc" id="4708248">len</span><span class="op" id="4708251">(</span><span class="ident" id="4708252">dst</span><span class="op" id="4708255">)</span><span class="op" id="4708256">)</span>&nbsp;<span class="op" id="4708258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708264">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708281">val</span>&nbsp;<span class="op" id="4708285">:=</span>&nbsp;<span class="ident" id="4708288">f</span><span class="op" id="4708289">.</span><span class="ident" id="4708290">ByteOrder</span><span class="op" id="4708299">.</span><span class="ident" id="4708300">Uint32</span><span class="op" id="4708306">(</span><span class="ident" id="4708307">dst</span><span class="op" id="4708310">[</span><span class="ident" id="4708311">rel</span><span class="op" id="4708314">.</span><span class="ident" id="4708315">Off</span>&nbsp;<span class="op" id="4708319">:</span>&nbsp;<span class="ident" id="4708321">rel</span><span class="op" id="4708324">.</span><span class="ident" id="4708325">Off</span><span class="op" id="4708328">+</span><span class="num" id="4708329">4</span><span class="op" id="4708330">]</span><span class="op" id="4708331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708336">val</span>&nbsp;<span class="op" id="4708340">+=</span>&nbsp;<span class="builtintype" id="4708343">uint32</span><span class="op" id="4708349">(</span><span class="ident" id="4708350">sym</span><span class="op" id="4708353">.</span><span class="ident" id="4708354">Value</span><span class="op" id="4708359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708364">f</span><span class="op" id="4708365">.</span><span class="ident" id="4708366">ByteOrder</span><span class="op" id="4708375">.</span><span class="ident" id="4708376">PutUint32</span><span class="op" id="4708385">(</span><span class="ident" id="4708386">dst</span><span class="op" id="4708389">[</span><span class="ident" id="4708390">rel</span><span class="op" id="4708393">.</span><span class="ident" id="4708394">Off</span><span class="op" id="4708397">:</span><span class="ident" id="4708398">rel</span><span class="op" id="4708401">.</span><span class="ident" id="4708402">Off</span><span class="op" id="4708405">+</span><span class="num" id="4708406">4</span><span class="op" id="4708407">]</span><span class="op" id="4708408">,</span>&nbsp;<span class="ident" id="4708410">val</span><span class="op" id="4708413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708417">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708424">return</span>&nbsp;<span class="ident" id="4708431">nil</span><br>
<span class="lineno"></span><span class="op" id="4708435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="4708438">func</span>&nbsp;<span class="op" id="4708443">(</span><span class="ident" id="4708444">f</span>&nbsp;<span class="op" id="4708446">*</span><span class="ident" id="4708447">File</span><span class="op" id="4708451">)</span>&nbsp;<span class="ident" id="4708453">applyRelocationsARM64</span><span class="op" id="4708474">(</span><span class="ident" id="4708475">dst</span>&nbsp;<span class="op" id="4708479">[</span><span class="op" id="4708480">]</span><span class="builtintype" id="4708481">byte</span><span class="op" id="4708485">,</span>&nbsp;<span class="ident" id="4708487">rels</span>&nbsp;<span class="op" id="4708492">[</span><span class="op" id="4708493">]</span><span class="builtintype" id="4708494">byte</span><span class="op" id="4708498">)</span>&nbsp;<span class="builtintype" id="4708500">error</span>&nbsp;<span class="op" id="4708506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4708509">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708539">if</span>&nbsp;<span class="builtinfunc" id="4708542">len</span><span class="op" id="4708545">(</span><span class="ident" id="4708546">rels</span><span class="op" id="4708550">)</span><span class="op" id="4708551">%</span><span class="num" id="4708552">24</span>&nbsp;<span class="op" id="4708555">!=</span>&nbsp;<span class="num" id="4708558">0</span>&nbsp;<span class="op" id="4708560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708564">return</span>&nbsp;<span class="ident" id="4708571">errors</span><span class="op" id="4708577">.</span><span class="ident" id="4708578">New</span><span class="op" id="4708581">(</span><span class="string" id="4708582">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="4708636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708639">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708643">symbols</span><span class="op" id="4708650">,</span>&nbsp;<span class="ident" id="4708652">_</span><span class="op" id="4708653">,</span>&nbsp;<span class="ident" id="4708655">err</span>&nbsp;<span class="op" id="4708659">:=</span>&nbsp;<span class="ident" id="4708662">f</span><span class="op" id="4708663">.</span><span class="ident" id="4708664">getSymbols</span><span class="op" id="4708674">(</span><span class="ident" id="4708675">SHT_SYMTAB</span><span class="op" id="4708685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708688">if</span>&nbsp;<span class="ident" id="4708691">err</span>&nbsp;<span class="op" id="4708695">!=</span>&nbsp;<span class="ident" id="4708698">nil</span>&nbsp;<span class="op" id="4708702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708706">return</span>&nbsp;<span class="ident" id="4708713">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708718">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708722">b</span>&nbsp;<span class="op" id="4708724">:=</span>&nbsp;<span class="ident" id="4708727">bytes</span><span class="op" id="4708732">.</span><span class="ident" id="4708733">NewReader</span><span class="op" id="4708742">(</span><span class="ident" id="4708743">rels</span><span class="op" id="4708747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708750">var</span>&nbsp;<span class="ident" id="4708754">rela</span>&nbsp;<span class="ident" id="4708759">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708768">for</span>&nbsp;<span class="ident" id="4708772">b</span><span class="op" id="4708773">.</span><span class="ident" id="4708774">Len</span><span class="op" id="4708777">(</span><span class="op" id="4708778">)</span>&nbsp;<span class="op" id="4708780">&gt;</span>&nbsp;<span class="num" id="4708782">0</span>&nbsp;<span class="op" id="4708784">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708788">binary</span><span class="op" id="4708794">.</span><span class="ident" id="4708795">Read</span><span class="op" id="4708799">(</span><span class="ident" id="4708800">b</span><span class="op" id="4708801">,</span>&nbsp;<span class="ident" id="4708803">f</span><span class="op" id="4708804">.</span><span class="ident" id="4708805">ByteOrder</span><span class="op" id="4708814">,</span>&nbsp;<span class="op" id="4708816">&amp;</span><span class="ident" id="4708817">rela</span><span class="op" id="4708821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708825">symNo</span>&nbsp;<span class="op" id="4708831">:=</span>&nbsp;<span class="ident" id="4708834">rela</span><span class="op" id="4708838">.</span><span class="ident" id="4708839">Info</span>&nbsp;<span class="op" id="4708844">&gt;&gt;</span>&nbsp;<span class="num" id="4708847">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708852">t</span>&nbsp;<span class="op" id="4708854">:=</span>&nbsp;<span class="ident" id="4708857">R_AARCH64</span><span class="op" id="4708866">(</span><span class="ident" id="4708867">rela</span><span class="op" id="4708871">.</span><span class="ident" id="4708872">Info</span>&nbsp;<span class="op" id="4708877">&amp;</span>&nbsp;<span class="num" id="4708879">0xffff</span><span class="op" id="4708885">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708890">if</span>&nbsp;<span class="ident" id="4708893">symNo</span>&nbsp;<span class="op" id="4708899">==</span>&nbsp;<span class="num" id="4708902">0</span>&nbsp;<span class="op" id="4708904">||</span>&nbsp;<span class="ident" id="4708907">symNo</span>&nbsp;<span class="op" id="4708913">&gt;</span>&nbsp;<span class="ident" id="4708915">uint64</span><span class="op" id="4708921">(</span><span class="builtinfunc" id="4708922">len</span><span class="op" id="4708925">(</span><span class="ident" id="4708926">symbols</span><span class="op" id="4708933">)</span><span class="op" id="4708934">)</span>&nbsp;<span class="op" id="4708936">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708941">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4708952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4708956">sym</span>&nbsp;<span class="op" id="4708960">:=</span>&nbsp;<span class="op" id="4708963">&amp;</span><span class="ident" id="4708964">symbols</span><span class="op" id="4708971">[</span><span class="ident" id="4708972">symNo</span><span class="op" id="4708977">-</span><span class="num" id="4708978">1</span><span class="op" id="4708979">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4708983">if</span>&nbsp;<span class="ident" id="4708986">SymType</span><span class="op" id="4708993">(</span><span class="ident" id="4708994">sym</span><span class="op" id="4708997">.</span><span class="ident" id="4708998">Info</span><span class="op" id="4709002">&amp;</span><span class="num" id="4709003">0xf</span><span class="op" id="4709006">)</span>&nbsp;<span class="op" id="4709008">!=</span>&nbsp;<span class="ident" id="4709011">STT_SECTION</span>&nbsp;<span class="op" id="4709023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4709028">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709083">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4709099">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4709152">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4709207">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709254">switch</span>&nbsp;<span class="ident" id="4709261">t</span>&nbsp;<span class="op" id="4709263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709267">case</span>&nbsp;<span class="ident" id="4709272">R_AARCH64_ABS64</span><span class="op" id="4709287">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709292">if</span>&nbsp;<span class="ident" id="4709295">rela</span><span class="op" id="4709299">.</span><span class="ident" id="4709300">Off</span><span class="op" id="4709303">+</span><span class="num" id="4709304">8</span>&nbsp;<span class="op" id="4709306">&gt;=</span>&nbsp;<span class="ident" id="4709309">uint64</span><span class="op" id="4709315">(</span><span class="builtinfunc" id="4709316">len</span><span class="op" id="4709319">(</span><span class="ident" id="4709320">dst</span><span class="op" id="4709323">)</span><span class="op" id="4709324">)</span>&nbsp;<span class="op" id="4709326">||</span>&nbsp;<span class="ident" id="4709329">rela</span><span class="op" id="4709333">.</span><span class="ident" id="4709334">Addend</span>&nbsp;<span class="op" id="4709341">&lt;</span>&nbsp;<span class="num" id="4709343">0</span>&nbsp;<span class="op" id="4709345">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709351">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4709368">f</span><span class="op" id="4709369">.</span><span class="ident" id="4709370">ByteOrder</span><span class="op" id="4709379">.</span><span class="ident" id="4709380">PutUint64</span><span class="op" id="4709389">(</span><span class="ident" id="4709390">dst</span><span class="op" id="4709393">[</span><span class="ident" id="4709394">rela</span><span class="op" id="4709398">.</span><span class="ident" id="4709399">Off</span><span class="op" id="4709402">:</span><span class="ident" id="4709403">rela</span><span class="op" id="4709407">.</span><span class="ident" id="4709408">Off</span><span class="op" id="4709411">+</span><span class="num" id="4709412">8</span><span class="op" id="4709413">]</span><span class="op" id="4709414">,</span>&nbsp;<span class="ident" id="4709416">uint64</span><span class="op" id="4709422">(</span><span class="ident" id="4709423">rela</span><span class="op" id="4709427">.</span><span class="ident" id="4709428">Addend</span><span class="op" id="4709434">)</span><span class="op" id="4709435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709439">case</span>&nbsp;<span class="ident" id="4709444">R_AARCH64_ABS32</span><span class="op" id="4709459">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709464">if</span>&nbsp;<span class="ident" id="4709467">rela</span><span class="op" id="4709471">.</span><span class="ident" id="4709472">Off</span><span class="op" id="4709475">+</span><span class="num" id="4709476">4</span>&nbsp;<span class="op" id="4709478">&gt;=</span>&nbsp;<span class="ident" id="4709481">uint64</span><span class="op" id="4709487">(</span><span class="builtinfunc" id="4709488">len</span><span class="op" id="4709491">(</span><span class="ident" id="4709492">dst</span><span class="op" id="4709495">)</span><span class="op" id="4709496">)</span>&nbsp;<span class="op" id="4709498">||</span>&nbsp;<span class="ident" id="4709501">rela</span><span class="op" id="4709505">.</span><span class="ident" id="4709506">Addend</span>&nbsp;<span class="op" id="4709513">&lt;</span>&nbsp;<span class="num" id="4709515">0</span>&nbsp;<span class="op" id="4709517">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709523">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4709540">f</span><span class="op" id="4709541">.</span><span class="ident" id="4709542">ByteOrder</span><span class="op" id="4709551">.</span><span class="ident" id="4709552">PutUint32</span><span class="op" id="4709561">(</span><span class="ident" id="4709562">dst</span><span class="op" id="4709565">[</span><span class="ident" id="4709566">rela</span><span class="op" id="4709570">.</span><span class="ident" id="4709571">Off</span><span class="op" id="4709574">:</span><span class="ident" id="4709575">rela</span><span class="op" id="4709579">.</span><span class="ident" id="4709580">Off</span><span class="op" id="4709583">+</span><span class="num" id="4709584">4</span><span class="op" id="4709585">]</span><span class="op" id="4709586">,</span>&nbsp;<span class="builtintype" id="4709588">uint32</span><span class="op" id="4709594">(</span><span class="ident" id="4709595">rela</span><span class="op" id="4709599">.</span><span class="ident" id="4709600">Addend</span><span class="op" id="4709606">)</span><span class="op" id="4709607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4709614">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709618">return</span>&nbsp;<span class="ident" id="4709625">nil</span><br>
<span class="lineno"></span><span class="op" id="4709629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4709632">func</span>&nbsp;<span class="op" id="4709637">(</span><span class="ident" id="4709638">f</span>&nbsp;<span class="op" id="4709640">*</span><span class="ident" id="4709641">File</span><span class="op" id="4709645">)</span>&nbsp;<span class="ident" id="4709647">DWARF</span><span class="op" id="4709652">(</span><span class="op" id="4709653">)</span>&nbsp;<span class="op" id="4709655">(</span><span class="op" id="4709656">*</span><span class="ident" id="4709657">dwarf</span><span class="op" id="4709662">.</span><span class="ident" id="4709663">Data</span><span class="op" id="4709667">,</span>&nbsp;<span class="builtintype" id="4709669">error</span><span class="op" id="4709674">)</span>&nbsp;<span class="op" id="4709676">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4709679">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4709730">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4709785">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709844">var</span>&nbsp;<span class="ident" id="4709848">names</span>&nbsp;<span class="op" id="4709854">=</span>&nbsp;<span class="op" id="4709856">[</span><span class="op" id="4709857">...</span><span class="op" id="4709860">]</span><span class="builtintype" id="4709861">string</span><span class="op" id="4709867">{</span><span class="string" id="4709868">&#34;abbrev&#34;</span><span class="op" id="4709876">,</span>&nbsp;<span class="string" id="4709878">&#34;info&#34;</span><span class="op" id="4709884">,</span>&nbsp;<span class="string" id="4709886">&#34;str&#34;</span><span class="op" id="4709891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709894">var</span>&nbsp;<span class="ident" id="4709898">dat</span>&nbsp;<span class="op" id="4709902">[</span><span class="builtinfunc" id="4709903">len</span><span class="op" id="4709906">(</span><span class="ident" id="4709907">names</span><span class="op" id="4709912">)</span><span class="op" id="4709913">]</span><span class="op" id="4709914">[</span><span class="op" id="4709915">]</span><span class="builtintype" id="4709916">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4709922">for</span>&nbsp;<span class="ident" id="4709926">i</span><span class="op" id="4709927">,</span>&nbsp;<span class="ident" id="4709929">name</span>&nbsp;<span class="op" id="4709934">:=</span>&nbsp;<span class="keyword" id="4709937">range</span>&nbsp;<span class="ident" id="4709943">names</span>&nbsp;<span class="op" id="4709949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4709953">name</span>&nbsp;<span class="op" id="4709958">=</span>&nbsp;<span class="string" id="4709960">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="4709970">+</span>&nbsp;<span class="ident" id="4709972">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4709979">s</span>&nbsp;<span class="op" id="4709981">:=</span>&nbsp;<span class="ident" id="4709984">f</span><span class="op" id="4709985">.</span><span class="ident" id="4709986">Section</span><span class="op" id="4709993">(</span><span class="ident" id="4709994">name</span><span class="op" id="4709998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710002">if</span>&nbsp;<span class="ident" id="4710005">s</span>&nbsp;<span class="op" id="4710007">==</span>&nbsp;<span class="ident" id="4710010">nil</span>&nbsp;<span class="op" id="4710014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710019">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4710030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4710034">b</span><span class="op" id="4710035">,</span>&nbsp;<span class="ident" id="4710037">err</span>&nbsp;<span class="op" id="4710041">:=</span>&nbsp;<span class="ident" id="4710044">s</span><span class="op" id="4710045">.</span><span class="ident" id="4710046">Data</span><span class="op" id="4710050">(</span><span class="op" id="4710051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710055">if</span>&nbsp;<span class="ident" id="4710058">err</span>&nbsp;<span class="op" id="4710062">!=</span>&nbsp;<span class="ident" id="4710065">nil</span>&nbsp;<span class="op" id="4710069">&amp;&amp;</span>&nbsp;<span class="ident" id="4710072">uint64</span><span class="op" id="4710078">(</span><span class="builtinfunc" id="4710079">len</span><span class="op" id="4710082">(</span><span class="ident" id="4710083">b</span><span class="op" id="4710084">)</span><span class="op" id="4710085">)</span>&nbsp;<span class="op" id="4710087">&lt;</span>&nbsp;<span class="ident" id="4710089">s</span><span class="op" id="4710090">.</span><span class="ident" id="4710091">Size</span>&nbsp;<span class="op" id="4710096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710101">return</span>&nbsp;<span class="ident" id="4710108">nil</span><span class="op" id="4710111">,</span>&nbsp;<span class="ident" id="4710113">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4710119">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4710123">dat</span><span class="op" id="4710126">[</span><span class="ident" id="4710127">i</span><span class="op" id="4710128">]</span>&nbsp;<span class="op" id="4710130">=</span>&nbsp;<span class="ident" id="4710132">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4710135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4710139">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4710212">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4710285">rela</span>&nbsp;<span class="op" id="4710290">:=</span>&nbsp;<span class="ident" id="4710293">f</span><span class="op" id="4710294">.</span><span class="ident" id="4710295">Section</span><span class="op" id="4710302">(</span><span class="string" id="4710303">&#34;.rela.debug_info&#34;</span><span class="op" id="4710321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710324">if</span>&nbsp;<span class="ident" id="4710327">rela</span>&nbsp;<span class="op" id="4710332">!=</span>&nbsp;<span class="ident" id="4710335">nil</span>&nbsp;<span class="op" id="4710339">&amp;&amp;</span>&nbsp;<span class="ident" id="4710342">rela</span><span class="op" id="4710346">.</span><span class="ident" id="4710347">Type</span>&nbsp;<span class="op" id="4710352">==</span>&nbsp;<span class="ident" id="4710355">SHT_RELA</span>&nbsp;<span class="op" id="4710364">&amp;&amp;</span>&nbsp;<span class="op" id="4710367">(</span><span class="ident" id="4710368">f</span><span class="op" id="4710369">.</span><span class="ident" id="4710370">Machine</span>&nbsp;<span class="op" id="4710378">==</span>&nbsp;<span class="ident" id="4710381">EM_X86_64</span>&nbsp;<span class="op" id="4710391">||</span>&nbsp;<span class="ident" id="4710394">f</span><span class="op" id="4710395">.</span><span class="ident" id="4710396">Machine</span>&nbsp;<span class="op" id="4710404">==</span>&nbsp;<span class="ident" id="4710407">EM_AARCH64</span><span class="op" id="4710417">)</span>&nbsp;<span class="op" id="4710419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4710423">data</span><span class="op" id="4710427">,</span>&nbsp;<span class="ident" id="4710429">err</span>&nbsp;<span class="op" id="4710433">:=</span>&nbsp;<span class="ident" id="4710436">rela</span><span class="op" id="4710440">.</span><span class="ident" id="4710441">Data</span><span class="op" id="4710445">(</span><span class="op" id="4710446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710450">if</span>&nbsp;<span class="ident" id="4710453">err</span>&nbsp;<span class="op" id="4710457">!=</span>&nbsp;<span class="ident" id="4710460">nil</span>&nbsp;<span class="op" id="4710464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710469">return</span>&nbsp;<span class="ident" id="4710476">nil</span><span class="op" id="4710479">,</span>&nbsp;<span class="ident" id="4710481">err</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4710487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4710491">err</span>&nbsp;<span class="op" id="4710495">=</span>&nbsp;<span class="ident" id="4710497">f</span><span class="op" id="4710498">.</span><span class="ident" id="4710499">applyRelocations</span><span class="op" id="4710515">(</span><span class="ident" id="4710516">dat</span><span class="op" id="4710519">[</span><span class="num" id="4710520">1</span><span class="op" id="4710521">]</span><span class="op" id="4710522">,</span>&nbsp;<span class="ident" id="4710524">data</span><span class="op" id="4710528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710532">if</span>&nbsp;<span class="ident" id="4710535">err</span>&nbsp;<span class="op" id="4710539">!=</span>&nbsp;<span class="ident" id="4710542">nil</span>&nbsp;<span class="op" id="4710546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710551">return</span>&nbsp;<span class="ident" id="4710558">nil</span><span class="op" id="4710561">,</span>&nbsp;<span class="ident" id="4710563">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4710569">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4710572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4710576">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4710642">rel</span>&nbsp;<span class="op" id="4710646">:=</span>&nbsp;<span class="ident" id="4710649">f</span><span class="op" id="4710650">.</span><span class="ident" id="4710651">Section</span><span class="op" id="4710658">(</span><span class="string" id="4710659">&#34;.rel.debug_info&#34;</span><span class="op" id="4710676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710679">if</span>&nbsp;<span class="ident" id="4710682">rel</span>&nbsp;<span class="op" id="4710686">!=</span>&nbsp;<span class="ident" id="4710689">nil</span>&nbsp;<span class="op" id="4710693">&amp;&amp;</span>&nbsp;<span class="ident" id="4710696">rel</span><span class="op" id="4710699">.</span><span class="ident" id="4710700">Type</span>&nbsp;<span class="op" id="4710705">==</span>&nbsp;<span class="ident" id="4710708">SHT_REL</span>&nbsp;<span class="op" id="4710716">&amp;&amp;</span>&nbsp;<span class="ident" id="4710719">f</span><span class="op" id="4710720">.</span><span class="ident" id="4710721">Machine</span>&nbsp;<span class="op" id="4710729">==</span>&nbsp;<span class="ident" id="4710732">EM_386</span>&nbsp;<span class="op" id="4710739">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4710743">data</span><span class="op" id="4710747">,</span>&nbsp;<span class="ident" id="4710749">err</span>&nbsp;<span class="op" id="4710753">:=</span>&nbsp;<span class="ident" id="4710756">rel</span><span class="op" id="4710759">.</span><span class="ident" id="4710760">Data</span><span class="op" id="4710764">(</span><span class="op" id="4710765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710769">if</span>&nbsp;<span class="ident" id="4710772">err</span>&nbsp;<span class="op" id="4710776">!=</span>&nbsp;<span class="ident" id="4710779">nil</span>&nbsp;<span class="op" id="4710783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710788">return</span>&nbsp;<span class="ident" id="4710795">nil</span><span class="op" id="4710798">,</span>&nbsp;<span class="ident" id="4710800">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4710806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4710810">err</span>&nbsp;<span class="op" id="4710814">=</span>&nbsp;<span class="ident" id="4710816">f</span><span class="op" id="4710817">.</span><span class="ident" id="4710818">applyRelocations</span><span class="op" id="4710834">(</span><span class="ident" id="4710835">dat</span><span class="op" id="4710838">[</span><span class="num" id="4710839">1</span><span class="op" id="4710840">]</span><span class="op" id="4710841">,</span>&nbsp;<span class="ident" id="4710843">data</span><span class="op" id="4710847">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710851">if</span>&nbsp;<span class="ident" id="4710854">err</span>&nbsp;<span class="op" id="4710858">!=</span>&nbsp;<span class="ident" id="4710861">nil</span>&nbsp;<span class="op" id="4710865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4710870">return</span>&nbsp;<span class="ident" id="4710877">nil</span><span class="op" id="4710880">,</span>&nbsp;<span class="ident" id="4710882">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4710888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4710891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4710895">abbrev</span><span class="op" id="4710901">,</span>&nbsp;<span class="ident" id="4710903">info</span><span class="op" id="4710907">,</span>&nbsp;<span class="ident" id="4710909">str</span>&nbsp;<span class="op" id="4710913">:=</span>&nbsp;<span class="ident" id="4710916">dat</span><span class="op" id="4710919">[</span><span class="num" id="4710920">0</span><span class="op" id="4710921">]</span><span class="op" id="4710922">,</span>&nbsp;<span class="ident" id="4710924">dat</span><span class="op" id="4710927">[</span><span class="num" id="4710928">1</span><span class="op" id="4710929">]</span><span class="op" id="4710930">,</span>&nbsp;<span class="ident" id="4710932">dat</span><span class="op" id="4710935">[</span><span class="num" id="4710936">2</span><span class="op" id="4710937">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4710940">d</span><span class="op" id="4710941">,</span>&nbsp;<span class="ident" id="4710943">err</span>&nbsp;<span class="op" id="4710947">:=</span>&nbsp;<span class="ident" id="4710950">dwarf</span><span class="op" id="4710955">.</span><span class="ident" id="4710956">New</span><span class="op" id="4710959">(</span><span class="ident" id="4710960">abbrev</span><span class="op" id="4710966">,</span>&nbsp;<span class="ident" id="4710968">nil</span><span class="op" id="4710971">,</span>&nbsp;<span class="ident" id="4710973">nil</span><span class="op" id="4710976">,</span>&nbsp;<span class="ident" id="4710978">info</span><span class="op" id="4710982">,</span>&nbsp;<span class="ident" id="4710984">nil</span><span class="op" id="4710987">,</span>&nbsp;<span class="ident" id="4710989">nil</span><span class="op" id="4710992">,</span>&nbsp;<span class="ident" id="4710994">nil</span><span class="op" id="4710997">,</span>&nbsp;<span class="ident" id="4710999">str</span><span class="op" id="4711002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711005">if</span>&nbsp;<span class="ident" id="4711008">err</span>&nbsp;<span class="op" id="4711012">!=</span>&nbsp;<span class="ident" id="4711015">nil</span>&nbsp;<span class="op" id="4711019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711023">return</span>&nbsp;<span class="ident" id="4711030">nil</span><span class="op" id="4711033">,</span>&nbsp;<span class="ident" id="4711035">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4711040">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4711044">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711087">for</span>&nbsp;<span class="ident" id="4711091">i</span><span class="op" id="4711092">,</span>&nbsp;<span class="ident" id="4711094">s</span>&nbsp;<span class="op" id="4711096">:=</span>&nbsp;<span class="keyword" id="4711099">range</span>&nbsp;<span class="ident" id="4711105">f</span><span class="op" id="4711106">.</span><span class="ident" id="4711107">Sections</span>&nbsp;<span class="op" id="4711116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711120">if</span>&nbsp;<span class="ident" id="4711123">s</span><span class="op" id="4711124">.</span><span class="ident" id="4711125">Name</span>&nbsp;<span class="op" id="4711130">==</span>&nbsp;<span class="string" id="4711133">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="4711148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4711153">b</span><span class="op" id="4711154">,</span>&nbsp;<span class="ident" id="4711156">err</span>&nbsp;<span class="op" id="4711160">:=</span>&nbsp;<span class="ident" id="4711163">s</span><span class="op" id="4711164">.</span><span class="ident" id="4711165">Data</span><span class="op" id="4711169">(</span><span class="op" id="4711170">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711175">if</span>&nbsp;<span class="ident" id="4711178">err</span>&nbsp;<span class="op" id="4711182">!=</span>&nbsp;<span class="ident" id="4711185">nil</span>&nbsp;<span class="op" id="4711189">&amp;&amp;</span>&nbsp;<span class="ident" id="4711192">uint64</span><span class="op" id="4711198">(</span><span class="builtinfunc" id="4711199">len</span><span class="op" id="4711202">(</span><span class="ident" id="4711203">b</span><span class="op" id="4711204">)</span><span class="op" id="4711205">)</span>&nbsp;<span class="op" id="4711207">&lt;</span>&nbsp;<span class="ident" id="4711209">s</span><span class="op" id="4711210">.</span><span class="ident" id="4711211">Size</span>&nbsp;<span class="op" id="4711216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711222">return</span>&nbsp;<span class="ident" id="4711229">nil</span><span class="op" id="4711232">,</span>&nbsp;<span class="ident" id="4711234">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4711241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711247">for</span>&nbsp;<span class="ident" id="4711251">_</span><span class="op" id="4711252">,</span>&nbsp;<span class="ident" id="4711254">r</span>&nbsp;<span class="op" id="4711256">:=</span>&nbsp;<span class="keyword" id="4711259">range</span>&nbsp;<span class="ident" id="4711265">f</span><span class="op" id="4711266">.</span><span class="ident" id="4711267">Sections</span>&nbsp;<span class="op" id="4711276">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711282">if</span>&nbsp;<span class="ident" id="4711285">r</span><span class="op" id="4711286">.</span><span class="ident" id="4711287">Type</span>&nbsp;<span class="op" id="4711292">!=</span>&nbsp;<span class="ident" id="4711295">SHT_RELA</span>&nbsp;<span class="op" id="4711304">&amp;&amp;</span>&nbsp;<span class="ident" id="4711307">r</span><span class="op" id="4711308">.</span><span class="ident" id="4711309">Type</span>&nbsp;<span class="op" id="4711314">!=</span>&nbsp;<span class="ident" id="4711317">SHT_REL</span>&nbsp;<span class="op" id="4711325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711332">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4711345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711351">if</span>&nbsp;<span class="builtintype" id="4711354">int</span><span class="op" id="4711357">(</span><span class="ident" id="4711358">r</span><span class="op" id="4711359">.</span><span class="ident" id="4711360">Info</span><span class="op" id="4711364">)</span>&nbsp;<span class="op" id="4711366">!=</span>&nbsp;<span class="ident" id="4711369">i</span>&nbsp;<span class="op" id="4711371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711378">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4711391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4711397">rd</span><span class="op" id="4711399">,</span>&nbsp;<span class="ident" id="4711401">err</span>&nbsp;<span class="op" id="4711405">:=</span>&nbsp;<span class="ident" id="4711408">r</span><span class="op" id="4711409">.</span><span class="ident" id="4711410">Data</span><span class="op" id="4711414">(</span><span class="op" id="4711415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711421">if</span>&nbsp;<span class="ident" id="4711424">err</span>&nbsp;<span class="op" id="4711428">!=</span>&nbsp;<span class="ident" id="4711431">nil</span>&nbsp;<span class="op" id="4711435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711442">return</span>&nbsp;<span class="ident" id="4711449">nil</span><span class="op" id="4711452">,</span>&nbsp;<span class="ident" id="4711454">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4711462">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4711468">err</span>&nbsp;<span class="op" id="4711472">=</span>&nbsp;<span class="ident" id="4711474">f</span><span class="op" id="4711475">.</span><span class="ident" id="4711476">applyRelocations</span><span class="op" id="4711492">(</span><span class="ident" id="4711493">b</span><span class="op" id="4711494">,</span>&nbsp;<span class="ident" id="4711496">rd</span><span class="op" id="4711498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711504">if</span>&nbsp;<span class="ident" id="4711507">err</span>&nbsp;<span class="op" id="4711511">!=</span>&nbsp;<span class="ident" id="4711514">nil</span>&nbsp;<span class="op" id="4711518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711525">return</span>&nbsp;<span class="ident" id="4711532">nil</span><span class="op" id="4711535">,</span>&nbsp;<span class="ident" id="4711537">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4711545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4711550">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4711556">err</span>&nbsp;<span class="op" id="4711560">=</span>&nbsp;<span class="ident" id="4711562">d</span><span class="op" id="4711563">.</span><span class="ident" id="4711564">AddTypes</span><span class="op" id="4711572">(</span><span class="ident" id="4711573">fmt</span><span class="op" id="4711576">.</span><span class="ident" id="4711577">Sprintf</span><span class="op" id="4711584">(</span><span class="string" id="4711585">&#34;types-%d&#34;</span><span class="op" id="4711595">,</span>&nbsp;<span class="ident" id="4711597">i</span><span class="op" id="4711598">)</span><span class="op" id="4711599">,</span>&nbsp;<span class="ident" id="4711601">b</span><span class="op" id="4711602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711607">if</span>&nbsp;<span class="ident" id="4711610">err</span>&nbsp;<span class="op" id="4711614">!=</span>&nbsp;<span class="ident" id="4711617">nil</span>&nbsp;<span class="op" id="4711621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711627">return</span>&nbsp;<span class="ident" id="4711634">nil</span><span class="op" id="4711637">,</span>&nbsp;<span class="ident" id="4711639">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4711646">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4711650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4711653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4711657">return</span>&nbsp;<span class="ident" id="4711664">d</span><span class="op" id="4711665">,</span>&nbsp;<span class="ident" id="4711667">nil</span><br>
<span class="lineno"></span><span class="op" id="4711671">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="4711674">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="4711757">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="4711778">//</span><br>
<span class="lineno"></span><span class="comment" id="4711781">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="4711857">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="4711931">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="4711977">func</span>&nbsp;<span class="op" id="4711982">(</span><span class="ident" id="4711983">f</span>&nbsp;<span class="op" id="4711985">*</span><span class="ident" id="4711986">File</span><span class="op" id="4711990">)</span>&nbsp;<span class="ident" id="4711992">Symbols</span><span class="op" id="4711999">(</span><span class="op" id="4712000">)</span>&nbsp;<span class="op" id="4712002">(</span><span class="op" id="4712003">[</span><span class="op" id="4712004">]</span><span class="ident" id="4712005">Symbol</span><span class="op" id="4712011">,</span>&nbsp;<span class="builtintype" id="4712013">error</span><span class="op" id="4712018">)</span>&nbsp;<span class="op" id="4712020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4712023">sym</span><span class="op" id="4712026">,</span>&nbsp;<span class="ident" id="4712028">_</span><span class="op" id="4712029">,</span>&nbsp;<span class="ident" id="4712031">err</span>&nbsp;<span class="op" id="4712035">:=</span>&nbsp;<span class="ident" id="4712038">f</span><span class="op" id="4712039">.</span><span class="ident" id="4712040">getSymbols</span><span class="op" id="4712050">(</span><span class="ident" id="4712051">SHT_SYMTAB</span><span class="op" id="4712061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4712064">return</span>&nbsp;<span class="ident" id="4712071">sym</span><span class="op" id="4712074">,</span>&nbsp;<span class="ident" id="4712076">err</span><br>
<span class="lineno">770</span><span class="op" id="4712080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4712083">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="4712153">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="4712202">//</span><br>
<span class="lineno">775</span><span class="comment" id="4712205">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="4712289">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="4712363">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="4712409">func</span>&nbsp;<span class="op" id="4712414">(</span><span class="ident" id="4712415">f</span>&nbsp;<span class="op" id="4712417">*</span><span class="ident" id="4712418">File</span><span class="op" id="4712422">)</span>&nbsp;<span class="ident" id="4712424">DynamicSymbols</span><span class="op" id="4712438">(</span><span class="op" id="4712439">)</span>&nbsp;<span class="op" id="4712441">(</span><span class="op" id="4712442">[</span><span class="op" id="4712443">]</span><span class="ident" id="4712444">Symbol</span><span class="op" id="4712450">,</span>&nbsp;<span class="builtintype" id="4712452">error</span><span class="op" id="4712457">)</span>&nbsp;<span class="op" id="4712459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4712462">sym</span><span class="op" id="4712465">,</span>&nbsp;<span class="ident" id="4712467">_</span><span class="op" id="4712468">,</span>&nbsp;<span class="ident" id="4712470">err</span>&nbsp;<span class="op" id="4712474">:=</span>&nbsp;<span class="ident" id="4712477">f</span><span class="op" id="4712478">.</span><span class="ident" id="4712479">getSymbols</span><span class="op" id="4712489">(</span><span class="ident" id="4712490">SHT_DYNSYM</span><span class="op" id="4712500">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4712503">return</span>&nbsp;<span class="ident" id="4712510">sym</span><span class="op" id="4712513">,</span>&nbsp;<span class="ident" id="4712515">err</span><br>
<span class="lineno"></span><span class="op" id="4712519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4712522">type</span>&nbsp;<span class="ident" id="4712527">ImportedSymbol</span>&nbsp;<span class="keyword" id="4712542">struct</span>&nbsp;<span class="op" id="4712549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4712552">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4712560">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4712568">Version</span>&nbsp;<span class="builtintype" id="4712576">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4712584">Library</span>&nbsp;<span class="builtintype" id="4712592">string</span><br>
<span class="lineno"></span><span class="op" id="4712599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4712602">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="4712654">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4712709">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="4712763">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="4712799">func</span>&nbsp;<span class="op" id="4712804">(</span><span class="ident" id="4712805">f</span>&nbsp;<span class="op" id="4712807">*</span><span class="ident" id="4712808">File</span><span class="op" id="4712812">)</span>&nbsp;<span class="ident" id="4712814">ImportedSymbols</span><span class="op" id="4712829">(</span><span class="op" id="4712830">)</span>&nbsp;<span class="op" id="4712832">(</span><span class="op" id="4712833">[</span><span class="op" id="4712834">]</span><span class="ident" id="4712835">ImportedSymbol</span><span class="op" id="4712849">,</span>&nbsp;<span class="builtintype" id="4712851">error</span><span class="op" id="4712856">)</span>&nbsp;<span class="op" id="4712858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4712861">sym</span><span class="op" id="4712864">,</span>&nbsp;<span class="ident" id="4712866">str</span><span class="op" id="4712869">,</span>&nbsp;<span class="ident" id="4712871">err</span>&nbsp;<span class="op" id="4712875">:=</span>&nbsp;<span class="ident" id="4712878">f</span><span class="op" id="4712879">.</span><span class="ident" id="4712880">getSymbols</span><span class="op" id="4712890">(</span><span class="ident" id="4712891">SHT_DYNSYM</span><span class="op" id="4712901">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4712904">if</span>&nbsp;<span class="ident" id="4712907">err</span>&nbsp;<span class="op" id="4712911">!=</span>&nbsp;<span class="ident" id="4712914">nil</span>&nbsp;<span class="op" id="4712918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4712922">return</span>&nbsp;<span class="ident" id="4712929">nil</span><span class="op" id="4712932">,</span>&nbsp;<span class="ident" id="4712934">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4712939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4712942">f</span><span class="op" id="4712943">.</span><span class="ident" id="4712944">gnuVersionInit</span><span class="op" id="4712958">(</span><span class="ident" id="4712959">str</span><span class="op" id="4712962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4712965">var</span>&nbsp;<span class="ident" id="4712969">all</span>&nbsp;<span class="op" id="4712973">[</span><span class="op" id="4712974">]</span><span class="ident" id="4712975">ImportedSymbol</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4712991">for</span>&nbsp;<span class="ident" id="4712995">i</span><span class="op" id="4712996">,</span>&nbsp;<span class="ident" id="4712998">s</span>&nbsp;<span class="op" id="4713000">:=</span>&nbsp;<span class="keyword" id="4713003">range</span>&nbsp;<span class="ident" id="4713009">sym</span>&nbsp;<span class="op" id="4713013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713017">if</span>&nbsp;<span class="ident" id="4713020">ST_BIND</span><span class="op" id="4713027">(</span><span class="ident" id="4713028">s</span><span class="op" id="4713029">.</span><span class="ident" id="4713030">Info</span><span class="op" id="4713034">)</span>&nbsp;<span class="op" id="4713036">==</span>&nbsp;<span class="ident" id="4713039">STB_GLOBAL</span>&nbsp;<span class="op" id="4713050">&amp;&amp;</span>&nbsp;<span class="ident" id="4713053">s</span><span class="op" id="4713054">.</span><span class="ident" id="4713055">Section</span>&nbsp;<span class="op" id="4713063">==</span>&nbsp;<span class="ident" id="4713066">SHN_UNDEF</span>&nbsp;<span class="op" id="4713076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713081">all</span>&nbsp;<span class="op" id="4713085">=</span>&nbsp;<span class="builtinfunc" id="4713087">append</span><span class="op" id="4713093">(</span><span class="ident" id="4713094">all</span><span class="op" id="4713097">,</span>&nbsp;<span class="ident" id="4713099">ImportedSymbol</span><span class="op" id="4713113">{</span><span class="ident" id="4713114">Name</span><span class="op" id="4713118">:</span>&nbsp;<span class="ident" id="4713120">s</span><span class="op" id="4713121">.</span><span class="ident" id="4713122">Name</span><span class="op" id="4713126">}</span><span class="op" id="4713127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713132">f</span><span class="op" id="4713133">.</span><span class="ident" id="4713134">gnuVersion</span><span class="op" id="4713144">(</span><span class="ident" id="4713145">i</span><span class="op" id="4713146">,</span>&nbsp;<span class="op" id="4713148">&amp;</span><span class="ident" id="4713149">all</span><span class="op" id="4713152">[</span><span class="builtinfunc" id="4713153">len</span><span class="op" id="4713156">(</span><span class="ident" id="4713157">all</span><span class="op" id="4713160">)</span><span class="op" id="4713161">-</span><span class="num" id="4713162">1</span><span class="op" id="4713163">]</span><span class="op" id="4713164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4713168">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4713171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713174">return</span>&nbsp;<span class="ident" id="4713181">all</span><span class="op" id="4713184">,</span>&nbsp;<span class="ident" id="4713186">nil</span><br>
<span class="lineno"></span><span class="op" id="4713190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4713193">type</span>&nbsp;<span class="ident" id="4713198">verneed</span>&nbsp;<span class="keyword" id="4713206">struct</span>&nbsp;<span class="op" id="4713213">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713216">File</span>&nbsp;<span class="builtintype" id="4713221">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713229">Name</span>&nbsp;<span class="builtintype" id="4713234">string</span><br>
<span class="lineno"></span><span class="op" id="4713241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4713244">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="4713292">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="4713327">func</span>&nbsp;<span class="op" id="4713332">(</span><span class="ident" id="4713333">f</span>&nbsp;<span class="op" id="4713335">*</span><span class="ident" id="4713336">File</span><span class="op" id="4713340">)</span>&nbsp;<span class="ident" id="4713342">gnuVersionInit</span><span class="op" id="4713356">(</span><span class="ident" id="4713357">str</span>&nbsp;<span class="op" id="4713361">[</span><span class="op" id="4713362">]</span><span class="builtintype" id="4713363">byte</span><span class="op" id="4713367">)</span>&nbsp;<span class="op" id="4713369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4713372">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713408">vn</span>&nbsp;<span class="op" id="4713411">:=</span>&nbsp;<span class="ident" id="4713414">f</span><span class="op" id="4713415">.</span><span class="ident" id="4713416">SectionByType</span><span class="op" id="4713429">(</span><span class="ident" id="4713430">SHT_GNU_VERNEED</span><span class="op" id="4713445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713448">if</span>&nbsp;<span class="ident" id="4713451">vn</span>&nbsp;<span class="op" id="4713454">==</span>&nbsp;<span class="ident" id="4713457">nil</span>&nbsp;<span class="op" id="4713461">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713465">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4713473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713476">d</span><span class="op" id="4713477">,</span>&nbsp;<span class="ident" id="4713479">_</span>&nbsp;<span class="op" id="4713481">:=</span>&nbsp;<span class="ident" id="4713484">vn</span><span class="op" id="4713486">.</span><span class="ident" id="4713487">Data</span><span class="op" id="4713491">(</span><span class="op" id="4713492">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713496">var</span>&nbsp;<span class="ident" id="4713500">need</span>&nbsp;<span class="op" id="4713505">[</span><span class="op" id="4713506">]</span><span class="ident" id="4713507">verneed</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713516">i</span>&nbsp;<span class="op" id="4713518">:=</span>&nbsp;<span class="num" id="4713521">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713524">for</span>&nbsp;<span class="op" id="4713528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713532">if</span>&nbsp;<span class="ident" id="4713535">i</span><span class="op" id="4713536">+</span><span class="num" id="4713537">16</span>&nbsp;<span class="op" id="4713540">&gt;</span>&nbsp;<span class="builtinfunc" id="4713542">len</span><span class="op" id="4713545">(</span><span class="ident" id="4713546">d</span><span class="op" id="4713547">)</span>&nbsp;<span class="op" id="4713549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713554">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4713562">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713566">vers</span>&nbsp;<span class="op" id="4713571">:=</span>&nbsp;<span class="ident" id="4713574">f</span><span class="op" id="4713575">.</span><span class="ident" id="4713576">ByteOrder</span><span class="op" id="4713585">.</span><span class="ident" id="4713586">Uint16</span><span class="op" id="4713592">(</span><span class="ident" id="4713593">d</span><span class="op" id="4713594">[</span><span class="ident" id="4713595">i</span>&nbsp;<span class="op" id="4713597">:</span>&nbsp;<span class="ident" id="4713599">i</span><span class="op" id="4713600">+</span><span class="num" id="4713601">2</span><span class="op" id="4713602">]</span><span class="op" id="4713603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713607">if</span>&nbsp;<span class="ident" id="4713610">vers</span>&nbsp;<span class="op" id="4713615">!=</span>&nbsp;<span class="num" id="4713618">1</span>&nbsp;<span class="op" id="4713620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713625">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4713633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713637">cnt</span>&nbsp;<span class="op" id="4713641">:=</span>&nbsp;<span class="ident" id="4713644">f</span><span class="op" id="4713645">.</span><span class="ident" id="4713646">ByteOrder</span><span class="op" id="4713655">.</span><span class="ident" id="4713656">Uint16</span><span class="op" id="4713662">(</span><span class="ident" id="4713663">d</span><span class="op" id="4713664">[</span><span class="ident" id="4713665">i</span><span class="op" id="4713666">+</span><span class="num" id="4713667">2</span>&nbsp;<span class="op" id="4713669">:</span>&nbsp;<span class="ident" id="4713671">i</span><span class="op" id="4713672">+</span><span class="num" id="4713673">4</span><span class="op" id="4713674">]</span><span class="op" id="4713675">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713679">fileoff</span>&nbsp;<span class="op" id="4713687">:=</span>&nbsp;<span class="ident" id="4713690">f</span><span class="op" id="4713691">.</span><span class="ident" id="4713692">ByteOrder</span><span class="op" id="4713701">.</span><span class="ident" id="4713702">Uint32</span><span class="op" id="4713708">(</span><span class="ident" id="4713709">d</span><span class="op" id="4713710">[</span><span class="ident" id="4713711">i</span><span class="op" id="4713712">+</span><span class="num" id="4713713">4</span>&nbsp;<span class="op" id="4713715">:</span>&nbsp;<span class="ident" id="4713717">i</span><span class="op" id="4713718">+</span><span class="num" id="4713719">8</span><span class="op" id="4713720">]</span><span class="op" id="4713721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713725">aux</span>&nbsp;<span class="op" id="4713729">:=</span>&nbsp;<span class="ident" id="4713732">f</span><span class="op" id="4713733">.</span><span class="ident" id="4713734">ByteOrder</span><span class="op" id="4713743">.</span><span class="ident" id="4713744">Uint32</span><span class="op" id="4713750">(</span><span class="ident" id="4713751">d</span><span class="op" id="4713752">[</span><span class="ident" id="4713753">i</span><span class="op" id="4713754">+</span><span class="num" id="4713755">8</span>&nbsp;<span class="op" id="4713757">:</span>&nbsp;<span class="ident" id="4713759">i</span><span class="op" id="4713760">+</span><span class="num" id="4713761">12</span><span class="op" id="4713763">]</span><span class="op" id="4713764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713768">next</span>&nbsp;<span class="op" id="4713773">:=</span>&nbsp;<span class="ident" id="4713776">f</span><span class="op" id="4713777">.</span><span class="ident" id="4713778">ByteOrder</span><span class="op" id="4713787">.</span><span class="ident" id="4713788">Uint32</span><span class="op" id="4713794">(</span><span class="ident" id="4713795">d</span><span class="op" id="4713796">[</span><span class="ident" id="4713797">i</span><span class="op" id="4713798">+</span><span class="num" id="4713799">12</span>&nbsp;<span class="op" id="4713802">:</span>&nbsp;<span class="ident" id="4713804">i</span><span class="op" id="4713805">+</span><span class="num" id="4713806">16</span><span class="op" id="4713808">]</span><span class="op" id="4713809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713813">file</span><span class="op" id="4713817">,</span>&nbsp;<span class="ident" id="4713819">_</span>&nbsp;<span class="op" id="4713821">:=</span>&nbsp;<span class="ident" id="4713824">getString</span><span class="op" id="4713833">(</span><span class="ident" id="4713834">str</span><span class="op" id="4713837">,</span>&nbsp;<span class="builtintype" id="4713839">int</span><span class="op" id="4713842">(</span><span class="ident" id="4713843">fileoff</span><span class="op" id="4713850">)</span><span class="op" id="4713851">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713856">var</span>&nbsp;<span class="ident" id="4713860">name</span>&nbsp;<span class="builtintype" id="4713865">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4713874">j</span>&nbsp;<span class="op" id="4713876">:=</span>&nbsp;<span class="ident" id="4713879">i</span>&nbsp;<span class="op" id="4713881">+</span>&nbsp;<span class="builtintype" id="4713883">int</span><span class="op" id="4713886">(</span><span class="ident" id="4713887">aux</span><span class="op" id="4713890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713894">for</span>&nbsp;<span class="ident" id="4713898">c</span>&nbsp;<span class="op" id="4713900">:=</span>&nbsp;<span class="num" id="4713903">0</span><span class="op" id="4713904">;</span>&nbsp;<span class="ident" id="4713906">c</span>&nbsp;<span class="op" id="4713908">&lt;</span>&nbsp;<span class="builtintype" id="4713910">int</span><span class="op" id="4713913">(</span><span class="ident" id="4713914">cnt</span><span class="op" id="4713917">)</span><span class="op" id="4713918">;</span>&nbsp;<span class="ident" id="4713920">c</span><span class="op" id="4713921">++</span>&nbsp;<span class="op" id="4713924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713929">if</span>&nbsp;<span class="ident" id="4713932">j</span><span class="op" id="4713933">+</span><span class="num" id="4713934">16</span>&nbsp;<span class="op" id="4713937">&gt;</span>&nbsp;<span class="builtinfunc" id="4713939">len</span><span class="op" id="4713942">(</span><span class="ident" id="4713943">d</span><span class="op" id="4713944">)</span>&nbsp;<span class="op" id="4713946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4713952">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4713961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4713966">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4714009">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714055">other</span>&nbsp;<span class="op" id="4714061">:=</span>&nbsp;<span class="ident" id="4714064">f</span><span class="op" id="4714065">.</span><span class="ident" id="4714066">ByteOrder</span><span class="op" id="4714075">.</span><span class="ident" id="4714076">Uint16</span><span class="op" id="4714082">(</span><span class="ident" id="4714083">d</span><span class="op" id="4714084">[</span><span class="ident" id="4714085">j</span><span class="op" id="4714086">+</span><span class="num" id="4714087">6</span>&nbsp;<span class="op" id="4714089">:</span>&nbsp;<span class="ident" id="4714091">j</span><span class="op" id="4714092">+</span><span class="num" id="4714093">8</span><span class="op" id="4714094">]</span><span class="op" id="4714095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714100">nameoff</span>&nbsp;<span class="op" id="4714108">:=</span>&nbsp;<span class="ident" id="4714111">f</span><span class="op" id="4714112">.</span><span class="ident" id="4714113">ByteOrder</span><span class="op" id="4714122">.</span><span class="ident" id="4714123">Uint32</span><span class="op" id="4714129">(</span><span class="ident" id="4714130">d</span><span class="op" id="4714131">[</span><span class="ident" id="4714132">j</span><span class="op" id="4714133">+</span><span class="num" id="4714134">8</span>&nbsp;<span class="op" id="4714136">:</span>&nbsp;<span class="ident" id="4714138">j</span><span class="op" id="4714139">+</span><span class="num" id="4714140">12</span><span class="op" id="4714142">]</span><span class="op" id="4714143">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714148">next</span>&nbsp;<span class="op" id="4714153">:=</span>&nbsp;<span class="ident" id="4714156">f</span><span class="op" id="4714157">.</span><span class="ident" id="4714158">ByteOrder</span><span class="op" id="4714167">.</span><span class="ident" id="4714168">Uint32</span><span class="op" id="4714174">(</span><span class="ident" id="4714175">d</span><span class="op" id="4714176">[</span><span class="ident" id="4714177">j</span><span class="op" id="4714178">+</span><span class="num" id="4714179">12</span>&nbsp;<span class="op" id="4714182">:</span>&nbsp;<span class="ident" id="4714184">j</span><span class="op" id="4714185">+</span><span class="num" id="4714186">16</span><span class="op" id="4714188">]</span><span class="op" id="4714189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714194">name</span><span class="op" id="4714198">,</span>&nbsp;<span class="ident" id="4714200">_</span>&nbsp;<span class="op" id="4714202">=</span>&nbsp;<span class="ident" id="4714204">getString</span><span class="op" id="4714213">(</span><span class="ident" id="4714214">str</span><span class="op" id="4714217">,</span>&nbsp;<span class="builtintype" id="4714219">int</span><span class="op" id="4714222">(</span><span class="ident" id="4714223">nameoff</span><span class="op" id="4714230">)</span><span class="op" id="4714231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714236">ndx</span>&nbsp;<span class="op" id="4714240">:=</span>&nbsp;<span class="builtintype" id="4714243">int</span><span class="op" id="4714246">(</span><span class="ident" id="4714247">other</span><span class="op" id="4714252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4714257">if</span>&nbsp;<span class="ident" id="4714260">ndx</span>&nbsp;<span class="op" id="4714264">&gt;=</span>&nbsp;<span class="builtinfunc" id="4714267">len</span><span class="op" id="4714270">(</span><span class="ident" id="4714271">need</span><span class="op" id="4714275">)</span>&nbsp;<span class="op" id="4714277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714283">a</span>&nbsp;<span class="op" id="4714285">:=</span>&nbsp;<span class="builtinfunc" id="4714288">make</span><span class="op" id="4714292">(</span><span class="op" id="4714293">[</span><span class="op" id="4714294">]</span><span class="ident" id="4714295">verneed</span><span class="op" id="4714302">,</span>&nbsp;<span class="num" id="4714304">2</span><span class="op" id="4714305">*</span><span class="op" id="4714306">(</span><span class="ident" id="4714307">ndx</span><span class="op" id="4714310">+</span><span class="num" id="4714311">1</span><span class="op" id="4714312">)</span><span class="op" id="4714313">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4714319">copy</span><span class="op" id="4714323">(</span><span class="ident" id="4714324">a</span><span class="op" id="4714325">,</span>&nbsp;<span class="ident" id="4714327">need</span><span class="op" id="4714331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714337">need</span>&nbsp;<span class="op" id="4714342">=</span>&nbsp;<span class="ident" id="4714344">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4714349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714355">need</span><span class="op" id="4714359">[</span><span class="ident" id="4714360">ndx</span><span class="op" id="4714363">]</span>&nbsp;<span class="op" id="4714365">=</span>&nbsp;<span class="ident" id="4714367">verneed</span><span class="op" id="4714374">{</span><span class="ident" id="4714375">file</span><span class="op" id="4714379">,</span>&nbsp;<span class="ident" id="4714381">name</span><span class="op" id="4714385">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4714390">if</span>&nbsp;<span class="ident" id="4714393">next</span>&nbsp;<span class="op" id="4714398">==</span>&nbsp;<span class="num" id="4714401">0</span>&nbsp;<span class="op" id="4714403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4714409">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4714418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714423">j</span>&nbsp;<span class="op" id="4714425">+=</span>&nbsp;<span class="builtintype" id="4714428">int</span><span class="op" id="4714431">(</span><span class="ident" id="4714432">next</span><span class="op" id="4714436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4714440">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4714445">if</span>&nbsp;<span class="ident" id="4714448">next</span>&nbsp;<span class="op" id="4714453">==</span>&nbsp;<span class="num" id="4714456">0</span>&nbsp;<span class="op" id="4714458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4714463">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4714471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714475">i</span>&nbsp;<span class="op" id="4714477">+=</span>&nbsp;<span class="builtintype" id="4714480">int</span><span class="op" id="4714483">(</span><span class="ident" id="4714484">next</span><span class="op" id="4714488">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4714491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4714495">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714553">vs</span>&nbsp;<span class="op" id="4714556">:=</span>&nbsp;<span class="ident" id="4714559">f</span><span class="op" id="4714560">.</span><span class="ident" id="4714561">SectionByType</span><span class="op" id="4714574">(</span><span class="ident" id="4714575">SHT_GNU_VERSYM</span><span class="op" id="4714589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4714592">if</span>&nbsp;<span class="ident" id="4714595">vs</span>&nbsp;<span class="op" id="4714598">==</span>&nbsp;<span class="ident" id="4714601">nil</span>&nbsp;<span class="op" id="4714605">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4714609">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4714617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714620">d</span><span class="op" id="4714621">,</span>&nbsp;<span class="ident" id="4714623">_</span>&nbsp;<span class="op" id="4714625">=</span>&nbsp;<span class="ident" id="4714627">vs</span><span class="op" id="4714629">.</span><span class="ident" id="4714630">Data</span><span class="op" id="4714634">(</span><span class="op" id="4714635">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714639">f</span><span class="op" id="4714640">.</span><span class="ident" id="4714641">gnuNeed</span>&nbsp;<span class="op" id="4714649">=</span>&nbsp;<span class="ident" id="4714651">need</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714657">f</span><span class="op" id="4714658">.</span><span class="ident" id="4714659">gnuVersym</span>&nbsp;<span class="op" id="4714669">=</span>&nbsp;<span class="ident" id="4714671">d</span><br>
<span class="lineno"></span><span class="op" id="4714673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4714676">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="4714735">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="4714784">func</span>&nbsp;<span class="op" id="4714789">(</span><span class="ident" id="4714790">f</span>&nbsp;<span class="op" id="4714792">*</span><span class="ident" id="4714793">File</span><span class="op" id="4714797">)</span>&nbsp;<span class="ident" id="4714799">gnuVersion</span><span class="op" id="4714809">(</span><span class="ident" id="4714810">i</span>&nbsp;<span class="builtintype" id="4714812">int</span><span class="op" id="4714815">,</span>&nbsp;<span class="ident" id="4714817">sym</span>&nbsp;<span class="op" id="4714821">*</span><span class="ident" id="4714822">ImportedSymbol</span><span class="op" id="4714836">)</span>&nbsp;<span class="op" id="4714838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4714841">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714870">i</span>&nbsp;<span class="op" id="4714872">=</span>&nbsp;<span class="op" id="4714874">(</span><span class="ident" id="4714875">i</span>&nbsp;<span class="op" id="4714877">+</span>&nbsp;<span class="num" id="4714879">1</span><span class="op" id="4714880">)</span>&nbsp;<span class="op" id="4714882">*</span>&nbsp;<span class="num" id="4714884">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4714887">if</span>&nbsp;<span class="ident" id="4714890">i</span>&nbsp;<span class="op" id="4714892">&gt;=</span>&nbsp;<span class="builtinfunc" id="4714895">len</span><span class="op" id="4714898">(</span><span class="ident" id="4714899">f</span><span class="op" id="4714900">.</span><span class="ident" id="4714901">gnuVersym</span><span class="op" id="4714910">)</span>&nbsp;<span class="op" id="4714912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4714916">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4714924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4714927">j</span>&nbsp;<span class="op" id="4714929">:=</span>&nbsp;<span class="builtintype" id="4714932">int</span><span class="op" id="4714935">(</span><span class="ident" id="4714936">f</span><span class="op" id="4714937">.</span><span class="ident" id="4714938">ByteOrder</span><span class="op" id="4714947">.</span><span class="ident" id="4714948">Uint16</span><span class="op" id="4714954">(</span><span class="ident" id="4714955">f</span><span class="op" id="4714956">.</span><span class="ident" id="4714957">gnuVersym</span><span class="op" id="4714966">[</span><span class="ident" id="4714967">i</span><span class="op" id="4714968">:</span><span class="op" id="4714969">]</span><span class="op" id="4714970">)</span><span class="op" id="4714971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4714974">if</span>&nbsp;<span class="ident" id="4714977">j</span>&nbsp;<span class="op" id="4714979">&lt;</span>&nbsp;<span class="num" id="4714981">2</span>&nbsp;<span class="op" id="4714983">||</span>&nbsp;<span class="ident" id="4714986">j</span>&nbsp;<span class="op" id="4714988">&gt;=</span>&nbsp;<span class="builtinfunc" id="4714991">len</span><span class="op" id="4714994">(</span><span class="ident" id="4714995">f</span><span class="op" id="4714996">.</span><span class="ident" id="4714997">gnuNeed</span><span class="op" id="4715004">)</span>&nbsp;<span class="op" id="4715006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715010">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4715018">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4715021">n</span>&nbsp;<span class="op" id="4715023">:=</span>&nbsp;<span class="op" id="4715026">&amp;</span><span class="ident" id="4715027">f</span><span class="op" id="4715028">.</span><span class="ident" id="4715029">gnuNeed</span><span class="op" id="4715036">[</span><span class="ident" id="4715037">j</span><span class="op" id="4715038">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4715041">sym</span><span class="op" id="4715044">.</span><span class="ident" id="4715045">Library</span>&nbsp;<span class="op" id="4715053">=</span>&nbsp;<span class="ident" id="4715055">n</span><span class="op" id="4715056">.</span><span class="ident" id="4715057">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4715063">sym</span><span class="op" id="4715066">.</span><span class="ident" id="4715067">Version</span>&nbsp;<span class="op" id="4715075">=</span>&nbsp;<span class="ident" id="4715077">n</span><span class="op" id="4715078">.</span><span class="ident" id="4715079">Name</span><br>
<span class="lineno"></span><span class="op" id="4715084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="4715087">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="4715143">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4715198">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4715246">func</span>&nbsp;<span class="op" id="4715251">(</span><span class="ident" id="4715252">f</span>&nbsp;<span class="op" id="4715254">*</span><span class="ident" id="4715255">File</span><span class="op" id="4715259">)</span>&nbsp;<span class="ident" id="4715261">ImportedLibraries</span><span class="op" id="4715278">(</span><span class="op" id="4715279">)</span>&nbsp;<span class="op" id="4715281">(</span><span class="op" id="4715282">[</span><span class="op" id="4715283">]</span><span class="builtintype" id="4715284">string</span><span class="op" id="4715290">,</span>&nbsp;<span class="builtintype" id="4715292">error</span><span class="op" id="4715297">)</span>&nbsp;<span class="op" id="4715299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715302">return</span>&nbsp;<span class="ident" id="4715309">f</span><span class="op" id="4715310">.</span><span class="ident" id="4715311">DynString</span><span class="op" id="4715320">(</span><span class="ident" id="4715321">DT_NEEDED</span><span class="op" id="4715330">)</span><br>
<span class="lineno">905</span><span class="op" id="4715332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4715335">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="4715415">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="4715427">//</span><br>
<span class="lineno">910</span><span class="comment" id="4715430">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4715514">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="4715529">func</span>&nbsp;<span class="op" id="4715534">(</span><span class="ident" id="4715535">f</span>&nbsp;<span class="op" id="4715537">*</span><span class="ident" id="4715538">File</span><span class="op" id="4715542">)</span>&nbsp;<span class="ident" id="4715544">DynString</span><span class="op" id="4715553">(</span><span class="ident" id="4715554">tag</span>&nbsp;<span class="ident" id="4715558">DynTag</span><span class="op" id="4715564">)</span>&nbsp;<span class="op" id="4715566">(</span><span class="op" id="4715567">[</span><span class="op" id="4715568">]</span><span class="builtintype" id="4715569">string</span><span class="op" id="4715575">,</span>&nbsp;<span class="builtintype" id="4715577">error</span><span class="op" id="4715582">)</span>&nbsp;<span class="op" id="4715584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715587">switch</span>&nbsp;<span class="ident" id="4715594">tag</span>&nbsp;<span class="op" id="4715598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715601">case</span>&nbsp;<span class="ident" id="4715606">DT_NEEDED</span><span class="op" id="4715615">,</span>&nbsp;<span class="ident" id="4715617">DT_SONAME</span><span class="op" id="4715626">,</span>&nbsp;<span class="ident" id="4715628">DT_RPATH</span><span class="op" id="4715636">,</span>&nbsp;<span class="ident" id="4715638">DT_RUNPATH</span><span class="op" id="4715648">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715651">default</span><span class="op" id="4715658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715662">return</span>&nbsp;<span class="ident" id="4715669">nil</span><span class="op" id="4715672">,</span>&nbsp;<span class="ident" id="4715674">fmt</span><span class="op" id="4715677">.</span><span class="ident" id="4715678">Errorf</span><span class="op" id="4715684">(</span><span class="string" id="4715685">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="4715711">,</span>&nbsp;<span class="ident" id="4715713">tag</span><span class="op" id="4715716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4715719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4715722">ds</span>&nbsp;<span class="op" id="4715725">:=</span>&nbsp;<span class="ident" id="4715728">f</span><span class="op" id="4715729">.</span><span class="ident" id="4715730">SectionByType</span><span class="op" id="4715743">(</span><span class="ident" id="4715744">SHT_DYNAMIC</span><span class="op" id="4715755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715758">if</span>&nbsp;<span class="ident" id="4715761">ds</span>&nbsp;<span class="op" id="4715764">==</span>&nbsp;<span class="ident" id="4715767">nil</span>&nbsp;<span class="op" id="4715771">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4715775">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715809">return</span>&nbsp;<span class="ident" id="4715816">nil</span><span class="op" id="4715819">,</span>&nbsp;<span class="ident" id="4715821">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4715826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4715829">d</span><span class="op" id="4715830">,</span>&nbsp;<span class="ident" id="4715832">err</span>&nbsp;<span class="op" id="4715836">:=</span>&nbsp;<span class="ident" id="4715839">ds</span><span class="op" id="4715841">.</span><span class="ident" id="4715842">Data</span><span class="op" id="4715846">(</span><span class="op" id="4715847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715850">if</span>&nbsp;<span class="ident" id="4715853">err</span>&nbsp;<span class="op" id="4715857">!=</span>&nbsp;<span class="ident" id="4715860">nil</span>&nbsp;<span class="op" id="4715864">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715868">return</span>&nbsp;<span class="ident" id="4715875">nil</span><span class="op" id="4715878">,</span>&nbsp;<span class="ident" id="4715880">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4715885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4715888">str</span><span class="op" id="4715891">,</span>&nbsp;<span class="ident" id="4715893">err</span>&nbsp;<span class="op" id="4715897">:=</span>&nbsp;<span class="ident" id="4715900">f</span><span class="op" id="4715901">.</span><span class="ident" id="4715902">stringTable</span><span class="op" id="4715913">(</span><span class="ident" id="4715914">ds</span><span class="op" id="4715916">.</span><span class="ident" id="4715917">Link</span><span class="op" id="4715921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715924">if</span>&nbsp;<span class="ident" id="4715927">err</span>&nbsp;<span class="op" id="4715931">!=</span>&nbsp;<span class="ident" id="4715934">nil</span>&nbsp;<span class="op" id="4715938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715942">return</span>&nbsp;<span class="ident" id="4715949">nil</span><span class="op" id="4715952">,</span>&nbsp;<span class="ident" id="4715954">err</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4715959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715962">var</span>&nbsp;<span class="ident" id="4715966">all</span>&nbsp;<span class="op" id="4715970">[</span><span class="op" id="4715971">]</span><span class="builtintype" id="4715972">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715980">for</span>&nbsp;<span class="builtinfunc" id="4715984">len</span><span class="op" id="4715987">(</span><span class="ident" id="4715988">d</span><span class="op" id="4715989">)</span>&nbsp;<span class="op" id="4715991">&gt;</span>&nbsp;<span class="num" id="4715993">0</span>&nbsp;<span class="op" id="4715995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4715999">var</span>&nbsp;<span class="ident" id="4716003">t</span>&nbsp;<span class="ident" id="4716005">DynTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4716014">var</span>&nbsp;<span class="ident" id="4716018">v</span>&nbsp;<span class="ident" id="4716020">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4716029">switch</span>&nbsp;<span class="ident" id="4716036">f</span><span class="op" id="4716037">.</span><span class="ident" id="4716038">Class</span>&nbsp;<span class="op" id="4716044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4716048">case</span>&nbsp;<span class="ident" id="4716053">ELFCLASS32</span><span class="op" id="4716063">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4716068">t</span>&nbsp;<span class="op" id="4716070">=</span>&nbsp;<span class="ident" id="4716072">DynTag</span><span class="op" id="4716078">(</span><span class="ident" id="4716079">f</span><span class="op" id="4716080">.</span><span class="ident" id="4716081">ByteOrder</span><span class="op" id="4716090">.</span><span class="ident" id="4716091">Uint32</span><span class="op" id="4716097">(</span><span class="ident" id="4716098">d</span><span class="op" id="4716099">[</span><span class="num" id="4716100">0</span><span class="op" id="4716101">:</span><span class="num" id="4716102">4</span><span class="op" id="4716103">]</span><span class="op" id="4716104">)</span><span class="op" id="4716105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4716110">v</span>&nbsp;<span class="op" id="4716112">=</span>&nbsp;<span class="ident" id="4716114">uint64</span><span class="op" id="4716120">(</span><span class="ident" id="4716121">f</span><span class="op" id="4716122">.</span><span class="ident" id="4716123">ByteOrder</span><span class="op" id="4716132">.</span><span class="ident" id="4716133">Uint32</span><span class="op" id="4716139">(</span><span class="ident" id="4716140">d</span><span class="op" id="4716141">[</span><span class="num" id="4716142">4</span><span class="op" id="4716143">:</span><span class="num" id="4716144">8</span><span class="op" id="4716145">]</span><span class="op" id="4716146">)</span><span class="op" id="4716147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4716152">d</span>&nbsp;<span class="op" id="4716154">=</span>&nbsp;<span class="ident" id="4716156">d</span><span class="op" id="4716157">[</span><span class="num" id="4716158">8</span><span class="op" id="4716159">:</span><span class="op" id="4716160">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4716164">case</span>&nbsp;<span class="ident" id="4716169">ELFCLASS64</span><span class="op" id="4716179">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4716184">t</span>&nbsp;<span class="op" id="4716186">=</span>&nbsp;<span class="ident" id="4716188">DynTag</span><span class="op" id="4716194">(</span><span class="ident" id="4716195">f</span><span class="op" id="4716196">.</span><span class="ident" id="4716197">ByteOrder</span><span class="op" id="4716206">.</span><span class="ident" id="4716207">Uint64</span><span class="op" id="4716213">(</span><span class="ident" id="4716214">d</span><span class="op" id="4716215">[</span><span class="num" id="4716216">0</span><span class="op" id="4716217">:</span><span class="num" id="4716218">8</span><span class="op" id="4716219">]</span><span class="op" id="4716220">)</span><span class="op" id="4716221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4716226">v</span>&nbsp;<span class="op" id="4716228">=</span>&nbsp;<span class="ident" id="4716230">f</span><span class="op" id="4716231">.</span><span class="ident" id="4716232">ByteOrder</span><span class="op" id="4716241">.</span><span class="ident" id="4716242">Uint64</span><span class="op" id="4716248">(</span><span class="ident" id="4716249">d</span><span class="op" id="4716250">[</span><span class="num" id="4716251">8</span><span class="op" id="4716252">:</span><span class="num" id="4716253">16</span><span class="op" id="4716255">]</span><span class="op" id="4716256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4716261">d</span>&nbsp;<span class="op" id="4716263">=</span>&nbsp;<span class="ident" id="4716265">d</span><span class="op" id="4716266">[</span><span class="num" id="4716267">16</span><span class="op" id="4716269">:</span><span class="op" id="4716270">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4716274">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4716278">if</span>&nbsp;<span class="ident" id="4716281">t</span>&nbsp;<span class="op" id="4716283">==</span>&nbsp;<span class="ident" id="4716286">tag</span>&nbsp;<span class="op" id="4716290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4716295">s</span><span class="op" id="4716296">,</span>&nbsp;<span class="ident" id="4716298">ok</span>&nbsp;<span class="op" id="4716301">:=</span>&nbsp;<span class="ident" id="4716304">getString</span><span class="op" id="4716313">(</span><span class="ident" id="4716314">str</span><span class="op" id="4716317">,</span>&nbsp;<span class="builtintype" id="4716319">int</span><span class="op" id="4716322">(</span><span class="ident" id="4716323">v</span><span class="op" id="4716324">)</span><span class="op" id="4716325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4716330">if</span>&nbsp;<span class="ident" id="4716333">ok</span>&nbsp;<span class="op" id="4716336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4716342">all</span>&nbsp;<span class="op" id="4716346">=</span>&nbsp;<span class="builtinfunc" id="4716348">append</span><span class="op" id="4716354">(</span><span class="ident" id="4716355">all</span><span class="op" id="4716358">,</span>&nbsp;<span class="ident" id="4716360">s</span><span class="op" id="4716361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4716366">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4716370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4716373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4716376">return</span>&nbsp;<span class="ident" id="4716383">all</span><span class="op" id="4716386">,</span>&nbsp;<span class="ident" id="4716388">nil</span><br>
<span class="lineno"></span><span class="op" id="4716392">}</span>
</div>
</body>
</html>
