<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2485786">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2485841">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2485895">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2485946">package</span>&nbsp;<span class="ident" id="2485954">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2485958">import</span>&nbsp;<span class="op" id="2485965">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2485968">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2485974">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2485984">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2485987">//&nbsp;MkdirAll&nbsp;creates&nbsp;a&nbsp;directory&nbsp;named&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="2486031">//&nbsp;along&nbsp;with&nbsp;any&nbsp;necessary&nbsp;parents,&nbsp;and&nbsp;returns&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="2486085">//&nbsp;or&nbsp;else&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno">15</span><span class="comment" id="2486114">//&nbsp;The&nbsp;permission&nbsp;bits&nbsp;perm&nbsp;are&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2486159">//&nbsp;directories&nbsp;that&nbsp;MkdirAll&nbsp;creates.</span><br>
<span class="lineno"></span><span class="comment" id="2486197">//&nbsp;If&nbsp;path&nbsp;is&nbsp;already&nbsp;a&nbsp;directory,&nbsp;MkdirAll&nbsp;does&nbsp;nothing</span><br>
<span class="lineno"></span><span class="comment" id="2486254">//&nbsp;and&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2486274">func</span>&nbsp;<span class="ident" id="2486279">MkdirAll</span><span class="op" id="2486287">(</span><span class="ident" id="2486288">path</span>&nbsp;<span class="builtintype" id="2486293">string</span><span class="op" id="2486299">,</span>&nbsp;<span class="ident" id="2486301">perm</span>&nbsp;<span class="ident" id="2486306">FileMode</span><span class="op" id="2486314">)</span>&nbsp;<span class="builtintype" id="2486316">error</span>&nbsp;<span class="op" id="2486322">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2486325">//&nbsp;Fast&nbsp;path:&nbsp;if&nbsp;we&nbsp;can&nbsp;tell&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;directory&nbsp;or&nbsp;file,&nbsp;stop&nbsp;with&nbsp;success&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486420">dir</span><span class="op" id="2486423">,</span>&nbsp;<span class="ident" id="2486425">err</span>&nbsp;<span class="op" id="2486429">:=</span>&nbsp;<span class="ident" id="2486432">Stat</span><span class="op" id="2486436">(</span><span class="ident" id="2486437">path</span><span class="op" id="2486441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486444">if</span>&nbsp;<span class="ident" id="2486447">err</span>&nbsp;<span class="op" id="2486451">==</span>&nbsp;<span class="ident" id="2486454">nil</span>&nbsp;<span class="op" id="2486458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486462">if</span>&nbsp;<span class="ident" id="2486465">dir</span><span class="op" id="2486468">.</span><span class="ident" id="2486469">IsDir</span><span class="op" id="2486474">(</span><span class="op" id="2486475">)</span>&nbsp;<span class="op" id="2486477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486482">return</span>&nbsp;<span class="ident" id="2486489">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2486495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486499">return</span>&nbsp;<span class="op" id="2486506">&amp;</span><span class="ident" id="2486507">PathError</span><span class="op" id="2486516">{</span><span class="string" id="2486517">&#34;mkdir&#34;</span><span class="op" id="2486524">,</span>&nbsp;<span class="ident" id="2486526">path</span><span class="op" id="2486530">,</span>&nbsp;<span class="ident" id="2486532">syscall</span><span class="op" id="2486539">.</span><span class="ident" id="2486540">ENOTDIR</span><span class="op" id="2486547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2486550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2486554">//&nbsp;Slow&nbsp;path:&nbsp;make&nbsp;sure&nbsp;parent&nbsp;exists&nbsp;and&nbsp;then&nbsp;call&nbsp;Mkdir&nbsp;for&nbsp;path.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486623">i</span>&nbsp;<span class="op" id="2486625">:=</span>&nbsp;<span class="builtinfunc" id="2486628">len</span><span class="op" id="2486631">(</span><span class="ident" id="2486632">path</span><span class="op" id="2486636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486639">for</span>&nbsp;<span class="ident" id="2486643">i</span>&nbsp;<span class="op" id="2486645">&gt;</span>&nbsp;<span class="num" id="2486647">0</span>&nbsp;<span class="op" id="2486649">&amp;&amp;</span>&nbsp;<span class="ident" id="2486652">IsPathSeparator</span><span class="op" id="2486667">(</span><span class="ident" id="2486668">path</span><span class="op" id="2486672">[</span><span class="ident" id="2486673">i</span><span class="op" id="2486674">-</span><span class="num" id="2486675">1</span><span class="op" id="2486676">]</span><span class="op" id="2486677">)</span>&nbsp;<span class="op" id="2486679">{</span>&nbsp;<span class="comment" id="2486681">//&nbsp;Skip&nbsp;trailing&nbsp;path&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486716">i</span><span class="op" id="2486717">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2486721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486725">j</span>&nbsp;<span class="op" id="2486727">:=</span>&nbsp;<span class="ident" id="2486730">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486733">for</span>&nbsp;<span class="ident" id="2486737">j</span>&nbsp;<span class="op" id="2486739">&gt;</span>&nbsp;<span class="num" id="2486741">0</span>&nbsp;<span class="op" id="2486743">&amp;&amp;</span>&nbsp;<span class="op" id="2486746">!</span><span class="ident" id="2486747">IsPathSeparator</span><span class="op" id="2486762">(</span><span class="ident" id="2486763">path</span><span class="op" id="2486767">[</span><span class="ident" id="2486768">j</span><span class="op" id="2486769">-</span><span class="num" id="2486770">1</span><span class="op" id="2486771">]</span><span class="op" id="2486772">)</span>&nbsp;<span class="op" id="2486774">{</span>&nbsp;<span class="comment" id="2486776">//&nbsp;Scan&nbsp;backward&nbsp;over&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486809">j</span><span class="op" id="2486810">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2486814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486818">if</span>&nbsp;<span class="ident" id="2486821">j</span>&nbsp;<span class="op" id="2486823">&gt;</span>&nbsp;<span class="num" id="2486825">1</span>&nbsp;<span class="op" id="2486827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2486831">//&nbsp;Create&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486850">err</span>&nbsp;<span class="op" id="2486854">=</span>&nbsp;<span class="ident" id="2486856">MkdirAll</span><span class="op" id="2486864">(</span><span class="ident" id="2486865">path</span><span class="op" id="2486869">[</span><span class="num" id="2486870">0</span><span class="op" id="2486871">:</span><span class="ident" id="2486872">j</span><span class="op" id="2486873">-</span><span class="num" id="2486874">1</span><span class="op" id="2486875">]</span><span class="op" id="2486876">,</span>&nbsp;<span class="ident" id="2486878">perm</span><span class="op" id="2486882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486886">if</span>&nbsp;<span class="ident" id="2486889">err</span>&nbsp;<span class="op" id="2486893">!=</span>&nbsp;<span class="ident" id="2486896">nil</span>&nbsp;<span class="op" id="2486900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2486905">return</span>&nbsp;<span class="ident" id="2486912">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2486918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2486921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2486925">//&nbsp;Parent&nbsp;now&nbsp;exists;&nbsp;invoke&nbsp;Mkdir&nbsp;and&nbsp;use&nbsp;its&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2486981">err</span>&nbsp;<span class="op" id="2486985">=</span>&nbsp;<span class="ident" id="2486987">Mkdir</span><span class="op" id="2486992">(</span><span class="ident" id="2486993">path</span><span class="op" id="2486997">,</span>&nbsp;<span class="ident" id="2486999">perm</span><span class="op" id="2487003">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487006">if</span>&nbsp;<span class="ident" id="2487009">err</span>&nbsp;<span class="op" id="2487013">!=</span>&nbsp;<span class="ident" id="2487016">nil</span>&nbsp;<span class="op" id="2487020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2487024">//&nbsp;Handle&nbsp;arguments&nbsp;like&nbsp;&#34;foo/.&#34;&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2487062">//&nbsp;double-checking&nbsp;that&nbsp;directory&nbsp;doesn&#39;t&nbsp;exist.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487113">dir</span><span class="op" id="2487116">,</span>&nbsp;<span class="ident" id="2487118">err1</span>&nbsp;<span class="op" id="2487123">:=</span>&nbsp;<span class="ident" id="2487126">Lstat</span><span class="op" id="2487131">(</span><span class="ident" id="2487132">path</span><span class="op" id="2487136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487140">if</span>&nbsp;<span class="ident" id="2487143">err1</span>&nbsp;<span class="op" id="2487148">==</span>&nbsp;<span class="ident" id="2487151">nil</span>&nbsp;<span class="op" id="2487155">&amp;&amp;</span>&nbsp;<span class="ident" id="2487158">dir</span><span class="op" id="2487161">.</span><span class="ident" id="2487162">IsDir</span><span class="op" id="2487167">(</span><span class="op" id="2487168">)</span>&nbsp;<span class="op" id="2487170">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487175">return</span>&nbsp;<span class="ident" id="2487182">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2487188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487192">return</span>&nbsp;<span class="ident" id="2487199">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2487204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487207">return</span>&nbsp;<span class="ident" id="2487214">nil</span><br>
<span class="lineno">60</span><span class="op" id="2487218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2487221">//&nbsp;RemoveAll&nbsp;removes&nbsp;path&nbsp;and&nbsp;any&nbsp;children&nbsp;it&nbsp;contains.</span><br>
<span class="lineno"></span><span class="comment" id="2487277">//&nbsp;It&nbsp;removes&nbsp;everything&nbsp;it&nbsp;can&nbsp;but&nbsp;returns&nbsp;the&nbsp;first&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2487337">//&nbsp;it&nbsp;encounters.&nbsp;&nbsp;If&nbsp;the&nbsp;path&nbsp;does&nbsp;not&nbsp;exist,&nbsp;RemoveAll</span><br>
<span class="lineno">65</span><span class="comment" id="2487394">//&nbsp;returns&nbsp;nil&nbsp;(no&nbsp;error).</span><br>
<span class="lineno"></span><span class="keyword" id="2487421">func</span>&nbsp;<span class="ident" id="2487426">RemoveAll</span><span class="op" id="2487435">(</span><span class="ident" id="2487436">path</span>&nbsp;<span class="builtintype" id="2487441">string</span><span class="op" id="2487447">)</span>&nbsp;<span class="builtintype" id="2487449">error</span>&nbsp;<span class="op" id="2487455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2487458">//&nbsp;Simple&nbsp;case:&nbsp;if&nbsp;Remove&nbsp;works,&nbsp;we&#39;re&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487504">err</span>&nbsp;<span class="op" id="2487508">:=</span>&nbsp;<span class="ident" id="2487511">Remove</span><span class="op" id="2487517">(</span><span class="ident" id="2487518">path</span><span class="op" id="2487522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487525">if</span>&nbsp;<span class="ident" id="2487528">err</span>&nbsp;<span class="op" id="2487532">==</span>&nbsp;<span class="ident" id="2487535">nil</span>&nbsp;<span class="op" id="2487539">||</span>&nbsp;<span class="ident" id="2487542">IsNotExist</span><span class="op" id="2487552">(</span><span class="ident" id="2487553">err</span><span class="op" id="2487556">)</span>&nbsp;<span class="op" id="2487558">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487562">return</span>&nbsp;<span class="ident" id="2487569">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2487574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2487578">//&nbsp;Otherwise,&nbsp;is&nbsp;this&nbsp;a&nbsp;directory&nbsp;we&nbsp;need&nbsp;to&nbsp;recurse&nbsp;into?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487638">dir</span><span class="op" id="2487641">,</span>&nbsp;<span class="ident" id="2487643">serr</span>&nbsp;<span class="op" id="2487648">:=</span>&nbsp;<span class="ident" id="2487651">Lstat</span><span class="op" id="2487656">(</span><span class="ident" id="2487657">path</span><span class="op" id="2487661">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487664">if</span>&nbsp;<span class="ident" id="2487667">serr</span>&nbsp;<span class="op" id="2487672">!=</span>&nbsp;<span class="ident" id="2487675">nil</span>&nbsp;<span class="op" id="2487679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487683">if</span>&nbsp;<span class="ident" id="2487686">serr</span><span class="op" id="2487690">,</span>&nbsp;<span class="ident" id="2487692">ok</span>&nbsp;<span class="op" id="2487695">:=</span>&nbsp;<span class="ident" id="2487698">serr</span><span class="op" id="2487702">.</span><span class="op" id="2487703">(</span><span class="op" id="2487704">*</span><span class="ident" id="2487705">PathError</span><span class="op" id="2487714">)</span><span class="op" id="2487715">;</span>&nbsp;<span class="ident" id="2487717">ok</span>&nbsp;<span class="op" id="2487720">&amp;&amp;</span>&nbsp;<span class="op" id="2487723">(</span><span class="ident" id="2487724">IsNotExist</span><span class="op" id="2487734">(</span><span class="ident" id="2487735">serr</span><span class="op" id="2487739">.</span><span class="ident" id="2487740">Err</span><span class="op" id="2487743">)</span>&nbsp;<span class="op" id="2487745">||</span>&nbsp;<span class="ident" id="2487748">serr</span><span class="op" id="2487752">.</span><span class="ident" id="2487753">Err</span>&nbsp;<span class="op" id="2487757">==</span>&nbsp;<span class="ident" id="2487760">syscall</span><span class="op" id="2487767">.</span><span class="ident" id="2487768">ENOTDIR</span><span class="op" id="2487775">)</span>&nbsp;<span class="op" id="2487777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487782">return</span>&nbsp;<span class="ident" id="2487789">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2487795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487799">return</span>&nbsp;<span class="ident" id="2487806">serr</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2487812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487815">if</span>&nbsp;<span class="op" id="2487818">!</span><span class="ident" id="2487819">dir</span><span class="op" id="2487822">.</span><span class="ident" id="2487823">IsDir</span><span class="op" id="2487828">(</span><span class="op" id="2487829">)</span>&nbsp;<span class="op" id="2487831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2487835">//&nbsp;Not&nbsp;a&nbsp;directory;&nbsp;return&nbsp;the&nbsp;error&nbsp;from&nbsp;Remove.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487887">return</span>&nbsp;<span class="ident" id="2487894">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2487899">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2487903">//&nbsp;Directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2487918">fd</span><span class="op" id="2487920">,</span>&nbsp;<span class="ident" id="2487922">err</span>&nbsp;<span class="op" id="2487926">:=</span>&nbsp;<span class="ident" id="2487929">Open</span><span class="op" id="2487933">(</span><span class="ident" id="2487934">path</span><span class="op" id="2487938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487941">if</span>&nbsp;<span class="ident" id="2487944">err</span>&nbsp;<span class="op" id="2487948">!=</span>&nbsp;<span class="ident" id="2487951">nil</span>&nbsp;<span class="op" id="2487955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2487959">if</span>&nbsp;<span class="ident" id="2487962">IsNotExist</span><span class="op" id="2487972">(</span><span class="ident" id="2487973">err</span><span class="op" id="2487976">)</span>&nbsp;<span class="op" id="2487978">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2487983">//&nbsp;Race.&nbsp;It&nbsp;was&nbsp;deleted&nbsp;between&nbsp;the&nbsp;Lstat&nbsp;and&nbsp;Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2488038">//&nbsp;Return&nbsp;nil&nbsp;per&nbsp;RemoveAll&#39;s&nbsp;docs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488077">return</span>&nbsp;<span class="ident" id="2488084">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2488090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488094">return</span>&nbsp;<span class="ident" id="2488101">err</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2488106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2488110">//&nbsp;Remove&nbsp;contents&nbsp;&amp;&nbsp;return&nbsp;first&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2488152">err</span>&nbsp;<span class="op" id="2488156">=</span>&nbsp;<span class="ident" id="2488158">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488163">for</span>&nbsp;<span class="op" id="2488167">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2488171">names</span><span class="op" id="2488176">,</span>&nbsp;<span class="ident" id="2488178">err1</span>&nbsp;<span class="op" id="2488183">:=</span>&nbsp;<span class="ident" id="2488186">fd</span><span class="op" id="2488188">.</span><span class="ident" id="2488189">Readdirnames</span><span class="op" id="2488201">(</span><span class="num" id="2488202">100</span><span class="op" id="2488205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488209">for</span>&nbsp;<span class="ident" id="2488213">_</span><span class="op" id="2488214">,</span>&nbsp;<span class="ident" id="2488216">name</span>&nbsp;<span class="op" id="2488221">:=</span>&nbsp;<span class="keyword" id="2488224">range</span>&nbsp;<span class="ident" id="2488230">names</span>&nbsp;<span class="op" id="2488236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2488241">err1</span>&nbsp;<span class="op" id="2488246">:=</span>&nbsp;<span class="ident" id="2488249">RemoveAll</span><span class="op" id="2488258">(</span><span class="ident" id="2488259">path</span>&nbsp;<span class="op" id="2488264">+</span>&nbsp;<span class="builtintype" id="2488266">string</span><span class="op" id="2488272">(</span><span class="ident" id="2488273">PathSeparator</span><span class="op" id="2488286">)</span>&nbsp;<span class="op" id="2488288">+</span>&nbsp;<span class="ident" id="2488290">name</span><span class="op" id="2488294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488299">if</span>&nbsp;<span class="ident" id="2488302">err</span>&nbsp;<span class="op" id="2488306">==</span>&nbsp;<span class="ident" id="2488309">nil</span>&nbsp;<span class="op" id="2488313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2488319">err</span>&nbsp;<span class="op" id="2488323">=</span>&nbsp;<span class="ident" id="2488325">err1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2488333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2488337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488341">if</span>&nbsp;<span class="ident" id="2488344">err1</span>&nbsp;<span class="op" id="2488349">==</span>&nbsp;<span class="ident" id="2488352">io</span><span class="op" id="2488354">.</span><span class="ident" id="2488355">EOF</span>&nbsp;<span class="op" id="2488359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488364">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2488372">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2488376">//&nbsp;If&nbsp;Readdirnames&nbsp;returned&nbsp;an&nbsp;error,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488424">if</span>&nbsp;<span class="ident" id="2488427">err</span>&nbsp;<span class="op" id="2488431">==</span>&nbsp;<span class="ident" id="2488434">nil</span>&nbsp;<span class="op" id="2488438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2488443">err</span>&nbsp;<span class="op" id="2488447">=</span>&nbsp;<span class="ident" id="2488449">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2488456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488460">if</span>&nbsp;<span class="builtinfunc" id="2488463">len</span><span class="op" id="2488466">(</span><span class="ident" id="2488467">names</span><span class="op" id="2488472">)</span>&nbsp;<span class="op" id="2488474">==</span>&nbsp;<span class="num" id="2488477">0</span>&nbsp;<span class="op" id="2488479">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488484">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2488492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2488495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2488499">//&nbsp;Close&nbsp;directory,&nbsp;because&nbsp;windows&nbsp;won&#39;t&nbsp;remove&nbsp;opened&nbsp;directory.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2488567">fd</span><span class="op" id="2488569">.</span><span class="ident" id="2488570">Close</span><span class="op" id="2488575">(</span><span class="op" id="2488576">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2488580">//&nbsp;Remove&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2488602">err1</span>&nbsp;<span class="op" id="2488607">:=</span>&nbsp;<span class="ident" id="2488610">Remove</span><span class="op" id="2488616">(</span><span class="ident" id="2488617">path</span><span class="op" id="2488621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488624">if</span>&nbsp;<span class="ident" id="2488627">err1</span>&nbsp;<span class="op" id="2488632">==</span>&nbsp;<span class="ident" id="2488635">nil</span>&nbsp;<span class="op" id="2488639">||</span>&nbsp;<span class="ident" id="2488642">IsNotExist</span><span class="op" id="2488652">(</span><span class="ident" id="2488653">err1</span><span class="op" id="2488657">)</span>&nbsp;<span class="op" id="2488659">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488663">return</span>&nbsp;<span class="ident" id="2488670">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2488675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488678">if</span>&nbsp;<span class="ident" id="2488681">err</span>&nbsp;<span class="op" id="2488685">==</span>&nbsp;<span class="ident" id="2488688">nil</span>&nbsp;<span class="op" id="2488692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2488696">err</span>&nbsp;<span class="op" id="2488700">=</span>&nbsp;<span class="ident" id="2488702">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2488708">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2488711">return</span>&nbsp;<span class="ident" id="2488718">err</span><br>
<span class="lineno"></span><span class="op" id="2488722">}</span>
</div>
</body>
</html>
