<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html" class="current">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3180579">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3180634">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3180688">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3180739">//&nbsp;Package&nbsp;parse&nbsp;builds&nbsp;parse&nbsp;trees&nbsp;for&nbsp;templates&nbsp;as&nbsp;defined&nbsp;by&nbsp;text/template</span><br>
<span class="lineno"></span><span class="comment" id="3180817">//&nbsp;and&nbsp;html/template.&nbsp;Clients&nbsp;should&nbsp;use&nbsp;those&nbsp;packages&nbsp;to&nbsp;construct&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="3180896">//&nbsp;rather&nbsp;than&nbsp;this&nbsp;one,&nbsp;which&nbsp;provides&nbsp;shared&nbsp;internal&nbsp;data&nbsp;structures&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3180972">//&nbsp;intended&nbsp;for&nbsp;general&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="3181001">package</span>&nbsp;<span class="ident" id="3181009">parse</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="3181016">import</span>&nbsp;<span class="op" id="3181023">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3181026">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3181035">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3181042">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3181053">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3181064">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3181074">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3181077">//&nbsp;Tree&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;single&nbsp;parsed&nbsp;template.</span><br>
<span class="lineno">20</span><span class="keyword" id="3181136">type</span>&nbsp;<span class="ident" id="3181141">Tree</span>&nbsp;<span class="keyword" id="3181146">struct</span>&nbsp;<span class="op" id="3181153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181156">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3181166">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3181176">//&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;represented&nbsp;by&nbsp;the&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181226">ParseName</span>&nbsp;<span class="builtintype" id="3181236">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3181246">//&nbsp;name&nbsp;of&nbsp;the&nbsp;top-level&nbsp;template&nbsp;during&nbsp;parsing,&nbsp;for&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181317">Root</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3181327">*</span><span class="ident" id="3181328"><a href="/gostd/text/template/parse/node.go.html#3162635">ListNode</a></span>&nbsp;<span class="comment" id="3181337">//&nbsp;top-level&nbsp;root&nbsp;of&nbsp;the&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181369">text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3181379">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3181389">//&nbsp;text&nbsp;parsed&nbsp;to&nbsp;create&nbsp;the&nbsp;template&nbsp;(or&nbsp;its&nbsp;parent)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3181444">//&nbsp;Parsing&nbsp;only;&nbsp;cleared&nbsp;after&nbsp;parse.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181483">funcs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3181493">[</span><span class="op" id="3181494">]</span><span class="keyword" id="3181495">map</span><span class="op" id="3181498">[</span><span class="builtintype" id="3181499">string</span><span class="op" id="3181505">]</span><span class="keyword" id="3181506">interface</span><span class="op" id="3181515">{</span><span class="op" id="3181516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181519">lex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3181529">*</span><span class="ident" id="3181530"><a href="/gostd/text/template/parse/lex.go.html#3148960">lexer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181537">token</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3181547">[</span><span class="num" id="3181548">3</span><span class="op" id="3181549">]</span><span class="ident" id="3181550"><a href="/gostd/text/template/parse/lex.go.html#3146473">item</a></span>&nbsp;<span class="comment" id="3181555">//&nbsp;three-token&nbsp;lookahead&nbsp;for&nbsp;parser.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181593">peekCount</span>&nbsp;<span class="builtintype" id="3181603">int</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181608">vars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3181618">[</span><span class="op" id="3181619">]</span><span class="builtintype" id="3181620">string</span>&nbsp;<span class="comment" id="3181627">//&nbsp;variables&nbsp;defined&nbsp;at&nbsp;the&nbsp;moment.</span><br>
<span class="lineno"></span><span class="op" id="3181663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3181666">//&nbsp;Copy&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;Tree.&nbsp;Any&nbsp;parsing&nbsp;state&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno"></span><span class="keyword" id="3181734">func</span>&nbsp;<span class="op" id="3181739">(</span><span class="ident" id="3181740">t</span>&nbsp;<span class="op" id="3181742">*</span><span class="ident" id="3181743"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3181747">)</span>&nbsp;<span class="ident" id="3181749">Copy</span><span class="op" id="3181753">(</span><span class="op" id="3181754">)</span>&nbsp;<span class="op" id="3181756">*</span><span class="ident" id="3181757"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span>&nbsp;<span class="op" id="3181762">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3181765">if</span>&nbsp;<span class="ident" id="3181768"><a href="/gostd/text/template/parse/parse.go.html#3181740">t</a></span>&nbsp;<span class="op" id="3181770">==</span>&nbsp;<span class="builtintype" id="3181773">nil</span>&nbsp;<span class="op" id="3181777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3181781">return</span>&nbsp;<span class="builtintype" id="3181788">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3181793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3181796">return</span>&nbsp;<span class="op" id="3181803">&amp;</span><span class="ident" id="3181804"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3181808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181812"><a href="/gostd/text/template/parse/parse.go.html#3181156">Name</a></span><span class="op" id="3181816">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181823"><a href="/gostd/text/template/parse/parse.go.html#3181740">t</a></span><span class="op" id="3181824">.</span><span class="ident" id="3181825"><a href="/gostd/text/template/parse/parse.go.html#3181156">Name</a></span><span class="op" id="3181829">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181833"><a href="/gostd/text/template/parse/parse.go.html#3181226">ParseName</a></span><span class="op" id="3181842">:</span>&nbsp;<span class="ident" id="3181844"><a href="/gostd/text/template/parse/parse.go.html#3181740">t</a></span><span class="op" id="3181845">.</span><span class="ident" id="3181846"><a href="/gostd/text/template/parse/parse.go.html#3181226">ParseName</a></span><span class="op" id="3181855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181859"><a href="/gostd/text/template/parse/parse.go.html#3181317">Root</a></span><span class="op" id="3181863">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181870"><a href="/gostd/text/template/parse/parse.go.html#3181740">t</a></span><span class="op" id="3181871">.</span><span class="ident" id="3181872"><a href="/gostd/text/template/parse/parse.go.html#3181317">Root</a></span><span class="op" id="3181876">.</span><span class="ident" id="3181877"><a href="/gostd/text/template/parse/node.go.html#3163111">CopyList</a></span><span class="op" id="3181885">(</span><span class="op" id="3181886">)</span><span class="op" id="3181887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181891"><a href="/gostd/text/template/parse/parse.go.html#3181369">text</a></span><span class="op" id="3181895">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3181902"><a href="/gostd/text/template/parse/parse.go.html#3181740">t</a></span><span class="op" id="3181903">.</span><span class="ident" id="3181904"><a href="/gostd/text/template/parse/parse.go.html#3181369">text</a></span><span class="op" id="3181908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3181911">}</span><br>
<span class="lineno"></span><span class="op" id="3181913">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="3181916">//&nbsp;Parse&nbsp;returns&nbsp;a&nbsp;map&nbsp;from&nbsp;template&nbsp;name&nbsp;to&nbsp;parse.Tree,&nbsp;created&nbsp;by&nbsp;parsing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3181996">//&nbsp;templates&nbsp;described&nbsp;in&nbsp;the&nbsp;argument&nbsp;string.&nbsp;The&nbsp;top-level&nbsp;template&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3182074">//&nbsp;given&nbsp;the&nbsp;specified&nbsp;name.&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;encountered,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3182152">//&nbsp;empty&nbsp;map&nbsp;is&nbsp;returned&nbsp;with&nbsp;the&nbsp;error.</span><br>
<span class="lineno">50</span><span class="keyword" id="3182193">func</span>&nbsp;<span class="ident" id="3182198">Parse</span><span class="op" id="3182203">(</span><span class="ident" id="3182204">name</span><span class="op" id="3182208">,</span>&nbsp;<span class="ident" id="3182210">text</span><span class="op" id="3182214">,</span>&nbsp;<span class="ident" id="3182216">leftDelim</span><span class="op" id="3182225">,</span>&nbsp;<span class="ident" id="3182227">rightDelim</span>&nbsp;<span class="builtintype" id="3182238">string</span><span class="op" id="3182244">,</span>&nbsp;<span class="ident" id="3182246">funcs</span>&nbsp;<span class="op" id="3182252">...</span><span class="keyword" id="3182255">map</span><span class="op" id="3182258">[</span><span class="builtintype" id="3182259">string</span><span class="op" id="3182265">]</span><span class="keyword" id="3182266">interface</span><span class="op" id="3182275">{</span><span class="op" id="3182276">}</span><span class="op" id="3182277">)</span>&nbsp;<span class="op" id="3182279">(</span><span class="ident" id="3182280">treeSet</span>&nbsp;<span class="keyword" id="3182288">map</span><span class="op" id="3182291">[</span><span class="builtintype" id="3182292">string</span><span class="op" id="3182298">]</span><span class="op" id="3182299">*</span><span class="ident" id="3182300"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3182304">,</span>&nbsp;<span class="ident" id="3182306">err</span>&nbsp;<span class="builtintype" id="3182310">error</span><span class="op" id="3182315">)</span>&nbsp;<span class="op" id="3182317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3182320"><a href="/gostd/text/template/parse/parse.go.html#3182280">treeSet</a></span>&nbsp;<span class="op" id="3182328">=</span>&nbsp;<span class="builtinfunc" id="3182330">make</span><span class="op" id="3182334">(</span><span class="keyword" id="3182335">map</span><span class="op" id="3182338">[</span><span class="builtintype" id="3182339">string</span><span class="op" id="3182345">]</span><span class="op" id="3182346">*</span><span class="ident" id="3182347"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3182351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3182354">t</span>&nbsp;<span class="op" id="3182356">:=</span>&nbsp;<span class="ident" id="3182359"><a href="/gostd/text/template/parse/parse.go.html#3183787">New</a></span><span class="op" id="3182362">(</span><span class="ident" id="3182363"><a href="/gostd/text/template/parse/parse.go.html#3182204">name</a></span><span class="op" id="3182367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3182370"><a href="/gostd/text/template/parse/parse.go.html#3182354">t</a></span><span class="op" id="3182371">.</span><span class="ident" id="3182372"><a href="/gostd/text/template/parse/parse.go.html#3181369">text</a></span>&nbsp;<span class="op" id="3182377">=</span>&nbsp;<span class="ident" id="3182379"><a href="/gostd/text/template/parse/parse.go.html#3182210">text</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3182385">_</span><span class="op" id="3182386">,</span>&nbsp;<span class="ident" id="3182388"><a href="/gostd/text/template/parse/parse.go.html#3182306">err</a></span>&nbsp;<span class="op" id="3182392">=</span>&nbsp;<span class="ident" id="3182394"><a href="/gostd/text/template/parse/parse.go.html#3182354">t</a></span><span class="op" id="3182395">.</span><span class="ident" id="3182396"><a href="/gostd/text/template/parse/parse.go.html#3186584">Parse</a></span><span class="op" id="3182401">(</span><span class="ident" id="3182402"><a href="/gostd/text/template/parse/parse.go.html#3182210">text</a></span><span class="op" id="3182406">,</span>&nbsp;<span class="ident" id="3182408"><a href="/gostd/text/template/parse/parse.go.html#3182216">leftDelim</a></span><span class="op" id="3182417">,</span>&nbsp;<span class="ident" id="3182419"><a href="/gostd/text/template/parse/parse.go.html#3182227">rightDelim</a></span><span class="op" id="3182429">,</span>&nbsp;<span class="ident" id="3182431"><a href="/gostd/text/template/parse/parse.go.html#3182280">treeSet</a></span><span class="op" id="3182438">,</span>&nbsp;<span class="ident" id="3182440"><a href="/gostd/text/template/parse/parse.go.html#3182246">funcs</a></span><span class="op" id="3182445">...</span><span class="op" id="3182448">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3182451">return</span><br>
<span class="lineno"></span><span class="op" id="3182458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3182461">//&nbsp;next&nbsp;returns&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="3182493">func</span>&nbsp;<span class="op" id="3182498">(</span><span class="ident" id="3182499">t</span>&nbsp;<span class="op" id="3182501">*</span><span class="ident" id="3182502"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3182506">)</span>&nbsp;<span class="ident" id="3182508">next</span><span class="op" id="3182512">(</span><span class="op" id="3182513">)</span>&nbsp;<span class="ident" id="3182515"><a href="/gostd/text/template/parse/lex.go.html#3146473">item</a></span>&nbsp;<span class="op" id="3182520">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3182523">if</span>&nbsp;<span class="ident" id="3182526"><a href="/gostd/text/template/parse/parse.go.html#3182499">t</a></span><span class="op" id="3182527">.</span><span class="ident" id="3182528"><a href="/gostd/text/template/parse/parse.go.html#3181593">peekCount</a></span>&nbsp;<span class="op" id="3182538">&gt;</span>&nbsp;<span class="num" id="3182540">0</span>&nbsp;<span class="op" id="3182542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3182546"><a href="/gostd/text/template/parse/parse.go.html#3182499">t</a></span><span class="op" id="3182547">.</span><span class="ident" id="3182548"><a href="/gostd/text/template/parse/parse.go.html#3181593">peekCount</a></span><span class="op" id="3182557">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3182561">}</span>&nbsp;<span class="keyword" id="3182563">else</span>&nbsp;<span class="op" id="3182568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3182572"><a href="/gostd/text/template/parse/parse.go.html#3182499">t</a></span><span class="op" id="3182573">.</span><span class="ident" id="3182574"><a href="/gostd/text/template/parse/parse.go.html#3181537">token</a></span><span class="op" id="3182579">[</span><span class="num" id="3182580">0</span><span class="op" id="3182581">]</span>&nbsp;<span class="op" id="3182583">=</span>&nbsp;<span class="ident" id="3182585"><a href="/gostd/text/template/parse/parse.go.html#3182499">t</a></span><span class="op" id="3182586">.</span><span class="ident" id="3182587"><a href="/gostd/text/template/parse/parse.go.html#3181519">lex</a></span><span class="op" id="3182590">.</span><span class="ident" id="3182591"><a href="/gostd/text/template/parse/lex.go.html#3151337">nextItem</a></span><span class="op" id="3182599">(</span><span class="op" id="3182600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3182603">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3182606">return</span>&nbsp;<span class="ident" id="3182613"><a href="/gostd/text/template/parse/parse.go.html#3182499">t</a></span><span class="op" id="3182614">.</span><span class="ident" id="3182615"><a href="/gostd/text/template/parse/parse.go.html#3181537">token</a></span><span class="op" id="3182620">[</span><span class="ident" id="3182621"><a href="/gostd/text/template/parse/parse.go.html#3182499">t</a></span><span class="op" id="3182622">.</span><span class="ident" id="3182623"><a href="/gostd/text/template/parse/parse.go.html#3181593">peekCount</a></span><span class="op" id="3182632">]</span><br>
<span class="lineno"></span><span class="op" id="3182634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3182637">//&nbsp;backup&nbsp;backs&nbsp;the&nbsp;input&nbsp;stream&nbsp;up&nbsp;one&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="3182684">func</span>&nbsp;<span class="op" id="3182689">(</span><span class="ident" id="3182690">t</span>&nbsp;<span class="op" id="3182692">*</span><span class="ident" id="3182693"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3182697">)</span>&nbsp;<span class="ident" id="3182699">backup</span><span class="op" id="3182705">(</span><span class="op" id="3182706">)</span>&nbsp;<span class="op" id="3182708">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3182711"><a href="/gostd/text/template/parse/parse.go.html#3182690">t</a></span><span class="op" id="3182712">.</span><span class="ident" id="3182713"><a href="/gostd/text/template/parse/parse.go.html#3181593">peekCount</a></span><span class="op" id="3182722">++</span><br>
<span class="lineno"></span><span class="op" id="3182725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3182728">//&nbsp;backup2&nbsp;backs&nbsp;the&nbsp;input&nbsp;stream&nbsp;up&nbsp;two&nbsp;tokens.</span><br>
<span class="lineno"></span><span class="comment" id="3182777">//&nbsp;The&nbsp;zeroth&nbsp;token&nbsp;is&nbsp;already&nbsp;there.</span><br>
<span class="lineno">75</span><span class="keyword" id="3182815">func</span>&nbsp;<span class="op" id="3182820">(</span><span class="ident" id="3182821">t</span>&nbsp;<span class="op" id="3182823">*</span><span class="ident" id="3182824"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3182828">)</span>&nbsp;<span class="ident" id="3182830">backup2</span><span class="op" id="3182837">(</span><span class="ident" id="3182838">t1</span>&nbsp;<span class="ident" id="3182841"><a href="/gostd/text/template/parse/lex.go.html#3146473">item</a></span><span class="op" id="3182845">)</span>&nbsp;<span class="op" id="3182847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3182850"><a href="/gostd/text/template/parse/parse.go.html#3182821">t</a></span><span class="op" id="3182851">.</span><span class="ident" id="3182852"><a href="/gostd/text/template/parse/parse.go.html#3181537">token</a></span><span class="op" id="3182857">[</span><span class="num" id="3182858">1</span><span class="op" id="3182859">]</span>&nbsp;<span class="op" id="3182861">=</span>&nbsp;<span class="ident" id="3182863"><a href="/gostd/text/template/parse/parse.go.html#3182838">t1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3182867"><a href="/gostd/text/template/parse/parse.go.html#3182821">t</a></span><span class="op" id="3182868">.</span><span class="ident" id="3182869"><a href="/gostd/text/template/parse/parse.go.html#3181593">peekCount</a></span>&nbsp;<span class="op" id="3182879">=</span>&nbsp;<span class="num" id="3182881">2</span><br>
<span class="lineno"></span><span class="op" id="3182883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3182886">//&nbsp;backup3&nbsp;backs&nbsp;the&nbsp;input&nbsp;stream&nbsp;up&nbsp;three&nbsp;tokens</span><br>
<span class="lineno"></span><span class="comment" id="3182936">//&nbsp;The&nbsp;zeroth&nbsp;token&nbsp;is&nbsp;already&nbsp;there.</span><br>
<span class="lineno"></span><span class="keyword" id="3182974">func</span>&nbsp;<span class="op" id="3182979">(</span><span class="ident" id="3182980">t</span>&nbsp;<span class="op" id="3182982">*</span><span class="ident" id="3182983"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3182987">)</span>&nbsp;<span class="ident" id="3182989">backup3</span><span class="op" id="3182996">(</span><span class="ident" id="3182997">t2</span><span class="op" id="3182999">,</span>&nbsp;<span class="ident" id="3183001">t1</span>&nbsp;<span class="ident" id="3183004"><a href="/gostd/text/template/parse/lex.go.html#3146473">item</a></span><span class="op" id="3183008">)</span>&nbsp;<span class="op" id="3183010">{</span>&nbsp;<span class="comment" id="3183012">//&nbsp;Reverse&nbsp;order:&nbsp;we&#39;re&nbsp;pushing&nbsp;back.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183051"><a href="/gostd/text/template/parse/parse.go.html#3182980">t</a></span><span class="op" id="3183052">.</span><span class="ident" id="3183053"><a href="/gostd/text/template/parse/parse.go.html#3181537">token</a></span><span class="op" id="3183058">[</span><span class="num" id="3183059">1</span><span class="op" id="3183060">]</span>&nbsp;<span class="op" id="3183062">=</span>&nbsp;<span class="ident" id="3183064"><a href="/gostd/text/template/parse/parse.go.html#3183001">t1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183068"><a href="/gostd/text/template/parse/parse.go.html#3182980">t</a></span><span class="op" id="3183069">.</span><span class="ident" id="3183070"><a href="/gostd/text/template/parse/parse.go.html#3181537">token</a></span><span class="op" id="3183075">[</span><span class="num" id="3183076">2</span><span class="op" id="3183077">]</span>&nbsp;<span class="op" id="3183079">=</span>&nbsp;<span class="ident" id="3183081"><a href="/gostd/text/template/parse/parse.go.html#3182997">t2</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183085"><a href="/gostd/text/template/parse/parse.go.html#3182980">t</a></span><span class="op" id="3183086">.</span><span class="ident" id="3183087"><a href="/gostd/text/template/parse/parse.go.html#3181593">peekCount</a></span>&nbsp;<span class="op" id="3183097">=</span>&nbsp;<span class="num" id="3183099">3</span><br>
<span class="lineno"></span><span class="op" id="3183101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3183104">//&nbsp;peek&nbsp;returns&nbsp;but&nbsp;does&nbsp;not&nbsp;consume&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="3183157">func</span>&nbsp;<span class="op" id="3183162">(</span><span class="ident" id="3183163">t</span>&nbsp;<span class="op" id="3183165">*</span><span class="ident" id="3183166"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3183170">)</span>&nbsp;<span class="ident" id="3183172">peek</span><span class="op" id="3183176">(</span><span class="op" id="3183177">)</span>&nbsp;<span class="ident" id="3183179"><a href="/gostd/text/template/parse/lex.go.html#3146473">item</a></span>&nbsp;<span class="op" id="3183184">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3183187">if</span>&nbsp;<span class="ident" id="3183190"><a href="/gostd/text/template/parse/parse.go.html#3183163">t</a></span><span class="op" id="3183191">.</span><span class="ident" id="3183192"><a href="/gostd/text/template/parse/parse.go.html#3181593">peekCount</a></span>&nbsp;<span class="op" id="3183202">&gt;</span>&nbsp;<span class="num" id="3183204">0</span>&nbsp;<span class="op" id="3183206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3183210">return</span>&nbsp;<span class="ident" id="3183217"><a href="/gostd/text/template/parse/parse.go.html#3183163">t</a></span><span class="op" id="3183218">.</span><span class="ident" id="3183219"><a href="/gostd/text/template/parse/parse.go.html#3181537">token</a></span><span class="op" id="3183224">[</span><span class="ident" id="3183225"><a href="/gostd/text/template/parse/parse.go.html#3183163">t</a></span><span class="op" id="3183226">.</span><span class="ident" id="3183227"><a href="/gostd/text/template/parse/parse.go.html#3181593">peekCount</a></span><span class="op" id="3183236">-</span><span class="num" id="3183237">1</span><span class="op" id="3183238">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3183241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183244"><a href="/gostd/text/template/parse/parse.go.html#3183163">t</a></span><span class="op" id="3183245">.</span><span class="ident" id="3183246"><a href="/gostd/text/template/parse/parse.go.html#3181593">peekCount</a></span>&nbsp;<span class="op" id="3183256">=</span>&nbsp;<span class="num" id="3183258">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183261"><a href="/gostd/text/template/parse/parse.go.html#3183163">t</a></span><span class="op" id="3183262">.</span><span class="ident" id="3183263"><a href="/gostd/text/template/parse/parse.go.html#3181537">token</a></span><span class="op" id="3183268">[</span><span class="num" id="3183269">0</span><span class="op" id="3183270">]</span>&nbsp;<span class="op" id="3183272">=</span>&nbsp;<span class="ident" id="3183274"><a href="/gostd/text/template/parse/parse.go.html#3183163">t</a></span><span class="op" id="3183275">.</span><span class="ident" id="3183276"><a href="/gostd/text/template/parse/parse.go.html#3181519">lex</a></span><span class="op" id="3183279">.</span><span class="ident" id="3183280"><a href="/gostd/text/template/parse/lex.go.html#3151337">nextItem</a></span><span class="op" id="3183288">(</span><span class="op" id="3183289">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3183292">return</span>&nbsp;<span class="ident" id="3183299"><a href="/gostd/text/template/parse/parse.go.html#3183163">t</a></span><span class="op" id="3183300">.</span><span class="ident" id="3183301"><a href="/gostd/text/template/parse/parse.go.html#3181537">token</a></span><span class="op" id="3183306">[</span><span class="num" id="3183307">0</span><span class="op" id="3183308">]</span><br>
<span class="lineno"></span><span class="op" id="3183310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3183313">//&nbsp;nextNonSpace&nbsp;returns&nbsp;the&nbsp;next&nbsp;non-space&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="3183363">func</span>&nbsp;<span class="op" id="3183368">(</span><span class="ident" id="3183369">t</span>&nbsp;<span class="op" id="3183371">*</span><span class="ident" id="3183372"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3183376">)</span>&nbsp;<span class="ident" id="3183378">nextNonSpace</span><span class="op" id="3183390">(</span><span class="op" id="3183391">)</span>&nbsp;<span class="op" id="3183393">(</span><span class="ident" id="3183394">token</span>&nbsp;<span class="ident" id="3183400"><a href="/gostd/text/template/parse/lex.go.html#3146473">item</a></span><span class="op" id="3183404">)</span>&nbsp;<span class="op" id="3183406">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3183409">for</span>&nbsp;<span class="op" id="3183413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183417"><a href="/gostd/text/template/parse/parse.go.html#3183394">token</a></span>&nbsp;<span class="op" id="3183423">=</span>&nbsp;<span class="ident" id="3183425"><a href="/gostd/text/template/parse/parse.go.html#3183369">t</a></span><span class="op" id="3183426">.</span><span class="ident" id="3183427"><a href="/gostd/text/template/parse/parse.go.html#3182508">next</a></span><span class="op" id="3183431">(</span><span class="op" id="3183432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3183436">if</span>&nbsp;<span class="ident" id="3183439"><a href="/gostd/text/template/parse/parse.go.html#3183394">token</a></span><span class="op" id="3183444">.</span><span class="ident" id="3183445"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3183449">!=</span>&nbsp;<span class="ident" id="3183452"><a href="/gostd/text/template/parse/lex.go.html#3147894">itemSpace</a></span>&nbsp;<span class="op" id="3183462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3183467">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3183475">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3183478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3183481">return</span>&nbsp;<span class="ident" id="3183488"><a href="/gostd/text/template/parse/parse.go.html#3183394">token</a></span><br>
<span class="lineno"></span><span class="op" id="3183494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3183497">//&nbsp;peekNonSpace&nbsp;returns&nbsp;but&nbsp;does&nbsp;not&nbsp;consume&nbsp;the&nbsp;next&nbsp;non-space&nbsp;token.</span><br>
<span class="lineno">110</span><span class="keyword" id="3183568">func</span>&nbsp;<span class="op" id="3183573">(</span><span class="ident" id="3183574">t</span>&nbsp;<span class="op" id="3183576">*</span><span class="ident" id="3183577"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3183581">)</span>&nbsp;<span class="ident" id="3183583">peekNonSpace</span><span class="op" id="3183595">(</span><span class="op" id="3183596">)</span>&nbsp;<span class="op" id="3183598">(</span><span class="ident" id="3183599">token</span>&nbsp;<span class="ident" id="3183605"><a href="/gostd/text/template/parse/lex.go.html#3146473">item</a></span><span class="op" id="3183609">)</span>&nbsp;<span class="op" id="3183611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3183614">for</span>&nbsp;<span class="op" id="3183618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183622"><a href="/gostd/text/template/parse/parse.go.html#3183599">token</a></span>&nbsp;<span class="op" id="3183628">=</span>&nbsp;<span class="ident" id="3183630"><a href="/gostd/text/template/parse/parse.go.html#3183574">t</a></span><span class="op" id="3183631">.</span><span class="ident" id="3183632"><a href="/gostd/text/template/parse/parse.go.html#3182508">next</a></span><span class="op" id="3183636">(</span><span class="op" id="3183637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3183641">if</span>&nbsp;<span class="ident" id="3183644"><a href="/gostd/text/template/parse/parse.go.html#3183599">token</a></span><span class="op" id="3183649">.</span><span class="ident" id="3183650"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3183654">!=</span>&nbsp;<span class="ident" id="3183657"><a href="/gostd/text/template/parse/lex.go.html#3147894">itemSpace</a></span>&nbsp;<span class="op" id="3183667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3183672">break</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3183680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3183683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183686"><a href="/gostd/text/template/parse/parse.go.html#3183574">t</a></span><span class="op" id="3183687">.</span><span class="ident" id="3183688"><a href="/gostd/text/template/parse/parse.go.html#3182699">backup</a></span><span class="op" id="3183694">(</span><span class="op" id="3183695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3183698">return</span>&nbsp;<span class="ident" id="3183705"><a href="/gostd/text/template/parse/parse.go.html#3183599">token</a></span><br>
<span class="lineno"></span><span class="op" id="3183711">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="3183714">//&nbsp;Parsing.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3183727">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3183782">func</span>&nbsp;<span class="ident" id="3183787">New</span><span class="op" id="3183790">(</span><span class="ident" id="3183791">name</span>&nbsp;<span class="builtintype" id="3183796">string</span><span class="op" id="3183802">,</span>&nbsp;<span class="ident" id="3183804">funcs</span>&nbsp;<span class="op" id="3183810">...</span><span class="keyword" id="3183813">map</span><span class="op" id="3183816">[</span><span class="builtintype" id="3183817">string</span><span class="op" id="3183823">]</span><span class="keyword" id="3183824">interface</span><span class="op" id="3183833">{</span><span class="op" id="3183834">}</span><span class="op" id="3183835">)</span>&nbsp;<span class="op" id="3183837">*</span><span class="ident" id="3183838"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span>&nbsp;<span class="op" id="3183843">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3183846">return</span>&nbsp;<span class="op" id="3183853">&amp;</span><span class="ident" id="3183854"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3183858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183862"><a href="/gostd/text/template/parse/parse.go.html#3181156">Name</a></span><span class="op" id="3183866">:</span>&nbsp;&nbsp;<span class="ident" id="3183869"><a href="/gostd/text/template/parse/parse.go.html#3183791">name</a></span><span class="op" id="3183873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3183877"><a href="/gostd/text/template/parse/parse.go.html#3181483">funcs</a></span><span class="op" id="3183882">:</span>&nbsp;<span class="ident" id="3183884"><a href="/gostd/text/template/parse/parse.go.html#3183804">funcs</a></span><span class="op" id="3183889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3183892">}</span><br>
<span class="lineno"></span><span class="op" id="3183894">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="3183897">//&nbsp;ErrorContext&nbsp;returns&nbsp;a&nbsp;textual&nbsp;representation&nbsp;of&nbsp;the&nbsp;location&nbsp;of&nbsp;the&nbsp;node&nbsp;in&nbsp;the&nbsp;input&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="3183993">//&nbsp;The&nbsp;receiver&nbsp;is&nbsp;only&nbsp;used&nbsp;when&nbsp;the&nbsp;node&nbsp;does&nbsp;not&nbsp;have&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;tree&nbsp;inside,</span><br>
<span class="lineno"></span><span class="comment" id="3184080">//&nbsp;which&nbsp;can&nbsp;occur&nbsp;in&nbsp;old&nbsp;code.</span><br>
<span class="lineno"></span><span class="keyword" id="3184112">func</span>&nbsp;<span class="op" id="3184117">(</span><span class="ident" id="3184118">t</span>&nbsp;<span class="op" id="3184120">*</span><span class="ident" id="3184121"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3184125">)</span>&nbsp;<span class="ident" id="3184127">ErrorContext</span><span class="op" id="3184139">(</span><span class="ident" id="3184140">n</span>&nbsp;<span class="ident" id="3184142"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span><span class="op" id="3184146">)</span>&nbsp;<span class="op" id="3184148">(</span><span class="ident" id="3184149">location</span><span class="op" id="3184157">,</span>&nbsp;<span class="ident" id="3184159">context</span>&nbsp;<span class="builtintype" id="3184167">string</span><span class="op" id="3184173">)</span>&nbsp;<span class="op" id="3184175">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184178">pos</span>&nbsp;<span class="op" id="3184182">:=</span>&nbsp;<span class="builtintype" id="3184185">int</span><span class="op" id="3184188">(</span><span class="ident" id="3184189"><a href="/gostd/text/template/parse/parse.go.html#3184140">n</a></span><span class="op" id="3184190">.</span><span class="ident" id="3184191"><a href="/gostd/text/template/parse/node.go.html#3160769">Position</a></span><span class="op" id="3184199">(</span><span class="op" id="3184200">)</span><span class="op" id="3184201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184204">tree</span>&nbsp;<span class="op" id="3184209">:=</span>&nbsp;<span class="ident" id="3184212"><a href="/gostd/text/template/parse/parse.go.html#3184140">n</a></span><span class="op" id="3184213">.</span><span class="ident" id="3184214"><a href="/gostd/text/template/parse/node.go.html#3160961">tree</a></span><span class="op" id="3184218">(</span><span class="op" id="3184219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3184222">if</span>&nbsp;<span class="ident" id="3184225"><a href="/gostd/text/template/parse/parse.go.html#3184204">tree</a></span>&nbsp;<span class="op" id="3184230">==</span>&nbsp;<span class="builtintype" id="3184233">nil</span>&nbsp;<span class="op" id="3184237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184241"><a href="/gostd/text/template/parse/parse.go.html#3184204">tree</a></span>&nbsp;<span class="op" id="3184246">=</span>&nbsp;<span class="ident" id="3184248"><a href="/gostd/text/template/parse/parse.go.html#3184118">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3184251">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184254">text</span>&nbsp;<span class="op" id="3184259">:=</span>&nbsp;<span class="ident" id="3184262"><a href="/gostd/text/template/parse/parse.go.html#3184204">tree</a></span><span class="op" id="3184266">.</span><span class="ident" id="3184267"><a href="/gostd/text/template/parse/parse.go.html#3181369">text</a></span><span class="op" id="3184271">[</span><span class="op" id="3184272">:</span><span class="ident" id="3184273"><a href="/gostd/text/template/parse/parse.go.html#3184178">pos</a></span><span class="op" id="3184276">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184279">byteNum</span>&nbsp;<span class="op" id="3184287">:=</span>&nbsp;<span class="ident" id="3184290"><a href="/gostd/text/template/parse/parse.go.html#3181064">strings</a></span><span class="op" id="3184297">.</span><span class="ident" id="3184298"><a href="/gostd/strings/strings.go.html#2969551">LastIndex</a></span><span class="op" id="3184307">(</span><span class="ident" id="3184308"><a href="/gostd/text/template/parse/parse.go.html#3184254">text</a></span><span class="op" id="3184312">,</span>&nbsp;<span class="string" id="3184314">&#34;\n&#34;</span><span class="op" id="3184318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3184321">if</span>&nbsp;<span class="ident" id="3184324"><a href="/gostd/text/template/parse/parse.go.html#3184279">byteNum</a></span>&nbsp;<span class="op" id="3184332">==</span>&nbsp;<span class="op" id="3184335">-</span><span class="num" id="3184336">1</span>&nbsp;<span class="op" id="3184338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184342"><a href="/gostd/text/template/parse/parse.go.html#3184279">byteNum</a></span>&nbsp;<span class="op" id="3184350">=</span>&nbsp;<span class="ident" id="3184352"><a href="/gostd/text/template/parse/parse.go.html#3184178">pos</a></span>&nbsp;<span class="comment" id="3184356">//&nbsp;On&nbsp;first&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3184375">}</span>&nbsp;<span class="keyword" id="3184377">else</span>&nbsp;<span class="op" id="3184382">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184386"><a href="/gostd/text/template/parse/parse.go.html#3184279">byteNum</a></span><span class="op" id="3184393">++</span>&nbsp;<span class="comment" id="3184396">//&nbsp;After&nbsp;the&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184420"><a href="/gostd/text/template/parse/parse.go.html#3184279">byteNum</a></span>&nbsp;<span class="op" id="3184428">=</span>&nbsp;<span class="ident" id="3184430"><a href="/gostd/text/template/parse/parse.go.html#3184178">pos</a></span>&nbsp;<span class="op" id="3184434">-</span>&nbsp;<span class="ident" id="3184436"><a href="/gostd/text/template/parse/parse.go.html#3184279">byteNum</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3184445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184448">lineNum</span>&nbsp;<span class="op" id="3184456">:=</span>&nbsp;<span class="num" id="3184459">1</span>&nbsp;<span class="op" id="3184461">+</span>&nbsp;<span class="ident" id="3184463"><a href="/gostd/text/template/parse/parse.go.html#3181064">strings</a></span><span class="op" id="3184470">.</span><span class="ident" id="3184471"><a href="/gostd/strings/strings.go.html#2967531">Count</a></span><span class="op" id="3184476">(</span><span class="ident" id="3184477"><a href="/gostd/text/template/parse/parse.go.html#3184254">text</a></span><span class="op" id="3184481">,</span>&nbsp;<span class="string" id="3184483">&#34;\n&#34;</span><span class="op" id="3184487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184490"><a href="/gostd/text/template/parse/parse.go.html#3184159">context</a></span>&nbsp;<span class="op" id="3184498">=</span>&nbsp;<span class="ident" id="3184500"><a href="/gostd/text/template/parse/parse.go.html#3184140">n</a></span><span class="op" id="3184501">.</span><span class="ident" id="3184502"><a href="/gostd/text/template/parse/node.go.html#3160569">String</a></span><span class="op" id="3184508">(</span><span class="op" id="3184509">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3184512">if</span>&nbsp;<span class="builtinfunc" id="3184515">len</span><span class="op" id="3184518">(</span><span class="ident" id="3184519"><a href="/gostd/text/template/parse/parse.go.html#3184159">context</a></span><span class="op" id="3184526">)</span>&nbsp;<span class="op" id="3184528">&gt;</span>&nbsp;<span class="num" id="3184530">20</span>&nbsp;<span class="op" id="3184533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184537"><a href="/gostd/text/template/parse/parse.go.html#3184159">context</a></span>&nbsp;<span class="op" id="3184545">=</span>&nbsp;<span class="ident" id="3184547"><a href="/gostd/text/template/parse/parse.go.html#3181035">fmt</a></span><span class="op" id="3184550">.</span><span class="ident" id="3184551"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="3184558">(</span><span class="string" id="3184559">&#34;%.20s...&#34;</span><span class="op" id="3184569">,</span>&nbsp;<span class="ident" id="3184571"><a href="/gostd/text/template/parse/parse.go.html#3184159">context</a></span><span class="op" id="3184578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3184581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3184584">return</span>&nbsp;<span class="ident" id="3184591"><a href="/gostd/text/template/parse/parse.go.html#3181035">fmt</a></span><span class="op" id="3184594">.</span><span class="ident" id="3184595"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="3184602">(</span><span class="string" id="3184603">&#34;%s:%d:%d&#34;</span><span class="op" id="3184613">,</span>&nbsp;<span class="ident" id="3184615"><a href="/gostd/text/template/parse/parse.go.html#3184204">tree</a></span><span class="op" id="3184619">.</span><span class="ident" id="3184620"><a href="/gostd/text/template/parse/parse.go.html#3181226">ParseName</a></span><span class="op" id="3184629">,</span>&nbsp;<span class="ident" id="3184631"><a href="/gostd/text/template/parse/parse.go.html#3184448">lineNum</a></span><span class="op" id="3184638">,</span>&nbsp;<span class="ident" id="3184640"><a href="/gostd/text/template/parse/parse.go.html#3184279">byteNum</a></span><span class="op" id="3184647">)</span><span class="op" id="3184648">,</span>&nbsp;<span class="ident" id="3184650"><a href="/gostd/text/template/parse/parse.go.html#3184159">context</a></span><br>
<span class="lineno"></span><span class="op" id="3184658">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="3184661">//&nbsp;errorf&nbsp;formats&nbsp;the&nbsp;error&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="3184716">func</span>&nbsp;<span class="op" id="3184721">(</span><span class="ident" id="3184722">t</span>&nbsp;<span class="op" id="3184724">*</span><span class="ident" id="3184725"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3184729">)</span>&nbsp;<span class="ident" id="3184731">errorf</span><span class="op" id="3184737">(</span><span class="ident" id="3184738">format</span>&nbsp;<span class="builtintype" id="3184745">string</span><span class="op" id="3184751">,</span>&nbsp;<span class="ident" id="3184753">args</span>&nbsp;<span class="op" id="3184758">...</span><span class="keyword" id="3184761">interface</span><span class="op" id="3184770">{</span><span class="op" id="3184771">}</span><span class="op" id="3184772">)</span>&nbsp;<span class="op" id="3184774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184777"><a href="/gostd/text/template/parse/parse.go.html#3184722">t</a></span><span class="op" id="3184778">.</span><span class="ident" id="3184779"><a href="/gostd/text/template/parse/parse.go.html#3181317">Root</a></span>&nbsp;<span class="op" id="3184784">=</span>&nbsp;<span class="builtintype" id="3184786">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184791"><a href="/gostd/text/template/parse/parse.go.html#3184738">format</a></span>&nbsp;<span class="op" id="3184798">=</span>&nbsp;<span class="ident" id="3184800"><a href="/gostd/text/template/parse/parse.go.html#3181035">fmt</a></span><span class="op" id="3184803">.</span><span class="ident" id="3184804"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="3184811">(</span><span class="string" id="3184812">&#34;template:&nbsp;%s:%d:&nbsp;%s&#34;</span><span class="op" id="3184833">,</span>&nbsp;<span class="ident" id="3184835"><a href="/gostd/text/template/parse/parse.go.html#3184722">t</a></span><span class="op" id="3184836">.</span><span class="ident" id="3184837"><a href="/gostd/text/template/parse/parse.go.html#3181226">ParseName</a></span><span class="op" id="3184846">,</span>&nbsp;<span class="ident" id="3184848"><a href="/gostd/text/template/parse/parse.go.html#3184722">t</a></span><span class="op" id="3184849">.</span><span class="ident" id="3184850"><a href="/gostd/text/template/parse/parse.go.html#3181519">lex</a></span><span class="op" id="3184853">.</span><span class="ident" id="3184854"><a href="/gostd/text/template/parse/lex.go.html#3150902">lineNumber</a></span><span class="op" id="3184864">(</span><span class="op" id="3184865">)</span><span class="op" id="3184866">,</span>&nbsp;<span class="ident" id="3184868"><a href="/gostd/text/template/parse/parse.go.html#3184738">format</a></span><span class="op" id="3184874">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3184877">panic</span><span class="op" id="3184882">(</span><span class="ident" id="3184883"><a href="/gostd/text/template/parse/parse.go.html#3181035">fmt</a></span><span class="op" id="3184886">.</span><span class="ident" id="3184887"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="3184893">(</span><span class="ident" id="3184894"><a href="/gostd/text/template/parse/parse.go.html#3184738">format</a></span><span class="op" id="3184900">,</span>&nbsp;<span class="ident" id="3184902"><a href="/gostd/text/template/parse/parse.go.html#3184753">args</a></span><span class="op" id="3184906">...</span><span class="op" id="3184909">)</span><span class="op" id="3184910">)</span><br>
<span class="lineno"></span><span class="op" id="3184912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3184915">//&nbsp;error&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="3184947">func</span>&nbsp;<span class="op" id="3184952">(</span><span class="ident" id="3184953">t</span>&nbsp;<span class="op" id="3184955">*</span><span class="ident" id="3184956"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3184960">)</span>&nbsp;<span class="builtintype" id="3184962">error</span><span class="op" id="3184967">(</span><span class="ident" id="3184968">err</span>&nbsp;<span class="builtintype" id="3184972">error</span><span class="op" id="3184977">)</span>&nbsp;<span class="op" id="3184979">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3184982"><a href="/gostd/text/template/parse/parse.go.html#3184953">t</a></span><span class="op" id="3184983">.</span><span class="ident" id="3184984"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3184990">(</span><span class="string" id="3184991">&#34;%s&#34;</span><span class="op" id="3184995">,</span>&nbsp;<span class="ident" id="3184997"><a href="/gostd/text/template/parse/parse.go.html#3184968">err</a></span><span class="op" id="3185000">)</span><br>
<span class="lineno"></span><span class="op" id="3185002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3185005">//&nbsp;expect&nbsp;consumes&nbsp;the&nbsp;next&nbsp;token&nbsp;and&nbsp;guarantees&nbsp;it&nbsp;has&nbsp;the&nbsp;required&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3185080">func</span>&nbsp;<span class="op" id="3185085">(</span><span class="ident" id="3185086">t</span>&nbsp;<span class="op" id="3185088">*</span><span class="ident" id="3185089"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3185093">)</span>&nbsp;<span class="ident" id="3185095">expect</span><span class="op" id="3185101">(</span><span class="ident" id="3185102">expected</span>&nbsp;<span class="ident" id="3185111"><a href="/gostd/text/template/parse/lex.go.html#3146993">itemType</a></span><span class="op" id="3185119">,</span>&nbsp;<span class="ident" id="3185121">context</span>&nbsp;<span class="builtintype" id="3185129">string</span><span class="op" id="3185135">)</span>&nbsp;<span class="ident" id="3185137"><a href="/gostd/text/template/parse/lex.go.html#3146473">item</a></span>&nbsp;<span class="op" id="3185142">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185145">token</span>&nbsp;<span class="op" id="3185151">:=</span>&nbsp;<span class="ident" id="3185154"><a href="/gostd/text/template/parse/parse.go.html#3185086">t</a></span><span class="op" id="3185155">.</span><span class="ident" id="3185156"><a href="/gostd/text/template/parse/parse.go.html#3183378">nextNonSpace</a></span><span class="op" id="3185168">(</span><span class="op" id="3185169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185172">if</span>&nbsp;<span class="ident" id="3185175"><a href="/gostd/text/template/parse/parse.go.html#3185145">token</a></span><span class="op" id="3185180">.</span><span class="ident" id="3185181"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3185185">!=</span>&nbsp;<span class="ident" id="3185188"><a href="/gostd/text/template/parse/parse.go.html#3185102">expected</a></span>&nbsp;<span class="op" id="3185197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185201"><a href="/gostd/text/template/parse/parse.go.html#3185086">t</a></span><span class="op" id="3185202">.</span><span class="ident" id="3185203"><a href="/gostd/text/template/parse/parse.go.html#3185634">unexpected</a></span><span class="op" id="3185213">(</span><span class="ident" id="3185214"><a href="/gostd/text/template/parse/parse.go.html#3185145">token</a></span><span class="op" id="3185219">,</span>&nbsp;<span class="ident" id="3185221"><a href="/gostd/text/template/parse/parse.go.html#3185121">context</a></span><span class="op" id="3185228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185234">return</span>&nbsp;<span class="ident" id="3185241"><a href="/gostd/text/template/parse/parse.go.html#3185145">token</a></span><br>
<span class="lineno">175</span><span class="op" id="3185247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3185250">//&nbsp;expectOneOf&nbsp;consumes&nbsp;the&nbsp;next&nbsp;token&nbsp;and&nbsp;guarantees&nbsp;it&nbsp;has&nbsp;one&nbsp;of&nbsp;the&nbsp;required&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="3185338">func</span>&nbsp;<span class="op" id="3185343">(</span><span class="ident" id="3185344">t</span>&nbsp;<span class="op" id="3185346">*</span><span class="ident" id="3185347"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3185351">)</span>&nbsp;<span class="ident" id="3185353">expectOneOf</span><span class="op" id="3185364">(</span><span class="ident" id="3185365">expected1</span><span class="op" id="3185374">,</span>&nbsp;<span class="ident" id="3185376">expected2</span>&nbsp;<span class="ident" id="3185386"><a href="/gostd/text/template/parse/lex.go.html#3146993">itemType</a></span><span class="op" id="3185394">,</span>&nbsp;<span class="ident" id="3185396">context</span>&nbsp;<span class="builtintype" id="3185404">string</span><span class="op" id="3185410">)</span>&nbsp;<span class="ident" id="3185412"><a href="/gostd/text/template/parse/lex.go.html#3146473">item</a></span>&nbsp;<span class="op" id="3185417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185420">token</span>&nbsp;<span class="op" id="3185426">:=</span>&nbsp;<span class="ident" id="3185429"><a href="/gostd/text/template/parse/parse.go.html#3185344">t</a></span><span class="op" id="3185430">.</span><span class="ident" id="3185431"><a href="/gostd/text/template/parse/parse.go.html#3183378">nextNonSpace</a></span><span class="op" id="3185443">(</span><span class="op" id="3185444">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185447">if</span>&nbsp;<span class="ident" id="3185450"><a href="/gostd/text/template/parse/parse.go.html#3185420">token</a></span><span class="op" id="3185455">.</span><span class="ident" id="3185456"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3185460">!=</span>&nbsp;<span class="ident" id="3185463"><a href="/gostd/text/template/parse/parse.go.html#3185365">expected1</a></span>&nbsp;<span class="op" id="3185473">&amp;&amp;</span>&nbsp;<span class="ident" id="3185476"><a href="/gostd/text/template/parse/parse.go.html#3185420">token</a></span><span class="op" id="3185481">.</span><span class="ident" id="3185482"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3185486">!=</span>&nbsp;<span class="ident" id="3185489"><a href="/gostd/text/template/parse/parse.go.html#3185376">expected2</a></span>&nbsp;<span class="op" id="3185499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185503"><a href="/gostd/text/template/parse/parse.go.html#3185344">t</a></span><span class="op" id="3185504">.</span><span class="ident" id="3185505"><a href="/gostd/text/template/parse/parse.go.html#3185634">unexpected</a></span><span class="op" id="3185515">(</span><span class="ident" id="3185516"><a href="/gostd/text/template/parse/parse.go.html#3185420">token</a></span><span class="op" id="3185521">,</span>&nbsp;<span class="ident" id="3185523"><a href="/gostd/text/template/parse/parse.go.html#3185396">context</a></span><span class="op" id="3185530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185536">return</span>&nbsp;<span class="ident" id="3185543"><a href="/gostd/text/template/parse/parse.go.html#3185420">token</a></span><br>
<span class="lineno"></span><span class="op" id="3185549">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="comment" id="3185552">//&nbsp;unexpected&nbsp;complains&nbsp;about&nbsp;the&nbsp;token&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="3185619">func</span>&nbsp;<span class="op" id="3185624">(</span><span class="ident" id="3185625">t</span>&nbsp;<span class="op" id="3185627">*</span><span class="ident" id="3185628"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3185632">)</span>&nbsp;<span class="ident" id="3185634">unexpected</span><span class="op" id="3185644">(</span><span class="ident" id="3185645">token</span>&nbsp;<span class="ident" id="3185651"><a href="/gostd/text/template/parse/lex.go.html#3146473">item</a></span><span class="op" id="3185655">,</span>&nbsp;<span class="ident" id="3185657">context</span>&nbsp;<span class="builtintype" id="3185665">string</span><span class="op" id="3185671">)</span>&nbsp;<span class="op" id="3185673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185676"><a href="/gostd/text/template/parse/parse.go.html#3185625">t</a></span><span class="op" id="3185677">.</span><span class="ident" id="3185678"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3185684">(</span><span class="string" id="3185685">&#34;unexpected&nbsp;%s&nbsp;in&nbsp;%s&#34;</span><span class="op" id="3185706">,</span>&nbsp;<span class="ident" id="3185708"><a href="/gostd/text/template/parse/parse.go.html#3185645">token</a></span><span class="op" id="3185713">,</span>&nbsp;<span class="ident" id="3185715"><a href="/gostd/text/template/parse/parse.go.html#3185657">context</a></span><span class="op" id="3185722">)</span><br>
<span class="lineno"></span><span class="op" id="3185724">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="3185727">//&nbsp;recover&nbsp;is&nbsp;the&nbsp;handler&nbsp;that&nbsp;turns&nbsp;panics&nbsp;into&nbsp;returns&nbsp;from&nbsp;the&nbsp;top&nbsp;level&nbsp;of&nbsp;Parse.</span><br>
<span class="lineno"></span><span class="keyword" id="3185813">func</span>&nbsp;<span class="op" id="3185818">(</span><span class="ident" id="3185819">t</span>&nbsp;<span class="op" id="3185821">*</span><span class="ident" id="3185822"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3185826">)</span>&nbsp;<span class="builtinfunc" id="3185828">recover</span><span class="op" id="3185835">(</span><span class="ident" id="3185836">errp</span>&nbsp;<span class="op" id="3185841">*</span><span class="builtintype" id="3185842">error</span><span class="op" id="3185847">)</span>&nbsp;<span class="op" id="3185849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185852">e</span>&nbsp;<span class="op" id="3185854">:=</span>&nbsp;<span class="builtinfunc" id="3185857">recover</span><span class="op" id="3185864">(</span><span class="op" id="3185865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185868">if</span>&nbsp;<span class="ident" id="3185871"><a href="/gostd/text/template/parse/parse.go.html#3185852">e</a></span>&nbsp;<span class="op" id="3185873">!=</span>&nbsp;<span class="builtintype" id="3185876">nil</span>&nbsp;<span class="op" id="3185880">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185884">if</span>&nbsp;<span class="ident" id="3185887">_</span><span class="op" id="3185888">,</span>&nbsp;<span class="ident" id="3185890">ok</span>&nbsp;<span class="op" id="3185893">:=</span>&nbsp;<span class="ident" id="3185896"><a href="/gostd/text/template/parse/parse.go.html#3185852">e</a></span><span class="op" id="3185897">.</span><span class="op" id="3185898">(</span><span class="ident" id="3185899"><a href="/gostd/text/template/parse/parse.go.html#3181042">runtime</a></span><span class="op" id="3185906">.</span><span class="ident" id="3185907"><a href="/gostd/runtime/error.go.html#1524079">Error</a></span><span class="op" id="3185912">)</span><span class="op" id="3185913">;</span>&nbsp;<span class="ident" id="3185915"><a href="/gostd/text/template/parse/parse.go.html#3185890">ok</a></span>&nbsp;<span class="op" id="3185918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3185923">panic</span><span class="op" id="3185928">(</span><span class="ident" id="3185929"><a href="/gostd/text/template/parse/parse.go.html#3185852">e</a></span><span class="op" id="3185930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185938">if</span>&nbsp;<span class="ident" id="3185941"><a href="/gostd/text/template/parse/parse.go.html#3185819">t</a></span>&nbsp;<span class="op" id="3185943">!=</span>&nbsp;<span class="builtintype" id="3185946">nil</span>&nbsp;<span class="op" id="3185950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3185955"><a href="/gostd/text/template/parse/parse.go.html#3185819">t</a></span><span class="op" id="3185956">.</span><span class="ident" id="3185957"><a href="/gostd/text/template/parse/parse.go.html#3186253">stopParse</a></span><span class="op" id="3185966">(</span><span class="op" id="3185967">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185975">*</span><span class="ident" id="3185976"><a href="/gostd/text/template/parse/parse.go.html#3185836">errp</a></span>&nbsp;<span class="op" id="3185981">=</span>&nbsp;<span class="ident" id="3185983"><a href="/gostd/text/template/parse/parse.go.html#3185852">e</a></span><span class="op" id="3185984">.</span><span class="op" id="3185985">(</span><span class="builtintype" id="3185986">error</span><span class="op" id="3185991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3185994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3185997">return</span><br>
<span class="lineno"></span><span class="op" id="3186004">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="3186007">//&nbsp;startParse&nbsp;initializes&nbsp;the&nbsp;parser,&nbsp;using&nbsp;the&nbsp;lexer.</span><br>
<span class="lineno"></span><span class="keyword" id="3186062">func</span>&nbsp;<span class="op" id="3186067">(</span><span class="ident" id="3186068">t</span>&nbsp;<span class="op" id="3186070">*</span><span class="ident" id="3186071"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3186075">)</span>&nbsp;<span class="ident" id="3186077">startParse</span><span class="op" id="3186087">(</span><span class="ident" id="3186088">funcs</span>&nbsp;<span class="op" id="3186094">[</span><span class="op" id="3186095">]</span><span class="keyword" id="3186096">map</span><span class="op" id="3186099">[</span><span class="builtintype" id="3186100">string</span><span class="op" id="3186106">]</span><span class="keyword" id="3186107">interface</span><span class="op" id="3186116">{</span><span class="op" id="3186117">}</span><span class="op" id="3186118">,</span>&nbsp;<span class="ident" id="3186120">lex</span>&nbsp;<span class="op" id="3186124">*</span><span class="ident" id="3186125"><a href="/gostd/text/template/parse/lex.go.html#3148960">lexer</a></span><span class="op" id="3186130">)</span>&nbsp;<span class="op" id="3186132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186135"><a href="/gostd/text/template/parse/parse.go.html#3186068">t</a></span><span class="op" id="3186136">.</span><span class="ident" id="3186137"><a href="/gostd/text/template/parse/parse.go.html#3181317">Root</a></span>&nbsp;<span class="op" id="3186142">=</span>&nbsp;<span class="builtintype" id="3186144">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186149"><a href="/gostd/text/template/parse/parse.go.html#3186068">t</a></span><span class="op" id="3186150">.</span><span class="ident" id="3186151"><a href="/gostd/text/template/parse/parse.go.html#3181519">lex</a></span>&nbsp;<span class="op" id="3186155">=</span>&nbsp;<span class="ident" id="3186157"><a href="/gostd/text/template/parse/parse.go.html#3186120">lex</a></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186162"><a href="/gostd/text/template/parse/parse.go.html#3186068">t</a></span><span class="op" id="3186163">.</span><span class="ident" id="3186164"><a href="/gostd/text/template/parse/parse.go.html#3181608">vars</a></span>&nbsp;<span class="op" id="3186169">=</span>&nbsp;<span class="op" id="3186171">[</span><span class="op" id="3186172">]</span><span class="builtintype" id="3186173">string</span><span class="op" id="3186179">{</span><span class="string" id="3186180">&#34;$&#34;</span><span class="op" id="3186183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186186"><a href="/gostd/text/template/parse/parse.go.html#3186068">t</a></span><span class="op" id="3186187">.</span><span class="ident" id="3186188"><a href="/gostd/text/template/parse/parse.go.html#3181483">funcs</a></span>&nbsp;<span class="op" id="3186194">=</span>&nbsp;<span class="ident" id="3186196"><a href="/gostd/text/template/parse/parse.go.html#3186088">funcs</a></span><br>
<span class="lineno"></span><span class="op" id="3186202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3186205">//&nbsp;stopParse&nbsp;terminates&nbsp;parsing.</span><br>
<span class="lineno">215</span><span class="keyword" id="3186238">func</span>&nbsp;<span class="op" id="3186243">(</span><span class="ident" id="3186244">t</span>&nbsp;<span class="op" id="3186246">*</span><span class="ident" id="3186247"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3186251">)</span>&nbsp;<span class="ident" id="3186253">stopParse</span><span class="op" id="3186262">(</span><span class="op" id="3186263">)</span>&nbsp;<span class="op" id="3186265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186268"><a href="/gostd/text/template/parse/parse.go.html#3186244">t</a></span><span class="op" id="3186269">.</span><span class="ident" id="3186270"><a href="/gostd/text/template/parse/parse.go.html#3181519">lex</a></span>&nbsp;<span class="op" id="3186274">=</span>&nbsp;<span class="builtintype" id="3186276">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186281"><a href="/gostd/text/template/parse/parse.go.html#3186244">t</a></span><span class="op" id="3186282">.</span><span class="ident" id="3186283"><a href="/gostd/text/template/parse/parse.go.html#3181608">vars</a></span>&nbsp;<span class="op" id="3186288">=</span>&nbsp;<span class="builtintype" id="3186290">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186295"><a href="/gostd/text/template/parse/parse.go.html#3186244">t</a></span><span class="op" id="3186296">.</span><span class="ident" id="3186297"><a href="/gostd/text/template/parse/parse.go.html#3181483">funcs</a></span>&nbsp;<span class="op" id="3186303">=</span>&nbsp;<span class="builtintype" id="3186305">nil</span><br>
<span class="lineno"></span><span class="op" id="3186309">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="3186312">//&nbsp;Parse&nbsp;parses&nbsp;the&nbsp;template&nbsp;definition&nbsp;string&nbsp;to&nbsp;construct&nbsp;a&nbsp;representation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3186392">//&nbsp;the&nbsp;template&nbsp;for&nbsp;execution.&nbsp;If&nbsp;either&nbsp;action&nbsp;delimiter&nbsp;string&nbsp;is&nbsp;empty,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3186471">//&nbsp;default&nbsp;(&#34;{{&#34;&nbsp;or&nbsp;&#34;}}&#34;)&nbsp;is&nbsp;used.&nbsp;Embedded&nbsp;template&nbsp;definitions&nbsp;are&nbsp;added&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3186549">//&nbsp;the&nbsp;treeSet&nbsp;map.</span><br>
<span class="lineno">225</span><span class="keyword" id="3186569">func</span>&nbsp;<span class="op" id="3186574">(</span><span class="ident" id="3186575">t</span>&nbsp;<span class="op" id="3186577">*</span><span class="ident" id="3186578"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3186582">)</span>&nbsp;<span class="ident" id="3186584">Parse</span><span class="op" id="3186589">(</span><span class="ident" id="3186590">text</span><span class="op" id="3186594">,</span>&nbsp;<span class="ident" id="3186596">leftDelim</span><span class="op" id="3186605">,</span>&nbsp;<span class="ident" id="3186607">rightDelim</span>&nbsp;<span class="builtintype" id="3186618">string</span><span class="op" id="3186624">,</span>&nbsp;<span class="ident" id="3186626">treeSet</span>&nbsp;<span class="keyword" id="3186634">map</span><span class="op" id="3186637">[</span><span class="builtintype" id="3186638">string</span><span class="op" id="3186644">]</span><span class="op" id="3186645">*</span><span class="ident" id="3186646"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3186650">,</span>&nbsp;<span class="ident" id="3186652">funcs</span>&nbsp;<span class="op" id="3186658">...</span><span class="keyword" id="3186661">map</span><span class="op" id="3186664">[</span><span class="builtintype" id="3186665">string</span><span class="op" id="3186671">]</span><span class="keyword" id="3186672">interface</span><span class="op" id="3186681">{</span><span class="op" id="3186682">}</span><span class="op" id="3186683">)</span>&nbsp;<span class="op" id="3186685">(</span><span class="ident" id="3186686">tree</span>&nbsp;<span class="op" id="3186691">*</span><span class="ident" id="3186692"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3186696">,</span>&nbsp;<span class="ident" id="3186698">err</span>&nbsp;<span class="builtintype" id="3186702">error</span><span class="op" id="3186707">)</span>&nbsp;<span class="op" id="3186709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186712">defer</span>&nbsp;<span class="ident" id="3186718"><a href="/gostd/text/template/parse/parse.go.html#3186575">t</a></span><span class="op" id="3186719">.</span><span class="builtinfunc" id="3186720"><a href="/gostd/text/template/parse/parse.go.html#3185828">recover</a></span><span class="op" id="3186727">(</span><span class="op" id="3186728">&amp;</span><span class="ident" id="3186729"><a href="/gostd/text/template/parse/parse.go.html#3186698">err</a></span><span class="op" id="3186732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186735"><a href="/gostd/text/template/parse/parse.go.html#3186575">t</a></span><span class="op" id="3186736">.</span><span class="ident" id="3186737"><a href="/gostd/text/template/parse/parse.go.html#3181226">ParseName</a></span>&nbsp;<span class="op" id="3186747">=</span>&nbsp;<span class="ident" id="3186749"><a href="/gostd/text/template/parse/parse.go.html#3186575">t</a></span><span class="op" id="3186750">.</span><span class="ident" id="3186751"><a href="/gostd/text/template/parse/parse.go.html#3181156">Name</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186757"><a href="/gostd/text/template/parse/parse.go.html#3186575">t</a></span><span class="op" id="3186758">.</span><span class="ident" id="3186759"><a href="/gostd/text/template/parse/parse.go.html#3186077">startParse</a></span><span class="op" id="3186769">(</span><span class="ident" id="3186770"><a href="/gostd/text/template/parse/parse.go.html#3186652">funcs</a></span><span class="op" id="3186775">,</span>&nbsp;<span class="ident" id="3186777"><a href="/gostd/text/template/parse/lex.go.html#3151468">lex</a></span><span class="op" id="3186780">(</span><span class="ident" id="3186781"><a href="/gostd/text/template/parse/parse.go.html#3186575">t</a></span><span class="op" id="3186782">.</span><span class="ident" id="3186783"><a href="/gostd/text/template/parse/parse.go.html#3181156">Name</a></span><span class="op" id="3186787">,</span>&nbsp;<span class="ident" id="3186789"><a href="/gostd/text/template/parse/parse.go.html#3186590">text</a></span><span class="op" id="3186793">,</span>&nbsp;<span class="ident" id="3186795"><a href="/gostd/text/template/parse/parse.go.html#3186596">leftDelim</a></span><span class="op" id="3186804">,</span>&nbsp;<span class="ident" id="3186806"><a href="/gostd/text/template/parse/parse.go.html#3186607">rightDelim</a></span><span class="op" id="3186816">)</span><span class="op" id="3186817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186820"><a href="/gostd/text/template/parse/parse.go.html#3186575">t</a></span><span class="op" id="3186821">.</span><span class="ident" id="3186822"><a href="/gostd/text/template/parse/parse.go.html#3181369">text</a></span>&nbsp;<span class="op" id="3186827">=</span>&nbsp;<span class="ident" id="3186829"><a href="/gostd/text/template/parse/parse.go.html#3186590">text</a></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186835"><a href="/gostd/text/template/parse/parse.go.html#3186575">t</a></span><span class="op" id="3186836">.</span><span class="ident" id="3186837"><a href="/gostd/text/template/parse/parse.go.html#3187844">parse</a></span><span class="op" id="3186842">(</span><span class="ident" id="3186843"><a href="/gostd/text/template/parse/parse.go.html#3186626">treeSet</a></span><span class="op" id="3186850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186853"><a href="/gostd/text/template/parse/parse.go.html#3186575">t</a></span><span class="op" id="3186854">.</span><span class="ident" id="3186855"><a href="/gostd/text/template/parse/parse.go.html#3186949">add</a></span><span class="op" id="3186858">(</span><span class="ident" id="3186859"><a href="/gostd/text/template/parse/parse.go.html#3186626">treeSet</a></span><span class="op" id="3186866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186869"><a href="/gostd/text/template/parse/parse.go.html#3186575">t</a></span><span class="op" id="3186870">.</span><span class="ident" id="3186871"><a href="/gostd/text/template/parse/parse.go.html#3186253">stopParse</a></span><span class="op" id="3186880">(</span><span class="op" id="3186881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3186884">return</span>&nbsp;<span class="ident" id="3186891"><a href="/gostd/text/template/parse/parse.go.html#3186575">t</a></span><span class="op" id="3186892">,</span>&nbsp;<span class="builtintype" id="3186894">nil</span><br>
<span class="lineno"></span><span class="op" id="3186898">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="3186901">//&nbsp;add&nbsp;adds&nbsp;tree&nbsp;to&nbsp;the&nbsp;treeSet.</span><br>
<span class="lineno"></span><span class="keyword" id="3186934">func</span>&nbsp;<span class="op" id="3186939">(</span><span class="ident" id="3186940">t</span>&nbsp;<span class="op" id="3186942">*</span><span class="ident" id="3186943"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3186947">)</span>&nbsp;<span class="ident" id="3186949">add</span><span class="op" id="3186952">(</span><span class="ident" id="3186953">treeSet</span>&nbsp;<span class="keyword" id="3186961">map</span><span class="op" id="3186964">[</span><span class="builtintype" id="3186965">string</span><span class="op" id="3186971">]</span><span class="op" id="3186972">*</span><span class="ident" id="3186973"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3186977">)</span>&nbsp;<span class="op" id="3186979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3186982">tree</span>&nbsp;<span class="op" id="3186987">:=</span>&nbsp;<span class="ident" id="3186990"><a href="/gostd/text/template/parse/parse.go.html#3186953">treeSet</a></span><span class="op" id="3186997">[</span><span class="ident" id="3186998"><a href="/gostd/text/template/parse/parse.go.html#3186940">t</a></span><span class="op" id="3186999">.</span><span class="ident" id="3187000"><a href="/gostd/text/template/parse/parse.go.html#3181156">Name</a></span><span class="op" id="3187004">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187007">if</span>&nbsp;<span class="ident" id="3187010"><a href="/gostd/text/template/parse/parse.go.html#3186982">tree</a></span>&nbsp;<span class="op" id="3187015">==</span>&nbsp;<span class="builtintype" id="3187018">nil</span>&nbsp;<span class="op" id="3187022">||</span>&nbsp;<span class="ident" id="3187025"><a href="/gostd/text/template/parse/parse.go.html#3187271">IsEmptyTree</a></span><span class="op" id="3187036">(</span><span class="ident" id="3187037"><a href="/gostd/text/template/parse/parse.go.html#3186982">tree</a></span><span class="op" id="3187041">.</span><span class="ident" id="3187042"><a href="/gostd/text/template/parse/parse.go.html#3181317">Root</a></span><span class="op" id="3187046">)</span>&nbsp;<span class="op" id="3187048">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187052"><a href="/gostd/text/template/parse/parse.go.html#3186953">treeSet</a></span><span class="op" id="3187059">[</span><span class="ident" id="3187060"><a href="/gostd/text/template/parse/parse.go.html#3186940">t</a></span><span class="op" id="3187061">.</span><span class="ident" id="3187062"><a href="/gostd/text/template/parse/parse.go.html#3181156">Name</a></span><span class="op" id="3187066">]</span>&nbsp;<span class="op" id="3187068">=</span>&nbsp;<span class="ident" id="3187070"><a href="/gostd/text/template/parse/parse.go.html#3186940">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187074">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187085">if</span>&nbsp;<span class="op" id="3187088">!</span><span class="ident" id="3187089"><a href="/gostd/text/template/parse/parse.go.html#3187271">IsEmptyTree</a></span><span class="op" id="3187100">(</span><span class="ident" id="3187101"><a href="/gostd/text/template/parse/parse.go.html#3186940">t</a></span><span class="op" id="3187102">.</span><span class="ident" id="3187103"><a href="/gostd/text/template/parse/parse.go.html#3181317">Root</a></span><span class="op" id="3187107">)</span>&nbsp;<span class="op" id="3187109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187113"><a href="/gostd/text/template/parse/parse.go.html#3186940">t</a></span><span class="op" id="3187114">.</span><span class="ident" id="3187115"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3187121">(</span><span class="string" id="3187122">&#34;template:&nbsp;multiple&nbsp;definition&nbsp;of&nbsp;template&nbsp;%q&#34;</span><span class="op" id="3187168">,</span>&nbsp;<span class="ident" id="3187170"><a href="/gostd/text/template/parse/parse.go.html#3186940">t</a></span><span class="op" id="3187171">.</span><span class="ident" id="3187172"><a href="/gostd/text/template/parse/parse.go.html#3181156">Name</a></span><span class="op" id="3187176">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187179">}</span><br>
<span class="lineno"></span><span class="op" id="3187181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3187184">//&nbsp;IsEmptyTree&nbsp;reports&nbsp;whether&nbsp;this&nbsp;tree&nbsp;(node)&nbsp;is&nbsp;empty&nbsp;of&nbsp;everything&nbsp;but&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="3187266">func</span>&nbsp;<span class="ident" id="3187271">IsEmptyTree</span><span class="op" id="3187282">(</span><span class="ident" id="3187283">n</span>&nbsp;<span class="ident" id="3187285"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span><span class="op" id="3187289">)</span>&nbsp;<span class="builtintype" id="3187291">bool</span>&nbsp;<span class="op" id="3187296">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187299">switch</span>&nbsp;<span class="ident" id="3187306">n</span>&nbsp;<span class="op" id="3187308">:=</span>&nbsp;<span class="ident" id="3187311"><a href="/gostd/text/template/parse/parse.go.html#3187283">n</a></span><span class="op" id="3187312">.</span><span class="op" id="3187313">(</span><span class="keyword" id="3187314">type</span><span class="op" id="3187318">)</span>&nbsp;<span class="op" id="3187320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187323">case</span>&nbsp;<span class="builtintype" id="3187328">nil</span><span class="op" id="3187331">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187335">return</span>&nbsp;<span class="builtintype" id="3187342">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187348">case</span>&nbsp;<span class="op" id="3187353">*</span><span class="ident" id="3187354"><a href="/gostd/text/template/parse/node.go.html#3165284">ActionNode</a></span><span class="op" id="3187364">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187367">case</span>&nbsp;<span class="op" id="3187372">*</span><span class="ident" id="3187373"><a href="/gostd/text/template/parse/node.go.html#3178449">IfNode</a></span><span class="op" id="3187379">:</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187382">case</span>&nbsp;<span class="op" id="3187387">*</span><span class="ident" id="3187388"><a href="/gostd/text/template/parse/node.go.html#3162635">ListNode</a></span><span class="op" id="3187396">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187400">for</span>&nbsp;<span class="ident" id="3187404">_</span><span class="op" id="3187405">,</span>&nbsp;<span class="ident" id="3187407">node</span>&nbsp;<span class="op" id="3187412">:=</span>&nbsp;<span class="keyword" id="3187415">range</span>&nbsp;<span class="ident" id="3187421"><a href="/gostd/text/template/parse/parse.go.html#3187306">n</a></span><span class="op" id="3187422">.</span><span class="ident" id="3187423"><a href="/gostd/text/template/parse/node.go.html#3162682">Nodes</a></span>&nbsp;<span class="op" id="3187429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187434">if</span>&nbsp;<span class="op" id="3187437">!</span><span class="ident" id="3187438"><a href="/gostd/text/template/parse/parse.go.html#3187271">IsEmptyTree</a></span><span class="op" id="3187449">(</span><span class="ident" id="3187450"><a href="/gostd/text/template/parse/parse.go.html#3187407">node</a></span><span class="op" id="3187454">)</span>&nbsp;<span class="op" id="3187456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187462">return</span>&nbsp;<span class="builtintype" id="3187469">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187478">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187486">return</span>&nbsp;<span class="builtintype" id="3187493">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187499">case</span>&nbsp;<span class="op" id="3187504">*</span><span class="ident" id="3187505"><a href="/gostd/text/template/parse/node.go.html#3178889">RangeNode</a></span><span class="op" id="3187514">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187517">case</span>&nbsp;<span class="op" id="3187522">*</span><span class="ident" id="3187523"><a href="/gostd/text/template/parse/node.go.html#3179791">TemplateNode</a></span><span class="op" id="3187535">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187538">case</span>&nbsp;<span class="op" id="3187543">*</span><span class="ident" id="3187544"><a href="/gostd/text/template/parse/node.go.html#3163353">TextNode</a></span><span class="op" id="3187552">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187556">return</span>&nbsp;<span class="builtinfunc" id="3187563">len</span><span class="op" id="3187566">(</span><span class="ident" id="3187567"><a href="/gostd/text/template/parse/parse.go.html#3181026">bytes</a></span><span class="op" id="3187572">.</span><span class="ident" id="3187573"><a href="/gostd/bytes/bytes.go.html#1411807">TrimSpace</a></span><span class="op" id="3187582">(</span><span class="ident" id="3187583"><a href="/gostd/text/template/parse/parse.go.html#3187306">n</a></span><span class="op" id="3187584">.</span><span class="ident" id="3187585"><a href="/gostd/text/template/parse/node.go.html#3163399">Text</a></span><span class="op" id="3187589">)</span><span class="op" id="3187590">)</span>&nbsp;<span class="op" id="3187592">==</span>&nbsp;<span class="num" id="3187595">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187598">case</span>&nbsp;<span class="op" id="3187603">*</span><span class="ident" id="3187604"><a href="/gostd/text/template/parse/node.go.html#3179348">WithNode</a></span><span class="op" id="3187612">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187615">default</span><span class="op" id="3187622">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3187626">panic</span><span class="op" id="3187631">(</span><span class="string" id="3187632">&#34;unknown&nbsp;node:&nbsp;&#34;</span>&nbsp;<span class="op" id="3187649">+</span>&nbsp;<span class="ident" id="3187651"><a href="/gostd/text/template/parse/parse.go.html#3187306">n</a></span><span class="op" id="3187652">.</span><span class="ident" id="3187653"><a href="/gostd/text/template/parse/node.go.html#3160569">String</a></span><span class="op" id="3187659">(</span><span class="op" id="3187660">)</span><span class="op" id="3187661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3187664">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187667">return</span>&nbsp;<span class="builtintype" id="3187674">false</span><br>
<span class="lineno"></span><span class="op" id="3187680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3187683">//&nbsp;parse&nbsp;is&nbsp;the&nbsp;top-level&nbsp;parser&nbsp;for&nbsp;a&nbsp;template,&nbsp;essentially&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="3187753">//&nbsp;as&nbsp;itemList&nbsp;except&nbsp;it&nbsp;also&nbsp;parses&nbsp;{{define}}&nbsp;actions.</span><br>
<span class="lineno">275</span><span class="comment" id="3187810">//&nbsp;It&nbsp;runs&nbsp;to&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="3187829">func</span>&nbsp;<span class="op" id="3187834">(</span><span class="ident" id="3187835">t</span>&nbsp;<span class="op" id="3187837">*</span><span class="ident" id="3187838"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3187842">)</span>&nbsp;<span class="ident" id="3187844">parse</span><span class="op" id="3187849">(</span><span class="ident" id="3187850">treeSet</span>&nbsp;<span class="keyword" id="3187858">map</span><span class="op" id="3187861">[</span><span class="builtintype" id="3187862">string</span><span class="op" id="3187868">]</span><span class="op" id="3187869">*</span><span class="ident" id="3187870"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3187874">)</span>&nbsp;<span class="op" id="3187876">(</span><span class="ident" id="3187877">next</span>&nbsp;<span class="ident" id="3187882"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span><span class="op" id="3187886">)</span>&nbsp;<span class="op" id="3187888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187891"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3187892">.</span><span class="ident" id="3187893"><a href="/gostd/text/template/parse/parse.go.html#3181317">Root</a></span>&nbsp;<span class="op" id="3187898">=</span>&nbsp;<span class="ident" id="3187900"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3187901">.</span><span class="ident" id="3187902"><a href="/gostd/text/template/parse/node.go.html#3162752">newList</a></span><span class="op" id="3187909">(</span><span class="ident" id="3187910"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3187911">.</span><span class="ident" id="3187912"><a href="/gostd/text/template/parse/parse.go.html#3183172">peek</a></span><span class="op" id="3187916">(</span><span class="op" id="3187917">)</span><span class="op" id="3187918">.</span><span class="ident" id="3187919"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3187922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187925">for</span>&nbsp;<span class="ident" id="3187929"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3187930">.</span><span class="ident" id="3187931"><a href="/gostd/text/template/parse/parse.go.html#3183172">peek</a></span><span class="op" id="3187935">(</span><span class="op" id="3187936">)</span><span class="op" id="3187937">.</span><span class="ident" id="3187938"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3187942">!=</span>&nbsp;<span class="ident" id="3187945"><a href="/gostd/text/template/parse/lex.go.html#3147462">itemEOF</a></span>&nbsp;<span class="op" id="3187953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3187957">if</span>&nbsp;<span class="ident" id="3187960"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3187961">.</span><span class="ident" id="3187962"><a href="/gostd/text/template/parse/parse.go.html#3183172">peek</a></span><span class="op" id="3187966">(</span><span class="op" id="3187967">)</span><span class="op" id="3187968">.</span><span class="ident" id="3187969"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3187973">==</span>&nbsp;<span class="ident" id="3187976"><a href="/gostd/text/template/parse/lex.go.html#3147597">itemLeftDelim</a></span>&nbsp;<span class="op" id="3187990">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3187995">delim</span>&nbsp;<span class="op" id="3188001">:=</span>&nbsp;<span class="ident" id="3188004"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3188005">.</span><span class="ident" id="3188006"><a href="/gostd/text/template/parse/parse.go.html#3182508">next</a></span><span class="op" id="3188010">(</span><span class="op" id="3188011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188016">if</span>&nbsp;<span class="ident" id="3188019"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3188020">.</span><span class="ident" id="3188021"><a href="/gostd/text/template/parse/parse.go.html#3183378">nextNonSpace</a></span><span class="op" id="3188033">(</span><span class="op" id="3188034">)</span><span class="op" id="3188035">.</span><span class="ident" id="3188036"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3188040">==</span>&nbsp;<span class="ident" id="3188043"><a href="/gostd/text/template/parse/lex.go.html#3148241">itemDefine</a></span>&nbsp;<span class="op" id="3188054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188060">newT</span>&nbsp;<span class="op" id="3188065">:=</span>&nbsp;<span class="ident" id="3188068"><a href="/gostd/text/template/parse/parse.go.html#3183787">New</a></span><span class="op" id="3188071">(</span><span class="string" id="3188072">&#34;definition&#34;</span><span class="op" id="3188084">)</span>&nbsp;<span class="comment" id="3188086">//&nbsp;name&nbsp;will&nbsp;be&nbsp;updated&nbsp;once&nbsp;we&nbsp;know&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188131"><a href="/gostd/text/template/parse/parse.go.html#3188060">newT</a></span><span class="op" id="3188135">.</span><span class="ident" id="3188136"><a href="/gostd/text/template/parse/parse.go.html#3181369">text</a></span>&nbsp;<span class="op" id="3188141">=</span>&nbsp;<span class="ident" id="3188143"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3188144">.</span><span class="ident" id="3188145"><a href="/gostd/text/template/parse/parse.go.html#3181369">text</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188154"><a href="/gostd/text/template/parse/parse.go.html#3188060">newT</a></span><span class="op" id="3188158">.</span><span class="ident" id="3188159"><a href="/gostd/text/template/parse/parse.go.html#3181226">ParseName</a></span>&nbsp;<span class="op" id="3188169">=</span>&nbsp;<span class="ident" id="3188171"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3188172">.</span><span class="ident" id="3188173"><a href="/gostd/text/template/parse/parse.go.html#3181226">ParseName</a></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188187"><a href="/gostd/text/template/parse/parse.go.html#3188060">newT</a></span><span class="op" id="3188191">.</span><span class="ident" id="3188192"><a href="/gostd/text/template/parse/parse.go.html#3186077">startParse</a></span><span class="op" id="3188202">(</span><span class="ident" id="3188203"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3188204">.</span><span class="ident" id="3188205"><a href="/gostd/text/template/parse/parse.go.html#3181483">funcs</a></span><span class="op" id="3188210">,</span>&nbsp;<span class="ident" id="3188212"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3188213">.</span><span class="ident" id="3188214"><a href="/gostd/text/template/parse/parse.go.html#3181519">lex</a></span><span class="op" id="3188217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188223"><a href="/gostd/text/template/parse/parse.go.html#3188060">newT</a></span><span class="op" id="3188227">.</span><span class="ident" id="3188228"><a href="/gostd/text/template/parse/parse.go.html#3188608">parseDefinition</a></span><span class="op" id="3188243">(</span><span class="ident" id="3188244"><a href="/gostd/text/template/parse/parse.go.html#3187850">treeSet</a></span><span class="op" id="3188251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188257">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3188269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188274"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3188275">.</span><span class="ident" id="3188276"><a href="/gostd/text/template/parse/parse.go.html#3182830">backup2</a></span><span class="op" id="3188283">(</span><span class="ident" id="3188284"><a href="/gostd/text/template/parse/parse.go.html#3187995">delim</a></span><span class="op" id="3188289">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3188293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188297">n</span>&nbsp;<span class="op" id="3188299">:=</span>&nbsp;<span class="ident" id="3188302"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3188303">.</span><span class="ident" id="3188304"><a href="/gostd/text/template/parse/parse.go.html#3189449">textOrAction</a></span><span class="op" id="3188316">(</span><span class="op" id="3188317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188321">if</span>&nbsp;<span class="ident" id="3188324"><a href="/gostd/text/template/parse/parse.go.html#3188297">n</a></span><span class="op" id="3188325">.</span><span class="ident" id="3188326"><a href="/gostd/text/template/parse/node.go.html#3160552">Type</a></span><span class="op" id="3188330">(</span><span class="op" id="3188331">)</span>&nbsp;<span class="op" id="3188333">==</span>&nbsp;<span class="ident" id="3188336"><a href="/gostd/text/template/parse/node.go.html#3161830">nodeEnd</a></span>&nbsp;<span class="op" id="3188344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188349"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3188350">.</span><span class="ident" id="3188351"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3188357">(</span><span class="string" id="3188358">&#34;unexpected&nbsp;%s&#34;</span><span class="op" id="3188373">,</span>&nbsp;<span class="ident" id="3188375"><a href="/gostd/text/template/parse/parse.go.html#3188297">n</a></span><span class="op" id="3188376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3188380">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188384"><a href="/gostd/text/template/parse/parse.go.html#3187835">t</a></span><span class="op" id="3188385">.</span><span class="ident" id="3188386"><a href="/gostd/text/template/parse/parse.go.html#3181317">Root</a></span><span class="op" id="3188390">.</span><span class="builtinfunc" id="3188391"><a href="/gostd/text/template/parse/node.go.html#3162858">append</a></span><span class="op" id="3188397">(</span><span class="ident" id="3188398"><a href="/gostd/text/template/parse/parse.go.html#3188297">n</a></span><span class="op" id="3188399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3188402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188405">return</span>&nbsp;<span class="builtintype" id="3188412">nil</span><br>
<span class="lineno"></span><span class="op" id="3188416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="3188419">//&nbsp;parseDefinition&nbsp;parses&nbsp;a&nbsp;{{define}}&nbsp;...&nbsp;&nbsp;{{end}}&nbsp;template&nbsp;definition&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3188495">//&nbsp;installs&nbsp;the&nbsp;definition&nbsp;in&nbsp;the&nbsp;treeSet&nbsp;map.&nbsp;&nbsp;The&nbsp;&#34;define&#34;&nbsp;keyword&nbsp;has&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="3188576">//&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="3188593">func</span>&nbsp;<span class="op" id="3188598">(</span><span class="ident" id="3188599">t</span>&nbsp;<span class="op" id="3188601">*</span><span class="ident" id="3188602"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3188606">)</span>&nbsp;<span class="ident" id="3188608">parseDefinition</span><span class="op" id="3188623">(</span><span class="ident" id="3188624">treeSet</span>&nbsp;<span class="keyword" id="3188632">map</span><span class="op" id="3188635">[</span><span class="builtintype" id="3188636">string</span><span class="op" id="3188642">]</span><span class="op" id="3188643">*</span><span class="ident" id="3188644"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3188648">)</span>&nbsp;<span class="op" id="3188650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188653">const</span>&nbsp;<span class="ident" id="3188659">context</span>&nbsp;<span class="op" id="3188667">=</span>&nbsp;<span class="string" id="3188669">&#34;define&nbsp;clause&#34;</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188686">name</span>&nbsp;<span class="op" id="3188691">:=</span>&nbsp;<span class="ident" id="3188694"><a href="/gostd/text/template/parse/parse.go.html#3188599">t</a></span><span class="op" id="3188695">.</span><span class="ident" id="3188696"><a href="/gostd/text/template/parse/parse.go.html#3185353">expectOneOf</a></span><span class="op" id="3188707">(</span><span class="ident" id="3188708"><a href="/gostd/text/template/parse/lex.go.html#3147948">itemString</a></span><span class="op" id="3188718">,</span>&nbsp;<span class="ident" id="3188720"><a href="/gostd/text/template/parse/lex.go.html#3147760">itemRawString</a></span><span class="op" id="3188733">,</span>&nbsp;<span class="ident" id="3188735"><a href="/gostd/text/template/parse/parse.go.html#3188659">context</a></span><span class="op" id="3188742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188745">var</span>&nbsp;<span class="ident" id="3188749">err</span>&nbsp;<span class="builtintype" id="3188753">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188760"><a href="/gostd/text/template/parse/parse.go.html#3188599">t</a></span><span class="op" id="3188761">.</span><span class="ident" id="3188762"><a href="/gostd/text/template/parse/parse.go.html#3181156">Name</a></span><span class="op" id="3188766">,</span>&nbsp;<span class="ident" id="3188768"><a href="/gostd/text/template/parse/parse.go.html#3188749">err</a></span>&nbsp;<span class="op" id="3188772">=</span>&nbsp;<span class="ident" id="3188774"><a href="/gostd/text/template/parse/parse.go.html#3181053">strconv</a></span><span class="op" id="3188781">.</span><span class="ident" id="3188782"><a href="/gostd/strconv/quote.go.html#2417743">Unquote</a></span><span class="op" id="3188789">(</span><span class="ident" id="3188790"><a href="/gostd/text/template/parse/parse.go.html#3188686">name</a></span><span class="op" id="3188794">.</span><span class="ident" id="3188795"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3188798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188801">if</span>&nbsp;<span class="ident" id="3188804"><a href="/gostd/text/template/parse/parse.go.html#3188749">err</a></span>&nbsp;<span class="op" id="3188808">!=</span>&nbsp;<span class="builtintype" id="3188811">nil</span>&nbsp;<span class="op" id="3188815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188819"><a href="/gostd/text/template/parse/parse.go.html#3188599">t</a></span><span class="op" id="3188820">.</span><span class="builtintype" id="3188821"><a href="/gostd/text/template/parse/parse.go.html#3184962">error</a></span><span class="op" id="3188826">(</span><span class="ident" id="3188827"><a href="/gostd/text/template/parse/parse.go.html#3188749">err</a></span><span class="op" id="3188830">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3188833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188836"><a href="/gostd/text/template/parse/parse.go.html#3188599">t</a></span><span class="op" id="3188837">.</span><span class="ident" id="3188838"><a href="/gostd/text/template/parse/parse.go.html#3185095">expect</a></span><span class="op" id="3188844">(</span><span class="ident" id="3188845"><a href="/gostd/text/template/parse/lex.go.html#3147815">itemRightDelim</a></span><span class="op" id="3188859">,</span>&nbsp;<span class="ident" id="3188861"><a href="/gostd/text/template/parse/parse.go.html#3188659">context</a></span><span class="op" id="3188868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188871">var</span>&nbsp;<span class="ident" id="3188875">end</span>&nbsp;<span class="ident" id="3188879"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188885"><a href="/gostd/text/template/parse/parse.go.html#3188599">t</a></span><span class="op" id="3188886">.</span><span class="ident" id="3188887"><a href="/gostd/text/template/parse/parse.go.html#3181317">Root</a></span><span class="op" id="3188891">,</span>&nbsp;<span class="ident" id="3188893"><a href="/gostd/text/template/parse/parse.go.html#3188875">end</a></span>&nbsp;<span class="op" id="3188897">=</span>&nbsp;<span class="ident" id="3188899"><a href="/gostd/text/template/parse/parse.go.html#3188599">t</a></span><span class="op" id="3188900">.</span><span class="ident" id="3188901"><a href="/gostd/text/template/parse/parse.go.html#3189129">itemList</a></span><span class="op" id="3188909">(</span><span class="op" id="3188910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3188913">if</span>&nbsp;<span class="ident" id="3188916"><a href="/gostd/text/template/parse/parse.go.html#3188875">end</a></span><span class="op" id="3188919">.</span><span class="ident" id="3188920"><a href="/gostd/text/template/parse/node.go.html#3160552">Type</a></span><span class="op" id="3188924">(</span><span class="op" id="3188925">)</span>&nbsp;<span class="op" id="3188927">!=</span>&nbsp;<span class="ident" id="3188930"><a href="/gostd/text/template/parse/node.go.html#3161830">nodeEnd</a></span>&nbsp;<span class="op" id="3188938">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188942"><a href="/gostd/text/template/parse/parse.go.html#3188599">t</a></span><span class="op" id="3188943">.</span><span class="ident" id="3188944"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3188950">(</span><span class="string" id="3188951">&#34;unexpected&nbsp;%s&nbsp;in&nbsp;%s&#34;</span><span class="op" id="3188972">,</span>&nbsp;<span class="ident" id="3188974"><a href="/gostd/text/template/parse/parse.go.html#3188875">end</a></span><span class="op" id="3188977">,</span>&nbsp;<span class="ident" id="3188979"><a href="/gostd/text/template/parse/parse.go.html#3188659">context</a></span><span class="op" id="3188986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3188989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3188992"><a href="/gostd/text/template/parse/parse.go.html#3188599">t</a></span><span class="op" id="3188993">.</span><span class="ident" id="3188994"><a href="/gostd/text/template/parse/parse.go.html#3186949">add</a></span><span class="op" id="3188997">(</span><span class="ident" id="3188998"><a href="/gostd/text/template/parse/parse.go.html#3188624">treeSet</a></span><span class="op" id="3189005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3189008"><a href="/gostd/text/template/parse/parse.go.html#3188599">t</a></span><span class="op" id="3189009">.</span><span class="ident" id="3189010"><a href="/gostd/text/template/parse/parse.go.html#3186253">stopParse</a></span><span class="op" id="3189019">(</span><span class="op" id="3189020">)</span><br>
<span class="lineno"></span><span class="op" id="3189022">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="3189025">//&nbsp;itemList:</span><br>
<span class="lineno"></span><span class="comment" id="3189038">//&nbsp;&nbsp;&nbsp;&nbsp;textOrAction*</span><br>
<span class="lineno"></span><span class="comment" id="3189055">//&nbsp;Terminates&nbsp;at&nbsp;{{end}}&nbsp;or&nbsp;{{else}},&nbsp;returned&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="3189114">func</span>&nbsp;<span class="op" id="3189119">(</span><span class="ident" id="3189120">t</span>&nbsp;<span class="op" id="3189122">*</span><span class="ident" id="3189123"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3189127">)</span>&nbsp;<span class="ident" id="3189129">itemList</span><span class="op" id="3189137">(</span><span class="op" id="3189138">)</span>&nbsp;<span class="op" id="3189140">(</span><span class="ident" id="3189141">list</span>&nbsp;<span class="op" id="3189146">*</span><span class="ident" id="3189147"><a href="/gostd/text/template/parse/node.go.html#3162635">ListNode</a></span><span class="op" id="3189155">,</span>&nbsp;<span class="ident" id="3189157">next</span>&nbsp;<span class="ident" id="3189162"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span><span class="op" id="3189166">)</span>&nbsp;<span class="op" id="3189168">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3189171"><a href="/gostd/text/template/parse/parse.go.html#3189141">list</a></span>&nbsp;<span class="op" id="3189176">=</span>&nbsp;<span class="ident" id="3189178"><a href="/gostd/text/template/parse/parse.go.html#3189120">t</a></span><span class="op" id="3189179">.</span><span class="ident" id="3189180"><a href="/gostd/text/template/parse/node.go.html#3162752">newList</a></span><span class="op" id="3189187">(</span><span class="ident" id="3189188"><a href="/gostd/text/template/parse/parse.go.html#3189120">t</a></span><span class="op" id="3189189">.</span><span class="ident" id="3189190"><a href="/gostd/text/template/parse/parse.go.html#3183583">peekNonSpace</a></span><span class="op" id="3189202">(</span><span class="op" id="3189203">)</span><span class="op" id="3189204">.</span><span class="ident" id="3189205"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3189208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189211">for</span>&nbsp;<span class="ident" id="3189215"><a href="/gostd/text/template/parse/parse.go.html#3189120">t</a></span><span class="op" id="3189216">.</span><span class="ident" id="3189217"><a href="/gostd/text/template/parse/parse.go.html#3183583">peekNonSpace</a></span><span class="op" id="3189229">(</span><span class="op" id="3189230">)</span><span class="op" id="3189231">.</span><span class="ident" id="3189232"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3189236">!=</span>&nbsp;<span class="ident" id="3189239"><a href="/gostd/text/template/parse/lex.go.html#3147462">itemEOF</a></span>&nbsp;<span class="op" id="3189247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3189251">n</span>&nbsp;<span class="op" id="3189253">:=</span>&nbsp;<span class="ident" id="3189256"><a href="/gostd/text/template/parse/parse.go.html#3189120">t</a></span><span class="op" id="3189257">.</span><span class="ident" id="3189258"><a href="/gostd/text/template/parse/parse.go.html#3189449">textOrAction</a></span><span class="op" id="3189270">(</span><span class="op" id="3189271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189275">switch</span>&nbsp;<span class="ident" id="3189282"><a href="/gostd/text/template/parse/parse.go.html#3189251">n</a></span><span class="op" id="3189283">.</span><span class="ident" id="3189284"><a href="/gostd/text/template/parse/node.go.html#3160552">Type</a></span><span class="op" id="3189288">(</span><span class="op" id="3189289">)</span>&nbsp;<span class="op" id="3189291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189295">case</span>&nbsp;<span class="ident" id="3189300"><a href="/gostd/text/template/parse/node.go.html#3161830">nodeEnd</a></span><span class="op" id="3189307">,</span>&nbsp;<span class="ident" id="3189309"><a href="/gostd/text/template/parse/node.go.html#3161760">nodeElse</a></span><span class="op" id="3189317">:</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189322">return</span>&nbsp;<span class="ident" id="3189329"><a href="/gostd/text/template/parse/parse.go.html#3189141">list</a></span><span class="op" id="3189333">,</span>&nbsp;<span class="ident" id="3189335"><a href="/gostd/text/template/parse/parse.go.html#3189251">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3189339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3189343"><a href="/gostd/text/template/parse/parse.go.html#3189141">list</a></span><span class="op" id="3189347">.</span><span class="builtinfunc" id="3189348"><a href="/gostd/text/template/parse/node.go.html#3162858">append</a></span><span class="op" id="3189354">(</span><span class="ident" id="3189355"><a href="/gostd/text/template/parse/parse.go.html#3189251">n</a></span><span class="op" id="3189356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3189359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3189362"><a href="/gostd/text/template/parse/parse.go.html#3189120">t</a></span><span class="op" id="3189363">.</span><span class="ident" id="3189364"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3189370">(</span><span class="string" id="3189371">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="3189387">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189390">return</span><br>
<span class="lineno"></span><span class="op" id="3189397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3189400">//&nbsp;textOrAction:</span><br>
<span class="lineno"></span><span class="comment" id="3189417">//&nbsp;&nbsp;&nbsp;&nbsp;text&nbsp;|&nbsp;action</span><br>
<span class="lineno">340</span><span class="keyword" id="3189434">func</span>&nbsp;<span class="op" id="3189439">(</span><span class="ident" id="3189440">t</span>&nbsp;<span class="op" id="3189442">*</span><span class="ident" id="3189443"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3189447">)</span>&nbsp;<span class="ident" id="3189449">textOrAction</span><span class="op" id="3189461">(</span><span class="op" id="3189462">)</span>&nbsp;<span class="ident" id="3189464"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span>&nbsp;<span class="op" id="3189469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189472">switch</span>&nbsp;<span class="ident" id="3189479">token</span>&nbsp;<span class="op" id="3189485">:=</span>&nbsp;<span class="ident" id="3189488"><a href="/gostd/text/template/parse/parse.go.html#3189440">t</a></span><span class="op" id="3189489">.</span><span class="ident" id="3189490"><a href="/gostd/text/template/parse/parse.go.html#3183378">nextNonSpace</a></span><span class="op" id="3189502">(</span><span class="op" id="3189503">)</span><span class="op" id="3189504">;</span>&nbsp;<span class="ident" id="3189506"><a href="/gostd/text/template/parse/parse.go.html#3189479">token</a></span><span class="op" id="3189511">.</span><span class="ident" id="3189512"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3189516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189519">case</span>&nbsp;<span class="ident" id="3189524"><a href="/gostd/text/template/parse/lex.go.html#3147999">itemText</a></span><span class="op" id="3189532">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189536">return</span>&nbsp;<span class="ident" id="3189543"><a href="/gostd/text/template/parse/parse.go.html#3189440">t</a></span><span class="op" id="3189544">.</span><span class="ident" id="3189545"><a href="/gostd/text/template/parse/node.go.html#3163461">newText</a></span><span class="op" id="3189552">(</span><span class="ident" id="3189553"><a href="/gostd/text/template/parse/parse.go.html#3189479">token</a></span><span class="op" id="3189558">.</span><span class="ident" id="3189559"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3189562">,</span>&nbsp;<span class="ident" id="3189564"><a href="/gostd/text/template/parse/parse.go.html#3189479">token</a></span><span class="op" id="3189569">.</span><span class="ident" id="3189570"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3189573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189576">case</span>&nbsp;<span class="ident" id="3189581"><a href="/gostd/text/template/parse/lex.go.html#3147597">itemLeftDelim</a></span><span class="op" id="3189594">:</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189598">return</span>&nbsp;<span class="ident" id="3189605"><a href="/gostd/text/template/parse/parse.go.html#3189440">t</a></span><span class="op" id="3189606">.</span><span class="ident" id="3189607"><a href="/gostd/text/template/parse/parse.go.html#3189826">action</a></span><span class="op" id="3189613">(</span><span class="op" id="3189614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189617">default</span><span class="op" id="3189624">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3189628"><a href="/gostd/text/template/parse/parse.go.html#3189440">t</a></span><span class="op" id="3189629">.</span><span class="ident" id="3189630"><a href="/gostd/text/template/parse/parse.go.html#3185634">unexpected</a></span><span class="op" id="3189640">(</span><span class="ident" id="3189641"><a href="/gostd/text/template/parse/parse.go.html#3189479">token</a></span><span class="op" id="3189646">,</span>&nbsp;<span class="string" id="3189648">&#34;input&#34;</span><span class="op" id="3189655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3189658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189661">return</span>&nbsp;<span class="builtintype" id="3189668">nil</span><br>
<span class="lineno">350</span><span class="op" id="3189672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3189675">//&nbsp;Action:</span><br>
<span class="lineno"></span><span class="comment" id="3189686">//&nbsp;&nbsp;&nbsp;&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="3189697">//&nbsp;&nbsp;&nbsp;&nbsp;command&nbsp;(&#34;|&#34;&nbsp;command)*</span><br>
<span class="lineno">355</span><span class="comment" id="3189723">//&nbsp;Left&nbsp;delim&nbsp;is&nbsp;past.&nbsp;Now&nbsp;get&nbsp;actions.</span><br>
<span class="lineno"></span><span class="comment" id="3189763">//&nbsp;First&nbsp;word&nbsp;could&nbsp;be&nbsp;a&nbsp;keyword&nbsp;such&nbsp;as&nbsp;range.</span><br>
<span class="lineno"></span><span class="keyword" id="3189811">func</span>&nbsp;<span class="op" id="3189816">(</span><span class="ident" id="3189817">t</span>&nbsp;<span class="op" id="3189819">*</span><span class="ident" id="3189820"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3189824">)</span>&nbsp;<span class="ident" id="3189826">action</span><span class="op" id="3189832">(</span><span class="op" id="3189833">)</span>&nbsp;<span class="op" id="3189835">(</span><span class="ident" id="3189836">n</span>&nbsp;<span class="ident" id="3189838"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span><span class="op" id="3189842">)</span>&nbsp;<span class="op" id="3189844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189847">switch</span>&nbsp;<span class="ident" id="3189854">token</span>&nbsp;<span class="op" id="3189860">:=</span>&nbsp;<span class="ident" id="3189863"><a href="/gostd/text/template/parse/parse.go.html#3189817">t</a></span><span class="op" id="3189864">.</span><span class="ident" id="3189865"><a href="/gostd/text/template/parse/parse.go.html#3183378">nextNonSpace</a></span><span class="op" id="3189877">(</span><span class="op" id="3189878">)</span><span class="op" id="3189879">;</span>&nbsp;<span class="ident" id="3189881"><a href="/gostd/text/template/parse/parse.go.html#3189854">token</a></span><span class="op" id="3189886">.</span><span class="ident" id="3189887"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3189891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189894">case</span>&nbsp;<span class="ident" id="3189899"><a href="/gostd/text/template/parse/lex.go.html#3148273">itemElse</a></span><span class="op" id="3189907">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189911">return</span>&nbsp;<span class="ident" id="3189918"><a href="/gostd/text/template/parse/parse.go.html#3189817">t</a></span><span class="op" id="3189919">.</span><span class="ident" id="3189920"><a href="/gostd/text/template/parse/parse.go.html#3194025">elseControl</a></span><span class="op" id="3189931">(</span><span class="op" id="3189932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189935">case</span>&nbsp;<span class="ident" id="3189940"><a href="/gostd/text/template/parse/lex.go.html#3148303">itemEnd</a></span><span class="op" id="3189947">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189951">return</span>&nbsp;<span class="ident" id="3189958"><a href="/gostd/text/template/parse/parse.go.html#3189817">t</a></span><span class="op" id="3189959">.</span><span class="ident" id="3189960"><a href="/gostd/text/template/parse/parse.go.html#3193887">endControl</a></span><span class="op" id="3189970">(</span><span class="op" id="3189971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189974">case</span>&nbsp;<span class="ident" id="3189979"><a href="/gostd/text/template/parse/lex.go.html#3148332">itemIf</a></span><span class="op" id="3189985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3189989">return</span>&nbsp;<span class="ident" id="3189996"><a href="/gostd/text/template/parse/parse.go.html#3189817">t</a></span><span class="op" id="3189997">.</span><span class="ident" id="3189998"><a href="/gostd/text/template/parse/parse.go.html#3193326">ifControl</a></span><span class="op" id="3190007">(</span><span class="op" id="3190008">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3190011">case</span>&nbsp;<span class="ident" id="3190016"><a href="/gostd/text/template/parse/lex.go.html#3148433">itemRange</a></span><span class="op" id="3190025">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3190029">return</span>&nbsp;<span class="ident" id="3190036"><a href="/gostd/text/template/parse/parse.go.html#3189817">t</a></span><span class="op" id="3190037">.</span><span class="ident" id="3190038"><a href="/gostd/text/template/parse/parse.go.html#3193539">rangeControl</a></span><span class="op" id="3190050">(</span><span class="op" id="3190051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3190054">case</span>&nbsp;<span class="ident" id="3190059"><a href="/gostd/text/template/parse/lex.go.html#3148464">itemTemplate</a></span><span class="op" id="3190071">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3190075">return</span>&nbsp;<span class="ident" id="3190082"><a href="/gostd/text/template/parse/parse.go.html#3189817">t</a></span><span class="op" id="3190083">.</span><span class="ident" id="3190084"><a href="/gostd/text/template/parse/parse.go.html#3194493">templateControl</a></span><span class="op" id="3190099">(</span><span class="op" id="3190100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3190103">case</span>&nbsp;<span class="ident" id="3190108"><a href="/gostd/text/template/parse/lex.go.html#3148498">itemWith</a></span><span class="op" id="3190116">:</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3190120">return</span>&nbsp;<span class="ident" id="3190127"><a href="/gostd/text/template/parse/parse.go.html#3189817">t</a></span><span class="op" id="3190128">.</span><span class="ident" id="3190129"><a href="/gostd/text/template/parse/parse.go.html#3193756">withControl</a></span><span class="op" id="3190140">(</span><span class="op" id="3190141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3190144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3190147"><a href="/gostd/text/template/parse/parse.go.html#3189817">t</a></span><span class="op" id="3190148">.</span><span class="ident" id="3190149"><a href="/gostd/text/template/parse/parse.go.html#3182699">backup</a></span><span class="op" id="3190155">(</span><span class="op" id="3190156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3190159">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables;&nbsp;they&nbsp;persist&nbsp;until&nbsp;&#34;end&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3190211">return</span>&nbsp;<span class="ident" id="3190218"><a href="/gostd/text/template/parse/parse.go.html#3189817">t</a></span><span class="op" id="3190219">.</span><span class="ident" id="3190220"><a href="/gostd/text/template/parse/node.go.html#3165481">newAction</a></span><span class="op" id="3190229">(</span><span class="ident" id="3190230"><a href="/gostd/text/template/parse/parse.go.html#3189817">t</a></span><span class="op" id="3190231">.</span><span class="ident" id="3190232"><a href="/gostd/text/template/parse/parse.go.html#3183172">peek</a></span><span class="op" id="3190236">(</span><span class="op" id="3190237">)</span><span class="op" id="3190238">.</span><span class="ident" id="3190239"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3190242">,</span>&nbsp;<span class="ident" id="3190244"><a href="/gostd/text/template/parse/parse.go.html#3189817">t</a></span><span class="op" id="3190245">.</span><span class="ident" id="3190246"><a href="/gostd/text/template/parse/parse.go.html#3181519">lex</a></span><span class="op" id="3190249">.</span><span class="ident" id="3190250"><a href="/gostd/text/template/parse/lex.go.html#3150902">lineNumber</a></span><span class="op" id="3190260">(</span><span class="op" id="3190261">)</span><span class="op" id="3190262">,</span>&nbsp;<span class="ident" id="3190264"><a href="/gostd/text/template/parse/parse.go.html#3189817">t</a></span><span class="op" id="3190265">.</span><span class="ident" id="3190266"><a href="/gostd/text/template/parse/parse.go.html#3190358">pipeline</a></span><span class="op" id="3190274">(</span><span class="string" id="3190275">&#34;command&#34;</span><span class="op" id="3190284">)</span><span class="op" id="3190285">)</span><br>
<span class="lineno">375</span><span class="op" id="3190287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3190290">//&nbsp;Pipeline:</span><br>
<span class="lineno"></span><span class="comment" id="3190303">//&nbsp;&nbsp;&nbsp;&nbsp;declarations?&nbsp;command&nbsp;(&#39;|&#39;&nbsp;command)*</span><br>
<span class="lineno"></span><span class="keyword" id="3190343">func</span>&nbsp;<span class="op" id="3190348">(</span><span class="ident" id="3190349">t</span>&nbsp;<span class="op" id="3190351">*</span><span class="ident" id="3190352"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3190356">)</span>&nbsp;<span class="ident" id="3190358">pipeline</span><span class="op" id="3190366">(</span><span class="ident" id="3190367">context</span>&nbsp;<span class="builtintype" id="3190375">string</span><span class="op" id="3190381">)</span>&nbsp;<span class="op" id="3190383">(</span><span class="ident" id="3190384">pipe</span>&nbsp;<span class="op" id="3190389">*</span><span class="ident" id="3190390"><a href="/gostd/text/template/parse/node.go.html#3163902">PipeNode</a></span><span class="op" id="3190398">)</span>&nbsp;<span class="op" id="3190400">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3190403">var</span>&nbsp;<span class="ident" id="3190407">decl</span>&nbsp;<span class="op" id="3190412">[</span><span class="op" id="3190413">]</span><span class="op" id="3190414">*</span><span class="ident" id="3190415"><a href="/gostd/text/template/parse/node.go.html#3167861">VariableNode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3190429">pos</span>&nbsp;<span class="op" id="3190433">:=</span>&nbsp;<span class="ident" id="3190436"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3190437">.</span><span class="ident" id="3190438"><a href="/gostd/text/template/parse/parse.go.html#3183583">peekNonSpace</a></span><span class="op" id="3190450">(</span><span class="op" id="3190451">)</span><span class="op" id="3190452">.</span><span class="ident" id="3190453"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3190458">//&nbsp;Are&nbsp;there&nbsp;declarations?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3190486">for</span>&nbsp;<span class="op" id="3190490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3190494">if</span>&nbsp;<span class="ident" id="3190497">v</span>&nbsp;<span class="op" id="3190499">:=</span>&nbsp;<span class="ident" id="3190502"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3190503">.</span><span class="ident" id="3190504"><a href="/gostd/text/template/parse/parse.go.html#3183583">peekNonSpace</a></span><span class="op" id="3190516">(</span><span class="op" id="3190517">)</span><span class="op" id="3190518">;</span>&nbsp;<span class="ident" id="3190520"><a href="/gostd/text/template/parse/parse.go.html#3190497">v</a></span><span class="op" id="3190521">.</span><span class="ident" id="3190522"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3190526">==</span>&nbsp;<span class="ident" id="3190529"><a href="/gostd/text/template/parse/lex.go.html#3148029">itemVariable</a></span>&nbsp;<span class="op" id="3190542">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3190547"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3190548">.</span><span class="ident" id="3190549"><a href="/gostd/text/template/parse/parse.go.html#3182508">next</a></span><span class="op" id="3190553">(</span><span class="op" id="3190554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3190559">//&nbsp;Since&nbsp;space&nbsp;is&nbsp;a&nbsp;token,&nbsp;we&nbsp;need&nbsp;3-token&nbsp;look-ahead&nbsp;here&nbsp;in&nbsp;the&nbsp;worst&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3190640">//&nbsp;in&nbsp;&#34;$x&nbsp;foo&#34;&nbsp;we&nbsp;need&nbsp;to&nbsp;read&nbsp;&#34;foo&#34;&nbsp;(as&nbsp;opposed&nbsp;to&nbsp;&#34;:=&#34;)&nbsp;to&nbsp;know&nbsp;that&nbsp;$x&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3190723">//&nbsp;argument&nbsp;variable&nbsp;rather&nbsp;than&nbsp;a&nbsp;declaration.&nbsp;So&nbsp;remember&nbsp;the&nbsp;token</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3190796">//&nbsp;adjacent&nbsp;to&nbsp;the&nbsp;variable&nbsp;so&nbsp;we&nbsp;can&nbsp;push&nbsp;it&nbsp;back&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3190864">tokenAfterVariable</span>&nbsp;<span class="op" id="3190883">:=</span>&nbsp;<span class="ident" id="3190886"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3190887">.</span><span class="ident" id="3190888"><a href="/gostd/text/template/parse/parse.go.html#3183172">peek</a></span><span class="op" id="3190892">(</span><span class="op" id="3190893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3190898">if</span>&nbsp;<span class="ident" id="3190901">next</span>&nbsp;<span class="op" id="3190906">:=</span>&nbsp;<span class="ident" id="3190909"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3190910">.</span><span class="ident" id="3190911"><a href="/gostd/text/template/parse/parse.go.html#3183583">peekNonSpace</a></span><span class="op" id="3190923">(</span><span class="op" id="3190924">)</span><span class="op" id="3190925">;</span>&nbsp;<span class="ident" id="3190927"><a href="/gostd/text/template/parse/parse.go.html#3190901">next</a></span><span class="op" id="3190931">.</span><span class="ident" id="3190932"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3190936">==</span>&nbsp;<span class="ident" id="3190939"><a href="/gostd/text/template/parse/lex.go.html#3147379">itemColonEquals</a></span>&nbsp;<span class="op" id="3190955">||</span>&nbsp;<span class="op" id="3190958">(</span><span class="ident" id="3190959"><a href="/gostd/text/template/parse/parse.go.html#3190901">next</a></span><span class="op" id="3190963">.</span><span class="ident" id="3190964"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3190968">==</span>&nbsp;<span class="ident" id="3190971"><a href="/gostd/text/template/parse/lex.go.html#3147146">itemChar</a></span>&nbsp;<span class="op" id="3190980">&amp;&amp;</span>&nbsp;<span class="ident" id="3190983"><a href="/gostd/text/template/parse/parse.go.html#3190901">next</a></span><span class="op" id="3190987">.</span><span class="ident" id="3190988"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span>&nbsp;<span class="op" id="3190992">==</span>&nbsp;<span class="string" id="3190995">&#34;,&#34;</span><span class="op" id="3190998">)</span>&nbsp;<span class="op" id="3191000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191006"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191007">.</span><span class="ident" id="3191008"><a href="/gostd/text/template/parse/parse.go.html#3183378">nextNonSpace</a></span><span class="op" id="3191020">(</span><span class="op" id="3191021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191027">variable</span>&nbsp;<span class="op" id="3191036">:=</span>&nbsp;<span class="ident" id="3191039"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191040">.</span><span class="ident" id="3191041"><a href="/gostd/text/template/parse/node.go.html#3167991">newVariable</a></span><span class="op" id="3191052">(</span><span class="ident" id="3191053"><a href="/gostd/text/template/parse/parse.go.html#3190497">v</a></span><span class="op" id="3191054">.</span><span class="ident" id="3191055"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3191058">,</span>&nbsp;<span class="ident" id="3191060"><a href="/gostd/text/template/parse/parse.go.html#3190497">v</a></span><span class="op" id="3191061">.</span><span class="ident" id="3191062"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3191065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191071"><a href="/gostd/text/template/parse/parse.go.html#3190407">decl</a></span>&nbsp;<span class="op" id="3191076">=</span>&nbsp;<span class="builtinfunc" id="3191078">append</span><span class="op" id="3191084">(</span><span class="ident" id="3191085"><a href="/gostd/text/template/parse/parse.go.html#3190407">decl</a></span><span class="op" id="3191089">,</span>&nbsp;<span class="ident" id="3191091"><a href="/gostd/text/template/parse/parse.go.html#3191027">variable</a></span><span class="op" id="3191099">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191105"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191106">.</span><span class="ident" id="3191107"><a href="/gostd/text/template/parse/parse.go.html#3181608">vars</a></span>&nbsp;<span class="op" id="3191112">=</span>&nbsp;<span class="builtinfunc" id="3191114">append</span><span class="op" id="3191120">(</span><span class="ident" id="3191121"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191122">.</span><span class="ident" id="3191123"><a href="/gostd/text/template/parse/parse.go.html#3181608">vars</a></span><span class="op" id="3191127">,</span>&nbsp;<span class="ident" id="3191129"><a href="/gostd/text/template/parse/parse.go.html#3190497">v</a></span><span class="op" id="3191130">.</span><span class="ident" id="3191131"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3191134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3191140">if</span>&nbsp;<span class="ident" id="3191143"><a href="/gostd/text/template/parse/parse.go.html#3190901">next</a></span><span class="op" id="3191147">.</span><span class="ident" id="3191148"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3191152">==</span>&nbsp;<span class="ident" id="3191155"><a href="/gostd/text/template/parse/lex.go.html#3147146">itemChar</a></span>&nbsp;<span class="op" id="3191164">&amp;&amp;</span>&nbsp;<span class="ident" id="3191167"><a href="/gostd/text/template/parse/parse.go.html#3190901">next</a></span><span class="op" id="3191171">.</span><span class="ident" id="3191172"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span>&nbsp;<span class="op" id="3191176">==</span>&nbsp;<span class="string" id="3191179">&#34;,&#34;</span>&nbsp;<span class="op" id="3191183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3191190">if</span>&nbsp;<span class="ident" id="3191193"><a href="/gostd/text/template/parse/parse.go.html#3190367">context</a></span>&nbsp;<span class="op" id="3191201">==</span>&nbsp;<span class="string" id="3191204">&#34;range&#34;</span>&nbsp;<span class="op" id="3191212">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3191215">len</span><span class="op" id="3191218">(</span><span class="ident" id="3191219"><a href="/gostd/text/template/parse/parse.go.html#3190407">decl</a></span><span class="op" id="3191223">)</span>&nbsp;<span class="op" id="3191225">&lt;</span>&nbsp;<span class="num" id="3191227">2</span>&nbsp;<span class="op" id="3191229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3191237">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3191251">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191258"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191259">.</span><span class="ident" id="3191260"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3191266">(</span><span class="string" id="3191267">&#34;too&nbsp;many&nbsp;declarations&nbsp;in&nbsp;%s&#34;</span><span class="op" id="3191296">,</span>&nbsp;<span class="ident" id="3191298"><a href="/gostd/text/template/parse/parse.go.html#3190367">context</a></span><span class="op" id="3191305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3191311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3191316">}</span>&nbsp;<span class="keyword" id="3191318">else</span>&nbsp;<span class="keyword" id="3191323">if</span>&nbsp;<span class="ident" id="3191326"><a href="/gostd/text/template/parse/parse.go.html#3190864">tokenAfterVariable</a></span><span class="op" id="3191344">.</span><span class="ident" id="3191345"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3191349">==</span>&nbsp;<span class="ident" id="3191352"><a href="/gostd/text/template/parse/lex.go.html#3147894">itemSpace</a></span>&nbsp;<span class="op" id="3191362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191368"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191369">.</span><span class="ident" id="3191370"><a href="/gostd/text/template/parse/parse.go.html#3182989">backup3</a></span><span class="op" id="3191377">(</span><span class="ident" id="3191378"><a href="/gostd/text/template/parse/parse.go.html#3190497">v</a></span><span class="op" id="3191379">,</span>&nbsp;<span class="ident" id="3191381"><a href="/gostd/text/template/parse/parse.go.html#3190864">tokenAfterVariable</a></span><span class="op" id="3191399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3191404">}</span>&nbsp;<span class="keyword" id="3191406">else</span>&nbsp;<span class="op" id="3191411">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191417"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191418">.</span><span class="ident" id="3191419"><a href="/gostd/text/template/parse/parse.go.html#3182830">backup2</a></span><span class="op" id="3191426">(</span><span class="ident" id="3191427"><a href="/gostd/text/template/parse/parse.go.html#3190497">v</a></span><span class="op" id="3191428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3191433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3191437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3191441">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3191448">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191451"><a href="/gostd/text/template/parse/parse.go.html#3190384">pipe</a></span>&nbsp;<span class="op" id="3191456">=</span>&nbsp;<span class="ident" id="3191458"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191459">.</span><span class="ident" id="3191460"><a href="/gostd/text/template/parse/node.go.html#3164177">newPipeline</a></span><span class="op" id="3191471">(</span><span class="ident" id="3191472"><a href="/gostd/text/template/parse/parse.go.html#3190429">pos</a></span><span class="op" id="3191475">,</span>&nbsp;<span class="ident" id="3191477"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191478">.</span><span class="ident" id="3191479"><a href="/gostd/text/template/parse/parse.go.html#3181519">lex</a></span><span class="op" id="3191482">.</span><span class="ident" id="3191483"><a href="/gostd/text/template/parse/lex.go.html#3150902">lineNumber</a></span><span class="op" id="3191493">(</span><span class="op" id="3191494">)</span><span class="op" id="3191495">,</span>&nbsp;<span class="ident" id="3191497"><a href="/gostd/text/template/parse/parse.go.html#3190407">decl</a></span><span class="op" id="3191501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3191504">for</span>&nbsp;<span class="op" id="3191508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3191512">switch</span>&nbsp;<span class="ident" id="3191519">token</span>&nbsp;<span class="op" id="3191525">:=</span>&nbsp;<span class="ident" id="3191528"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191529">.</span><span class="ident" id="3191530"><a href="/gostd/text/template/parse/parse.go.html#3183378">nextNonSpace</a></span><span class="op" id="3191542">(</span><span class="op" id="3191543">)</span><span class="op" id="3191544">;</span>&nbsp;<span class="ident" id="3191546"><a href="/gostd/text/template/parse/parse.go.html#3191519">token</a></span><span class="op" id="3191551">.</span><span class="ident" id="3191552"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3191556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3191560">case</span>&nbsp;<span class="ident" id="3191565"><a href="/gostd/text/template/parse/lex.go.html#3147815">itemRightDelim</a></span><span class="op" id="3191579">,</span>&nbsp;<span class="ident" id="3191581"><a href="/gostd/text/template/parse/lex.go.html#3147857">itemRightParen</a></span><span class="op" id="3191595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3191600">if</span>&nbsp;<span class="builtinfunc" id="3191603">len</span><span class="op" id="3191606">(</span><span class="ident" id="3191607"><a href="/gostd/text/template/parse/parse.go.html#3190384">pipe</a></span><span class="op" id="3191611">.</span><span class="ident" id="3191612"><a href="/gostd/text/template/parse/node.go.html#3164104">Cmds</a></span><span class="op" id="3191616">)</span>&nbsp;<span class="op" id="3191618">==</span>&nbsp;<span class="num" id="3191621">0</span>&nbsp;<span class="op" id="3191623">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191629"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191630">.</span><span class="ident" id="3191631"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3191637">(</span><span class="string" id="3191638">&#34;missing&nbsp;value&nbsp;for&nbsp;%s&#34;</span><span class="op" id="3191660">,</span>&nbsp;<span class="ident" id="3191662"><a href="/gostd/text/template/parse/parse.go.html#3190367">context</a></span><span class="op" id="3191669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3191674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3191679">if</span>&nbsp;<span class="ident" id="3191682"><a href="/gostd/text/template/parse/parse.go.html#3191519">token</a></span><span class="op" id="3191687">.</span><span class="ident" id="3191688"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3191692">==</span>&nbsp;<span class="ident" id="3191695"><a href="/gostd/text/template/parse/lex.go.html#3147857">itemRightParen</a></span>&nbsp;<span class="op" id="3191710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191716"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191717">.</span><span class="ident" id="3191718"><a href="/gostd/text/template/parse/parse.go.html#3182699">backup</a></span><span class="op" id="3191724">(</span><span class="op" id="3191725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3191730">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3191735">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3191744">case</span>&nbsp;<span class="ident" id="3191749"><a href="/gostd/text/template/parse/lex.go.html#3147092">itemBool</a></span><span class="op" id="3191757">,</span>&nbsp;<span class="ident" id="3191759"><a href="/gostd/text/template/parse/lex.go.html#3147234">itemCharConstant</a></span><span class="op" id="3191775">,</span>&nbsp;<span class="ident" id="3191777"><a href="/gostd/text/template/parse/lex.go.html#3147290">itemComplex</a></span><span class="op" id="3191788">,</span>&nbsp;<span class="ident" id="3191790"><a href="/gostd/text/template/parse/lex.go.html#3148200">itemDot</a></span><span class="op" id="3191797">,</span>&nbsp;<span class="ident" id="3191799"><a href="/gostd/text/template/parse/lex.go.html#3147471">itemField</a></span><span class="op" id="3191808">,</span>&nbsp;<span class="ident" id="3191810"><a href="/gostd/text/template/parse/lex.go.html#3147532">itemIdentifier</a></span><span class="op" id="3191824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191829"><a href="/gostd/text/template/parse/lex.go.html#3147675">itemNumber</a></span><span class="op" id="3191839">,</span>&nbsp;<span class="ident" id="3191841"><a href="/gostd/text/template/parse/lex.go.html#3148360">itemNil</a></span><span class="op" id="3191848">,</span>&nbsp;<span class="ident" id="3191850"><a href="/gostd/text/template/parse/lex.go.html#3147760">itemRawString</a></span><span class="op" id="3191863">,</span>&nbsp;<span class="ident" id="3191865"><a href="/gostd/text/template/parse/lex.go.html#3147948">itemString</a></span><span class="op" id="3191875">,</span>&nbsp;<span class="ident" id="3191877"><a href="/gostd/text/template/parse/lex.go.html#3148029">itemVariable</a></span><span class="op" id="3191889">,</span>&nbsp;<span class="ident" id="3191891"><a href="/gostd/text/template/parse/lex.go.html#3147638">itemLeftParen</a></span><span class="op" id="3191904">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191909"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191910">.</span><span class="ident" id="3191911"><a href="/gostd/text/template/parse/parse.go.html#3182699">backup</a></span><span class="op" id="3191917">(</span><span class="op" id="3191918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191923"><a href="/gostd/text/template/parse/parse.go.html#3190384">pipe</a></span><span class="op" id="3191927">.</span><span class="builtinfunc" id="3191928"><a href="/gostd/text/template/parse/node.go.html#3164343">append</a></span><span class="op" id="3191934">(</span><span class="ident" id="3191935"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191936">.</span><span class="ident" id="3191937"><a href="/gostd/text/template/parse/parse.go.html#3195210">command</a></span><span class="op" id="3191944">(</span><span class="op" id="3191945">)</span><span class="op" id="3191946">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3191950">default</span><span class="op" id="3191957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3191962"><a href="/gostd/text/template/parse/parse.go.html#3190349">t</a></span><span class="op" id="3191963">.</span><span class="ident" id="3191964"><a href="/gostd/text/template/parse/parse.go.html#3185634">unexpected</a></span><span class="op" id="3191974">(</span><span class="ident" id="3191975"><a href="/gostd/text/template/parse/parse.go.html#3191519">token</a></span><span class="op" id="3191980">,</span>&nbsp;<span class="ident" id="3191982"><a href="/gostd/text/template/parse/parse.go.html#3190367">context</a></span><span class="op" id="3191989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3191993">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3191996">}</span><br>
<span class="lineno"></span><span class="op" id="3191998">}</span><br>
<span class="lineno">430</span><br>
<span class="lineno"></span><span class="keyword" id="3192001">func</span>&nbsp;<span class="op" id="3192006">(</span><span class="ident" id="3192007">t</span>&nbsp;<span class="op" id="3192009">*</span><span class="ident" id="3192010"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3192014">)</span>&nbsp;<span class="ident" id="3192016">parseControl</span><span class="op" id="3192028">(</span><span class="ident" id="3192029">allowElseIf</span>&nbsp;<span class="builtintype" id="3192041">bool</span><span class="op" id="3192045">,</span>&nbsp;<span class="ident" id="3192047">context</span>&nbsp;<span class="builtintype" id="3192055">string</span><span class="op" id="3192061">)</span>&nbsp;<span class="op" id="3192063">(</span><span class="ident" id="3192064">pos</span>&nbsp;<span class="ident" id="3192068"><a href="/gostd/text/template/parse/node.go.html#3161156">Pos</a></span><span class="op" id="3192071">,</span>&nbsp;<span class="ident" id="3192073">line</span>&nbsp;<span class="builtintype" id="3192078">int</span><span class="op" id="3192081">,</span>&nbsp;<span class="ident" id="3192083">pipe</span>&nbsp;<span class="op" id="3192088">*</span><span class="ident" id="3192089"><a href="/gostd/text/template/parse/node.go.html#3163902">PipeNode</a></span><span class="op" id="3192097">,</span>&nbsp;<span class="ident" id="3192099">list</span><span class="op" id="3192103">,</span>&nbsp;<span class="ident" id="3192105">elseList</span>&nbsp;<span class="op" id="3192114">*</span><span class="ident" id="3192115"><a href="/gostd/text/template/parse/node.go.html#3162635">ListNode</a></span><span class="op" id="3192123">)</span>&nbsp;<span class="op" id="3192125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3192128">defer</span>&nbsp;<span class="ident" id="3192134"><a href="/gostd/text/template/parse/parse.go.html#3192007">t</a></span><span class="op" id="3192135">.</span><span class="ident" id="3192136"><a href="/gostd/text/template/parse/parse.go.html#3198251">popVars</a></span><span class="op" id="3192143">(</span><span class="builtinfunc" id="3192144">len</span><span class="op" id="3192147">(</span><span class="ident" id="3192148"><a href="/gostd/text/template/parse/parse.go.html#3192007">t</a></span><span class="op" id="3192149">.</span><span class="ident" id="3192150"><a href="/gostd/text/template/parse/parse.go.html#3181608">vars</a></span><span class="op" id="3192154">)</span><span class="op" id="3192155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3192158"><a href="/gostd/text/template/parse/parse.go.html#3192073">line</a></span>&nbsp;<span class="op" id="3192163">=</span>&nbsp;<span class="ident" id="3192165"><a href="/gostd/text/template/parse/parse.go.html#3192007">t</a></span><span class="op" id="3192166">.</span><span class="ident" id="3192167"><a href="/gostd/text/template/parse/parse.go.html#3181519">lex</a></span><span class="op" id="3192170">.</span><span class="ident" id="3192171"><a href="/gostd/text/template/parse/lex.go.html#3150902">lineNumber</a></span><span class="op" id="3192181">(</span><span class="op" id="3192182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3192185"><a href="/gostd/text/template/parse/parse.go.html#3192083">pipe</a></span>&nbsp;<span class="op" id="3192190">=</span>&nbsp;<span class="ident" id="3192192"><a href="/gostd/text/template/parse/parse.go.html#3192007">t</a></span><span class="op" id="3192193">.</span><span class="ident" id="3192194"><a href="/gostd/text/template/parse/parse.go.html#3190358">pipeline</a></span><span class="op" id="3192202">(</span><span class="ident" id="3192203"><a href="/gostd/text/template/parse/parse.go.html#3192047">context</a></span><span class="op" id="3192210">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3192213">var</span>&nbsp;<span class="ident" id="3192217">next</span>&nbsp;<span class="ident" id="3192222"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3192228"><a href="/gostd/text/template/parse/parse.go.html#3192099">list</a></span><span class="op" id="3192232">,</span>&nbsp;<span class="ident" id="3192234"><a href="/gostd/text/template/parse/parse.go.html#3192217">next</a></span>&nbsp;<span class="op" id="3192239">=</span>&nbsp;<span class="ident" id="3192241"><a href="/gostd/text/template/parse/parse.go.html#3192007">t</a></span><span class="op" id="3192242">.</span><span class="ident" id="3192243"><a href="/gostd/text/template/parse/parse.go.html#3189129">itemList</a></span><span class="op" id="3192251">(</span><span class="op" id="3192252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3192255">switch</span>&nbsp;<span class="ident" id="3192262"><a href="/gostd/text/template/parse/parse.go.html#3192217">next</a></span><span class="op" id="3192266">.</span><span class="ident" id="3192267"><a href="/gostd/text/template/parse/node.go.html#3160552">Type</a></span><span class="op" id="3192271">(</span><span class="op" id="3192272">)</span>&nbsp;<span class="op" id="3192274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3192277">case</span>&nbsp;<span class="ident" id="3192282"><a href="/gostd/text/template/parse/node.go.html#3161830">nodeEnd</a></span><span class="op" id="3192289">:</span>&nbsp;<span class="comment" id="3192291">//done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3192299">case</span>&nbsp;<span class="ident" id="3192304"><a href="/gostd/text/template/parse/node.go.html#3161760">nodeElse</a></span><span class="op" id="3192312">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3192316">if</span>&nbsp;<span class="ident" id="3192319"><a href="/gostd/text/template/parse/parse.go.html#3192029">allowElseIf</a></span>&nbsp;<span class="op" id="3192331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3192336">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;&#34;else&nbsp;if&#34;.&nbsp;If&nbsp;the&nbsp;&#34;else&#34;&nbsp;is&nbsp;followed&nbsp;immediately&nbsp;by&nbsp;an&nbsp;&#34;if&#34;,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3192420">//&nbsp;the&nbsp;elseControl&nbsp;will&nbsp;have&nbsp;left&nbsp;the&nbsp;&#34;if&#34;&nbsp;token&nbsp;pending.&nbsp;Treat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3192487">//&nbsp;&nbsp;&nbsp;&nbsp;{{if&nbsp;a}}_{{else&nbsp;if&nbsp;b}}_{{end}}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3192524">//&nbsp;as</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3192533">//&nbsp;&nbsp;&nbsp;&nbsp;{{if&nbsp;a}}_{{else}}{{if&nbsp;b}}_{{end}}{{end}}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3192581">//&nbsp;To&nbsp;do&nbsp;this,&nbsp;parse&nbsp;the&nbsp;if&nbsp;as&nbsp;usual&nbsp;and&nbsp;stop&nbsp;at&nbsp;it&nbsp;{{end}};&nbsp;the&nbsp;subsequent{{end}}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3192667">//&nbsp;is&nbsp;assumed.&nbsp;This&nbsp;technique&nbsp;works&nbsp;even&nbsp;for&nbsp;long&nbsp;if-else-if&nbsp;chains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3192739">//&nbsp;TODO:&nbsp;Should&nbsp;we&nbsp;allow&nbsp;else-if&nbsp;in&nbsp;with&nbsp;and&nbsp;range?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3192794">if</span>&nbsp;<span class="ident" id="3192797"><a href="/gostd/text/template/parse/parse.go.html#3192007">t</a></span><span class="op" id="3192798">.</span><span class="ident" id="3192799"><a href="/gostd/text/template/parse/parse.go.html#3183172">peek</a></span><span class="op" id="3192803">(</span><span class="op" id="3192804">)</span><span class="op" id="3192805">.</span><span class="ident" id="3192806"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3192810">==</span>&nbsp;<span class="ident" id="3192813"><a href="/gostd/text/template/parse/lex.go.html#3148332">itemIf</a></span>&nbsp;<span class="op" id="3192820">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3192826"><a href="/gostd/text/template/parse/parse.go.html#3192007">t</a></span><span class="op" id="3192827">.</span><span class="ident" id="3192828"><a href="/gostd/text/template/parse/parse.go.html#3182508">next</a></span><span class="op" id="3192832">(</span><span class="op" id="3192833">)</span>&nbsp;<span class="comment" id="3192835">//&nbsp;Consume&nbsp;the&nbsp;&#34;if&#34;&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3192866"><a href="/gostd/text/template/parse/parse.go.html#3192105">elseList</a></span>&nbsp;<span class="op" id="3192875">=</span>&nbsp;<span class="ident" id="3192877"><a href="/gostd/text/template/parse/parse.go.html#3192007">t</a></span><span class="op" id="3192878">.</span><span class="ident" id="3192879"><a href="/gostd/text/template/parse/node.go.html#3162752">newList</a></span><span class="op" id="3192886">(</span><span class="ident" id="3192887"><a href="/gostd/text/template/parse/parse.go.html#3192217">next</a></span><span class="op" id="3192891">.</span><span class="ident" id="3192892"><a href="/gostd/text/template/parse/node.go.html#3160769">Position</a></span><span class="op" id="3192900">(</span><span class="op" id="3192901">)</span><span class="op" id="3192902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3192908"><a href="/gostd/text/template/parse/parse.go.html#3192105">elseList</a></span><span class="op" id="3192916">.</span><span class="builtinfunc" id="3192917"><a href="/gostd/text/template/parse/node.go.html#3162858">append</a></span><span class="op" id="3192923">(</span><span class="ident" id="3192924"><a href="/gostd/text/template/parse/parse.go.html#3192007">t</a></span><span class="op" id="3192925">.</span><span class="ident" id="3192926"><a href="/gostd/text/template/parse/parse.go.html#3193326">ifControl</a></span><span class="op" id="3192935">(</span><span class="op" id="3192936">)</span><span class="op" id="3192937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3192943">//&nbsp;Do&nbsp;not&nbsp;consume&nbsp;the&nbsp;next&nbsp;item&nbsp;-&nbsp;only&nbsp;one&nbsp;{{end}}&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3193008">break</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3193017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3193021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3193025"><a href="/gostd/text/template/parse/parse.go.html#3192105">elseList</a></span><span class="op" id="3193033">,</span>&nbsp;<span class="ident" id="3193035"><a href="/gostd/text/template/parse/parse.go.html#3192217">next</a></span>&nbsp;<span class="op" id="3193040">=</span>&nbsp;<span class="ident" id="3193042"><a href="/gostd/text/template/parse/parse.go.html#3192007">t</a></span><span class="op" id="3193043">.</span><span class="ident" id="3193044"><a href="/gostd/text/template/parse/parse.go.html#3189129">itemList</a></span><span class="op" id="3193052">(</span><span class="op" id="3193053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3193057">if</span>&nbsp;<span class="ident" id="3193060"><a href="/gostd/text/template/parse/parse.go.html#3192217">next</a></span><span class="op" id="3193064">.</span><span class="ident" id="3193065"><a href="/gostd/text/template/parse/node.go.html#3160552">Type</a></span><span class="op" id="3193069">(</span><span class="op" id="3193070">)</span>&nbsp;<span class="op" id="3193072">!=</span>&nbsp;<span class="ident" id="3193075"><a href="/gostd/text/template/parse/node.go.html#3161830">nodeEnd</a></span>&nbsp;<span class="op" id="3193083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3193088"><a href="/gostd/text/template/parse/parse.go.html#3192007">t</a></span><span class="op" id="3193089">.</span><span class="ident" id="3193090"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3193096">(</span><span class="string" id="3193097">&#34;expected&nbsp;end;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3193121">,</span>&nbsp;<span class="ident" id="3193123"><a href="/gostd/text/template/parse/parse.go.html#3192217">next</a></span><span class="op" id="3193127">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3193131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3193134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3193137">return</span>&nbsp;<span class="ident" id="3193144"><a href="/gostd/text/template/parse/parse.go.html#3192083">pipe</a></span><span class="op" id="3193148">.</span><span class="ident" id="3193149"><a href="/gostd/text/template/parse/node.go.html#3161178">Position</a></span><span class="op" id="3193157">(</span><span class="op" id="3193158">)</span><span class="op" id="3193159">,</span>&nbsp;<span class="ident" id="3193161"><a href="/gostd/text/template/parse/parse.go.html#3192073">line</a></span><span class="op" id="3193165">,</span>&nbsp;<span class="ident" id="3193167"><a href="/gostd/text/template/parse/parse.go.html#3192083">pipe</a></span><span class="op" id="3193171">,</span>&nbsp;<span class="ident" id="3193173"><a href="/gostd/text/template/parse/parse.go.html#3192099">list</a></span><span class="op" id="3193177">,</span>&nbsp;<span class="ident" id="3193179"><a href="/gostd/text/template/parse/parse.go.html#3192105">elseList</a></span><br>
<span class="lineno"></span><span class="op" id="3193188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="3193191">//&nbsp;If:</span><br>
<span class="lineno"></span><span class="comment" id="3193198">//&nbsp;&nbsp;&nbsp;&nbsp;{{if&nbsp;pipeline}}&nbsp;itemList&nbsp;{{end}}</span><br>
<span class="lineno"></span><span class="comment" id="3193234">//&nbsp;&nbsp;&nbsp;&nbsp;{{if&nbsp;pipeline}}&nbsp;itemList&nbsp;{{else}}&nbsp;itemList&nbsp;{{end}}</span><br>
<span class="lineno"></span><span class="comment" id="3193288">//&nbsp;If&nbsp;keyword&nbsp;is&nbsp;past.</span><br>
<span class="lineno"></span><span class="keyword" id="3193311">func</span>&nbsp;<span class="op" id="3193316">(</span><span class="ident" id="3193317">t</span>&nbsp;<span class="op" id="3193319">*</span><span class="ident" id="3193320"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3193324">)</span>&nbsp;<span class="ident" id="3193326">ifControl</span><span class="op" id="3193335">(</span><span class="op" id="3193336">)</span>&nbsp;<span class="ident" id="3193338"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span>&nbsp;<span class="op" id="3193343">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3193346">return</span>&nbsp;<span class="ident" id="3193353"><a href="/gostd/text/template/parse/parse.go.html#3193317">t</a></span><span class="op" id="3193354">.</span><span class="ident" id="3193355"><a href="/gostd/text/template/parse/node.go.html#3178495">newIf</a></span><span class="op" id="3193360">(</span><span class="ident" id="3193361"><a href="/gostd/text/template/parse/parse.go.html#3193317">t</a></span><span class="op" id="3193362">.</span><span class="ident" id="3193363"><a href="/gostd/text/template/parse/parse.go.html#3192016">parseControl</a></span><span class="op" id="3193375">(</span><span class="builtintype" id="3193376">true</span><span class="op" id="3193380">,</span>&nbsp;<span class="string" id="3193382">&#34;if&#34;</span><span class="op" id="3193386">)</span><span class="op" id="3193387">)</span><br>
<span class="lineno"></span><span class="op" id="3193389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3193392">//&nbsp;Range:</span><br>
<span class="lineno"></span><span class="comment" id="3193402">//&nbsp;&nbsp;&nbsp;&nbsp;{{range&nbsp;pipeline}}&nbsp;itemList&nbsp;{{end}}</span><br>
<span class="lineno">475</span><span class="comment" id="3193441">//&nbsp;&nbsp;&nbsp;&nbsp;{{range&nbsp;pipeline}}&nbsp;itemList&nbsp;{{else}}&nbsp;itemList&nbsp;{{end}}</span><br>
<span class="lineno"></span><span class="comment" id="3193498">//&nbsp;Range&nbsp;keyword&nbsp;is&nbsp;past.</span><br>
<span class="lineno"></span><span class="keyword" id="3193524">func</span>&nbsp;<span class="op" id="3193529">(</span><span class="ident" id="3193530">t</span>&nbsp;<span class="op" id="3193532">*</span><span class="ident" id="3193533"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3193537">)</span>&nbsp;<span class="ident" id="3193539">rangeControl</span><span class="op" id="3193551">(</span><span class="op" id="3193552">)</span>&nbsp;<span class="ident" id="3193554"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span>&nbsp;<span class="op" id="3193559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3193562">return</span>&nbsp;<span class="ident" id="3193569"><a href="/gostd/text/template/parse/parse.go.html#3193530">t</a></span><span class="op" id="3193570">.</span><span class="ident" id="3193571"><a href="/gostd/text/template/parse/node.go.html#3178938">newRange</a></span><span class="op" id="3193579">(</span><span class="ident" id="3193580"><a href="/gostd/text/template/parse/parse.go.html#3193530">t</a></span><span class="op" id="3193581">.</span><span class="ident" id="3193582"><a href="/gostd/text/template/parse/parse.go.html#3192016">parseControl</a></span><span class="op" id="3193594">(</span><span class="builtintype" id="3193595">false</span><span class="op" id="3193600">,</span>&nbsp;<span class="string" id="3193602">&#34;range&#34;</span><span class="op" id="3193609">)</span><span class="op" id="3193610">)</span><br>
<span class="lineno"></span><span class="op" id="3193612">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="comment" id="3193615">//&nbsp;With:</span><br>
<span class="lineno"></span><span class="comment" id="3193624">//&nbsp;&nbsp;&nbsp;&nbsp;{{with&nbsp;pipeline}}&nbsp;itemList&nbsp;{{end}}</span><br>
<span class="lineno"></span><span class="comment" id="3193662">//&nbsp;&nbsp;&nbsp;&nbsp;{{with&nbsp;pipeline}}&nbsp;itemList&nbsp;{{else}}&nbsp;itemList&nbsp;{{end}}</span><br>
<span class="lineno"></span><span class="comment" id="3193718">//&nbsp;If&nbsp;keyword&nbsp;is&nbsp;past.</span><br>
<span class="lineno">485</span><span class="keyword" id="3193741">func</span>&nbsp;<span class="op" id="3193746">(</span><span class="ident" id="3193747">t</span>&nbsp;<span class="op" id="3193749">*</span><span class="ident" id="3193750"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3193754">)</span>&nbsp;<span class="ident" id="3193756">withControl</span><span class="op" id="3193767">(</span><span class="op" id="3193768">)</span>&nbsp;<span class="ident" id="3193770"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span>&nbsp;<span class="op" id="3193775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3193778">return</span>&nbsp;<span class="ident" id="3193785"><a href="/gostd/text/template/parse/parse.go.html#3193747">t</a></span><span class="op" id="3193786">.</span><span class="ident" id="3193787"><a href="/gostd/text/template/parse/node.go.html#3179396">newWith</a></span><span class="op" id="3193794">(</span><span class="ident" id="3193795"><a href="/gostd/text/template/parse/parse.go.html#3193747">t</a></span><span class="op" id="3193796">.</span><span class="ident" id="3193797"><a href="/gostd/text/template/parse/parse.go.html#3192016">parseControl</a></span><span class="op" id="3193809">(</span><span class="builtintype" id="3193810">false</span><span class="op" id="3193815">,</span>&nbsp;<span class="string" id="3193817">&#34;with&#34;</span><span class="op" id="3193823">)</span><span class="op" id="3193824">)</span><br>
<span class="lineno"></span><span class="op" id="3193826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3193829">//&nbsp;End:</span><br>
<span class="lineno">490</span><span class="comment" id="3193837">//&nbsp;&nbsp;&nbsp;&nbsp;{{end}}</span><br>
<span class="lineno"></span><span class="comment" id="3193848">//&nbsp;End&nbsp;keyword&nbsp;is&nbsp;past.</span><br>
<span class="lineno"></span><span class="keyword" id="3193872">func</span>&nbsp;<span class="op" id="3193877">(</span><span class="ident" id="3193878">t</span>&nbsp;<span class="op" id="3193880">*</span><span class="ident" id="3193881"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3193885">)</span>&nbsp;<span class="ident" id="3193887">endControl</span><span class="op" id="3193897">(</span><span class="op" id="3193898">)</span>&nbsp;<span class="ident" id="3193900"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span>&nbsp;<span class="op" id="3193905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3193908">return</span>&nbsp;<span class="ident" id="3193915"><a href="/gostd/text/template/parse/parse.go.html#3193878">t</a></span><span class="op" id="3193916">.</span><span class="ident" id="3193917"><a href="/gostd/text/template/parse/node.go.html#3176366">newEnd</a></span><span class="op" id="3193923">(</span><span class="ident" id="3193924"><a href="/gostd/text/template/parse/parse.go.html#3193878">t</a></span><span class="op" id="3193925">.</span><span class="ident" id="3193926"><a href="/gostd/text/template/parse/parse.go.html#3185095">expect</a></span><span class="op" id="3193932">(</span><span class="ident" id="3193933"><a href="/gostd/text/template/parse/lex.go.html#3147815">itemRightDelim</a></span><span class="op" id="3193947">,</span>&nbsp;<span class="string" id="3193949">&#34;end&#34;</span><span class="op" id="3193954">)</span><span class="op" id="3193955">.</span><span class="ident" id="3193956"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3193959">)</span><br>
<span class="lineno"></span><span class="op" id="3193961">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="comment" id="3193964">//&nbsp;Else:</span><br>
<span class="lineno"></span><span class="comment" id="3193973">//&nbsp;&nbsp;&nbsp;&nbsp;{{else}}</span><br>
<span class="lineno"></span><span class="comment" id="3193985">//&nbsp;Else&nbsp;keyword&nbsp;is&nbsp;past.</span><br>
<span class="lineno"></span><span class="keyword" id="3194010">func</span>&nbsp;<span class="op" id="3194015">(</span><span class="ident" id="3194016">t</span>&nbsp;<span class="op" id="3194018">*</span><span class="ident" id="3194019"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3194023">)</span>&nbsp;<span class="ident" id="3194025">elseControl</span><span class="op" id="3194036">(</span><span class="op" id="3194037">)</span>&nbsp;<span class="ident" id="3194039"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span>&nbsp;<span class="op" id="3194044">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3194047">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;&#34;else&nbsp;if&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3194079">peek</span>&nbsp;<span class="op" id="3194084">:=</span>&nbsp;<span class="ident" id="3194087"><a href="/gostd/text/template/parse/parse.go.html#3194016">t</a></span><span class="op" id="3194088">.</span><span class="ident" id="3194089"><a href="/gostd/text/template/parse/parse.go.html#3183583">peekNonSpace</a></span><span class="op" id="3194101">(</span><span class="op" id="3194102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3194105">if</span>&nbsp;<span class="ident" id="3194108"><a href="/gostd/text/template/parse/parse.go.html#3194079">peek</a></span><span class="op" id="3194112">.</span><span class="ident" id="3194113"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3194117">==</span>&nbsp;<span class="ident" id="3194120"><a href="/gostd/text/template/parse/lex.go.html#3148332">itemIf</a></span>&nbsp;<span class="op" id="3194127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3194131">//&nbsp;We&nbsp;see&nbsp;&#34;{{else&nbsp;if&nbsp;...&nbsp;&#34;&nbsp;but&nbsp;in&nbsp;effect&nbsp;rewrite&nbsp;it&nbsp;to&nbsp;{{else}}{{if&nbsp;...&nbsp;&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3194208">return</span>&nbsp;<span class="ident" id="3194215"><a href="/gostd/text/template/parse/parse.go.html#3194016">t</a></span><span class="op" id="3194216">.</span><span class="ident" id="3194217"><a href="/gostd/text/template/parse/node.go.html#3176842">newElse</a></span><span class="op" id="3194224">(</span><span class="ident" id="3194225"><a href="/gostd/text/template/parse/parse.go.html#3194079">peek</a></span><span class="op" id="3194229">.</span><span class="ident" id="3194230"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3194233">,</span>&nbsp;<span class="ident" id="3194235"><a href="/gostd/text/template/parse/parse.go.html#3194016">t</a></span><span class="op" id="3194236">.</span><span class="ident" id="3194237"><a href="/gostd/text/template/parse/parse.go.html#3181519">lex</a></span><span class="op" id="3194240">.</span><span class="ident" id="3194241"><a href="/gostd/text/template/parse/lex.go.html#3150902">lineNumber</a></span><span class="op" id="3194251">(</span><span class="op" id="3194252">)</span><span class="op" id="3194253">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3194256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3194259">return</span>&nbsp;<span class="ident" id="3194266"><a href="/gostd/text/template/parse/parse.go.html#3194016">t</a></span><span class="op" id="3194267">.</span><span class="ident" id="3194268"><a href="/gostd/text/template/parse/node.go.html#3176842">newElse</a></span><span class="op" id="3194275">(</span><span class="ident" id="3194276"><a href="/gostd/text/template/parse/parse.go.html#3194016">t</a></span><span class="op" id="3194277">.</span><span class="ident" id="3194278"><a href="/gostd/text/template/parse/parse.go.html#3185095">expect</a></span><span class="op" id="3194284">(</span><span class="ident" id="3194285"><a href="/gostd/text/template/parse/lex.go.html#3147815">itemRightDelim</a></span><span class="op" id="3194299">,</span>&nbsp;<span class="string" id="3194301">&#34;else&#34;</span><span class="op" id="3194307">)</span><span class="op" id="3194308">.</span><span class="ident" id="3194309"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3194312">,</span>&nbsp;<span class="ident" id="3194314"><a href="/gostd/text/template/parse/parse.go.html#3194016">t</a></span><span class="op" id="3194315">.</span><span class="ident" id="3194316"><a href="/gostd/text/template/parse/parse.go.html#3181519">lex</a></span><span class="op" id="3194319">.</span><span class="ident" id="3194320"><a href="/gostd/text/template/parse/lex.go.html#3150902">lineNumber</a></span><span class="op" id="3194330">(</span><span class="op" id="3194331">)</span><span class="op" id="3194332">)</span><br>
<span class="lineno"></span><span class="op" id="3194334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3194337">//&nbsp;Template:</span><br>
<span class="lineno">510</span><span class="comment" id="3194350">//&nbsp;&nbsp;&nbsp;&nbsp;{{template&nbsp;stringValue&nbsp;pipeline}}</span><br>
<span class="lineno"></span><span class="comment" id="3194387">//&nbsp;Template&nbsp;keyword&nbsp;is&nbsp;past.&nbsp;&nbsp;The&nbsp;name&nbsp;must&nbsp;be&nbsp;something&nbsp;that&nbsp;can&nbsp;evaluate</span><br>
<span class="lineno"></span><span class="comment" id="3194462">//&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3194478">func</span>&nbsp;<span class="op" id="3194483">(</span><span class="ident" id="3194484">t</span>&nbsp;<span class="op" id="3194486">*</span><span class="ident" id="3194487"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3194491">)</span>&nbsp;<span class="ident" id="3194493">templateControl</span><span class="op" id="3194508">(</span><span class="op" id="3194509">)</span>&nbsp;<span class="ident" id="3194511"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span>&nbsp;<span class="op" id="3194516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3194519">var</span>&nbsp;<span class="ident" id="3194523">name</span>&nbsp;<span class="builtintype" id="3194528">string</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3194536">token</span>&nbsp;<span class="op" id="3194542">:=</span>&nbsp;<span class="ident" id="3194545"><a href="/gostd/text/template/parse/parse.go.html#3194484">t</a></span><span class="op" id="3194546">.</span><span class="ident" id="3194547"><a href="/gostd/text/template/parse/parse.go.html#3183378">nextNonSpace</a></span><span class="op" id="3194559">(</span><span class="op" id="3194560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3194563">switch</span>&nbsp;<span class="ident" id="3194570"><a href="/gostd/text/template/parse/parse.go.html#3194536">token</a></span><span class="op" id="3194575">.</span><span class="ident" id="3194576"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3194580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3194583">case</span>&nbsp;<span class="ident" id="3194588"><a href="/gostd/text/template/parse/lex.go.html#3147948">itemString</a></span><span class="op" id="3194598">,</span>&nbsp;<span class="ident" id="3194600"><a href="/gostd/text/template/parse/lex.go.html#3147760">itemRawString</a></span><span class="op" id="3194613">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3194617">s</span><span class="op" id="3194618">,</span>&nbsp;<span class="ident" id="3194620">err</span>&nbsp;<span class="op" id="3194624">:=</span>&nbsp;<span class="ident" id="3194627"><a href="/gostd/text/template/parse/parse.go.html#3181053">strconv</a></span><span class="op" id="3194634">.</span><span class="ident" id="3194635"><a href="/gostd/strconv/quote.go.html#2417743">Unquote</a></span><span class="op" id="3194642">(</span><span class="ident" id="3194643"><a href="/gostd/text/template/parse/parse.go.html#3194536">token</a></span><span class="op" id="3194648">.</span><span class="ident" id="3194649"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3194652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3194656">if</span>&nbsp;<span class="ident" id="3194659"><a href="/gostd/text/template/parse/parse.go.html#3194620">err</a></span>&nbsp;<span class="op" id="3194663">!=</span>&nbsp;<span class="builtintype" id="3194666">nil</span>&nbsp;<span class="op" id="3194670">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3194675"><a href="/gostd/text/template/parse/parse.go.html#3194484">t</a></span><span class="op" id="3194676">.</span><span class="builtintype" id="3194677"><a href="/gostd/text/template/parse/parse.go.html#3184962">error</a></span><span class="op" id="3194682">(</span><span class="ident" id="3194683"><a href="/gostd/text/template/parse/parse.go.html#3194620">err</a></span><span class="op" id="3194686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3194690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3194694"><a href="/gostd/text/template/parse/parse.go.html#3194523">name</a></span>&nbsp;<span class="op" id="3194699">=</span>&nbsp;<span class="ident" id="3194701"><a href="/gostd/text/template/parse/parse.go.html#3194617">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3194704">default</span><span class="op" id="3194711">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3194715"><a href="/gostd/text/template/parse/parse.go.html#3194484">t</a></span><span class="op" id="3194716">.</span><span class="ident" id="3194717"><a href="/gostd/text/template/parse/parse.go.html#3185634">unexpected</a></span><span class="op" id="3194727">(</span><span class="ident" id="3194728"><a href="/gostd/text/template/parse/parse.go.html#3194536">token</a></span><span class="op" id="3194733">,</span>&nbsp;<span class="string" id="3194735">&#34;template&nbsp;invocation&#34;</span><span class="op" id="3194756">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3194759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3194762">var</span>&nbsp;<span class="ident" id="3194766">pipe</span>&nbsp;<span class="op" id="3194771">*</span><span class="ident" id="3194772"><a href="/gostd/text/template/parse/node.go.html#3163902">PipeNode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3194782">if</span>&nbsp;<span class="ident" id="3194785"><a href="/gostd/text/template/parse/parse.go.html#3194484">t</a></span><span class="op" id="3194786">.</span><span class="ident" id="3194787"><a href="/gostd/text/template/parse/parse.go.html#3183378">nextNonSpace</a></span><span class="op" id="3194799">(</span><span class="op" id="3194800">)</span><span class="op" id="3194801">.</span><span class="ident" id="3194802"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3194806">!=</span>&nbsp;<span class="ident" id="3194809"><a href="/gostd/text/template/parse/lex.go.html#3147815">itemRightDelim</a></span>&nbsp;<span class="op" id="3194824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3194828"><a href="/gostd/text/template/parse/parse.go.html#3194484">t</a></span><span class="op" id="3194829">.</span><span class="ident" id="3194830"><a href="/gostd/text/template/parse/parse.go.html#3182699">backup</a></span><span class="op" id="3194836">(</span><span class="op" id="3194837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3194841">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables;&nbsp;they&nbsp;persist&nbsp;until&nbsp;&#34;end&#34;.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3194894"><a href="/gostd/text/template/parse/parse.go.html#3194766">pipe</a></span>&nbsp;<span class="op" id="3194899">=</span>&nbsp;<span class="ident" id="3194901"><a href="/gostd/text/template/parse/parse.go.html#3194484">t</a></span><span class="op" id="3194902">.</span><span class="ident" id="3194903"><a href="/gostd/text/template/parse/parse.go.html#3190358">pipeline</a></span><span class="op" id="3194911">(</span><span class="string" id="3194912">&#34;template&#34;</span><span class="op" id="3194922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3194925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3194928">return</span>&nbsp;<span class="ident" id="3194935"><a href="/gostd/text/template/parse/parse.go.html#3194484">t</a></span><span class="op" id="3194936">.</span><span class="ident" id="3194937"><a href="/gostd/text/template/parse/node.go.html#3180067">newTemplate</a></span><span class="op" id="3194948">(</span><span class="ident" id="3194949"><a href="/gostd/text/template/parse/parse.go.html#3194536">token</a></span><span class="op" id="3194954">.</span><span class="ident" id="3194955"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3194958">,</span>&nbsp;<span class="ident" id="3194960"><a href="/gostd/text/template/parse/parse.go.html#3194484">t</a></span><span class="op" id="3194961">.</span><span class="ident" id="3194962"><a href="/gostd/text/template/parse/parse.go.html#3181519">lex</a></span><span class="op" id="3194965">.</span><span class="ident" id="3194966"><a href="/gostd/text/template/parse/lex.go.html#3150902">lineNumber</a></span><span class="op" id="3194976">(</span><span class="op" id="3194977">)</span><span class="op" id="3194978">,</span>&nbsp;<span class="ident" id="3194980"><a href="/gostd/text/template/parse/parse.go.html#3194523">name</a></span><span class="op" id="3194984">,</span>&nbsp;<span class="ident" id="3194986"><a href="/gostd/text/template/parse/parse.go.html#3194766">pipe</a></span><span class="op" id="3194990">)</span><br>
<span class="lineno"></span><span class="op" id="3194992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="3194995">//&nbsp;command:</span><br>
<span class="lineno"></span><span class="comment" id="3195007">//&nbsp;&nbsp;&nbsp;&nbsp;operand&nbsp;(space&nbsp;operand)*</span><br>
<span class="lineno"></span><span class="comment" id="3195035">//&nbsp;space-separated&nbsp;arguments&nbsp;up&nbsp;to&nbsp;a&nbsp;pipeline&nbsp;character&nbsp;or&nbsp;right&nbsp;delimiter.</span><br>
<span class="lineno"></span><span class="comment" id="3195111">//&nbsp;we&nbsp;consume&nbsp;the&nbsp;pipe&nbsp;character&nbsp;but&nbsp;leave&nbsp;the&nbsp;right&nbsp;delim&nbsp;to&nbsp;terminate&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="3195195">func</span>&nbsp;<span class="op" id="3195200">(</span><span class="ident" id="3195201">t</span>&nbsp;<span class="op" id="3195203">*</span><span class="ident" id="3195204"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3195208">)</span>&nbsp;<span class="ident" id="3195210">command</span><span class="op" id="3195217">(</span><span class="op" id="3195218">)</span>&nbsp;<span class="op" id="3195220">*</span><span class="ident" id="3195221"><a href="/gostd/text/template/parse/node.go.html#3165933">CommandNode</a></span>&nbsp;<span class="op" id="3195233">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3195236">cmd</span>&nbsp;<span class="op" id="3195240">:=</span>&nbsp;<span class="ident" id="3195243"><a href="/gostd/text/template/parse/parse.go.html#3195201">t</a></span><span class="op" id="3195244">.</span><span class="ident" id="3195245"><a href="/gostd/text/template/parse/node.go.html#3166075">newCommand</a></span><span class="op" id="3195255">(</span><span class="ident" id="3195256"><a href="/gostd/text/template/parse/parse.go.html#3195201">t</a></span><span class="op" id="3195257">.</span><span class="ident" id="3195258"><a href="/gostd/text/template/parse/parse.go.html#3183583">peekNonSpace</a></span><span class="op" id="3195270">(</span><span class="op" id="3195271">)</span><span class="op" id="3195272">.</span><span class="ident" id="3195273"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3195276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195279">for</span>&nbsp;<span class="op" id="3195283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3195287"><a href="/gostd/text/template/parse/parse.go.html#3195201">t</a></span><span class="op" id="3195288">.</span><span class="ident" id="3195289"><a href="/gostd/text/template/parse/parse.go.html#3183583">peekNonSpace</a></span><span class="op" id="3195301">(</span><span class="op" id="3195302">)</span>&nbsp;<span class="comment" id="3195304">//&nbsp;skip&nbsp;leading&nbsp;spaces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3195330">operand</span>&nbsp;<span class="op" id="3195338">:=</span>&nbsp;<span class="ident" id="3195341"><a href="/gostd/text/template/parse/parse.go.html#3195201">t</a></span><span class="op" id="3195342">.</span><span class="ident" id="3195343"><a href="/gostd/text/template/parse/parse.go.html#3195953">operand</a></span><span class="op" id="3195350">(</span><span class="op" id="3195351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195355">if</span>&nbsp;<span class="ident" id="3195358"><a href="/gostd/text/template/parse/parse.go.html#3195330">operand</a></span>&nbsp;<span class="op" id="3195366">!=</span>&nbsp;<span class="builtintype" id="3195369">nil</span>&nbsp;<span class="op" id="3195373">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3195378"><a href="/gostd/text/template/parse/parse.go.html#3195236">cmd</a></span><span class="op" id="3195381">.</span><span class="builtinfunc" id="3195382"><a href="/gostd/text/template/parse/node.go.html#3166196">append</a></span><span class="op" id="3195388">(</span><span class="ident" id="3195389"><a href="/gostd/text/template/parse/parse.go.html#3195330">operand</a></span><span class="op" id="3195396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3195400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195404">switch</span>&nbsp;<span class="ident" id="3195411">token</span>&nbsp;<span class="op" id="3195417">:=</span>&nbsp;<span class="ident" id="3195420"><a href="/gostd/text/template/parse/parse.go.html#3195201">t</a></span><span class="op" id="3195421">.</span><span class="ident" id="3195422"><a href="/gostd/text/template/parse/parse.go.html#3182508">next</a></span><span class="op" id="3195426">(</span><span class="op" id="3195427">)</span><span class="op" id="3195428">;</span>&nbsp;<span class="ident" id="3195430"><a href="/gostd/text/template/parse/parse.go.html#3195411">token</a></span><span class="op" id="3195435">.</span><span class="ident" id="3195436"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3195440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195444">case</span>&nbsp;<span class="ident" id="3195449"><a href="/gostd/text/template/parse/lex.go.html#3147894">itemSpace</a></span><span class="op" id="3195458">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195463">continue</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195474">case</span>&nbsp;<span class="ident" id="3195479"><a href="/gostd/text/template/parse/lex.go.html#3147016">itemError</a></span><span class="op" id="3195488">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3195493"><a href="/gostd/text/template/parse/parse.go.html#3195201">t</a></span><span class="op" id="3195494">.</span><span class="ident" id="3195495"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3195501">(</span><span class="string" id="3195502">&#34;%s&#34;</span><span class="op" id="3195506">,</span>&nbsp;<span class="ident" id="3195508"><a href="/gostd/text/template/parse/parse.go.html#3195411">token</a></span><span class="op" id="3195513">.</span><span class="ident" id="3195514"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3195517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195521">case</span>&nbsp;<span class="ident" id="3195526"><a href="/gostd/text/template/parse/lex.go.html#3147815">itemRightDelim</a></span><span class="op" id="3195540">,</span>&nbsp;<span class="ident" id="3195542"><a href="/gostd/text/template/parse/lex.go.html#3147857">itemRightParen</a></span><span class="op" id="3195556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3195561"><a href="/gostd/text/template/parse/parse.go.html#3195201">t</a></span><span class="op" id="3195562">.</span><span class="ident" id="3195563"><a href="/gostd/text/template/parse/parse.go.html#3182699">backup</a></span><span class="op" id="3195569">(</span><span class="op" id="3195570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195574">case</span>&nbsp;<span class="ident" id="3195579"><a href="/gostd/text/template/parse/lex.go.html#3147729">itemPipe</a></span><span class="op" id="3195587">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195591">default</span><span class="op" id="3195598">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3195603"><a href="/gostd/text/template/parse/parse.go.html#3195201">t</a></span><span class="op" id="3195604">.</span><span class="ident" id="3195605"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3195611">(</span><span class="string" id="3195612">&#34;unexpected&nbsp;%s&nbsp;in&nbsp;operand;&nbsp;missing&nbsp;space?&#34;</span><span class="op" id="3195654">,</span>&nbsp;<span class="ident" id="3195656"><a href="/gostd/text/template/parse/parse.go.html#3195411">token</a></span><span class="op" id="3195661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3195665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195669">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3195676">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195679">if</span>&nbsp;<span class="builtinfunc" id="3195682">len</span><span class="op" id="3195685">(</span><span class="ident" id="3195686"><a href="/gostd/text/template/parse/parse.go.html#3195236">cmd</a></span><span class="op" id="3195689">.</span><span class="ident" id="3195690"><a href="/gostd/text/template/parse/node.go.html#3165982">Args</a></span><span class="op" id="3195694">)</span>&nbsp;<span class="op" id="3195696">==</span>&nbsp;<span class="num" id="3195699">0</span>&nbsp;<span class="op" id="3195701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3195705"><a href="/gostd/text/template/parse/parse.go.html#3195201">t</a></span><span class="op" id="3195706">.</span><span class="ident" id="3195707"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3195713">(</span><span class="string" id="3195714">&#34;empty&nbsp;command&#34;</span><span class="op" id="3195729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3195732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195735">return</span>&nbsp;<span class="ident" id="3195742"><a href="/gostd/text/template/parse/parse.go.html#3195236">cmd</a></span><br>
<span class="lineno"></span><span class="op" id="3195746">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span><span class="comment" id="3195749">//&nbsp;operand:</span><br>
<span class="lineno"></span><span class="comment" id="3195761">//&nbsp;&nbsp;&nbsp;&nbsp;term&nbsp;.Field*</span><br>
<span class="lineno"></span><span class="comment" id="3195777">//&nbsp;An&nbsp;operand&nbsp;is&nbsp;a&nbsp;space-separated&nbsp;component&nbsp;of&nbsp;a&nbsp;command,</span><br>
<span class="lineno"></span><span class="comment" id="3195836">//&nbsp;a&nbsp;term&nbsp;possibly&nbsp;followed&nbsp;by&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno">570</span><span class="comment" id="3195883">//&nbsp;A&nbsp;nil&nbsp;return&nbsp;means&nbsp;the&nbsp;next&nbsp;item&nbsp;is&nbsp;not&nbsp;an&nbsp;operand.</span><br>
<span class="lineno"></span><span class="keyword" id="3195938">func</span>&nbsp;<span class="op" id="3195943">(</span><span class="ident" id="3195944">t</span>&nbsp;<span class="op" id="3195946">*</span><span class="ident" id="3195947"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3195951">)</span>&nbsp;<span class="ident" id="3195953">operand</span><span class="op" id="3195960">(</span><span class="op" id="3195961">)</span>&nbsp;<span class="ident" id="3195963"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span>&nbsp;<span class="op" id="3195968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3195971">node</span>&nbsp;<span class="op" id="3195976">:=</span>&nbsp;<span class="ident" id="3195979"><a href="/gostd/text/template/parse/parse.go.html#3195944">t</a></span><span class="op" id="3195980">.</span><span class="ident" id="3195981"><a href="/gostd/text/template/parse/parse.go.html#3196820">term</a></span><span class="op" id="3195985">(</span><span class="op" id="3195986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3195989">if</span>&nbsp;<span class="ident" id="3195992"><a href="/gostd/text/template/parse/parse.go.html#3195971">node</a></span>&nbsp;<span class="op" id="3195997">==</span>&nbsp;<span class="builtintype" id="3196000">nil</span>&nbsp;<span class="op" id="3196004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196008">return</span>&nbsp;<span class="builtintype" id="3196015">nil</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3196020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196023">if</span>&nbsp;<span class="ident" id="3196026"><a href="/gostd/text/template/parse/parse.go.html#3195944">t</a></span><span class="op" id="3196027">.</span><span class="ident" id="3196028"><a href="/gostd/text/template/parse/parse.go.html#3183172">peek</a></span><span class="op" id="3196032">(</span><span class="op" id="3196033">)</span><span class="op" id="3196034">.</span><span class="ident" id="3196035"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3196039">==</span>&nbsp;<span class="ident" id="3196042"><a href="/gostd/text/template/parse/lex.go.html#3147471">itemField</a></span>&nbsp;<span class="op" id="3196052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196056">chain</span>&nbsp;<span class="op" id="3196062">:=</span>&nbsp;<span class="ident" id="3196065"><a href="/gostd/text/template/parse/parse.go.html#3195944">t</a></span><span class="op" id="3196066">.</span><span class="ident" id="3196067"><a href="/gostd/text/template/parse/node.go.html#3170698">newChain</a></span><span class="op" id="3196075">(</span><span class="ident" id="3196076"><a href="/gostd/text/template/parse/parse.go.html#3195944">t</a></span><span class="op" id="3196077">.</span><span class="ident" id="3196078"><a href="/gostd/text/template/parse/parse.go.html#3183172">peek</a></span><span class="op" id="3196082">(</span><span class="op" id="3196083">)</span><span class="op" id="3196084">.</span><span class="ident" id="3196085"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3196088">,</span>&nbsp;<span class="ident" id="3196090"><a href="/gostd/text/template/parse/parse.go.html#3195971">node</a></span><span class="op" id="3196094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196098">for</span>&nbsp;<span class="ident" id="3196102"><a href="/gostd/text/template/parse/parse.go.html#3195944">t</a></span><span class="op" id="3196103">.</span><span class="ident" id="3196104"><a href="/gostd/text/template/parse/parse.go.html#3183172">peek</a></span><span class="op" id="3196108">(</span><span class="op" id="3196109">)</span><span class="op" id="3196110">.</span><span class="ident" id="3196111"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3196115">==</span>&nbsp;<span class="ident" id="3196118"><a href="/gostd/text/template/parse/lex.go.html#3147471">itemField</a></span>&nbsp;<span class="op" id="3196128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196133"><a href="/gostd/text/template/parse/parse.go.html#3196056">chain</a></span><span class="op" id="3196138">.</span><span class="ident" id="3196139"><a href="/gostd/text/template/parse/node.go.html#3170920">Add</a></span><span class="op" id="3196142">(</span><span class="ident" id="3196143"><a href="/gostd/text/template/parse/parse.go.html#3195944">t</a></span><span class="op" id="3196144">.</span><span class="ident" id="3196145"><a href="/gostd/text/template/parse/parse.go.html#3182508">next</a></span><span class="op" id="3196149">(</span><span class="op" id="3196150">)</span><span class="op" id="3196151">.</span><span class="ident" id="3196152"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3196155">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3196159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3196163">//&nbsp;Compatibility&nbsp;with&nbsp;original&nbsp;API:&nbsp;If&nbsp;the&nbsp;term&nbsp;is&nbsp;of&nbsp;type&nbsp;NodeField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3196234">//&nbsp;or&nbsp;NodeVariable,&nbsp;just&nbsp;put&nbsp;more&nbsp;fields&nbsp;on&nbsp;the&nbsp;original.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3196294">//&nbsp;Otherwise,&nbsp;keep&nbsp;the&nbsp;Chain&nbsp;node.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3196331">//&nbsp;TODO:&nbsp;Switch&nbsp;to&nbsp;Chains&nbsp;always&nbsp;when&nbsp;we&nbsp;can.</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196379">switch</span>&nbsp;<span class="ident" id="3196386"><a href="/gostd/text/template/parse/parse.go.html#3195971">node</a></span><span class="op" id="3196390">.</span><span class="ident" id="3196391"><a href="/gostd/text/template/parse/node.go.html#3160552">Type</a></span><span class="op" id="3196395">(</span><span class="op" id="3196396">)</span>&nbsp;<span class="op" id="3196398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196402">case</span>&nbsp;<span class="ident" id="3196407"><a href="/gostd/text/template/parse/node.go.html#3161899">NodeField</a></span><span class="op" id="3196416">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196421"><a href="/gostd/text/template/parse/parse.go.html#3195971">node</a></span>&nbsp;<span class="op" id="3196426">=</span>&nbsp;<span class="ident" id="3196428"><a href="/gostd/text/template/parse/parse.go.html#3195944">t</a></span><span class="op" id="3196429">.</span><span class="ident" id="3196430"><a href="/gostd/text/template/parse/node.go.html#3169913">newField</a></span><span class="op" id="3196438">(</span><span class="ident" id="3196439"><a href="/gostd/text/template/parse/parse.go.html#3196056">chain</a></span><span class="op" id="3196444">.</span><span class="ident" id="3196445"><a href="/gostd/text/template/parse/node.go.html#3161178">Position</a></span><span class="op" id="3196453">(</span><span class="op" id="3196454">)</span><span class="op" id="3196455">,</span>&nbsp;<span class="ident" id="3196457"><a href="/gostd/text/template/parse/parse.go.html#3196056">chain</a></span><span class="op" id="3196462">.</span><span class="ident" id="3196463"><a href="/gostd/text/template/parse/node.go.html#3171154">String</a></span><span class="op" id="3196469">(</span><span class="op" id="3196470">)</span><span class="op" id="3196471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196475">case</span>&nbsp;<span class="ident" id="3196480"><a href="/gostd/text/template/parse/node.go.html#3162479">NodeVariable</a></span><span class="op" id="3196492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196497"><a href="/gostd/text/template/parse/parse.go.html#3195971">node</a></span>&nbsp;<span class="op" id="3196502">=</span>&nbsp;<span class="ident" id="3196504"><a href="/gostd/text/template/parse/parse.go.html#3195944">t</a></span><span class="op" id="3196505">.</span><span class="ident" id="3196506"><a href="/gostd/text/template/parse/node.go.html#3167991">newVariable</a></span><span class="op" id="3196517">(</span><span class="ident" id="3196518"><a href="/gostd/text/template/parse/parse.go.html#3196056">chain</a></span><span class="op" id="3196523">.</span><span class="ident" id="3196524"><a href="/gostd/text/template/parse/node.go.html#3161178">Position</a></span><span class="op" id="3196532">(</span><span class="op" id="3196533">)</span><span class="op" id="3196534">,</span>&nbsp;<span class="ident" id="3196536"><a href="/gostd/text/template/parse/parse.go.html#3196056">chain</a></span><span class="op" id="3196541">.</span><span class="ident" id="3196542"><a href="/gostd/text/template/parse/node.go.html#3171154">String</a></span><span class="op" id="3196548">(</span><span class="op" id="3196549">)</span><span class="op" id="3196550">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196554">default</span><span class="op" id="3196561">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196566"><a href="/gostd/text/template/parse/parse.go.html#3195971">node</a></span>&nbsp;<span class="op" id="3196571">=</span>&nbsp;<span class="ident" id="3196573"><a href="/gostd/text/template/parse/parse.go.html#3196056">chain</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3196581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3196584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196587">return</span>&nbsp;<span class="ident" id="3196594"><a href="/gostd/text/template/parse/parse.go.html#3195971">node</a></span><br>
<span class="lineno">595</span><span class="op" id="3196599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3196602">//&nbsp;term:</span><br>
<span class="lineno"></span><span class="comment" id="3196611">//&nbsp;&nbsp;&nbsp;&nbsp;literal&nbsp;(number,&nbsp;string,&nbsp;nil,&nbsp;boolean)</span><br>
<span class="lineno"></span><span class="comment" id="3196653">//&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(identifier)</span><br>
<span class="lineno">600</span><span class="comment" id="3196678">//&nbsp;&nbsp;&nbsp;&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="3196683">//&nbsp;&nbsp;&nbsp;&nbsp;.Field</span><br>
<span class="lineno"></span><span class="comment" id="3196693">//&nbsp;&nbsp;&nbsp;&nbsp;$</span><br>
<span class="lineno"></span><span class="comment" id="3196698">//&nbsp;&nbsp;&nbsp;&nbsp;&#39;(&#39;&nbsp;pipeline&nbsp;&#39;)&#39;</span><br>
<span class="lineno"></span><span class="comment" id="3196718">//&nbsp;A&nbsp;term&nbsp;is&nbsp;a&nbsp;simple&nbsp;&#34;expression&#34;.</span><br>
<span class="lineno">605</span><span class="comment" id="3196754">//&nbsp;A&nbsp;nil&nbsp;return&nbsp;means&nbsp;the&nbsp;next&nbsp;item&nbsp;is&nbsp;not&nbsp;a&nbsp;term.</span><br>
<span class="lineno"></span><span class="keyword" id="3196805">func</span>&nbsp;<span class="op" id="3196810">(</span><span class="ident" id="3196811">t</span>&nbsp;<span class="op" id="3196813">*</span><span class="ident" id="3196814"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3196818">)</span>&nbsp;<span class="ident" id="3196820">term</span><span class="op" id="3196824">(</span><span class="op" id="3196825">)</span>&nbsp;<span class="ident" id="3196827"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span>&nbsp;<span class="op" id="3196832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196835">switch</span>&nbsp;<span class="ident" id="3196842">token</span>&nbsp;<span class="op" id="3196848">:=</span>&nbsp;<span class="ident" id="3196851"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3196852">.</span><span class="ident" id="3196853"><a href="/gostd/text/template/parse/parse.go.html#3183378">nextNonSpace</a></span><span class="op" id="3196865">(</span><span class="op" id="3196866">)</span><span class="op" id="3196867">;</span>&nbsp;<span class="ident" id="3196869"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3196874">.</span><span class="ident" id="3196875"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3196879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196882">case</span>&nbsp;<span class="ident" id="3196887"><a href="/gostd/text/template/parse/lex.go.html#3147016">itemError</a></span><span class="op" id="3196896">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196900"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3196901">.</span><span class="ident" id="3196902"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3196908">(</span><span class="string" id="3196909">&#34;%s&#34;</span><span class="op" id="3196913">,</span>&nbsp;<span class="ident" id="3196915"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3196920">.</span><span class="ident" id="3196921"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3196924">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196927">case</span>&nbsp;<span class="ident" id="3196932"><a href="/gostd/text/template/parse/lex.go.html#3147532">itemIdentifier</a></span><span class="op" id="3196946">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3196950">if</span>&nbsp;<span class="op" id="3196953">!</span><span class="ident" id="3196954"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3196955">.</span><span class="ident" id="3196956"><a href="/gostd/text/template/parse/parse.go.html#3198005">hasFunction</a></span><span class="op" id="3196967">(</span><span class="ident" id="3196968"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3196973">.</span><span class="ident" id="3196974"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3196977">)</span>&nbsp;<span class="op" id="3196979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3196984"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3196985">.</span><span class="ident" id="3196986"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3196992">(</span><span class="string" id="3196993">&#34;function&nbsp;%q&nbsp;not&nbsp;defined&#34;</span><span class="op" id="3197018">,</span>&nbsp;<span class="ident" id="3197020"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197025">.</span><span class="ident" id="3197026"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3197029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3197033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197037">return</span>&nbsp;<span class="ident" id="3197044"><a href="/gostd/text/template/parse/node.go.html#3166913">NewIdentifier</a></span><span class="op" id="3197057">(</span><span class="ident" id="3197058"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197063">.</span><span class="ident" id="3197064"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3197067">)</span><span class="op" id="3197068">.</span><span class="ident" id="3197069"><a href="/gostd/text/template/parse/node.go.html#3167445">SetTree</a></span><span class="op" id="3197076">(</span><span class="ident" id="3197077"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197078">)</span><span class="op" id="3197079">.</span><span class="ident" id="3197080"><a href="/gostd/text/template/parse/node.go.html#3167197">SetPos</a></span><span class="op" id="3197086">(</span><span class="ident" id="3197087"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197092">.</span><span class="ident" id="3197093"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3197096">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197099">case</span>&nbsp;<span class="ident" id="3197104"><a href="/gostd/text/template/parse/lex.go.html#3148200">itemDot</a></span><span class="op" id="3197111">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197115">return</span>&nbsp;<span class="ident" id="3197122"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197123">.</span><span class="ident" id="3197124"><a href="/gostd/text/template/parse/node.go.html#3168588">newDot</a></span><span class="op" id="3197130">(</span><span class="ident" id="3197131"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197136">.</span><span class="ident" id="3197137"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3197140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197143">case</span>&nbsp;<span class="ident" id="3197148"><a href="/gostd/text/template/parse/lex.go.html#3148360">itemNil</a></span><span class="op" id="3197155">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197159">return</span>&nbsp;<span class="ident" id="3197166"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197167">.</span><span class="ident" id="3197168"><a href="/gostd/text/template/parse/node.go.html#3169193">newNil</a></span><span class="op" id="3197174">(</span><span class="ident" id="3197175"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197180">.</span><span class="ident" id="3197181"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3197184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197187">case</span>&nbsp;<span class="ident" id="3197192"><a href="/gostd/text/template/parse/lex.go.html#3148029">itemVariable</a></span><span class="op" id="3197204">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197208">return</span>&nbsp;<span class="ident" id="3197215"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197216">.</span><span class="ident" id="3197217"><a href="/gostd/text/template/parse/parse.go.html#3198403">useVar</a></span><span class="op" id="3197223">(</span><span class="ident" id="3197224"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197229">.</span><span class="ident" id="3197230"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3197233">,</span>&nbsp;<span class="ident" id="3197235"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197240">.</span><span class="ident" id="3197241"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3197244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197247">case</span>&nbsp;<span class="ident" id="3197252"><a href="/gostd/text/template/parse/lex.go.html#3147471">itemField</a></span><span class="op" id="3197261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197265">return</span>&nbsp;<span class="ident" id="3197272"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197273">.</span><span class="ident" id="3197274"><a href="/gostd/text/template/parse/node.go.html#3169913">newField</a></span><span class="op" id="3197282">(</span><span class="ident" id="3197283"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197288">.</span><span class="ident" id="3197289"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3197292">,</span>&nbsp;<span class="ident" id="3197294"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197299">.</span><span class="ident" id="3197300"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3197303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197306">case</span>&nbsp;<span class="ident" id="3197311"><a href="/gostd/text/template/parse/lex.go.html#3147092">itemBool</a></span><span class="op" id="3197319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197323">return</span>&nbsp;<span class="ident" id="3197330"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197331">.</span><span class="ident" id="3197332"><a href="/gostd/text/template/parse/node.go.html#3171681">newBool</a></span><span class="op" id="3197339">(</span><span class="ident" id="3197340"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197345">.</span><span class="ident" id="3197346"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3197349">,</span>&nbsp;<span class="ident" id="3197351"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197356">.</span><span class="ident" id="3197357"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span>&nbsp;<span class="op" id="3197361">==</span>&nbsp;<span class="string" id="3197364">&#34;true&#34;</span><span class="op" id="3197370">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197373">case</span>&nbsp;<span class="ident" id="3197378"><a href="/gostd/text/template/parse/lex.go.html#3147234">itemCharConstant</a></span><span class="op" id="3197394">,</span>&nbsp;<span class="ident" id="3197396"><a href="/gostd/text/template/parse/lex.go.html#3147290">itemComplex</a></span><span class="op" id="3197407">,</span>&nbsp;<span class="ident" id="3197409"><a href="/gostd/text/template/parse/lex.go.html#3147675">itemNumber</a></span><span class="op" id="3197419">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197423">number</span><span class="op" id="3197429">,</span>&nbsp;<span class="ident" id="3197431">err</span>&nbsp;<span class="op" id="3197435">:=</span>&nbsp;<span class="ident" id="3197438"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197439">.</span><span class="ident" id="3197440"><a href="/gostd/text/template/parse/node.go.html#3172828">newNumber</a></span><span class="op" id="3197449">(</span><span class="ident" id="3197450"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197455">.</span><span class="ident" id="3197456"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3197459">,</span>&nbsp;<span class="ident" id="3197461"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197466">.</span><span class="ident" id="3197467"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3197470">,</span>&nbsp;<span class="ident" id="3197472"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197477">.</span><span class="ident" id="3197478"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span><span class="op" id="3197481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197485">if</span>&nbsp;<span class="ident" id="3197488"><a href="/gostd/text/template/parse/parse.go.html#3197431">err</a></span>&nbsp;<span class="op" id="3197492">!=</span>&nbsp;<span class="builtintype" id="3197495">nil</span>&nbsp;<span class="op" id="3197499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197504"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197505">.</span><span class="builtintype" id="3197506"><a href="/gostd/text/template/parse/parse.go.html#3184962">error</a></span><span class="op" id="3197511">(</span><span class="ident" id="3197512"><a href="/gostd/text/template/parse/parse.go.html#3197431">err</a></span><span class="op" id="3197515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3197519">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197523">return</span>&nbsp;<span class="ident" id="3197530"><a href="/gostd/text/template/parse/parse.go.html#3197423">number</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197538">case</span>&nbsp;<span class="ident" id="3197543"><a href="/gostd/text/template/parse/lex.go.html#3147638">itemLeftParen</a></span><span class="op" id="3197556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197560">pipe</span>&nbsp;<span class="op" id="3197565">:=</span>&nbsp;<span class="ident" id="3197568"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197569">.</span><span class="ident" id="3197570"><a href="/gostd/text/template/parse/parse.go.html#3190358">pipeline</a></span><span class="op" id="3197578">(</span><span class="string" id="3197579">&#34;parenthesized&nbsp;pipeline&#34;</span><span class="op" id="3197603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197607">if</span>&nbsp;<span class="ident" id="3197610">token</span>&nbsp;<span class="op" id="3197616">:=</span>&nbsp;<span class="ident" id="3197619"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197620">.</span><span class="ident" id="3197621"><a href="/gostd/text/template/parse/parse.go.html#3182508">next</a></span><span class="op" id="3197625">(</span><span class="op" id="3197626">)</span><span class="op" id="3197627">;</span>&nbsp;<span class="ident" id="3197629"><a href="/gostd/text/template/parse/parse.go.html#3197610">token</a></span><span class="op" id="3197634">.</span><span class="ident" id="3197635"><a href="/gostd/text/template/parse/lex.go.html#3146488">typ</a></span>&nbsp;<span class="op" id="3197639">!=</span>&nbsp;<span class="ident" id="3197642"><a href="/gostd/text/template/parse/lex.go.html#3147857">itemRightParen</a></span>&nbsp;<span class="op" id="3197657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197662"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197663">.</span><span class="ident" id="3197664"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3197670">(</span><span class="string" id="3197671">&#34;unclosed&nbsp;right&nbsp;paren:&nbsp;unexpected&nbsp;%s&#34;</span><span class="op" id="3197708">,</span>&nbsp;<span class="ident" id="3197710"><a href="/gostd/text/template/parse/parse.go.html#3197610">token</a></span><span class="op" id="3197715">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3197719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197723">return</span>&nbsp;<span class="ident" id="3197730"><a href="/gostd/text/template/parse/parse.go.html#3197560">pipe</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197736">case</span>&nbsp;<span class="ident" id="3197741"><a href="/gostd/text/template/parse/lex.go.html#3147948">itemString</a></span><span class="op" id="3197751">,</span>&nbsp;<span class="ident" id="3197753"><a href="/gostd/text/template/parse/lex.go.html#3147760">itemRawString</a></span><span class="op" id="3197766">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197770">s</span><span class="op" id="3197771">,</span>&nbsp;<span class="ident" id="3197773">err</span>&nbsp;<span class="op" id="3197777">:=</span>&nbsp;<span class="ident" id="3197780"><a href="/gostd/text/template/parse/parse.go.html#3181053">strconv</a></span><span class="op" id="3197787">.</span><span class="ident" id="3197788"><a href="/gostd/strconv/quote.go.html#2417743">Unquote</a></span><span class="op" id="3197795">(</span><span class="ident" id="3197796"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197801">.</span><span class="ident" id="3197802"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3197805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197809">if</span>&nbsp;<span class="ident" id="3197812"><a href="/gostd/text/template/parse/parse.go.html#3197773">err</a></span>&nbsp;<span class="op" id="3197816">!=</span>&nbsp;<span class="builtintype" id="3197819">nil</span>&nbsp;<span class="op" id="3197823">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197828"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197829">.</span><span class="builtintype" id="3197830"><a href="/gostd/text/template/parse/parse.go.html#3184962">error</a></span><span class="op" id="3197835">(</span><span class="ident" id="3197836"><a href="/gostd/text/template/parse/parse.go.html#3197773">err</a></span><span class="op" id="3197839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3197843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197847">return</span>&nbsp;<span class="ident" id="3197854"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197855">.</span><span class="ident" id="3197856"><a href="/gostd/text/template/parse/node.go.html#3175876">newString</a></span><span class="op" id="3197865">(</span><span class="ident" id="3197866"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197871">.</span><span class="ident" id="3197872"><a href="/gostd/text/template/parse/lex.go.html#3146528">pos</a></span><span class="op" id="3197875">,</span>&nbsp;<span class="ident" id="3197877"><a href="/gostd/text/template/parse/parse.go.html#3196842">token</a></span><span class="op" id="3197882">.</span><span class="ident" id="3197883"><a href="/gostd/text/template/parse/lex.go.html#3146612">val</a></span><span class="op" id="3197886">,</span>&nbsp;<span class="ident" id="3197888"><a href="/gostd/text/template/parse/parse.go.html#3197770">s</a></span><span class="op" id="3197889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3197892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3197895"><a href="/gostd/text/template/parse/parse.go.html#3196811">t</a></span><span class="op" id="3197896">.</span><span class="ident" id="3197897"><a href="/gostd/text/template/parse/parse.go.html#3182699">backup</a></span><span class="op" id="3197903">(</span><span class="op" id="3197904">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3197907">return</span>&nbsp;<span class="builtintype" id="3197914">nil</span><br>
<span class="lineno"></span><span class="op" id="3197918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3197921">//&nbsp;hasFunction&nbsp;reports&nbsp;if&nbsp;a&nbsp;function&nbsp;name&nbsp;exists&nbsp;in&nbsp;the&nbsp;Tree&#39;s&nbsp;maps.</span><br>
<span class="lineno"></span><span class="keyword" id="3197990">func</span>&nbsp;<span class="op" id="3197995">(</span><span class="ident" id="3197996">t</span>&nbsp;<span class="op" id="3197998">*</span><span class="ident" id="3197999"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3198003">)</span>&nbsp;<span class="ident" id="3198005">hasFunction</span><span class="op" id="3198016">(</span><span class="ident" id="3198017">name</span>&nbsp;<span class="builtintype" id="3198022">string</span><span class="op" id="3198028">)</span>&nbsp;<span class="builtintype" id="3198030">bool</span>&nbsp;<span class="op" id="3198035">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198038">for</span>&nbsp;<span class="ident" id="3198042">_</span><span class="op" id="3198043">,</span>&nbsp;<span class="ident" id="3198045">funcMap</span>&nbsp;<span class="op" id="3198053">:=</span>&nbsp;<span class="keyword" id="3198056">range</span>&nbsp;<span class="ident" id="3198062"><a href="/gostd/text/template/parse/parse.go.html#3197996">t</a></span><span class="op" id="3198063">.</span><span class="ident" id="3198064"><a href="/gostd/text/template/parse/parse.go.html#3181483">funcs</a></span>&nbsp;<span class="op" id="3198070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198074">if</span>&nbsp;<span class="ident" id="3198077"><a href="/gostd/text/template/parse/parse.go.html#3198045">funcMap</a></span>&nbsp;<span class="op" id="3198085">==</span>&nbsp;<span class="builtintype" id="3198088">nil</span>&nbsp;<span class="op" id="3198092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198097">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3198108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198112">if</span>&nbsp;<span class="ident" id="3198115"><a href="/gostd/text/template/parse/parse.go.html#3198045">funcMap</a></span><span class="op" id="3198122">[</span><span class="ident" id="3198123"><a href="/gostd/text/template/parse/parse.go.html#3198017">name</a></span><span class="op" id="3198127">]</span>&nbsp;<span class="op" id="3198129">!=</span>&nbsp;<span class="builtintype" id="3198132">nil</span>&nbsp;<span class="op" id="3198136">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198141">return</span>&nbsp;<span class="builtintype" id="3198148">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3198155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3198158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198161">return</span>&nbsp;<span class="builtintype" id="3198168">false</span><br>
<span class="lineno"></span><span class="op" id="3198174">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="comment" id="3198177">//&nbsp;popVars&nbsp;trims&nbsp;the&nbsp;variable&nbsp;list&nbsp;to&nbsp;the&nbsp;specified&nbsp;length</span><br>
<span class="lineno"></span><span class="keyword" id="3198236">func</span>&nbsp;<span class="op" id="3198241">(</span><span class="ident" id="3198242">t</span>&nbsp;<span class="op" id="3198244">*</span><span class="ident" id="3198245"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3198249">)</span>&nbsp;<span class="ident" id="3198251">popVars</span><span class="op" id="3198258">(</span><span class="ident" id="3198259">n</span>&nbsp;<span class="builtintype" id="3198261">int</span><span class="op" id="3198264">)</span>&nbsp;<span class="op" id="3198266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3198269"><a href="/gostd/text/template/parse/parse.go.html#3198242">t</a></span><span class="op" id="3198270">.</span><span class="ident" id="3198271"><a href="/gostd/text/template/parse/parse.go.html#3181608">vars</a></span>&nbsp;<span class="op" id="3198276">=</span>&nbsp;<span class="ident" id="3198278"><a href="/gostd/text/template/parse/parse.go.html#3198242">t</a></span><span class="op" id="3198279">.</span><span class="ident" id="3198280"><a href="/gostd/text/template/parse/parse.go.html#3181608">vars</a></span><span class="op" id="3198284">[</span><span class="op" id="3198285">:</span><span class="ident" id="3198286"><a href="/gostd/text/template/parse/parse.go.html#3198259">n</a></span><span class="op" id="3198287">]</span><br>
<span class="lineno"></span><span class="op" id="3198289">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="comment" id="3198292">//&nbsp;useVar&nbsp;returns&nbsp;a&nbsp;node&nbsp;for&nbsp;a&nbsp;variable&nbsp;reference.&nbsp;It&nbsp;errors&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3198360">//&nbsp;variable&nbsp;is&nbsp;not&nbsp;defined.</span><br>
<span class="lineno"></span><span class="keyword" id="3198388">func</span>&nbsp;<span class="op" id="3198393">(</span><span class="ident" id="3198394">t</span>&nbsp;<span class="op" id="3198396">*</span><span class="ident" id="3198397"><a href="/gostd/text/template/parse/parse.go.html#3181141">Tree</a></span><span class="op" id="3198401">)</span>&nbsp;<span class="ident" id="3198403">useVar</span><span class="op" id="3198409">(</span><span class="ident" id="3198410">pos</span>&nbsp;<span class="ident" id="3198414"><a href="/gostd/text/template/parse/node.go.html#3161156">Pos</a></span><span class="op" id="3198417">,</span>&nbsp;<span class="ident" id="3198419">name</span>&nbsp;<span class="builtintype" id="3198424">string</span><span class="op" id="3198430">)</span>&nbsp;<span class="ident" id="3198432"><a href="/gostd/text/template/parse/node.go.html#3160534">Node</a></span>&nbsp;<span class="op" id="3198437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3198440">v</span>&nbsp;<span class="op" id="3198442">:=</span>&nbsp;<span class="ident" id="3198445"><a href="/gostd/text/template/parse/parse.go.html#3198394">t</a></span><span class="op" id="3198446">.</span><span class="ident" id="3198447"><a href="/gostd/text/template/parse/node.go.html#3167991">newVariable</a></span><span class="op" id="3198458">(</span><span class="ident" id="3198459"><a href="/gostd/text/template/parse/parse.go.html#3198410">pos</a></span><span class="op" id="3198462">,</span>&nbsp;<span class="ident" id="3198464"><a href="/gostd/text/template/parse/parse.go.html#3198419">name</a></span><span class="op" id="3198468">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198471">for</span>&nbsp;<span class="ident" id="3198475">_</span><span class="op" id="3198476">,</span>&nbsp;<span class="ident" id="3198478">varName</span>&nbsp;<span class="op" id="3198486">:=</span>&nbsp;<span class="keyword" id="3198489">range</span>&nbsp;<span class="ident" id="3198495"><a href="/gostd/text/template/parse/parse.go.html#3198394">t</a></span><span class="op" id="3198496">.</span><span class="ident" id="3198497"><a href="/gostd/text/template/parse/parse.go.html#3181608">vars</a></span>&nbsp;<span class="op" id="3198502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198506">if</span>&nbsp;<span class="ident" id="3198509"><a href="/gostd/text/template/parse/parse.go.html#3198478">varName</a></span>&nbsp;<span class="op" id="3198517">==</span>&nbsp;<span class="ident" id="3198520"><a href="/gostd/text/template/parse/parse.go.html#3198440">v</a></span><span class="op" id="3198521">.</span><span class="ident" id="3198522"><a href="/gostd/text/template/parse/node.go.html#3167912">Ident</a></span><span class="op" id="3198527">[</span><span class="num" id="3198528">0</span><span class="op" id="3198529">]</span>&nbsp;<span class="op" id="3198531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198536">return</span>&nbsp;<span class="ident" id="3198543"><a href="/gostd/text/template/parse/parse.go.html#3198440">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3198547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3198550">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3198553"><a href="/gostd/text/template/parse/parse.go.html#3198394">t</a></span><span class="op" id="3198554">.</span><span class="ident" id="3198555"><a href="/gostd/text/template/parse/parse.go.html#3184731">errorf</a></span><span class="op" id="3198561">(</span><span class="string" id="3198562">&#34;undefined&nbsp;variable&nbsp;%q&#34;</span><span class="op" id="3198585">,</span>&nbsp;<span class="ident" id="3198587"><a href="/gostd/text/template/parse/parse.go.html#3198440">v</a></span><span class="op" id="3198588">.</span><span class="ident" id="3198589"><a href="/gostd/text/template/parse/node.go.html#3167912">Ident</a></span><span class="op" id="3198594">[</span><span class="num" id="3198595">0</span><span class="op" id="3198596">]</span><span class="op" id="3198597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3198600">return</span>&nbsp;<span class="builtintype" id="3198607">nil</span><br>
<span class="lineno"></span><span class="op" id="3198611">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
