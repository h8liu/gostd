<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword">package</span>&nbsp;<span class="ident">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">import</span>&nbsp;<span class="op">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">parseIPTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span>&nbsp;&nbsp;<span class="builtintype">string</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span>&nbsp;<span class="ident">IP</span><br>
<span class="lineno"></span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;127.0.1.2&#34;</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">127</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">2</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;127.0.0.1&#34;</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">127</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;127.0.0.256&#34;</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;abc&#34;</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;123:&#34;</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;::ffff:127.0.0.1&#34;</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">127</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;2001:4860:0:2001::68&#34;</span><span class="op">,</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">0x20</span><span class="op">,</span>&nbsp;<span class="num">0x01</span><span class="op">,</span>&nbsp;<span class="num">0x48</span><span class="op">,</span>&nbsp;<span class="num">0x60</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x20</span><span class="op">,</span>&nbsp;<span class="num">0x01</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x00</span><span class="op">,</span>&nbsp;<span class="num">0x68</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;::ffff:4a7d:1363&#34;</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">74</span><span class="op">,</span>&nbsp;<span class="num">125</span><span class="op">,</span>&nbsp;<span class="num">19</span><span class="op">,</span>&nbsp;<span class="num">99</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;fe80::1%lo0&#34;</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;fe80::1%911&#34;</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;&#34;</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;a1:a2:a3:a4::b1:b2:b3:b4&#34;</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;Issue&nbsp;6628</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">TestParseIP</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">parseIPTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="op">!</span><span class="ident">reflect</span><span class="op">.</span><span class="ident">DeepEqual</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;ParseIP(%q)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span>&nbsp;<span class="op">==</span>&nbsp;<span class="string">&#34;&#34;</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Tested&nbsp;in&nbsp;TestMarshalEmptyIP&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="ident">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">out</span><span class="op">.</span><span class="ident">UnmarshalText</span><span class="op">(</span><span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">)</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="op">!</span><span class="ident">reflect</span><span class="op">.</span><span class="ident">DeepEqual</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span>&nbsp;<span class="op">||</span>&nbsp;<span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">out</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="op">(</span><span class="ident">err</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;IP.UnmarshalText(%q)&nbsp;=&nbsp;%v,&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">err</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">45</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">BenchmarkParseIP</span><span class="op">(</span><span class="ident">b</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">B</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">b</span><span class="op">.</span><span class="ident">N</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">parseIPTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ParseIP</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment">//&nbsp;Issue&nbsp;6339</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">TestMarshalEmptyIP</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">in</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">{</span><span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">(</span><span class="string">&#34;&#34;</span><span class="op">)</span><span class="op">}</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">2</span><span class="op">,</span>&nbsp;<span class="num">3</span><span class="op">,</span>&nbsp;<span class="num">4</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">out</span><span class="op">.</span><span class="ident">UnmarshalText</span><span class="op">(</span><span class="ident">in</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;UnmarshalText(%v)&nbsp;=&nbsp;%v,&nbsp;%v;&nbsp;want&nbsp;nil,&nbsp;nil&#34;</span><span class="op">,</span>&nbsp;<span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">err</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">var</span>&nbsp;<span class="ident">ip</span>&nbsp;<span class="ident">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">got</span><span class="op">,</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">ip</span><span class="op">.</span><span class="ident">MarshalText</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Fatal</span><span class="op">(</span><span class="ident">err</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">!</span><span class="ident">reflect</span><span class="op">.</span><span class="ident">DeepEqual</span><span class="op">(</span><span class="ident">got</span><span class="op">,</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="builtintype">byte</span><span class="op">(</span><span class="string">&#34;&#34;</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">`got&nbsp;%#v,&nbsp;want&nbsp;[]byte(&#34;&#34;)`</span><span class="op">,</span>&nbsp;<span class="ident">got</span><span class="op">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">ipStringTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span>&nbsp;&nbsp;<span class="ident">IP</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span>&nbsp;<span class="builtintype">string</span>&nbsp;<span class="comment">//&nbsp;see&nbsp;RFC&nbsp;5952</span><br>
<span class="lineno"></span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">{</span><span class="num">0x20</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0xd</span><span class="op">,</span>&nbsp;<span class="num">0xb8</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0x23</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x12</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="string">&#34;2001:db8::123:12:1&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">{</span><span class="num">0x20</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0xd</span><span class="op">,</span>&nbsp;<span class="num">0xb8</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="string">&#34;2001:db8::1&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">{</span><span class="num">0x20</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0xd</span><span class="op">,</span>&nbsp;<span class="num">0xb8</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="string">&#34;2001:db8:0:1:0:1:0:1&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">{</span><span class="num">0x20</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0xd</span><span class="op">,</span>&nbsp;<span class="num">0xb8</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="string">&#34;2001:db8:1:0:1:0:1:0&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">{</span><span class="num">0x20</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="string">&#34;2001::1:0:0:1&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">{</span><span class="num">0x20</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0xd</span><span class="op">,</span>&nbsp;<span class="num">0xb8</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="string">&#34;2001:db8:0:0:1::&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">{</span><span class="num">0x20</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0xd</span><span class="op">,</span>&nbsp;<span class="num">0xb8</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="string">&#34;2001:db8::1:0:0:1&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">{</span><span class="num">0x20</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0xD</span><span class="op">,</span>&nbsp;<span class="num">0xB8</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0xA</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0xB</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0xC</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0xD</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="string">&#34;2001:db8::a:b:c:d&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="string">&#34;192.168.0.1&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="string">&#34;&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">TestIPString</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">ipStringTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;IP.String(%v)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">.</span><span class="ident">MarshalText</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="builtintype">string</span><span class="op">(</span><span class="ident">out</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;IP.MarshalText(%v)&nbsp;=&nbsp;%q,&nbsp;%v,&nbsp;want&nbsp;%q,&nbsp;nil&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">err</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">100</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">BenchmarkIPString</span><span class="op">(</span><span class="ident">b</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">B</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">b</span><span class="op">.</span><span class="ident">N</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">ipStringTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">110</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">ipMaskTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span>&nbsp;&nbsp;&nbsp;<span class="ident">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">mask</span>&nbsp;<span class="ident">IPMask</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span>&nbsp;&nbsp;<span class="ident">IP</span><br>
<span class="lineno"></span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">127</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">128</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">127</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;255.255.255.192&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">64</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">127</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffe0&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">96</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">127</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8::1&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ff80::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:d80::&#34;</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8::1&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;f0f0:0f0f::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2000:d08::&#34;</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword">func</span>&nbsp;<span class="ident">TestIPMask</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">ipMaskTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">.</span><span class="ident">Mask</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">mask</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">||</span>&nbsp;<span class="op">!</span><span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">.</span><span class="ident">Equal</span><span class="op">(</span><span class="ident">out</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;IP(%v).Mask(%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">mask</span><span class="op">,</span>&nbsp;<span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">ipMaskStringTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span>&nbsp;&nbsp;<span class="ident">IPMask</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span>&nbsp;<span class="builtintype">string</span><br>
<span class="lineno"></span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">240</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="string">&#34;fffffff0&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">128</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="string">&#34;ff008000&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ff80::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="string">&#34;ffffff80000000000000000000000000&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ef00:ff80::cafe:0&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="string">&#34;ef00ff800000000000000000cafe0000&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="string">&#34;&lt;nil&gt;&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">TestIPMaskString</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">ipMaskStringTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;IPMask.String(%v)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">150</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">BenchmarkIPMaskString</span><span class="op">(</span><span class="ident">b</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">B</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="num">0</span><span class="op">;</span>&nbsp;<span class="ident">i</span>&nbsp;<span class="op">&lt;</span>&nbsp;<span class="ident">b</span><span class="op">.</span><span class="ident">N</span><span class="op">;</span>&nbsp;<span class="ident">i</span><span class="op">++</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">ipMaskStringTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="keyword">var</span>&nbsp;<span class="ident">parseCIDRTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span>&nbsp;&nbsp;<span class="builtintype">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ip</span>&nbsp;&nbsp;<span class="ident">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">net</span>&nbsp;<span class="op">*</span><span class="ident">IPNet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">err</span>&nbsp;<span class="builtintype">error</span><br>
<span class="lineno">165</span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;135.104.0.0/32&#34;</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">135</span><span class="op">,</span>&nbsp;<span class="num">104</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">135</span><span class="op">,</span>&nbsp;<span class="num">104</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;0.0.0.0/24&#34;</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;135.104.0.0/24&#34;</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">135</span><span class="op">,</span>&nbsp;<span class="num">104</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">135</span><span class="op">,</span>&nbsp;<span class="num">104</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;135.104.0.1/32&#34;</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">135</span><span class="op">,</span>&nbsp;<span class="num">104</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">135</span><span class="op">,</span>&nbsp;<span class="num">104</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;135.104.0.1/24&#34;</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">135</span><span class="op">,</span>&nbsp;<span class="num">104</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">135</span><span class="op">,</span>&nbsp;<span class="num">104</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;::1/128&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;::1&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;::1&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;abcd:2345::/127&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:fffe&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;abcd:2345::/65&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ffff:ffff:ffff:8000::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;abcd:2345::/64&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ffff:ffff:ffff::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;abcd:2345::/63&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ffff:ffff:fffe::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;abcd:2345::/33&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ffff:8000::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;abcd:2345::/32&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ffff::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;abcd:2344::/31&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2344::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2344::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:fffe::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;abcd:2300::/24&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2300::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2300::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ff00::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;abcd:2345::/24&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2345::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;abcd:2300::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ff00::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;2001:DB8::/48&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:DB8::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:DB8::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ffff:ffff::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;2001:DB8::1/48&#34;</span><span class="op">,</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:DB8::1&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:DB8::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:ffff:ffff::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;192.168.1.1/255.255.255.0&#34;</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ParseError</span><span class="op">{</span><span class="string">&#34;CIDR&nbsp;address&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;192.168.1.1/255.255.255.0&#34;</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;192.168.1.1/35&#34;</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ParseError</span><span class="op">{</span><span class="string">&#34;CIDR&nbsp;address&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;192.168.1.1/35&#34;</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;2001:db8::1/-1&#34;</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ParseError</span><span class="op">{</span><span class="string">&#34;CIDR&nbsp;address&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;2001:db8::1/-1&#34;</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;&#34;</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">ParseError</span><span class="op">{</span><span class="string">&#34;CIDR&nbsp;address&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;&#34;</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">TestParseCIDR</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">parseCIDRTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ip</span><span class="op">,</span>&nbsp;<span class="ident">net</span><span class="op">,</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">ParseCIDR</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">!</span><span class="ident">reflect</span><span class="op">.</span><span class="ident">DeepEqual</span><span class="op">(</span><span class="ident">err</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">err</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;ParseCIDR(%q)&nbsp;=&nbsp;%v,&nbsp;%v;&nbsp;want&nbsp;%v,&nbsp;%v&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">ip</span><span class="op">,</span>&nbsp;<span class="ident">net</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">ip</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">net</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="op">(</span><span class="op">!</span><span class="ident">tt</span><span class="op">.</span><span class="ident">ip</span><span class="op">.</span><span class="ident">Equal</span><span class="op">(</span><span class="ident">ip</span><span class="op">)</span>&nbsp;<span class="op">||</span>&nbsp;<span class="op">!</span><span class="ident">tt</span><span class="op">.</span><span class="ident">net</span><span class="op">.</span><span class="ident">IP</span><span class="op">.</span><span class="ident">Equal</span><span class="op">(</span><span class="ident">net</span><span class="op">.</span><span class="ident">IP</span><span class="op">)</span>&nbsp;<span class="op">||</span>&nbsp;<span class="op">!</span><span class="ident">reflect</span><span class="op">.</span><span class="ident">DeepEqual</span><span class="op">(</span><span class="ident">net</span><span class="op">.</span><span class="ident">Mask</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">net</span><span class="op">.</span><span class="ident">Mask</span><span class="op">)</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;ParseCIDR(%q)&nbsp;=&nbsp;%v,&nbsp;{%v,&nbsp;%v};&nbsp;want&nbsp;%v,&nbsp;{%v,&nbsp;%v}&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">ip</span><span class="op">,</span>&nbsp;<span class="ident">net</span><span class="op">.</span><span class="ident">IP</span><span class="op">,</span>&nbsp;<span class="ident">net</span><span class="op">.</span><span class="ident">Mask</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">ip</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">net</span><span class="op">.</span><span class="ident">IP</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">net</span><span class="op">.</span><span class="ident">Mask</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">ipNetContainsTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ip</span>&nbsp;&nbsp;<span class="ident">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">net</span>&nbsp;<span class="op">*</span><span class="ident">IPNet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ok</span>&nbsp;&nbsp;<span class="builtintype">bool</span><br>
<span class="lineno">205</span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4</span><span class="op">(</span><span class="num">172</span><span class="op">,</span>&nbsp;<span class="num">16</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">172</span><span class="op">,</span>&nbsp;<span class="num">16</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">CIDRMask</span><span class="op">(</span><span class="num">12</span><span class="op">,</span>&nbsp;<span class="num">32</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4</span><span class="op">(</span><span class="num">172</span><span class="op">,</span>&nbsp;<span class="num">24</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">172</span><span class="op">,</span>&nbsp;<span class="num">16</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">CIDRMask</span><span class="op">(</span><span class="num">13</span><span class="op">,</span>&nbsp;<span class="num">32</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">3</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">252</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">4</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">252</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8:1:2::1&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8:1::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">CIDRMask</span><span class="op">(</span><span class="num">47</span><span class="op">,</span>&nbsp;<span class="num">128</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8:1:2::1&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8:2::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">CIDRMask</span><span class="op">(</span><span class="num">47</span><span class="op">,</span>&nbsp;<span class="num">128</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8:1:2::1&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8:1::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ffff:0:ffff::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8:1:2::1&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8:1::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;0:0:0:ffff::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">TestIPNetContains</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">ipNetContainsTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">net</span><span class="op">.</span><span class="ident">Contains</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">ip</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">ok</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;IPNet(%v).Contains(%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">net</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">ip</span><span class="op">,</span>&nbsp;<span class="ident">ok</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">ok</span><span class="op">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">ipNetStringTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span>&nbsp;&nbsp;<span class="op">*</span><span class="ident">IPNet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span>&nbsp;<span class="builtintype">string</span><br>
<span class="lineno"></span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">CIDRMask</span><span class="op">(</span><span class="num">26</span><span class="op">,</span>&nbsp;<span class="num">32</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="string">&#34;192.168.1.0/26&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="string">&#34;192.168.1.0/ff00ff00&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">CIDRMask</span><span class="op">(</span><span class="num">55</span><span class="op">,</span>&nbsp;<span class="num">128</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="string">&#34;2001:db8::/55&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8::&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">IPMask</span><span class="op">(</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;8000:f123:0:cafe::&#34;</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="string">&#34;2001:db8::/8000f1230000cafe0000000000000000&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">TestIPNetString</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">ipNetStringTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">.</span><span class="ident">String</span><span class="op">(</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;IPNet.String(%v)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">240</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">cidrMaskTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ones</span>&nbsp;<span class="builtintype">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">bits</span>&nbsp;<span class="builtintype">int</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span>&nbsp;&nbsp;<span class="ident">IPMask</span><br>
<span class="lineno"></span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">32</span><span class="op">,</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="num">12</span><span class="op">,</span>&nbsp;<span class="num">32</span><span class="op">,</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">240</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="num">24</span><span class="op">,</span>&nbsp;<span class="num">32</span><span class="op">,</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="num">32</span><span class="op">,</span>&nbsp;<span class="num">32</span><span class="op">,</span>&nbsp;<span class="ident">IPv4Mask</span><span class="op">(</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">)</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">128</span><span class="op">,</span>&nbsp;<span class="ident">IPMask</span><span class="op">{</span><span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="num">4</span><span class="op">,</span>&nbsp;<span class="num">128</span><span class="op">,</span>&nbsp;<span class="ident">IPMask</span><span class="op">{</span><span class="num">0xf0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="num">48</span><span class="op">,</span>&nbsp;<span class="num">128</span><span class="op">,</span>&nbsp;<span class="ident">IPMask</span><span class="op">{</span><span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="num">128</span><span class="op">,</span>&nbsp;<span class="num">128</span><span class="op">,</span>&nbsp;<span class="ident">IPMask</span><span class="op">{</span><span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="num">33</span><span class="op">,</span>&nbsp;<span class="num">32</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="num">32</span><span class="op">,</span>&nbsp;<span class="num">33</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="op">-</span><span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">128</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="num">128</span><span class="op">,</span>&nbsp;<span class="op">-</span><span class="num">1</span><span class="op">,</span>&nbsp;<span class="ident">nil</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">TestCIDRMask</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">cidrMaskTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">out</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">CIDRMask</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">ones</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">bits</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="op">!</span><span class="ident">reflect</span><span class="op">.</span><span class="ident">DeepEqual</span><span class="op">(</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;CIDRMask(%v,&nbsp;%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">ones</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">bits</span><span class="op">,</span>&nbsp;<span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="op">(</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v4addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v4mappedv6addr</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v6addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">0x20</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0xd</span><span class="op">,</span>&nbsp;<span class="num">0xb8</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0x23</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x12</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v4mask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="ident">IPMask</span><span class="op">{</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v4mappedv6mask</span>&nbsp;<span class="op">=</span>&nbsp;<span class="ident">IPMask</span><span class="op">{</span><span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v6mask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="ident">IPMask</span><span class="op">{</span><span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">badaddr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">192</span><span class="op">,</span>&nbsp;<span class="num">168</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">badmask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="ident">IPMask</span><span class="op">{</span><span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">v4maskzero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op">=</span>&nbsp;<span class="ident">IPMask</span><span class="op">{</span><span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><br>
<span class="lineno"></span><span class="op">)</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">networkNumberAndMaskTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span>&nbsp;&nbsp;<span class="ident">IPNet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span>&nbsp;<span class="ident">IPNet</span><br>
<span class="lineno"></span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v4addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4mask</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v4addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4mask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v4addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4mappedv6mask</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v4addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4mask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v4mappedv6addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4mappedv6mask</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v4addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4mask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v4mappedv6addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v6mask</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v4addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4maskzero</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v4addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v6mask</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v4addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4maskzero</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v6addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v6mask</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v6addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v6mask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v6addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4mappedv6mask</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v6addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4mappedv6mask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">in</span><span class="op">:</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v6addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4mask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">in</span><span class="op">:</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v4addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">badmask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">in</span><span class="op">:</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v4mappedv6addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">badmask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">in</span><span class="op">:</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">v6addr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">badmask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">in</span><span class="op">:</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">badaddr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4mask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">in</span><span class="op">:</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">badaddr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v4mappedv6mask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">in</span><span class="op">:</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">badaddr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">v6mask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">in</span><span class="op">:</span>&nbsp;<span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">badaddr</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">badmask</span><span class="op">}</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">300</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">TestNetworkNumberAndMask</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">networkNumberAndMaskTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ip</span><span class="op">,</span>&nbsp;<span class="ident">m</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">networkNumberAndMask</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">out</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="op">&amp;</span><span class="ident">IPNet</span><span class="op">{</span><span class="ident">IP</span><span class="op">:</span>&nbsp;<span class="ident">ip</span><span class="op">,</span>&nbsp;<span class="ident">Mask</span><span class="op">:</span>&nbsp;<span class="ident">m</span><span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="op">!</span><span class="ident">reflect</span><span class="op">.</span><span class="ident">DeepEqual</span><span class="op">(</span><span class="op">&amp;</span><span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">,</span>&nbsp;<span class="ident">out</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;networkNumberAndMask(%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">out</span><span class="op">,</span>&nbsp;<span class="op">&amp;</span><span class="ident">tt</span><span class="op">.</span><span class="ident">out</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">310</span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">splitJoinTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">host</span>&nbsp;<span class="builtintype">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">port</span>&nbsp;<span class="builtintype">string</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">join</span>&nbsp;<span class="builtintype">string</span><br>
<span class="lineno"></span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;www.google.com&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;80&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;www.google.com:80&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;127.0.0.1&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;1234&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;127.0.0.1:1234&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;::1&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;80&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;[::1]:80&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;fe80::1%lo0&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;80&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;[fe80::1%lo0]:80&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;localhost%lo0&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;80&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;[localhost%lo0]:80&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;0&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;:0&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;google.com&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;https%foo&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;google.com:https%foo&#34;</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="comment">//&nbsp;Go&nbsp;1.0&nbsp;behavior</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;127.0.0.1&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;127.0.0.1:&#34;</span><span class="op">}</span><span class="op">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Go&nbsp;1.0&nbsp;behaviour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;www.google.com&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;www.google.com:&#34;</span><span class="op">}</span><span class="op">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Go&nbsp;1.0&nbsp;behaviour</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">splitFailureTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">hostPort</span>&nbsp;<span class="builtintype">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype">string</span><br>
<span class="lineno"></span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;www.google.com&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;missing&nbsp;port&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;127.0.0.1&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;missing&nbsp;port&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;[::1]&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;missing&nbsp;port&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;[fe80::1%lo0]&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;missing&nbsp;port&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;[localhost%lo0]&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;missing&nbsp;port&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;localhost%lo0&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;missing&nbsp;port&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;::1&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;too&nbsp;many&nbsp;colons&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;fe80::1%lo0&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;too&nbsp;many&nbsp;colons&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;fe80::1%lo0:80&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;too&nbsp;many&nbsp;colons&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;localhost%lo0:80&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;missing&nbsp;brackets&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment">//&nbsp;Test&nbsp;cases&nbsp;that&nbsp;didn&#39;t&nbsp;fail&nbsp;in&nbsp;Go&nbsp;1.0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;[foo:bar]&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;missing&nbsp;port&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;[foo:bar]baz&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;missing&nbsp;port&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;[foo]bar:baz&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;missing&nbsp;port&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;[foo]:[bar]:baz&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;too&nbsp;many&nbsp;colons&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;[foo]:[bar]baz&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;unexpected&nbsp;&#39;[&#39;&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;foo[bar]:baz&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;unexpected&nbsp;&#39;[&#39;&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="string">&#34;foo]bar:baz&#34;</span><span class="op">,</span>&nbsp;<span class="string">&#34;unexpected&nbsp;&#39;]&#39;&nbsp;in&nbsp;address&#34;</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="keyword">func</span>&nbsp;<span class="ident">TestSplitHostPort</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">splitJoinTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">host</span><span class="op">,</span>&nbsp;<span class="ident">port</span><span class="op">,</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">SplitHostPort</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">join</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">host</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">host</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">port</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">port</span>&nbsp;<span class="op">||</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;SplitHostPort(%q)&nbsp;=&nbsp;%q,&nbsp;%q,&nbsp;%v;&nbsp;want&nbsp;%q,&nbsp;%q,&nbsp;nil&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">join</span><span class="op">,</span>&nbsp;<span class="ident">host</span><span class="op">,</span>&nbsp;<span class="ident">port</span><span class="op">,</span>&nbsp;<span class="ident">err</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">host</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">port</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">splitFailureTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">SplitHostPort</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">hostPort</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">err</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;SplitHostPort(%q)&nbsp;should&nbsp;have&nbsp;failed&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">hostPort</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span>&nbsp;<span class="keyword">else</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">e</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">err</span><span class="op">.</span><span class="op">(</span><span class="op">*</span><span class="ident">AddrError</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">e</span><span class="op">.</span><span class="ident">Err</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">err</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;SplitHostPort(%q)&nbsp;=&nbsp;_,&nbsp;_,&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">hostPort</span><span class="op">,</span>&nbsp;<span class="ident">e</span><span class="op">.</span><span class="ident">Err</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">err</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">TestJoinHostPort</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">splitJoinTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">join</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">JoinHostPort</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">host</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">port</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">join</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">join</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;JoinHostPort(%q,&nbsp;%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">host</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">port</span><span class="op">,</span>&nbsp;<span class="ident">join</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">join</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">ipAddrFamilyTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span>&nbsp;&nbsp;<span class="ident">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">af4</span>&nbsp;<span class="builtintype">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">af6</span>&nbsp;<span class="builtintype">bool</span><br>
<span class="lineno">390</span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4bcast</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4allsys</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4allrouter</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4zero</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4</span><span class="op">(</span><span class="num">224</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4</span><span class="op">(</span><span class="num">127</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv4</span><span class="op">(</span><span class="num">240</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv6unspecified</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv6loopback</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv6interfacelocalallnodes</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv6linklocalallnodes</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IPv6linklocalallrouters</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;ff05::a:b:c:d&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;fe80::1:2:3:4&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">ParseIP</span><span class="op">(</span><span class="string">&#34;2001:db8::123:12:1&#34;</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">TestIPAddrFamily</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">ipAddrFamilyTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">af</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">.</span><span class="ident">To4</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">nil</span><span class="op">;</span>&nbsp;<span class="ident">af</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">af4</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;verifying&nbsp;IPv4&nbsp;address&nbsp;family&nbsp;for&nbsp;%q&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">af</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">af4</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">af</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="builtinfunc">len</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">IPv6len</span>&nbsp;<span class="op">&amp;&amp;</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">.</span><span class="ident">To4</span><span class="op">(</span><span class="op">)</span>&nbsp;<span class="op">==</span>&nbsp;<span class="ident">nil</span><span class="op">;</span>&nbsp;<span class="ident">af</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">af6</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;verifying&nbsp;IPv6&nbsp;address&nbsp;family&nbsp;for&nbsp;%q&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">af</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">af6</span><span class="op">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">var</span>&nbsp;<span class="ident">ipAddrScopeTests</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">[</span><span class="op">]</span><span class="keyword">struct</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">scope</span>&nbsp;<span class="keyword">func</span><span class="op">(</span><span class="ident">IP</span><span class="op">)</span>&nbsp;<span class="builtintype">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">in</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype">bool</span><br>
<span class="lineno"></span><span class="op">}</span><span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsUnspecified</span><span class="op">,</span>&nbsp;<span class="ident">IPv4zero</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsUnspecified</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">127</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsUnspecified</span><span class="op">,</span>&nbsp;<span class="ident">IPv6unspecified</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsUnspecified</span><span class="op">,</span>&nbsp;<span class="ident">IPv6interfacelocalallnodes</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLoopback</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">127</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLoopback</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">127</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">254</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLoopback</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">128</span><span class="op">,</span>&nbsp;<span class="num">1</span><span class="op">,</span>&nbsp;<span class="num">2</span><span class="op">,</span>&nbsp;<span class="num">3</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLoopback</span><span class="op">,</span>&nbsp;<span class="ident">IPv6loopback</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLoopback</span><span class="op">,</span>&nbsp;<span class="ident">IPv6linklocalallrouters</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsMulticast</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">224</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsMulticast</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">239</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsMulticast</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">240</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsMulticast</span><span class="op">,</span>&nbsp;<span class="ident">IPv6linklocalallnodes</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsMulticast</span><span class="op">,</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0x05</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsMulticast</span><span class="op">,</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">0xfe</span><span class="op">,</span>&nbsp;<span class="num">0x80</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLinkLocalMulticast</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">224</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLinkLocalMulticast</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">239</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLinkLocalMulticast</span><span class="op">,</span>&nbsp;<span class="ident">IPv6linklocalallrouters</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLinkLocalMulticast</span><span class="op">,</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0x05</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLinkLocalUnicast</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">169</span><span class="op">,</span>&nbsp;<span class="num">254</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLinkLocalUnicast</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">169</span><span class="op">,</span>&nbsp;<span class="num">255</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLinkLocalUnicast</span><span class="op">,</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">0xfe</span><span class="op">,</span>&nbsp;<span class="num">0x80</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsLinkLocalUnicast</span><span class="op">,</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">0xfe</span><span class="op">,</span>&nbsp;<span class="num">0xc0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsGlobalUnicast</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">240</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsGlobalUnicast</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">232</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsGlobalUnicast</span><span class="op">,</span>&nbsp;<span class="ident">IPv4</span><span class="op">(</span><span class="num">169</span><span class="op">,</span>&nbsp;<span class="num">254</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsGlobalUnicast</span><span class="op">,</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">0x20</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0xd</span><span class="op">,</span>&nbsp;<span class="num">0xb8</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">,</span>&nbsp;<span class="num">0x23</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x12</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0x1</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">true</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsGlobalUnicast</span><span class="op">,</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">0xfe</span><span class="op">,</span>&nbsp;<span class="num">0x80</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">{</span><span class="ident">IP</span><span class="op">.</span><span class="ident">IsGlobalUnicast</span><span class="op">,</span>&nbsp;<span class="ident">IP</span><span class="op">{</span><span class="num">0xff</span><span class="op">,</span>&nbsp;<span class="num">0x05</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">,</span>&nbsp;<span class="num">0</span><span class="op">}</span><span class="op">,</span>&nbsp;<span class="ident">false</span><span class="op">}</span><span class="op">,</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword">func</span>&nbsp;<span class="ident">name</span><span class="op">(</span><span class="ident">f</span>&nbsp;<span class="keyword">interface</span><span class="op">{</span><span class="op">}</span><span class="op">)</span>&nbsp;<span class="builtintype">string</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">return</span>&nbsp;<span class="ident">runtime</span><span class="op">.</span><span class="ident">FuncForPC</span><span class="op">(</span><span class="ident">reflect</span><span class="op">.</span><span class="ident">ValueOf</span><span class="op">(</span><span class="ident">f</span><span class="op">)</span><span class="op">.</span><span class="ident">Pointer</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">.</span><span class="ident">Name</span><span class="op">(</span><span class="op">)</span><br>
<span class="lineno"></span><span class="op">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword">func</span>&nbsp;<span class="ident">TestIPAddrScope</span><span class="op">(</span><span class="ident">t</span>&nbsp;<span class="op">*</span><span class="ident">testing</span><span class="op">.</span><span class="ident">T</span><span class="op">)</span>&nbsp;<span class="op">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">for</span>&nbsp;<span class="ident">_</span><span class="op">,</span>&nbsp;<span class="ident">tt</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="keyword">range</span>&nbsp;<span class="ident">ipAddrScopeTests</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword">if</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="op">:=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">scope</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">)</span><span class="op">;</span>&nbsp;<span class="ident">ok</span>&nbsp;<span class="op">!=</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">ok</span>&nbsp;<span class="op">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident">t</span><span class="op">.</span><span class="ident">Errorf</span><span class="op">(</span><span class="string">&#34;%s(%q)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op">,</span>&nbsp;<span class="ident">name</span><span class="op">(</span><span class="ident">tt</span><span class="op">.</span><span class="ident">scope</span><span class="op">)</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">in</span><span class="op">,</span>&nbsp;<span class="ident">ok</span><span class="op">,</span>&nbsp;<span class="ident">tt</span><span class="op">.</span><span class="ident">ok</span><span class="op">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op">}</span><br>
<span class="lineno">465</span><span class="op">}</span>
</div>
</body>
</html>
