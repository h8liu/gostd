<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5974073">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5974128">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5974182">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5974233">//&nbsp;Godoc&nbsp;comment&nbsp;extraction&nbsp;and&nbsp;comment&nbsp;-&gt;&nbsp;HTML&nbsp;formatting.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5974294">package</span>&nbsp;<span class="ident" id="5974302">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5974307">import</span>&nbsp;<span class="op" id="5974314">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5974317">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5974323">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5974333">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5974344">&#34;text/template&#34;</span>&nbsp;<span class="comment" id="5974360">//&nbsp;for&nbsp;HTMLEscape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5974379">&#34;unicode&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5974390">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5974405">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5974408">var</span>&nbsp;<span class="op" id="5974412">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974415">ldquo</span>&nbsp;<span class="op" id="5974421">=</span>&nbsp;<span class="op" id="5974423">[</span><span class="op" id="5974424">]</span><span class="builtintype" id="5974425">byte</span><span class="op" id="5974429">(</span><span class="string" id="5974430">&#34;&amp;ldquo;&#34;</span><span class="op" id="5974439">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974442">rdquo</span>&nbsp;<span class="op" id="5974448">=</span>&nbsp;<span class="op" id="5974450">[</span><span class="op" id="5974451">]</span><span class="builtintype" id="5974452">byte</span><span class="op" id="5974456">(</span><span class="string" id="5974457">&#34;&amp;rdquo;&#34;</span><span class="op" id="5974466">)</span><br>
<span class="lineno"></span><span class="op" id="5974468">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5974471">//&nbsp;Escape&nbsp;comment&nbsp;text&nbsp;for&nbsp;HTML.&nbsp;If&nbsp;nice&nbsp;is&nbsp;set,</span><br>
<span class="lineno"></span><span class="comment" id="5974520">//&nbsp;also&nbsp;turn&nbsp;``&nbsp;into&nbsp;&amp;ldquo;&nbsp;and&nbsp;&#39;&#39;&nbsp;into&nbsp;&amp;rdquo;.</span><br>
<span class="lineno">25</span><span class="keyword" id="5974570">func</span>&nbsp;<span class="ident" id="5974575">commentEscape</span><span class="op" id="5974588">(</span><span class="ident" id="5974589">w</span>&nbsp;<span class="ident" id="5974591"><a href="/go/doc/comment.go.html#5974317">io</a></span><span class="op" id="5974593">.</span><span class="ident" id="5974594">Writer</span><span class="op" id="5974600">,</span>&nbsp;<span class="ident" id="5974602">text</span>&nbsp;<span class="builtintype" id="5974607">string</span><span class="op" id="5974613">,</span>&nbsp;<span class="ident" id="5974615">nice</span>&nbsp;<span class="builtintype" id="5974620">bool</span><span class="op" id="5974624">)</span>&nbsp;<span class="op" id="5974626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974629">last</span>&nbsp;<span class="op" id="5974634">:=</span>&nbsp;<span class="num" id="5974637">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5974640">if</span>&nbsp;<span class="ident" id="5974643"><a href="/go/doc/comment.go.html#5974615">nice</a></span>&nbsp;<span class="op" id="5974648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5974652">for</span>&nbsp;<span class="ident" id="5974656">i</span>&nbsp;<span class="op" id="5974658">:=</span>&nbsp;<span class="num" id="5974661">0</span><span class="op" id="5974662">;</span>&nbsp;<span class="ident" id="5974664"><a href="/go/doc/comment.go.html#5974656">i</a></span>&nbsp;<span class="op" id="5974666">&lt;</span>&nbsp;<span class="builtinfunc" id="5974668">len</span><span class="op" id="5974671">(</span><span class="ident" id="5974672"><a href="/go/doc/comment.go.html#5974602">text</a></span><span class="op" id="5974676">)</span><span class="op" id="5974677">-</span><span class="num" id="5974678">1</span><span class="op" id="5974679">;</span>&nbsp;<span class="ident" id="5974681"><a href="/go/doc/comment.go.html#5974656">i</a></span><span class="op" id="5974682">++</span>&nbsp;<span class="op" id="5974685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974690">ch</span>&nbsp;<span class="op" id="5974693">:=</span>&nbsp;<span class="ident" id="5974696"><a href="/go/doc/comment.go.html#5974602">text</a></span><span class="op" id="5974700">[</span><span class="ident" id="5974701"><a href="/go/doc/comment.go.html#5974656">i</a></span><span class="op" id="5974702">]</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5974707">if</span>&nbsp;<span class="ident" id="5974710"><a href="/go/doc/comment.go.html#5974690">ch</a></span>&nbsp;<span class="op" id="5974713">==</span>&nbsp;<span class="ident" id="5974716"><a href="/go/doc/comment.go.html#5974602">text</a></span><span class="op" id="5974720">[</span><span class="ident" id="5974721"><a href="/go/doc/comment.go.html#5974656">i</a></span><span class="op" id="5974722">+</span><span class="num" id="5974723">1</span><span class="op" id="5974724">]</span>&nbsp;<span class="op" id="5974726">&amp;&amp;</span>&nbsp;<span class="op" id="5974729">(</span><span class="ident" id="5974730"><a href="/go/doc/comment.go.html#5974690">ch</a></span>&nbsp;<span class="op" id="5974733">==</span>&nbsp;<span class="string" id="5974736">&#39;`&#39;</span>&nbsp;<span class="op" id="5974740">||</span>&nbsp;<span class="ident" id="5974743"><a href="/go/doc/comment.go.html#5974690">ch</a></span>&nbsp;<span class="op" id="5974746">==</span>&nbsp;<span class="string" id="5974749">&#39;\&#39;&#39;</span><span class="op" id="5974753">)</span>&nbsp;<span class="op" id="5974755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974761"><a href="/go/doc/comment.go.html#5974344">template</a></span><span class="op" id="5974769">.</span><span class="ident" id="5974770">HTMLEscape</span><span class="op" id="5974780">(</span><span class="ident" id="5974781"><a href="/go/doc/comment.go.html#5974589">w</a></span><span class="op" id="5974782">,</span>&nbsp;<span class="op" id="5974784">[</span><span class="op" id="5974785">]</span><span class="builtintype" id="5974786">byte</span><span class="op" id="5974790">(</span><span class="ident" id="5974791"><a href="/go/doc/comment.go.html#5974602">text</a></span><span class="op" id="5974795">[</span><span class="ident" id="5974796"><a href="/go/doc/comment.go.html#5974629">last</a></span><span class="op" id="5974800">:</span><span class="ident" id="5974801"><a href="/go/doc/comment.go.html#5974656">i</a></span><span class="op" id="5974802">]</span><span class="op" id="5974803">)</span><span class="op" id="5974804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974810"><a href="/go/doc/comment.go.html#5974629">last</a></span>&nbsp;<span class="op" id="5974815">=</span>&nbsp;<span class="ident" id="5974817"><a href="/go/doc/comment.go.html#5974656">i</a></span>&nbsp;<span class="op" id="5974819">+</span>&nbsp;<span class="num" id="5974821">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5974827">switch</span>&nbsp;<span class="ident" id="5974834"><a href="/go/doc/comment.go.html#5974690">ch</a></span>&nbsp;<span class="op" id="5974837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5974843">case</span>&nbsp;<span class="string" id="5974848">&#39;`&#39;</span><span class="op" id="5974851">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974858"><a href="/go/doc/comment.go.html#5974589">w</a></span><span class="op" id="5974859">.</span><span class="ident" id="5974860">Write</span><span class="op" id="5974865">(</span><span class="ident" id="5974866"><a href="/go/doc/comment.go.html#5974415">ldquo</a></span><span class="op" id="5974871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5974877">case</span>&nbsp;<span class="string" id="5974882">&#39;\&#39;&#39;</span><span class="op" id="5974886">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974893"><a href="/go/doc/comment.go.html#5974589">w</a></span><span class="op" id="5974894">.</span><span class="ident" id="5974895">Write</span><span class="op" id="5974900">(</span><span class="ident" id="5974901"><a href="/go/doc/comment.go.html#5974442">rdquo</a></span><span class="op" id="5974906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5974912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974918"><a href="/go/doc/comment.go.html#5974656">i</a></span><span class="op" id="5974919">++</span>&nbsp;<span class="comment" id="5974922">//&nbsp;loop&nbsp;will&nbsp;add&nbsp;one&nbsp;more</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5974951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5974955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5974958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5974961"><a href="/go/doc/comment.go.html#5974344">template</a></span><span class="op" id="5974969">.</span><span class="ident" id="5974970">HTMLEscape</span><span class="op" id="5974980">(</span><span class="ident" id="5974981"><a href="/go/doc/comment.go.html#5974589">w</a></span><span class="op" id="5974982">,</span>&nbsp;<span class="op" id="5974984">[</span><span class="op" id="5974985">]</span><span class="builtintype" id="5974986">byte</span><span class="op" id="5974990">(</span><span class="ident" id="5974991"><a href="/go/doc/comment.go.html#5974602">text</a></span><span class="op" id="5974995">[</span><span class="ident" id="5974996"><a href="/go/doc/comment.go.html#5974629">last</a></span><span class="op" id="5975000">:</span><span class="op" id="5975001">]</span><span class="op" id="5975002">)</span><span class="op" id="5975003">)</span><br>
<span class="lineno"></span><span class="op" id="5975005">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="5975008">const</span>&nbsp;<span class="op" id="5975014">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5975017">//&nbsp;Regexp&nbsp;for&nbsp;Go&nbsp;identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975047">identRx</span>&nbsp;<span class="op" id="5975055">=</span>&nbsp;<span class="string" id="5975057">`[\pL_][\pL_0-9]*`</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5975078">//&nbsp;Regexp&nbsp;for&nbsp;URLs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975098">protocol</span>&nbsp;<span class="op" id="5975107">=</span>&nbsp;<span class="string" id="5975109">`https?|ftp|file|gopher|mailto|news|nntp|telnet|wais|prospero`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975173">hostPart</span>&nbsp;<span class="op" id="5975182">=</span>&nbsp;<span class="string" id="5975184">`[a-zA-Z0-9_@\-]+`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975204">filePart</span>&nbsp;<span class="op" id="5975213">=</span>&nbsp;<span class="string" id="5975215">`[a-zA-Z0-9_?%#~&amp;/\-+=()]+`</span>&nbsp;<span class="comment" id="5975243">//&nbsp;parentheses&nbsp;may&nbsp;not&nbsp;be&nbsp;matching;&nbsp;see&nbsp;pairedParensPrefixLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975306">urlRx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5975315">=</span>&nbsp;<span class="string" id="5975317">`(`</span>&nbsp;<span class="op" id="5975321">+</span>&nbsp;<span class="ident" id="5975323"><a href="/go/doc/comment.go.html#5975098">protocol</a></span>&nbsp;<span class="op" id="5975332">+</span>&nbsp;<span class="string" id="5975334">`)://`</span>&nbsp;<span class="op" id="5975341">+</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5975345">//&nbsp;http://</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975358"><a href="/go/doc/comment.go.html#5975173">hostPart</a></span>&nbsp;<span class="op" id="5975367">+</span>&nbsp;<span class="string" id="5975369">`([.:]`</span>&nbsp;<span class="op" id="5975377">+</span>&nbsp;<span class="ident" id="5975379"><a href="/go/doc/comment.go.html#5975173">hostPart</a></span>&nbsp;<span class="op" id="5975388">+</span>&nbsp;<span class="string" id="5975390">`)*/?`</span>&nbsp;<span class="op" id="5975397">+</span>&nbsp;<span class="comment" id="5975399">//&nbsp;//www.google.com:8080/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975427"><a href="/go/doc/comment.go.html#5975204">filePart</a></span>&nbsp;<span class="op" id="5975436">+</span>&nbsp;<span class="string" id="5975438">`([:.,]`</span>&nbsp;<span class="op" id="5975447">+</span>&nbsp;<span class="ident" id="5975449"><a href="/go/doc/comment.go.html#5975204">filePart</a></span>&nbsp;<span class="op" id="5975458">+</span>&nbsp;<span class="string" id="5975460">`)*`</span><br>
<span class="lineno"></span><span class="op" id="5975465">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5975468">var</span>&nbsp;<span class="ident" id="5975472">matchRx</span>&nbsp;<span class="op" id="5975480">=</span>&nbsp;<span class="ident" id="5975482"><a href="/go/doc/comment.go.html#5974323">regexp</a></span><span class="op" id="5975488">.</span><span class="ident" id="5975489">MustCompile</span><span class="op" id="5975500">(</span><span class="string" id="5975501">`(`</span>&nbsp;<span class="op" id="5975505">+</span>&nbsp;<span class="ident" id="5975507"><a href="/go/doc/comment.go.html#5975306">urlRx</a></span>&nbsp;<span class="op" id="5975513">+</span>&nbsp;<span class="string" id="5975515">`)|(`</span>&nbsp;<span class="op" id="5975521">+</span>&nbsp;<span class="ident" id="5975523"><a href="/go/doc/comment.go.html#5975047">identRx</a></span>&nbsp;<span class="op" id="5975531">+</span>&nbsp;<span class="string" id="5975533">`)`</span><span class="op" id="5975536">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="5975539">var</span>&nbsp;<span class="op" id="5975543">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975546">html_a</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5975558">=</span>&nbsp;<span class="op" id="5975560">[</span><span class="op" id="5975561">]</span><span class="builtintype" id="5975562">byte</span><span class="op" id="5975566">(</span><span class="string" id="5975567">`&lt;a&nbsp;href=&#34;`</span><span class="op" id="5975578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975581">html_aq</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5975593">=</span>&nbsp;<span class="op" id="5975595">[</span><span class="op" id="5975596">]</span><span class="builtintype" id="5975597">byte</span><span class="op" id="5975601">(</span><span class="string" id="5975602">`&#34;&gt;`</span><span class="op" id="5975606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975609">html_enda</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5975621">=</span>&nbsp;<span class="op" id="5975623">[</span><span class="op" id="5975624">]</span><span class="builtintype" id="5975625">byte</span><span class="op" id="5975629">(</span><span class="string" id="5975630">&#34;&lt;/a&gt;&#34;</span><span class="op" id="5975636">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975639">html_i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5975651">=</span>&nbsp;<span class="op" id="5975653">[</span><span class="op" id="5975654">]</span><span class="builtintype" id="5975655">byte</span><span class="op" id="5975659">(</span><span class="string" id="5975660">&#34;&lt;i&gt;&#34;</span><span class="op" id="5975665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975668">html_endi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5975680">=</span>&nbsp;<span class="op" id="5975682">[</span><span class="op" id="5975683">]</span><span class="builtintype" id="5975684">byte</span><span class="op" id="5975688">(</span><span class="string" id="5975689">&#34;&lt;/i&gt;&#34;</span><span class="op" id="5975695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975698">html_p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5975710">=</span>&nbsp;<span class="op" id="5975712">[</span><span class="op" id="5975713">]</span><span class="builtintype" id="5975714">byte</span><span class="op" id="5975718">(</span><span class="string" id="5975719">&#34;&lt;p&gt;\n&#34;</span><span class="op" id="5975726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975729">html_endp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5975741">=</span>&nbsp;<span class="op" id="5975743">[</span><span class="op" id="5975744">]</span><span class="builtintype" id="5975745">byte</span><span class="op" id="5975749">(</span><span class="string" id="5975750">&#34;&lt;/p&gt;\n&#34;</span><span class="op" id="5975758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975761">html_pre</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5975773">=</span>&nbsp;<span class="op" id="5975775">[</span><span class="op" id="5975776">]</span><span class="builtintype" id="5975777">byte</span><span class="op" id="5975781">(</span><span class="string" id="5975782">&#34;&lt;pre&gt;&#34;</span><span class="op" id="5975789">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975792">html_endpre</span>&nbsp;<span class="op" id="5975804">=</span>&nbsp;<span class="op" id="5975806">[</span><span class="op" id="5975807">]</span><span class="builtintype" id="5975808">byte</span><span class="op" id="5975812">(</span><span class="string" id="5975813">&#34;&lt;/pre&gt;\n&#34;</span><span class="op" id="5975823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975826">html_h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5975838">=</span>&nbsp;<span class="op" id="5975840">[</span><span class="op" id="5975841">]</span><span class="builtintype" id="5975842">byte</span><span class="op" id="5975846">(</span><span class="string" id="5975847">`&lt;h3&nbsp;id=&#34;`</span><span class="op" id="5975857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975860">html_hq</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5975872">=</span>&nbsp;<span class="op" id="5975874">[</span><span class="op" id="5975875">]</span><span class="builtintype" id="5975876">byte</span><span class="op" id="5975880">(</span><span class="string" id="5975881">`&#34;&gt;`</span><span class="op" id="5975885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5975888">html_endh</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5975900">=</span>&nbsp;<span class="op" id="5975902">[</span><span class="op" id="5975903">]</span><span class="builtintype" id="5975904">byte</span><span class="op" id="5975908">(</span><span class="string" id="5975909">&#34;&lt;/h3&gt;\n&#34;</span><span class="op" id="5975918">)</span><br>
<span class="lineno"></span><span class="op" id="5975920">)</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="5975923">//&nbsp;pairedParensPrefixLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;longest&nbsp;prefix&nbsp;of&nbsp;s&nbsp;containing&nbsp;paired&nbsp;parentheses.</span><br>
<span class="lineno"></span><span class="keyword" id="5976025">func</span>&nbsp;<span class="ident" id="5976030">pairedParensPrefixLen</span><span class="op" id="5976051">(</span><span class="ident" id="5976052">s</span>&nbsp;<span class="builtintype" id="5976054">string</span><span class="op" id="5976060">)</span>&nbsp;<span class="builtintype" id="5976062">int</span>&nbsp;<span class="op" id="5976066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976069">parens</span>&nbsp;<span class="op" id="5976076">:=</span>&nbsp;<span class="num" id="5976079">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976082">l</span>&nbsp;<span class="op" id="5976084">:=</span>&nbsp;<span class="builtinfunc" id="5976087">len</span><span class="op" id="5976090">(</span><span class="ident" id="5976091"><a href="/go/doc/comment.go.html#5976052">s</a></span><span class="op" id="5976092">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976095">for</span>&nbsp;<span class="ident" id="5976099">i</span><span class="op" id="5976100">,</span>&nbsp;<span class="ident" id="5976102">ch</span>&nbsp;<span class="op" id="5976105">:=</span>&nbsp;<span class="keyword" id="5976108">range</span>&nbsp;<span class="ident" id="5976114"><a href="/go/doc/comment.go.html#5976052">s</a></span>&nbsp;<span class="op" id="5976116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976120">switch</span>&nbsp;<span class="ident" id="5976127"><a href="/go/doc/comment.go.html#5976102">ch</a></span>&nbsp;<span class="op" id="5976130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976134">case</span>&nbsp;<span class="string" id="5976139">&#39;(&#39;</span><span class="op" id="5976142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976147">if</span>&nbsp;<span class="ident" id="5976150"><a href="/go/doc/comment.go.html#5976069">parens</a></span>&nbsp;<span class="op" id="5976157">==</span>&nbsp;<span class="num" id="5976160">0</span>&nbsp;<span class="op" id="5976162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976168"><a href="/go/doc/comment.go.html#5976082">l</a></span>&nbsp;<span class="op" id="5976170">=</span>&nbsp;<span class="ident" id="5976172"><a href="/go/doc/comment.go.html#5976099">i</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976182"><a href="/go/doc/comment.go.html#5976069">parens</a></span><span class="op" id="5976188">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976193">case</span>&nbsp;<span class="string" id="5976198">&#39;)&#39;</span><span class="op" id="5976201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976206"><a href="/go/doc/comment.go.html#5976069">parens</a></span><span class="op" id="5976212">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976218">if</span>&nbsp;<span class="ident" id="5976221"><a href="/go/doc/comment.go.html#5976069">parens</a></span>&nbsp;<span class="op" id="5976228">==</span>&nbsp;<span class="num" id="5976231">0</span>&nbsp;<span class="op" id="5976233">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976239"><a href="/go/doc/comment.go.html#5976082">l</a></span>&nbsp;<span class="op" id="5976241">=</span>&nbsp;<span class="builtinfunc" id="5976243">len</span><span class="op" id="5976246">(</span><span class="ident" id="5976247"><a href="/go/doc/comment.go.html#5976052">s</a></span><span class="op" id="5976248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976253">}</span>&nbsp;<span class="keyword" id="5976255">else</span>&nbsp;<span class="keyword" id="5976260">if</span>&nbsp;<span class="ident" id="5976263"><a href="/go/doc/comment.go.html#5976069">parens</a></span>&nbsp;<span class="op" id="5976270">&lt;</span>&nbsp;<span class="num" id="5976272">0</span>&nbsp;<span class="op" id="5976274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976280">return</span>&nbsp;<span class="ident" id="5976287"><a href="/go/doc/comment.go.html#5976099">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976296">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5976299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976302">return</span>&nbsp;<span class="ident" id="5976309"><a href="/go/doc/comment.go.html#5976082">l</a></span><br>
<span class="lineno"></span><span class="op" id="5976311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5976314">//&nbsp;Emphasize&nbsp;and&nbsp;escape&nbsp;a&nbsp;line&nbsp;of&nbsp;text&nbsp;for&nbsp;HTML.&nbsp;URLs&nbsp;are&nbsp;converted&nbsp;into&nbsp;links;</span><br>
<span class="lineno">100</span><span class="comment" id="5976394">//&nbsp;if&nbsp;the&nbsp;URL&nbsp;also&nbsp;appears&nbsp;in&nbsp;the&nbsp;words&nbsp;map,&nbsp;the&nbsp;link&nbsp;is&nbsp;taken&nbsp;from&nbsp;the&nbsp;map&nbsp;(if</span><br>
<span class="lineno"></span><span class="comment" id="5976474">//&nbsp;the&nbsp;corresponding&nbsp;map&nbsp;value&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;the&nbsp;URL&nbsp;is&nbsp;not&nbsp;converted</span><br>
<span class="lineno"></span><span class="comment" id="5976551">//&nbsp;into&nbsp;a&nbsp;link).&nbsp;Go&nbsp;identifiers&nbsp;that&nbsp;appear&nbsp;in&nbsp;the&nbsp;words&nbsp;map&nbsp;are&nbsp;italicized;&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5976631">//&nbsp;the&nbsp;corresponding&nbsp;map&nbsp;value&nbsp;is&nbsp;not&nbsp;the&nbsp;empty&nbsp;string,&nbsp;it&nbsp;is&nbsp;considered&nbsp;a&nbsp;URL</span><br>
<span class="lineno"></span><span class="comment" id="5976710">//&nbsp;and&nbsp;the&nbsp;word&nbsp;is&nbsp;converted&nbsp;into&nbsp;a&nbsp;link.&nbsp;If&nbsp;nice&nbsp;is&nbsp;set,&nbsp;the&nbsp;remaining&nbsp;text&#39;s</span><br>
<span class="lineno">105</span><span class="comment" id="5976789">//&nbsp;appearance&nbsp;is&nbsp;improved&nbsp;where&nbsp;it&nbsp;makes&nbsp;sense&nbsp;(e.g.,&nbsp;``&nbsp;is&nbsp;turned&nbsp;into&nbsp;&amp;ldquo;</span><br>
<span class="lineno"></span><span class="comment" id="5976869">//&nbsp;and&nbsp;&#39;&#39;&nbsp;into&nbsp;&amp;rdquo;).</span><br>
<span class="lineno"></span><span class="keyword" id="5976894">func</span>&nbsp;<span class="ident" id="5976899">emphasize</span><span class="op" id="5976908">(</span><span class="ident" id="5976909">w</span>&nbsp;<span class="ident" id="5976911"><a href="/go/doc/comment.go.html#5974317">io</a></span><span class="op" id="5976913">.</span><span class="ident" id="5976914">Writer</span><span class="op" id="5976920">,</span>&nbsp;<span class="ident" id="5976922">line</span>&nbsp;<span class="builtintype" id="5976927">string</span><span class="op" id="5976933">,</span>&nbsp;<span class="ident" id="5976935">words</span>&nbsp;<span class="keyword" id="5976941">map</span><span class="op" id="5976944">[</span><span class="builtintype" id="5976945">string</span><span class="op" id="5976951">]</span><span class="builtintype" id="5976952">string</span><span class="op" id="5976958">,</span>&nbsp;<span class="ident" id="5976960">nice</span>&nbsp;<span class="builtintype" id="5976965">bool</span><span class="op" id="5976969">)</span>&nbsp;<span class="op" id="5976971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976974">for</span>&nbsp;<span class="op" id="5976978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976982">m</span>&nbsp;<span class="op" id="5976984">:=</span>&nbsp;<span class="ident" id="5976987"><a href="/go/doc/comment.go.html#5975472">matchRx</a></span><span class="op" id="5976994">.</span><span class="ident" id="5976995">FindStringSubmatchIndex</span><span class="op" id="5977018">(</span><span class="ident" id="5977019"><a href="/go/doc/comment.go.html#5976922">line</a></span><span class="op" id="5977023">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977027">if</span>&nbsp;<span class="ident" id="5977030"><a href="/go/doc/comment.go.html#5976982">m</a></span>&nbsp;<span class="op" id="5977032">==</span>&nbsp;<span class="ident" id="5977035">nil</span>&nbsp;<span class="op" id="5977039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977044">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977056">//&nbsp;m&nbsp;&gt;=&nbsp;6&nbsp;(two&nbsp;parenthesized&nbsp;sub-regexps&nbsp;in&nbsp;matchRx,&nbsp;1st&nbsp;one&nbsp;is&nbsp;urlRx)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977130">//&nbsp;write&nbsp;text&nbsp;before&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977159"><a href="/go/doc/comment.go.html#5974575">commentEscape</a></span><span class="op" id="5977172">(</span><span class="ident" id="5977173"><a href="/go/doc/comment.go.html#5976909">w</a></span><span class="op" id="5977174">,</span>&nbsp;<span class="ident" id="5977176"><a href="/go/doc/comment.go.html#5976922">line</a></span><span class="op" id="5977180">[</span><span class="num" id="5977181">0</span><span class="op" id="5977182">:</span><span class="ident" id="5977183"><a href="/go/doc/comment.go.html#5976982">m</a></span><span class="op" id="5977184">[</span><span class="num" id="5977185">0</span><span class="op" id="5977186">]</span><span class="op" id="5977187">]</span><span class="op" id="5977188">,</span>&nbsp;<span class="ident" id="5977190"><a href="/go/doc/comment.go.html#5976960">nice</a></span><span class="op" id="5977194">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977199">//&nbsp;adjust&nbsp;match&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977230">match</span>&nbsp;<span class="op" id="5977236">:=</span>&nbsp;<span class="ident" id="5977239"><a href="/go/doc/comment.go.html#5976922">line</a></span><span class="op" id="5977243">[</span><span class="ident" id="5977244"><a href="/go/doc/comment.go.html#5976982">m</a></span><span class="op" id="5977245">[</span><span class="num" id="5977246">0</span><span class="op" id="5977247">]</span><span class="op" id="5977248">:</span><span class="ident" id="5977249"><a href="/go/doc/comment.go.html#5976982">m</a></span><span class="op" id="5977250">[</span><span class="num" id="5977251">1</span><span class="op" id="5977252">]</span><span class="op" id="5977253">]</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977257">if</span>&nbsp;<span class="ident" id="5977260">n</span>&nbsp;<span class="op" id="5977262">:=</span>&nbsp;<span class="ident" id="5977265"><a href="/go/doc/comment.go.html#5976030">pairedParensPrefixLen</a></span><span class="op" id="5977286">(</span><span class="ident" id="5977287"><a href="/go/doc/comment.go.html#5977230">match</a></span><span class="op" id="5977292">)</span><span class="op" id="5977293">;</span>&nbsp;<span class="ident" id="5977295"><a href="/go/doc/comment.go.html#5977260">n</a></span>&nbsp;<span class="op" id="5977297">&lt;</span>&nbsp;<span class="builtinfunc" id="5977299">len</span><span class="op" id="5977302">(</span><span class="ident" id="5977303"><a href="/go/doc/comment.go.html#5977230">match</a></span><span class="op" id="5977308">)</span>&nbsp;<span class="op" id="5977310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977315">//&nbsp;match&nbsp;contains&nbsp;unpaired&nbsp;parentheses&nbsp;(rare);</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977365">//&nbsp;redo&nbsp;matching&nbsp;with&nbsp;shortened&nbsp;line&nbsp;for&nbsp;correct&nbsp;indices</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977425"><a href="/go/doc/comment.go.html#5976982">m</a></span>&nbsp;<span class="op" id="5977427">=</span>&nbsp;<span class="ident" id="5977429"><a href="/go/doc/comment.go.html#5975472">matchRx</a></span><span class="op" id="5977436">.</span><span class="ident" id="5977437">FindStringSubmatchIndex</span><span class="op" id="5977460">(</span><span class="ident" id="5977461"><a href="/go/doc/comment.go.html#5976922">line</a></span><span class="op" id="5977465">[</span><span class="op" id="5977466">:</span><span class="ident" id="5977467"><a href="/go/doc/comment.go.html#5976982">m</a></span><span class="op" id="5977468">[</span><span class="num" id="5977469">0</span><span class="op" id="5977470">]</span><span class="op" id="5977471">+</span><span class="ident" id="5977472"><a href="/go/doc/comment.go.html#5977260">n</a></span><span class="op" id="5977473">]</span><span class="op" id="5977474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977479"><a href="/go/doc/comment.go.html#5977230">match</a></span>&nbsp;<span class="op" id="5977485">=</span>&nbsp;<span class="ident" id="5977487"><a href="/go/doc/comment.go.html#5977230">match</a></span><span class="op" id="5977492">[</span><span class="op" id="5977493">:</span><span class="ident" id="5977494"><a href="/go/doc/comment.go.html#5977260">n</a></span><span class="op" id="5977495">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977504">//&nbsp;analyze&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977523">url</span>&nbsp;<span class="op" id="5977527">:=</span>&nbsp;<span class="string" id="5977530">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977535">italics</span>&nbsp;<span class="op" id="5977543">:=</span>&nbsp;<span class="ident" id="5977546">false</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977554">if</span>&nbsp;<span class="ident" id="5977557"><a href="/go/doc/comment.go.html#5976935">words</a></span>&nbsp;<span class="op" id="5977563">!=</span>&nbsp;<span class="ident" id="5977566">nil</span>&nbsp;<span class="op" id="5977570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977575"><a href="/go/doc/comment.go.html#5977523">url</a></span><span class="op" id="5977578">,</span>&nbsp;<span class="ident" id="5977580"><a href="/go/doc/comment.go.html#5977535">italics</a></span>&nbsp;<span class="op" id="5977588">=</span>&nbsp;<span class="ident" id="5977590"><a href="/go/doc/comment.go.html#5976935">words</a></span><span class="op" id="5977595">[</span><span class="ident" id="5977596"><a href="/go/doc/comment.go.html#5977230">match</a></span><span class="op" id="5977601">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977609">if</span>&nbsp;<span class="ident" id="5977612"><a href="/go/doc/comment.go.html#5976982">m</a></span><span class="op" id="5977613">[</span><span class="num" id="5977614">2</span><span class="op" id="5977615">]</span>&nbsp;<span class="op" id="5977617">&gt;=</span>&nbsp;<span class="num" id="5977620">0</span>&nbsp;<span class="op" id="5977622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977627">//&nbsp;match&nbsp;against&nbsp;first&nbsp;parenthesized&nbsp;sub-regexp;&nbsp;must&nbsp;be&nbsp;match&nbsp;against&nbsp;urlRx</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977707">if</span>&nbsp;<span class="op" id="5977710">!</span><span class="ident" id="5977711"><a href="/go/doc/comment.go.html#5977535">italics</a></span>&nbsp;<span class="op" id="5977719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977725">//&nbsp;no&nbsp;alternative&nbsp;URL&nbsp;in&nbsp;words&nbsp;list,&nbsp;use&nbsp;match&nbsp;instead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977784"><a href="/go/doc/comment.go.html#5977523">url</a></span>&nbsp;<span class="op" id="5977788">=</span>&nbsp;<span class="ident" id="5977790"><a href="/go/doc/comment.go.html#5977230">match</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977804"><a href="/go/doc/comment.go.html#5977535">italics</a></span>&nbsp;<span class="op" id="5977812">=</span>&nbsp;<span class="ident" id="5977814">false</span>&nbsp;<span class="comment" id="5977820">//&nbsp;don&#39;t&nbsp;italicize&nbsp;URLs</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5977851">//&nbsp;write&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977868">if</span>&nbsp;<span class="builtinfunc" id="5977871">len</span><span class="op" id="5977874">(</span><span class="ident" id="5977875"><a href="/go/doc/comment.go.html#5977523">url</a></span><span class="op" id="5977878">)</span>&nbsp;<span class="op" id="5977880">&gt;</span>&nbsp;<span class="num" id="5977882">0</span>&nbsp;<span class="op" id="5977884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977889"><a href="/go/doc/comment.go.html#5976909">w</a></span><span class="op" id="5977890">.</span><span class="ident" id="5977891">Write</span><span class="op" id="5977896">(</span><span class="ident" id="5977897"><a href="/go/doc/comment.go.html#5975546">html_a</a></span><span class="op" id="5977903">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977908"><a href="/go/doc/comment.go.html#5974344">template</a></span><span class="op" id="5977916">.</span><span class="ident" id="5977917">HTMLEscape</span><span class="op" id="5977927">(</span><span class="ident" id="5977928"><a href="/go/doc/comment.go.html#5976909">w</a></span><span class="op" id="5977929">,</span>&nbsp;<span class="op" id="5977931">[</span><span class="op" id="5977932">]</span><span class="builtintype" id="5977933">byte</span><span class="op" id="5977937">(</span><span class="ident" id="5977938"><a href="/go/doc/comment.go.html#5977523">url</a></span><span class="op" id="5977941">)</span><span class="op" id="5977942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977947"><a href="/go/doc/comment.go.html#5976909">w</a></span><span class="op" id="5977948">.</span><span class="ident" id="5977949">Write</span><span class="op" id="5977954">(</span><span class="ident" id="5977955"><a href="/go/doc/comment.go.html#5975581">html_aq</a></span><span class="op" id="5977962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977970">if</span>&nbsp;<span class="ident" id="5977973"><a href="/go/doc/comment.go.html#5977535">italics</a></span>&nbsp;<span class="op" id="5977981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977986"><a href="/go/doc/comment.go.html#5976909">w</a></span><span class="op" id="5977987">.</span><span class="ident" id="5977988">Write</span><span class="op" id="5977993">(</span><span class="ident" id="5977994"><a href="/go/doc/comment.go.html#5975639">html_i</a></span><span class="op" id="5978000">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978008"><a href="/go/doc/comment.go.html#5974575">commentEscape</a></span><span class="op" id="5978021">(</span><span class="ident" id="5978022"><a href="/go/doc/comment.go.html#5976909">w</a></span><span class="op" id="5978023">,</span>&nbsp;<span class="ident" id="5978025"><a href="/go/doc/comment.go.html#5977230">match</a></span><span class="op" id="5978030">,</span>&nbsp;<span class="ident" id="5978032"><a href="/go/doc/comment.go.html#5976960">nice</a></span><span class="op" id="5978036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978040">if</span>&nbsp;<span class="ident" id="5978043"><a href="/go/doc/comment.go.html#5977535">italics</a></span>&nbsp;<span class="op" id="5978051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978056"><a href="/go/doc/comment.go.html#5976909">w</a></span><span class="op" id="5978057">.</span><span class="ident" id="5978058">Write</span><span class="op" id="5978063">(</span><span class="ident" id="5978064"><a href="/go/doc/comment.go.html#5975668">html_endi</a></span><span class="op" id="5978073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978077">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978081">if</span>&nbsp;<span class="builtinfunc" id="5978084">len</span><span class="op" id="5978087">(</span><span class="ident" id="5978088"><a href="/go/doc/comment.go.html#5977523">url</a></span><span class="op" id="5978091">)</span>&nbsp;<span class="op" id="5978093">&gt;</span>&nbsp;<span class="num" id="5978095">0</span>&nbsp;<span class="op" id="5978097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978102"><a href="/go/doc/comment.go.html#5976909">w</a></span><span class="op" id="5978103">.</span><span class="ident" id="5978104">Write</span><span class="op" id="5978109">(</span><span class="ident" id="5978110"><a href="/go/doc/comment.go.html#5975609">html_enda</a></span><span class="op" id="5978119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5978128">//&nbsp;advance</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978141"><a href="/go/doc/comment.go.html#5976922">line</a></span>&nbsp;<span class="op" id="5978146">=</span>&nbsp;<span class="ident" id="5978148"><a href="/go/doc/comment.go.html#5976922">line</a></span><span class="op" id="5978152">[</span><span class="ident" id="5978153"><a href="/go/doc/comment.go.html#5976982">m</a></span><span class="op" id="5978154">[</span><span class="num" id="5978155">1</span><span class="op" id="5978156">]</span><span class="op" id="5978157">:</span><span class="op" id="5978158">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978164"><a href="/go/doc/comment.go.html#5974575">commentEscape</a></span><span class="op" id="5978177">(</span><span class="ident" id="5978178"><a href="/go/doc/comment.go.html#5976909">w</a></span><span class="op" id="5978179">,</span>&nbsp;<span class="ident" id="5978181"><a href="/go/doc/comment.go.html#5976922">line</a></span><span class="op" id="5978185">,</span>&nbsp;<span class="ident" id="5978187"><a href="/go/doc/comment.go.html#5976960">nice</a></span><span class="op" id="5978191">)</span><br>
<span class="lineno"></span><span class="op" id="5978193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="5978196">func</span>&nbsp;<span class="ident" id="5978201">indentLen</span><span class="op" id="5978210">(</span><span class="ident" id="5978211">s</span>&nbsp;<span class="builtintype" id="5978213">string</span><span class="op" id="5978219">)</span>&nbsp;<span class="builtintype" id="5978221">int</span>&nbsp;<span class="op" id="5978225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978228">i</span>&nbsp;<span class="op" id="5978230">:=</span>&nbsp;<span class="num" id="5978233">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978236">for</span>&nbsp;<span class="ident" id="5978240"><a href="/go/doc/comment.go.html#5978228">i</a></span>&nbsp;<span class="op" id="5978242">&lt;</span>&nbsp;<span class="builtinfunc" id="5978244">len</span><span class="op" id="5978247">(</span><span class="ident" id="5978248"><a href="/go/doc/comment.go.html#5978211">s</a></span><span class="op" id="5978249">)</span>&nbsp;<span class="op" id="5978251">&amp;&amp;</span>&nbsp;<span class="op" id="5978254">(</span><span class="ident" id="5978255"><a href="/go/doc/comment.go.html#5978211">s</a></span><span class="op" id="5978256">[</span><span class="ident" id="5978257"><a href="/go/doc/comment.go.html#5978228">i</a></span><span class="op" id="5978258">]</span>&nbsp;<span class="op" id="5978260">==</span>&nbsp;<span class="string" id="5978263">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5978267">||</span>&nbsp;<span class="ident" id="5978270"><a href="/go/doc/comment.go.html#5978211">s</a></span><span class="op" id="5978271">[</span><span class="ident" id="5978272"><a href="/go/doc/comment.go.html#5978228">i</a></span><span class="op" id="5978273">]</span>&nbsp;<span class="op" id="5978275">==</span>&nbsp;<span class="string" id="5978278">&#39;\t&#39;</span><span class="op" id="5978282">)</span>&nbsp;<span class="op" id="5978284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978288"><a href="/go/doc/comment.go.html#5978228">i</a></span><span class="op" id="5978289">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978293">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978296">return</span>&nbsp;<span class="ident" id="5978303"><a href="/go/doc/comment.go.html#5978228">i</a></span><br>
<span class="lineno"></span><span class="op" id="5978305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5978308">func</span>&nbsp;<span class="ident" id="5978313">isBlank</span><span class="op" id="5978320">(</span><span class="ident" id="5978321">s</span>&nbsp;<span class="builtintype" id="5978323">string</span><span class="op" id="5978329">)</span>&nbsp;<span class="builtintype" id="5978331">bool</span>&nbsp;<span class="op" id="5978336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978339">return</span>&nbsp;<span class="builtinfunc" id="5978346">len</span><span class="op" id="5978349">(</span><span class="ident" id="5978350"><a href="/go/doc/comment.go.html#5978321">s</a></span><span class="op" id="5978351">)</span>&nbsp;<span class="op" id="5978353">==</span>&nbsp;<span class="num" id="5978356">0</span>&nbsp;<span class="op" id="5978358">||</span>&nbsp;<span class="op" id="5978361">(</span><span class="builtinfunc" id="5978362">len</span><span class="op" id="5978365">(</span><span class="ident" id="5978366"><a href="/go/doc/comment.go.html#5978321">s</a></span><span class="op" id="5978367">)</span>&nbsp;<span class="op" id="5978369">==</span>&nbsp;<span class="num" id="5978372">1</span>&nbsp;<span class="op" id="5978374">&amp;&amp;</span>&nbsp;<span class="ident" id="5978377"><a href="/go/doc/comment.go.html#5978321">s</a></span><span class="op" id="5978378">[</span><span class="num" id="5978379">0</span><span class="op" id="5978380">]</span>&nbsp;<span class="op" id="5978382">==</span>&nbsp;<span class="string" id="5978385">&#39;\n&#39;</span><span class="op" id="5978389">)</span><br>
<span class="lineno">175</span><span class="op" id="5978391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5978394">func</span>&nbsp;<span class="ident" id="5978399">commonPrefix</span><span class="op" id="5978411">(</span><span class="ident" id="5978412">a</span><span class="op" id="5978413">,</span>&nbsp;<span class="ident" id="5978415">b</span>&nbsp;<span class="builtintype" id="5978417">string</span><span class="op" id="5978423">)</span>&nbsp;<span class="builtintype" id="5978425">string</span>&nbsp;<span class="op" id="5978432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978435">i</span>&nbsp;<span class="op" id="5978437">:=</span>&nbsp;<span class="num" id="5978440">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978443">for</span>&nbsp;<span class="ident" id="5978447"><a href="/go/doc/comment.go.html#5978435">i</a></span>&nbsp;<span class="op" id="5978449">&lt;</span>&nbsp;<span class="builtinfunc" id="5978451">len</span><span class="op" id="5978454">(</span><span class="ident" id="5978455"><a href="/go/doc/comment.go.html#5978412">a</a></span><span class="op" id="5978456">)</span>&nbsp;<span class="op" id="5978458">&amp;&amp;</span>&nbsp;<span class="ident" id="5978461"><a href="/go/doc/comment.go.html#5978435">i</a></span>&nbsp;<span class="op" id="5978463">&lt;</span>&nbsp;<span class="builtinfunc" id="5978465">len</span><span class="op" id="5978468">(</span><span class="ident" id="5978469"><a href="/go/doc/comment.go.html#5978415">b</a></span><span class="op" id="5978470">)</span>&nbsp;<span class="op" id="5978472">&amp;&amp;</span>&nbsp;<span class="ident" id="5978475"><a href="/go/doc/comment.go.html#5978412">a</a></span><span class="op" id="5978476">[</span><span class="ident" id="5978477"><a href="/go/doc/comment.go.html#5978435">i</a></span><span class="op" id="5978478">]</span>&nbsp;<span class="op" id="5978480">==</span>&nbsp;<span class="ident" id="5978483"><a href="/go/doc/comment.go.html#5978415">b</a></span><span class="op" id="5978484">[</span><span class="ident" id="5978485"><a href="/go/doc/comment.go.html#5978435">i</a></span><span class="op" id="5978486">]</span>&nbsp;<span class="op" id="5978488">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978492"><a href="/go/doc/comment.go.html#5978435">i</a></span><span class="op" id="5978493">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978500">return</span>&nbsp;<span class="ident" id="5978507"><a href="/go/doc/comment.go.html#5978412">a</a></span><span class="op" id="5978508">[</span><span class="num" id="5978509">0</span><span class="op" id="5978510">:</span><span class="ident" id="5978511"><a href="/go/doc/comment.go.html#5978435">i</a></span><span class="op" id="5978512">]</span><br>
<span class="lineno"></span><span class="op" id="5978514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="5978517">func</span>&nbsp;<span class="ident" id="5978522">unindent</span><span class="op" id="5978530">(</span><span class="ident" id="5978531">block</span>&nbsp;<span class="op" id="5978537">[</span><span class="op" id="5978538">]</span><span class="builtintype" id="5978539">string</span><span class="op" id="5978545">)</span>&nbsp;<span class="op" id="5978547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978550">if</span>&nbsp;<span class="builtinfunc" id="5978553">len</span><span class="op" id="5978556">(</span><span class="ident" id="5978557"><a href="/go/doc/comment.go.html#5978531">block</a></span><span class="op" id="5978562">)</span>&nbsp;<span class="op" id="5978564">==</span>&nbsp;<span class="num" id="5978567">0</span>&nbsp;<span class="op" id="5978569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978573">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5978585">//&nbsp;compute&nbsp;maximum&nbsp;common&nbsp;white&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978625">prefix</span>&nbsp;<span class="op" id="5978632">:=</span>&nbsp;<span class="ident" id="5978635"><a href="/go/doc/comment.go.html#5978531">block</a></span><span class="op" id="5978640">[</span><span class="num" id="5978641">0</span><span class="op" id="5978642">]</span><span class="op" id="5978643">[</span><span class="num" id="5978644">0</span><span class="op" id="5978645">:</span><span class="ident" id="5978646"><a href="/go/doc/comment.go.html#5978201">indentLen</a></span><span class="op" id="5978655">(</span><span class="ident" id="5978656"><a href="/go/doc/comment.go.html#5978531">block</a></span><span class="op" id="5978661">[</span><span class="num" id="5978662">0</span><span class="op" id="5978663">]</span><span class="op" id="5978664">)</span><span class="op" id="5978665">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978668">for</span>&nbsp;<span class="ident" id="5978672">_</span><span class="op" id="5978673">,</span>&nbsp;<span class="ident" id="5978675">line</span>&nbsp;<span class="op" id="5978680">:=</span>&nbsp;<span class="keyword" id="5978683">range</span>&nbsp;<span class="ident" id="5978689"><a href="/go/doc/comment.go.html#5978531">block</a></span>&nbsp;<span class="op" id="5978695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978699">if</span>&nbsp;<span class="op" id="5978702">!</span><span class="ident" id="5978703"><a href="/go/doc/comment.go.html#5978313">isBlank</a></span><span class="op" id="5978710">(</span><span class="ident" id="5978711"><a href="/go/doc/comment.go.html#5978675">line</a></span><span class="op" id="5978715">)</span>&nbsp;<span class="op" id="5978717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978722"><a href="/go/doc/comment.go.html#5978625">prefix</a></span>&nbsp;<span class="op" id="5978729">=</span>&nbsp;<span class="ident" id="5978731"><a href="/go/doc/comment.go.html#5978399">commonPrefix</a></span><span class="op" id="5978743">(</span><span class="ident" id="5978744"><a href="/go/doc/comment.go.html#5978625">prefix</a></span><span class="op" id="5978750">,</span>&nbsp;<span class="ident" id="5978752"><a href="/go/doc/comment.go.html#5978675">line</a></span><span class="op" id="5978756">[</span><span class="num" id="5978757">0</span><span class="op" id="5978758">:</span><span class="ident" id="5978759"><a href="/go/doc/comment.go.html#5978201">indentLen</a></span><span class="op" id="5978768">(</span><span class="ident" id="5978769"><a href="/go/doc/comment.go.html#5978675">line</a></span><span class="op" id="5978773">)</span><span class="op" id="5978774">]</span><span class="op" id="5978775">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978785">n</span>&nbsp;<span class="op" id="5978787">:=</span>&nbsp;<span class="builtinfunc" id="5978790">len</span><span class="op" id="5978793">(</span><span class="ident" id="5978794"><a href="/go/doc/comment.go.html#5978625">prefix</a></span><span class="op" id="5978800">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5978804">//&nbsp;remove</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978815">for</span>&nbsp;<span class="ident" id="5978819">i</span><span class="op" id="5978820">,</span>&nbsp;<span class="ident" id="5978822">line</span>&nbsp;<span class="op" id="5978827">:=</span>&nbsp;<span class="keyword" id="5978830">range</span>&nbsp;<span class="ident" id="5978836"><a href="/go/doc/comment.go.html#5978531">block</a></span>&nbsp;<span class="op" id="5978842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5978846">if</span>&nbsp;<span class="op" id="5978849">!</span><span class="ident" id="5978850"><a href="/go/doc/comment.go.html#5978313">isBlank</a></span><span class="op" id="5978857">(</span><span class="ident" id="5978858"><a href="/go/doc/comment.go.html#5978822">line</a></span><span class="op" id="5978862">)</span>&nbsp;<span class="op" id="5978864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978869"><a href="/go/doc/comment.go.html#5978531">block</a></span><span class="op" id="5978874">[</span><span class="ident" id="5978875"><a href="/go/doc/comment.go.html#5978819">i</a></span><span class="op" id="5978876">]</span>&nbsp;<span class="op" id="5978878">=</span>&nbsp;<span class="ident" id="5978880"><a href="/go/doc/comment.go.html#5978822">line</a></span><span class="op" id="5978884">[</span><span class="ident" id="5978885"><a href="/go/doc/comment.go.html#5978785">n</a></span><span class="op" id="5978886">:</span><span class="op" id="5978887">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5978894">}</span><br>
<span class="lineno">205</span><span class="op" id="5978896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5978899">//&nbsp;heading&nbsp;returns&nbsp;the&nbsp;trimmed&nbsp;line&nbsp;if&nbsp;it&nbsp;passes&nbsp;as&nbsp;a&nbsp;section&nbsp;heading;</span><br>
<span class="lineno"></span><span class="comment" id="5978970">//&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5979012">func</span>&nbsp;<span class="ident" id="5979017">heading</span><span class="op" id="5979024">(</span><span class="ident" id="5979025">line</span>&nbsp;<span class="builtintype" id="5979030">string</span><span class="op" id="5979036">)</span>&nbsp;<span class="builtintype" id="5979038">string</span>&nbsp;<span class="op" id="5979045">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5979048"><a href="/go/doc/comment.go.html#5979025">line</a></span>&nbsp;<span class="op" id="5979053">=</span>&nbsp;<span class="ident" id="5979055"><a href="/go/doc/comment.go.html#5974333">strings</a></span><span class="op" id="5979062">.</span><span class="ident" id="5979063">TrimSpace</span><span class="op" id="5979072">(</span><span class="ident" id="5979073"><a href="/go/doc/comment.go.html#5979025">line</a></span><span class="op" id="5979077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979080">if</span>&nbsp;<span class="builtinfunc" id="5979083">len</span><span class="op" id="5979086">(</span><span class="ident" id="5979087"><a href="/go/doc/comment.go.html#5979025">line</a></span><span class="op" id="5979091">)</span>&nbsp;<span class="op" id="5979093">==</span>&nbsp;<span class="num" id="5979096">0</span>&nbsp;<span class="op" id="5979098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979102">return</span>&nbsp;<span class="string" id="5979109">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5979113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5979117">//&nbsp;a&nbsp;heading&nbsp;must&nbsp;start&nbsp;with&nbsp;an&nbsp;uppercase&nbsp;letter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5979167">r</span><span class="op" id="5979168">,</span>&nbsp;<span class="ident" id="5979170">_</span>&nbsp;<span class="op" id="5979172">:=</span>&nbsp;<span class="ident" id="5979175"><a href="/go/doc/comment.go.html#5974390">utf8</a></span><span class="op" id="5979179">.</span><span class="ident" id="5979180">DecodeRuneInString</span><span class="op" id="5979198">(</span><span class="ident" id="5979199"><a href="/go/doc/comment.go.html#5979025">line</a></span><span class="op" id="5979203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979206">if</span>&nbsp;<span class="op" id="5979209">!</span><span class="ident" id="5979210"><a href="/go/doc/comment.go.html#5974379">unicode</a></span><span class="op" id="5979217">.</span><span class="ident" id="5979218">IsLetter</span><span class="op" id="5979226">(</span><span class="ident" id="5979227"><a href="/go/doc/comment.go.html#5979167">r</a></span><span class="op" id="5979228">)</span>&nbsp;<span class="op" id="5979230">||</span>&nbsp;<span class="op" id="5979233">!</span><span class="ident" id="5979234"><a href="/go/doc/comment.go.html#5974379">unicode</a></span><span class="op" id="5979241">.</span><span class="ident" id="5979242">IsUpper</span><span class="op" id="5979249">(</span><span class="ident" id="5979250"><a href="/go/doc/comment.go.html#5979167">r</a></span><span class="op" id="5979251">)</span>&nbsp;<span class="op" id="5979253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979257">return</span>&nbsp;<span class="string" id="5979264">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5979268">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5979272">//&nbsp;it&nbsp;must&nbsp;end&nbsp;in&nbsp;a&nbsp;letter&nbsp;or&nbsp;digit:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5979310"><a href="/go/doc/comment.go.html#5979167">r</a></span><span class="op" id="5979311">,</span>&nbsp;<span class="ident" id="5979313">_</span>&nbsp;<span class="op" id="5979315">=</span>&nbsp;<span class="ident" id="5979317"><a href="/go/doc/comment.go.html#5974390">utf8</a></span><span class="op" id="5979321">.</span><span class="ident" id="5979322">DecodeLastRuneInString</span><span class="op" id="5979344">(</span><span class="ident" id="5979345"><a href="/go/doc/comment.go.html#5979025">line</a></span><span class="op" id="5979349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979352">if</span>&nbsp;<span class="op" id="5979355">!</span><span class="ident" id="5979356"><a href="/go/doc/comment.go.html#5974379">unicode</a></span><span class="op" id="5979363">.</span><span class="ident" id="5979364">IsLetter</span><span class="op" id="5979372">(</span><span class="ident" id="5979373"><a href="/go/doc/comment.go.html#5979167">r</a></span><span class="op" id="5979374">)</span>&nbsp;<span class="op" id="5979376">&amp;&amp;</span>&nbsp;<span class="op" id="5979379">!</span><span class="ident" id="5979380"><a href="/go/doc/comment.go.html#5974379">unicode</a></span><span class="op" id="5979387">.</span><span class="ident" id="5979388">IsDigit</span><span class="op" id="5979395">(</span><span class="ident" id="5979396"><a href="/go/doc/comment.go.html#5979167">r</a></span><span class="op" id="5979397">)</span>&nbsp;<span class="op" id="5979399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979403">return</span>&nbsp;<span class="string" id="5979410">&#34;&#34;</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5979414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5979418">//&nbsp;exclude&nbsp;lines&nbsp;with&nbsp;illegal&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979460">if</span>&nbsp;<span class="ident" id="5979463"><a href="/go/doc/comment.go.html#5974333">strings</a></span><span class="op" id="5979470">.</span><span class="ident" id="5979471">IndexAny</span><span class="op" id="5979479">(</span><span class="ident" id="5979480"><a href="/go/doc/comment.go.html#5979025">line</a></span><span class="op" id="5979484">,</span>&nbsp;<span class="string" id="5979486">&#34;,.;:!?+*/=()[]{}_^&amp;~%#@&lt;\&#34;&gt;\\&#34;</span><span class="op" id="5979521">)</span>&nbsp;<span class="op" id="5979523">&gt;=</span>&nbsp;<span class="num" id="5979526">0</span>&nbsp;<span class="op" id="5979528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979532">return</span>&nbsp;<span class="string" id="5979539">&#34;&#34;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5979543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5979547">//&nbsp;allow&nbsp;&#34;&#39;&#34;&nbsp;for&nbsp;possessive&nbsp;&#34;&#39;s&#34;&nbsp;only</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979586">for</span>&nbsp;<span class="ident" id="5979590">b</span>&nbsp;<span class="op" id="5979592">:=</span>&nbsp;<span class="ident" id="5979595"><a href="/go/doc/comment.go.html#5979025">line</a></span><span class="op" id="5979599">;</span>&nbsp;<span class="op" id="5979601">;</span>&nbsp;<span class="op" id="5979603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5979607">i</span>&nbsp;<span class="op" id="5979609">:=</span>&nbsp;<span class="ident" id="5979612"><a href="/go/doc/comment.go.html#5974333">strings</a></span><span class="op" id="5979619">.</span><span class="ident" id="5979620">IndexRune</span><span class="op" id="5979629">(</span><span class="ident" id="5979630"><a href="/go/doc/comment.go.html#5979590">b</a></span><span class="op" id="5979631">,</span>&nbsp;<span class="string" id="5979633">&#39;\&#39;&#39;</span><span class="op" id="5979637">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979641">if</span>&nbsp;<span class="ident" id="5979644"><a href="/go/doc/comment.go.html#5979607">i</a></span>&nbsp;<span class="op" id="5979646">&lt;</span>&nbsp;<span class="num" id="5979648">0</span>&nbsp;<span class="op" id="5979650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979655">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5979663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979667">if</span>&nbsp;<span class="ident" id="5979670"><a href="/go/doc/comment.go.html#5979607">i</a></span><span class="op" id="5979671">+</span><span class="num" id="5979672">1</span>&nbsp;<span class="op" id="5979674">&gt;=</span>&nbsp;<span class="builtinfunc" id="5979677">len</span><span class="op" id="5979680">(</span><span class="ident" id="5979681"><a href="/go/doc/comment.go.html#5979590">b</a></span><span class="op" id="5979682">)</span>&nbsp;<span class="op" id="5979684">||</span>&nbsp;<span class="ident" id="5979687"><a href="/go/doc/comment.go.html#5979590">b</a></span><span class="op" id="5979688">[</span><span class="ident" id="5979689"><a href="/go/doc/comment.go.html#5979607">i</a></span><span class="op" id="5979690">+</span><span class="num" id="5979691">1</span><span class="op" id="5979692">]</span>&nbsp;<span class="op" id="5979694">!=</span>&nbsp;<span class="string" id="5979697">&#39;s&#39;</span>&nbsp;<span class="op" id="5979701">||</span>&nbsp;<span class="op" id="5979704">(</span><span class="ident" id="5979705"><a href="/go/doc/comment.go.html#5979607">i</a></span><span class="op" id="5979706">+</span><span class="num" id="5979707">2</span>&nbsp;<span class="op" id="5979709">&lt;</span>&nbsp;<span class="builtinfunc" id="5979711">len</span><span class="op" id="5979714">(</span><span class="ident" id="5979715"><a href="/go/doc/comment.go.html#5979590">b</a></span><span class="op" id="5979716">)</span>&nbsp;<span class="op" id="5979718">&amp;&amp;</span>&nbsp;<span class="ident" id="5979721"><a href="/go/doc/comment.go.html#5979590">b</a></span><span class="op" id="5979722">[</span><span class="ident" id="5979723"><a href="/go/doc/comment.go.html#5979607">i</a></span><span class="op" id="5979724">+</span><span class="num" id="5979725">2</span><span class="op" id="5979726">]</span>&nbsp;<span class="op" id="5979728">!=</span>&nbsp;<span class="string" id="5979731">&#39;&nbsp;&#39;</span><span class="op" id="5979734">)</span>&nbsp;<span class="op" id="5979736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979741">return</span>&nbsp;<span class="string" id="5979748">&#34;&#34;</span>&nbsp;<span class="comment" id="5979751">//&nbsp;not&nbsp;followed&nbsp;by&nbsp;&#34;s&nbsp;&#34;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5979777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5979781"><a href="/go/doc/comment.go.html#5979590">b</a></span>&nbsp;<span class="op" id="5979783">=</span>&nbsp;<span class="ident" id="5979785"><a href="/go/doc/comment.go.html#5979590">b</a></span><span class="op" id="5979786">[</span><span class="ident" id="5979787"><a href="/go/doc/comment.go.html#5979607">i</a></span><span class="op" id="5979788">+</span><span class="num" id="5979789">2</span><span class="op" id="5979790">:</span><span class="op" id="5979791">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5979794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5979798">return</span>&nbsp;<span class="ident" id="5979805"><a href="/go/doc/comment.go.html#5979025">line</a></span><br>
<span class="lineno">245</span><span class="op" id="5979810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5979813">type</span>&nbsp;<span class="ident" id="5979818">op</span>&nbsp;<span class="builtintype" id="5979821">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5979826">const</span>&nbsp;<span class="op" id="5979832">(</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5979835">opPara</span>&nbsp;<span class="ident" id="5979842"><a href="/go/doc/comment.go.html#5979818">op</a></span>&nbsp;<span class="op" id="5979845">=</span>&nbsp;<span class="ident" id="5979847">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5979853">opHead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5979861">opPre</span><br>
<span class="lineno"></span><span class="op" id="5979867">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="keyword" id="5979870">type</span>&nbsp;<span class="ident" id="5979875">block</span>&nbsp;<span class="keyword" id="5979881">struct</span>&nbsp;<span class="op" id="5979888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5979891">op</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5979897"><a href="/go/doc/comment.go.html#5979818">op</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5979901">lines</span>&nbsp;<span class="op" id="5979907">[</span><span class="op" id="5979908">]</span><span class="builtintype" id="5979909">string</span><br>
<span class="lineno"></span><span class="op" id="5979916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="5979919">var</span>&nbsp;<span class="ident" id="5979923">nonAlphaNumRx</span>&nbsp;<span class="op" id="5979937">=</span>&nbsp;<span class="ident" id="5979939"><a href="/go/doc/comment.go.html#5974323">regexp</a></span><span class="op" id="5979945">.</span><span class="ident" id="5979946">MustCompile</span><span class="op" id="5979957">(</span><span class="string" id="5979958">`[^a-zA-Z0-9]`</span><span class="op" id="5979972">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5979975">func</span>&nbsp;<span class="ident" id="5979980">anchorID</span><span class="op" id="5979988">(</span><span class="ident" id="5979989">line</span>&nbsp;<span class="builtintype" id="5979994">string</span><span class="op" id="5980000">)</span>&nbsp;<span class="builtintype" id="5980002">string</span>&nbsp;<span class="op" id="5980009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5980012">//&nbsp;Add&nbsp;a&nbsp;&#34;hdr-&#34;&nbsp;prefix&nbsp;to&nbsp;avoid&nbsp;conflicting&nbsp;with&nbsp;IDs&nbsp;used&nbsp;for&nbsp;package&nbsp;symbols.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5980092">return</span>&nbsp;<span class="string" id="5980099">&#34;hdr-&#34;</span>&nbsp;<span class="op" id="5980106">+</span>&nbsp;<span class="ident" id="5980108"><a href="/go/doc/comment.go.html#5979923">nonAlphaNumRx</a></span><span class="op" id="5980121">.</span><span class="ident" id="5980122">ReplaceAllString</span><span class="op" id="5980138">(</span><span class="ident" id="5980139"><a href="/go/doc/comment.go.html#5979989">line</a></span><span class="op" id="5980143">,</span>&nbsp;<span class="string" id="5980145">&#34;_&#34;</span><span class="op" id="5980148">)</span><br>
<span class="lineno">265</span><span class="op" id="5980150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5980153">//&nbsp;ToHTML&nbsp;converts&nbsp;comment&nbsp;text&nbsp;to&nbsp;formatted&nbsp;HTML.</span><br>
<span class="lineno"></span><span class="comment" id="5980204">//&nbsp;The&nbsp;comment&nbsp;was&nbsp;prepared&nbsp;by&nbsp;DocReader,</span><br>
<span class="lineno"></span><span class="comment" id="5980246">//&nbsp;so&nbsp;it&nbsp;is&nbsp;known&nbsp;not&nbsp;to&nbsp;have&nbsp;leading,&nbsp;trailing&nbsp;blank&nbsp;lines</span><br>
<span class="lineno">270</span><span class="comment" id="5980306">//&nbsp;nor&nbsp;to&nbsp;have&nbsp;trailing&nbsp;spaces&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;lines.</span><br>
<span class="lineno"></span><span class="comment" id="5980358">//&nbsp;The&nbsp;comment&nbsp;markers&nbsp;have&nbsp;already&nbsp;been&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="5980408">//</span><br>
<span class="lineno"></span><span class="comment" id="5980411">//&nbsp;Each&nbsp;span&nbsp;of&nbsp;unindented&nbsp;non-blank&nbsp;lines&nbsp;is&nbsp;converted&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="5980472">//&nbsp;a&nbsp;single&nbsp;paragraph.&nbsp;There&nbsp;is&nbsp;one&nbsp;exception&nbsp;to&nbsp;the&nbsp;rule:&nbsp;a&nbsp;span&nbsp;that</span><br>
<span class="lineno">275</span><span class="comment" id="5980543">//&nbsp;consists&nbsp;of&nbsp;a&nbsp;single&nbsp;line,&nbsp;is&nbsp;followed&nbsp;by&nbsp;another&nbsp;paragraph&nbsp;span,</span><br>
<span class="lineno"></span><span class="comment" id="5980612">//&nbsp;begins&nbsp;with&nbsp;a&nbsp;capital&nbsp;letter,&nbsp;and&nbsp;contains&nbsp;no&nbsp;punctuation</span><br>
<span class="lineno"></span><span class="comment" id="5980673">//&nbsp;is&nbsp;formatted&nbsp;as&nbsp;a&nbsp;heading.</span><br>
<span class="lineno"></span><span class="comment" id="5980703">//</span><br>
<span class="lineno"></span><span class="comment" id="5980706">//&nbsp;A&nbsp;span&nbsp;of&nbsp;indented&nbsp;lines&nbsp;is&nbsp;converted&nbsp;into&nbsp;a&nbsp;&lt;pre&gt;&nbsp;block,</span><br>
<span class="lineno">280</span><span class="comment" id="5980767">//&nbsp;with&nbsp;the&nbsp;common&nbsp;indent&nbsp;prefix&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="5980809">//</span><br>
<span class="lineno"></span><span class="comment" id="5980812">//&nbsp;URLs&nbsp;in&nbsp;the&nbsp;comment&nbsp;text&nbsp;are&nbsp;converted&nbsp;into&nbsp;links;&nbsp;if&nbsp;the&nbsp;URL&nbsp;also&nbsp;appears</span><br>
<span class="lineno"></span><span class="comment" id="5980890">//&nbsp;in&nbsp;the&nbsp;words&nbsp;map,&nbsp;the&nbsp;link&nbsp;is&nbsp;taken&nbsp;from&nbsp;the&nbsp;map&nbsp;(if&nbsp;the&nbsp;corresponding&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="5980968">//&nbsp;value&nbsp;is&nbsp;the&nbsp;empty&nbsp;string,&nbsp;the&nbsp;URL&nbsp;is&nbsp;not&nbsp;converted&nbsp;into&nbsp;a&nbsp;link).</span><br>
<span class="lineno">285</span><span class="comment" id="5981037">//</span><br>
<span class="lineno"></span><span class="comment" id="5981040">//&nbsp;Go&nbsp;identifiers&nbsp;that&nbsp;appear&nbsp;in&nbsp;the&nbsp;words&nbsp;map&nbsp;are&nbsp;italicized;&nbsp;if&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="5981124">//&nbsp;map&nbsp;value&nbsp;is&nbsp;not&nbsp;the&nbsp;empty&nbsp;string,&nbsp;it&nbsp;is&nbsp;considered&nbsp;a&nbsp;URL&nbsp;and&nbsp;the&nbsp;word&nbsp;is&nbsp;converted</span><br>
<span class="lineno"></span><span class="comment" id="5981211">//&nbsp;into&nbsp;a&nbsp;link.</span><br>
<span class="lineno"></span><span class="keyword" id="5981227">func</span>&nbsp;<span class="ident" id="5981232">ToHTML</span><span class="op" id="5981238">(</span><span class="ident" id="5981239">w</span>&nbsp;<span class="ident" id="5981241"><a href="/go/doc/comment.go.html#5974317">io</a></span><span class="op" id="5981243">.</span><span class="ident" id="5981244">Writer</span><span class="op" id="5981250">,</span>&nbsp;<span class="ident" id="5981252">text</span>&nbsp;<span class="builtintype" id="5981257">string</span><span class="op" id="5981263">,</span>&nbsp;<span class="ident" id="5981265">words</span>&nbsp;<span class="keyword" id="5981271">map</span><span class="op" id="5981274">[</span><span class="builtintype" id="5981275">string</span><span class="op" id="5981281">]</span><span class="builtintype" id="5981282">string</span><span class="op" id="5981288">)</span>&nbsp;<span class="op" id="5981290">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981293">for</span>&nbsp;<span class="ident" id="5981297">_</span><span class="op" id="5981298">,</span>&nbsp;<span class="ident" id="5981300">b</span>&nbsp;<span class="op" id="5981302">:=</span>&nbsp;<span class="keyword" id="5981305">range</span>&nbsp;<span class="ident" id="5981311"><a href="/go/doc/comment.go.html#5981900">blocks</a></span><span class="op" id="5981317">(</span><span class="ident" id="5981318"><a href="/go/doc/comment.go.html#5981252">text</a></span><span class="op" id="5981322">)</span>&nbsp;<span class="op" id="5981324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981328">switch</span>&nbsp;<span class="ident" id="5981335"><a href="/go/doc/comment.go.html#5981300">b</a></span><span class="op" id="5981336">.</span><span class="ident" id="5981337">op</span>&nbsp;<span class="op" id="5981340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981344">case</span>&nbsp;<span class="ident" id="5981349"><a href="/go/doc/comment.go.html#5979835">opPara</a></span><span class="op" id="5981355">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981360"><a href="/go/doc/comment.go.html#5981239">w</a></span><span class="op" id="5981361">.</span><span class="ident" id="5981362">Write</span><span class="op" id="5981367">(</span><span class="ident" id="5981368"><a href="/go/doc/comment.go.html#5975698">html_p</a></span><span class="op" id="5981374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981379">for</span>&nbsp;<span class="ident" id="5981383">_</span><span class="op" id="5981384">,</span>&nbsp;<span class="ident" id="5981386">line</span>&nbsp;<span class="op" id="5981391">:=</span>&nbsp;<span class="keyword" id="5981394">range</span>&nbsp;<span class="ident" id="5981400"><a href="/go/doc/comment.go.html#5981300">b</a></span><span class="op" id="5981401">.</span><span class="ident" id="5981402">lines</span>&nbsp;<span class="op" id="5981408">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981414"><a href="/go/doc/comment.go.html#5976899">emphasize</a></span><span class="op" id="5981423">(</span><span class="ident" id="5981424"><a href="/go/doc/comment.go.html#5981239">w</a></span><span class="op" id="5981425">,</span>&nbsp;<span class="ident" id="5981427"><a href="/go/doc/comment.go.html#5981386">line</a></span><span class="op" id="5981431">,</span>&nbsp;<span class="ident" id="5981433"><a href="/go/doc/comment.go.html#5981265">words</a></span><span class="op" id="5981438">,</span>&nbsp;<span class="ident" id="5981440">true</span><span class="op" id="5981444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5981449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981454"><a href="/go/doc/comment.go.html#5981239">w</a></span><span class="op" id="5981455">.</span><span class="ident" id="5981456">Write</span><span class="op" id="5981461">(</span><span class="ident" id="5981462"><a href="/go/doc/comment.go.html#5975729">html_endp</a></span><span class="op" id="5981471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981475">case</span>&nbsp;<span class="ident" id="5981480"><a href="/go/doc/comment.go.html#5979853">opHead</a></span><span class="op" id="5981486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981491"><a href="/go/doc/comment.go.html#5981239">w</a></span><span class="op" id="5981492">.</span><span class="ident" id="5981493">Write</span><span class="op" id="5981498">(</span><span class="ident" id="5981499"><a href="/go/doc/comment.go.html#5975826">html_h</a></span><span class="op" id="5981505">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981510">id</span>&nbsp;<span class="op" id="5981513">:=</span>&nbsp;<span class="string" id="5981516">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981522">for</span>&nbsp;<span class="ident" id="5981526">_</span><span class="op" id="5981527">,</span>&nbsp;<span class="ident" id="5981529">line</span>&nbsp;<span class="op" id="5981534">:=</span>&nbsp;<span class="keyword" id="5981537">range</span>&nbsp;<span class="ident" id="5981543"><a href="/go/doc/comment.go.html#5981300">b</a></span><span class="op" id="5981544">.</span><span class="ident" id="5981545">lines</span>&nbsp;<span class="op" id="5981551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981557">if</span>&nbsp;<span class="ident" id="5981560"><a href="/go/doc/comment.go.html#5981510">id</a></span>&nbsp;<span class="op" id="5981563">==</span>&nbsp;<span class="string" id="5981566">&#34;&#34;</span>&nbsp;<span class="op" id="5981569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981576"><a href="/go/doc/comment.go.html#5981510">id</a></span>&nbsp;<span class="op" id="5981579">=</span>&nbsp;<span class="ident" id="5981581"><a href="/go/doc/comment.go.html#5979980">anchorID</a></span><span class="op" id="5981589">(</span><span class="ident" id="5981590"><a href="/go/doc/comment.go.html#5981529">line</a></span><span class="op" id="5981594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981601"><a href="/go/doc/comment.go.html#5981239">w</a></span><span class="op" id="5981602">.</span><span class="ident" id="5981603">Write</span><span class="op" id="5981608">(</span><span class="op" id="5981609">[</span><span class="op" id="5981610">]</span><span class="builtintype" id="5981611">byte</span><span class="op" id="5981615">(</span><span class="ident" id="5981616"><a href="/go/doc/comment.go.html#5981510">id</a></span><span class="op" id="5981618">)</span><span class="op" id="5981619">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981626"><a href="/go/doc/comment.go.html#5981239">w</a></span><span class="op" id="5981627">.</span><span class="ident" id="5981628">Write</span><span class="op" id="5981633">(</span><span class="ident" id="5981634"><a href="/go/doc/comment.go.html#5975860">html_hq</a></span><span class="op" id="5981641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5981647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981653"><a href="/go/doc/comment.go.html#5974575">commentEscape</a></span><span class="op" id="5981666">(</span><span class="ident" id="5981667"><a href="/go/doc/comment.go.html#5981239">w</a></span><span class="op" id="5981668">,</span>&nbsp;<span class="ident" id="5981670"><a href="/go/doc/comment.go.html#5981529">line</a></span><span class="op" id="5981674">,</span>&nbsp;<span class="ident" id="5981676">true</span><span class="op" id="5981680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5981685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981690">if</span>&nbsp;<span class="ident" id="5981693"><a href="/go/doc/comment.go.html#5981510">id</a></span>&nbsp;<span class="op" id="5981696">==</span>&nbsp;<span class="string" id="5981699">&#34;&#34;</span>&nbsp;<span class="op" id="5981702">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981708"><a href="/go/doc/comment.go.html#5981239">w</a></span><span class="op" id="5981709">.</span><span class="ident" id="5981710">Write</span><span class="op" id="5981715">(</span><span class="ident" id="5981716"><a href="/go/doc/comment.go.html#5975860">html_hq</a></span><span class="op" id="5981723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5981728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981733"><a href="/go/doc/comment.go.html#5981239">w</a></span><span class="op" id="5981734">.</span><span class="ident" id="5981735">Write</span><span class="op" id="5981740">(</span><span class="ident" id="5981741"><a href="/go/doc/comment.go.html#5975888">html_endh</a></span><span class="op" id="5981750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981754">case</span>&nbsp;<span class="ident" id="5981759"><a href="/go/doc/comment.go.html#5979861">opPre</a></span><span class="op" id="5981764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981769"><a href="/go/doc/comment.go.html#5981239">w</a></span><span class="op" id="5981770">.</span><span class="ident" id="5981771">Write</span><span class="op" id="5981776">(</span><span class="ident" id="5981777"><a href="/go/doc/comment.go.html#5975761">html_pre</a></span><span class="op" id="5981785">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981790">for</span>&nbsp;<span class="ident" id="5981794">_</span><span class="op" id="5981795">,</span>&nbsp;<span class="ident" id="5981797">line</span>&nbsp;<span class="op" id="5981802">:=</span>&nbsp;<span class="keyword" id="5981805">range</span>&nbsp;<span class="ident" id="5981811"><a href="/go/doc/comment.go.html#5981300">b</a></span><span class="op" id="5981812">.</span><span class="ident" id="5981813">lines</span>&nbsp;<span class="op" id="5981819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981825"><a href="/go/doc/comment.go.html#5976899">emphasize</a></span><span class="op" id="5981834">(</span><span class="ident" id="5981835"><a href="/go/doc/comment.go.html#5981239">w</a></span><span class="op" id="5981836">,</span>&nbsp;<span class="ident" id="5981838"><a href="/go/doc/comment.go.html#5981797">line</a></span><span class="op" id="5981842">,</span>&nbsp;<span class="ident" id="5981844">nil</span><span class="op" id="5981847">,</span>&nbsp;<span class="ident" id="5981849">false</span><span class="op" id="5981854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5981859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981864"><a href="/go/doc/comment.go.html#5981239">w</a></span><span class="op" id="5981865">.</span><span class="ident" id="5981866">Write</span><span class="op" id="5981871">(</span><span class="ident" id="5981872"><a href="/go/doc/comment.go.html#5975792">html_endpre</a></span><span class="op" id="5981883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5981887">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5981890">}</span><br>
<span class="lineno"></span><span class="op" id="5981892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5981895">func</span>&nbsp;<span class="ident" id="5981900">blocks</span><span class="op" id="5981906">(</span><span class="ident" id="5981907">text</span>&nbsp;<span class="builtintype" id="5981912">string</span><span class="op" id="5981918">)</span>&nbsp;<span class="op" id="5981920">[</span><span class="op" id="5981921">]</span><span class="ident" id="5981922"><a href="/go/doc/comment.go.html#5979875">block</a></span>&nbsp;<span class="op" id="5981928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5981931">var</span>&nbsp;<span class="op" id="5981935">(</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981939">out</span>&nbsp;&nbsp;<span class="op" id="5981944">[</span><span class="op" id="5981945">]</span><span class="ident" id="5981946"><a href="/go/doc/comment.go.html#5979875">block</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981954">para</span>&nbsp;<span class="op" id="5981959">[</span><span class="op" id="5981960">]</span><span class="builtintype" id="5981961">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981971">lastWasBlank</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5981986">=</span>&nbsp;<span class="ident" id="5981988">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5981996">lastWasHeading</span>&nbsp;<span class="op" id="5982011">=</span>&nbsp;<span class="ident" id="5982013">false</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982020">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5982024">close</span>&nbsp;<span class="op" id="5982030">:=</span>&nbsp;<span class="keyword" id="5982033">func</span><span class="op" id="5982037">(</span><span class="op" id="5982038">)</span>&nbsp;<span class="op" id="5982040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982044">if</span>&nbsp;<span class="ident" id="5982047"><a href="/go/doc/comment.go.html#5981954">para</a></span>&nbsp;<span class="op" id="5982052">!=</span>&nbsp;<span class="ident" id="5982055">nil</span>&nbsp;<span class="op" id="5982059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982064"><a href="/go/doc/comment.go.html#5981939">out</a></span>&nbsp;<span class="op" id="5982068">=</span>&nbsp;<span class="builtinfunc" id="5982070">append</span><span class="op" id="5982076">(</span><span class="ident" id="5982077"><a href="/go/doc/comment.go.html#5981939">out</a></span><span class="op" id="5982080">,</span>&nbsp;<span class="ident" id="5982082"><a href="/go/doc/comment.go.html#5979875">block</a></span><span class="op" id="5982087">{</span><span class="ident" id="5982088"><a href="/go/doc/comment.go.html#5979835">opPara</a></span><span class="op" id="5982094">,</span>&nbsp;<span class="ident" id="5982096"><a href="/go/doc/comment.go.html#5981954">para</a></span><span class="op" id="5982100">}</span><span class="op" id="5982101">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982106"><a href="/go/doc/comment.go.html#5981954">para</a></span>&nbsp;<span class="op" id="5982111">=</span>&nbsp;<span class="ident" id="5982113">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982126">lines</span>&nbsp;<span class="op" id="5982132">:=</span>&nbsp;<span class="ident" id="5982135"><a href="/go/doc/comment.go.html#5974333">strings</a></span><span class="op" id="5982142">.</span><span class="ident" id="5982143">SplitAfter</span><span class="op" id="5982153">(</span><span class="ident" id="5982154"><a href="/go/doc/comment.go.html#5981907">text</a></span><span class="op" id="5982158">,</span>&nbsp;<span class="string" id="5982160">&#34;\n&#34;</span><span class="op" id="5982164">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982167"><a href="/go/doc/comment.go.html#5978522">unindent</a></span><span class="op" id="5982175">(</span><span class="ident" id="5982176"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5982181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982184">for</span>&nbsp;<span class="ident" id="5982188">i</span>&nbsp;<span class="op" id="5982190">:=</span>&nbsp;<span class="num" id="5982193">0</span><span class="op" id="5982194">;</span>&nbsp;<span class="ident" id="5982196"><a href="/go/doc/comment.go.html#5982188">i</a></span>&nbsp;<span class="op" id="5982198">&lt;</span>&nbsp;<span class="builtinfunc" id="5982200">len</span><span class="op" id="5982203">(</span><span class="ident" id="5982204"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5982209">)</span><span class="op" id="5982210">;</span>&nbsp;<span class="op" id="5982212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982216">line</span>&nbsp;<span class="op" id="5982221">:=</span>&nbsp;<span class="ident" id="5982224"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5982229">[</span><span class="ident" id="5982230"><a href="/go/doc/comment.go.html#5982188">i</a></span><span class="op" id="5982231">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982235">if</span>&nbsp;<span class="ident" id="5982238"><a href="/go/doc/comment.go.html#5978313">isBlank</a></span><span class="op" id="5982245">(</span><span class="ident" id="5982246"><a href="/go/doc/comment.go.html#5982216">line</a></span><span class="op" id="5982250">)</span>&nbsp;<span class="op" id="5982252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5982257">//&nbsp;close&nbsp;paragraph</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5982279"><a href="/go/doc/comment.go.html#5982024">close</a></span><span class="op" id="5982284">(</span><span class="op" id="5982285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982290"><a href="/go/doc/comment.go.html#5982188">i</a></span><span class="op" id="5982291">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982297"><a href="/go/doc/comment.go.html#5981971">lastWasBlank</a></span>&nbsp;<span class="op" id="5982310">=</span>&nbsp;<span class="ident" id="5982312">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982320">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982331">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982335">if</span>&nbsp;<span class="ident" id="5982338"><a href="/go/doc/comment.go.html#5978201">indentLen</a></span><span class="op" id="5982347">(</span><span class="ident" id="5982348"><a href="/go/doc/comment.go.html#5982216">line</a></span><span class="op" id="5982352">)</span>&nbsp;<span class="op" id="5982354">&gt;</span>&nbsp;<span class="num" id="5982356">0</span>&nbsp;<span class="op" id="5982358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5982363">//&nbsp;close&nbsp;paragraph</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5982385"><a href="/go/doc/comment.go.html#5982024">close</a></span><span class="op" id="5982390">(</span><span class="op" id="5982391">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5982397">//&nbsp;count&nbsp;indented&nbsp;or&nbsp;blank&nbsp;lines</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982433">j</span>&nbsp;<span class="op" id="5982435">:=</span>&nbsp;<span class="ident" id="5982438"><a href="/go/doc/comment.go.html#5982188">i</a></span>&nbsp;<span class="op" id="5982440">+</span>&nbsp;<span class="num" id="5982442">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982447">for</span>&nbsp;<span class="ident" id="5982451"><a href="/go/doc/comment.go.html#5982433">j</a></span>&nbsp;<span class="op" id="5982453">&lt;</span>&nbsp;<span class="builtinfunc" id="5982455">len</span><span class="op" id="5982458">(</span><span class="ident" id="5982459"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5982464">)</span>&nbsp;<span class="op" id="5982466">&amp;&amp;</span>&nbsp;<span class="op" id="5982469">(</span><span class="ident" id="5982470"><a href="/go/doc/comment.go.html#5978313">isBlank</a></span><span class="op" id="5982477">(</span><span class="ident" id="5982478"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5982483">[</span><span class="ident" id="5982484"><a href="/go/doc/comment.go.html#5982433">j</a></span><span class="op" id="5982485">]</span><span class="op" id="5982486">)</span>&nbsp;<span class="op" id="5982488">||</span>&nbsp;<span class="ident" id="5982491"><a href="/go/doc/comment.go.html#5978201">indentLen</a></span><span class="op" id="5982500">(</span><span class="ident" id="5982501"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5982506">[</span><span class="ident" id="5982507"><a href="/go/doc/comment.go.html#5982433">j</a></span><span class="op" id="5982508">]</span><span class="op" id="5982509">)</span>&nbsp;<span class="op" id="5982511">&gt;</span>&nbsp;<span class="num" id="5982513">0</span><span class="op" id="5982514">)</span>&nbsp;<span class="op" id="5982516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982522"><a href="/go/doc/comment.go.html#5982433">j</a></span><span class="op" id="5982523">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5982534">//&nbsp;but&nbsp;not&nbsp;trailing&nbsp;blank&nbsp;lines</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982569">for</span>&nbsp;<span class="ident" id="5982573"><a href="/go/doc/comment.go.html#5982433">j</a></span>&nbsp;<span class="op" id="5982575">&gt;</span>&nbsp;<span class="ident" id="5982577"><a href="/go/doc/comment.go.html#5982188">i</a></span>&nbsp;<span class="op" id="5982579">&amp;&amp;</span>&nbsp;<span class="ident" id="5982582"><a href="/go/doc/comment.go.html#5978313">isBlank</a></span><span class="op" id="5982589">(</span><span class="ident" id="5982590"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5982595">[</span><span class="ident" id="5982596"><a href="/go/doc/comment.go.html#5982433">j</a></span><span class="op" id="5982597">-</span><span class="num" id="5982598">1</span><span class="op" id="5982599">]</span><span class="op" id="5982600">)</span>&nbsp;<span class="op" id="5982602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982608"><a href="/go/doc/comment.go.html#5982433">j</a></span><span class="op" id="5982609">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982620">pre</span>&nbsp;<span class="op" id="5982624">:=</span>&nbsp;<span class="ident" id="5982627"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5982632">[</span><span class="ident" id="5982633"><a href="/go/doc/comment.go.html#5982188">i</a></span><span class="op" id="5982634">:</span><span class="ident" id="5982635"><a href="/go/doc/comment.go.html#5982433">j</a></span><span class="op" id="5982636">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982641"><a href="/go/doc/comment.go.html#5982188">i</a></span>&nbsp;<span class="op" id="5982643">=</span>&nbsp;<span class="ident" id="5982645"><a href="/go/doc/comment.go.html#5982433">j</a></span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982651"><a href="/go/doc/comment.go.html#5978522">unindent</a></span><span class="op" id="5982659">(</span><span class="ident" id="5982660"><a href="/go/doc/comment.go.html#5982620">pre</a></span><span class="op" id="5982663">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5982669">//&nbsp;put&nbsp;those&nbsp;lines&nbsp;in&nbsp;a&nbsp;pre&nbsp;block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982706"><a href="/go/doc/comment.go.html#5981939">out</a></span>&nbsp;<span class="op" id="5982710">=</span>&nbsp;<span class="builtinfunc" id="5982712">append</span><span class="op" id="5982718">(</span><span class="ident" id="5982719"><a href="/go/doc/comment.go.html#5981939">out</a></span><span class="op" id="5982722">,</span>&nbsp;<span class="ident" id="5982724"><a href="/go/doc/comment.go.html#5979875">block</a></span><span class="op" id="5982729">{</span><span class="ident" id="5982730"><a href="/go/doc/comment.go.html#5979861">opPre</a></span><span class="op" id="5982735">,</span>&nbsp;<span class="ident" id="5982737"><a href="/go/doc/comment.go.html#5982620">pre</a></span><span class="op" id="5982740">}</span><span class="op" id="5982741">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982746"><a href="/go/doc/comment.go.html#5981996">lastWasHeading</a></span>&nbsp;<span class="op" id="5982761">=</span>&nbsp;<span class="ident" id="5982763">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982772">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5982783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5982788">if</span>&nbsp;<span class="ident" id="5982791"><a href="/go/doc/comment.go.html#5981971">lastWasBlank</a></span>&nbsp;<span class="op" id="5982804">&amp;&amp;</span>&nbsp;<span class="op" id="5982807">!</span><span class="ident" id="5982808"><a href="/go/doc/comment.go.html#5981996">lastWasHeading</a></span>&nbsp;<span class="op" id="5982823">&amp;&amp;</span>&nbsp;<span class="ident" id="5982826"><a href="/go/doc/comment.go.html#5982188">i</a></span><span class="op" id="5982827">+</span><span class="num" id="5982828">2</span>&nbsp;<span class="op" id="5982830">&lt;</span>&nbsp;<span class="builtinfunc" id="5982832">len</span><span class="op" id="5982835">(</span><span class="ident" id="5982836"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5982841">)</span>&nbsp;<span class="op" id="5982843">&amp;&amp;</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5982849"><a href="/go/doc/comment.go.html#5978313">isBlank</a></span><span class="op" id="5982856">(</span><span class="ident" id="5982857"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5982862">[</span><span class="ident" id="5982863"><a href="/go/doc/comment.go.html#5982188">i</a></span><span class="op" id="5982864">+</span><span class="num" id="5982865">1</span><span class="op" id="5982866">]</span><span class="op" id="5982867">)</span>&nbsp;<span class="op" id="5982869">&amp;&amp;</span>&nbsp;<span class="op" id="5982872">!</span><span class="ident" id="5982873"><a href="/go/doc/comment.go.html#5978313">isBlank</a></span><span class="op" id="5982880">(</span><span class="ident" id="5982881"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5982886">[</span><span class="ident" id="5982887"><a href="/go/doc/comment.go.html#5982188">i</a></span><span class="op" id="5982888">+</span><span class="num" id="5982889">2</span><span class="op" id="5982890">]</span><span class="op" id="5982891">)</span>&nbsp;<span class="op" id="5982893">&amp;&amp;</span>&nbsp;<span class="ident" id="5982896"><a href="/go/doc/comment.go.html#5978201">indentLen</a></span><span class="op" id="5982905">(</span><span class="ident" id="5982906"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5982911">[</span><span class="ident" id="5982912"><a href="/go/doc/comment.go.html#5982188">i</a></span><span class="op" id="5982913">+</span><span class="num" id="5982914">2</span><span class="op" id="5982915">]</span><span class="op" id="5982916">)</span>&nbsp;<span class="op" id="5982918">==</span>&nbsp;<span class="num" id="5982921">0</span>&nbsp;<span class="op" id="5982923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5982928">//&nbsp;current&nbsp;line&nbsp;is&nbsp;non-blank,&nbsp;surrounded&nbsp;by&nbsp;blank&nbsp;lines</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5982987">//&nbsp;and&nbsp;the&nbsp;next&nbsp;non-blank&nbsp;line&nbsp;is&nbsp;not&nbsp;indented:&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5983043">//&nbsp;might&nbsp;be&nbsp;a&nbsp;heading.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983069">if</span>&nbsp;<span class="ident" id="5983072">head</span>&nbsp;<span class="op" id="5983077">:=</span>&nbsp;<span class="ident" id="5983080"><a href="/go/doc/comment.go.html#5979017">heading</a></span><span class="op" id="5983087">(</span><span class="ident" id="5983088"><a href="/go/doc/comment.go.html#5982216">line</a></span><span class="op" id="5983092">)</span><span class="op" id="5983093">;</span>&nbsp;<span class="ident" id="5983095"><a href="/go/doc/comment.go.html#5983072">head</a></span>&nbsp;<span class="op" id="5983100">!=</span>&nbsp;<span class="string" id="5983103">&#34;&#34;</span>&nbsp;<span class="op" id="5983106">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5983112"><a href="/go/doc/comment.go.html#5982024">close</a></span><span class="op" id="5983117">(</span><span class="op" id="5983118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983124"><a href="/go/doc/comment.go.html#5981939">out</a></span>&nbsp;<span class="op" id="5983128">=</span>&nbsp;<span class="builtinfunc" id="5983130">append</span><span class="op" id="5983136">(</span><span class="ident" id="5983137"><a href="/go/doc/comment.go.html#5981939">out</a></span><span class="op" id="5983140">,</span>&nbsp;<span class="ident" id="5983142"><a href="/go/doc/comment.go.html#5979875">block</a></span><span class="op" id="5983147">{</span><span class="ident" id="5983148"><a href="/go/doc/comment.go.html#5979853">opHead</a></span><span class="op" id="5983154">,</span>&nbsp;<span class="op" id="5983156">[</span><span class="op" id="5983157">]</span><span class="builtintype" id="5983158">string</span><span class="op" id="5983164">{</span><span class="ident" id="5983165"><a href="/go/doc/comment.go.html#5983072">head</a></span><span class="op" id="5983169">}</span><span class="op" id="5983170">}</span><span class="op" id="5983171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983177"><a href="/go/doc/comment.go.html#5982188">i</a></span>&nbsp;<span class="op" id="5983179">+=</span>&nbsp;<span class="num" id="5983182">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983188"><a href="/go/doc/comment.go.html#5981996">lastWasHeading</a></span>&nbsp;<span class="op" id="5983203">=</span>&nbsp;<span class="ident" id="5983205">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983214">continue</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5983235">//&nbsp;open&nbsp;paragraph</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983255"><a href="/go/doc/comment.go.html#5981971">lastWasBlank</a></span>&nbsp;<span class="op" id="5983268">=</span>&nbsp;<span class="ident" id="5983270">false</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983278"><a href="/go/doc/comment.go.html#5981996">lastWasHeading</a></span>&nbsp;<span class="op" id="5983293">=</span>&nbsp;<span class="ident" id="5983295">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983303"><a href="/go/doc/comment.go.html#5981954">para</a></span>&nbsp;<span class="op" id="5983308">=</span>&nbsp;<span class="builtinfunc" id="5983310">append</span><span class="op" id="5983316">(</span><span class="ident" id="5983317"><a href="/go/doc/comment.go.html#5981954">para</a></span><span class="op" id="5983321">,</span>&nbsp;<span class="ident" id="5983323"><a href="/go/doc/comment.go.html#5982126">lines</a></span><span class="op" id="5983328">[</span><span class="ident" id="5983329"><a href="/go/doc/comment.go.html#5982188">i</a></span><span class="op" id="5983330">]</span><span class="op" id="5983331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983335"><a href="/go/doc/comment.go.html#5982188">i</a></span><span class="op" id="5983336">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5983343"><a href="/go/doc/comment.go.html#5982024">close</a></span><span class="op" id="5983348">(</span><span class="op" id="5983349">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983353">return</span>&nbsp;<span class="ident" id="5983360"><a href="/go/doc/comment.go.html#5981939">out</a></span><br>
<span class="lineno"></span><span class="op" id="5983364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5983367">//&nbsp;ToText&nbsp;prepares&nbsp;comment&nbsp;text&nbsp;for&nbsp;presentation&nbsp;in&nbsp;textual&nbsp;output.</span><br>
<span class="lineno">400</span><span class="comment" id="5983435">//&nbsp;It&nbsp;wraps&nbsp;paragraphs&nbsp;of&nbsp;text&nbsp;to&nbsp;width&nbsp;or&nbsp;fewer&nbsp;Unicode&nbsp;code&nbsp;points</span><br>
<span class="lineno"></span><span class="comment" id="5983504">//&nbsp;and&nbsp;then&nbsp;prefixes&nbsp;each&nbsp;line&nbsp;with&nbsp;the&nbsp;indent.&nbsp;&nbsp;In&nbsp;preformatted&nbsp;sections</span><br>
<span class="lineno"></span><span class="comment" id="5983578">//&nbsp;(such&nbsp;as&nbsp;program&nbsp;text),&nbsp;it&nbsp;prefixes&nbsp;each&nbsp;non-blank&nbsp;line&nbsp;with&nbsp;preIndent.</span><br>
<span class="lineno"></span><span class="keyword" id="5983653">func</span>&nbsp;<span class="ident" id="5983658">ToText</span><span class="op" id="5983664">(</span><span class="ident" id="5983665">w</span>&nbsp;<span class="ident" id="5983667"><a href="/go/doc/comment.go.html#5974317">io</a></span><span class="op" id="5983669">.</span><span class="ident" id="5983670">Writer</span><span class="op" id="5983676">,</span>&nbsp;<span class="ident" id="5983678">text</span>&nbsp;<span class="builtintype" id="5983683">string</span><span class="op" id="5983689">,</span>&nbsp;<span class="ident" id="5983691">indent</span><span class="op" id="5983697">,</span>&nbsp;<span class="ident" id="5983699">preIndent</span>&nbsp;<span class="builtintype" id="5983709">string</span><span class="op" id="5983715">,</span>&nbsp;<span class="ident" id="5983717">width</span>&nbsp;<span class="builtintype" id="5983723">int</span><span class="op" id="5983726">)</span>&nbsp;<span class="op" id="5983728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983731">l</span>&nbsp;<span class="op" id="5983733">:=</span>&nbsp;<span class="ident" id="5983736"><a href="/go/doc/comment.go.html#5984304">lineWrapper</a></span><span class="op" id="5983747">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983751">out</span><span class="op" id="5983754">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5983759"><a href="/go/doc/comment.go.html#5983665">w</a></span><span class="op" id="5983760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983764">width</span><span class="op" id="5983769">:</span>&nbsp;&nbsp;<span class="ident" id="5983772"><a href="/go/doc/comment.go.html#5983717">width</a></span><span class="op" id="5983777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983781">indent</span><span class="op" id="5983787">:</span>&nbsp;<span class="ident" id="5983789"><a href="/go/doc/comment.go.html#5983691">indent</a></span><span class="op" id="5983795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983801">for</span>&nbsp;<span class="ident" id="5983805">_</span><span class="op" id="5983806">,</span>&nbsp;<span class="ident" id="5983808">b</span>&nbsp;<span class="op" id="5983810">:=</span>&nbsp;<span class="keyword" id="5983813">range</span>&nbsp;<span class="ident" id="5983819"><a href="/go/doc/comment.go.html#5981900">blocks</a></span><span class="op" id="5983825">(</span><span class="ident" id="5983826"><a href="/go/doc/comment.go.html#5983678">text</a></span><span class="op" id="5983830">)</span>&nbsp;<span class="op" id="5983832">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983836">switch</span>&nbsp;<span class="ident" id="5983843"><a href="/go/doc/comment.go.html#5983808">b</a></span><span class="op" id="5983844">.</span><span class="ident" id="5983845">op</span>&nbsp;<span class="op" id="5983848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983852">case</span>&nbsp;<span class="ident" id="5983857"><a href="/go/doc/comment.go.html#5979835">opPara</a></span><span class="op" id="5983863">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5983868">//&nbsp;l.write&nbsp;will&nbsp;add&nbsp;leading&nbsp;newline&nbsp;if&nbsp;required</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983919">for</span>&nbsp;<span class="ident" id="5983923">_</span><span class="op" id="5983924">,</span>&nbsp;<span class="ident" id="5983926">line</span>&nbsp;<span class="op" id="5983931">:=</span>&nbsp;<span class="keyword" id="5983934">range</span>&nbsp;<span class="ident" id="5983940"><a href="/go/doc/comment.go.html#5983808">b</a></span><span class="op" id="5983941">.</span><span class="ident" id="5983942">lines</span>&nbsp;<span class="op" id="5983948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983954"><a href="/go/doc/comment.go.html#5983731">l</a></span><span class="op" id="5983955">.</span><span class="ident" id="5983956">write</span><span class="op" id="5983961">(</span><span class="ident" id="5983962"><a href="/go/doc/comment.go.html#5983926">line</a></span><span class="op" id="5983966">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5983971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5983976"><a href="/go/doc/comment.go.html#5983731">l</a></span><span class="op" id="5983977">.</span><span class="ident" id="5983978">flush</span><span class="op" id="5983983">(</span><span class="op" id="5983984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5983988">case</span>&nbsp;<span class="ident" id="5983993"><a href="/go/doc/comment.go.html#5979853">opHead</a></span><span class="op" id="5983999">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984004"><a href="/go/doc/comment.go.html#5983665">w</a></span><span class="op" id="5984005">.</span><span class="ident" id="5984006">Write</span><span class="op" id="5984011">(</span><span class="ident" id="5984012"><a href="/go/doc/comment.go.html#5984432">nl</a></span><span class="op" id="5984014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984019">for</span>&nbsp;<span class="ident" id="5984023">_</span><span class="op" id="5984024">,</span>&nbsp;<span class="ident" id="5984026">line</span>&nbsp;<span class="op" id="5984031">:=</span>&nbsp;<span class="keyword" id="5984034">range</span>&nbsp;<span class="ident" id="5984040"><a href="/go/doc/comment.go.html#5983808">b</a></span><span class="op" id="5984041">.</span><span class="ident" id="5984042">lines</span>&nbsp;<span class="op" id="5984048">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984054"><a href="/go/doc/comment.go.html#5983731">l</a></span><span class="op" id="5984055">.</span><span class="ident" id="5984056">write</span><span class="op" id="5984061">(</span><span class="ident" id="5984062"><a href="/go/doc/comment.go.html#5984026">line</a></span>&nbsp;<span class="op" id="5984067">+</span>&nbsp;<span class="string" id="5984069">&#34;\n&#34;</span><span class="op" id="5984073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984083"><a href="/go/doc/comment.go.html#5983731">l</a></span><span class="op" id="5984084">.</span><span class="ident" id="5984085">flush</span><span class="op" id="5984090">(</span><span class="op" id="5984091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984095">case</span>&nbsp;<span class="ident" id="5984100"><a href="/go/doc/comment.go.html#5979861">opPre</a></span><span class="op" id="5984105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984110"><a href="/go/doc/comment.go.html#5983665">w</a></span><span class="op" id="5984111">.</span><span class="ident" id="5984112">Write</span><span class="op" id="5984117">(</span><span class="ident" id="5984118"><a href="/go/doc/comment.go.html#5984432">nl</a></span><span class="op" id="5984120">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984125">for</span>&nbsp;<span class="ident" id="5984129">_</span><span class="op" id="5984130">,</span>&nbsp;<span class="ident" id="5984132">line</span>&nbsp;<span class="op" id="5984137">:=</span>&nbsp;<span class="keyword" id="5984140">range</span>&nbsp;<span class="ident" id="5984146"><a href="/go/doc/comment.go.html#5983808">b</a></span><span class="op" id="5984147">.</span><span class="ident" id="5984148">lines</span>&nbsp;<span class="op" id="5984154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984160">if</span>&nbsp;<span class="ident" id="5984163"><a href="/go/doc/comment.go.html#5978313">isBlank</a></span><span class="op" id="5984170">(</span><span class="ident" id="5984171"><a href="/go/doc/comment.go.html#5984132">line</a></span><span class="op" id="5984175">)</span>&nbsp;<span class="op" id="5984177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984184"><a href="/go/doc/comment.go.html#5983665">w</a></span><span class="op" id="5984185">.</span><span class="ident" id="5984186">Write</span><span class="op" id="5984191">(</span><span class="op" id="5984192">[</span><span class="op" id="5984193">]</span><span class="builtintype" id="5984194">byte</span><span class="op" id="5984198">(</span><span class="string" id="5984199">&#34;\n&#34;</span><span class="op" id="5984203">)</span><span class="op" id="5984204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984210">}</span>&nbsp;<span class="keyword" id="5984212">else</span>&nbsp;<span class="op" id="5984217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984224"><a href="/go/doc/comment.go.html#5983665">w</a></span><span class="op" id="5984225">.</span><span class="ident" id="5984226">Write</span><span class="op" id="5984231">(</span><span class="op" id="5984232">[</span><span class="op" id="5984233">]</span><span class="builtintype" id="5984234">byte</span><span class="op" id="5984238">(</span><span class="ident" id="5984239"><a href="/go/doc/comment.go.html#5983699">preIndent</a></span><span class="op" id="5984248">)</span><span class="op" id="5984249">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984256"><a href="/go/doc/comment.go.html#5983665">w</a></span><span class="op" id="5984257">.</span><span class="ident" id="5984258">Write</span><span class="op" id="5984263">(</span><span class="op" id="5984264">[</span><span class="op" id="5984265">]</span><span class="builtintype" id="5984266">byte</span><span class="op" id="5984270">(</span><span class="ident" id="5984271"><a href="/go/doc/comment.go.html#5984132">line</a></span><span class="op" id="5984275">)</span><span class="op" id="5984276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984294">}</span><br>
<span class="lineno">435</span><span class="op" id="5984296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5984299">type</span>&nbsp;<span class="ident" id="5984304">lineWrapper</span>&nbsp;<span class="keyword" id="5984316">struct</span>&nbsp;<span class="op" id="5984323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984326">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5984336"><a href="/go/doc/comment.go.html#5974317">io</a></span><span class="op" id="5984338">.</span><span class="ident" id="5984339">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984347">printed</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5984357">bool</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984363">width</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5984373">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984378">indent</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5984388">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984396">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5984406">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984411">pendSpace</span>&nbsp;<span class="builtintype" id="5984421">int</span><br>
<span class="lineno"></span><span class="op" id="5984425">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="5984428">var</span>&nbsp;<span class="ident" id="5984432">nl</span>&nbsp;<span class="op" id="5984435">=</span>&nbsp;<span class="op" id="5984437">[</span><span class="op" id="5984438">]</span><span class="builtintype" id="5984439">byte</span><span class="op" id="5984443">(</span><span class="string" id="5984444">&#34;\n&#34;</span><span class="op" id="5984448">)</span><br>
<span class="lineno"></span><span class="keyword" id="5984450">var</span>&nbsp;<span class="ident" id="5984454">space</span>&nbsp;<span class="op" id="5984460">=</span>&nbsp;<span class="op" id="5984462">[</span><span class="op" id="5984463">]</span><span class="builtintype" id="5984464">byte</span><span class="op" id="5984468">(</span><span class="string" id="5984469">&#34;&nbsp;&#34;</span><span class="op" id="5984472">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5984475">func</span>&nbsp;<span class="op" id="5984480">(</span><span class="ident" id="5984481">l</span>&nbsp;<span class="op" id="5984483">*</span><span class="ident" id="5984484"><a href="/go/doc/comment.go.html#5984304">lineWrapper</a></span><span class="op" id="5984495">)</span>&nbsp;<span class="ident" id="5984497">write</span><span class="op" id="5984502">(</span><span class="ident" id="5984503">text</span>&nbsp;<span class="builtintype" id="5984508">string</span><span class="op" id="5984514">)</span>&nbsp;<span class="op" id="5984516">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984519">if</span>&nbsp;<span class="ident" id="5984522"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984523">.</span><span class="ident" id="5984524">n</span>&nbsp;<span class="op" id="5984526">==</span>&nbsp;<span class="num" id="5984529">0</span>&nbsp;<span class="op" id="5984531">&amp;&amp;</span>&nbsp;<span class="ident" id="5984534"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984535">.</span><span class="ident" id="5984536">printed</span>&nbsp;<span class="op" id="5984544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984548"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984549">.</span><span class="ident" id="5984550">out</span><span class="op" id="5984553">.</span><span class="ident" id="5984554">Write</span><span class="op" id="5984559">(</span><span class="ident" id="5984560"><a href="/go/doc/comment.go.html#5984432">nl</a></span><span class="op" id="5984562">)</span>&nbsp;<span class="comment" id="5984564">//&nbsp;blank&nbsp;line&nbsp;before&nbsp;new&nbsp;paragraph</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984603"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984604">.</span><span class="ident" id="5984605">printed</span>&nbsp;<span class="op" id="5984613">=</span>&nbsp;<span class="ident" id="5984615">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984622">for</span>&nbsp;<span class="ident" id="5984626">_</span><span class="op" id="5984627">,</span>&nbsp;<span class="ident" id="5984629">f</span>&nbsp;<span class="op" id="5984631">:=</span>&nbsp;<span class="keyword" id="5984634">range</span>&nbsp;<span class="ident" id="5984640"><a href="/go/doc/comment.go.html#5974333">strings</a></span><span class="op" id="5984647">.</span><span class="ident" id="5984648">Fields</span><span class="op" id="5984654">(</span><span class="ident" id="5984655"><a href="/go/doc/comment.go.html#5984503">text</a></span><span class="op" id="5984659">)</span>&nbsp;<span class="op" id="5984661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984665">w</span>&nbsp;<span class="op" id="5984667">:=</span>&nbsp;<span class="ident" id="5984670"><a href="/go/doc/comment.go.html#5974390">utf8</a></span><span class="op" id="5984674">.</span><span class="ident" id="5984675">RuneCountInString</span><span class="op" id="5984692">(</span><span class="ident" id="5984693"><a href="/go/doc/comment.go.html#5984629">f</a></span><span class="op" id="5984694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5984698">//&nbsp;wrap&nbsp;if&nbsp;line&nbsp;is&nbsp;too&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984728">if</span>&nbsp;<span class="ident" id="5984731"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984732">.</span><span class="ident" id="5984733">n</span>&nbsp;<span class="op" id="5984735">&gt;</span>&nbsp;<span class="num" id="5984737">0</span>&nbsp;<span class="op" id="5984739">&amp;&amp;</span>&nbsp;<span class="ident" id="5984742"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984743">.</span><span class="ident" id="5984744">n</span><span class="op" id="5984745">+</span><span class="ident" id="5984746"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984747">.</span><span class="ident" id="5984748">pendSpace</span><span class="op" id="5984757">+</span><span class="ident" id="5984758"><a href="/go/doc/comment.go.html#5984665">w</a></span>&nbsp;<span class="op" id="5984760">&gt;</span>&nbsp;<span class="ident" id="5984762"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984763">.</span><span class="ident" id="5984764">width</span>&nbsp;<span class="op" id="5984770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984775"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984776">.</span><span class="ident" id="5984777">out</span><span class="op" id="5984780">.</span><span class="ident" id="5984781">Write</span><span class="op" id="5984786">(</span><span class="ident" id="5984787"><a href="/go/doc/comment.go.html#5984432">nl</a></span><span class="op" id="5984789">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984794"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984795">.</span><span class="ident" id="5984796">n</span>&nbsp;<span class="op" id="5984798">=</span>&nbsp;<span class="num" id="5984800">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984805"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984806">.</span><span class="ident" id="5984807">pendSpace</span>&nbsp;<span class="op" id="5984817">=</span>&nbsp;<span class="num" id="5984819">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5984827">if</span>&nbsp;<span class="ident" id="5984830"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984831">.</span><span class="ident" id="5984832">n</span>&nbsp;<span class="op" id="5984834">==</span>&nbsp;<span class="num" id="5984837">0</span>&nbsp;<span class="op" id="5984839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984844"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984845">.</span><span class="ident" id="5984846">out</span><span class="op" id="5984849">.</span><span class="ident" id="5984850">Write</span><span class="op" id="5984855">(</span><span class="op" id="5984856">[</span><span class="op" id="5984857">]</span><span class="builtintype" id="5984858">byte</span><span class="op" id="5984862">(</span><span class="ident" id="5984863"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984864">.</span><span class="ident" id="5984865">indent</span><span class="op" id="5984871">)</span><span class="op" id="5984872">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984880"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984881">.</span><span class="ident" id="5984882">out</span><span class="op" id="5984885">.</span><span class="ident" id="5984886">Write</span><span class="op" id="5984891">(</span><span class="ident" id="5984892"><a href="/go/doc/comment.go.html#5984454">space</a></span><span class="op" id="5984897">[</span><span class="op" id="5984898">:</span><span class="ident" id="5984899"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984900">.</span><span class="ident" id="5984901">pendSpace</span><span class="op" id="5984910">]</span><span class="op" id="5984911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984915"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984916">.</span><span class="ident" id="5984917">out</span><span class="op" id="5984920">.</span><span class="ident" id="5984921">Write</span><span class="op" id="5984926">(</span><span class="op" id="5984927">[</span><span class="op" id="5984928">]</span><span class="builtintype" id="5984929">byte</span><span class="op" id="5984933">(</span><span class="ident" id="5984934"><a href="/go/doc/comment.go.html#5984629">f</a></span><span class="op" id="5984935">)</span><span class="op" id="5984936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984940"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984941">.</span><span class="ident" id="5984942">n</span>&nbsp;<span class="op" id="5984944">+=</span>&nbsp;<span class="ident" id="5984947"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984948">.</span><span class="ident" id="5984949">pendSpace</span>&nbsp;<span class="op" id="5984959">+</span>&nbsp;<span class="ident" id="5984961"><a href="/go/doc/comment.go.html#5984665">w</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5984965"><a href="/go/doc/comment.go.html#5984481">l</a></span><span class="op" id="5984966">.</span><span class="ident" id="5984967">pendSpace</span>&nbsp;<span class="op" id="5984977">=</span>&nbsp;<span class="num" id="5984979">1</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5984982">}</span><br>
<span class="lineno"></span><span class="op" id="5984984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5984987">func</span>&nbsp;<span class="op" id="5984992">(</span><span class="ident" id="5984993">l</span>&nbsp;<span class="op" id="5984995">*</span><span class="ident" id="5984996"><a href="/go/doc/comment.go.html#5984304">lineWrapper</a></span><span class="op" id="5985007">)</span>&nbsp;<span class="ident" id="5985009">flush</span><span class="op" id="5985014">(</span><span class="op" id="5985015">)</span>&nbsp;<span class="op" id="5985017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985020">if</span>&nbsp;<span class="ident" id="5985023"><a href="/go/doc/comment.go.html#5984993">l</a></span><span class="op" id="5985024">.</span><span class="ident" id="5985025">n</span>&nbsp;<span class="op" id="5985027">==</span>&nbsp;<span class="num" id="5985030">0</span>&nbsp;<span class="op" id="5985032">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5985036">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5985044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985047"><a href="/go/doc/comment.go.html#5984993">l</a></span><span class="op" id="5985048">.</span><span class="ident" id="5985049">out</span><span class="op" id="5985052">.</span><span class="ident" id="5985053">Write</span><span class="op" id="5985058">(</span><span class="ident" id="5985059"><a href="/go/doc/comment.go.html#5984432">nl</a></span><span class="op" id="5985061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985064"><a href="/go/doc/comment.go.html#5984993">l</a></span><span class="op" id="5985065">.</span><span class="ident" id="5985066">pendSpace</span>&nbsp;<span class="op" id="5985076">=</span>&nbsp;<span class="num" id="5985078">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5985081"><a href="/go/doc/comment.go.html#5984993">l</a></span><span class="op" id="5985082">.</span><span class="ident" id="5985083">n</span>&nbsp;<span class="op" id="5985085">=</span>&nbsp;<span class="num" id="5985087">0</span><br>
<span class="lineno">480</span><span class="op" id="5985089">}</span>
</div>
</body>
</html>
