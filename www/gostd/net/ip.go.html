<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html" class="current">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3761626">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3761681">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3761735">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3761786">//&nbsp;IP&nbsp;address&nbsp;manipulations</span><br>
<span class="lineno"></span><span class="comment" id="3761814">//</span><br>
<span class="lineno"></span><span class="comment" id="3761817">//&nbsp;IPv4&nbsp;addresses&nbsp;are&nbsp;4&nbsp;bytes;&nbsp;IPv6&nbsp;addresses&nbsp;are&nbsp;16&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3761877">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;can&nbsp;be&nbsp;converted&nbsp;to&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3761935">//&nbsp;adding&nbsp;a&nbsp;canonical&nbsp;prefix&nbsp;(10&nbsp;zeros,&nbsp;2&nbsp;0xFFs).</span><br>
<span class="lineno">10</span><span class="comment" id="3761985">//&nbsp;This&nbsp;library&nbsp;accepts&nbsp;either&nbsp;size&nbsp;of&nbsp;byte&nbsp;slice&nbsp;but&nbsp;always</span><br>
<span class="lineno"></span><span class="comment" id="3762046">//&nbsp;returns&nbsp;16-byte&nbsp;addresses.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3762077">package</span>&nbsp;<span class="ident" id="3762085">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3762090">import</span>&nbsp;<span class="string" id="3762097">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3762107">//&nbsp;IP&nbsp;address&nbsp;lengths&nbsp;(bytes).</span><br>
<span class="lineno"></span><span class="keyword" id="3762138">const</span>&nbsp;<span class="op" id="3762144">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3762147">IPv4len</span>&nbsp;<span class="op" id="3762155">=</span>&nbsp;<span class="num" id="3762157">4</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3762160">IPv6len</span>&nbsp;<span class="op" id="3762168">=</span>&nbsp;<span class="num" id="3762170">16</span><br>
<span class="lineno"></span><span class="op" id="3762173">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3762176">//&nbsp;An&nbsp;IP&nbsp;is&nbsp;a&nbsp;single&nbsp;IP&nbsp;address,&nbsp;a&nbsp;slice&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3762227">//&nbsp;Functions&nbsp;in&nbsp;this&nbsp;package&nbsp;accept&nbsp;either&nbsp;4-byte&nbsp;(IPv4)</span><br>
<span class="lineno">25</span><span class="comment" id="3762284">//&nbsp;or&nbsp;16-byte&nbsp;(IPv6)&nbsp;slices&nbsp;as&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3762322">//</span><br>
<span class="lineno"></span><span class="comment" id="3762325">//&nbsp;Note&nbsp;that&nbsp;in&nbsp;this&nbsp;documentation,&nbsp;referring&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3762377">//&nbsp;IP&nbsp;address&nbsp;as&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;or&nbsp;an&nbsp;IPv6&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="3762429">//&nbsp;is&nbsp;a&nbsp;semantic&nbsp;property&nbsp;of&nbsp;the&nbsp;address,&nbsp;not&nbsp;just&nbsp;the</span><br>
<span class="lineno">30</span><span class="comment" id="3762484">//&nbsp;length&nbsp;of&nbsp;the&nbsp;byte&nbsp;slice:&nbsp;a&nbsp;16-byte&nbsp;slice&nbsp;can&nbsp;still</span><br>
<span class="lineno"></span><span class="comment" id="3762539">//&nbsp;be&nbsp;an&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3762562">type</span>&nbsp;<span class="ident" id="3762567">IP</span>&nbsp;<span class="op" id="3762570">[</span><span class="op" id="3762571">]</span><span class="builtintype" id="3762572">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3762578">//&nbsp;An&nbsp;IP&nbsp;mask&nbsp;is&nbsp;an&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">35</span><span class="keyword" id="3762610">type</span>&nbsp;<span class="ident" id="3762615">IPMask</span>&nbsp;<span class="op" id="3762622">[</span><span class="op" id="3762623">]</span><span class="builtintype" id="3762624">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3762630">//&nbsp;An&nbsp;IPNet&nbsp;represents&nbsp;an&nbsp;IP&nbsp;network.</span><br>
<span class="lineno"></span><span class="keyword" id="3762668">type</span>&nbsp;<span class="ident" id="3762673">IPNet</span>&nbsp;<span class="keyword" id="3762679">struct</span>&nbsp;<span class="op" id="3762686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3762689">IP</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3762694">IP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3762701">//&nbsp;network&nbsp;number</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3762720">Mask</span>&nbsp;<span class="ident" id="3762725">IPMask</span>&nbsp;<span class="comment" id="3762732">//&nbsp;network&nbsp;mask</span><br>
<span class="lineno"></span><span class="op" id="3762748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3762751">//&nbsp;IPv4&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;(in&nbsp;16-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3762807">//&nbsp;IPv4&nbsp;address&nbsp;a.b.c.d.</span><br>
<span class="lineno">45</span><span class="keyword" id="3762832">func</span>&nbsp;<span class="ident" id="3762837">IPv4</span><span class="op" id="3762841">(</span><span class="ident" id="3762842">a</span><span class="op" id="3762843">,</span>&nbsp;<span class="ident" id="3762845">b</span><span class="op" id="3762846">,</span>&nbsp;<span class="ident" id="3762848">c</span><span class="op" id="3762849">,</span>&nbsp;<span class="ident" id="3762851">d</span>&nbsp;<span class="builtintype" id="3762853">byte</span><span class="op" id="3762857">)</span>&nbsp;<span class="ident" id="3762859">IP</span>&nbsp;<span class="op" id="3762862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3762865">p</span>&nbsp;<span class="op" id="3762867">:=</span>&nbsp;<span class="builtinfunc" id="3762870">make</span><span class="op" id="3762874">(</span><span class="ident" id="3762875">IP</span><span class="op" id="3762877">,</span>&nbsp;<span class="ident" id="3762879">IPv6len</span><span class="op" id="3762886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3762889">copy</span><span class="op" id="3762893">(</span><span class="ident" id="3762894">p</span><span class="op" id="3762895">,</span>&nbsp;<span class="ident" id="3762897">v4InV6Prefix</span><span class="op" id="3762909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3762912">p</span><span class="op" id="3762913">[</span><span class="num" id="3762914">12</span><span class="op" id="3762916">]</span>&nbsp;<span class="op" id="3762918">=</span>&nbsp;<span class="ident" id="3762920">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3762923">p</span><span class="op" id="3762924">[</span><span class="num" id="3762925">13</span><span class="op" id="3762927">]</span>&nbsp;<span class="op" id="3762929">=</span>&nbsp;<span class="ident" id="3762931">b</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3762934">p</span><span class="op" id="3762935">[</span><span class="num" id="3762936">14</span><span class="op" id="3762938">]</span>&nbsp;<span class="op" id="3762940">=</span>&nbsp;<span class="ident" id="3762942">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3762945">p</span><span class="op" id="3762946">[</span><span class="num" id="3762947">15</span><span class="op" id="3762949">]</span>&nbsp;<span class="op" id="3762951">=</span>&nbsp;<span class="ident" id="3762953">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3762956">return</span>&nbsp;<span class="ident" id="3762963">p</span><br>
<span class="lineno"></span><span class="op" id="3762965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3762968">var</span>&nbsp;<span class="ident" id="3762972">v4InV6Prefix</span>&nbsp;<span class="op" id="3762985">=</span>&nbsp;<span class="op" id="3762987">[</span><span class="op" id="3762988">]</span><span class="builtintype" id="3762989">byte</span><span class="op" id="3762993">{</span><span class="num" id="3762994">0</span><span class="op" id="3762995">,</span>&nbsp;<span class="num" id="3762997">0</span><span class="op" id="3762998">,</span>&nbsp;<span class="num" id="3763000">0</span><span class="op" id="3763001">,</span>&nbsp;<span class="num" id="3763003">0</span><span class="op" id="3763004">,</span>&nbsp;<span class="num" id="3763006">0</span><span class="op" id="3763007">,</span>&nbsp;<span class="num" id="3763009">0</span><span class="op" id="3763010">,</span>&nbsp;<span class="num" id="3763012">0</span><span class="op" id="3763013">,</span>&nbsp;<span class="num" id="3763015">0</span><span class="op" id="3763016">,</span>&nbsp;<span class="num" id="3763018">0</span><span class="op" id="3763019">,</span>&nbsp;<span class="num" id="3763021">0</span><span class="op" id="3763022">,</span>&nbsp;<span class="num" id="3763024">0xff</span><span class="op" id="3763028">,</span>&nbsp;<span class="num" id="3763030">0xff</span><span class="op" id="3763034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3763037">//&nbsp;IPv4Mask&nbsp;returns&nbsp;the&nbsp;IP&nbsp;mask&nbsp;(in&nbsp;4-byte&nbsp;form)&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3763093">//&nbsp;IPv4&nbsp;mask&nbsp;a.b.c.d.</span><br>
<span class="lineno"></span><span class="keyword" id="3763115">func</span>&nbsp;<span class="ident" id="3763120">IPv4Mask</span><span class="op" id="3763128">(</span><span class="ident" id="3763129">a</span><span class="op" id="3763130">,</span>&nbsp;<span class="ident" id="3763132">b</span><span class="op" id="3763133">,</span>&nbsp;<span class="ident" id="3763135">c</span><span class="op" id="3763136">,</span>&nbsp;<span class="ident" id="3763138">d</span>&nbsp;<span class="builtintype" id="3763140">byte</span><span class="op" id="3763144">)</span>&nbsp;<span class="ident" id="3763146">IPMask</span>&nbsp;<span class="op" id="3763153">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763156">p</span>&nbsp;<span class="op" id="3763158">:=</span>&nbsp;<span class="builtinfunc" id="3763161">make</span><span class="op" id="3763165">(</span><span class="ident" id="3763166">IPMask</span><span class="op" id="3763172">,</span>&nbsp;<span class="ident" id="3763174">IPv4len</span><span class="op" id="3763181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763184">p</span><span class="op" id="3763185">[</span><span class="num" id="3763186">0</span><span class="op" id="3763187">]</span>&nbsp;<span class="op" id="3763189">=</span>&nbsp;<span class="ident" id="3763191">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763194">p</span><span class="op" id="3763195">[</span><span class="num" id="3763196">1</span><span class="op" id="3763197">]</span>&nbsp;<span class="op" id="3763199">=</span>&nbsp;<span class="ident" id="3763201">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763204">p</span><span class="op" id="3763205">[</span><span class="num" id="3763206">2</span><span class="op" id="3763207">]</span>&nbsp;<span class="op" id="3763209">=</span>&nbsp;<span class="ident" id="3763211">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763214">p</span><span class="op" id="3763215">[</span><span class="num" id="3763216">3</span><span class="op" id="3763217">]</span>&nbsp;<span class="op" id="3763219">=</span>&nbsp;<span class="ident" id="3763221">d</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3763224">return</span>&nbsp;<span class="ident" id="3763231">p</span><br>
<span class="lineno"></span><span class="op" id="3763233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3763236">//&nbsp;CIDRMask&nbsp;returns&nbsp;an&nbsp;IPMask&nbsp;consisting&nbsp;of&nbsp;`ones&#39;&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span><span class="comment" id="3763294">//&nbsp;followed&nbsp;by&nbsp;0s&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;length&nbsp;of&nbsp;`bits&#39;&nbsp;bits.</span><br>
<span class="lineno">70</span><span class="comment" id="3763349">//&nbsp;For&nbsp;a&nbsp;mask&nbsp;of&nbsp;this&nbsp;form,&nbsp;CIDRMask&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;IPMask.Size.</span><br>
<span class="lineno"></span><span class="keyword" id="3763417">func</span>&nbsp;<span class="ident" id="3763422">CIDRMask</span><span class="op" id="3763430">(</span><span class="ident" id="3763431">ones</span><span class="op" id="3763435">,</span>&nbsp;<span class="ident" id="3763437">bits</span>&nbsp;<span class="builtintype" id="3763442">int</span><span class="op" id="3763445">)</span>&nbsp;<span class="ident" id="3763447">IPMask</span>&nbsp;<span class="op" id="3763454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3763457">if</span>&nbsp;<span class="ident" id="3763460">bits</span>&nbsp;<span class="op" id="3763465">!=</span>&nbsp;<span class="num" id="3763468">8</span><span class="op" id="3763469">*</span><span class="ident" id="3763470">IPv4len</span>&nbsp;<span class="op" id="3763478">&amp;&amp;</span>&nbsp;<span class="ident" id="3763481">bits</span>&nbsp;<span class="op" id="3763486">!=</span>&nbsp;<span class="num" id="3763489">8</span><span class="op" id="3763490">*</span><span class="ident" id="3763491">IPv6len</span>&nbsp;<span class="op" id="3763499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3763503">return</span>&nbsp;<span class="builtintype" id="3763510">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3763515">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3763518">if</span>&nbsp;<span class="ident" id="3763521">ones</span>&nbsp;<span class="op" id="3763526">&lt;</span>&nbsp;<span class="num" id="3763528">0</span>&nbsp;<span class="op" id="3763530">||</span>&nbsp;<span class="ident" id="3763533">ones</span>&nbsp;<span class="op" id="3763538">&gt;</span>&nbsp;<span class="ident" id="3763540">bits</span>&nbsp;<span class="op" id="3763545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3763549">return</span>&nbsp;<span class="builtintype" id="3763556">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3763561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763564">l</span>&nbsp;<span class="op" id="3763566">:=</span>&nbsp;<span class="ident" id="3763569">bits</span>&nbsp;<span class="op" id="3763574">/</span>&nbsp;<span class="num" id="3763576">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763579">m</span>&nbsp;<span class="op" id="3763581">:=</span>&nbsp;<span class="builtinfunc" id="3763584">make</span><span class="op" id="3763588">(</span><span class="ident" id="3763589">IPMask</span><span class="op" id="3763595">,</span>&nbsp;<span class="ident" id="3763597">l</span><span class="op" id="3763598">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763601">n</span>&nbsp;<span class="op" id="3763603">:=</span>&nbsp;<span class="builtintype" id="3763606">uint</span><span class="op" id="3763610">(</span><span class="ident" id="3763611">ones</span><span class="op" id="3763615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3763618">for</span>&nbsp;<span class="ident" id="3763622">i</span>&nbsp;<span class="op" id="3763624">:=</span>&nbsp;<span class="num" id="3763627">0</span><span class="op" id="3763628">;</span>&nbsp;<span class="ident" id="3763630">i</span>&nbsp;<span class="op" id="3763632">&lt;</span>&nbsp;<span class="ident" id="3763634">l</span><span class="op" id="3763635">;</span>&nbsp;<span class="ident" id="3763637">i</span><span class="op" id="3763638">++</span>&nbsp;<span class="op" id="3763641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3763645">if</span>&nbsp;<span class="ident" id="3763648">n</span>&nbsp;<span class="op" id="3763650">&gt;=</span>&nbsp;<span class="num" id="3763653">8</span>&nbsp;<span class="op" id="3763655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763660">m</span><span class="op" id="3763661">[</span><span class="ident" id="3763662">i</span><span class="op" id="3763663">]</span>&nbsp;<span class="op" id="3763665">=</span>&nbsp;<span class="num" id="3763667">0xff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763675">n</span>&nbsp;<span class="op" id="3763677">-=</span>&nbsp;<span class="num" id="3763680">8</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3763685">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3763696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763700">m</span><span class="op" id="3763701">[</span><span class="ident" id="3763702">i</span><span class="op" id="3763703">]</span>&nbsp;<span class="op" id="3763705">=</span>&nbsp;<span class="op" id="3763707">^</span><span class="builtintype" id="3763708">byte</span><span class="op" id="3763712">(</span><span class="num" id="3763713">0xff</span>&nbsp;<span class="op" id="3763718">&gt;&gt;</span>&nbsp;<span class="ident" id="3763721">n</span><span class="op" id="3763722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763726">n</span>&nbsp;<span class="op" id="3763728">=</span>&nbsp;<span class="num" id="3763730">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3763733">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3763736">return</span>&nbsp;<span class="ident" id="3763743">m</span><br>
<span class="lineno"></span><span class="op" id="3763745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3763748">//&nbsp;Well-known&nbsp;IPv4&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3763777">var</span>&nbsp;<span class="op" id="3763781">(</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763784">IPv4bcast</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3763798">=</span>&nbsp;<span class="ident" id="3763800">IPv4</span><span class="op" id="3763804">(</span><span class="num" id="3763805">255</span><span class="op" id="3763808">,</span>&nbsp;<span class="num" id="3763810">255</span><span class="op" id="3763813">,</span>&nbsp;<span class="num" id="3763815">255</span><span class="op" id="3763818">,</span>&nbsp;<span class="num" id="3763820">255</span><span class="op" id="3763823">)</span>&nbsp;<span class="comment" id="3763825">//&nbsp;broadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763839">IPv4allsys</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3763853">=</span>&nbsp;<span class="ident" id="3763855">IPv4</span><span class="op" id="3763859">(</span><span class="num" id="3763860">224</span><span class="op" id="3763863">,</span>&nbsp;<span class="num" id="3763865">0</span><span class="op" id="3763866">,</span>&nbsp;<span class="num" id="3763868">0</span><span class="op" id="3763869">,</span>&nbsp;<span class="num" id="3763871">1</span><span class="op" id="3763872">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3763880">//&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763896">IPv4allrouter</span>&nbsp;<span class="op" id="3763910">=</span>&nbsp;<span class="ident" id="3763912">IPv4</span><span class="op" id="3763916">(</span><span class="num" id="3763917">224</span><span class="op" id="3763920">,</span>&nbsp;<span class="num" id="3763922">0</span><span class="op" id="3763923">,</span>&nbsp;<span class="num" id="3763925">0</span><span class="op" id="3763926">,</span>&nbsp;<span class="num" id="3763928">2</span><span class="op" id="3763929">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3763937">//&nbsp;all&nbsp;routers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3763953">IPv4zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3763967">=</span>&nbsp;<span class="ident" id="3763969">IPv4</span><span class="op" id="3763973">(</span><span class="num" id="3763974">0</span><span class="op" id="3763975">,</span>&nbsp;<span class="num" id="3763977">0</span><span class="op" id="3763978">,</span>&nbsp;<span class="num" id="3763980">0</span><span class="op" id="3763981">,</span>&nbsp;<span class="num" id="3763983">0</span><span class="op" id="3763984">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3763994">//&nbsp;all&nbsp;zeros</span><br>
<span class="lineno"></span><span class="op" id="3764007">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3764010">//&nbsp;Well-known&nbsp;IPv6&nbsp;addresses</span><br>
<span class="lineno"></span><span class="keyword" id="3764039">var</span>&nbsp;<span class="op" id="3764043">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3764046">IPv6zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3764073">=</span>&nbsp;<span class="ident" id="3764075">IP</span><span class="op" id="3764077">{</span><span class="num" id="3764078">0</span><span class="op" id="3764079">,</span>&nbsp;<span class="num" id="3764081">0</span><span class="op" id="3764082">,</span>&nbsp;<span class="num" id="3764084">0</span><span class="op" id="3764085">,</span>&nbsp;<span class="num" id="3764087">0</span><span class="op" id="3764088">,</span>&nbsp;<span class="num" id="3764090">0</span><span class="op" id="3764091">,</span>&nbsp;<span class="num" id="3764093">0</span><span class="op" id="3764094">,</span>&nbsp;<span class="num" id="3764096">0</span><span class="op" id="3764097">,</span>&nbsp;<span class="num" id="3764099">0</span><span class="op" id="3764100">,</span>&nbsp;<span class="num" id="3764102">0</span><span class="op" id="3764103">,</span>&nbsp;<span class="num" id="3764105">0</span><span class="op" id="3764106">,</span>&nbsp;<span class="num" id="3764108">0</span><span class="op" id="3764109">,</span>&nbsp;<span class="num" id="3764111">0</span><span class="op" id="3764112">,</span>&nbsp;<span class="num" id="3764114">0</span><span class="op" id="3764115">,</span>&nbsp;<span class="num" id="3764117">0</span><span class="op" id="3764118">,</span>&nbsp;<span class="num" id="3764120">0</span><span class="op" id="3764121">,</span>&nbsp;<span class="num" id="3764123">0</span><span class="op" id="3764124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3764127">IPv6unspecified</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3764154">=</span>&nbsp;<span class="ident" id="3764156">IP</span><span class="op" id="3764158">{</span><span class="num" id="3764159">0</span><span class="op" id="3764160">,</span>&nbsp;<span class="num" id="3764162">0</span><span class="op" id="3764163">,</span>&nbsp;<span class="num" id="3764165">0</span><span class="op" id="3764166">,</span>&nbsp;<span class="num" id="3764168">0</span><span class="op" id="3764169">,</span>&nbsp;<span class="num" id="3764171">0</span><span class="op" id="3764172">,</span>&nbsp;<span class="num" id="3764174">0</span><span class="op" id="3764175">,</span>&nbsp;<span class="num" id="3764177">0</span><span class="op" id="3764178">,</span>&nbsp;<span class="num" id="3764180">0</span><span class="op" id="3764181">,</span>&nbsp;<span class="num" id="3764183">0</span><span class="op" id="3764184">,</span>&nbsp;<span class="num" id="3764186">0</span><span class="op" id="3764187">,</span>&nbsp;<span class="num" id="3764189">0</span><span class="op" id="3764190">,</span>&nbsp;<span class="num" id="3764192">0</span><span class="op" id="3764193">,</span>&nbsp;<span class="num" id="3764195">0</span><span class="op" id="3764196">,</span>&nbsp;<span class="num" id="3764198">0</span><span class="op" id="3764199">,</span>&nbsp;<span class="num" id="3764201">0</span><span class="op" id="3764202">,</span>&nbsp;<span class="num" id="3764204">0</span><span class="op" id="3764205">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3764208">IPv6loopback</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3764235">=</span>&nbsp;<span class="ident" id="3764237">IP</span><span class="op" id="3764239">{</span><span class="num" id="3764240">0</span><span class="op" id="3764241">,</span>&nbsp;<span class="num" id="3764243">0</span><span class="op" id="3764244">,</span>&nbsp;<span class="num" id="3764246">0</span><span class="op" id="3764247">,</span>&nbsp;<span class="num" id="3764249">0</span><span class="op" id="3764250">,</span>&nbsp;<span class="num" id="3764252">0</span><span class="op" id="3764253">,</span>&nbsp;<span class="num" id="3764255">0</span><span class="op" id="3764256">,</span>&nbsp;<span class="num" id="3764258">0</span><span class="op" id="3764259">,</span>&nbsp;<span class="num" id="3764261">0</span><span class="op" id="3764262">,</span>&nbsp;<span class="num" id="3764264">0</span><span class="op" id="3764265">,</span>&nbsp;<span class="num" id="3764267">0</span><span class="op" id="3764268">,</span>&nbsp;<span class="num" id="3764270">0</span><span class="op" id="3764271">,</span>&nbsp;<span class="num" id="3764273">0</span><span class="op" id="3764274">,</span>&nbsp;<span class="num" id="3764276">0</span><span class="op" id="3764277">,</span>&nbsp;<span class="num" id="3764279">0</span><span class="op" id="3764280">,</span>&nbsp;<span class="num" id="3764282">0</span><span class="op" id="3764283">,</span>&nbsp;<span class="num" id="3764285">1</span><span class="op" id="3764286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3764289">IPv6interfacelocalallnodes</span>&nbsp;<span class="op" id="3764316">=</span>&nbsp;<span class="ident" id="3764318">IP</span><span class="op" id="3764320">{</span><span class="num" id="3764321">0xff</span><span class="op" id="3764325">,</span>&nbsp;<span class="num" id="3764327">0x01</span><span class="op" id="3764331">,</span>&nbsp;<span class="num" id="3764333">0</span><span class="op" id="3764334">,</span>&nbsp;<span class="num" id="3764336">0</span><span class="op" id="3764337">,</span>&nbsp;<span class="num" id="3764339">0</span><span class="op" id="3764340">,</span>&nbsp;<span class="num" id="3764342">0</span><span class="op" id="3764343">,</span>&nbsp;<span class="num" id="3764345">0</span><span class="op" id="3764346">,</span>&nbsp;<span class="num" id="3764348">0</span><span class="op" id="3764349">,</span>&nbsp;<span class="num" id="3764351">0</span><span class="op" id="3764352">,</span>&nbsp;<span class="num" id="3764354">0</span><span class="op" id="3764355">,</span>&nbsp;<span class="num" id="3764357">0</span><span class="op" id="3764358">,</span>&nbsp;<span class="num" id="3764360">0</span><span class="op" id="3764361">,</span>&nbsp;<span class="num" id="3764363">0</span><span class="op" id="3764364">,</span>&nbsp;<span class="num" id="3764366">0</span><span class="op" id="3764367">,</span>&nbsp;<span class="num" id="3764369">0</span><span class="op" id="3764370">,</span>&nbsp;<span class="num" id="3764372">0x01</span><span class="op" id="3764376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3764379">IPv6linklocalallnodes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3764406">=</span>&nbsp;<span class="ident" id="3764408">IP</span><span class="op" id="3764410">{</span><span class="num" id="3764411">0xff</span><span class="op" id="3764415">,</span>&nbsp;<span class="num" id="3764417">0x02</span><span class="op" id="3764421">,</span>&nbsp;<span class="num" id="3764423">0</span><span class="op" id="3764424">,</span>&nbsp;<span class="num" id="3764426">0</span><span class="op" id="3764427">,</span>&nbsp;<span class="num" id="3764429">0</span><span class="op" id="3764430">,</span>&nbsp;<span class="num" id="3764432">0</span><span class="op" id="3764433">,</span>&nbsp;<span class="num" id="3764435">0</span><span class="op" id="3764436">,</span>&nbsp;<span class="num" id="3764438">0</span><span class="op" id="3764439">,</span>&nbsp;<span class="num" id="3764441">0</span><span class="op" id="3764442">,</span>&nbsp;<span class="num" id="3764444">0</span><span class="op" id="3764445">,</span>&nbsp;<span class="num" id="3764447">0</span><span class="op" id="3764448">,</span>&nbsp;<span class="num" id="3764450">0</span><span class="op" id="3764451">,</span>&nbsp;<span class="num" id="3764453">0</span><span class="op" id="3764454">,</span>&nbsp;<span class="num" id="3764456">0</span><span class="op" id="3764457">,</span>&nbsp;<span class="num" id="3764459">0</span><span class="op" id="3764460">,</span>&nbsp;<span class="num" id="3764462">0x01</span><span class="op" id="3764466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3764469">IPv6linklocalallrouters</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3764496">=</span>&nbsp;<span class="ident" id="3764498">IP</span><span class="op" id="3764500">{</span><span class="num" id="3764501">0xff</span><span class="op" id="3764505">,</span>&nbsp;<span class="num" id="3764507">0x02</span><span class="op" id="3764511">,</span>&nbsp;<span class="num" id="3764513">0</span><span class="op" id="3764514">,</span>&nbsp;<span class="num" id="3764516">0</span><span class="op" id="3764517">,</span>&nbsp;<span class="num" id="3764519">0</span><span class="op" id="3764520">,</span>&nbsp;<span class="num" id="3764522">0</span><span class="op" id="3764523">,</span>&nbsp;<span class="num" id="3764525">0</span><span class="op" id="3764526">,</span>&nbsp;<span class="num" id="3764528">0</span><span class="op" id="3764529">,</span>&nbsp;<span class="num" id="3764531">0</span><span class="op" id="3764532">,</span>&nbsp;<span class="num" id="3764534">0</span><span class="op" id="3764535">,</span>&nbsp;<span class="num" id="3764537">0</span><span class="op" id="3764538">,</span>&nbsp;<span class="num" id="3764540">0</span><span class="op" id="3764541">,</span>&nbsp;<span class="num" id="3764543">0</span><span class="op" id="3764544">,</span>&nbsp;<span class="num" id="3764546">0</span><span class="op" id="3764547">,</span>&nbsp;<span class="num" id="3764549">0</span><span class="op" id="3764550">,</span>&nbsp;<span class="num" id="3764552">0x02</span><span class="op" id="3764556">}</span><br>
<span class="lineno"></span><span class="op" id="3764558">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="3764561">//&nbsp;IsUnspecified&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;an&nbsp;unspecified&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3764624">func</span>&nbsp;<span class="op" id="3764629">(</span><span class="ident" id="3764630">ip</span>&nbsp;<span class="ident" id="3764633">IP</span><span class="op" id="3764635">)</span>&nbsp;<span class="ident" id="3764637">IsUnspecified</span><span class="op" id="3764650">(</span><span class="op" id="3764651">)</span>&nbsp;<span class="builtintype" id="3764653">bool</span>&nbsp;<span class="op" id="3764658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3764661">if</span>&nbsp;<span class="ident" id="3764664">ip</span><span class="op" id="3764666">.</span><span class="ident" id="3764667">Equal</span><span class="op" id="3764672">(</span><span class="ident" id="3764673">IPv4zero</span><span class="op" id="3764681">)</span>&nbsp;<span class="op" id="3764683">||</span>&nbsp;<span class="ident" id="3764686">ip</span><span class="op" id="3764688">.</span><span class="ident" id="3764689">Equal</span><span class="op" id="3764694">(</span><span class="ident" id="3764695">IPv6unspecified</span><span class="op" id="3764710">)</span>&nbsp;<span class="op" id="3764712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3764716">return</span>&nbsp;<span class="builtintype" id="3764723">true</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3764729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3764732">return</span>&nbsp;<span class="builtintype" id="3764739">false</span><br>
<span class="lineno"></span><span class="op" id="3764745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3764748">//&nbsp;IsLoopback&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;loopback&nbsp;address.</span><br>
<span class="lineno">120</span><span class="keyword" id="3764804">func</span>&nbsp;<span class="op" id="3764809">(</span><span class="ident" id="3764810">ip</span>&nbsp;<span class="ident" id="3764813">IP</span><span class="op" id="3764815">)</span>&nbsp;<span class="ident" id="3764817">IsLoopback</span><span class="op" id="3764827">(</span><span class="op" id="3764828">)</span>&nbsp;<span class="builtintype" id="3764830">bool</span>&nbsp;<span class="op" id="3764835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3764838">if</span>&nbsp;<span class="ident" id="3764841">ip4</span>&nbsp;<span class="op" id="3764845">:=</span>&nbsp;<span class="ident" id="3764848">ip</span><span class="op" id="3764850">.</span><span class="ident" id="3764851">To4</span><span class="op" id="3764854">(</span><span class="op" id="3764855">)</span><span class="op" id="3764856">;</span>&nbsp;<span class="ident" id="3764858">ip4</span>&nbsp;<span class="op" id="3764862">!=</span>&nbsp;<span class="builtintype" id="3764865">nil</span>&nbsp;<span class="op" id="3764869">&amp;&amp;</span>&nbsp;<span class="ident" id="3764872">ip4</span><span class="op" id="3764875">[</span><span class="num" id="3764876">0</span><span class="op" id="3764877">]</span>&nbsp;<span class="op" id="3764879">==</span>&nbsp;<span class="num" id="3764882">127</span>&nbsp;<span class="op" id="3764886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3764890">return</span>&nbsp;<span class="builtintype" id="3764897">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3764903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3764906">return</span>&nbsp;<span class="ident" id="3764913">ip</span><span class="op" id="3764915">.</span><span class="ident" id="3764916">Equal</span><span class="op" id="3764921">(</span><span class="ident" id="3764922">IPv6loopback</span><span class="op" id="3764934">)</span><br>
<span class="lineno">125</span><span class="op" id="3764936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3764939">//&nbsp;IsMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3764997">func</span>&nbsp;<span class="op" id="3765002">(</span><span class="ident" id="3765003">ip</span>&nbsp;<span class="ident" id="3765006">IP</span><span class="op" id="3765008">)</span>&nbsp;<span class="ident" id="3765010">IsMulticast</span><span class="op" id="3765021">(</span><span class="op" id="3765022">)</span>&nbsp;<span class="builtintype" id="3765024">bool</span>&nbsp;<span class="op" id="3765029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3765032">if</span>&nbsp;<span class="ident" id="3765035">ip4</span>&nbsp;<span class="op" id="3765039">:=</span>&nbsp;<span class="ident" id="3765042">ip</span><span class="op" id="3765044">.</span><span class="ident" id="3765045">To4</span><span class="op" id="3765048">(</span><span class="op" id="3765049">)</span><span class="op" id="3765050">;</span>&nbsp;<span class="ident" id="3765052">ip4</span>&nbsp;<span class="op" id="3765056">!=</span>&nbsp;<span class="builtintype" id="3765059">nil</span>&nbsp;<span class="op" id="3765063">&amp;&amp;</span>&nbsp;<span class="ident" id="3765066">ip4</span><span class="op" id="3765069">[</span><span class="num" id="3765070">0</span><span class="op" id="3765071">]</span><span class="op" id="3765072">&amp;</span><span class="num" id="3765073">0xf0</span>&nbsp;<span class="op" id="3765078">==</span>&nbsp;<span class="num" id="3765081">0xe0</span>&nbsp;<span class="op" id="3765086">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3765090">return</span>&nbsp;<span class="builtintype" id="3765097">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3765103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3765106">return</span>&nbsp;<span class="ident" id="3765113">ip</span><span class="op" id="3765115">[</span><span class="num" id="3765116">0</span><span class="op" id="3765117">]</span>&nbsp;<span class="op" id="3765119">==</span>&nbsp;<span class="num" id="3765122">0xff</span><br>
<span class="lineno"></span><span class="op" id="3765127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="3765130">//&nbsp;IsInterfaceLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3765185">//&nbsp;an&nbsp;interface-local&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3765226">func</span>&nbsp;<span class="op" id="3765231">(</span><span class="ident" id="3765232">ip</span>&nbsp;<span class="ident" id="3765235">IP</span><span class="op" id="3765237">)</span>&nbsp;<span class="ident" id="3765239">IsInterfaceLocalMulticast</span><span class="op" id="3765264">(</span><span class="op" id="3765265">)</span>&nbsp;<span class="builtintype" id="3765267">bool</span>&nbsp;<span class="op" id="3765272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3765275">return</span>&nbsp;<span class="builtinfunc" id="3765282">len</span><span class="op" id="3765285">(</span><span class="ident" id="3765286">ip</span><span class="op" id="3765288">)</span>&nbsp;<span class="op" id="3765290">==</span>&nbsp;<span class="ident" id="3765293">IPv6len</span>&nbsp;<span class="op" id="3765301">&amp;&amp;</span>&nbsp;<span class="ident" id="3765304">ip</span><span class="op" id="3765306">[</span><span class="num" id="3765307">0</span><span class="op" id="3765308">]</span>&nbsp;<span class="op" id="3765310">==</span>&nbsp;<span class="num" id="3765313">0xff</span>&nbsp;<span class="op" id="3765318">&amp;&amp;</span>&nbsp;<span class="ident" id="3765321">ip</span><span class="op" id="3765323">[</span><span class="num" id="3765324">1</span><span class="op" id="3765325">]</span><span class="op" id="3765326">&amp;</span><span class="num" id="3765327">0x0f</span>&nbsp;<span class="op" id="3765332">==</span>&nbsp;<span class="num" id="3765335">0x01</span><br>
<span class="lineno"></span><span class="op" id="3765340">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="comment" id="3765343">//&nbsp;IsLinkLocalMulticast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3765402">//&nbsp;multicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3765424">func</span>&nbsp;<span class="op" id="3765429">(</span><span class="ident" id="3765430">ip</span>&nbsp;<span class="ident" id="3765433">IP</span><span class="op" id="3765435">)</span>&nbsp;<span class="ident" id="3765437">IsLinkLocalMulticast</span><span class="op" id="3765457">(</span><span class="op" id="3765458">)</span>&nbsp;<span class="builtintype" id="3765460">bool</span>&nbsp;<span class="op" id="3765465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3765468">if</span>&nbsp;<span class="ident" id="3765471">ip4</span>&nbsp;<span class="op" id="3765475">:=</span>&nbsp;<span class="ident" id="3765478">ip</span><span class="op" id="3765480">.</span><span class="ident" id="3765481">To4</span><span class="op" id="3765484">(</span><span class="op" id="3765485">)</span><span class="op" id="3765486">;</span>&nbsp;<span class="ident" id="3765488">ip4</span>&nbsp;<span class="op" id="3765492">!=</span>&nbsp;<span class="builtintype" id="3765495">nil</span>&nbsp;<span class="op" id="3765499">&amp;&amp;</span>&nbsp;<span class="ident" id="3765502">ip4</span><span class="op" id="3765505">[</span><span class="num" id="3765506">0</span><span class="op" id="3765507">]</span>&nbsp;<span class="op" id="3765509">==</span>&nbsp;<span class="num" id="3765512">224</span>&nbsp;<span class="op" id="3765516">&amp;&amp;</span>&nbsp;<span class="ident" id="3765519">ip4</span><span class="op" id="3765522">[</span><span class="num" id="3765523">1</span><span class="op" id="3765524">]</span>&nbsp;<span class="op" id="3765526">==</span>&nbsp;<span class="num" id="3765529">0</span>&nbsp;<span class="op" id="3765531">&amp;&amp;</span>&nbsp;<span class="ident" id="3765534">ip4</span><span class="op" id="3765537">[</span><span class="num" id="3765538">2</span><span class="op" id="3765539">]</span>&nbsp;<span class="op" id="3765541">==</span>&nbsp;<span class="num" id="3765544">0</span>&nbsp;<span class="op" id="3765546">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3765550">return</span>&nbsp;<span class="builtintype" id="3765557">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3765563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3765566">return</span>&nbsp;<span class="ident" id="3765573">ip</span><span class="op" id="3765575">[</span><span class="num" id="3765576">0</span><span class="op" id="3765577">]</span>&nbsp;<span class="op" id="3765579">==</span>&nbsp;<span class="num" id="3765582">0xff</span>&nbsp;<span class="op" id="3765587">&amp;&amp;</span>&nbsp;<span class="ident" id="3765590">ip</span><span class="op" id="3765592">[</span><span class="num" id="3765593">1</span><span class="op" id="3765594">]</span><span class="op" id="3765595">&amp;</span><span class="num" id="3765596">0x0f</span>&nbsp;<span class="op" id="3765601">==</span>&nbsp;<span class="num" id="3765604">0x02</span><br>
<span class="lineno"></span><span class="op" id="3765609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="comment" id="3765612">//&nbsp;IsLinkLocalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;link-local</span><br>
<span class="lineno"></span><span class="comment" id="3765669">//&nbsp;unicast&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3765689">func</span>&nbsp;<span class="op" id="3765694">(</span><span class="ident" id="3765695">ip</span>&nbsp;<span class="ident" id="3765698">IP</span><span class="op" id="3765700">)</span>&nbsp;<span class="ident" id="3765702">IsLinkLocalUnicast</span><span class="op" id="3765720">(</span><span class="op" id="3765721">)</span>&nbsp;<span class="builtintype" id="3765723">bool</span>&nbsp;<span class="op" id="3765728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3765731">if</span>&nbsp;<span class="ident" id="3765734">ip4</span>&nbsp;<span class="op" id="3765738">:=</span>&nbsp;<span class="ident" id="3765741">ip</span><span class="op" id="3765743">.</span><span class="ident" id="3765744">To4</span><span class="op" id="3765747">(</span><span class="op" id="3765748">)</span><span class="op" id="3765749">;</span>&nbsp;<span class="ident" id="3765751">ip4</span>&nbsp;<span class="op" id="3765755">!=</span>&nbsp;<span class="builtintype" id="3765758">nil</span>&nbsp;<span class="op" id="3765762">&amp;&amp;</span>&nbsp;<span class="ident" id="3765765">ip4</span><span class="op" id="3765768">[</span><span class="num" id="3765769">0</span><span class="op" id="3765770">]</span>&nbsp;<span class="op" id="3765772">==</span>&nbsp;<span class="num" id="3765775">169</span>&nbsp;<span class="op" id="3765779">&amp;&amp;</span>&nbsp;<span class="ident" id="3765782">ip4</span><span class="op" id="3765785">[</span><span class="num" id="3765786">1</span><span class="op" id="3765787">]</span>&nbsp;<span class="op" id="3765789">==</span>&nbsp;<span class="num" id="3765792">254</span>&nbsp;<span class="op" id="3765796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3765800">return</span>&nbsp;<span class="builtintype" id="3765807">true</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3765813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3765816">return</span>&nbsp;<span class="ident" id="3765823">ip</span><span class="op" id="3765825">[</span><span class="num" id="3765826">0</span><span class="op" id="3765827">]</span>&nbsp;<span class="op" id="3765829">==</span>&nbsp;<span class="num" id="3765832">0xfe</span>&nbsp;<span class="op" id="3765837">&amp;&amp;</span>&nbsp;<span class="ident" id="3765840">ip</span><span class="op" id="3765842">[</span><span class="num" id="3765843">1</span><span class="op" id="3765844">]</span><span class="op" id="3765845">&amp;</span><span class="num" id="3765846">0xc0</span>&nbsp;<span class="op" id="3765851">==</span>&nbsp;<span class="num" id="3765854">0x80</span><br>
<span class="lineno"></span><span class="op" id="3765859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3765862">//&nbsp;IsGlobalUnicast&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;is&nbsp;a&nbsp;global&nbsp;unicast</span><br>
<span class="lineno">160</span><span class="comment" id="3765920">//&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="3765932">func</span>&nbsp;<span class="op" id="3765937">(</span><span class="ident" id="3765938">ip</span>&nbsp;<span class="ident" id="3765941">IP</span><span class="op" id="3765943">)</span>&nbsp;<span class="ident" id="3765945">IsGlobalUnicast</span><span class="op" id="3765960">(</span><span class="op" id="3765961">)</span>&nbsp;<span class="builtintype" id="3765963">bool</span>&nbsp;<span class="op" id="3765968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3765971">return</span>&nbsp;<span class="op" id="3765978">!</span><span class="ident" id="3765979">ip</span><span class="op" id="3765981">.</span><span class="ident" id="3765982">IsUnspecified</span><span class="op" id="3765995">(</span><span class="op" id="3765996">)</span>&nbsp;<span class="op" id="3765998">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3766003">!</span><span class="ident" id="3766004">ip</span><span class="op" id="3766006">.</span><span class="ident" id="3766007">IsLoopback</span><span class="op" id="3766017">(</span><span class="op" id="3766018">)</span>&nbsp;<span class="op" id="3766020">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3766025">!</span><span class="ident" id="3766026">ip</span><span class="op" id="3766028">.</span><span class="ident" id="3766029">IsMulticast</span><span class="op" id="3766040">(</span><span class="op" id="3766041">)</span>&nbsp;<span class="op" id="3766043">&amp;&amp;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3766048">!</span><span class="ident" id="3766049">ip</span><span class="op" id="3766051">.</span><span class="ident" id="3766052">IsLinkLocalUnicast</span><span class="op" id="3766070">(</span><span class="op" id="3766071">)</span><br>
<span class="lineno"></span><span class="op" id="3766073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3766076">//&nbsp;Is&nbsp;p&nbsp;all&nbsp;zeros?</span><br>
<span class="lineno"></span><span class="keyword" id="3766095">func</span>&nbsp;<span class="ident" id="3766100">isZeros</span><span class="op" id="3766107">(</span><span class="ident" id="3766108">p</span>&nbsp;<span class="ident" id="3766110">IP</span><span class="op" id="3766112">)</span>&nbsp;<span class="builtintype" id="3766114">bool</span>&nbsp;<span class="op" id="3766119">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766122">for</span>&nbsp;<span class="ident" id="3766126">i</span>&nbsp;<span class="op" id="3766128">:=</span>&nbsp;<span class="num" id="3766131">0</span><span class="op" id="3766132">;</span>&nbsp;<span class="ident" id="3766134">i</span>&nbsp;<span class="op" id="3766136">&lt;</span>&nbsp;<span class="builtinfunc" id="3766138">len</span><span class="op" id="3766141">(</span><span class="ident" id="3766142">p</span><span class="op" id="3766143">)</span><span class="op" id="3766144">;</span>&nbsp;<span class="ident" id="3766146">i</span><span class="op" id="3766147">++</span>&nbsp;<span class="op" id="3766150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766154">if</span>&nbsp;<span class="ident" id="3766157">p</span><span class="op" id="3766158">[</span><span class="ident" id="3766159">i</span><span class="op" id="3766160">]</span>&nbsp;<span class="op" id="3766162">!=</span>&nbsp;<span class="num" id="3766165">0</span>&nbsp;<span class="op" id="3766167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766172">return</span>&nbsp;<span class="builtintype" id="3766179">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3766187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3766190">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766193">return</span>&nbsp;<span class="builtintype" id="3766200">true</span><br>
<span class="lineno"></span><span class="op" id="3766205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3766208">//&nbsp;To4&nbsp;converts&nbsp;the&nbsp;IPv4&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;4-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3766272">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;To4&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">180</span><span class="keyword" id="3766322">func</span>&nbsp;<span class="op" id="3766327">(</span><span class="ident" id="3766328">ip</span>&nbsp;<span class="ident" id="3766331">IP</span><span class="op" id="3766333">)</span>&nbsp;<span class="ident" id="3766335">To4</span><span class="op" id="3766338">(</span><span class="op" id="3766339">)</span>&nbsp;<span class="ident" id="3766341">IP</span>&nbsp;<span class="op" id="3766344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766347">if</span>&nbsp;<span class="builtinfunc" id="3766350">len</span><span class="op" id="3766353">(</span><span class="ident" id="3766354">ip</span><span class="op" id="3766356">)</span>&nbsp;<span class="op" id="3766358">==</span>&nbsp;<span class="ident" id="3766361">IPv4len</span>&nbsp;<span class="op" id="3766369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766373">return</span>&nbsp;<span class="ident" id="3766380">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3766384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766387">if</span>&nbsp;<span class="builtinfunc" id="3766390">len</span><span class="op" id="3766393">(</span><span class="ident" id="3766394">ip</span><span class="op" id="3766396">)</span>&nbsp;<span class="op" id="3766398">==</span>&nbsp;<span class="ident" id="3766401">IPv6len</span>&nbsp;<span class="op" id="3766409">&amp;&amp;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3766414">isZeros</span><span class="op" id="3766421">(</span><span class="ident" id="3766422">ip</span><span class="op" id="3766424">[</span><span class="num" id="3766425">0</span><span class="op" id="3766426">:</span><span class="num" id="3766427">10</span><span class="op" id="3766429">]</span><span class="op" id="3766430">)</span>&nbsp;<span class="op" id="3766432">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3766437">ip</span><span class="op" id="3766439">[</span><span class="num" id="3766440">10</span><span class="op" id="3766442">]</span>&nbsp;<span class="op" id="3766444">==</span>&nbsp;<span class="num" id="3766447">0xff</span>&nbsp;<span class="op" id="3766452">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3766457">ip</span><span class="op" id="3766459">[</span><span class="num" id="3766460">11</span><span class="op" id="3766462">]</span>&nbsp;<span class="op" id="3766464">==</span>&nbsp;<span class="num" id="3766467">0xff</span>&nbsp;<span class="op" id="3766472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766476">return</span>&nbsp;<span class="ident" id="3766483">ip</span><span class="op" id="3766485">[</span><span class="num" id="3766486">12</span><span class="op" id="3766488">:</span><span class="num" id="3766489">16</span><span class="op" id="3766491">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3766494">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766497">return</span>&nbsp;<span class="builtintype" id="3766504">nil</span><br>
<span class="lineno"></span><span class="op" id="3766508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3766511">//&nbsp;To16&nbsp;converts&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;to&nbsp;a&nbsp;16-byte&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="3766575">//&nbsp;If&nbsp;ip&nbsp;is&nbsp;not&nbsp;an&nbsp;IP&nbsp;address&nbsp;(it&nbsp;is&nbsp;the&nbsp;wrong&nbsp;length),&nbsp;To16&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno">195</span><span class="keyword" id="3766649">func</span>&nbsp;<span class="op" id="3766654">(</span><span class="ident" id="3766655">ip</span>&nbsp;<span class="ident" id="3766658">IP</span><span class="op" id="3766660">)</span>&nbsp;<span class="ident" id="3766662">To16</span><span class="op" id="3766666">(</span><span class="op" id="3766667">)</span>&nbsp;<span class="ident" id="3766669">IP</span>&nbsp;<span class="op" id="3766672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766675">if</span>&nbsp;<span class="builtinfunc" id="3766678">len</span><span class="op" id="3766681">(</span><span class="ident" id="3766682">ip</span><span class="op" id="3766684">)</span>&nbsp;<span class="op" id="3766686">==</span>&nbsp;<span class="ident" id="3766689">IPv4len</span>&nbsp;<span class="op" id="3766697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766701">return</span>&nbsp;<span class="ident" id="3766708">IPv4</span><span class="op" id="3766712">(</span><span class="ident" id="3766713">ip</span><span class="op" id="3766715">[</span><span class="num" id="3766716">0</span><span class="op" id="3766717">]</span><span class="op" id="3766718">,</span>&nbsp;<span class="ident" id="3766720">ip</span><span class="op" id="3766722">[</span><span class="num" id="3766723">1</span><span class="op" id="3766724">]</span><span class="op" id="3766725">,</span>&nbsp;<span class="ident" id="3766727">ip</span><span class="op" id="3766729">[</span><span class="num" id="3766730">2</span><span class="op" id="3766731">]</span><span class="op" id="3766732">,</span>&nbsp;<span class="ident" id="3766734">ip</span><span class="op" id="3766736">[</span><span class="num" id="3766737">3</span><span class="op" id="3766738">]</span><span class="op" id="3766739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3766742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766745">if</span>&nbsp;<span class="builtinfunc" id="3766748">len</span><span class="op" id="3766751">(</span><span class="ident" id="3766752">ip</span><span class="op" id="3766754">)</span>&nbsp;<span class="op" id="3766756">==</span>&nbsp;<span class="ident" id="3766759">IPv6len</span>&nbsp;<span class="op" id="3766767">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766771">return</span>&nbsp;<span class="ident" id="3766778">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3766782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3766785">return</span>&nbsp;<span class="builtintype" id="3766792">nil</span><br>
<span class="lineno"></span><span class="op" id="3766796">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="3766799">//&nbsp;Default&nbsp;route&nbsp;masks&nbsp;for&nbsp;IPv4.</span><br>
<span class="lineno"></span><span class="keyword" id="3766832">var</span>&nbsp;<span class="op" id="3766836">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3766839">classAMask</span>&nbsp;<span class="op" id="3766850">=</span>&nbsp;<span class="ident" id="3766852">IPv4Mask</span><span class="op" id="3766860">(</span><span class="num" id="3766861">0xff</span><span class="op" id="3766865">,</span>&nbsp;<span class="num" id="3766867">0</span><span class="op" id="3766868">,</span>&nbsp;<span class="num" id="3766870">0</span><span class="op" id="3766871">,</span>&nbsp;<span class="num" id="3766873">0</span><span class="op" id="3766874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3766877">classBMask</span>&nbsp;<span class="op" id="3766888">=</span>&nbsp;<span class="ident" id="3766890">IPv4Mask</span><span class="op" id="3766898">(</span><span class="num" id="3766899">0xff</span><span class="op" id="3766903">,</span>&nbsp;<span class="num" id="3766905">0xff</span><span class="op" id="3766909">,</span>&nbsp;<span class="num" id="3766911">0</span><span class="op" id="3766912">,</span>&nbsp;<span class="num" id="3766914">0</span><span class="op" id="3766915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3766918">classCMask</span>&nbsp;<span class="op" id="3766929">=</span>&nbsp;<span class="ident" id="3766931">IPv4Mask</span><span class="op" id="3766939">(</span><span class="num" id="3766940">0xff</span><span class="op" id="3766944">,</span>&nbsp;<span class="num" id="3766946">0xff</span><span class="op" id="3766950">,</span>&nbsp;<span class="num" id="3766952">0xff</span><span class="op" id="3766956">,</span>&nbsp;<span class="num" id="3766958">0</span><span class="op" id="3766959">)</span><br>
<span class="lineno">210</span><span class="op" id="3766961">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3766964">//&nbsp;DefaultMask&nbsp;returns&nbsp;the&nbsp;default&nbsp;IP&nbsp;mask&nbsp;for&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3767030">//&nbsp;Only&nbsp;IPv4&nbsp;addresses&nbsp;have&nbsp;default&nbsp;masks;&nbsp;DefaultMask&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3767093">//&nbsp;nil&nbsp;if&nbsp;ip&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;IPv4&nbsp;address.</span><br>
<span class="lineno">215</span><span class="keyword" id="3767135">func</span>&nbsp;<span class="op" id="3767140">(</span><span class="ident" id="3767141">ip</span>&nbsp;<span class="ident" id="3767144">IP</span><span class="op" id="3767146">)</span>&nbsp;<span class="ident" id="3767148">DefaultMask</span><span class="op" id="3767159">(</span><span class="op" id="3767160">)</span>&nbsp;<span class="ident" id="3767162">IPMask</span>&nbsp;<span class="op" id="3767169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767172">if</span>&nbsp;<span class="ident" id="3767175">ip</span>&nbsp;<span class="op" id="3767178">=</span>&nbsp;<span class="ident" id="3767180">ip</span><span class="op" id="3767182">.</span><span class="ident" id="3767183">To4</span><span class="op" id="3767186">(</span><span class="op" id="3767187">)</span><span class="op" id="3767188">;</span>&nbsp;<span class="ident" id="3767190">ip</span>&nbsp;<span class="op" id="3767193">==</span>&nbsp;<span class="builtintype" id="3767196">nil</span>&nbsp;<span class="op" id="3767200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767204">return</span>&nbsp;<span class="builtintype" id="3767211">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3767216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767219">switch</span>&nbsp;<span class="builtintype" id="3767226">true</span>&nbsp;<span class="op" id="3767231">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767234">case</span>&nbsp;<span class="ident" id="3767239">ip</span><span class="op" id="3767241">[</span><span class="num" id="3767242">0</span><span class="op" id="3767243">]</span>&nbsp;<span class="op" id="3767245">&lt;</span>&nbsp;<span class="num" id="3767247">0x80</span><span class="op" id="3767251">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767255">return</span>&nbsp;<span class="ident" id="3767262">classAMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767274">case</span>&nbsp;<span class="ident" id="3767279">ip</span><span class="op" id="3767281">[</span><span class="num" id="3767282">0</span><span class="op" id="3767283">]</span>&nbsp;<span class="op" id="3767285">&lt;</span>&nbsp;<span class="num" id="3767287">0xC0</span><span class="op" id="3767291">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767295">return</span>&nbsp;<span class="ident" id="3767302">classBMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767314">default</span><span class="op" id="3767321">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767325">return</span>&nbsp;<span class="ident" id="3767332">classCMask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3767344">}</span><br>
<span class="lineno"></span><span class="op" id="3767346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3767349">func</span>&nbsp;<span class="ident" id="3767354">allFF</span><span class="op" id="3767359">(</span><span class="ident" id="3767360">b</span>&nbsp;<span class="op" id="3767362">[</span><span class="op" id="3767363">]</span><span class="builtintype" id="3767364">byte</span><span class="op" id="3767368">)</span>&nbsp;<span class="builtintype" id="3767370">bool</span>&nbsp;<span class="op" id="3767375">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767378">for</span>&nbsp;<span class="ident" id="3767382">_</span><span class="op" id="3767383">,</span>&nbsp;<span class="ident" id="3767385">c</span>&nbsp;<span class="op" id="3767387">:=</span>&nbsp;<span class="keyword" id="3767390">range</span>&nbsp;<span class="ident" id="3767396">b</span>&nbsp;<span class="op" id="3767398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767402">if</span>&nbsp;<span class="ident" id="3767405">c</span>&nbsp;<span class="op" id="3767407">!=</span>&nbsp;<span class="num" id="3767410">0xff</span>&nbsp;<span class="op" id="3767415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767420">return</span>&nbsp;<span class="builtintype" id="3767427">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3767435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3767438">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767441">return</span>&nbsp;<span class="builtintype" id="3767448">true</span><br>
<span class="lineno"></span><span class="op" id="3767453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3767456">//&nbsp;Mask&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;masking&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip&nbsp;with&nbsp;mask.</span><br>
<span class="lineno"></span><span class="keyword" id="3767523">func</span>&nbsp;<span class="op" id="3767528">(</span><span class="ident" id="3767529">ip</span>&nbsp;<span class="ident" id="3767532">IP</span><span class="op" id="3767534">)</span>&nbsp;<span class="ident" id="3767536">Mask</span><span class="op" id="3767540">(</span><span class="ident" id="3767541">mask</span>&nbsp;<span class="ident" id="3767546">IPMask</span><span class="op" id="3767552">)</span>&nbsp;<span class="ident" id="3767554">IP</span>&nbsp;<span class="op" id="3767557">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767560">if</span>&nbsp;<span class="builtinfunc" id="3767563">len</span><span class="op" id="3767566">(</span><span class="ident" id="3767567">mask</span><span class="op" id="3767571">)</span>&nbsp;<span class="op" id="3767573">==</span>&nbsp;<span class="ident" id="3767576">IPv6len</span>&nbsp;<span class="op" id="3767584">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3767587">len</span><span class="op" id="3767590">(</span><span class="ident" id="3767591">ip</span><span class="op" id="3767593">)</span>&nbsp;<span class="op" id="3767595">==</span>&nbsp;<span class="ident" id="3767598">IPv4len</span>&nbsp;<span class="op" id="3767606">&amp;&amp;</span>&nbsp;<span class="ident" id="3767609">allFF</span><span class="op" id="3767614">(</span><span class="ident" id="3767615">mask</span><span class="op" id="3767619">[</span><span class="op" id="3767620">:</span><span class="num" id="3767621">12</span><span class="op" id="3767623">]</span><span class="op" id="3767624">)</span>&nbsp;<span class="op" id="3767626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3767630">mask</span>&nbsp;<span class="op" id="3767635">=</span>&nbsp;<span class="ident" id="3767637">mask</span><span class="op" id="3767641">[</span><span class="num" id="3767642">12</span><span class="op" id="3767644">:</span><span class="op" id="3767645">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3767648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767651">if</span>&nbsp;<span class="builtinfunc" id="3767654">len</span><span class="op" id="3767657">(</span><span class="ident" id="3767658">mask</span><span class="op" id="3767662">)</span>&nbsp;<span class="op" id="3767664">==</span>&nbsp;<span class="ident" id="3767667">IPv4len</span>&nbsp;<span class="op" id="3767675">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3767678">len</span><span class="op" id="3767681">(</span><span class="ident" id="3767682">ip</span><span class="op" id="3767684">)</span>&nbsp;<span class="op" id="3767686">==</span>&nbsp;<span class="ident" id="3767689">IPv6len</span>&nbsp;<span class="op" id="3767697">&amp;&amp;</span>&nbsp;<span class="ident" id="3767700">bytesEqual</span><span class="op" id="3767710">(</span><span class="ident" id="3767711">ip</span><span class="op" id="3767713">[</span><span class="op" id="3767714">:</span><span class="num" id="3767715">12</span><span class="op" id="3767717">]</span><span class="op" id="3767718">,</span>&nbsp;<span class="ident" id="3767720">v4InV6Prefix</span><span class="op" id="3767732">)</span>&nbsp;<span class="op" id="3767734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3767738">ip</span>&nbsp;<span class="op" id="3767741">=</span>&nbsp;<span class="ident" id="3767743">ip</span><span class="op" id="3767745">[</span><span class="num" id="3767746">12</span><span class="op" id="3767748">:</span><span class="op" id="3767749">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3767752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3767755">n</span>&nbsp;<span class="op" id="3767757">:=</span>&nbsp;<span class="builtinfunc" id="3767760">len</span><span class="op" id="3767763">(</span><span class="ident" id="3767764">ip</span><span class="op" id="3767766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767769">if</span>&nbsp;<span class="ident" id="3767772">n</span>&nbsp;<span class="op" id="3767774">!=</span>&nbsp;<span class="builtinfunc" id="3767777">len</span><span class="op" id="3767780">(</span><span class="ident" id="3767781">mask</span><span class="op" id="3767785">)</span>&nbsp;<span class="op" id="3767787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767791">return</span>&nbsp;<span class="builtintype" id="3767798">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3767803">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3767806">out</span>&nbsp;<span class="op" id="3767810">:=</span>&nbsp;<span class="builtinfunc" id="3767813">make</span><span class="op" id="3767817">(</span><span class="ident" id="3767818">IP</span><span class="op" id="3767820">,</span>&nbsp;<span class="ident" id="3767822">n</span><span class="op" id="3767823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767826">for</span>&nbsp;<span class="ident" id="3767830">i</span>&nbsp;<span class="op" id="3767832">:=</span>&nbsp;<span class="num" id="3767835">0</span><span class="op" id="3767836">;</span>&nbsp;<span class="ident" id="3767838">i</span>&nbsp;<span class="op" id="3767840">&lt;</span>&nbsp;<span class="ident" id="3767842">n</span><span class="op" id="3767843">;</span>&nbsp;<span class="ident" id="3767845">i</span><span class="op" id="3767846">++</span>&nbsp;<span class="op" id="3767849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3767853">out</span><span class="op" id="3767856">[</span><span class="ident" id="3767857">i</span><span class="op" id="3767858">]</span>&nbsp;<span class="op" id="3767860">=</span>&nbsp;<span class="ident" id="3767862">ip</span><span class="op" id="3767864">[</span><span class="ident" id="3767865">i</span><span class="op" id="3767866">]</span>&nbsp;<span class="op" id="3767868">&amp;</span>&nbsp;<span class="ident" id="3767870">mask</span><span class="op" id="3767874">[</span><span class="ident" id="3767875">i</span><span class="op" id="3767876">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3767879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3767882">return</span>&nbsp;<span class="ident" id="3767889">out</span><br>
<span class="lineno">255</span><span class="op" id="3767893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3767896">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;string&nbsp;form&nbsp;of&nbsp;the&nbsp;IP&nbsp;address&nbsp;ip.</span><br>
<span class="lineno"></span><span class="comment" id="3767952">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;an&nbsp;IPv4&nbsp;address,&nbsp;the&nbsp;string&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="3768016">//&nbsp;is&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;).&nbsp;&nbsp;Otherwise&nbsp;the&nbsp;representation</span><br>
<span class="lineno">260</span><span class="comment" id="3768085">//&nbsp;is&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;).</span><br>
<span class="lineno"></span><span class="keyword" id="3768122">func</span>&nbsp;<span class="op" id="3768127">(</span><span class="ident" id="3768128">ip</span>&nbsp;<span class="ident" id="3768131">IP</span><span class="op" id="3768133">)</span>&nbsp;<span class="ident" id="3768135">String</span><span class="op" id="3768141">(</span><span class="op" id="3768142">)</span>&nbsp;<span class="builtintype" id="3768144">string</span>&nbsp;<span class="op" id="3768151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768154">p</span>&nbsp;<span class="op" id="3768156">:=</span>&nbsp;<span class="ident" id="3768159">ip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768164">if</span>&nbsp;<span class="builtinfunc" id="3768167">len</span><span class="op" id="3768170">(</span><span class="ident" id="3768171">ip</span><span class="op" id="3768173">)</span>&nbsp;<span class="op" id="3768175">==</span>&nbsp;<span class="num" id="3768178">0</span>&nbsp;<span class="op" id="3768180">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768184">return</span>&nbsp;<span class="string" id="3768191">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3768200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3768204">//&nbsp;If&nbsp;IPv4,&nbsp;use&nbsp;dotted&nbsp;notation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768238">if</span>&nbsp;<span class="ident" id="3768241">p4</span>&nbsp;<span class="op" id="3768244">:=</span>&nbsp;<span class="ident" id="3768247">p</span><span class="op" id="3768248">.</span><span class="ident" id="3768249">To4</span><span class="op" id="3768252">(</span><span class="op" id="3768253">)</span><span class="op" id="3768254">;</span>&nbsp;<span class="builtinfunc" id="3768256">len</span><span class="op" id="3768259">(</span><span class="ident" id="3768260">p4</span><span class="op" id="3768262">)</span>&nbsp;<span class="op" id="3768264">==</span>&nbsp;<span class="ident" id="3768267">IPv4len</span>&nbsp;<span class="op" id="3768275">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768279">return</span>&nbsp;<span class="ident" id="3768286">itod</span><span class="op" id="3768290">(</span><span class="builtintype" id="3768291">uint</span><span class="op" id="3768295">(</span><span class="ident" id="3768296">p4</span><span class="op" id="3768298">[</span><span class="num" id="3768299">0</span><span class="op" id="3768300">]</span><span class="op" id="3768301">)</span><span class="op" id="3768302">)</span>&nbsp;<span class="op" id="3768304">+</span>&nbsp;<span class="string" id="3768306">&#34;.&#34;</span>&nbsp;<span class="op" id="3768310">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768315">itod</span><span class="op" id="3768319">(</span><span class="builtintype" id="3768320">uint</span><span class="op" id="3768324">(</span><span class="ident" id="3768325">p4</span><span class="op" id="3768327">[</span><span class="num" id="3768328">1</span><span class="op" id="3768329">]</span><span class="op" id="3768330">)</span><span class="op" id="3768331">)</span>&nbsp;<span class="op" id="3768333">+</span>&nbsp;<span class="string" id="3768335">&#34;.&#34;</span>&nbsp;<span class="op" id="3768339">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768344">itod</span><span class="op" id="3768348">(</span><span class="builtintype" id="3768349">uint</span><span class="op" id="3768353">(</span><span class="ident" id="3768354">p4</span><span class="op" id="3768356">[</span><span class="num" id="3768357">2</span><span class="op" id="3768358">]</span><span class="op" id="3768359">)</span><span class="op" id="3768360">)</span>&nbsp;<span class="op" id="3768362">+</span>&nbsp;<span class="string" id="3768364">&#34;.&#34;</span>&nbsp;<span class="op" id="3768368">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768373">itod</span><span class="op" id="3768377">(</span><span class="builtintype" id="3768378">uint</span><span class="op" id="3768382">(</span><span class="ident" id="3768383">p4</span><span class="op" id="3768385">[</span><span class="num" id="3768386">3</span><span class="op" id="3768387">]</span><span class="op" id="3768388">)</span><span class="op" id="3768389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3768392">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768395">if</span>&nbsp;<span class="builtinfunc" id="3768398">len</span><span class="op" id="3768401">(</span><span class="ident" id="3768402">p</span><span class="op" id="3768403">)</span>&nbsp;<span class="op" id="3768405">!=</span>&nbsp;<span class="ident" id="3768408">IPv6len</span>&nbsp;<span class="op" id="3768416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768420">return</span>&nbsp;<span class="string" id="3768427">&#34;?&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3768432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3768436">//&nbsp;Find&nbsp;longest&nbsp;run&nbsp;of&nbsp;zeros.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768467">e0</span>&nbsp;<span class="op" id="3768470">:=</span>&nbsp;<span class="op" id="3768473">-</span><span class="num" id="3768474">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768477">e1</span>&nbsp;<span class="op" id="3768480">:=</span>&nbsp;<span class="op" id="3768483">-</span><span class="num" id="3768484">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768487">for</span>&nbsp;<span class="ident" id="3768491">i</span>&nbsp;<span class="op" id="3768493">:=</span>&nbsp;<span class="num" id="3768496">0</span><span class="op" id="3768497">;</span>&nbsp;<span class="ident" id="3768499">i</span>&nbsp;<span class="op" id="3768501">&lt;</span>&nbsp;<span class="ident" id="3768503">IPv6len</span><span class="op" id="3768510">;</span>&nbsp;<span class="ident" id="3768512">i</span>&nbsp;<span class="op" id="3768514">+=</span>&nbsp;<span class="num" id="3768517">2</span>&nbsp;<span class="op" id="3768519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768523">j</span>&nbsp;<span class="op" id="3768525">:=</span>&nbsp;<span class="ident" id="3768528">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768532">for</span>&nbsp;<span class="ident" id="3768536">j</span>&nbsp;<span class="op" id="3768538">&lt;</span>&nbsp;<span class="ident" id="3768540">IPv6len</span>&nbsp;<span class="op" id="3768548">&amp;&amp;</span>&nbsp;<span class="ident" id="3768551">p</span><span class="op" id="3768552">[</span><span class="ident" id="3768553">j</span><span class="op" id="3768554">]</span>&nbsp;<span class="op" id="3768556">==</span>&nbsp;<span class="num" id="3768559">0</span>&nbsp;<span class="op" id="3768561">&amp;&amp;</span>&nbsp;<span class="ident" id="3768564">p</span><span class="op" id="3768565">[</span><span class="ident" id="3768566">j</span><span class="op" id="3768567">+</span><span class="num" id="3768568">1</span><span class="op" id="3768569">]</span>&nbsp;<span class="op" id="3768571">==</span>&nbsp;<span class="num" id="3768574">0</span>&nbsp;<span class="op" id="3768576">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768581">j</span>&nbsp;<span class="op" id="3768583">+=</span>&nbsp;<span class="num" id="3768586">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3768590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768594">if</span>&nbsp;<span class="ident" id="3768597">j</span>&nbsp;<span class="op" id="3768599">&gt;</span>&nbsp;<span class="ident" id="3768601">i</span>&nbsp;<span class="op" id="3768603">&amp;&amp;</span>&nbsp;<span class="ident" id="3768606">j</span><span class="op" id="3768607">-</span><span class="ident" id="3768608">i</span>&nbsp;<span class="op" id="3768610">&gt;</span>&nbsp;<span class="ident" id="3768612">e1</span><span class="op" id="3768614">-</span><span class="ident" id="3768615">e0</span>&nbsp;<span class="op" id="3768618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768623">e0</span>&nbsp;<span class="op" id="3768626">=</span>&nbsp;<span class="ident" id="3768628">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768633">e1</span>&nbsp;<span class="op" id="3768636">=</span>&nbsp;<span class="ident" id="3768638">j</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768643">i</span>&nbsp;<span class="op" id="3768645">=</span>&nbsp;<span class="ident" id="3768647">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3768651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3768654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3768657">//&nbsp;The&nbsp;symbol&nbsp;&#34;::&#34;&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;shorten&nbsp;just&nbsp;one&nbsp;16&nbsp;bit&nbsp;0&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768730">if</span>&nbsp;<span class="ident" id="3768733">e1</span><span class="op" id="3768735">-</span><span class="ident" id="3768736">e0</span>&nbsp;<span class="op" id="3768739">&lt;=</span>&nbsp;<span class="num" id="3768742">2</span>&nbsp;<span class="op" id="3768744">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768748">e0</span>&nbsp;<span class="op" id="3768751">=</span>&nbsp;<span class="op" id="3768753">-</span><span class="num" id="3768754">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768758">e1</span>&nbsp;<span class="op" id="3768761">=</span>&nbsp;<span class="op" id="3768763">-</span><span class="num" id="3768764">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3768767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768771">const</span>&nbsp;<span class="ident" id="3768777">maxLen</span>&nbsp;<span class="op" id="3768784">=</span>&nbsp;<span class="builtinfunc" id="3768786">len</span><span class="op" id="3768789">(</span><span class="string" id="3768790">&#34;ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span class="op" id="3768831">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768834">b</span>&nbsp;<span class="op" id="3768836">:=</span>&nbsp;<span class="builtinfunc" id="3768839">make</span><span class="op" id="3768843">(</span><span class="op" id="3768844">[</span><span class="op" id="3768845">]</span><span class="builtintype" id="3768846">byte</span><span class="op" id="3768850">,</span>&nbsp;<span class="num" id="3768852">0</span><span class="op" id="3768853">,</span>&nbsp;<span class="ident" id="3768855">maxLen</span><span class="op" id="3768861">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3768865">//&nbsp;Print&nbsp;with&nbsp;possible&nbsp;::&nbsp;in&nbsp;place&nbsp;of&nbsp;run&nbsp;of&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768917">for</span>&nbsp;<span class="ident" id="3768921">i</span>&nbsp;<span class="op" id="3768923">:=</span>&nbsp;<span class="num" id="3768926">0</span><span class="op" id="3768927">;</span>&nbsp;<span class="ident" id="3768929">i</span>&nbsp;<span class="op" id="3768931">&lt;</span>&nbsp;<span class="ident" id="3768933">IPv6len</span><span class="op" id="3768940">;</span>&nbsp;<span class="ident" id="3768942">i</span>&nbsp;<span class="op" id="3768944">+=</span>&nbsp;<span class="num" id="3768947">2</span>&nbsp;<span class="op" id="3768949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3768953">if</span>&nbsp;<span class="ident" id="3768956">i</span>&nbsp;<span class="op" id="3768958">==</span>&nbsp;<span class="ident" id="3768961">e0</span>&nbsp;<span class="op" id="3768964">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768969">b</span>&nbsp;<span class="op" id="3768971">=</span>&nbsp;<span class="builtinfunc" id="3768973">append</span><span class="op" id="3768979">(</span><span class="ident" id="3768980">b</span><span class="op" id="3768981">,</span>&nbsp;<span class="string" id="3768983">&#39;:&#39;</span><span class="op" id="3768986">,</span>&nbsp;<span class="string" id="3768988">&#39;:&#39;</span><span class="op" id="3768991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3768996">i</span>&nbsp;<span class="op" id="3768998">=</span>&nbsp;<span class="ident" id="3769000">e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769006">if</span>&nbsp;<span class="ident" id="3769009">i</span>&nbsp;<span class="op" id="3769011">&gt;=</span>&nbsp;<span class="ident" id="3769014">IPv6len</span>&nbsp;<span class="op" id="3769022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769028">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3769037">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3769041">}</span>&nbsp;<span class="keyword" id="3769043">else</span>&nbsp;<span class="keyword" id="3769048">if</span>&nbsp;<span class="ident" id="3769051">i</span>&nbsp;<span class="op" id="3769053">&gt;</span>&nbsp;<span class="num" id="3769055">0</span>&nbsp;<span class="op" id="3769057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3769062">b</span>&nbsp;<span class="op" id="3769064">=</span>&nbsp;<span class="builtinfunc" id="3769066">append</span><span class="op" id="3769072">(</span><span class="ident" id="3769073">b</span><span class="op" id="3769074">,</span>&nbsp;<span class="string" id="3769076">&#39;:&#39;</span><span class="op" id="3769079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3769083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3769087">b</span>&nbsp;<span class="op" id="3769089">=</span>&nbsp;<span class="ident" id="3769091">appendHex</span><span class="op" id="3769100">(</span><span class="ident" id="3769101">b</span><span class="op" id="3769102">,</span>&nbsp;<span class="op" id="3769104">(</span><span class="builtintype" id="3769105">uint32</span><span class="op" id="3769111">(</span><span class="ident" id="3769112">p</span><span class="op" id="3769113">[</span><span class="ident" id="3769114">i</span><span class="op" id="3769115">]</span><span class="op" id="3769116">)</span><span class="op" id="3769117">&lt;&lt;</span><span class="num" id="3769119">8</span><span class="op" id="3769120">)</span><span class="op" id="3769121">|</span><span class="builtintype" id="3769122">uint32</span><span class="op" id="3769128">(</span><span class="ident" id="3769129">p</span><span class="op" id="3769130">[</span><span class="ident" id="3769131">i</span><span class="op" id="3769132">+</span><span class="num" id="3769133">1</span><span class="op" id="3769134">]</span><span class="op" id="3769135">)</span><span class="op" id="3769136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3769139">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769142">return</span>&nbsp;<span class="builtintype" id="3769149">string</span><span class="op" id="3769155">(</span><span class="ident" id="3769156">b</span><span class="op" id="3769157">)</span><br>
<span class="lineno"></span><span class="op" id="3769159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3769162">//&nbsp;ipEmptyString&nbsp;is&nbsp;like&nbsp;ip.String&nbsp;except&nbsp;that&nbsp;it&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3769220">//&nbsp;an&nbsp;empty&nbsp;string&nbsp;when&nbsp;ip&nbsp;is&nbsp;unset.</span><br>
<span class="lineno">320</span><span class="keyword" id="3769257">func</span>&nbsp;<span class="ident" id="3769262">ipEmptyString</span><span class="op" id="3769275">(</span><span class="ident" id="3769276">ip</span>&nbsp;<span class="ident" id="3769279">IP</span><span class="op" id="3769281">)</span>&nbsp;<span class="builtintype" id="3769283">string</span>&nbsp;<span class="op" id="3769290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769293">if</span>&nbsp;<span class="builtinfunc" id="3769296">len</span><span class="op" id="3769299">(</span><span class="ident" id="3769300">ip</span><span class="op" id="3769302">)</span>&nbsp;<span class="op" id="3769304">==</span>&nbsp;<span class="num" id="3769307">0</span>&nbsp;<span class="op" id="3769309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769313">return</span>&nbsp;<span class="string" id="3769320">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3769324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769327">return</span>&nbsp;<span class="ident" id="3769334">ip</span><span class="op" id="3769336">.</span><span class="ident" id="3769337">String</span><span class="op" id="3769343">(</span><span class="op" id="3769344">)</span><br>
<span class="lineno">325</span><span class="op" id="3769346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3769349">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="3769413">//&nbsp;The&nbsp;encoding&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;returned&nbsp;by&nbsp;String.</span><br>
<span class="lineno"></span><span class="keyword" id="3769464">func</span>&nbsp;<span class="op" id="3769469">(</span><span class="ident" id="3769470">ip</span>&nbsp;<span class="ident" id="3769473">IP</span><span class="op" id="3769475">)</span>&nbsp;<span class="ident" id="3769477">MarshalText</span><span class="op" id="3769488">(</span><span class="op" id="3769489">)</span>&nbsp;<span class="op" id="3769491">(</span><span class="op" id="3769492">[</span><span class="op" id="3769493">]</span><span class="builtintype" id="3769494">byte</span><span class="op" id="3769498">,</span>&nbsp;<span class="builtintype" id="3769500">error</span><span class="op" id="3769505">)</span>&nbsp;<span class="op" id="3769507">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769510">if</span>&nbsp;<span class="builtinfunc" id="3769513">len</span><span class="op" id="3769516">(</span><span class="ident" id="3769517">ip</span><span class="op" id="3769519">)</span>&nbsp;<span class="op" id="3769521">==</span>&nbsp;<span class="num" id="3769524">0</span>&nbsp;<span class="op" id="3769526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769530">return</span>&nbsp;<span class="op" id="3769537">[</span><span class="op" id="3769538">]</span><span class="builtintype" id="3769539">byte</span><span class="op" id="3769543">(</span><span class="string" id="3769544">&#34;&#34;</span><span class="op" id="3769546">)</span><span class="op" id="3769547">,</span>&nbsp;<span class="builtintype" id="3769549">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3769554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769557">if</span>&nbsp;<span class="builtinfunc" id="3769560">len</span><span class="op" id="3769563">(</span><span class="ident" id="3769564">ip</span><span class="op" id="3769566">)</span>&nbsp;<span class="op" id="3769568">!=</span>&nbsp;<span class="ident" id="3769571">IPv4len</span>&nbsp;<span class="op" id="3769579">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3769582">len</span><span class="op" id="3769585">(</span><span class="ident" id="3769586">ip</span><span class="op" id="3769588">)</span>&nbsp;<span class="op" id="3769590">!=</span>&nbsp;<span class="ident" id="3769593">IPv6len</span>&nbsp;<span class="op" id="3769601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769605">return</span>&nbsp;<span class="builtintype" id="3769612">nil</span><span class="op" id="3769615">,</span>&nbsp;<span class="ident" id="3769617">errors</span><span class="op" id="3769623">.</span><span class="ident" id="3769624">New</span><span class="op" id="3769627">(</span><span class="string" id="3769628">&#34;invalid&nbsp;IP&nbsp;address&#34;</span><span class="op" id="3769648">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3769651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769654">return</span>&nbsp;<span class="op" id="3769661">[</span><span class="op" id="3769662">]</span><span class="builtintype" id="3769663">byte</span><span class="op" id="3769667">(</span><span class="ident" id="3769668">ip</span><span class="op" id="3769670">.</span><span class="ident" id="3769671">String</span><span class="op" id="3769677">(</span><span class="op" id="3769678">)</span><span class="op" id="3769679">)</span><span class="op" id="3769680">,</span>&nbsp;<span class="builtintype" id="3769682">nil</span><br>
<span class="lineno"></span><span class="op" id="3769686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3769689">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno">340</span><span class="comment" id="3769757">//&nbsp;The&nbsp;IP&nbsp;address&nbsp;is&nbsp;expected&nbsp;in&nbsp;a&nbsp;form&nbsp;accepted&nbsp;by&nbsp;ParseIP.</span><br>
<span class="lineno"></span><span class="keyword" id="3769818">func</span>&nbsp;<span class="op" id="3769823">(</span><span class="ident" id="3769824">ip</span>&nbsp;<span class="op" id="3769827">*</span><span class="ident" id="3769828">IP</span><span class="op" id="3769830">)</span>&nbsp;<span class="ident" id="3769832">UnmarshalText</span><span class="op" id="3769845">(</span><span class="ident" id="3769846">text</span>&nbsp;<span class="op" id="3769851">[</span><span class="op" id="3769852">]</span><span class="builtintype" id="3769853">byte</span><span class="op" id="3769857">)</span>&nbsp;<span class="builtintype" id="3769859">error</span>&nbsp;<span class="op" id="3769865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769868">if</span>&nbsp;<span class="builtinfunc" id="3769871">len</span><span class="op" id="3769874">(</span><span class="ident" id="3769875">text</span><span class="op" id="3769879">)</span>&nbsp;<span class="op" id="3769881">==</span>&nbsp;<span class="num" id="3769884">0</span>&nbsp;<span class="op" id="3769886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3769890">*</span><span class="ident" id="3769891">ip</span>&nbsp;<span class="op" id="3769894">=</span>&nbsp;<span class="builtintype" id="3769896">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769902">return</span>&nbsp;<span class="builtintype" id="3769909">nil</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3769914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3769917">s</span>&nbsp;<span class="op" id="3769919">:=</span>&nbsp;<span class="builtintype" id="3769922">string</span><span class="op" id="3769928">(</span><span class="ident" id="3769929">text</span><span class="op" id="3769933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3769936">x</span>&nbsp;<span class="op" id="3769938">:=</span>&nbsp;<span class="ident" id="3769941">ParseIP</span><span class="op" id="3769948">(</span><span class="ident" id="3769949">s</span><span class="op" id="3769950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769953">if</span>&nbsp;<span class="ident" id="3769956">x</span>&nbsp;<span class="op" id="3769958">==</span>&nbsp;<span class="builtintype" id="3769961">nil</span>&nbsp;<span class="op" id="3769965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3769969">return</span>&nbsp;<span class="op" id="3769976">&amp;</span><span class="ident" id="3769977">ParseError</span><span class="op" id="3769987">{</span><span class="string" id="3769988">&#34;IP&nbsp;address&#34;</span><span class="op" id="3770000">,</span>&nbsp;<span class="ident" id="3770002">s</span><span class="op" id="3770003">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3770006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3770009">*</span><span class="ident" id="3770010">ip</span>&nbsp;<span class="op" id="3770013">=</span>&nbsp;<span class="ident" id="3770015">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770018">return</span>&nbsp;<span class="builtintype" id="3770025">nil</span><br>
<span class="lineno"></span><span class="op" id="3770029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3770032">//&nbsp;Equal&nbsp;returns&nbsp;true&nbsp;if&nbsp;ip&nbsp;and&nbsp;x&nbsp;are&nbsp;the&nbsp;same&nbsp;IP&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="3770091">//&nbsp;An&nbsp;IPv4&nbsp;address&nbsp;and&nbsp;that&nbsp;same&nbsp;address&nbsp;in&nbsp;IPv6&nbsp;form&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3770149">//&nbsp;considered&nbsp;to&nbsp;be&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="3770176">func</span>&nbsp;<span class="op" id="3770181">(</span><span class="ident" id="3770182">ip</span>&nbsp;<span class="ident" id="3770185">IP</span><span class="op" id="3770187">)</span>&nbsp;<span class="ident" id="3770189">Equal</span><span class="op" id="3770194">(</span><span class="ident" id="3770195">x</span>&nbsp;<span class="ident" id="3770197">IP</span><span class="op" id="3770199">)</span>&nbsp;<span class="builtintype" id="3770201">bool</span>&nbsp;<span class="op" id="3770206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770209">if</span>&nbsp;<span class="builtinfunc" id="3770212">len</span><span class="op" id="3770215">(</span><span class="ident" id="3770216">ip</span><span class="op" id="3770218">)</span>&nbsp;<span class="op" id="3770220">==</span>&nbsp;<span class="builtinfunc" id="3770223">len</span><span class="op" id="3770226">(</span><span class="ident" id="3770227">x</span><span class="op" id="3770228">)</span>&nbsp;<span class="op" id="3770230">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770234">return</span>&nbsp;<span class="ident" id="3770241">bytesEqual</span><span class="op" id="3770251">(</span><span class="ident" id="3770252">ip</span><span class="op" id="3770254">,</span>&nbsp;<span class="ident" id="3770256">x</span><span class="op" id="3770257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3770260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770263">if</span>&nbsp;<span class="builtinfunc" id="3770266">len</span><span class="op" id="3770269">(</span><span class="ident" id="3770270">ip</span><span class="op" id="3770272">)</span>&nbsp;<span class="op" id="3770274">==</span>&nbsp;<span class="ident" id="3770277">IPv4len</span>&nbsp;<span class="op" id="3770285">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3770288">len</span><span class="op" id="3770291">(</span><span class="ident" id="3770292">x</span><span class="op" id="3770293">)</span>&nbsp;<span class="op" id="3770295">==</span>&nbsp;<span class="ident" id="3770298">IPv6len</span>&nbsp;<span class="op" id="3770306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770310">return</span>&nbsp;<span class="ident" id="3770317">bytesEqual</span><span class="op" id="3770327">(</span><span class="ident" id="3770328">x</span><span class="op" id="3770329">[</span><span class="num" id="3770330">0</span><span class="op" id="3770331">:</span><span class="num" id="3770332">12</span><span class="op" id="3770334">]</span><span class="op" id="3770335">,</span>&nbsp;<span class="ident" id="3770337">v4InV6Prefix</span><span class="op" id="3770349">)</span>&nbsp;<span class="op" id="3770351">&amp;&amp;</span>&nbsp;<span class="ident" id="3770354">bytesEqual</span><span class="op" id="3770364">(</span><span class="ident" id="3770365">ip</span><span class="op" id="3770367">,</span>&nbsp;<span class="ident" id="3770369">x</span><span class="op" id="3770370">[</span><span class="num" id="3770371">12</span><span class="op" id="3770373">:</span><span class="op" id="3770374">]</span><span class="op" id="3770375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3770378">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770381">if</span>&nbsp;<span class="builtinfunc" id="3770384">len</span><span class="op" id="3770387">(</span><span class="ident" id="3770388">ip</span><span class="op" id="3770390">)</span>&nbsp;<span class="op" id="3770392">==</span>&nbsp;<span class="ident" id="3770395">IPv6len</span>&nbsp;<span class="op" id="3770403">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3770406">len</span><span class="op" id="3770409">(</span><span class="ident" id="3770410">x</span><span class="op" id="3770411">)</span>&nbsp;<span class="op" id="3770413">==</span>&nbsp;<span class="ident" id="3770416">IPv4len</span>&nbsp;<span class="op" id="3770424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770428">return</span>&nbsp;<span class="ident" id="3770435">bytesEqual</span><span class="op" id="3770445">(</span><span class="ident" id="3770446">ip</span><span class="op" id="3770448">[</span><span class="num" id="3770449">0</span><span class="op" id="3770450">:</span><span class="num" id="3770451">12</span><span class="op" id="3770453">]</span><span class="op" id="3770454">,</span>&nbsp;<span class="ident" id="3770456">v4InV6Prefix</span><span class="op" id="3770468">)</span>&nbsp;<span class="op" id="3770470">&amp;&amp;</span>&nbsp;<span class="ident" id="3770473">bytesEqual</span><span class="op" id="3770483">(</span><span class="ident" id="3770484">ip</span><span class="op" id="3770486">[</span><span class="num" id="3770487">12</span><span class="op" id="3770489">:</span><span class="op" id="3770490">]</span><span class="op" id="3770491">,</span>&nbsp;<span class="ident" id="3770493">x</span><span class="op" id="3770494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3770497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770500">return</span>&nbsp;<span class="builtintype" id="3770507">false</span><br>
<span class="lineno"></span><span class="op" id="3770513">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="keyword" id="3770516">func</span>&nbsp;<span class="ident" id="3770521">bytesEqual</span><span class="op" id="3770531">(</span><span class="ident" id="3770532">x</span><span class="op" id="3770533">,</span>&nbsp;<span class="ident" id="3770535">y</span>&nbsp;<span class="op" id="3770537">[</span><span class="op" id="3770538">]</span><span class="builtintype" id="3770539">byte</span><span class="op" id="3770543">)</span>&nbsp;<span class="builtintype" id="3770545">bool</span>&nbsp;<span class="op" id="3770550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770553">if</span>&nbsp;<span class="builtinfunc" id="3770556">len</span><span class="op" id="3770559">(</span><span class="ident" id="3770560">x</span><span class="op" id="3770561">)</span>&nbsp;<span class="op" id="3770563">!=</span>&nbsp;<span class="builtinfunc" id="3770566">len</span><span class="op" id="3770569">(</span><span class="ident" id="3770570">y</span><span class="op" id="3770571">)</span>&nbsp;<span class="op" id="3770573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770577">return</span>&nbsp;<span class="builtintype" id="3770584">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3770591">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770594">for</span>&nbsp;<span class="ident" id="3770598">i</span><span class="op" id="3770599">,</span>&nbsp;<span class="ident" id="3770601">b</span>&nbsp;<span class="op" id="3770603">:=</span>&nbsp;<span class="keyword" id="3770606">range</span>&nbsp;<span class="ident" id="3770612">x</span>&nbsp;<span class="op" id="3770614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770618">if</span>&nbsp;<span class="ident" id="3770621">y</span><span class="op" id="3770622">[</span><span class="ident" id="3770623">i</span><span class="op" id="3770624">]</span>&nbsp;<span class="op" id="3770626">!=</span>&nbsp;<span class="ident" id="3770629">b</span>&nbsp;<span class="op" id="3770631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770636">return</span>&nbsp;<span class="builtintype" id="3770643">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3770651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3770654">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770657">return</span>&nbsp;<span class="builtintype" id="3770664">true</span><br>
<span class="lineno"></span><span class="op" id="3770669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3770672">//&nbsp;If&nbsp;mask&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;1&nbsp;bits&nbsp;followed&nbsp;by&nbsp;0&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3770727">//&nbsp;return&nbsp;the&nbsp;number&nbsp;of&nbsp;1&nbsp;bits.</span><br>
<span class="lineno">385</span><span class="keyword" id="3770759">func</span>&nbsp;<span class="ident" id="3770764">simpleMaskLength</span><span class="op" id="3770780">(</span><span class="ident" id="3770781">mask</span>&nbsp;<span class="ident" id="3770786">IPMask</span><span class="op" id="3770792">)</span>&nbsp;<span class="builtintype" id="3770794">int</span>&nbsp;<span class="op" id="3770798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770801">var</span>&nbsp;<span class="ident" id="3770805">n</span>&nbsp;<span class="builtintype" id="3770807">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770812">for</span>&nbsp;<span class="ident" id="3770816">i</span><span class="op" id="3770817">,</span>&nbsp;<span class="ident" id="3770819">v</span>&nbsp;<span class="op" id="3770821">:=</span>&nbsp;<span class="keyword" id="3770824">range</span>&nbsp;<span class="ident" id="3770830">mask</span>&nbsp;<span class="op" id="3770835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770839">if</span>&nbsp;<span class="ident" id="3770842">v</span>&nbsp;<span class="op" id="3770844">==</span>&nbsp;<span class="num" id="3770847">0xff</span>&nbsp;<span class="op" id="3770852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3770857">n</span>&nbsp;<span class="op" id="3770859">+=</span>&nbsp;<span class="num" id="3770862">8</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770867">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3770878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3770882">//&nbsp;found&nbsp;non-ff&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3770905">//&nbsp;count&nbsp;1&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770923">for</span>&nbsp;<span class="ident" id="3770927">v</span><span class="op" id="3770928">&amp;</span><span class="num" id="3770929">0x80</span>&nbsp;<span class="op" id="3770934">!=</span>&nbsp;<span class="num" id="3770937">0</span>&nbsp;<span class="op" id="3770939">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3770944">n</span><span class="op" id="3770945">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3770951">v</span>&nbsp;<span class="op" id="3770953">&lt;&lt;=</span>&nbsp;<span class="num" id="3770957">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3770961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3770965">//&nbsp;rest&nbsp;must&nbsp;be&nbsp;0&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3770990">if</span>&nbsp;<span class="ident" id="3770993">v</span>&nbsp;<span class="op" id="3770995">!=</span>&nbsp;<span class="num" id="3770998">0</span>&nbsp;<span class="op" id="3771000">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771005">return</span>&nbsp;<span class="op" id="3771012">-</span><span class="num" id="3771013">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3771017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771021">for</span>&nbsp;<span class="ident" id="3771025">i</span><span class="op" id="3771026">++</span><span class="op" id="3771028">;</span>&nbsp;<span class="ident" id="3771030">i</span>&nbsp;<span class="op" id="3771032">&lt;</span>&nbsp;<span class="builtinfunc" id="3771034">len</span><span class="op" id="3771037">(</span><span class="ident" id="3771038">mask</span><span class="op" id="3771042">)</span><span class="op" id="3771043">;</span>&nbsp;<span class="ident" id="3771045">i</span><span class="op" id="3771046">++</span>&nbsp;<span class="op" id="3771049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771054">if</span>&nbsp;<span class="ident" id="3771057">mask</span><span class="op" id="3771061">[</span><span class="ident" id="3771062">i</span><span class="op" id="3771063">]</span>&nbsp;<span class="op" id="3771065">!=</span>&nbsp;<span class="num" id="3771068">0</span>&nbsp;<span class="op" id="3771070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771076">return</span>&nbsp;<span class="op" id="3771083">-</span><span class="num" id="3771084">1</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3771089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3771093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771097">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3771104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771107">return</span>&nbsp;<span class="ident" id="3771114">n</span><br>
<span class="lineno">410</span><span class="op" id="3771116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3771119">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;leading&nbsp;ones&nbsp;and&nbsp;total&nbsp;bits&nbsp;in&nbsp;the&nbsp;mask.</span><br>
<span class="lineno"></span><span class="comment" id="3771190">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form--ones&nbsp;followed&nbsp;by&nbsp;zeros--then</span><br>
<span class="lineno"></span><span class="comment" id="3771264">//&nbsp;Size&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">415</span><span class="keyword" id="3771286">func</span>&nbsp;<span class="op" id="3771291">(</span><span class="ident" id="3771292">m</span>&nbsp;<span class="ident" id="3771294">IPMask</span><span class="op" id="3771300">)</span>&nbsp;<span class="ident" id="3771302">Size</span><span class="op" id="3771306">(</span><span class="op" id="3771307">)</span>&nbsp;<span class="op" id="3771309">(</span><span class="ident" id="3771310">ones</span><span class="op" id="3771314">,</span>&nbsp;<span class="ident" id="3771316">bits</span>&nbsp;<span class="builtintype" id="3771321">int</span><span class="op" id="3771324">)</span>&nbsp;<span class="op" id="3771326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3771329">ones</span><span class="op" id="3771333">,</span>&nbsp;<span class="ident" id="3771335">bits</span>&nbsp;<span class="op" id="3771340">=</span>&nbsp;<span class="ident" id="3771342">simpleMaskLength</span><span class="op" id="3771358">(</span><span class="ident" id="3771359">m</span><span class="op" id="3771360">)</span><span class="op" id="3771361">,</span>&nbsp;<span class="builtinfunc" id="3771363">len</span><span class="op" id="3771366">(</span><span class="ident" id="3771367">m</span><span class="op" id="3771368">)</span><span class="op" id="3771369">*</span><span class="num" id="3771370">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771373">if</span>&nbsp;<span class="ident" id="3771376">ones</span>&nbsp;<span class="op" id="3771381">==</span>&nbsp;<span class="op" id="3771384">-</span><span class="num" id="3771385">1</span>&nbsp;<span class="op" id="3771387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771391">return</span>&nbsp;<span class="num" id="3771398">0</span><span class="op" id="3771399">,</span>&nbsp;<span class="num" id="3771401">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3771404">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771407">return</span><br>
<span class="lineno"></span><span class="op" id="3771414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3771417">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;hexadecimal&nbsp;form&nbsp;of&nbsp;m,&nbsp;with&nbsp;no&nbsp;punctuation.</span><br>
<span class="lineno"></span><span class="keyword" id="3771483">func</span>&nbsp;<span class="op" id="3771488">(</span><span class="ident" id="3771489">m</span>&nbsp;<span class="ident" id="3771491">IPMask</span><span class="op" id="3771497">)</span>&nbsp;<span class="ident" id="3771499">String</span><span class="op" id="3771505">(</span><span class="op" id="3771506">)</span>&nbsp;<span class="builtintype" id="3771508">string</span>&nbsp;<span class="op" id="3771515">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771518">if</span>&nbsp;<span class="builtinfunc" id="3771521">len</span><span class="op" id="3771524">(</span><span class="ident" id="3771525">m</span><span class="op" id="3771526">)</span>&nbsp;<span class="op" id="3771528">==</span>&nbsp;<span class="num" id="3771531">0</span>&nbsp;<span class="op" id="3771533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771537">return</span>&nbsp;<span class="string" id="3771544">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3771553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3771556">buf</span>&nbsp;<span class="op" id="3771560">:=</span>&nbsp;<span class="builtinfunc" id="3771563">make</span><span class="op" id="3771567">(</span><span class="op" id="3771568">[</span><span class="op" id="3771569">]</span><span class="builtintype" id="3771570">byte</span><span class="op" id="3771574">,</span>&nbsp;<span class="builtinfunc" id="3771576">len</span><span class="op" id="3771579">(</span><span class="ident" id="3771580">m</span><span class="op" id="3771581">)</span><span class="op" id="3771582">*</span><span class="num" id="3771583">2</span><span class="op" id="3771584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771587">for</span>&nbsp;<span class="ident" id="3771591">i</span><span class="op" id="3771592">,</span>&nbsp;<span class="ident" id="3771594">b</span>&nbsp;<span class="op" id="3771596">:=</span>&nbsp;<span class="keyword" id="3771599">range</span>&nbsp;<span class="ident" id="3771605">m</span>&nbsp;<span class="op" id="3771607">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3771611">buf</span><span class="op" id="3771614">[</span><span class="ident" id="3771615">i</span><span class="op" id="3771616">*</span><span class="num" id="3771617">2</span><span class="op" id="3771618">]</span><span class="op" id="3771619">,</span>&nbsp;<span class="ident" id="3771621">buf</span><span class="op" id="3771624">[</span><span class="ident" id="3771625">i</span><span class="op" id="3771626">*</span><span class="num" id="3771627">2</span><span class="op" id="3771628">+</span><span class="num" id="3771629">1</span><span class="op" id="3771630">]</span>&nbsp;<span class="op" id="3771632">=</span>&nbsp;<span class="ident" id="3771634">hexDigit</span><span class="op" id="3771642">[</span><span class="ident" id="3771643">b</span><span class="op" id="3771644">&gt;&gt;</span><span class="num" id="3771646">4</span><span class="op" id="3771647">]</span><span class="op" id="3771648">,</span>&nbsp;<span class="ident" id="3771650">hexDigit</span><span class="op" id="3771658">[</span><span class="ident" id="3771659">b</span><span class="op" id="3771660">&amp;</span><span class="num" id="3771661">0xf</span><span class="op" id="3771664">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3771667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771670">return</span>&nbsp;<span class="builtintype" id="3771677">string</span><span class="op" id="3771683">(</span><span class="ident" id="3771684">buf</span><span class="op" id="3771687">)</span><br>
<span class="lineno"></span><span class="op" id="3771689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="3771692">func</span>&nbsp;<span class="ident" id="3771697">networkNumberAndMask</span><span class="op" id="3771717">(</span><span class="ident" id="3771718">n</span>&nbsp;<span class="op" id="3771720">*</span><span class="ident" id="3771721">IPNet</span><span class="op" id="3771726">)</span>&nbsp;<span class="op" id="3771728">(</span><span class="ident" id="3771729">ip</span>&nbsp;<span class="ident" id="3771732">IP</span><span class="op" id="3771734">,</span>&nbsp;<span class="ident" id="3771736">m</span>&nbsp;<span class="ident" id="3771738">IPMask</span><span class="op" id="3771744">)</span>&nbsp;<span class="op" id="3771746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771749">if</span>&nbsp;<span class="ident" id="3771752">ip</span>&nbsp;<span class="op" id="3771755">=</span>&nbsp;<span class="ident" id="3771757">n</span><span class="op" id="3771758">.</span><span class="ident" id="3771759">IP</span><span class="op" id="3771761">.</span><span class="ident" id="3771762">To4</span><span class="op" id="3771765">(</span><span class="op" id="3771766">)</span><span class="op" id="3771767">;</span>&nbsp;<span class="ident" id="3771769">ip</span>&nbsp;<span class="op" id="3771772">==</span>&nbsp;<span class="builtintype" id="3771775">nil</span>&nbsp;<span class="op" id="3771779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3771783">ip</span>&nbsp;<span class="op" id="3771786">=</span>&nbsp;<span class="ident" id="3771788">n</span><span class="op" id="3771789">.</span><span class="ident" id="3771790">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771795">if</span>&nbsp;<span class="builtinfunc" id="3771798">len</span><span class="op" id="3771801">(</span><span class="ident" id="3771802">ip</span><span class="op" id="3771804">)</span>&nbsp;<span class="op" id="3771806">!=</span>&nbsp;<span class="ident" id="3771809">IPv6len</span>&nbsp;<span class="op" id="3771817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771822">return</span>&nbsp;<span class="builtintype" id="3771829">nil</span><span class="op" id="3771832">,</span>&nbsp;<span class="builtintype" id="3771834">nil</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3771840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3771843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3771846">m</span>&nbsp;<span class="op" id="3771848">=</span>&nbsp;<span class="ident" id="3771850">n</span><span class="op" id="3771851">.</span><span class="ident" id="3771852">Mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771858">switch</span>&nbsp;<span class="builtinfunc" id="3771865">len</span><span class="op" id="3771868">(</span><span class="ident" id="3771869">m</span><span class="op" id="3771870">)</span>&nbsp;<span class="op" id="3771872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771875">case</span>&nbsp;<span class="ident" id="3771880">IPv4len</span><span class="op" id="3771887">:</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771891">if</span>&nbsp;<span class="builtinfunc" id="3771894">len</span><span class="op" id="3771897">(</span><span class="ident" id="3771898">ip</span><span class="op" id="3771900">)</span>&nbsp;<span class="op" id="3771902">!=</span>&nbsp;<span class="ident" id="3771905">IPv4len</span>&nbsp;<span class="op" id="3771913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771918">return</span>&nbsp;<span class="builtintype" id="3771925">nil</span><span class="op" id="3771928">,</span>&nbsp;<span class="builtintype" id="3771930">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3771936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771939">case</span>&nbsp;<span class="ident" id="3771944">IPv6len</span><span class="op" id="3771951">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771955">if</span>&nbsp;<span class="builtinfunc" id="3771958">len</span><span class="op" id="3771961">(</span><span class="ident" id="3771962">ip</span><span class="op" id="3771964">)</span>&nbsp;<span class="op" id="3771966">==</span>&nbsp;<span class="ident" id="3771969">IPv4len</span>&nbsp;<span class="op" id="3771977">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3771982">m</span>&nbsp;<span class="op" id="3771984">=</span>&nbsp;<span class="ident" id="3771986">m</span><span class="op" id="3771987">[</span><span class="num" id="3771988">12</span><span class="op" id="3771990">:</span><span class="op" id="3771991">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3771995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3771998">default</span><span class="op" id="3772005">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772009">return</span>&nbsp;<span class="builtintype" id="3772016">nil</span><span class="op" id="3772019">,</span>&nbsp;<span class="builtintype" id="3772021">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3772026">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772029">return</span><br>
<span class="lineno"></span><span class="op" id="3772036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3772039">//&nbsp;Contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;network&nbsp;includes&nbsp;ip.</span><br>
<span class="lineno"></span><span class="keyword" id="3772092">func</span>&nbsp;<span class="op" id="3772097">(</span><span class="ident" id="3772098">n</span>&nbsp;<span class="op" id="3772100">*</span><span class="ident" id="3772101">IPNet</span><span class="op" id="3772106">)</span>&nbsp;<span class="ident" id="3772108">Contains</span><span class="op" id="3772116">(</span><span class="ident" id="3772117">ip</span>&nbsp;<span class="ident" id="3772120">IP</span><span class="op" id="3772122">)</span>&nbsp;<span class="builtintype" id="3772124">bool</span>&nbsp;<span class="op" id="3772129">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3772132">nn</span><span class="op" id="3772134">,</span>&nbsp;<span class="ident" id="3772136">m</span>&nbsp;<span class="op" id="3772138">:=</span>&nbsp;<span class="ident" id="3772141">networkNumberAndMask</span><span class="op" id="3772161">(</span><span class="ident" id="3772162">n</span><span class="op" id="3772163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772166">if</span>&nbsp;<span class="ident" id="3772169">x</span>&nbsp;<span class="op" id="3772171">:=</span>&nbsp;<span class="ident" id="3772174">ip</span><span class="op" id="3772176">.</span><span class="ident" id="3772177">To4</span><span class="op" id="3772180">(</span><span class="op" id="3772181">)</span><span class="op" id="3772182">;</span>&nbsp;<span class="ident" id="3772184">x</span>&nbsp;<span class="op" id="3772186">!=</span>&nbsp;<span class="builtintype" id="3772189">nil</span>&nbsp;<span class="op" id="3772193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3772197">ip</span>&nbsp;<span class="op" id="3772200">=</span>&nbsp;<span class="ident" id="3772202">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3772205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3772208">l</span>&nbsp;<span class="op" id="3772210">:=</span>&nbsp;<span class="builtinfunc" id="3772213">len</span><span class="op" id="3772216">(</span><span class="ident" id="3772217">ip</span><span class="op" id="3772219">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772222">if</span>&nbsp;<span class="ident" id="3772225">l</span>&nbsp;<span class="op" id="3772227">!=</span>&nbsp;<span class="builtinfunc" id="3772230">len</span><span class="op" id="3772233">(</span><span class="ident" id="3772234">nn</span><span class="op" id="3772236">)</span>&nbsp;<span class="op" id="3772238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772242">return</span>&nbsp;<span class="builtintype" id="3772249">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3772256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772259">for</span>&nbsp;<span class="ident" id="3772263">i</span>&nbsp;<span class="op" id="3772265">:=</span>&nbsp;<span class="num" id="3772268">0</span><span class="op" id="3772269">;</span>&nbsp;<span class="ident" id="3772271">i</span>&nbsp;<span class="op" id="3772273">&lt;</span>&nbsp;<span class="ident" id="3772275">l</span><span class="op" id="3772276">;</span>&nbsp;<span class="ident" id="3772278">i</span><span class="op" id="3772279">++</span>&nbsp;<span class="op" id="3772282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772286">if</span>&nbsp;<span class="ident" id="3772289">nn</span><span class="op" id="3772291">[</span><span class="ident" id="3772292">i</span><span class="op" id="3772293">]</span><span class="op" id="3772294">&amp;</span><span class="ident" id="3772295">m</span><span class="op" id="3772296">[</span><span class="ident" id="3772297">i</span><span class="op" id="3772298">]</span>&nbsp;<span class="op" id="3772300">!=</span>&nbsp;<span class="ident" id="3772303">ip</span><span class="op" id="3772305">[</span><span class="ident" id="3772306">i</span><span class="op" id="3772307">]</span><span class="op" id="3772308">&amp;</span><span class="ident" id="3772309">m</span><span class="op" id="3772310">[</span><span class="ident" id="3772311">i</span><span class="op" id="3772312">]</span>&nbsp;<span class="op" id="3772314">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772319">return</span>&nbsp;<span class="builtintype" id="3772326">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3772334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3772337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772340">return</span>&nbsp;<span class="builtintype" id="3772347">true</span><br>
<span class="lineno"></span><span class="op" id="3772352">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="3772355">//&nbsp;Network&nbsp;returns&nbsp;the&nbsp;address&#39;s&nbsp;network&nbsp;name,&nbsp;&#34;ip+net&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3772412">func</span>&nbsp;<span class="op" id="3772417">(</span><span class="ident" id="3772418">n</span>&nbsp;<span class="op" id="3772420">*</span><span class="ident" id="3772421">IPNet</span><span class="op" id="3772426">)</span>&nbsp;<span class="ident" id="3772428">Network</span><span class="op" id="3772435">(</span><span class="op" id="3772436">)</span>&nbsp;<span class="builtintype" id="3772438">string</span>&nbsp;<span class="op" id="3772445">{</span>&nbsp;<span class="keyword" id="3772447">return</span>&nbsp;<span class="string" id="3772454">&#34;ip+net&#34;</span>&nbsp;<span class="op" id="3772463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3772466">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;CIDR&nbsp;notation&nbsp;of&nbsp;n&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;</span><br>
<span class="lineno">480</span><span class="comment" id="3772531">//&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3772590">//&nbsp;If&nbsp;the&nbsp;mask&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;canonical&nbsp;form,&nbsp;it&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3772650">//&nbsp;string&nbsp;which&nbsp;consists&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,&nbsp;followed&nbsp;by&nbsp;a&nbsp;slash</span><br>
<span class="lineno"></span><span class="comment" id="3772713">//&nbsp;character&nbsp;and&nbsp;a&nbsp;mask&nbsp;expressed&nbsp;as&nbsp;hexadecimal&nbsp;form&nbsp;with&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3772775">//&nbsp;punctuation&nbsp;like&nbsp;&#34;192.168.100.1/c000ff00&#34;.</span><br>
<span class="lineno">485</span><span class="keyword" id="3772821">func</span>&nbsp;<span class="op" id="3772826">(</span><span class="ident" id="3772827">n</span>&nbsp;<span class="op" id="3772829">*</span><span class="ident" id="3772830">IPNet</span><span class="op" id="3772835">)</span>&nbsp;<span class="ident" id="3772837">String</span><span class="op" id="3772843">(</span><span class="op" id="3772844">)</span>&nbsp;<span class="builtintype" id="3772846">string</span>&nbsp;<span class="op" id="3772853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3772856">nn</span><span class="op" id="3772858">,</span>&nbsp;<span class="ident" id="3772860">m</span>&nbsp;<span class="op" id="3772862">:=</span>&nbsp;<span class="ident" id="3772865">networkNumberAndMask</span><span class="op" id="3772885">(</span><span class="ident" id="3772886">n</span><span class="op" id="3772887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772890">if</span>&nbsp;<span class="ident" id="3772893">nn</span>&nbsp;<span class="op" id="3772896">==</span>&nbsp;<span class="builtintype" id="3772899">nil</span>&nbsp;<span class="op" id="3772903">||</span>&nbsp;<span class="ident" id="3772906">m</span>&nbsp;<span class="op" id="3772908">==</span>&nbsp;<span class="builtintype" id="3772911">nil</span>&nbsp;<span class="op" id="3772915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772919">return</span>&nbsp;<span class="string" id="3772926">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3772935">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3772938">l</span>&nbsp;<span class="op" id="3772940">:=</span>&nbsp;<span class="ident" id="3772943">simpleMaskLength</span><span class="op" id="3772959">(</span><span class="ident" id="3772960">m</span><span class="op" id="3772961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772964">if</span>&nbsp;<span class="ident" id="3772967">l</span>&nbsp;<span class="op" id="3772969">==</span>&nbsp;<span class="op" id="3772972">-</span><span class="num" id="3772973">1</span>&nbsp;<span class="op" id="3772975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3772979">return</span>&nbsp;<span class="ident" id="3772986">nn</span><span class="op" id="3772988">.</span><span class="ident" id="3772989">String</span><span class="op" id="3772995">(</span><span class="op" id="3772996">)</span>&nbsp;<span class="op" id="3772998">+</span>&nbsp;<span class="string" id="3773000">&#34;/&#34;</span>&nbsp;<span class="op" id="3773004">+</span>&nbsp;<span class="ident" id="3773006">m</span><span class="op" id="3773007">.</span><span class="ident" id="3773008">String</span><span class="op" id="3773014">(</span><span class="op" id="3773015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3773018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773021">return</span>&nbsp;<span class="ident" id="3773028">nn</span><span class="op" id="3773030">.</span><span class="ident" id="3773031">String</span><span class="op" id="3773037">(</span><span class="op" id="3773038">)</span>&nbsp;<span class="op" id="3773040">+</span>&nbsp;<span class="string" id="3773042">&#34;/&#34;</span>&nbsp;<span class="op" id="3773046">+</span>&nbsp;<span class="ident" id="3773048">itod</span><span class="op" id="3773052">(</span><span class="builtintype" id="3773053">uint</span><span class="op" id="3773057">(</span><span class="ident" id="3773058">l</span><span class="op" id="3773059">)</span><span class="op" id="3773060">)</span><br>
<span class="lineno">495</span><span class="op" id="3773062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3773065">//&nbsp;Parse&nbsp;IPv4&nbsp;address&nbsp;(d.d.d.d).</span><br>
<span class="lineno"></span><span class="keyword" id="3773098">func</span>&nbsp;<span class="ident" id="3773103">parseIPv4</span><span class="op" id="3773112">(</span><span class="ident" id="3773113">s</span>&nbsp;<span class="builtintype" id="3773115">string</span><span class="op" id="3773121">)</span>&nbsp;<span class="ident" id="3773123">IP</span>&nbsp;<span class="op" id="3773126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773129">var</span>&nbsp;<span class="ident" id="3773133">p</span>&nbsp;<span class="op" id="3773135">[</span><span class="ident" id="3773136">IPv4len</span><span class="op" id="3773143">]</span><span class="builtintype" id="3773144">byte</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3773150">i</span>&nbsp;<span class="op" id="3773152">:=</span>&nbsp;<span class="num" id="3773155">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773158">for</span>&nbsp;<span class="ident" id="3773162">j</span>&nbsp;<span class="op" id="3773164">:=</span>&nbsp;<span class="num" id="3773167">0</span><span class="op" id="3773168">;</span>&nbsp;<span class="ident" id="3773170">j</span>&nbsp;<span class="op" id="3773172">&lt;</span>&nbsp;<span class="ident" id="3773174">IPv4len</span><span class="op" id="3773181">;</span>&nbsp;<span class="ident" id="3773183">j</span><span class="op" id="3773184">++</span>&nbsp;<span class="op" id="3773187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773191">if</span>&nbsp;<span class="ident" id="3773194">i</span>&nbsp;<span class="op" id="3773196">&gt;=</span>&nbsp;<span class="builtinfunc" id="3773199">len</span><span class="op" id="3773202">(</span><span class="ident" id="3773203">s</span><span class="op" id="3773204">)</span>&nbsp;<span class="op" id="3773206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3773211">//&nbsp;Missing&nbsp;octets.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773233">return</span>&nbsp;<span class="builtintype" id="3773240">nil</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3773246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773250">if</span>&nbsp;<span class="ident" id="3773253">j</span>&nbsp;<span class="op" id="3773255">&gt;</span>&nbsp;<span class="num" id="3773257">0</span>&nbsp;<span class="op" id="3773259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773264">if</span>&nbsp;<span class="ident" id="3773267">s</span><span class="op" id="3773268">[</span><span class="ident" id="3773269">i</span><span class="op" id="3773270">]</span>&nbsp;<span class="op" id="3773272">!=</span>&nbsp;<span class="string" id="3773275">&#39;.&#39;</span>&nbsp;<span class="op" id="3773279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773285">return</span>&nbsp;<span class="builtintype" id="3773292">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3773299">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3773304">i</span><span class="op" id="3773305">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3773310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773314">var</span>&nbsp;<span class="op" id="3773318">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3773323">n</span>&nbsp;&nbsp;<span class="builtintype" id="3773326">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3773333">ok</span>&nbsp;<span class="builtintype" id="3773336">bool</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3773343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3773347">n</span><span class="op" id="3773348">,</span>&nbsp;<span class="ident" id="3773350">i</span><span class="op" id="3773351">,</span>&nbsp;<span class="ident" id="3773353">ok</span>&nbsp;<span class="op" id="3773356">=</span>&nbsp;<span class="ident" id="3773358">dtoi</span><span class="op" id="3773362">(</span><span class="ident" id="3773363">s</span><span class="op" id="3773364">,</span>&nbsp;<span class="ident" id="3773366">i</span><span class="op" id="3773367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773371">if</span>&nbsp;<span class="op" id="3773374">!</span><span class="ident" id="3773375">ok</span>&nbsp;<span class="op" id="3773378">||</span>&nbsp;<span class="ident" id="3773381">n</span>&nbsp;<span class="op" id="3773383">&gt;</span>&nbsp;<span class="num" id="3773385">0xFF</span>&nbsp;<span class="op" id="3773390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773395">return</span>&nbsp;<span class="builtintype" id="3773402">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3773408">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3773412">p</span><span class="op" id="3773413">[</span><span class="ident" id="3773414">j</span><span class="op" id="3773415">]</span>&nbsp;<span class="op" id="3773417">=</span>&nbsp;<span class="builtintype" id="3773419">byte</span><span class="op" id="3773423">(</span><span class="ident" id="3773424">n</span><span class="op" id="3773425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3773428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773431">if</span>&nbsp;<span class="ident" id="3773434">i</span>&nbsp;<span class="op" id="3773436">!=</span>&nbsp;<span class="builtinfunc" id="3773439">len</span><span class="op" id="3773442">(</span><span class="ident" id="3773443">s</span><span class="op" id="3773444">)</span>&nbsp;<span class="op" id="3773446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773450">return</span>&nbsp;<span class="builtintype" id="3773457">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3773462">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773465">return</span>&nbsp;<span class="ident" id="3773472">IPv4</span><span class="op" id="3773476">(</span><span class="ident" id="3773477">p</span><span class="op" id="3773478">[</span><span class="num" id="3773479">0</span><span class="op" id="3773480">]</span><span class="op" id="3773481">,</span>&nbsp;<span class="ident" id="3773483">p</span><span class="op" id="3773484">[</span><span class="num" id="3773485">1</span><span class="op" id="3773486">]</span><span class="op" id="3773487">,</span>&nbsp;<span class="ident" id="3773489">p</span><span class="op" id="3773490">[</span><span class="num" id="3773491">2</span><span class="op" id="3773492">]</span><span class="op" id="3773493">,</span>&nbsp;<span class="ident" id="3773495">p</span><span class="op" id="3773496">[</span><span class="num" id="3773497">3</span><span class="op" id="3773498">]</span><span class="op" id="3773499">)</span><br>
<span class="lineno"></span><span class="op" id="3773501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3773504">//&nbsp;parseIPv6&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;literal&nbsp;IPv6&nbsp;address&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4291</span><br>
<span class="lineno"></span><span class="comment" id="3773574">//&nbsp;and&nbsp;RFC&nbsp;5952.&nbsp;&nbsp;It&nbsp;can&nbsp;also&nbsp;parse&nbsp;a&nbsp;literal&nbsp;scoped&nbsp;IPv6&nbsp;address&nbsp;with</span><br>
<span class="lineno">530</span><span class="comment" id="3773645">//&nbsp;zone&nbsp;identifier&nbsp;which&nbsp;is&nbsp;described&nbsp;in&nbsp;RFC&nbsp;4007&nbsp;when&nbsp;zoneAllowed&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3773715">//&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3773724">func</span>&nbsp;<span class="ident" id="3773729">parseIPv6</span><span class="op" id="3773738">(</span><span class="ident" id="3773739">s</span>&nbsp;<span class="builtintype" id="3773741">string</span><span class="op" id="3773747">,</span>&nbsp;<span class="ident" id="3773749">zoneAllowed</span>&nbsp;<span class="builtintype" id="3773761">bool</span><span class="op" id="3773765">)</span>&nbsp;<span class="op" id="3773767">(</span><span class="ident" id="3773768">ip</span>&nbsp;<span class="ident" id="3773771">IP</span><span class="op" id="3773773">,</span>&nbsp;<span class="ident" id="3773775">zone</span>&nbsp;<span class="builtintype" id="3773780">string</span><span class="op" id="3773786">)</span>&nbsp;<span class="op" id="3773788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3773791">ip</span>&nbsp;<span class="op" id="3773794">=</span>&nbsp;<span class="builtinfunc" id="3773796">make</span><span class="op" id="3773800">(</span><span class="ident" id="3773801">IP</span><span class="op" id="3773803">,</span>&nbsp;<span class="ident" id="3773805">IPv6len</span><span class="op" id="3773812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3773815">ellipsis</span>&nbsp;<span class="op" id="3773824">:=</span>&nbsp;<span class="op" id="3773827">-</span><span class="num" id="3773828">1</span>&nbsp;<span class="comment" id="3773830">//&nbsp;position&nbsp;of&nbsp;ellipsis&nbsp;in&nbsp;p</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3773860">i</span>&nbsp;<span class="op" id="3773862">:=</span>&nbsp;<span class="num" id="3773865">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3773875">//&nbsp;index&nbsp;in&nbsp;string&nbsp;s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773898">if</span>&nbsp;<span class="ident" id="3773901">zoneAllowed</span>&nbsp;<span class="op" id="3773913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3773917">s</span><span class="op" id="3773918">,</span>&nbsp;<span class="ident" id="3773920">zone</span>&nbsp;<span class="op" id="3773925">=</span>&nbsp;<span class="ident" id="3773927">splitHostZone</span><span class="op" id="3773940">(</span><span class="ident" id="3773941">s</span><span class="op" id="3773942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3773945">}</span><br>
<span class="lineno">540</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3773949">//&nbsp;Might&nbsp;have&nbsp;leading&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3773981">if</span>&nbsp;<span class="builtinfunc" id="3773984">len</span><span class="op" id="3773987">(</span><span class="ident" id="3773988">s</span><span class="op" id="3773989">)</span>&nbsp;<span class="op" id="3773991">&gt;=</span>&nbsp;<span class="num" id="3773994">2</span>&nbsp;<span class="op" id="3773996">&amp;&amp;</span>&nbsp;<span class="ident" id="3773999">s</span><span class="op" id="3774000">[</span><span class="num" id="3774001">0</span><span class="op" id="3774002">]</span>&nbsp;<span class="op" id="3774004">==</span>&nbsp;<span class="string" id="3774007">&#39;:&#39;</span>&nbsp;<span class="op" id="3774011">&amp;&amp;</span>&nbsp;<span class="ident" id="3774014">s</span><span class="op" id="3774015">[</span><span class="num" id="3774016">1</span><span class="op" id="3774017">]</span>&nbsp;<span class="op" id="3774019">==</span>&nbsp;<span class="string" id="3774022">&#39;:&#39;</span>&nbsp;<span class="op" id="3774026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774030">ellipsis</span>&nbsp;<span class="op" id="3774039">=</span>&nbsp;<span class="num" id="3774041">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774045">i</span>&nbsp;<span class="op" id="3774047">=</span>&nbsp;<span class="num" id="3774049">2</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3774053">//&nbsp;Might&nbsp;be&nbsp;only&nbsp;ellipsis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774081">if</span>&nbsp;<span class="ident" id="3774084">i</span>&nbsp;<span class="op" id="3774086">==</span>&nbsp;<span class="builtinfunc" id="3774089">len</span><span class="op" id="3774092">(</span><span class="ident" id="3774093">s</span><span class="op" id="3774094">)</span>&nbsp;<span class="op" id="3774096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774101">return</span>&nbsp;<span class="ident" id="3774108">ip</span><span class="op" id="3774110">,</span>&nbsp;<span class="ident" id="3774112">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3774119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3774122">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3774126">//&nbsp;Loop,&nbsp;parsing&nbsp;hex&nbsp;numbers&nbsp;followed&nbsp;by&nbsp;colon.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774175">j</span>&nbsp;<span class="op" id="3774177">:=</span>&nbsp;<span class="num" id="3774180">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774183">for</span>&nbsp;<span class="ident" id="3774187">j</span>&nbsp;<span class="op" id="3774189">&lt;</span>&nbsp;<span class="ident" id="3774191">IPv6len</span>&nbsp;<span class="op" id="3774199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3774203">//&nbsp;Hex&nbsp;number.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774220">n</span><span class="op" id="3774221">,</span>&nbsp;<span class="ident" id="3774223">i1</span><span class="op" id="3774225">,</span>&nbsp;<span class="ident" id="3774227">ok</span>&nbsp;<span class="op" id="3774230">:=</span>&nbsp;<span class="ident" id="3774233">xtoi</span><span class="op" id="3774237">(</span><span class="ident" id="3774238">s</span><span class="op" id="3774239">,</span>&nbsp;<span class="ident" id="3774241">i</span><span class="op" id="3774242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774246">if</span>&nbsp;<span class="op" id="3774249">!</span><span class="ident" id="3774250">ok</span>&nbsp;<span class="op" id="3774253">||</span>&nbsp;<span class="ident" id="3774256">n</span>&nbsp;<span class="op" id="3774258">&gt;</span>&nbsp;<span class="num" id="3774260">0xFFFF</span>&nbsp;<span class="op" id="3774267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774272">return</span>&nbsp;<span class="builtintype" id="3774279">nil</span><span class="op" id="3774282">,</span>&nbsp;<span class="ident" id="3774284">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3774291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3774296">//&nbsp;If&nbsp;followed&nbsp;by&nbsp;dot,&nbsp;might&nbsp;be&nbsp;in&nbsp;trailing&nbsp;IPv4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774348">if</span>&nbsp;<span class="ident" id="3774351">i1</span>&nbsp;<span class="op" id="3774354">&lt;</span>&nbsp;<span class="builtinfunc" id="3774356">len</span><span class="op" id="3774359">(</span><span class="ident" id="3774360">s</span><span class="op" id="3774361">)</span>&nbsp;<span class="op" id="3774363">&amp;&amp;</span>&nbsp;<span class="ident" id="3774366">s</span><span class="op" id="3774367">[</span><span class="ident" id="3774368">i1</span><span class="op" id="3774370">]</span>&nbsp;<span class="op" id="3774372">==</span>&nbsp;<span class="string" id="3774375">&#39;.&#39;</span>&nbsp;<span class="op" id="3774379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774384">if</span>&nbsp;<span class="ident" id="3774387">ellipsis</span>&nbsp;<span class="op" id="3774396">&lt;</span>&nbsp;<span class="num" id="3774398">0</span>&nbsp;<span class="op" id="3774400">&amp;&amp;</span>&nbsp;<span class="ident" id="3774403">j</span>&nbsp;<span class="op" id="3774405">!=</span>&nbsp;<span class="ident" id="3774408">IPv6len</span><span class="op" id="3774415">-</span><span class="ident" id="3774416">IPv4len</span>&nbsp;<span class="op" id="3774424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3774430">//&nbsp;Not&nbsp;the&nbsp;right&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774458">return</span>&nbsp;<span class="builtintype" id="3774465">nil</span><span class="op" id="3774468">,</span>&nbsp;<span class="ident" id="3774470">zone</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3774478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774483">if</span>&nbsp;<span class="ident" id="3774486">j</span><span class="op" id="3774487">+</span><span class="ident" id="3774488">IPv4len</span>&nbsp;<span class="op" id="3774496">&gt;</span>&nbsp;<span class="ident" id="3774498">IPv6len</span>&nbsp;<span class="op" id="3774506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3774512">//&nbsp;Not&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774536">return</span>&nbsp;<span class="builtintype" id="3774543">nil</span><span class="op" id="3774546">,</span>&nbsp;<span class="ident" id="3774548">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3774556">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774561">ip4</span>&nbsp;<span class="op" id="3774565">:=</span>&nbsp;<span class="ident" id="3774568">parseIPv4</span><span class="op" id="3774577">(</span><span class="ident" id="3774578">s</span><span class="op" id="3774579">[</span><span class="ident" id="3774580">i</span><span class="op" id="3774581">:</span><span class="op" id="3774582">]</span><span class="op" id="3774583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774588">if</span>&nbsp;<span class="ident" id="3774591">ip4</span>&nbsp;<span class="op" id="3774595">==</span>&nbsp;<span class="builtintype" id="3774598">nil</span>&nbsp;<span class="op" id="3774602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774608">return</span>&nbsp;<span class="builtintype" id="3774615">nil</span><span class="op" id="3774618">,</span>&nbsp;<span class="ident" id="3774620">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3774628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774633">ip</span><span class="op" id="3774635">[</span><span class="ident" id="3774636">j</span><span class="op" id="3774637">]</span>&nbsp;<span class="op" id="3774639">=</span>&nbsp;<span class="ident" id="3774641">ip4</span><span class="op" id="3774644">[</span><span class="num" id="3774645">12</span><span class="op" id="3774647">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774652">ip</span><span class="op" id="3774654">[</span><span class="ident" id="3774655">j</span><span class="op" id="3774656">+</span><span class="num" id="3774657">1</span><span class="op" id="3774658">]</span>&nbsp;<span class="op" id="3774660">=</span>&nbsp;<span class="ident" id="3774662">ip4</span><span class="op" id="3774665">[</span><span class="num" id="3774666">13</span><span class="op" id="3774668">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774673">ip</span><span class="op" id="3774675">[</span><span class="ident" id="3774676">j</span><span class="op" id="3774677">+</span><span class="num" id="3774678">2</span><span class="op" id="3774679">]</span>&nbsp;<span class="op" id="3774681">=</span>&nbsp;<span class="ident" id="3774683">ip4</span><span class="op" id="3774686">[</span><span class="num" id="3774687">14</span><span class="op" id="3774689">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774694">ip</span><span class="op" id="3774696">[</span><span class="ident" id="3774697">j</span><span class="op" id="3774698">+</span><span class="num" id="3774699">3</span><span class="op" id="3774700">]</span>&nbsp;<span class="op" id="3774702">=</span>&nbsp;<span class="ident" id="3774704">ip4</span><span class="op" id="3774707">[</span><span class="num" id="3774708">15</span><span class="op" id="3774710">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774715">i</span>&nbsp;<span class="op" id="3774717">=</span>&nbsp;<span class="builtinfunc" id="3774719">len</span><span class="op" id="3774722">(</span><span class="ident" id="3774723">s</span><span class="op" id="3774724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774729">j</span>&nbsp;<span class="op" id="3774731">+=</span>&nbsp;<span class="ident" id="3774734">IPv4len</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774745">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3774753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3774758">//&nbsp;Save&nbsp;this&nbsp;16-bit&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774787">ip</span><span class="op" id="3774789">[</span><span class="ident" id="3774790">j</span><span class="op" id="3774791">]</span>&nbsp;<span class="op" id="3774793">=</span>&nbsp;<span class="builtintype" id="3774795">byte</span><span class="op" id="3774799">(</span><span class="ident" id="3774800">n</span>&nbsp;<span class="op" id="3774802">&gt;&gt;</span>&nbsp;<span class="num" id="3774805">8</span><span class="op" id="3774806">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774810">ip</span><span class="op" id="3774812">[</span><span class="ident" id="3774813">j</span><span class="op" id="3774814">+</span><span class="num" id="3774815">1</span><span class="op" id="3774816">]</span>&nbsp;<span class="op" id="3774818">=</span>&nbsp;<span class="builtintype" id="3774820">byte</span><span class="op" id="3774824">(</span><span class="ident" id="3774825">n</span><span class="op" id="3774826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774830">j</span>&nbsp;<span class="op" id="3774832">+=</span>&nbsp;<span class="num" id="3774835">2</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3774840">//&nbsp;Stop&nbsp;at&nbsp;end&nbsp;of&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3774868">i</span>&nbsp;<span class="op" id="3774870">=</span>&nbsp;<span class="ident" id="3774872">i1</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774877">if</span>&nbsp;<span class="ident" id="3774880">i</span>&nbsp;<span class="op" id="3774882">==</span>&nbsp;<span class="builtinfunc" id="3774885">len</span><span class="op" id="3774888">(</span><span class="ident" id="3774889">s</span><span class="op" id="3774890">)</span>&nbsp;<span class="op" id="3774892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774897">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3774905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3774910">//&nbsp;Otherwise&nbsp;must&nbsp;be&nbsp;followed&nbsp;by&nbsp;colon&nbsp;and&nbsp;more.</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774961">if</span>&nbsp;<span class="ident" id="3774964">s</span><span class="op" id="3774965">[</span><span class="ident" id="3774966">i</span><span class="op" id="3774967">]</span>&nbsp;<span class="op" id="3774969">!=</span>&nbsp;<span class="string" id="3774972">&#39;:&#39;</span>&nbsp;<span class="op" id="3774976">||</span>&nbsp;<span class="ident" id="3774979">i</span><span class="op" id="3774980">+</span><span class="num" id="3774981">1</span>&nbsp;<span class="op" id="3774983">==</span>&nbsp;<span class="builtinfunc" id="3774986">len</span><span class="op" id="3774989">(</span><span class="ident" id="3774990">s</span><span class="op" id="3774991">)</span>&nbsp;<span class="op" id="3774993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3774998">return</span>&nbsp;<span class="builtintype" id="3775005">nil</span><span class="op" id="3775008">,</span>&nbsp;<span class="ident" id="3775010">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3775017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3775021">i</span><span class="op" id="3775022">++</span><br>
<span class="lineno"></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3775028">//&nbsp;Look&nbsp;for&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775052">if</span>&nbsp;<span class="ident" id="3775055">s</span><span class="op" id="3775056">[</span><span class="ident" id="3775057">i</span><span class="op" id="3775058">]</span>&nbsp;<span class="op" id="3775060">==</span>&nbsp;<span class="string" id="3775063">&#39;:&#39;</span>&nbsp;<span class="op" id="3775067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775072">if</span>&nbsp;<span class="ident" id="3775075">ellipsis</span>&nbsp;<span class="op" id="3775084">&gt;=</span>&nbsp;<span class="num" id="3775087">0</span>&nbsp;<span class="op" id="3775089">{</span>&nbsp;<span class="comment" id="3775091">//&nbsp;already&nbsp;have&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775115">return</span>&nbsp;<span class="builtintype" id="3775122">nil</span><span class="op" id="3775125">,</span>&nbsp;<span class="ident" id="3775127">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3775135">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3775140">ellipsis</span>&nbsp;<span class="op" id="3775149">=</span>&nbsp;<span class="ident" id="3775151">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775156">if</span>&nbsp;<span class="ident" id="3775159">i</span><span class="op" id="3775160">++</span><span class="op" id="3775162">;</span>&nbsp;<span class="ident" id="3775164">i</span>&nbsp;<span class="op" id="3775166">==</span>&nbsp;<span class="builtinfunc" id="3775169">len</span><span class="op" id="3775172">(</span><span class="ident" id="3775173">s</span><span class="op" id="3775174">)</span>&nbsp;<span class="op" id="3775176">{</span>&nbsp;<span class="comment" id="3775178">//&nbsp;can&nbsp;be&nbsp;at&nbsp;end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775199">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3775208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3775212">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3775215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3775219">//&nbsp;Must&nbsp;have&nbsp;used&nbsp;entire&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775253">if</span>&nbsp;<span class="ident" id="3775256">i</span>&nbsp;<span class="op" id="3775258">!=</span>&nbsp;<span class="builtinfunc" id="3775261">len</span><span class="op" id="3775264">(</span><span class="ident" id="3775265">s</span><span class="op" id="3775266">)</span>&nbsp;<span class="op" id="3775268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775272">return</span>&nbsp;<span class="builtintype" id="3775279">nil</span><span class="op" id="3775282">,</span>&nbsp;<span class="ident" id="3775284">zone</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3775290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3775294">//&nbsp;If&nbsp;didn&#39;t&nbsp;parse&nbsp;enough,&nbsp;expand&nbsp;ellipsis.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775339">if</span>&nbsp;<span class="ident" id="3775342">j</span>&nbsp;<span class="op" id="3775344">&lt;</span>&nbsp;<span class="ident" id="3775346">IPv6len</span>&nbsp;<span class="op" id="3775354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775358">if</span>&nbsp;<span class="ident" id="3775361">ellipsis</span>&nbsp;<span class="op" id="3775370">&lt;</span>&nbsp;<span class="num" id="3775372">0</span>&nbsp;<span class="op" id="3775374">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775379">return</span>&nbsp;<span class="builtintype" id="3775386">nil</span><span class="op" id="3775389">,</span>&nbsp;<span class="ident" id="3775391">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3775398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3775402">n</span>&nbsp;<span class="op" id="3775404">:=</span>&nbsp;<span class="ident" id="3775407">IPv6len</span>&nbsp;<span class="op" id="3775415">-</span>&nbsp;<span class="ident" id="3775417">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775421">for</span>&nbsp;<span class="ident" id="3775425">k</span>&nbsp;<span class="op" id="3775427">:=</span>&nbsp;<span class="ident" id="3775430">j</span>&nbsp;<span class="op" id="3775432">-</span>&nbsp;<span class="num" id="3775434">1</span><span class="op" id="3775435">;</span>&nbsp;<span class="ident" id="3775437">k</span>&nbsp;<span class="op" id="3775439">&gt;=</span>&nbsp;<span class="ident" id="3775442">ellipsis</span><span class="op" id="3775450">;</span>&nbsp;<span class="ident" id="3775452">k</span><span class="op" id="3775453">--</span>&nbsp;<span class="op" id="3775456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3775461">ip</span><span class="op" id="3775463">[</span><span class="ident" id="3775464">k</span><span class="op" id="3775465">+</span><span class="ident" id="3775466">n</span><span class="op" id="3775467">]</span>&nbsp;<span class="op" id="3775469">=</span>&nbsp;<span class="ident" id="3775471">ip</span><span class="op" id="3775473">[</span><span class="ident" id="3775474">k</span><span class="op" id="3775475">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3775479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775483">for</span>&nbsp;<span class="ident" id="3775487">k</span>&nbsp;<span class="op" id="3775489">:=</span>&nbsp;<span class="ident" id="3775492">ellipsis</span>&nbsp;<span class="op" id="3775501">+</span>&nbsp;<span class="ident" id="3775503">n</span>&nbsp;<span class="op" id="3775505">-</span>&nbsp;<span class="num" id="3775507">1</span><span class="op" id="3775508">;</span>&nbsp;<span class="ident" id="3775510">k</span>&nbsp;<span class="op" id="3775512">&gt;=</span>&nbsp;<span class="ident" id="3775515">ellipsis</span><span class="op" id="3775523">;</span>&nbsp;<span class="ident" id="3775525">k</span><span class="op" id="3775526">--</span>&nbsp;<span class="op" id="3775529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3775534">ip</span><span class="op" id="3775536">[</span><span class="ident" id="3775537">k</span><span class="op" id="3775538">]</span>&nbsp;<span class="op" id="3775540">=</span>&nbsp;<span class="num" id="3775542">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3775546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3775549">}</span>&nbsp;<span class="keyword" id="3775551">else</span>&nbsp;<span class="keyword" id="3775556">if</span>&nbsp;<span class="ident" id="3775559">ellipsis</span>&nbsp;<span class="op" id="3775568">&gt;=</span>&nbsp;<span class="num" id="3775571">0</span>&nbsp;<span class="op" id="3775573">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3775577">//&nbsp;Ellipsis&nbsp;must&nbsp;represent&nbsp;at&nbsp;least&nbsp;one&nbsp;0&nbsp;group.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775628">return</span>&nbsp;<span class="builtintype" id="3775635">nil</span><span class="op" id="3775638">,</span>&nbsp;<span class="ident" id="3775640">zone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3775646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775649">return</span>&nbsp;<span class="ident" id="3775656">ip</span><span class="op" id="3775658">,</span>&nbsp;<span class="ident" id="3775660">zone</span><br>
<span class="lineno"></span><span class="op" id="3775665">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="3775668">//&nbsp;A&nbsp;ParseError&nbsp;represents&nbsp;a&nbsp;malformed&nbsp;text&nbsp;string&nbsp;and&nbsp;the&nbsp;type&nbsp;of&nbsp;string&nbsp;that&nbsp;was&nbsp;expected.</span><br>
<span class="lineno"></span><span class="keyword" id="3775761">type</span>&nbsp;<span class="ident" id="3775766">ParseError</span>&nbsp;<span class="keyword" id="3775777">struct</span>&nbsp;<span class="op" id="3775784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3775787">Type</span>&nbsp;<span class="builtintype" id="3775792">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3775800">Text</span>&nbsp;<span class="builtintype" id="3775805">string</span><br>
<span class="lineno">640</span><span class="op" id="3775812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3775815">func</span>&nbsp;<span class="op" id="3775820">(</span><span class="ident" id="3775821">e</span>&nbsp;<span class="op" id="3775823">*</span><span class="ident" id="3775824">ParseError</span><span class="op" id="3775834">)</span>&nbsp;<span class="ident" id="3775836">Error</span><span class="op" id="3775841">(</span><span class="op" id="3775842">)</span>&nbsp;<span class="builtintype" id="3775844">string</span>&nbsp;<span class="op" id="3775851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3775854">return</span>&nbsp;<span class="string" id="3775861">&#34;invalid&nbsp;&#34;</span>&nbsp;<span class="op" id="3775872">+</span>&nbsp;<span class="ident" id="3775874">e</span><span class="op" id="3775875">.</span><span class="ident" id="3775876">Type</span>&nbsp;<span class="op" id="3775881">+</span>&nbsp;<span class="string" id="3775883">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3775888">+</span>&nbsp;<span class="ident" id="3775890">e</span><span class="op" id="3775891">.</span><span class="ident" id="3775892">Text</span><br>
<span class="lineno"></span><span class="op" id="3775897">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span><span class="comment" id="3775900">//&nbsp;ParseIP&nbsp;parses&nbsp;s&nbsp;as&nbsp;an&nbsp;IP&nbsp;address,&nbsp;returning&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="comment" id="3775960">//&nbsp;The&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;in&nbsp;dotted&nbsp;decimal&nbsp;(&#34;74.125.19.99&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3776018">//&nbsp;or&nbsp;IPv6&nbsp;(&#34;2001:4860:0:2001::68&#34;)&nbsp;form.</span><br>
<span class="lineno"></span><span class="comment" id="3776060">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;textual&nbsp;representation&nbsp;of&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno">650</span><span class="comment" id="3776124">//&nbsp;ParseIP&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3776148">func</span>&nbsp;<span class="ident" id="3776153">ParseIP</span><span class="op" id="3776160">(</span><span class="ident" id="3776161">s</span>&nbsp;<span class="builtintype" id="3776163">string</span><span class="op" id="3776169">)</span>&nbsp;<span class="ident" id="3776171">IP</span>&nbsp;<span class="op" id="3776174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3776177">for</span>&nbsp;<span class="ident" id="3776181">i</span>&nbsp;<span class="op" id="3776183">:=</span>&nbsp;<span class="num" id="3776186">0</span><span class="op" id="3776187">;</span>&nbsp;<span class="ident" id="3776189">i</span>&nbsp;<span class="op" id="3776191">&lt;</span>&nbsp;<span class="builtinfunc" id="3776193">len</span><span class="op" id="3776196">(</span><span class="ident" id="3776197">s</span><span class="op" id="3776198">)</span><span class="op" id="3776199">;</span>&nbsp;<span class="ident" id="3776201">i</span><span class="op" id="3776202">++</span>&nbsp;<span class="op" id="3776205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3776209">switch</span>&nbsp;<span class="ident" id="3776216">s</span><span class="op" id="3776217">[</span><span class="ident" id="3776218">i</span><span class="op" id="3776219">]</span>&nbsp;<span class="op" id="3776221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3776225">case</span>&nbsp;<span class="string" id="3776230">&#39;.&#39;</span><span class="op" id="3776233">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3776238">return</span>&nbsp;<span class="ident" id="3776245">parseIPv4</span><span class="op" id="3776254">(</span><span class="ident" id="3776255">s</span><span class="op" id="3776256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3776260">case</span>&nbsp;<span class="string" id="3776265">&#39;:&#39;</span><span class="op" id="3776268">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3776273">ip</span><span class="op" id="3776275">,</span>&nbsp;<span class="ident" id="3776277">_</span>&nbsp;<span class="op" id="3776279">:=</span>&nbsp;<span class="ident" id="3776282">parseIPv6</span><span class="op" id="3776291">(</span><span class="ident" id="3776292">s</span><span class="op" id="3776293">,</span>&nbsp;<span class="builtintype" id="3776295">false</span><span class="op" id="3776300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3776305">return</span>&nbsp;<span class="ident" id="3776312">ip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3776317">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3776320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3776323">return</span>&nbsp;<span class="builtintype" id="3776330">nil</span><br>
<span class="lineno"></span><span class="op" id="3776334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3776337">//&nbsp;ParseCIDR&nbsp;parses&nbsp;s&nbsp;as&nbsp;a&nbsp;CIDR&nbsp;notation&nbsp;IP&nbsp;address&nbsp;and&nbsp;mask,</span><br>
<span class="lineno">665</span><span class="comment" id="3776399">//&nbsp;like&nbsp;&#34;192.168.100.1/24&#34;&nbsp;or&nbsp;&#34;2001:DB8::/48&#34;,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3776460">//&nbsp;RFC&nbsp;4632&nbsp;and&nbsp;RFC&nbsp;4291.</span><br>
<span class="lineno"></span><span class="comment" id="3776486">//</span><br>
<span class="lineno"></span><span class="comment" id="3776489">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;IP&nbsp;address&nbsp;and&nbsp;the&nbsp;network&nbsp;implied&nbsp;by&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="3776552">//&nbsp;and&nbsp;mask.&nbsp;&nbsp;For&nbsp;example,&nbsp;ParseCIDR(&#34;192.168.100.1/16&#34;)&nbsp;returns</span><br>
<span class="lineno">670</span><span class="comment" id="3776617">//&nbsp;the&nbsp;IP&nbsp;address&nbsp;192.168.100.1&nbsp;and&nbsp;the&nbsp;network&nbsp;192.168.0.0/16.</span><br>
<span class="lineno"></span><span class="keyword" id="3776681">func</span>&nbsp;<span class="ident" id="3776686">ParseCIDR</span><span class="op" id="3776695">(</span><span class="ident" id="3776696">s</span>&nbsp;<span class="builtintype" id="3776698">string</span><span class="op" id="3776704">)</span>&nbsp;<span class="op" id="3776706">(</span><span class="ident" id="3776707">IP</span><span class="op" id="3776709">,</span>&nbsp;<span class="op" id="3776711">*</span><span class="ident" id="3776712">IPNet</span><span class="op" id="3776717">,</span>&nbsp;<span class="builtintype" id="3776719">error</span><span class="op" id="3776724">)</span>&nbsp;<span class="op" id="3776726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3776729">i</span>&nbsp;<span class="op" id="3776731">:=</span>&nbsp;<span class="ident" id="3776734">byteIndex</span><span class="op" id="3776743">(</span><span class="ident" id="3776744">s</span><span class="op" id="3776745">,</span>&nbsp;<span class="string" id="3776747">&#39;/&#39;</span><span class="op" id="3776750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3776753">if</span>&nbsp;<span class="ident" id="3776756">i</span>&nbsp;<span class="op" id="3776758">&lt;</span>&nbsp;<span class="num" id="3776760">0</span>&nbsp;<span class="op" id="3776762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3776766">return</span>&nbsp;<span class="builtintype" id="3776773">nil</span><span class="op" id="3776776">,</span>&nbsp;<span class="builtintype" id="3776778">nil</span><span class="op" id="3776781">,</span>&nbsp;<span class="op" id="3776783">&amp;</span><span class="ident" id="3776784">ParseError</span><span class="op" id="3776794">{</span><span class="string" id="3776795">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3776809">,</span>&nbsp;<span class="ident" id="3776811">s</span><span class="op" id="3776812">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3776815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3776818">addr</span><span class="op" id="3776822">,</span>&nbsp;<span class="ident" id="3776824">mask</span>&nbsp;<span class="op" id="3776829">:=</span>&nbsp;<span class="ident" id="3776832">s</span><span class="op" id="3776833">[</span><span class="op" id="3776834">:</span><span class="ident" id="3776835">i</span><span class="op" id="3776836">]</span><span class="op" id="3776837">,</span>&nbsp;<span class="ident" id="3776839">s</span><span class="op" id="3776840">[</span><span class="ident" id="3776841">i</span><span class="op" id="3776842">+</span><span class="num" id="3776843">1</span><span class="op" id="3776844">:</span><span class="op" id="3776845">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3776848">iplen</span>&nbsp;<span class="op" id="3776854">:=</span>&nbsp;<span class="ident" id="3776857">IPv4len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3776866">ip</span>&nbsp;<span class="op" id="3776869">:=</span>&nbsp;<span class="ident" id="3776872">parseIPv4</span><span class="op" id="3776881">(</span><span class="ident" id="3776882">addr</span><span class="op" id="3776886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3776889">if</span>&nbsp;<span class="ident" id="3776892">ip</span>&nbsp;<span class="op" id="3776895">==</span>&nbsp;<span class="builtintype" id="3776898">nil</span>&nbsp;<span class="op" id="3776902">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3776906">iplen</span>&nbsp;<span class="op" id="3776912">=</span>&nbsp;<span class="ident" id="3776914">IPv6len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3776924">ip</span><span class="op" id="3776926">,</span>&nbsp;<span class="ident" id="3776928">_</span>&nbsp;<span class="op" id="3776930">=</span>&nbsp;<span class="ident" id="3776932">parseIPv6</span><span class="op" id="3776941">(</span><span class="ident" id="3776942">addr</span><span class="op" id="3776946">,</span>&nbsp;<span class="builtintype" id="3776948">false</span><span class="op" id="3776953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3776956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3776959">n</span><span class="op" id="3776960">,</span>&nbsp;<span class="ident" id="3776962">i</span><span class="op" id="3776963">,</span>&nbsp;<span class="ident" id="3776965">ok</span>&nbsp;<span class="op" id="3776968">:=</span>&nbsp;<span class="ident" id="3776971">dtoi</span><span class="op" id="3776975">(</span><span class="ident" id="3776976">mask</span><span class="op" id="3776980">,</span>&nbsp;<span class="num" id="3776982">0</span><span class="op" id="3776983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3776986">if</span>&nbsp;<span class="ident" id="3776989">ip</span>&nbsp;<span class="op" id="3776992">==</span>&nbsp;<span class="builtintype" id="3776995">nil</span>&nbsp;<span class="op" id="3776999">||</span>&nbsp;<span class="op" id="3777002">!</span><span class="ident" id="3777003">ok</span>&nbsp;<span class="op" id="3777006">||</span>&nbsp;<span class="ident" id="3777009">i</span>&nbsp;<span class="op" id="3777011">!=</span>&nbsp;<span class="builtinfunc" id="3777014">len</span><span class="op" id="3777017">(</span><span class="ident" id="3777018">mask</span><span class="op" id="3777022">)</span>&nbsp;<span class="op" id="3777024">||</span>&nbsp;<span class="ident" id="3777027">n</span>&nbsp;<span class="op" id="3777029">&lt;</span>&nbsp;<span class="num" id="3777031">0</span>&nbsp;<span class="op" id="3777033">||</span>&nbsp;<span class="ident" id="3777036">n</span>&nbsp;<span class="op" id="3777038">&gt;</span>&nbsp;<span class="num" id="3777040">8</span><span class="op" id="3777041">*</span><span class="ident" id="3777042">iplen</span>&nbsp;<span class="op" id="3777048">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3777052">return</span>&nbsp;<span class="builtintype" id="3777059">nil</span><span class="op" id="3777062">,</span>&nbsp;<span class="builtintype" id="3777064">nil</span><span class="op" id="3777067">,</span>&nbsp;<span class="op" id="3777069">&amp;</span><span class="ident" id="3777070">ParseError</span><span class="op" id="3777080">{</span><span class="string" id="3777081">&#34;CIDR&nbsp;address&#34;</span><span class="op" id="3777095">,</span>&nbsp;<span class="ident" id="3777097">s</span><span class="op" id="3777098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3777101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3777104">m</span>&nbsp;<span class="op" id="3777106">:=</span>&nbsp;<span class="ident" id="3777109">CIDRMask</span><span class="op" id="3777117">(</span><span class="ident" id="3777118">n</span><span class="op" id="3777119">,</span>&nbsp;<span class="num" id="3777121">8</span><span class="op" id="3777122">*</span><span class="ident" id="3777123">iplen</span><span class="op" id="3777128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3777131">return</span>&nbsp;<span class="ident" id="3777138">ip</span><span class="op" id="3777140">,</span>&nbsp;<span class="op" id="3777142">&amp;</span><span class="ident" id="3777143">IPNet</span><span class="op" id="3777148">{</span><span class="ident" id="3777149">IP</span><span class="op" id="3777151">:</span>&nbsp;<span class="ident" id="3777153">ip</span><span class="op" id="3777155">.</span><span class="ident" id="3777156">Mask</span><span class="op" id="3777160">(</span><span class="ident" id="3777161">m</span><span class="op" id="3777162">)</span><span class="op" id="3777163">,</span>&nbsp;<span class="ident" id="3777165">Mask</span><span class="op" id="3777169">:</span>&nbsp;<span class="ident" id="3777171">m</span><span class="op" id="3777172">}</span><span class="op" id="3777173">,</span>&nbsp;<span class="builtintype" id="3777175">nil</span><br>
<span class="lineno"></span><span class="op" id="3777179">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
