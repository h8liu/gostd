<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html" class="current">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2286029">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2286084">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2286138">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2286189">package</span>&nbsp;<span class="ident" id="2286197">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2286203">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;sine&nbsp;and&nbsp;cosine.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2286243">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2286303">//&nbsp;below&nbsp;were&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cmath/sin.c,</span><br>
<span class="lineno"></span><span class="comment" id="2286367">//&nbsp;available&nbsp;from&nbsp;http://www.netlib.org/cephes/cmath.tgz.</span><br>
<span class="lineno"></span><span class="comment" id="2286425">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2286483">//</span><br>
<span class="lineno"></span><span class="comment" id="2286486">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin.c</span><br>
<span class="lineno"></span><span class="comment" id="2286500">//</span><br>
<span class="lineno"></span><span class="comment" id="2286503">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;sine</span><br>
<span class="lineno"></span><span class="comment" id="2286525">//</span><br>
<span class="lineno">20</span><span class="comment" id="2286528">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2286541">//</span><br>
<span class="lineno"></span><span class="comment" id="2286544">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;sin();</span><br>
<span class="lineno"></span><span class="comment" id="2286567">//&nbsp;y&nbsp;=&nbsp;sin(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2286584">//</span><br>
<span class="lineno">25</span><span class="comment" id="2286587">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2286603">//</span><br>
<span class="lineno"></span><span class="comment" id="2286606">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2286683">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="comment" id="2286753">//</span><br>
<span class="lineno">30</span><span class="comment" id="2286756">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2286812">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;sine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2286862">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2286890">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;cosine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2286944">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno">35</span><span class="comment" id="2286972">//</span><br>
<span class="lineno"></span><span class="comment" id="2286975">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2286988">//</span><br>
<span class="lineno"></span><span class="comment" id="2286991">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2287031">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2287090">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;150000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.8e-18</span><br>
<span class="lineno"></span><span class="comment" id="2287151">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2287212">//</span><br>
<span class="lineno"></span><span class="comment" id="2287215">//&nbsp;Partial&nbsp;loss&nbsp;of&nbsp;accuracy&nbsp;begins&nbsp;to&nbsp;occur&nbsp;at&nbsp;x&nbsp;=&nbsp;2**30&nbsp;=&nbsp;1.074e9.&nbsp;&nbsp;The&nbsp;loss</span><br>
<span class="lineno"></span><span class="comment" id="2287293">//&nbsp;is&nbsp;not&nbsp;gradual,&nbsp;but&nbsp;jumps&nbsp;suddenly&nbsp;to&nbsp;about&nbsp;1&nbsp;part&nbsp;in&nbsp;10e7.&nbsp;&nbsp;Results&nbsp;may</span><br>
<span class="lineno">45</span><span class="comment" id="2287369">//&nbsp;be&nbsp;meaningless&nbsp;for&nbsp;x&nbsp;&gt;&nbsp;2**49&nbsp;=&nbsp;5.6e14.</span><br>
<span class="lineno"></span><span class="comment" id="2287411">//</span><br>
<span class="lineno"></span><span class="comment" id="2287414">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos.c</span><br>
<span class="lineno"></span><span class="comment" id="2287428">//</span><br>
<span class="lineno"></span><span class="comment" id="2287431">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Circular&nbsp;cosine</span><br>
<span class="lineno">50</span><span class="comment" id="2287455">//</span><br>
<span class="lineno"></span><span class="comment" id="2287458">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2287471">//</span><br>
<span class="lineno"></span><span class="comment" id="2287474">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;cos();</span><br>
<span class="lineno"></span><span class="comment" id="2287497">//&nbsp;y&nbsp;=&nbsp;cos(&nbsp;x&nbsp;);</span><br>
<span class="lineno">55</span><span class="comment" id="2287514">//</span><br>
<span class="lineno"></span><span class="comment" id="2287517">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2287533">//</span><br>
<span class="lineno"></span><span class="comment" id="2287536">//&nbsp;Range&nbsp;reduction&nbsp;is&nbsp;into&nbsp;intervals&nbsp;of&nbsp;pi/4.&nbsp;&nbsp;The&nbsp;reduction&nbsp;error&nbsp;is&nbsp;nearly</span><br>
<span class="lineno"></span><span class="comment" id="2287613">//&nbsp;eliminated&nbsp;by&nbsp;contriving&nbsp;an&nbsp;extended&nbsp;precision&nbsp;modular&nbsp;arithmetic.</span><br>
<span class="lineno">60</span><span class="comment" id="2287683">//</span><br>
<span class="lineno"></span><span class="comment" id="2287686">//&nbsp;Two&nbsp;polynomial&nbsp;approximating&nbsp;functions&nbsp;are&nbsp;employed.</span><br>
<span class="lineno"></span><span class="comment" id="2287742">//&nbsp;Between&nbsp;0&nbsp;and&nbsp;pi/4&nbsp;the&nbsp;cosine&nbsp;is&nbsp;approximated&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2287794">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;-&nbsp;&nbsp;x**2&nbsp;Q(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2287822">//&nbsp;Between&nbsp;pi/4&nbsp;and&nbsp;pi/2&nbsp;the&nbsp;sine&nbsp;is&nbsp;represented&nbsp;as</span><br>
<span class="lineno">65</span><span class="comment" id="2287874">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;+&nbsp;&nbsp;x**3&nbsp;P(x**2).</span><br>
<span class="lineno"></span><span class="comment" id="2287902">//</span><br>
<span class="lineno"></span><span class="comment" id="2287905">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2287918">//</span><br>
<span class="lineno"></span><span class="comment" id="2287921">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno">70</span><span class="comment" id="2287961">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="2288020">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;-1.07e9,+1.07e9&nbsp;&nbsp;130000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5.4e-17</span><br>
<span class="lineno"></span><span class="comment" id="2288081">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,+1.07e9&nbsp;&nbsp;&nbsp;17000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.0e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-18</span><br>
<span class="lineno"></span><span class="comment" id="2288142">//</span><br>
<span class="lineno"></span><span class="comment" id="2288145">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno">75</span><span class="comment" id="2288193">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2288257">//</span><br>
<span class="lineno"></span><span class="comment" id="2288260">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2288321">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2288391">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno">80</span><span class="comment" id="2288466">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2288533">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2288606">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2288678">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2288692">//</span><br>
<span class="lineno">85</span><span class="comment" id="2288695">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2288761">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2288827">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2288840">//</span><br>
<span class="lineno"></span><span class="comment" id="2288843">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">90</span><span class="comment" id="2288867">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2288897">//&nbsp;sin&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2288917">var</span>&nbsp;<span class="ident" id="2288921">_sin</span>&nbsp;<span class="op" id="2288926">=</span>&nbsp;<span class="op" id="2288928">[</span><span class="op" id="2288929">...</span><span class="op" id="2288932">]</span><span class="builtintype" id="2288933">float64</span><span class="op" id="2288940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2288943">1.58962301576546568060E-10</span><span class="op" id="2288969">,</span>&nbsp;<span class="comment" id="2288971">//&nbsp;0x3de5d8fd1fd19ccd</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2288994">-</span><span class="num" id="2288995">2.50507477628578072866E-8</span><span class="op" id="2289020">,</span>&nbsp;<span class="comment" id="2289022">//&nbsp;0xbe5ae5e5a9291f5d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2289045">2.75573136213857245213E-6</span><span class="op" id="2289070">,</span>&nbsp;&nbsp;<span class="comment" id="2289073">//&nbsp;0x3ec71de3567d48a1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2289096">-</span><span class="num" id="2289097">1.98412698295895385996E-4</span><span class="op" id="2289122">,</span>&nbsp;<span class="comment" id="2289124">//&nbsp;0xbf2a01a019bfdf03</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2289147">8.33333333332211858878E-3</span><span class="op" id="2289172">,</span>&nbsp;&nbsp;<span class="comment" id="2289175">//&nbsp;0x3f8111111110f7d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2289198">-</span><span class="num" id="2289199">1.66666666666666307295E-1</span><span class="op" id="2289224">,</span>&nbsp;<span class="comment" id="2289226">//&nbsp;0xbfc5555555555548</span><br>
<span class="lineno">100</span><span class="op" id="2289248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2289251">//&nbsp;cos&nbsp;coefficients</span><br>
<span class="lineno"></span><span class="keyword" id="2289271">var</span>&nbsp;<span class="ident" id="2289275">_cos</span>&nbsp;<span class="op" id="2289280">=</span>&nbsp;<span class="op" id="2289282">[</span><span class="op" id="2289283">...</span><span class="op" id="2289286">]</span><span class="builtintype" id="2289287">float64</span><span class="op" id="2289294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2289297">-</span><span class="num" id="2289298">1.13585365213876817300E-11</span><span class="op" id="2289324">,</span>&nbsp;<span class="comment" id="2289326">//&nbsp;0xbda8fa49a0861a9b</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2289349">2.08757008419747316778E-9</span><span class="op" id="2289374">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2289378">//&nbsp;0x3e21ee9d7b4e3f05</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2289401">-</span><span class="num" id="2289402">2.75573141792967388112E-7</span><span class="op" id="2289427">,</span>&nbsp;&nbsp;<span class="comment" id="2289430">//&nbsp;0xbe927e4f7eac4bc6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2289453">2.48015872888517045348E-5</span><span class="op" id="2289478">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2289482">//&nbsp;0x3efa01a019c844f5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2289505">-</span><span class="num" id="2289506">1.38888888888730564116E-3</span><span class="op" id="2289531">,</span>&nbsp;&nbsp;<span class="comment" id="2289534">//&nbsp;0xbf56c16c16c14f91</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2289557">4.16666666666665929218E-2</span><span class="op" id="2289582">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2289586">//&nbsp;0x3fa555555555554b</span><br>
<span class="lineno">110</span><span class="op" id="2289608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2289611">//&nbsp;Cos&nbsp;returns&nbsp;the&nbsp;cosine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2289663">//</span><br>
<span class="lineno"></span><span class="comment" id="2289666">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">115</span><span class="comment" id="2289688">//&nbsp;&nbsp;&nbsp;&nbsp;Cos(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2289708">//&nbsp;&nbsp;&nbsp;&nbsp;Cos(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2289726">func</span>&nbsp;<span class="ident" id="2289731">Cos</span><span class="op" id="2289734">(</span><span class="ident" id="2289735">x</span>&nbsp;<span class="builtintype" id="2289737">float64</span><span class="op" id="2289744">)</span>&nbsp;<span class="builtintype" id="2289746">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2289755">func</span>&nbsp;<span class="ident" id="2289760">cos</span><span class="op" id="2289763">(</span><span class="ident" id="2289764">x</span>&nbsp;<span class="builtintype" id="2289766">float64</span><span class="op" id="2289773">)</span>&nbsp;<span class="builtintype" id="2289775">float64</span>&nbsp;<span class="op" id="2289783">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2289786">const</span>&nbsp;<span class="op" id="2289792">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2289796">PI4A</span>&nbsp;<span class="op" id="2289801">=</span>&nbsp;<span class="num" id="2289803">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2289857">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2289910">PI4B</span>&nbsp;<span class="op" id="2289915">=</span>&nbsp;<span class="num" id="2289917">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2289971">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2289996">PI4C</span>&nbsp;<span class="op" id="2290001">=</span>&nbsp;<span class="num" id="2290003">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2290057">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290082">M4PI</span>&nbsp;<span class="op" id="2290087">=</span>&nbsp;<span class="num" id="2290089">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2290143">//&nbsp;4/pi</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2290155">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2290173">switch</span>&nbsp;<span class="op" id="2290180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2290183">case</span>&nbsp;<span class="ident" id="2290188">IsNaN</span><span class="op" id="2290193">(</span><span class="ident" id="2290194">x</span><span class="op" id="2290195">)</span>&nbsp;<span class="op" id="2290197">||</span>&nbsp;<span class="ident" id="2290200">IsInf</span><span class="op" id="2290205">(</span><span class="ident" id="2290206">x</span><span class="op" id="2290207">,</span>&nbsp;<span class="num" id="2290209">0</span><span class="op" id="2290210">)</span><span class="op" id="2290211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2290215">return</span>&nbsp;<span class="ident" id="2290222">NaN</span><span class="op" id="2290225">(</span><span class="op" id="2290226">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2290233">//&nbsp;make&nbsp;argument&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290260">sign</span>&nbsp;<span class="op" id="2290265">:=</span>&nbsp;<span class="builtintype" id="2290268">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2290275">if</span>&nbsp;<span class="ident" id="2290278">x</span>&nbsp;<span class="op" id="2290280">&lt;</span>&nbsp;<span class="num" id="2290282">0</span>&nbsp;<span class="op" id="2290284">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290288">x</span>&nbsp;<span class="op" id="2290290">=</span>&nbsp;<span class="op" id="2290292">-</span><span class="ident" id="2290293">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290300">j</span>&nbsp;<span class="op" id="2290302">:=</span>&nbsp;<span class="builtintype" id="2290305">int64</span><span class="op" id="2290310">(</span><span class="ident" id="2290311">x</span>&nbsp;<span class="op" id="2290313">*</span>&nbsp;<span class="ident" id="2290315">M4PI</span><span class="op" id="2290319">)</span>&nbsp;<span class="comment" id="2290321">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290391">y</span>&nbsp;<span class="op" id="2290393">:=</span>&nbsp;<span class="builtintype" id="2290396">float64</span><span class="op" id="2290403">(</span><span class="ident" id="2290404">j</span><span class="op" id="2290405">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2290412">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2290452">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2290476">if</span>&nbsp;<span class="ident" id="2290479">j</span><span class="op" id="2290480">&amp;</span><span class="num" id="2290481">1</span>&nbsp;<span class="op" id="2290483">==</span>&nbsp;<span class="num" id="2290486">1</span>&nbsp;<span class="op" id="2290488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290492">j</span>&nbsp;<span class="op" id="2290494">+=</span>&nbsp;<span class="num" id="2290497">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290501">y</span>&nbsp;<span class="op" id="2290503">+=</span>&nbsp;<span class="num" id="2290506">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290512">j</span>&nbsp;<span class="op" id="2290514">&amp;=</span>&nbsp;<span class="num" id="2290517">7</span>&nbsp;<span class="comment" id="2290519">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2290563">if</span>&nbsp;<span class="ident" id="2290566">j</span>&nbsp;<span class="op" id="2290568">&gt;</span>&nbsp;<span class="num" id="2290570">3</span>&nbsp;<span class="op" id="2290572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290576">j</span>&nbsp;<span class="op" id="2290578">-=</span>&nbsp;<span class="num" id="2290581">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290585">sign</span>&nbsp;<span class="op" id="2290590">=</span>&nbsp;<span class="op" id="2290592">!</span><span class="ident" id="2290593">sign</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2290602">if</span>&nbsp;<span class="ident" id="2290605">j</span>&nbsp;<span class="op" id="2290607">&gt;</span>&nbsp;<span class="num" id="2290609">1</span>&nbsp;<span class="op" id="2290611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290615">sign</span>&nbsp;<span class="op" id="2290620">=</span>&nbsp;<span class="op" id="2290622">!</span><span class="ident" id="2290623">sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290633">z</span>&nbsp;<span class="op" id="2290635">:=</span>&nbsp;<span class="op" id="2290638">(</span><span class="op" id="2290639">(</span><span class="ident" id="2290640">x</span>&nbsp;<span class="op" id="2290642">-</span>&nbsp;<span class="ident" id="2290644">y</span><span class="op" id="2290645">*</span><span class="ident" id="2290646">PI4A</span><span class="op" id="2290650">)</span>&nbsp;<span class="op" id="2290652">-</span>&nbsp;<span class="ident" id="2290654">y</span><span class="op" id="2290655">*</span><span class="ident" id="2290656">PI4B</span><span class="op" id="2290660">)</span>&nbsp;<span class="op" id="2290662">-</span>&nbsp;<span class="ident" id="2290664">y</span><span class="op" id="2290665">*</span><span class="ident" id="2290666">PI4C</span>&nbsp;<span class="comment" id="2290671">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290713">zz</span>&nbsp;<span class="op" id="2290716">:=</span>&nbsp;<span class="ident" id="2290719">z</span>&nbsp;<span class="op" id="2290721">*</span>&nbsp;<span class="ident" id="2290723">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2290726">if</span>&nbsp;<span class="ident" id="2290729">j</span>&nbsp;<span class="op" id="2290731">==</span>&nbsp;<span class="num" id="2290734">1</span>&nbsp;<span class="op" id="2290736">||</span>&nbsp;<span class="ident" id="2290739">j</span>&nbsp;<span class="op" id="2290741">==</span>&nbsp;<span class="num" id="2290744">2</span>&nbsp;<span class="op" id="2290746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290750">y</span>&nbsp;<span class="op" id="2290752">=</span>&nbsp;<span class="ident" id="2290754">z</span>&nbsp;<span class="op" id="2290756">+</span>&nbsp;<span class="ident" id="2290758">z</span><span class="op" id="2290759">*</span><span class="ident" id="2290760">zz</span><span class="op" id="2290762">*</span><span class="op" id="2290763">(</span><span class="op" id="2290764">(</span><span class="op" id="2290765">(</span><span class="op" id="2290766">(</span><span class="op" id="2290767">(</span><span class="op" id="2290768">(</span><span class="ident" id="2290769">_sin</span><span class="op" id="2290773">[</span><span class="num" id="2290774">0</span><span class="op" id="2290775">]</span><span class="op" id="2290776">*</span><span class="ident" id="2290777">zz</span><span class="op" id="2290779">)</span><span class="op" id="2290780">+</span><span class="ident" id="2290781">_sin</span><span class="op" id="2290785">[</span><span class="num" id="2290786">1</span><span class="op" id="2290787">]</span><span class="op" id="2290788">)</span><span class="op" id="2290789">*</span><span class="ident" id="2290790">zz</span><span class="op" id="2290792">+</span><span class="ident" id="2290793">_sin</span><span class="op" id="2290797">[</span><span class="num" id="2290798">2</span><span class="op" id="2290799">]</span><span class="op" id="2290800">)</span><span class="op" id="2290801">*</span><span class="ident" id="2290802">zz</span><span class="op" id="2290804">+</span><span class="ident" id="2290805">_sin</span><span class="op" id="2290809">[</span><span class="num" id="2290810">3</span><span class="op" id="2290811">]</span><span class="op" id="2290812">)</span><span class="op" id="2290813">*</span><span class="ident" id="2290814">zz</span><span class="op" id="2290816">+</span><span class="ident" id="2290817">_sin</span><span class="op" id="2290821">[</span><span class="num" id="2290822">4</span><span class="op" id="2290823">]</span><span class="op" id="2290824">)</span><span class="op" id="2290825">*</span><span class="ident" id="2290826">zz</span><span class="op" id="2290828">+</span><span class="ident" id="2290829">_sin</span><span class="op" id="2290833">[</span><span class="num" id="2290834">5</span><span class="op" id="2290835">]</span><span class="op" id="2290836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290839">}</span>&nbsp;<span class="keyword" id="2290841">else</span>&nbsp;<span class="op" id="2290846">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290850">y</span>&nbsp;<span class="op" id="2290852">=</span>&nbsp;<span class="num" id="2290854">1.0</span>&nbsp;<span class="op" id="2290858">-</span>&nbsp;<span class="num" id="2290860">0.5</span><span class="op" id="2290863">*</span><span class="ident" id="2290864">zz</span>&nbsp;<span class="op" id="2290867">+</span>&nbsp;<span class="ident" id="2290869">zz</span><span class="op" id="2290871">*</span><span class="ident" id="2290872">zz</span><span class="op" id="2290874">*</span><span class="op" id="2290875">(</span><span class="op" id="2290876">(</span><span class="op" id="2290877">(</span><span class="op" id="2290878">(</span><span class="op" id="2290879">(</span><span class="op" id="2290880">(</span><span class="ident" id="2290881">_cos</span><span class="op" id="2290885">[</span><span class="num" id="2290886">0</span><span class="op" id="2290887">]</span><span class="op" id="2290888">*</span><span class="ident" id="2290889">zz</span><span class="op" id="2290891">)</span><span class="op" id="2290892">+</span><span class="ident" id="2290893">_cos</span><span class="op" id="2290897">[</span><span class="num" id="2290898">1</span><span class="op" id="2290899">]</span><span class="op" id="2290900">)</span><span class="op" id="2290901">*</span><span class="ident" id="2290902">zz</span><span class="op" id="2290904">+</span><span class="ident" id="2290905">_cos</span><span class="op" id="2290909">[</span><span class="num" id="2290910">2</span><span class="op" id="2290911">]</span><span class="op" id="2290912">)</span><span class="op" id="2290913">*</span><span class="ident" id="2290914">zz</span><span class="op" id="2290916">+</span><span class="ident" id="2290917">_cos</span><span class="op" id="2290921">[</span><span class="num" id="2290922">3</span><span class="op" id="2290923">]</span><span class="op" id="2290924">)</span><span class="op" id="2290925">*</span><span class="ident" id="2290926">zz</span><span class="op" id="2290928">+</span><span class="ident" id="2290929">_cos</span><span class="op" id="2290933">[</span><span class="num" id="2290934">4</span><span class="op" id="2290935">]</span><span class="op" id="2290936">)</span><span class="op" id="2290937">*</span><span class="ident" id="2290938">zz</span><span class="op" id="2290940">+</span><span class="ident" id="2290941">_cos</span><span class="op" id="2290945">[</span><span class="num" id="2290946">5</span><span class="op" id="2290947">]</span><span class="op" id="2290948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2290954">if</span>&nbsp;<span class="ident" id="2290957">sign</span>&nbsp;<span class="op" id="2290962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2290966">y</span>&nbsp;<span class="op" id="2290968">=</span>&nbsp;<span class="op" id="2290970">-</span><span class="ident" id="2290971">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2290974">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2290977">return</span>&nbsp;<span class="ident" id="2290984">y</span><br>
<span class="lineno"></span><span class="op" id="2290986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2290989">//&nbsp;Sin&nbsp;returns&nbsp;the&nbsp;sine&nbsp;of&nbsp;the&nbsp;radian&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2291039">//</span><br>
<span class="lineno">170</span><span class="comment" id="2291042">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2291064">//&nbsp;&nbsp;&nbsp;&nbsp;Sin(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="2291082">//&nbsp;&nbsp;&nbsp;&nbsp;Sin(±Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2291102">//&nbsp;&nbsp;&nbsp;&nbsp;Sin(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2291120">func</span>&nbsp;<span class="ident" id="2291125">Sin</span><span class="op" id="2291128">(</span><span class="ident" id="2291129">x</span>&nbsp;<span class="builtintype" id="2291131">float64</span><span class="op" id="2291138">)</span>&nbsp;<span class="builtintype" id="2291140">float64</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="2291149">func</span>&nbsp;<span class="ident" id="2291154">sin</span><span class="op" id="2291157">(</span><span class="ident" id="2291158">x</span>&nbsp;<span class="builtintype" id="2291160">float64</span><span class="op" id="2291167">)</span>&nbsp;<span class="builtintype" id="2291169">float64</span>&nbsp;<span class="op" id="2291177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2291180">const</span>&nbsp;<span class="op" id="2291186">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291190">PI4A</span>&nbsp;<span class="op" id="2291195">=</span>&nbsp;<span class="num" id="2291197">7.85398125648498535156E-1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2291251">//&nbsp;0x3fe921fb40000000,&nbsp;Pi/4&nbsp;split&nbsp;into&nbsp;three&nbsp;parts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291304">PI4B</span>&nbsp;<span class="op" id="2291309">=</span>&nbsp;<span class="num" id="2291311">3.77489470793079817668E-8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2291365">//&nbsp;0x3e64442d00000000,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291390">PI4C</span>&nbsp;<span class="op" id="2291395">=</span>&nbsp;<span class="num" id="2291397">2.69515142907905952645E-15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2291451">//&nbsp;0x3ce8469898cc5170,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291476">M4PI</span>&nbsp;<span class="op" id="2291481">=</span>&nbsp;<span class="num" id="2291483">1.273239544735162542821171882678754627704620361328125</span>&nbsp;<span class="comment" id="2291537">//&nbsp;4/pi</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2291546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2291549">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2291567">switch</span>&nbsp;<span class="op" id="2291574">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2291577">case</span>&nbsp;<span class="ident" id="2291582">x</span>&nbsp;<span class="op" id="2291584">==</span>&nbsp;<span class="num" id="2291587">0</span>&nbsp;<span class="op" id="2291589">||</span>&nbsp;<span class="ident" id="2291592">IsNaN</span><span class="op" id="2291597">(</span><span class="ident" id="2291598">x</span><span class="op" id="2291599">)</span><span class="op" id="2291600">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2291604">return</span>&nbsp;<span class="ident" id="2291611">x</span>&nbsp;<span class="comment" id="2291613">//&nbsp;return&nbsp;±0&nbsp;||&nbsp;NaN()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2291637">case</span>&nbsp;<span class="ident" id="2291642">IsInf</span><span class="op" id="2291647">(</span><span class="ident" id="2291648">x</span><span class="op" id="2291649">,</span>&nbsp;<span class="num" id="2291651">0</span><span class="op" id="2291652">)</span><span class="op" id="2291653">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2291657">return</span>&nbsp;<span class="ident" id="2291664">NaN</span><span class="op" id="2291667">(</span><span class="op" id="2291668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2291671">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2291675">//&nbsp;make&nbsp;argument&nbsp;positive&nbsp;but&nbsp;save&nbsp;the&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291720">sign</span>&nbsp;<span class="op" id="2291725">:=</span>&nbsp;<span class="builtintype" id="2291728">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2291735">if</span>&nbsp;<span class="ident" id="2291738">x</span>&nbsp;<span class="op" id="2291740">&lt;</span>&nbsp;<span class="num" id="2291742">0</span>&nbsp;<span class="op" id="2291744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291748">x</span>&nbsp;<span class="op" id="2291750">=</span>&nbsp;<span class="op" id="2291752">-</span><span class="ident" id="2291753">x</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291757">sign</span>&nbsp;<span class="op" id="2291762">=</span>&nbsp;<span class="builtintype" id="2291764">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2291770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291774">j</span>&nbsp;<span class="op" id="2291776">:=</span>&nbsp;<span class="builtintype" id="2291779">int64</span><span class="op" id="2291784">(</span><span class="ident" id="2291785">x</span>&nbsp;<span class="op" id="2291787">*</span>&nbsp;<span class="ident" id="2291789">M4PI</span><span class="op" id="2291793">)</span>&nbsp;<span class="comment" id="2291795">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;integer&nbsp;for&nbsp;tests&nbsp;on&nbsp;the&nbsp;phase&nbsp;angle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291865">y</span>&nbsp;<span class="op" id="2291867">:=</span>&nbsp;<span class="builtintype" id="2291870">float64</span><span class="op" id="2291877">(</span><span class="ident" id="2291878">j</span><span class="op" id="2291879">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2291886">//&nbsp;integer&nbsp;part&nbsp;of&nbsp;x/(Pi/4),&nbsp;as&nbsp;float</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2291926">//&nbsp;map&nbsp;zeros&nbsp;to&nbsp;origin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2291950">if</span>&nbsp;<span class="ident" id="2291953">j</span><span class="op" id="2291954">&amp;</span><span class="num" id="2291955">1</span>&nbsp;<span class="op" id="2291957">==</span>&nbsp;<span class="num" id="2291960">1</span>&nbsp;<span class="op" id="2291962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291966">j</span>&nbsp;<span class="op" id="2291968">+=</span>&nbsp;<span class="num" id="2291971">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291975">y</span>&nbsp;<span class="op" id="2291977">+=</span>&nbsp;<span class="num" id="2291980">1</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2291983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2291986">j</span>&nbsp;<span class="op" id="2291988">&amp;=</span>&nbsp;<span class="num" id="2291991">7</span>&nbsp;<span class="comment" id="2291993">//&nbsp;octant&nbsp;modulo&nbsp;2Pi&nbsp;radians&nbsp;(360&nbsp;degrees)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2292037">//&nbsp;reflect&nbsp;in&nbsp;x&nbsp;axis</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2292059">if</span>&nbsp;<span class="ident" id="2292062">j</span>&nbsp;<span class="op" id="2292064">&gt;</span>&nbsp;<span class="num" id="2292066">3</span>&nbsp;<span class="op" id="2292068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2292072">sign</span>&nbsp;<span class="op" id="2292077">=</span>&nbsp;<span class="op" id="2292079">!</span><span class="ident" id="2292080">sign</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2292087">j</span>&nbsp;<span class="op" id="2292089">-=</span>&nbsp;<span class="num" id="2292092">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2292095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2292099">z</span>&nbsp;<span class="op" id="2292101">:=</span>&nbsp;<span class="op" id="2292104">(</span><span class="op" id="2292105">(</span><span class="ident" id="2292106">x</span>&nbsp;<span class="op" id="2292108">-</span>&nbsp;<span class="ident" id="2292110">y</span><span class="op" id="2292111">*</span><span class="ident" id="2292112">PI4A</span><span class="op" id="2292116">)</span>&nbsp;<span class="op" id="2292118">-</span>&nbsp;<span class="ident" id="2292120">y</span><span class="op" id="2292121">*</span><span class="ident" id="2292122">PI4B</span><span class="op" id="2292126">)</span>&nbsp;<span class="op" id="2292128">-</span>&nbsp;<span class="ident" id="2292130">y</span><span class="op" id="2292131">*</span><span class="ident" id="2292132">PI4C</span>&nbsp;<span class="comment" id="2292137">//&nbsp;Extended&nbsp;precision&nbsp;modular&nbsp;arithmetic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2292179">zz</span>&nbsp;<span class="op" id="2292182">:=</span>&nbsp;<span class="ident" id="2292185">z</span>&nbsp;<span class="op" id="2292187">*</span>&nbsp;<span class="ident" id="2292189">z</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2292192">if</span>&nbsp;<span class="ident" id="2292195">j</span>&nbsp;<span class="op" id="2292197">==</span>&nbsp;<span class="num" id="2292200">1</span>&nbsp;<span class="op" id="2292202">||</span>&nbsp;<span class="ident" id="2292205">j</span>&nbsp;<span class="op" id="2292207">==</span>&nbsp;<span class="num" id="2292210">2</span>&nbsp;<span class="op" id="2292212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2292216">y</span>&nbsp;<span class="op" id="2292218">=</span>&nbsp;<span class="num" id="2292220">1.0</span>&nbsp;<span class="op" id="2292224">-</span>&nbsp;<span class="num" id="2292226">0.5</span><span class="op" id="2292229">*</span><span class="ident" id="2292230">zz</span>&nbsp;<span class="op" id="2292233">+</span>&nbsp;<span class="ident" id="2292235">zz</span><span class="op" id="2292237">*</span><span class="ident" id="2292238">zz</span><span class="op" id="2292240">*</span><span class="op" id="2292241">(</span><span class="op" id="2292242">(</span><span class="op" id="2292243">(</span><span class="op" id="2292244">(</span><span class="op" id="2292245">(</span><span class="op" id="2292246">(</span><span class="ident" id="2292247">_cos</span><span class="op" id="2292251">[</span><span class="num" id="2292252">0</span><span class="op" id="2292253">]</span><span class="op" id="2292254">*</span><span class="ident" id="2292255">zz</span><span class="op" id="2292257">)</span><span class="op" id="2292258">+</span><span class="ident" id="2292259">_cos</span><span class="op" id="2292263">[</span><span class="num" id="2292264">1</span><span class="op" id="2292265">]</span><span class="op" id="2292266">)</span><span class="op" id="2292267">*</span><span class="ident" id="2292268">zz</span><span class="op" id="2292270">+</span><span class="ident" id="2292271">_cos</span><span class="op" id="2292275">[</span><span class="num" id="2292276">2</span><span class="op" id="2292277">]</span><span class="op" id="2292278">)</span><span class="op" id="2292279">*</span><span class="ident" id="2292280">zz</span><span class="op" id="2292282">+</span><span class="ident" id="2292283">_cos</span><span class="op" id="2292287">[</span><span class="num" id="2292288">3</span><span class="op" id="2292289">]</span><span class="op" id="2292290">)</span><span class="op" id="2292291">*</span><span class="ident" id="2292292">zz</span><span class="op" id="2292294">+</span><span class="ident" id="2292295">_cos</span><span class="op" id="2292299">[</span><span class="num" id="2292300">4</span><span class="op" id="2292301">]</span><span class="op" id="2292302">)</span><span class="op" id="2292303">*</span><span class="ident" id="2292304">zz</span><span class="op" id="2292306">+</span><span class="ident" id="2292307">_cos</span><span class="op" id="2292311">[</span><span class="num" id="2292312">5</span><span class="op" id="2292313">]</span><span class="op" id="2292314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2292317">}</span>&nbsp;<span class="keyword" id="2292319">else</span>&nbsp;<span class="op" id="2292324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2292328">y</span>&nbsp;<span class="op" id="2292330">=</span>&nbsp;<span class="ident" id="2292332">z</span>&nbsp;<span class="op" id="2292334">+</span>&nbsp;<span class="ident" id="2292336">z</span><span class="op" id="2292337">*</span><span class="ident" id="2292338">zz</span><span class="op" id="2292340">*</span><span class="op" id="2292341">(</span><span class="op" id="2292342">(</span><span class="op" id="2292343">(</span><span class="op" id="2292344">(</span><span class="op" id="2292345">(</span><span class="op" id="2292346">(</span><span class="ident" id="2292347">_sin</span><span class="op" id="2292351">[</span><span class="num" id="2292352">0</span><span class="op" id="2292353">]</span><span class="op" id="2292354">*</span><span class="ident" id="2292355">zz</span><span class="op" id="2292357">)</span><span class="op" id="2292358">+</span><span class="ident" id="2292359">_sin</span><span class="op" id="2292363">[</span><span class="num" id="2292364">1</span><span class="op" id="2292365">]</span><span class="op" id="2292366">)</span><span class="op" id="2292367">*</span><span class="ident" id="2292368">zz</span><span class="op" id="2292370">+</span><span class="ident" id="2292371">_sin</span><span class="op" id="2292375">[</span><span class="num" id="2292376">2</span><span class="op" id="2292377">]</span><span class="op" id="2292378">)</span><span class="op" id="2292379">*</span><span class="ident" id="2292380">zz</span><span class="op" id="2292382">+</span><span class="ident" id="2292383">_sin</span><span class="op" id="2292387">[</span><span class="num" id="2292388">3</span><span class="op" id="2292389">]</span><span class="op" id="2292390">)</span><span class="op" id="2292391">*</span><span class="ident" id="2292392">zz</span><span class="op" id="2292394">+</span><span class="ident" id="2292395">_sin</span><span class="op" id="2292399">[</span><span class="num" id="2292400">4</span><span class="op" id="2292401">]</span><span class="op" id="2292402">)</span><span class="op" id="2292403">*</span><span class="ident" id="2292404">zz</span><span class="op" id="2292406">+</span><span class="ident" id="2292407">_sin</span><span class="op" id="2292411">[</span><span class="num" id="2292412">5</span><span class="op" id="2292413">]</span><span class="op" id="2292414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2292417">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2292420">if</span>&nbsp;<span class="ident" id="2292423">sign</span>&nbsp;<span class="op" id="2292428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2292432">y</span>&nbsp;<span class="op" id="2292434">=</span>&nbsp;<span class="op" id="2292436">-</span><span class="ident" id="2292437">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2292440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2292443">return</span>&nbsp;<span class="ident" id="2292450">y</span><br>
<span class="lineno"></span><span class="op" id="2292452">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
