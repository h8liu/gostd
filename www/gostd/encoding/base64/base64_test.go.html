<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/base64</h2>
<ul>
<li><a href="/gostd/encoding/base64/base64.go.html">base64.go</a></li>
<li><a href="/gostd/encoding/base64/base64_test.go.html" class="current">base64_test.go</a></li>
<li><a href="/gostd/encoding/base64/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8215760">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8215815">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8215869">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8215920">package</span>&nbsp;<span class="ident" id="8215928">base64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8215936">import</span>&nbsp;<span class="op" id="8215943">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8215946">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8215955">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8215965">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8215971">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8215984">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8215995">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8216006">&#34;testing&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8216017">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="8216024">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8216027">type</span>&nbsp;<span class="ident" id="8216032">testpair</span>&nbsp;<span class="keyword" id="8216041">struct</span>&nbsp;<span class="op" id="8216048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8216051">decoded</span><span class="op" id="8216058">,</span>&nbsp;<span class="ident" id="8216060">encoded</span>&nbsp;<span class="builtintype" id="8216068">string</span><br>
<span class="lineno">20</span><span class="op" id="8216075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8216078">var</span>&nbsp;<span class="ident" id="8216082">pairs</span>&nbsp;<span class="op" id="8216088">=</span>&nbsp;<span class="op" id="8216090">[</span><span class="op" id="8216091">]</span><span class="ident" id="8216092">testpair</span><span class="op" id="8216100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8216103">//&nbsp;RFC&nbsp;3548&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216125">{</span><span class="string" id="8216126">&#34;\x14\xfb\x9c\x03\xd9\x7e&#34;</span><span class="op" id="8216152">,</span>&nbsp;<span class="string" id="8216154">&#34;FPucA9l+&#34;</span><span class="op" id="8216164">}</span><span class="op" id="8216165">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216168">{</span><span class="string" id="8216169">&#34;\x14\xfb\x9c\x03\xd9&#34;</span><span class="op" id="8216191">,</span>&nbsp;<span class="string" id="8216193">&#34;FPucA9k=&#34;</span><span class="op" id="8216203">}</span><span class="op" id="8216204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216207">{</span><span class="string" id="8216208">&#34;\x14\xfb\x9c\x03&#34;</span><span class="op" id="8216226">,</span>&nbsp;<span class="string" id="8216228">&#34;FPucAw==&#34;</span><span class="op" id="8216238">}</span><span class="op" id="8216239">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8216243">//&nbsp;RFC&nbsp;4648&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216265">{</span><span class="string" id="8216266">&#34;&#34;</span><span class="op" id="8216268">,</span>&nbsp;<span class="string" id="8216270">&#34;&#34;</span><span class="op" id="8216272">}</span><span class="op" id="8216273">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216276">{</span><span class="string" id="8216277">&#34;f&#34;</span><span class="op" id="8216280">,</span>&nbsp;<span class="string" id="8216282">&#34;Zg==&#34;</span><span class="op" id="8216288">}</span><span class="op" id="8216289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216292">{</span><span class="string" id="8216293">&#34;fo&#34;</span><span class="op" id="8216297">,</span>&nbsp;<span class="string" id="8216299">&#34;Zm8=&#34;</span><span class="op" id="8216305">}</span><span class="op" id="8216306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216309">{</span><span class="string" id="8216310">&#34;foo&#34;</span><span class="op" id="8216315">,</span>&nbsp;<span class="string" id="8216317">&#34;Zm9v&#34;</span><span class="op" id="8216323">}</span><span class="op" id="8216324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216327">{</span><span class="string" id="8216328">&#34;foob&#34;</span><span class="op" id="8216334">,</span>&nbsp;<span class="string" id="8216336">&#34;Zm9vYg==&#34;</span><span class="op" id="8216346">}</span><span class="op" id="8216347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216350">{</span><span class="string" id="8216351">&#34;fooba&#34;</span><span class="op" id="8216358">,</span>&nbsp;<span class="string" id="8216360">&#34;Zm9vYmE=&#34;</span><span class="op" id="8216370">}</span><span class="op" id="8216371">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216374">{</span><span class="string" id="8216375">&#34;foobar&#34;</span><span class="op" id="8216383">,</span>&nbsp;<span class="string" id="8216385">&#34;Zm9vYmFy&#34;</span><span class="op" id="8216395">}</span><span class="op" id="8216396">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8216400">//&nbsp;Wikipedia&nbsp;examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216423">{</span><span class="string" id="8216424">&#34;sure.&#34;</span><span class="op" id="8216431">,</span>&nbsp;<span class="string" id="8216433">&#34;c3VyZS4=&#34;</span><span class="op" id="8216443">}</span><span class="op" id="8216444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216447">{</span><span class="string" id="8216448">&#34;sure&#34;</span><span class="op" id="8216454">,</span>&nbsp;<span class="string" id="8216456">&#34;c3VyZQ==&#34;</span><span class="op" id="8216466">}</span><span class="op" id="8216467">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216470">{</span><span class="string" id="8216471">&#34;sur&#34;</span><span class="op" id="8216476">,</span>&nbsp;<span class="string" id="8216478">&#34;c3Vy&#34;</span><span class="op" id="8216484">}</span><span class="op" id="8216485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216488">{</span><span class="string" id="8216489">&#34;su&#34;</span><span class="op" id="8216493">,</span>&nbsp;<span class="string" id="8216495">&#34;c3U=&#34;</span><span class="op" id="8216501">}</span><span class="op" id="8216502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216505">{</span><span class="string" id="8216506">&#34;leasure.&#34;</span><span class="op" id="8216516">,</span>&nbsp;<span class="string" id="8216518">&#34;bGVhc3VyZS4=&#34;</span><span class="op" id="8216532">}</span><span class="op" id="8216533">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216536">{</span><span class="string" id="8216537">&#34;easure.&#34;</span><span class="op" id="8216546">,</span>&nbsp;<span class="string" id="8216548">&#34;ZWFzdXJlLg==&#34;</span><span class="op" id="8216562">}</span><span class="op" id="8216563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216566">{</span><span class="string" id="8216567">&#34;asure.&#34;</span><span class="op" id="8216575">,</span>&nbsp;<span class="string" id="8216577">&#34;YXN1cmUu&#34;</span><span class="op" id="8216587">}</span><span class="op" id="8216588">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216591">{</span><span class="string" id="8216592">&#34;sure.&#34;</span><span class="op" id="8216599">,</span>&nbsp;<span class="string" id="8216601">&#34;c3VyZS4=&#34;</span><span class="op" id="8216611">}</span><span class="op" id="8216612">,</span><br>
<span class="lineno"></span><span class="op" id="8216614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8216617">var</span>&nbsp;<span class="ident" id="8216621">bigtest</span>&nbsp;<span class="op" id="8216629">=</span>&nbsp;<span class="ident" id="8216631">testpair</span><span class="op" id="8216639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8216642">&#34;Twas&nbsp;brillig,&nbsp;and&nbsp;the&nbsp;slithy&nbsp;toves&#34;</span><span class="op" id="8216678">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8216681">&#34;VHdhcyBicmlsbGlnLCBhbmQgdGhlIHNsaXRoeSB0b3Zlcw==&#34;</span><span class="op" id="8216731">,</span><br>
<span class="lineno"></span><span class="op" id="8216733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8216736">func</span>&nbsp;<span class="ident" id="8216741">testEqual</span><span class="op" id="8216750">(</span><span class="ident" id="8216751">t</span>&nbsp;<span class="op" id="8216753">*</span><span class="ident" id="8216754">testing</span><span class="op" id="8216761">.</span><span class="ident" id="8216762">T</span><span class="op" id="8216763">,</span>&nbsp;<span class="ident" id="8216765">msg</span>&nbsp;<span class="builtintype" id="8216769">string</span><span class="op" id="8216775">,</span>&nbsp;<span class="ident" id="8216777">args</span>&nbsp;<span class="op" id="8216782">...</span><span class="keyword" id="8216785">interface</span><span class="op" id="8216794">{</span><span class="op" id="8216795">}</span><span class="op" id="8216796">)</span>&nbsp;<span class="builtintype" id="8216798">bool</span>&nbsp;<span class="op" id="8216803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8216806">if</span>&nbsp;<span class="ident" id="8216809">args</span><span class="op" id="8216813">[</span><span class="builtinfunc" id="8216814">len</span><span class="op" id="8216817">(</span><span class="ident" id="8216818">args</span><span class="op" id="8216822">)</span><span class="op" id="8216823">-</span><span class="num" id="8216824">2</span><span class="op" id="8216825">]</span>&nbsp;<span class="op" id="8216827">!=</span>&nbsp;<span class="ident" id="8216830">args</span><span class="op" id="8216834">[</span><span class="builtinfunc" id="8216835">len</span><span class="op" id="8216838">(</span><span class="ident" id="8216839">args</span><span class="op" id="8216843">)</span><span class="op" id="8216844">-</span><span class="num" id="8216845">1</span><span class="op" id="8216846">]</span>&nbsp;<span class="op" id="8216848">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8216852">t</span><span class="op" id="8216853">.</span><span class="ident" id="8216854">Errorf</span><span class="op" id="8216860">(</span><span class="ident" id="8216861">msg</span><span class="op" id="8216864">,</span>&nbsp;<span class="ident" id="8216866">args</span><span class="op" id="8216870">...</span><span class="op" id="8216873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8216877">return</span>&nbsp;<span class="builtintype" id="8216884">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8216891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8216894">return</span>&nbsp;<span class="builtintype" id="8216901">true</span><br>
<span class="lineno"></span><span class="op" id="8216906">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="8216909">func</span>&nbsp;<span class="ident" id="8216914">TestEncode</span><span class="op" id="8216924">(</span><span class="ident" id="8216925">t</span>&nbsp;<span class="op" id="8216927">*</span><span class="ident" id="8216928">testing</span><span class="op" id="8216935">.</span><span class="ident" id="8216936">T</span><span class="op" id="8216937">)</span>&nbsp;<span class="op" id="8216939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8216942">for</span>&nbsp;<span class="ident" id="8216946">_</span><span class="op" id="8216947">,</span>&nbsp;<span class="ident" id="8216949">p</span>&nbsp;<span class="op" id="8216951">:=</span>&nbsp;<span class="keyword" id="8216954">range</span>&nbsp;<span class="ident" id="8216960">pairs</span>&nbsp;<span class="op" id="8216966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8216970">got</span>&nbsp;<span class="op" id="8216974">:=</span>&nbsp;<span class="ident" id="8216977">StdEncoding</span><span class="op" id="8216988">.</span><span class="ident" id="8216989">EncodeToString</span><span class="op" id="8217003">(</span><span class="op" id="8217004">[</span><span class="op" id="8217005">]</span><span class="builtintype" id="8217006">byte</span><span class="op" id="8217010">(</span><span class="ident" id="8217011">p</span><span class="op" id="8217012">.</span><span class="ident" id="8217013">decoded</span><span class="op" id="8217020">)</span><span class="op" id="8217021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217025">testEqual</span><span class="op" id="8217034">(</span><span class="ident" id="8217035">t</span><span class="op" id="8217036">,</span>&nbsp;<span class="string" id="8217038">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8217064">,</span>&nbsp;<span class="ident" id="8217066">p</span><span class="op" id="8217067">.</span><span class="ident" id="8217068">decoded</span><span class="op" id="8217075">,</span>&nbsp;<span class="ident" id="8217077">got</span><span class="op" id="8217080">,</span>&nbsp;<span class="ident" id="8217082">p</span><span class="op" id="8217083">.</span><span class="ident" id="8217084">encoded</span><span class="op" id="8217091">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8217094">}</span><br>
<span class="lineno"></span><span class="op" id="8217096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8217099">func</span>&nbsp;<span class="ident" id="8217104">TestEncoder</span><span class="op" id="8217115">(</span><span class="ident" id="8217116">t</span>&nbsp;<span class="op" id="8217118">*</span><span class="ident" id="8217119">testing</span><span class="op" id="8217126">.</span><span class="ident" id="8217127">T</span><span class="op" id="8217128">)</span>&nbsp;<span class="op" id="8217130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8217133">for</span>&nbsp;<span class="ident" id="8217137">_</span><span class="op" id="8217138">,</span>&nbsp;<span class="ident" id="8217140">p</span>&nbsp;<span class="op" id="8217142">:=</span>&nbsp;<span class="keyword" id="8217145">range</span>&nbsp;<span class="ident" id="8217151">pairs</span>&nbsp;<span class="op" id="8217157">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217161">bb</span>&nbsp;<span class="op" id="8217164">:=</span>&nbsp;<span class="op" id="8217167">&amp;</span><span class="ident" id="8217168">bytes</span><span class="op" id="8217173">.</span><span class="ident" id="8217174">Buffer</span><span class="op" id="8217180">{</span><span class="op" id="8217181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217185">encoder</span>&nbsp;<span class="op" id="8217193">:=</span>&nbsp;<span class="ident" id="8217196">NewEncoder</span><span class="op" id="8217206">(</span><span class="ident" id="8217207">StdEncoding</span><span class="op" id="8217218">,</span>&nbsp;<span class="ident" id="8217220">bb</span><span class="op" id="8217222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217226">encoder</span><span class="op" id="8217233">.</span><span class="ident" id="8217234">Write</span><span class="op" id="8217239">(</span><span class="op" id="8217240">[</span><span class="op" id="8217241">]</span><span class="builtintype" id="8217242">byte</span><span class="op" id="8217246">(</span><span class="ident" id="8217247">p</span><span class="op" id="8217248">.</span><span class="ident" id="8217249">decoded</span><span class="op" id="8217256">)</span><span class="op" id="8217257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217261">encoder</span><span class="op" id="8217268">.</span><span class="ident" id="8217269">Close</span><span class="op" id="8217274">(</span><span class="op" id="8217275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217279">testEqual</span><span class="op" id="8217288">(</span><span class="ident" id="8217289">t</span><span class="op" id="8217290">,</span>&nbsp;<span class="string" id="8217292">&#34;Encode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8217318">,</span>&nbsp;<span class="ident" id="8217320">p</span><span class="op" id="8217321">.</span><span class="ident" id="8217322">decoded</span><span class="op" id="8217329">,</span>&nbsp;<span class="ident" id="8217331">bb</span><span class="op" id="8217333">.</span><span class="ident" id="8217334">String</span><span class="op" id="8217340">(</span><span class="op" id="8217341">)</span><span class="op" id="8217342">,</span>&nbsp;<span class="ident" id="8217344">p</span><span class="op" id="8217345">.</span><span class="ident" id="8217346">encoded</span><span class="op" id="8217353">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8217356">}</span><br>
<span class="lineno"></span><span class="op" id="8217358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8217361">func</span>&nbsp;<span class="ident" id="8217366">TestEncoderBuffering</span><span class="op" id="8217386">(</span><span class="ident" id="8217387">t</span>&nbsp;<span class="op" id="8217389">*</span><span class="ident" id="8217390">testing</span><span class="op" id="8217397">.</span><span class="ident" id="8217398">T</span><span class="op" id="8217399">)</span>&nbsp;<span class="op" id="8217401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217404">input</span>&nbsp;<span class="op" id="8217410">:=</span>&nbsp;<span class="op" id="8217413">[</span><span class="op" id="8217414">]</span><span class="builtintype" id="8217415">byte</span><span class="op" id="8217419">(</span><span class="ident" id="8217420">bigtest</span><span class="op" id="8217427">.</span><span class="ident" id="8217428">decoded</span><span class="op" id="8217435">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8217438">for</span>&nbsp;<span class="ident" id="8217442">bs</span>&nbsp;<span class="op" id="8217445">:=</span>&nbsp;<span class="num" id="8217448">1</span><span class="op" id="8217449">;</span>&nbsp;<span class="ident" id="8217451">bs</span>&nbsp;<span class="op" id="8217454">&lt;=</span>&nbsp;<span class="num" id="8217457">12</span><span class="op" id="8217459">;</span>&nbsp;<span class="ident" id="8217461">bs</span><span class="op" id="8217463">++</span>&nbsp;<span class="op" id="8217466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217470">bb</span>&nbsp;<span class="op" id="8217473">:=</span>&nbsp;<span class="op" id="8217476">&amp;</span><span class="ident" id="8217477">bytes</span><span class="op" id="8217482">.</span><span class="ident" id="8217483">Buffer</span><span class="op" id="8217489">{</span><span class="op" id="8217490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217494">encoder</span>&nbsp;<span class="op" id="8217502">:=</span>&nbsp;<span class="ident" id="8217505">NewEncoder</span><span class="op" id="8217515">(</span><span class="ident" id="8217516">StdEncoding</span><span class="op" id="8217527">,</span>&nbsp;<span class="ident" id="8217529">bb</span><span class="op" id="8217531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8217535">for</span>&nbsp;<span class="ident" id="8217539">pos</span>&nbsp;<span class="op" id="8217543">:=</span>&nbsp;<span class="num" id="8217546">0</span><span class="op" id="8217547">;</span>&nbsp;<span class="ident" id="8217549">pos</span>&nbsp;<span class="op" id="8217553">&lt;</span>&nbsp;<span class="builtinfunc" id="8217555">len</span><span class="op" id="8217558">(</span><span class="ident" id="8217559">input</span><span class="op" id="8217564">)</span><span class="op" id="8217565">;</span>&nbsp;<span class="ident" id="8217567">pos</span>&nbsp;<span class="op" id="8217571">+=</span>&nbsp;<span class="ident" id="8217574">bs</span>&nbsp;<span class="op" id="8217577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217582">end</span>&nbsp;<span class="op" id="8217586">:=</span>&nbsp;<span class="ident" id="8217589">pos</span>&nbsp;<span class="op" id="8217593">+</span>&nbsp;<span class="ident" id="8217595">bs</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8217601">if</span>&nbsp;<span class="ident" id="8217604">end</span>&nbsp;<span class="op" id="8217608">&gt;</span>&nbsp;<span class="builtinfunc" id="8217610">len</span><span class="op" id="8217613">(</span><span class="ident" id="8217614">input</span><span class="op" id="8217619">)</span>&nbsp;<span class="op" id="8217621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217627">end</span>&nbsp;<span class="op" id="8217631">=</span>&nbsp;<span class="builtinfunc" id="8217633">len</span><span class="op" id="8217636">(</span><span class="ident" id="8217637">input</span><span class="op" id="8217642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8217647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217652">n</span><span class="op" id="8217653">,</span>&nbsp;<span class="ident" id="8217655">err</span>&nbsp;<span class="op" id="8217659">:=</span>&nbsp;<span class="ident" id="8217662">encoder</span><span class="op" id="8217669">.</span><span class="ident" id="8217670">Write</span><span class="op" id="8217675">(</span><span class="ident" id="8217676">input</span><span class="op" id="8217681">[</span><span class="ident" id="8217682">pos</span><span class="op" id="8217685">:</span><span class="ident" id="8217686">end</span><span class="op" id="8217689">]</span><span class="op" id="8217690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217695">testEqual</span><span class="op" id="8217704">(</span><span class="ident" id="8217705">t</span><span class="op" id="8217706">,</span>&nbsp;<span class="string" id="8217708">&#34;Write(%q)&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8217742">,</span>&nbsp;<span class="ident" id="8217744">input</span><span class="op" id="8217749">[</span><span class="ident" id="8217750">pos</span><span class="op" id="8217753">:</span><span class="ident" id="8217754">end</span><span class="op" id="8217757">]</span><span class="op" id="8217758">,</span>&nbsp;<span class="ident" id="8217760">err</span><span class="op" id="8217763">,</span>&nbsp;<span class="builtintype" id="8217765">error</span><span class="op" id="8217770">(</span><span class="builtintype" id="8217771">nil</span><span class="op" id="8217774">)</span><span class="op" id="8217775">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217780">testEqual</span><span class="op" id="8217789">(</span><span class="ident" id="8217790">t</span><span class="op" id="8217791">,</span>&nbsp;<span class="string" id="8217793">&#34;Write(%q)&nbsp;gave&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8217828">,</span>&nbsp;<span class="ident" id="8217830">input</span><span class="op" id="8217835">[</span><span class="ident" id="8217836">pos</span><span class="op" id="8217839">:</span><span class="ident" id="8217840">end</span><span class="op" id="8217843">]</span><span class="op" id="8217844">,</span>&nbsp;<span class="ident" id="8217846">n</span><span class="op" id="8217847">,</span>&nbsp;<span class="ident" id="8217849">end</span><span class="op" id="8217852">-</span><span class="ident" id="8217853">pos</span><span class="op" id="8217856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8217860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217864">err</span>&nbsp;<span class="op" id="8217868">:=</span>&nbsp;<span class="ident" id="8217871">encoder</span><span class="op" id="8217878">.</span><span class="ident" id="8217879">Close</span><span class="op" id="8217884">(</span><span class="op" id="8217885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217889">testEqual</span><span class="op" id="8217898">(</span><span class="ident" id="8217899">t</span><span class="op" id="8217900">,</span>&nbsp;<span class="string" id="8217902">&#34;Close&nbsp;gave&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8217932">,</span>&nbsp;<span class="ident" id="8217934">err</span><span class="op" id="8217937">,</span>&nbsp;<span class="builtintype" id="8217939">error</span><span class="op" id="8217944">(</span><span class="builtintype" id="8217945">nil</span><span class="op" id="8217948">)</span><span class="op" id="8217949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8217953">testEqual</span><span class="op" id="8217962">(</span><span class="ident" id="8217963">t</span><span class="op" id="8217964">,</span>&nbsp;<span class="string" id="8217966">&#34;Encoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8217999">,</span>&nbsp;<span class="ident" id="8218001">bs</span><span class="op" id="8218003">,</span>&nbsp;<span class="ident" id="8218005">bigtest</span><span class="op" id="8218012">.</span><span class="ident" id="8218013">decoded</span><span class="op" id="8218020">,</span>&nbsp;<span class="ident" id="8218022">bb</span><span class="op" id="8218024">.</span><span class="ident" id="8218025">String</span><span class="op" id="8218031">(</span><span class="op" id="8218032">)</span><span class="op" id="8218033">,</span>&nbsp;<span class="ident" id="8218035">bigtest</span><span class="op" id="8218042">.</span><span class="ident" id="8218043">encoded</span><span class="op" id="8218050">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8218053">}</span><br>
<span class="lineno"></span><span class="op" id="8218055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8218058">func</span>&nbsp;<span class="ident" id="8218063">TestDecode</span><span class="op" id="8218073">(</span><span class="ident" id="8218074">t</span>&nbsp;<span class="op" id="8218076">*</span><span class="ident" id="8218077">testing</span><span class="op" id="8218084">.</span><span class="ident" id="8218085">T</span><span class="op" id="8218086">)</span>&nbsp;<span class="op" id="8218088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8218091">for</span>&nbsp;<span class="ident" id="8218095">_</span><span class="op" id="8218096">,</span>&nbsp;<span class="ident" id="8218098">p</span>&nbsp;<span class="op" id="8218100">:=</span>&nbsp;<span class="keyword" id="8218103">range</span>&nbsp;<span class="ident" id="8218109">pairs</span>&nbsp;<span class="op" id="8218115">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218119">dbuf</span>&nbsp;<span class="op" id="8218124">:=</span>&nbsp;<span class="builtinfunc" id="8218127">make</span><span class="op" id="8218131">(</span><span class="op" id="8218132">[</span><span class="op" id="8218133">]</span><span class="builtintype" id="8218134">byte</span><span class="op" id="8218138">,</span>&nbsp;<span class="ident" id="8218140">StdEncoding</span><span class="op" id="8218151">.</span><span class="ident" id="8218152">DecodedLen</span><span class="op" id="8218162">(</span><span class="builtinfunc" id="8218163">len</span><span class="op" id="8218166">(</span><span class="ident" id="8218167">p</span><span class="op" id="8218168">.</span><span class="ident" id="8218169">encoded</span><span class="op" id="8218176">)</span><span class="op" id="8218177">)</span><span class="op" id="8218178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218182">count</span><span class="op" id="8218187">,</span>&nbsp;<span class="ident" id="8218189">end</span><span class="op" id="8218192">,</span>&nbsp;<span class="ident" id="8218194">err</span>&nbsp;<span class="op" id="8218198">:=</span>&nbsp;<span class="ident" id="8218201">StdEncoding</span><span class="op" id="8218212">.</span><span class="ident" id="8218213">decode</span><span class="op" id="8218219">(</span><span class="ident" id="8218220">dbuf</span><span class="op" id="8218224">,</span>&nbsp;<span class="op" id="8218226">[</span><span class="op" id="8218227">]</span><span class="builtintype" id="8218228">byte</span><span class="op" id="8218232">(</span><span class="ident" id="8218233">p</span><span class="op" id="8218234">.</span><span class="ident" id="8218235">encoded</span><span class="op" id="8218242">)</span><span class="op" id="8218243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218247">testEqual</span><span class="op" id="8218256">(</span><span class="ident" id="8218257">t</span><span class="op" id="8218258">,</span>&nbsp;<span class="string" id="8218260">&#34;Decode(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8218292">,</span>&nbsp;<span class="ident" id="8218294">p</span><span class="op" id="8218295">.</span><span class="ident" id="8218296">encoded</span><span class="op" id="8218303">,</span>&nbsp;<span class="ident" id="8218305">err</span><span class="op" id="8218308">,</span>&nbsp;<span class="builtintype" id="8218310">error</span><span class="op" id="8218315">(</span><span class="builtintype" id="8218316">nil</span><span class="op" id="8218319">)</span><span class="op" id="8218320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218324">testEqual</span><span class="op" id="8218333">(</span><span class="ident" id="8218334">t</span><span class="op" id="8218335">,</span>&nbsp;<span class="string" id="8218337">&#34;Decode(%q)&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8218370">,</span>&nbsp;<span class="ident" id="8218372">p</span><span class="op" id="8218373">.</span><span class="ident" id="8218374">encoded</span><span class="op" id="8218381">,</span>&nbsp;<span class="ident" id="8218383">count</span><span class="op" id="8218388">,</span>&nbsp;<span class="builtinfunc" id="8218390">len</span><span class="op" id="8218393">(</span><span class="ident" id="8218394">p</span><span class="op" id="8218395">.</span><span class="ident" id="8218396">decoded</span><span class="op" id="8218403">)</span><span class="op" id="8218404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8218408">if</span>&nbsp;<span class="builtinfunc" id="8218411">len</span><span class="op" id="8218414">(</span><span class="ident" id="8218415">p</span><span class="op" id="8218416">.</span><span class="ident" id="8218417">encoded</span><span class="op" id="8218424">)</span>&nbsp;<span class="op" id="8218426">&gt;</span>&nbsp;<span class="num" id="8218428">0</span>&nbsp;<span class="op" id="8218430">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218435">testEqual</span><span class="op" id="8218444">(</span><span class="ident" id="8218445">t</span><span class="op" id="8218446">,</span>&nbsp;<span class="string" id="8218448">&#34;Decode(%q)&nbsp;=&nbsp;end&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8218478">,</span>&nbsp;<span class="ident" id="8218480">p</span><span class="op" id="8218481">.</span><span class="ident" id="8218482">encoded</span><span class="op" id="8218489">,</span>&nbsp;<span class="ident" id="8218491">end</span><span class="op" id="8218494">,</span>&nbsp;<span class="op" id="8218496">(</span><span class="ident" id="8218497">p</span><span class="op" id="8218498">.</span><span class="ident" id="8218499">encoded</span><span class="op" id="8218506">[</span><span class="builtinfunc" id="8218507">len</span><span class="op" id="8218510">(</span><span class="ident" id="8218511">p</span><span class="op" id="8218512">.</span><span class="ident" id="8218513">encoded</span><span class="op" id="8218520">)</span><span class="op" id="8218521">-</span><span class="num" id="8218522">1</span><span class="op" id="8218523">]</span>&nbsp;<span class="op" id="8218525">==</span>&nbsp;<span class="string" id="8218528">&#39;=&#39;</span><span class="op" id="8218531">)</span><span class="op" id="8218532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8218536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218540">testEqual</span><span class="op" id="8218549">(</span><span class="ident" id="8218550">t</span><span class="op" id="8218551">,</span>&nbsp;<span class="string" id="8218553">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8218579">,</span>&nbsp;<span class="ident" id="8218581">p</span><span class="op" id="8218582">.</span><span class="ident" id="8218583">encoded</span><span class="op" id="8218590">,</span>&nbsp;<span class="builtintype" id="8218592">string</span><span class="op" id="8218598">(</span><span class="ident" id="8218599">dbuf</span><span class="op" id="8218603">[</span><span class="num" id="8218604">0</span><span class="op" id="8218605">:</span><span class="ident" id="8218606">count</span><span class="op" id="8218611">]</span><span class="op" id="8218612">)</span><span class="op" id="8218613">,</span>&nbsp;<span class="ident" id="8218615">p</span><span class="op" id="8218616">.</span><span class="ident" id="8218617">decoded</span><span class="op" id="8218624">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218629">dbuf</span><span class="op" id="8218633">,</span>&nbsp;<span class="ident" id="8218635">err</span>&nbsp;<span class="op" id="8218639">=</span>&nbsp;<span class="ident" id="8218641">StdEncoding</span><span class="op" id="8218652">.</span><span class="ident" id="8218653">DecodeString</span><span class="op" id="8218665">(</span><span class="ident" id="8218666">p</span><span class="op" id="8218667">.</span><span class="ident" id="8218668">encoded</span><span class="op" id="8218675">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218679">testEqual</span><span class="op" id="8218688">(</span><span class="ident" id="8218689">t</span><span class="op" id="8218690">,</span>&nbsp;<span class="string" id="8218692">&#34;DecodeString(%q)&nbsp;=&nbsp;error&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8218730">,</span>&nbsp;<span class="ident" id="8218732">p</span><span class="op" id="8218733">.</span><span class="ident" id="8218734">encoded</span><span class="op" id="8218741">,</span>&nbsp;<span class="ident" id="8218743">err</span><span class="op" id="8218746">,</span>&nbsp;<span class="builtintype" id="8218748">error</span><span class="op" id="8218753">(</span><span class="builtintype" id="8218754">nil</span><span class="op" id="8218757">)</span><span class="op" id="8218758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218762">testEqual</span><span class="op" id="8218771">(</span><span class="ident" id="8218772">t</span><span class="op" id="8218773">,</span>&nbsp;<span class="string" id="8218775">&#34;DecodeString(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8218807">,</span>&nbsp;<span class="builtintype" id="8218809">string</span><span class="op" id="8218815">(</span><span class="ident" id="8218816">dbuf</span><span class="op" id="8218820">)</span><span class="op" id="8218821">,</span>&nbsp;<span class="ident" id="8218823">p</span><span class="op" id="8218824">.</span><span class="ident" id="8218825">decoded</span><span class="op" id="8218832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8218835">}</span><br>
<span class="lineno"></span><span class="op" id="8218837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="8218840">func</span>&nbsp;<span class="ident" id="8218845">TestDecoder</span><span class="op" id="8218856">(</span><span class="ident" id="8218857">t</span>&nbsp;<span class="op" id="8218859">*</span><span class="ident" id="8218860">testing</span><span class="op" id="8218867">.</span><span class="ident" id="8218868">T</span><span class="op" id="8218869">)</span>&nbsp;<span class="op" id="8218871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8218874">for</span>&nbsp;<span class="ident" id="8218878">_</span><span class="op" id="8218879">,</span>&nbsp;<span class="ident" id="8218881">p</span>&nbsp;<span class="op" id="8218883">:=</span>&nbsp;<span class="keyword" id="8218886">range</span>&nbsp;<span class="ident" id="8218892">pairs</span>&nbsp;<span class="op" id="8218898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218902">decoder</span>&nbsp;<span class="op" id="8218910">:=</span>&nbsp;<span class="ident" id="8218913">NewDecoder</span><span class="op" id="8218923">(</span><span class="ident" id="8218924">StdEncoding</span><span class="op" id="8218935">,</span>&nbsp;<span class="ident" id="8218937">strings</span><span class="op" id="8218944">.</span><span class="ident" id="8218945">NewReader</span><span class="op" id="8218954">(</span><span class="ident" id="8218955">p</span><span class="op" id="8218956">.</span><span class="ident" id="8218957">encoded</span><span class="op" id="8218964">)</span><span class="op" id="8218965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8218969">dbuf</span>&nbsp;<span class="op" id="8218974">:=</span>&nbsp;<span class="builtinfunc" id="8218977">make</span><span class="op" id="8218981">(</span><span class="op" id="8218982">[</span><span class="op" id="8218983">]</span><span class="builtintype" id="8218984">byte</span><span class="op" id="8218988">,</span>&nbsp;<span class="ident" id="8218990">StdEncoding</span><span class="op" id="8219001">.</span><span class="ident" id="8219002">DecodedLen</span><span class="op" id="8219012">(</span><span class="builtinfunc" id="8219013">len</span><span class="op" id="8219016">(</span><span class="ident" id="8219017">p</span><span class="op" id="8219018">.</span><span class="ident" id="8219019">encoded</span><span class="op" id="8219026">)</span><span class="op" id="8219027">)</span><span class="op" id="8219028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8219032">count</span><span class="op" id="8219037">,</span>&nbsp;<span class="ident" id="8219039">err</span>&nbsp;<span class="op" id="8219043">:=</span>&nbsp;<span class="ident" id="8219046">decoder</span><span class="op" id="8219053">.</span><span class="ident" id="8219054">Read</span><span class="op" id="8219058">(</span><span class="ident" id="8219059">dbuf</span><span class="op" id="8219063">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8219067">if</span>&nbsp;<span class="ident" id="8219070">err</span>&nbsp;<span class="op" id="8219074">!=</span>&nbsp;<span class="builtintype" id="8219077">nil</span>&nbsp;<span class="op" id="8219081">&amp;&amp;</span>&nbsp;<span class="ident" id="8219084">err</span>&nbsp;<span class="op" id="8219088">!=</span>&nbsp;<span class="ident" id="8219091">io</span><span class="op" id="8219093">.</span><span class="ident" id="8219094">EOF</span>&nbsp;<span class="op" id="8219098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8219103">t</span><span class="op" id="8219104">.</span><span class="ident" id="8219105">Fatal</span><span class="op" id="8219110">(</span><span class="string" id="8219111">&#34;Read&nbsp;failed&#34;</span><span class="op" id="8219124">,</span>&nbsp;<span class="ident" id="8219126">err</span><span class="op" id="8219129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8219133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8219137">testEqual</span><span class="op" id="8219146">(</span><span class="ident" id="8219147">t</span><span class="op" id="8219148">,</span>&nbsp;<span class="string" id="8219150">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;length&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8219185">,</span>&nbsp;<span class="ident" id="8219187">p</span><span class="op" id="8219188">.</span><span class="ident" id="8219189">encoded</span><span class="op" id="8219196">,</span>&nbsp;<span class="ident" id="8219198">count</span><span class="op" id="8219203">,</span>&nbsp;<span class="builtinfunc" id="8219205">len</span><span class="op" id="8219208">(</span><span class="ident" id="8219209">p</span><span class="op" id="8219210">.</span><span class="ident" id="8219211">decoded</span><span class="op" id="8219218">)</span><span class="op" id="8219219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8219223">testEqual</span><span class="op" id="8219232">(</span><span class="ident" id="8219233">t</span><span class="op" id="8219234">,</span>&nbsp;<span class="string" id="8219236">&#34;Decoding&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8219266">,</span>&nbsp;<span class="ident" id="8219268">p</span><span class="op" id="8219269">.</span><span class="ident" id="8219270">encoded</span><span class="op" id="8219277">,</span>&nbsp;<span class="builtintype" id="8219279">string</span><span class="op" id="8219285">(</span><span class="ident" id="8219286">dbuf</span><span class="op" id="8219290">[</span><span class="num" id="8219291">0</span><span class="op" id="8219292">:</span><span class="ident" id="8219293">count</span><span class="op" id="8219298">]</span><span class="op" id="8219299">)</span><span class="op" id="8219300">,</span>&nbsp;<span class="ident" id="8219302">p</span><span class="op" id="8219303">.</span><span class="ident" id="8219304">decoded</span><span class="op" id="8219311">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8219315">if</span>&nbsp;<span class="ident" id="8219318">err</span>&nbsp;<span class="op" id="8219322">!=</span>&nbsp;<span class="ident" id="8219325">io</span><span class="op" id="8219327">.</span><span class="ident" id="8219328">EOF</span>&nbsp;<span class="op" id="8219332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8219337">count</span><span class="op" id="8219342">,</span>&nbsp;<span class="ident" id="8219344">err</span>&nbsp;<span class="op" id="8219348">=</span>&nbsp;<span class="ident" id="8219350">decoder</span><span class="op" id="8219357">.</span><span class="ident" id="8219358">Read</span><span class="op" id="8219362">(</span><span class="ident" id="8219363">dbuf</span><span class="op" id="8219367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8219371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8219375">testEqual</span><span class="op" id="8219384">(</span><span class="ident" id="8219385">t</span><span class="op" id="8219386">,</span>&nbsp;<span class="string" id="8219388">&#34;Read&nbsp;from&nbsp;%q&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8219416">,</span>&nbsp;<span class="ident" id="8219418">p</span><span class="op" id="8219419">.</span><span class="ident" id="8219420">encoded</span><span class="op" id="8219427">,</span>&nbsp;<span class="ident" id="8219429">err</span><span class="op" id="8219432">,</span>&nbsp;<span class="ident" id="8219434">io</span><span class="op" id="8219436">.</span><span class="ident" id="8219437">EOF</span><span class="op" id="8219440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8219443">}</span><br>
<span class="lineno">130</span><span class="op" id="8219445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8219448">func</span>&nbsp;<span class="ident" id="8219453">TestDecoderBuffering</span><span class="op" id="8219473">(</span><span class="ident" id="8219474">t</span>&nbsp;<span class="op" id="8219476">*</span><span class="ident" id="8219477">testing</span><span class="op" id="8219484">.</span><span class="ident" id="8219485">T</span><span class="op" id="8219486">)</span>&nbsp;<span class="op" id="8219488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8219491">for</span>&nbsp;<span class="ident" id="8219495">bs</span>&nbsp;<span class="op" id="8219498">:=</span>&nbsp;<span class="num" id="8219501">1</span><span class="op" id="8219502">;</span>&nbsp;<span class="ident" id="8219504">bs</span>&nbsp;<span class="op" id="8219507">&lt;=</span>&nbsp;<span class="num" id="8219510">12</span><span class="op" id="8219512">;</span>&nbsp;<span class="ident" id="8219514">bs</span><span class="op" id="8219516">++</span>&nbsp;<span class="op" id="8219519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8219523">decoder</span>&nbsp;<span class="op" id="8219531">:=</span>&nbsp;<span class="ident" id="8219534">NewDecoder</span><span class="op" id="8219544">(</span><span class="ident" id="8219545">StdEncoding</span><span class="op" id="8219556">,</span>&nbsp;<span class="ident" id="8219558">strings</span><span class="op" id="8219565">.</span><span class="ident" id="8219566">NewReader</span><span class="op" id="8219575">(</span><span class="ident" id="8219576">bigtest</span><span class="op" id="8219583">.</span><span class="ident" id="8219584">encoded</span><span class="op" id="8219591">)</span><span class="op" id="8219592">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8219596">buf</span>&nbsp;<span class="op" id="8219600">:=</span>&nbsp;<span class="builtinfunc" id="8219603">make</span><span class="op" id="8219607">(</span><span class="op" id="8219608">[</span><span class="op" id="8219609">]</span><span class="builtintype" id="8219610">byte</span><span class="op" id="8219614">,</span>&nbsp;<span class="builtinfunc" id="8219616">len</span><span class="op" id="8219619">(</span><span class="ident" id="8219620">bigtest</span><span class="op" id="8219627">.</span><span class="ident" id="8219628">decoded</span><span class="op" id="8219635">)</span><span class="op" id="8219636">+</span><span class="num" id="8219637">12</span><span class="op" id="8219639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8219643">var</span>&nbsp;<span class="ident" id="8219647">total</span>&nbsp;<span class="builtintype" id="8219653">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8219659">for</span>&nbsp;<span class="ident" id="8219663">total</span>&nbsp;<span class="op" id="8219669">=</span>&nbsp;<span class="num" id="8219671">0</span><span class="op" id="8219672">;</span>&nbsp;<span class="ident" id="8219674">total</span>&nbsp;<span class="op" id="8219680">&lt;</span>&nbsp;<span class="builtinfunc" id="8219682">len</span><span class="op" id="8219685">(</span><span class="ident" id="8219686">bigtest</span><span class="op" id="8219693">.</span><span class="ident" id="8219694">decoded</span><span class="op" id="8219701">)</span><span class="op" id="8219702">;</span>&nbsp;<span class="op" id="8219704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8219709">n</span><span class="op" id="8219710">,</span>&nbsp;<span class="ident" id="8219712">err</span>&nbsp;<span class="op" id="8219716">:=</span>&nbsp;<span class="ident" id="8219719">decoder</span><span class="op" id="8219726">.</span><span class="ident" id="8219727">Read</span><span class="op" id="8219731">(</span><span class="ident" id="8219732">buf</span><span class="op" id="8219735">[</span><span class="ident" id="8219736">total</span>&nbsp;<span class="op" id="8219742">:</span>&nbsp;<span class="ident" id="8219744">total</span><span class="op" id="8219749">+</span><span class="ident" id="8219750">bs</span><span class="op" id="8219752">]</span><span class="op" id="8219753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8219758">testEqual</span><span class="op" id="8219767">(</span><span class="ident" id="8219768">t</span><span class="op" id="8219769">,</span>&nbsp;<span class="string" id="8219771">&#34;Read&nbsp;from&nbsp;%q&nbsp;at&nbsp;pos&nbsp;%d&nbsp;=&nbsp;%d,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="8219816">,</span>&nbsp;<span class="ident" id="8219818">bigtest</span><span class="op" id="8219825">.</span><span class="ident" id="8219826">encoded</span><span class="op" id="8219833">,</span>&nbsp;<span class="ident" id="8219835">total</span><span class="op" id="8219840">,</span>&nbsp;<span class="ident" id="8219842">n</span><span class="op" id="8219843">,</span>&nbsp;<span class="ident" id="8219845">err</span><span class="op" id="8219848">,</span>&nbsp;<span class="builtintype" id="8219850">error</span><span class="op" id="8219855">(</span><span class="builtintype" id="8219856">nil</span><span class="op" id="8219859">)</span><span class="op" id="8219860">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8219865">total</span>&nbsp;<span class="op" id="8219871">+=</span>&nbsp;<span class="ident" id="8219874">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8219878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8219882">testEqual</span><span class="op" id="8219891">(</span><span class="ident" id="8219892">t</span><span class="op" id="8219893">,</span>&nbsp;<span class="string" id="8219895">&#34;Decoding/%d&nbsp;of&nbsp;%q&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8219928">,</span>&nbsp;<span class="ident" id="8219930">bs</span><span class="op" id="8219932">,</span>&nbsp;<span class="ident" id="8219934">bigtest</span><span class="op" id="8219941">.</span><span class="ident" id="8219942">encoded</span><span class="op" id="8219949">,</span>&nbsp;<span class="builtintype" id="8219951">string</span><span class="op" id="8219957">(</span><span class="ident" id="8219958">buf</span><span class="op" id="8219961">[</span><span class="num" id="8219962">0</span><span class="op" id="8219963">:</span><span class="ident" id="8219964">total</span><span class="op" id="8219969">]</span><span class="op" id="8219970">)</span><span class="op" id="8219971">,</span>&nbsp;<span class="ident" id="8219973">bigtest</span><span class="op" id="8219980">.</span><span class="ident" id="8219981">decoded</span><span class="op" id="8219988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8219991">}</span><br>
<span class="lineno"></span><span class="op" id="8219993">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="8219996">func</span>&nbsp;<span class="ident" id="8220001">TestDecodeCorrupt</span><span class="op" id="8220018">(</span><span class="ident" id="8220019">t</span>&nbsp;<span class="op" id="8220021">*</span><span class="ident" id="8220022">testing</span><span class="op" id="8220029">.</span><span class="ident" id="8220030">T</span><span class="op" id="8220031">)</span>&nbsp;<span class="op" id="8220033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220036">testCases</span>&nbsp;<span class="op" id="8220046">:=</span>&nbsp;<span class="op" id="8220049">[</span><span class="op" id="8220050">]</span><span class="keyword" id="8220051">struct</span>&nbsp;<span class="op" id="8220058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220062">input</span>&nbsp;&nbsp;<span class="builtintype" id="8220069">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220078">offset</span>&nbsp;<span class="builtintype" id="8220085">int</span>&nbsp;<span class="comment" id="8220089">//&nbsp;-1&nbsp;means&nbsp;no&nbsp;corruption.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220117">}</span><span class="op" id="8220118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220122">{</span><span class="string" id="8220123">&#34;&#34;</span><span class="op" id="8220125">,</span>&nbsp;<span class="op" id="8220127">-</span><span class="num" id="8220128">1</span><span class="op" id="8220129">}</span><span class="op" id="8220130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220134">{</span><span class="string" id="8220135">&#34;!!!!&#34;</span><span class="op" id="8220141">,</span>&nbsp;<span class="num" id="8220143">0</span><span class="op" id="8220144">}</span><span class="op" id="8220145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220149">{</span><span class="string" id="8220150">&#34;====&#34;</span><span class="op" id="8220156">,</span>&nbsp;<span class="num" id="8220158">0</span><span class="op" id="8220159">}</span><span class="op" id="8220160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220164">{</span><span class="string" id="8220165">&#34;x===&#34;</span><span class="op" id="8220171">,</span>&nbsp;<span class="num" id="8220173">1</span><span class="op" id="8220174">}</span><span class="op" id="8220175">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220179">{</span><span class="string" id="8220180">&#34;=AAA&#34;</span><span class="op" id="8220186">,</span>&nbsp;<span class="num" id="8220188">0</span><span class="op" id="8220189">}</span><span class="op" id="8220190">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220194">{</span><span class="string" id="8220195">&#34;A=AA&#34;</span><span class="op" id="8220201">,</span>&nbsp;<span class="num" id="8220203">1</span><span class="op" id="8220204">}</span><span class="op" id="8220205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220209">{</span><span class="string" id="8220210">&#34;AA=A&#34;</span><span class="op" id="8220216">,</span>&nbsp;<span class="num" id="8220218">2</span><span class="op" id="8220219">}</span><span class="op" id="8220220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220224">{</span><span class="string" id="8220225">&#34;AA==A&#34;</span><span class="op" id="8220232">,</span>&nbsp;<span class="num" id="8220234">4</span><span class="op" id="8220235">}</span><span class="op" id="8220236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220240">{</span><span class="string" id="8220241">&#34;AAA=AAAA&#34;</span><span class="op" id="8220251">,</span>&nbsp;<span class="num" id="8220253">4</span><span class="op" id="8220254">}</span><span class="op" id="8220255">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220259">{</span><span class="string" id="8220260">&#34;AAAAA&#34;</span><span class="op" id="8220267">,</span>&nbsp;<span class="num" id="8220269">4</span><span class="op" id="8220270">}</span><span class="op" id="8220271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220275">{</span><span class="string" id="8220276">&#34;AAAAAA&#34;</span><span class="op" id="8220284">,</span>&nbsp;<span class="num" id="8220286">4</span><span class="op" id="8220287">}</span><span class="op" id="8220288">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220292">{</span><span class="string" id="8220293">&#34;A=&#34;</span><span class="op" id="8220297">,</span>&nbsp;<span class="num" id="8220299">1</span><span class="op" id="8220300">}</span><span class="op" id="8220301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220305">{</span><span class="string" id="8220306">&#34;A==&#34;</span><span class="op" id="8220311">,</span>&nbsp;<span class="num" id="8220313">1</span><span class="op" id="8220314">}</span><span class="op" id="8220315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220319">{</span><span class="string" id="8220320">&#34;AA=&#34;</span><span class="op" id="8220325">,</span>&nbsp;<span class="num" id="8220327">3</span><span class="op" id="8220328">}</span><span class="op" id="8220329">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220333">{</span><span class="string" id="8220334">&#34;AA==&#34;</span><span class="op" id="8220340">,</span>&nbsp;<span class="op" id="8220342">-</span><span class="num" id="8220343">1</span><span class="op" id="8220344">}</span><span class="op" id="8220345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220349">{</span><span class="string" id="8220350">&#34;AAA=&#34;</span><span class="op" id="8220356">,</span>&nbsp;<span class="op" id="8220358">-</span><span class="num" id="8220359">1</span><span class="op" id="8220360">}</span><span class="op" id="8220361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220365">{</span><span class="string" id="8220366">&#34;AAAA&#34;</span><span class="op" id="8220372">,</span>&nbsp;<span class="op" id="8220374">-</span><span class="num" id="8220375">1</span><span class="op" id="8220376">}</span><span class="op" id="8220377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220381">{</span><span class="string" id="8220382">&#34;AAAAAA=&#34;</span><span class="op" id="8220391">,</span>&nbsp;<span class="num" id="8220393">7</span><span class="op" id="8220394">}</span><span class="op" id="8220395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220399">{</span><span class="string" id="8220400">&#34;YWJjZA=====&#34;</span><span class="op" id="8220413">,</span>&nbsp;<span class="num" id="8220415">8</span><span class="op" id="8220416">}</span><span class="op" id="8220417">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8220423">for</span>&nbsp;<span class="ident" id="8220427">_</span><span class="op" id="8220428">,</span>&nbsp;<span class="ident" id="8220430">tc</span>&nbsp;<span class="op" id="8220433">:=</span>&nbsp;<span class="keyword" id="8220436">range</span>&nbsp;<span class="ident" id="8220442">testCases</span>&nbsp;<span class="op" id="8220452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220456">dbuf</span>&nbsp;<span class="op" id="8220461">:=</span>&nbsp;<span class="builtinfunc" id="8220464">make</span><span class="op" id="8220468">(</span><span class="op" id="8220469">[</span><span class="op" id="8220470">]</span><span class="builtintype" id="8220471">byte</span><span class="op" id="8220475">,</span>&nbsp;<span class="ident" id="8220477">StdEncoding</span><span class="op" id="8220488">.</span><span class="ident" id="8220489">DecodedLen</span><span class="op" id="8220499">(</span><span class="builtinfunc" id="8220500">len</span><span class="op" id="8220503">(</span><span class="ident" id="8220504">tc</span><span class="op" id="8220506">.</span><span class="ident" id="8220507">input</span><span class="op" id="8220512">)</span><span class="op" id="8220513">)</span><span class="op" id="8220514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220518">_</span><span class="op" id="8220519">,</span>&nbsp;<span class="ident" id="8220521">err</span>&nbsp;<span class="op" id="8220525">:=</span>&nbsp;<span class="ident" id="8220528">StdEncoding</span><span class="op" id="8220539">.</span><span class="ident" id="8220540">Decode</span><span class="op" id="8220546">(</span><span class="ident" id="8220547">dbuf</span><span class="op" id="8220551">,</span>&nbsp;<span class="op" id="8220553">[</span><span class="op" id="8220554">]</span><span class="builtintype" id="8220555">byte</span><span class="op" id="8220559">(</span><span class="ident" id="8220560">tc</span><span class="op" id="8220562">.</span><span class="ident" id="8220563">input</span><span class="op" id="8220568">)</span><span class="op" id="8220569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8220573">if</span>&nbsp;<span class="ident" id="8220576">tc</span><span class="op" id="8220578">.</span><span class="ident" id="8220579">offset</span>&nbsp;<span class="op" id="8220586">==</span>&nbsp;<span class="op" id="8220589">-</span><span class="num" id="8220590">1</span>&nbsp;<span class="op" id="8220592">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8220597">if</span>&nbsp;<span class="ident" id="8220600">err</span>&nbsp;<span class="op" id="8220604">!=</span>&nbsp;<span class="builtintype" id="8220607">nil</span>&nbsp;<span class="op" id="8220611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220617">t</span><span class="op" id="8220618">.</span><span class="ident" id="8220619">Error</span><span class="op" id="8220624">(</span><span class="string" id="8220625">&#34;Decoder&nbsp;wrongly&nbsp;detected&nbsp;coruption&nbsp;in&#34;</span><span class="op" id="8220664">,</span>&nbsp;<span class="ident" id="8220666">tc</span><span class="op" id="8220668">.</span><span class="ident" id="8220669">input</span><span class="op" id="8220674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8220684">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220695">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8220699">switch</span>&nbsp;<span class="ident" id="8220706">err</span>&nbsp;<span class="op" id="8220710">:=</span>&nbsp;<span class="ident" id="8220713">err</span><span class="op" id="8220716">.</span><span class="op" id="8220717">(</span><span class="keyword" id="8220718">type</span><span class="op" id="8220722">)</span>&nbsp;<span class="op" id="8220724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8220728">case</span>&nbsp;<span class="ident" id="8220733">CorruptInputError</span><span class="op" id="8220750">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220755">testEqual</span><span class="op" id="8220764">(</span><span class="ident" id="8220765">t</span><span class="op" id="8220766">,</span>&nbsp;<span class="string" id="8220768">&#34;Corruption&nbsp;in&nbsp;%q&nbsp;at&nbsp;offset&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8220808">,</span>&nbsp;<span class="ident" id="8220810">tc</span><span class="op" id="8220812">.</span><span class="ident" id="8220813">input</span><span class="op" id="8220818">,</span>&nbsp;<span class="builtintype" id="8220820">int</span><span class="op" id="8220823">(</span><span class="ident" id="8220824">err</span><span class="op" id="8220827">)</span><span class="op" id="8220828">,</span>&nbsp;<span class="ident" id="8220830">tc</span><span class="op" id="8220832">.</span><span class="ident" id="8220833">offset</span><span class="op" id="8220839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8220843">default</span><span class="op" id="8220850">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220855">t</span><span class="op" id="8220856">.</span><span class="ident" id="8220857">Error</span><span class="op" id="8220862">(</span><span class="string" id="8220863">&#34;Decoder&nbsp;failed&nbsp;to&nbsp;detect&nbsp;corruption&nbsp;in&#34;</span><span class="op" id="8220903">,</span>&nbsp;<span class="ident" id="8220905">tc</span><span class="op" id="8220907">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8220914">}</span><br>
<span class="lineno"></span><span class="op" id="8220916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8220919">func</span>&nbsp;<span class="ident" id="8220924">TestBig</span><span class="op" id="8220931">(</span><span class="ident" id="8220932">t</span>&nbsp;<span class="op" id="8220934">*</span><span class="ident" id="8220935">testing</span><span class="op" id="8220942">.</span><span class="ident" id="8220943">T</span><span class="op" id="8220944">)</span>&nbsp;<span class="op" id="8220946">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220949">n</span>&nbsp;<span class="op" id="8220951">:=</span>&nbsp;<span class="num" id="8220954">3</span><span class="op" id="8220955">*</span><span class="num" id="8220956">1000</span>&nbsp;<span class="op" id="8220961">+</span>&nbsp;<span class="num" id="8220963">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8220966">raw</span>&nbsp;<span class="op" id="8220970">:=</span>&nbsp;<span class="builtinfunc" id="8220973">make</span><span class="op" id="8220977">(</span><span class="op" id="8220978">[</span><span class="op" id="8220979">]</span><span class="builtintype" id="8220980">byte</span><span class="op" id="8220984">,</span>&nbsp;<span class="ident" id="8220986">n</span><span class="op" id="8220987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8220990">const</span>&nbsp;<span class="ident" id="8220996">alpha</span>&nbsp;<span class="op" id="8221002">=</span>&nbsp;<span class="string" id="8221004">&#34;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221070">for</span>&nbsp;<span class="ident" id="8221074">i</span>&nbsp;<span class="op" id="8221076">:=</span>&nbsp;<span class="num" id="8221079">0</span><span class="op" id="8221080">;</span>&nbsp;<span class="ident" id="8221082">i</span>&nbsp;<span class="op" id="8221084">&lt;</span>&nbsp;<span class="ident" id="8221086">n</span><span class="op" id="8221087">;</span>&nbsp;<span class="ident" id="8221089">i</span><span class="op" id="8221090">++</span>&nbsp;<span class="op" id="8221093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221097">raw</span><span class="op" id="8221100">[</span><span class="ident" id="8221101">i</span><span class="op" id="8221102">]</span>&nbsp;<span class="op" id="8221104">=</span>&nbsp;<span class="ident" id="8221106">alpha</span><span class="op" id="8221111">[</span><span class="ident" id="8221112">i</span><span class="op" id="8221113">%</span><span class="builtinfunc" id="8221114">len</span><span class="op" id="8221117">(</span><span class="ident" id="8221118">alpha</span><span class="op" id="8221123">)</span><span class="op" id="8221124">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221130">encoded</span>&nbsp;<span class="op" id="8221138">:=</span>&nbsp;<span class="builtinfunc" id="8221141">new</span><span class="op" id="8221144">(</span><span class="ident" id="8221145">bytes</span><span class="op" id="8221150">.</span><span class="ident" id="8221151">Buffer</span><span class="op" id="8221157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221160">w</span>&nbsp;<span class="op" id="8221162">:=</span>&nbsp;<span class="ident" id="8221165">NewEncoder</span><span class="op" id="8221175">(</span><span class="ident" id="8221176">StdEncoding</span><span class="op" id="8221187">,</span>&nbsp;<span class="ident" id="8221189">encoded</span><span class="op" id="8221196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221199">nn</span><span class="op" id="8221201">,</span>&nbsp;<span class="ident" id="8221203">err</span>&nbsp;<span class="op" id="8221207">:=</span>&nbsp;<span class="ident" id="8221210">w</span><span class="op" id="8221211">.</span><span class="ident" id="8221212">Write</span><span class="op" id="8221217">(</span><span class="ident" id="8221218">raw</span><span class="op" id="8221221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221224">if</span>&nbsp;<span class="ident" id="8221227">nn</span>&nbsp;<span class="op" id="8221230">!=</span>&nbsp;<span class="ident" id="8221233">n</span>&nbsp;<span class="op" id="8221235">||</span>&nbsp;<span class="ident" id="8221238">err</span>&nbsp;<span class="op" id="8221242">!=</span>&nbsp;<span class="builtintype" id="8221245">nil</span>&nbsp;<span class="op" id="8221249">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221253">t</span><span class="op" id="8221254">.</span><span class="ident" id="8221255">Fatalf</span><span class="op" id="8221261">(</span><span class="string" id="8221262">&#34;Encoder.Write(raw)&nbsp;=&nbsp;%d,&nbsp;%v&nbsp;want&nbsp;%d,&nbsp;nil&#34;</span><span class="op" id="8221304">,</span>&nbsp;<span class="ident" id="8221306">nn</span><span class="op" id="8221308">,</span>&nbsp;<span class="ident" id="8221310">err</span><span class="op" id="8221313">,</span>&nbsp;<span class="ident" id="8221315">n</span><span class="op" id="8221316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221322">err</span>&nbsp;<span class="op" id="8221326">=</span>&nbsp;<span class="ident" id="8221328">w</span><span class="op" id="8221329">.</span><span class="ident" id="8221330">Close</span><span class="op" id="8221335">(</span><span class="op" id="8221336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221339">if</span>&nbsp;<span class="ident" id="8221342">err</span>&nbsp;<span class="op" id="8221346">!=</span>&nbsp;<span class="builtintype" id="8221349">nil</span>&nbsp;<span class="op" id="8221353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221357">t</span><span class="op" id="8221358">.</span><span class="ident" id="8221359">Fatalf</span><span class="op" id="8221365">(</span><span class="string" id="8221366">&#34;Encoder.Close()&nbsp;=&nbsp;%v&nbsp;want&nbsp;nil&#34;</span><span class="op" id="8221397">,</span>&nbsp;<span class="ident" id="8221399">err</span><span class="op" id="8221402">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221408">decoded</span><span class="op" id="8221415">,</span>&nbsp;<span class="ident" id="8221417">err</span>&nbsp;<span class="op" id="8221421">:=</span>&nbsp;<span class="ident" id="8221424">ioutil</span><span class="op" id="8221430">.</span><span class="ident" id="8221431">ReadAll</span><span class="op" id="8221438">(</span><span class="ident" id="8221439">NewDecoder</span><span class="op" id="8221449">(</span><span class="ident" id="8221450">StdEncoding</span><span class="op" id="8221461">,</span>&nbsp;<span class="ident" id="8221463">encoded</span><span class="op" id="8221470">)</span><span class="op" id="8221471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221474">if</span>&nbsp;<span class="ident" id="8221477">err</span>&nbsp;<span class="op" id="8221481">!=</span>&nbsp;<span class="builtintype" id="8221484">nil</span>&nbsp;<span class="op" id="8221488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221492">t</span><span class="op" id="8221493">.</span><span class="ident" id="8221494">Fatalf</span><span class="op" id="8221500">(</span><span class="string" id="8221501">&#34;ioutil.ReadAll(NewDecoder(...)):&nbsp;%v&#34;</span><span class="op" id="8221538">,</span>&nbsp;<span class="ident" id="8221540">err</span><span class="op" id="8221543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221546">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221550">if</span>&nbsp;<span class="op" id="8221553">!</span><span class="ident" id="8221554">bytes</span><span class="op" id="8221559">.</span><span class="ident" id="8221560">Equal</span><span class="op" id="8221565">(</span><span class="ident" id="8221566">raw</span><span class="op" id="8221569">,</span>&nbsp;<span class="ident" id="8221571">decoded</span><span class="op" id="8221578">)</span>&nbsp;<span class="op" id="8221580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221584">var</span>&nbsp;<span class="ident" id="8221588">i</span>&nbsp;<span class="builtintype" id="8221590">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221596">for</span>&nbsp;<span class="ident" id="8221600">i</span>&nbsp;<span class="op" id="8221602">=</span>&nbsp;<span class="num" id="8221604">0</span><span class="op" id="8221605">;</span>&nbsp;<span class="ident" id="8221607">i</span>&nbsp;<span class="op" id="8221609">&lt;</span>&nbsp;<span class="builtinfunc" id="8221611">len</span><span class="op" id="8221614">(</span><span class="ident" id="8221615">decoded</span><span class="op" id="8221622">)</span>&nbsp;<span class="op" id="8221624">&amp;&amp;</span>&nbsp;<span class="ident" id="8221627">i</span>&nbsp;<span class="op" id="8221629">&lt;</span>&nbsp;<span class="builtinfunc" id="8221631">len</span><span class="op" id="8221634">(</span><span class="ident" id="8221635">raw</span><span class="op" id="8221638">)</span><span class="op" id="8221639">;</span>&nbsp;<span class="ident" id="8221641">i</span><span class="op" id="8221642">++</span>&nbsp;<span class="op" id="8221645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221650">if</span>&nbsp;<span class="ident" id="8221653">decoded</span><span class="op" id="8221660">[</span><span class="ident" id="8221661">i</span><span class="op" id="8221662">]</span>&nbsp;<span class="op" id="8221664">!=</span>&nbsp;<span class="ident" id="8221667">raw</span><span class="op" id="8221670">[</span><span class="ident" id="8221671">i</span><span class="op" id="8221672">]</span>&nbsp;<span class="op" id="8221674">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221680">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221697">t</span><span class="op" id="8221698">.</span><span class="ident" id="8221699">Errorf</span><span class="op" id="8221705">(</span><span class="string" id="8221706">&#34;Decode(Encode(%d-byte&nbsp;string))&nbsp;failed&nbsp;at&nbsp;offset&nbsp;%d&#34;</span><span class="op" id="8221758">,</span>&nbsp;<span class="ident" id="8221760">n</span><span class="op" id="8221761">,</span>&nbsp;<span class="ident" id="8221763">i</span><span class="op" id="8221764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8221767">}</span><br>
<span class="lineno">220</span><span class="op" id="8221769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8221772">func</span>&nbsp;<span class="ident" id="8221777">TestNewLineCharacters</span><span class="op" id="8221798">(</span><span class="ident" id="8221799">t</span>&nbsp;<span class="op" id="8221801">*</span><span class="ident" id="8221802">testing</span><span class="op" id="8221809">.</span><span class="ident" id="8221810">T</span><span class="op" id="8221811">)</span>&nbsp;<span class="op" id="8221813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8221816">//&nbsp;Each&nbsp;of&nbsp;these&nbsp;should&nbsp;decode&nbsp;to&nbsp;the&nbsp;string&nbsp;&#34;sure&#34;,&nbsp;without&nbsp;errors.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8221886">const</span>&nbsp;<span class="ident" id="8221892">expected</span>&nbsp;<span class="op" id="8221901">=</span>&nbsp;<span class="string" id="8221903">&#34;sure&#34;</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8221911">examples</span>&nbsp;<span class="op" id="8221920">:=</span>&nbsp;<span class="op" id="8221923">[</span><span class="op" id="8221924">]</span><span class="builtintype" id="8221925">string</span><span class="op" id="8221931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221935">&#34;c3VyZQ==&#34;</span><span class="op" id="8221945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221949">&#34;c3VyZQ==\r&#34;</span><span class="op" id="8221961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221965">&#34;c3VyZQ==\n&#34;</span><span class="op" id="8221977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221981">&#34;c3VyZQ==\r\n&#34;</span><span class="op" id="8221995">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8221999">&#34;c3VyZ\r\nQ==&#34;</span><span class="op" id="8222013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222017">&#34;c3V\ryZ\nQ==&#34;</span><span class="op" id="8222031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222035">&#34;c3V\nyZ\rQ==&#34;</span><span class="op" id="8222049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222053">&#34;c3VyZ\nQ==&#34;</span><span class="op" id="8222065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222069">&#34;c3VyZQ\n==&#34;</span><span class="op" id="8222081">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222085">&#34;c3VyZQ=\n=&#34;</span><span class="op" id="8222097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8222101">&#34;c3VyZQ=\r\n\r\n=&#34;</span><span class="op" id="8222119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222125">for</span>&nbsp;<span class="ident" id="8222129">_</span><span class="op" id="8222130">,</span>&nbsp;<span class="ident" id="8222132">e</span>&nbsp;<span class="op" id="8222134">:=</span>&nbsp;<span class="keyword" id="8222137">range</span>&nbsp;<span class="ident" id="8222143">examples</span>&nbsp;<span class="op" id="8222152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222156">buf</span><span class="op" id="8222159">,</span>&nbsp;<span class="ident" id="8222161">err</span>&nbsp;<span class="op" id="8222165">:=</span>&nbsp;<span class="ident" id="8222168">StdEncoding</span><span class="op" id="8222179">.</span><span class="ident" id="8222180">DecodeString</span><span class="op" id="8222192">(</span><span class="ident" id="8222193">e</span><span class="op" id="8222194">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222198">if</span>&nbsp;<span class="ident" id="8222201">err</span>&nbsp;<span class="op" id="8222205">!=</span>&nbsp;<span class="builtintype" id="8222208">nil</span>&nbsp;<span class="op" id="8222212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222217">t</span><span class="op" id="8222218">.</span><span class="ident" id="8222219">Errorf</span><span class="op" id="8222225">(</span><span class="string" id="8222226">&#34;Decode(%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8222249">,</span>&nbsp;<span class="ident" id="8222251">e</span><span class="op" id="8222252">,</span>&nbsp;<span class="ident" id="8222254">err</span><span class="op" id="8222257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222262">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222277">if</span>&nbsp;<span class="ident" id="8222280">s</span>&nbsp;<span class="op" id="8222282">:=</span>&nbsp;<span class="builtintype" id="8222285">string</span><span class="op" id="8222291">(</span><span class="ident" id="8222292">buf</span><span class="op" id="8222295">)</span><span class="op" id="8222296">;</span>&nbsp;<span class="ident" id="8222298">s</span>&nbsp;<span class="op" id="8222300">!=</span>&nbsp;<span class="ident" id="8222303">expected</span>&nbsp;<span class="op" id="8222312">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222317">t</span><span class="op" id="8222318">.</span><span class="ident" id="8222319">Errorf</span><span class="op" id="8222325">(</span><span class="string" id="8222326">&#34;Decode(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8222352">,</span>&nbsp;<span class="ident" id="8222354">e</span><span class="op" id="8222355">,</span>&nbsp;<span class="ident" id="8222357">s</span><span class="op" id="8222358">,</span>&nbsp;<span class="ident" id="8222360">expected</span><span class="op" id="8222368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222375">}</span><br>
<span class="lineno"></span><span class="op" id="8222377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="8222380">type</span>&nbsp;<span class="ident" id="8222385">nextRead</span>&nbsp;<span class="keyword" id="8222394">struct</span>&nbsp;<span class="op" id="8222401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222404">n</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8222408">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="8222414">//&nbsp;bytes&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222434">err</span>&nbsp;<span class="builtintype" id="8222438">error</span>&nbsp;<span class="comment" id="8222444">//&nbsp;error&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="op" id="8222463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="8222466">//&nbsp;faultInjectReader&nbsp;returns&nbsp;data&nbsp;from&nbsp;source,&nbsp;rate-limited</span><br>
<span class="lineno"></span><span class="comment" id="8222526">//&nbsp;and&nbsp;with&nbsp;the&nbsp;errors&nbsp;as&nbsp;written&nbsp;to&nbsp;nextc.</span><br>
<span class="lineno"></span><span class="keyword" id="8222570">type</span>&nbsp;<span class="ident" id="8222575">faultInjectReader</span>&nbsp;<span class="keyword" id="8222593">struct</span>&nbsp;<span class="op" id="8222600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222603">source</span>&nbsp;<span class="builtintype" id="8222610">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222618">nextc</span>&nbsp;&nbsp;<span class="op" id="8222625">&lt;-</span><span class="keyword" id="8222627">chan</span>&nbsp;<span class="ident" id="8222632">nextRead</span><br>
<span class="lineno">260</span><span class="op" id="8222641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8222644">func</span>&nbsp;<span class="op" id="8222649">(</span><span class="ident" id="8222650">r</span>&nbsp;<span class="op" id="8222652">*</span><span class="ident" id="8222653">faultInjectReader</span><span class="op" id="8222670">)</span>&nbsp;<span class="ident" id="8222672">Read</span><span class="op" id="8222676">(</span><span class="ident" id="8222677">p</span>&nbsp;<span class="op" id="8222679">[</span><span class="op" id="8222680">]</span><span class="builtintype" id="8222681">byte</span><span class="op" id="8222685">)</span>&nbsp;<span class="op" id="8222687">(</span><span class="builtintype" id="8222688">int</span><span class="op" id="8222691">,</span>&nbsp;<span class="builtintype" id="8222693">error</span><span class="op" id="8222698">)</span>&nbsp;<span class="op" id="8222700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222703">nr</span>&nbsp;<span class="op" id="8222706">:=</span>&nbsp;<span class="op" id="8222709">&lt;-</span><span class="ident" id="8222711">r</span><span class="op" id="8222712">.</span><span class="ident" id="8222713">nextc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222720">if</span>&nbsp;<span class="builtinfunc" id="8222723">len</span><span class="op" id="8222726">(</span><span class="ident" id="8222727">p</span><span class="op" id="8222728">)</span>&nbsp;<span class="op" id="8222730">&gt;</span>&nbsp;<span class="ident" id="8222732">nr</span><span class="op" id="8222734">.</span><span class="ident" id="8222735">n</span>&nbsp;<span class="op" id="8222737">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222741">p</span>&nbsp;<span class="op" id="8222743">=</span>&nbsp;<span class="ident" id="8222745">p</span><span class="op" id="8222746">[</span><span class="op" id="8222747">:</span><span class="ident" id="8222748">nr</span><span class="op" id="8222750">.</span><span class="ident" id="8222751">n</span><span class="op" id="8222752">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8222755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222758">n</span>&nbsp;<span class="op" id="8222760">:=</span>&nbsp;<span class="builtinfunc" id="8222763">copy</span><span class="op" id="8222767">(</span><span class="ident" id="8222768">p</span><span class="op" id="8222769">,</span>&nbsp;<span class="ident" id="8222771">r</span><span class="op" id="8222772">.</span><span class="ident" id="8222773">source</span><span class="op" id="8222779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222782">r</span><span class="op" id="8222783">.</span><span class="ident" id="8222784">source</span>&nbsp;<span class="op" id="8222791">=</span>&nbsp;<span class="ident" id="8222793">r</span><span class="op" id="8222794">.</span><span class="ident" id="8222795">source</span><span class="op" id="8222801">[</span><span class="ident" id="8222802">n</span><span class="op" id="8222803">:</span><span class="op" id="8222804">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8222807">return</span>&nbsp;<span class="ident" id="8222814">n</span><span class="op" id="8222815">,</span>&nbsp;<span class="ident" id="8222817">nr</span><span class="op" id="8222819">.</span><span class="ident" id="8222820">err</span><br>
<span class="lineno">270</span><span class="op" id="8222824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8222827">//&nbsp;tests&nbsp;that&nbsp;we&nbsp;don&#39;t&nbsp;ignore&nbsp;errors&nbsp;from&nbsp;our&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span><span class="keyword" id="8222891">func</span>&nbsp;<span class="ident" id="8222896">TestDecoderIssue3577</span><span class="op" id="8222916">(</span><span class="ident" id="8222917">t</span>&nbsp;<span class="op" id="8222919">*</span><span class="ident" id="8222920">testing</span><span class="op" id="8222927">.</span><span class="ident" id="8222928">T</span><span class="op" id="8222929">)</span>&nbsp;<span class="op" id="8222931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222934">next</span>&nbsp;<span class="op" id="8222939">:=</span>&nbsp;<span class="builtinfunc" id="8222942">make</span><span class="op" id="8222946">(</span><span class="keyword" id="8222947">chan</span>&nbsp;<span class="ident" id="8222952">nextRead</span><span class="op" id="8222960">,</span>&nbsp;<span class="num" id="8222962">10</span><span class="op" id="8222964">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8222967">wantErr</span>&nbsp;<span class="op" id="8222975">:=</span>&nbsp;<span class="ident" id="8222978">errors</span><span class="op" id="8222984">.</span><span class="ident" id="8222985">New</span><span class="op" id="8222988">(</span><span class="string" id="8222989">&#34;my&nbsp;error&#34;</span><span class="op" id="8222999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223002">next</span>&nbsp;<span class="op" id="8223007">&lt;-</span>&nbsp;<span class="ident" id="8223010">nextRead</span><span class="op" id="8223018">{</span><span class="num" id="8223019">5</span><span class="op" id="8223020">,</span>&nbsp;<span class="builtintype" id="8223022">nil</span><span class="op" id="8223025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223028">next</span>&nbsp;<span class="op" id="8223033">&lt;-</span>&nbsp;<span class="ident" id="8223036">nextRead</span><span class="op" id="8223044">{</span><span class="num" id="8223045">10</span><span class="op" id="8223047">,</span>&nbsp;<span class="ident" id="8223049">wantErr</span><span class="op" id="8223056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223059">next</span>&nbsp;<span class="op" id="8223064">&lt;-</span>&nbsp;<span class="ident" id="8223067">nextRead</span><span class="op" id="8223075">{</span><span class="num" id="8223076">0</span><span class="op" id="8223077">,</span>&nbsp;<span class="ident" id="8223079">wantErr</span><span class="op" id="8223086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223089">d</span>&nbsp;<span class="op" id="8223091">:=</span>&nbsp;<span class="ident" id="8223094">NewDecoder</span><span class="op" id="8223104">(</span><span class="ident" id="8223105">StdEncoding</span><span class="op" id="8223116">,</span>&nbsp;<span class="op" id="8223118">&amp;</span><span class="ident" id="8223119">faultInjectReader</span><span class="op" id="8223136">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223140">source</span><span class="op" id="8223146">:</span>&nbsp;<span class="string" id="8223148">&#34;VHdhcyBicmlsbGlnLCBhbmQgdGhlIHNsaXRoeSB0b3Zlcw==&#34;</span><span class="op" id="8223198">,</span>&nbsp;<span class="comment" id="8223200">//&nbsp;twas&nbsp;brillig...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223221">nextc</span><span class="op" id="8223226">:</span>&nbsp;&nbsp;<span class="ident" id="8223229">next</span><span class="op" id="8223233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223236">}</span><span class="op" id="8223237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223240">errc</span>&nbsp;<span class="op" id="8223245">:=</span>&nbsp;<span class="builtinfunc" id="8223248">make</span><span class="op" id="8223252">(</span><span class="keyword" id="8223253">chan</span>&nbsp;<span class="builtintype" id="8223258">error</span><span class="op" id="8223263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8223266">go</span>&nbsp;<span class="keyword" id="8223269">func</span><span class="op" id="8223273">(</span><span class="op" id="8223274">)</span>&nbsp;<span class="op" id="8223276">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223280">_</span><span class="op" id="8223281">,</span>&nbsp;<span class="ident" id="8223283">err</span>&nbsp;<span class="op" id="8223287">:=</span>&nbsp;<span class="ident" id="8223290">ioutil</span><span class="op" id="8223296">.</span><span class="ident" id="8223297">ReadAll</span><span class="op" id="8223304">(</span><span class="ident" id="8223305">d</span><span class="op" id="8223306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223310">errc</span>&nbsp;<span class="op" id="8223315">&lt;-</span>&nbsp;<span class="ident" id="8223318">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223323">}</span><span class="op" id="8223324">(</span><span class="op" id="8223325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8223328">select</span>&nbsp;<span class="op" id="8223335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8223338">case</span>&nbsp;<span class="ident" id="8223343">err</span>&nbsp;<span class="op" id="8223347">:=</span>&nbsp;<span class="op" id="8223350">&lt;-</span><span class="ident" id="8223352">errc</span><span class="op" id="8223356">:</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8223360">if</span>&nbsp;<span class="ident" id="8223363">err</span>&nbsp;<span class="op" id="8223367">!=</span>&nbsp;<span class="ident" id="8223370">wantErr</span>&nbsp;<span class="op" id="8223378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223383">t</span><span class="op" id="8223384">.</span><span class="ident" id="8223385">Errorf</span><span class="op" id="8223391">(</span><span class="string" id="8223392">&#34;got&nbsp;error&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8223415">,</span>&nbsp;<span class="ident" id="8223417">err</span><span class="op" id="8223420">,</span>&nbsp;<span class="ident" id="8223422">wantErr</span><span class="op" id="8223429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8223436">case</span>&nbsp;<span class="op" id="8223441">&lt;-</span><span class="ident" id="8223443">time</span><span class="op" id="8223447">.</span><span class="ident" id="8223448">After</span><span class="op" id="8223453">(</span><span class="num" id="8223454">5</span>&nbsp;<span class="op" id="8223456">*</span>&nbsp;<span class="ident" id="8223458">time</span><span class="op" id="8223462">.</span><span class="ident" id="8223463">Second</span><span class="op" id="8223469">)</span><span class="op" id="8223470">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223474">t</span><span class="op" id="8223475">.</span><span class="ident" id="8223476">Errorf</span><span class="op" id="8223482">(</span><span class="string" id="8223483">&#34;timeout;&nbsp;Decoder&nbsp;blocked&nbsp;without&nbsp;returning&nbsp;an&nbsp;error&#34;</span><span class="op" id="8223536">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8223539">}</span><br>
<span class="lineno"></span><span class="op" id="8223541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8223544">func</span>&nbsp;<span class="ident" id="8223549">TestDecoderIssue4779</span><span class="op" id="8223569">(</span><span class="ident" id="8223570">t</span>&nbsp;<span class="op" id="8223572">*</span><span class="ident" id="8223573">testing</span><span class="op" id="8223580">.</span><span class="ident" id="8223581">T</span><span class="op" id="8223582">)</span>&nbsp;<span class="op" id="8223584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8223587">encoded</span>&nbsp;<span class="op" id="8223595">:=</span>&nbsp;<span class="string" id="8223598">`CP/EAT8AAAEF<br>
<span class="lineno">300</span>AQEBAQEBAAAAAAAAAAMAAQIEBQYHCAkKCwEAAQUBAQEBAQEAAAAAAAAAAQACAwQFBgcICQoLEAAB<br>
<span class="lineno"></span>BAEDAgQCBQcGCAUDDDMBAAIRAwQhEjEFQVFhEyJxgTIGFJGhsUIjJBVSwWIzNHKC0UMHJZJT8OHx<br>
<span class="lineno"></span>Y3M1FqKygyZEk1RkRcKjdDYX0lXiZfKzhMPTdePzRieUpIW0lcTU5PSltcXV5fVWZnaGlqa2xtbm<br>
<span class="lineno"></span>9jdHV2d3h5ent8fX5/cRAAICAQIEBAMEBQYHBwYFNQEAAhEDITESBEFRYXEiEwUygZEUobFCI8FS<br>
<span class="lineno"></span>0fAzJGLhcoKSQ1MVY3M08SUGFqKygwcmNcLSRJNUoxdkRVU2dGXi8rOEw9N14/NGlKSFtJXE1OT0<br>
<span class="lineno">305</span>pbXF1eX1VmZ2hpamtsbW5vYnN0dXZ3eHl6e3x//aAAwDAQACEQMRAD8A9VSSSSUpJJJJSkkkJ+Tj<br>
<span class="lineno"></span>1kiy1jCJJDnAcCTykpKkuQ6p/jN6FgmxlNduXawwAzaGH+V6jn/R/wCt71zdn+N/qL3kVYFNYB4N<br>
<span class="lineno"></span>ji6PDVjWpKp9TSXnvTf8bFNjg3qOEa2n6VlLpj/rT/pf567DpX1i6L1hs9Py67X8mqdtg/rUWbbf<br>
<span class="lineno"></span>+gkp0kkkklKSSSSUpJJJJT//0PVUkkklKVLq3WMDpGI7KzrNjADtYNXvI/Mqr/Pd/q9W3vaxjnvM<br>
<span class="lineno"></span>NaCXE9gNSvGPrf8AWS3qmba5jjsJhoB0DAf0NDf6sevf+/lf8Hj0JJATfWT6/dV6oXU1uOLQeKKn<br>
<span class="lineno">310</span>EQP+Hubtfe/+R7Mf/g7f5xcocp++Z11JMCJPgFBxOg7/AOuqDx8I/ikpkXkmSdU8mJIJA/O8EMAy<br>
<span class="lineno"></span>j+mSARB/17pKVXYWHXjsj7yIex0PadzXMO1zT5KHoNA3HT8ietoGhgjsfA+CSnvvqh/jJtqsrwOv<br>
<span class="lineno"></span>2b6NGNzXfTYexzJ+nU7/ALkf4P8Awv6P9KvTQQ4AgyDqCF85Pho3CTB7eHwXoH+LT65uZbX9X+o2<br>
<span class="lineno"></span>bqbPb06551Y4<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224629">encodedShort</span>&nbsp;<span class="op" id="8224642">:=</span>&nbsp;<span class="ident" id="8224645">strings</span><span class="op" id="8224652">.</span><span class="ident" id="8224653">Replace</span><span class="op" id="8224660">(</span><span class="ident" id="8224661">encoded</span><span class="op" id="8224668">,</span>&nbsp;<span class="string" id="8224670">&#34;\n&#34;</span><span class="op" id="8224674">,</span>&nbsp;<span class="string" id="8224676">&#34;&#34;</span><span class="op" id="8224678">,</span>&nbsp;<span class="op" id="8224680">-</span><span class="num" id="8224681">1</span><span class="op" id="8224682">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224686">dec</span>&nbsp;<span class="op" id="8224690">:=</span>&nbsp;<span class="ident" id="8224693">NewDecoder</span><span class="op" id="8224703">(</span><span class="ident" id="8224704">StdEncoding</span><span class="op" id="8224715">,</span>&nbsp;<span class="ident" id="8224717">strings</span><span class="op" id="8224724">.</span><span class="ident" id="8224725">NewReader</span><span class="op" id="8224734">(</span><span class="ident" id="8224735">encoded</span><span class="op" id="8224742">)</span><span class="op" id="8224743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224746">res1</span><span class="op" id="8224750">,</span>&nbsp;<span class="ident" id="8224752">err</span>&nbsp;<span class="op" id="8224756">:=</span>&nbsp;<span class="ident" id="8224759">ioutil</span><span class="op" id="8224765">.</span><span class="ident" id="8224766">ReadAll</span><span class="op" id="8224773">(</span><span class="ident" id="8224774">dec</span><span class="op" id="8224777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224780">if</span>&nbsp;<span class="ident" id="8224783">err</span>&nbsp;<span class="op" id="8224787">!=</span>&nbsp;<span class="builtintype" id="8224790">nil</span>&nbsp;<span class="op" id="8224794">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224798">t</span><span class="op" id="8224799">.</span><span class="ident" id="8224800">Errorf</span><span class="op" id="8224806">(</span><span class="string" id="8224807">&#34;ReadAll&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8224827">,</span>&nbsp;<span class="ident" id="8224829">err</span><span class="op" id="8224832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8224835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224839">dec</span>&nbsp;<span class="op" id="8224843">=</span>&nbsp;<span class="ident" id="8224845">NewDecoder</span><span class="op" id="8224855">(</span><span class="ident" id="8224856">StdEncoding</span><span class="op" id="8224867">,</span>&nbsp;<span class="ident" id="8224869">strings</span><span class="op" id="8224876">.</span><span class="ident" id="8224877">NewReader</span><span class="op" id="8224886">(</span><span class="ident" id="8224887">encodedShort</span><span class="op" id="8224899">)</span><span class="op" id="8224900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224903">var</span>&nbsp;<span class="ident" id="8224907">res2</span>&nbsp;<span class="op" id="8224912">[</span><span class="op" id="8224913">]</span><span class="builtintype" id="8224914">byte</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224920">res2</span><span class="op" id="8224924">,</span>&nbsp;<span class="ident" id="8224926">err</span>&nbsp;<span class="op" id="8224930">=</span>&nbsp;<span class="ident" id="8224932">ioutil</span><span class="op" id="8224938">.</span><span class="ident" id="8224939">ReadAll</span><span class="op" id="8224946">(</span><span class="ident" id="8224947">dec</span><span class="op" id="8224950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8224953">if</span>&nbsp;<span class="ident" id="8224956">err</span>&nbsp;<span class="op" id="8224960">!=</span>&nbsp;<span class="builtintype" id="8224963">nil</span>&nbsp;<span class="op" id="8224967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8224971">t</span><span class="op" id="8224972">.</span><span class="ident" id="8224973">Errorf</span><span class="op" id="8224979">(</span><span class="string" id="8224980">&#34;ReadAll&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8225000">,</span>&nbsp;<span class="ident" id="8225002">err</span><span class="op" id="8225005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8225012">if</span>&nbsp;<span class="op" id="8225015">!</span><span class="ident" id="8225016">bytes</span><span class="op" id="8225021">.</span><span class="ident" id="8225022">Equal</span><span class="op" id="8225027">(</span><span class="ident" id="8225028">res1</span><span class="op" id="8225032">,</span>&nbsp;<span class="ident" id="8225034">res2</span><span class="op" id="8225038">)</span>&nbsp;<span class="op" id="8225040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225044">t</span><span class="op" id="8225045">.</span><span class="ident" id="8225046">Error</span><span class="op" id="8225051">(</span><span class="string" id="8225052">&#34;Decoded&nbsp;results&nbsp;not&nbsp;equal&#34;</span><span class="op" id="8225079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225082">}</span><br>
<span class="lineno"></span><span class="op" id="8225084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="8225087">func</span>&nbsp;<span class="ident" id="8225092">TestDecoderIssue7733</span><span class="op" id="8225112">(</span><span class="ident" id="8225113">t</span>&nbsp;<span class="op" id="8225115">*</span><span class="ident" id="8225116">testing</span><span class="op" id="8225123">.</span><span class="ident" id="8225124">T</span><span class="op" id="8225125">)</span>&nbsp;<span class="op" id="8225127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225130">s</span><span class="op" id="8225131">,</span>&nbsp;<span class="ident" id="8225133">err</span>&nbsp;<span class="op" id="8225137">:=</span>&nbsp;<span class="ident" id="8225140">StdEncoding</span><span class="op" id="8225151">.</span><span class="ident" id="8225152">DecodeString</span><span class="op" id="8225164">(</span><span class="string" id="8225165">&#34;YWJjZA=====&#34;</span><span class="op" id="8225178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225181">want</span>&nbsp;<span class="op" id="8225186">:=</span>&nbsp;<span class="ident" id="8225189">CorruptInputError</span><span class="op" id="8225206">(</span><span class="num" id="8225207">8</span><span class="op" id="8225208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8225211">if</span>&nbsp;<span class="op" id="8225214">!</span><span class="ident" id="8225215">reflect</span><span class="op" id="8225222">.</span><span class="ident" id="8225223">DeepEqual</span><span class="op" id="8225232">(</span><span class="ident" id="8225233">want</span><span class="op" id="8225237">,</span>&nbsp;<span class="ident" id="8225239">err</span><span class="op" id="8225242">)</span>&nbsp;<span class="op" id="8225244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225248">t</span><span class="op" id="8225249">.</span><span class="ident" id="8225250">Errorf</span><span class="op" id="8225256">(</span><span class="string" id="8225257">&#34;Error&nbsp;=&nbsp;%v;&nbsp;want&nbsp;CorruptInputError(8)&#34;</span><span class="op" id="8225296">,</span>&nbsp;<span class="ident" id="8225298">err</span><span class="op" id="8225301">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8225307">if</span>&nbsp;<span class="builtintype" id="8225310">string</span><span class="op" id="8225316">(</span><span class="ident" id="8225317">s</span><span class="op" id="8225318">)</span>&nbsp;<span class="op" id="8225320">!=</span>&nbsp;<span class="string" id="8225323">&#34;abcd&#34;</span>&nbsp;<span class="op" id="8225330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225334">t</span><span class="op" id="8225335">.</span><span class="ident" id="8225336">Errorf</span><span class="op" id="8225342">(</span><span class="string" id="8225343">&#34;DecodeString&nbsp;=&nbsp;%q;&nbsp;want&nbsp;abcd&#34;</span><span class="op" id="8225373">,</span>&nbsp;<span class="ident" id="8225375">s</span><span class="op" id="8225376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225379">}</span><br>
<span class="lineno"></span><span class="op" id="8225381">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="8225384">func</span>&nbsp;<span class="ident" id="8225389">BenchmarkEncodeToString</span><span class="op" id="8225412">(</span><span class="ident" id="8225413">b</span>&nbsp;<span class="op" id="8225415">*</span><span class="ident" id="8225416">testing</span><span class="op" id="8225423">.</span><span class="ident" id="8225424">B</span><span class="op" id="8225425">)</span>&nbsp;<span class="op" id="8225427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225430">data</span>&nbsp;<span class="op" id="8225435">:=</span>&nbsp;<span class="builtinfunc" id="8225438">make</span><span class="op" id="8225442">(</span><span class="op" id="8225443">[</span><span class="op" id="8225444">]</span><span class="builtintype" id="8225445">byte</span><span class="op" id="8225449">,</span>&nbsp;<span class="num" id="8225451">8192</span><span class="op" id="8225455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225458">b</span><span class="op" id="8225459">.</span><span class="ident" id="8225460">SetBytes</span><span class="op" id="8225468">(</span><span class="builtintype" id="8225469">int64</span><span class="op" id="8225474">(</span><span class="builtinfunc" id="8225475">len</span><span class="op" id="8225478">(</span><span class="ident" id="8225479">data</span><span class="op" id="8225483">)</span><span class="op" id="8225484">)</span><span class="op" id="8225485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8225488">for</span>&nbsp;<span class="ident" id="8225492">i</span>&nbsp;<span class="op" id="8225494">:=</span>&nbsp;<span class="num" id="8225497">0</span><span class="op" id="8225498">;</span>&nbsp;<span class="ident" id="8225500">i</span>&nbsp;<span class="op" id="8225502">&lt;</span>&nbsp;<span class="ident" id="8225504">b</span><span class="op" id="8225505">.</span><span class="ident" id="8225506">N</span><span class="op" id="8225507">;</span>&nbsp;<span class="ident" id="8225509">i</span><span class="op" id="8225510">++</span>&nbsp;<span class="op" id="8225513">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225517">StdEncoding</span><span class="op" id="8225528">.</span><span class="ident" id="8225529">EncodeToString</span><span class="op" id="8225543">(</span><span class="ident" id="8225544">data</span><span class="op" id="8225548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225551">}</span><br>
<span class="lineno"></span><span class="op" id="8225553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8225556">func</span>&nbsp;<span class="ident" id="8225561">BenchmarkDecodeString</span><span class="op" id="8225582">(</span><span class="ident" id="8225583">b</span>&nbsp;<span class="op" id="8225585">*</span><span class="ident" id="8225586">testing</span><span class="op" id="8225593">.</span><span class="ident" id="8225594">B</span><span class="op" id="8225595">)</span>&nbsp;<span class="op" id="8225597">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225600">data</span>&nbsp;<span class="op" id="8225605">:=</span>&nbsp;<span class="ident" id="8225608">StdEncoding</span><span class="op" id="8225619">.</span><span class="ident" id="8225620">EncodeToString</span><span class="op" id="8225634">(</span><span class="builtinfunc" id="8225635">make</span><span class="op" id="8225639">(</span><span class="op" id="8225640">[</span><span class="op" id="8225641">]</span><span class="builtintype" id="8225642">byte</span><span class="op" id="8225646">,</span>&nbsp;<span class="num" id="8225648">8192</span><span class="op" id="8225652">)</span><span class="op" id="8225653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225656">b</span><span class="op" id="8225657">.</span><span class="ident" id="8225658">SetBytes</span><span class="op" id="8225666">(</span><span class="builtintype" id="8225667">int64</span><span class="op" id="8225672">(</span><span class="builtinfunc" id="8225673">len</span><span class="op" id="8225676">(</span><span class="ident" id="8225677">data</span><span class="op" id="8225681">)</span><span class="op" id="8225682">)</span><span class="op" id="8225683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8225686">for</span>&nbsp;<span class="ident" id="8225690">i</span>&nbsp;<span class="op" id="8225692">:=</span>&nbsp;<span class="num" id="8225695">0</span><span class="op" id="8225696">;</span>&nbsp;<span class="ident" id="8225698">i</span>&nbsp;<span class="op" id="8225700">&lt;</span>&nbsp;<span class="ident" id="8225702">b</span><span class="op" id="8225703">.</span><span class="ident" id="8225704">N</span><span class="op" id="8225705">;</span>&nbsp;<span class="ident" id="8225707">i</span><span class="op" id="8225708">++</span>&nbsp;<span class="op" id="8225711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8225715">StdEncoding</span><span class="op" id="8225726">.</span><span class="ident" id="8225727">DecodeString</span><span class="op" id="8225739">(</span><span class="ident" id="8225740">data</span><span class="op" id="8225744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8225747">}</span><br>
<span class="lineno">360</span><span class="op" id="8225749">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
