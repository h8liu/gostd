<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3489577">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3489632">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3489686">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3489737">package</span>&nbsp;<span class="ident" id="3489745">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3489750">import</span>&nbsp;<span class="op" id="3489757">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3489760">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3489777">&#34;strconv&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3489787">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3489790">//&nbsp;The&nbsp;AES&nbsp;block&nbsp;size&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3489822">const</span>&nbsp;<span class="ident" id="3489828">BlockSize</span>&nbsp;<span class="op" id="3489838">=</span>&nbsp;<span class="num" id="3489840">16</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3489844">//&nbsp;A&nbsp;cipher&nbsp;is&nbsp;an&nbsp;instance&nbsp;of&nbsp;AES&nbsp;encryption&nbsp;using&nbsp;a&nbsp;particular&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3489913">type</span>&nbsp;<span class="ident" id="3489918">aesCipher</span>&nbsp;<span class="keyword" id="3489928">struct</span>&nbsp;<span class="op" id="3489935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489938">enc</span>&nbsp;<span class="op" id="3489942">[</span><span class="op" id="3489943">]</span><span class="builtintype" id="3489944">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489952">dec</span>&nbsp;<span class="op" id="3489956">[</span><span class="op" id="3489957">]</span><span class="builtintype" id="3489958">uint32</span><br>
<span class="lineno"></span><span class="op" id="3489965">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3489968">type</span>&nbsp;<span class="ident" id="3489973">KeySizeError</span>&nbsp;<span class="builtintype" id="3489986">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3489991">func</span>&nbsp;<span class="op" id="3489996">(</span><span class="ident" id="3489997">k</span>&nbsp;<span class="ident" id="3489999">KeySizeError</span><span class="op" id="3490011">)</span>&nbsp;<span class="ident" id="3490013">Error</span><span class="op" id="3490018">(</span><span class="op" id="3490019">)</span>&nbsp;<span class="builtintype" id="3490021">string</span>&nbsp;<span class="op" id="3490028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490031">return</span>&nbsp;<span class="string" id="3490038">&#34;crypto/aes:&nbsp;invalid&nbsp;key&nbsp;size&nbsp;&#34;</span>&nbsp;<span class="op" id="3490070">+</span>&nbsp;<span class="ident" id="3490072">strconv</span><span class="op" id="3490079">.</span><span class="ident" id="3490080">Itoa</span><span class="op" id="3490084">(</span><span class="builtintype" id="3490085">int</span><span class="op" id="3490088">(</span><span class="ident" id="3490089">k</span><span class="op" id="3490090">)</span><span class="op" id="3490091">)</span><br>
<span class="lineno">25</span><span class="op" id="3490093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3490096">//&nbsp;NewCipher&nbsp;creates&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;cipher.Block.</span><br>
<span class="lineno"></span><span class="comment" id="3490149">//&nbsp;The&nbsp;key&nbsp;argument&nbsp;should&nbsp;be&nbsp;the&nbsp;AES&nbsp;key,</span><br>
<span class="lineno"></span><span class="comment" id="3490192">//&nbsp;either&nbsp;16,&nbsp;24,&nbsp;or&nbsp;32&nbsp;bytes&nbsp;to&nbsp;select</span><br>
<span class="lineno">30</span><span class="comment" id="3490232">//&nbsp;AES-128,&nbsp;AES-192,&nbsp;or&nbsp;AES-256.</span><br>
<span class="lineno"></span><span class="keyword" id="3490265">func</span>&nbsp;<span class="ident" id="3490270">NewCipher</span><span class="op" id="3490279">(</span><span class="ident" id="3490280">key</span>&nbsp;<span class="op" id="3490284">[</span><span class="op" id="3490285">]</span><span class="builtintype" id="3490286">byte</span><span class="op" id="3490290">)</span>&nbsp;<span class="op" id="3490292">(</span><span class="ident" id="3490293">cipher</span><span class="op" id="3490299">.</span><span class="ident" id="3490300">Block</span><span class="op" id="3490305">,</span>&nbsp;<span class="builtintype" id="3490307">error</span><span class="op" id="3490312">)</span>&nbsp;<span class="op" id="3490314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490317">k</span>&nbsp;<span class="op" id="3490319">:=</span>&nbsp;<span class="builtinfunc" id="3490322">len</span><span class="op" id="3490325">(</span><span class="ident" id="3490326">key</span><span class="op" id="3490329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490332">switch</span>&nbsp;<span class="ident" id="3490339">k</span>&nbsp;<span class="op" id="3490341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490344">default</span><span class="op" id="3490351">:</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490355">return</span>&nbsp;<span class="ident" id="3490362">nil</span><span class="op" id="3490365">,</span>&nbsp;<span class="ident" id="3490367">KeySizeError</span><span class="op" id="3490379">(</span><span class="ident" id="3490380">k</span><span class="op" id="3490381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490384">case</span>&nbsp;<span class="num" id="3490389">16</span><span class="op" id="3490391">,</span>&nbsp;<span class="num" id="3490393">24</span><span class="op" id="3490395">,</span>&nbsp;<span class="num" id="3490397">32</span><span class="op" id="3490399">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490403">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3490410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490414">n</span>&nbsp;<span class="op" id="3490416">:=</span>&nbsp;<span class="ident" id="3490419">k</span>&nbsp;<span class="op" id="3490421">+</span>&nbsp;<span class="num" id="3490423">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490427">c</span>&nbsp;<span class="op" id="3490429">:=</span>&nbsp;<span class="op" id="3490432">&amp;</span><span class="ident" id="3490433">aesCipher</span><span class="op" id="3490442">{</span><span class="builtinfunc" id="3490443">make</span><span class="op" id="3490447">(</span><span class="op" id="3490448">[</span><span class="op" id="3490449">]</span><span class="builtintype" id="3490450">uint32</span><span class="op" id="3490456">,</span>&nbsp;<span class="ident" id="3490458">n</span><span class="op" id="3490459">)</span><span class="op" id="3490460">,</span>&nbsp;<span class="builtinfunc" id="3490462">make</span><span class="op" id="3490466">(</span><span class="op" id="3490467">[</span><span class="op" id="3490468">]</span><span class="builtintype" id="3490469">uint32</span><span class="op" id="3490475">,</span>&nbsp;<span class="ident" id="3490477">n</span><span class="op" id="3490478">)</span><span class="op" id="3490479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490482">expandKey</span><span class="op" id="3490491">(</span><span class="ident" id="3490492">key</span><span class="op" id="3490495">,</span>&nbsp;<span class="ident" id="3490497">c</span><span class="op" id="3490498">.</span><span class="ident" id="3490499">enc</span><span class="op" id="3490502">,</span>&nbsp;<span class="ident" id="3490504">c</span><span class="op" id="3490505">.</span><span class="ident" id="3490506">dec</span><span class="op" id="3490509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490512">return</span>&nbsp;<span class="ident" id="3490519">c</span><span class="op" id="3490520">,</span>&nbsp;<span class="ident" id="3490522">nil</span><br>
<span class="lineno"></span><span class="op" id="3490526">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="3490529">func</span>&nbsp;<span class="op" id="3490534">(</span><span class="ident" id="3490535">c</span>&nbsp;<span class="op" id="3490537">*</span><span class="ident" id="3490538">aesCipher</span><span class="op" id="3490547">)</span>&nbsp;<span class="ident" id="3490549">BlockSize</span><span class="op" id="3490558">(</span><span class="op" id="3490559">)</span>&nbsp;<span class="builtintype" id="3490561">int</span>&nbsp;<span class="op" id="3490565">{</span>&nbsp;<span class="keyword" id="3490567">return</span>&nbsp;<span class="ident" id="3490574">BlockSize</span>&nbsp;<span class="op" id="3490584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3490587">func</span>&nbsp;<span class="op" id="3490592">(</span><span class="ident" id="3490593">c</span>&nbsp;<span class="op" id="3490595">*</span><span class="ident" id="3490596">aesCipher</span><span class="op" id="3490605">)</span>&nbsp;<span class="ident" id="3490607">Encrypt</span><span class="op" id="3490614">(</span><span class="ident" id="3490615">dst</span><span class="op" id="3490618">,</span>&nbsp;<span class="ident" id="3490620">src</span>&nbsp;<span class="op" id="3490624">[</span><span class="op" id="3490625">]</span><span class="builtintype" id="3490626">byte</span><span class="op" id="3490630">)</span>&nbsp;<span class="op" id="3490632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490635">if</span>&nbsp;<span class="builtinfunc" id="3490638">len</span><span class="op" id="3490641">(</span><span class="ident" id="3490642">src</span><span class="op" id="3490645">)</span>&nbsp;<span class="op" id="3490647">&lt;</span>&nbsp;<span class="ident" id="3490649">BlockSize</span>&nbsp;<span class="op" id="3490659">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3490663">panic</span><span class="op" id="3490668">(</span><span class="string" id="3490669">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3490703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3490706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490709">if</span>&nbsp;<span class="builtinfunc" id="3490712">len</span><span class="op" id="3490715">(</span><span class="ident" id="3490716">dst</span><span class="op" id="3490719">)</span>&nbsp;<span class="op" id="3490721">&lt;</span>&nbsp;<span class="ident" id="3490723">BlockSize</span>&nbsp;<span class="op" id="3490733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3490737">panic</span><span class="op" id="3490742">(</span><span class="string" id="3490743">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3490778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3490781">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490784">encryptBlock</span><span class="op" id="3490796">(</span><span class="ident" id="3490797">c</span><span class="op" id="3490798">.</span><span class="ident" id="3490799">enc</span><span class="op" id="3490802">,</span>&nbsp;<span class="ident" id="3490804">dst</span><span class="op" id="3490807">,</span>&nbsp;<span class="ident" id="3490809">src</span><span class="op" id="3490812">)</span><br>
<span class="lineno"></span><span class="op" id="3490814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3490817">func</span>&nbsp;<span class="op" id="3490822">(</span><span class="ident" id="3490823">c</span>&nbsp;<span class="op" id="3490825">*</span><span class="ident" id="3490826">aesCipher</span><span class="op" id="3490835">)</span>&nbsp;<span class="ident" id="3490837">Decrypt</span><span class="op" id="3490844">(</span><span class="ident" id="3490845">dst</span><span class="op" id="3490848">,</span>&nbsp;<span class="ident" id="3490850">src</span>&nbsp;<span class="op" id="3490854">[</span><span class="op" id="3490855">]</span><span class="builtintype" id="3490856">byte</span><span class="op" id="3490860">)</span>&nbsp;<span class="op" id="3490862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490865">if</span>&nbsp;<span class="builtinfunc" id="3490868">len</span><span class="op" id="3490871">(</span><span class="ident" id="3490872">src</span><span class="op" id="3490875">)</span>&nbsp;<span class="op" id="3490877">&lt;</span>&nbsp;<span class="ident" id="3490879">BlockSize</span>&nbsp;<span class="op" id="3490889">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3490893">panic</span><span class="op" id="3490898">(</span><span class="string" id="3490899">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3490933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3490936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490939">if</span>&nbsp;<span class="builtinfunc" id="3490942">len</span><span class="op" id="3490945">(</span><span class="ident" id="3490946">dst</span><span class="op" id="3490949">)</span>&nbsp;<span class="op" id="3490951">&lt;</span>&nbsp;<span class="ident" id="3490953">BlockSize</span>&nbsp;<span class="op" id="3490963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3490967">panic</span><span class="op" id="3490972">(</span><span class="string" id="3490973">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="3491008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3491011">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491014">decryptBlock</span><span class="op" id="3491026">(</span><span class="ident" id="3491027">c</span><span class="op" id="3491028">.</span><span class="ident" id="3491029">dec</span><span class="op" id="3491032">,</span>&nbsp;<span class="ident" id="3491034">dst</span><span class="op" id="3491037">,</span>&nbsp;<span class="ident" id="3491039">src</span><span class="op" id="3491042">)</span><br>
<span class="lineno"></span><span class="op" id="3491044">}</span>
</div>
</body>
</html>
