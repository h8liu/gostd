<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3461156">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3461212">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3461266">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3461317">package</span>&nbsp;<span class="ident" id="3461325">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3461331">import</span>&nbsp;<span class="op" id="3461338">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3461341">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3461350">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3461368">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3461371">//&nbsp;The&nbsp;algorithm&nbsp;uses&nbsp;at&nbsp;most&nbsp;sniffLen&nbsp;bytes&nbsp;to&nbsp;make&nbsp;its&nbsp;decision.</span><br>
<span class="lineno"></span><span class="keyword" id="3461438">const</span>&nbsp;<span class="ident" id="3461444">sniffLen</span>&nbsp;<span class="op" id="3461453">=</span>&nbsp;<span class="num" id="3461455">512</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="3461460">//&nbsp;DetectContentType&nbsp;implements&nbsp;the&nbsp;algorithm&nbsp;described</span><br>
<span class="lineno"></span><span class="comment" id="3461516">//&nbsp;at&nbsp;http://mimesniff.spec.whatwg.org/&nbsp;to&nbsp;determine&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3461573">//&nbsp;Content-Type&nbsp;of&nbsp;the&nbsp;given&nbsp;data.&nbsp;&nbsp;It&nbsp;considers&nbsp;at&nbsp;most&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3461634">//&nbsp;first&nbsp;512&nbsp;bytes&nbsp;of&nbsp;data.&nbsp;&nbsp;DetectContentType&nbsp;always&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="3461696">//&nbsp;a&nbsp;valid&nbsp;MIME&nbsp;type:&nbsp;if&nbsp;it&nbsp;cannot&nbsp;determine&nbsp;a&nbsp;more&nbsp;specific&nbsp;one,&nbsp;it</span><br>
<span class="lineno">20</span><span class="comment" id="3461765">//&nbsp;returns&nbsp;&#34;application/octet-stream&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3461804">func</span>&nbsp;<span class="ident" id="3461809">DetectContentType</span><span class="op" id="3461826">(</span><span class="ident" id="3461827">data</span>&nbsp;<span class="op" id="3461832">[</span><span class="op" id="3461833">]</span><span class="builtintype" id="3461834">byte</span><span class="op" id="3461838">)</span>&nbsp;<span class="builtintype" id="3461840">string</span>&nbsp;<span class="op" id="3461847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3461850">if</span>&nbsp;<span class="builtinfunc" id="3461853">len</span><span class="op" id="3461856">(</span><span class="ident" id="3461857"><a href="/net/http/sniff.go.html#3461827">data</a></span><span class="op" id="3461861">)</span>&nbsp;<span class="op" id="3461863">&gt;</span>&nbsp;<span class="ident" id="3461865"><a href="/net/http/sniff.go.html#3461444">sniffLen</a></span>&nbsp;<span class="op" id="3461874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3461878"><a href="/net/http/sniff.go.html#3461827">data</a></span>&nbsp;<span class="op" id="3461883">=</span>&nbsp;<span class="ident" id="3461885"><a href="/net/http/sniff.go.html#3461827">data</a></span><span class="op" id="3461889">[</span><span class="op" id="3461890">:</span><span class="ident" id="3461891"><a href="/net/http/sniff.go.html#3461444">sniffLen</a></span><span class="op" id="3461899">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3461902">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3461906">//&nbsp;Index&nbsp;of&nbsp;the&nbsp;first&nbsp;non-whitespace&nbsp;byte&nbsp;in&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3461958">firstNonWS</span>&nbsp;<span class="op" id="3461969">:=</span>&nbsp;<span class="num" id="3461972">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3461975">for</span>&nbsp;<span class="op" id="3461979">;</span>&nbsp;<span class="ident" id="3461981"><a href="/net/http/sniff.go.html#3461958">firstNonWS</a></span>&nbsp;<span class="op" id="3461992">&lt;</span>&nbsp;<span class="builtinfunc" id="3461994">len</span><span class="op" id="3461997">(</span><span class="ident" id="3461998"><a href="/net/http/sniff.go.html#3461827">data</a></span><span class="op" id="3462002">)</span>&nbsp;<span class="op" id="3462004">&amp;&amp;</span>&nbsp;<span class="ident" id="3462007"><a href="/net/http/sniff.go.html#3462216">isWS</a></span><span class="op" id="3462011">(</span><span class="ident" id="3462012"><a href="/net/http/sniff.go.html#3461827">data</a></span><span class="op" id="3462016">[</span><span class="ident" id="3462017"><a href="/net/http/sniff.go.html#3461958">firstNonWS</a></span><span class="op" id="3462027">]</span><span class="op" id="3462028">)</span><span class="op" id="3462029">;</span>&nbsp;<span class="ident" id="3462031"><a href="/net/http/sniff.go.html#3461958">firstNonWS</a></span><span class="op" id="3462041">++</span>&nbsp;<span class="op" id="3462044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3462047">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3462051">for</span>&nbsp;<span class="ident" id="3462055">_</span><span class="op" id="3462056">,</span>&nbsp;<span class="ident" id="3462058">sig</span>&nbsp;<span class="op" id="3462062">:=</span>&nbsp;<span class="keyword" id="3462065">range</span>&nbsp;<span class="ident" id="3462071"><a href="/net/http/sniff.go.html#3462475">sniffSignatures</a></span>&nbsp;<span class="op" id="3462087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3462091">if</span>&nbsp;<span class="ident" id="3462094">ct</span>&nbsp;<span class="op" id="3462097">:=</span>&nbsp;<span class="ident" id="3462100"><a href="/net/http/sniff.go.html#3462058">sig</a></span><span class="op" id="3462103">.</span><span class="ident" id="3462104">match</span><span class="op" id="3462109">(</span><span class="ident" id="3462110"><a href="/net/http/sniff.go.html#3461827">data</a></span><span class="op" id="3462114">,</span>&nbsp;<span class="ident" id="3462116"><a href="/net/http/sniff.go.html#3461958">firstNonWS</a></span><span class="op" id="3462126">)</span><span class="op" id="3462127">;</span>&nbsp;<span class="ident" id="3462129"><a href="/net/http/sniff.go.html#3462094">ct</a></span>&nbsp;<span class="op" id="3462132">!=</span>&nbsp;<span class="string" id="3462135">&#34;&#34;</span>&nbsp;<span class="op" id="3462138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3462143">return</span>&nbsp;<span class="ident" id="3462150"><a href="/net/http/sniff.go.html#3462094">ct</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3462155">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3462158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3462162">return</span>&nbsp;<span class="string" id="3462169">&#34;application/octet-stream&#34;</span>&nbsp;<span class="comment" id="3462196">//&nbsp;fallback</span><br>
<span class="lineno"></span><span class="op" id="3462208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3462211">func</span>&nbsp;<span class="ident" id="3462216">isWS</span><span class="op" id="3462220">(</span><span class="ident" id="3462221">b</span>&nbsp;<span class="builtintype" id="3462223">byte</span><span class="op" id="3462227">)</span>&nbsp;<span class="builtintype" id="3462229">bool</span>&nbsp;<span class="op" id="3462234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3462237">return</span>&nbsp;<span class="ident" id="3462244"><a href="/net/http/sniff.go.html#3461341">bytes</a></span><span class="op" id="3462249">.</span><span class="ident" id="3462250">IndexByte</span><span class="op" id="3462259">(</span><span class="op" id="3462260">[</span><span class="op" id="3462261">]</span><span class="builtintype" id="3462262">byte</span><span class="op" id="3462266">(</span><span class="string" id="3462267">&#34;\t\n\x0C\r&nbsp;&#34;</span><span class="op" id="3462280">)</span><span class="op" id="3462281">,</span>&nbsp;<span class="ident" id="3462283"><a href="/net/http/sniff.go.html#3462221">b</a></span><span class="op" id="3462284">)</span>&nbsp;<span class="op" id="3462286">!=</span>&nbsp;<span class="op" id="3462289">-</span><span class="num" id="3462290">1</span><br>
<span class="lineno"></span><span class="op" id="3462292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3462295">type</span>&nbsp;<span class="ident" id="3462300">sniffSig</span>&nbsp;<span class="keyword" id="3462309">interface</span>&nbsp;<span class="op" id="3462319">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3462322">//&nbsp;match&nbsp;returns&nbsp;the&nbsp;MIME&nbsp;type&nbsp;of&nbsp;the&nbsp;data,&nbsp;or&nbsp;&#34;&#34;&nbsp;if&nbsp;unknown.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462385">match</span><span class="op" id="3462390">(</span><span class="ident" id="3462391">data</span>&nbsp;<span class="op" id="3462396">[</span><span class="op" id="3462397">]</span><span class="builtintype" id="3462398">byte</span><span class="op" id="3462402">,</span>&nbsp;<span class="ident" id="3462404">firstNonWS</span>&nbsp;<span class="builtintype" id="3462415">int</span><span class="op" id="3462418">)</span>&nbsp;<span class="builtintype" id="3462420">string</span><br>
<span class="lineno"></span><span class="op" id="3462427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3462430">//&nbsp;Data&nbsp;matching&nbsp;the&nbsp;table&nbsp;in&nbsp;section&nbsp;6.</span><br>
<span class="lineno">50</span><span class="keyword" id="3462471">var</span>&nbsp;<span class="ident" id="3462475">sniffSignatures</span>&nbsp;<span class="op" id="3462491">=</span>&nbsp;<span class="op" id="3462493">[</span><span class="op" id="3462494">]</span><span class="ident" id="3462495"><a href="/net/http/sniff.go.html#3462300">sniffSig</a></span><span class="op" id="3462503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462506"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462513">(</span><span class="string" id="3462514">&#34;&lt;!DOCTYPE&nbsp;HTML&#34;</span><span class="op" id="3462530">)</span><span class="op" id="3462531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462534"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462541">(</span><span class="string" id="3462542">&#34;&lt;HTML&#34;</span><span class="op" id="3462549">)</span><span class="op" id="3462550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462553"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462560">(</span><span class="string" id="3462561">&#34;&lt;HEAD&#34;</span><span class="op" id="3462568">)</span><span class="op" id="3462569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462572"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462579">(</span><span class="string" id="3462580">&#34;&lt;SCRIPT&#34;</span><span class="op" id="3462589">)</span><span class="op" id="3462590">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462593"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462600">(</span><span class="string" id="3462601">&#34;&lt;IFRAME&#34;</span><span class="op" id="3462610">)</span><span class="op" id="3462611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462614"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462621">(</span><span class="string" id="3462622">&#34;&lt;H1&#34;</span><span class="op" id="3462627">)</span><span class="op" id="3462628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462631"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462638">(</span><span class="string" id="3462639">&#34;&lt;DIV&#34;</span><span class="op" id="3462645">)</span><span class="op" id="3462646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462649"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462656">(</span><span class="string" id="3462657">&#34;&lt;FONT&#34;</span><span class="op" id="3462664">)</span><span class="op" id="3462665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462668"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462675">(</span><span class="string" id="3462676">&#34;&lt;TABLE&#34;</span><span class="op" id="3462684">)</span><span class="op" id="3462685">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462688"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462695">(</span><span class="string" id="3462696">&#34;&lt;A&#34;</span><span class="op" id="3462700">)</span><span class="op" id="3462701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462704"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462711">(</span><span class="string" id="3462712">&#34;&lt;STYLE&#34;</span><span class="op" id="3462720">)</span><span class="op" id="3462721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462724"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462731">(</span><span class="string" id="3462732">&#34;&lt;TITLE&#34;</span><span class="op" id="3462740">)</span><span class="op" id="3462741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462744"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462751">(</span><span class="string" id="3462752">&#34;&lt;B&#34;</span><span class="op" id="3462756">)</span><span class="op" id="3462757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462760"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462767">(</span><span class="string" id="3462768">&#34;&lt;BODY&#34;</span><span class="op" id="3462775">)</span><span class="op" id="3462776">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462779"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462786">(</span><span class="string" id="3462787">&#34;&lt;BR&#34;</span><span class="op" id="3462792">)</span><span class="op" id="3462793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462796"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462803">(</span><span class="string" id="3462804">&#34;&lt;P&#34;</span><span class="op" id="3462808">)</span><span class="op" id="3462809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3462812"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3462819">(</span><span class="string" id="3462820">&#34;&lt;!--&#34;</span><span class="op" id="3462826">)</span><span class="op" id="3462827">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3462831">&amp;</span><span class="ident" id="3462832"><a href="/net/http/sniff.go.html#3464666">maskedSig</a></span><span class="op" id="3462841">{</span><span class="ident" id="3462842">mask</span><span class="op" id="3462846">:</span>&nbsp;<span class="op" id="3462848">[</span><span class="op" id="3462849">]</span><span class="builtintype" id="3462850">byte</span><span class="op" id="3462854">(</span><span class="string" id="3462855">&#34;\xFF\xFF\xFF\xFF\xFF&#34;</span><span class="op" id="3462877">)</span><span class="op" id="3462878">,</span>&nbsp;<span class="ident" id="3462880">pat</span><span class="op" id="3462883">:</span>&nbsp;<span class="op" id="3462885">[</span><span class="op" id="3462886">]</span><span class="builtintype" id="3462887">byte</span><span class="op" id="3462891">(</span><span class="string" id="3462892">&#34;&lt;?xml&#34;</span><span class="op" id="3462899">)</span><span class="op" id="3462900">,</span>&nbsp;<span class="ident" id="3462902">skipWS</span><span class="op" id="3462908">:</span>&nbsp;<span class="builtintype" id="3462910">true</span><span class="op" id="3462914">,</span>&nbsp;<span class="ident" id="3462916">ct</span><span class="op" id="3462918">:</span>&nbsp;<span class="string" id="3462920">&#34;text/xml;&nbsp;charset=utf-8&#34;</span><span class="op" id="3462945">}</span><span class="op" id="3462946">,</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3462950">&amp;</span><span class="ident" id="3462951"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3462959">{</span><span class="op" id="3462960">[</span><span class="op" id="3462961">]</span><span class="builtintype" id="3462962">byte</span><span class="op" id="3462966">(</span><span class="string" id="3462967">&#34;%PDF-&#34;</span><span class="op" id="3462974">)</span><span class="op" id="3462975">,</span>&nbsp;<span class="string" id="3462977">&#34;application/pdf&#34;</span><span class="op" id="3462994">}</span><span class="op" id="3462995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3462998">&amp;</span><span class="ident" id="3462999"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3463007">{</span><span class="op" id="3463008">[</span><span class="op" id="3463009">]</span><span class="builtintype" id="3463010">byte</span><span class="op" id="3463014">(</span><span class="string" id="3463015">&#34;%!PS-Adobe-&#34;</span><span class="op" id="3463028">)</span><span class="op" id="3463029">,</span>&nbsp;<span class="string" id="3463031">&#34;application/postscript&#34;</span><span class="op" id="3463055">}</span><span class="op" id="3463056">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3463060">//&nbsp;UTF&nbsp;BOMs.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463074">&amp;</span><span class="ident" id="3463075"><a href="/net/http/sniff.go.html#3464666">maskedSig</a></span><span class="op" id="3463084">{</span><span class="ident" id="3463085">mask</span><span class="op" id="3463089">:</span>&nbsp;<span class="op" id="3463091">[</span><span class="op" id="3463092">]</span><span class="builtintype" id="3463093">byte</span><span class="op" id="3463097">(</span><span class="string" id="3463098">&#34;\xFF\xFF\x00\x00&#34;</span><span class="op" id="3463116">)</span><span class="op" id="3463117">,</span>&nbsp;<span class="ident" id="3463119">pat</span><span class="op" id="3463122">:</span>&nbsp;<span class="op" id="3463124">[</span><span class="op" id="3463125">]</span><span class="builtintype" id="3463126">byte</span><span class="op" id="3463130">(</span><span class="string" id="3463131">&#34;\xFE\xFF\x00\x00&#34;</span><span class="op" id="3463149">)</span><span class="op" id="3463150">,</span>&nbsp;<span class="ident" id="3463152">ct</span><span class="op" id="3463154">:</span>&nbsp;<span class="string" id="3463156">&#34;text/plain;&nbsp;charset=utf-16be&#34;</span><span class="op" id="3463186">}</span><span class="op" id="3463187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463190">&amp;</span><span class="ident" id="3463191"><a href="/net/http/sniff.go.html#3464666">maskedSig</a></span><span class="op" id="3463200">{</span><span class="ident" id="3463201">mask</span><span class="op" id="3463205">:</span>&nbsp;<span class="op" id="3463207">[</span><span class="op" id="3463208">]</span><span class="builtintype" id="3463209">byte</span><span class="op" id="3463213">(</span><span class="string" id="3463214">&#34;\xFF\xFF\x00\x00&#34;</span><span class="op" id="3463232">)</span><span class="op" id="3463233">,</span>&nbsp;<span class="ident" id="3463235">pat</span><span class="op" id="3463238">:</span>&nbsp;<span class="op" id="3463240">[</span><span class="op" id="3463241">]</span><span class="builtintype" id="3463242">byte</span><span class="op" id="3463246">(</span><span class="string" id="3463247">&#34;\xFF\xFE\x00\x00&#34;</span><span class="op" id="3463265">)</span><span class="op" id="3463266">,</span>&nbsp;<span class="ident" id="3463268">ct</span><span class="op" id="3463270">:</span>&nbsp;<span class="string" id="3463272">&#34;text/plain;&nbsp;charset=utf-16le&#34;</span><span class="op" id="3463302">}</span><span class="op" id="3463303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463306">&amp;</span><span class="ident" id="3463307"><a href="/net/http/sniff.go.html#3464666">maskedSig</a></span><span class="op" id="3463316">{</span><span class="ident" id="3463317">mask</span><span class="op" id="3463321">:</span>&nbsp;<span class="op" id="3463323">[</span><span class="op" id="3463324">]</span><span class="builtintype" id="3463325">byte</span><span class="op" id="3463329">(</span><span class="string" id="3463330">&#34;\xFF\xFF\xFF\x00&#34;</span><span class="op" id="3463348">)</span><span class="op" id="3463349">,</span>&nbsp;<span class="ident" id="3463351">pat</span><span class="op" id="3463354">:</span>&nbsp;<span class="op" id="3463356">[</span><span class="op" id="3463357">]</span><span class="builtintype" id="3463358">byte</span><span class="op" id="3463362">(</span><span class="string" id="3463363">&#34;\xEF\xBB\xBF\x00&#34;</span><span class="op" id="3463381">)</span><span class="op" id="3463382">,</span>&nbsp;<span class="ident" id="3463384">ct</span><span class="op" id="3463386">:</span>&nbsp;<span class="string" id="3463388">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="3463415">}</span><span class="op" id="3463416">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463420">&amp;</span><span class="ident" id="3463421"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3463429">{</span><span class="op" id="3463430">[</span><span class="op" id="3463431">]</span><span class="builtintype" id="3463432">byte</span><span class="op" id="3463436">(</span><span class="string" id="3463437">&#34;GIF87a&#34;</span><span class="op" id="3463445">)</span><span class="op" id="3463446">,</span>&nbsp;<span class="string" id="3463448">&#34;image/gif&#34;</span><span class="op" id="3463459">}</span><span class="op" id="3463460">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463463">&amp;</span><span class="ident" id="3463464"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3463472">{</span><span class="op" id="3463473">[</span><span class="op" id="3463474">]</span><span class="builtintype" id="3463475">byte</span><span class="op" id="3463479">(</span><span class="string" id="3463480">&#34;GIF89a&#34;</span><span class="op" id="3463488">)</span><span class="op" id="3463489">,</span>&nbsp;<span class="string" id="3463491">&#34;image/gif&#34;</span><span class="op" id="3463502">}</span><span class="op" id="3463503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463506">&amp;</span><span class="ident" id="3463507"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3463515">{</span><span class="op" id="3463516">[</span><span class="op" id="3463517">]</span><span class="builtintype" id="3463518">byte</span><span class="op" id="3463522">(</span><span class="string" id="3463523">&#34;\x89\x50\x4E\x47\x0D\x0A\x1A\x0A&#34;</span><span class="op" id="3463557">)</span><span class="op" id="3463558">,</span>&nbsp;<span class="string" id="3463560">&#34;image/png&#34;</span><span class="op" id="3463571">}</span><span class="op" id="3463572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463575">&amp;</span><span class="ident" id="3463576"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3463584">{</span><span class="op" id="3463585">[</span><span class="op" id="3463586">]</span><span class="builtintype" id="3463587">byte</span><span class="op" id="3463591">(</span><span class="string" id="3463592">&#34;\xFF\xD8\xFF&#34;</span><span class="op" id="3463606">)</span><span class="op" id="3463607">,</span>&nbsp;<span class="string" id="3463609">&#34;image/jpeg&#34;</span><span class="op" id="3463621">}</span><span class="op" id="3463622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463625">&amp;</span><span class="ident" id="3463626"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3463634">{</span><span class="op" id="3463635">[</span><span class="op" id="3463636">]</span><span class="builtintype" id="3463637">byte</span><span class="op" id="3463641">(</span><span class="string" id="3463642">&#34;BM&#34;</span><span class="op" id="3463646">)</span><span class="op" id="3463647">,</span>&nbsp;<span class="string" id="3463649">&#34;image/bmp&#34;</span><span class="op" id="3463660">}</span><span class="op" id="3463661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463664">&amp;</span><span class="ident" id="3463665"><a href="/net/http/sniff.go.html#3464666">maskedSig</a></span><span class="op" id="3463674">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3463678">mask</span><span class="op" id="3463682">:</span>&nbsp;<span class="op" id="3463684">[</span><span class="op" id="3463685">]</span><span class="builtintype" id="3463686">byte</span><span class="op" id="3463690">(</span><span class="string" id="3463691">&#34;\xFF\xFF\xFF\xFF\x00\x00\x00\x00\xFF\xFF\xFF\xFF\xFF\xFF&#34;</span><span class="op" id="3463749">)</span><span class="op" id="3463750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3463754">pat</span><span class="op" id="3463757">:</span>&nbsp;&nbsp;<span class="op" id="3463760">[</span><span class="op" id="3463761">]</span><span class="builtintype" id="3463762">byte</span><span class="op" id="3463766">(</span><span class="string" id="3463767">&#34;RIFF\x00\x00\x00\x00WEBPVP&#34;</span><span class="op" id="3463795">)</span><span class="op" id="3463796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3463800">ct</span><span class="op" id="3463802">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3463806">&#34;image/webp&#34;</span><span class="op" id="3463818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463821">}</span><span class="op" id="3463822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463825">&amp;</span><span class="ident" id="3463826"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3463834">{</span><span class="op" id="3463835">[</span><span class="op" id="3463836">]</span><span class="builtintype" id="3463837">byte</span><span class="op" id="3463841">(</span><span class="string" id="3463842">&#34;\x00\x00\x01\x00&#34;</span><span class="op" id="3463860">)</span><span class="op" id="3463861">,</span>&nbsp;<span class="string" id="3463863">&#34;image/vnd.microsoft.icon&#34;</span><span class="op" id="3463889">}</span><span class="op" id="3463890">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463893">&amp;</span><span class="ident" id="3463894"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3463902">{</span><span class="op" id="3463903">[</span><span class="op" id="3463904">]</span><span class="builtintype" id="3463905">byte</span><span class="op" id="3463909">(</span><span class="string" id="3463910">&#34;\x4F\x67\x67\x53\x00&#34;</span><span class="op" id="3463932">)</span><span class="op" id="3463933">,</span>&nbsp;<span class="string" id="3463935">&#34;application/ogg&#34;</span><span class="op" id="3463952">}</span><span class="op" id="3463953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3463956">&amp;</span><span class="ident" id="3463957"><a href="/net/http/sniff.go.html#3464666">maskedSig</a></span><span class="op" id="3463966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3463970">mask</span><span class="op" id="3463974">:</span>&nbsp;<span class="op" id="3463976">[</span><span class="op" id="3463977">]</span><span class="builtintype" id="3463978">byte</span><span class="op" id="3463982">(</span><span class="string" id="3463983">&#34;\xFF\xFF\xFF\xFF\x00\x00\x00\x00\xFF\xFF\xFF\xFF&#34;</span><span class="op" id="3464033">)</span><span class="op" id="3464034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3464038">pat</span><span class="op" id="3464041">:</span>&nbsp;&nbsp;<span class="op" id="3464044">[</span><span class="op" id="3464045">]</span><span class="builtintype" id="3464046">byte</span><span class="op" id="3464050">(</span><span class="string" id="3464051">&#34;RIFF\x00\x00\x00\x00WAVE&#34;</span><span class="op" id="3464077">)</span><span class="op" id="3464078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3464082">ct</span><span class="op" id="3464084">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3464088">&#34;audio/wave&#34;</span><span class="op" id="3464100">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3464103">}</span><span class="op" id="3464104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3464107">&amp;</span><span class="ident" id="3464108"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3464116">{</span><span class="op" id="3464117">[</span><span class="op" id="3464118">]</span><span class="builtintype" id="3464119">byte</span><span class="op" id="3464123">(</span><span class="string" id="3464124">&#34;\x1A\x45\xDF\xA3&#34;</span><span class="op" id="3464142">)</span><span class="op" id="3464143">,</span>&nbsp;<span class="string" id="3464145">&#34;video/webm&#34;</span><span class="op" id="3464157">}</span><span class="op" id="3464158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3464161">&amp;</span><span class="ident" id="3464162"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3464170">{</span><span class="op" id="3464171">[</span><span class="op" id="3464172">]</span><span class="builtintype" id="3464173">byte</span><span class="op" id="3464177">(</span><span class="string" id="3464178">&#34;\x52\x61\x72\x20\x1A\x07\x00&#34;</span><span class="op" id="3464208">)</span><span class="op" id="3464209">,</span>&nbsp;<span class="string" id="3464211">&#34;application/x-rar-compressed&#34;</span><span class="op" id="3464241">}</span><span class="op" id="3464242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3464245">&amp;</span><span class="ident" id="3464246"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3464254">{</span><span class="op" id="3464255">[</span><span class="op" id="3464256">]</span><span class="builtintype" id="3464257">byte</span><span class="op" id="3464261">(</span><span class="string" id="3464262">&#34;\x50\x4B\x03\x04&#34;</span><span class="op" id="3464280">)</span><span class="op" id="3464281">,</span>&nbsp;<span class="string" id="3464283">&#34;application/zip&#34;</span><span class="op" id="3464300">}</span><span class="op" id="3464301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3464304">&amp;</span><span class="ident" id="3464305"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3464313">{</span><span class="op" id="3464314">[</span><span class="op" id="3464315">]</span><span class="builtintype" id="3464316">byte</span><span class="op" id="3464320">(</span><span class="string" id="3464321">&#34;\x1F\x8B\x08&#34;</span><span class="op" id="3464335">)</span><span class="op" id="3464336">,</span>&nbsp;<span class="string" id="3464338">&#34;application/x-gzip&#34;</span><span class="op" id="3464358">}</span><span class="op" id="3464359">,</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3464363">//&nbsp;TODO(dsymonds):&nbsp;Re-enable&nbsp;this&nbsp;when&nbsp;the&nbsp;spec&nbsp;is&nbsp;sorted&nbsp;w.r.t.&nbsp;MP4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3464434">//mp4Sig(0),</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3464449"><a href="/net/http/sniff.go.html#3466143">textSig</a></span><span class="op" id="3464456">(</span><span class="num" id="3464457">0</span><span class="op" id="3464458">)</span><span class="op" id="3464459">,</span>&nbsp;<span class="comment" id="3464461">//&nbsp;should&nbsp;be&nbsp;last</span><br>
<span class="lineno">105</span><span class="op" id="3464479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3464482">type</span>&nbsp;<span class="ident" id="3464487">exactSig</span>&nbsp;<span class="keyword" id="3464496">struct</span>&nbsp;<span class="op" id="3464503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3464506">sig</span>&nbsp;<span class="op" id="3464510">[</span><span class="op" id="3464511">]</span><span class="builtintype" id="3464512">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3464518">ct</span>&nbsp;&nbsp;<span class="builtintype" id="3464522">string</span><br>
<span class="lineno">110</span><span class="op" id="3464529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3464532">func</span>&nbsp;<span class="op" id="3464537">(</span><span class="ident" id="3464538">e</span>&nbsp;<span class="op" id="3464540">*</span><span class="ident" id="3464541"><a href="/net/http/sniff.go.html#3464487">exactSig</a></span><span class="op" id="3464549">)</span>&nbsp;<span class="ident" id="3464551">match</span><span class="op" id="3464556">(</span><span class="ident" id="3464557">data</span>&nbsp;<span class="op" id="3464562">[</span><span class="op" id="3464563">]</span><span class="builtintype" id="3464564">byte</span><span class="op" id="3464568">,</span>&nbsp;<span class="ident" id="3464570">firstNonWS</span>&nbsp;<span class="builtintype" id="3464581">int</span><span class="op" id="3464584">)</span>&nbsp;<span class="builtintype" id="3464586">string</span>&nbsp;<span class="op" id="3464593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3464596">if</span>&nbsp;<span class="ident" id="3464599"><a href="/net/http/sniff.go.html#3461341">bytes</a></span><span class="op" id="3464604">.</span><span class="ident" id="3464605">HasPrefix</span><span class="op" id="3464614">(</span><span class="ident" id="3464615"><a href="/net/http/sniff.go.html#3464557">data</a></span><span class="op" id="3464619">,</span>&nbsp;<span class="ident" id="3464621"><a href="/net/http/sniff.go.html#3464538">e</a></span><span class="op" id="3464622">.</span><span class="ident" id="3464623">sig</span><span class="op" id="3464626">)</span>&nbsp;<span class="op" id="3464628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3464632">return</span>&nbsp;<span class="ident" id="3464639"><a href="/net/http/sniff.go.html#3464538">e</a></span><span class="op" id="3464640">.</span><span class="ident" id="3464641">ct</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3464645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3464648">return</span>&nbsp;<span class="string" id="3464655">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3464658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3464661">type</span>&nbsp;<span class="ident" id="3464666">maskedSig</span>&nbsp;<span class="keyword" id="3464676">struct</span>&nbsp;<span class="op" id="3464683">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3464686">mask</span><span class="op" id="3464690">,</span>&nbsp;<span class="ident" id="3464692">pat</span>&nbsp;<span class="op" id="3464696">[</span><span class="op" id="3464697">]</span><span class="builtintype" id="3464698">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3464704">skipWS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3464714">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3464720">ct</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3464730">string</span><br>
<span class="lineno"></span><span class="op" id="3464737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="3464740">func</span>&nbsp;<span class="op" id="3464745">(</span><span class="ident" id="3464746">m</span>&nbsp;<span class="op" id="3464748">*</span><span class="ident" id="3464749"><a href="/net/http/sniff.go.html#3464666">maskedSig</a></span><span class="op" id="3464758">)</span>&nbsp;<span class="ident" id="3464760">match</span><span class="op" id="3464765">(</span><span class="ident" id="3464766">data</span>&nbsp;<span class="op" id="3464771">[</span><span class="op" id="3464772">]</span><span class="builtintype" id="3464773">byte</span><span class="op" id="3464777">,</span>&nbsp;<span class="ident" id="3464779">firstNonWS</span>&nbsp;<span class="builtintype" id="3464790">int</span><span class="op" id="3464793">)</span>&nbsp;<span class="builtintype" id="3464795">string</span>&nbsp;<span class="op" id="3464802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3464805">if</span>&nbsp;<span class="ident" id="3464808"><a href="/net/http/sniff.go.html#3464746">m</a></span><span class="op" id="3464809">.</span><span class="ident" id="3464810">skipWS</span>&nbsp;<span class="op" id="3464817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3464821"><a href="/net/http/sniff.go.html#3464766">data</a></span>&nbsp;<span class="op" id="3464826">=</span>&nbsp;<span class="ident" id="3464828"><a href="/net/http/sniff.go.html#3464766">data</a></span><span class="op" id="3464832">[</span><span class="ident" id="3464833"><a href="/net/http/sniff.go.html#3464779">firstNonWS</a></span><span class="op" id="3464843">:</span><span class="op" id="3464844">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3464847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3464850">if</span>&nbsp;<span class="builtinfunc" id="3464853">len</span><span class="op" id="3464856">(</span><span class="ident" id="3464857"><a href="/net/http/sniff.go.html#3464766">data</a></span><span class="op" id="3464861">)</span>&nbsp;<span class="op" id="3464863">&lt;</span>&nbsp;<span class="builtinfunc" id="3464865">len</span><span class="op" id="3464868">(</span><span class="ident" id="3464869"><a href="/net/http/sniff.go.html#3464746">m</a></span><span class="op" id="3464870">.</span><span class="ident" id="3464871">mask</span><span class="op" id="3464875">)</span>&nbsp;<span class="op" id="3464877">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3464881">return</span>&nbsp;<span class="string" id="3464888">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3464892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3464895">for</span>&nbsp;<span class="ident" id="3464899">i</span><span class="op" id="3464900">,</span>&nbsp;<span class="ident" id="3464902">mask</span>&nbsp;<span class="op" id="3464907">:=</span>&nbsp;<span class="keyword" id="3464910">range</span>&nbsp;<span class="ident" id="3464916"><a href="/net/http/sniff.go.html#3464746">m</a></span><span class="op" id="3464917">.</span><span class="ident" id="3464918">mask</span>&nbsp;<span class="op" id="3464923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3464927">db</span>&nbsp;<span class="op" id="3464930">:=</span>&nbsp;<span class="ident" id="3464933"><a href="/net/http/sniff.go.html#3464766">data</a></span><span class="op" id="3464937">[</span><span class="ident" id="3464938"><a href="/net/http/sniff.go.html#3464899">i</a></span><span class="op" id="3464939">]</span>&nbsp;<span class="op" id="3464941">&amp;</span>&nbsp;<span class="ident" id="3464943"><a href="/net/http/sniff.go.html#3464902">mask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3464950">if</span>&nbsp;<span class="ident" id="3464953"><a href="/net/http/sniff.go.html#3464927">db</a></span>&nbsp;<span class="op" id="3464956">!=</span>&nbsp;<span class="ident" id="3464959"><a href="/net/http/sniff.go.html#3464746">m</a></span><span class="op" id="3464960">.</span><span class="ident" id="3464961">pat</span><span class="op" id="3464964">[</span><span class="ident" id="3464965"><a href="/net/http/sniff.go.html#3464899">i</a></span><span class="op" id="3464966">]</span>&nbsp;<span class="op" id="3464968">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3464973">return</span>&nbsp;<span class="string" id="3464980">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3464985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3464988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3464991">return</span>&nbsp;<span class="ident" id="3464998"><a href="/net/http/sniff.go.html#3464746">m</a></span><span class="op" id="3464999">.</span><span class="ident" id="3465000">ct</span><br>
<span class="lineno"></span><span class="op" id="3465003">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="3465006">type</span>&nbsp;<span class="ident" id="3465011">htmlSig</span>&nbsp;<span class="op" id="3465019">[</span><span class="op" id="3465020">]</span><span class="builtintype" id="3465021">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3465027">func</span>&nbsp;<span class="op" id="3465032">(</span><span class="ident" id="3465033">h</span>&nbsp;<span class="ident" id="3465035"><a href="/net/http/sniff.go.html#3465011">htmlSig</a></span><span class="op" id="3465042">)</span>&nbsp;<span class="ident" id="3465044">match</span><span class="op" id="3465049">(</span><span class="ident" id="3465050">data</span>&nbsp;<span class="op" id="3465055">[</span><span class="op" id="3465056">]</span><span class="builtintype" id="3465057">byte</span><span class="op" id="3465061">,</span>&nbsp;<span class="ident" id="3465063">firstNonWS</span>&nbsp;<span class="builtintype" id="3465074">int</span><span class="op" id="3465077">)</span>&nbsp;<span class="builtintype" id="3465079">string</span>&nbsp;<span class="op" id="3465086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3465089"><a href="/net/http/sniff.go.html#3465050">data</a></span>&nbsp;<span class="op" id="3465094">=</span>&nbsp;<span class="ident" id="3465096"><a href="/net/http/sniff.go.html#3465050">data</a></span><span class="op" id="3465100">[</span><span class="ident" id="3465101"><a href="/net/http/sniff.go.html#3465063">firstNonWS</a></span><span class="op" id="3465111">:</span><span class="op" id="3465112">]</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465115">if</span>&nbsp;<span class="builtinfunc" id="3465118">len</span><span class="op" id="3465121">(</span><span class="ident" id="3465122"><a href="/net/http/sniff.go.html#3465050">data</a></span><span class="op" id="3465126">)</span>&nbsp;<span class="op" id="3465128">&lt;</span>&nbsp;<span class="builtinfunc" id="3465130">len</span><span class="op" id="3465133">(</span><span class="ident" id="3465134"><a href="/net/http/sniff.go.html#3465033">h</a></span><span class="op" id="3465135">)</span><span class="op" id="3465136">+</span><span class="num" id="3465137">1</span>&nbsp;<span class="op" id="3465139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465143">return</span>&nbsp;<span class="string" id="3465150">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3465154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465157">for</span>&nbsp;<span class="ident" id="3465161">i</span><span class="op" id="3465162">,</span>&nbsp;<span class="ident" id="3465164">b</span>&nbsp;<span class="op" id="3465166">:=</span>&nbsp;<span class="keyword" id="3465169">range</span>&nbsp;<span class="ident" id="3465175"><a href="/net/http/sniff.go.html#3465033">h</a></span>&nbsp;<span class="op" id="3465177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3465181">db</span>&nbsp;<span class="op" id="3465184">:=</span>&nbsp;<span class="ident" id="3465187"><a href="/net/http/sniff.go.html#3465050">data</a></span><span class="op" id="3465191">[</span><span class="ident" id="3465192"><a href="/net/http/sniff.go.html#3465161">i</a></span><span class="op" id="3465193">]</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465197">if</span>&nbsp;<span class="string" id="3465200">&#39;A&#39;</span>&nbsp;<span class="op" id="3465204">&lt;=</span>&nbsp;<span class="ident" id="3465207"><a href="/net/http/sniff.go.html#3465164">b</a></span>&nbsp;<span class="op" id="3465209">&amp;&amp;</span>&nbsp;<span class="ident" id="3465212"><a href="/net/http/sniff.go.html#3465164">b</a></span>&nbsp;<span class="op" id="3465214">&lt;=</span>&nbsp;<span class="string" id="3465217">&#39;Z&#39;</span>&nbsp;<span class="op" id="3465221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3465226"><a href="/net/http/sniff.go.html#3465181">db</a></span>&nbsp;<span class="op" id="3465229">&amp;=</span>&nbsp;<span class="num" id="3465232">0xDF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3465239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465243">if</span>&nbsp;<span class="ident" id="3465246"><a href="/net/http/sniff.go.html#3465164">b</a></span>&nbsp;<span class="op" id="3465248">!=</span>&nbsp;<span class="ident" id="3465251"><a href="/net/http/sniff.go.html#3465181">db</a></span>&nbsp;<span class="op" id="3465254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465259">return</span>&nbsp;<span class="string" id="3465266">&#34;&#34;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3465271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3465274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3465277">//&nbsp;Next&nbsp;byte&nbsp;must&nbsp;be&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465329">if</span>&nbsp;<span class="ident" id="3465332">db</span>&nbsp;<span class="op" id="3465335">:=</span>&nbsp;<span class="ident" id="3465338"><a href="/net/http/sniff.go.html#3465050">data</a></span><span class="op" id="3465342">[</span><span class="builtinfunc" id="3465343">len</span><span class="op" id="3465346">(</span><span class="ident" id="3465347"><a href="/net/http/sniff.go.html#3465033">h</a></span><span class="op" id="3465348">)</span><span class="op" id="3465349">]</span><span class="op" id="3465350">;</span>&nbsp;<span class="ident" id="3465352"><a href="/net/http/sniff.go.html#3465332">db</a></span>&nbsp;<span class="op" id="3465355">!=</span>&nbsp;<span class="string" id="3465358">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3465362">&amp;&amp;</span>&nbsp;<span class="ident" id="3465365"><a href="/net/http/sniff.go.html#3465332">db</a></span>&nbsp;<span class="op" id="3465368">!=</span>&nbsp;<span class="string" id="3465371">&#39;&gt;&#39;</span>&nbsp;<span class="op" id="3465375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465379">return</span>&nbsp;<span class="string" id="3465386">&#34;&#34;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3465390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465393">return</span>&nbsp;<span class="string" id="3465400">&#34;text/html;&nbsp;charset=utf-8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3465427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3465430">type</span>&nbsp;<span class="ident" id="3465435">mp4Sig</span>&nbsp;<span class="builtintype" id="3465442">int</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3465447">func</span>&nbsp;<span class="op" id="3465452">(</span><span class="ident" id="3465453"><a href="/net/http/sniff.go.html#3465435">mp4Sig</a></span><span class="op" id="3465459">)</span>&nbsp;<span class="ident" id="3465461">match</span><span class="op" id="3465466">(</span><span class="ident" id="3465467">data</span>&nbsp;<span class="op" id="3465472">[</span><span class="op" id="3465473">]</span><span class="builtintype" id="3465474">byte</span><span class="op" id="3465478">,</span>&nbsp;<span class="ident" id="3465480">firstNonWS</span>&nbsp;<span class="builtintype" id="3465491">int</span><span class="op" id="3465494">)</span>&nbsp;<span class="builtintype" id="3465496">string</span>&nbsp;<span class="op" id="3465503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3465506">//&nbsp;c.f.&nbsp;section&nbsp;6.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465528">if</span>&nbsp;<span class="builtinfunc" id="3465531">len</span><span class="op" id="3465534">(</span><span class="ident" id="3465535"><a href="/net/http/sniff.go.html#3465467">data</a></span><span class="op" id="3465539">)</span>&nbsp;<span class="op" id="3465541">&lt;</span>&nbsp;<span class="num" id="3465543">8</span>&nbsp;<span class="op" id="3465545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465549">return</span>&nbsp;<span class="string" id="3465556">&#34;&#34;</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3465560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3465563">boxSize</span>&nbsp;<span class="op" id="3465571">:=</span>&nbsp;<span class="builtintype" id="3465574">int</span><span class="op" id="3465577">(</span><span class="ident" id="3465578"><a href="/net/http/sniff.go.html#3461350">binary</a></span><span class="op" id="3465584">.</span><span class="ident" id="3465585">BigEndian</span><span class="op" id="3465594">.</span><span class="ident" id="3465595">Uint32</span><span class="op" id="3465601">(</span><span class="ident" id="3465602"><a href="/net/http/sniff.go.html#3465467">data</a></span><span class="op" id="3465606">[</span><span class="op" id="3465607">:</span><span class="num" id="3465608">4</span><span class="op" id="3465609">]</span><span class="op" id="3465610">)</span><span class="op" id="3465611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465614">if</span>&nbsp;<span class="ident" id="3465617"><a href="/net/http/sniff.go.html#3465563">boxSize</a></span><span class="op" id="3465624">%</span><span class="num" id="3465625">4</span>&nbsp;<span class="op" id="3465627">!=</span>&nbsp;<span class="num" id="3465630">0</span>&nbsp;<span class="op" id="3465632">||</span>&nbsp;<span class="builtinfunc" id="3465635">len</span><span class="op" id="3465638">(</span><span class="ident" id="3465639"><a href="/net/http/sniff.go.html#3465467">data</a></span><span class="op" id="3465643">)</span>&nbsp;<span class="op" id="3465645">&lt;</span>&nbsp;<span class="ident" id="3465647"><a href="/net/http/sniff.go.html#3465563">boxSize</a></span>&nbsp;<span class="op" id="3465655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465659">return</span>&nbsp;<span class="string" id="3465666">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3465670">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465673">if</span>&nbsp;<span class="op" id="3465676">!</span><span class="ident" id="3465677"><a href="/net/http/sniff.go.html#3461341">bytes</a></span><span class="op" id="3465682">.</span><span class="ident" id="3465683">Equal</span><span class="op" id="3465688">(</span><span class="ident" id="3465689"><a href="/net/http/sniff.go.html#3465467">data</a></span><span class="op" id="3465693">[</span><span class="num" id="3465694">4</span><span class="op" id="3465695">:</span><span class="num" id="3465696">8</span><span class="op" id="3465697">]</span><span class="op" id="3465698">,</span>&nbsp;<span class="op" id="3465700">[</span><span class="op" id="3465701">]</span><span class="builtintype" id="3465702">byte</span><span class="op" id="3465706">(</span><span class="string" id="3465707">&#34;ftyp&#34;</span><span class="op" id="3465713">)</span><span class="op" id="3465714">)</span>&nbsp;<span class="op" id="3465716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465720">return</span>&nbsp;<span class="string" id="3465727">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3465731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465734">for</span>&nbsp;<span class="ident" id="3465738">st</span>&nbsp;<span class="op" id="3465741">:=</span>&nbsp;<span class="num" id="3465744">8</span><span class="op" id="3465745">;</span>&nbsp;<span class="ident" id="3465747"><a href="/net/http/sniff.go.html#3465738">st</a></span>&nbsp;<span class="op" id="3465750">&lt;</span>&nbsp;<span class="ident" id="3465752"><a href="/net/http/sniff.go.html#3465563">boxSize</a></span><span class="op" id="3465759">;</span>&nbsp;<span class="ident" id="3465761"><a href="/net/http/sniff.go.html#3465738">st</a></span>&nbsp;<span class="op" id="3465764">+=</span>&nbsp;<span class="num" id="3465767">4</span>&nbsp;<span class="op" id="3465769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465773">if</span>&nbsp;<span class="ident" id="3465776"><a href="/net/http/sniff.go.html#3465738">st</a></span>&nbsp;<span class="op" id="3465779">==</span>&nbsp;<span class="num" id="3465782">12</span>&nbsp;<span class="op" id="3465785">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3465790">//&nbsp;minor&nbsp;version&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465817">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3465828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3465832">seg</span>&nbsp;<span class="op" id="3465836">:=</span>&nbsp;<span class="builtintype" id="3465839">string</span><span class="op" id="3465845">(</span><span class="ident" id="3465846"><a href="/net/http/sniff.go.html#3465467">data</a></span><span class="op" id="3465850">[</span><span class="ident" id="3465851"><a href="/net/http/sniff.go.html#3465738">st</a></span>&nbsp;<span class="op" id="3465854">:</span>&nbsp;<span class="ident" id="3465856"><a href="/net/http/sniff.go.html#3465738">st</a></span><span class="op" id="3465858">+</span><span class="num" id="3465859">3</span><span class="op" id="3465860">]</span><span class="op" id="3465861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465865">switch</span>&nbsp;<span class="ident" id="3465872"><a href="/net/http/sniff.go.html#3465832">seg</a></span>&nbsp;<span class="op" id="3465876">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465880">case</span>&nbsp;<span class="string" id="3465885">&#34;mp4&#34;</span><span class="op" id="3465890">,</span>&nbsp;<span class="string" id="3465892">&#34;iso&#34;</span><span class="op" id="3465897">,</span>&nbsp;<span class="string" id="3465899">&#34;M4V&#34;</span><span class="op" id="3465904">,</span>&nbsp;<span class="string" id="3465906">&#34;M4P&#34;</span><span class="op" id="3465911">,</span>&nbsp;<span class="string" id="3465913">&#34;M4B&#34;</span><span class="op" id="3465918">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3465923">return</span>&nbsp;<span class="string" id="3465930">&#34;video/mp4&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3465945">/*&nbsp;The&nbsp;remainder&nbsp;are&nbsp;not&nbsp;in&nbsp;the&nbsp;spec.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcase&nbsp;&#34;M4A&#34;:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;&#34;audio/mp4&#34;<br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcase&nbsp;&#34;3gp&#34;:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;&#34;video/3gpp&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcase&nbsp;&#34;jp2&#34;:<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;&#34;image/jp2&#34;&nbsp;//&nbsp;JPEG&nbsp;2000<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp*/</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3466119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3466122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3466125">return</span>&nbsp;<span class="string" id="3466132">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3466135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="3466138">type</span>&nbsp;<span class="ident" id="3466143">textSig</span>&nbsp;<span class="builtintype" id="3466151">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3466156">func</span>&nbsp;<span class="op" id="3466161">(</span><span class="ident" id="3466162"><a href="/net/http/sniff.go.html#3466143">textSig</a></span><span class="op" id="3466169">)</span>&nbsp;<span class="ident" id="3466171">match</span><span class="op" id="3466176">(</span><span class="ident" id="3466177">data</span>&nbsp;<span class="op" id="3466182">[</span><span class="op" id="3466183">]</span><span class="builtintype" id="3466184">byte</span><span class="op" id="3466188">,</span>&nbsp;<span class="ident" id="3466190">firstNonWS</span>&nbsp;<span class="builtintype" id="3466201">int</span><span class="op" id="3466204">)</span>&nbsp;<span class="builtintype" id="3466206">string</span>&nbsp;<span class="op" id="3466213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3466216">//&nbsp;c.f.&nbsp;section&nbsp;5,&nbsp;step&nbsp;4.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3466244">for</span>&nbsp;<span class="ident" id="3466248">_</span><span class="op" id="3466249">,</span>&nbsp;<span class="ident" id="3466251">b</span>&nbsp;<span class="op" id="3466253">:=</span>&nbsp;<span class="keyword" id="3466256">range</span>&nbsp;<span class="ident" id="3466262"><a href="/net/http/sniff.go.html#3466177">data</a></span><span class="op" id="3466266">[</span><span class="ident" id="3466267"><a href="/net/http/sniff.go.html#3466190">firstNonWS</a></span><span class="op" id="3466277">:</span><span class="op" id="3466278">]</span>&nbsp;<span class="op" id="3466280">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3466284">switch</span>&nbsp;<span class="op" id="3466291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3466295">case</span>&nbsp;<span class="num" id="3466300">0x00</span>&nbsp;<span class="op" id="3466305">&lt;=</span>&nbsp;<span class="ident" id="3466308"><a href="/net/http/sniff.go.html#3466251">b</a></span>&nbsp;<span class="op" id="3466310">&amp;&amp;</span>&nbsp;<span class="ident" id="3466313"><a href="/net/http/sniff.go.html#3466251">b</a></span>&nbsp;<span class="op" id="3466315">&lt;=</span>&nbsp;<span class="num" id="3466318">0x08</span><span class="op" id="3466322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3466327"><a href="/net/http/sniff.go.html#3466251">b</a></span>&nbsp;<span class="op" id="3466329">==</span>&nbsp;<span class="num" id="3466332">0x0B</span><span class="op" id="3466336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3466341">0x0E</span>&nbsp;<span class="op" id="3466346">&lt;=</span>&nbsp;<span class="ident" id="3466349"><a href="/net/http/sniff.go.html#3466251">b</a></span>&nbsp;<span class="op" id="3466351">&amp;&amp;</span>&nbsp;<span class="ident" id="3466354"><a href="/net/http/sniff.go.html#3466251">b</a></span>&nbsp;<span class="op" id="3466356">&lt;=</span>&nbsp;<span class="num" id="3466359">0x1A</span><span class="op" id="3466363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="3466368">0x1C</span>&nbsp;<span class="op" id="3466373">&lt;=</span>&nbsp;<span class="ident" id="3466376"><a href="/net/http/sniff.go.html#3466251">b</a></span>&nbsp;<span class="op" id="3466378">&amp;&amp;</span>&nbsp;<span class="ident" id="3466381"><a href="/net/http/sniff.go.html#3466251">b</a></span>&nbsp;<span class="op" id="3466383">&lt;=</span>&nbsp;<span class="num" id="3466386">0x1F</span><span class="op" id="3466390">:</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3466395">return</span>&nbsp;<span class="string" id="3466402">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3466407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3466410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3466413">return</span>&nbsp;<span class="string" id="3466420">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3466448">}</span>
</div>
</body>
</html>
