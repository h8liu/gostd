<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode/utf16</h2>
<ul>
<li><a href="/gostd/unicode/utf16/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16.go.html">utf16.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16_test.go.html">utf16_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4400097">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4400153">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4400207">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4400258">//&nbsp;Package&nbsp;utf16&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;UTF-16&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="4400329">package</span>&nbsp;<span class="ident" id="4400337">utf16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4400344">//&nbsp;The&nbsp;conditions&nbsp;replacementChar==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4400407">//&nbsp;maxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno">10</span><span class="comment" id="4400462">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4400538">const</span>&nbsp;<span class="op" id="4400544">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400547">replacementChar</span>&nbsp;<span class="op" id="4400563">=</span>&nbsp;<span class="string" id="4400565">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4400578">//&nbsp;Unicode&nbsp;replacement&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400612">maxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4400628">=</span>&nbsp;<span class="string" id="4400630">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="4400643">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno">15</span><span class="op" id="4400680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4400683">const</span>&nbsp;<span class="op" id="4400689">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4400692">//&nbsp;0xd800-0xdc00&nbsp;encodes&nbsp;the&nbsp;high&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4400746">//&nbsp;0xdc00-0xe000&nbsp;encodes&nbsp;the&nbsp;low&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4400799">//&nbsp;the&nbsp;value&nbsp;is&nbsp;those&nbsp;20&nbsp;bits&nbsp;plus&nbsp;0x10000.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400844">surr1</span>&nbsp;<span class="op" id="4400850">=</span>&nbsp;<span class="num" id="4400852">0xd800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400860">surr2</span>&nbsp;<span class="op" id="4400866">=</span>&nbsp;<span class="num" id="4400868">0xdc00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400876">surr3</span>&nbsp;<span class="op" id="4400882">=</span>&nbsp;<span class="num" id="4400884">0xe000</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4400893">surrSelf</span>&nbsp;<span class="op" id="4400902">=</span>&nbsp;<span class="num" id="4400904">0x10000</span><br>
<span class="lineno"></span><span class="op" id="4400912">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4400915">//&nbsp;IsSurrogate&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;specified&nbsp;Unicode&nbsp;code&nbsp;point</span><br>
<span class="lineno"></span><span class="comment" id="4400979">//&nbsp;can&nbsp;appear&nbsp;in&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">30</span><span class="keyword" id="4401014">func</span>&nbsp;<span class="ident" id="4401019">IsSurrogate</span><span class="op" id="4401030">(</span><span class="ident" id="4401031">r</span>&nbsp;<span class="builtintype" id="4401033">rune</span><span class="op" id="4401037">)</span>&nbsp;<span class="builtintype" id="4401039">bool</span>&nbsp;<span class="op" id="4401044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401047">return</span>&nbsp;<span class="ident" id="4401054">surr1</span>&nbsp;<span class="op" id="4401060">&lt;=</span>&nbsp;<span class="ident" id="4401063">r</span>&nbsp;<span class="op" id="4401065">&amp;&amp;</span>&nbsp;<span class="ident" id="4401068">r</span>&nbsp;<span class="op" id="4401070">&lt;</span>&nbsp;<span class="ident" id="4401072">surr3</span><br>
<span class="lineno"></span><span class="op" id="4401078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4401081">//&nbsp;DecodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;decoding&nbsp;of&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">35</span><span class="comment" id="4401144">//&nbsp;If&nbsp;the&nbsp;pair&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;UTF-16&nbsp;surrogate&nbsp;pair,&nbsp;DecodeRune&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4401216">//&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;code&nbsp;point&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="4401262">func</span>&nbsp;<span class="ident" id="4401267">DecodeRune</span><span class="op" id="4401277">(</span><span class="ident" id="4401278">r1</span><span class="op" id="4401280">,</span>&nbsp;<span class="ident" id="4401282">r2</span>&nbsp;<span class="builtintype" id="4401285">rune</span><span class="op" id="4401289">)</span>&nbsp;<span class="builtintype" id="4401291">rune</span>&nbsp;<span class="op" id="4401296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401299">if</span>&nbsp;<span class="ident" id="4401302">surr1</span>&nbsp;<span class="op" id="4401308">&lt;=</span>&nbsp;<span class="ident" id="4401311">r1</span>&nbsp;<span class="op" id="4401314">&amp;&amp;</span>&nbsp;<span class="ident" id="4401317">r1</span>&nbsp;<span class="op" id="4401320">&lt;</span>&nbsp;<span class="ident" id="4401322">surr2</span>&nbsp;<span class="op" id="4401328">&amp;&amp;</span>&nbsp;<span class="ident" id="4401331">surr2</span>&nbsp;<span class="op" id="4401337">&lt;=</span>&nbsp;<span class="ident" id="4401340">r2</span>&nbsp;<span class="op" id="4401343">&amp;&amp;</span>&nbsp;<span class="ident" id="4401346">r2</span>&nbsp;<span class="op" id="4401349">&lt;</span>&nbsp;<span class="ident" id="4401351">surr3</span>&nbsp;<span class="op" id="4401357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401361">return</span>&nbsp;<span class="op" id="4401368">(</span><span class="ident" id="4401369">r1</span><span class="op" id="4401371">-</span><span class="ident" id="4401372">surr1</span><span class="op" id="4401377">)</span><span class="op" id="4401378">&lt;&lt;</span><span class="num" id="4401380">10</span>&nbsp;<span class="op" id="4401383">|</span>&nbsp;<span class="op" id="4401385">(</span><span class="ident" id="4401386">r2</span>&nbsp;<span class="op" id="4401389">-</span>&nbsp;<span class="ident" id="4401391">surr2</span><span class="op" id="4401396">)</span>&nbsp;<span class="op" id="4401398">+</span>&nbsp;<span class="num" id="4401400">0x10000</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4401409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401412">return</span>&nbsp;<span class="ident" id="4401419">replacementChar</span><br>
<span class="lineno"></span><span class="op" id="4401435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4401438">//&nbsp;EncodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;surrogate&nbsp;pair&nbsp;r1,&nbsp;r2&nbsp;for&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="4401513">//&nbsp;If&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;does&nbsp;not&nbsp;need&nbsp;encoding,</span><br>
<span class="lineno"></span><span class="comment" id="4401589">//&nbsp;EncodeRune&nbsp;returns&nbsp;U+FFFD,&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="4401627">func</span>&nbsp;<span class="ident" id="4401632">EncodeRune</span><span class="op" id="4401642">(</span><span class="ident" id="4401643">r</span>&nbsp;<span class="builtintype" id="4401645">rune</span><span class="op" id="4401649">)</span>&nbsp;<span class="op" id="4401651">(</span><span class="ident" id="4401652">r1</span><span class="op" id="4401654">,</span>&nbsp;<span class="ident" id="4401656">r2</span>&nbsp;<span class="builtintype" id="4401659">rune</span><span class="op" id="4401663">)</span>&nbsp;<span class="op" id="4401665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401668">if</span>&nbsp;<span class="ident" id="4401671">r</span>&nbsp;<span class="op" id="4401673">&lt;</span>&nbsp;<span class="ident" id="4401675">surrSelf</span>&nbsp;<span class="op" id="4401684">||</span>&nbsp;<span class="ident" id="4401687">r</span>&nbsp;<span class="op" id="4401689">&gt;</span>&nbsp;<span class="ident" id="4401691">maxRune</span>&nbsp;<span class="op" id="4401699">||</span>&nbsp;<span class="ident" id="4401702">IsSurrogate</span><span class="op" id="4401713">(</span><span class="ident" id="4401714">r</span><span class="op" id="4401715">)</span>&nbsp;<span class="op" id="4401717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401721">return</span>&nbsp;<span class="ident" id="4401728">replacementChar</span><span class="op" id="4401743">,</span>&nbsp;<span class="ident" id="4401745">replacementChar</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4401762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401765">r</span>&nbsp;<span class="op" id="4401767">-=</span>&nbsp;<span class="ident" id="4401770">surrSelf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401780">return</span>&nbsp;<span class="ident" id="4401787">surr1</span>&nbsp;<span class="op" id="4401793">+</span>&nbsp;<span class="op" id="4401795">(</span><span class="ident" id="4401796">r</span><span class="op" id="4401797">&gt;&gt;</span><span class="num" id="4401799">10</span><span class="op" id="4401801">)</span><span class="op" id="4401802">&amp;</span><span class="num" id="4401803">0x3ff</span><span class="op" id="4401808">,</span>&nbsp;<span class="ident" id="4401810">surr2</span>&nbsp;<span class="op" id="4401816">+</span>&nbsp;<span class="ident" id="4401818">r</span><span class="op" id="4401819">&amp;</span><span class="num" id="4401820">0x3ff</span><br>
<span class="lineno"></span><span class="op" id="4401826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="4401829">//&nbsp;Encode&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;of&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4401905">func</span>&nbsp;<span class="ident" id="4401910">Encode</span><span class="op" id="4401916">(</span><span class="ident" id="4401917">s</span>&nbsp;<span class="op" id="4401919">[</span><span class="op" id="4401920">]</span><span class="builtintype" id="4401921">rune</span><span class="op" id="4401925">)</span>&nbsp;<span class="op" id="4401927">[</span><span class="op" id="4401928">]</span><span class="builtintype" id="4401929">uint16</span>&nbsp;<span class="op" id="4401936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401939">n</span>&nbsp;<span class="op" id="4401941">:=</span>&nbsp;<span class="builtinfunc" id="4401944">len</span><span class="op" id="4401947">(</span><span class="ident" id="4401948">s</span><span class="op" id="4401949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401952">for</span>&nbsp;<span class="ident" id="4401956">_</span><span class="op" id="4401957">,</span>&nbsp;<span class="ident" id="4401959">v</span>&nbsp;<span class="op" id="4401961">:=</span>&nbsp;<span class="keyword" id="4401964">range</span>&nbsp;<span class="ident" id="4401970">s</span>&nbsp;<span class="op" id="4401972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4401976">if</span>&nbsp;<span class="ident" id="4401979">v</span>&nbsp;<span class="op" id="4401981">&gt;=</span>&nbsp;<span class="ident" id="4401984">surrSelf</span>&nbsp;<span class="op" id="4401993">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4401998">n</span><span class="op" id="4401999">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4402004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4402007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402011">a</span>&nbsp;<span class="op" id="4402013">:=</span>&nbsp;<span class="builtinfunc" id="4402016">make</span><span class="op" id="4402020">(</span><span class="op" id="4402021">[</span><span class="op" id="4402022">]</span><span class="builtintype" id="4402023">uint16</span><span class="op" id="4402029">,</span>&nbsp;<span class="ident" id="4402031">n</span><span class="op" id="4402032">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402035">n</span>&nbsp;<span class="op" id="4402037">=</span>&nbsp;<span class="num" id="4402039">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402042">for</span>&nbsp;<span class="ident" id="4402046">_</span><span class="op" id="4402047">,</span>&nbsp;<span class="ident" id="4402049">v</span>&nbsp;<span class="op" id="4402051">:=</span>&nbsp;<span class="keyword" id="4402054">range</span>&nbsp;<span class="ident" id="4402060">s</span>&nbsp;<span class="op" id="4402062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402066">switch</span>&nbsp;<span class="op" id="4402073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402077">case</span>&nbsp;<span class="ident" id="4402082">v</span>&nbsp;<span class="op" id="4402084">&lt;</span>&nbsp;<span class="num" id="4402086">0</span><span class="op" id="4402087">,</span>&nbsp;<span class="ident" id="4402089">surr1</span>&nbsp;<span class="op" id="4402095">&lt;=</span>&nbsp;<span class="ident" id="4402098">v</span>&nbsp;<span class="op" id="4402100">&amp;&amp;</span>&nbsp;<span class="ident" id="4402103">v</span>&nbsp;<span class="op" id="4402105">&lt;</span>&nbsp;<span class="ident" id="4402107">surr3</span><span class="op" id="4402112">,</span>&nbsp;<span class="ident" id="4402114">v</span>&nbsp;<span class="op" id="4402116">&gt;</span>&nbsp;<span class="ident" id="4402118">maxRune</span><span class="op" id="4402125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402130">v</span>&nbsp;<span class="op" id="4402132">=</span>&nbsp;<span class="ident" id="4402134">replacementChar</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402153">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402167">case</span>&nbsp;<span class="ident" id="4402172">v</span>&nbsp;<span class="op" id="4402174">&lt;</span>&nbsp;<span class="ident" id="4402176">surrSelf</span><span class="op" id="4402184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402189">a</span><span class="op" id="4402190">[</span><span class="ident" id="4402191">n</span><span class="op" id="4402192">]</span>&nbsp;<span class="op" id="4402194">=</span>&nbsp;<span class="builtintype" id="4402196">uint16</span><span class="op" id="4402202">(</span><span class="ident" id="4402203">v</span><span class="op" id="4402204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402209">n</span><span class="op" id="4402210">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402215">default</span><span class="op" id="4402222">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402227">r1</span><span class="op" id="4402229">,</span>&nbsp;<span class="ident" id="4402231">r2</span>&nbsp;<span class="op" id="4402234">:=</span>&nbsp;<span class="ident" id="4402237">EncodeRune</span><span class="op" id="4402247">(</span><span class="ident" id="4402248">v</span><span class="op" id="4402249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402254">a</span><span class="op" id="4402255">[</span><span class="ident" id="4402256">n</span><span class="op" id="4402257">]</span>&nbsp;<span class="op" id="4402259">=</span>&nbsp;<span class="builtintype" id="4402261">uint16</span><span class="op" id="4402267">(</span><span class="ident" id="4402268">r1</span><span class="op" id="4402270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402275">a</span><span class="op" id="4402276">[</span><span class="ident" id="4402277">n</span><span class="op" id="4402278">+</span><span class="num" id="4402279">1</span><span class="op" id="4402280">]</span>&nbsp;<span class="op" id="4402282">=</span>&nbsp;<span class="builtintype" id="4402284">uint16</span><span class="op" id="4402290">(</span><span class="ident" id="4402291">r2</span><span class="op" id="4402293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402298">n</span>&nbsp;<span class="op" id="4402300">+=</span>&nbsp;<span class="num" id="4402303">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4402307">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4402310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402313">return</span>&nbsp;<span class="ident" id="4402320">a</span><span class="op" id="4402321">[</span><span class="num" id="4402322">0</span><span class="op" id="4402323">:</span><span class="ident" id="4402324">n</span><span class="op" id="4402325">]</span><br>
<span class="lineno"></span><span class="op" id="4402327">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4402330">//&nbsp;Decode&nbsp;returns&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;represented</span><br>
<span class="lineno">85</span><span class="comment" id="4402392">//&nbsp;by&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4402421">func</span>&nbsp;<span class="ident" id="4402426">Decode</span><span class="op" id="4402432">(</span><span class="ident" id="4402433">s</span>&nbsp;<span class="op" id="4402435">[</span><span class="op" id="4402436">]</span><span class="builtintype" id="4402437">uint16</span><span class="op" id="4402443">)</span>&nbsp;<span class="op" id="4402445">[</span><span class="op" id="4402446">]</span><span class="builtintype" id="4402447">rune</span>&nbsp;<span class="op" id="4402452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402455">a</span>&nbsp;<span class="op" id="4402457">:=</span>&nbsp;<span class="builtinfunc" id="4402460">make</span><span class="op" id="4402464">(</span><span class="op" id="4402465">[</span><span class="op" id="4402466">]</span><span class="builtintype" id="4402467">rune</span><span class="op" id="4402471">,</span>&nbsp;<span class="builtinfunc" id="4402473">len</span><span class="op" id="4402476">(</span><span class="ident" id="4402477">s</span><span class="op" id="4402478">)</span><span class="op" id="4402479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402482">n</span>&nbsp;<span class="op" id="4402484">:=</span>&nbsp;<span class="num" id="4402487">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402490">for</span>&nbsp;<span class="ident" id="4402494">i</span>&nbsp;<span class="op" id="4402496">:=</span>&nbsp;<span class="num" id="4402499">0</span><span class="op" id="4402500">;</span>&nbsp;<span class="ident" id="4402502">i</span>&nbsp;<span class="op" id="4402504">&lt;</span>&nbsp;<span class="builtinfunc" id="4402506">len</span><span class="op" id="4402509">(</span><span class="ident" id="4402510">s</span><span class="op" id="4402511">)</span><span class="op" id="4402512">;</span>&nbsp;<span class="ident" id="4402514">i</span><span class="op" id="4402515">++</span>&nbsp;<span class="op" id="4402518">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402522">switch</span>&nbsp;<span class="ident" id="4402529">r</span>&nbsp;<span class="op" id="4402531">:=</span>&nbsp;<span class="ident" id="4402534">s</span><span class="op" id="4402535">[</span><span class="ident" id="4402536">i</span><span class="op" id="4402537">]</span><span class="op" id="4402538">;</span>&nbsp;<span class="op" id="4402540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402544">case</span>&nbsp;<span class="ident" id="4402549">surr1</span>&nbsp;<span class="op" id="4402555">&lt;=</span>&nbsp;<span class="ident" id="4402558">r</span>&nbsp;<span class="op" id="4402560">&amp;&amp;</span>&nbsp;<span class="ident" id="4402563">r</span>&nbsp;<span class="op" id="4402565">&lt;</span>&nbsp;<span class="ident" id="4402567">surr2</span>&nbsp;<span class="op" id="4402573">&amp;&amp;</span>&nbsp;<span class="ident" id="4402576">i</span><span class="op" id="4402577">+</span><span class="num" id="4402578">1</span>&nbsp;<span class="op" id="4402580">&lt;</span>&nbsp;<span class="builtinfunc" id="4402582">len</span><span class="op" id="4402585">(</span><span class="ident" id="4402586">s</span><span class="op" id="4402587">)</span>&nbsp;<span class="op" id="4402589">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402595">surr2</span>&nbsp;<span class="op" id="4402601">&lt;=</span>&nbsp;<span class="ident" id="4402604">s</span><span class="op" id="4402605">[</span><span class="ident" id="4402606">i</span><span class="op" id="4402607">+</span><span class="num" id="4402608">1</span><span class="op" id="4402609">]</span>&nbsp;<span class="op" id="4402611">&amp;&amp;</span>&nbsp;<span class="ident" id="4402614">s</span><span class="op" id="4402615">[</span><span class="ident" id="4402616">i</span><span class="op" id="4402617">+</span><span class="num" id="4402618">1</span><span class="op" id="4402619">]</span>&nbsp;<span class="op" id="4402621">&lt;</span>&nbsp;<span class="ident" id="4402623">surr3</span><span class="op" id="4402628">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4402633">//&nbsp;valid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402664">a</span><span class="op" id="4402665">[</span><span class="ident" id="4402666">n</span><span class="op" id="4402667">]</span>&nbsp;<span class="op" id="4402669">=</span>&nbsp;<span class="ident" id="4402671">DecodeRune</span><span class="op" id="4402681">(</span><span class="builtintype" id="4402682">rune</span><span class="op" id="4402686">(</span><span class="ident" id="4402687">r</span><span class="op" id="4402688">)</span><span class="op" id="4402689">,</span>&nbsp;<span class="builtintype" id="4402691">rune</span><span class="op" id="4402695">(</span><span class="ident" id="4402696">s</span><span class="op" id="4402697">[</span><span class="ident" id="4402698">i</span><span class="op" id="4402699">+</span><span class="num" id="4402700">1</span><span class="op" id="4402701">]</span><span class="op" id="4402702">)</span><span class="op" id="4402703">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402708">i</span><span class="op" id="4402709">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402715">n</span><span class="op" id="4402716">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402721">case</span>&nbsp;<span class="ident" id="4402726">surr1</span>&nbsp;<span class="op" id="4402732">&lt;=</span>&nbsp;<span class="ident" id="4402735">r</span>&nbsp;<span class="op" id="4402737">&amp;&amp;</span>&nbsp;<span class="ident" id="4402740">r</span>&nbsp;<span class="op" id="4402742">&lt;</span>&nbsp;<span class="ident" id="4402744">surr3</span><span class="op" id="4402749">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4402754">//&nbsp;invalid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402787">a</span><span class="op" id="4402788">[</span><span class="ident" id="4402789">n</span><span class="op" id="4402790">]</span>&nbsp;<span class="op" id="4402792">=</span>&nbsp;<span class="ident" id="4402794">replacementChar</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402813">n</span><span class="op" id="4402814">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402819">default</span><span class="op" id="4402826">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4402831">//&nbsp;normal&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402849">a</span><span class="op" id="4402850">[</span><span class="ident" id="4402851">n</span><span class="op" id="4402852">]</span>&nbsp;<span class="op" id="4402854">=</span>&nbsp;<span class="builtintype" id="4402856">rune</span><span class="op" id="4402860">(</span><span class="ident" id="4402861">r</span><span class="op" id="4402862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4402867">n</span><span class="op" id="4402868">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4402873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4402876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4402879">return</span>&nbsp;<span class="ident" id="4402886">a</span><span class="op" id="4402887">[</span><span class="num" id="4402888">0</span><span class="op" id="4402889">:</span><span class="ident" id="4402890">n</span><span class="op" id="4402891">]</span><br>
<span class="lineno"></span><span class="op" id="4402893">}</span>
</div>
</body>
</html>
