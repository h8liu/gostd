<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4084282">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4084337">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4084391">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4084442">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="4084515">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="4084549">//</span><br>
<span class="lineno"></span><span class="comment" id="4084552">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4084621">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="4084673">package</span>&nbsp;<span class="ident" id="4084681">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4084687">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="4084767">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="4084843">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="4084919">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4084998">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="4085073">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4085145">//</span><br>
<span class="lineno"></span><span class="comment" id="4085148">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="4085219">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4085248">import</span>&nbsp;<span class="op" id="4085255">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4085258">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4085265">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4085277">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4085288">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4085299">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4085306">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4085309">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4085385">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="4085425">type</span>&nbsp;<span class="ident" id="4085430">StructuralError</span>&nbsp;<span class="keyword" id="4085446">struct</span>&nbsp;<span class="op" id="4085453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085456">Msg</span>&nbsp;<span class="builtintype" id="4085460">string</span><br>
<span class="lineno"></span><span class="op" id="4085467">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4085470">func</span>&nbsp;<span class="op" id="4085475">(</span><span class="ident" id="4085476">e</span>&nbsp;<span class="ident" id="4085478">StructuralError</span><span class="op" id="4085493">)</span>&nbsp;<span class="ident" id="4085495">Error</span><span class="op" id="4085500">(</span><span class="op" id="4085501">)</span>&nbsp;<span class="builtintype" id="4085503">string</span>&nbsp;<span class="op" id="4085510">{</span>&nbsp;<span class="keyword" id="4085512">return</span>&nbsp;<span class="string" id="4085519">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4085545">+</span>&nbsp;<span class="ident" id="4085547">e</span><span class="op" id="4085548">.</span><span class="ident" id="4085549">Msg</span>&nbsp;<span class="op" id="4085553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4085556">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="4085614">type</span>&nbsp;<span class="ident" id="4085619">SyntaxError</span>&nbsp;<span class="keyword" id="4085631">struct</span>&nbsp;<span class="op" id="4085638">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085641">Msg</span>&nbsp;<span class="builtintype" id="4085645">string</span><br>
<span class="lineno"></span><span class="op" id="4085652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4085655">func</span>&nbsp;<span class="op" id="4085660">(</span><span class="ident" id="4085661">e</span>&nbsp;<span class="ident" id="4085663">SyntaxError</span><span class="op" id="4085674">)</span>&nbsp;<span class="ident" id="4085676">Error</span><span class="op" id="4085681">(</span><span class="op" id="4085682">)</span>&nbsp;<span class="builtintype" id="4085684">string</span>&nbsp;<span class="op" id="4085691">{</span>&nbsp;<span class="keyword" id="4085693">return</span>&nbsp;<span class="string" id="4085700">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4085723">+</span>&nbsp;<span class="ident" id="4085725">e</span><span class="op" id="4085726">.</span><span class="ident" id="4085727">Msg</span>&nbsp;<span class="op" id="4085731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4085734">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4085800">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4085812">func</span>&nbsp;<span class="ident" id="4085817">parseBool</span><span class="op" id="4085826">(</span><span class="ident" id="4085827">bytes</span>&nbsp;<span class="op" id="4085833">[</span><span class="op" id="4085834">]</span><span class="builtintype" id="4085835">byte</span><span class="op" id="4085839">)</span>&nbsp;<span class="op" id="4085841">(</span><span class="ident" id="4085842">ret</span>&nbsp;<span class="builtintype" id="4085846">bool</span><span class="op" id="4085850">,</span>&nbsp;<span class="ident" id="4085852">err</span>&nbsp;<span class="builtintype" id="4085856">error</span><span class="op" id="4085861">)</span>&nbsp;<span class="op" id="4085863">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085866">if</span>&nbsp;<span class="builtinfunc" id="4085869">len</span><span class="op" id="4085872">(</span><span class="ident" id="4085873">bytes</span><span class="op" id="4085878">)</span>&nbsp;<span class="op" id="4085880">!=</span>&nbsp;<span class="num" id="4085883">1</span>&nbsp;<span class="op" id="4085885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4085889">err</span>&nbsp;<span class="op" id="4085893">=</span>&nbsp;<span class="ident" id="4085895">SyntaxError</span><span class="op" id="4085906">{</span><span class="string" id="4085907">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4085924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4085928">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4085936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4085940">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4086013">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4086082">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086132">switch</span>&nbsp;<span class="ident" id="4086139">bytes</span><span class="op" id="4086144">[</span><span class="num" id="4086145">0</span><span class="op" id="4086146">]</span>&nbsp;<span class="op" id="4086148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086151">case</span>&nbsp;<span class="num" id="4086156">0</span><span class="op" id="4086157">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086161">ret</span>&nbsp;<span class="op" id="4086165">=</span>&nbsp;<span class="builtintype" id="4086167">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086174">case</span>&nbsp;<span class="num" id="4086179">0xff</span><span class="op" id="4086183">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086187">ret</span>&nbsp;<span class="op" id="4086191">=</span>&nbsp;<span class="builtintype" id="4086193">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086199">default</span><span class="op" id="4086206">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086210">err</span>&nbsp;<span class="op" id="4086214">=</span>&nbsp;<span class="ident" id="4086216">SyntaxError</span><span class="op" id="4086227">{</span><span class="string" id="4086228">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4086245">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086252">return</span><br>
<span class="lineno"></span><span class="op" id="4086259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4086262">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4086274">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4086347">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4086370">func</span>&nbsp;<span class="ident" id="4086375">parseInt64</span><span class="op" id="4086385">(</span><span class="ident" id="4086386">bytes</span>&nbsp;<span class="op" id="4086392">[</span><span class="op" id="4086393">]</span><span class="builtintype" id="4086394">byte</span><span class="op" id="4086398">)</span>&nbsp;<span class="op" id="4086400">(</span><span class="ident" id="4086401">ret</span>&nbsp;<span class="ident" id="4086405">int64</span><span class="op" id="4086410">,</span>&nbsp;<span class="ident" id="4086412">err</span>&nbsp;<span class="builtintype" id="4086416">error</span><span class="op" id="4086421">)</span>&nbsp;<span class="op" id="4086423">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086426">if</span>&nbsp;<span class="builtinfunc" id="4086429">len</span><span class="op" id="4086432">(</span><span class="ident" id="4086433">bytes</span><span class="op" id="4086438">)</span>&nbsp;<span class="op" id="4086440">&gt;</span>&nbsp;<span class="num" id="4086442">8</span>&nbsp;<span class="op" id="4086444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4086448">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086491">err</span>&nbsp;<span class="op" id="4086495">=</span>&nbsp;<span class="ident" id="4086497">StructuralError</span><span class="op" id="4086512">{</span><span class="string" id="4086513">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4086532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086536">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086544">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086547">for</span>&nbsp;<span class="ident" id="4086551">bytesRead</span>&nbsp;<span class="op" id="4086561">:=</span>&nbsp;<span class="num" id="4086564">0</span><span class="op" id="4086565">;</span>&nbsp;<span class="ident" id="4086567">bytesRead</span>&nbsp;<span class="op" id="4086577">&lt;</span>&nbsp;<span class="builtinfunc" id="4086579">len</span><span class="op" id="4086582">(</span><span class="ident" id="4086583">bytes</span><span class="op" id="4086588">)</span><span class="op" id="4086589">;</span>&nbsp;<span class="ident" id="4086591">bytesRead</span><span class="op" id="4086600">++</span>&nbsp;<span class="op" id="4086603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086607">ret</span>&nbsp;<span class="op" id="4086611">&lt;&lt;=</span>&nbsp;<span class="num" id="4086615">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086619">ret</span>&nbsp;<span class="op" id="4086623">|=</span>&nbsp;<span class="ident" id="4086626">int64</span><span class="op" id="4086631">(</span><span class="ident" id="4086632">bytes</span><span class="op" id="4086637">[</span><span class="ident" id="4086638">bytesRead</span><span class="op" id="4086647">]</span><span class="op" id="4086648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4086655">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086713">ret</span>&nbsp;<span class="op" id="4086717">&lt;&lt;=</span>&nbsp;<span class="num" id="4086721">64</span>&nbsp;<span class="op" id="4086724">-</span>&nbsp;<span class="builtintype" id="4086726">uint8</span><span class="op" id="4086731">(</span><span class="builtinfunc" id="4086732">len</span><span class="op" id="4086735">(</span><span class="ident" id="4086736">bytes</span><span class="op" id="4086741">)</span><span class="op" id="4086742">)</span><span class="op" id="4086743">*</span><span class="num" id="4086744">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086747">ret</span>&nbsp;<span class="op" id="4086751">&gt;&gt;=</span>&nbsp;<span class="num" id="4086755">64</span>&nbsp;<span class="op" id="4086758">-</span>&nbsp;<span class="builtintype" id="4086760">uint8</span><span class="op" id="4086765">(</span><span class="builtinfunc" id="4086766">len</span><span class="op" id="4086769">(</span><span class="ident" id="4086770">bytes</span><span class="op" id="4086775">)</span><span class="op" id="4086776">)</span><span class="op" id="4086777">*</span><span class="num" id="4086778">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086781">return</span><br>
<span class="lineno"></span><span class="op" id="4086788">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4086791">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4086870">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4086885">func</span>&nbsp;<span class="ident" id="4086890">parseInt32</span><span class="op" id="4086900">(</span><span class="ident" id="4086901">bytes</span>&nbsp;<span class="op" id="4086907">[</span><span class="op" id="4086908">]</span><span class="builtintype" id="4086909">byte</span><span class="op" id="4086913">)</span>&nbsp;<span class="op" id="4086915">(</span><span class="builtintype" id="4086916">int32</span><span class="op" id="4086921">,</span>&nbsp;<span class="builtintype" id="4086923">error</span><span class="op" id="4086928">)</span>&nbsp;<span class="op" id="4086930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4086933">ret64</span><span class="op" id="4086938">,</span>&nbsp;<span class="ident" id="4086940">err</span>&nbsp;<span class="op" id="4086944">:=</span>&nbsp;<span class="ident" id="4086947">parseInt64</span><span class="op" id="4086957">(</span><span class="ident" id="4086958">bytes</span><span class="op" id="4086963">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086966">if</span>&nbsp;<span class="ident" id="4086969">err</span>&nbsp;<span class="op" id="4086973">!=</span>&nbsp;<span class="ident" id="4086976">nil</span>&nbsp;<span class="op" id="4086980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4086984">return</span>&nbsp;<span class="num" id="4086991">0</span><span class="op" id="4086992">,</span>&nbsp;<span class="ident" id="4086994">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4086999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087002">if</span>&nbsp;<span class="ident" id="4087005">ret64</span>&nbsp;<span class="op" id="4087011">!=</span>&nbsp;<span class="ident" id="4087014">int64</span><span class="op" id="4087019">(</span><span class="builtintype" id="4087020">int32</span><span class="op" id="4087025">(</span><span class="ident" id="4087026">ret64</span><span class="op" id="4087031">)</span><span class="op" id="4087032">)</span>&nbsp;<span class="op" id="4087034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087038">return</span>&nbsp;<span class="num" id="4087045">0</span><span class="op" id="4087046">,</span>&nbsp;<span class="ident" id="4087048">StructuralError</span><span class="op" id="4087063">{</span><span class="string" id="4087064">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4087083">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087089">return</span>&nbsp;<span class="builtintype" id="4087096">int32</span><span class="op" id="4087101">(</span><span class="ident" id="4087102">ret64</span><span class="op" id="4087107">)</span><span class="op" id="4087108">,</span>&nbsp;<span class="ident" id="4087110">nil</span><br>
<span class="lineno"></span><span class="op" id="4087114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4087117">var</span>&nbsp;<span class="ident" id="4087121">bigOne</span>&nbsp;<span class="op" id="4087128">=</span>&nbsp;<span class="ident" id="4087130">big</span><span class="op" id="4087133">.</span><span class="ident" id="4087134">NewInt</span><span class="op" id="4087140">(</span><span class="num" id="4087141">1</span><span class="op" id="4087142">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4087145">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4087227">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4087242">func</span>&nbsp;<span class="ident" id="4087247">parseBigInt</span><span class="op" id="4087258">(</span><span class="ident" id="4087259">bytes</span>&nbsp;<span class="op" id="4087265">[</span><span class="op" id="4087266">]</span><span class="builtintype" id="4087267">byte</span><span class="op" id="4087271">)</span>&nbsp;<span class="op" id="4087273">*</span><span class="ident" id="4087274">big</span><span class="op" id="4087277">.</span><span class="ident" id="4087278">Int</span>&nbsp;<span class="op" id="4087282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087285">ret</span>&nbsp;<span class="op" id="4087289">:=</span>&nbsp;<span class="builtinfunc" id="4087292">new</span><span class="op" id="4087295">(</span><span class="ident" id="4087296">big</span><span class="op" id="4087299">.</span><span class="ident" id="4087300">Int</span><span class="op" id="4087303">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087306">if</span>&nbsp;<span class="builtinfunc" id="4087309">len</span><span class="op" id="4087312">(</span><span class="ident" id="4087313">bytes</span><span class="op" id="4087318">)</span>&nbsp;<span class="op" id="4087320">&gt;</span>&nbsp;<span class="num" id="4087322">0</span>&nbsp;<span class="op" id="4087324">&amp;&amp;</span>&nbsp;<span class="ident" id="4087327">bytes</span><span class="op" id="4087332">[</span><span class="num" id="4087333">0</span><span class="op" id="4087334">]</span><span class="op" id="4087335">&amp;</span><span class="num" id="4087336">0x80</span>&nbsp;<span class="op" id="4087341">==</span>&nbsp;<span class="num" id="4087344">0x80</span>&nbsp;<span class="op" id="4087349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4087353">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087385">notBytes</span>&nbsp;<span class="op" id="4087394">:=</span>&nbsp;<span class="builtinfunc" id="4087397">make</span><span class="op" id="4087401">(</span><span class="op" id="4087402">[</span><span class="op" id="4087403">]</span><span class="builtintype" id="4087404">byte</span><span class="op" id="4087408">,</span>&nbsp;<span class="builtinfunc" id="4087410">len</span><span class="op" id="4087413">(</span><span class="ident" id="4087414">bytes</span><span class="op" id="4087419">)</span><span class="op" id="4087420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087424">for</span>&nbsp;<span class="ident" id="4087428">i</span>&nbsp;<span class="op" id="4087430">:=</span>&nbsp;<span class="keyword" id="4087433">range</span>&nbsp;<span class="ident" id="4087439">notBytes</span>&nbsp;<span class="op" id="4087448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087453">notBytes</span><span class="op" id="4087461">[</span><span class="ident" id="4087462">i</span><span class="op" id="4087463">]</span>&nbsp;<span class="op" id="4087465">=</span>&nbsp;<span class="op" id="4087467">^</span><span class="ident" id="4087468">bytes</span><span class="op" id="4087473">[</span><span class="ident" id="4087474">i</span><span class="op" id="4087475">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087483">ret</span><span class="op" id="4087486">.</span><span class="ident" id="4087487">SetBytes</span><span class="op" id="4087495">(</span><span class="ident" id="4087496">notBytes</span><span class="op" id="4087504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087508">ret</span><span class="op" id="4087511">.</span><span class="ident" id="4087512">Add</span><span class="op" id="4087515">(</span><span class="ident" id="4087516">ret</span><span class="op" id="4087519">,</span>&nbsp;<span class="ident" id="4087521">bigOne</span><span class="op" id="4087527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087531">ret</span><span class="op" id="4087534">.</span><span class="ident" id="4087535">Neg</span><span class="op" id="4087538">(</span><span class="ident" id="4087539">ret</span><span class="op" id="4087542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087546">return</span>&nbsp;<span class="ident" id="4087553">ret</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4087558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087561">ret</span><span class="op" id="4087564">.</span><span class="ident" id="4087565">SetBytes</span><span class="op" id="4087573">(</span><span class="ident" id="4087574">bytes</span><span class="op" id="4087579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4087582">return</span>&nbsp;<span class="ident" id="4087589">ret</span><br>
<span class="lineno"></span><span class="op" id="4087593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4087596">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4087611">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="4087690">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4087765">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="4087819">type</span>&nbsp;<span class="ident" id="4087824">BitString</span>&nbsp;<span class="keyword" id="4087834">struct</span>&nbsp;<span class="op" id="4087841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087844">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4087854">[</span><span class="op" id="4087855">]</span><span class="builtintype" id="4087856">byte</span>&nbsp;<span class="comment" id="4087861">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4087889">BitLength</span>&nbsp;<span class="builtintype" id="4087899">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4087906">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="4087925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4087928">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4088002">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="4088020">func</span>&nbsp;<span class="op" id="4088025">(</span><span class="ident" id="4088026">b</span>&nbsp;<span class="ident" id="4088028">BitString</span><span class="op" id="4088037">)</span>&nbsp;<span class="ident" id="4088039">At</span><span class="op" id="4088041">(</span><span class="ident" id="4088042">i</span>&nbsp;<span class="builtintype" id="4088044">int</span><span class="op" id="4088047">)</span>&nbsp;<span class="builtintype" id="4088049">int</span>&nbsp;<span class="op" id="4088053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088056">if</span>&nbsp;<span class="ident" id="4088059">i</span>&nbsp;<span class="op" id="4088061">&lt;</span>&nbsp;<span class="num" id="4088063">0</span>&nbsp;<span class="op" id="4088065">||</span>&nbsp;<span class="ident" id="4088068">i</span>&nbsp;<span class="op" id="4088070">&gt;=</span>&nbsp;<span class="ident" id="4088073">b</span><span class="op" id="4088074">.</span><span class="ident" id="4088075">BitLength</span>&nbsp;<span class="op" id="4088085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088089">return</span>&nbsp;<span class="num" id="4088096">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088102">x</span>&nbsp;<span class="op" id="4088104">:=</span>&nbsp;<span class="ident" id="4088107">i</span>&nbsp;<span class="op" id="4088109">/</span>&nbsp;<span class="num" id="4088111">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088114">y</span>&nbsp;<span class="op" id="4088116">:=</span>&nbsp;<span class="num" id="4088119">7</span>&nbsp;<span class="op" id="4088121">-</span>&nbsp;<span class="builtintype" id="4088123">uint</span><span class="op" id="4088127">(</span><span class="ident" id="4088128">i</span><span class="op" id="4088129">%</span><span class="num" id="4088130">8</span><span class="op" id="4088131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088134">return</span>&nbsp;<span class="builtintype" id="4088141">int</span><span class="op" id="4088144">(</span><span class="ident" id="4088145">b</span><span class="op" id="4088146">.</span><span class="ident" id="4088147">Bytes</span><span class="op" id="4088152">[</span><span class="ident" id="4088153">x</span><span class="op" id="4088154">]</span><span class="op" id="4088155">&gt;&gt;</span><span class="ident" id="4088157">y</span><span class="op" id="4088158">)</span>&nbsp;<span class="op" id="4088160">&amp;</span>&nbsp;<span class="num" id="4088162">1</span><br>
<span class="lineno"></span><span class="op" id="4088164">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4088167">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4088246">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="4088292">func</span>&nbsp;<span class="op" id="4088297">(</span><span class="ident" id="4088298">b</span>&nbsp;<span class="ident" id="4088300">BitString</span><span class="op" id="4088309">)</span>&nbsp;<span class="ident" id="4088311">RightAlign</span><span class="op" id="4088321">(</span><span class="op" id="4088322">)</span>&nbsp;<span class="op" id="4088324">[</span><span class="op" id="4088325">]</span><span class="builtintype" id="4088326">byte</span>&nbsp;<span class="op" id="4088331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088334">shift</span>&nbsp;<span class="op" id="4088340">:=</span>&nbsp;<span class="builtintype" id="4088343">uint</span><span class="op" id="4088347">(</span><span class="num" id="4088348">8</span>&nbsp;<span class="op" id="4088350">-</span>&nbsp;<span class="op" id="4088352">(</span><span class="ident" id="4088353">b</span><span class="op" id="4088354">.</span><span class="ident" id="4088355">BitLength</span>&nbsp;<span class="op" id="4088365">%</span>&nbsp;<span class="num" id="4088367">8</span><span class="op" id="4088368">)</span><span class="op" id="4088369">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088372">if</span>&nbsp;<span class="ident" id="4088375">shift</span>&nbsp;<span class="op" id="4088381">==</span>&nbsp;<span class="num" id="4088384">8</span>&nbsp;<span class="op" id="4088386">||</span>&nbsp;<span class="builtinfunc" id="4088389">len</span><span class="op" id="4088392">(</span><span class="ident" id="4088393">b</span><span class="op" id="4088394">.</span><span class="ident" id="4088395">Bytes</span><span class="op" id="4088400">)</span>&nbsp;<span class="op" id="4088402">==</span>&nbsp;<span class="num" id="4088405">0</span>&nbsp;<span class="op" id="4088407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088411">return</span>&nbsp;<span class="ident" id="4088418">b</span><span class="op" id="4088419">.</span><span class="ident" id="4088420">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088431">a</span>&nbsp;<span class="op" id="4088433">:=</span>&nbsp;<span class="builtinfunc" id="4088436">make</span><span class="op" id="4088440">(</span><span class="op" id="4088441">[</span><span class="op" id="4088442">]</span><span class="builtintype" id="4088443">byte</span><span class="op" id="4088447">,</span>&nbsp;<span class="builtinfunc" id="4088449">len</span><span class="op" id="4088452">(</span><span class="ident" id="4088453">b</span><span class="op" id="4088454">.</span><span class="ident" id="4088455">Bytes</span><span class="op" id="4088460">)</span><span class="op" id="4088461">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088464">a</span><span class="op" id="4088465">[</span><span class="num" id="4088466">0</span><span class="op" id="4088467">]</span>&nbsp;<span class="op" id="4088469">=</span>&nbsp;<span class="ident" id="4088471">b</span><span class="op" id="4088472">.</span><span class="ident" id="4088473">Bytes</span><span class="op" id="4088478">[</span><span class="num" id="4088479">0</span><span class="op" id="4088480">]</span>&nbsp;<span class="op" id="4088482">&gt;&gt;</span>&nbsp;<span class="ident" id="4088485">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088492">for</span>&nbsp;<span class="ident" id="4088496">i</span>&nbsp;<span class="op" id="4088498">:=</span>&nbsp;<span class="num" id="4088501">1</span><span class="op" id="4088502">;</span>&nbsp;<span class="ident" id="4088504">i</span>&nbsp;<span class="op" id="4088506">&lt;</span>&nbsp;<span class="builtinfunc" id="4088508">len</span><span class="op" id="4088511">(</span><span class="ident" id="4088512">b</span><span class="op" id="4088513">.</span><span class="ident" id="4088514">Bytes</span><span class="op" id="4088519">)</span><span class="op" id="4088520">;</span>&nbsp;<span class="ident" id="4088522">i</span><span class="op" id="4088523">++</span>&nbsp;<span class="op" id="4088526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088530">a</span><span class="op" id="4088531">[</span><span class="ident" id="4088532">i</span><span class="op" id="4088533">]</span>&nbsp;<span class="op" id="4088535">=</span>&nbsp;<span class="ident" id="4088537">b</span><span class="op" id="4088538">.</span><span class="ident" id="4088539">Bytes</span><span class="op" id="4088544">[</span><span class="ident" id="4088545">i</span><span class="op" id="4088546">-</span><span class="num" id="4088547">1</span><span class="op" id="4088548">]</span>&nbsp;<span class="op" id="4088550">&lt;&lt;</span>&nbsp;<span class="op" id="4088553">(</span><span class="num" id="4088554">8</span>&nbsp;<span class="op" id="4088556">-</span>&nbsp;<span class="ident" id="4088558">shift</span><span class="op" id="4088563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088567">a</span><span class="op" id="4088568">[</span><span class="ident" id="4088569">i</span><span class="op" id="4088570">]</span>&nbsp;<span class="op" id="4088572">|=</span>&nbsp;<span class="ident" id="4088575">b</span><span class="op" id="4088576">.</span><span class="ident" id="4088577">Bytes</span><span class="op" id="4088582">[</span><span class="ident" id="4088583">i</span><span class="op" id="4088584">]</span>&nbsp;<span class="op" id="4088586">&gt;&gt;</span>&nbsp;<span class="ident" id="4088589">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088596">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088600">return</span>&nbsp;<span class="ident" id="4088607">a</span><br>
<span class="lineno"></span><span class="op" id="4088609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4088612">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="4088699">func</span>&nbsp;<span class="ident" id="4088704">parseBitString</span><span class="op" id="4088718">(</span><span class="ident" id="4088719">bytes</span>&nbsp;<span class="op" id="4088725">[</span><span class="op" id="4088726">]</span><span class="builtintype" id="4088727">byte</span><span class="op" id="4088731">)</span>&nbsp;<span class="op" id="4088733">(</span><span class="ident" id="4088734">ret</span>&nbsp;<span class="ident" id="4088738">BitString</span><span class="op" id="4088747">,</span>&nbsp;<span class="ident" id="4088749">err</span>&nbsp;<span class="builtintype" id="4088753">error</span><span class="op" id="4088758">)</span>&nbsp;<span class="op" id="4088760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088763">if</span>&nbsp;<span class="builtinfunc" id="4088766">len</span><span class="op" id="4088769">(</span><span class="ident" id="4088770">bytes</span><span class="op" id="4088775">)</span>&nbsp;<span class="op" id="4088777">==</span>&nbsp;<span class="num" id="4088780">0</span>&nbsp;<span class="op" id="4088782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088786">err</span>&nbsp;<span class="op" id="4088790">=</span>&nbsp;<span class="ident" id="4088792">SyntaxError</span><span class="op" id="4088803">{</span><span class="string" id="4088804">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4088828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088832">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4088840">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088843">paddingBits</span>&nbsp;<span class="op" id="4088855">:=</span>&nbsp;<span class="builtintype" id="4088858">int</span><span class="op" id="4088861">(</span><span class="ident" id="4088862">bytes</span><span class="op" id="4088867">[</span><span class="num" id="4088868">0</span><span class="op" id="4088869">]</span><span class="op" id="4088870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4088873">if</span>&nbsp;<span class="ident" id="4088876">paddingBits</span>&nbsp;<span class="op" id="4088888">&gt;</span>&nbsp;<span class="num" id="4088890">7</span>&nbsp;<span class="op" id="4088892">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4088897">len</span><span class="op" id="4088900">(</span><span class="ident" id="4088901">bytes</span><span class="op" id="4088906">)</span>&nbsp;<span class="op" id="4088908">==</span>&nbsp;<span class="num" id="4088911">1</span>&nbsp;<span class="op" id="4088913">&amp;&amp;</span>&nbsp;<span class="ident" id="4088916">paddingBits</span>&nbsp;<span class="op" id="4088928">&gt;</span>&nbsp;<span class="num" id="4088930">0</span>&nbsp;<span class="op" id="4088932">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088937">bytes</span><span class="op" id="4088942">[</span><span class="builtinfunc" id="4088943">len</span><span class="op" id="4088946">(</span><span class="ident" id="4088947">bytes</span><span class="op" id="4088952">)</span><span class="op" id="4088953">-</span><span class="num" id="4088954">1</span><span class="op" id="4088955">]</span><span class="op" id="4088956">&amp;</span><span class="op" id="4088957">(</span><span class="op" id="4088958">(</span><span class="num" id="4088959">1</span><span class="op" id="4088960">&lt;&lt;</span><span class="ident" id="4088962">bytes</span><span class="op" id="4088967">[</span><span class="num" id="4088968">0</span><span class="op" id="4088969">]</span><span class="op" id="4088970">)</span><span class="op" id="4088971">-</span><span class="num" id="4088972">1</span><span class="op" id="4088973">)</span>&nbsp;<span class="op" id="4088975">!=</span>&nbsp;<span class="num" id="4088978">0</span>&nbsp;<span class="op" id="4088980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4088984">err</span>&nbsp;<span class="op" id="4088988">=</span>&nbsp;<span class="ident" id="4088990">SyntaxError</span><span class="op" id="4089001">{</span><span class="string" id="4089002">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4089038">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089042">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089053">ret</span><span class="op" id="4089056">.</span><span class="ident" id="4089057">BitLength</span>&nbsp;<span class="op" id="4089067">=</span>&nbsp;<span class="op" id="4089069">(</span><span class="builtinfunc" id="4089070">len</span><span class="op" id="4089073">(</span><span class="ident" id="4089074">bytes</span><span class="op" id="4089079">)</span><span class="op" id="4089080">-</span><span class="num" id="4089081">1</span><span class="op" id="4089082">)</span><span class="op" id="4089083">*</span><span class="num" id="4089084">8</span>&nbsp;<span class="op" id="4089086">-</span>&nbsp;<span class="ident" id="4089088">paddingBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089101">ret</span><span class="op" id="4089104">.</span><span class="ident" id="4089105">Bytes</span>&nbsp;<span class="op" id="4089111">=</span>&nbsp;<span class="ident" id="4089113">bytes</span><span class="op" id="4089118">[</span><span class="num" id="4089119">1</span><span class="op" id="4089120">:</span><span class="op" id="4089121">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089124">return</span><br>
<span class="lineno">180</span><span class="op" id="4089131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4089134">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4089156">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="4089218">type</span>&nbsp;<span class="ident" id="4089223">ObjectIdentifier</span>&nbsp;<span class="op" id="4089240">[</span><span class="op" id="4089241">]</span><span class="builtintype" id="4089242">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4089247">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="4089316">func</span>&nbsp;<span class="op" id="4089321">(</span><span class="ident" id="4089322">oi</span>&nbsp;<span class="ident" id="4089325">ObjectIdentifier</span><span class="op" id="4089341">)</span>&nbsp;<span class="ident" id="4089343">Equal</span><span class="op" id="4089348">(</span><span class="ident" id="4089349">other</span>&nbsp;<span class="ident" id="4089355">ObjectIdentifier</span><span class="op" id="4089371">)</span>&nbsp;<span class="builtintype" id="4089373">bool</span>&nbsp;<span class="op" id="4089378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089381">if</span>&nbsp;<span class="builtinfunc" id="4089384">len</span><span class="op" id="4089387">(</span><span class="ident" id="4089388">oi</span><span class="op" id="4089390">)</span>&nbsp;<span class="op" id="4089392">!=</span>&nbsp;<span class="builtinfunc" id="4089395">len</span><span class="op" id="4089398">(</span><span class="ident" id="4089399">other</span><span class="op" id="4089404">)</span>&nbsp;<span class="op" id="4089406">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089410">return</span>&nbsp;<span class="builtintype" id="4089417">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089427">for</span>&nbsp;<span class="ident" id="4089431">i</span>&nbsp;<span class="op" id="4089433">:=</span>&nbsp;<span class="num" id="4089436">0</span><span class="op" id="4089437">;</span>&nbsp;<span class="ident" id="4089439">i</span>&nbsp;<span class="op" id="4089441">&lt;</span>&nbsp;<span class="builtinfunc" id="4089443">len</span><span class="op" id="4089446">(</span><span class="ident" id="4089447">oi</span><span class="op" id="4089449">)</span><span class="op" id="4089450">;</span>&nbsp;<span class="ident" id="4089452">i</span><span class="op" id="4089453">++</span>&nbsp;<span class="op" id="4089456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089460">if</span>&nbsp;<span class="ident" id="4089463">oi</span><span class="op" id="4089465">[</span><span class="ident" id="4089466">i</span><span class="op" id="4089467">]</span>&nbsp;<span class="op" id="4089469">!=</span>&nbsp;<span class="ident" id="4089472">other</span><span class="op" id="4089477">[</span><span class="ident" id="4089478">i</span><span class="op" id="4089479">]</span>&nbsp;<span class="op" id="4089481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089486">return</span>&nbsp;<span class="builtintype" id="4089493">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089508">return</span>&nbsp;<span class="builtintype" id="4089515">true</span><br>
<span class="lineno"></span><span class="op" id="4089520">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4089523">func</span>&nbsp;<span class="op" id="4089528">(</span><span class="ident" id="4089529">oi</span>&nbsp;<span class="ident" id="4089532">ObjectIdentifier</span><span class="op" id="4089548">)</span>&nbsp;<span class="ident" id="4089550">String</span><span class="op" id="4089556">(</span><span class="op" id="4089557">)</span>&nbsp;<span class="builtintype" id="4089559">string</span>&nbsp;<span class="op" id="4089566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089569">var</span>&nbsp;<span class="ident" id="4089573">s</span>&nbsp;<span class="builtintype" id="4089575">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089584">for</span>&nbsp;<span class="ident" id="4089588">i</span><span class="op" id="4089589">,</span>&nbsp;<span class="ident" id="4089591">v</span>&nbsp;<span class="op" id="4089593">:=</span>&nbsp;<span class="keyword" id="4089596">range</span>&nbsp;<span class="ident" id="4089602">oi</span>&nbsp;<span class="op" id="4089605">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089609">if</span>&nbsp;<span class="ident" id="4089612">i</span>&nbsp;<span class="op" id="4089614">&gt;</span>&nbsp;<span class="num" id="4089616">0</span>&nbsp;<span class="op" id="4089618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089623">s</span>&nbsp;<span class="op" id="4089625">+=</span>&nbsp;<span class="string" id="4089628">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089638">s</span>&nbsp;<span class="op" id="4089640">+=</span>&nbsp;<span class="ident" id="4089643">strconv</span><span class="op" id="4089650">.</span><span class="ident" id="4089651">Itoa</span><span class="op" id="4089655">(</span><span class="ident" id="4089656">v</span><span class="op" id="4089657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4089660">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089664">return</span>&nbsp;<span class="ident" id="4089671">s</span><br>
<span class="lineno"></span><span class="op" id="4089673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4089676">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="4089754">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="4089832">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="4089869">func</span>&nbsp;<span class="ident" id="4089874">parseObjectIdentifier</span><span class="op" id="4089895">(</span><span class="ident" id="4089896">bytes</span>&nbsp;<span class="op" id="4089902">[</span><span class="op" id="4089903">]</span><span class="builtintype" id="4089904">byte</span><span class="op" id="4089908">)</span>&nbsp;<span class="op" id="4089910">(</span><span class="ident" id="4089911">s</span>&nbsp;<span class="op" id="4089913">[</span><span class="op" id="4089914">]</span><span class="builtintype" id="4089915">int</span><span class="op" id="4089918">,</span>&nbsp;<span class="ident" id="4089920">err</span>&nbsp;<span class="builtintype" id="4089924">error</span><span class="op" id="4089929">)</span>&nbsp;<span class="op" id="4089931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4089934">if</span>&nbsp;<span class="builtinfunc" id="4089937">len</span><span class="op" id="4089940">(</span><span class="ident" id="4089941">bytes</span><span class="op" id="4089946">)</span>&nbsp;<span class="op" id="4089948">==</span>&nbsp;<span class="num" id="4089951">0</span>&nbsp;<span class="op" id="4089953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4089957">err</span>&nbsp;<span class="op" id="4089961">=</span>&nbsp;<span class="ident" id="4089963">SyntaxError</span><span class="op" id="4089974">{</span><span class="string" id="4089975">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="4090006">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090010">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4090022">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4090095">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090165">s</span>&nbsp;<span class="op" id="4090167">=</span>&nbsp;<span class="builtinfunc" id="4090169">make</span><span class="op" id="4090173">(</span><span class="op" id="4090174">[</span><span class="op" id="4090175">]</span><span class="builtintype" id="4090176">int</span><span class="op" id="4090179">,</span>&nbsp;<span class="builtinfunc" id="4090181">len</span><span class="op" id="4090184">(</span><span class="ident" id="4090185">bytes</span><span class="op" id="4090190">)</span><span class="op" id="4090191">+</span><span class="num" id="4090192">1</span><span class="op" id="4090193">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4090197">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4090241">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4090316">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4090390">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090436">v</span><span class="op" id="4090437">,</span>&nbsp;<span class="ident" id="4090439">offset</span><span class="op" id="4090445">,</span>&nbsp;<span class="ident" id="4090447">err</span>&nbsp;<span class="op" id="4090451">:=</span>&nbsp;<span class="ident" id="4090454">parseBase128Int</span><span class="op" id="4090469">(</span><span class="ident" id="4090470">bytes</span><span class="op" id="4090475">,</span>&nbsp;<span class="num" id="4090477">0</span><span class="op" id="4090478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090481">if</span>&nbsp;<span class="ident" id="4090484">err</span>&nbsp;<span class="op" id="4090488">!=</span>&nbsp;<span class="ident" id="4090491">nil</span>&nbsp;<span class="op" id="4090495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090499">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090507">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090510">if</span>&nbsp;<span class="ident" id="4090513">v</span>&nbsp;<span class="op" id="4090515">&lt;</span>&nbsp;<span class="num" id="4090517">80</span>&nbsp;<span class="op" id="4090520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090524">s</span><span class="op" id="4090525">[</span><span class="num" id="4090526">0</span><span class="op" id="4090527">]</span>&nbsp;<span class="op" id="4090529">=</span>&nbsp;<span class="ident" id="4090531">v</span>&nbsp;<span class="op" id="4090533">/</span>&nbsp;<span class="num" id="4090535">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090540">s</span><span class="op" id="4090541">[</span><span class="num" id="4090542">1</span><span class="op" id="4090543">]</span>&nbsp;<span class="op" id="4090545">=</span>&nbsp;<span class="ident" id="4090547">v</span>&nbsp;<span class="op" id="4090549">%</span>&nbsp;<span class="num" id="4090551">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090555">}</span>&nbsp;<span class="keyword" id="4090557">else</span>&nbsp;<span class="op" id="4090562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090566">s</span><span class="op" id="4090567">[</span><span class="num" id="4090568">0</span><span class="op" id="4090569">]</span>&nbsp;<span class="op" id="4090571">=</span>&nbsp;<span class="num" id="4090573">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090577">s</span><span class="op" id="4090578">[</span><span class="num" id="4090579">1</span><span class="op" id="4090580">]</span>&nbsp;<span class="op" id="4090582">=</span>&nbsp;<span class="ident" id="4090584">v</span>&nbsp;<span class="op" id="4090586">-</span>&nbsp;<span class="num" id="4090588">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090596">i</span>&nbsp;<span class="op" id="4090598">:=</span>&nbsp;<span class="num" id="4090601">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090604">for</span>&nbsp;<span class="op" id="4090608">;</span>&nbsp;<span class="ident" id="4090610">offset</span>&nbsp;<span class="op" id="4090617">&lt;</span>&nbsp;<span class="builtinfunc" id="4090619">len</span><span class="op" id="4090622">(</span><span class="ident" id="4090623">bytes</span><span class="op" id="4090628">)</span><span class="op" id="4090629">;</span>&nbsp;<span class="ident" id="4090631">i</span><span class="op" id="4090632">++</span>&nbsp;<span class="op" id="4090635">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090639">v</span><span class="op" id="4090640">,</span>&nbsp;<span class="ident" id="4090642">offset</span><span class="op" id="4090648">,</span>&nbsp;<span class="ident" id="4090650">err</span>&nbsp;<span class="op" id="4090654">=</span>&nbsp;<span class="ident" id="4090656">parseBase128Int</span><span class="op" id="4090671">(</span><span class="ident" id="4090672">bytes</span><span class="op" id="4090677">,</span>&nbsp;<span class="ident" id="4090679">offset</span><span class="op" id="4090685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090689">if</span>&nbsp;<span class="ident" id="4090692">err</span>&nbsp;<span class="op" id="4090696">!=</span>&nbsp;<span class="ident" id="4090699">nil</span>&nbsp;<span class="op" id="4090703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090708">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090721">s</span><span class="op" id="4090722">[</span><span class="ident" id="4090723">i</span><span class="op" id="4090724">]</span>&nbsp;<span class="op" id="4090726">=</span>&nbsp;<span class="ident" id="4090728">v</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4090731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4090734">s</span>&nbsp;<span class="op" id="4090736">=</span>&nbsp;<span class="ident" id="4090738">s</span><span class="op" id="4090739">[</span><span class="num" id="4090740">0</span><span class="op" id="4090741">:</span><span class="ident" id="4090742">i</span><span class="op" id="4090743">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4090746">return</span><br>
<span class="lineno"></span><span class="op" id="4090753">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4090756">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4090771">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="4090819">type</span>&nbsp;<span class="ident" id="4090824">Enumerated</span>&nbsp;<span class="builtintype" id="4090835">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="4090840">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4090849">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="4090907">type</span>&nbsp;<span class="ident" id="4090912">Flag</span>&nbsp;<span class="builtintype" id="4090917">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="4090923">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4091001">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="4091063">func</span>&nbsp;<span class="ident" id="4091068">parseBase128Int</span><span class="op" id="4091083">(</span><span class="ident" id="4091084">bytes</span>&nbsp;<span class="op" id="4091090">[</span><span class="op" id="4091091">]</span><span class="builtintype" id="4091092">byte</span><span class="op" id="4091096">,</span>&nbsp;<span class="ident" id="4091098">initOffset</span>&nbsp;<span class="builtintype" id="4091109">int</span><span class="op" id="4091112">)</span>&nbsp;<span class="op" id="4091114">(</span><span class="ident" id="4091115">ret</span><span class="op" id="4091118">,</span>&nbsp;<span class="ident" id="4091120">offset</span>&nbsp;<span class="builtintype" id="4091127">int</span><span class="op" id="4091130">,</span>&nbsp;<span class="ident" id="4091132">err</span>&nbsp;<span class="builtintype" id="4091136">error</span><span class="op" id="4091141">)</span>&nbsp;<span class="op" id="4091143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091146">offset</span>&nbsp;<span class="op" id="4091153">=</span>&nbsp;<span class="ident" id="4091155">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091167">for</span>&nbsp;<span class="ident" id="4091171">shifted</span>&nbsp;<span class="op" id="4091179">:=</span>&nbsp;<span class="num" id="4091182">0</span><span class="op" id="4091183">;</span>&nbsp;<span class="ident" id="4091185">offset</span>&nbsp;<span class="op" id="4091192">&lt;</span>&nbsp;<span class="builtinfunc" id="4091194">len</span><span class="op" id="4091197">(</span><span class="ident" id="4091198">bytes</span><span class="op" id="4091203">)</span><span class="op" id="4091204">;</span>&nbsp;<span class="ident" id="4091206">shifted</span><span class="op" id="4091213">++</span>&nbsp;<span class="op" id="4091216">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091220">if</span>&nbsp;<span class="ident" id="4091223">shifted</span>&nbsp;<span class="op" id="4091231">&gt;</span>&nbsp;<span class="num" id="4091233">4</span>&nbsp;<span class="op" id="4091235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091240">err</span>&nbsp;<span class="op" id="4091244">=</span>&nbsp;<span class="ident" id="4091246">StructuralError</span><span class="op" id="4091261">{</span><span class="string" id="4091262">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4091290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091295">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4091304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091308">ret</span>&nbsp;<span class="op" id="4091312">&lt;&lt;=</span>&nbsp;<span class="num" id="4091316">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091320">b</span>&nbsp;<span class="op" id="4091322">:=</span>&nbsp;<span class="ident" id="4091325">bytes</span><span class="op" id="4091330">[</span><span class="ident" id="4091331">offset</span><span class="op" id="4091337">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091341">ret</span>&nbsp;<span class="op" id="4091345">|=</span>&nbsp;<span class="builtintype" id="4091348">int</span><span class="op" id="4091351">(</span><span class="ident" id="4091352">b</span>&nbsp;<span class="op" id="4091354">&amp;</span>&nbsp;<span class="num" id="4091356">0x7f</span><span class="op" id="4091360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091364">offset</span><span class="op" id="4091370">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091375">if</span>&nbsp;<span class="ident" id="4091378">b</span><span class="op" id="4091379">&amp;</span><span class="num" id="4091380">0x80</span>&nbsp;<span class="op" id="4091385">==</span>&nbsp;<span class="num" id="4091388">0</span>&nbsp;<span class="op" id="4091390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091395">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4091404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4091407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091410">err</span>&nbsp;<span class="op" id="4091414">=</span>&nbsp;<span class="ident" id="4091416">SyntaxError</span><span class="op" id="4091427">{</span><span class="string" id="4091428">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="4091456">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091459">return</span><br>
<span class="lineno"></span><span class="op" id="4091466">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4091469">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4091481">func</span>&nbsp;<span class="ident" id="4091486">parseUTCTime</span><span class="op" id="4091498">(</span><span class="ident" id="4091499">bytes</span>&nbsp;<span class="op" id="4091505">[</span><span class="op" id="4091506">]</span><span class="builtintype" id="4091507">byte</span><span class="op" id="4091511">)</span>&nbsp;<span class="op" id="4091513">(</span><span class="ident" id="4091514">ret</span>&nbsp;<span class="ident" id="4091518">time</span><span class="op" id="4091522">.</span><span class="ident" id="4091523">Time</span><span class="op" id="4091527">,</span>&nbsp;<span class="ident" id="4091529">err</span>&nbsp;<span class="builtintype" id="4091533">error</span><span class="op" id="4091538">)</span>&nbsp;<span class="op" id="4091540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091543">s</span>&nbsp;<span class="op" id="4091545">:=</span>&nbsp;<span class="builtintype" id="4091548">string</span><span class="op" id="4091554">(</span><span class="ident" id="4091555">bytes</span><span class="op" id="4091560">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091563">ret</span><span class="op" id="4091566">,</span>&nbsp;<span class="ident" id="4091568">err</span>&nbsp;<span class="op" id="4091572">=</span>&nbsp;<span class="ident" id="4091574">time</span><span class="op" id="4091578">.</span><span class="ident" id="4091579">Parse</span><span class="op" id="4091584">(</span><span class="string" id="4091585">&#34;0601021504Z0700&#34;</span><span class="op" id="4091602">,</span>&nbsp;<span class="ident" id="4091604">s</span><span class="op" id="4091605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091608">if</span>&nbsp;<span class="ident" id="4091611">err</span>&nbsp;<span class="op" id="4091615">!=</span>&nbsp;<span class="ident" id="4091618">nil</span>&nbsp;<span class="op" id="4091622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091626">ret</span><span class="op" id="4091629">,</span>&nbsp;<span class="ident" id="4091631">err</span>&nbsp;<span class="op" id="4091635">=</span>&nbsp;<span class="ident" id="4091637">time</span><span class="op" id="4091641">.</span><span class="ident" id="4091642">Parse</span><span class="op" id="4091647">(</span><span class="string" id="4091648">&#34;060102150405Z0700&#34;</span><span class="op" id="4091667">,</span>&nbsp;<span class="ident" id="4091669">s</span><span class="op" id="4091670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4091673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091676">if</span>&nbsp;<span class="ident" id="4091679">err</span>&nbsp;<span class="op" id="4091683">==</span>&nbsp;<span class="ident" id="4091686">nil</span>&nbsp;<span class="op" id="4091690">&amp;&amp;</span>&nbsp;<span class="ident" id="4091693">ret</span><span class="op" id="4091696">.</span><span class="ident" id="4091697">Year</span><span class="op" id="4091701">(</span><span class="op" id="4091702">)</span>&nbsp;<span class="op" id="4091704">&gt;=</span>&nbsp;<span class="num" id="4091707">2050</span>&nbsp;<span class="op" id="4091712">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4091716">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4091821">ret</span>&nbsp;<span class="op" id="4091825">=</span>&nbsp;<span class="ident" id="4091827">ret</span><span class="op" id="4091830">.</span><span class="ident" id="4091831">AddDate</span><span class="op" id="4091838">(</span><span class="op" id="4091839">-</span><span class="num" id="4091840">100</span><span class="op" id="4091843">,</span>&nbsp;<span class="num" id="4091845">0</span><span class="op" id="4091846">,</span>&nbsp;<span class="num" id="4091848">0</span><span class="op" id="4091849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4091852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4091856">return</span><br>
<span class="lineno">300</span><span class="op" id="4091863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4091866">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4091943">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4091978">func</span>&nbsp;<span class="ident" id="4091983">parseGeneralizedTime</span><span class="op" id="4092003">(</span><span class="ident" id="4092004">bytes</span>&nbsp;<span class="op" id="4092010">[</span><span class="op" id="4092011">]</span><span class="builtintype" id="4092012">byte</span><span class="op" id="4092016">)</span>&nbsp;<span class="op" id="4092018">(</span><span class="ident" id="4092019">ret</span>&nbsp;<span class="ident" id="4092023">time</span><span class="op" id="4092027">.</span><span class="ident" id="4092028">Time</span><span class="op" id="4092032">,</span>&nbsp;<span class="ident" id="4092034">err</span>&nbsp;<span class="builtintype" id="4092038">error</span><span class="op" id="4092043">)</span>&nbsp;<span class="op" id="4092045">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092048">return</span>&nbsp;<span class="ident" id="4092055">time</span><span class="op" id="4092059">.</span><span class="ident" id="4092060">Parse</span><span class="op" id="4092065">(</span><span class="string" id="4092066">&#34;20060102150405Z0700&#34;</span><span class="op" id="4092087">,</span>&nbsp;<span class="builtintype" id="4092089">string</span><span class="op" id="4092095">(</span><span class="ident" id="4092096">bytes</span><span class="op" id="4092101">)</span><span class="op" id="4092102">)</span><br>
<span class="lineno"></span><span class="op" id="4092104">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4092107">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4092127">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4092202">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4092227">func</span>&nbsp;<span class="ident" id="4092232">parsePrintableString</span><span class="op" id="4092252">(</span><span class="ident" id="4092253">bytes</span>&nbsp;<span class="op" id="4092259">[</span><span class="op" id="4092260">]</span><span class="builtintype" id="4092261">byte</span><span class="op" id="4092265">)</span>&nbsp;<span class="op" id="4092267">(</span><span class="ident" id="4092268">ret</span>&nbsp;<span class="builtintype" id="4092272">string</span><span class="op" id="4092278">,</span>&nbsp;<span class="ident" id="4092280">err</span>&nbsp;<span class="builtintype" id="4092284">error</span><span class="op" id="4092289">)</span>&nbsp;<span class="op" id="4092291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092294">for</span>&nbsp;<span class="ident" id="4092298">_</span><span class="op" id="4092299">,</span>&nbsp;<span class="ident" id="4092301">b</span>&nbsp;<span class="op" id="4092303">:=</span>&nbsp;<span class="keyword" id="4092306">range</span>&nbsp;<span class="ident" id="4092312">bytes</span>&nbsp;<span class="op" id="4092318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092322">if</span>&nbsp;<span class="op" id="4092325">!</span><span class="ident" id="4092326">isPrintable</span><span class="op" id="4092337">(</span><span class="ident" id="4092338">b</span><span class="op" id="4092339">)</span>&nbsp;<span class="op" id="4092341">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092346">err</span>&nbsp;<span class="op" id="4092350">=</span>&nbsp;<span class="ident" id="4092352">SyntaxError</span><span class="op" id="4092363">{</span><span class="string" id="4092364">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4092408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092413">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4092425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092428">ret</span>&nbsp;<span class="op" id="4092432">=</span>&nbsp;<span class="builtintype" id="4092434">string</span><span class="op" id="4092440">(</span><span class="ident" id="4092441">bytes</span><span class="op" id="4092446">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092449">return</span><br>
<span class="lineno"></span><span class="op" id="4092456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4092459">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="4092540">func</span>&nbsp;<span class="ident" id="4092545">isPrintable</span><span class="op" id="4092556">(</span><span class="ident" id="4092557">b</span>&nbsp;<span class="builtintype" id="4092559">byte</span><span class="op" id="4092563">)</span>&nbsp;<span class="builtintype" id="4092565">bool</span>&nbsp;<span class="op" id="4092570">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4092573">return</span>&nbsp;<span class="string" id="4092580">&#39;a&#39;</span>&nbsp;<span class="op" id="4092584">&lt;=</span>&nbsp;<span class="ident" id="4092587">b</span>&nbsp;<span class="op" id="4092589">&amp;&amp;</span>&nbsp;<span class="ident" id="4092592">b</span>&nbsp;<span class="op" id="4092594">&lt;=</span>&nbsp;<span class="string" id="4092597">&#39;z&#39;</span>&nbsp;<span class="op" id="4092601">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4092606">&#39;A&#39;</span>&nbsp;<span class="op" id="4092610">&lt;=</span>&nbsp;<span class="ident" id="4092613">b</span>&nbsp;<span class="op" id="4092615">&amp;&amp;</span>&nbsp;<span class="ident" id="4092618">b</span>&nbsp;<span class="op" id="4092620">&lt;=</span>&nbsp;<span class="string" id="4092623">&#39;Z&#39;</span>&nbsp;<span class="op" id="4092627">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4092632">&#39;0&#39;</span>&nbsp;<span class="op" id="4092636">&lt;=</span>&nbsp;<span class="ident" id="4092639">b</span>&nbsp;<span class="op" id="4092641">&amp;&amp;</span>&nbsp;<span class="ident" id="4092644">b</span>&nbsp;<span class="op" id="4092646">&lt;=</span>&nbsp;<span class="string" id="4092649">&#39;9&#39;</span>&nbsp;<span class="op" id="4092653">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4092658">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4092663">&lt;=</span>&nbsp;<span class="ident" id="4092666">b</span>&nbsp;<span class="op" id="4092668">&amp;&amp;</span>&nbsp;<span class="ident" id="4092671">b</span>&nbsp;<span class="op" id="4092673">&lt;=</span>&nbsp;<span class="string" id="4092676">&#39;)&#39;</span>&nbsp;<span class="op" id="4092680">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4092685">&#39;+&#39;</span>&nbsp;<span class="op" id="4092689">&lt;=</span>&nbsp;<span class="ident" id="4092692">b</span>&nbsp;<span class="op" id="4092694">&amp;&amp;</span>&nbsp;<span class="ident" id="4092697">b</span>&nbsp;<span class="op" id="4092699">&lt;=</span>&nbsp;<span class="string" id="4092702">&#39;/&#39;</span>&nbsp;<span class="op" id="4092706">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092711">b</span>&nbsp;<span class="op" id="4092713">==</span>&nbsp;<span class="string" id="4092716">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4092720">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092725">b</span>&nbsp;<span class="op" id="4092727">==</span>&nbsp;<span class="string" id="4092730">&#39;:&#39;</span>&nbsp;<span class="op" id="4092734">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092739">b</span>&nbsp;<span class="op" id="4092741">==</span>&nbsp;<span class="string" id="4092744">&#39;=&#39;</span>&nbsp;<span class="op" id="4092748">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092753">b</span>&nbsp;<span class="op" id="4092755">==</span>&nbsp;<span class="string" id="4092758">&#39;?&#39;</span>&nbsp;<span class="op" id="4092762">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092767">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092826">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4092886">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092943">b</span>&nbsp;<span class="op" id="4092945">==</span>&nbsp;<span class="string" id="4092948">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="4092952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="4092955">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4092969">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4093042">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4093072">func</span>&nbsp;<span class="ident" id="4093077">parseIA5String</span><span class="op" id="4093091">(</span><span class="ident" id="4093092">bytes</span>&nbsp;<span class="op" id="4093098">[</span><span class="op" id="4093099">]</span><span class="builtintype" id="4093100">byte</span><span class="op" id="4093104">)</span>&nbsp;<span class="op" id="4093106">(</span><span class="ident" id="4093107">ret</span>&nbsp;<span class="builtintype" id="4093111">string</span><span class="op" id="4093117">,</span>&nbsp;<span class="ident" id="4093119">err</span>&nbsp;<span class="builtintype" id="4093123">error</span><span class="op" id="4093128">)</span>&nbsp;<span class="op" id="4093130">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093133">for</span>&nbsp;<span class="ident" id="4093137">_</span><span class="op" id="4093138">,</span>&nbsp;<span class="ident" id="4093140">b</span>&nbsp;<span class="op" id="4093142">:=</span>&nbsp;<span class="keyword" id="4093145">range</span>&nbsp;<span class="ident" id="4093151">bytes</span>&nbsp;<span class="op" id="4093157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093161">if</span>&nbsp;<span class="ident" id="4093164">b</span>&nbsp;<span class="op" id="4093166">&gt;=</span>&nbsp;<span class="num" id="4093169">0x80</span>&nbsp;<span class="op" id="4093174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093179">err</span>&nbsp;<span class="op" id="4093183">=</span>&nbsp;<span class="ident" id="4093185">SyntaxError</span><span class="op" id="4093196">{</span><span class="string" id="4093197">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4093235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093240">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093249">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093255">ret</span>&nbsp;<span class="op" id="4093259">=</span>&nbsp;<span class="builtintype" id="4093261">string</span><span class="op" id="4093267">(</span><span class="ident" id="4093268">bytes</span><span class="op" id="4093273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093276">return</span><br>
<span class="lineno"></span><span class="op" id="4093283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4093286">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4093300">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4093379">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4093409">func</span>&nbsp;<span class="ident" id="4093414">parseT61String</span><span class="op" id="4093428">(</span><span class="ident" id="4093429">bytes</span>&nbsp;<span class="op" id="4093435">[</span><span class="op" id="4093436">]</span><span class="builtintype" id="4093437">byte</span><span class="op" id="4093441">)</span>&nbsp;<span class="op" id="4093443">(</span><span class="ident" id="4093444">ret</span>&nbsp;<span class="builtintype" id="4093448">string</span><span class="op" id="4093454">,</span>&nbsp;<span class="ident" id="4093456">err</span>&nbsp;<span class="builtintype" id="4093460">error</span><span class="op" id="4093465">)</span>&nbsp;<span class="op" id="4093467">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093470">return</span>&nbsp;<span class="builtintype" id="4093477">string</span><span class="op" id="4093483">(</span><span class="ident" id="4093484">bytes</span><span class="op" id="4093489">)</span><span class="op" id="4093490">,</span>&nbsp;<span class="ident" id="4093492">nil</span><br>
<span class="lineno"></span><span class="op" id="4093496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4093499">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4093514">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4093591">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4093616">func</span>&nbsp;<span class="ident" id="4093621">parseUTF8String</span><span class="op" id="4093636">(</span><span class="ident" id="4093637">bytes</span>&nbsp;<span class="op" id="4093643">[</span><span class="op" id="4093644">]</span><span class="builtintype" id="4093645">byte</span><span class="op" id="4093649">)</span>&nbsp;<span class="op" id="4093651">(</span><span class="ident" id="4093652">ret</span>&nbsp;<span class="builtintype" id="4093656">string</span><span class="op" id="4093662">,</span>&nbsp;<span class="ident" id="4093664">err</span>&nbsp;<span class="builtintype" id="4093668">error</span><span class="op" id="4093673">)</span>&nbsp;<span class="op" id="4093675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093678">return</span>&nbsp;<span class="builtintype" id="4093685">string</span><span class="op" id="4093691">(</span><span class="ident" id="4093692">bytes</span><span class="op" id="4093697">)</span><span class="op" id="4093698">,</span>&nbsp;<span class="ident" id="4093700">nil</span><br>
<span class="lineno"></span><span class="op" id="4093704">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="4093707">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4093759">type</span>&nbsp;<span class="ident" id="4093764">RawValue</span>&nbsp;<span class="keyword" id="4093773">struct</span>&nbsp;<span class="op" id="4093780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093783">Class</span><span class="op" id="4093788">,</span>&nbsp;<span class="ident" id="4093790">Tag</span>&nbsp;<span class="builtintype" id="4093794">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093799">IsCompound</span>&nbsp;<span class="builtintype" id="4093810">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093816">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4093827">[</span><span class="op" id="4093828">]</span><span class="builtintype" id="4093829">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093835">FullBytes</span>&nbsp;&nbsp;<span class="op" id="4093846">[</span><span class="op" id="4093847">]</span><span class="builtintype" id="4093848">byte</span>&nbsp;<span class="comment" id="4093853">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="4093884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4093887">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="4093960">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="4094038">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4094113">type</span>&nbsp;<span class="ident" id="4094118">RawContent</span>&nbsp;<span class="op" id="4094129">[</span><span class="op" id="4094130">]</span><span class="builtintype" id="4094131">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4094137">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="4094149">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="4094228">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4094305">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="4094381">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="4094454">func</span>&nbsp;<span class="ident" id="4094459">parseTagAndLength</span><span class="op" id="4094476">(</span><span class="ident" id="4094477">bytes</span>&nbsp;<span class="op" id="4094483">[</span><span class="op" id="4094484">]</span><span class="builtintype" id="4094485">byte</span><span class="op" id="4094489">,</span>&nbsp;<span class="ident" id="4094491">initOffset</span>&nbsp;<span class="builtintype" id="4094502">int</span><span class="op" id="4094505">)</span>&nbsp;<span class="op" id="4094507">(</span><span class="ident" id="4094508">ret</span>&nbsp;<span class="ident" id="4094512">tagAndLength</span><span class="op" id="4094524">,</span>&nbsp;<span class="ident" id="4094526">offset</span>&nbsp;<span class="builtintype" id="4094533">int</span><span class="op" id="4094536">,</span>&nbsp;<span class="ident" id="4094538">err</span>&nbsp;<span class="builtintype" id="4094542">error</span><span class="op" id="4094547">)</span>&nbsp;<span class="op" id="4094549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094552">offset</span>&nbsp;<span class="op" id="4094559">=</span>&nbsp;<span class="ident" id="4094561">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094573">b</span>&nbsp;<span class="op" id="4094575">:=</span>&nbsp;<span class="ident" id="4094578">bytes</span><span class="op" id="4094583">[</span><span class="ident" id="4094584">offset</span><span class="op" id="4094590">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094593">offset</span><span class="op" id="4094599">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094603">ret</span><span class="op" id="4094606">.</span><span class="ident" id="4094607">class</span>&nbsp;<span class="op" id="4094613">=</span>&nbsp;<span class="builtintype" id="4094615">int</span><span class="op" id="4094618">(</span><span class="ident" id="4094619">b</span>&nbsp;<span class="op" id="4094621">&gt;&gt;</span>&nbsp;<span class="num" id="4094624">6</span><span class="op" id="4094625">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094628">ret</span><span class="op" id="4094631">.</span><span class="ident" id="4094632">isCompound</span>&nbsp;<span class="op" id="4094643">=</span>&nbsp;<span class="ident" id="4094645">b</span><span class="op" id="4094646">&amp;</span><span class="num" id="4094647">0x20</span>&nbsp;<span class="op" id="4094652">==</span>&nbsp;<span class="num" id="4094655">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094661">ret</span><span class="op" id="4094664">.</span><span class="ident" id="4094665">tag</span>&nbsp;<span class="op" id="4094669">=</span>&nbsp;<span class="builtintype" id="4094671">int</span><span class="op" id="4094674">(</span><span class="ident" id="4094675">b</span>&nbsp;<span class="op" id="4094677">&amp;</span>&nbsp;<span class="num" id="4094679">0x1f</span><span class="op" id="4094683">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4094687">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4094765">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094788">if</span>&nbsp;<span class="ident" id="4094791">ret</span><span class="op" id="4094794">.</span><span class="ident" id="4094795">tag</span>&nbsp;<span class="op" id="4094799">==</span>&nbsp;<span class="num" id="4094802">0x1f</span>&nbsp;<span class="op" id="4094807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094811">ret</span><span class="op" id="4094814">.</span><span class="ident" id="4094815">tag</span><span class="op" id="4094818">,</span>&nbsp;<span class="ident" id="4094820">offset</span><span class="op" id="4094826">,</span>&nbsp;<span class="ident" id="4094828">err</span>&nbsp;<span class="op" id="4094832">=</span>&nbsp;<span class="ident" id="4094834">parseBase128Int</span><span class="op" id="4094849">(</span><span class="ident" id="4094850">bytes</span><span class="op" id="4094855">,</span>&nbsp;<span class="ident" id="4094857">offset</span><span class="op" id="4094863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094867">if</span>&nbsp;<span class="ident" id="4094870">err</span>&nbsp;<span class="op" id="4094874">!=</span>&nbsp;<span class="ident" id="4094877">nil</span>&nbsp;<span class="op" id="4094881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094886">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094895">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094901">if</span>&nbsp;<span class="ident" id="4094904">offset</span>&nbsp;<span class="op" id="4094911">&gt;=</span>&nbsp;<span class="builtinfunc" id="4094914">len</span><span class="op" id="4094917">(</span><span class="ident" id="4094918">bytes</span><span class="op" id="4094923">)</span>&nbsp;<span class="op" id="4094925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094929">err</span>&nbsp;<span class="op" id="4094933">=</span>&nbsp;<span class="ident" id="4094935">SyntaxError</span><span class="op" id="4094946">{</span><span class="string" id="4094947">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4094972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094976">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094984">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094987">b</span>&nbsp;<span class="op" id="4094989">=</span>&nbsp;<span class="ident" id="4094991">bytes</span><span class="op" id="4094996">[</span><span class="ident" id="4094997">offset</span><span class="op" id="4095003">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095006">offset</span><span class="op" id="4095012">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095016">if</span>&nbsp;<span class="ident" id="4095019">b</span><span class="op" id="4095020">&amp;</span><span class="num" id="4095021">0x80</span>&nbsp;<span class="op" id="4095026">==</span>&nbsp;<span class="num" id="4095029">0</span>&nbsp;<span class="op" id="4095031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4095035">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095084">ret</span><span class="op" id="4095087">.</span><span class="ident" id="4095088">length</span>&nbsp;<span class="op" id="4095095">=</span>&nbsp;<span class="builtintype" id="4095097">int</span><span class="op" id="4095100">(</span><span class="ident" id="4095101">b</span>&nbsp;<span class="op" id="4095103">&amp;</span>&nbsp;<span class="num" id="4095105">0x7f</span><span class="op" id="4095109">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095112">}</span>&nbsp;<span class="keyword" id="4095114">else</span>&nbsp;<span class="op" id="4095119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4095123">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095185">numBytes</span>&nbsp;<span class="op" id="4095194">:=</span>&nbsp;<span class="builtintype" id="4095197">int</span><span class="op" id="4095200">(</span><span class="ident" id="4095201">b</span>&nbsp;<span class="op" id="4095203">&amp;</span>&nbsp;<span class="num" id="4095205">0x7f</span><span class="op" id="4095209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095213">if</span>&nbsp;<span class="ident" id="4095216">numBytes</span>&nbsp;<span class="op" id="4095225">==</span>&nbsp;<span class="num" id="4095228">0</span>&nbsp;<span class="op" id="4095230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095235">err</span>&nbsp;<span class="op" id="4095239">=</span>&nbsp;<span class="ident" id="4095241">SyntaxError</span><span class="op" id="4095252">{</span><span class="string" id="4095253">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="4095288">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095293">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095306">ret</span><span class="op" id="4095309">.</span><span class="ident" id="4095310">length</span>&nbsp;<span class="op" id="4095317">=</span>&nbsp;<span class="num" id="4095319">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095323">for</span>&nbsp;<span class="ident" id="4095327">i</span>&nbsp;<span class="op" id="4095329">:=</span>&nbsp;<span class="num" id="4095332">0</span><span class="op" id="4095333">;</span>&nbsp;<span class="ident" id="4095335">i</span>&nbsp;<span class="op" id="4095337">&lt;</span>&nbsp;<span class="ident" id="4095339">numBytes</span><span class="op" id="4095347">;</span>&nbsp;<span class="ident" id="4095349">i</span><span class="op" id="4095350">++</span>&nbsp;<span class="op" id="4095353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095358">if</span>&nbsp;<span class="ident" id="4095361">offset</span>&nbsp;<span class="op" id="4095368">&gt;=</span>&nbsp;<span class="builtinfunc" id="4095371">len</span><span class="op" id="4095374">(</span><span class="ident" id="4095375">bytes</span><span class="op" id="4095380">)</span>&nbsp;<span class="op" id="4095382">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095388">err</span>&nbsp;<span class="op" id="4095392">=</span>&nbsp;<span class="ident" id="4095394">SyntaxError</span><span class="op" id="4095405">{</span><span class="string" id="4095406">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4095431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095437">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095452">b</span>&nbsp;<span class="op" id="4095454">=</span>&nbsp;<span class="ident" id="4095456">bytes</span><span class="op" id="4095461">[</span><span class="ident" id="4095462">offset</span><span class="op" id="4095468">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095473">offset</span><span class="op" id="4095479">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095485">if</span>&nbsp;<span class="ident" id="4095488">ret</span><span class="op" id="4095491">.</span><span class="ident" id="4095492">length</span>&nbsp;<span class="op" id="4095499">&gt;=</span>&nbsp;<span class="num" id="4095502">1</span><span class="op" id="4095503">&lt;&lt;</span><span class="num" id="4095505">23</span>&nbsp;<span class="op" id="4095508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4095514">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4095558">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095578">err</span>&nbsp;<span class="op" id="4095582">=</span>&nbsp;<span class="ident" id="4095584">StructuralError</span><span class="op" id="4095599">{</span><span class="string" id="4095600">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="4095618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095624">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095639">ret</span><span class="op" id="4095642">.</span><span class="ident" id="4095643">length</span>&nbsp;<span class="op" id="4095650">&lt;&lt;=</span>&nbsp;<span class="num" id="4095654">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095659">ret</span><span class="op" id="4095662">.</span><span class="ident" id="4095663">length</span>&nbsp;<span class="op" id="4095670">|=</span>&nbsp;<span class="builtintype" id="4095673">int</span><span class="op" id="4095676">(</span><span class="ident" id="4095677">b</span><span class="op" id="4095678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095683">if</span>&nbsp;<span class="ident" id="4095686">ret</span><span class="op" id="4095689">.</span><span class="ident" id="4095690">length</span>&nbsp;<span class="op" id="4095697">==</span>&nbsp;<span class="num" id="4095700">0</span>&nbsp;<span class="op" id="4095702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4095708">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095753">err</span>&nbsp;<span class="op" id="4095757">=</span>&nbsp;<span class="ident" id="4095759">StructuralError</span><span class="op" id="4095774">{</span><span class="string" id="4095775">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="4095812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095818">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095835">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095839">return</span><br>
<span class="lineno"></span><span class="op" id="4095846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4095849">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="4095929">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4096005">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4096046">func</span>&nbsp;<span class="ident" id="4096051">parseSequenceOf</span><span class="op" id="4096066">(</span><span class="ident" id="4096067">bytes</span>&nbsp;<span class="op" id="4096073">[</span><span class="op" id="4096074">]</span><span class="builtintype" id="4096075">byte</span><span class="op" id="4096079">,</span>&nbsp;<span class="ident" id="4096081">sliceType</span>&nbsp;<span class="ident" id="4096091">reflect</span><span class="op" id="4096098">.</span><span class="ident" id="4096099">Type</span><span class="op" id="4096103">,</span>&nbsp;<span class="ident" id="4096105">elemType</span>&nbsp;<span class="ident" id="4096114">reflect</span><span class="op" id="4096121">.</span><span class="ident" id="4096122">Type</span><span class="op" id="4096126">)</span>&nbsp;<span class="op" id="4096128">(</span><span class="ident" id="4096129">ret</span>&nbsp;<span class="ident" id="4096133">reflect</span><span class="op" id="4096140">.</span><span class="ident" id="4096141">Value</span><span class="op" id="4096146">,</span>&nbsp;<span class="ident" id="4096148">err</span>&nbsp;<span class="builtintype" id="4096152">error</span><span class="op" id="4096157">)</span>&nbsp;<span class="op" id="4096159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4096162">expectedTag</span><span class="op" id="4096173">,</span>&nbsp;<span class="ident" id="4096175">compoundType</span><span class="op" id="4096187">,</span>&nbsp;<span class="ident" id="4096189">ok</span>&nbsp;<span class="op" id="4096192">:=</span>&nbsp;<span class="ident" id="4096195">getUniversalType</span><span class="op" id="4096211">(</span><span class="ident" id="4096212">elemType</span><span class="op" id="4096220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096223">if</span>&nbsp;<span class="op" id="4096226">!</span><span class="ident" id="4096227">ok</span>&nbsp;<span class="op" id="4096230">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4096234">err</span>&nbsp;<span class="op" id="4096238">=</span>&nbsp;<span class="ident" id="4096240">StructuralError</span><span class="op" id="4096255">{</span><span class="string" id="4096256">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="4096283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096287">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4096295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4096299">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4096369">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4096423">numElements</span>&nbsp;<span class="op" id="4096435">:=</span>&nbsp;<span class="num" id="4096438">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096441">for</span>&nbsp;<span class="ident" id="4096445">offset</span>&nbsp;<span class="op" id="4096452">:=</span>&nbsp;<span class="num" id="4096455">0</span><span class="op" id="4096456">;</span>&nbsp;<span class="ident" id="4096458">offset</span>&nbsp;<span class="op" id="4096465">&lt;</span>&nbsp;<span class="builtinfunc" id="4096467">len</span><span class="op" id="4096470">(</span><span class="ident" id="4096471">bytes</span><span class="op" id="4096476">)</span><span class="op" id="4096477">;</span>&nbsp;<span class="op" id="4096479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096483">var</span>&nbsp;<span class="ident" id="4096487">t</span>&nbsp;<span class="ident" id="4096489">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4096504">t</span><span class="op" id="4096505">,</span>&nbsp;<span class="ident" id="4096507">offset</span><span class="op" id="4096513">,</span>&nbsp;<span class="ident" id="4096515">err</span>&nbsp;<span class="op" id="4096519">=</span>&nbsp;<span class="ident" id="4096521">parseTagAndLength</span><span class="op" id="4096538">(</span><span class="ident" id="4096539">bytes</span><span class="op" id="4096544">,</span>&nbsp;<span class="ident" id="4096546">offset</span><span class="op" id="4096552">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096556">if</span>&nbsp;<span class="ident" id="4096559">err</span>&nbsp;<span class="op" id="4096563">!=</span>&nbsp;<span class="ident" id="4096566">nil</span>&nbsp;<span class="op" id="4096570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096575">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4096584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096588">switch</span>&nbsp;<span class="ident" id="4096595">t</span><span class="op" id="4096596">.</span><span class="ident" id="4096597">tag</span>&nbsp;<span class="op" id="4096601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096605">case</span>&nbsp;<span class="ident" id="4096610">tagIA5String</span><span class="op" id="4096622">,</span>&nbsp;<span class="ident" id="4096624">tagGeneralString</span><span class="op" id="4096640">,</span>&nbsp;<span class="ident" id="4096642">tagT61String</span><span class="op" id="4096654">,</span>&nbsp;<span class="ident" id="4096656">tagUTF8String</span><span class="op" id="4096669">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4096674">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4096727">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4096785">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4096815">t</span><span class="op" id="4096816">.</span><span class="ident" id="4096817">tag</span>&nbsp;<span class="op" id="4096821">=</span>&nbsp;<span class="ident" id="4096823">tagPrintableString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096844">case</span>&nbsp;<span class="ident" id="4096849">tagGeneralizedTime</span><span class="op" id="4096867">,</span>&nbsp;<span class="ident" id="4096869">tagUTCTime</span><span class="op" id="4096879">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4096884">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4096938">t</span><span class="op" id="4096939">.</span><span class="ident" id="4096940">tag</span>&nbsp;<span class="op" id="4096944">=</span>&nbsp;<span class="ident" id="4096946">tagUTCTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4096959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4096964">if</span>&nbsp;<span class="ident" id="4096967">t</span><span class="op" id="4096968">.</span><span class="ident" id="4096969">class</span>&nbsp;<span class="op" id="4096975">!=</span>&nbsp;<span class="ident" id="4096978">classUniversal</span>&nbsp;<span class="op" id="4096993">||</span>&nbsp;<span class="ident" id="4096996">t</span><span class="op" id="4096997">.</span><span class="ident" id="4096998">isCompound</span>&nbsp;<span class="op" id="4097009">!=</span>&nbsp;<span class="ident" id="4097012">compoundType</span>&nbsp;<span class="op" id="4097025">||</span>&nbsp;<span class="ident" id="4097028">t</span><span class="op" id="4097029">.</span><span class="ident" id="4097030">tag</span>&nbsp;<span class="op" id="4097034">!=</span>&nbsp;<span class="ident" id="4097037">expectedTag</span>&nbsp;<span class="op" id="4097049">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097054">err</span>&nbsp;<span class="op" id="4097058">=</span>&nbsp;<span class="ident" id="4097060">StructuralError</span><span class="op" id="4097075">{</span><span class="string" id="4097076">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="4097099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097104">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097117">if</span>&nbsp;<span class="ident" id="4097120">invalidLength</span><span class="op" id="4097133">(</span><span class="ident" id="4097134">offset</span><span class="op" id="4097140">,</span>&nbsp;<span class="ident" id="4097142">t</span><span class="op" id="4097143">.</span><span class="ident" id="4097144">length</span><span class="op" id="4097150">,</span>&nbsp;<span class="builtinfunc" id="4097152">len</span><span class="op" id="4097155">(</span><span class="ident" id="4097156">bytes</span><span class="op" id="4097161">)</span><span class="op" id="4097162">)</span>&nbsp;<span class="op" id="4097164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097169">err</span>&nbsp;<span class="op" id="4097173">=</span>&nbsp;<span class="ident" id="4097175">SyntaxError</span><span class="op" id="4097186">{</span><span class="string" id="4097187">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="4097207">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097212">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097225">offset</span>&nbsp;<span class="op" id="4097232">+=</span>&nbsp;<span class="ident" id="4097235">t</span><span class="op" id="4097236">.</span><span class="ident" id="4097237">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097246">numElements</span><span class="op" id="4097257">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097261">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097264">ret</span>&nbsp;<span class="op" id="4097268">=</span>&nbsp;<span class="ident" id="4097270">reflect</span><span class="op" id="4097277">.</span><span class="ident" id="4097278">MakeSlice</span><span class="op" id="4097287">(</span><span class="ident" id="4097288">sliceType</span><span class="op" id="4097297">,</span>&nbsp;<span class="ident" id="4097299">numElements</span><span class="op" id="4097310">,</span>&nbsp;<span class="ident" id="4097312">numElements</span><span class="op" id="4097323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097326">params</span>&nbsp;<span class="op" id="4097333">:=</span>&nbsp;<span class="ident" id="4097336">fieldParameters</span><span class="op" id="4097351">{</span><span class="op" id="4097352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097355">offset</span>&nbsp;<span class="op" id="4097362">:=</span>&nbsp;<span class="num" id="4097365">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097368">for</span>&nbsp;<span class="ident" id="4097372">i</span>&nbsp;<span class="op" id="4097374">:=</span>&nbsp;<span class="num" id="4097377">0</span><span class="op" id="4097378">;</span>&nbsp;<span class="ident" id="4097380">i</span>&nbsp;<span class="op" id="4097382">&lt;</span>&nbsp;<span class="ident" id="4097384">numElements</span><span class="op" id="4097395">;</span>&nbsp;<span class="ident" id="4097397">i</span><span class="op" id="4097398">++</span>&nbsp;<span class="op" id="4097401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097405">offset</span><span class="op" id="4097411">,</span>&nbsp;<span class="ident" id="4097413">err</span>&nbsp;<span class="op" id="4097417">=</span>&nbsp;<span class="ident" id="4097419">parseField</span><span class="op" id="4097429">(</span><span class="ident" id="4097430">ret</span><span class="op" id="4097433">.</span><span class="ident" id="4097434">Index</span><span class="op" id="4097439">(</span><span class="ident" id="4097440">i</span><span class="op" id="4097441">)</span><span class="op" id="4097442">,</span>&nbsp;<span class="ident" id="4097444">bytes</span><span class="op" id="4097449">,</span>&nbsp;<span class="ident" id="4097451">offset</span><span class="op" id="4097457">,</span>&nbsp;<span class="ident" id="4097459">params</span><span class="op" id="4097465">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097469">if</span>&nbsp;<span class="ident" id="4097472">err</span>&nbsp;<span class="op" id="4097476">!=</span>&nbsp;<span class="ident" id="4097479">nil</span>&nbsp;<span class="op" id="4097483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097488">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4097500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4097503">return</span><br>
<span class="lineno">500</span><span class="op" id="4097510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4097513">var</span>&nbsp;<span class="op" id="4097517">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097520">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097541">=</span>&nbsp;<span class="ident" id="4097543">reflect</span><span class="op" id="4097550">.</span><span class="ident" id="4097551">TypeOf</span><span class="op" id="4097557">(</span><span class="ident" id="4097558">BitString</span><span class="op" id="4097567">{</span><span class="op" id="4097568">}</span><span class="op" id="4097569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097572">objectIdentifierType</span>&nbsp;<span class="op" id="4097593">=</span>&nbsp;<span class="ident" id="4097595">reflect</span><span class="op" id="4097602">.</span><span class="ident" id="4097603">TypeOf</span><span class="op" id="4097609">(</span><span class="ident" id="4097610">ObjectIdentifier</span><span class="op" id="4097626">{</span><span class="op" id="4097627">}</span><span class="op" id="4097628">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097631">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097652">=</span>&nbsp;<span class="ident" id="4097654">reflect</span><span class="op" id="4097661">.</span><span class="ident" id="4097662">TypeOf</span><span class="op" id="4097668">(</span><span class="ident" id="4097669">Enumerated</span><span class="op" id="4097679">(</span><span class="num" id="4097680">0</span><span class="op" id="4097681">)</span><span class="op" id="4097682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097685">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097706">=</span>&nbsp;<span class="ident" id="4097708">reflect</span><span class="op" id="4097715">.</span><span class="ident" id="4097716">TypeOf</span><span class="op" id="4097722">(</span><span class="ident" id="4097723">Flag</span><span class="op" id="4097727">(</span><span class="builtintype" id="4097728">false</span><span class="op" id="4097733">)</span><span class="op" id="4097734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097737">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097758">=</span>&nbsp;<span class="ident" id="4097760">reflect</span><span class="op" id="4097767">.</span><span class="ident" id="4097768">TypeOf</span><span class="op" id="4097774">(</span><span class="ident" id="4097775">time</span><span class="op" id="4097779">.</span><span class="ident" id="4097780">Time</span><span class="op" id="4097784">{</span><span class="op" id="4097785">}</span><span class="op" id="4097786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097789">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097810">=</span>&nbsp;<span class="ident" id="4097812">reflect</span><span class="op" id="4097819">.</span><span class="ident" id="4097820">TypeOf</span><span class="op" id="4097826">(</span><span class="ident" id="4097827">RawValue</span><span class="op" id="4097835">{</span><span class="op" id="4097836">}</span><span class="op" id="4097837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097840">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097861">=</span>&nbsp;<span class="ident" id="4097863">reflect</span><span class="op" id="4097870">.</span><span class="ident" id="4097871">TypeOf</span><span class="op" id="4097877">(</span><span class="ident" id="4097878">RawContent</span><span class="op" id="4097888">(</span><span class="ident" id="4097889">nil</span><span class="op" id="4097892">)</span><span class="op" id="4097893">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4097896">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4097917">=</span>&nbsp;<span class="ident" id="4097919">reflect</span><span class="op" id="4097926">.</span><span class="ident" id="4097927">TypeOf</span><span class="op" id="4097933">(</span><span class="builtinfunc" id="4097934">new</span><span class="op" id="4097937">(</span><span class="ident" id="4097938">big</span><span class="op" id="4097941">.</span><span class="ident" id="4097942">Int</span><span class="op" id="4097945">)</span><span class="op" id="4097946">)</span><br>
<span class="lineno"></span><span class="op" id="4097948">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4097951">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4098026">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="4098054">func</span>&nbsp;<span class="ident" id="4098059">invalidLength</span><span class="op" id="4098072">(</span><span class="ident" id="4098073">offset</span><span class="op" id="4098079">,</span>&nbsp;<span class="ident" id="4098081">length</span><span class="op" id="4098087">,</span>&nbsp;<span class="ident" id="4098089">sliceLength</span>&nbsp;<span class="builtintype" id="4098101">int</span><span class="op" id="4098104">)</span>&nbsp;<span class="builtintype" id="4098106">bool</span>&nbsp;<span class="op" id="4098111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098114">return</span>&nbsp;<span class="ident" id="4098121">offset</span><span class="op" id="4098127">+</span><span class="ident" id="4098128">length</span>&nbsp;<span class="op" id="4098135">&lt;</span>&nbsp;<span class="ident" id="4098137">offset</span>&nbsp;<span class="op" id="4098144">||</span>&nbsp;<span class="ident" id="4098147">offset</span><span class="op" id="4098153">+</span><span class="ident" id="4098154">length</span>&nbsp;<span class="op" id="4098161">&gt;</span>&nbsp;<span class="ident" id="4098163">sliceLength</span><br>
<span class="lineno"></span><span class="op" id="4098175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4098178">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="4098255">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4098335">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4098358">func</span>&nbsp;<span class="ident" id="4098363">parseField</span><span class="op" id="4098373">(</span><span class="ident" id="4098374">v</span>&nbsp;<span class="ident" id="4098376">reflect</span><span class="op" id="4098383">.</span><span class="ident" id="4098384">Value</span><span class="op" id="4098389">,</span>&nbsp;<span class="ident" id="4098391">bytes</span>&nbsp;<span class="op" id="4098397">[</span><span class="op" id="4098398">]</span><span class="builtintype" id="4098399">byte</span><span class="op" id="4098403">,</span>&nbsp;<span class="ident" id="4098405">initOffset</span>&nbsp;<span class="builtintype" id="4098416">int</span><span class="op" id="4098419">,</span>&nbsp;<span class="ident" id="4098421">params</span>&nbsp;<span class="ident" id="4098428">fieldParameters</span><span class="op" id="4098443">)</span>&nbsp;<span class="op" id="4098445">(</span><span class="ident" id="4098446">offset</span>&nbsp;<span class="builtintype" id="4098453">int</span><span class="op" id="4098456">,</span>&nbsp;<span class="ident" id="4098458">err</span>&nbsp;<span class="builtintype" id="4098462">error</span><span class="op" id="4098467">)</span>&nbsp;<span class="op" id="4098469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098472">offset</span>&nbsp;<span class="op" id="4098479">=</span>&nbsp;<span class="ident" id="4098481">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098493">fieldType</span>&nbsp;<span class="op" id="4098503">:=</span>&nbsp;<span class="ident" id="4098506">v</span><span class="op" id="4098507">.</span><span class="ident" id="4098508">Type</span><span class="op" id="4098512">(</span><span class="op" id="4098513">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4098517">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098604">if</span>&nbsp;<span class="ident" id="4098607">offset</span>&nbsp;<span class="op" id="4098614">==</span>&nbsp;<span class="builtinfunc" id="4098617">len</span><span class="op" id="4098620">(</span><span class="ident" id="4098621">bytes</span><span class="op" id="4098626">)</span>&nbsp;<span class="op" id="4098628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098632">if</span>&nbsp;<span class="op" id="4098635">!</span><span class="ident" id="4098636">setDefaultValue</span><span class="op" id="4098651">(</span><span class="ident" id="4098652">v</span><span class="op" id="4098653">,</span>&nbsp;<span class="ident" id="4098655">params</span><span class="op" id="4098661">)</span>&nbsp;<span class="op" id="4098663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098668">err</span>&nbsp;<span class="op" id="4098672">=</span>&nbsp;<span class="ident" id="4098674">SyntaxError</span><span class="op" id="4098685">{</span><span class="string" id="4098686">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="4098706">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098714">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4098726">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098752">if</span>&nbsp;<span class="ident" id="4098755">fieldType</span>&nbsp;<span class="op" id="4098765">==</span>&nbsp;<span class="ident" id="4098768">rawValueType</span>&nbsp;<span class="op" id="4098781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098785">var</span>&nbsp;<span class="ident" id="4098789">t</span>&nbsp;<span class="ident" id="4098791">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098806">t</span><span class="op" id="4098807">,</span>&nbsp;<span class="ident" id="4098809">offset</span><span class="op" id="4098815">,</span>&nbsp;<span class="ident" id="4098817">err</span>&nbsp;<span class="op" id="4098821">=</span>&nbsp;<span class="ident" id="4098823">parseTagAndLength</span><span class="op" id="4098840">(</span><span class="ident" id="4098841">bytes</span><span class="op" id="4098846">,</span>&nbsp;<span class="ident" id="4098848">offset</span><span class="op" id="4098854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098858">if</span>&nbsp;<span class="ident" id="4098861">err</span>&nbsp;<span class="op" id="4098865">!=</span>&nbsp;<span class="ident" id="4098868">nil</span>&nbsp;<span class="op" id="4098872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098877">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098890">if</span>&nbsp;<span class="ident" id="4098893">invalidLength</span><span class="op" id="4098906">(</span><span class="ident" id="4098907">offset</span><span class="op" id="4098913">,</span>&nbsp;<span class="ident" id="4098915">t</span><span class="op" id="4098916">.</span><span class="ident" id="4098917">length</span><span class="op" id="4098923">,</span>&nbsp;<span class="builtinfunc" id="4098925">len</span><span class="op" id="4098928">(</span><span class="ident" id="4098929">bytes</span><span class="op" id="4098934">)</span><span class="op" id="4098935">)</span>&nbsp;<span class="op" id="4098937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098942">err</span>&nbsp;<span class="op" id="4098946">=</span>&nbsp;<span class="ident" id="4098948">SyntaxError</span><span class="op" id="4098959">{</span><span class="string" id="4098960">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4098976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4098981">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4098990">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4098994">result</span>&nbsp;<span class="op" id="4099001">:=</span>&nbsp;<span class="ident" id="4099004">RawValue</span><span class="op" id="4099012">{</span><span class="ident" id="4099013">t</span><span class="op" id="4099014">.</span><span class="ident" id="4099015">class</span><span class="op" id="4099020">,</span>&nbsp;<span class="ident" id="4099022">t</span><span class="op" id="4099023">.</span><span class="ident" id="4099024">tag</span><span class="op" id="4099027">,</span>&nbsp;<span class="ident" id="4099029">t</span><span class="op" id="4099030">.</span><span class="ident" id="4099031">isCompound</span><span class="op" id="4099041">,</span>&nbsp;<span class="ident" id="4099043">bytes</span><span class="op" id="4099048">[</span><span class="ident" id="4099049">offset</span>&nbsp;<span class="op" id="4099056">:</span>&nbsp;<span class="ident" id="4099058">offset</span><span class="op" id="4099064">+</span><span class="ident" id="4099065">t</span><span class="op" id="4099066">.</span><span class="ident" id="4099067">length</span><span class="op" id="4099073">]</span><span class="op" id="4099074">,</span>&nbsp;<span class="ident" id="4099076">bytes</span><span class="op" id="4099081">[</span><span class="ident" id="4099082">initOffset</span>&nbsp;<span class="op" id="4099093">:</span>&nbsp;<span class="ident" id="4099095">offset</span><span class="op" id="4099101">+</span><span class="ident" id="4099102">t</span><span class="op" id="4099103">.</span><span class="ident" id="4099104">length</span><span class="op" id="4099110">]</span><span class="op" id="4099111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099115">offset</span>&nbsp;<span class="op" id="4099122">+=</span>&nbsp;<span class="ident" id="4099125">t</span><span class="op" id="4099126">.</span><span class="ident" id="4099127">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099136">v</span><span class="op" id="4099137">.</span><span class="ident" id="4099138">Set</span><span class="op" id="4099141">(</span><span class="ident" id="4099142">reflect</span><span class="op" id="4099149">.</span><span class="ident" id="4099150">ValueOf</span><span class="op" id="4099157">(</span><span class="ident" id="4099158">result</span><span class="op" id="4099164">)</span><span class="op" id="4099165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099169">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4099177">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4099181">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099209">if</span>&nbsp;<span class="ident" id="4099212">ifaceType</span>&nbsp;<span class="op" id="4099222">:=</span>&nbsp;<span class="ident" id="4099225">fieldType</span><span class="op" id="4099234">;</span>&nbsp;<span class="ident" id="4099236">ifaceType</span><span class="op" id="4099245">.</span><span class="ident" id="4099246">Kind</span><span class="op" id="4099250">(</span><span class="op" id="4099251">)</span>&nbsp;<span class="op" id="4099253">==</span>&nbsp;<span class="ident" id="4099256">reflect</span><span class="op" id="4099263">.</span><span class="ident" id="4099264">Interface</span>&nbsp;<span class="op" id="4099274">&amp;&amp;</span>&nbsp;<span class="ident" id="4099277">ifaceType</span><span class="op" id="4099286">.</span><span class="ident" id="4099287">NumMethod</span><span class="op" id="4099296">(</span><span class="op" id="4099297">)</span>&nbsp;<span class="op" id="4099299">==</span>&nbsp;<span class="num" id="4099302">0</span>&nbsp;<span class="op" id="4099304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099308">var</span>&nbsp;<span class="ident" id="4099312">t</span>&nbsp;<span class="ident" id="4099314">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099329">t</span><span class="op" id="4099330">,</span>&nbsp;<span class="ident" id="4099332">offset</span><span class="op" id="4099338">,</span>&nbsp;<span class="ident" id="4099340">err</span>&nbsp;<span class="op" id="4099344">=</span>&nbsp;<span class="ident" id="4099346">parseTagAndLength</span><span class="op" id="4099363">(</span><span class="ident" id="4099364">bytes</span><span class="op" id="4099369">,</span>&nbsp;<span class="ident" id="4099371">offset</span><span class="op" id="4099377">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099381">if</span>&nbsp;<span class="ident" id="4099384">err</span>&nbsp;<span class="op" id="4099388">!=</span>&nbsp;<span class="ident" id="4099391">nil</span>&nbsp;<span class="op" id="4099395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099400">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4099409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099413">if</span>&nbsp;<span class="ident" id="4099416">invalidLength</span><span class="op" id="4099429">(</span><span class="ident" id="4099430">offset</span><span class="op" id="4099436">,</span>&nbsp;<span class="ident" id="4099438">t</span><span class="op" id="4099439">.</span><span class="ident" id="4099440">length</span><span class="op" id="4099446">,</span>&nbsp;<span class="builtinfunc" id="4099448">len</span><span class="op" id="4099451">(</span><span class="ident" id="4099452">bytes</span><span class="op" id="4099457">)</span><span class="op" id="4099458">)</span>&nbsp;<span class="op" id="4099460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099465">err</span>&nbsp;<span class="op" id="4099469">=</span>&nbsp;<span class="ident" id="4099471">SyntaxError</span><span class="op" id="4099482">{</span><span class="string" id="4099483">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4099499">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099504">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4099513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099517">var</span>&nbsp;<span class="ident" id="4099521">result</span>&nbsp;<span class="keyword" id="4099528">interface</span><span class="op" id="4099537">{</span><span class="op" id="4099538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099542">if</span>&nbsp;<span class="op" id="4099545">!</span><span class="ident" id="4099546">t</span><span class="op" id="4099547">.</span><span class="ident" id="4099548">isCompound</span>&nbsp;<span class="op" id="4099559">&amp;&amp;</span>&nbsp;<span class="ident" id="4099562">t</span><span class="op" id="4099563">.</span><span class="ident" id="4099564">class</span>&nbsp;<span class="op" id="4099570">==</span>&nbsp;<span class="ident" id="4099573">classUniversal</span>&nbsp;<span class="op" id="4099588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099593">innerBytes</span>&nbsp;<span class="op" id="4099604">:=</span>&nbsp;<span class="ident" id="4099607">bytes</span><span class="op" id="4099612">[</span><span class="ident" id="4099613">offset</span>&nbsp;<span class="op" id="4099620">:</span>&nbsp;<span class="ident" id="4099622">offset</span><span class="op" id="4099628">+</span><span class="ident" id="4099629">t</span><span class="op" id="4099630">.</span><span class="ident" id="4099631">length</span><span class="op" id="4099637">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099642">switch</span>&nbsp;<span class="ident" id="4099649">t</span><span class="op" id="4099650">.</span><span class="ident" id="4099651">tag</span>&nbsp;<span class="op" id="4099655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099660">case</span>&nbsp;<span class="ident" id="4099665">tagPrintableString</span><span class="op" id="4099683">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099689">result</span><span class="op" id="4099695">,</span>&nbsp;<span class="ident" id="4099697">err</span>&nbsp;<span class="op" id="4099701">=</span>&nbsp;<span class="ident" id="4099703">parsePrintableString</span><span class="op" id="4099723">(</span><span class="ident" id="4099724">innerBytes</span><span class="op" id="4099734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099739">case</span>&nbsp;<span class="ident" id="4099744">tagIA5String</span><span class="op" id="4099756">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099762">result</span><span class="op" id="4099768">,</span>&nbsp;<span class="ident" id="4099770">err</span>&nbsp;<span class="op" id="4099774">=</span>&nbsp;<span class="ident" id="4099776">parseIA5String</span><span class="op" id="4099790">(</span><span class="ident" id="4099791">innerBytes</span><span class="op" id="4099801">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099806">case</span>&nbsp;<span class="ident" id="4099811">tagT61String</span><span class="op" id="4099823">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099829">result</span><span class="op" id="4099835">,</span>&nbsp;<span class="ident" id="4099837">err</span>&nbsp;<span class="op" id="4099841">=</span>&nbsp;<span class="ident" id="4099843">parseT61String</span><span class="op" id="4099857">(</span><span class="ident" id="4099858">innerBytes</span><span class="op" id="4099868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099873">case</span>&nbsp;<span class="ident" id="4099878">tagUTF8String</span><span class="op" id="4099891">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099897">result</span><span class="op" id="4099903">,</span>&nbsp;<span class="ident" id="4099905">err</span>&nbsp;<span class="op" id="4099909">=</span>&nbsp;<span class="ident" id="4099911">parseUTF8String</span><span class="op" id="4099926">(</span><span class="ident" id="4099927">innerBytes</span><span class="op" id="4099937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4099942">case</span>&nbsp;<span class="ident" id="4099947">tagInteger</span><span class="op" id="4099957">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4099963">result</span><span class="op" id="4099969">,</span>&nbsp;<span class="ident" id="4099971">err</span>&nbsp;<span class="op" id="4099975">=</span>&nbsp;<span class="ident" id="4099977">parseInt64</span><span class="op" id="4099987">(</span><span class="ident" id="4099988">innerBytes</span><span class="op" id="4099998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100003">case</span>&nbsp;<span class="ident" id="4100008">tagBitString</span><span class="op" id="4100020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100026">result</span><span class="op" id="4100032">,</span>&nbsp;<span class="ident" id="4100034">err</span>&nbsp;<span class="op" id="4100038">=</span>&nbsp;<span class="ident" id="4100040">parseBitString</span><span class="op" id="4100054">(</span><span class="ident" id="4100055">innerBytes</span><span class="op" id="4100065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100070">case</span>&nbsp;<span class="ident" id="4100075">tagOID</span><span class="op" id="4100081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100087">result</span><span class="op" id="4100093">,</span>&nbsp;<span class="ident" id="4100095">err</span>&nbsp;<span class="op" id="4100099">=</span>&nbsp;<span class="ident" id="4100101">parseObjectIdentifier</span><span class="op" id="4100122">(</span><span class="ident" id="4100123">innerBytes</span><span class="op" id="4100133">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100138">case</span>&nbsp;<span class="ident" id="4100143">tagUTCTime</span><span class="op" id="4100153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100159">result</span><span class="op" id="4100165">,</span>&nbsp;<span class="ident" id="4100167">err</span>&nbsp;<span class="op" id="4100171">=</span>&nbsp;<span class="ident" id="4100173">parseUTCTime</span><span class="op" id="4100185">(</span><span class="ident" id="4100186">innerBytes</span><span class="op" id="4100196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100201">case</span>&nbsp;<span class="ident" id="4100206">tagOctetString</span><span class="op" id="4100220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100226">result</span>&nbsp;<span class="op" id="4100233">=</span>&nbsp;<span class="ident" id="4100235">innerBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100249">default</span><span class="op" id="4100256">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4100262">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100345">offset</span>&nbsp;<span class="op" id="4100352">+=</span>&nbsp;<span class="ident" id="4100355">t</span><span class="op" id="4100356">.</span><span class="ident" id="4100357">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100366">if</span>&nbsp;<span class="ident" id="4100369">err</span>&nbsp;<span class="op" id="4100373">!=</span>&nbsp;<span class="ident" id="4100376">nil</span>&nbsp;<span class="op" id="4100380">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100385">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100398">if</span>&nbsp;<span class="ident" id="4100401">result</span>&nbsp;<span class="op" id="4100408">!=</span>&nbsp;<span class="ident" id="4100411">nil</span>&nbsp;<span class="op" id="4100415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100420">v</span><span class="op" id="4100421">.</span><span class="ident" id="4100422">Set</span><span class="op" id="4100425">(</span><span class="ident" id="4100426">reflect</span><span class="op" id="4100433">.</span><span class="ident" id="4100434">ValueOf</span><span class="op" id="4100441">(</span><span class="ident" id="4100442">result</span><span class="op" id="4100448">)</span><span class="op" id="4100449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100453">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100457">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100468">universalTag</span><span class="op" id="4100480">,</span>&nbsp;<span class="ident" id="4100482">compoundType</span><span class="op" id="4100494">,</span>&nbsp;<span class="ident" id="4100496">ok1</span>&nbsp;<span class="op" id="4100500">:=</span>&nbsp;<span class="ident" id="4100503">getUniversalType</span><span class="op" id="4100519">(</span><span class="ident" id="4100520">fieldType</span><span class="op" id="4100529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100532">if</span>&nbsp;<span class="op" id="4100535">!</span><span class="ident" id="4100536">ok1</span>&nbsp;<span class="op" id="4100540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100544">err</span>&nbsp;<span class="op" id="4100548">=</span>&nbsp;<span class="ident" id="4100550">StructuralError</span><span class="op" id="4100565">{</span><span class="ident" id="4100566">fmt</span><span class="op" id="4100569">.</span><span class="ident" id="4100570">Sprintf</span><span class="op" id="4100577">(</span><span class="string" id="4100578">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4100599">,</span>&nbsp;<span class="ident" id="4100601">fieldType</span><span class="op" id="4100610">)</span><span class="op" id="4100611">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100615">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100627">t</span><span class="op" id="4100628">,</span>&nbsp;<span class="ident" id="4100630">offset</span><span class="op" id="4100636">,</span>&nbsp;<span class="ident" id="4100638">err</span>&nbsp;<span class="op" id="4100642">:=</span>&nbsp;<span class="ident" id="4100645">parseTagAndLength</span><span class="op" id="4100662">(</span><span class="ident" id="4100663">bytes</span><span class="op" id="4100668">,</span>&nbsp;<span class="ident" id="4100670">offset</span><span class="op" id="4100676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100679">if</span>&nbsp;<span class="ident" id="4100682">err</span>&nbsp;<span class="op" id="4100686">!=</span>&nbsp;<span class="ident" id="4100689">nil</span>&nbsp;<span class="op" id="4100693">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100697">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100708">if</span>&nbsp;<span class="ident" id="4100711">params</span><span class="op" id="4100717">.</span><span class="ident" id="4100718">explicit</span>&nbsp;<span class="op" id="4100727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100731">expectedClass</span>&nbsp;<span class="op" id="4100745">:=</span>&nbsp;<span class="ident" id="4100748">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100771">if</span>&nbsp;<span class="ident" id="4100774">params</span><span class="op" id="4100780">.</span><span class="ident" id="4100781">application</span>&nbsp;<span class="op" id="4100793">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100798">expectedClass</span>&nbsp;<span class="op" id="4100812">=</span>&nbsp;<span class="ident" id="4100814">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4100833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100837">if</span>&nbsp;<span class="ident" id="4100840">t</span><span class="op" id="4100841">.</span><span class="ident" id="4100842">class</span>&nbsp;<span class="op" id="4100848">==</span>&nbsp;<span class="ident" id="4100851">expectedClass</span>&nbsp;<span class="op" id="4100865">&amp;&amp;</span>&nbsp;<span class="ident" id="4100868">t</span><span class="op" id="4100869">.</span><span class="ident" id="4100870">tag</span>&nbsp;<span class="op" id="4100874">==</span>&nbsp;<span class="op" id="4100877">*</span><span class="ident" id="4100878">params</span><span class="op" id="4100884">.</span><span class="ident" id="4100885">tag</span>&nbsp;<span class="op" id="4100889">&amp;&amp;</span>&nbsp;<span class="op" id="4100892">(</span><span class="ident" id="4100893">t</span><span class="op" id="4100894">.</span><span class="ident" id="4100895">length</span>&nbsp;<span class="op" id="4100902">==</span>&nbsp;<span class="num" id="4100905">0</span>&nbsp;<span class="op" id="4100907">||</span>&nbsp;<span class="ident" id="4100910">t</span><span class="op" id="4100911">.</span><span class="ident" id="4100912">isCompound</span><span class="op" id="4100922">)</span>&nbsp;<span class="op" id="4100924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4100929">if</span>&nbsp;<span class="ident" id="4100932">t</span><span class="op" id="4100933">.</span><span class="ident" id="4100934">length</span>&nbsp;<span class="op" id="4100941">&gt;</span>&nbsp;<span class="num" id="4100943">0</span>&nbsp;<span class="op" id="4100945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4100951">t</span><span class="op" id="4100952">,</span>&nbsp;<span class="ident" id="4100954">offset</span><span class="op" id="4100960">,</span>&nbsp;<span class="ident" id="4100962">err</span>&nbsp;<span class="op" id="4100966">=</span>&nbsp;<span class="ident" id="4100968">parseTagAndLength</span><span class="op" id="4100985">(</span><span class="ident" id="4100986">bytes</span><span class="op" id="4100991">,</span>&nbsp;<span class="ident" id="4100993">offset</span><span class="op" id="4100999">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101005">if</span>&nbsp;<span class="ident" id="4101008">err</span>&nbsp;<span class="op" id="4101012">!=</span>&nbsp;<span class="ident" id="4101015">nil</span>&nbsp;<span class="op" id="4101019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101026">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101042">}</span>&nbsp;<span class="keyword" id="4101044">else</span>&nbsp;<span class="op" id="4101049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101055">if</span>&nbsp;<span class="ident" id="4101058">fieldType</span>&nbsp;<span class="op" id="4101068">!=</span>&nbsp;<span class="ident" id="4101071">flagType</span>&nbsp;<span class="op" id="4101080">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101087">err</span>&nbsp;<span class="op" id="4101091">=</span>&nbsp;<span class="ident" id="4101093">StructuralError</span><span class="op" id="4101108">{</span><span class="string" id="4101109">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="4101156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101163">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101180">v</span><span class="op" id="4101181">.</span><span class="ident" id="4101182">SetBool</span><span class="op" id="4101189">(</span><span class="builtintype" id="4101190">true</span><span class="op" id="4101194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101200">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101214">}</span>&nbsp;<span class="keyword" id="4101216">else</span>&nbsp;<span class="op" id="4101221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101226">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101288">ok</span>&nbsp;<span class="op" id="4101291">:=</span>&nbsp;<span class="ident" id="4101294">setDefaultValue</span><span class="op" id="4101309">(</span><span class="ident" id="4101310">v</span><span class="op" id="4101311">,</span>&nbsp;<span class="ident" id="4101313">params</span><span class="op" id="4101319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101324">if</span>&nbsp;<span class="ident" id="4101327">ok</span>&nbsp;<span class="op" id="4101330">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101336">offset</span>&nbsp;<span class="op" id="4101343">=</span>&nbsp;<span class="ident" id="4101345">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101359">}</span>&nbsp;<span class="keyword" id="4101361">else</span>&nbsp;<span class="op" id="4101366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101372">err</span>&nbsp;<span class="op" id="4101376">=</span>&nbsp;<span class="ident" id="4101378">StructuralError</span><span class="op" id="4101393">{</span><span class="string" id="4101394">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="4101433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101443">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101459">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101530">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101600">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101671">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101720">if</span>&nbsp;<span class="ident" id="4101723">universalTag</span>&nbsp;<span class="op" id="4101736">==</span>&nbsp;<span class="ident" id="4101739">tagPrintableString</span>&nbsp;<span class="op" id="4101758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101762">if</span>&nbsp;<span class="ident" id="4101765">t</span><span class="op" id="4101766">.</span><span class="ident" id="4101767">class</span>&nbsp;<span class="op" id="4101773">==</span>&nbsp;<span class="ident" id="4101776">classUniversal</span>&nbsp;<span class="op" id="4101791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101796">switch</span>&nbsp;<span class="ident" id="4101803">t</span><span class="op" id="4101804">.</span><span class="ident" id="4101805">tag</span>&nbsp;<span class="op" id="4101809">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4101814">case</span>&nbsp;<span class="ident" id="4101819">tagIA5String</span><span class="op" id="4101831">,</span>&nbsp;<span class="ident" id="4101833">tagGeneralString</span><span class="op" id="4101849">,</span>&nbsp;<span class="ident" id="4101851">tagT61String</span><span class="op" id="4101863">,</span>&nbsp;<span class="ident" id="4101865">tagUTF8String</span><span class="op" id="4101878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101884">universalTag</span>&nbsp;<span class="op" id="4101897">=</span>&nbsp;<span class="ident" id="4101899">t</span><span class="op" id="4101900">.</span><span class="ident" id="4101901">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101912">}</span>&nbsp;<span class="keyword" id="4101914">else</span>&nbsp;<span class="keyword" id="4101919">if</span>&nbsp;<span class="ident" id="4101922">params</span><span class="op" id="4101928">.</span><span class="ident" id="4101929">stringType</span>&nbsp;<span class="op" id="4101940">!=</span>&nbsp;<span class="num" id="4101943">0</span>&nbsp;<span class="op" id="4101945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4101950">universalTag</span>&nbsp;<span class="op" id="4101963">=</span>&nbsp;<span class="ident" id="4101965">params</span><span class="op" id="4101971">.</span><span class="ident" id="4101972">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4101988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4101992">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4102063">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102086">if</span>&nbsp;<span class="ident" id="4102089">universalTag</span>&nbsp;<span class="op" id="4102102">==</span>&nbsp;<span class="ident" id="4102105">tagUTCTime</span>&nbsp;<span class="op" id="4102116">&amp;&amp;</span>&nbsp;<span class="ident" id="4102119">t</span><span class="op" id="4102120">.</span><span class="ident" id="4102121">tag</span>&nbsp;<span class="op" id="4102125">==</span>&nbsp;<span class="ident" id="4102128">tagGeneralizedTime</span>&nbsp;<span class="op" id="4102147">&amp;&amp;</span>&nbsp;<span class="ident" id="4102150">t</span><span class="op" id="4102151">.</span><span class="ident" id="4102152">class</span>&nbsp;<span class="op" id="4102158">==</span>&nbsp;<span class="ident" id="4102161">classUniversal</span>&nbsp;<span class="op" id="4102176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102180">universalTag</span>&nbsp;<span class="op" id="4102193">=</span>&nbsp;<span class="ident" id="4102195">tagGeneralizedTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102219">if</span>&nbsp;<span class="ident" id="4102222">params</span><span class="op" id="4102228">.</span><span class="ident" id="4102229">set</span>&nbsp;<span class="op" id="4102233">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102237">universalTag</span>&nbsp;<span class="op" id="4102250">=</span>&nbsp;<span class="ident" id="4102252">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102264">expectedClass</span>&nbsp;<span class="op" id="4102278">:=</span>&nbsp;<span class="ident" id="4102281">classUniversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102297">expectedTag</span>&nbsp;<span class="op" id="4102309">:=</span>&nbsp;<span class="ident" id="4102312">universalTag</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102327">if</span>&nbsp;<span class="op" id="4102330">!</span><span class="ident" id="4102331">params</span><span class="op" id="4102337">.</span><span class="ident" id="4102338">explicit</span>&nbsp;<span class="op" id="4102347">&amp;&amp;</span>&nbsp;<span class="ident" id="4102350">params</span><span class="op" id="4102356">.</span><span class="ident" id="4102357">tag</span>&nbsp;<span class="op" id="4102361">!=</span>&nbsp;<span class="ident" id="4102364">nil</span>&nbsp;<span class="op" id="4102368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102372">expectedClass</span>&nbsp;<span class="op" id="4102386">=</span>&nbsp;<span class="ident" id="4102388">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102411">expectedTag</span>&nbsp;<span class="op" id="4102423">=</span>&nbsp;<span class="op" id="4102425">*</span><span class="ident" id="4102426">params</span><span class="op" id="4102432">.</span><span class="ident" id="4102433">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102438">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102442">if</span>&nbsp;<span class="op" id="4102445">!</span><span class="ident" id="4102446">params</span><span class="op" id="4102452">.</span><span class="ident" id="4102453">explicit</span>&nbsp;<span class="op" id="4102462">&amp;&amp;</span>&nbsp;<span class="ident" id="4102465">params</span><span class="op" id="4102471">.</span><span class="ident" id="4102472">application</span>&nbsp;<span class="op" id="4102484">&amp;&amp;</span>&nbsp;<span class="ident" id="4102487">params</span><span class="op" id="4102493">.</span><span class="ident" id="4102494">tag</span>&nbsp;<span class="op" id="4102498">!=</span>&nbsp;<span class="ident" id="4102501">nil</span>&nbsp;<span class="op" id="4102505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102509">expectedClass</span>&nbsp;<span class="op" id="4102523">=</span>&nbsp;<span class="ident" id="4102525">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102544">expectedTag</span>&nbsp;<span class="op" id="4102556">=</span>&nbsp;<span class="op" id="4102558">*</span><span class="ident" id="4102559">params</span><span class="op" id="4102565">.</span><span class="ident" id="4102566">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102571">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4102575">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102633">if</span>&nbsp;<span class="ident" id="4102636">t</span><span class="op" id="4102637">.</span><span class="ident" id="4102638">class</span>&nbsp;<span class="op" id="4102644">!=</span>&nbsp;<span class="ident" id="4102647">expectedClass</span>&nbsp;<span class="op" id="4102661">||</span>&nbsp;<span class="ident" id="4102664">t</span><span class="op" id="4102665">.</span><span class="ident" id="4102666">tag</span>&nbsp;<span class="op" id="4102670">!=</span>&nbsp;<span class="ident" id="4102673">expectedTag</span>&nbsp;<span class="op" id="4102685">||</span>&nbsp;<span class="ident" id="4102688">t</span><span class="op" id="4102689">.</span><span class="ident" id="4102690">isCompound</span>&nbsp;<span class="op" id="4102701">!=</span>&nbsp;<span class="ident" id="4102704">compoundType</span>&nbsp;<span class="op" id="4102717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4102721">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102784">ok</span>&nbsp;<span class="op" id="4102787">:=</span>&nbsp;<span class="ident" id="4102790">setDefaultValue</span><span class="op" id="4102805">(</span><span class="ident" id="4102806">v</span><span class="op" id="4102807">,</span>&nbsp;<span class="ident" id="4102809">params</span><span class="op" id="4102815">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102819">if</span>&nbsp;<span class="ident" id="4102822">ok</span>&nbsp;<span class="op" id="4102825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102830">offset</span>&nbsp;<span class="op" id="4102837">=</span>&nbsp;<span class="ident" id="4102839">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102852">}</span>&nbsp;<span class="keyword" id="4102854">else</span>&nbsp;<span class="op" id="4102859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4102864">err</span>&nbsp;<span class="op" id="4102868">=</span>&nbsp;<span class="ident" id="4102870">StructuralError</span><span class="op" id="4102885">{</span><span class="ident" id="4102886">fmt</span><span class="op" id="4102889">.</span><span class="ident" id="4102890">Sprintf</span><span class="op" id="4102897">(</span><span class="string" id="4102898">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="4102939">,</span>&nbsp;<span class="ident" id="4102941">expectedTag</span><span class="op" id="4102952">,</span>&nbsp;<span class="ident" id="4102954">t</span><span class="op" id="4102955">,</span>&nbsp;<span class="ident" id="4102957">params</span><span class="op" id="4102963">,</span>&nbsp;<span class="ident" id="4102965">fieldType</span><span class="op" id="4102974">.</span><span class="ident" id="4102975">Name</span><span class="op" id="4102979">(</span><span class="op" id="4102980">)</span><span class="op" id="4102981">,</span>&nbsp;<span class="ident" id="4102983">offset</span><span class="op" id="4102989">)</span><span class="op" id="4102990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4102994">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4102998">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103009">if</span>&nbsp;<span class="ident" id="4103012">invalidLength</span><span class="op" id="4103025">(</span><span class="ident" id="4103026">offset</span><span class="op" id="4103032">,</span>&nbsp;<span class="ident" id="4103034">t</span><span class="op" id="4103035">.</span><span class="ident" id="4103036">length</span><span class="op" id="4103042">,</span>&nbsp;<span class="builtinfunc" id="4103044">len</span><span class="op" id="4103047">(</span><span class="ident" id="4103048">bytes</span><span class="op" id="4103053">)</span><span class="op" id="4103054">)</span>&nbsp;<span class="op" id="4103056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103060">err</span>&nbsp;<span class="op" id="4103064">=</span>&nbsp;<span class="ident" id="4103066">SyntaxError</span><span class="op" id="4103077">{</span><span class="string" id="4103078">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4103094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103098">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103109">innerBytes</span>&nbsp;<span class="op" id="4103120">:=</span>&nbsp;<span class="ident" id="4103123">bytes</span><span class="op" id="4103128">[</span><span class="ident" id="4103129">offset</span>&nbsp;<span class="op" id="4103136">:</span>&nbsp;<span class="ident" id="4103138">offset</span><span class="op" id="4103144">+</span><span class="ident" id="4103145">t</span><span class="op" id="4103146">.</span><span class="ident" id="4103147">length</span><span class="op" id="4103153">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103156">offset</span>&nbsp;<span class="op" id="4103163">+=</span>&nbsp;<span class="ident" id="4103166">t</span><span class="op" id="4103167">.</span><span class="ident" id="4103168">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4103177">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103240">switch</span>&nbsp;<span class="ident" id="4103247">fieldType</span>&nbsp;<span class="op" id="4103257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103260">case</span>&nbsp;<span class="ident" id="4103265">objectIdentifierType</span><span class="op" id="4103285">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103289">newSlice</span><span class="op" id="4103297">,</span>&nbsp;<span class="ident" id="4103299">err1</span>&nbsp;<span class="op" id="4103304">:=</span>&nbsp;<span class="ident" id="4103307">parseObjectIdentifier</span><span class="op" id="4103328">(</span><span class="ident" id="4103329">innerBytes</span><span class="op" id="4103339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103343">v</span><span class="op" id="4103344">.</span><span class="ident" id="4103345">Set</span><span class="op" id="4103348">(</span><span class="ident" id="4103349">reflect</span><span class="op" id="4103356">.</span><span class="ident" id="4103357">MakeSlice</span><span class="op" id="4103366">(</span><span class="ident" id="4103367">v</span><span class="op" id="4103368">.</span><span class="ident" id="4103369">Type</span><span class="op" id="4103373">(</span><span class="op" id="4103374">)</span><span class="op" id="4103375">,</span>&nbsp;<span class="builtinfunc" id="4103377">len</span><span class="op" id="4103380">(</span><span class="ident" id="4103381">newSlice</span><span class="op" id="4103389">)</span><span class="op" id="4103390">,</span>&nbsp;<span class="builtinfunc" id="4103392">len</span><span class="op" id="4103395">(</span><span class="ident" id="4103396">newSlice</span><span class="op" id="4103404">)</span><span class="op" id="4103405">)</span><span class="op" id="4103406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103410">if</span>&nbsp;<span class="ident" id="4103413">err1</span>&nbsp;<span class="op" id="4103418">==</span>&nbsp;<span class="ident" id="4103421">nil</span>&nbsp;<span class="op" id="4103425">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103430">reflect</span><span class="op" id="4103437">.</span><span class="ident" id="4103438">Copy</span><span class="op" id="4103442">(</span><span class="ident" id="4103443">v</span><span class="op" id="4103444">,</span>&nbsp;<span class="ident" id="4103446">reflect</span><span class="op" id="4103453">.</span><span class="ident" id="4103454">ValueOf</span><span class="op" id="4103461">(</span><span class="ident" id="4103462">newSlice</span><span class="op" id="4103470">)</span><span class="op" id="4103471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103479">err</span>&nbsp;<span class="op" id="4103483">=</span>&nbsp;<span class="ident" id="4103485">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103492">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103500">case</span>&nbsp;<span class="ident" id="4103505">bitStringType</span><span class="op" id="4103518">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103522">bs</span><span class="op" id="4103524">,</span>&nbsp;<span class="ident" id="4103526">err1</span>&nbsp;<span class="op" id="4103531">:=</span>&nbsp;<span class="ident" id="4103534">parseBitString</span><span class="op" id="4103548">(</span><span class="ident" id="4103549">innerBytes</span><span class="op" id="4103559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103563">if</span>&nbsp;<span class="ident" id="4103566">err1</span>&nbsp;<span class="op" id="4103571">==</span>&nbsp;<span class="ident" id="4103574">nil</span>&nbsp;<span class="op" id="4103578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103583">v</span><span class="op" id="4103584">.</span><span class="ident" id="4103585">Set</span><span class="op" id="4103588">(</span><span class="ident" id="4103589">reflect</span><span class="op" id="4103596">.</span><span class="ident" id="4103597">ValueOf</span><span class="op" id="4103604">(</span><span class="ident" id="4103605">bs</span><span class="op" id="4103607">)</span><span class="op" id="4103608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103612">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103616">err</span>&nbsp;<span class="op" id="4103620">=</span>&nbsp;<span class="ident" id="4103622">err1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103629">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103637">case</span>&nbsp;<span class="ident" id="4103642">timeType</span><span class="op" id="4103650">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103654">var</span>&nbsp;<span class="ident" id="4103658">time</span>&nbsp;<span class="ident" id="4103663">time</span><span class="op" id="4103667">.</span><span class="ident" id="4103668">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103675">var</span>&nbsp;<span class="ident" id="4103679">err1</span>&nbsp;<span class="builtintype" id="4103684">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103692">if</span>&nbsp;<span class="ident" id="4103695">universalTag</span>&nbsp;<span class="op" id="4103708">==</span>&nbsp;<span class="ident" id="4103711">tagUTCTime</span>&nbsp;<span class="op" id="4103722">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103727">time</span><span class="op" id="4103731">,</span>&nbsp;<span class="ident" id="4103733">err1</span>&nbsp;<span class="op" id="4103738">=</span>&nbsp;<span class="ident" id="4103740">parseUTCTime</span><span class="op" id="4103752">(</span><span class="ident" id="4103753">innerBytes</span><span class="op" id="4103763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103767">}</span>&nbsp;<span class="keyword" id="4103769">else</span>&nbsp;<span class="op" id="4103774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103779">time</span><span class="op" id="4103783">,</span>&nbsp;<span class="ident" id="4103785">err1</span>&nbsp;<span class="op" id="4103790">=</span>&nbsp;<span class="ident" id="4103792">parseGeneralizedTime</span><span class="op" id="4103812">(</span><span class="ident" id="4103813">innerBytes</span><span class="op" id="4103823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103831">if</span>&nbsp;<span class="ident" id="4103834">err1</span>&nbsp;<span class="op" id="4103839">==</span>&nbsp;<span class="ident" id="4103842">nil</span>&nbsp;<span class="op" id="4103846">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103851">v</span><span class="op" id="4103852">.</span><span class="ident" id="4103853">Set</span><span class="op" id="4103856">(</span><span class="ident" id="4103857">reflect</span><span class="op" id="4103864">.</span><span class="ident" id="4103865">ValueOf</span><span class="op" id="4103872">(</span><span class="ident" id="4103873">time</span><span class="op" id="4103877">)</span><span class="op" id="4103878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4103882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103886">err</span>&nbsp;<span class="op" id="4103890">=</span>&nbsp;<span class="ident" id="4103892">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103899">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103907">case</span>&nbsp;<span class="ident" id="4103912">enumeratedType</span><span class="op" id="4103926">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103930">parsedInt</span><span class="op" id="4103939">,</span>&nbsp;<span class="ident" id="4103941">err1</span>&nbsp;<span class="op" id="4103946">:=</span>&nbsp;<span class="ident" id="4103949">parseInt32</span><span class="op" id="4103959">(</span><span class="ident" id="4103960">innerBytes</span><span class="op" id="4103970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4103974">if</span>&nbsp;<span class="ident" id="4103977">err1</span>&nbsp;<span class="op" id="4103982">==</span>&nbsp;<span class="ident" id="4103985">nil</span>&nbsp;<span class="op" id="4103989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4103994">v</span><span class="op" id="4103995">.</span><span class="ident" id="4103996">SetInt</span><span class="op" id="4104002">(</span><span class="ident" id="4104003">int64</span><span class="op" id="4104008">(</span><span class="ident" id="4104009">parsedInt</span><span class="op" id="4104018">)</span><span class="op" id="4104019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104027">err</span>&nbsp;<span class="op" id="4104031">=</span>&nbsp;<span class="ident" id="4104033">err1</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104040">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104048">case</span>&nbsp;<span class="ident" id="4104053">flagType</span><span class="op" id="4104061">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104065">v</span><span class="op" id="4104066">.</span><span class="ident" id="4104067">SetBool</span><span class="op" id="4104074">(</span><span class="builtintype" id="4104075">true</span><span class="op" id="4104079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104083">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104091">case</span>&nbsp;<span class="ident" id="4104096">bigIntType</span><span class="op" id="4104106">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104110">parsedInt</span>&nbsp;<span class="op" id="4104120">:=</span>&nbsp;<span class="ident" id="4104123">parseBigInt</span><span class="op" id="4104134">(</span><span class="ident" id="4104135">innerBytes</span><span class="op" id="4104145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104149">v</span><span class="op" id="4104150">.</span><span class="ident" id="4104151">Set</span><span class="op" id="4104154">(</span><span class="ident" id="4104155">reflect</span><span class="op" id="4104162">.</span><span class="ident" id="4104163">ValueOf</span><span class="op" id="4104170">(</span><span class="ident" id="4104171">parsedInt</span><span class="op" id="4104180">)</span><span class="op" id="4104181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104185">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104196">switch</span>&nbsp;<span class="ident" id="4104203">val</span>&nbsp;<span class="op" id="4104207">:=</span>&nbsp;<span class="ident" id="4104210">v</span><span class="op" id="4104211">;</span>&nbsp;<span class="ident" id="4104213">val</span><span class="op" id="4104216">.</span><span class="ident" id="4104217">Kind</span><span class="op" id="4104221">(</span><span class="op" id="4104222">)</span>&nbsp;<span class="op" id="4104224">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104227">case</span>&nbsp;<span class="ident" id="4104232">reflect</span><span class="op" id="4104239">.</span><span class="ident" id="4104240">Bool</span><span class="op" id="4104244">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104248">parsedBool</span><span class="op" id="4104258">,</span>&nbsp;<span class="ident" id="4104260">err1</span>&nbsp;<span class="op" id="4104265">:=</span>&nbsp;<span class="ident" id="4104268">parseBool</span><span class="op" id="4104277">(</span><span class="ident" id="4104278">innerBytes</span><span class="op" id="4104288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104292">if</span>&nbsp;<span class="ident" id="4104295">err1</span>&nbsp;<span class="op" id="4104300">==</span>&nbsp;<span class="ident" id="4104303">nil</span>&nbsp;<span class="op" id="4104307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104312">val</span><span class="op" id="4104315">.</span><span class="ident" id="4104316">SetBool</span><span class="op" id="4104323">(</span><span class="ident" id="4104324">parsedBool</span><span class="op" id="4104334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104338">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104342">err</span>&nbsp;<span class="op" id="4104346">=</span>&nbsp;<span class="ident" id="4104348">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104355">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104363">case</span>&nbsp;<span class="ident" id="4104368">reflect</span><span class="op" id="4104375">.</span><span class="ident" id="4104376">Int</span><span class="op" id="4104379">,</span>&nbsp;<span class="ident" id="4104381">reflect</span><span class="op" id="4104388">.</span><span class="ident" id="4104389">Int32</span><span class="op" id="4104394">,</span>&nbsp;<span class="ident" id="4104396">reflect</span><span class="op" id="4104403">.</span><span class="ident" id="4104404">Int64</span><span class="op" id="4104409">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104413">if</span>&nbsp;<span class="ident" id="4104416">val</span><span class="op" id="4104419">.</span><span class="ident" id="4104420">Type</span><span class="op" id="4104424">(</span><span class="op" id="4104425">)</span><span class="op" id="4104426">.</span><span class="ident" id="4104427">Size</span><span class="op" id="4104431">(</span><span class="op" id="4104432">)</span>&nbsp;<span class="op" id="4104434">==</span>&nbsp;<span class="num" id="4104437">4</span>&nbsp;<span class="op" id="4104439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104444">parsedInt</span><span class="op" id="4104453">,</span>&nbsp;<span class="ident" id="4104455">err1</span>&nbsp;<span class="op" id="4104460">:=</span>&nbsp;<span class="ident" id="4104463">parseInt32</span><span class="op" id="4104473">(</span><span class="ident" id="4104474">innerBytes</span><span class="op" id="4104484">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104489">if</span>&nbsp;<span class="ident" id="4104492">err1</span>&nbsp;<span class="op" id="4104497">==</span>&nbsp;<span class="ident" id="4104500">nil</span>&nbsp;<span class="op" id="4104504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104510">val</span><span class="op" id="4104513">.</span><span class="ident" id="4104514">SetInt</span><span class="op" id="4104520">(</span><span class="ident" id="4104521">int64</span><span class="op" id="4104526">(</span><span class="ident" id="4104527">parsedInt</span><span class="op" id="4104536">)</span><span class="op" id="4104537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104547">err</span>&nbsp;<span class="op" id="4104551">=</span>&nbsp;<span class="ident" id="4104553">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104560">}</span>&nbsp;<span class="keyword" id="4104562">else</span>&nbsp;<span class="op" id="4104567">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104572">parsedInt</span><span class="op" id="4104581">,</span>&nbsp;<span class="ident" id="4104583">err1</span>&nbsp;<span class="op" id="4104588">:=</span>&nbsp;<span class="ident" id="4104591">parseInt64</span><span class="op" id="4104601">(</span><span class="ident" id="4104602">innerBytes</span><span class="op" id="4104612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104617">if</span>&nbsp;<span class="ident" id="4104620">err1</span>&nbsp;<span class="op" id="4104625">==</span>&nbsp;<span class="ident" id="4104628">nil</span>&nbsp;<span class="op" id="4104632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104638">val</span><span class="op" id="4104641">.</span><span class="ident" id="4104642">SetInt</span><span class="op" id="4104648">(</span><span class="ident" id="4104649">parsedInt</span><span class="op" id="4104658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104668">err</span>&nbsp;<span class="op" id="4104672">=</span>&nbsp;<span class="ident" id="4104674">err1</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104685">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4104693">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104751">case</span>&nbsp;<span class="ident" id="4104756">reflect</span><span class="op" id="4104763">.</span><span class="ident" id="4104764">Struct</span><span class="op" id="4104770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104774">structType</span>&nbsp;<span class="op" id="4104785">:=</span>&nbsp;<span class="ident" id="4104788">fieldType</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4104801">if</span>&nbsp;<span class="ident" id="4104804">structType</span><span class="op" id="4104814">.</span><span class="ident" id="4104815">NumField</span><span class="op" id="4104823">(</span><span class="op" id="4104824">)</span>&nbsp;<span class="op" id="4104826">&gt;</span>&nbsp;<span class="num" id="4104828">0</span>&nbsp;<span class="op" id="4104830">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104836">structType</span><span class="op" id="4104846">.</span><span class="ident" id="4104847">Field</span><span class="op" id="4104852">(</span><span class="num" id="4104853">0</span><span class="op" id="4104854">)</span><span class="op" id="4104855">.</span><span class="ident" id="4104856">Type</span>&nbsp;<span class="op" id="4104861">==</span>&nbsp;<span class="ident" id="4104864">rawContentsType</span>&nbsp;<span class="op" id="4104880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104885">bytes</span>&nbsp;<span class="op" id="4104891">:=</span>&nbsp;<span class="ident" id="4104894">bytes</span><span class="op" id="4104899">[</span><span class="ident" id="4104900">initOffset</span><span class="op" id="4104910">:</span><span class="ident" id="4104911">offset</span><span class="op" id="4104917">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104922">val</span><span class="op" id="4104925">.</span><span class="ident" id="4104926">Field</span><span class="op" id="4104931">(</span><span class="num" id="4104932">0</span><span class="op" id="4104933">)</span><span class="op" id="4104934">.</span><span class="ident" id="4104935">Set</span><span class="op" id="4104938">(</span><span class="ident" id="4104939">reflect</span><span class="op" id="4104946">.</span><span class="ident" id="4104947">ValueOf</span><span class="op" id="4104954">(</span><span class="ident" id="4104955">RawContent</span><span class="op" id="4104965">(</span><span class="ident" id="4104966">bytes</span><span class="op" id="4104971">)</span><span class="op" id="4104972">)</span><span class="op" id="4104973">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4104977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4104982">innerOffset</span>&nbsp;<span class="op" id="4104994">:=</span>&nbsp;<span class="num" id="4104997">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105001">for</span>&nbsp;<span class="ident" id="4105005">i</span>&nbsp;<span class="op" id="4105007">:=</span>&nbsp;<span class="num" id="4105010">0</span><span class="op" id="4105011">;</span>&nbsp;<span class="ident" id="4105013">i</span>&nbsp;<span class="op" id="4105015">&lt;</span>&nbsp;<span class="ident" id="4105017">structType</span><span class="op" id="4105027">.</span><span class="ident" id="4105028">NumField</span><span class="op" id="4105036">(</span><span class="op" id="4105037">)</span><span class="op" id="4105038">;</span>&nbsp;<span class="ident" id="4105040">i</span><span class="op" id="4105041">++</span>&nbsp;<span class="op" id="4105044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105049">field</span>&nbsp;<span class="op" id="4105055">:=</span>&nbsp;<span class="ident" id="4105058">structType</span><span class="op" id="4105068">.</span><span class="ident" id="4105069">Field</span><span class="op" id="4105074">(</span><span class="ident" id="4105075">i</span><span class="op" id="4105076">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105081">if</span>&nbsp;<span class="ident" id="4105084">i</span>&nbsp;<span class="op" id="4105086">==</span>&nbsp;<span class="num" id="4105089">0</span>&nbsp;<span class="op" id="4105091">&amp;&amp;</span>&nbsp;<span class="ident" id="4105094">field</span><span class="op" id="4105099">.</span><span class="ident" id="4105100">Type</span>&nbsp;<span class="op" id="4105105">==</span>&nbsp;<span class="ident" id="4105108">rawContentsType</span>&nbsp;<span class="op" id="4105124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105130">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105147">innerOffset</span><span class="op" id="4105158">,</span>&nbsp;<span class="ident" id="4105160">err</span>&nbsp;<span class="op" id="4105164">=</span>&nbsp;<span class="ident" id="4105166">parseField</span><span class="op" id="4105176">(</span><span class="ident" id="4105177">val</span><span class="op" id="4105180">.</span><span class="ident" id="4105181">Field</span><span class="op" id="4105186">(</span><span class="ident" id="4105187">i</span><span class="op" id="4105188">)</span><span class="op" id="4105189">,</span>&nbsp;<span class="ident" id="4105191">innerBytes</span><span class="op" id="4105201">,</span>&nbsp;<span class="ident" id="4105203">innerOffset</span><span class="op" id="4105214">,</span>&nbsp;<span class="ident" id="4105216">parseFieldParameters</span><span class="op" id="4105236">(</span><span class="ident" id="4105237">field</span><span class="op" id="4105242">.</span><span class="ident" id="4105243">Tag</span><span class="op" id="4105246">.</span><span class="ident" id="4105247">Get</span><span class="op" id="4105250">(</span><span class="string" id="4105251">&#34;asn1&#34;</span><span class="op" id="4105257">)</span><span class="op" id="4105258">)</span><span class="op" id="4105259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105264">if</span>&nbsp;<span class="ident" id="4105267">err</span>&nbsp;<span class="op" id="4105271">!=</span>&nbsp;<span class="ident" id="4105274">nil</span>&nbsp;<span class="op" id="4105278">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105284">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4105302">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4105363">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4105425">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105462">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105470">case</span>&nbsp;<span class="ident" id="4105475">reflect</span><span class="op" id="4105482">.</span><span class="ident" id="4105483">Slice</span><span class="op" id="4105488">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105492">sliceType</span>&nbsp;<span class="op" id="4105502">:=</span>&nbsp;<span class="ident" id="4105505">fieldType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105517">if</span>&nbsp;<span class="ident" id="4105520">sliceType</span><span class="op" id="4105529">.</span><span class="ident" id="4105530">Elem</span><span class="op" id="4105534">(</span><span class="op" id="4105535">)</span><span class="op" id="4105536">.</span><span class="ident" id="4105537">Kind</span><span class="op" id="4105541">(</span><span class="op" id="4105542">)</span>&nbsp;<span class="op" id="4105544">==</span>&nbsp;<span class="ident" id="4105547">reflect</span><span class="op" id="4105554">.</span><span class="ident" id="4105555">Uint8</span>&nbsp;<span class="op" id="4105561">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105566">val</span><span class="op" id="4105569">.</span><span class="ident" id="4105570">Set</span><span class="op" id="4105573">(</span><span class="ident" id="4105574">reflect</span><span class="op" id="4105581">.</span><span class="ident" id="4105582">MakeSlice</span><span class="op" id="4105591">(</span><span class="ident" id="4105592">sliceType</span><span class="op" id="4105601">,</span>&nbsp;<span class="builtinfunc" id="4105603">len</span><span class="op" id="4105606">(</span><span class="ident" id="4105607">innerBytes</span><span class="op" id="4105617">)</span><span class="op" id="4105618">,</span>&nbsp;<span class="builtinfunc" id="4105620">len</span><span class="op" id="4105623">(</span><span class="ident" id="4105624">innerBytes</span><span class="op" id="4105634">)</span><span class="op" id="4105635">)</span><span class="op" id="4105636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105641">reflect</span><span class="op" id="4105648">.</span><span class="ident" id="4105649">Copy</span><span class="op" id="4105653">(</span><span class="ident" id="4105654">val</span><span class="op" id="4105657">,</span>&nbsp;<span class="ident" id="4105659">reflect</span><span class="op" id="4105666">.</span><span class="ident" id="4105667">ValueOf</span><span class="op" id="4105674">(</span><span class="ident" id="4105675">innerBytes</span><span class="op" id="4105685">)</span><span class="op" id="4105686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105691">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105704">newSlice</span><span class="op" id="4105712">,</span>&nbsp;<span class="ident" id="4105714">err1</span>&nbsp;<span class="op" id="4105719">:=</span>&nbsp;<span class="ident" id="4105722">parseSequenceOf</span><span class="op" id="4105737">(</span><span class="ident" id="4105738">innerBytes</span><span class="op" id="4105748">,</span>&nbsp;<span class="ident" id="4105750">sliceType</span><span class="op" id="4105759">,</span>&nbsp;<span class="ident" id="4105761">sliceType</span><span class="op" id="4105770">.</span><span class="ident" id="4105771">Elem</span><span class="op" id="4105775">(</span><span class="op" id="4105776">)</span><span class="op" id="4105777">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105781">if</span>&nbsp;<span class="ident" id="4105784">err1</span>&nbsp;<span class="op" id="4105789">==</span>&nbsp;<span class="ident" id="4105792">nil</span>&nbsp;<span class="op" id="4105796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105801">val</span><span class="op" id="4105804">.</span><span class="ident" id="4105805">Set</span><span class="op" id="4105808">(</span><span class="ident" id="4105809">newSlice</span><span class="op" id="4105817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4105821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105825">err</span>&nbsp;<span class="op" id="4105829">=</span>&nbsp;<span class="ident" id="4105831">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105838">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105846">case</span>&nbsp;<span class="ident" id="4105851">reflect</span><span class="op" id="4105858">.</span><span class="ident" id="4105859">String</span><span class="op" id="4105865">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105869">var</span>&nbsp;<span class="ident" id="4105873">v</span>&nbsp;<span class="builtintype" id="4105875">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105884">switch</span>&nbsp;<span class="ident" id="4105891">universalTag</span>&nbsp;<span class="op" id="4105904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105908">case</span>&nbsp;<span class="ident" id="4105913">tagPrintableString</span><span class="op" id="4105931">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4105936">v</span><span class="op" id="4105937">,</span>&nbsp;<span class="ident" id="4105939">err</span>&nbsp;<span class="op" id="4105943">=</span>&nbsp;<span class="ident" id="4105945">parsePrintableString</span><span class="op" id="4105965">(</span><span class="ident" id="4105966">innerBytes</span><span class="op" id="4105976">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4105980">case</span>&nbsp;<span class="ident" id="4105985">tagIA5String</span><span class="op" id="4105997">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106002">v</span><span class="op" id="4106003">,</span>&nbsp;<span class="ident" id="4106005">err</span>&nbsp;<span class="op" id="4106009">=</span>&nbsp;<span class="ident" id="4106011">parseIA5String</span><span class="op" id="4106025">(</span><span class="ident" id="4106026">innerBytes</span><span class="op" id="4106036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106040">case</span>&nbsp;<span class="ident" id="4106045">tagT61String</span><span class="op" id="4106057">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106062">v</span><span class="op" id="4106063">,</span>&nbsp;<span class="ident" id="4106065">err</span>&nbsp;<span class="op" id="4106069">=</span>&nbsp;<span class="ident" id="4106071">parseT61String</span><span class="op" id="4106085">(</span><span class="ident" id="4106086">innerBytes</span><span class="op" id="4106096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106100">case</span>&nbsp;<span class="ident" id="4106105">tagUTF8String</span><span class="op" id="4106118">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106123">v</span><span class="op" id="4106124">,</span>&nbsp;<span class="ident" id="4106126">err</span>&nbsp;<span class="op" id="4106130">=</span>&nbsp;<span class="ident" id="4106132">parseUTF8String</span><span class="op" id="4106147">(</span><span class="ident" id="4106148">innerBytes</span><span class="op" id="4106158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106162">case</span>&nbsp;<span class="ident" id="4106167">tagGeneralString</span><span class="op" id="4106183">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4106188">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4106242">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4106300">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4106354">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106409">v</span><span class="op" id="4106410">,</span>&nbsp;<span class="ident" id="4106412">err</span>&nbsp;<span class="op" id="4106416">=</span>&nbsp;<span class="ident" id="4106418">parseT61String</span><span class="op" id="4106432">(</span><span class="ident" id="4106433">innerBytes</span><span class="op" id="4106443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106447">default</span><span class="op" id="4106454">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106459">err</span>&nbsp;<span class="op" id="4106463">=</span>&nbsp;<span class="ident" id="4106465">SyntaxError</span><span class="op" id="4106476">{</span><span class="ident" id="4106477">fmt</span><span class="op" id="4106480">.</span><span class="ident" id="4106481">Sprintf</span><span class="op" id="4106488">(</span><span class="string" id="4106489">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="4106529">,</span>&nbsp;<span class="ident" id="4106531">universalTag</span><span class="op" id="4106543">)</span><span class="op" id="4106544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4106548">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106552">if</span>&nbsp;<span class="ident" id="4106555">err</span>&nbsp;<span class="op" id="4106559">==</span>&nbsp;<span class="ident" id="4106562">nil</span>&nbsp;<span class="op" id="4106566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106571">val</span><span class="op" id="4106574">.</span><span class="ident" id="4106575">SetString</span><span class="op" id="4106584">(</span><span class="ident" id="4106585">v</span><span class="op" id="4106586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4106590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106594">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4106602">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4106605">err</span>&nbsp;<span class="op" id="4106609">=</span>&nbsp;<span class="ident" id="4106611">StructuralError</span><span class="op" id="4106626">{</span><span class="string" id="4106627">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="4106643">+</span>&nbsp;<span class="ident" id="4106645">v</span><span class="op" id="4106646">.</span><span class="ident" id="4106647">Type</span><span class="op" id="4106651">(</span><span class="op" id="4106652">)</span><span class="op" id="4106653">.</span><span class="ident" id="4106654">String</span><span class="op" id="4106660">(</span><span class="op" id="4106661">)</span><span class="op" id="4106662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106665">return</span><br>
<span class="lineno"></span><span class="op" id="4106672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4106675">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="4106753">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="4106800">func</span>&nbsp;<span class="ident" id="4106805">canHaveDefaultValue</span><span class="op" id="4106824">(</span><span class="ident" id="4106825">k</span>&nbsp;<span class="ident" id="4106827">reflect</span><span class="op" id="4106834">.</span><span class="ident" id="4106835">Kind</span><span class="op" id="4106839">)</span>&nbsp;<span class="builtintype" id="4106841">bool</span>&nbsp;<span class="op" id="4106846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106849">switch</span>&nbsp;<span class="ident" id="4106856">k</span>&nbsp;<span class="op" id="4106858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106861">case</span>&nbsp;<span class="ident" id="4106866">reflect</span><span class="op" id="4106873">.</span><span class="ident" id="4106874">Int</span><span class="op" id="4106877">,</span>&nbsp;<span class="ident" id="4106879">reflect</span><span class="op" id="4106886">.</span><span class="ident" id="4106887">Int8</span><span class="op" id="4106891">,</span>&nbsp;<span class="ident" id="4106893">reflect</span><span class="op" id="4106900">.</span><span class="ident" id="4106901">Int16</span><span class="op" id="4106906">,</span>&nbsp;<span class="ident" id="4106908">reflect</span><span class="op" id="4106915">.</span><span class="ident" id="4106916">Int32</span><span class="op" id="4106921">,</span>&nbsp;<span class="ident" id="4106923">reflect</span><span class="op" id="4106930">.</span><span class="ident" id="4106931">Int64</span><span class="op" id="4106936">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106940">return</span>&nbsp;<span class="builtintype" id="4106947">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4106953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4106957">return</span>&nbsp;<span class="builtintype" id="4106964">false</span><br>
<span class="lineno"></span><span class="op" id="4106970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4106973">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4107052">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4107132">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4107194">func</span>&nbsp;<span class="ident" id="4107199">setDefaultValue</span><span class="op" id="4107214">(</span><span class="ident" id="4107215">v</span>&nbsp;<span class="ident" id="4107217">reflect</span><span class="op" id="4107224">.</span><span class="ident" id="4107225">Value</span><span class="op" id="4107230">,</span>&nbsp;<span class="ident" id="4107232">params</span>&nbsp;<span class="ident" id="4107239">fieldParameters</span><span class="op" id="4107254">)</span>&nbsp;<span class="op" id="4107256">(</span><span class="ident" id="4107257">ok</span>&nbsp;<span class="builtintype" id="4107260">bool</span><span class="op" id="4107264">)</span>&nbsp;<span class="op" id="4107266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107269">if</span>&nbsp;<span class="op" id="4107272">!</span><span class="ident" id="4107273">params</span><span class="op" id="4107279">.</span><span class="ident" id="4107280">optional</span>&nbsp;<span class="op" id="4107289">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107293">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4107301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107304">ok</span>&nbsp;<span class="op" id="4107307">=</span>&nbsp;<span class="builtintype" id="4107309">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107315">if</span>&nbsp;<span class="ident" id="4107318">params</span><span class="op" id="4107324">.</span><span class="ident" id="4107325">defaultValue</span>&nbsp;<span class="op" id="4107338">==</span>&nbsp;<span class="ident" id="4107341">nil</span>&nbsp;<span class="op" id="4107345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107349">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4107357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107360">if</span>&nbsp;<span class="ident" id="4107363">canHaveDefaultValue</span><span class="op" id="4107382">(</span><span class="ident" id="4107383">v</span><span class="op" id="4107384">.</span><span class="ident" id="4107385">Kind</span><span class="op" id="4107389">(</span><span class="op" id="4107390">)</span><span class="op" id="4107391">)</span>&nbsp;<span class="op" id="4107393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4107397">v</span><span class="op" id="4107398">.</span><span class="ident" id="4107399">SetInt</span><span class="op" id="4107405">(</span><span class="op" id="4107406">*</span><span class="ident" id="4107407">params</span><span class="op" id="4107413">.</span><span class="ident" id="4107414">defaultValue</span><span class="op" id="4107426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4107429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4107432">return</span><br>
<span class="lineno">855</span><span class="op" id="4107439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4107442">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="4107501">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4107582">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="4107641">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4107694">//</span><br>
<span class="lineno"></span><span class="comment" id="4107697">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="4107757">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="4107801">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="4107854">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4107890">//</span><br>
<span class="lineno"></span><span class="comment" id="4107893">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="4107947">//</span><br>
<span class="lineno"></span><span class="comment" id="4107950">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="4108003">//</span><br>
<span class="lineno"></span><span class="comment" id="4108006">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4108057">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="4108078">//</span><br>
<span class="lineno"></span><span class="comment" id="4108081">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="4108137">//</span><br>
<span class="lineno"></span><span class="comment" id="4108140">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="4108210">//</span><br>
<span class="lineno"></span><span class="comment" id="4108213">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="4108282">//</span><br>
<span class="lineno">880</span><span class="comment" id="4108285">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="4108352">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4108420">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="4108457">//</span><br>
<span class="lineno"></span><span class="comment" id="4108460">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="4108513">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4108579">//</span><br>
<span class="lineno"></span><span class="comment" id="4108582">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4108637">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4108687">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="4108742">//</span><br>
<span class="lineno"></span><span class="comment" id="4108745">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="4108819">//</span><br>
<span class="lineno"></span><span class="comment" id="4108822">//&nbsp;&nbsp;&nbsp;&nbspapplication&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4108878">//&nbsp;&nbsp;&nbsp;&nbspdefault:x&nbsp;&nbsp;&nbsp;&nbspsets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="4108942">//&nbsp;&nbsp;&nbsp;&nbspexplicit&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4109020">//&nbsp;&nbsp;&nbsp;&nbspoptional&nbsp;&nbsp;&nbsp;&nbspmarks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="4109066">//&nbsp;&nbsp;&nbsp;&nbspset&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4109131">//&nbsp;&nbsp;&nbsp;&nbsptag:x&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="4109204">//</span><br>
<span class="lineno">900</span><span class="comment" id="4109207">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="4109283">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4109336">//</span><br>
<span class="lineno"></span><span class="comment" id="4109339">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4109418">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="4109494">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="4109525">//</span><br>
<span class="lineno"></span><span class="comment" id="4109528">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="4109591">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4109627">func</span>&nbsp;<span class="ident" id="4109632">Unmarshal</span><span class="op" id="4109641">(</span><span class="ident" id="4109642">b</span>&nbsp;<span class="op" id="4109644">[</span><span class="op" id="4109645">]</span><span class="builtintype" id="4109646">byte</span><span class="op" id="4109650">,</span>&nbsp;<span class="ident" id="4109652">val</span>&nbsp;<span class="keyword" id="4109656">interface</span><span class="op" id="4109665">{</span><span class="op" id="4109666">}</span><span class="op" id="4109667">)</span>&nbsp;<span class="op" id="4109669">(</span><span class="ident" id="4109670">rest</span>&nbsp;<span class="op" id="4109675">[</span><span class="op" id="4109676">]</span><span class="builtintype" id="4109677">byte</span><span class="op" id="4109681">,</span>&nbsp;<span class="ident" id="4109683">err</span>&nbsp;<span class="builtintype" id="4109687">error</span><span class="op" id="4109692">)</span>&nbsp;<span class="op" id="4109694">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4109697">return</span>&nbsp;<span class="ident" id="4109704">UnmarshalWithParams</span><span class="op" id="4109723">(</span><span class="ident" id="4109724">b</span><span class="op" id="4109725">,</span>&nbsp;<span class="ident" id="4109727">val</span><span class="op" id="4109730">,</span>&nbsp;<span class="string" id="4109732">&#34;&#34;</span><span class="op" id="4109734">)</span><br>
<span class="lineno"></span><span class="op" id="4109736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4109739">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4109810">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="4109886">func</span>&nbsp;<span class="ident" id="4109891">UnmarshalWithParams</span><span class="op" id="4109910">(</span><span class="ident" id="4109911">b</span>&nbsp;<span class="op" id="4109913">[</span><span class="op" id="4109914">]</span><span class="builtintype" id="4109915">byte</span><span class="op" id="4109919">,</span>&nbsp;<span class="ident" id="4109921">val</span>&nbsp;<span class="keyword" id="4109925">interface</span><span class="op" id="4109934">{</span><span class="op" id="4109935">}</span><span class="op" id="4109936">,</span>&nbsp;<span class="ident" id="4109938">params</span>&nbsp;<span class="builtintype" id="4109945">string</span><span class="op" id="4109951">)</span>&nbsp;<span class="op" id="4109953">(</span><span class="ident" id="4109954">rest</span>&nbsp;<span class="op" id="4109959">[</span><span class="op" id="4109960">]</span><span class="builtintype" id="4109961">byte</span><span class="op" id="4109965">,</span>&nbsp;<span class="ident" id="4109967">err</span>&nbsp;<span class="builtintype" id="4109971">error</span><span class="op" id="4109976">)</span>&nbsp;<span class="op" id="4109978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4109981">v</span>&nbsp;<span class="op" id="4109983">:=</span>&nbsp;<span class="ident" id="4109986">reflect</span><span class="op" id="4109993">.</span><span class="ident" id="4109994">ValueOf</span><span class="op" id="4110001">(</span><span class="ident" id="4110002">val</span><span class="op" id="4110005">)</span><span class="op" id="4110006">.</span><span class="ident" id="4110007">Elem</span><span class="op" id="4110011">(</span><span class="op" id="4110012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4110015">offset</span><span class="op" id="4110021">,</span>&nbsp;<span class="ident" id="4110023">err</span>&nbsp;<span class="op" id="4110027">:=</span>&nbsp;<span class="ident" id="4110030">parseField</span><span class="op" id="4110040">(</span><span class="ident" id="4110041">v</span><span class="op" id="4110042">,</span>&nbsp;<span class="ident" id="4110044">b</span><span class="op" id="4110045">,</span>&nbsp;<span class="num" id="4110047">0</span><span class="op" id="4110048">,</span>&nbsp;<span class="ident" id="4110050">parseFieldParameters</span><span class="op" id="4110070">(</span><span class="ident" id="4110071">params</span><span class="op" id="4110077">)</span><span class="op" id="4110078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4110081">if</span>&nbsp;<span class="ident" id="4110084">err</span>&nbsp;<span class="op" id="4110088">!=</span>&nbsp;<span class="ident" id="4110091">nil</span>&nbsp;<span class="op" id="4110095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4110099">return</span>&nbsp;<span class="ident" id="4110106">nil</span><span class="op" id="4110109">,</span>&nbsp;<span class="ident" id="4110111">err</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4110116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4110119">return</span>&nbsp;<span class="ident" id="4110126">b</span><span class="op" id="4110127">[</span><span class="ident" id="4110128">offset</span><span class="op" id="4110134">:</span><span class="op" id="4110135">]</span><span class="op" id="4110136">,</span>&nbsp;<span class="ident" id="4110138">nil</span><br>
<span class="lineno"></span><span class="op" id="4110142">}</span>
</div>
</body>
</html>
