<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>reflect</h2>
<ul>
<li><a href="/gostd/reflect/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/reflect/deepequal.go.html">deepequal.go</a></li>
<li><a href="/gostd/reflect/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/reflect/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/reflect/makefunc.go.html">makefunc.go</a></li>
<li><a href="/gostd/reflect/set_test.go.html">set_test.go</a></li>
<li><a href="/gostd/reflect/tostring_test.go.html">tostring_test.go</a></li>
<li><a href="/gostd/reflect/type.go.html">type.go</a></li>
<li><a href="/gostd/reflect/value.go.html">value.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2665034">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2665089">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2665143">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2665194">//&nbsp;Package&nbsp;reflect&nbsp;implements&nbsp;run-time&nbsp;reflection,&nbsp;allowing&nbsp;a&nbsp;program&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2665267">//&nbsp;manipulate&nbsp;objects&nbsp;with&nbsp;arbitrary&nbsp;types.&nbsp;&nbsp;The&nbsp;typical&nbsp;use&nbsp;is&nbsp;to&nbsp;take&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2665347">//&nbsp;with&nbsp;static&nbsp;type&nbsp;interface{}&nbsp;and&nbsp;extract&nbsp;its&nbsp;dynamic&nbsp;type&nbsp;information&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2665423">//&nbsp;calling&nbsp;TypeOf,&nbsp;which&nbsp;returns&nbsp;a&nbsp;Type.</span><br>
<span class="lineno"></span><span class="comment" id="2665464">//</span><br>
<span class="lineno">10</span><span class="comment" id="2665467">//&nbsp;A&nbsp;call&nbsp;to&nbsp;ValueOf&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;the&nbsp;run-time&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="2665536">//&nbsp;Zero&nbsp;takes&nbsp;a&nbsp;Type&nbsp;and&nbsp;returns&nbsp;a&nbsp;Value&nbsp;representing&nbsp;a&nbsp;zero&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2665603">//&nbsp;for&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2665621">//</span><br>
<span class="lineno"></span><span class="comment" id="2665624">//&nbsp;See&nbsp;&#34;The&nbsp;Laws&nbsp;of&nbsp;Reflection&#34;&nbsp;for&nbsp;an&nbsp;introduction&nbsp;to&nbsp;reflection&nbsp;in&nbsp;Go:</span><br>
<span class="lineno">15</span><span class="comment" id="2665697">//&nbsp;http://golang.org/doc/articles/laws_of_reflection.html</span><br>
<span class="lineno"></span><span class="keyword" id="2665755">package</span>&nbsp;<span class="ident" id="2665763">reflect</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2665772">import</span>&nbsp;<span class="op" id="2665779">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2665782">&#34;runtime&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2665793">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2665804">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2665812">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="2665821">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="2665824">//&nbsp;Type&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2665868">//</span><br>
<span class="lineno"></span><span class="comment" id="2665871">//&nbsp;Not&nbsp;all&nbsp;methods&nbsp;apply&nbsp;to&nbsp;all&nbsp;kinds&nbsp;of&nbsp;types.&nbsp;&nbsp;Restrictions,</span><br>
<span class="lineno"></span><span class="comment" id="2665934">//&nbsp;if&nbsp;any,&nbsp;are&nbsp;noted&nbsp;in&nbsp;the&nbsp;documentation&nbsp;for&nbsp;each&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2665993">//&nbsp;Use&nbsp;the&nbsp;Kind&nbsp;method&nbsp;to&nbsp;find&nbsp;out&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;before</span><br>
<span class="lineno">30</span><span class="comment" id="2666052">//&nbsp;calling&nbsp;kind-specific&nbsp;methods.&nbsp;&nbsp;Calling&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span><span class="comment" id="2666104">//&nbsp;inappropriate&nbsp;to&nbsp;the&nbsp;kind&nbsp;of&nbsp;type&nbsp;causes&nbsp;a&nbsp;run-time&nbsp;panic.</span><br>
<span class="lineno"></span><span class="keyword" id="2666166">type</span>&nbsp;<span class="ident" id="2666171">Type</span>&nbsp;<span class="keyword" id="2666176">interface</span>&nbsp;<span class="op" id="2666186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666189">//&nbsp;Methods&nbsp;applicable&nbsp;to&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666227">//&nbsp;Align&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666282">//&nbsp;this&nbsp;type&nbsp;when&nbsp;allocated&nbsp;in&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2666322">Align</span><span class="op" id="2666327">(</span><span class="op" id="2666328">)</span>&nbsp;<span class="builtintype" id="2666330">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666336">//&nbsp;FieldAlign&nbsp;returns&nbsp;the&nbsp;alignment&nbsp;in&nbsp;bytes&nbsp;of&nbsp;a&nbsp;value&nbsp;of</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666396">//&nbsp;this&nbsp;type&nbsp;when&nbsp;used&nbsp;as&nbsp;a&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2666444">FieldAlign</span><span class="op" id="2666454">(</span><span class="op" id="2666455">)</span>&nbsp;<span class="builtintype" id="2666457">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666463">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666524">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumMethod()).</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666581">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666585">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666659">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666728">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666732">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666802">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2666871">Method</span><span class="op" id="2666877">(</span><span class="builtintype" id="2666878">int</span><span class="op" id="2666881">)</span>&nbsp;<span class="ident" id="2666883">Method</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666892">//&nbsp;MethodByName&nbsp;returns&nbsp;the&nbsp;method&nbsp;with&nbsp;that&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2666957">//&nbsp;method&nbsp;set&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;method&nbsp;was&nbsp;found.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667022">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667026">//&nbsp;For&nbsp;a&nbsp;non-interface&nbsp;type&nbsp;T&nbsp;or&nbsp;*T,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;and&nbsp;Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667100">//&nbsp;fields&nbsp;describe&nbsp;a&nbsp;function&nbsp;whose&nbsp;first&nbsp;argument&nbsp;is&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667169">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667173">//&nbsp;For&nbsp;an&nbsp;interface&nbsp;type,&nbsp;the&nbsp;returned&nbsp;Method&#39;s&nbsp;Type&nbsp;field&nbsp;gives&nbsp;the</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667243">//&nbsp;method&nbsp;signature,&nbsp;without&nbsp;a&nbsp;receiver,&nbsp;and&nbsp;the&nbsp;Func&nbsp;field&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2667312">MethodByName</span><span class="op" id="2667324">(</span><span class="builtintype" id="2667325">string</span><span class="op" id="2667331">)</span>&nbsp;<span class="op" id="2667333">(</span><span class="ident" id="2667334">Method</span><span class="op" id="2667340">,</span>&nbsp;<span class="builtintype" id="2667342">bool</span><span class="op" id="2667346">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667350">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2667420">NumMethod</span><span class="op" id="2667429">(</span><span class="op" id="2667430">)</span>&nbsp;<span class="builtintype" id="2667432">int</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667438">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;type&#39;s&nbsp;name&nbsp;within&nbsp;its&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667491">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;empty&nbsp;string&nbsp;for&nbsp;unnamed&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2667541">Name</span><span class="op" id="2667545">(</span><span class="op" id="2667546">)</span>&nbsp;<span class="builtintype" id="2667548">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667557">//&nbsp;PkgPath&nbsp;returns&nbsp;a&nbsp;named&nbsp;type&#39;s&nbsp;package&nbsp;path,&nbsp;that&nbsp;is,&nbsp;the&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667631">//&nbsp;that&nbsp;uniquely&nbsp;identifies&nbsp;the&nbsp;package,&nbsp;such&nbsp;as&nbsp;&#34;encoding/base64&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667700">//&nbsp;If&nbsp;the&nbsp;type&nbsp;was&nbsp;predeclared&nbsp;(string,&nbsp;error)&nbsp;or&nbsp;unnamed&nbsp;(*T,&nbsp;struct{},&nbsp;[]int),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667782">//&nbsp;the&nbsp;package&nbsp;path&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2667829">PkgPath</span><span class="op" id="2667836">(</span><span class="op" id="2667837">)</span>&nbsp;<span class="builtintype" id="2667839">string</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667848">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;needed&nbsp;to&nbsp;store</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667901">//&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;given&nbsp;type;&nbsp;it&nbsp;is&nbsp;analogous&nbsp;to&nbsp;unsafe.Sizeof.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2667966">Size</span><span class="op" id="2667970">(</span><span class="op" id="2667971">)</span>&nbsp;<span class="builtintype" id="2667973">uintptr</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2667983">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668039">//&nbsp;The&nbsp;string&nbsp;representation&nbsp;may&nbsp;use&nbsp;shortened&nbsp;package&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668101">//&nbsp;(e.g.,&nbsp;base64&nbsp;instead&nbsp;of&nbsp;&#34;encoding/base64&#34;)&nbsp;and&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668160">//&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique&nbsp;among&nbsp;types.&nbsp;&nbsp;To&nbsp;test&nbsp;for&nbsp;equality,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668224">//&nbsp;compare&nbsp;the&nbsp;Types&nbsp;directly.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2668256">String</span><span class="op" id="2668262">(</span><span class="op" id="2668263">)</span>&nbsp;<span class="builtintype" id="2668265">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668274">//&nbsp;Kind&nbsp;returns&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2668323">Kind</span><span class="op" id="2668327">(</span><span class="op" id="2668328">)</span>&nbsp;<span class="ident" id="2668330">Kind</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668337">//&nbsp;Implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2668410">Implements</span><span class="op" id="2668420">(</span><span class="ident" id="2668421">u</span>&nbsp;<span class="ident" id="2668423">Type</span><span class="op" id="2668427">)</span>&nbsp;<span class="builtintype" id="2668429">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668436">//&nbsp;AssignableTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;assignable&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2668514">AssignableTo</span><span class="op" id="2668526">(</span><span class="ident" id="2668527">u</span>&nbsp;<span class="ident" id="2668529">Type</span><span class="op" id="2668533">)</span>&nbsp;<span class="builtintype" id="2668535">bool</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668542">//&nbsp;ConvertibleTo&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;of&nbsp;the&nbsp;type&nbsp;is&nbsp;convertible&nbsp;to&nbsp;type&nbsp;u.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2668622">ConvertibleTo</span><span class="op" id="2668635">(</span><span class="ident" id="2668636">u</span>&nbsp;<span class="ident" id="2668638">Type</span><span class="op" id="2668642">)</span>&nbsp;<span class="builtintype" id="2668644">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668651">//&nbsp;Comparable&nbsp;returns&nbsp;true&nbsp;if&nbsp;values&nbsp;of&nbsp;this&nbsp;type&nbsp;are&nbsp;comparable.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2668718">Comparable</span><span class="op" id="2668728">(</span><span class="op" id="2668729">)</span>&nbsp;<span class="builtintype" id="2668731">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668738">//&nbsp;Methods&nbsp;applicable&nbsp;only&nbsp;to&nbsp;some&nbsp;types,&nbsp;depending&nbsp;on&nbsp;Kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668800">//&nbsp;The&nbsp;methods&nbsp;allowed&nbsp;for&nbsp;each&nbsp;kind&nbsp;are:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668843">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668847">//&nbsp;&nbsp;&nbsp;&nbspInt*,&nbsp;Uint*,&nbsp;Float*,&nbsp;Complex*:&nbsp;Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668887">//&nbsp;&nbsp;&nbsp;&nbspArray:&nbsp;Elem,&nbsp;Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668908">//&nbsp;&nbsp;&nbsp;&nbspChan:&nbsp;ChanDir,&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668932">//&nbsp;&nbsp;&nbsp;&nbspFunc:&nbsp;In,&nbsp;NumIn,&nbsp;Out,&nbsp;NumOut,&nbsp;IsVariadic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668978">//&nbsp;&nbsp;&nbsp;&nbspMap:&nbsp;Key,&nbsp;Elem</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2668997">//&nbsp;&nbsp;&nbsp;&nbspPtr:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669011">//&nbsp;&nbsp;&nbsp;&nbspSlice:&nbsp;Elem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669027">//&nbsp;&nbsp;&nbsp;&nbspStruct:&nbsp;Field,&nbsp;FieldByIndex,&nbsp;FieldByName,&nbsp;FieldByNameFunc,&nbsp;NumField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669100">//&nbsp;Bits&nbsp;returns&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;type&nbsp;in&nbsp;bits.</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669147">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;one&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669198">//&nbsp;sized&nbsp;or&nbsp;unsized&nbsp;Int,&nbsp;Uint,&nbsp;Float,&nbsp;or&nbsp;Complex&nbsp;kinds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669255">Bits</span><span class="op" id="2669259">(</span><span class="op" id="2669260">)</span>&nbsp;<span class="builtintype" id="2669262">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669268">//&nbsp;ChanDir&nbsp;returns&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669316">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Chan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669362">ChanDir</span><span class="op" id="2669369">(</span><span class="op" id="2669370">)</span>&nbsp;<span class="ident" id="2669372">ChanDir</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669382">//&nbsp;IsVariadic&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;final&nbsp;input&nbsp;parameter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669453">//&nbsp;is&nbsp;a&nbsp;&#34;...&#34;&nbsp;parameter.&nbsp;&nbsp;If&nbsp;so,&nbsp;t.In(t.NumIn()&nbsp;-&nbsp;1)&nbsp;returns&nbsp;the&nbsp;parameter&#39;s</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669531">//&nbsp;implicit&nbsp;actual&nbsp;type&nbsp;[]T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669561">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669565">//&nbsp;For&nbsp;concreteness,&nbsp;if&nbsp;t&nbsp;represents&nbsp;func(x&nbsp;int,&nbsp;y&nbsp;...&nbsp;float64),&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669636">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669640">//&nbsp;&nbsp;&nbsp;&nbspt.NumIn()&nbsp;==&nbsp;2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669659">//&nbsp;&nbsp;&nbsp;&nbspt.In(0)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;int&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669701">//&nbsp;&nbsp;&nbsp;&nbspt.In(1)&nbsp;is&nbsp;the&nbsp;reflect.Type&nbsp;for&nbsp;&#34;[]float64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669749">//&nbsp;&nbsp;&nbsp;&nbspt.IsVariadic()&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669776">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669780">//&nbsp;IsVariadic&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669834">IsVariadic</span><span class="op" id="2669844">(</span><span class="op" id="2669845">)</span>&nbsp;<span class="builtintype" id="2669847">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669854">//&nbsp;Elem&nbsp;returns&nbsp;a&nbsp;type&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669894">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array,&nbsp;Chan,&nbsp;Map,&nbsp;Ptr,&nbsp;or&nbsp;Slice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2669967">Elem</span><span class="op" id="2669971">(</span><span class="op" id="2669972">)</span>&nbsp;<span class="ident" id="2669974">Type</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2669981">//&nbsp;Field&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670027">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670075">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumField()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670131">Field</span><span class="op" id="2670136">(</span><span class="ident" id="2670137">i</span>&nbsp;<span class="builtintype" id="2670139">int</span><span class="op" id="2670142">)</span>&nbsp;<span class="ident" id="2670144">StructField</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670158">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670214">//&nbsp;to&nbsp;the&nbsp;index&nbsp;sequence.&nbsp;&nbsp;It&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670276">//&nbsp;successively&nbsp;for&nbsp;each&nbsp;index&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670311">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670359">FieldByIndex</span><span class="op" id="2670371">(</span><span class="ident" id="2670372">index</span>&nbsp;<span class="op" id="2670378">[</span><span class="op" id="2670379">]</span><span class="builtintype" id="2670380">int</span><span class="op" id="2670383">)</span>&nbsp;<span class="ident" id="2670385">StructField</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670399">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670460">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670513">FieldByName</span><span class="op" id="2670524">(</span><span class="ident" id="2670525">name</span>&nbsp;<span class="builtintype" id="2670530">string</span><span class="op" id="2670536">)</span>&nbsp;<span class="op" id="2670538">(</span><span class="ident" id="2670539">StructField</span><span class="op" id="2670550">,</span>&nbsp;<span class="builtintype" id="2670552">bool</span><span class="op" id="2670556">)</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670560">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;first&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670623">//&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670689">//&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670714">FieldByNameFunc</span><span class="op" id="2670729">(</span><span class="ident" id="2670730">match</span>&nbsp;<span class="keyword" id="2670736">func</span><span class="op" id="2670740">(</span><span class="builtintype" id="2670741">string</span><span class="op" id="2670747">)</span>&nbsp;<span class="builtintype" id="2670749">bool</span><span class="op" id="2670753">)</span>&nbsp;<span class="op" id="2670755">(</span><span class="ident" id="2670756">StructField</span><span class="op" id="2670767">,</span>&nbsp;<span class="builtintype" id="2670769">bool</span><span class="op" id="2670773">)</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670777">//&nbsp;In&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;input&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670844">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670890">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumIn()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2670943">In</span><span class="op" id="2670945">(</span><span class="ident" id="2670946">i</span>&nbsp;<span class="builtintype" id="2670948">int</span><span class="op" id="2670951">)</span>&nbsp;<span class="ident" id="2670953">Type</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670960">//&nbsp;Key&nbsp;returns&nbsp;a&nbsp;map&nbsp;type&#39;s&nbsp;key&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2670999">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671044">Key</span><span class="op" id="2671047">(</span><span class="op" id="2671048">)</span>&nbsp;<span class="ident" id="2671050">Type</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671057">//&nbsp;Len&nbsp;returns&nbsp;an&nbsp;array&nbsp;type&#39;s&nbsp;length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671097">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Array.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671144">Len</span><span class="op" id="2671147">(</span><span class="op" id="2671148">)</span>&nbsp;<span class="builtintype" id="2671150">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671156">//&nbsp;NumField&nbsp;returns&nbsp;a&nbsp;struct&nbsp;type&#39;s&nbsp;field&nbsp;count.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671206">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Struct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671254">NumField</span><span class="op" id="2671262">(</span><span class="op" id="2671263">)</span>&nbsp;<span class="builtintype" id="2671265">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671271">//&nbsp;NumIn&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;input&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671330">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671376">NumIn</span><span class="op" id="2671381">(</span><span class="op" id="2671382">)</span>&nbsp;<span class="builtintype" id="2671384">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671390">//&nbsp;NumOut&nbsp;returns&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;output&nbsp;parameter&nbsp;count.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671451">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671497">NumOut</span><span class="op" id="2671503">(</span><span class="op" id="2671504">)</span>&nbsp;<span class="builtintype" id="2671506">int</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671512">//&nbsp;Out&nbsp;returns&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;function&nbsp;type&#39;s&nbsp;i&#39;th&nbsp;output&nbsp;parameter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671581">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;the&nbsp;type&#39;s&nbsp;Kind&nbsp;is&nbsp;not&nbsp;Func.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2671627">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;i&nbsp;is&nbsp;not&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;NumOut()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671681">Out</span><span class="op" id="2671684">(</span><span class="ident" id="2671685">i</span>&nbsp;<span class="builtintype" id="2671687">int</span><span class="op" id="2671690">)</span>&nbsp;<span class="ident" id="2671692">Type</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671699">common</span><span class="op" id="2671705">(</span><span class="op" id="2671706">)</span>&nbsp;<span class="op" id="2671708">*</span><span class="ident" id="2671709">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2671716">uncommon</span><span class="op" id="2671724">(</span><span class="op" id="2671725">)</span>&nbsp;<span class="op" id="2671727">*</span><span class="ident" id="2671728">uncommonType</span><br>
<span class="lineno"></span><span class="op" id="2671741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2671744">//&nbsp;BUG(rsc):&nbsp;FieldByName&nbsp;and&nbsp;related&nbsp;functions&nbsp;consider&nbsp;struct&nbsp;field&nbsp;names&nbsp;to&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span><span class="comment" id="2671831">//&nbsp;if&nbsp;the&nbsp;names&nbsp;are&nbsp;equal,&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;unexported&nbsp;names&nbsp;originating</span><br>
<span class="lineno"></span><span class="comment" id="2671904">//&nbsp;in&nbsp;different&nbsp;packages.&nbsp;The&nbsp;practical&nbsp;effect&nbsp;of&nbsp;this&nbsp;is&nbsp;that&nbsp;the&nbsp;result&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2671981">//&nbsp;t.FieldByName(&#34;x&#34;)&nbsp;is&nbsp;not&nbsp;well&nbsp;defined&nbsp;if&nbsp;the&nbsp;struct&nbsp;type&nbsp;t&nbsp;contains</span><br>
<span class="lineno"></span><span class="comment" id="2672053">//&nbsp;multiple&nbsp;fields&nbsp;named&nbsp;x&nbsp;(embedded&nbsp;from&nbsp;different&nbsp;packages).</span><br>
<span class="lineno">200</span><span class="comment" id="2672116">//&nbsp;FieldByName&nbsp;may&nbsp;return&nbsp;one&nbsp;of&nbsp;the&nbsp;fields&nbsp;named&nbsp;x&nbsp;or&nbsp;may&nbsp;report&nbsp;that&nbsp;there&nbsp;are&nbsp;none.</span><br>
<span class="lineno"></span><span class="comment" id="2672203">//&nbsp;See&nbsp;golang.org/issue/4876&nbsp;for&nbsp;more&nbsp;details.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2672251">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;These&nbsp;data&nbsp;structures&nbsp;are&nbsp;known&nbsp;to&nbsp;the&nbsp;compiler&nbsp;(../../cmd/gc/reflect.c).<br>
<span class="lineno">205</span>&nbsp;*&nbsp;A&nbsp;few&nbsp;are&nbsp;known&nbsp;to&nbsp;../runtime/type.go&nbsp;to&nbsp;convey&nbsp;to&nbsp;debuggers.<br>
<span class="lineno"></span>&nbsp;*&nbsp;They&nbsp;are&nbsp;also&nbsp;known&nbsp;to&nbsp;../runtime/type.h.<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2672446">//&nbsp;A&nbsp;Kind&nbsp;represents&nbsp;the&nbsp;specific&nbsp;kind&nbsp;of&nbsp;type&nbsp;that&nbsp;a&nbsp;Type&nbsp;represents.</span><br>
<span class="lineno">210</span><span class="comment" id="2672517">//&nbsp;The&nbsp;zero&nbsp;Kind&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;kind.</span><br>
<span class="lineno"></span><span class="keyword" id="2672555">type</span>&nbsp;<span class="ident" id="2672560">Kind</span>&nbsp;<span class="builtintype" id="2672565">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2672571">const</span>&nbsp;<span class="op" id="2672577">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672580">Invalid</span>&nbsp;<span class="ident" id="2672588">Kind</span>&nbsp;<span class="op" id="2672593">=</span>&nbsp;<span class="ident" id="2672595">iota</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672601">Bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672607">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672612">Int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672618">Int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672625">Int32</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672632">Int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672639">Uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672645">Uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672652">Uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672660">Uint32</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672668">Uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672676">Uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672685">Float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672694">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672703">Complex64</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672714">Complex128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672726">Array</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672733">Chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672739">Func</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672745">Interface</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672756">Map</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672761">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672766">Slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672773">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672781">Struct</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2672789">UnsafePointer</span><br>
<span class="lineno"></span><span class="op" id="2672803">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2672806">//&nbsp;rtype&nbsp;is&nbsp;the&nbsp;common&nbsp;implementation&nbsp;of&nbsp;most&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="2672860">//&nbsp;It&nbsp;is&nbsp;embedded&nbsp;in&nbsp;other,&nbsp;public&nbsp;struct&nbsp;types,&nbsp;but&nbsp;always</span><br>
<span class="lineno">245</span><span class="comment" id="2672920">//&nbsp;with&nbsp;a&nbsp;unique&nbsp;tag&nbsp;like&nbsp;`reflect:&#34;array&#34;`&nbsp;or&nbsp;`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span><span class="comment" id="2672983">//&nbsp;so&nbsp;that&nbsp;code&nbsp;cannot&nbsp;convert&nbsp;from,&nbsp;say,&nbsp;*arrayType&nbsp;to&nbsp;*ptrType.</span><br>
<span class="lineno"></span><span class="keyword" id="2673049">type</span>&nbsp;<span class="ident" id="2673054">rtype</span>&nbsp;<span class="keyword" id="2673060">struct</span>&nbsp;<span class="op" id="2673067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673070">size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2673084">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673093">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2673107">uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2673125">//&nbsp;hash&nbsp;of&nbsp;type;&nbsp;avoids&nbsp;computation&nbsp;in&nbsp;hash&nbsp;tables</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673177">_</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2673191">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2673209">//&nbsp;unused/padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673228">align</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2673242">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2673260">//&nbsp;alignment&nbsp;of&nbsp;variable&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673301">fieldAlign</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2673315">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2673333">//&nbsp;alignment&nbsp;of&nbsp;struct&nbsp;field&nbsp;with&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673378">kind</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2673392">uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2673410">//&nbsp;enumeration&nbsp;for&nbsp;C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673432">alg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2673446">*</span><span class="ident" id="2673447">typeAlg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2673464">//&nbsp;algorithm&nbsp;table&nbsp;(../runtime/runtime.h:/Alg)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673512">gc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2673526">[</span><span class="num" id="2673527">2</span><span class="op" id="2673528">]</span><span class="ident" id="2673529">unsafe</span><span class="op" id="2673535">.</span><span class="ident" id="2673536">Pointer</span>&nbsp;<span class="comment" id="2673544">//&nbsp;garbage&nbsp;collection&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2673572">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2673586">*</span><span class="builtintype" id="2673587">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2673604">//&nbsp;string&nbsp;form;&nbsp;unnecessary&nbsp;but&nbsp;undeniably&nbsp;useful</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2673655">*</span><span class="ident" id="2673656">uncommonType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2673687">//&nbsp;(relatively)&nbsp;uncommon&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673720">ptrToThis</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2673734">*</span><span class="ident" id="2673735">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2673752">//&nbsp;type&nbsp;for&nbsp;pointer&nbsp;to&nbsp;this&nbsp;type,&nbsp;if&nbsp;used&nbsp;in&nbsp;binary&nbsp;or&nbsp;has&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673820">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2673834">unsafe</span><span class="op" id="2673840">.</span><span class="ident" id="2673841">Pointer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2673852">//&nbsp;pointer&nbsp;to&nbsp;zero&nbsp;value</span><br>
<span class="lineno">260</span><span class="op" id="2673877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2673880">type</span>&nbsp;<span class="ident" id="2673885">typeAlg</span>&nbsp;<span class="keyword" id="2673893">struct</span>&nbsp;<span class="op" id="2673900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673903">//&nbsp;function&nbsp;for&nbsp;hashing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2673949">//&nbsp;(ptr&nbsp;to&nbsp;object,&nbsp;size,&nbsp;seed)&nbsp;-&gt;&nbsp;hash</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2673989">hash</span>&nbsp;<span class="keyword" id="2673994">func</span><span class="op" id="2673998">(</span><span class="ident" id="2673999">unsafe</span><span class="op" id="2674005">.</span><span class="ident" id="2674006">Pointer</span><span class="op" id="2674013">,</span>&nbsp;<span class="builtintype" id="2674015">uintptr</span><span class="op" id="2674022">,</span>&nbsp;<span class="builtintype" id="2674024">uintptr</span><span class="op" id="2674031">)</span>&nbsp;<span class="builtintype" id="2674033">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674042">//&nbsp;function&nbsp;for&nbsp;comparing&nbsp;objects&nbsp;of&nbsp;this&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2674090">//&nbsp;(ptr&nbsp;to&nbsp;object&nbsp;A,&nbsp;ptr&nbsp;to&nbsp;object&nbsp;B,&nbsp;size)&nbsp;-&gt;&nbsp;==?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674142">equal</span>&nbsp;<span class="keyword" id="2674148">func</span><span class="op" id="2674152">(</span><span class="ident" id="2674153">unsafe</span><span class="op" id="2674159">.</span><span class="ident" id="2674160">Pointer</span><span class="op" id="2674167">,</span>&nbsp;<span class="ident" id="2674169">unsafe</span><span class="op" id="2674175">.</span><span class="ident" id="2674176">Pointer</span><span class="op" id="2674183">,</span>&nbsp;<span class="builtintype" id="2674185">uintptr</span><span class="op" id="2674192">)</span>&nbsp;<span class="builtintype" id="2674194">bool</span><br>
<span class="lineno"></span><span class="op" id="2674199">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="2674202">//&nbsp;Method&nbsp;on&nbsp;non-interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2674234">type</span>&nbsp;<span class="ident" id="2674239">method</span>&nbsp;<span class="keyword" id="2674246">struct</span>&nbsp;<span class="op" id="2674253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674256">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2674264">*</span><span class="builtintype" id="2674265">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2674279">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674298">pkgPath</span>&nbsp;<span class="op" id="2674306">*</span><span class="builtintype" id="2674307">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2674321">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674371">mtyp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2674379">*</span><span class="ident" id="2674380">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2674394">//&nbsp;method&nbsp;type&nbsp;(without&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674429">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2674437">*</span><span class="ident" id="2674438">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2674452">//&nbsp;.(*FuncType)&nbsp;underneath&nbsp;(with&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674496">ifn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2674504">unsafe</span><span class="op" id="2674510">.</span><span class="ident" id="2674511">Pointer</span>&nbsp;<span class="comment" id="2674519">//&nbsp;fn&nbsp;used&nbsp;in&nbsp;interface&nbsp;call&nbsp;(one-word&nbsp;receiver)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674569">tfn</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2674577">unsafe</span><span class="op" id="2674583">.</span><span class="ident" id="2674584">Pointer</span>&nbsp;<span class="comment" id="2674592">//&nbsp;fn&nbsp;used&nbsp;for&nbsp;normal&nbsp;method&nbsp;call</span><br>
<span class="lineno"></span><span class="op" id="2674626">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="2674629">//&nbsp;uncommonType&nbsp;is&nbsp;present&nbsp;only&nbsp;for&nbsp;types&nbsp;with&nbsp;names&nbsp;or&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="2674693">//&nbsp;(if&nbsp;T&nbsp;is&nbsp;a&nbsp;named&nbsp;type,&nbsp;the&nbsp;uncommonTypes&nbsp;for&nbsp;T&nbsp;and&nbsp;*T&nbsp;have&nbsp;methods).</span><br>
<span class="lineno"></span><span class="comment" id="2674765">//&nbsp;Using&nbsp;a&nbsp;pointer&nbsp;to&nbsp;this&nbsp;struct&nbsp;reduces&nbsp;the&nbsp;overall&nbsp;size&nbsp;required</span><br>
<span class="lineno"></span><span class="comment" id="2674833">//&nbsp;to&nbsp;describe&nbsp;an&nbsp;unnamed&nbsp;type&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno">285</span><span class="keyword" id="2674881">type</span>&nbsp;<span class="ident" id="2674886">uncommonType</span>&nbsp;<span class="keyword" id="2674899">struct</span>&nbsp;<span class="op" id="2674906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674909">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2674917">*</span><span class="builtintype" id="2674918">string</span>&nbsp;&nbsp;<span class="comment" id="2674926">//&nbsp;name&nbsp;of&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2674943">pkgPath</span>&nbsp;<span class="op" id="2674951">*</span><span class="builtintype" id="2674952">string</span>&nbsp;&nbsp;<span class="comment" id="2674960">//&nbsp;import&nbsp;path;&nbsp;nil&nbsp;for&nbsp;built-in&nbsp;types&nbsp;like&nbsp;int,&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675017">methods</span>&nbsp;<span class="op" id="2675025">[</span><span class="op" id="2675026">]</span><span class="ident" id="2675027">method</span>&nbsp;<span class="comment" id="2675034">//&nbsp;methods&nbsp;associated&nbsp;with&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2675066">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="2675069">//&nbsp;ChanDir&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type&#39;s&nbsp;direction.</span><br>
<span class="lineno"></span><span class="keyword" id="2675119">type</span>&nbsp;<span class="ident" id="2675124">ChanDir</span>&nbsp;<span class="builtintype" id="2675132">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2675137">const</span>&nbsp;<span class="op" id="2675143">(</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675146">RecvDir</span>&nbsp;<span class="ident" id="2675154">ChanDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2675174">=</span>&nbsp;<span class="num" id="2675176">1</span>&nbsp;<span class="op" id="2675178">&lt;&lt;</span>&nbsp;<span class="ident" id="2675181">iota</span>&nbsp;<span class="comment" id="2675186">//&nbsp;&lt;-chan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675197">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675237">//&nbsp;chan&lt;-</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675248">BothDir</span>&nbsp;<span class="op" id="2675256">=</span>&nbsp;<span class="ident" id="2675258">RecvDir</span>&nbsp;<span class="op" id="2675266">|</span>&nbsp;<span class="ident" id="2675268">SendDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675288">//&nbsp;chan</span><br>
<span class="lineno"></span><span class="op" id="2675296">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="2675299">//&nbsp;arrayType&nbsp;represents&nbsp;a&nbsp;fixed&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2675343">type</span>&nbsp;<span class="ident" id="2675348">arrayType</span>&nbsp;<span class="keyword" id="2675358">struct</span>&nbsp;<span class="op" id="2675365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675368">rtype</span>&nbsp;<span class="string" id="2675374">`reflect:&#34;array&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675393">elem</span>&nbsp;&nbsp;<span class="op" id="2675399">*</span><span class="ident" id="2675400">rtype</span>&nbsp;<span class="comment" id="2675406">//&nbsp;array&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675429">slice</span>&nbsp;<span class="op" id="2675435">*</span><span class="ident" id="2675436">rtype</span>&nbsp;<span class="comment" id="2675442">//&nbsp;slice&nbsp;type</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2675457">len</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2675463">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2675471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2675474">//&nbsp;chanType&nbsp;represents&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2675513">type</span>&nbsp;<span class="ident" id="2675518">chanType</span>&nbsp;<span class="keyword" id="2675527">struct</span>&nbsp;<span class="op" id="2675534">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675537">rtype</span>&nbsp;<span class="string" id="2675543">`reflect:&#34;chan&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675561">elem</span>&nbsp;&nbsp;<span class="op" id="2675567">*</span><span class="ident" id="2675568">rtype</span>&nbsp;&nbsp;<span class="comment" id="2675575">//&nbsp;channel&nbsp;element&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675600">dir</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2675606">uintptr</span>&nbsp;<span class="comment" id="2675614">//&nbsp;channel&nbsp;direction&nbsp;(ChanDir)</span><br>
<span class="lineno"></span><span class="op" id="2675645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="comment" id="2675648">//&nbsp;funcType&nbsp;represents&nbsp;a&nbsp;function&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2675688">type</span>&nbsp;<span class="ident" id="2675693">funcType</span>&nbsp;<span class="keyword" id="2675702">struct</span>&nbsp;<span class="op" id="2675709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675712">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2675722">`reflect:&#34;func&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675740">dotdotdot</span>&nbsp;<span class="builtintype" id="2675750">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2675759">//&nbsp;last&nbsp;input&nbsp;parameter&nbsp;is&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675791">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2675801">[</span><span class="op" id="2675802">]</span><span class="op" id="2675803">*</span><span class="ident" id="2675804">rtype</span>&nbsp;<span class="comment" id="2675810">//&nbsp;input&nbsp;parameter&nbsp;types</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675836">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2675846">[</span><span class="op" id="2675847">]</span><span class="op" id="2675848">*</span><span class="ident" id="2675849">rtype</span>&nbsp;<span class="comment" id="2675855">//&nbsp;output&nbsp;parameter&nbsp;types</span><br>
<span class="lineno"></span><span class="op" id="2675881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2675884">//&nbsp;imethod&nbsp;represents&nbsp;a&nbsp;method&nbsp;on&nbsp;an&nbsp;interface&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="2675936">type</span>&nbsp;<span class="ident" id="2675941">imethod</span>&nbsp;<span class="keyword" id="2675949">struct</span>&nbsp;<span class="op" id="2675956">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675959">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2675967">*</span><span class="builtintype" id="2675968">string</span>&nbsp;<span class="comment" id="2675975">//&nbsp;name&nbsp;of&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2675994">pkgPath</span>&nbsp;<span class="op" id="2676002">*</span><span class="builtintype" id="2676003">string</span>&nbsp;<span class="comment" id="2676010">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676060">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2676068">*</span><span class="ident" id="2676069">rtype</span>&nbsp;&nbsp;<span class="comment" id="2676076">//&nbsp;.(*FuncType)&nbsp;underneath</span><br>
<span class="lineno"></span><span class="op" id="2676103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="comment" id="2676106">//&nbsp;interfaceType&nbsp;represents&nbsp;an&nbsp;interface&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2676153">type</span>&nbsp;<span class="ident" id="2676158">interfaceType</span>&nbsp;<span class="keyword" id="2676172">struct</span>&nbsp;<span class="op" id="2676179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676182">rtype</span>&nbsp;&nbsp;&nbsp;<span class="string" id="2676190">`reflect:&#34;interface&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676213">methods</span>&nbsp;<span class="op" id="2676221">[</span><span class="op" id="2676222">]</span><span class="ident" id="2676223">imethod</span>&nbsp;<span class="comment" id="2676231">//&nbsp;sorted&nbsp;by&nbsp;hash</span><br>
<span class="lineno"></span><span class="op" id="2676249">}</span><br>
<span class="lineno">335</span><br>
<span class="lineno"></span><span class="comment" id="2676252">//&nbsp;mapType&nbsp;represents&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2676286">type</span>&nbsp;<span class="ident" id="2676291">mapType</span>&nbsp;<span class="keyword" id="2676299">struct</span>&nbsp;<span class="op" id="2676306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676309">rtype</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2676323">`reflect:&#34;map&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676340">key</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2676354">*</span><span class="ident" id="2676355">rtype</span>&nbsp;<span class="comment" id="2676361">//&nbsp;map&nbsp;key&nbsp;type</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676378">elem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2676392">*</span><span class="ident" id="2676393">rtype</span>&nbsp;<span class="comment" id="2676399">//&nbsp;map&nbsp;element&nbsp;(value)&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676428">bucket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2676442">*</span><span class="ident" id="2676443">rtype</span>&nbsp;<span class="comment" id="2676449">//&nbsp;internal&nbsp;bucket&nbsp;structure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676479">hmap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2676493">*</span><span class="ident" id="2676494">rtype</span>&nbsp;<span class="comment" id="2676500">//&nbsp;internal&nbsp;map&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676524">keysize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2676538">uint8</span>&nbsp;&nbsp;<span class="comment" id="2676545">//&nbsp;size&nbsp;of&nbsp;key&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676566">indirectkey</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2676580">uint8</span>&nbsp;&nbsp;<span class="comment" id="2676587">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;key&nbsp;instead&nbsp;of&nbsp;key&nbsp;itself</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676630">valuesize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2676644">uint8</span>&nbsp;&nbsp;<span class="comment" id="2676651">//&nbsp;size&nbsp;of&nbsp;value&nbsp;slot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676674">indirectvalue</span>&nbsp;<span class="builtintype" id="2676688">uint8</span>&nbsp;&nbsp;<span class="comment" id="2676695">//&nbsp;store&nbsp;ptr&nbsp;to&nbsp;value&nbsp;instead&nbsp;of&nbsp;value&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676742">bucketsize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2676756">uint16</span>&nbsp;<span class="comment" id="2676763">//&nbsp;size&nbsp;of&nbsp;bucket</span><br>
<span class="lineno"></span><span class="op" id="2676781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="2676784">//&nbsp;ptrType&nbsp;represents&nbsp;a&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2676822">type</span>&nbsp;<span class="ident" id="2676827">ptrType</span>&nbsp;<span class="keyword" id="2676835">struct</span>&nbsp;<span class="op" id="2676842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676845">rtype</span>&nbsp;<span class="string" id="2676851">`reflect:&#34;ptr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676868">elem</span>&nbsp;&nbsp;<span class="op" id="2676874">*</span><span class="ident" id="2676875">rtype</span>&nbsp;<span class="comment" id="2676881">//&nbsp;pointer&nbsp;element&nbsp;(pointed&nbsp;at)&nbsp;type</span><br>
<span class="lineno"></span><span class="op" id="2676918">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="2676921">//&nbsp;sliceType&nbsp;represents&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2676959">type</span>&nbsp;<span class="ident" id="2676964">sliceType</span>&nbsp;<span class="keyword" id="2676974">struct</span>&nbsp;<span class="op" id="2676981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2676984">rtype</span>&nbsp;<span class="string" id="2676990">`reflect:&#34;slice&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677009">elem</span>&nbsp;&nbsp;<span class="op" id="2677015">*</span><span class="ident" id="2677016">rtype</span>&nbsp;<span class="comment" id="2677022">//&nbsp;slice&nbsp;element&nbsp;type</span><br>
<span class="lineno">360</span><span class="op" id="2677044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2677047">//&nbsp;Struct&nbsp;field</span><br>
<span class="lineno"></span><span class="keyword" id="2677063">type</span>&nbsp;<span class="ident" id="2677068">structField</span>&nbsp;<span class="keyword" id="2677080">struct</span>&nbsp;<span class="op" id="2677087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677090">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2677098">*</span><span class="builtintype" id="2677099">string</span>&nbsp;<span class="comment" id="2677106">//&nbsp;nil&nbsp;for&nbsp;embedded&nbsp;fields</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677134">pkgPath</span>&nbsp;<span class="op" id="2677142">*</span><span class="builtintype" id="2677143">string</span>&nbsp;<span class="comment" id="2677150">//&nbsp;nil&nbsp;for&nbsp;exported&nbsp;Names;&nbsp;otherwise&nbsp;import&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677200">typ</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2677208">*</span><span class="ident" id="2677209">rtype</span>&nbsp;&nbsp;<span class="comment" id="2677216">//&nbsp;type&nbsp;of&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677234">tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2677242">*</span><span class="builtintype" id="2677243">string</span>&nbsp;<span class="comment" id="2677250">//&nbsp;nil&nbsp;if&nbsp;no&nbsp;tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677268">offset</span>&nbsp;&nbsp;<span class="builtintype" id="2677276">uintptr</span>&nbsp;<span class="comment" id="2677284">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;field&nbsp;within&nbsp;struct</span><br>
<span class="lineno"></span><span class="op" id="2677322">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="2677325">//&nbsp;structType&nbsp;represents&nbsp;a&nbsp;struct&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="2677365">type</span>&nbsp;<span class="ident" id="2677370">structType</span>&nbsp;<span class="keyword" id="2677381">struct</span>&nbsp;<span class="op" id="2677388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677391">rtype</span>&nbsp;&nbsp;<span class="string" id="2677398">`reflect:&#34;struct&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2677418">fields</span>&nbsp;<span class="op" id="2677425">[</span><span class="op" id="2677426">]</span><span class="ident" id="2677427">structField</span>&nbsp;<span class="comment" id="2677439">//&nbsp;sorted&nbsp;by&nbsp;offset</span><br>
<span class="lineno">375</span><span class="op" id="2677459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2677462">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;knows&nbsp;the&nbsp;exact&nbsp;layout&nbsp;of&nbsp;all&nbsp;the&nbsp;data&nbsp;structures&nbsp;above.<br>
<span class="lineno"></span>&nbsp;*&nbsp;The&nbsp;compiler&nbsp;does&nbsp;not&nbsp;know&nbsp;about&nbsp;the&nbsp;data&nbsp;structures&nbsp;and&nbsp;methods&nbsp;below.<br>
<span class="lineno">380</span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2677618">//&nbsp;Method&nbsp;represents&nbsp;a&nbsp;single&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="2677656">type</span>&nbsp;<span class="ident" id="2677661">Method</span>&nbsp;<span class="keyword" id="2677668">struct</span>&nbsp;<span class="op" id="2677675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2677678">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;method&nbsp;name.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2677707">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2677780">//&nbsp;method&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;method&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2677850">//&nbsp;The&nbsp;combination&nbsp;of&nbsp;PkgPath&nbsp;and&nbsp;Name&nbsp;uniquely&nbsp;identifies&nbsp;a&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2677919">//&nbsp;in&nbsp;a&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2677940">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678001">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2678009">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678017">PkgPath</span>&nbsp;<span class="builtintype" id="2678025">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678034">Type</span>&nbsp;&nbsp;<span class="ident" id="2678040">Type</span>&nbsp;&nbsp;<span class="comment" id="2678046">//&nbsp;method&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678062">Func</span>&nbsp;&nbsp;<span class="ident" id="2678068">Value</span>&nbsp;<span class="comment" id="2678074">//&nbsp;func&nbsp;with&nbsp;receiver&nbsp;as&nbsp;first&nbsp;argument</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678115">Index</span>&nbsp;<span class="builtintype" id="2678121">int</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2678127">//&nbsp;index&nbsp;for&nbsp;Type.Method</span><br>
<span class="lineno"></span><span class="op" id="2678152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2678155">const</span>&nbsp;<span class="op" id="2678161">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678164">kindDirectIface</span>&nbsp;<span class="op" id="2678180">=</span>&nbsp;<span class="num" id="2678182">1</span>&nbsp;<span class="op" id="2678184">&lt;&lt;</span>&nbsp;<span class="num" id="2678187">5</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678190">kindGCProg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2678206">=</span>&nbsp;<span class="num" id="2678208">1</span>&nbsp;<span class="op" id="2678210">&lt;&lt;</span>&nbsp;<span class="num" id="2678213">6</span>&nbsp;<span class="comment" id="2678215">//&nbsp;Type.gc&nbsp;points&nbsp;to&nbsp;GC&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678248">kindNoPointers</span>&nbsp;&nbsp;<span class="op" id="2678264">=</span>&nbsp;<span class="num" id="2678266">1</span>&nbsp;<span class="op" id="2678268">&lt;&lt;</span>&nbsp;<span class="num" id="2678271">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678274">kindMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2678290">=</span>&nbsp;<span class="op" id="2678292">(</span><span class="num" id="2678293">1</span>&nbsp;<span class="op" id="2678295">&lt;&lt;</span>&nbsp;<span class="num" id="2678298">5</span><span class="op" id="2678299">)</span>&nbsp;<span class="op" id="2678301">-</span>&nbsp;<span class="num" id="2678303">1</span><br>
<span class="lineno"></span><span class="op" id="2678305">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="keyword" id="2678308">func</span>&nbsp;<span class="op" id="2678313">(</span><span class="ident" id="2678314">k</span>&nbsp;<span class="ident" id="2678316">Kind</span><span class="op" id="2678320">)</span>&nbsp;<span class="ident" id="2678322">String</span><span class="op" id="2678328">(</span><span class="op" id="2678329">)</span>&nbsp;<span class="builtintype" id="2678331">string</span>&nbsp;<span class="op" id="2678338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678341">if</span>&nbsp;<span class="builtintype" id="2678344">int</span><span class="op" id="2678347">(</span><span class="ident" id="2678348">k</span><span class="op" id="2678349">)</span>&nbsp;<span class="op" id="2678351">&lt;</span>&nbsp;<span class="builtinfunc" id="2678353">len</span><span class="op" id="2678356">(</span><span class="ident" id="2678357">kindNames</span><span class="op" id="2678366">)</span>&nbsp;<span class="op" id="2678368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678372">return</span>&nbsp;<span class="ident" id="2678379">kindNames</span><span class="op" id="2678388">[</span><span class="ident" id="2678389">k</span><span class="op" id="2678390">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2678393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2678396">return</span>&nbsp;<span class="string" id="2678403">&#34;kind&#34;</span>&nbsp;<span class="op" id="2678410">+</span>&nbsp;<span class="ident" id="2678412">strconv</span><span class="op" id="2678419">.</span><span class="ident" id="2678420">Itoa</span><span class="op" id="2678424">(</span><span class="builtintype" id="2678425">int</span><span class="op" id="2678428">(</span><span class="ident" id="2678429">k</span><span class="op" id="2678430">)</span><span class="op" id="2678431">)</span><br>
<span class="lineno">410</span><span class="op" id="2678433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2678436">var</span>&nbsp;<span class="ident" id="2678440">kindNames</span>&nbsp;<span class="op" id="2678450">=</span>&nbsp;<span class="op" id="2678452">[</span><span class="op" id="2678453">]</span><span class="builtintype" id="2678454">string</span><span class="op" id="2678460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678463">Invalid</span><span class="op" id="2678470">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678478">&#34;invalid&#34;</span><span class="op" id="2678487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678490">Bool</span><span class="op" id="2678494">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678505">&#34;bool&#34;</span><span class="op" id="2678511">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678514">Int</span><span class="op" id="2678517">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678529">&#34;int&#34;</span><span class="op" id="2678534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678537">Int8</span><span class="op" id="2678541">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678552">&#34;int8&#34;</span><span class="op" id="2678558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678561">Int16</span><span class="op" id="2678566">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678576">&#34;int16&#34;</span><span class="op" id="2678583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678586">Int32</span><span class="op" id="2678591">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678601">&#34;int32&#34;</span><span class="op" id="2678608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678611">Int64</span><span class="op" id="2678616">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678626">&#34;int64&#34;</span><span class="op" id="2678633">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678636">Uint</span><span class="op" id="2678640">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678651">&#34;uint&#34;</span><span class="op" id="2678657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678660">Uint8</span><span class="op" id="2678665">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678675">&#34;uint8&#34;</span><span class="op" id="2678682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678685">Uint16</span><span class="op" id="2678691">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678700">&#34;uint16&#34;</span><span class="op" id="2678708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678711">Uint32</span><span class="op" id="2678717">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678726">&#34;uint32&#34;</span><span class="op" id="2678734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678737">Uint64</span><span class="op" id="2678743">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678752">&#34;uint64&#34;</span><span class="op" id="2678760">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678763">Uintptr</span><span class="op" id="2678770">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678778">&#34;uintptr&#34;</span><span class="op" id="2678787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678790">Float32</span><span class="op" id="2678797">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678805">&#34;float32&#34;</span><span class="op" id="2678814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678817">Float64</span><span class="op" id="2678824">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678832">&#34;float64&#34;</span><span class="op" id="2678841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678844">Complex64</span><span class="op" id="2678853">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678859">&#34;complex64&#34;</span><span class="op" id="2678870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678873">Complex128</span><span class="op" id="2678883">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678888">&#34;complex128&#34;</span><span class="op" id="2678900">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678903">Array</span><span class="op" id="2678908">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678918">&#34;array&#34;</span><span class="op" id="2678925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678928">Chan</span><span class="op" id="2678932">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678943">&#34;chan&#34;</span><span class="op" id="2678949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678952">Func</span><span class="op" id="2678956">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678967">&#34;func&#34;</span><span class="op" id="2678973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2678976">Interface</span><span class="op" id="2678985">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2678991">&#34;interface&#34;</span><span class="op" id="2679002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679005">Map</span><span class="op" id="2679008">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2679020">&#34;map&#34;</span><span class="op" id="2679025">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679028">Ptr</span><span class="op" id="2679031">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2679043">&#34;ptr&#34;</span><span class="op" id="2679048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679051">Slice</span><span class="op" id="2679056">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2679066">&#34;slice&#34;</span><span class="op" id="2679073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679076">String</span><span class="op" id="2679082">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2679091">&#34;string&#34;</span><span class="op" id="2679099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679102">Struct</span><span class="op" id="2679108">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2679117">&#34;struct&#34;</span><span class="op" id="2679125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679128">UnsafePointer</span><span class="op" id="2679141">:</span>&nbsp;<span class="string" id="2679143">&#34;unsafe.Pointer&#34;</span><span class="op" id="2679159">,</span><br>
<span class="lineno">440</span><span class="op" id="2679161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679164">func</span>&nbsp;<span class="op" id="2679169">(</span><span class="ident" id="2679170">t</span>&nbsp;<span class="op" id="2679172">*</span><span class="ident" id="2679173">uncommonType</span><span class="op" id="2679185">)</span>&nbsp;<span class="ident" id="2679187">uncommon</span><span class="op" id="2679195">(</span><span class="op" id="2679196">)</span>&nbsp;<span class="op" id="2679198">*</span><span class="ident" id="2679199">uncommonType</span>&nbsp;<span class="op" id="2679212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679215">return</span>&nbsp;<span class="ident" id="2679222">t</span><br>
<span class="lineno"></span><span class="op" id="2679224">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="2679227">func</span>&nbsp;<span class="op" id="2679232">(</span><span class="ident" id="2679233">t</span>&nbsp;<span class="op" id="2679235">*</span><span class="ident" id="2679236">uncommonType</span><span class="op" id="2679248">)</span>&nbsp;<span class="ident" id="2679250">PkgPath</span><span class="op" id="2679257">(</span><span class="op" id="2679258">)</span>&nbsp;<span class="builtintype" id="2679260">string</span>&nbsp;<span class="op" id="2679267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679270">if</span>&nbsp;<span class="ident" id="2679273">t</span>&nbsp;<span class="op" id="2679275">==</span>&nbsp;<span class="ident" id="2679278">nil</span>&nbsp;<span class="op" id="2679282">||</span>&nbsp;<span class="ident" id="2679285">t</span><span class="op" id="2679286">.</span><span class="ident" id="2679287">pkgPath</span>&nbsp;<span class="op" id="2679295">==</span>&nbsp;<span class="ident" id="2679298">nil</span>&nbsp;<span class="op" id="2679302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679306">return</span>&nbsp;<span class="string" id="2679313">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2679317">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679320">return</span>&nbsp;<span class="op" id="2679327">*</span><span class="ident" id="2679328">t</span><span class="op" id="2679329">.</span><span class="ident" id="2679330">pkgPath</span><br>
<span class="lineno"></span><span class="op" id="2679338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679341">func</span>&nbsp;<span class="op" id="2679346">(</span><span class="ident" id="2679347">t</span>&nbsp;<span class="op" id="2679349">*</span><span class="ident" id="2679350">uncommonType</span><span class="op" id="2679362">)</span>&nbsp;<span class="ident" id="2679364">Name</span><span class="op" id="2679368">(</span><span class="op" id="2679369">)</span>&nbsp;<span class="builtintype" id="2679371">string</span>&nbsp;<span class="op" id="2679378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679381">if</span>&nbsp;<span class="ident" id="2679384">t</span>&nbsp;<span class="op" id="2679386">==</span>&nbsp;<span class="ident" id="2679389">nil</span>&nbsp;<span class="op" id="2679393">||</span>&nbsp;<span class="ident" id="2679396">t</span><span class="op" id="2679397">.</span><span class="ident" id="2679398">name</span>&nbsp;<span class="op" id="2679403">==</span>&nbsp;<span class="ident" id="2679406">nil</span>&nbsp;<span class="op" id="2679410">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679414">return</span>&nbsp;<span class="string" id="2679421">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2679425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679428">return</span>&nbsp;<span class="op" id="2679435">*</span><span class="ident" id="2679436">t</span><span class="op" id="2679437">.</span><span class="ident" id="2679438">name</span><br>
<span class="lineno"></span><span class="op" id="2679443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="2679446">func</span>&nbsp;<span class="op" id="2679451">(</span><span class="ident" id="2679452">t</span>&nbsp;<span class="op" id="2679454">*</span><span class="ident" id="2679455">rtype</span><span class="op" id="2679460">)</span>&nbsp;<span class="ident" id="2679462">String</span><span class="op" id="2679468">(</span><span class="op" id="2679469">)</span>&nbsp;<span class="builtintype" id="2679471">string</span>&nbsp;<span class="op" id="2679478">{</span>&nbsp;<span class="keyword" id="2679480">return</span>&nbsp;<span class="op" id="2679487">*</span><span class="ident" id="2679488">t</span><span class="op" id="2679489">.</span><span class="builtintype" id="2679490">string</span>&nbsp;<span class="op" id="2679497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679500">func</span>&nbsp;<span class="op" id="2679505">(</span><span class="ident" id="2679506">t</span>&nbsp;<span class="op" id="2679508">*</span><span class="ident" id="2679509">rtype</span><span class="op" id="2679514">)</span>&nbsp;<span class="ident" id="2679516">Size</span><span class="op" id="2679520">(</span><span class="op" id="2679521">)</span>&nbsp;<span class="builtintype" id="2679523">uintptr</span>&nbsp;<span class="op" id="2679531">{</span>&nbsp;<span class="keyword" id="2679533">return</span>&nbsp;<span class="ident" id="2679540">t</span><span class="op" id="2679541">.</span><span class="ident" id="2679542">size</span>&nbsp;<span class="op" id="2679547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679550">func</span>&nbsp;<span class="op" id="2679555">(</span><span class="ident" id="2679556">t</span>&nbsp;<span class="op" id="2679558">*</span><span class="ident" id="2679559">rtype</span><span class="op" id="2679564">)</span>&nbsp;<span class="ident" id="2679566">Bits</span><span class="op" id="2679570">(</span><span class="op" id="2679571">)</span>&nbsp;<span class="builtintype" id="2679573">int</span>&nbsp;<span class="op" id="2679577">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679580">if</span>&nbsp;<span class="ident" id="2679583">t</span>&nbsp;<span class="op" id="2679585">==</span>&nbsp;<span class="ident" id="2679588">nil</span>&nbsp;<span class="op" id="2679592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2679596">panic</span><span class="op" id="2679601">(</span><span class="string" id="2679602">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;nil&nbsp;Type&#34;</span><span class="op" id="2679629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2679632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2679635">k</span>&nbsp;<span class="op" id="2679637">:=</span>&nbsp;<span class="ident" id="2679640">t</span><span class="op" id="2679641">.</span><span class="ident" id="2679642">Kind</span><span class="op" id="2679646">(</span><span class="op" id="2679647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679650">if</span>&nbsp;<span class="ident" id="2679653">k</span>&nbsp;<span class="op" id="2679655">&lt;</span>&nbsp;<span class="ident" id="2679657">Int</span>&nbsp;<span class="op" id="2679661">||</span>&nbsp;<span class="ident" id="2679664">k</span>&nbsp;<span class="op" id="2679666">&gt;</span>&nbsp;<span class="ident" id="2679668">Complex128</span>&nbsp;<span class="op" id="2679679">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2679683">panic</span><span class="op" id="2679688">(</span><span class="string" id="2679689">&#34;reflect:&nbsp;Bits&nbsp;of&nbsp;non-arithmetic&nbsp;Type&nbsp;&#34;</span>&nbsp;<span class="op" id="2679729">+</span>&nbsp;<span class="ident" id="2679731">t</span><span class="op" id="2679732">.</span><span class="ident" id="2679733">String</span><span class="op" id="2679739">(</span><span class="op" id="2679740">)</span><span class="op" id="2679741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2679744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2679747">return</span>&nbsp;<span class="builtintype" id="2679754">int</span><span class="op" id="2679757">(</span><span class="ident" id="2679758">t</span><span class="op" id="2679759">.</span><span class="ident" id="2679760">size</span><span class="op" id="2679764">)</span>&nbsp;<span class="op" id="2679766">*</span>&nbsp;<span class="num" id="2679768">8</span><br>
<span class="lineno"></span><span class="op" id="2679770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span><span class="keyword" id="2679773">func</span>&nbsp;<span class="op" id="2679778">(</span><span class="ident" id="2679779">t</span>&nbsp;<span class="op" id="2679781">*</span><span class="ident" id="2679782">rtype</span><span class="op" id="2679787">)</span>&nbsp;<span class="ident" id="2679789">Align</span><span class="op" id="2679794">(</span><span class="op" id="2679795">)</span>&nbsp;<span class="builtintype" id="2679797">int</span>&nbsp;<span class="op" id="2679801">{</span>&nbsp;<span class="keyword" id="2679803">return</span>&nbsp;<span class="builtintype" id="2679810">int</span><span class="op" id="2679813">(</span><span class="ident" id="2679814">t</span><span class="op" id="2679815">.</span><span class="ident" id="2679816">align</span><span class="op" id="2679821">)</span>&nbsp;<span class="op" id="2679823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679826">func</span>&nbsp;<span class="op" id="2679831">(</span><span class="ident" id="2679832">t</span>&nbsp;<span class="op" id="2679834">*</span><span class="ident" id="2679835">rtype</span><span class="op" id="2679840">)</span>&nbsp;<span class="ident" id="2679842">FieldAlign</span><span class="op" id="2679852">(</span><span class="op" id="2679853">)</span>&nbsp;<span class="builtintype" id="2679855">int</span>&nbsp;<span class="op" id="2679859">{</span>&nbsp;<span class="keyword" id="2679861">return</span>&nbsp;<span class="builtintype" id="2679868">int</span><span class="op" id="2679871">(</span><span class="ident" id="2679872">t</span><span class="op" id="2679873">.</span><span class="ident" id="2679874">fieldAlign</span><span class="op" id="2679884">)</span>&nbsp;<span class="op" id="2679886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2679889">func</span>&nbsp;<span class="op" id="2679894">(</span><span class="ident" id="2679895">t</span>&nbsp;<span class="op" id="2679897">*</span><span class="ident" id="2679898">rtype</span><span class="op" id="2679903">)</span>&nbsp;<span class="ident" id="2679905">Kind</span><span class="op" id="2679909">(</span><span class="op" id="2679910">)</span>&nbsp;<span class="ident" id="2679912">Kind</span>&nbsp;<span class="op" id="2679917">{</span>&nbsp;<span class="keyword" id="2679919">return</span>&nbsp;<span class="ident" id="2679926">Kind</span><span class="op" id="2679930">(</span><span class="ident" id="2679931">t</span><span class="op" id="2679932">.</span><span class="ident" id="2679933">kind</span>&nbsp;<span class="op" id="2679938">&amp;</span>&nbsp;<span class="ident" id="2679940">kindMask</span><span class="op" id="2679948">)</span>&nbsp;<span class="op" id="2679950">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="keyword" id="2679953">func</span>&nbsp;<span class="op" id="2679958">(</span><span class="ident" id="2679959">t</span>&nbsp;<span class="op" id="2679961">*</span><span class="ident" id="2679962">rtype</span><span class="op" id="2679967">)</span>&nbsp;<span class="ident" id="2679969">pointers</span><span class="op" id="2679977">(</span><span class="op" id="2679978">)</span>&nbsp;<span class="builtintype" id="2679980">bool</span>&nbsp;<span class="op" id="2679985">{</span>&nbsp;<span class="keyword" id="2679987">return</span>&nbsp;<span class="ident" id="2679994">t</span><span class="op" id="2679995">.</span><span class="ident" id="2679996">kind</span><span class="op" id="2680000">&amp;</span><span class="ident" id="2680001">kindNoPointers</span>&nbsp;<span class="op" id="2680016">==</span>&nbsp;<span class="num" id="2680019">0</span>&nbsp;<span class="op" id="2680021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2680024">func</span>&nbsp;<span class="op" id="2680029">(</span><span class="ident" id="2680030">t</span>&nbsp;<span class="op" id="2680032">*</span><span class="ident" id="2680033">rtype</span><span class="op" id="2680038">)</span>&nbsp;<span class="ident" id="2680040">common</span><span class="op" id="2680046">(</span><span class="op" id="2680047">)</span>&nbsp;<span class="op" id="2680049">*</span><span class="ident" id="2680050">rtype</span>&nbsp;<span class="op" id="2680056">{</span>&nbsp;<span class="keyword" id="2680058">return</span>&nbsp;<span class="ident" id="2680065">t</span>&nbsp;<span class="op" id="2680067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="keyword" id="2680070">func</span>&nbsp;<span class="op" id="2680075">(</span><span class="ident" id="2680076">t</span>&nbsp;<span class="op" id="2680078">*</span><span class="ident" id="2680079">uncommonType</span><span class="op" id="2680091">)</span>&nbsp;<span class="ident" id="2680093">Method</span><span class="op" id="2680099">(</span><span class="ident" id="2680100">i</span>&nbsp;<span class="builtintype" id="2680102">int</span><span class="op" id="2680105">)</span>&nbsp;<span class="op" id="2680107">(</span><span class="ident" id="2680108">m</span>&nbsp;<span class="ident" id="2680110">Method</span><span class="op" id="2680116">)</span>&nbsp;<span class="op" id="2680118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680121">if</span>&nbsp;<span class="ident" id="2680124">t</span>&nbsp;<span class="op" id="2680126">==</span>&nbsp;<span class="ident" id="2680129">nil</span>&nbsp;<span class="op" id="2680133">||</span>&nbsp;<span class="ident" id="2680136">i</span>&nbsp;<span class="op" id="2680138">&lt;</span>&nbsp;<span class="num" id="2680140">0</span>&nbsp;<span class="op" id="2680142">||</span>&nbsp;<span class="ident" id="2680145">i</span>&nbsp;<span class="op" id="2680147">&gt;=</span>&nbsp;<span class="builtinfunc" id="2680150">len</span><span class="op" id="2680153">(</span><span class="ident" id="2680154">t</span><span class="op" id="2680155">.</span><span class="ident" id="2680156">methods</span><span class="op" id="2680163">)</span>&nbsp;<span class="op" id="2680165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2680169">panic</span><span class="op" id="2680174">(</span><span class="string" id="2680175">&#34;reflect:&nbsp;Method&nbsp;index&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="2680211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680217">p</span>&nbsp;<span class="op" id="2680219">:=</span>&nbsp;<span class="op" id="2680222">&amp;</span><span class="ident" id="2680223">t</span><span class="op" id="2680224">.</span><span class="ident" id="2680225">methods</span><span class="op" id="2680232">[</span><span class="ident" id="2680233">i</span><span class="op" id="2680234">]</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680237">if</span>&nbsp;<span class="ident" id="2680240">p</span><span class="op" id="2680241">.</span><span class="ident" id="2680242">name</span>&nbsp;<span class="op" id="2680247">!=</span>&nbsp;<span class="ident" id="2680250">nil</span>&nbsp;<span class="op" id="2680254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680258">m</span><span class="op" id="2680259">.</span><span class="ident" id="2680260">Name</span>&nbsp;<span class="op" id="2680265">=</span>&nbsp;<span class="op" id="2680267">*</span><span class="ident" id="2680268">p</span><span class="op" id="2680269">.</span><span class="ident" id="2680270">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680279">fl</span>&nbsp;<span class="op" id="2680282">:=</span>&nbsp;<span class="ident" id="2680285">flag</span><span class="op" id="2680289">(</span><span class="ident" id="2680290">Func</span><span class="op" id="2680294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680297">if</span>&nbsp;<span class="ident" id="2680300">p</span><span class="op" id="2680301">.</span><span class="ident" id="2680302">pkgPath</span>&nbsp;<span class="op" id="2680310">!=</span>&nbsp;<span class="ident" id="2680313">nil</span>&nbsp;<span class="op" id="2680317">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680321">m</span><span class="op" id="2680322">.</span><span class="ident" id="2680323">PkgPath</span>&nbsp;<span class="op" id="2680331">=</span>&nbsp;<span class="op" id="2680333">*</span><span class="ident" id="2680334">p</span><span class="op" id="2680335">.</span><span class="ident" id="2680336">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680346">fl</span>&nbsp;<span class="op" id="2680349">|=</span>&nbsp;<span class="ident" id="2680352">flagRO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680363">mt</span>&nbsp;<span class="op" id="2680366">:=</span>&nbsp;<span class="ident" id="2680369">p</span><span class="op" id="2680370">.</span><span class="ident" id="2680371">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680376">m</span><span class="op" id="2680377">.</span><span class="ident" id="2680378">Type</span>&nbsp;<span class="op" id="2680383">=</span>&nbsp;<span class="ident" id="2680385">mt</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680389">fn</span>&nbsp;<span class="op" id="2680392">:=</span>&nbsp;<span class="ident" id="2680395">unsafe</span><span class="op" id="2680401">.</span><span class="ident" id="2680402">Pointer</span><span class="op" id="2680409">(</span><span class="op" id="2680410">&amp;</span><span class="ident" id="2680411">p</span><span class="op" id="2680412">.</span><span class="ident" id="2680413">tfn</span><span class="op" id="2680416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680419">m</span><span class="op" id="2680420">.</span><span class="ident" id="2680421">Func</span>&nbsp;<span class="op" id="2680426">=</span>&nbsp;<span class="ident" id="2680428">Value</span><span class="op" id="2680433">{</span><span class="ident" id="2680434">mt</span><span class="op" id="2680436">,</span>&nbsp;<span class="ident" id="2680438">fn</span><span class="op" id="2680440">,</span>&nbsp;<span class="ident" id="2680442">fl</span><span class="op" id="2680444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680447">m</span><span class="op" id="2680448">.</span><span class="ident" id="2680449">Index</span>&nbsp;<span class="op" id="2680455">=</span>&nbsp;<span class="ident" id="2680457">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680460">return</span><br>
<span class="lineno"></span><span class="op" id="2680467">}</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="keyword" id="2680470">func</span>&nbsp;<span class="op" id="2680475">(</span><span class="ident" id="2680476">t</span>&nbsp;<span class="op" id="2680478">*</span><span class="ident" id="2680479">uncommonType</span><span class="op" id="2680491">)</span>&nbsp;<span class="ident" id="2680493">NumMethod</span><span class="op" id="2680502">(</span><span class="op" id="2680503">)</span>&nbsp;<span class="builtintype" id="2680505">int</span>&nbsp;<span class="op" id="2680509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680512">if</span>&nbsp;<span class="ident" id="2680515">t</span>&nbsp;<span class="op" id="2680517">==</span>&nbsp;<span class="ident" id="2680520">nil</span>&nbsp;<span class="op" id="2680524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680528">return</span>&nbsp;<span class="num" id="2680535">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680538">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680541">return</span>&nbsp;<span class="builtinfunc" id="2680548">len</span><span class="op" id="2680551">(</span><span class="ident" id="2680552">t</span><span class="op" id="2680553">.</span><span class="ident" id="2680554">methods</span><span class="op" id="2680561">)</span><br>
<span class="lineno"></span><span class="op" id="2680563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2680566">func</span>&nbsp;<span class="op" id="2680571">(</span><span class="ident" id="2680572">t</span>&nbsp;<span class="op" id="2680574">*</span><span class="ident" id="2680575">uncommonType</span><span class="op" id="2680587">)</span>&nbsp;<span class="ident" id="2680589">MethodByName</span><span class="op" id="2680601">(</span><span class="ident" id="2680602">name</span>&nbsp;<span class="builtintype" id="2680607">string</span><span class="op" id="2680613">)</span>&nbsp;<span class="op" id="2680615">(</span><span class="ident" id="2680616">m</span>&nbsp;<span class="ident" id="2680618">Method</span><span class="op" id="2680624">,</span>&nbsp;<span class="ident" id="2680626">ok</span>&nbsp;<span class="builtintype" id="2680629">bool</span><span class="op" id="2680633">)</span>&nbsp;<span class="op" id="2680635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680638">if</span>&nbsp;<span class="ident" id="2680641">t</span>&nbsp;<span class="op" id="2680643">==</span>&nbsp;<span class="ident" id="2680646">nil</span>&nbsp;<span class="op" id="2680650">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680654">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680665">var</span>&nbsp;<span class="ident" id="2680669">p</span>&nbsp;<span class="op" id="2680671">*</span><span class="ident" id="2680672">method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680680">for</span>&nbsp;<span class="ident" id="2680684">i</span>&nbsp;<span class="op" id="2680686">:=</span>&nbsp;<span class="keyword" id="2680689">range</span>&nbsp;<span class="ident" id="2680695">t</span><span class="op" id="2680696">.</span><span class="ident" id="2680697">methods</span>&nbsp;<span class="op" id="2680705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2680709">p</span>&nbsp;<span class="op" id="2680711">=</span>&nbsp;<span class="op" id="2680713">&amp;</span><span class="ident" id="2680714">t</span><span class="op" id="2680715">.</span><span class="ident" id="2680716">methods</span><span class="op" id="2680723">[</span><span class="ident" id="2680724">i</span><span class="op" id="2680725">]</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680729">if</span>&nbsp;<span class="ident" id="2680732">p</span><span class="op" id="2680733">.</span><span class="ident" id="2680734">name</span>&nbsp;<span class="op" id="2680739">!=</span>&nbsp;<span class="ident" id="2680742">nil</span>&nbsp;<span class="op" id="2680746">&amp;&amp;</span>&nbsp;<span class="op" id="2680749">*</span><span class="ident" id="2680750">p</span><span class="op" id="2680751">.</span><span class="ident" id="2680752">name</span>&nbsp;<span class="op" id="2680757">==</span>&nbsp;<span class="ident" id="2680760">name</span>&nbsp;<span class="op" id="2680765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680770">return</span>&nbsp;<span class="ident" id="2680777">t</span><span class="op" id="2680778">.</span><span class="ident" id="2680779">Method</span><span class="op" id="2680785">(</span><span class="ident" id="2680786">i</span><span class="op" id="2680787">)</span><span class="op" id="2680788">,</span>&nbsp;<span class="builtintype" id="2680790">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2680800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680803">return</span><br>
<span class="lineno">525</span><span class="op" id="2680810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2680813">//&nbsp;TODO(rsc):&nbsp;6g&nbsp;supplies&nbsp;these,&nbsp;but&nbsp;they&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2680863">//&nbsp;as&nbsp;efficient&nbsp;as&nbsp;they&nbsp;could&nbsp;be:&nbsp;they&nbsp;have&nbsp;commonType</span><br>
<span class="lineno"></span><span class="comment" id="2680918">//&nbsp;as&nbsp;the&nbsp;receiver&nbsp;instead&nbsp;of&nbsp;*rtype.</span><br>
<span class="lineno">530</span><span class="keyword" id="2680956">func</span>&nbsp;<span class="op" id="2680961">(</span><span class="ident" id="2680962">t</span>&nbsp;<span class="op" id="2680964">*</span><span class="ident" id="2680965">rtype</span><span class="op" id="2680970">)</span>&nbsp;<span class="ident" id="2680972">NumMethod</span><span class="op" id="2680981">(</span><span class="op" id="2680982">)</span>&nbsp;<span class="builtintype" id="2680984">int</span>&nbsp;<span class="op" id="2680988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2680991">if</span>&nbsp;<span class="ident" id="2680994">t</span><span class="op" id="2680995">.</span><span class="ident" id="2680996">Kind</span><span class="op" id="2681000">(</span><span class="op" id="2681001">)</span>&nbsp;<span class="op" id="2681003">==</span>&nbsp;<span class="ident" id="2681006">Interface</span>&nbsp;<span class="op" id="2681016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681020">tt</span>&nbsp;<span class="op" id="2681023">:=</span>&nbsp;<span class="op" id="2681026">(</span><span class="op" id="2681027">*</span><span class="ident" id="2681028">interfaceType</span><span class="op" id="2681041">)</span><span class="op" id="2681042">(</span><span class="ident" id="2681043">unsafe</span><span class="op" id="2681049">.</span><span class="ident" id="2681050">Pointer</span><span class="op" id="2681057">(</span><span class="ident" id="2681058">t</span><span class="op" id="2681059">)</span><span class="op" id="2681060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681064">return</span>&nbsp;<span class="ident" id="2681071">tt</span><span class="op" id="2681073">.</span><span class="ident" id="2681074">NumMethod</span><span class="op" id="2681083">(</span><span class="op" id="2681084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681087">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681090">return</span>&nbsp;<span class="ident" id="2681097">t</span><span class="op" id="2681098">.</span><span class="ident" id="2681099">uncommonType</span><span class="op" id="2681111">.</span><span class="ident" id="2681112">NumMethod</span><span class="op" id="2681121">(</span><span class="op" id="2681122">)</span><br>
<span class="lineno"></span><span class="op" id="2681124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2681127">func</span>&nbsp;<span class="op" id="2681132">(</span><span class="ident" id="2681133">t</span>&nbsp;<span class="op" id="2681135">*</span><span class="ident" id="2681136">rtype</span><span class="op" id="2681141">)</span>&nbsp;<span class="ident" id="2681143">Method</span><span class="op" id="2681149">(</span><span class="ident" id="2681150">i</span>&nbsp;<span class="builtintype" id="2681152">int</span><span class="op" id="2681155">)</span>&nbsp;<span class="op" id="2681157">(</span><span class="ident" id="2681158">m</span>&nbsp;<span class="ident" id="2681160">Method</span><span class="op" id="2681166">)</span>&nbsp;<span class="op" id="2681168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681171">if</span>&nbsp;<span class="ident" id="2681174">t</span><span class="op" id="2681175">.</span><span class="ident" id="2681176">Kind</span><span class="op" id="2681180">(</span><span class="op" id="2681181">)</span>&nbsp;<span class="op" id="2681183">==</span>&nbsp;<span class="ident" id="2681186">Interface</span>&nbsp;<span class="op" id="2681196">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681200">tt</span>&nbsp;<span class="op" id="2681203">:=</span>&nbsp;<span class="op" id="2681206">(</span><span class="op" id="2681207">*</span><span class="ident" id="2681208">interfaceType</span><span class="op" id="2681221">)</span><span class="op" id="2681222">(</span><span class="ident" id="2681223">unsafe</span><span class="op" id="2681229">.</span><span class="ident" id="2681230">Pointer</span><span class="op" id="2681237">(</span><span class="ident" id="2681238">t</span><span class="op" id="2681239">)</span><span class="op" id="2681240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681244">return</span>&nbsp;<span class="ident" id="2681251">tt</span><span class="op" id="2681253">.</span><span class="ident" id="2681254">Method</span><span class="op" id="2681260">(</span><span class="ident" id="2681261">i</span><span class="op" id="2681262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681268">return</span>&nbsp;<span class="ident" id="2681275">t</span><span class="op" id="2681276">.</span><span class="ident" id="2681277">uncommonType</span><span class="op" id="2681289">.</span><span class="ident" id="2681290">Method</span><span class="op" id="2681296">(</span><span class="ident" id="2681297">i</span><span class="op" id="2681298">)</span><br>
<span class="lineno"></span><span class="op" id="2681300">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="keyword" id="2681303">func</span>&nbsp;<span class="op" id="2681308">(</span><span class="ident" id="2681309">t</span>&nbsp;<span class="op" id="2681311">*</span><span class="ident" id="2681312">rtype</span><span class="op" id="2681317">)</span>&nbsp;<span class="ident" id="2681319">MethodByName</span><span class="op" id="2681331">(</span><span class="ident" id="2681332">name</span>&nbsp;<span class="builtintype" id="2681337">string</span><span class="op" id="2681343">)</span>&nbsp;<span class="op" id="2681345">(</span><span class="ident" id="2681346">m</span>&nbsp;<span class="ident" id="2681348">Method</span><span class="op" id="2681354">,</span>&nbsp;<span class="ident" id="2681356">ok</span>&nbsp;<span class="builtintype" id="2681359">bool</span><span class="op" id="2681363">)</span>&nbsp;<span class="op" id="2681365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681368">if</span>&nbsp;<span class="ident" id="2681371">t</span><span class="op" id="2681372">.</span><span class="ident" id="2681373">Kind</span><span class="op" id="2681377">(</span><span class="op" id="2681378">)</span>&nbsp;<span class="op" id="2681380">==</span>&nbsp;<span class="ident" id="2681383">Interface</span>&nbsp;<span class="op" id="2681393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681397">tt</span>&nbsp;<span class="op" id="2681400">:=</span>&nbsp;<span class="op" id="2681403">(</span><span class="op" id="2681404">*</span><span class="ident" id="2681405">interfaceType</span><span class="op" id="2681418">)</span><span class="op" id="2681419">(</span><span class="ident" id="2681420">unsafe</span><span class="op" id="2681426">.</span><span class="ident" id="2681427">Pointer</span><span class="op" id="2681434">(</span><span class="ident" id="2681435">t</span><span class="op" id="2681436">)</span><span class="op" id="2681437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681441">return</span>&nbsp;<span class="ident" id="2681448">tt</span><span class="op" id="2681450">.</span><span class="ident" id="2681451">MethodByName</span><span class="op" id="2681463">(</span><span class="ident" id="2681464">name</span><span class="op" id="2681468">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681474">return</span>&nbsp;<span class="ident" id="2681481">t</span><span class="op" id="2681482">.</span><span class="ident" id="2681483">uncommonType</span><span class="op" id="2681495">.</span><span class="ident" id="2681496">MethodByName</span><span class="op" id="2681508">(</span><span class="ident" id="2681509">name</span><span class="op" id="2681513">)</span><br>
<span class="lineno"></span><span class="op" id="2681515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2681518">func</span>&nbsp;<span class="op" id="2681523">(</span><span class="ident" id="2681524">t</span>&nbsp;<span class="op" id="2681526">*</span><span class="ident" id="2681527">rtype</span><span class="op" id="2681532">)</span>&nbsp;<span class="ident" id="2681534">PkgPath</span><span class="op" id="2681541">(</span><span class="op" id="2681542">)</span>&nbsp;<span class="builtintype" id="2681544">string</span>&nbsp;<span class="op" id="2681551">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681554">return</span>&nbsp;<span class="ident" id="2681561">t</span><span class="op" id="2681562">.</span><span class="ident" id="2681563">uncommonType</span><span class="op" id="2681575">.</span><span class="ident" id="2681576">PkgPath</span><span class="op" id="2681583">(</span><span class="op" id="2681584">)</span><br>
<span class="lineno"></span><span class="op" id="2681586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2681589">func</span>&nbsp;<span class="op" id="2681594">(</span><span class="ident" id="2681595">t</span>&nbsp;<span class="op" id="2681597">*</span><span class="ident" id="2681598">rtype</span><span class="op" id="2681603">)</span>&nbsp;<span class="ident" id="2681605">Name</span><span class="op" id="2681609">(</span><span class="op" id="2681610">)</span>&nbsp;<span class="builtintype" id="2681612">string</span>&nbsp;<span class="op" id="2681619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681622">return</span>&nbsp;<span class="ident" id="2681629">t</span><span class="op" id="2681630">.</span><span class="ident" id="2681631">uncommonType</span><span class="op" id="2681643">.</span><span class="ident" id="2681644">Name</span><span class="op" id="2681648">(</span><span class="op" id="2681649">)</span><br>
<span class="lineno">560</span><span class="op" id="2681651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2681654">func</span>&nbsp;<span class="op" id="2681659">(</span><span class="ident" id="2681660">t</span>&nbsp;<span class="op" id="2681662">*</span><span class="ident" id="2681663">rtype</span><span class="op" id="2681668">)</span>&nbsp;<span class="ident" id="2681670">ChanDir</span><span class="op" id="2681677">(</span><span class="op" id="2681678">)</span>&nbsp;<span class="ident" id="2681680">ChanDir</span>&nbsp;<span class="op" id="2681688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681691">if</span>&nbsp;<span class="ident" id="2681694">t</span><span class="op" id="2681695">.</span><span class="ident" id="2681696">Kind</span><span class="op" id="2681700">(</span><span class="op" id="2681701">)</span>&nbsp;<span class="op" id="2681703">!=</span>&nbsp;<span class="ident" id="2681706">Chan</span>&nbsp;<span class="op" id="2681711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2681715">panic</span><span class="op" id="2681720">(</span><span class="string" id="2681721">&#34;reflect:&nbsp;ChanDir&nbsp;of&nbsp;non-chan&nbsp;type&#34;</span><span class="op" id="2681756">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681762">tt</span>&nbsp;<span class="op" id="2681765">:=</span>&nbsp;<span class="op" id="2681768">(</span><span class="op" id="2681769">*</span><span class="ident" id="2681770">chanType</span><span class="op" id="2681778">)</span><span class="op" id="2681779">(</span><span class="ident" id="2681780">unsafe</span><span class="op" id="2681786">.</span><span class="ident" id="2681787">Pointer</span><span class="op" id="2681794">(</span><span class="ident" id="2681795">t</span><span class="op" id="2681796">)</span><span class="op" id="2681797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681800">return</span>&nbsp;<span class="ident" id="2681807">ChanDir</span><span class="op" id="2681814">(</span><span class="ident" id="2681815">tt</span><span class="op" id="2681817">.</span><span class="ident" id="2681818">dir</span><span class="op" id="2681821">)</span><br>
<span class="lineno"></span><span class="op" id="2681823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="keyword" id="2681826">func</span>&nbsp;<span class="op" id="2681831">(</span><span class="ident" id="2681832">t</span>&nbsp;<span class="op" id="2681834">*</span><span class="ident" id="2681835">rtype</span><span class="op" id="2681840">)</span>&nbsp;<span class="ident" id="2681842">IsVariadic</span><span class="op" id="2681852">(</span><span class="op" id="2681853">)</span>&nbsp;<span class="builtintype" id="2681855">bool</span>&nbsp;<span class="op" id="2681860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681863">if</span>&nbsp;<span class="ident" id="2681866">t</span><span class="op" id="2681867">.</span><span class="ident" id="2681868">Kind</span><span class="op" id="2681872">(</span><span class="op" id="2681873">)</span>&nbsp;<span class="op" id="2681875">!=</span>&nbsp;<span class="ident" id="2681878">Func</span>&nbsp;<span class="op" id="2681883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2681887">panic</span><span class="op" id="2681892">(</span><span class="string" id="2681893">&#34;reflect:&nbsp;IsVariadic&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2681931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2681934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2681937">tt</span>&nbsp;<span class="op" id="2681940">:=</span>&nbsp;<span class="op" id="2681943">(</span><span class="op" id="2681944">*</span><span class="ident" id="2681945">funcType</span><span class="op" id="2681953">)</span><span class="op" id="2681954">(</span><span class="ident" id="2681955">unsafe</span><span class="op" id="2681961">.</span><span class="ident" id="2681962">Pointer</span><span class="op" id="2681969">(</span><span class="ident" id="2681970">t</span><span class="op" id="2681971">)</span><span class="op" id="2681972">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2681975">return</span>&nbsp;<span class="ident" id="2681982">tt</span><span class="op" id="2681984">.</span><span class="ident" id="2681985">dotdotdot</span><br>
<span class="lineno"></span><span class="op" id="2681995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2681998">func</span>&nbsp;<span class="op" id="2682003">(</span><span class="ident" id="2682004">t</span>&nbsp;<span class="op" id="2682006">*</span><span class="ident" id="2682007">rtype</span><span class="op" id="2682012">)</span>&nbsp;<span class="ident" id="2682014">Elem</span><span class="op" id="2682018">(</span><span class="op" id="2682019">)</span>&nbsp;<span class="ident" id="2682021">Type</span>&nbsp;<span class="op" id="2682026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682029">switch</span>&nbsp;<span class="ident" id="2682036">t</span><span class="op" id="2682037">.</span><span class="ident" id="2682038">Kind</span><span class="op" id="2682042">(</span><span class="op" id="2682043">)</span>&nbsp;<span class="op" id="2682045">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682048">case</span>&nbsp;<span class="ident" id="2682053">Array</span><span class="op" id="2682058">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682062">tt</span>&nbsp;<span class="op" id="2682065">:=</span>&nbsp;<span class="op" id="2682068">(</span><span class="op" id="2682069">*</span><span class="ident" id="2682070">arrayType</span><span class="op" id="2682079">)</span><span class="op" id="2682080">(</span><span class="ident" id="2682081">unsafe</span><span class="op" id="2682087">.</span><span class="ident" id="2682088">Pointer</span><span class="op" id="2682095">(</span><span class="ident" id="2682096">t</span><span class="op" id="2682097">)</span><span class="op" id="2682098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682102">return</span>&nbsp;<span class="ident" id="2682109">toType</span><span class="op" id="2682115">(</span><span class="ident" id="2682116">tt</span><span class="op" id="2682118">.</span><span class="ident" id="2682119">elem</span><span class="op" id="2682123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682126">case</span>&nbsp;<span class="ident" id="2682131">Chan</span><span class="op" id="2682135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682139">tt</span>&nbsp;<span class="op" id="2682142">:=</span>&nbsp;<span class="op" id="2682145">(</span><span class="op" id="2682146">*</span><span class="ident" id="2682147">chanType</span><span class="op" id="2682155">)</span><span class="op" id="2682156">(</span><span class="ident" id="2682157">unsafe</span><span class="op" id="2682163">.</span><span class="ident" id="2682164">Pointer</span><span class="op" id="2682171">(</span><span class="ident" id="2682172">t</span><span class="op" id="2682173">)</span><span class="op" id="2682174">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682178">return</span>&nbsp;<span class="ident" id="2682185">toType</span><span class="op" id="2682191">(</span><span class="ident" id="2682192">tt</span><span class="op" id="2682194">.</span><span class="ident" id="2682195">elem</span><span class="op" id="2682199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682202">case</span>&nbsp;<span class="ident" id="2682207">Map</span><span class="op" id="2682210">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682214">tt</span>&nbsp;<span class="op" id="2682217">:=</span>&nbsp;<span class="op" id="2682220">(</span><span class="op" id="2682221">*</span><span class="ident" id="2682222">mapType</span><span class="op" id="2682229">)</span><span class="op" id="2682230">(</span><span class="ident" id="2682231">unsafe</span><span class="op" id="2682237">.</span><span class="ident" id="2682238">Pointer</span><span class="op" id="2682245">(</span><span class="ident" id="2682246">t</span><span class="op" id="2682247">)</span><span class="op" id="2682248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682252">return</span>&nbsp;<span class="ident" id="2682259">toType</span><span class="op" id="2682265">(</span><span class="ident" id="2682266">tt</span><span class="op" id="2682268">.</span><span class="ident" id="2682269">elem</span><span class="op" id="2682273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682276">case</span>&nbsp;<span class="ident" id="2682281">Ptr</span><span class="op" id="2682284">:</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682288">tt</span>&nbsp;<span class="op" id="2682291">:=</span>&nbsp;<span class="op" id="2682294">(</span><span class="op" id="2682295">*</span><span class="ident" id="2682296">ptrType</span><span class="op" id="2682303">)</span><span class="op" id="2682304">(</span><span class="ident" id="2682305">unsafe</span><span class="op" id="2682311">.</span><span class="ident" id="2682312">Pointer</span><span class="op" id="2682319">(</span><span class="ident" id="2682320">t</span><span class="op" id="2682321">)</span><span class="op" id="2682322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682326">return</span>&nbsp;<span class="ident" id="2682333">toType</span><span class="op" id="2682339">(</span><span class="ident" id="2682340">tt</span><span class="op" id="2682342">.</span><span class="ident" id="2682343">elem</span><span class="op" id="2682347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682350">case</span>&nbsp;<span class="ident" id="2682355">Slice</span><span class="op" id="2682360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682364">tt</span>&nbsp;<span class="op" id="2682367">:=</span>&nbsp;<span class="op" id="2682370">(</span><span class="op" id="2682371">*</span><span class="ident" id="2682372">sliceType</span><span class="op" id="2682381">)</span><span class="op" id="2682382">(</span><span class="ident" id="2682383">unsafe</span><span class="op" id="2682389">.</span><span class="ident" id="2682390">Pointer</span><span class="op" id="2682397">(</span><span class="ident" id="2682398">t</span><span class="op" id="2682399">)</span><span class="op" id="2682400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682404">return</span>&nbsp;<span class="ident" id="2682411">toType</span><span class="op" id="2682417">(</span><span class="ident" id="2682418">tt</span><span class="op" id="2682420">.</span><span class="ident" id="2682421">elem</span><span class="op" id="2682425">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2682431">panic</span><span class="op" id="2682436">(</span><span class="string" id="2682437">&#34;reflect:&nbsp;Elem&nbsp;of&nbsp;invalid&nbsp;type&#34;</span><span class="op" id="2682468">)</span><br>
<span class="lineno"></span><span class="op" id="2682470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2682473">func</span>&nbsp;<span class="op" id="2682478">(</span><span class="ident" id="2682479">t</span>&nbsp;<span class="op" id="2682481">*</span><span class="ident" id="2682482">rtype</span><span class="op" id="2682487">)</span>&nbsp;<span class="ident" id="2682489">Field</span><span class="op" id="2682494">(</span><span class="ident" id="2682495">i</span>&nbsp;<span class="builtintype" id="2682497">int</span><span class="op" id="2682500">)</span>&nbsp;<span class="ident" id="2682502">StructField</span>&nbsp;<span class="op" id="2682514">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682517">if</span>&nbsp;<span class="ident" id="2682520">t</span><span class="op" id="2682521">.</span><span class="ident" id="2682522">Kind</span><span class="op" id="2682526">(</span><span class="op" id="2682527">)</span>&nbsp;<span class="op" id="2682529">!=</span>&nbsp;<span class="ident" id="2682532">Struct</span>&nbsp;<span class="op" id="2682539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2682543">panic</span><span class="op" id="2682548">(</span><span class="string" id="2682549">&#34;reflect:&nbsp;Field&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2682584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682590">tt</span>&nbsp;<span class="op" id="2682593">:=</span>&nbsp;<span class="op" id="2682596">(</span><span class="op" id="2682597">*</span><span class="ident" id="2682598">structType</span><span class="op" id="2682608">)</span><span class="op" id="2682609">(</span><span class="ident" id="2682610">unsafe</span><span class="op" id="2682616">.</span><span class="ident" id="2682617">Pointer</span><span class="op" id="2682624">(</span><span class="ident" id="2682625">t</span><span class="op" id="2682626">)</span><span class="op" id="2682627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682630">return</span>&nbsp;<span class="ident" id="2682637">tt</span><span class="op" id="2682639">.</span><span class="ident" id="2682640">Field</span><span class="op" id="2682645">(</span><span class="ident" id="2682646">i</span><span class="op" id="2682647">)</span><br>
<span class="lineno">605</span><span class="op" id="2682649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2682652">func</span>&nbsp;<span class="op" id="2682657">(</span><span class="ident" id="2682658">t</span>&nbsp;<span class="op" id="2682660">*</span><span class="ident" id="2682661">rtype</span><span class="op" id="2682666">)</span>&nbsp;<span class="ident" id="2682668">FieldByIndex</span><span class="op" id="2682680">(</span><span class="ident" id="2682681">index</span>&nbsp;<span class="op" id="2682687">[</span><span class="op" id="2682688">]</span><span class="builtintype" id="2682689">int</span><span class="op" id="2682692">)</span>&nbsp;<span class="ident" id="2682694">StructField</span>&nbsp;<span class="op" id="2682706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682709">if</span>&nbsp;<span class="ident" id="2682712">t</span><span class="op" id="2682713">.</span><span class="ident" id="2682714">Kind</span><span class="op" id="2682718">(</span><span class="op" id="2682719">)</span>&nbsp;<span class="op" id="2682721">!=</span>&nbsp;<span class="ident" id="2682724">Struct</span>&nbsp;<span class="op" id="2682731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2682735">panic</span><span class="op" id="2682740">(</span><span class="string" id="2682741">&#34;reflect:&nbsp;FieldByIndex&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2682783">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2682786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2682789">tt</span>&nbsp;<span class="op" id="2682792">:=</span>&nbsp;<span class="op" id="2682795">(</span><span class="op" id="2682796">*</span><span class="ident" id="2682797">structType</span><span class="op" id="2682807">)</span><span class="op" id="2682808">(</span><span class="ident" id="2682809">unsafe</span><span class="op" id="2682815">.</span><span class="ident" id="2682816">Pointer</span><span class="op" id="2682823">(</span><span class="ident" id="2682824">t</span><span class="op" id="2682825">)</span><span class="op" id="2682826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682829">return</span>&nbsp;<span class="ident" id="2682836">tt</span><span class="op" id="2682838">.</span><span class="ident" id="2682839">FieldByIndex</span><span class="op" id="2682851">(</span><span class="ident" id="2682852">index</span><span class="op" id="2682857">)</span><br>
<span class="lineno"></span><span class="op" id="2682859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="2682862">func</span>&nbsp;<span class="op" id="2682867">(</span><span class="ident" id="2682868">t</span>&nbsp;<span class="op" id="2682870">*</span><span class="ident" id="2682871">rtype</span><span class="op" id="2682876">)</span>&nbsp;<span class="ident" id="2682878">FieldByName</span><span class="op" id="2682889">(</span><span class="ident" id="2682890">name</span>&nbsp;<span class="builtintype" id="2682895">string</span><span class="op" id="2682901">)</span>&nbsp;<span class="op" id="2682903">(</span><span class="ident" id="2682904">StructField</span><span class="op" id="2682915">,</span>&nbsp;<span class="builtintype" id="2682917">bool</span><span class="op" id="2682921">)</span>&nbsp;<span class="op" id="2682923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2682926">if</span>&nbsp;<span class="ident" id="2682929">t</span><span class="op" id="2682930">.</span><span class="ident" id="2682931">Kind</span><span class="op" id="2682935">(</span><span class="op" id="2682936">)</span>&nbsp;<span class="op" id="2682938">!=</span>&nbsp;<span class="ident" id="2682941">Struct</span>&nbsp;<span class="op" id="2682948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2682952">panic</span><span class="op" id="2682957">(</span><span class="string" id="2682958">&#34;reflect:&nbsp;FieldByName&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2682999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683005">tt</span>&nbsp;<span class="op" id="2683008">:=</span>&nbsp;<span class="op" id="2683011">(</span><span class="op" id="2683012">*</span><span class="ident" id="2683013">structType</span><span class="op" id="2683023">)</span><span class="op" id="2683024">(</span><span class="ident" id="2683025">unsafe</span><span class="op" id="2683031">.</span><span class="ident" id="2683032">Pointer</span><span class="op" id="2683039">(</span><span class="ident" id="2683040">t</span><span class="op" id="2683041">)</span><span class="op" id="2683042">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683045">return</span>&nbsp;<span class="ident" id="2683052">tt</span><span class="op" id="2683054">.</span><span class="ident" id="2683055">FieldByName</span><span class="op" id="2683066">(</span><span class="ident" id="2683067">name</span><span class="op" id="2683071">)</span><br>
<span class="lineno"></span><span class="op" id="2683073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2683076">func</span>&nbsp;<span class="op" id="2683081">(</span><span class="ident" id="2683082">t</span>&nbsp;<span class="op" id="2683084">*</span><span class="ident" id="2683085">rtype</span><span class="op" id="2683090">)</span>&nbsp;<span class="ident" id="2683092">FieldByNameFunc</span><span class="op" id="2683107">(</span><span class="ident" id="2683108">match</span>&nbsp;<span class="keyword" id="2683114">func</span><span class="op" id="2683118">(</span><span class="builtintype" id="2683119">string</span><span class="op" id="2683125">)</span>&nbsp;<span class="builtintype" id="2683127">bool</span><span class="op" id="2683131">)</span>&nbsp;<span class="op" id="2683133">(</span><span class="ident" id="2683134">StructField</span><span class="op" id="2683145">,</span>&nbsp;<span class="builtintype" id="2683147">bool</span><span class="op" id="2683151">)</span>&nbsp;<span class="op" id="2683153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683156">if</span>&nbsp;<span class="ident" id="2683159">t</span><span class="op" id="2683160">.</span><span class="ident" id="2683161">Kind</span><span class="op" id="2683165">(</span><span class="op" id="2683166">)</span>&nbsp;<span class="op" id="2683168">!=</span>&nbsp;<span class="ident" id="2683171">Struct</span>&nbsp;<span class="op" id="2683178">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2683182">panic</span><span class="op" id="2683187">(</span><span class="string" id="2683188">&#34;reflect:&nbsp;FieldByNameFunc&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2683233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683239">tt</span>&nbsp;<span class="op" id="2683242">:=</span>&nbsp;<span class="op" id="2683245">(</span><span class="op" id="2683246">*</span><span class="ident" id="2683247">structType</span><span class="op" id="2683257">)</span><span class="op" id="2683258">(</span><span class="ident" id="2683259">unsafe</span><span class="op" id="2683265">.</span><span class="ident" id="2683266">Pointer</span><span class="op" id="2683273">(</span><span class="ident" id="2683274">t</span><span class="op" id="2683275">)</span><span class="op" id="2683276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683279">return</span>&nbsp;<span class="ident" id="2683286">tt</span><span class="op" id="2683288">.</span><span class="ident" id="2683289">FieldByNameFunc</span><span class="op" id="2683304">(</span><span class="ident" id="2683305">match</span><span class="op" id="2683310">)</span><br>
<span class="lineno"></span><span class="op" id="2683312">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="2683315">func</span>&nbsp;<span class="op" id="2683320">(</span><span class="ident" id="2683321">t</span>&nbsp;<span class="op" id="2683323">*</span><span class="ident" id="2683324">rtype</span><span class="op" id="2683329">)</span>&nbsp;<span class="ident" id="2683331">In</span><span class="op" id="2683333">(</span><span class="ident" id="2683334">i</span>&nbsp;<span class="builtintype" id="2683336">int</span><span class="op" id="2683339">)</span>&nbsp;<span class="ident" id="2683341">Type</span>&nbsp;<span class="op" id="2683346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683349">if</span>&nbsp;<span class="ident" id="2683352">t</span><span class="op" id="2683353">.</span><span class="ident" id="2683354">Kind</span><span class="op" id="2683358">(</span><span class="op" id="2683359">)</span>&nbsp;<span class="op" id="2683361">!=</span>&nbsp;<span class="ident" id="2683364">Func</span>&nbsp;<span class="op" id="2683369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2683373">panic</span><span class="op" id="2683378">(</span><span class="string" id="2683379">&#34;reflect:&nbsp;In&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2683409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683412">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683415">tt</span>&nbsp;<span class="op" id="2683418">:=</span>&nbsp;<span class="op" id="2683421">(</span><span class="op" id="2683422">*</span><span class="ident" id="2683423">funcType</span><span class="op" id="2683431">)</span><span class="op" id="2683432">(</span><span class="ident" id="2683433">unsafe</span><span class="op" id="2683439">.</span><span class="ident" id="2683440">Pointer</span><span class="op" id="2683447">(</span><span class="ident" id="2683448">t</span><span class="op" id="2683449">)</span><span class="op" id="2683450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683453">return</span>&nbsp;<span class="ident" id="2683460">toType</span><span class="op" id="2683466">(</span><span class="ident" id="2683467">tt</span><span class="op" id="2683469">.</span><span class="ident" id="2683470">in</span><span class="op" id="2683472">[</span><span class="ident" id="2683473">i</span><span class="op" id="2683474">]</span><span class="op" id="2683475">)</span><br>
<span class="lineno"></span><span class="op" id="2683477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2683480">func</span>&nbsp;<span class="op" id="2683485">(</span><span class="ident" id="2683486">t</span>&nbsp;<span class="op" id="2683488">*</span><span class="ident" id="2683489">rtype</span><span class="op" id="2683494">)</span>&nbsp;<span class="ident" id="2683496">Key</span><span class="op" id="2683499">(</span><span class="op" id="2683500">)</span>&nbsp;<span class="ident" id="2683502">Type</span>&nbsp;<span class="op" id="2683507">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683510">if</span>&nbsp;<span class="ident" id="2683513">t</span><span class="op" id="2683514">.</span><span class="ident" id="2683515">Kind</span><span class="op" id="2683519">(</span><span class="op" id="2683520">)</span>&nbsp;<span class="op" id="2683522">!=</span>&nbsp;<span class="ident" id="2683525">Map</span>&nbsp;<span class="op" id="2683529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2683533">panic</span><span class="op" id="2683538">(</span><span class="string" id="2683539">&#34;reflect:&nbsp;Key&nbsp;of&nbsp;non-map&nbsp;type&#34;</span><span class="op" id="2683569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683575">tt</span>&nbsp;<span class="op" id="2683578">:=</span>&nbsp;<span class="op" id="2683581">(</span><span class="op" id="2683582">*</span><span class="ident" id="2683583">mapType</span><span class="op" id="2683590">)</span><span class="op" id="2683591">(</span><span class="ident" id="2683592">unsafe</span><span class="op" id="2683598">.</span><span class="ident" id="2683599">Pointer</span><span class="op" id="2683606">(</span><span class="ident" id="2683607">t</span><span class="op" id="2683608">)</span><span class="op" id="2683609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683612">return</span>&nbsp;<span class="ident" id="2683619">toType</span><span class="op" id="2683625">(</span><span class="ident" id="2683626">tt</span><span class="op" id="2683628">.</span><span class="ident" id="2683629">key</span><span class="op" id="2683632">)</span><br>
<span class="lineno">645</span><span class="op" id="2683634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2683637">func</span>&nbsp;<span class="op" id="2683642">(</span><span class="ident" id="2683643">t</span>&nbsp;<span class="op" id="2683645">*</span><span class="ident" id="2683646">rtype</span><span class="op" id="2683651">)</span>&nbsp;<span class="ident" id="2683653">Len</span><span class="op" id="2683656">(</span><span class="op" id="2683657">)</span>&nbsp;<span class="builtintype" id="2683659">int</span>&nbsp;<span class="op" id="2683663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683666">if</span>&nbsp;<span class="ident" id="2683669">t</span><span class="op" id="2683670">.</span><span class="ident" id="2683671">Kind</span><span class="op" id="2683675">(</span><span class="op" id="2683676">)</span>&nbsp;<span class="op" id="2683678">!=</span>&nbsp;<span class="ident" id="2683681">Array</span>&nbsp;<span class="op" id="2683687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2683691">panic</span><span class="op" id="2683696">(</span><span class="string" id="2683697">&#34;reflect:&nbsp;Len&nbsp;of&nbsp;non-array&nbsp;type&#34;</span><span class="op" id="2683729">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683735">tt</span>&nbsp;<span class="op" id="2683738">:=</span>&nbsp;<span class="op" id="2683741">(</span><span class="op" id="2683742">*</span><span class="ident" id="2683743">arrayType</span><span class="op" id="2683752">)</span><span class="op" id="2683753">(</span><span class="ident" id="2683754">unsafe</span><span class="op" id="2683760">.</span><span class="ident" id="2683761">Pointer</span><span class="op" id="2683768">(</span><span class="ident" id="2683769">t</span><span class="op" id="2683770">)</span><span class="op" id="2683771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683774">return</span>&nbsp;<span class="builtintype" id="2683781">int</span><span class="op" id="2683784">(</span><span class="ident" id="2683785">tt</span><span class="op" id="2683787">.</span><span class="builtinfunc" id="2683788">len</span><span class="op" id="2683791">)</span><br>
<span class="lineno"></span><span class="op" id="2683793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="2683796">func</span>&nbsp;<span class="op" id="2683801">(</span><span class="ident" id="2683802">t</span>&nbsp;<span class="op" id="2683804">*</span><span class="ident" id="2683805">rtype</span><span class="op" id="2683810">)</span>&nbsp;<span class="ident" id="2683812">NumField</span><span class="op" id="2683820">(</span><span class="op" id="2683821">)</span>&nbsp;<span class="builtintype" id="2683823">int</span>&nbsp;<span class="op" id="2683827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683830">if</span>&nbsp;<span class="ident" id="2683833">t</span><span class="op" id="2683834">.</span><span class="ident" id="2683835">Kind</span><span class="op" id="2683839">(</span><span class="op" id="2683840">)</span>&nbsp;<span class="op" id="2683842">!=</span>&nbsp;<span class="ident" id="2683845">Struct</span>&nbsp;<span class="op" id="2683852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2683856">panic</span><span class="op" id="2683861">(</span><span class="string" id="2683862">&#34;reflect:&nbsp;NumField&nbsp;of&nbsp;non-struct&nbsp;type&#34;</span><span class="op" id="2683900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2683903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2683906">tt</span>&nbsp;<span class="op" id="2683909">:=</span>&nbsp;<span class="op" id="2683912">(</span><span class="op" id="2683913">*</span><span class="ident" id="2683914">structType</span><span class="op" id="2683924">)</span><span class="op" id="2683925">(</span><span class="ident" id="2683926">unsafe</span><span class="op" id="2683932">.</span><span class="ident" id="2683933">Pointer</span><span class="op" id="2683940">(</span><span class="ident" id="2683941">t</span><span class="op" id="2683942">)</span><span class="op" id="2683943">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2683946">return</span>&nbsp;<span class="builtinfunc" id="2683953">len</span><span class="op" id="2683956">(</span><span class="ident" id="2683957">tt</span><span class="op" id="2683959">.</span><span class="ident" id="2683960">fields</span><span class="op" id="2683966">)</span><br>
<span class="lineno"></span><span class="op" id="2683968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2683971">func</span>&nbsp;<span class="op" id="2683976">(</span><span class="ident" id="2683977">t</span>&nbsp;<span class="op" id="2683979">*</span><span class="ident" id="2683980">rtype</span><span class="op" id="2683985">)</span>&nbsp;<span class="ident" id="2683987">NumIn</span><span class="op" id="2683992">(</span><span class="op" id="2683993">)</span>&nbsp;<span class="builtintype" id="2683995">int</span>&nbsp;<span class="op" id="2683999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684002">if</span>&nbsp;<span class="ident" id="2684005">t</span><span class="op" id="2684006">.</span><span class="ident" id="2684007">Kind</span><span class="op" id="2684011">(</span><span class="op" id="2684012">)</span>&nbsp;<span class="op" id="2684014">!=</span>&nbsp;<span class="ident" id="2684017">Func</span>&nbsp;<span class="op" id="2684022">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2684026">panic</span><span class="op" id="2684031">(</span><span class="string" id="2684032">&#34;reflect:&nbsp;NumIn&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2684065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684071">tt</span>&nbsp;<span class="op" id="2684074">:=</span>&nbsp;<span class="op" id="2684077">(</span><span class="op" id="2684078">*</span><span class="ident" id="2684079">funcType</span><span class="op" id="2684087">)</span><span class="op" id="2684088">(</span><span class="ident" id="2684089">unsafe</span><span class="op" id="2684095">.</span><span class="ident" id="2684096">Pointer</span><span class="op" id="2684103">(</span><span class="ident" id="2684104">t</span><span class="op" id="2684105">)</span><span class="op" id="2684106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684109">return</span>&nbsp;<span class="builtinfunc" id="2684116">len</span><span class="op" id="2684119">(</span><span class="ident" id="2684120">tt</span><span class="op" id="2684122">.</span><span class="ident" id="2684123">in</span><span class="op" id="2684125">)</span><br>
<span class="lineno"></span><span class="op" id="2684127">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="2684130">func</span>&nbsp;<span class="op" id="2684135">(</span><span class="ident" id="2684136">t</span>&nbsp;<span class="op" id="2684138">*</span><span class="ident" id="2684139">rtype</span><span class="op" id="2684144">)</span>&nbsp;<span class="ident" id="2684146">NumOut</span><span class="op" id="2684152">(</span><span class="op" id="2684153">)</span>&nbsp;<span class="builtintype" id="2684155">int</span>&nbsp;<span class="op" id="2684159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684162">if</span>&nbsp;<span class="ident" id="2684165">t</span><span class="op" id="2684166">.</span><span class="ident" id="2684167">Kind</span><span class="op" id="2684171">(</span><span class="op" id="2684172">)</span>&nbsp;<span class="op" id="2684174">!=</span>&nbsp;<span class="ident" id="2684177">Func</span>&nbsp;<span class="op" id="2684182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2684186">panic</span><span class="op" id="2684191">(</span><span class="string" id="2684192">&#34;reflect:&nbsp;NumOut&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2684226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684229">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684232">tt</span>&nbsp;<span class="op" id="2684235">:=</span>&nbsp;<span class="op" id="2684238">(</span><span class="op" id="2684239">*</span><span class="ident" id="2684240">funcType</span><span class="op" id="2684248">)</span><span class="op" id="2684249">(</span><span class="ident" id="2684250">unsafe</span><span class="op" id="2684256">.</span><span class="ident" id="2684257">Pointer</span><span class="op" id="2684264">(</span><span class="ident" id="2684265">t</span><span class="op" id="2684266">)</span><span class="op" id="2684267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684270">return</span>&nbsp;<span class="builtinfunc" id="2684277">len</span><span class="op" id="2684280">(</span><span class="ident" id="2684281">tt</span><span class="op" id="2684283">.</span><span class="ident" id="2684284">out</span><span class="op" id="2684287">)</span><br>
<span class="lineno"></span><span class="op" id="2684289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2684292">func</span>&nbsp;<span class="op" id="2684297">(</span><span class="ident" id="2684298">t</span>&nbsp;<span class="op" id="2684300">*</span><span class="ident" id="2684301">rtype</span><span class="op" id="2684306">)</span>&nbsp;<span class="ident" id="2684308">Out</span><span class="op" id="2684311">(</span><span class="ident" id="2684312">i</span>&nbsp;<span class="builtintype" id="2684314">int</span><span class="op" id="2684317">)</span>&nbsp;<span class="ident" id="2684319">Type</span>&nbsp;<span class="op" id="2684324">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684327">if</span>&nbsp;<span class="ident" id="2684330">t</span><span class="op" id="2684331">.</span><span class="ident" id="2684332">Kind</span><span class="op" id="2684336">(</span><span class="op" id="2684337">)</span>&nbsp;<span class="op" id="2684339">!=</span>&nbsp;<span class="ident" id="2684342">Func</span>&nbsp;<span class="op" id="2684347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2684351">panic</span><span class="op" id="2684356">(</span><span class="string" id="2684357">&#34;reflect:&nbsp;Out&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2684388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684394">tt</span>&nbsp;<span class="op" id="2684397">:=</span>&nbsp;<span class="op" id="2684400">(</span><span class="op" id="2684401">*</span><span class="ident" id="2684402">funcType</span><span class="op" id="2684410">)</span><span class="op" id="2684411">(</span><span class="ident" id="2684412">unsafe</span><span class="op" id="2684418">.</span><span class="ident" id="2684419">Pointer</span><span class="op" id="2684426">(</span><span class="ident" id="2684427">t</span><span class="op" id="2684428">)</span><span class="op" id="2684429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684432">return</span>&nbsp;<span class="ident" id="2684439">toType</span><span class="op" id="2684445">(</span><span class="ident" id="2684446">tt</span><span class="op" id="2684448">.</span><span class="ident" id="2684449">out</span><span class="op" id="2684452">[</span><span class="ident" id="2684453">i</span><span class="op" id="2684454">]</span><span class="op" id="2684455">)</span><br>
<span class="lineno">685</span><span class="op" id="2684457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2684460">func</span>&nbsp;<span class="op" id="2684465">(</span><span class="ident" id="2684466">d</span>&nbsp;<span class="ident" id="2684468">ChanDir</span><span class="op" id="2684475">)</span>&nbsp;<span class="ident" id="2684477">String</span><span class="op" id="2684483">(</span><span class="op" id="2684484">)</span>&nbsp;<span class="builtintype" id="2684486">string</span>&nbsp;<span class="op" id="2684493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684496">switch</span>&nbsp;<span class="ident" id="2684503">d</span>&nbsp;<span class="op" id="2684505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684508">case</span>&nbsp;<span class="ident" id="2684513">SendDir</span><span class="op" id="2684520">:</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684524">return</span>&nbsp;<span class="string" id="2684531">&#34;chan&lt;-&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684541">case</span>&nbsp;<span class="ident" id="2684546">RecvDir</span><span class="op" id="2684553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684557">return</span>&nbsp;<span class="string" id="2684564">&#34;&lt;-chan&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684574">case</span>&nbsp;<span class="ident" id="2684579">BothDir</span><span class="op" id="2684586">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684590">return</span>&nbsp;<span class="string" id="2684597">&#34;chan&#34;</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684608">return</span>&nbsp;<span class="string" id="2684615">&#34;ChanDir&#34;</span>&nbsp;<span class="op" id="2684625">+</span>&nbsp;<span class="ident" id="2684627">strconv</span><span class="op" id="2684634">.</span><span class="ident" id="2684635">Itoa</span><span class="op" id="2684639">(</span><span class="builtintype" id="2684640">int</span><span class="op" id="2684643">(</span><span class="ident" id="2684644">d</span><span class="op" id="2684645">)</span><span class="op" id="2684646">)</span><br>
<span class="lineno"></span><span class="op" id="2684648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2684651">//&nbsp;Method&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;method&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">700</span><span class="keyword" id="2684711">func</span>&nbsp;<span class="op" id="2684716">(</span><span class="ident" id="2684717">t</span>&nbsp;<span class="op" id="2684719">*</span><span class="ident" id="2684720">interfaceType</span><span class="op" id="2684733">)</span>&nbsp;<span class="ident" id="2684735">Method</span><span class="op" id="2684741">(</span><span class="ident" id="2684742">i</span>&nbsp;<span class="builtintype" id="2684744">int</span><span class="op" id="2684747">)</span>&nbsp;<span class="op" id="2684749">(</span><span class="ident" id="2684750">m</span>&nbsp;<span class="ident" id="2684752">Method</span><span class="op" id="2684758">)</span>&nbsp;<span class="op" id="2684760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684763">if</span>&nbsp;<span class="ident" id="2684766">i</span>&nbsp;<span class="op" id="2684768">&lt;</span>&nbsp;<span class="num" id="2684770">0</span>&nbsp;<span class="op" id="2684772">||</span>&nbsp;<span class="ident" id="2684775">i</span>&nbsp;<span class="op" id="2684777">&gt;=</span>&nbsp;<span class="builtinfunc" id="2684780">len</span><span class="op" id="2684783">(</span><span class="ident" id="2684784">t</span><span class="op" id="2684785">.</span><span class="ident" id="2684786">methods</span><span class="op" id="2684793">)</span>&nbsp;<span class="op" id="2684795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684799">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684807">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684810">p</span>&nbsp;<span class="op" id="2684812">:=</span>&nbsp;<span class="op" id="2684815">&amp;</span><span class="ident" id="2684816">t</span><span class="op" id="2684817">.</span><span class="ident" id="2684818">methods</span><span class="op" id="2684825">[</span><span class="ident" id="2684826">i</span><span class="op" id="2684827">]</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684830">m</span><span class="op" id="2684831">.</span><span class="ident" id="2684832">Name</span>&nbsp;<span class="op" id="2684837">=</span>&nbsp;<span class="op" id="2684839">*</span><span class="ident" id="2684840">p</span><span class="op" id="2684841">.</span><span class="ident" id="2684842">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684848">if</span>&nbsp;<span class="ident" id="2684851">p</span><span class="op" id="2684852">.</span><span class="ident" id="2684853">pkgPath</span>&nbsp;<span class="op" id="2684861">!=</span>&nbsp;<span class="ident" id="2684864">nil</span>&nbsp;<span class="op" id="2684868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684872">m</span><span class="op" id="2684873">.</span><span class="ident" id="2684874">PkgPath</span>&nbsp;<span class="op" id="2684882">=</span>&nbsp;<span class="op" id="2684884">*</span><span class="ident" id="2684885">p</span><span class="op" id="2684886">.</span><span class="ident" id="2684887">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2684896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684899">m</span><span class="op" id="2684900">.</span><span class="ident" id="2684901">Type</span>&nbsp;<span class="op" id="2684906">=</span>&nbsp;<span class="ident" id="2684908">toType</span><span class="op" id="2684914">(</span><span class="ident" id="2684915">p</span><span class="op" id="2684916">.</span><span class="ident" id="2684917">typ</span><span class="op" id="2684920">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2684923">m</span><span class="op" id="2684924">.</span><span class="ident" id="2684925">Index</span>&nbsp;<span class="op" id="2684931">=</span>&nbsp;<span class="ident" id="2684933">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2684936">return</span><br>
<span class="lineno"></span><span class="op" id="2684943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2684946">//&nbsp;NumMethod&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;interface&nbsp;methods&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno">715</span><span class="keyword" id="2685025">func</span>&nbsp;<span class="op" id="2685030">(</span><span class="ident" id="2685031">t</span>&nbsp;<span class="op" id="2685033">*</span><span class="ident" id="2685034">interfaceType</span><span class="op" id="2685047">)</span>&nbsp;<span class="ident" id="2685049">NumMethod</span><span class="op" id="2685058">(</span><span class="op" id="2685059">)</span>&nbsp;<span class="builtintype" id="2685061">int</span>&nbsp;<span class="op" id="2685065">{</span>&nbsp;<span class="keyword" id="2685067">return</span>&nbsp;<span class="builtinfunc" id="2685074">len</span><span class="op" id="2685077">(</span><span class="ident" id="2685078">t</span><span class="op" id="2685079">.</span><span class="ident" id="2685080">methods</span><span class="op" id="2685087">)</span>&nbsp;<span class="op" id="2685089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2685092">//&nbsp;MethodByName&nbsp;method&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;type&#39;s&nbsp;method&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="2685161">func</span>&nbsp;<span class="op" id="2685166">(</span><span class="ident" id="2685167">t</span>&nbsp;<span class="op" id="2685169">*</span><span class="ident" id="2685170">interfaceType</span><span class="op" id="2685183">)</span>&nbsp;<span class="ident" id="2685185">MethodByName</span><span class="op" id="2685197">(</span><span class="ident" id="2685198">name</span>&nbsp;<span class="builtintype" id="2685203">string</span><span class="op" id="2685209">)</span>&nbsp;<span class="op" id="2685211">(</span><span class="ident" id="2685212">m</span>&nbsp;<span class="ident" id="2685214">Method</span><span class="op" id="2685220">,</span>&nbsp;<span class="ident" id="2685222">ok</span>&nbsp;<span class="builtintype" id="2685225">bool</span><span class="op" id="2685229">)</span>&nbsp;<span class="op" id="2685231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685234">if</span>&nbsp;<span class="ident" id="2685237">t</span>&nbsp;<span class="op" id="2685239">==</span>&nbsp;<span class="ident" id="2685242">nil</span>&nbsp;<span class="op" id="2685246">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685250">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685261">var</span>&nbsp;<span class="ident" id="2685265">p</span>&nbsp;<span class="op" id="2685267">*</span><span class="ident" id="2685268">imethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685277">for</span>&nbsp;<span class="ident" id="2685281">i</span>&nbsp;<span class="op" id="2685283">:=</span>&nbsp;<span class="keyword" id="2685286">range</span>&nbsp;<span class="ident" id="2685292">t</span><span class="op" id="2685293">.</span><span class="ident" id="2685294">methods</span>&nbsp;<span class="op" id="2685302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685306">p</span>&nbsp;<span class="op" id="2685308">=</span>&nbsp;<span class="op" id="2685310">&amp;</span><span class="ident" id="2685311">t</span><span class="op" id="2685312">.</span><span class="ident" id="2685313">methods</span><span class="op" id="2685320">[</span><span class="ident" id="2685321">i</span><span class="op" id="2685322">]</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685326">if</span>&nbsp;<span class="op" id="2685329">*</span><span class="ident" id="2685330">p</span><span class="op" id="2685331">.</span><span class="ident" id="2685332">name</span>&nbsp;<span class="op" id="2685337">==</span>&nbsp;<span class="ident" id="2685340">name</span>&nbsp;<span class="op" id="2685345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685350">return</span>&nbsp;<span class="ident" id="2685357">t</span><span class="op" id="2685358">.</span><span class="ident" id="2685359">Method</span><span class="op" id="2685365">(</span><span class="ident" id="2685366">i</span><span class="op" id="2685367">)</span><span class="op" id="2685368">,</span>&nbsp;<span class="builtintype" id="2685370">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2685380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2685383">return</span><br>
<span class="lineno">730</span><span class="op" id="2685390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2685393">//&nbsp;A&nbsp;StructField&nbsp;describes&nbsp;a&nbsp;single&nbsp;field&nbsp;in&nbsp;a&nbsp;struct.</span><br>
<span class="lineno"></span><span class="keyword" id="2685448">type</span>&nbsp;<span class="ident" id="2685453">StructField</span>&nbsp;<span class="keyword" id="2685465">struct</span>&nbsp;<span class="op" id="2685472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2685475">//&nbsp;Name&nbsp;is&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2685503">//&nbsp;PkgPath&nbsp;is&nbsp;the&nbsp;package&nbsp;path&nbsp;that&nbsp;qualifies&nbsp;a&nbsp;lower&nbsp;case&nbsp;(unexported)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2685576">//&nbsp;field&nbsp;name.&nbsp;&nbsp;It&nbsp;is&nbsp;empty&nbsp;for&nbsp;upper&nbsp;case&nbsp;(exported)&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2685644">//&nbsp;See&nbsp;http://golang.org/ref/spec#Uniqueness_of_identifiers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685705">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2685713">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685721">PkgPath</span>&nbsp;<span class="builtintype" id="2685729">string</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685738">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685748">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2685758">//&nbsp;field&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685773">Tag</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2685783">StructTag</span>&nbsp;<span class="comment" id="2685793">//&nbsp;field&nbsp;tag&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685814">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2685824">uintptr</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2685834">//&nbsp;offset&nbsp;within&nbsp;struct,&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685869">Index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2685879">[</span><span class="op" id="2685880">]</span><span class="builtintype" id="2685881">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2685889">//&nbsp;index&nbsp;sequence&nbsp;for&nbsp;Type.FieldByIndex</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2685930">Anonymous</span>&nbsp;<span class="builtintype" id="2685940">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2685950">//&nbsp;is&nbsp;an&nbsp;embedded&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="2685974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2685977">//&nbsp;A&nbsp;StructTag&nbsp;is&nbsp;the&nbsp;tag&nbsp;string&nbsp;in&nbsp;a&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="2686029">//</span><br>
<span class="lineno">750</span><span class="comment" id="2686032">//&nbsp;By&nbsp;convention,&nbsp;tag&nbsp;strings&nbsp;are&nbsp;a&nbsp;concatenation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2686085">//&nbsp;optionally&nbsp;space-separated&nbsp;key:&#34;value&#34;&nbsp;pairs.</span><br>
<span class="lineno"></span><span class="comment" id="2686134">//&nbsp;Each&nbsp;key&nbsp;is&nbsp;a&nbsp;non-empty&nbsp;string&nbsp;consisting&nbsp;of&nbsp;non-control</span><br>
<span class="lineno"></span><span class="comment" id="2686194">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;space&nbsp;(U+0020&nbsp;&#39;&nbsp;&#39;),&nbsp;quote&nbsp;(U+0022&nbsp;&#39;&#34;&#39;),</span><br>
<span class="lineno"></span><span class="comment" id="2686259">//&nbsp;and&nbsp;colon&nbsp;(U+003A&nbsp;&#39;:&#39;).&nbsp;&nbsp;Each&nbsp;value&nbsp;is&nbsp;quoted&nbsp;using&nbsp;U+0022&nbsp;&#39;&#34;&#39;</span><br>
<span class="lineno">755</span><span class="comment" id="2686325">//&nbsp;characters&nbsp;and&nbsp;Go&nbsp;string&nbsp;literal&nbsp;syntax.</span><br>
<span class="lineno"></span><span class="keyword" id="2686369">type</span>&nbsp;<span class="ident" id="2686374">StructTag</span>&nbsp;<span class="builtintype" id="2686384">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2686392">//&nbsp;Get&nbsp;returns&nbsp;the&nbsp;value&nbsp;associated&nbsp;with&nbsp;key&nbsp;in&nbsp;the&nbsp;tag&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2686456">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;key&nbsp;in&nbsp;the&nbsp;tag,&nbsp;Get&nbsp;returns&nbsp;the&nbsp;empty&nbsp;string.</span><br>
<span class="lineno">760</span><span class="comment" id="2686525">//&nbsp;If&nbsp;the&nbsp;tag&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;conventional&nbsp;format,&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="2686588">//&nbsp;returned&nbsp;by&nbsp;Get&nbsp;is&nbsp;unspecified.</span><br>
<span class="lineno"></span><span class="keyword" id="2686623">func</span>&nbsp;<span class="op" id="2686628">(</span><span class="ident" id="2686629">tag</span>&nbsp;<span class="ident" id="2686633">StructTag</span><span class="op" id="2686642">)</span>&nbsp;<span class="ident" id="2686644">Get</span><span class="op" id="2686647">(</span><span class="ident" id="2686648">key</span>&nbsp;<span class="builtintype" id="2686652">string</span><span class="op" id="2686658">)</span>&nbsp;<span class="builtintype" id="2686660">string</span>&nbsp;<span class="op" id="2686667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686670">for</span>&nbsp;<span class="ident" id="2686674">tag</span>&nbsp;<span class="op" id="2686678">!=</span>&nbsp;<span class="string" id="2686681">&#34;&#34;</span>&nbsp;<span class="op" id="2686684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2686688">//&nbsp;skip&nbsp;leading&nbsp;space</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686712">i</span>&nbsp;<span class="op" id="2686714">:=</span>&nbsp;<span class="num" id="2686717">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686721">for</span>&nbsp;<span class="ident" id="2686725">i</span>&nbsp;<span class="op" id="2686727">&lt;</span>&nbsp;<span class="builtinfunc" id="2686729">len</span><span class="op" id="2686732">(</span><span class="ident" id="2686733">tag</span><span class="op" id="2686736">)</span>&nbsp;<span class="op" id="2686738">&amp;&amp;</span>&nbsp;<span class="ident" id="2686741">tag</span><span class="op" id="2686744">[</span><span class="ident" id="2686745">i</span><span class="op" id="2686746">]</span>&nbsp;<span class="op" id="2686748">==</span>&nbsp;<span class="string" id="2686751">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2686755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686760">i</span><span class="op" id="2686761">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686770">tag</span>&nbsp;<span class="op" id="2686774">=</span>&nbsp;<span class="ident" id="2686776">tag</span><span class="op" id="2686779">[</span><span class="ident" id="2686780">i</span><span class="op" id="2686781">:</span><span class="op" id="2686782">]</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686786">if</span>&nbsp;<span class="ident" id="2686789">tag</span>&nbsp;<span class="op" id="2686793">==</span>&nbsp;<span class="string" id="2686796">&#34;&#34;</span>&nbsp;<span class="op" id="2686799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686804">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2686817">//&nbsp;scan&nbsp;to&nbsp;colon.</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2686837">//&nbsp;a&nbsp;space&nbsp;or&nbsp;a&nbsp;quote&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686879">i</span>&nbsp;<span class="op" id="2686881">=</span>&nbsp;<span class="num" id="2686883">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686887">for</span>&nbsp;<span class="ident" id="2686891">i</span>&nbsp;<span class="op" id="2686893">&lt;</span>&nbsp;<span class="builtinfunc" id="2686895">len</span><span class="op" id="2686898">(</span><span class="ident" id="2686899">tag</span><span class="op" id="2686902">)</span>&nbsp;<span class="op" id="2686904">&amp;&amp;</span>&nbsp;<span class="ident" id="2686907">tag</span><span class="op" id="2686910">[</span><span class="ident" id="2686911">i</span><span class="op" id="2686912">]</span>&nbsp;<span class="op" id="2686914">!=</span>&nbsp;<span class="string" id="2686917">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="2686921">&amp;&amp;</span>&nbsp;<span class="ident" id="2686924">tag</span><span class="op" id="2686927">[</span><span class="ident" id="2686928">i</span><span class="op" id="2686929">]</span>&nbsp;<span class="op" id="2686931">!=</span>&nbsp;<span class="string" id="2686934">&#39;:&#39;</span>&nbsp;<span class="op" id="2686938">&amp;&amp;</span>&nbsp;<span class="ident" id="2686941">tag</span><span class="op" id="2686944">[</span><span class="ident" id="2686945">i</span><span class="op" id="2686946">]</span>&nbsp;<span class="op" id="2686948">!=</span>&nbsp;<span class="string" id="2686951">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2686955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2686960">i</span><span class="op" id="2686961">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2686966">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2686970">if</span>&nbsp;<span class="ident" id="2686973">i</span><span class="op" id="2686974">+</span><span class="num" id="2686975">1</span>&nbsp;<span class="op" id="2686977">&gt;=</span>&nbsp;<span class="builtinfunc" id="2686980">len</span><span class="op" id="2686983">(</span><span class="ident" id="2686984">tag</span><span class="op" id="2686987">)</span>&nbsp;<span class="op" id="2686989">||</span>&nbsp;<span class="ident" id="2686992">tag</span><span class="op" id="2686995">[</span><span class="ident" id="2686996">i</span><span class="op" id="2686997">]</span>&nbsp;<span class="op" id="2686999">!=</span>&nbsp;<span class="string" id="2687002">&#39;:&#39;</span>&nbsp;<span class="op" id="2687006">||</span>&nbsp;<span class="ident" id="2687009">tag</span><span class="op" id="2687012">[</span><span class="ident" id="2687013">i</span><span class="op" id="2687014">+</span><span class="num" id="2687015">1</span><span class="op" id="2687016">]</span>&nbsp;<span class="op" id="2687018">!=</span>&nbsp;<span class="string" id="2687021">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2687025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687030">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687042">name</span>&nbsp;<span class="op" id="2687047">:=</span>&nbsp;<span class="builtintype" id="2687050">string</span><span class="op" id="2687056">(</span><span class="ident" id="2687057">tag</span><span class="op" id="2687060">[</span><span class="op" id="2687061">:</span><span class="ident" id="2687062">i</span><span class="op" id="2687063">]</span><span class="op" id="2687064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687068">tag</span>&nbsp;<span class="op" id="2687072">=</span>&nbsp;<span class="ident" id="2687074">tag</span><span class="op" id="2687077">[</span><span class="ident" id="2687078">i</span><span class="op" id="2687079">+</span><span class="num" id="2687080">1</span><span class="op" id="2687081">:</span><span class="op" id="2687082">]</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687087">//&nbsp;scan&nbsp;quoted&nbsp;string&nbsp;to&nbsp;find&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687125">i</span>&nbsp;<span class="op" id="2687127">=</span>&nbsp;<span class="num" id="2687129">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687133">for</span>&nbsp;<span class="ident" id="2687137">i</span>&nbsp;<span class="op" id="2687139">&lt;</span>&nbsp;<span class="builtinfunc" id="2687141">len</span><span class="op" id="2687144">(</span><span class="ident" id="2687145">tag</span><span class="op" id="2687148">)</span>&nbsp;<span class="op" id="2687150">&amp;&amp;</span>&nbsp;<span class="ident" id="2687153">tag</span><span class="op" id="2687156">[</span><span class="ident" id="2687157">i</span><span class="op" id="2687158">]</span>&nbsp;<span class="op" id="2687160">!=</span>&nbsp;<span class="string" id="2687163">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="2687167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687172">if</span>&nbsp;<span class="ident" id="2687175">tag</span><span class="op" id="2687178">[</span><span class="ident" id="2687179">i</span><span class="op" id="2687180">]</span>&nbsp;<span class="op" id="2687182">==</span>&nbsp;<span class="string" id="2687185">&#39;\\&#39;</span>&nbsp;<span class="op" id="2687190">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687196">i</span><span class="op" id="2687197">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687208">i</span><span class="op" id="2687209">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687218">if</span>&nbsp;<span class="ident" id="2687221">i</span>&nbsp;<span class="op" id="2687223">&gt;=</span>&nbsp;<span class="builtinfunc" id="2687226">len</span><span class="op" id="2687229">(</span><span class="ident" id="2687230">tag</span><span class="op" id="2687233">)</span>&nbsp;<span class="op" id="2687235">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687240">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687252">qvalue</span>&nbsp;<span class="op" id="2687259">:=</span>&nbsp;<span class="builtintype" id="2687262">string</span><span class="op" id="2687268">(</span><span class="ident" id="2687269">tag</span><span class="op" id="2687272">[</span><span class="op" id="2687273">:</span><span class="ident" id="2687274">i</span><span class="op" id="2687275">+</span><span class="num" id="2687276">1</span><span class="op" id="2687277">]</span><span class="op" id="2687278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687282">tag</span>&nbsp;<span class="op" id="2687286">=</span>&nbsp;<span class="ident" id="2687288">tag</span><span class="op" id="2687291">[</span><span class="ident" id="2687292">i</span><span class="op" id="2687293">+</span><span class="num" id="2687294">1</span><span class="op" id="2687295">:</span><span class="op" id="2687296">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687301">if</span>&nbsp;<span class="ident" id="2687304">key</span>&nbsp;<span class="op" id="2687308">==</span>&nbsp;<span class="ident" id="2687311">name</span>&nbsp;<span class="op" id="2687316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687321">value</span><span class="op" id="2687326">,</span>&nbsp;<span class="ident" id="2687328">_</span>&nbsp;<span class="op" id="2687330">:=</span>&nbsp;<span class="ident" id="2687333">strconv</span><span class="op" id="2687340">.</span><span class="ident" id="2687341">Unquote</span><span class="op" id="2687348">(</span><span class="ident" id="2687349">qvalue</span><span class="op" id="2687355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687360">return</span>&nbsp;<span class="ident" id="2687367">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687378">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687381">return</span>&nbsp;<span class="string" id="2687388">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2687391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2687394">//&nbsp;Field&nbsp;returns&nbsp;the&nbsp;i&#39;th&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="2687434">func</span>&nbsp;<span class="op" id="2687439">(</span><span class="ident" id="2687440">t</span>&nbsp;<span class="op" id="2687442">*</span><span class="ident" id="2687443">structType</span><span class="op" id="2687453">)</span>&nbsp;<span class="ident" id="2687455">Field</span><span class="op" id="2687460">(</span><span class="ident" id="2687461">i</span>&nbsp;<span class="builtintype" id="2687463">int</span><span class="op" id="2687466">)</span>&nbsp;<span class="op" id="2687468">(</span><span class="ident" id="2687469">f</span>&nbsp;<span class="ident" id="2687471">StructField</span><span class="op" id="2687482">)</span>&nbsp;<span class="op" id="2687484">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687487">if</span>&nbsp;<span class="ident" id="2687490">i</span>&nbsp;<span class="op" id="2687492">&lt;</span>&nbsp;<span class="num" id="2687494">0</span>&nbsp;<span class="op" id="2687496">||</span>&nbsp;<span class="ident" id="2687499">i</span>&nbsp;<span class="op" id="2687501">&gt;=</span>&nbsp;<span class="builtinfunc" id="2687504">len</span><span class="op" id="2687507">(</span><span class="ident" id="2687508">t</span><span class="op" id="2687509">.</span><span class="ident" id="2687510">fields</span><span class="op" id="2687516">)</span>&nbsp;<span class="op" id="2687518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687522">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687533">p</span>&nbsp;<span class="op" id="2687535">:=</span>&nbsp;<span class="op" id="2687538">&amp;</span><span class="ident" id="2687539">t</span><span class="op" id="2687540">.</span><span class="ident" id="2687541">fields</span><span class="op" id="2687547">[</span><span class="ident" id="2687548">i</span><span class="op" id="2687549">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687552">f</span><span class="op" id="2687553">.</span><span class="ident" id="2687554">Type</span>&nbsp;<span class="op" id="2687559">=</span>&nbsp;<span class="ident" id="2687561">toType</span><span class="op" id="2687567">(</span><span class="ident" id="2687568">p</span><span class="op" id="2687569">.</span><span class="ident" id="2687570">typ</span><span class="op" id="2687573">)</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687576">if</span>&nbsp;<span class="ident" id="2687579">p</span><span class="op" id="2687580">.</span><span class="ident" id="2687581">name</span>&nbsp;<span class="op" id="2687586">!=</span>&nbsp;<span class="ident" id="2687589">nil</span>&nbsp;<span class="op" id="2687593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687597">f</span><span class="op" id="2687598">.</span><span class="ident" id="2687599">Name</span>&nbsp;<span class="op" id="2687604">=</span>&nbsp;<span class="op" id="2687606">*</span><span class="ident" id="2687607">p</span><span class="op" id="2687608">.</span><span class="ident" id="2687609">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687615">}</span>&nbsp;<span class="keyword" id="2687617">else</span>&nbsp;<span class="op" id="2687622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687626">t</span>&nbsp;<span class="op" id="2687628">:=</span>&nbsp;<span class="ident" id="2687631">f</span><span class="op" id="2687632">.</span><span class="ident" id="2687633">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687640">if</span>&nbsp;<span class="ident" id="2687643">t</span><span class="op" id="2687644">.</span><span class="ident" id="2687645">Kind</span><span class="op" id="2687649">(</span><span class="op" id="2687650">)</span>&nbsp;<span class="op" id="2687652">==</span>&nbsp;<span class="ident" id="2687655">Ptr</span>&nbsp;<span class="op" id="2687659">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687664">t</span>&nbsp;<span class="op" id="2687666">=</span>&nbsp;<span class="ident" id="2687668">t</span><span class="op" id="2687669">.</span><span class="ident" id="2687670">Elem</span><span class="op" id="2687674">(</span><span class="op" id="2687675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687683">f</span><span class="op" id="2687684">.</span><span class="ident" id="2687685">Name</span>&nbsp;<span class="op" id="2687690">=</span>&nbsp;<span class="ident" id="2687692">t</span><span class="op" id="2687693">.</span><span class="ident" id="2687694">Name</span><span class="op" id="2687698">(</span><span class="op" id="2687699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687703">f</span><span class="op" id="2687704">.</span><span class="ident" id="2687705">Anonymous</span>&nbsp;<span class="op" id="2687715">=</span>&nbsp;<span class="builtintype" id="2687717">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687723">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687726">if</span>&nbsp;<span class="ident" id="2687729">p</span><span class="op" id="2687730">.</span><span class="ident" id="2687731">pkgPath</span>&nbsp;<span class="op" id="2687739">!=</span>&nbsp;<span class="ident" id="2687742">nil</span>&nbsp;<span class="op" id="2687746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687750">f</span><span class="op" id="2687751">.</span><span class="ident" id="2687752">PkgPath</span>&nbsp;<span class="op" id="2687760">=</span>&nbsp;<span class="op" id="2687762">*</span><span class="ident" id="2687763">p</span><span class="op" id="2687764">.</span><span class="ident" id="2687765">pkgPath</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2687777">if</span>&nbsp;<span class="ident" id="2687780">p</span><span class="op" id="2687781">.</span><span class="ident" id="2687782">tag</span>&nbsp;<span class="op" id="2687786">!=</span>&nbsp;<span class="ident" id="2687789">nil</span>&nbsp;<span class="op" id="2687793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687797">f</span><span class="op" id="2687798">.</span><span class="ident" id="2687799">Tag</span>&nbsp;<span class="op" id="2687803">=</span>&nbsp;<span class="ident" id="2687805">StructTag</span><span class="op" id="2687814">(</span><span class="op" id="2687815">*</span><span class="ident" id="2687816">p</span><span class="op" id="2687817">.</span><span class="ident" id="2687818">tag</span><span class="op" id="2687821">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2687824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2687827">f</span><span class="op" id="2687828">.</span><span class="ident" id="2687829">Offset</span>&nbsp;<span class="op" id="2687836">=</span>&nbsp;<span class="ident" id="2687838">p</span><span class="op" id="2687839">.</span><span class="ident" id="2687840">offset</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687849">//&nbsp;NOTE(rsc):&nbsp;This&nbsp;is&nbsp;the&nbsp;only&nbsp;allocation&nbsp;in&nbsp;the&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687909">//&nbsp;presented&nbsp;by&nbsp;a&nbsp;reflect.Type.&nbsp;&nbsp;It&nbsp;would&nbsp;be&nbsp;nice&nbsp;to&nbsp;avoid,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2687970">//&nbsp;at&nbsp;least&nbsp;in&nbsp;the&nbsp;common&nbsp;cases,&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688029">//&nbsp;that&nbsp;misbehaving&nbsp;clients&nbsp;of&nbsp;reflect&nbsp;cannot&nbsp;affect&nbsp;other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688089">//&nbsp;uses&nbsp;of&nbsp;reflect.&nbsp;&nbsp;One&nbsp;possibility&nbsp;is&nbsp;CL&nbsp;5371098,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688149">//&nbsp;postponed&nbsp;that&nbsp;ugliness&nbsp;until&nbsp;there&nbsp;is&nbsp;a&nbsp;demonstrated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2688207">//&nbsp;need&nbsp;for&nbsp;the&nbsp;performance.&nbsp;&nbsp;This&nbsp;is&nbsp;issue&nbsp;2320.</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688258">f</span><span class="op" id="2688259">.</span><span class="ident" id="2688260">Index</span>&nbsp;<span class="op" id="2688266">=</span>&nbsp;<span class="op" id="2688268">[</span><span class="op" id="2688269">]</span><span class="builtintype" id="2688270">int</span><span class="op" id="2688273">{</span><span class="ident" id="2688274">i</span><span class="op" id="2688275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688278">return</span><br>
<span class="lineno"></span><span class="op" id="2688285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2688288">//&nbsp;TODO(gri):&nbsp;Should&nbsp;there&nbsp;be&nbsp;an&nbsp;error/bool&nbsp;indicator&nbsp;if&nbsp;the&nbsp;index</span><br>
<span class="lineno">845</span><span class="comment" id="2688355">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;wrong&nbsp;for&nbsp;FieldByIndex?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2688397">//&nbsp;FieldByIndex&nbsp;returns&nbsp;the&nbsp;nested&nbsp;field&nbsp;corresponding&nbsp;to&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="2688462">func</span>&nbsp;<span class="op" id="2688467">(</span><span class="ident" id="2688468">t</span>&nbsp;<span class="op" id="2688470">*</span><span class="ident" id="2688471">structType</span><span class="op" id="2688481">)</span>&nbsp;<span class="ident" id="2688483">FieldByIndex</span><span class="op" id="2688495">(</span><span class="ident" id="2688496">index</span>&nbsp;<span class="op" id="2688502">[</span><span class="op" id="2688503">]</span><span class="builtintype" id="2688504">int</span><span class="op" id="2688507">)</span>&nbsp;<span class="op" id="2688509">(</span><span class="ident" id="2688510">f</span>&nbsp;<span class="ident" id="2688512">StructField</span><span class="op" id="2688523">)</span>&nbsp;<span class="op" id="2688525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688528">f</span><span class="op" id="2688529">.</span><span class="ident" id="2688530">Type</span>&nbsp;<span class="op" id="2688535">=</span>&nbsp;<span class="ident" id="2688537">toType</span><span class="op" id="2688543">(</span><span class="op" id="2688544">&amp;</span><span class="ident" id="2688545">t</span><span class="op" id="2688546">.</span><span class="ident" id="2688547">rtype</span><span class="op" id="2688552">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688555">for</span>&nbsp;<span class="ident" id="2688559">i</span><span class="op" id="2688560">,</span>&nbsp;<span class="ident" id="2688562">x</span>&nbsp;<span class="op" id="2688564">:=</span>&nbsp;<span class="keyword" id="2688567">range</span>&nbsp;<span class="ident" id="2688573">index</span>&nbsp;<span class="op" id="2688579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688583">if</span>&nbsp;<span class="ident" id="2688586">i</span>&nbsp;<span class="op" id="2688588">&gt;</span>&nbsp;<span class="num" id="2688590">0</span>&nbsp;<span class="op" id="2688592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688597">ft</span>&nbsp;<span class="op" id="2688600">:=</span>&nbsp;<span class="ident" id="2688603">f</span><span class="op" id="2688604">.</span><span class="ident" id="2688605">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688613">if</span>&nbsp;<span class="ident" id="2688616">ft</span><span class="op" id="2688618">.</span><span class="ident" id="2688619">Kind</span><span class="op" id="2688623">(</span><span class="op" id="2688624">)</span>&nbsp;<span class="op" id="2688626">==</span>&nbsp;<span class="ident" id="2688629">Ptr</span>&nbsp;<span class="op" id="2688633">&amp;&amp;</span>&nbsp;<span class="ident" id="2688636">ft</span><span class="op" id="2688638">.</span><span class="ident" id="2688639">Elem</span><span class="op" id="2688643">(</span><span class="op" id="2688644">)</span><span class="op" id="2688645">.</span><span class="ident" id="2688646">Kind</span><span class="op" id="2688650">(</span><span class="op" id="2688651">)</span>&nbsp;<span class="op" id="2688653">==</span>&nbsp;<span class="ident" id="2688656">Struct</span>&nbsp;<span class="op" id="2688663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688669">ft</span>&nbsp;<span class="op" id="2688672">=</span>&nbsp;<span class="ident" id="2688674">ft</span><span class="op" id="2688676">.</span><span class="ident" id="2688677">Elem</span><span class="op" id="2688681">(</span><span class="op" id="2688682">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688692">f</span><span class="op" id="2688693">.</span><span class="ident" id="2688694">Type</span>&nbsp;<span class="op" id="2688699">=</span>&nbsp;<span class="ident" id="2688701">ft</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688710">f</span>&nbsp;<span class="op" id="2688712">=</span>&nbsp;<span class="ident" id="2688714">f</span><span class="op" id="2688715">.</span><span class="ident" id="2688716">Type</span><span class="op" id="2688720">.</span><span class="ident" id="2688721">Field</span><span class="op" id="2688726">(</span><span class="ident" id="2688727">x</span><span class="op" id="2688728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2688731">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2688734">return</span><br>
<span class="lineno"></span><span class="op" id="2688741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2688744">//&nbsp;A&nbsp;fieldScan&nbsp;represents&nbsp;an&nbsp;item&nbsp;on&nbsp;the&nbsp;fieldByNameFunc&nbsp;scan&nbsp;work&nbsp;list.</span><br>
<span class="lineno"></span><span class="keyword" id="2688817">type</span>&nbsp;<span class="ident" id="2688822">fieldScan</span>&nbsp;<span class="keyword" id="2688832">struct</span>&nbsp;<span class="op" id="2688839">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688842">typ</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2688848">*</span><span class="ident" id="2688849">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2688861">index</span>&nbsp;<span class="op" id="2688867">[</span><span class="op" id="2688868">]</span><span class="builtintype" id="2688869">int</span><br>
<span class="lineno"></span><span class="op" id="2688873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2688876">//&nbsp;FieldByNameFunc&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;a&nbsp;name&nbsp;that&nbsp;satisfies&nbsp;the</span><br>
<span class="lineno">870</span><span class="comment" id="2688951">//&nbsp;match&nbsp;function&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2689019">func</span>&nbsp;<span class="op" id="2689024">(</span><span class="ident" id="2689025">t</span>&nbsp;<span class="op" id="2689027">*</span><span class="ident" id="2689028">structType</span><span class="op" id="2689038">)</span>&nbsp;<span class="ident" id="2689040">FieldByNameFunc</span><span class="op" id="2689055">(</span><span class="ident" id="2689056">match</span>&nbsp;<span class="keyword" id="2689062">func</span><span class="op" id="2689066">(</span><span class="builtintype" id="2689067">string</span><span class="op" id="2689073">)</span>&nbsp;<span class="builtintype" id="2689075">bool</span><span class="op" id="2689079">)</span>&nbsp;<span class="op" id="2689081">(</span><span class="ident" id="2689082">result</span>&nbsp;<span class="ident" id="2689089">StructField</span><span class="op" id="2689100">,</span>&nbsp;<span class="ident" id="2689102">ok</span>&nbsp;<span class="builtintype" id="2689105">bool</span><span class="op" id="2689109">)</span>&nbsp;<span class="op" id="2689111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689114">//&nbsp;This&nbsp;uses&nbsp;the&nbsp;same&nbsp;condition&nbsp;that&nbsp;the&nbsp;Go&nbsp;language&nbsp;does:&nbsp;there&nbsp;must&nbsp;be&nbsp;a&nbsp;unique&nbsp;instance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689206">//&nbsp;of&nbsp;the&nbsp;match&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level.&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;instances&nbsp;of&nbsp;a&nbsp;match&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689297">//&nbsp;same&nbsp;depth,&nbsp;they&nbsp;annihilate&nbsp;each&nbsp;other&nbsp;and&nbsp;inhibit&nbsp;any&nbsp;possible&nbsp;match&nbsp;at&nbsp;a&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689389">//&nbsp;The&nbsp;algorithm&nbsp;is&nbsp;breadth&nbsp;first&nbsp;search,&nbsp;one&nbsp;depth&nbsp;level&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689460">//&nbsp;The&nbsp;current&nbsp;and&nbsp;next&nbsp;slices&nbsp;are&nbsp;work&nbsp;queues:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689509">//&nbsp;current&nbsp;lists&nbsp;the&nbsp;fields&nbsp;to&nbsp;visit&nbsp;on&nbsp;this&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689568">//&nbsp;and&nbsp;next&nbsp;lists&nbsp;the&nbsp;fields&nbsp;on&nbsp;the&nbsp;next&nbsp;lower&nbsp;level.</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689623">current</span>&nbsp;<span class="op" id="2689631">:=</span>&nbsp;<span class="op" id="2689634">[</span><span class="op" id="2689635">]</span><span class="ident" id="2689636">fieldScan</span><span class="op" id="2689645">{</span><span class="op" id="2689646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2689649">next</span>&nbsp;<span class="op" id="2689654">:=</span>&nbsp;<span class="op" id="2689657">[</span><span class="op" id="2689658">]</span><span class="ident" id="2689659">fieldScan</span><span class="op" id="2689668">{</span><span class="op" id="2689669">{</span><span class="ident" id="2689670">typ</span><span class="op" id="2689673">:</span>&nbsp;<span class="ident" id="2689675">t</span><span class="op" id="2689676">}</span><span class="op" id="2689677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689681">//&nbsp;nextCount&nbsp;records&nbsp;the&nbsp;number&nbsp;of&nbsp;times&nbsp;an&nbsp;embedded&nbsp;type&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689749">//&nbsp;encountered&nbsp;and&nbsp;considered&nbsp;for&nbsp;queueing&nbsp;in&nbsp;the&nbsp;&#39;next&#39;&nbsp;slice.</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689814">//&nbsp;We&nbsp;only&nbsp;queue&nbsp;the&nbsp;first&nbsp;one,&nbsp;but&nbsp;we&nbsp;increment&nbsp;the&nbsp;count&nbsp;on&nbsp;each.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689883">//&nbsp;If&nbsp;a&nbsp;struct&nbsp;type&nbsp;T&nbsp;can&nbsp;be&nbsp;reached&nbsp;more&nbsp;than&nbsp;once&nbsp;at&nbsp;a&nbsp;given&nbsp;depth&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2689960">//&nbsp;then&nbsp;it&nbsp;annihilates&nbsp;itself&nbsp;and&nbsp;need&nbsp;not&nbsp;be&nbsp;considered&nbsp;at&nbsp;all&nbsp;when&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690033">//&nbsp;process&nbsp;that&nbsp;next&nbsp;depth&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690068">var</span>&nbsp;<span class="ident" id="2690072">nextCount</span>&nbsp;<span class="keyword" id="2690082">map</span><span class="op" id="2690085">[</span><span class="op" id="2690086">*</span><span class="ident" id="2690087">structType</span><span class="op" id="2690097">]</span><span class="builtintype" id="2690098">int</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690104">//&nbsp;visited&nbsp;records&nbsp;the&nbsp;structs&nbsp;that&nbsp;have&nbsp;been&nbsp;considered&nbsp;already.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690171">//&nbsp;Embedded&nbsp;pointer&nbsp;fields&nbsp;can&nbsp;create&nbsp;cycles&nbsp;in&nbsp;the&nbsp;graph&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690233">//&nbsp;reachable&nbsp;embedded&nbsp;types;&nbsp;visited&nbsp;avoids&nbsp;following&nbsp;those&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690302">//&nbsp;It&nbsp;also&nbsp;avoids&nbsp;duplicated&nbsp;effort:&nbsp;if&nbsp;we&nbsp;didn&#39;t&nbsp;find&nbsp;the&nbsp;field&nbsp;in&nbsp;an</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690374">//&nbsp;embedded&nbsp;type&nbsp;T&nbsp;at&nbsp;level&nbsp;2,&nbsp;we&nbsp;won&#39;t&nbsp;find&nbsp;it&nbsp;in&nbsp;one&nbsp;at&nbsp;level&nbsp;4&nbsp;either.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690449">visited</span>&nbsp;<span class="op" id="2690457">:=</span>&nbsp;<span class="keyword" id="2690460">map</span><span class="op" id="2690463">[</span><span class="op" id="2690464">*</span><span class="ident" id="2690465">structType</span><span class="op" id="2690475">]</span><span class="builtintype" id="2690476">bool</span><span class="op" id="2690480">{</span><span class="op" id="2690481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690485">for</span>&nbsp;<span class="builtinfunc" id="2690489">len</span><span class="op" id="2690492">(</span><span class="ident" id="2690493">next</span><span class="op" id="2690497">)</span>&nbsp;<span class="op" id="2690499">&gt;</span>&nbsp;<span class="num" id="2690501">0</span>&nbsp;<span class="op" id="2690503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690507">current</span><span class="op" id="2690514">,</span>&nbsp;<span class="ident" id="2690516">next</span>&nbsp;<span class="op" id="2690521">=</span>&nbsp;<span class="ident" id="2690523">next</span><span class="op" id="2690527">,</span>&nbsp;<span class="ident" id="2690529">current</span><span class="op" id="2690536">[</span><span class="op" id="2690537">:</span><span class="num" id="2690538">0</span><span class="op" id="2690539">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690543">count</span>&nbsp;<span class="op" id="2690549">:=</span>&nbsp;<span class="ident" id="2690552">nextCount</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690564">nextCount</span>&nbsp;<span class="op" id="2690574">=</span>&nbsp;<span class="ident" id="2690576">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690583">//&nbsp;Process&nbsp;all&nbsp;the&nbsp;fields&nbsp;at&nbsp;this&nbsp;depth,&nbsp;now&nbsp;listed&nbsp;in&nbsp;&#39;current&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690651">//&nbsp;The&nbsp;loop&nbsp;queues&nbsp;embedded&nbsp;fields&nbsp;found&nbsp;in&nbsp;&#39;next&#39;,&nbsp;for&nbsp;processing&nbsp;during&nbsp;the&nbsp;next</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690736">//&nbsp;iteration.&nbsp;The&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;current&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690811">//&nbsp;in&nbsp;&#39;count&#39;;&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;&#39;next&#39;&nbsp;field&nbsp;counts&nbsp;is&nbsp;recorded&nbsp;in&nbsp;&#39;nextCount&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690900">for</span>&nbsp;<span class="ident" id="2690904">_</span><span class="op" id="2690905">,</span>&nbsp;<span class="ident" id="2690907">scan</span>&nbsp;<span class="op" id="2690912">:=</span>&nbsp;<span class="keyword" id="2690915">range</span>&nbsp;<span class="ident" id="2690921">current</span>&nbsp;<span class="op" id="2690929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2690934">t</span>&nbsp;<span class="op" id="2690936">:=</span>&nbsp;<span class="ident" id="2690939">scan</span><span class="op" id="2690943">.</span><span class="ident" id="2690944">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2690951">if</span>&nbsp;<span class="ident" id="2690954">visited</span><span class="op" id="2690961">[</span><span class="ident" id="2690962">t</span><span class="op" id="2690963">]</span>&nbsp;<span class="op" id="2690965">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2690971">//&nbsp;We&#39;ve&nbsp;looked&nbsp;through&nbsp;this&nbsp;type&nbsp;before,&nbsp;at&nbsp;a&nbsp;higher&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2691036">//&nbsp;That&nbsp;higher&nbsp;level&nbsp;would&nbsp;shadow&nbsp;the&nbsp;lower&nbsp;level&nbsp;we&#39;re&nbsp;now&nbsp;at,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2691104">//&nbsp;so&nbsp;this&nbsp;one&nbsp;can&#39;t&nbsp;be&nbsp;useful&nbsp;to&nbsp;us.&nbsp;Ignore&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691157">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691169">}</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691174">visited</span><span class="op" id="2691181">[</span><span class="ident" id="2691182">t</span><span class="op" id="2691183">]</span>&nbsp;<span class="op" id="2691185">=</span>&nbsp;<span class="builtintype" id="2691187">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691195">for</span>&nbsp;<span class="ident" id="2691199">i</span>&nbsp;<span class="op" id="2691201">:=</span>&nbsp;<span class="keyword" id="2691204">range</span>&nbsp;<span class="ident" id="2691210">t</span><span class="op" id="2691211">.</span><span class="ident" id="2691212">fields</span>&nbsp;<span class="op" id="2691219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691225">f</span>&nbsp;<span class="op" id="2691227">:=</span>&nbsp;<span class="op" id="2691230">&amp;</span><span class="ident" id="2691231">t</span><span class="op" id="2691232">.</span><span class="ident" id="2691233">fields</span><span class="op" id="2691239">[</span><span class="ident" id="2691240">i</span><span class="op" id="2691241">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2691247">//&nbsp;Find&nbsp;name&nbsp;and&nbsp;type&nbsp;for&nbsp;field&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691286">var</span>&nbsp;<span class="ident" id="2691290">fname</span>&nbsp;<span class="builtintype" id="2691296">string</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691307">var</span>&nbsp;<span class="ident" id="2691311">ntyp</span>&nbsp;<span class="op" id="2691316">*</span><span class="ident" id="2691317">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691327">if</span>&nbsp;<span class="ident" id="2691330">f</span><span class="op" id="2691331">.</span><span class="ident" id="2691332">name</span>&nbsp;<span class="op" id="2691337">!=</span>&nbsp;<span class="ident" id="2691340">nil</span>&nbsp;<span class="op" id="2691344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691351">fname</span>&nbsp;<span class="op" id="2691357">=</span>&nbsp;<span class="op" id="2691359">*</span><span class="ident" id="2691360">f</span><span class="op" id="2691361">.</span><span class="ident" id="2691362">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691371">}</span>&nbsp;<span class="keyword" id="2691373">else</span>&nbsp;<span class="op" id="2691378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2691385">//&nbsp;Anonymous&nbsp;field&nbsp;of&nbsp;type&nbsp;T&nbsp;or&nbsp;*T.</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2691426">//&nbsp;Name&nbsp;taken&nbsp;from&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691456">ntyp</span>&nbsp;<span class="op" id="2691461">=</span>&nbsp;<span class="ident" id="2691463">f</span><span class="op" id="2691464">.</span><span class="ident" id="2691465">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691474">if</span>&nbsp;<span class="ident" id="2691477">ntyp</span><span class="op" id="2691481">.</span><span class="ident" id="2691482">Kind</span><span class="op" id="2691486">(</span><span class="op" id="2691487">)</span>&nbsp;<span class="op" id="2691489">==</span>&nbsp;<span class="ident" id="2691492">Ptr</span>&nbsp;<span class="op" id="2691496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691504">ntyp</span>&nbsp;<span class="op" id="2691509">=</span>&nbsp;<span class="ident" id="2691511">ntyp</span><span class="op" id="2691515">.</span><span class="ident" id="2691516">Elem</span><span class="op" id="2691520">(</span><span class="op" id="2691521">)</span><span class="op" id="2691522">.</span><span class="ident" id="2691523">common</span><span class="op" id="2691529">(</span><span class="op" id="2691530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691537">}</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691544">fname</span>&nbsp;<span class="op" id="2691550">=</span>&nbsp;<span class="ident" id="2691552">ntyp</span><span class="op" id="2691556">.</span><span class="ident" id="2691557">Name</span><span class="op" id="2691561">(</span><span class="op" id="2691562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2691575">//&nbsp;Does&nbsp;it&nbsp;match?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691597">if</span>&nbsp;<span class="ident" id="2691600">match</span><span class="op" id="2691605">(</span><span class="ident" id="2691606">fname</span><span class="op" id="2691611">)</span>&nbsp;<span class="op" id="2691613">{</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2691620">//&nbsp;Potential&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691644">if</span>&nbsp;<span class="ident" id="2691647">count</span><span class="op" id="2691652">[</span><span class="ident" id="2691653">t</span><span class="op" id="2691654">]</span>&nbsp;<span class="op" id="2691656">&gt;</span>&nbsp;<span class="num" id="2691658">1</span>&nbsp;<span class="op" id="2691660">||</span>&nbsp;<span class="ident" id="2691663">ok</span>&nbsp;<span class="op" id="2691666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2691674">//&nbsp;Name&nbsp;appeared&nbsp;multiple&nbsp;times&nbsp;at&nbsp;this&nbsp;level:&nbsp;annihilate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691739">return</span>&nbsp;<span class="ident" id="2691746">StructField</span><span class="op" id="2691757">{</span><span class="op" id="2691758">}</span><span class="op" id="2691759">,</span>&nbsp;<span class="builtintype" id="2691761">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691772">}</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691779">result</span>&nbsp;<span class="op" id="2691786">=</span>&nbsp;<span class="ident" id="2691788">t</span><span class="op" id="2691789">.</span><span class="ident" id="2691790">Field</span><span class="op" id="2691795">(</span><span class="ident" id="2691796">i</span><span class="op" id="2691797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691804">result</span><span class="op" id="2691810">.</span><span class="ident" id="2691811">Index</span>&nbsp;<span class="op" id="2691817">=</span>&nbsp;<span class="ident" id="2691819">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691828">result</span><span class="op" id="2691834">.</span><span class="ident" id="2691835">Index</span>&nbsp;<span class="op" id="2691841">=</span>&nbsp;<span class="builtinfunc" id="2691843">append</span><span class="op" id="2691849">(</span><span class="ident" id="2691850">result</span><span class="op" id="2691856">.</span><span class="ident" id="2691857">Index</span><span class="op" id="2691862">,</span>&nbsp;<span class="ident" id="2691864">scan</span><span class="op" id="2691868">.</span><span class="ident" id="2691869">index</span><span class="op" id="2691874">...</span><span class="op" id="2691877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691884">result</span><span class="op" id="2691890">.</span><span class="ident" id="2691891">Index</span>&nbsp;<span class="op" id="2691897">=</span>&nbsp;<span class="builtinfunc" id="2691899">append</span><span class="op" id="2691905">(</span><span class="ident" id="2691906">result</span><span class="op" id="2691912">.</span><span class="ident" id="2691913">Index</span><span class="op" id="2691918">,</span>&nbsp;<span class="ident" id="2691920">i</span><span class="op" id="2691921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2691928">ok</span>&nbsp;<span class="op" id="2691931">=</span>&nbsp;<span class="builtintype" id="2691933">true</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2691943">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2691956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2691963">//&nbsp;Queue&nbsp;embedded&nbsp;struct&nbsp;fields&nbsp;for&nbsp;processing&nbsp;with&nbsp;next&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692031">//&nbsp;but&nbsp;only&nbsp;if&nbsp;we&nbsp;haven&#39;t&nbsp;seen&nbsp;a&nbsp;match&nbsp;yet&nbsp;at&nbsp;this&nbsp;level&nbsp;and&nbsp;only</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692101">//&nbsp;if&nbsp;the&nbsp;embedded&nbsp;types&nbsp;haven&#39;t&nbsp;already&nbsp;been&nbsp;queued.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692159">if</span>&nbsp;<span class="ident" id="2692162">ok</span>&nbsp;<span class="op" id="2692165">||</span>&nbsp;<span class="ident" id="2692168">ntyp</span>&nbsp;<span class="op" id="2692173">==</span>&nbsp;<span class="ident" id="2692176">nil</span>&nbsp;<span class="op" id="2692180">||</span>&nbsp;<span class="ident" id="2692183">ntyp</span><span class="op" id="2692187">.</span><span class="ident" id="2692188">Kind</span><span class="op" id="2692192">(</span><span class="op" id="2692193">)</span>&nbsp;<span class="op" id="2692195">!=</span>&nbsp;<span class="ident" id="2692198">Struct</span>&nbsp;<span class="op" id="2692205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692212">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692231">styp</span>&nbsp;<span class="op" id="2692236">:=</span>&nbsp;<span class="op" id="2692239">(</span><span class="op" id="2692240">*</span><span class="ident" id="2692241">structType</span><span class="op" id="2692251">)</span><span class="op" id="2692252">(</span><span class="ident" id="2692253">unsafe</span><span class="op" id="2692259">.</span><span class="ident" id="2692260">Pointer</span><span class="op" id="2692267">(</span><span class="ident" id="2692268">ntyp</span><span class="op" id="2692272">)</span><span class="op" id="2692273">)</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692279">if</span>&nbsp;<span class="ident" id="2692282">nextCount</span><span class="op" id="2692291">[</span><span class="ident" id="2692292">styp</span><span class="op" id="2692296">]</span>&nbsp;<span class="op" id="2692298">&gt;</span>&nbsp;<span class="num" id="2692300">0</span>&nbsp;<span class="op" id="2692302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692309">nextCount</span><span class="op" id="2692318">[</span><span class="ident" id="2692319">styp</span><span class="op" id="2692323">]</span>&nbsp;<span class="op" id="2692325">=</span>&nbsp;<span class="num" id="2692327">2</span>&nbsp;<span class="comment" id="2692329">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692367">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692386">if</span>&nbsp;<span class="ident" id="2692389">nextCount</span>&nbsp;<span class="op" id="2692399">==</span>&nbsp;<span class="ident" id="2692402">nil</span>&nbsp;<span class="op" id="2692406">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692413">nextCount</span>&nbsp;<span class="op" id="2692423">=</span>&nbsp;<span class="keyword" id="2692425">map</span><span class="op" id="2692428">[</span><span class="op" id="2692429">*</span><span class="ident" id="2692430">structType</span><span class="op" id="2692440">]</span><span class="builtintype" id="2692441">int</span><span class="op" id="2692444">{</span><span class="op" id="2692445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692457">nextCount</span><span class="op" id="2692466">[</span><span class="ident" id="2692467">styp</span><span class="op" id="2692471">]</span>&nbsp;<span class="op" id="2692473">=</span>&nbsp;<span class="num" id="2692475">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692481">if</span>&nbsp;<span class="ident" id="2692484">count</span><span class="op" id="2692489">[</span><span class="ident" id="2692490">t</span><span class="op" id="2692491">]</span>&nbsp;<span class="op" id="2692493">&gt;</span>&nbsp;<span class="num" id="2692495">1</span>&nbsp;<span class="op" id="2692497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692504">nextCount</span><span class="op" id="2692513">[</span><span class="ident" id="2692514">styp</span><span class="op" id="2692518">]</span>&nbsp;<span class="op" id="2692520">=</span>&nbsp;<span class="num" id="2692522">2</span>&nbsp;<span class="comment" id="2692524">//&nbsp;exact&nbsp;multiple&nbsp;doesn&#39;t&nbsp;matter</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692567">var</span>&nbsp;<span class="ident" id="2692571">index</span>&nbsp;<span class="op" id="2692577">[</span><span class="op" id="2692578">]</span><span class="builtintype" id="2692579">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692587">index</span>&nbsp;<span class="op" id="2692593">=</span>&nbsp;<span class="builtinfunc" id="2692595">append</span><span class="op" id="2692601">(</span><span class="ident" id="2692602">index</span><span class="op" id="2692607">,</span>&nbsp;<span class="ident" id="2692609">scan</span><span class="op" id="2692613">.</span><span class="ident" id="2692614">index</span><span class="op" id="2692619">...</span><span class="op" id="2692622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692628">index</span>&nbsp;<span class="op" id="2692634">=</span>&nbsp;<span class="builtinfunc" id="2692636">append</span><span class="op" id="2692642">(</span><span class="ident" id="2692643">index</span><span class="op" id="2692648">,</span>&nbsp;<span class="ident" id="2692650">i</span><span class="op" id="2692651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2692657">next</span>&nbsp;<span class="op" id="2692662">=</span>&nbsp;<span class="builtinfunc" id="2692664">append</span><span class="op" id="2692670">(</span><span class="ident" id="2692671">next</span><span class="op" id="2692675">,</span>&nbsp;<span class="ident" id="2692677">fieldScan</span><span class="op" id="2692686">{</span><span class="ident" id="2692687">styp</span><span class="op" id="2692691">,</span>&nbsp;<span class="ident" id="2692693">index</span><span class="op" id="2692698">}</span><span class="op" id="2692699">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692712">if</span>&nbsp;<span class="ident" id="2692715">ok</span>&nbsp;<span class="op" id="2692718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692723">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692731">}</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2692734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2692737">return</span><br>
<span class="lineno"></span><span class="op" id="2692744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2692747">//&nbsp;FieldByName&nbsp;returns&nbsp;the&nbsp;struct&nbsp;field&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">980</span><span class="comment" id="2692807">//&nbsp;and&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="2692860">func</span>&nbsp;<span class="op" id="2692865">(</span><span class="ident" id="2692866">t</span>&nbsp;<span class="op" id="2692868">*</span><span class="ident" id="2692869">structType</span><span class="op" id="2692879">)</span>&nbsp;<span class="ident" id="2692881">FieldByName</span><span class="op" id="2692892">(</span><span class="ident" id="2692893">name</span>&nbsp;<span class="builtintype" id="2692898">string</span><span class="op" id="2692904">)</span>&nbsp;<span class="op" id="2692906">(</span><span class="ident" id="2692907">f</span>&nbsp;<span class="ident" id="2692909">StructField</span><span class="op" id="2692920">,</span>&nbsp;<span class="ident" id="2692922">present</span>&nbsp;<span class="builtintype" id="2692930">bool</span><span class="op" id="2692934">)</span>&nbsp;<span class="op" id="2692936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2692939">//&nbsp;Quick&nbsp;check&nbsp;for&nbsp;top-level&nbsp;name,&nbsp;or&nbsp;struct&nbsp;without&nbsp;anonymous&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693011">hasAnon</span>&nbsp;<span class="op" id="2693019">:=</span>&nbsp;<span class="builtintype" id="2693022">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693029">if</span>&nbsp;<span class="ident" id="2693032">name</span>&nbsp;<span class="op" id="2693037">!=</span>&nbsp;<span class="string" id="2693040">&#34;&#34;</span>&nbsp;<span class="op" id="2693043">{</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693047">for</span>&nbsp;<span class="ident" id="2693051">i</span>&nbsp;<span class="op" id="2693053">:=</span>&nbsp;<span class="keyword" id="2693056">range</span>&nbsp;<span class="ident" id="2693062">t</span><span class="op" id="2693063">.</span><span class="ident" id="2693064">fields</span>&nbsp;<span class="op" id="2693071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693076">tf</span>&nbsp;<span class="op" id="2693079">:=</span>&nbsp;<span class="op" id="2693082">&amp;</span><span class="ident" id="2693083">t</span><span class="op" id="2693084">.</span><span class="ident" id="2693085">fields</span><span class="op" id="2693091">[</span><span class="ident" id="2693092">i</span><span class="op" id="2693093">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693098">if</span>&nbsp;<span class="ident" id="2693101">tf</span><span class="op" id="2693103">.</span><span class="ident" id="2693104">name</span>&nbsp;<span class="op" id="2693109">==</span>&nbsp;<span class="ident" id="2693112">nil</span>&nbsp;<span class="op" id="2693116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693122">hasAnon</span>&nbsp;<span class="op" id="2693130">=</span>&nbsp;<span class="builtintype" id="2693132">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693141">continue</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693158">if</span>&nbsp;<span class="op" id="2693161">*</span><span class="ident" id="2693162">tf</span><span class="op" id="2693164">.</span><span class="ident" id="2693165">name</span>&nbsp;<span class="op" id="2693170">==</span>&nbsp;<span class="ident" id="2693173">name</span>&nbsp;<span class="op" id="2693178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693184">return</span>&nbsp;<span class="ident" id="2693191">t</span><span class="op" id="2693192">.</span><span class="ident" id="2693193">Field</span><span class="op" id="2693198">(</span><span class="ident" id="2693199">i</span><span class="op" id="2693200">)</span><span class="op" id="2693201">,</span>&nbsp;<span class="builtintype" id="2693203">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693215">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693221">if</span>&nbsp;<span class="op" id="2693224">!</span><span class="ident" id="2693225">hasAnon</span>&nbsp;<span class="op" id="2693233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693237">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693248">return</span>&nbsp;<span class="ident" id="2693255">t</span><span class="op" id="2693256">.</span><span class="ident" id="2693257">FieldByNameFunc</span><span class="op" id="2693272">(</span><span class="keyword" id="2693273">func</span><span class="op" id="2693277">(</span><span class="ident" id="2693278">s</span>&nbsp;<span class="builtintype" id="2693280">string</span><span class="op" id="2693286">)</span>&nbsp;<span class="builtintype" id="2693288">bool</span>&nbsp;<span class="op" id="2693293">{</span>&nbsp;<span class="keyword" id="2693295">return</span>&nbsp;<span class="ident" id="2693302">s</span>&nbsp;<span class="op" id="2693304">==</span>&nbsp;<span class="ident" id="2693307">name</span>&nbsp;<span class="op" id="2693312">}</span><span class="op" id="2693313">)</span><br>
<span class="lineno">1000</span><span class="op" id="2693315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2693318">//&nbsp;TypeOf&nbsp;returns&nbsp;the&nbsp;reflection&nbsp;Type&nbsp;of&nbsp;the&nbsp;value&nbsp;in&nbsp;the&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="2693389">//&nbsp;TypeOf(nil)&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2693417">func</span>&nbsp;<span class="ident" id="2693422">TypeOf</span><span class="op" id="2693428">(</span><span class="ident" id="2693429">i</span>&nbsp;<span class="keyword" id="2693431">interface</span><span class="op" id="2693440">{</span><span class="op" id="2693441">}</span><span class="op" id="2693442">)</span>&nbsp;<span class="ident" id="2693444">Type</span>&nbsp;<span class="op" id="2693449">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693452">eface</span>&nbsp;<span class="op" id="2693458">:=</span>&nbsp;<span class="op" id="2693461">*</span><span class="op" id="2693462">(</span><span class="op" id="2693463">*</span><span class="ident" id="2693464">emptyInterface</span><span class="op" id="2693478">)</span><span class="op" id="2693479">(</span><span class="ident" id="2693480">unsafe</span><span class="op" id="2693486">.</span><span class="ident" id="2693487">Pointer</span><span class="op" id="2693494">(</span><span class="op" id="2693495">&amp;</span><span class="ident" id="2693496">i</span><span class="op" id="2693497">)</span><span class="op" id="2693498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693501">return</span>&nbsp;<span class="ident" id="2693508">toType</span><span class="op" id="2693514">(</span><span class="ident" id="2693515">eface</span><span class="op" id="2693520">.</span><span class="ident" id="2693521">typ</span><span class="op" id="2693524">)</span><br>
<span class="lineno"></span><span class="op" id="2693526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2693529">//&nbsp;ptrMap&nbsp;is&nbsp;the&nbsp;cache&nbsp;for&nbsp;PtrTo.</span><br>
<span class="lineno">1010</span><span class="keyword" id="2693563">var</span>&nbsp;<span class="ident" id="2693567">ptrMap</span>&nbsp;<span class="keyword" id="2693574">struct</span>&nbsp;<span class="op" id="2693581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693584">sync</span><span class="op" id="2693588">.</span><span class="ident" id="2693589">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2693598">m</span>&nbsp;<span class="keyword" id="2693600">map</span><span class="op" id="2693603">[</span><span class="op" id="2693604">*</span><span class="ident" id="2693605">rtype</span><span class="op" id="2693610">]</span><span class="op" id="2693611">*</span><span class="ident" id="2693612">ptrType</span><br>
<span class="lineno"></span><span class="op" id="2693620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1015</span><span class="comment" id="2693623">//&nbsp;PtrTo&nbsp;returns&nbsp;the&nbsp;pointer&nbsp;type&nbsp;with&nbsp;element&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2693673">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;type&nbsp;Foo,&nbsp;PtrTo(t)&nbsp;represents&nbsp;*Foo.</span><br>
<span class="lineno"></span><span class="keyword" id="2693741">func</span>&nbsp;<span class="ident" id="2693746">PtrTo</span><span class="op" id="2693751">(</span><span class="ident" id="2693752">t</span>&nbsp;<span class="ident" id="2693754">Type</span><span class="op" id="2693758">)</span>&nbsp;<span class="ident" id="2693760">Type</span>&nbsp;<span class="op" id="2693765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693768">return</span>&nbsp;<span class="ident" id="2693775">t</span><span class="op" id="2693776">.</span><span class="op" id="2693777">(</span><span class="op" id="2693778">*</span><span class="ident" id="2693779">rtype</span><span class="op" id="2693784">)</span><span class="op" id="2693785">.</span><span class="ident" id="2693786">ptrTo</span><span class="op" id="2693791">(</span><span class="op" id="2693792">)</span><br>
<span class="lineno"></span><span class="op" id="2693794">}</span><br>
<span class="lineno">1020</span><br>
<span class="lineno"></span><span class="keyword" id="2693797">func</span>&nbsp;<span class="op" id="2693802">(</span><span class="ident" id="2693803">t</span>&nbsp;<span class="op" id="2693805">*</span><span class="ident" id="2693806">rtype</span><span class="op" id="2693811">)</span>&nbsp;<span class="ident" id="2693813">ptrTo</span><span class="op" id="2693818">(</span><span class="op" id="2693819">)</span>&nbsp;<span class="op" id="2693821">*</span><span class="ident" id="2693822">rtype</span>&nbsp;<span class="op" id="2693828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693831">if</span>&nbsp;<span class="ident" id="2693834">p</span>&nbsp;<span class="op" id="2693836">:=</span>&nbsp;<span class="ident" id="2693839">t</span><span class="op" id="2693840">.</span><span class="ident" id="2693841">ptrToThis</span><span class="op" id="2693850">;</span>&nbsp;<span class="ident" id="2693852">p</span>&nbsp;<span class="op" id="2693854">!=</span>&nbsp;<span class="ident" id="2693857">nil</span>&nbsp;<span class="op" id="2693861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2693865">return</span>&nbsp;<span class="ident" id="2693872">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2693875">}</span><br>
<span class="lineno">1025</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693879">//&nbsp;Otherwise,&nbsp;synthesize&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693910">//&nbsp;This&nbsp;only&nbsp;happens&nbsp;for&nbsp;pointers&nbsp;with&nbsp;no&nbsp;methods.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2693962">//&nbsp;We&nbsp;keep&nbsp;the&nbsp;mapping&nbsp;in&nbsp;a&nbsp;map&nbsp;on&nbsp;the&nbsp;side,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694016">//&nbsp;this&nbsp;operation&nbsp;is&nbsp;rare&nbsp;and&nbsp;a&nbsp;separate&nbsp;map&nbsp;lets&nbsp;us&nbsp;keep</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694075">//&nbsp;the&nbsp;type&nbsp;structures&nbsp;in&nbsp;read-only&nbsp;memory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694120">ptrMap</span><span class="op" id="2694126">.</span><span class="ident" id="2694127">RLock</span><span class="op" id="2694132">(</span><span class="op" id="2694133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694136">if</span>&nbsp;<span class="ident" id="2694139">m</span>&nbsp;<span class="op" id="2694141">:=</span>&nbsp;<span class="ident" id="2694144">ptrMap</span><span class="op" id="2694150">.</span><span class="ident" id="2694151">m</span><span class="op" id="2694152">;</span>&nbsp;<span class="ident" id="2694154">m</span>&nbsp;<span class="op" id="2694156">!=</span>&nbsp;<span class="ident" id="2694159">nil</span>&nbsp;<span class="op" id="2694163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694167">if</span>&nbsp;<span class="ident" id="2694170">p</span>&nbsp;<span class="op" id="2694172">:=</span>&nbsp;<span class="ident" id="2694175">m</span><span class="op" id="2694176">[</span><span class="ident" id="2694177">t</span><span class="op" id="2694178">]</span><span class="op" id="2694179">;</span>&nbsp;<span class="ident" id="2694181">p</span>&nbsp;<span class="op" id="2694183">!=</span>&nbsp;<span class="ident" id="2694186">nil</span>&nbsp;<span class="op" id="2694190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694195">ptrMap</span><span class="op" id="2694201">.</span><span class="ident" id="2694202">RUnlock</span><span class="op" id="2694209">(</span><span class="op" id="2694210">)</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694215">return</span>&nbsp;<span class="op" id="2694222">&amp;</span><span class="ident" id="2694223">p</span><span class="op" id="2694224">.</span><span class="ident" id="2694225">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2694233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2694236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694239">ptrMap</span><span class="op" id="2694245">.</span><span class="ident" id="2694246">RUnlock</span><span class="op" id="2694253">(</span><span class="op" id="2694254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694257">ptrMap</span><span class="op" id="2694263">.</span><span class="ident" id="2694264">Lock</span><span class="op" id="2694268">(</span><span class="op" id="2694269">)</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694272">if</span>&nbsp;<span class="ident" id="2694275">ptrMap</span><span class="op" id="2694281">.</span><span class="ident" id="2694282">m</span>&nbsp;<span class="op" id="2694284">==</span>&nbsp;<span class="ident" id="2694287">nil</span>&nbsp;<span class="op" id="2694291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694295">ptrMap</span><span class="op" id="2694301">.</span><span class="ident" id="2694302">m</span>&nbsp;<span class="op" id="2694304">=</span>&nbsp;<span class="builtinfunc" id="2694306">make</span><span class="op" id="2694310">(</span><span class="keyword" id="2694311">map</span><span class="op" id="2694314">[</span><span class="op" id="2694315">*</span><span class="ident" id="2694316">rtype</span><span class="op" id="2694321">]</span><span class="op" id="2694322">*</span><span class="ident" id="2694323">ptrType</span><span class="op" id="2694330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2694333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694336">p</span>&nbsp;<span class="op" id="2694338">:=</span>&nbsp;<span class="ident" id="2694341">ptrMap</span><span class="op" id="2694347">.</span><span class="ident" id="2694348">m</span><span class="op" id="2694349">[</span><span class="ident" id="2694350">t</span><span class="op" id="2694351">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694354">if</span>&nbsp;<span class="ident" id="2694357">p</span>&nbsp;<span class="op" id="2694359">!=</span>&nbsp;<span class="ident" id="2694362">nil</span>&nbsp;<span class="op" id="2694366">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694370">//&nbsp;some&nbsp;other&nbsp;goroutine&nbsp;won&nbsp;the&nbsp;race&nbsp;and&nbsp;created&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694424">ptrMap</span><span class="op" id="2694430">.</span><span class="ident" id="2694431">Unlock</span><span class="op" id="2694437">(</span><span class="op" id="2694438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694442">return</span>&nbsp;<span class="op" id="2694449">&amp;</span><span class="ident" id="2694450">p</span><span class="op" id="2694451">.</span><span class="ident" id="2694452">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2694459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694463">//&nbsp;Create&nbsp;a&nbsp;new&nbsp;ptrType&nbsp;starting&nbsp;with&nbsp;the&nbsp;description</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694518">//&nbsp;of&nbsp;an&nbsp;*unsafe.Pointer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694545">p</span>&nbsp;<span class="op" id="2694547">=</span>&nbsp;<span class="builtinfunc" id="2694549">new</span><span class="op" id="2694552">(</span><span class="ident" id="2694553">ptrType</span><span class="op" id="2694560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2694563">var</span>&nbsp;<span class="ident" id="2694567">iptr</span>&nbsp;<span class="keyword" id="2694572">interface</span><span class="op" id="2694581">{</span><span class="op" id="2694582">}</span>&nbsp;<span class="op" id="2694584">=</span>&nbsp;<span class="op" id="2694586">(</span><span class="op" id="2694587">*</span><span class="ident" id="2694588">unsafe</span><span class="op" id="2694594">.</span><span class="ident" id="2694595">Pointer</span><span class="op" id="2694602">)</span><span class="op" id="2694603">(</span><span class="ident" id="2694604">nil</span><span class="op" id="2694607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694610">prototype</span>&nbsp;<span class="op" id="2694620">:=</span>&nbsp;<span class="op" id="2694623">*</span><span class="op" id="2694624">(</span><span class="op" id="2694625">*</span><span class="op" id="2694626">*</span><span class="ident" id="2694627">ptrType</span><span class="op" id="2694634">)</span><span class="op" id="2694635">(</span><span class="ident" id="2694636">unsafe</span><span class="op" id="2694642">.</span><span class="ident" id="2694643">Pointer</span><span class="op" id="2694650">(</span><span class="op" id="2694651">&amp;</span><span class="ident" id="2694652">iptr</span><span class="op" id="2694656">)</span><span class="op" id="2694657">)</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2694660">*</span><span class="ident" id="2694661">p</span>&nbsp;<span class="op" id="2694663">=</span>&nbsp;<span class="op" id="2694665">*</span><span class="ident" id="2694666">prototype</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694678">s</span>&nbsp;<span class="op" id="2694680">:=</span>&nbsp;<span class="string" id="2694683">&#34;*&#34;</span>&nbsp;<span class="op" id="2694687">+</span>&nbsp;<span class="op" id="2694689">*</span><span class="ident" id="2694690">t</span><span class="op" id="2694691">.</span><span class="builtintype" id="2694692">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694700">p</span><span class="op" id="2694701">.</span><span class="builtintype" id="2694702">string</span>&nbsp;<span class="op" id="2694709">=</span>&nbsp;<span class="op" id="2694711">&amp;</span><span class="ident" id="2694712">s</span><br>
<span class="lineno"></span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694716">//&nbsp;For&nbsp;the&nbsp;type&nbsp;structures&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary,&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694772">//&nbsp;compiler&nbsp;provides&nbsp;a&nbsp;good&nbsp;hash&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694821">//&nbsp;Create&nbsp;a&nbsp;good&nbsp;hash&nbsp;for&nbsp;the&nbsp;new&nbsp;string&nbsp;by&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694872">//&nbsp;the&nbsp;FNV-1&nbsp;hash&#39;s&nbsp;mixing&nbsp;function&nbsp;to&nbsp;combine&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2694924">//&nbsp;old&nbsp;hash&nbsp;and&nbsp;the&nbsp;new&nbsp;&#34;*&#34;.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694954">p</span><span class="op" id="2694955">.</span><span class="ident" id="2694956">hash</span>&nbsp;<span class="op" id="2694961">=</span>&nbsp;<span class="ident" id="2694963">fnv1</span><span class="op" id="2694967">(</span><span class="ident" id="2694968">t</span><span class="op" id="2694969">.</span><span class="ident" id="2694970">hash</span><span class="op" id="2694974">,</span>&nbsp;<span class="string" id="2694976">&#39;*&#39;</span><span class="op" id="2694979">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2694983">p</span><span class="op" id="2694984">.</span><span class="ident" id="2694985">uncommonType</span>&nbsp;<span class="op" id="2694998">=</span>&nbsp;<span class="ident" id="2695000">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695005">p</span><span class="op" id="2695006">.</span><span class="ident" id="2695007">ptrToThis</span>&nbsp;<span class="op" id="2695017">=</span>&nbsp;<span class="ident" id="2695019">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695024">p</span><span class="op" id="2695025">.</span><span class="ident" id="2695026">zero</span>&nbsp;<span class="op" id="2695031">=</span>&nbsp;<span class="ident" id="2695033">unsafe</span><span class="op" id="2695039">.</span><span class="ident" id="2695040">Pointer</span><span class="op" id="2695047">(</span><span class="op" id="2695048">&amp;</span><span class="builtinfunc" id="2695049">make</span><span class="op" id="2695053">(</span><span class="op" id="2695054">[</span><span class="op" id="2695055">]</span><span class="builtintype" id="2695056">byte</span><span class="op" id="2695060">,</span>&nbsp;<span class="ident" id="2695062">p</span><span class="op" id="2695063">.</span><span class="ident" id="2695064">size</span><span class="op" id="2695068">)</span><span class="op" id="2695069">[</span><span class="num" id="2695070">0</span><span class="op" id="2695071">]</span><span class="op" id="2695072">)</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695075">p</span><span class="op" id="2695076">.</span><span class="ident" id="2695077">elem</span>&nbsp;<span class="op" id="2695082">=</span>&nbsp;<span class="ident" id="2695084">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695088">ptrMap</span><span class="op" id="2695094">.</span><span class="ident" id="2695095">m</span><span class="op" id="2695096">[</span><span class="ident" id="2695097">t</span><span class="op" id="2695098">]</span>&nbsp;<span class="op" id="2695100">=</span>&nbsp;<span class="ident" id="2695102">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695105">ptrMap</span><span class="op" id="2695111">.</span><span class="ident" id="2695112">Unlock</span><span class="op" id="2695118">(</span><span class="op" id="2695119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695122">return</span>&nbsp;<span class="op" id="2695129">&amp;</span><span class="ident" id="2695130">p</span><span class="op" id="2695131">.</span><span class="ident" id="2695132">rtype</span><br>
<span class="lineno">1075</span><span class="op" id="2695138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2695141">//&nbsp;fnv1&nbsp;incorporates&nbsp;the&nbsp;list&nbsp;of&nbsp;bytes&nbsp;into&nbsp;the&nbsp;hash&nbsp;x&nbsp;using&nbsp;the&nbsp;FNV-1&nbsp;hash&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2695227">func</span>&nbsp;<span class="ident" id="2695232">fnv1</span><span class="op" id="2695236">(</span><span class="ident" id="2695237">x</span>&nbsp;<span class="builtintype" id="2695239">uint32</span><span class="op" id="2695245">,</span>&nbsp;<span class="ident" id="2695247">list</span>&nbsp;<span class="op" id="2695252">...</span><span class="builtintype" id="2695255">byte</span><span class="op" id="2695259">)</span>&nbsp;<span class="builtintype" id="2695261">uint32</span>&nbsp;<span class="op" id="2695268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695271">for</span>&nbsp;<span class="ident" id="2695275">_</span><span class="op" id="2695276">,</span>&nbsp;<span class="ident" id="2695278">b</span>&nbsp;<span class="op" id="2695280">:=</span>&nbsp;<span class="keyword" id="2695283">range</span>&nbsp;<span class="ident" id="2695289">list</span>&nbsp;<span class="op" id="2695294">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695298">x</span>&nbsp;<span class="op" id="2695300">=</span>&nbsp;<span class="ident" id="2695302">x</span><span class="op" id="2695303">*</span><span class="num" id="2695304">16777619</span>&nbsp;<span class="op" id="2695313">^</span>&nbsp;<span class="builtintype" id="2695315">uint32</span><span class="op" id="2695321">(</span><span class="ident" id="2695322">b</span><span class="op" id="2695323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695329">return</span>&nbsp;<span class="ident" id="2695336">x</span><br>
<span class="lineno"></span><span class="op" id="2695338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1085</span><span class="keyword" id="2695341">func</span>&nbsp;<span class="op" id="2695346">(</span><span class="ident" id="2695347">t</span>&nbsp;<span class="op" id="2695349">*</span><span class="ident" id="2695350">rtype</span><span class="op" id="2695355">)</span>&nbsp;<span class="ident" id="2695357">Implements</span><span class="op" id="2695367">(</span><span class="ident" id="2695368">u</span>&nbsp;<span class="ident" id="2695370">Type</span><span class="op" id="2695374">)</span>&nbsp;<span class="builtintype" id="2695376">bool</span>&nbsp;<span class="op" id="2695381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695384">if</span>&nbsp;<span class="ident" id="2695387">u</span>&nbsp;<span class="op" id="2695389">==</span>&nbsp;<span class="ident" id="2695392">nil</span>&nbsp;<span class="op" id="2695396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2695400">panic</span><span class="op" id="2695405">(</span><span class="string" id="2695406">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2695451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695457">if</span>&nbsp;<span class="ident" id="2695460">u</span><span class="op" id="2695461">.</span><span class="ident" id="2695462">Kind</span><span class="op" id="2695466">(</span><span class="op" id="2695467">)</span>&nbsp;<span class="op" id="2695469">!=</span>&nbsp;<span class="ident" id="2695472">Interface</span>&nbsp;<span class="op" id="2695482">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2695486">panic</span><span class="op" id="2695491">(</span><span class="string" id="2695492">&#34;reflect:&nbsp;non-interface&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.Implements&#34;</span><span class="op" id="2695547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695553">return</span>&nbsp;<span class="ident" id="2695560">implements</span><span class="op" id="2695570">(</span><span class="ident" id="2695571">u</span><span class="op" id="2695572">.</span><span class="op" id="2695573">(</span><span class="op" id="2695574">*</span><span class="ident" id="2695575">rtype</span><span class="op" id="2695580">)</span><span class="op" id="2695581">,</span>&nbsp;<span class="ident" id="2695583">t</span><span class="op" id="2695584">)</span><br>
<span class="lineno"></span><span class="op" id="2695586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span><span class="keyword" id="2695589">func</span>&nbsp;<span class="op" id="2695594">(</span><span class="ident" id="2695595">t</span>&nbsp;<span class="op" id="2695597">*</span><span class="ident" id="2695598">rtype</span><span class="op" id="2695603">)</span>&nbsp;<span class="ident" id="2695605">AssignableTo</span><span class="op" id="2695617">(</span><span class="ident" id="2695618">u</span>&nbsp;<span class="ident" id="2695620">Type</span><span class="op" id="2695624">)</span>&nbsp;<span class="builtintype" id="2695626">bool</span>&nbsp;<span class="op" id="2695631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695634">if</span>&nbsp;<span class="ident" id="2695637">u</span>&nbsp;<span class="op" id="2695639">==</span>&nbsp;<span class="ident" id="2695642">nil</span>&nbsp;<span class="op" id="2695646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2695650">panic</span><span class="op" id="2695655">(</span><span class="string" id="2695656">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.AssignableTo&#34;</span><span class="op" id="2695703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695709">uu</span>&nbsp;<span class="op" id="2695712">:=</span>&nbsp;<span class="ident" id="2695715">u</span><span class="op" id="2695716">.</span><span class="op" id="2695717">(</span><span class="op" id="2695718">*</span><span class="ident" id="2695719">rtype</span><span class="op" id="2695724">)</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695727">return</span>&nbsp;<span class="ident" id="2695734">directlyAssignable</span><span class="op" id="2695752">(</span><span class="ident" id="2695753">uu</span><span class="op" id="2695755">,</span>&nbsp;<span class="ident" id="2695757">t</span><span class="op" id="2695758">)</span>&nbsp;<span class="op" id="2695760">||</span>&nbsp;<span class="ident" id="2695763">implements</span><span class="op" id="2695773">(</span><span class="ident" id="2695774">uu</span><span class="op" id="2695776">,</span>&nbsp;<span class="ident" id="2695778">t</span><span class="op" id="2695779">)</span><br>
<span class="lineno"></span><span class="op" id="2695781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2695784">func</span>&nbsp;<span class="op" id="2695789">(</span><span class="ident" id="2695790">t</span>&nbsp;<span class="op" id="2695792">*</span><span class="ident" id="2695793">rtype</span><span class="op" id="2695798">)</span>&nbsp;<span class="ident" id="2695800">ConvertibleTo</span><span class="op" id="2695813">(</span><span class="ident" id="2695814">u</span>&nbsp;<span class="ident" id="2695816">Type</span><span class="op" id="2695820">)</span>&nbsp;<span class="builtintype" id="2695822">bool</span>&nbsp;<span class="op" id="2695827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695830">if</span>&nbsp;<span class="ident" id="2695833">u</span>&nbsp;<span class="op" id="2695835">==</span>&nbsp;<span class="ident" id="2695838">nil</span>&nbsp;<span class="op" id="2695842">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2695846">panic</span><span class="op" id="2695851">(</span><span class="string" id="2695852">&#34;reflect:&nbsp;nil&nbsp;type&nbsp;passed&nbsp;to&nbsp;Type.ConvertibleTo&#34;</span><span class="op" id="2695900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2695903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2695906">uu</span>&nbsp;<span class="op" id="2695909">:=</span>&nbsp;<span class="ident" id="2695912">u</span><span class="op" id="2695913">.</span><span class="op" id="2695914">(</span><span class="op" id="2695915">*</span><span class="ident" id="2695916">rtype</span><span class="op" id="2695921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695924">return</span>&nbsp;<span class="ident" id="2695931">convertOp</span><span class="op" id="2695940">(</span><span class="ident" id="2695941">uu</span><span class="op" id="2695943">,</span>&nbsp;<span class="ident" id="2695945">t</span><span class="op" id="2695946">)</span>&nbsp;<span class="op" id="2695948">!=</span>&nbsp;<span class="ident" id="2695951">nil</span><br>
<span class="lineno"></span><span class="op" id="2695955">}</span><br>
<span class="lineno">1110</span><br>
<span class="lineno"></span><span class="keyword" id="2695958">func</span>&nbsp;<span class="op" id="2695963">(</span><span class="ident" id="2695964">t</span>&nbsp;<span class="op" id="2695966">*</span><span class="ident" id="2695967">rtype</span><span class="op" id="2695972">)</span>&nbsp;<span class="ident" id="2695974">Comparable</span><span class="op" id="2695984">(</span><span class="op" id="2695985">)</span>&nbsp;<span class="builtintype" id="2695987">bool</span>&nbsp;<span class="op" id="2695992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2695995">return</span>&nbsp;<span class="ident" id="2696002">t</span><span class="op" id="2696003">.</span><span class="ident" id="2696004">alg</span>&nbsp;<span class="op" id="2696008">!=</span>&nbsp;<span class="ident" id="2696011">nil</span>&nbsp;<span class="op" id="2696015">&amp;&amp;</span>&nbsp;<span class="ident" id="2696018">t</span><span class="op" id="2696019">.</span><span class="ident" id="2696020">alg</span><span class="op" id="2696023">.</span><span class="ident" id="2696024">equal</span>&nbsp;<span class="op" id="2696030">!=</span>&nbsp;<span class="ident" id="2696033">nil</span><br>
<span class="lineno"></span><span class="op" id="2696037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2696040">//&nbsp;implements&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;type&nbsp;V&nbsp;implements&nbsp;the&nbsp;interface&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="keyword" id="2696114">func</span>&nbsp;<span class="ident" id="2696119">implements</span><span class="op" id="2696129">(</span><span class="ident" id="2696130">T</span><span class="op" id="2696131">,</span>&nbsp;<span class="ident" id="2696133">V</span>&nbsp;<span class="op" id="2696135">*</span><span class="ident" id="2696136">rtype</span><span class="op" id="2696141">)</span>&nbsp;<span class="builtintype" id="2696143">bool</span>&nbsp;<span class="op" id="2696148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696151">if</span>&nbsp;<span class="ident" id="2696154">T</span><span class="op" id="2696155">.</span><span class="ident" id="2696156">Kind</span><span class="op" id="2696160">(</span><span class="op" id="2696161">)</span>&nbsp;<span class="op" id="2696163">!=</span>&nbsp;<span class="ident" id="2696166">Interface</span>&nbsp;<span class="op" id="2696176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696180">return</span>&nbsp;<span class="builtintype" id="2696187">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2696194">}</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2696197">t</span>&nbsp;<span class="op" id="2696199">:=</span>&nbsp;<span class="op" id="2696202">(</span><span class="op" id="2696203">*</span><span class="ident" id="2696204">interfaceType</span><span class="op" id="2696217">)</span><span class="op" id="2696218">(</span><span class="ident" id="2696219">unsafe</span><span class="op" id="2696225">.</span><span class="ident" id="2696226">Pointer</span><span class="op" id="2696233">(</span><span class="ident" id="2696234">T</span><span class="op" id="2696235">)</span><span class="op" id="2696236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696239">if</span>&nbsp;<span class="builtinfunc" id="2696242">len</span><span class="op" id="2696245">(</span><span class="ident" id="2696246">t</span><span class="op" id="2696247">.</span><span class="ident" id="2696248">methods</span><span class="op" id="2696255">)</span>&nbsp;<span class="op" id="2696257">==</span>&nbsp;<span class="num" id="2696260">0</span>&nbsp;<span class="op" id="2696262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696266">return</span>&nbsp;<span class="builtintype" id="2696273">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2696279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696283">//&nbsp;The&nbsp;same&nbsp;algorithm&nbsp;applies&nbsp;in&nbsp;both&nbsp;cases,&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696337">//&nbsp;method&nbsp;tables&nbsp;for&nbsp;an&nbsp;interface&nbsp;type&nbsp;and&nbsp;a&nbsp;concrete&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696397">//&nbsp;are&nbsp;different,&nbsp;so&nbsp;the&nbsp;code&nbsp;is&nbsp;duplicated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696443">//&nbsp;In&nbsp;both&nbsp;cases&nbsp;the&nbsp;algorithm&nbsp;is&nbsp;a&nbsp;linear&nbsp;scan&nbsp;over&nbsp;the&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696505">//&nbsp;lists&nbsp;-&nbsp;T&#39;s&nbsp;methods&nbsp;and&nbsp;V&#39;s&nbsp;methods&nbsp;-&nbsp;simultaneously.</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696563">//&nbsp;Since&nbsp;method&nbsp;tables&nbsp;are&nbsp;stored&nbsp;in&nbsp;a&nbsp;unique&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696623">//&nbsp;(alphabetical,&nbsp;with&nbsp;no&nbsp;duplicate&nbsp;method&nbsp;names),&nbsp;the&nbsp;scan</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696684">//&nbsp;through&nbsp;V&#39;s&nbsp;methods&nbsp;must&nbsp;hit&nbsp;a&nbsp;match&nbsp;for&nbsp;each&nbsp;of&nbsp;T&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696741">//&nbsp;methods&nbsp;along&nbsp;the&nbsp;way,&nbsp;or&nbsp;else&nbsp;V&nbsp;does&nbsp;not&nbsp;implement&nbsp;T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696800">//&nbsp;This&nbsp;lets&nbsp;us&nbsp;run&nbsp;the&nbsp;scan&nbsp;in&nbsp;overall&nbsp;linear&nbsp;time&nbsp;instead&nbsp;of</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696864">//&nbsp;the&nbsp;quadratic&nbsp;time&nbsp;&nbsp;a&nbsp;naive&nbsp;search&nbsp;would&nbsp;require.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2696918">//&nbsp;See&nbsp;also&nbsp;../runtime/iface.c.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2696951">if</span>&nbsp;<span class="ident" id="2696954">V</span><span class="op" id="2696955">.</span><span class="ident" id="2696956">Kind</span><span class="op" id="2696960">(</span><span class="op" id="2696961">)</span>&nbsp;<span class="op" id="2696963">==</span>&nbsp;<span class="ident" id="2696966">Interface</span>&nbsp;<span class="op" id="2696976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2696980">v</span>&nbsp;<span class="op" id="2696982">:=</span>&nbsp;<span class="op" id="2696985">(</span><span class="op" id="2696986">*</span><span class="ident" id="2696987">interfaceType</span><span class="op" id="2697000">)</span><span class="op" id="2697001">(</span><span class="ident" id="2697002">unsafe</span><span class="op" id="2697008">.</span><span class="ident" id="2697009">Pointer</span><span class="op" id="2697016">(</span><span class="ident" id="2697017">V</span><span class="op" id="2697018">)</span><span class="op" id="2697019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697023">i</span>&nbsp;<span class="op" id="2697025">:=</span>&nbsp;<span class="num" id="2697028">0</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697032">for</span>&nbsp;<span class="ident" id="2697036">j</span>&nbsp;<span class="op" id="2697038">:=</span>&nbsp;<span class="num" id="2697041">0</span><span class="op" id="2697042">;</span>&nbsp;<span class="ident" id="2697044">j</span>&nbsp;<span class="op" id="2697046">&lt;</span>&nbsp;<span class="builtinfunc" id="2697048">len</span><span class="op" id="2697051">(</span><span class="ident" id="2697052">v</span><span class="op" id="2697053">.</span><span class="ident" id="2697054">methods</span><span class="op" id="2697061">)</span><span class="op" id="2697062">;</span>&nbsp;<span class="ident" id="2697064">j</span><span class="op" id="2697065">++</span>&nbsp;<span class="op" id="2697068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697073">tm</span>&nbsp;<span class="op" id="2697076">:=</span>&nbsp;<span class="op" id="2697079">&amp;</span><span class="ident" id="2697080">t</span><span class="op" id="2697081">.</span><span class="ident" id="2697082">methods</span><span class="op" id="2697089">[</span><span class="ident" id="2697090">i</span><span class="op" id="2697091">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697096">vm</span>&nbsp;<span class="op" id="2697099">:=</span>&nbsp;<span class="op" id="2697102">&amp;</span><span class="ident" id="2697103">v</span><span class="op" id="2697104">.</span><span class="ident" id="2697105">methods</span><span class="op" id="2697112">[</span><span class="ident" id="2697113">j</span><span class="op" id="2697114">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697119">if</span>&nbsp;<span class="ident" id="2697122">vm</span><span class="op" id="2697124">.</span><span class="ident" id="2697125">name</span>&nbsp;<span class="op" id="2697130">==</span>&nbsp;<span class="ident" id="2697133">tm</span><span class="op" id="2697135">.</span><span class="ident" id="2697136">name</span>&nbsp;<span class="op" id="2697141">&amp;&amp;</span>&nbsp;<span class="ident" id="2697144">vm</span><span class="op" id="2697146">.</span><span class="ident" id="2697147">pkgPath</span>&nbsp;<span class="op" id="2697155">==</span>&nbsp;<span class="ident" id="2697158">tm</span><span class="op" id="2697160">.</span><span class="ident" id="2697161">pkgPath</span>&nbsp;<span class="op" id="2697169">&amp;&amp;</span>&nbsp;<span class="ident" id="2697172">vm</span><span class="op" id="2697174">.</span><span class="ident" id="2697175">typ</span>&nbsp;<span class="op" id="2697179">==</span>&nbsp;<span class="ident" id="2697182">tm</span><span class="op" id="2697184">.</span><span class="ident" id="2697185">typ</span>&nbsp;<span class="op" id="2697189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697195">if</span>&nbsp;<span class="ident" id="2697198">i</span><span class="op" id="2697199">++</span><span class="op" id="2697201">;</span>&nbsp;<span class="ident" id="2697203">i</span>&nbsp;<span class="op" id="2697205">&gt;=</span>&nbsp;<span class="builtinfunc" id="2697208">len</span><span class="op" id="2697211">(</span><span class="ident" id="2697212">t</span><span class="op" id="2697213">.</span><span class="ident" id="2697214">methods</span><span class="op" id="2697221">)</span>&nbsp;<span class="op" id="2697223">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697230">return</span>&nbsp;<span class="builtintype" id="2697237">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697259">return</span>&nbsp;<span class="builtintype" id="2697266">false</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697277">v</span>&nbsp;<span class="op" id="2697279">:=</span>&nbsp;<span class="ident" id="2697282">V</span><span class="op" id="2697283">.</span><span class="ident" id="2697284">uncommon</span><span class="op" id="2697292">(</span><span class="op" id="2697293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697296">if</span>&nbsp;<span class="ident" id="2697299">v</span>&nbsp;<span class="op" id="2697301">==</span>&nbsp;<span class="ident" id="2697304">nil</span>&nbsp;<span class="op" id="2697308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697312">return</span>&nbsp;<span class="builtintype" id="2697319">false</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697329">i</span>&nbsp;<span class="op" id="2697331">:=</span>&nbsp;<span class="num" id="2697334">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697337">for</span>&nbsp;<span class="ident" id="2697341">j</span>&nbsp;<span class="op" id="2697343">:=</span>&nbsp;<span class="num" id="2697346">0</span><span class="op" id="2697347">;</span>&nbsp;<span class="ident" id="2697349">j</span>&nbsp;<span class="op" id="2697351">&lt;</span>&nbsp;<span class="builtinfunc" id="2697353">len</span><span class="op" id="2697356">(</span><span class="ident" id="2697357">v</span><span class="op" id="2697358">.</span><span class="ident" id="2697359">methods</span><span class="op" id="2697366">)</span><span class="op" id="2697367">;</span>&nbsp;<span class="ident" id="2697369">j</span><span class="op" id="2697370">++</span>&nbsp;<span class="op" id="2697373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697377">tm</span>&nbsp;<span class="op" id="2697380">:=</span>&nbsp;<span class="op" id="2697383">&amp;</span><span class="ident" id="2697384">t</span><span class="op" id="2697385">.</span><span class="ident" id="2697386">methods</span><span class="op" id="2697393">[</span><span class="ident" id="2697394">i</span><span class="op" id="2697395">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2697399">vm</span>&nbsp;<span class="op" id="2697402">:=</span>&nbsp;<span class="op" id="2697405">&amp;</span><span class="ident" id="2697406">v</span><span class="op" id="2697407">.</span><span class="ident" id="2697408">methods</span><span class="op" id="2697415">[</span><span class="ident" id="2697416">j</span><span class="op" id="2697417">]</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697421">if</span>&nbsp;<span class="ident" id="2697424">vm</span><span class="op" id="2697426">.</span><span class="ident" id="2697427">name</span>&nbsp;<span class="op" id="2697432">==</span>&nbsp;<span class="ident" id="2697435">tm</span><span class="op" id="2697437">.</span><span class="ident" id="2697438">name</span>&nbsp;<span class="op" id="2697443">&amp;&amp;</span>&nbsp;<span class="ident" id="2697446">vm</span><span class="op" id="2697448">.</span><span class="ident" id="2697449">pkgPath</span>&nbsp;<span class="op" id="2697457">==</span>&nbsp;<span class="ident" id="2697460">tm</span><span class="op" id="2697462">.</span><span class="ident" id="2697463">pkgPath</span>&nbsp;<span class="op" id="2697471">&amp;&amp;</span>&nbsp;<span class="ident" id="2697474">vm</span><span class="op" id="2697476">.</span><span class="ident" id="2697477">mtyp</span>&nbsp;<span class="op" id="2697482">==</span>&nbsp;<span class="ident" id="2697485">tm</span><span class="op" id="2697487">.</span><span class="ident" id="2697488">typ</span>&nbsp;<span class="op" id="2697492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697497">if</span>&nbsp;<span class="ident" id="2697500">i</span><span class="op" id="2697501">++</span><span class="op" id="2697503">;</span>&nbsp;<span class="ident" id="2697505">i</span>&nbsp;<span class="op" id="2697507">&gt;=</span>&nbsp;<span class="builtinfunc" id="2697510">len</span><span class="op" id="2697513">(</span><span class="ident" id="2697514">t</span><span class="op" id="2697515">.</span><span class="ident" id="2697516">methods</span><span class="op" id="2697523">)</span>&nbsp;<span class="op" id="2697525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697531">return</span>&nbsp;<span class="builtintype" id="2697538">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697550">}</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697556">return</span>&nbsp;<span class="builtintype" id="2697563">false</span><br>
<span class="lineno"></span><span class="op" id="2697569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2697572">//&nbsp;directlyAssignable&nbsp;returns&nbsp;true&nbsp;if&nbsp;a&nbsp;value&nbsp;x&nbsp;of&nbsp;type&nbsp;V&nbsp;can&nbsp;be&nbsp;directly</span><br>
<span class="lineno">1170</span><span class="comment" id="2697646">//&nbsp;assigned&nbsp;(using&nbsp;memmove)&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;T.</span><br>
<span class="lineno"></span><span class="comment" id="2697696">//&nbsp;http://golang.org/doc/go_spec.html#Assignability</span><br>
<span class="lineno"></span><span class="comment" id="2697748">//&nbsp;Ignoring&nbsp;the&nbsp;interface&nbsp;rules&nbsp;(implemented&nbsp;elsewhere)</span><br>
<span class="lineno"></span><span class="comment" id="2697804">//&nbsp;and&nbsp;the&nbsp;ideal&nbsp;constant&nbsp;rules&nbsp;(no&nbsp;ideal&nbsp;constants&nbsp;at&nbsp;run&nbsp;time).</span><br>
<span class="lineno"></span><span class="keyword" id="2697870">func</span>&nbsp;<span class="ident" id="2697875">directlyAssignable</span><span class="op" id="2697893">(</span><span class="ident" id="2697894">T</span><span class="op" id="2697895">,</span>&nbsp;<span class="ident" id="2697897">V</span>&nbsp;<span class="op" id="2697899">*</span><span class="ident" id="2697900">rtype</span><span class="op" id="2697905">)</span>&nbsp;<span class="builtintype" id="2697907">bool</span>&nbsp;<span class="op" id="2697912">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2697915">//&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;is&nbsp;identical&nbsp;to&nbsp;T?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697949">if</span>&nbsp;<span class="ident" id="2697952">T</span>&nbsp;<span class="op" id="2697954">==</span>&nbsp;<span class="ident" id="2697957">V</span>&nbsp;<span class="op" id="2697959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2697963">return</span>&nbsp;<span class="builtintype" id="2697970">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2697976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2697980">//&nbsp;Otherwise&nbsp;at&nbsp;least&nbsp;one&nbsp;of&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;be&nbsp;unnamed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2698034">//&nbsp;and&nbsp;they&nbsp;must&nbsp;have&nbsp;the&nbsp;same&nbsp;kind.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698072">if</span>&nbsp;<span class="ident" id="2698075">T</span><span class="op" id="2698076">.</span><span class="ident" id="2698077">Name</span><span class="op" id="2698081">(</span><span class="op" id="2698082">)</span>&nbsp;<span class="op" id="2698084">!=</span>&nbsp;<span class="string" id="2698087">&#34;&#34;</span>&nbsp;<span class="op" id="2698090">&amp;&amp;</span>&nbsp;<span class="ident" id="2698093">V</span><span class="op" id="2698094">.</span><span class="ident" id="2698095">Name</span><span class="op" id="2698099">(</span><span class="op" id="2698100">)</span>&nbsp;<span class="op" id="2698102">!=</span>&nbsp;<span class="string" id="2698105">&#34;&#34;</span>&nbsp;<span class="op" id="2698108">||</span>&nbsp;<span class="ident" id="2698111">T</span><span class="op" id="2698112">.</span><span class="ident" id="2698113">Kind</span><span class="op" id="2698117">(</span><span class="op" id="2698118">)</span>&nbsp;<span class="op" id="2698120">!=</span>&nbsp;<span class="ident" id="2698123">V</span><span class="op" id="2698124">.</span><span class="ident" id="2698125">Kind</span><span class="op" id="2698129">(</span><span class="op" id="2698130">)</span>&nbsp;<span class="op" id="2698132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698136">return</span>&nbsp;<span class="builtintype" id="2698143">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698150">}</span><br>
<span class="lineno">1185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2698154">//&nbsp;x&#39;s&nbsp;type&nbsp;T&nbsp;and&nbsp;V&nbsp;must&nbsp;&nbsp;have&nbsp;identical&nbsp;underlying&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698214">return</span>&nbsp;<span class="ident" id="2698221">haveIdenticalUnderlyingType</span><span class="op" id="2698248">(</span><span class="ident" id="2698249">T</span><span class="op" id="2698250">,</span>&nbsp;<span class="ident" id="2698252">V</span><span class="op" id="2698253">)</span><br>
<span class="lineno"></span><span class="op" id="2698255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1190</span><span class="keyword" id="2698258">func</span>&nbsp;<span class="ident" id="2698263">haveIdenticalUnderlyingType</span><span class="op" id="2698290">(</span><span class="ident" id="2698291">T</span><span class="op" id="2698292">,</span>&nbsp;<span class="ident" id="2698294">V</span>&nbsp;<span class="op" id="2698296">*</span><span class="ident" id="2698297">rtype</span><span class="op" id="2698302">)</span>&nbsp;<span class="builtintype" id="2698304">bool</span>&nbsp;<span class="op" id="2698309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698312">if</span>&nbsp;<span class="ident" id="2698315">T</span>&nbsp;<span class="op" id="2698317">==</span>&nbsp;<span class="ident" id="2698320">V</span>&nbsp;<span class="op" id="2698322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698326">return</span>&nbsp;<span class="builtintype" id="2698333">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2698343">kind</span>&nbsp;<span class="op" id="2698348">:=</span>&nbsp;<span class="ident" id="2698351">T</span><span class="op" id="2698352">.</span><span class="ident" id="2698353">Kind</span><span class="op" id="2698357">(</span><span class="op" id="2698358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698361">if</span>&nbsp;<span class="ident" id="2698364">kind</span>&nbsp;<span class="op" id="2698369">!=</span>&nbsp;<span class="ident" id="2698372">V</span><span class="op" id="2698373">.</span><span class="ident" id="2698374">Kind</span><span class="op" id="2698378">(</span><span class="op" id="2698379">)</span>&nbsp;<span class="op" id="2698381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698385">return</span>&nbsp;<span class="builtintype" id="2698392">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2698403">//&nbsp;Non-composite&nbsp;types&nbsp;of&nbsp;equal&nbsp;kind&nbsp;have&nbsp;same&nbsp;underlying&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2698467">//&nbsp;(the&nbsp;predefined&nbsp;instance&nbsp;of&nbsp;the&nbsp;type).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698510">if</span>&nbsp;<span class="ident" id="2698513">Bool</span>&nbsp;<span class="op" id="2698518">&lt;=</span>&nbsp;<span class="ident" id="2698521">kind</span>&nbsp;<span class="op" id="2698526">&amp;&amp;</span>&nbsp;<span class="ident" id="2698529">kind</span>&nbsp;<span class="op" id="2698534">&lt;=</span>&nbsp;<span class="ident" id="2698537">Complex128</span>&nbsp;<span class="op" id="2698548">||</span>&nbsp;<span class="ident" id="2698551">kind</span>&nbsp;<span class="op" id="2698556">==</span>&nbsp;<span class="ident" id="2698559">String</span>&nbsp;<span class="op" id="2698566">||</span>&nbsp;<span class="ident" id="2698569">kind</span>&nbsp;<span class="op" id="2698574">==</span>&nbsp;<span class="ident" id="2698577">UnsafePointer</span>&nbsp;<span class="op" id="2698591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698595">return</span>&nbsp;<span class="builtintype" id="2698602">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698608">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2698612">//&nbsp;Composite&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698633">switch</span>&nbsp;<span class="ident" id="2698640">kind</span>&nbsp;<span class="op" id="2698645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698648">case</span>&nbsp;<span class="ident" id="2698653">Array</span><span class="op" id="2698658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698662">return</span>&nbsp;<span class="ident" id="2698669">T</span><span class="op" id="2698670">.</span><span class="ident" id="2698671">Elem</span><span class="op" id="2698675">(</span><span class="op" id="2698676">)</span>&nbsp;<span class="op" id="2698678">==</span>&nbsp;<span class="ident" id="2698681">V</span><span class="op" id="2698682">.</span><span class="ident" id="2698683">Elem</span><span class="op" id="2698687">(</span><span class="op" id="2698688">)</span>&nbsp;<span class="op" id="2698690">&amp;&amp;</span>&nbsp;<span class="ident" id="2698693">T</span><span class="op" id="2698694">.</span><span class="ident" id="2698695">Len</span><span class="op" id="2698698">(</span><span class="op" id="2698699">)</span>&nbsp;<span class="op" id="2698701">==</span>&nbsp;<span class="ident" id="2698704">V</span><span class="op" id="2698705">.</span><span class="ident" id="2698706">Len</span><span class="op" id="2698709">(</span><span class="op" id="2698710">)</span><br>
<span class="lineno">1210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698714">case</span>&nbsp;<span class="ident" id="2698719">Chan</span><span class="op" id="2698723">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2698727">//&nbsp;Special&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2698746">//&nbsp;x&nbsp;is&nbsp;a&nbsp;bidirectional&nbsp;channel&nbsp;value,&nbsp;T&nbsp;is&nbsp;a&nbsp;channel&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2698808">//&nbsp;and&nbsp;x&#39;s&nbsp;type&nbsp;V&nbsp;and&nbsp;T&nbsp;have&nbsp;identical&nbsp;element&nbsp;types.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698864">if</span>&nbsp;<span class="ident" id="2698867">V</span><span class="op" id="2698868">.</span><span class="ident" id="2698869">ChanDir</span><span class="op" id="2698876">(</span><span class="op" id="2698877">)</span>&nbsp;<span class="op" id="2698879">==</span>&nbsp;<span class="ident" id="2698882">BothDir</span>&nbsp;<span class="op" id="2698890">&amp;&amp;</span>&nbsp;<span class="ident" id="2698893">T</span><span class="op" id="2698894">.</span><span class="ident" id="2698895">Elem</span><span class="op" id="2698899">(</span><span class="op" id="2698900">)</span>&nbsp;<span class="op" id="2698902">==</span>&nbsp;<span class="ident" id="2698905">V</span><span class="op" id="2698906">.</span><span class="ident" id="2698907">Elem</span><span class="op" id="2698911">(</span><span class="op" id="2698912">)</span>&nbsp;<span class="op" id="2698914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698919">return</span>&nbsp;<span class="builtintype" id="2698926">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2698933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2698938">//&nbsp;Otherwise&nbsp;continue&nbsp;test&nbsp;for&nbsp;identical&nbsp;underlying&nbsp;type.</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2698998">return</span>&nbsp;<span class="ident" id="2699005">V</span><span class="op" id="2699006">.</span><span class="ident" id="2699007">ChanDir</span><span class="op" id="2699014">(</span><span class="op" id="2699015">)</span>&nbsp;<span class="op" id="2699017">==</span>&nbsp;<span class="ident" id="2699020">T</span><span class="op" id="2699021">.</span><span class="ident" id="2699022">ChanDir</span><span class="op" id="2699029">(</span><span class="op" id="2699030">)</span>&nbsp;<span class="op" id="2699032">&amp;&amp;</span>&nbsp;<span class="ident" id="2699035">T</span><span class="op" id="2699036">.</span><span class="ident" id="2699037">Elem</span><span class="op" id="2699041">(</span><span class="op" id="2699042">)</span>&nbsp;<span class="op" id="2699044">==</span>&nbsp;<span class="ident" id="2699047">V</span><span class="op" id="2699048">.</span><span class="ident" id="2699049">Elem</span><span class="op" id="2699053">(</span><span class="op" id="2699054">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699058">case</span>&nbsp;<span class="ident" id="2699063">Func</span><span class="op" id="2699067">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699071">t</span>&nbsp;<span class="op" id="2699073">:=</span>&nbsp;<span class="op" id="2699076">(</span><span class="op" id="2699077">*</span><span class="ident" id="2699078">funcType</span><span class="op" id="2699086">)</span><span class="op" id="2699087">(</span><span class="ident" id="2699088">unsafe</span><span class="op" id="2699094">.</span><span class="ident" id="2699095">Pointer</span><span class="op" id="2699102">(</span><span class="ident" id="2699103">T</span><span class="op" id="2699104">)</span><span class="op" id="2699105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699109">v</span>&nbsp;<span class="op" id="2699111">:=</span>&nbsp;<span class="op" id="2699114">(</span><span class="op" id="2699115">*</span><span class="ident" id="2699116">funcType</span><span class="op" id="2699124">)</span><span class="op" id="2699125">(</span><span class="ident" id="2699126">unsafe</span><span class="op" id="2699132">.</span><span class="ident" id="2699133">Pointer</span><span class="op" id="2699140">(</span><span class="ident" id="2699141">V</span><span class="op" id="2699142">)</span><span class="op" id="2699143">)</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699147">if</span>&nbsp;<span class="ident" id="2699150">t</span><span class="op" id="2699151">.</span><span class="ident" id="2699152">dotdotdot</span>&nbsp;<span class="op" id="2699162">!=</span>&nbsp;<span class="ident" id="2699165">v</span><span class="op" id="2699166">.</span><span class="ident" id="2699167">dotdotdot</span>&nbsp;<span class="op" id="2699177">||</span>&nbsp;<span class="builtinfunc" id="2699180">len</span><span class="op" id="2699183">(</span><span class="ident" id="2699184">t</span><span class="op" id="2699185">.</span><span class="ident" id="2699186">in</span><span class="op" id="2699188">)</span>&nbsp;<span class="op" id="2699190">!=</span>&nbsp;<span class="builtinfunc" id="2699193">len</span><span class="op" id="2699196">(</span><span class="ident" id="2699197">v</span><span class="op" id="2699198">.</span><span class="ident" id="2699199">in</span><span class="op" id="2699201">)</span>&nbsp;<span class="op" id="2699203">||</span>&nbsp;<span class="builtinfunc" id="2699206">len</span><span class="op" id="2699209">(</span><span class="ident" id="2699210">t</span><span class="op" id="2699211">.</span><span class="ident" id="2699212">out</span><span class="op" id="2699215">)</span>&nbsp;<span class="op" id="2699217">!=</span>&nbsp;<span class="builtinfunc" id="2699220">len</span><span class="op" id="2699223">(</span><span class="ident" id="2699224">v</span><span class="op" id="2699225">.</span><span class="ident" id="2699226">out</span><span class="op" id="2699229">)</span>&nbsp;<span class="op" id="2699231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699236">return</span>&nbsp;<span class="builtintype" id="2699243">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699255">for</span>&nbsp;<span class="ident" id="2699259">i</span><span class="op" id="2699260">,</span>&nbsp;<span class="ident" id="2699262">typ</span>&nbsp;<span class="op" id="2699266">:=</span>&nbsp;<span class="keyword" id="2699269">range</span>&nbsp;<span class="ident" id="2699275">t</span><span class="op" id="2699276">.</span><span class="ident" id="2699277">in</span>&nbsp;<span class="op" id="2699280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699285">if</span>&nbsp;<span class="ident" id="2699288">typ</span>&nbsp;<span class="op" id="2699292">!=</span>&nbsp;<span class="ident" id="2699295">v</span><span class="op" id="2699296">.</span><span class="ident" id="2699297">in</span><span class="op" id="2699299">[</span><span class="ident" id="2699300">i</span><span class="op" id="2699301">]</span>&nbsp;<span class="op" id="2699303">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699309">return</span>&nbsp;<span class="builtintype" id="2699316">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699333">for</span>&nbsp;<span class="ident" id="2699337">i</span><span class="op" id="2699338">,</span>&nbsp;<span class="ident" id="2699340">typ</span>&nbsp;<span class="op" id="2699344">:=</span>&nbsp;<span class="keyword" id="2699347">range</span>&nbsp;<span class="ident" id="2699353">t</span><span class="op" id="2699354">.</span><span class="ident" id="2699355">out</span>&nbsp;<span class="op" id="2699359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699364">if</span>&nbsp;<span class="ident" id="2699367">typ</span>&nbsp;<span class="op" id="2699371">!=</span>&nbsp;<span class="ident" id="2699374">v</span><span class="op" id="2699375">.</span><span class="ident" id="2699376">out</span><span class="op" id="2699379">[</span><span class="ident" id="2699380">i</span><span class="op" id="2699381">]</span>&nbsp;<span class="op" id="2699383">{</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699389">return</span>&nbsp;<span class="builtintype" id="2699396">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699413">return</span>&nbsp;<span class="builtintype" id="2699420">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699427">case</span>&nbsp;<span class="ident" id="2699432">Interface</span><span class="op" id="2699441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699445">t</span>&nbsp;<span class="op" id="2699447">:=</span>&nbsp;<span class="op" id="2699450">(</span><span class="op" id="2699451">*</span><span class="ident" id="2699452">interfaceType</span><span class="op" id="2699465">)</span><span class="op" id="2699466">(</span><span class="ident" id="2699467">unsafe</span><span class="op" id="2699473">.</span><span class="ident" id="2699474">Pointer</span><span class="op" id="2699481">(</span><span class="ident" id="2699482">T</span><span class="op" id="2699483">)</span><span class="op" id="2699484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699488">v</span>&nbsp;<span class="op" id="2699490">:=</span>&nbsp;<span class="op" id="2699493">(</span><span class="op" id="2699494">*</span><span class="ident" id="2699495">interfaceType</span><span class="op" id="2699508">)</span><span class="op" id="2699509">(</span><span class="ident" id="2699510">unsafe</span><span class="op" id="2699516">.</span><span class="ident" id="2699517">Pointer</span><span class="op" id="2699524">(</span><span class="ident" id="2699525">V</span><span class="op" id="2699526">)</span><span class="op" id="2699527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699531">if</span>&nbsp;<span class="builtinfunc" id="2699534">len</span><span class="op" id="2699537">(</span><span class="ident" id="2699538">t</span><span class="op" id="2699539">.</span><span class="ident" id="2699540">methods</span><span class="op" id="2699547">)</span>&nbsp;<span class="op" id="2699549">==</span>&nbsp;<span class="num" id="2699552">0</span>&nbsp;<span class="op" id="2699554">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2699557">len</span><span class="op" id="2699560">(</span><span class="ident" id="2699561">v</span><span class="op" id="2699562">.</span><span class="ident" id="2699563">methods</span><span class="op" id="2699570">)</span>&nbsp;<span class="op" id="2699572">==</span>&nbsp;<span class="num" id="2699575">0</span>&nbsp;<span class="op" id="2699577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699582">return</span>&nbsp;<span class="builtintype" id="2699589">true</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699600">//&nbsp;Might&nbsp;have&nbsp;the&nbsp;same&nbsp;methods&nbsp;but&nbsp;still</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2699643">//&nbsp;need&nbsp;a&nbsp;run&nbsp;time&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699676">return</span>&nbsp;<span class="builtintype" id="2699683">false</span><br>
<span class="lineno"></span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699691">case</span>&nbsp;<span class="ident" id="2699696">Map</span><span class="op" id="2699699">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699703">return</span>&nbsp;<span class="ident" id="2699710">T</span><span class="op" id="2699711">.</span><span class="ident" id="2699712">Key</span><span class="op" id="2699715">(</span><span class="op" id="2699716">)</span>&nbsp;<span class="op" id="2699718">==</span>&nbsp;<span class="ident" id="2699721">V</span><span class="op" id="2699722">.</span><span class="ident" id="2699723">Key</span><span class="op" id="2699726">(</span><span class="op" id="2699727">)</span>&nbsp;<span class="op" id="2699729">&amp;&amp;</span>&nbsp;<span class="ident" id="2699732">T</span><span class="op" id="2699733">.</span><span class="ident" id="2699734">Elem</span><span class="op" id="2699738">(</span><span class="op" id="2699739">)</span>&nbsp;<span class="op" id="2699741">==</span>&nbsp;<span class="ident" id="2699744">V</span><span class="op" id="2699745">.</span><span class="ident" id="2699746">Elem</span><span class="op" id="2699750">(</span><span class="op" id="2699751">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699755">case</span>&nbsp;<span class="ident" id="2699760">Ptr</span><span class="op" id="2699763">,</span>&nbsp;<span class="ident" id="2699765">Slice</span><span class="op" id="2699770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699774">return</span>&nbsp;<span class="ident" id="2699781">T</span><span class="op" id="2699782">.</span><span class="ident" id="2699783">Elem</span><span class="op" id="2699787">(</span><span class="op" id="2699788">)</span>&nbsp;<span class="op" id="2699790">==</span>&nbsp;<span class="ident" id="2699793">V</span><span class="op" id="2699794">.</span><span class="ident" id="2699795">Elem</span><span class="op" id="2699799">(</span><span class="op" id="2699800">)</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699804">case</span>&nbsp;<span class="ident" id="2699809">Struct</span><span class="op" id="2699815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699819">t</span>&nbsp;<span class="op" id="2699821">:=</span>&nbsp;<span class="op" id="2699824">(</span><span class="op" id="2699825">*</span><span class="ident" id="2699826">structType</span><span class="op" id="2699836">)</span><span class="op" id="2699837">(</span><span class="ident" id="2699838">unsafe</span><span class="op" id="2699844">.</span><span class="ident" id="2699845">Pointer</span><span class="op" id="2699852">(</span><span class="ident" id="2699853">T</span><span class="op" id="2699854">)</span><span class="op" id="2699855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699859">v</span>&nbsp;<span class="op" id="2699861">:=</span>&nbsp;<span class="op" id="2699864">(</span><span class="op" id="2699865">*</span><span class="ident" id="2699866">structType</span><span class="op" id="2699876">)</span><span class="op" id="2699877">(</span><span class="ident" id="2699878">unsafe</span><span class="op" id="2699884">.</span><span class="ident" id="2699885">Pointer</span><span class="op" id="2699892">(</span><span class="ident" id="2699893">V</span><span class="op" id="2699894">)</span><span class="op" id="2699895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699899">if</span>&nbsp;<span class="builtinfunc" id="2699902">len</span><span class="op" id="2699905">(</span><span class="ident" id="2699906">t</span><span class="op" id="2699907">.</span><span class="ident" id="2699908">fields</span><span class="op" id="2699914">)</span>&nbsp;<span class="op" id="2699916">!=</span>&nbsp;<span class="builtinfunc" id="2699919">len</span><span class="op" id="2699922">(</span><span class="ident" id="2699923">v</span><span class="op" id="2699924">.</span><span class="ident" id="2699925">fields</span><span class="op" id="2699931">)</span>&nbsp;<span class="op" id="2699933">{</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699938">return</span>&nbsp;<span class="builtintype" id="2699945">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2699953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2699957">for</span>&nbsp;<span class="ident" id="2699961">i</span>&nbsp;<span class="op" id="2699963">:=</span>&nbsp;<span class="keyword" id="2699966">range</span>&nbsp;<span class="ident" id="2699972">t</span><span class="op" id="2699973">.</span><span class="ident" id="2699974">fields</span>&nbsp;<span class="op" id="2699981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2699986">tf</span>&nbsp;<span class="op" id="2699989">:=</span>&nbsp;<span class="op" id="2699992">&amp;</span><span class="ident" id="2699993">t</span><span class="op" id="2699994">.</span><span class="ident" id="2699995">fields</span><span class="op" id="2700001">[</span><span class="ident" id="2700002">i</span><span class="op" id="2700003">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2700008">vf</span>&nbsp;<span class="op" id="2700011">:=</span>&nbsp;<span class="op" id="2700014">&amp;</span><span class="ident" id="2700015">v</span><span class="op" id="2700016">.</span><span class="ident" id="2700017">fields</span><span class="op" id="2700023">[</span><span class="ident" id="2700024">i</span><span class="op" id="2700025">]</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700030">if</span>&nbsp;<span class="ident" id="2700033">tf</span><span class="op" id="2700035">.</span><span class="ident" id="2700036">name</span>&nbsp;<span class="op" id="2700041">!=</span>&nbsp;<span class="ident" id="2700044">vf</span><span class="op" id="2700046">.</span><span class="ident" id="2700047">name</span>&nbsp;<span class="op" id="2700052">&amp;&amp;</span>&nbsp;<span class="op" id="2700055">(</span><span class="ident" id="2700056">tf</span><span class="op" id="2700058">.</span><span class="ident" id="2700059">name</span>&nbsp;<span class="op" id="2700064">==</span>&nbsp;<span class="ident" id="2700067">nil</span>&nbsp;<span class="op" id="2700071">||</span>&nbsp;<span class="ident" id="2700074">vf</span><span class="op" id="2700076">.</span><span class="ident" id="2700077">name</span>&nbsp;<span class="op" id="2700082">==</span>&nbsp;<span class="ident" id="2700085">nil</span>&nbsp;<span class="op" id="2700089">||</span>&nbsp;<span class="op" id="2700092">*</span><span class="ident" id="2700093">tf</span><span class="op" id="2700095">.</span><span class="ident" id="2700096">name</span>&nbsp;<span class="op" id="2700101">!=</span>&nbsp;<span class="op" id="2700104">*</span><span class="ident" id="2700105">vf</span><span class="op" id="2700107">.</span><span class="ident" id="2700108">name</span><span class="op" id="2700112">)</span>&nbsp;<span class="op" id="2700114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700120">return</span>&nbsp;<span class="builtintype" id="2700127">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700136">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700141">if</span>&nbsp;<span class="ident" id="2700144">tf</span><span class="op" id="2700146">.</span><span class="ident" id="2700147">pkgPath</span>&nbsp;<span class="op" id="2700155">!=</span>&nbsp;<span class="ident" id="2700158">vf</span><span class="op" id="2700160">.</span><span class="ident" id="2700161">pkgPath</span>&nbsp;<span class="op" id="2700169">&amp;&amp;</span>&nbsp;<span class="op" id="2700172">(</span><span class="ident" id="2700173">tf</span><span class="op" id="2700175">.</span><span class="ident" id="2700176">pkgPath</span>&nbsp;<span class="op" id="2700184">==</span>&nbsp;<span class="ident" id="2700187">nil</span>&nbsp;<span class="op" id="2700191">||</span>&nbsp;<span class="ident" id="2700194">vf</span><span class="op" id="2700196">.</span><span class="ident" id="2700197">pkgPath</span>&nbsp;<span class="op" id="2700205">==</span>&nbsp;<span class="ident" id="2700208">nil</span>&nbsp;<span class="op" id="2700212">||</span>&nbsp;<span class="op" id="2700215">*</span><span class="ident" id="2700216">tf</span><span class="op" id="2700218">.</span><span class="ident" id="2700219">pkgPath</span>&nbsp;<span class="op" id="2700227">!=</span>&nbsp;<span class="op" id="2700230">*</span><span class="ident" id="2700231">vf</span><span class="op" id="2700233">.</span><span class="ident" id="2700234">pkgPath</span><span class="op" id="2700241">)</span>&nbsp;<span class="op" id="2700243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700249">return</span>&nbsp;<span class="builtintype" id="2700256">false</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700270">if</span>&nbsp;<span class="ident" id="2700273">tf</span><span class="op" id="2700275">.</span><span class="ident" id="2700276">typ</span>&nbsp;<span class="op" id="2700280">!=</span>&nbsp;<span class="ident" id="2700283">vf</span><span class="op" id="2700285">.</span><span class="ident" id="2700286">typ</span>&nbsp;<span class="op" id="2700290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700296">return</span>&nbsp;<span class="builtintype" id="2700303">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700317">if</span>&nbsp;<span class="ident" id="2700320">tf</span><span class="op" id="2700322">.</span><span class="ident" id="2700323">tag</span>&nbsp;<span class="op" id="2700327">!=</span>&nbsp;<span class="ident" id="2700330">vf</span><span class="op" id="2700332">.</span><span class="ident" id="2700333">tag</span>&nbsp;<span class="op" id="2700337">&amp;&amp;</span>&nbsp;<span class="op" id="2700340">(</span><span class="ident" id="2700341">tf</span><span class="op" id="2700343">.</span><span class="ident" id="2700344">tag</span>&nbsp;<span class="op" id="2700348">==</span>&nbsp;<span class="ident" id="2700351">nil</span>&nbsp;<span class="op" id="2700355">||</span>&nbsp;<span class="ident" id="2700358">vf</span><span class="op" id="2700360">.</span><span class="ident" id="2700361">tag</span>&nbsp;<span class="op" id="2700365">==</span>&nbsp;<span class="ident" id="2700368">nil</span>&nbsp;<span class="op" id="2700372">||</span>&nbsp;<span class="op" id="2700375">*</span><span class="ident" id="2700376">tf</span><span class="op" id="2700378">.</span><span class="ident" id="2700379">tag</span>&nbsp;<span class="op" id="2700383">!=</span>&nbsp;<span class="op" id="2700386">*</span><span class="ident" id="2700387">vf</span><span class="op" id="2700389">.</span><span class="ident" id="2700390">tag</span><span class="op" id="2700393">)</span>&nbsp;<span class="op" id="2700395">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700401">return</span>&nbsp;<span class="builtintype" id="2700408">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700422">if</span>&nbsp;<span class="ident" id="2700425">tf</span><span class="op" id="2700427">.</span><span class="ident" id="2700428">offset</span>&nbsp;<span class="op" id="2700435">!=</span>&nbsp;<span class="ident" id="2700438">vf</span><span class="op" id="2700440">.</span><span class="ident" id="2700441">offset</span>&nbsp;<span class="op" id="2700448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700454">return</span>&nbsp;<span class="builtintype" id="2700461">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700470">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700478">return</span>&nbsp;<span class="builtintype" id="2700485">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2700491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2700495">return</span>&nbsp;<span class="builtintype" id="2700502">false</span><br>
<span class="lineno">1285</span><span class="op" id="2700508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2700511">//&nbsp;typelinks&nbsp;is&nbsp;implemented&nbsp;in&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="comment" id="2700559">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;all&nbsp;the&nbsp;&#39;typelink&#39;&nbsp;information&nbsp;in&nbsp;the&nbsp;binary,</span><br>
<span class="lineno"></span><span class="comment" id="2700630">//&nbsp;which&nbsp;is&nbsp;to&nbsp;say&nbsp;a&nbsp;slice&nbsp;of&nbsp;known&nbsp;types,&nbsp;sorted&nbsp;by&nbsp;string.</span><br>
<span class="lineno">1290</span><span class="comment" id="2700691">//&nbsp;Note&nbsp;that&nbsp;strings&nbsp;are&nbsp;not&nbsp;unique&nbsp;identifiers&nbsp;for&nbsp;types:</span><br>
<span class="lineno"></span><span class="comment" id="2700750">//&nbsp;there&nbsp;can&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;with&nbsp;a&nbsp;given&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="2700801">//&nbsp;Only&nbsp;types&nbsp;we&nbsp;might&nbsp;want&nbsp;to&nbsp;look&nbsp;up&nbsp;are&nbsp;included:</span><br>
<span class="lineno"></span><span class="comment" id="2700854">//&nbsp;channels,&nbsp;maps,&nbsp;slices,&nbsp;and&nbsp;arrays.</span><br>
<span class="lineno"></span><span class="keyword" id="2700893">func</span>&nbsp;<span class="ident" id="2700898">typelinks</span><span class="op" id="2700907">(</span><span class="op" id="2700908">)</span>&nbsp;<span class="op" id="2700910">[</span><span class="op" id="2700911">]</span><span class="op" id="2700912">*</span><span class="ident" id="2700913">rtype</span><br>
<span class="lineno">1295</span><br>
<span class="lineno"></span><span class="comment" id="2700920">//&nbsp;typesByString&nbsp;returns&nbsp;the&nbsp;subslice&nbsp;of&nbsp;typelinks()&nbsp;whose&nbsp;elements&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2700993">//&nbsp;the&nbsp;given&nbsp;string&nbsp;representation.</span><br>
<span class="lineno"></span><span class="comment" id="2701029">//&nbsp;It&nbsp;may&nbsp;be&nbsp;empty&nbsp;(no&nbsp;known&nbsp;types&nbsp;with&nbsp;that&nbsp;string)&nbsp;or&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2701094">//&nbsp;multiple&nbsp;elements&nbsp;(multiple&nbsp;types&nbsp;with&nbsp;that&nbsp;string).</span><br>
<span class="lineno">1300</span><span class="keyword" id="2701150">func</span>&nbsp;<span class="ident" id="2701155">typesByString</span><span class="op" id="2701168">(</span><span class="ident" id="2701169">s</span>&nbsp;<span class="builtintype" id="2701171">string</span><span class="op" id="2701177">)</span>&nbsp;<span class="op" id="2701179">[</span><span class="op" id="2701180">]</span><span class="op" id="2701181">*</span><span class="ident" id="2701182">rtype</span>&nbsp;<span class="op" id="2701188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701191">typ</span>&nbsp;<span class="op" id="2701195">:=</span>&nbsp;<span class="ident" id="2701198">typelinks</span><span class="op" id="2701207">(</span><span class="op" id="2701208">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701212">//&nbsp;We&nbsp;are&nbsp;looking&nbsp;for&nbsp;the&nbsp;first&nbsp;index&nbsp;i&nbsp;where&nbsp;the&nbsp;string&nbsp;becomes&nbsp;&gt;=&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701284">//&nbsp;This&nbsp;is&nbsp;a&nbsp;copy&nbsp;of&nbsp;sort.Search,&nbsp;with&nbsp;f(h)&nbsp;replaced&nbsp;by&nbsp;(*typ[h].string&nbsp;&gt;=&nbsp;s).</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701364">i</span><span class="op" id="2701365">,</span>&nbsp;<span class="ident" id="2701367">j</span>&nbsp;<span class="op" id="2701369">:=</span>&nbsp;<span class="num" id="2701372">0</span><span class="op" id="2701373">,</span>&nbsp;<span class="builtinfunc" id="2701375">len</span><span class="op" id="2701378">(</span><span class="ident" id="2701379">typ</span><span class="op" id="2701382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701385">for</span>&nbsp;<span class="ident" id="2701389">i</span>&nbsp;<span class="op" id="2701391">&lt;</span>&nbsp;<span class="ident" id="2701393">j</span>&nbsp;<span class="op" id="2701395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701399">h</span>&nbsp;<span class="op" id="2701401">:=</span>&nbsp;<span class="ident" id="2701404">i</span>&nbsp;<span class="op" id="2701406">+</span>&nbsp;<span class="op" id="2701408">(</span><span class="ident" id="2701409">j</span><span class="op" id="2701410">-</span><span class="ident" id="2701411">i</span><span class="op" id="2701412">)</span><span class="op" id="2701413">/</span><span class="num" id="2701414">2</span>&nbsp;<span class="comment" id="2701416">//&nbsp;avoid&nbsp;overflow&nbsp;when&nbsp;computing&nbsp;h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701453">//&nbsp;i&nbsp;≤&nbsp;h&nbsp;&lt;&nbsp;j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701470">if</span>&nbsp;<span class="op" id="2701473">!</span><span class="op" id="2701474">(</span><span class="op" id="2701475">*</span><span class="ident" id="2701476">typ</span><span class="op" id="2701479">[</span><span class="ident" id="2701480">h</span><span class="op" id="2701481">]</span><span class="op" id="2701482">.</span><span class="builtintype" id="2701483">string</span>&nbsp;<span class="op" id="2701490">&gt;=</span>&nbsp;<span class="ident" id="2701493">s</span><span class="op" id="2701494">)</span>&nbsp;<span class="op" id="2701496">{</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701501">i</span>&nbsp;<span class="op" id="2701503">=</span>&nbsp;<span class="ident" id="2701505">h</span>&nbsp;<span class="op" id="2701507">+</span>&nbsp;<span class="num" id="2701509">1</span>&nbsp;<span class="comment" id="2701511">//&nbsp;preserves&nbsp;f(i-1)&nbsp;==&nbsp;false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2701542">}</span>&nbsp;<span class="keyword" id="2701544">else</span>&nbsp;<span class="op" id="2701549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701554">j</span>&nbsp;<span class="op" id="2701556">=</span>&nbsp;<span class="ident" id="2701558">h</span>&nbsp;<span class="comment" id="2701560">//&nbsp;preserves&nbsp;f(j)&nbsp;==&nbsp;true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2701588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2701591">}</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701594">//&nbsp;i&nbsp;==&nbsp;j,&nbsp;f(i-1)&nbsp;==&nbsp;false,&nbsp;and&nbsp;f(j)&nbsp;(=&nbsp;f(i))&nbsp;==&nbsp;true&nbsp;&nbsp;=&gt;&nbsp;&nbsp;answer&nbsp;is&nbsp;i.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701668">//&nbsp;Having&nbsp;found&nbsp;the&nbsp;first,&nbsp;linear&nbsp;scan&nbsp;forward&nbsp;to&nbsp;find&nbsp;the&nbsp;last.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701734">//&nbsp;We&nbsp;could&nbsp;do&nbsp;a&nbsp;second&nbsp;binary&nbsp;search,&nbsp;but&nbsp;the&nbsp;caller&nbsp;is&nbsp;going</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701798">//&nbsp;to&nbsp;do&nbsp;a&nbsp;linear&nbsp;scan&nbsp;anyway.</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701830">j</span>&nbsp;<span class="op" id="2701832">=</span>&nbsp;<span class="ident" id="2701834">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701837">for</span>&nbsp;<span class="ident" id="2701841">j</span>&nbsp;<span class="op" id="2701843">&lt;</span>&nbsp;<span class="builtinfunc" id="2701845">len</span><span class="op" id="2701848">(</span><span class="ident" id="2701849">typ</span><span class="op" id="2701852">)</span>&nbsp;<span class="op" id="2701854">&amp;&amp;</span>&nbsp;<span class="op" id="2701857">*</span><span class="ident" id="2701858">typ</span><span class="op" id="2701861">[</span><span class="ident" id="2701862">j</span><span class="op" id="2701863">]</span><span class="op" id="2701864">.</span><span class="builtintype" id="2701865">string</span>&nbsp;<span class="op" id="2701872">==</span>&nbsp;<span class="ident" id="2701875">s</span>&nbsp;<span class="op" id="2701877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2701881">j</span><span class="op" id="2701882">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2701886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2701890">//&nbsp;This&nbsp;slice&nbsp;will&nbsp;be&nbsp;empty&nbsp;if&nbsp;the&nbsp;string&nbsp;is&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2701947">return</span>&nbsp;<span class="ident" id="2701954">typ</span><span class="op" id="2701957">[</span><span class="ident" id="2701958">i</span><span class="op" id="2701959">:</span><span class="ident" id="2701960">j</span><span class="op" id="2701961">]</span><br>
<span class="lineno"></span><span class="op" id="2701963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2701966">//&nbsp;The&nbsp;lookupCache&nbsp;caches&nbsp;ChanOf,&nbsp;MapOf,&nbsp;and&nbsp;SliceOf&nbsp;lookups.</span><br>
<span class="lineno">1330</span><span class="keyword" id="2702028">var</span>&nbsp;<span class="ident" id="2702032">lookupCache</span>&nbsp;<span class="keyword" id="2702044">struct</span>&nbsp;<span class="op" id="2702051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702054">sync</span><span class="op" id="2702058">.</span><span class="ident" id="2702059">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702068">m</span>&nbsp;<span class="keyword" id="2702070">map</span><span class="op" id="2702073">[</span><span class="ident" id="2702074">cacheKey</span><span class="op" id="2702082">]</span><span class="op" id="2702083">*</span><span class="ident" id="2702084">rtype</span><br>
<span class="lineno"></span><span class="op" id="2702090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="comment" id="2702093">//&nbsp;A&nbsp;cacheKey&nbsp;is&nbsp;the&nbsp;key&nbsp;for&nbsp;use&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2702146">//&nbsp;Four&nbsp;values&nbsp;describe&nbsp;any&nbsp;of&nbsp;the&nbsp;types&nbsp;we&nbsp;are&nbsp;looking&nbsp;for:</span><br>
<span class="lineno"></span><span class="comment" id="2702207">//&nbsp;type&nbsp;kind,&nbsp;one&nbsp;or&nbsp;two&nbsp;subtypes,&nbsp;and&nbsp;an&nbsp;extra&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="2702264">type</span>&nbsp;<span class="ident" id="2702269">cacheKey</span>&nbsp;<span class="keyword" id="2702278">struct</span>&nbsp;<span class="op" id="2702285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702288">kind</span>&nbsp;&nbsp;<span class="ident" id="2702294">Kind</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702300">t1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2702306">*</span><span class="ident" id="2702307">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702314">t2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2702320">*</span><span class="ident" id="2702321">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702328">extra</span>&nbsp;<span class="builtintype" id="2702334">uintptr</span><br>
<span class="lineno"></span><span class="op" id="2702342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1345</span><span class="comment" id="2702345">//&nbsp;cacheGet&nbsp;looks&nbsp;for&nbsp;a&nbsp;type&nbsp;under&nbsp;the&nbsp;key&nbsp;k&nbsp;in&nbsp;the&nbsp;lookupCache.</span><br>
<span class="lineno"></span><span class="comment" id="2702410">//&nbsp;If&nbsp;it&nbsp;finds&nbsp;one,&nbsp;it&nbsp;returns&nbsp;that&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2702452">//&nbsp;If&nbsp;not,&nbsp;it&nbsp;returns&nbsp;nil&nbsp;with&nbsp;the&nbsp;cache&nbsp;locked.</span><br>
<span class="lineno"></span><span class="comment" id="2702501">//&nbsp;The&nbsp;caller&nbsp;is&nbsp;expected&nbsp;to&nbsp;use&nbsp;cachePut&nbsp;to&nbsp;unlock&nbsp;the&nbsp;cache.</span><br>
<span class="lineno"></span><span class="keyword" id="2702564">func</span>&nbsp;<span class="ident" id="2702569">cacheGet</span><span class="op" id="2702577">(</span><span class="ident" id="2702578">k</span>&nbsp;<span class="ident" id="2702580">cacheKey</span><span class="op" id="2702588">)</span>&nbsp;<span class="ident" id="2702590">Type</span>&nbsp;<span class="op" id="2702595">{</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702598">lookupCache</span><span class="op" id="2702609">.</span><span class="ident" id="2702610">RLock</span><span class="op" id="2702615">(</span><span class="op" id="2702616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702619">t</span>&nbsp;<span class="op" id="2702621">:=</span>&nbsp;<span class="ident" id="2702624">lookupCache</span><span class="op" id="2702635">.</span><span class="ident" id="2702636">m</span><span class="op" id="2702637">[</span><span class="ident" id="2702638">k</span><span class="op" id="2702639">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702642">lookupCache</span><span class="op" id="2702653">.</span><span class="ident" id="2702654">RUnlock</span><span class="op" id="2702661">(</span><span class="op" id="2702662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702665">if</span>&nbsp;<span class="ident" id="2702668">t</span>&nbsp;<span class="op" id="2702670">!=</span>&nbsp;<span class="ident" id="2702673">nil</span>&nbsp;<span class="op" id="2702677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702681">return</span>&nbsp;<span class="ident" id="2702688">t</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702695">lookupCache</span><span class="op" id="2702706">.</span><span class="ident" id="2702707">Lock</span><span class="op" id="2702711">(</span><span class="op" id="2702712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702715">t</span>&nbsp;<span class="op" id="2702717">=</span>&nbsp;<span class="ident" id="2702719">lookupCache</span><span class="op" id="2702730">.</span><span class="ident" id="2702731">m</span><span class="op" id="2702732">[</span><span class="ident" id="2702733">k</span><span class="op" id="2702734">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702737">if</span>&nbsp;<span class="ident" id="2702740">t</span>&nbsp;<span class="op" id="2702742">!=</span>&nbsp;<span class="ident" id="2702745">nil</span>&nbsp;<span class="op" id="2702749">{</span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702753">lookupCache</span><span class="op" id="2702764">.</span><span class="ident" id="2702765">Unlock</span><span class="op" id="2702771">(</span><span class="op" id="2702772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702776">return</span>&nbsp;<span class="ident" id="2702783">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702790">if</span>&nbsp;<span class="ident" id="2702793">lookupCache</span><span class="op" id="2702804">.</span><span class="ident" id="2702805">m</span>&nbsp;<span class="op" id="2702807">==</span>&nbsp;<span class="ident" id="2702810">nil</span>&nbsp;<span class="op" id="2702814">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2702818">lookupCache</span><span class="op" id="2702829">.</span><span class="ident" id="2702830">m</span>&nbsp;<span class="op" id="2702832">=</span>&nbsp;<span class="builtinfunc" id="2702834">make</span><span class="op" id="2702838">(</span><span class="keyword" id="2702839">map</span><span class="op" id="2702842">[</span><span class="ident" id="2702843">cacheKey</span><span class="op" id="2702851">]</span><span class="op" id="2702852">*</span><span class="ident" id="2702853">rtype</span><span class="op" id="2702858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2702861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2702865">return</span>&nbsp;<span class="ident" id="2702872">nil</span><br>
<span class="lineno"></span><span class="op" id="2702876">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="2702879">//&nbsp;cachePut&nbsp;stores&nbsp;the&nbsp;given&nbsp;type&nbsp;in&nbsp;the&nbsp;cache,&nbsp;unlocks&nbsp;the&nbsp;cache,</span><br>
<span class="lineno"></span><span class="comment" id="2702946">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;type.&nbsp;It&nbsp;is&nbsp;expected&nbsp;that&nbsp;the&nbsp;cache&nbsp;is&nbsp;locked</span><br>
<span class="lineno"></span><span class="comment" id="2703011">//&nbsp;because&nbsp;cacheGet&nbsp;returned&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2703045">func</span>&nbsp;<span class="ident" id="2703050">cachePut</span><span class="op" id="2703058">(</span><span class="ident" id="2703059">k</span>&nbsp;<span class="ident" id="2703061">cacheKey</span><span class="op" id="2703069">,</span>&nbsp;<span class="ident" id="2703071">t</span>&nbsp;<span class="op" id="2703073">*</span><span class="ident" id="2703074">rtype</span><span class="op" id="2703079">)</span>&nbsp;<span class="ident" id="2703081">Type</span>&nbsp;<span class="op" id="2703086">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703089">lookupCache</span><span class="op" id="2703100">.</span><span class="ident" id="2703101">m</span><span class="op" id="2703102">[</span><span class="ident" id="2703103">k</span><span class="op" id="2703104">]</span>&nbsp;<span class="op" id="2703106">=</span>&nbsp;<span class="ident" id="2703108">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703111">lookupCache</span><span class="op" id="2703122">.</span><span class="ident" id="2703123">Unlock</span><span class="op" id="2703129">(</span><span class="op" id="2703130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703133">return</span>&nbsp;<span class="ident" id="2703140">t</span><br>
<span class="lineno"></span><span class="op" id="2703142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1380</span><span class="comment" id="2703145">//&nbsp;ChanOf&nbsp;returns&nbsp;the&nbsp;channel&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;direction&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2703223">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ChanOf(RecvDir,&nbsp;t)&nbsp;represents&nbsp;&lt;-chan&nbsp;int.</span><br>
<span class="lineno"></span><span class="comment" id="2703302">//</span><br>
<span class="lineno"></span><span class="comment" id="2703305">//&nbsp;The&nbsp;gc&nbsp;runtime&nbsp;imposes&nbsp;a&nbsp;limit&nbsp;of&nbsp;64&nbsp;kB&nbsp;on&nbsp;channel&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2703374">//&nbsp;If&nbsp;t&#39;s&nbsp;size&nbsp;is&nbsp;equal&nbsp;to&nbsp;or&nbsp;exceeds&nbsp;this&nbsp;limit,&nbsp;ChanOf&nbsp;panics.</span><br>
<span class="lineno">1385</span><span class="keyword" id="2703439">func</span>&nbsp;<span class="ident" id="2703444">ChanOf</span><span class="op" id="2703450">(</span><span class="ident" id="2703451">dir</span>&nbsp;<span class="ident" id="2703455">ChanDir</span><span class="op" id="2703462">,</span>&nbsp;<span class="ident" id="2703464">t</span>&nbsp;<span class="ident" id="2703466">Type</span><span class="op" id="2703470">)</span>&nbsp;<span class="ident" id="2703472">Type</span>&nbsp;<span class="op" id="2703477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703480">typ</span>&nbsp;<span class="op" id="2703484">:=</span>&nbsp;<span class="ident" id="2703487">t</span><span class="op" id="2703488">.</span><span class="op" id="2703489">(</span><span class="op" id="2703490">*</span><span class="ident" id="2703491">rtype</span><span class="op" id="2703496">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703500">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703519">ckey</span>&nbsp;<span class="op" id="2703524">:=</span>&nbsp;<span class="ident" id="2703527">cacheKey</span><span class="op" id="2703535">{</span><span class="ident" id="2703536">Chan</span><span class="op" id="2703540">,</span>&nbsp;<span class="ident" id="2703542">typ</span><span class="op" id="2703545">,</span>&nbsp;<span class="ident" id="2703547">nil</span><span class="op" id="2703550">,</span>&nbsp;<span class="builtintype" id="2703552">uintptr</span><span class="op" id="2703559">(</span><span class="ident" id="2703560">dir</span><span class="op" id="2703563">)</span><span class="op" id="2703564">}</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703567">if</span>&nbsp;<span class="ident" id="2703570">ch</span>&nbsp;<span class="op" id="2703573">:=</span>&nbsp;<span class="ident" id="2703576">cacheGet</span><span class="op" id="2703584">(</span><span class="ident" id="2703585">ckey</span><span class="op" id="2703589">)</span><span class="op" id="2703590">;</span>&nbsp;<span class="ident" id="2703592">ch</span>&nbsp;<span class="op" id="2703595">!=</span>&nbsp;<span class="ident" id="2703598">nil</span>&nbsp;<span class="op" id="2703602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703606">return</span>&nbsp;<span class="ident" id="2703613">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703621">//&nbsp;This&nbsp;restriction&nbsp;is&nbsp;imposed&nbsp;by&nbsp;the&nbsp;gc&nbsp;compiler&nbsp;and&nbsp;the&nbsp;runtime.</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703689">if</span>&nbsp;<span class="ident" id="2703692">typ</span><span class="op" id="2703695">.</span><span class="ident" id="2703696">size</span>&nbsp;<span class="op" id="2703701">&gt;=</span>&nbsp;<span class="num" id="2703704">1</span><span class="op" id="2703705">&lt;&lt;</span><span class="num" id="2703707">16</span>&nbsp;<span class="op" id="2703710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703714">lookupCache</span><span class="op" id="2703725">.</span><span class="ident" id="2703726">Unlock</span><span class="op" id="2703732">(</span><span class="op" id="2703733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2703737">panic</span><span class="op" id="2703742">(</span><span class="string" id="2703743">&#34;reflect.ChanOf:&nbsp;element&nbsp;size&nbsp;too&nbsp;large&#34;</span><span class="op" id="2703783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2703786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703790">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2703815">//&nbsp;TODO:&nbsp;Precedence&nbsp;when&nbsp;constructing&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703862">var</span>&nbsp;<span class="ident" id="2703866">s</span>&nbsp;<span class="builtintype" id="2703868">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703876">switch</span>&nbsp;<span class="ident" id="2703883">dir</span>&nbsp;<span class="op" id="2703887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703890">default</span><span class="op" id="2703897">:</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703901">lookupCache</span><span class="op" id="2703912">.</span><span class="ident" id="2703913">Unlock</span><span class="op" id="2703919">(</span><span class="op" id="2703920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2703924">panic</span><span class="op" id="2703929">(</span><span class="string" id="2703930">&#34;reflect.ChanOf:&nbsp;invalid&nbsp;dir&#34;</span><span class="op" id="2703959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2703962">case</span>&nbsp;<span class="ident" id="2703967">SendDir</span><span class="op" id="2703974">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2703978">s</span>&nbsp;<span class="op" id="2703980">=</span>&nbsp;<span class="string" id="2703982">&#34;chan&lt;-&nbsp;&#34;</span>&nbsp;<span class="op" id="2703992">+</span>&nbsp;<span class="op" id="2703994">*</span><span class="ident" id="2703995">typ</span><span class="op" id="2703998">.</span><span class="builtintype" id="2703999">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704007">case</span>&nbsp;<span class="ident" id="2704012">RecvDir</span><span class="op" id="2704019">:</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704023">s</span>&nbsp;<span class="op" id="2704025">=</span>&nbsp;<span class="string" id="2704027">&#34;&lt;-chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2704037">+</span>&nbsp;<span class="op" id="2704039">*</span><span class="ident" id="2704040">typ</span><span class="op" id="2704043">.</span><span class="builtintype" id="2704044">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704052">case</span>&nbsp;<span class="ident" id="2704057">BothDir</span><span class="op" id="2704064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704068">s</span>&nbsp;<span class="op" id="2704070">=</span>&nbsp;<span class="string" id="2704072">&#34;chan&nbsp;&#34;</span>&nbsp;<span class="op" id="2704080">+</span>&nbsp;<span class="op" id="2704082">*</span><span class="ident" id="2704083">typ</span><span class="op" id="2704086">.</span><span class="builtintype" id="2704087">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704098">for</span>&nbsp;<span class="ident" id="2704102">_</span><span class="op" id="2704103">,</span>&nbsp;<span class="ident" id="2704105">tt</span>&nbsp;<span class="op" id="2704108">:=</span>&nbsp;<span class="keyword" id="2704111">range</span>&nbsp;<span class="ident" id="2704117">typesByString</span><span class="op" id="2704130">(</span><span class="ident" id="2704131">s</span><span class="op" id="2704132">)</span>&nbsp;<span class="op" id="2704134">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704138">ch</span>&nbsp;<span class="op" id="2704141">:=</span>&nbsp;<span class="op" id="2704144">(</span><span class="op" id="2704145">*</span><span class="ident" id="2704146">chanType</span><span class="op" id="2704154">)</span><span class="op" id="2704155">(</span><span class="ident" id="2704156">unsafe</span><span class="op" id="2704162">.</span><span class="ident" id="2704163">Pointer</span><span class="op" id="2704170">(</span><span class="ident" id="2704171">tt</span><span class="op" id="2704173">)</span><span class="op" id="2704174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704178">if</span>&nbsp;<span class="ident" id="2704181">ch</span><span class="op" id="2704183">.</span><span class="ident" id="2704184">elem</span>&nbsp;<span class="op" id="2704189">==</span>&nbsp;<span class="ident" id="2704192">typ</span>&nbsp;<span class="op" id="2704196">&amp;&amp;</span>&nbsp;<span class="ident" id="2704199">ch</span><span class="op" id="2704201">.</span><span class="ident" id="2704202">dir</span>&nbsp;<span class="op" id="2704206">==</span>&nbsp;<span class="builtintype" id="2704209">uintptr</span><span class="op" id="2704216">(</span><span class="ident" id="2704217">dir</span><span class="op" id="2704220">)</span>&nbsp;<span class="op" id="2704222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704227">return</span>&nbsp;<span class="ident" id="2704234">cachePut</span><span class="op" id="2704242">(</span><span class="ident" id="2704243">ckey</span><span class="op" id="2704247">,</span>&nbsp;<span class="ident" id="2704249">tt</span><span class="op" id="2704251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704258">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2704262">//&nbsp;Make&nbsp;a&nbsp;channel&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704287">var</span>&nbsp;<span class="ident" id="2704291">ichan</span>&nbsp;<span class="keyword" id="2704297">interface</span><span class="op" id="2704306">{</span><span class="op" id="2704307">}</span>&nbsp;<span class="op" id="2704309">=</span>&nbsp;<span class="op" id="2704311">(</span><span class="keyword" id="2704312">chan</span>&nbsp;<span class="ident" id="2704317">unsafe</span><span class="op" id="2704323">.</span><span class="ident" id="2704324">Pointer</span><span class="op" id="2704331">)</span><span class="op" id="2704332">(</span><span class="ident" id="2704333">nil</span><span class="op" id="2704336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704339">prototype</span>&nbsp;<span class="op" id="2704349">:=</span>&nbsp;<span class="op" id="2704352">*</span><span class="op" id="2704353">(</span><span class="op" id="2704354">*</span><span class="op" id="2704355">*</span><span class="ident" id="2704356">chanType</span><span class="op" id="2704364">)</span><span class="op" id="2704365">(</span><span class="ident" id="2704366">unsafe</span><span class="op" id="2704372">.</span><span class="ident" id="2704373">Pointer</span><span class="op" id="2704380">(</span><span class="op" id="2704381">&amp;</span><span class="ident" id="2704382">ichan</span><span class="op" id="2704387">)</span><span class="op" id="2704388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704391">ch</span>&nbsp;<span class="op" id="2704394">:=</span>&nbsp;<span class="builtinfunc" id="2704397">new</span><span class="op" id="2704400">(</span><span class="ident" id="2704401">chanType</span><span class="op" id="2704409">)</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2704412">*</span><span class="ident" id="2704413">ch</span>&nbsp;<span class="op" id="2704416">=</span>&nbsp;<span class="op" id="2704418">*</span><span class="ident" id="2704419">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704430">ch</span><span class="op" id="2704432">.</span><span class="builtintype" id="2704433">string</span>&nbsp;<span class="op" id="2704440">=</span>&nbsp;<span class="op" id="2704442">&amp;</span><span class="ident" id="2704443">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704446">ch</span><span class="op" id="2704448">.</span><span class="ident" id="2704449">hash</span>&nbsp;<span class="op" id="2704454">=</span>&nbsp;<span class="ident" id="2704456">fnv1</span><span class="op" id="2704460">(</span><span class="ident" id="2704461">typ</span><span class="op" id="2704464">.</span><span class="ident" id="2704465">hash</span><span class="op" id="2704469">,</span>&nbsp;<span class="string" id="2704471">&#39;c&#39;</span><span class="op" id="2704474">,</span>&nbsp;<span class="builtintype" id="2704476">byte</span><span class="op" id="2704480">(</span><span class="ident" id="2704481">dir</span><span class="op" id="2704484">)</span><span class="op" id="2704485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704488">ch</span><span class="op" id="2704490">.</span><span class="ident" id="2704491">elem</span>&nbsp;<span class="op" id="2704496">=</span>&nbsp;<span class="ident" id="2704498">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704503">ch</span><span class="op" id="2704505">.</span><span class="ident" id="2704506">uncommonType</span>&nbsp;<span class="op" id="2704519">=</span>&nbsp;<span class="ident" id="2704521">nil</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704526">ch</span><span class="op" id="2704528">.</span><span class="ident" id="2704529">ptrToThis</span>&nbsp;<span class="op" id="2704539">=</span>&nbsp;<span class="ident" id="2704541">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2704546">ch</span><span class="op" id="2704548">.</span><span class="ident" id="2704549">zero</span>&nbsp;<span class="op" id="2704554">=</span>&nbsp;<span class="ident" id="2704556">unsafe</span><span class="op" id="2704562">.</span><span class="ident" id="2704563">Pointer</span><span class="op" id="2704570">(</span><span class="op" id="2704571">&amp;</span><span class="builtinfunc" id="2704572">make</span><span class="op" id="2704576">(</span><span class="op" id="2704577">[</span><span class="op" id="2704578">]</span><span class="builtintype" id="2704579">byte</span><span class="op" id="2704583">,</span>&nbsp;<span class="ident" id="2704585">ch</span><span class="op" id="2704587">.</span><span class="ident" id="2704588">size</span><span class="op" id="2704592">)</span><span class="op" id="2704593">[</span><span class="num" id="2704594">0</span><span class="op" id="2704595">]</span><span class="op" id="2704596">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2704600">return</span>&nbsp;<span class="ident" id="2704607">cachePut</span><span class="op" id="2704615">(</span><span class="ident" id="2704616">ckey</span><span class="op" id="2704620">,</span>&nbsp;<span class="op" id="2704622">&amp;</span><span class="ident" id="2704623">ch</span><span class="op" id="2704625">.</span><span class="ident" id="2704626">rtype</span><span class="op" id="2704631">)</span><br>
<span class="lineno"></span><span class="op" id="2704633">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="keyword" id="2704636">func</span>&nbsp;<span class="ident" id="2704641">ismapkey</span><span class="op" id="2704649">(</span><span class="op" id="2704650">*</span><span class="ident" id="2704651">rtype</span><span class="op" id="2704656">)</span>&nbsp;<span class="builtintype" id="2704658">bool</span>&nbsp;<span class="comment" id="2704663">//&nbsp;implemented&nbsp;in&nbsp;runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2704690">//&nbsp;MapOf&nbsp;returns&nbsp;the&nbsp;map&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;key&nbsp;and&nbsp;element&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="2704758">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;k&nbsp;represents&nbsp;int&nbsp;and&nbsp;e&nbsp;represents&nbsp;string,</span><br>
<span class="lineno">1440</span><span class="comment" id="2704819">//&nbsp;MapOf(k,&nbsp;e)&nbsp;represents&nbsp;map[int]string.</span><br>
<span class="lineno"></span><span class="comment" id="2704861">//</span><br>
<span class="lineno"></span><span class="comment" id="2704864">//&nbsp;If&nbsp;the&nbsp;key&nbsp;type&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;map&nbsp;key&nbsp;type&nbsp;(that&nbsp;is,&nbsp;if&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2704932">//&nbsp;not&nbsp;implement&nbsp;Go&#39;s&nbsp;==&nbsp;operator),&nbsp;MapOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="keyword" id="2704982">func</span>&nbsp;<span class="ident" id="2704987">MapOf</span><span class="op" id="2704992">(</span><span class="ident" id="2704993">key</span><span class="op" id="2704996">,</span>&nbsp;<span class="ident" id="2704998">elem</span>&nbsp;<span class="ident" id="2705003">Type</span><span class="op" id="2705007">)</span>&nbsp;<span class="ident" id="2705009">Type</span>&nbsp;<span class="op" id="2705014">{</span><br>
<span class="lineno">1445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705017">ktyp</span>&nbsp;<span class="op" id="2705022">:=</span>&nbsp;<span class="ident" id="2705025">key</span><span class="op" id="2705028">.</span><span class="op" id="2705029">(</span><span class="op" id="2705030">*</span><span class="ident" id="2705031">rtype</span><span class="op" id="2705036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705039">etyp</span>&nbsp;<span class="op" id="2705044">:=</span>&nbsp;<span class="ident" id="2705047">elem</span><span class="op" id="2705051">.</span><span class="op" id="2705052">(</span><span class="op" id="2705053">*</span><span class="ident" id="2705054">rtype</span><span class="op" id="2705059">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705063">if</span>&nbsp;<span class="op" id="2705066">!</span><span class="ident" id="2705067">ismapkey</span><span class="op" id="2705075">(</span><span class="ident" id="2705076">ktyp</span><span class="op" id="2705080">)</span>&nbsp;<span class="op" id="2705082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2705086">panic</span><span class="op" id="2705091">(</span><span class="string" id="2705092">&#34;reflect.MapOf:&nbsp;invalid&nbsp;key&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="2705127">+</span>&nbsp;<span class="ident" id="2705129">ktyp</span><span class="op" id="2705133">.</span><span class="ident" id="2705134">String</span><span class="op" id="2705140">(</span><span class="op" id="2705141">)</span><span class="op" id="2705142">)</span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2705149">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705168">ckey</span>&nbsp;<span class="op" id="2705173">:=</span>&nbsp;<span class="ident" id="2705176">cacheKey</span><span class="op" id="2705184">{</span><span class="ident" id="2705185">Map</span><span class="op" id="2705188">,</span>&nbsp;<span class="ident" id="2705190">ktyp</span><span class="op" id="2705194">,</span>&nbsp;<span class="ident" id="2705196">etyp</span><span class="op" id="2705200">,</span>&nbsp;<span class="num" id="2705202">0</span><span class="op" id="2705203">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705206">if</span>&nbsp;<span class="ident" id="2705209">mt</span>&nbsp;<span class="op" id="2705212">:=</span>&nbsp;<span class="ident" id="2705215">cacheGet</span><span class="op" id="2705223">(</span><span class="ident" id="2705224">ckey</span><span class="op" id="2705228">)</span><span class="op" id="2705229">;</span>&nbsp;<span class="ident" id="2705231">mt</span>&nbsp;<span class="op" id="2705234">!=</span>&nbsp;<span class="ident" id="2705237">nil</span>&nbsp;<span class="op" id="2705241">{</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705245">return</span>&nbsp;<span class="ident" id="2705252">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705256">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2705260">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705285">s</span>&nbsp;<span class="op" id="2705287">:=</span>&nbsp;<span class="string" id="2705290">&#34;map[&#34;</span>&nbsp;<span class="op" id="2705297">+</span>&nbsp;<span class="op" id="2705299">*</span><span class="ident" id="2705300">ktyp</span><span class="op" id="2705304">.</span><span class="builtintype" id="2705305">string</span>&nbsp;<span class="op" id="2705312">+</span>&nbsp;<span class="string" id="2705314">&#34;]&#34;</span>&nbsp;<span class="op" id="2705318">+</span>&nbsp;<span class="op" id="2705320">*</span><span class="ident" id="2705321">etyp</span><span class="op" id="2705325">.</span><span class="builtintype" id="2705326">string</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705334">for</span>&nbsp;<span class="ident" id="2705338">_</span><span class="op" id="2705339">,</span>&nbsp;<span class="ident" id="2705341">tt</span>&nbsp;<span class="op" id="2705344">:=</span>&nbsp;<span class="keyword" id="2705347">range</span>&nbsp;<span class="ident" id="2705353">typesByString</span><span class="op" id="2705366">(</span><span class="ident" id="2705367">s</span><span class="op" id="2705368">)</span>&nbsp;<span class="op" id="2705370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705374">mt</span>&nbsp;<span class="op" id="2705377">:=</span>&nbsp;<span class="op" id="2705380">(</span><span class="op" id="2705381">*</span><span class="ident" id="2705382">mapType</span><span class="op" id="2705389">)</span><span class="op" id="2705390">(</span><span class="ident" id="2705391">unsafe</span><span class="op" id="2705397">.</span><span class="ident" id="2705398">Pointer</span><span class="op" id="2705405">(</span><span class="ident" id="2705406">tt</span><span class="op" id="2705408">)</span><span class="op" id="2705409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705413">if</span>&nbsp;<span class="ident" id="2705416">mt</span><span class="op" id="2705418">.</span><span class="ident" id="2705419">key</span>&nbsp;<span class="op" id="2705423">==</span>&nbsp;<span class="ident" id="2705426">ktyp</span>&nbsp;<span class="op" id="2705431">&amp;&amp;</span>&nbsp;<span class="ident" id="2705434">mt</span><span class="op" id="2705436">.</span><span class="ident" id="2705437">elem</span>&nbsp;<span class="op" id="2705442">==</span>&nbsp;<span class="ident" id="2705445">etyp</span>&nbsp;<span class="op" id="2705450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705455">return</span>&nbsp;<span class="ident" id="2705462">cachePut</span><span class="op" id="2705470">(</span><span class="ident" id="2705471">ckey</span><span class="op" id="2705475">,</span>&nbsp;<span class="ident" id="2705477">tt</span><span class="op" id="2705479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705483">}</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2705490">//&nbsp;Make&nbsp;a&nbsp;map&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705511">var</span>&nbsp;<span class="ident" id="2705515">imap</span>&nbsp;<span class="keyword" id="2705520">interface</span><span class="op" id="2705529">{</span><span class="op" id="2705530">}</span>&nbsp;<span class="op" id="2705532">=</span>&nbsp;<span class="op" id="2705534">(</span><span class="keyword" id="2705535">map</span><span class="op" id="2705538">[</span><span class="ident" id="2705539">unsafe</span><span class="op" id="2705545">.</span><span class="ident" id="2705546">Pointer</span><span class="op" id="2705553">]</span><span class="ident" id="2705554">unsafe</span><span class="op" id="2705560">.</span><span class="ident" id="2705561">Pointer</span><span class="op" id="2705568">)</span><span class="op" id="2705569">(</span><span class="ident" id="2705570">nil</span><span class="op" id="2705573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705576">prototype</span>&nbsp;<span class="op" id="2705586">:=</span>&nbsp;<span class="op" id="2705589">*</span><span class="op" id="2705590">(</span><span class="op" id="2705591">*</span><span class="op" id="2705592">*</span><span class="ident" id="2705593">mapType</span><span class="op" id="2705600">)</span><span class="op" id="2705601">(</span><span class="ident" id="2705602">unsafe</span><span class="op" id="2705608">.</span><span class="ident" id="2705609">Pointer</span><span class="op" id="2705616">(</span><span class="op" id="2705617">&amp;</span><span class="ident" id="2705618">imap</span><span class="op" id="2705622">)</span><span class="op" id="2705623">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705626">mt</span>&nbsp;<span class="op" id="2705629">:=</span>&nbsp;<span class="builtinfunc" id="2705632">new</span><span class="op" id="2705635">(</span><span class="ident" id="2705636">mapType</span><span class="op" id="2705643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705646">*</span><span class="ident" id="2705647">mt</span>&nbsp;<span class="op" id="2705650">=</span>&nbsp;<span class="op" id="2705652">*</span><span class="ident" id="2705653">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705664">mt</span><span class="op" id="2705666">.</span><span class="builtintype" id="2705667">string</span>&nbsp;<span class="op" id="2705674">=</span>&nbsp;<span class="op" id="2705676">&amp;</span><span class="ident" id="2705677">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705680">mt</span><span class="op" id="2705682">.</span><span class="ident" id="2705683">hash</span>&nbsp;<span class="op" id="2705688">=</span>&nbsp;<span class="ident" id="2705690">fnv1</span><span class="op" id="2705694">(</span><span class="ident" id="2705695">etyp</span><span class="op" id="2705699">.</span><span class="ident" id="2705700">hash</span><span class="op" id="2705704">,</span>&nbsp;<span class="string" id="2705706">&#39;m&#39;</span><span class="op" id="2705709">,</span>&nbsp;<span class="builtintype" id="2705711">byte</span><span class="op" id="2705715">(</span><span class="ident" id="2705716">ktyp</span><span class="op" id="2705720">.</span><span class="ident" id="2705721">hash</span><span class="op" id="2705725">&gt;&gt;</span><span class="num" id="2705727">24</span><span class="op" id="2705729">)</span><span class="op" id="2705730">,</span>&nbsp;<span class="builtintype" id="2705732">byte</span><span class="op" id="2705736">(</span><span class="ident" id="2705737">ktyp</span><span class="op" id="2705741">.</span><span class="ident" id="2705742">hash</span><span class="op" id="2705746">&gt;&gt;</span><span class="num" id="2705748">16</span><span class="op" id="2705750">)</span><span class="op" id="2705751">,</span>&nbsp;<span class="builtintype" id="2705753">byte</span><span class="op" id="2705757">(</span><span class="ident" id="2705758">ktyp</span><span class="op" id="2705762">.</span><span class="ident" id="2705763">hash</span><span class="op" id="2705767">&gt;&gt;</span><span class="num" id="2705769">8</span><span class="op" id="2705770">)</span><span class="op" id="2705771">,</span>&nbsp;<span class="builtintype" id="2705773">byte</span><span class="op" id="2705777">(</span><span class="ident" id="2705778">ktyp</span><span class="op" id="2705782">.</span><span class="ident" id="2705783">hash</span><span class="op" id="2705787">)</span><span class="op" id="2705788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705791">mt</span><span class="op" id="2705793">.</span><span class="ident" id="2705794">key</span>&nbsp;<span class="op" id="2705798">=</span>&nbsp;<span class="ident" id="2705800">ktyp</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705806">mt</span><span class="op" id="2705808">.</span><span class="ident" id="2705809">elem</span>&nbsp;<span class="op" id="2705814">=</span>&nbsp;<span class="ident" id="2705816">etyp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705822">mt</span><span class="op" id="2705824">.</span><span class="ident" id="2705825">bucket</span>&nbsp;<span class="op" id="2705832">=</span>&nbsp;<span class="ident" id="2705834">bucketOf</span><span class="op" id="2705842">(</span><span class="ident" id="2705843">ktyp</span><span class="op" id="2705847">,</span>&nbsp;<span class="ident" id="2705849">etyp</span><span class="op" id="2705853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2705856">if</span>&nbsp;<span class="ident" id="2705859">ktyp</span><span class="op" id="2705863">.</span><span class="ident" id="2705864">size</span>&nbsp;<span class="op" id="2705869">&gt;</span>&nbsp;<span class="ident" id="2705871">maxKeySize</span>&nbsp;<span class="op" id="2705882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705886">mt</span><span class="op" id="2705888">.</span><span class="ident" id="2705889">keysize</span>&nbsp;<span class="op" id="2705897">=</span>&nbsp;<span class="builtintype" id="2705899">uint8</span><span class="op" id="2705904">(</span><span class="ident" id="2705905">ptrSize</span><span class="op" id="2705912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705916">mt</span><span class="op" id="2705918">.</span><span class="ident" id="2705919">indirectkey</span>&nbsp;<span class="op" id="2705931">=</span>&nbsp;<span class="num" id="2705933">1</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705936">}</span>&nbsp;<span class="keyword" id="2705938">else</span>&nbsp;<span class="op" id="2705943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705947">mt</span><span class="op" id="2705949">.</span><span class="ident" id="2705950">keysize</span>&nbsp;<span class="op" id="2705958">=</span>&nbsp;<span class="builtintype" id="2705960">uint8</span><span class="op" id="2705965">(</span><span class="ident" id="2705966">ktyp</span><span class="op" id="2705970">.</span><span class="ident" id="2705971">size</span><span class="op" id="2705975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2705979">mt</span><span class="op" id="2705981">.</span><span class="ident" id="2705982">indirectkey</span>&nbsp;<span class="op" id="2705994">=</span>&nbsp;<span class="num" id="2705996">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2705999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706002">if</span>&nbsp;<span class="ident" id="2706005">etyp</span><span class="op" id="2706009">.</span><span class="ident" id="2706010">size</span>&nbsp;<span class="op" id="2706015">&gt;</span>&nbsp;<span class="ident" id="2706017">maxValSize</span>&nbsp;<span class="op" id="2706028">{</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706032">mt</span><span class="op" id="2706034">.</span><span class="ident" id="2706035">valuesize</span>&nbsp;<span class="op" id="2706045">=</span>&nbsp;<span class="builtintype" id="2706047">uint8</span><span class="op" id="2706052">(</span><span class="ident" id="2706053">ptrSize</span><span class="op" id="2706060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706064">mt</span><span class="op" id="2706066">.</span><span class="ident" id="2706067">indirectvalue</span>&nbsp;<span class="op" id="2706081">=</span>&nbsp;<span class="num" id="2706083">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2706086">}</span>&nbsp;<span class="keyword" id="2706088">else</span>&nbsp;<span class="op" id="2706093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706097">mt</span><span class="op" id="2706099">.</span><span class="ident" id="2706100">valuesize</span>&nbsp;<span class="op" id="2706110">=</span>&nbsp;<span class="builtintype" id="2706112">uint8</span><span class="op" id="2706117">(</span><span class="ident" id="2706118">etyp</span><span class="op" id="2706122">.</span><span class="ident" id="2706123">size</span><span class="op" id="2706127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706131">mt</span><span class="op" id="2706133">.</span><span class="ident" id="2706134">indirectvalue</span>&nbsp;<span class="op" id="2706148">=</span>&nbsp;<span class="num" id="2706150">0</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2706153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706156">mt</span><span class="op" id="2706158">.</span><span class="ident" id="2706159">bucketsize</span>&nbsp;<span class="op" id="2706170">=</span>&nbsp;<span class="builtintype" id="2706172">uint16</span><span class="op" id="2706178">(</span><span class="ident" id="2706179">mt</span><span class="op" id="2706181">.</span><span class="ident" id="2706182">bucket</span><span class="op" id="2706188">.</span><span class="ident" id="2706189">size</span><span class="op" id="2706193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706196">mt</span><span class="op" id="2706198">.</span><span class="ident" id="2706199">uncommonType</span>&nbsp;<span class="op" id="2706212">=</span>&nbsp;<span class="ident" id="2706214">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706219">mt</span><span class="op" id="2706221">.</span><span class="ident" id="2706222">ptrToThis</span>&nbsp;<span class="op" id="2706232">=</span>&nbsp;<span class="ident" id="2706234">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706239">mt</span><span class="op" id="2706241">.</span><span class="ident" id="2706242">zero</span>&nbsp;<span class="op" id="2706247">=</span>&nbsp;<span class="ident" id="2706249">unsafe</span><span class="op" id="2706255">.</span><span class="ident" id="2706256">Pointer</span><span class="op" id="2706263">(</span><span class="op" id="2706264">&amp;</span><span class="builtinfunc" id="2706265">make</span><span class="op" id="2706269">(</span><span class="op" id="2706270">[</span><span class="op" id="2706271">]</span><span class="builtintype" id="2706272">byte</span><span class="op" id="2706276">,</span>&nbsp;<span class="ident" id="2706278">mt</span><span class="op" id="2706280">.</span><span class="ident" id="2706281">size</span><span class="op" id="2706285">)</span><span class="op" id="2706286">[</span><span class="num" id="2706287">0</span><span class="op" id="2706288">]</span><span class="op" id="2706289">)</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706293">return</span>&nbsp;<span class="ident" id="2706300">cachePut</span><span class="op" id="2706308">(</span><span class="ident" id="2706309">ckey</span><span class="op" id="2706313">,</span>&nbsp;<span class="op" id="2706315">&amp;</span><span class="ident" id="2706316">mt</span><span class="op" id="2706318">.</span><span class="ident" id="2706319">rtype</span><span class="op" id="2706324">)</span><br>
<span class="lineno"></span><span class="op" id="2706326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2706329">//&nbsp;gcProg&nbsp;is&nbsp;a&nbsp;helper&nbsp;type&nbsp;for&nbsp;generatation&nbsp;of&nbsp;GC&nbsp;pointer&nbsp;info.</span><br>
<span class="lineno">1500</span><span class="keyword" id="2706393">type</span>&nbsp;<span class="ident" id="2706398">gcProg</span>&nbsp;<span class="keyword" id="2706405">struct</span>&nbsp;<span class="op" id="2706412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706415">gc</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2706420">[</span><span class="op" id="2706421">]</span><span class="builtintype" id="2706422">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706428">size</span>&nbsp;<span class="builtintype" id="2706433">uintptr</span>&nbsp;<span class="comment" id="2706441">//&nbsp;size&nbsp;of&nbsp;type&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><span class="op" id="2706466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1505</span><span class="keyword" id="2706469">func</span>&nbsp;<span class="op" id="2706474">(</span><span class="ident" id="2706475">gc</span>&nbsp;<span class="op" id="2706478">*</span><span class="ident" id="2706479">gcProg</span><span class="op" id="2706485">)</span>&nbsp;<span class="builtinfunc" id="2706487">append</span><span class="op" id="2706493">(</span><span class="ident" id="2706494">v</span>&nbsp;<span class="builtintype" id="2706496">byte</span><span class="op" id="2706500">)</span>&nbsp;<span class="op" id="2706502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706505">gc</span><span class="op" id="2706507">.</span><span class="ident" id="2706508">align</span><span class="op" id="2706513">(</span><span class="ident" id="2706514">unsafe</span><span class="op" id="2706520">.</span><span class="ident" id="2706521">Sizeof</span><span class="op" id="2706527">(</span><span class="builtintype" id="2706528">uintptr</span><span class="op" id="2706535">(</span><span class="num" id="2706536">0</span><span class="op" id="2706537">)</span><span class="op" id="2706538">)</span><span class="op" id="2706539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706542">gc</span><span class="op" id="2706544">.</span><span class="ident" id="2706545">appendWord</span><span class="op" id="2706555">(</span><span class="ident" id="2706556">v</span><span class="op" id="2706557">)</span><br>
<span class="lineno"></span><span class="op" id="2706559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1510</span><span class="comment" id="2706562">//&nbsp;Appends&nbsp;t&#39;s&nbsp;type&nbsp;info&nbsp;to&nbsp;the&nbsp;current&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2706611">func</span>&nbsp;<span class="op" id="2706616">(</span><span class="ident" id="2706617">gc</span>&nbsp;<span class="op" id="2706620">*</span><span class="ident" id="2706621">gcProg</span><span class="op" id="2706627">)</span>&nbsp;<span class="ident" id="2706629">appendProg</span><span class="op" id="2706639">(</span><span class="ident" id="2706640">t</span>&nbsp;<span class="op" id="2706642">*</span><span class="ident" id="2706643">rtype</span><span class="op" id="2706648">)</span>&nbsp;<span class="op" id="2706650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706653">gc</span><span class="op" id="2706655">.</span><span class="ident" id="2706656">align</span><span class="op" id="2706661">(</span><span class="builtintype" id="2706662">uintptr</span><span class="op" id="2706669">(</span><span class="ident" id="2706670">t</span><span class="op" id="2706671">.</span><span class="ident" id="2706672">align</span><span class="op" id="2706677">)</span><span class="op" id="2706678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706681">if</span>&nbsp;<span class="op" id="2706684">!</span><span class="ident" id="2706685">t</span><span class="op" id="2706686">.</span><span class="ident" id="2706687">pointers</span><span class="op" id="2706695">(</span><span class="op" id="2706696">)</span>&nbsp;<span class="op" id="2706698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706702">gc</span><span class="op" id="2706704">.</span><span class="ident" id="2706705">size</span>&nbsp;<span class="op" id="2706710">+=</span>&nbsp;<span class="ident" id="2706713">t</span><span class="op" id="2706714">.</span><span class="ident" id="2706715">size</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706722">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2706730">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706733">switch</span>&nbsp;<span class="ident" id="2706740">t</span><span class="op" id="2706741">.</span><span class="ident" id="2706742">Kind</span><span class="op" id="2706746">(</span><span class="op" id="2706747">)</span>&nbsp;<span class="op" id="2706749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706752">default</span><span class="op" id="2706759">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2706763">panic</span><span class="op" id="2706768">(</span><span class="string" id="2706769">&#34;reflect:&nbsp;non-pointer&nbsp;type&nbsp;marked&nbsp;as&nbsp;having&nbsp;pointers&#34;</span><span class="op" id="2706822">)</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706825">case</span>&nbsp;<span class="ident" id="2706830">Ptr</span><span class="op" id="2706833">,</span>&nbsp;<span class="ident" id="2706835">UnsafePointer</span><span class="op" id="2706848">,</span>&nbsp;<span class="ident" id="2706850">Chan</span><span class="op" id="2706854">,</span>&nbsp;<span class="ident" id="2706856">Func</span><span class="op" id="2706860">,</span>&nbsp;<span class="ident" id="2706862">Map</span><span class="op" id="2706865">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706869">gc</span><span class="op" id="2706871">.</span><span class="ident" id="2706872">appendWord</span><span class="op" id="2706882">(</span><span class="ident" id="2706883">bitsPointer</span><span class="op" id="2706894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706897">case</span>&nbsp;<span class="ident" id="2706902">Slice</span><span class="op" id="2706907">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706911">gc</span><span class="op" id="2706913">.</span><span class="ident" id="2706914">appendWord</span><span class="op" id="2706924">(</span><span class="ident" id="2706925">bitsPointer</span><span class="op" id="2706936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706940">gc</span><span class="op" id="2706942">.</span><span class="ident" id="2706943">appendWord</span><span class="op" id="2706953">(</span><span class="ident" id="2706954">bitsScalar</span><span class="op" id="2706964">)</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2706968">gc</span><span class="op" id="2706970">.</span><span class="ident" id="2706971">appendWord</span><span class="op" id="2706981">(</span><span class="ident" id="2706982">bitsScalar</span><span class="op" id="2706992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2706995">case</span>&nbsp;<span class="ident" id="2707000">String</span><span class="op" id="2707006">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707010">gc</span><span class="op" id="2707012">.</span><span class="ident" id="2707013">appendWord</span><span class="op" id="2707023">(</span><span class="ident" id="2707024">bitsPointer</span><span class="op" id="2707035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707039">gc</span><span class="op" id="2707041">.</span><span class="ident" id="2707042">appendWord</span><span class="op" id="2707052">(</span><span class="ident" id="2707053">bitsScalar</span><span class="op" id="2707063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707066">case</span>&nbsp;<span class="ident" id="2707071">Array</span><span class="op" id="2707076">:</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707080">c</span>&nbsp;<span class="op" id="2707082">:=</span>&nbsp;<span class="ident" id="2707085">t</span><span class="op" id="2707086">.</span><span class="ident" id="2707087">Len</span><span class="op" id="2707090">(</span><span class="op" id="2707091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707095">e</span>&nbsp;<span class="op" id="2707097">:=</span>&nbsp;<span class="ident" id="2707100">t</span><span class="op" id="2707101">.</span><span class="ident" id="2707102">Elem</span><span class="op" id="2707106">(</span><span class="op" id="2707107">)</span><span class="op" id="2707108">.</span><span class="ident" id="2707109">common</span><span class="op" id="2707115">(</span><span class="op" id="2707116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707120">for</span>&nbsp;<span class="ident" id="2707124">i</span>&nbsp;<span class="op" id="2707126">:=</span>&nbsp;<span class="num" id="2707129">0</span><span class="op" id="2707130">;</span>&nbsp;<span class="ident" id="2707132">i</span>&nbsp;<span class="op" id="2707134">&lt;</span>&nbsp;<span class="ident" id="2707136">c</span><span class="op" id="2707137">;</span>&nbsp;<span class="ident" id="2707139">i</span><span class="op" id="2707140">++</span>&nbsp;<span class="op" id="2707143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707148">gc</span><span class="op" id="2707150">.</span><span class="ident" id="2707151">appendProg</span><span class="op" id="2707161">(</span><span class="ident" id="2707162">e</span><span class="op" id="2707163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707167">}</span><br>
<span class="lineno">1535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707170">case</span>&nbsp;<span class="ident" id="2707175">Interface</span><span class="op" id="2707184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707188">gc</span><span class="op" id="2707190">.</span><span class="ident" id="2707191">appendWord</span><span class="op" id="2707201">(</span><span class="ident" id="2707202">bitsMultiWord</span><span class="op" id="2707215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707219">if</span>&nbsp;<span class="ident" id="2707222">t</span><span class="op" id="2707223">.</span><span class="ident" id="2707224">NumMethod</span><span class="op" id="2707233">(</span><span class="op" id="2707234">)</span>&nbsp;<span class="op" id="2707236">==</span>&nbsp;<span class="num" id="2707239">0</span>&nbsp;<span class="op" id="2707241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707246">gc</span><span class="op" id="2707248">.</span><span class="ident" id="2707249">appendWord</span><span class="op" id="2707259">(</span><span class="ident" id="2707260">bitsEface</span><span class="op" id="2707269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707273">}</span>&nbsp;<span class="keyword" id="2707275">else</span>&nbsp;<span class="op" id="2707280">{</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707285">gc</span><span class="op" id="2707287">.</span><span class="ident" id="2707288">appendWord</span><span class="op" id="2707298">(</span><span class="ident" id="2707299">bitsIface</span><span class="op" id="2707308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707315">case</span>&nbsp;<span class="ident" id="2707320">Struct</span><span class="op" id="2707326">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707330">c</span>&nbsp;<span class="op" id="2707332">:=</span>&nbsp;<span class="ident" id="2707335">t</span><span class="op" id="2707336">.</span><span class="ident" id="2707337">NumField</span><span class="op" id="2707345">(</span><span class="op" id="2707346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707350">for</span>&nbsp;<span class="ident" id="2707354">i</span>&nbsp;<span class="op" id="2707356">:=</span>&nbsp;<span class="num" id="2707359">0</span><span class="op" id="2707360">;</span>&nbsp;<span class="ident" id="2707362">i</span>&nbsp;<span class="op" id="2707364">&lt;</span>&nbsp;<span class="ident" id="2707366">c</span><span class="op" id="2707367">;</span>&nbsp;<span class="ident" id="2707369">i</span><span class="op" id="2707370">++</span>&nbsp;<span class="op" id="2707373">{</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707378">gc</span><span class="op" id="2707380">.</span><span class="ident" id="2707381">appendProg</span><span class="op" id="2707391">(</span><span class="ident" id="2707392">t</span><span class="op" id="2707393">.</span><span class="ident" id="2707394">Field</span><span class="op" id="2707399">(</span><span class="ident" id="2707400">i</span><span class="op" id="2707401">)</span><span class="op" id="2707402">.</span><span class="ident" id="2707403">Type</span><span class="op" id="2707407">.</span><span class="ident" id="2707408">common</span><span class="op" id="2707414">(</span><span class="op" id="2707415">)</span><span class="op" id="2707416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707424">gc</span><span class="op" id="2707426">.</span><span class="ident" id="2707427">align</span><span class="op" id="2707432">(</span><span class="builtintype" id="2707433">uintptr</span><span class="op" id="2707440">(</span><span class="ident" id="2707441">t</span><span class="op" id="2707442">.</span><span class="ident" id="2707443">align</span><span class="op" id="2707448">)</span><span class="op" id="2707449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707452">}</span><br>
<span class="lineno"></span><span class="op" id="2707454">}</span><br>
<span class="lineno">1550</span><br>
<span class="lineno"></span><span class="keyword" id="2707457">func</span>&nbsp;<span class="op" id="2707462">(</span><span class="ident" id="2707463">gc</span>&nbsp;<span class="op" id="2707466">*</span><span class="ident" id="2707467">gcProg</span><span class="op" id="2707473">)</span>&nbsp;<span class="ident" id="2707475">appendWord</span><span class="op" id="2707485">(</span><span class="ident" id="2707486">v</span>&nbsp;<span class="builtintype" id="2707488">byte</span><span class="op" id="2707492">)</span>&nbsp;<span class="op" id="2707494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707497">ptrsize</span>&nbsp;<span class="op" id="2707505">:=</span>&nbsp;<span class="ident" id="2707508">unsafe</span><span class="op" id="2707514">.</span><span class="ident" id="2707515">Sizeof</span><span class="op" id="2707521">(</span><span class="builtintype" id="2707522">uintptr</span><span class="op" id="2707529">(</span><span class="num" id="2707530">0</span><span class="op" id="2707531">)</span><span class="op" id="2707532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707535">if</span>&nbsp;<span class="ident" id="2707538">gc</span><span class="op" id="2707540">.</span><span class="ident" id="2707541">size</span><span class="op" id="2707545">%</span><span class="ident" id="2707546">ptrsize</span>&nbsp;<span class="op" id="2707554">!=</span>&nbsp;<span class="num" id="2707557">0</span>&nbsp;<span class="op" id="2707559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2707563">panic</span><span class="op" id="2707568">(</span><span class="string" id="2707569">&#34;reflect:&nbsp;unaligned&nbsp;GC&nbsp;program&#34;</span><span class="op" id="2707600">)</span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707606">nptr</span>&nbsp;<span class="op" id="2707611">:=</span>&nbsp;<span class="ident" id="2707614">gc</span><span class="op" id="2707616">.</span><span class="ident" id="2707617">size</span>&nbsp;<span class="op" id="2707622">/</span>&nbsp;<span class="ident" id="2707624">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707633">for</span>&nbsp;<span class="builtintype" id="2707637">uintptr</span><span class="op" id="2707644">(</span><span class="builtinfunc" id="2707645">len</span><span class="op" id="2707648">(</span><span class="ident" id="2707649">gc</span><span class="op" id="2707651">.</span><span class="ident" id="2707652">gc</span><span class="op" id="2707654">)</span><span class="op" id="2707655">)</span>&nbsp;<span class="op" id="2707657">&lt;</span>&nbsp;<span class="ident" id="2707659">nptr</span><span class="op" id="2707663">/</span><span class="num" id="2707664">2</span><span class="op" id="2707665">+</span><span class="num" id="2707666">1</span>&nbsp;<span class="op" id="2707668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707672">gc</span><span class="op" id="2707674">.</span><span class="ident" id="2707675">gc</span>&nbsp;<span class="op" id="2707678">=</span>&nbsp;<span class="builtinfunc" id="2707680">append</span><span class="op" id="2707686">(</span><span class="ident" id="2707687">gc</span><span class="op" id="2707689">.</span><span class="ident" id="2707690">gc</span><span class="op" id="2707692">,</span>&nbsp;<span class="num" id="2707694">0x44</span><span class="op" id="2707698">)</span>&nbsp;<span class="comment" id="2707700">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707715">}</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707718">gc</span><span class="op" id="2707720">.</span><span class="ident" id="2707721">gc</span><span class="op" id="2707723">[</span><span class="ident" id="2707724">nptr</span><span class="op" id="2707728">/</span><span class="num" id="2707729">2</span><span class="op" id="2707730">]</span>&nbsp;<span class="op" id="2707732">&amp;=</span>&nbsp;<span class="op" id="2707735">^</span><span class="op" id="2707736">(</span><span class="num" id="2707737">3</span>&nbsp;<span class="op" id="2707739">&lt;&lt;</span>&nbsp;<span class="op" id="2707742">(</span><span class="op" id="2707743">(</span><span class="ident" id="2707744">nptr</span><span class="op" id="2707748">%</span><span class="num" id="2707749">2</span><span class="op" id="2707750">)</span><span class="op" id="2707751">*</span><span class="num" id="2707752">4</span>&nbsp;<span class="op" id="2707754">+</span>&nbsp;<span class="num" id="2707756">2</span><span class="op" id="2707757">)</span><span class="op" id="2707758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707761">gc</span><span class="op" id="2707763">.</span><span class="ident" id="2707764">gc</span><span class="op" id="2707766">[</span><span class="ident" id="2707767">nptr</span><span class="op" id="2707771">/</span><span class="num" id="2707772">2</span><span class="op" id="2707773">]</span>&nbsp;<span class="op" id="2707775">|=</span>&nbsp;<span class="ident" id="2707778">v</span>&nbsp;<span class="op" id="2707780">&lt;&lt;</span>&nbsp;<span class="op" id="2707783">(</span><span class="op" id="2707784">(</span><span class="ident" id="2707785">nptr</span><span class="op" id="2707789">%</span><span class="num" id="2707790">2</span><span class="op" id="2707791">)</span><span class="op" id="2707792">*</span><span class="num" id="2707793">4</span>&nbsp;<span class="op" id="2707795">+</span>&nbsp;<span class="num" id="2707797">2</span><span class="op" id="2707798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707801">gc</span><span class="op" id="2707803">.</span><span class="ident" id="2707804">size</span>&nbsp;<span class="op" id="2707809">+=</span>&nbsp;<span class="ident" id="2707812">ptrsize</span><br>
<span class="lineno"></span><span class="op" id="2707820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="keyword" id="2707823">func</span>&nbsp;<span class="op" id="2707828">(</span><span class="ident" id="2707829">gc</span>&nbsp;<span class="op" id="2707832">*</span><span class="ident" id="2707833">gcProg</span><span class="op" id="2707839">)</span>&nbsp;<span class="ident" id="2707841">finalize</span><span class="op" id="2707849">(</span><span class="op" id="2707850">)</span>&nbsp;<span class="ident" id="2707852">unsafe</span><span class="op" id="2707858">.</span><span class="ident" id="2707859">Pointer</span>&nbsp;<span class="op" id="2707867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707870">if</span>&nbsp;<span class="ident" id="2707873">gc</span><span class="op" id="2707875">.</span><span class="ident" id="2707876">size</span>&nbsp;<span class="op" id="2707881">==</span>&nbsp;<span class="num" id="2707884">0</span>&nbsp;<span class="op" id="2707886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707890">return</span>&nbsp;<span class="ident" id="2707897">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2707902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707905">ptrsize</span>&nbsp;<span class="op" id="2707913">:=</span>&nbsp;<span class="ident" id="2707916">unsafe</span><span class="op" id="2707922">.</span><span class="ident" id="2707923">Sizeof</span><span class="op" id="2707929">(</span><span class="builtintype" id="2707930">uintptr</span><span class="op" id="2707937">(</span><span class="num" id="2707938">0</span><span class="op" id="2707939">)</span><span class="op" id="2707940">)</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707943">gc</span><span class="op" id="2707945">.</span><span class="ident" id="2707946">align</span><span class="op" id="2707951">(</span><span class="ident" id="2707952">ptrsize</span><span class="op" id="2707959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2707962">nptr</span>&nbsp;<span class="op" id="2707967">:=</span>&nbsp;<span class="ident" id="2707970">gc</span><span class="op" id="2707972">.</span><span class="ident" id="2707973">size</span>&nbsp;<span class="op" id="2707978">/</span>&nbsp;<span class="ident" id="2707980">ptrsize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2707989">for</span>&nbsp;<span class="builtintype" id="2707993">uintptr</span><span class="op" id="2708000">(</span><span class="builtinfunc" id="2708001">len</span><span class="op" id="2708004">(</span><span class="ident" id="2708005">gc</span><span class="op" id="2708007">.</span><span class="ident" id="2708008">gc</span><span class="op" id="2708010">)</span><span class="op" id="2708011">)</span>&nbsp;<span class="op" id="2708013">&lt;</span>&nbsp;<span class="ident" id="2708015">nptr</span><span class="op" id="2708019">/</span><span class="num" id="2708020">2</span><span class="op" id="2708021">+</span><span class="num" id="2708022">1</span>&nbsp;<span class="op" id="2708024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708028">gc</span><span class="op" id="2708030">.</span><span class="ident" id="2708031">gc</span>&nbsp;<span class="op" id="2708034">=</span>&nbsp;<span class="builtinfunc" id="2708036">append</span><span class="op" id="2708042">(</span><span class="ident" id="2708043">gc</span><span class="op" id="2708045">.</span><span class="ident" id="2708046">gc</span><span class="op" id="2708048">,</span>&nbsp;<span class="num" id="2708050">0x44</span><span class="op" id="2708054">)</span>&nbsp;<span class="comment" id="2708056">//&nbsp;BitsScalar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2708071">}</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2708074">//&nbsp;If&nbsp;number&nbsp;of&nbsp;words&nbsp;is&nbsp;odd,&nbsp;repeat&nbsp;the&nbsp;mask&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2708128">//&nbsp;Compiler&nbsp;does&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708156">if</span>&nbsp;<span class="ident" id="2708159">nptr</span><span class="op" id="2708163">%</span><span class="num" id="2708164">2</span>&nbsp;<span class="op" id="2708166">!=</span>&nbsp;<span class="num" id="2708169">0</span>&nbsp;<span class="op" id="2708171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708175">for</span>&nbsp;<span class="ident" id="2708179">i</span>&nbsp;<span class="op" id="2708181">:=</span>&nbsp;<span class="builtintype" id="2708184">uintptr</span><span class="op" id="2708191">(</span><span class="num" id="2708192">0</span><span class="op" id="2708193">)</span><span class="op" id="2708194">;</span>&nbsp;<span class="ident" id="2708196">i</span>&nbsp;<span class="op" id="2708198">&lt;</span>&nbsp;<span class="ident" id="2708200">nptr</span><span class="op" id="2708204">;</span>&nbsp;<span class="ident" id="2708206">i</span><span class="op" id="2708207">++</span>&nbsp;<span class="op" id="2708210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708215">gc</span><span class="op" id="2708217">.</span><span class="ident" id="2708218">appendWord</span><span class="op" id="2708228">(</span><span class="ident" id="2708229">extractGCWord</span><span class="op" id="2708242">(</span><span class="ident" id="2708243">gc</span><span class="op" id="2708245">.</span><span class="ident" id="2708246">gc</span><span class="op" id="2708248">,</span>&nbsp;<span class="ident" id="2708250">i</span><span class="op" id="2708251">)</span><span class="op" id="2708252">)</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2708256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2708259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708262">return</span>&nbsp;<span class="ident" id="2708269">unsafe</span><span class="op" id="2708275">.</span><span class="ident" id="2708276">Pointer</span><span class="op" id="2708283">(</span><span class="op" id="2708284">&amp;</span><span class="ident" id="2708285">gc</span><span class="op" id="2708287">.</span><span class="ident" id="2708288">gc</span><span class="op" id="2708290">[</span><span class="num" id="2708291">0</span><span class="op" id="2708292">]</span><span class="op" id="2708293">)</span><br>
<span class="lineno"></span><span class="op" id="2708295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span><span class="keyword" id="2708298">func</span>&nbsp;<span class="ident" id="2708303">extractGCWord</span><span class="op" id="2708316">(</span><span class="ident" id="2708317">gc</span>&nbsp;<span class="op" id="2708320">[</span><span class="op" id="2708321">]</span><span class="builtintype" id="2708322">byte</span><span class="op" id="2708326">,</span>&nbsp;<span class="ident" id="2708328">i</span>&nbsp;<span class="builtintype" id="2708330">uintptr</span><span class="op" id="2708337">)</span>&nbsp;<span class="builtintype" id="2708339">byte</span>&nbsp;<span class="op" id="2708344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708347">return</span>&nbsp;<span class="op" id="2708354">(</span><span class="ident" id="2708355">gc</span><span class="op" id="2708357">[</span><span class="ident" id="2708358">i</span><span class="op" id="2708359">/</span><span class="num" id="2708360">2</span><span class="op" id="2708361">]</span>&nbsp;<span class="op" id="2708363">&gt;&gt;</span>&nbsp;<span class="op" id="2708366">(</span><span class="op" id="2708367">(</span><span class="ident" id="2708368">i</span><span class="op" id="2708369">%</span><span class="num" id="2708370">2</span><span class="op" id="2708371">)</span><span class="op" id="2708372">*</span><span class="num" id="2708373">4</span>&nbsp;<span class="op" id="2708375">+</span>&nbsp;<span class="num" id="2708377">2</span><span class="op" id="2708378">)</span><span class="op" id="2708379">)</span>&nbsp;<span class="op" id="2708381">&amp;</span>&nbsp;<span class="num" id="2708383">3</span><br>
<span class="lineno"></span><span class="op" id="2708385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2708388">func</span>&nbsp;<span class="op" id="2708393">(</span><span class="ident" id="2708394">gc</span>&nbsp;<span class="op" id="2708397">*</span><span class="ident" id="2708398">gcProg</span><span class="op" id="2708404">)</span>&nbsp;<span class="ident" id="2708406">align</span><span class="op" id="2708411">(</span><span class="ident" id="2708412">a</span>&nbsp;<span class="builtintype" id="2708414">uintptr</span><span class="op" id="2708421">)</span>&nbsp;<span class="op" id="2708423">{</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708426">gc</span><span class="op" id="2708428">.</span><span class="ident" id="2708429">size</span>&nbsp;<span class="op" id="2708434">=</span>&nbsp;<span class="ident" id="2708436">align</span><span class="op" id="2708441">(</span><span class="ident" id="2708442">gc</span><span class="op" id="2708444">.</span><span class="ident" id="2708445">size</span><span class="op" id="2708449">,</span>&nbsp;<span class="ident" id="2708451">a</span><span class="op" id="2708452">)</span><br>
<span class="lineno"></span><span class="op" id="2708454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2708457">//&nbsp;These&nbsp;constants&nbsp;must&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../runtime/mgc0.h.</span><br>
<span class="lineno"></span><span class="keyword" id="2708518">const</span>&nbsp;<span class="op" id="2708524">(</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708527">bitsScalar</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2708541">=</span>&nbsp;<span class="num" id="2708543">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708546">bitsPointer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2708560">=</span>&nbsp;<span class="num" id="2708562">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708565">bitsMultiWord</span>&nbsp;<span class="op" id="2708579">=</span>&nbsp;<span class="num" id="2708581">3</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708585">bitsIface</span>&nbsp;<span class="op" id="2708595">=</span>&nbsp;<span class="num" id="2708597">2</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708600">bitsEface</span>&nbsp;<span class="op" id="2708610">=</span>&nbsp;<span class="num" id="2708612">3</span><br>
<span class="lineno"></span><span class="op" id="2708614">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2708617">//&nbsp;Make&nbsp;sure&nbsp;these&nbsp;routines&nbsp;stay&nbsp;in&nbsp;sync&nbsp;with&nbsp;../../runtime/hashmap.go!</span><br>
<span class="lineno"></span><span class="comment" id="2708689">//&nbsp;These&nbsp;types&nbsp;exist&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno">1605</span><span class="comment" id="2708761">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="2708836">//&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2708867">const</span>&nbsp;<span class="op" id="2708873">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708876">bucketSize</span>&nbsp;<span class="op" id="2708887">=</span>&nbsp;<span class="num" id="2708889">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708892">maxKeySize</span>&nbsp;<span class="op" id="2708903">=</span>&nbsp;<span class="num" id="2708905">128</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2708910">maxValSize</span>&nbsp;<span class="op" id="2708921">=</span>&nbsp;<span class="num" id="2708923">128</span><br>
<span class="lineno"></span><span class="op" id="2708927">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2708930">func</span>&nbsp;<span class="ident" id="2708935">bucketOf</span><span class="op" id="2708943">(</span><span class="ident" id="2708944">ktyp</span><span class="op" id="2708948">,</span>&nbsp;<span class="ident" id="2708950">etyp</span>&nbsp;<span class="op" id="2708955">*</span><span class="ident" id="2708956">rtype</span><span class="op" id="2708961">)</span>&nbsp;<span class="op" id="2708963">*</span><span class="ident" id="2708964">rtype</span>&nbsp;<span class="op" id="2708970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2708973">if</span>&nbsp;<span class="ident" id="2708976">ktyp</span><span class="op" id="2708980">.</span><span class="ident" id="2708981">size</span>&nbsp;<span class="op" id="2708986">&gt;</span>&nbsp;<span class="ident" id="2708988">maxKeySize</span>&nbsp;<span class="op" id="2708999">{</span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709003">ktyp</span>&nbsp;<span class="op" id="2709008">=</span>&nbsp;<span class="ident" id="2709010">PtrTo</span><span class="op" id="2709015">(</span><span class="ident" id="2709016">ktyp</span><span class="op" id="2709020">)</span><span class="op" id="2709021">.</span><span class="op" id="2709022">(</span><span class="op" id="2709023">*</span><span class="ident" id="2709024">rtype</span><span class="op" id="2709029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709035">if</span>&nbsp;<span class="ident" id="2709038">etyp</span><span class="op" id="2709042">.</span><span class="ident" id="2709043">size</span>&nbsp;<span class="op" id="2709048">&gt;</span>&nbsp;<span class="ident" id="2709050">maxValSize</span>&nbsp;<span class="op" id="2709061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709065">etyp</span>&nbsp;<span class="op" id="2709070">=</span>&nbsp;<span class="ident" id="2709072">PtrTo</span><span class="op" id="2709077">(</span><span class="ident" id="2709078">etyp</span><span class="op" id="2709082">)</span><span class="op" id="2709083">.</span><span class="op" id="2709084">(</span><span class="op" id="2709085">*</span><span class="ident" id="2709086">rtype</span><span class="op" id="2709091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709094">}</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709097">ptrsize</span>&nbsp;<span class="op" id="2709105">:=</span>&nbsp;<span class="ident" id="2709108">unsafe</span><span class="op" id="2709114">.</span><span class="ident" id="2709115">Sizeof</span><span class="op" id="2709121">(</span><span class="builtintype" id="2709122">uintptr</span><span class="op" id="2709129">(</span><span class="num" id="2709130">0</span><span class="op" id="2709131">)</span><span class="op" id="2709132">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709136">var</span>&nbsp;<span class="ident" id="2709140">gc</span>&nbsp;<span class="ident" id="2709143">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2709151">//&nbsp;topbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709163">for</span>&nbsp;<span class="ident" id="2709167">i</span>&nbsp;<span class="op" id="2709169">:=</span>&nbsp;<span class="num" id="2709172">0</span><span class="op" id="2709173">;</span>&nbsp;<span class="ident" id="2709175">i</span>&nbsp;<span class="op" id="2709177">&lt;</span>&nbsp;<span class="builtintype" id="2709179">int</span><span class="op" id="2709182">(</span><span class="ident" id="2709183">bucketSize</span><span class="op" id="2709193">*</span><span class="ident" id="2709194">unsafe</span><span class="op" id="2709200">.</span><span class="ident" id="2709201">Sizeof</span><span class="op" id="2709207">(</span><span class="builtintype" id="2709208">uint8</span><span class="op" id="2709213">(</span><span class="num" id="2709214">0</span><span class="op" id="2709215">)</span><span class="op" id="2709216">)</span><span class="op" id="2709217">/</span><span class="ident" id="2709218">ptrsize</span><span class="op" id="2709225">)</span><span class="op" id="2709226">;</span>&nbsp;<span class="ident" id="2709228">i</span><span class="op" id="2709229">++</span>&nbsp;<span class="op" id="2709232">{</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709236">gc</span><span class="op" id="2709238">.</span><span class="builtinfunc" id="2709239">append</span><span class="op" id="2709245">(</span><span class="ident" id="2709246">bitsScalar</span><span class="op" id="2709256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709262">gc</span><span class="op" id="2709264">.</span><span class="builtinfunc" id="2709265">append</span><span class="op" id="2709271">(</span><span class="ident" id="2709272">bitsPointer</span><span class="op" id="2709283">)</span>&nbsp;<span class="comment" id="2709285">//&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709298">if</span>&nbsp;<span class="ident" id="2709301">runtime</span><span class="op" id="2709308">.</span><span class="ident" id="2709309">GOARCH</span>&nbsp;<span class="op" id="2709316">==</span>&nbsp;<span class="string" id="2709319">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2709330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709334">gc</span><span class="op" id="2709336">.</span><span class="builtinfunc" id="2709337">append</span><span class="op" id="2709343">(</span><span class="ident" id="2709344">bitsScalar</span><span class="op" id="2709354">)</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2709360">//&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709369">for</span>&nbsp;<span class="ident" id="2709373">i</span>&nbsp;<span class="op" id="2709375">:=</span>&nbsp;<span class="num" id="2709378">0</span><span class="op" id="2709379">;</span>&nbsp;<span class="ident" id="2709381">i</span>&nbsp;<span class="op" id="2709383">&lt;</span>&nbsp;<span class="ident" id="2709385">bucketSize</span><span class="op" id="2709395">;</span>&nbsp;<span class="ident" id="2709397">i</span><span class="op" id="2709398">++</span>&nbsp;<span class="op" id="2709401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709405">gc</span><span class="op" id="2709407">.</span><span class="ident" id="2709408">appendProg</span><span class="op" id="2709418">(</span><span class="ident" id="2709419">ktyp</span><span class="op" id="2709423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709426">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2709429">//&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709440">for</span>&nbsp;<span class="ident" id="2709444">i</span>&nbsp;<span class="op" id="2709446">:=</span>&nbsp;<span class="num" id="2709449">0</span><span class="op" id="2709450">;</span>&nbsp;<span class="ident" id="2709452">i</span>&nbsp;<span class="op" id="2709454">&lt;</span>&nbsp;<span class="ident" id="2709456">bucketSize</span><span class="op" id="2709466">;</span>&nbsp;<span class="ident" id="2709468">i</span><span class="op" id="2709469">++</span>&nbsp;<span class="op" id="2709472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709476">gc</span><span class="op" id="2709478">.</span><span class="ident" id="2709479">appendProg</span><span class="op" id="2709489">(</span><span class="ident" id="2709490">etyp</span><span class="op" id="2709494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709501">b</span>&nbsp;<span class="op" id="2709503">:=</span>&nbsp;<span class="builtinfunc" id="2709506">new</span><span class="op" id="2709509">(</span><span class="ident" id="2709510">rtype</span><span class="op" id="2709515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709518">b</span><span class="op" id="2709519">.</span><span class="ident" id="2709520">size</span>&nbsp;<span class="op" id="2709525">=</span>&nbsp;<span class="ident" id="2709527">gc</span><span class="op" id="2709529">.</span><span class="ident" id="2709530">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709536">b</span><span class="op" id="2709537">.</span><span class="ident" id="2709538">gc</span><span class="op" id="2709540">[</span><span class="num" id="2709541">0</span><span class="op" id="2709542">]</span>&nbsp;<span class="op" id="2709544">=</span>&nbsp;<span class="ident" id="2709546">gc</span><span class="op" id="2709548">.</span><span class="ident" id="2709549">finalize</span><span class="op" id="2709557">(</span><span class="op" id="2709558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709561">s</span>&nbsp;<span class="op" id="2709563">:=</span>&nbsp;<span class="string" id="2709566">&#34;bucket(&#34;</span>&nbsp;<span class="op" id="2709576">+</span>&nbsp;<span class="op" id="2709578">*</span><span class="ident" id="2709579">ktyp</span><span class="op" id="2709583">.</span><span class="builtintype" id="2709584">string</span>&nbsp;<span class="op" id="2709591">+</span>&nbsp;<span class="string" id="2709593">&#34;,&#34;</span>&nbsp;<span class="op" id="2709597">+</span>&nbsp;<span class="op" id="2709599">*</span><span class="ident" id="2709600">etyp</span><span class="op" id="2709604">.</span><span class="builtintype" id="2709605">string</span>&nbsp;<span class="op" id="2709612">+</span>&nbsp;<span class="string" id="2709614">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709619">b</span><span class="op" id="2709620">.</span><span class="builtintype" id="2709621">string</span>&nbsp;<span class="op" id="2709628">=</span>&nbsp;<span class="op" id="2709630">&amp;</span><span class="ident" id="2709631">s</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709634">return</span>&nbsp;<span class="ident" id="2709641">b</span><br>
<span class="lineno"></span><span class="op" id="2709643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2709646">//&nbsp;SliceOf&nbsp;returns&nbsp;the&nbsp;slice&nbsp;type&nbsp;with&nbsp;element&nbsp;type&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2709701">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;SliceOf(t)&nbsp;represents&nbsp;[]int.</span><br>
<span class="lineno">1650</span><span class="keyword" id="2709767">func</span>&nbsp;<span class="ident" id="2709772">SliceOf</span><span class="op" id="2709779">(</span><span class="ident" id="2709780">t</span>&nbsp;<span class="ident" id="2709782">Type</span><span class="op" id="2709786">)</span>&nbsp;<span class="ident" id="2709788">Type</span>&nbsp;<span class="op" id="2709793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709796">typ</span>&nbsp;<span class="op" id="2709800">:=</span>&nbsp;<span class="ident" id="2709803">t</span><span class="op" id="2709804">.</span><span class="op" id="2709805">(</span><span class="op" id="2709806">*</span><span class="ident" id="2709807">rtype</span><span class="op" id="2709812">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2709816">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709835">ckey</span>&nbsp;<span class="op" id="2709840">:=</span>&nbsp;<span class="ident" id="2709843">cacheKey</span><span class="op" id="2709851">{</span><span class="ident" id="2709852">Slice</span><span class="op" id="2709857">,</span>&nbsp;<span class="ident" id="2709859">typ</span><span class="op" id="2709862">,</span>&nbsp;<span class="ident" id="2709864">nil</span><span class="op" id="2709867">,</span>&nbsp;<span class="num" id="2709869">0</span><span class="op" id="2709870">}</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709873">if</span>&nbsp;<span class="ident" id="2709876">slice</span>&nbsp;<span class="op" id="2709882">:=</span>&nbsp;<span class="ident" id="2709885">cacheGet</span><span class="op" id="2709893">(</span><span class="ident" id="2709894">ckey</span><span class="op" id="2709898">)</span><span class="op" id="2709899">;</span>&nbsp;<span class="ident" id="2709901">slice</span>&nbsp;<span class="op" id="2709907">!=</span>&nbsp;<span class="ident" id="2709910">nil</span>&nbsp;<span class="op" id="2709914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709918">return</span>&nbsp;<span class="ident" id="2709925">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2709932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2709936">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2709961">s</span>&nbsp;<span class="op" id="2709963">:=</span>&nbsp;<span class="string" id="2709966">&#34;[]&#34;</span>&nbsp;<span class="op" id="2709971">+</span>&nbsp;<span class="op" id="2709973">*</span><span class="ident" id="2709974">typ</span><span class="op" id="2709977">.</span><span class="builtintype" id="2709978">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2709986">for</span>&nbsp;<span class="ident" id="2709990">_</span><span class="op" id="2709991">,</span>&nbsp;<span class="ident" id="2709993">tt</span>&nbsp;<span class="op" id="2709996">:=</span>&nbsp;<span class="keyword" id="2709999">range</span>&nbsp;<span class="ident" id="2710005">typesByString</span><span class="op" id="2710018">(</span><span class="ident" id="2710019">s</span><span class="op" id="2710020">)</span>&nbsp;<span class="op" id="2710022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710026">slice</span>&nbsp;<span class="op" id="2710032">:=</span>&nbsp;<span class="op" id="2710035">(</span><span class="op" id="2710036">*</span><span class="ident" id="2710037">sliceType</span><span class="op" id="2710046">)</span><span class="op" id="2710047">(</span><span class="ident" id="2710048">unsafe</span><span class="op" id="2710054">.</span><span class="ident" id="2710055">Pointer</span><span class="op" id="2710062">(</span><span class="ident" id="2710063">tt</span><span class="op" id="2710065">)</span><span class="op" id="2710066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710070">if</span>&nbsp;<span class="ident" id="2710073">slice</span><span class="op" id="2710078">.</span><span class="ident" id="2710079">elem</span>&nbsp;<span class="op" id="2710084">==</span>&nbsp;<span class="ident" id="2710087">typ</span>&nbsp;<span class="op" id="2710091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710096">return</span>&nbsp;<span class="ident" id="2710103">cachePut</span><span class="op" id="2710111">(</span><span class="ident" id="2710112">ckey</span><span class="op" id="2710116">,</span>&nbsp;<span class="ident" id="2710118">tt</span><span class="op" id="2710120">)</span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2710124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2710127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2710131">//&nbsp;Make&nbsp;a&nbsp;slice&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710154">var</span>&nbsp;<span class="ident" id="2710158">islice</span>&nbsp;<span class="keyword" id="2710165">interface</span><span class="op" id="2710174">{</span><span class="op" id="2710175">}</span>&nbsp;<span class="op" id="2710177">=</span>&nbsp;<span class="op" id="2710179">(</span><span class="op" id="2710180">[</span><span class="op" id="2710181">]</span><span class="ident" id="2710182">unsafe</span><span class="op" id="2710188">.</span><span class="ident" id="2710189">Pointer</span><span class="op" id="2710196">)</span><span class="op" id="2710197">(</span><span class="ident" id="2710198">nil</span><span class="op" id="2710201">)</span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710204">prototype</span>&nbsp;<span class="op" id="2710214">:=</span>&nbsp;<span class="op" id="2710217">*</span><span class="op" id="2710218">(</span><span class="op" id="2710219">*</span><span class="op" id="2710220">*</span><span class="ident" id="2710221">sliceType</span><span class="op" id="2710230">)</span><span class="op" id="2710231">(</span><span class="ident" id="2710232">unsafe</span><span class="op" id="2710238">.</span><span class="ident" id="2710239">Pointer</span><span class="op" id="2710246">(</span><span class="op" id="2710247">&amp;</span><span class="ident" id="2710248">islice</span><span class="op" id="2710254">)</span><span class="op" id="2710255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710258">slice</span>&nbsp;<span class="op" id="2710264">:=</span>&nbsp;<span class="builtinfunc" id="2710267">new</span><span class="op" id="2710270">(</span><span class="ident" id="2710271">sliceType</span><span class="op" id="2710280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2710283">*</span><span class="ident" id="2710284">slice</span>&nbsp;<span class="op" id="2710290">=</span>&nbsp;<span class="op" id="2710292">*</span><span class="ident" id="2710293">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710304">slice</span><span class="op" id="2710309">.</span><span class="builtintype" id="2710310">string</span>&nbsp;<span class="op" id="2710317">=</span>&nbsp;<span class="op" id="2710319">&amp;</span><span class="ident" id="2710320">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710323">slice</span><span class="op" id="2710328">.</span><span class="ident" id="2710329">hash</span>&nbsp;<span class="op" id="2710334">=</span>&nbsp;<span class="ident" id="2710336">fnv1</span><span class="op" id="2710340">(</span><span class="ident" id="2710341">typ</span><span class="op" id="2710344">.</span><span class="ident" id="2710345">hash</span><span class="op" id="2710349">,</span>&nbsp;<span class="string" id="2710351">&#39;[&#39;</span><span class="op" id="2710354">)</span><br>
<span class="lineno">1675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710357">slice</span><span class="op" id="2710362">.</span><span class="ident" id="2710363">elem</span>&nbsp;<span class="op" id="2710368">=</span>&nbsp;<span class="ident" id="2710370">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710375">slice</span><span class="op" id="2710380">.</span><span class="ident" id="2710381">uncommonType</span>&nbsp;<span class="op" id="2710394">=</span>&nbsp;<span class="ident" id="2710396">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710401">slice</span><span class="op" id="2710406">.</span><span class="ident" id="2710407">ptrToThis</span>&nbsp;<span class="op" id="2710417">=</span>&nbsp;<span class="ident" id="2710419">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710424">slice</span><span class="op" id="2710429">.</span><span class="ident" id="2710430">zero</span>&nbsp;<span class="op" id="2710435">=</span>&nbsp;<span class="ident" id="2710437">unsafe</span><span class="op" id="2710443">.</span><span class="ident" id="2710444">Pointer</span><span class="op" id="2710451">(</span><span class="op" id="2710452">&amp;</span><span class="builtinfunc" id="2710453">make</span><span class="op" id="2710457">(</span><span class="op" id="2710458">[</span><span class="op" id="2710459">]</span><span class="builtintype" id="2710460">byte</span><span class="op" id="2710464">,</span>&nbsp;<span class="ident" id="2710466">slice</span><span class="op" id="2710471">.</span><span class="ident" id="2710472">size</span><span class="op" id="2710476">)</span><span class="op" id="2710477">[</span><span class="num" id="2710478">0</span><span class="op" id="2710479">]</span><span class="op" id="2710480">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2710484">return</span>&nbsp;<span class="ident" id="2710491">cachePut</span><span class="op" id="2710499">(</span><span class="ident" id="2710500">ckey</span><span class="op" id="2710504">,</span>&nbsp;<span class="op" id="2710506">&amp;</span><span class="ident" id="2710507">slice</span><span class="op" id="2710512">.</span><span class="ident" id="2710513">rtype</span><span class="op" id="2710518">)</span><br>
<span class="lineno"></span><span class="op" id="2710520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2710523">//&nbsp;ArrayOf&nbsp;returns&nbsp;the&nbsp;array&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;count&nbsp;and&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="2710596">//&nbsp;For&nbsp;example,&nbsp;if&nbsp;t&nbsp;represents&nbsp;int,&nbsp;ArrayOf(5,&nbsp;t)&nbsp;represents&nbsp;[5]int.</span><br>
<span class="lineno">1685</span><span class="comment" id="2710666">//</span><br>
<span class="lineno"></span><span class="comment" id="2710669">//&nbsp;If&nbsp;the&nbsp;resulting&nbsp;type&nbsp;would&nbsp;be&nbsp;larger&nbsp;than&nbsp;the&nbsp;available&nbsp;address&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="2710744">//&nbsp;ArrayOf&nbsp;panics.</span><br>
<span class="lineno"></span><span class="comment" id="2710763">//</span><br>
<span class="lineno"></span><span class="comment" id="2710766">//&nbsp;TODO(rsc):&nbsp;Unexported&nbsp;for&nbsp;now.&nbsp;Export&nbsp;once&nbsp;the&nbsp;alg&nbsp;field&nbsp;is&nbsp;set&nbsp;correctly</span><br>
<span class="lineno">1690</span><span class="comment" id="2710843">//&nbsp;for&nbsp;the&nbsp;type.&nbsp;This&nbsp;may&nbsp;require&nbsp;significant&nbsp;work.</span><br>
<span class="lineno"></span><span class="comment" id="2710895">//</span><br>
<span class="lineno"></span><span class="comment" id="2710898">//&nbsp;TODO(rsc):&nbsp;TestArrayOf&nbsp;is&nbsp;also&nbsp;disabled.&nbsp;Re-enable.</span><br>
<span class="lineno"></span><span class="keyword" id="2710953">func</span>&nbsp;<span class="ident" id="2710958">arrayOf</span><span class="op" id="2710965">(</span><span class="ident" id="2710966">count</span>&nbsp;<span class="builtintype" id="2710972">int</span><span class="op" id="2710975">,</span>&nbsp;<span class="ident" id="2710977">elem</span>&nbsp;<span class="ident" id="2710982">Type</span><span class="op" id="2710986">)</span>&nbsp;<span class="ident" id="2710988">Type</span>&nbsp;<span class="op" id="2710993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2710996">typ</span>&nbsp;<span class="op" id="2711000">:=</span>&nbsp;<span class="ident" id="2711003">elem</span><span class="op" id="2711007">.</span><span class="op" id="2711008">(</span><span class="op" id="2711009">*</span><span class="ident" id="2711010">rtype</span><span class="op" id="2711015">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711018">slice</span>&nbsp;<span class="op" id="2711024">:=</span>&nbsp;<span class="ident" id="2711027">SliceOf</span><span class="op" id="2711034">(</span><span class="ident" id="2711035">elem</span><span class="op" id="2711039">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2711043">//&nbsp;Look&nbsp;in&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711062">ckey</span>&nbsp;<span class="op" id="2711067">:=</span>&nbsp;<span class="ident" id="2711070">cacheKey</span><span class="op" id="2711078">{</span><span class="ident" id="2711079">Array</span><span class="op" id="2711084">,</span>&nbsp;<span class="ident" id="2711086">typ</span><span class="op" id="2711089">,</span>&nbsp;<span class="ident" id="2711091">nil</span><span class="op" id="2711094">,</span>&nbsp;<span class="builtintype" id="2711096">uintptr</span><span class="op" id="2711103">(</span><span class="ident" id="2711104">count</span><span class="op" id="2711109">)</span><span class="op" id="2711110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711113">if</span>&nbsp;<span class="ident" id="2711116">slice</span>&nbsp;<span class="op" id="2711122">:=</span>&nbsp;<span class="ident" id="2711125">cacheGet</span><span class="op" id="2711133">(</span><span class="ident" id="2711134">ckey</span><span class="op" id="2711138">)</span><span class="op" id="2711139">;</span>&nbsp;<span class="ident" id="2711141">slice</span>&nbsp;<span class="op" id="2711147">!=</span>&nbsp;<span class="ident" id="2711150">nil</span>&nbsp;<span class="op" id="2711154">{</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711158">return</span>&nbsp;<span class="ident" id="2711165">slice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2711176">//&nbsp;Look&nbsp;in&nbsp;known&nbsp;types.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711201">s</span>&nbsp;<span class="op" id="2711203">:=</span>&nbsp;<span class="string" id="2711206">&#34;[&#34;</span>&nbsp;<span class="op" id="2711210">+</span>&nbsp;<span class="ident" id="2711212">strconv</span><span class="op" id="2711219">.</span><span class="ident" id="2711220">Itoa</span><span class="op" id="2711224">(</span><span class="ident" id="2711225">count</span><span class="op" id="2711230">)</span>&nbsp;<span class="op" id="2711232">+</span>&nbsp;<span class="string" id="2711234">&#34;]&#34;</span>&nbsp;<span class="op" id="2711238">+</span>&nbsp;<span class="op" id="2711240">*</span><span class="ident" id="2711241">typ</span><span class="op" id="2711244">.</span><span class="builtintype" id="2711245">string</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711253">for</span>&nbsp;<span class="ident" id="2711257">_</span><span class="op" id="2711258">,</span>&nbsp;<span class="ident" id="2711260">tt</span>&nbsp;<span class="op" id="2711263">:=</span>&nbsp;<span class="keyword" id="2711266">range</span>&nbsp;<span class="ident" id="2711272">typesByString</span><span class="op" id="2711285">(</span><span class="ident" id="2711286">s</span><span class="op" id="2711287">)</span>&nbsp;<span class="op" id="2711289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711293">slice</span>&nbsp;<span class="op" id="2711299">:=</span>&nbsp;<span class="op" id="2711302">(</span><span class="op" id="2711303">*</span><span class="ident" id="2711304">sliceType</span><span class="op" id="2711313">)</span><span class="op" id="2711314">(</span><span class="ident" id="2711315">unsafe</span><span class="op" id="2711321">.</span><span class="ident" id="2711322">Pointer</span><span class="op" id="2711329">(</span><span class="ident" id="2711330">tt</span><span class="op" id="2711332">)</span><span class="op" id="2711333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711337">if</span>&nbsp;<span class="ident" id="2711340">slice</span><span class="op" id="2711345">.</span><span class="ident" id="2711346">elem</span>&nbsp;<span class="op" id="2711351">==</span>&nbsp;<span class="ident" id="2711354">typ</span>&nbsp;<span class="op" id="2711358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711363">return</span>&nbsp;<span class="ident" id="2711370">cachePut</span><span class="op" id="2711378">(</span><span class="ident" id="2711379">ckey</span><span class="op" id="2711383">,</span>&nbsp;<span class="ident" id="2711385">tt</span><span class="op" id="2711387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711391">}</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2711398">//&nbsp;Make&nbsp;an&nbsp;array&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711422">var</span>&nbsp;<span class="ident" id="2711426">iarray</span>&nbsp;<span class="keyword" id="2711433">interface</span><span class="op" id="2711442">{</span><span class="op" id="2711443">}</span>&nbsp;<span class="op" id="2711445">=</span>&nbsp;<span class="op" id="2711447">[</span><span class="num" id="2711448">1</span><span class="op" id="2711449">]</span><span class="ident" id="2711450">unsafe</span><span class="op" id="2711456">.</span><span class="ident" id="2711457">Pointer</span><span class="op" id="2711464">{</span><span class="op" id="2711465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711468">prototype</span>&nbsp;<span class="op" id="2711478">:=</span>&nbsp;<span class="op" id="2711481">*</span><span class="op" id="2711482">(</span><span class="op" id="2711483">*</span><span class="op" id="2711484">*</span><span class="ident" id="2711485">arrayType</span><span class="op" id="2711494">)</span><span class="op" id="2711495">(</span><span class="ident" id="2711496">unsafe</span><span class="op" id="2711502">.</span><span class="ident" id="2711503">Pointer</span><span class="op" id="2711510">(</span><span class="op" id="2711511">&amp;</span><span class="ident" id="2711512">iarray</span><span class="op" id="2711518">)</span><span class="op" id="2711519">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711522">array</span>&nbsp;<span class="op" id="2711528">:=</span>&nbsp;<span class="builtinfunc" id="2711531">new</span><span class="op" id="2711534">(</span><span class="ident" id="2711535">arrayType</span><span class="op" id="2711544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711547">*</span><span class="ident" id="2711548">array</span>&nbsp;<span class="op" id="2711554">=</span>&nbsp;<span class="op" id="2711556">*</span><span class="ident" id="2711557">prototype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2711568">//&nbsp;TODO:&nbsp;Set&nbsp;extra&nbsp;kind&nbsp;bits&nbsp;correctly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711609">array</span><span class="op" id="2711614">.</span><span class="builtintype" id="2711615">string</span>&nbsp;<span class="op" id="2711622">=</span>&nbsp;<span class="op" id="2711624">&amp;</span><span class="ident" id="2711625">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711628">array</span><span class="op" id="2711633">.</span><span class="ident" id="2711634">hash</span>&nbsp;<span class="op" id="2711639">=</span>&nbsp;<span class="ident" id="2711641">fnv1</span><span class="op" id="2711645">(</span><span class="ident" id="2711646">typ</span><span class="op" id="2711649">.</span><span class="ident" id="2711650">hash</span><span class="op" id="2711654">,</span>&nbsp;<span class="string" id="2711656">&#39;[&#39;</span><span class="op" id="2711659">)</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711662">for</span>&nbsp;<span class="ident" id="2711666">n</span>&nbsp;<span class="op" id="2711668">:=</span>&nbsp;<span class="builtintype" id="2711671">uint32</span><span class="op" id="2711677">(</span><span class="ident" id="2711678">count</span><span class="op" id="2711683">)</span><span class="op" id="2711684">;</span>&nbsp;<span class="ident" id="2711686">n</span>&nbsp;<span class="op" id="2711688">&gt;</span>&nbsp;<span class="num" id="2711690">0</span><span class="op" id="2711691">;</span>&nbsp;<span class="ident" id="2711693">n</span>&nbsp;<span class="op" id="2711695">&gt;&gt;=</span>&nbsp;<span class="num" id="2711699">8</span>&nbsp;<span class="op" id="2711701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711705">array</span><span class="op" id="2711710">.</span><span class="ident" id="2711711">hash</span>&nbsp;<span class="op" id="2711716">=</span>&nbsp;<span class="ident" id="2711718">fnv1</span><span class="op" id="2711722">(</span><span class="ident" id="2711723">array</span><span class="op" id="2711728">.</span><span class="ident" id="2711729">hash</span><span class="op" id="2711733">,</span>&nbsp;<span class="builtintype" id="2711735">byte</span><span class="op" id="2711739">(</span><span class="ident" id="2711740">n</span><span class="op" id="2711741">)</span><span class="op" id="2711742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711748">array</span><span class="op" id="2711753">.</span><span class="ident" id="2711754">hash</span>&nbsp;<span class="op" id="2711759">=</span>&nbsp;<span class="ident" id="2711761">fnv1</span><span class="op" id="2711765">(</span><span class="ident" id="2711766">array</span><span class="op" id="2711771">.</span><span class="ident" id="2711772">hash</span><span class="op" id="2711776">,</span>&nbsp;<span class="string" id="2711778">&#39;]&#39;</span><span class="op" id="2711781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711784">array</span><span class="op" id="2711789">.</span><span class="ident" id="2711790">elem</span>&nbsp;<span class="op" id="2711795">=</span>&nbsp;<span class="ident" id="2711797">typ</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711802">max</span>&nbsp;<span class="op" id="2711806">:=</span>&nbsp;<span class="op" id="2711809">^</span><span class="builtintype" id="2711810">uintptr</span><span class="op" id="2711817">(</span><span class="num" id="2711818">0</span><span class="op" id="2711819">)</span>&nbsp;<span class="op" id="2711821">/</span>&nbsp;<span class="ident" id="2711823">typ</span><span class="op" id="2711826">.</span><span class="ident" id="2711827">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2711833">if</span>&nbsp;<span class="builtintype" id="2711836">uintptr</span><span class="op" id="2711843">(</span><span class="ident" id="2711844">count</span><span class="op" id="2711849">)</span>&nbsp;<span class="op" id="2711851">&gt;</span>&nbsp;<span class="ident" id="2711853">max</span>&nbsp;<span class="op" id="2711857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2711861">panic</span><span class="op" id="2711866">(</span><span class="string" id="2711867">&#34;reflect.ArrayOf:&nbsp;array&nbsp;size&nbsp;would&nbsp;exceed&nbsp;virtual&nbsp;address&nbsp;space&#34;</span><span class="op" id="2711931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2711934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711937">array</span><span class="op" id="2711942">.</span><span class="ident" id="2711943">size</span>&nbsp;<span class="op" id="2711948">=</span>&nbsp;<span class="ident" id="2711950">typ</span><span class="op" id="2711953">.</span><span class="ident" id="2711954">size</span>&nbsp;<span class="op" id="2711959">*</span>&nbsp;<span class="builtintype" id="2711961">uintptr</span><span class="op" id="2711968">(</span><span class="ident" id="2711969">count</span><span class="op" id="2711974">)</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2711977">array</span><span class="op" id="2711982">.</span><span class="ident" id="2711983">align</span>&nbsp;<span class="op" id="2711989">=</span>&nbsp;<span class="ident" id="2711991">typ</span><span class="op" id="2711994">.</span><span class="ident" id="2711995">align</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712002">array</span><span class="op" id="2712007">.</span><span class="ident" id="2712008">fieldAlign</span>&nbsp;<span class="op" id="2712019">=</span>&nbsp;<span class="ident" id="2712021">typ</span><span class="op" id="2712024">.</span><span class="ident" id="2712025">fieldAlign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2712037">//&nbsp;TODO:&nbsp;array.alg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2712057">//&nbsp;TODO:&nbsp;array.gc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2712076">//&nbsp;TODO:</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712086">array</span><span class="op" id="2712091">.</span><span class="ident" id="2712092">uncommonType</span>&nbsp;<span class="op" id="2712105">=</span>&nbsp;<span class="ident" id="2712107">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712112">array</span><span class="op" id="2712117">.</span><span class="ident" id="2712118">ptrToThis</span>&nbsp;<span class="op" id="2712128">=</span>&nbsp;<span class="ident" id="2712130">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712135">array</span><span class="op" id="2712140">.</span><span class="ident" id="2712141">zero</span>&nbsp;<span class="op" id="2712146">=</span>&nbsp;<span class="ident" id="2712148">unsafe</span><span class="op" id="2712154">.</span><span class="ident" id="2712155">Pointer</span><span class="op" id="2712162">(</span><span class="op" id="2712163">&amp;</span><span class="builtinfunc" id="2712164">make</span><span class="op" id="2712168">(</span><span class="op" id="2712169">[</span><span class="op" id="2712170">]</span><span class="builtintype" id="2712171">byte</span><span class="op" id="2712175">,</span>&nbsp;<span class="ident" id="2712177">array</span><span class="op" id="2712182">.</span><span class="ident" id="2712183">size</span><span class="op" id="2712187">)</span><span class="op" id="2712188">[</span><span class="num" id="2712189">0</span><span class="op" id="2712190">]</span><span class="op" id="2712191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712194">array</span><span class="op" id="2712199">.</span><span class="builtinfunc" id="2712200">len</span>&nbsp;<span class="op" id="2712204">=</span>&nbsp;<span class="builtintype" id="2712206">uintptr</span><span class="op" id="2712213">(</span><span class="ident" id="2712214">count</span><span class="op" id="2712219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712222">array</span><span class="op" id="2712227">.</span><span class="ident" id="2712228">slice</span>&nbsp;<span class="op" id="2712234">=</span>&nbsp;<span class="ident" id="2712236">slice</span><span class="op" id="2712241">.</span><span class="op" id="2712242">(</span><span class="op" id="2712243">*</span><span class="ident" id="2712244">rtype</span><span class="op" id="2712249">)</span><br>
<span class="lineno">1740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712253">return</span>&nbsp;<span class="ident" id="2712260">cachePut</span><span class="op" id="2712268">(</span><span class="ident" id="2712269">ckey</span><span class="op" id="2712273">,</span>&nbsp;<span class="op" id="2712275">&amp;</span><span class="ident" id="2712276">array</span><span class="op" id="2712281">.</span><span class="ident" id="2712282">rtype</span><span class="op" id="2712287">)</span><br>
<span class="lineno"></span><span class="op" id="2712289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2712292">//&nbsp;toType&nbsp;converts&nbsp;from&nbsp;a&nbsp;*rtype&nbsp;to&nbsp;a&nbsp;Type&nbsp;that&nbsp;can&nbsp;be&nbsp;returned</span><br>
<span class="lineno">1745</span><span class="comment" id="2712356">//&nbsp;to&nbsp;the&nbsp;client&nbsp;of&nbsp;package&nbsp;reflect.&nbsp;In&nbsp;gc,&nbsp;the&nbsp;only&nbsp;concern&nbsp;is&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2712425">//&nbsp;a&nbsp;nil&nbsp;*rtype&nbsp;must&nbsp;be&nbsp;replaced&nbsp;by&nbsp;a&nbsp;nil&nbsp;Type,&nbsp;but&nbsp;in&nbsp;gccgo&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2712491">//&nbsp;function&nbsp;takes&nbsp;care&nbsp;of&nbsp;ensuring&nbsp;that&nbsp;multiple&nbsp;*rtype&nbsp;for&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2712560">//&nbsp;type&nbsp;are&nbsp;coalesced&nbsp;into&nbsp;a&nbsp;single&nbsp;Type.</span><br>
<span class="lineno"></span><span class="keyword" id="2712602">func</span>&nbsp;<span class="ident" id="2712607">toType</span><span class="op" id="2712613">(</span><span class="ident" id="2712614">t</span>&nbsp;<span class="op" id="2712616">*</span><span class="ident" id="2712617">rtype</span><span class="op" id="2712622">)</span>&nbsp;<span class="ident" id="2712624">Type</span>&nbsp;<span class="op" id="2712629">{</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712632">if</span>&nbsp;<span class="ident" id="2712635">t</span>&nbsp;<span class="op" id="2712637">==</span>&nbsp;<span class="ident" id="2712640">nil</span>&nbsp;<span class="op" id="2712644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712648">return</span>&nbsp;<span class="ident" id="2712655">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2712660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2712663">return</span>&nbsp;<span class="ident" id="2712670">t</span><br>
<span class="lineno"></span><span class="op" id="2712672">}</span><br>
<span class="lineno">1755</span><br>
<span class="lineno"></span><span class="keyword" id="2712675">type</span>&nbsp;<span class="ident" id="2712680">layoutKey</span>&nbsp;<span class="keyword" id="2712690">struct</span>&nbsp;<span class="op" id="2712697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712700">t</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2712705">*</span><span class="ident" id="2712706">rtype</span>&nbsp;<span class="comment" id="2712712">//&nbsp;function&nbsp;signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712735">rcvr</span>&nbsp;<span class="op" id="2712740">*</span><span class="ident" id="2712741">rtype</span>&nbsp;<span class="comment" id="2712747">//&nbsp;receiver&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;none</span><br>
<span class="lineno"></span><span class="op" id="2712780">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span><span class="keyword" id="2712783">type</span>&nbsp;<span class="ident" id="2712788">layoutType</span>&nbsp;<span class="keyword" id="2712799">struct</span>&nbsp;<span class="op" id="2712806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712809">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2712819">*</span><span class="ident" id="2712820">rtype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712827">argSize</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2712837">uintptr</span>&nbsp;<span class="comment" id="2712845">//&nbsp;size&nbsp;of&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712867">retOffset</span>&nbsp;<span class="builtintype" id="2712877">uintptr</span>&nbsp;<span class="comment" id="2712885">//&nbsp;offset&nbsp;of&nbsp;return&nbsp;values.</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712914">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2712924">*</span><span class="ident" id="2712925">bitVector</span><br>
<span class="lineno"></span><span class="op" id="2712935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2712938">var</span>&nbsp;<span class="ident" id="2712942">layoutCache</span>&nbsp;<span class="keyword" id="2712954">struct</span>&nbsp;<span class="op" id="2712961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712964">sync</span><span class="op" id="2712968">.</span><span class="ident" id="2712969">RWMutex</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2712978">m</span>&nbsp;<span class="keyword" id="2712980">map</span><span class="op" id="2712983">[</span><span class="ident" id="2712984">layoutKey</span><span class="op" id="2712993">]</span><span class="ident" id="2712994">layoutType</span><br>
<span class="lineno"></span><span class="op" id="2713005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2713008">//&nbsp;funcLayout&nbsp;computes&nbsp;a&nbsp;struct&nbsp;type&nbsp;representing&nbsp;the&nbsp;layout&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2713076">//&nbsp;function&nbsp;arguments&nbsp;and&nbsp;return&nbsp;values&nbsp;for&nbsp;the&nbsp;function&nbsp;type&nbsp;t.</span><br>
<span class="lineno">1775</span><span class="comment" id="2713141">//&nbsp;If&nbsp;rcvr&nbsp;!=&nbsp;nil,&nbsp;rcvr&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="2713201">//&nbsp;The&nbsp;returned&nbsp;type&nbsp;exists&nbsp;only&nbsp;for&nbsp;GC,&nbsp;so&nbsp;we&nbsp;only&nbsp;fill&nbsp;out&nbsp;GC&nbsp;relevant&nbsp;info.</span><br>
<span class="lineno"></span><span class="comment" id="2713280">//&nbsp;Currently,&nbsp;that&#39;s&nbsp;just&nbsp;size&nbsp;and&nbsp;the&nbsp;GC&nbsp;program.&nbsp;&nbsp;We&nbsp;also&nbsp;fill&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2713348">//&nbsp;the&nbsp;name&nbsp;for&nbsp;possible&nbsp;debugging&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="2713388">func</span>&nbsp;<span class="ident" id="2713393">funcLayout</span><span class="op" id="2713403">(</span><span class="ident" id="2713404">t</span>&nbsp;<span class="op" id="2713406">*</span><span class="ident" id="2713407">rtype</span><span class="op" id="2713412">,</span>&nbsp;<span class="ident" id="2713414">rcvr</span>&nbsp;<span class="op" id="2713419">*</span><span class="ident" id="2713420">rtype</span><span class="op" id="2713425">)</span>&nbsp;<span class="op" id="2713427">(</span><span class="ident" id="2713428">frametype</span>&nbsp;<span class="op" id="2713438">*</span><span class="ident" id="2713439">rtype</span><span class="op" id="2713444">,</span>&nbsp;<span class="ident" id="2713446">argSize</span><span class="op" id="2713453">,</span>&nbsp;<span class="ident" id="2713455">retOffset</span>&nbsp;<span class="builtintype" id="2713465">uintptr</span><span class="op" id="2713472">,</span>&nbsp;<span class="ident" id="2713474">stack</span>&nbsp;<span class="op" id="2713480">*</span><span class="ident" id="2713481">bitVector</span><span class="op" id="2713490">)</span>&nbsp;<span class="op" id="2713492">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713495">if</span>&nbsp;<span class="ident" id="2713498">t</span><span class="op" id="2713499">.</span><span class="ident" id="2713500">Kind</span><span class="op" id="2713504">(</span><span class="op" id="2713505">)</span>&nbsp;<span class="op" id="2713507">!=</span>&nbsp;<span class="ident" id="2713510">Func</span>&nbsp;<span class="op" id="2713515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2713519">panic</span><span class="op" id="2713524">(</span><span class="string" id="2713525">&#34;reflect:&nbsp;funcLayout&nbsp;of&nbsp;non-func&nbsp;type&#34;</span><span class="op" id="2713563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713569">if</span>&nbsp;<span class="ident" id="2713572">rcvr</span>&nbsp;<span class="op" id="2713577">!=</span>&nbsp;<span class="ident" id="2713580">nil</span>&nbsp;<span class="op" id="2713584">&amp;&amp;</span>&nbsp;<span class="ident" id="2713587">rcvr</span><span class="op" id="2713591">.</span><span class="ident" id="2713592">Kind</span><span class="op" id="2713596">(</span><span class="op" id="2713597">)</span>&nbsp;<span class="op" id="2713599">==</span>&nbsp;<span class="ident" id="2713602">Interface</span>&nbsp;<span class="op" id="2713612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2713616">panic</span><span class="op" id="2713621">(</span><span class="string" id="2713622">&#34;reflect:&nbsp;funcLayout&nbsp;with&nbsp;interface&nbsp;receiver&nbsp;&#34;</span>&nbsp;<span class="op" id="2713669">+</span>&nbsp;<span class="ident" id="2713671">rcvr</span><span class="op" id="2713675">.</span><span class="ident" id="2713676">String</span><span class="op" id="2713682">(</span><span class="op" id="2713683">)</span><span class="op" id="2713684">)</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713690">k</span>&nbsp;<span class="op" id="2713692">:=</span>&nbsp;<span class="ident" id="2713695">layoutKey</span><span class="op" id="2713704">{</span><span class="ident" id="2713705">t</span><span class="op" id="2713706">,</span>&nbsp;<span class="ident" id="2713708">rcvr</span><span class="op" id="2713712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713715">layoutCache</span><span class="op" id="2713726">.</span><span class="ident" id="2713727">RLock</span><span class="op" id="2713732">(</span><span class="op" id="2713733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713736">if</span>&nbsp;<span class="ident" id="2713739">x</span>&nbsp;<span class="op" id="2713741">:=</span>&nbsp;<span class="ident" id="2713744">layoutCache</span><span class="op" id="2713755">.</span><span class="ident" id="2713756">m</span><span class="op" id="2713757">[</span><span class="ident" id="2713758">k</span><span class="op" id="2713759">]</span><span class="op" id="2713760">;</span>&nbsp;<span class="ident" id="2713762">x</span><span class="op" id="2713763">.</span><span class="ident" id="2713764">t</span>&nbsp;<span class="op" id="2713766">!=</span>&nbsp;<span class="ident" id="2713769">nil</span>&nbsp;<span class="op" id="2713773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713777">layoutCache</span><span class="op" id="2713788">.</span><span class="ident" id="2713789">RUnlock</span><span class="op" id="2713796">(</span><span class="op" id="2713797">)</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713801">return</span>&nbsp;<span class="ident" id="2713808">x</span><span class="op" id="2713809">.</span><span class="ident" id="2713810">t</span><span class="op" id="2713811">,</span>&nbsp;<span class="ident" id="2713813">x</span><span class="op" id="2713814">.</span><span class="ident" id="2713815">argSize</span><span class="op" id="2713822">,</span>&nbsp;<span class="ident" id="2713824">x</span><span class="op" id="2713825">.</span><span class="ident" id="2713826">retOffset</span><span class="op" id="2713835">,</span>&nbsp;<span class="ident" id="2713837">x</span><span class="op" id="2713838">.</span><span class="ident" id="2713839">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2713846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713849">layoutCache</span><span class="op" id="2713860">.</span><span class="ident" id="2713861">RUnlock</span><span class="op" id="2713868">(</span><span class="op" id="2713869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713872">layoutCache</span><span class="op" id="2713883">.</span><span class="ident" id="2713884">Lock</span><span class="op" id="2713888">(</span><span class="op" id="2713889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713892">if</span>&nbsp;<span class="ident" id="2713895">x</span>&nbsp;<span class="op" id="2713897">:=</span>&nbsp;<span class="ident" id="2713900">layoutCache</span><span class="op" id="2713911">.</span><span class="ident" id="2713912">m</span><span class="op" id="2713913">[</span><span class="ident" id="2713914">k</span><span class="op" id="2713915">]</span><span class="op" id="2713916">;</span>&nbsp;<span class="ident" id="2713918">x</span><span class="op" id="2713919">.</span><span class="ident" id="2713920">t</span>&nbsp;<span class="op" id="2713922">!=</span>&nbsp;<span class="ident" id="2713925">nil</span>&nbsp;<span class="op" id="2713929">{</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2713933">layoutCache</span><span class="op" id="2713944">.</span><span class="ident" id="2713945">Unlock</span><span class="op" id="2713951">(</span><span class="op" id="2713952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2713956">return</span>&nbsp;<span class="ident" id="2713963">x</span><span class="op" id="2713964">.</span><span class="ident" id="2713965">t</span><span class="op" id="2713966">,</span>&nbsp;<span class="ident" id="2713968">x</span><span class="op" id="2713969">.</span><span class="ident" id="2713970">argSize</span><span class="op" id="2713977">,</span>&nbsp;<span class="ident" id="2713979">x</span><span class="op" id="2713980">.</span><span class="ident" id="2713981">retOffset</span><span class="op" id="2713990">,</span>&nbsp;<span class="ident" id="2713992">x</span><span class="op" id="2713993">.</span><span class="ident" id="2713994">stack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714005">tt</span>&nbsp;<span class="op" id="2714008">:=</span>&nbsp;<span class="op" id="2714011">(</span><span class="op" id="2714012">*</span><span class="ident" id="2714013">funcType</span><span class="op" id="2714021">)</span><span class="op" id="2714022">(</span><span class="ident" id="2714023">unsafe</span><span class="op" id="2714029">.</span><span class="ident" id="2714030">Pointer</span><span class="op" id="2714037">(</span><span class="ident" id="2714038">t</span><span class="op" id="2714039">)</span><span class="op" id="2714040">)</span><br>
<span class="lineno">1800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714044">//&nbsp;compute&nbsp;gc&nbsp;program&nbsp;&amp;&nbsp;stack&nbsp;bitmap&nbsp;for&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714096">stack</span>&nbsp;<span class="op" id="2714102">=</span>&nbsp;<span class="builtinfunc" id="2714104">new</span><span class="op" id="2714107">(</span><span class="ident" id="2714108">bitVector</span><span class="op" id="2714117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714120">var</span>&nbsp;<span class="ident" id="2714124">gc</span>&nbsp;<span class="ident" id="2714127">gcProg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714135">var</span>&nbsp;<span class="ident" id="2714139">offset</span>&nbsp;<span class="builtintype" id="2714146">uintptr</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714155">if</span>&nbsp;<span class="ident" id="2714158">rcvr</span>&nbsp;<span class="op" id="2714163">!=</span>&nbsp;<span class="ident" id="2714166">nil</span>&nbsp;<span class="op" id="2714170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714174">//&nbsp;Reflect&nbsp;uses&nbsp;the&nbsp;&#34;interface&#34;&nbsp;calling&nbsp;convention&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714231">//&nbsp;methods,&nbsp;where&nbsp;receivers&nbsp;take&nbsp;one&nbsp;word&nbsp;of&nbsp;argument</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714287">//&nbsp;space&nbsp;no&nbsp;matter&nbsp;how&nbsp;big&nbsp;they&nbsp;actually&nbsp;are.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714335">if</span>&nbsp;<span class="ident" id="2714338">ifaceIndir</span><span class="op" id="2714348">(</span><span class="ident" id="2714349">rcvr</span><span class="op" id="2714353">)</span>&nbsp;<span class="op" id="2714355">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714360">//&nbsp;we&nbsp;pass&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714401">gc</span><span class="op" id="2714403">.</span><span class="builtinfunc" id="2714404">append</span><span class="op" id="2714410">(</span><span class="ident" id="2714411">bitsPointer</span><span class="op" id="2714422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714427">stack</span><span class="op" id="2714432">.</span><span class="ident" id="2714433">append2</span><span class="op" id="2714440">(</span><span class="ident" id="2714441">bitsPointer</span><span class="op" id="2714452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714456">}</span>&nbsp;<span class="keyword" id="2714458">else</span>&nbsp;<span class="keyword" id="2714463">if</span>&nbsp;<span class="ident" id="2714466">rcvr</span><span class="op" id="2714470">.</span><span class="ident" id="2714471">pointers</span><span class="op" id="2714479">(</span><span class="op" id="2714480">)</span>&nbsp;<span class="op" id="2714482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714487">//&nbsp;rcvr&nbsp;is&nbsp;a&nbsp;one-word&nbsp;pointer&nbsp;object.&nbsp;&nbsp;Its&nbsp;gc&nbsp;program</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714544">//&nbsp;is&nbsp;just&nbsp;what&nbsp;we&nbsp;need&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714577">gc</span><span class="op" id="2714579">.</span><span class="builtinfunc" id="2714580">append</span><span class="op" id="2714586">(</span><span class="ident" id="2714587">bitsPointer</span><span class="op" id="2714598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714603">stack</span><span class="op" id="2714608">.</span><span class="ident" id="2714609">append2</span><span class="op" id="2714616">(</span><span class="ident" id="2714617">bitsPointer</span><span class="op" id="2714628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714632">}</span>&nbsp;<span class="keyword" id="2714634">else</span>&nbsp;<span class="op" id="2714639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714644">gc</span><span class="op" id="2714646">.</span><span class="builtinfunc" id="2714647">append</span><span class="op" id="2714653">(</span><span class="ident" id="2714654">bitsScalar</span><span class="op" id="2714664">)</span><br>
<span class="lineno">1820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714669">stack</span><span class="op" id="2714674">.</span><span class="ident" id="2714675">append2</span><span class="op" id="2714682">(</span><span class="ident" id="2714683">bitsScalar</span><span class="op" id="2714693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714701">offset</span>&nbsp;<span class="op" id="2714708">+=</span>&nbsp;<span class="ident" id="2714711">ptrSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714723">for</span>&nbsp;<span class="ident" id="2714727">_</span><span class="op" id="2714728">,</span>&nbsp;<span class="ident" id="2714730">arg</span>&nbsp;<span class="op" id="2714734">:=</span>&nbsp;<span class="keyword" id="2714737">range</span>&nbsp;<span class="ident" id="2714743">tt</span><span class="op" id="2714745">.</span><span class="ident" id="2714746">in</span>&nbsp;<span class="op" id="2714749">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714753">gc</span><span class="op" id="2714755">.</span><span class="ident" id="2714756">appendProg</span><span class="op" id="2714766">(</span><span class="ident" id="2714767">arg</span><span class="op" id="2714770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714774">addTypeBits</span><span class="op" id="2714785">(</span><span class="ident" id="2714786">stack</span><span class="op" id="2714791">,</span>&nbsp;<span class="op" id="2714793">&amp;</span><span class="ident" id="2714794">offset</span><span class="op" id="2714800">,</span>&nbsp;<span class="ident" id="2714802">arg</span><span class="op" id="2714805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714811">argSize</span>&nbsp;<span class="op" id="2714819">=</span>&nbsp;<span class="ident" id="2714821">gc</span><span class="op" id="2714823">.</span><span class="ident" id="2714824">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714830">if</span>&nbsp;<span class="ident" id="2714833">runtime</span><span class="op" id="2714840">.</span><span class="ident" id="2714841">GOARCH</span>&nbsp;<span class="op" id="2714848">==</span>&nbsp;<span class="string" id="2714851">&#34;amd64p32&#34;</span>&nbsp;<span class="op" id="2714862">{</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714866">gc</span><span class="op" id="2714868">.</span><span class="ident" id="2714869">align</span><span class="op" id="2714874">(</span><span class="num" id="2714875">8</span><span class="op" id="2714876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2714879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714882">gc</span><span class="op" id="2714884">.</span><span class="ident" id="2714885">align</span><span class="op" id="2714890">(</span><span class="ident" id="2714891">ptrSize</span><span class="op" id="2714898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714901">retOffset</span>&nbsp;<span class="op" id="2714911">=</span>&nbsp;<span class="ident" id="2714913">gc</span><span class="op" id="2714915">.</span><span class="ident" id="2714916">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2714922">for</span>&nbsp;<span class="ident" id="2714926">_</span><span class="op" id="2714927">,</span>&nbsp;<span class="ident" id="2714929">res</span>&nbsp;<span class="op" id="2714933">:=</span>&nbsp;<span class="keyword" id="2714936">range</span>&nbsp;<span class="ident" id="2714942">tt</span><span class="op" id="2714944">.</span><span class="ident" id="2714945">out</span>&nbsp;<span class="op" id="2714949">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2714953">gc</span><span class="op" id="2714955">.</span><span class="ident" id="2714956">appendProg</span><span class="op" id="2714966">(</span><span class="ident" id="2714967">res</span><span class="op" id="2714970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2714974">//&nbsp;stack&nbsp;map&nbsp;does&nbsp;not&nbsp;need&nbsp;result&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715017">gc</span><span class="op" id="2715019">.</span><span class="ident" id="2715020">align</span><span class="op" id="2715025">(</span><span class="ident" id="2715026">ptrSize</span><span class="op" id="2715033">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2715037">//&nbsp;build&nbsp;dummy&nbsp;rtype&nbsp;holding&nbsp;gc&nbsp;program</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715078">x</span>&nbsp;<span class="op" id="2715080">:=</span>&nbsp;<span class="builtinfunc" id="2715083">new</span><span class="op" id="2715086">(</span><span class="ident" id="2715087">rtype</span><span class="op" id="2715092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715095">x</span><span class="op" id="2715096">.</span><span class="ident" id="2715097">size</span>&nbsp;<span class="op" id="2715102">=</span>&nbsp;<span class="ident" id="2715104">gc</span><span class="op" id="2715106">.</span><span class="ident" id="2715107">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715113">x</span><span class="op" id="2715114">.</span><span class="ident" id="2715115">gc</span><span class="op" id="2715117">[</span><span class="num" id="2715118">0</span><span class="op" id="2715119">]</span>&nbsp;<span class="op" id="2715121">=</span>&nbsp;<span class="ident" id="2715123">gc</span><span class="op" id="2715125">.</span><span class="ident" id="2715126">finalize</span><span class="op" id="2715134">(</span><span class="op" id="2715135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715138">var</span>&nbsp;<span class="ident" id="2715142">s</span>&nbsp;<span class="builtintype" id="2715144">string</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715152">if</span>&nbsp;<span class="ident" id="2715155">rcvr</span>&nbsp;<span class="op" id="2715160">!=</span>&nbsp;<span class="ident" id="2715163">nil</span>&nbsp;<span class="op" id="2715167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715171">s</span>&nbsp;<span class="op" id="2715173">=</span>&nbsp;<span class="string" id="2715175">&#34;methodargs(&#34;</span>&nbsp;<span class="op" id="2715189">+</span>&nbsp;<span class="op" id="2715191">*</span><span class="ident" id="2715192">rcvr</span><span class="op" id="2715196">.</span><span class="builtintype" id="2715197">string</span>&nbsp;<span class="op" id="2715204">+</span>&nbsp;<span class="string" id="2715206">&#34;)(&#34;</span>&nbsp;<span class="op" id="2715211">+</span>&nbsp;<span class="op" id="2715213">*</span><span class="ident" id="2715214">t</span><span class="op" id="2715215">.</span><span class="builtintype" id="2715216">string</span>&nbsp;<span class="op" id="2715223">+</span>&nbsp;<span class="string" id="2715225">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715230">}</span>&nbsp;<span class="keyword" id="2715232">else</span>&nbsp;<span class="op" id="2715237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715241">s</span>&nbsp;<span class="op" id="2715243">=</span>&nbsp;<span class="string" id="2715245">&#34;funcargs(&#34;</span>&nbsp;<span class="op" id="2715257">+</span>&nbsp;<span class="op" id="2715259">*</span><span class="ident" id="2715260">t</span><span class="op" id="2715261">.</span><span class="builtintype" id="2715262">string</span>&nbsp;<span class="op" id="2715269">+</span>&nbsp;<span class="string" id="2715271">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715276">}</span><br>
<span class="lineno">1850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715279">x</span><span class="op" id="2715280">.</span><span class="builtintype" id="2715281">string</span>&nbsp;<span class="op" id="2715288">=</span>&nbsp;<span class="op" id="2715290">&amp;</span><span class="ident" id="2715291">s</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2715295">//&nbsp;cache&nbsp;result&nbsp;for&nbsp;future&nbsp;callers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715331">if</span>&nbsp;<span class="ident" id="2715334">layoutCache</span><span class="op" id="2715345">.</span><span class="ident" id="2715346">m</span>&nbsp;<span class="op" id="2715348">==</span>&nbsp;<span class="ident" id="2715351">nil</span>&nbsp;<span class="op" id="2715355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715359">layoutCache</span><span class="op" id="2715370">.</span><span class="ident" id="2715371">m</span>&nbsp;<span class="op" id="2715373">=</span>&nbsp;<span class="builtinfunc" id="2715375">make</span><span class="op" id="2715379">(</span><span class="keyword" id="2715380">map</span><span class="op" id="2715383">[</span><span class="ident" id="2715384">layoutKey</span><span class="op" id="2715393">]</span><span class="ident" id="2715394">layoutType</span><span class="op" id="2715404">)</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715410">layoutCache</span><span class="op" id="2715421">.</span><span class="ident" id="2715422">m</span><span class="op" id="2715423">[</span><span class="ident" id="2715424">k</span><span class="op" id="2715425">]</span>&nbsp;<span class="op" id="2715427">=</span>&nbsp;<span class="ident" id="2715429">layoutType</span><span class="op" id="2715439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715443">t</span><span class="op" id="2715444">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715454">x</span><span class="op" id="2715455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715459">argSize</span><span class="op" id="2715466">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2715470">argSize</span><span class="op" id="2715477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715481">retOffset</span><span class="op" id="2715490">:</span>&nbsp;<span class="ident" id="2715492">retOffset</span><span class="op" id="2715501">,</span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715505">stack</span><span class="op" id="2715510">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2715516">stack</span><span class="op" id="2715521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2715524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715527">layoutCache</span><span class="op" id="2715538">.</span><span class="ident" id="2715539">Unlock</span><span class="op" id="2715545">(</span><span class="op" id="2715546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715549">return</span>&nbsp;<span class="ident" id="2715556">x</span><span class="op" id="2715557">,</span>&nbsp;<span class="ident" id="2715559">argSize</span><span class="op" id="2715566">,</span>&nbsp;<span class="ident" id="2715568">retOffset</span><span class="op" id="2715577">,</span>&nbsp;<span class="ident" id="2715579">stack</span><br>
<span class="lineno"></span><span class="op" id="2715585">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span><span class="comment" id="2715588">//&nbsp;ifaceIndir&nbsp;reports&nbsp;whether&nbsp;t&nbsp;is&nbsp;stored&nbsp;indirectly&nbsp;in&nbsp;an&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="2715664">func</span>&nbsp;<span class="ident" id="2715669">ifaceIndir</span><span class="op" id="2715679">(</span><span class="ident" id="2715680">t</span>&nbsp;<span class="op" id="2715682">*</span><span class="ident" id="2715683">rtype</span><span class="op" id="2715688">)</span>&nbsp;<span class="builtintype" id="2715690">bool</span>&nbsp;<span class="op" id="2715695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2715698">return</span>&nbsp;<span class="ident" id="2715705">t</span><span class="op" id="2715706">.</span><span class="ident" id="2715707">kind</span><span class="op" id="2715711">&amp;</span><span class="ident" id="2715712">kindDirectIface</span>&nbsp;<span class="op" id="2715728">==</span>&nbsp;<span class="num" id="2715731">0</span><br>
<span class="lineno"></span><span class="op" id="2715733">}</span><br>
<span class="lineno">1870</span><br>
<span class="lineno"></span><span class="comment" id="2715736">//&nbsp;Layout&nbsp;matches&nbsp;runtime.BitVector&nbsp;(well&nbsp;enough).</span><br>
<span class="lineno"></span><span class="keyword" id="2715787">type</span>&nbsp;<span class="ident" id="2715792">bitVector</span>&nbsp;<span class="keyword" id="2715802">struct</span>&nbsp;<span class="op" id="2715809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715812">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2715817">uint32</span>&nbsp;<span class="comment" id="2715824">//&nbsp;number&nbsp;of&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2715843">data</span>&nbsp;<span class="op" id="2715848">[</span><span class="op" id="2715849">]</span><span class="builtintype" id="2715850">byte</span><br>
<span class="lineno">1875</span><span class="op" id="2715855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2715858">//&nbsp;append&nbsp;a&nbsp;bit&nbsp;pair&nbsp;to&nbsp;the&nbsp;bitmap.</span><br>
<span class="lineno"></span><span class="keyword" id="2715894">func</span>&nbsp;<span class="op" id="2715899">(</span><span class="ident" id="2715900">bv</span>&nbsp;<span class="op" id="2715903">*</span><span class="ident" id="2715904">bitVector</span><span class="op" id="2715913">)</span>&nbsp;<span class="ident" id="2715915">append2</span><span class="op" id="2715922">(</span><span class="ident" id="2715923">bits</span>&nbsp;<span class="builtintype" id="2715928">uint8</span><span class="op" id="2715933">)</span>&nbsp;<span class="op" id="2715935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2715938">//&nbsp;assume&nbsp;bv.n&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;2,&nbsp;since&nbsp;append2&nbsp;is&nbsp;the&nbsp;only&nbsp;operation.</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716011">if</span>&nbsp;<span class="ident" id="2716014">bv</span><span class="op" id="2716016">.</span><span class="ident" id="2716017">n</span><span class="op" id="2716018">%</span><span class="num" id="2716019">8</span>&nbsp;<span class="op" id="2716021">==</span>&nbsp;<span class="num" id="2716024">0</span>&nbsp;<span class="op" id="2716026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716030">bv</span><span class="op" id="2716032">.</span><span class="ident" id="2716033">data</span>&nbsp;<span class="op" id="2716038">=</span>&nbsp;<span class="builtinfunc" id="2716040">append</span><span class="op" id="2716046">(</span><span class="ident" id="2716047">bv</span><span class="op" id="2716049">.</span><span class="ident" id="2716050">data</span><span class="op" id="2716054">,</span>&nbsp;<span class="num" id="2716056">0</span><span class="op" id="2716057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2716060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716063">bv</span><span class="op" id="2716065">.</span><span class="ident" id="2716066">data</span><span class="op" id="2716070">[</span><span class="ident" id="2716071">bv</span><span class="op" id="2716073">.</span><span class="ident" id="2716074">n</span><span class="op" id="2716075">/</span><span class="num" id="2716076">8</span><span class="op" id="2716077">]</span>&nbsp;<span class="op" id="2716079">|=</span>&nbsp;<span class="ident" id="2716082">bits</span>&nbsp;<span class="op" id="2716087">&lt;&lt;</span>&nbsp;<span class="op" id="2716090">(</span><span class="ident" id="2716091">bv</span><span class="op" id="2716093">.</span><span class="ident" id="2716094">n</span>&nbsp;<span class="op" id="2716096">%</span>&nbsp;<span class="num" id="2716098">8</span><span class="op" id="2716099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716102">bv</span><span class="op" id="2716104">.</span><span class="ident" id="2716105">n</span>&nbsp;<span class="op" id="2716107">+=</span>&nbsp;<span class="num" id="2716110">2</span><br>
<span class="lineno">1885</span><span class="op" id="2716112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2716115">func</span>&nbsp;<span class="ident" id="2716120">addTypeBits</span><span class="op" id="2716131">(</span><span class="ident" id="2716132">bv</span>&nbsp;<span class="op" id="2716135">*</span><span class="ident" id="2716136">bitVector</span><span class="op" id="2716145">,</span>&nbsp;<span class="ident" id="2716147">offset</span>&nbsp;<span class="op" id="2716154">*</span><span class="builtintype" id="2716155">uintptr</span><span class="op" id="2716162">,</span>&nbsp;<span class="ident" id="2716164">t</span>&nbsp;<span class="op" id="2716166">*</span><span class="ident" id="2716167">rtype</span><span class="op" id="2716172">)</span>&nbsp;<span class="op" id="2716174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2716177">*</span><span class="ident" id="2716178">offset</span>&nbsp;<span class="op" id="2716185">=</span>&nbsp;<span class="ident" id="2716187">align</span><span class="op" id="2716192">(</span><span class="op" id="2716193">*</span><span class="ident" id="2716194">offset</span><span class="op" id="2716200">,</span>&nbsp;<span class="builtintype" id="2716202">uintptr</span><span class="op" id="2716209">(</span><span class="ident" id="2716210">t</span><span class="op" id="2716211">.</span><span class="ident" id="2716212">align</span><span class="op" id="2716217">)</span><span class="op" id="2716218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716221">if</span>&nbsp;<span class="ident" id="2716224">t</span><span class="op" id="2716225">.</span><span class="ident" id="2716226">kind</span><span class="op" id="2716230">&amp;</span><span class="ident" id="2716231">kindNoPointers</span>&nbsp;<span class="op" id="2716246">!=</span>&nbsp;<span class="num" id="2716249">0</span>&nbsp;<span class="op" id="2716251">{</span><br>
<span class="lineno">1890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2716255">*</span><span class="ident" id="2716256">offset</span>&nbsp;<span class="op" id="2716263">+=</span>&nbsp;<span class="ident" id="2716266">t</span><span class="op" id="2716267">.</span><span class="ident" id="2716268">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716275">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2716283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716287">switch</span>&nbsp;<span class="ident" id="2716294">Kind</span><span class="op" id="2716298">(</span><span class="ident" id="2716299">t</span><span class="op" id="2716300">.</span><span class="ident" id="2716301">kind</span>&nbsp;<span class="op" id="2716306">&amp;</span>&nbsp;<span class="ident" id="2716308">kindMask</span><span class="op" id="2716316">)</span>&nbsp;<span class="op" id="2716318">{</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716321">case</span>&nbsp;<span class="ident" id="2716326">Chan</span><span class="op" id="2716330">,</span>&nbsp;<span class="ident" id="2716332">Func</span><span class="op" id="2716336">,</span>&nbsp;<span class="ident" id="2716338">Map</span><span class="op" id="2716341">,</span>&nbsp;<span class="ident" id="2716343">Ptr</span><span class="op" id="2716346">,</span>&nbsp;<span class="ident" id="2716348">Slice</span><span class="op" id="2716353">,</span>&nbsp;<span class="ident" id="2716355">String</span><span class="op" id="2716361">,</span>&nbsp;<span class="ident" id="2716363">UnsafePointer</span><span class="op" id="2716376">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2716380">//&nbsp;1&nbsp;pointer&nbsp;at&nbsp;start&nbsp;of&nbsp;representation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716422">for</span>&nbsp;<span class="ident" id="2716426">bv</span><span class="op" id="2716428">.</span><span class="ident" id="2716429">n</span>&nbsp;<span class="op" id="2716431">&lt;</span>&nbsp;<span class="num" id="2716433">2</span><span class="op" id="2716434">*</span><span class="builtintype" id="2716435">uint32</span><span class="op" id="2716441">(</span><span class="op" id="2716442">*</span><span class="ident" id="2716443">offset</span><span class="op" id="2716449">/</span><span class="builtintype" id="2716450">uintptr</span><span class="op" id="2716457">(</span><span class="ident" id="2716458">ptrSize</span><span class="op" id="2716465">)</span><span class="op" id="2716466">)</span>&nbsp;<span class="op" id="2716468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716473">bv</span><span class="op" id="2716475">.</span><span class="ident" id="2716476">append2</span><span class="op" id="2716483">(</span><span class="ident" id="2716484">bitsScalar</span><span class="op" id="2716494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2716498">}</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716502">bv</span><span class="op" id="2716504">.</span><span class="ident" id="2716505">append2</span><span class="op" id="2716512">(</span><span class="ident" id="2716513">bitsPointer</span><span class="op" id="2716524">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716528">case</span>&nbsp;<span class="ident" id="2716533">Interface</span><span class="op" id="2716542">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2716546">//&nbsp;2&nbsp;pointers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716562">for</span>&nbsp;<span class="ident" id="2716566">bv</span><span class="op" id="2716568">.</span><span class="ident" id="2716569">n</span>&nbsp;<span class="op" id="2716571">&lt;</span>&nbsp;<span class="num" id="2716573">2</span><span class="op" id="2716574">*</span><span class="builtintype" id="2716575">uint32</span><span class="op" id="2716581">(</span><span class="op" id="2716582">*</span><span class="ident" id="2716583">offset</span><span class="op" id="2716589">/</span><span class="builtintype" id="2716590">uintptr</span><span class="op" id="2716597">(</span><span class="ident" id="2716598">ptrSize</span><span class="op" id="2716605">)</span><span class="op" id="2716606">)</span>&nbsp;<span class="op" id="2716608">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716613">bv</span><span class="op" id="2716615">.</span><span class="ident" id="2716616">append2</span><span class="op" id="2716623">(</span><span class="ident" id="2716624">bitsScalar</span><span class="op" id="2716634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2716638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716642">bv</span><span class="op" id="2716644">.</span><span class="ident" id="2716645">append2</span><span class="op" id="2716652">(</span><span class="ident" id="2716653">bitsPointer</span><span class="op" id="2716664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716668">bv</span><span class="op" id="2716670">.</span><span class="ident" id="2716671">append2</span><span class="op" id="2716678">(</span><span class="ident" id="2716679">bitsPointer</span><span class="op" id="2716690">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716694">case</span>&nbsp;<span class="ident" id="2716699">Array</span><span class="op" id="2716704">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2716708">//&nbsp;repeat&nbsp;inner&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716731">tt</span>&nbsp;<span class="op" id="2716734">:=</span>&nbsp;<span class="op" id="2716737">(</span><span class="op" id="2716738">*</span><span class="ident" id="2716739">arrayType</span><span class="op" id="2716748">)</span><span class="op" id="2716749">(</span><span class="ident" id="2716750">unsafe</span><span class="op" id="2716756">.</span><span class="ident" id="2716757">Pointer</span><span class="op" id="2716764">(</span><span class="ident" id="2716765">t</span><span class="op" id="2716766">)</span><span class="op" id="2716767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716771">for</span>&nbsp;<span class="ident" id="2716775">i</span>&nbsp;<span class="op" id="2716777">:=</span>&nbsp;<span class="num" id="2716780">0</span><span class="op" id="2716781">;</span>&nbsp;<span class="ident" id="2716783">i</span>&nbsp;<span class="op" id="2716785">&lt;</span>&nbsp;<span class="builtintype" id="2716787">int</span><span class="op" id="2716790">(</span><span class="ident" id="2716791">tt</span><span class="op" id="2716793">.</span><span class="builtinfunc" id="2716794">len</span><span class="op" id="2716797">)</span><span class="op" id="2716798">;</span>&nbsp;<span class="ident" id="2716800">i</span><span class="op" id="2716801">++</span>&nbsp;<span class="op" id="2716804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716809">addTypeBits</span><span class="op" id="2716820">(</span><span class="ident" id="2716821">bv</span><span class="op" id="2716823">,</span>&nbsp;<span class="ident" id="2716825">offset</span><span class="op" id="2716831">,</span>&nbsp;<span class="ident" id="2716833">tt</span><span class="op" id="2716835">.</span><span class="ident" id="2716836">elem</span><span class="op" id="2716840">)</span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2716844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716848">case</span>&nbsp;<span class="ident" id="2716853">Struct</span><span class="op" id="2716859">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2716863">//&nbsp;apply&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716881">tt</span>&nbsp;<span class="op" id="2716884">:=</span>&nbsp;<span class="op" id="2716887">(</span><span class="op" id="2716888">*</span><span class="ident" id="2716889">structType</span><span class="op" id="2716899">)</span><span class="op" id="2716900">(</span><span class="ident" id="2716901">unsafe</span><span class="op" id="2716907">.</span><span class="ident" id="2716908">Pointer</span><span class="op" id="2716915">(</span><span class="ident" id="2716916">t</span><span class="op" id="2716917">)</span><span class="op" id="2716918">)</span><br>
<span class="lineno">1920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716922">start</span>&nbsp;<span class="op" id="2716928">:=</span>&nbsp;<span class="op" id="2716931">*</span><span class="ident" id="2716932">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2716941">for</span>&nbsp;<span class="ident" id="2716945">i</span>&nbsp;<span class="op" id="2716947">:=</span>&nbsp;<span class="keyword" id="2716950">range</span>&nbsp;<span class="ident" id="2716956">tt</span><span class="op" id="2716958">.</span><span class="ident" id="2716959">fields</span>&nbsp;<span class="op" id="2716966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716971">f</span>&nbsp;<span class="op" id="2716973">:=</span>&nbsp;<span class="op" id="2716976">&amp;</span><span class="ident" id="2716977">tt</span><span class="op" id="2716979">.</span><span class="ident" id="2716980">fields</span><span class="op" id="2716986">[</span><span class="ident" id="2716987">i</span><span class="op" id="2716988">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2716993">off</span>&nbsp;<span class="op" id="2716997">:=</span>&nbsp;<span class="ident" id="2717000">start</span>&nbsp;<span class="op" id="2717006">+</span>&nbsp;<span class="ident" id="2717008">f</span><span class="op" id="2717009">.</span><span class="ident" id="2717010">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2717020">addTypeBits</span><span class="op" id="2717031">(</span><span class="ident" id="2717032">bv</span><span class="op" id="2717034">,</span>&nbsp;<span class="op" id="2717036">&amp;</span><span class="ident" id="2717037">off</span><span class="op" id="2717040">,</span>&nbsp;<span class="ident" id="2717042">f</span><span class="op" id="2717043">.</span><span class="ident" id="2717044">typ</span><span class="op" id="2717047">)</span><br>
<span class="lineno">1925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2717051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2717054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2717058">*</span><span class="ident" id="2717059">offset</span>&nbsp;<span class="op" id="2717066">+=</span>&nbsp;<span class="ident" id="2717069">t</span><span class="op" id="2717070">.</span><span class="ident" id="2717071">size</span><br>
<span class="lineno"></span><span class="op" id="2717076">}</span>
</div>
</body>
</html>
