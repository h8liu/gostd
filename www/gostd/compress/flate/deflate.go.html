<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/flate</h2>
<ul>
<li><a href="/gostd/compress/flate/copy.go.html">copy.go</a></li>
<li><a href="/gostd/compress/flate/copy_test.go.html">copy_test.go</a></li>
<li><a href="/gostd/compress/flate/deflate.go.html" class="current">deflate.go</a></li>
<li><a href="/gostd/compress/flate/deflate_test.go.html">deflate_test.go</a></li>
<li><a href="/gostd/compress/flate/fixedhuff.go.html">fixedhuff.go</a></li>
<li><a href="/gostd/compress/flate/flate_test.go.html">flate_test.go</a></li>
<li><a href="/gostd/compress/flate/huffman_bit_writer.go.html">huffman_bit_writer.go</a></li>
<li><a href="/gostd/compress/flate/huffman_code.go.html">huffman_code.go</a></li>
<li><a href="/gostd/compress/flate/inflate.go.html">inflate.go</a></li>
<li><a href="/gostd/compress/flate/inflate_test.go.html">inflate_test.go</a></li>
<li><a href="/gostd/compress/flate/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/flate/reverse_bits.go.html">reverse_bits.go</a></li>
<li><a href="/gostd/compress/flate/token.go.html">token.go</a></li>
<li><a href="/gostd/compress/flate/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4792068">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4792123">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4792177">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4792228">package</span>&nbsp;<span class="ident" id="4792236">flate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4792243">import</span>&nbsp;<span class="op" id="4792250">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4792253">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4792260">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4792266">&#34;math&#34;</span><br>
<span class="lineno"></span><span class="op" id="4792273">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4792276">const</span>&nbsp;<span class="op" id="4792282">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792285">NoCompression</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4792304">=</span>&nbsp;<span class="num" id="4792306">0</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792309">BestSpeed</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4792328">=</span>&nbsp;<span class="num" id="4792330">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792333">fastCompression</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4792352">=</span>&nbsp;<span class="num" id="4792354">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792357">BestCompression</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4792376">=</span>&nbsp;<span class="num" id="4792378">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792381">DefaultCompression</span>&nbsp;<span class="op" id="4792400">=</span>&nbsp;<span class="op" id="4792402">-</span><span class="num" id="4792403">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792406">logWindowSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4792425">=</span>&nbsp;<span class="num" id="4792427">15</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792431">windowSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4792450">=</span>&nbsp;<span class="num" id="4792452">1</span>&nbsp;<span class="op" id="4792454">&lt;&lt;</span>&nbsp;<span class="ident" id="4792457"><a href="/gostd/compress/flate/deflate.go.html#4792406">logWindowSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792472">windowMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4792491">=</span>&nbsp;<span class="ident" id="4792493"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span>&nbsp;<span class="op" id="4792504">-</span>&nbsp;<span class="num" id="4792506">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792509">logMaxOffsetSize</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4792528">=</span>&nbsp;<span class="num" id="4792530">15</span>&nbsp;&nbsp;<span class="comment" id="4792534">//&nbsp;Standard&nbsp;DEFLATE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792555">minMatchLength</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4792574">=</span>&nbsp;<span class="num" id="4792576">3</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4792580">//&nbsp;The&nbsp;smallest&nbsp;match&nbsp;that&nbsp;the&nbsp;compressor&nbsp;looks&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792633">maxMatchLength</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4792652">=</span>&nbsp;<span class="num" id="4792654">258</span>&nbsp;<span class="comment" id="4792658">//&nbsp;The&nbsp;longest&nbsp;match&nbsp;for&nbsp;the&nbsp;compressor</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792699">minOffsetSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4792718">=</span>&nbsp;<span class="num" id="4792720">1</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4792724">//&nbsp;The&nbsp;shortest&nbsp;offset&nbsp;that&nbsp;makes&nbsp;any&nbsp;sense</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4792770">//&nbsp;The&nbsp;maximum&nbsp;number&nbsp;of&nbsp;tokens&nbsp;we&nbsp;put&nbsp;into&nbsp;a&nbsp;single&nbsp;flat&nbsp;block,&nbsp;just&nbsp;too</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4792845">//&nbsp;stop&nbsp;things&nbsp;from&nbsp;getting&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792885">maxFlateBlockTokens</span>&nbsp;<span class="op" id="4792905">=</span>&nbsp;<span class="num" id="4792907">1</span>&nbsp;<span class="op" id="4792909">&lt;&lt;</span>&nbsp;<span class="num" id="4792912">14</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792916">maxStoreBlockSize</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4792936">=</span>&nbsp;<span class="num" id="4792938">65535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792945">hashBits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4792965">=</span>&nbsp;<span class="num" id="4792967">17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4792971">hashSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4792991">=</span>&nbsp;<span class="num" id="4792993">1</span>&nbsp;<span class="op" id="4792995">&lt;&lt;</span>&nbsp;<span class="ident" id="4792998"><a href="/gostd/compress/flate/deflate.go.html#4792945">hashBits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4793008">hashMask</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793028">=</span>&nbsp;<span class="op" id="4793030">(</span><span class="num" id="4793031">1</span>&nbsp;<span class="op" id="4793033">&lt;&lt;</span>&nbsp;<span class="ident" id="4793036"><a href="/gostd/compress/flate/deflate.go.html#4792945">hashBits</a></span><span class="op" id="4793044">)</span>&nbsp;<span class="op" id="4793046">-</span>&nbsp;<span class="num" id="4793048">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4793051">hashShift</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793071">=</span>&nbsp;<span class="op" id="4793073">(</span><span class="ident" id="4793074"><a href="/gostd/compress/flate/deflate.go.html#4792945">hashBits</a></span>&nbsp;<span class="op" id="4793083">+</span>&nbsp;<span class="ident" id="4793085"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span>&nbsp;<span class="op" id="4793100">-</span>&nbsp;<span class="num" id="4793102">1</span><span class="op" id="4793103">)</span>&nbsp;<span class="op" id="4793105">/</span>&nbsp;<span class="ident" id="4793107"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4793123">maxHashOffset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793143">=</span>&nbsp;<span class="num" id="4793145">1</span>&nbsp;<span class="op" id="4793147">&lt;&lt;</span>&nbsp;<span class="num" id="4793150">24</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4793155">skipNever</span>&nbsp;<span class="op" id="4793165">=</span>&nbsp;<span class="ident" id="4793167"><a href="/gostd/compress/flate/deflate.go.html#4792266">math</a></span><span class="op" id="4793171">.</span><span class="ident" id="4793172"><a href="/gostd/math/const.go.html#2216030">MaxInt32</a></span><br>
<span class="lineno"></span><span class="op" id="4793181">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="4793184">type</span>&nbsp;<span class="ident" id="4793189">compressionLevel</span>&nbsp;<span class="keyword" id="4793206">struct</span>&nbsp;<span class="op" id="4793213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4793216">good</span><span class="op" id="4793220">,</span>&nbsp;<span class="ident" id="4793222">lazy</span><span class="op" id="4793226">,</span>&nbsp;<span class="ident" id="4793228">nice</span><span class="op" id="4793232">,</span>&nbsp;<span class="ident" id="4793234">chain</span><span class="op" id="4793239">,</span>&nbsp;<span class="ident" id="4793241">fastSkipHashing</span>&nbsp;<span class="builtintype" id="4793257">int</span><br>
<span class="lineno"></span><span class="op" id="4793261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4793264">var</span>&nbsp;<span class="ident" id="4793268">levels</span>&nbsp;<span class="op" id="4793275">=</span>&nbsp;<span class="op" id="4793277">[</span><span class="op" id="4793278">]</span><span class="ident" id="4793279"><a href="/gostd/compress/flate/deflate.go.html#4793189">compressionLevel</a></span><span class="op" id="4793295">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793298">{</span><span class="op" id="4793299">}</span><span class="op" id="4793300">,</span>&nbsp;<span class="comment" id="4793302">//&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4793308">//&nbsp;For&nbsp;levels&nbsp;1-3&nbsp;we&nbsp;don&#39;t&nbsp;bother&nbsp;trying&nbsp;with&nbsp;lazy&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793368">{</span><span class="num" id="4793369">3</span><span class="op" id="4793370">,</span>&nbsp;<span class="num" id="4793372">0</span><span class="op" id="4793373">,</span>&nbsp;<span class="num" id="4793375">8</span><span class="op" id="4793376">,</span>&nbsp;<span class="num" id="4793378">4</span><span class="op" id="4793379">,</span>&nbsp;<span class="num" id="4793381">4</span><span class="op" id="4793382">}</span><span class="op" id="4793383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793386">{</span><span class="num" id="4793387">3</span><span class="op" id="4793388">,</span>&nbsp;<span class="num" id="4793390">0</span><span class="op" id="4793391">,</span>&nbsp;<span class="num" id="4793393">16</span><span class="op" id="4793395">,</span>&nbsp;<span class="num" id="4793397">8</span><span class="op" id="4793398">,</span>&nbsp;<span class="num" id="4793400">5</span><span class="op" id="4793401">}</span><span class="op" id="4793402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793405">{</span><span class="num" id="4793406">3</span><span class="op" id="4793407">,</span>&nbsp;<span class="num" id="4793409">0</span><span class="op" id="4793410">,</span>&nbsp;<span class="num" id="4793412">32</span><span class="op" id="4793414">,</span>&nbsp;<span class="num" id="4793416">32</span><span class="op" id="4793418">,</span>&nbsp;<span class="num" id="4793420">6</span><span class="op" id="4793421">}</span><span class="op" id="4793422">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4793425">//&nbsp;Levels&nbsp;4-9&nbsp;use&nbsp;increasingly&nbsp;more&nbsp;lazy&nbsp;matching</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4793476">//&nbsp;and&nbsp;increasingly&nbsp;stringent&nbsp;conditions&nbsp;for&nbsp;&#34;good&nbsp;enough&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793537">{</span><span class="num" id="4793538">4</span><span class="op" id="4793539">,</span>&nbsp;<span class="num" id="4793541">4</span><span class="op" id="4793542">,</span>&nbsp;<span class="num" id="4793544">16</span><span class="op" id="4793546">,</span>&nbsp;<span class="num" id="4793548">16</span><span class="op" id="4793550">,</span>&nbsp;<span class="ident" id="4793552"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span><span class="op" id="4793561">}</span><span class="op" id="4793562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793565">{</span><span class="num" id="4793566">8</span><span class="op" id="4793567">,</span>&nbsp;<span class="num" id="4793569">16</span><span class="op" id="4793571">,</span>&nbsp;<span class="num" id="4793573">32</span><span class="op" id="4793575">,</span>&nbsp;<span class="num" id="4793577">32</span><span class="op" id="4793579">,</span>&nbsp;<span class="ident" id="4793581"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span><span class="op" id="4793590">}</span><span class="op" id="4793591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793594">{</span><span class="num" id="4793595">8</span><span class="op" id="4793596">,</span>&nbsp;<span class="num" id="4793598">16</span><span class="op" id="4793600">,</span>&nbsp;<span class="num" id="4793602">128</span><span class="op" id="4793605">,</span>&nbsp;<span class="num" id="4793607">128</span><span class="op" id="4793610">,</span>&nbsp;<span class="ident" id="4793612"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span><span class="op" id="4793621">}</span><span class="op" id="4793622">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793625">{</span><span class="num" id="4793626">8</span><span class="op" id="4793627">,</span>&nbsp;<span class="num" id="4793629">32</span><span class="op" id="4793631">,</span>&nbsp;<span class="num" id="4793633">128</span><span class="op" id="4793636">,</span>&nbsp;<span class="num" id="4793638">256</span><span class="op" id="4793641">,</span>&nbsp;<span class="ident" id="4793643"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span><span class="op" id="4793652">}</span><span class="op" id="4793653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793656">{</span><span class="num" id="4793657">32</span><span class="op" id="4793659">,</span>&nbsp;<span class="num" id="4793661">128</span><span class="op" id="4793664">,</span>&nbsp;<span class="num" id="4793666">258</span><span class="op" id="4793669">,</span>&nbsp;<span class="num" id="4793671">1024</span><span class="op" id="4793675">,</span>&nbsp;<span class="ident" id="4793677"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span><span class="op" id="4793686">}</span><span class="op" id="4793687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4793690">{</span><span class="num" id="4793691">32</span><span class="op" id="4793693">,</span>&nbsp;<span class="num" id="4793695">258</span><span class="op" id="4793698">,</span>&nbsp;<span class="num" id="4793700">258</span><span class="op" id="4793703">,</span>&nbsp;<span class="num" id="4793705">4096</span><span class="op" id="4793709">,</span>&nbsp;<span class="ident" id="4793711"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span><span class="op" id="4793720">}</span><span class="op" id="4793721">,</span><br>
<span class="lineno"></span><span class="op" id="4793723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="4793726">type</span>&nbsp;<span class="ident" id="4793731">compressor</span>&nbsp;<span class="keyword" id="4793742">struct</span>&nbsp;<span class="op" id="4793749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4793752"><a href="/gostd/compress/flate/deflate.go.html#4793189">compressionLevel</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4793771">w</span>&nbsp;<span class="op" id="4793773">*</span><span class="ident" id="4793774"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4813775">huffmanBitWriter</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4793793">//&nbsp;compression&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4793819">fill</span>&nbsp;<span class="keyword" id="4793824">func</span><span class="op" id="4793828">(</span><span class="op" id="4793829">*</span><span class="ident" id="4793830"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4793840">,</span>&nbsp;<span class="op" id="4793842">[</span><span class="op" id="4793843">]</span><span class="builtintype" id="4793844">byte</span><span class="op" id="4793848">)</span>&nbsp;<span class="builtintype" id="4793850">int</span>&nbsp;<span class="comment" id="4793854">//&nbsp;copy&nbsp;data&nbsp;to&nbsp;window</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4793878">step</span>&nbsp;<span class="keyword" id="4793883">func</span><span class="op" id="4793887">(</span><span class="op" id="4793888">*</span><span class="ident" id="4793889"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4793899">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4793913">//&nbsp;process&nbsp;window</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4793932">sync</span>&nbsp;<span class="builtintype" id="4793937">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4793967">//&nbsp;requesting&nbsp;flush</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4793989">//&nbsp;Input&nbsp;hash&nbsp;chains</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4794011">//&nbsp;hashHead[hashValue]&nbsp;contains&nbsp;the&nbsp;largest&nbsp;inputIndex&nbsp;with&nbsp;the&nbsp;specified&nbsp;hash&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4794097">//&nbsp;If&nbsp;hashHead[hashValue]&nbsp;is&nbsp;within&nbsp;the&nbsp;current&nbsp;window,&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4794159">//&nbsp;hashPrev[hashHead[hashValue]&nbsp;&amp;&nbsp;windowMask]&nbsp;contains&nbsp;the&nbsp;previous&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4794234">//&nbsp;with&nbsp;the&nbsp;same&nbsp;hash&nbsp;value.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794264">chainHead</span>&nbsp;&nbsp;<span class="builtintype" id="4794275">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794280">hashHead</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4794291">[</span><span class="op" id="4794292">]</span><span class="builtintype" id="4794293">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794298">hashPrev</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4794309">[</span><span class="op" id="4794310">]</span><span class="builtintype" id="4794311">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794316">hashOffset</span>&nbsp;<span class="builtintype" id="4794327">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4794333">//&nbsp;input&nbsp;window:&nbsp;unprocessed&nbsp;data&nbsp;is&nbsp;window[index:windowEnd]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794395">index</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4794409">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794414">window</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4794428">[</span><span class="op" id="4794429">]</span><span class="builtintype" id="4794430">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794436">windowEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4794450">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794455">blockStart</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4794469">int</span>&nbsp;&nbsp;<span class="comment" id="4794474">//&nbsp;window&nbsp;index&nbsp;where&nbsp;current&nbsp;tokens&nbsp;start</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794518">byteAvailable</span>&nbsp;<span class="builtintype" id="4794532">bool</span>&nbsp;<span class="comment" id="4794537">//&nbsp;if&nbsp;true,&nbsp;still&nbsp;need&nbsp;to&nbsp;process&nbsp;window[index-1].</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4794590">//&nbsp;queued&nbsp;output&nbsp;tokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794615">tokens</span>&nbsp;<span class="op" id="4794622">[</span><span class="op" id="4794623">]</span><span class="ident" id="4794624"><a href="/gostd/compress/flate/token.go.html#4856145">token</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4794632">//&nbsp;deflate&nbsp;state</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794650">length</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4794665">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794670">offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4794685">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794690">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4794705">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794710">maxInsertIndex</span>&nbsp;<span class="builtintype" id="4794725">int</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794730">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4794745">error</span><br>
<span class="lineno"></span><span class="op" id="4794751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4794754">func</span>&nbsp;<span class="op" id="4794759">(</span><span class="ident" id="4794760">d</span>&nbsp;<span class="op" id="4794762">*</span><span class="ident" id="4794763"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4794773">)</span>&nbsp;<span class="ident" id="4794775">fillDeflate</span><span class="op" id="4794786">(</span><span class="ident" id="4794787">b</span>&nbsp;<span class="op" id="4794789">[</span><span class="op" id="4794790">]</span><span class="builtintype" id="4794791">byte</span><span class="op" id="4794795">)</span>&nbsp;<span class="builtintype" id="4794797">int</span>&nbsp;<span class="op" id="4794801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4794804">if</span>&nbsp;<span class="ident" id="4794807"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4794808">.</span><span class="ident" id="4794809"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4794815">&gt;=</span>&nbsp;<span class="num" id="4794818">2</span><span class="op" id="4794819">*</span><span class="ident" id="4794820"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span><span class="op" id="4794830">-</span><span class="op" id="4794831">(</span><span class="ident" id="4794832"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span><span class="op" id="4794846">+</span><span class="ident" id="4794847"><a href="/gostd/compress/flate/deflate.go.html#4792633">maxMatchLength</a></span><span class="op" id="4794861">)</span>&nbsp;<span class="op" id="4794863">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4794867">//&nbsp;shift&nbsp;the&nbsp;window&nbsp;by&nbsp;windowSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4794903">copy</span><span class="op" id="4794907">(</span><span class="ident" id="4794908"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4794909">.</span><span class="ident" id="4794910"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4794916">,</span>&nbsp;<span class="ident" id="4794918"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4794919">.</span><span class="ident" id="4794920"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4794926">[</span><span class="ident" id="4794927"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span><span class="op" id="4794937">:</span><span class="num" id="4794938">2</span><span class="op" id="4794939">*</span><span class="ident" id="4794940"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span><span class="op" id="4794950">]</span><span class="op" id="4794951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794955"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4794956">.</span><span class="ident" id="4794957"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4794963">-=</span>&nbsp;<span class="ident" id="4794966"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4794979"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4794980">.</span><span class="ident" id="4794981"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span>&nbsp;<span class="op" id="4794991">-=</span>&nbsp;<span class="ident" id="4794994"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795007">if</span>&nbsp;<span class="ident" id="4795010"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795011">.</span><span class="ident" id="4795012"><a href="/gostd/compress/flate/deflate.go.html#4794455">blockStart</a></span>&nbsp;<span class="op" id="4795023">&gt;=</span>&nbsp;<span class="ident" id="4795026"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span>&nbsp;<span class="op" id="4795037">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795042"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795043">.</span><span class="ident" id="4795044"><a href="/gostd/compress/flate/deflate.go.html#4794455">blockStart</a></span>&nbsp;<span class="op" id="4795055">-=</span>&nbsp;<span class="ident" id="4795058"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4795071">}</span>&nbsp;<span class="keyword" id="4795073">else</span>&nbsp;<span class="op" id="4795078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795083"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795084">.</span><span class="ident" id="4795085"><a href="/gostd/compress/flate/deflate.go.html#4794455">blockStart</a></span>&nbsp;<span class="op" id="4795096">=</span>&nbsp;<span class="ident" id="4795098"><a href="/gostd/compress/flate/deflate.go.html#4792266">math</a></span><span class="op" id="4795102">.</span><span class="ident" id="4795103"><a href="/gostd/math/const.go.html#2216030">MaxInt32</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4795114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795118"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795119">.</span><span class="ident" id="4795120"><a href="/gostd/compress/flate/deflate.go.html#4794316">hashOffset</a></span>&nbsp;<span class="op" id="4795131">+=</span>&nbsp;<span class="ident" id="4795134"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795147">if</span>&nbsp;<span class="ident" id="4795150"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795151">.</span><span class="ident" id="4795152"><a href="/gostd/compress/flate/deflate.go.html#4794316">hashOffset</a></span>&nbsp;<span class="op" id="4795163">&gt;</span>&nbsp;<span class="ident" id="4795165"><a href="/gostd/compress/flate/deflate.go.html#4793123">maxHashOffset</a></span>&nbsp;<span class="op" id="4795179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795184">delta</span>&nbsp;<span class="op" id="4795190">:=</span>&nbsp;<span class="ident" id="4795193"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795194">.</span><span class="ident" id="4795195"><a href="/gostd/compress/flate/deflate.go.html#4794316">hashOffset</a></span>&nbsp;<span class="op" id="4795206">-</span>&nbsp;<span class="num" id="4795208">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795213"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795214">.</span><span class="ident" id="4795215"><a href="/gostd/compress/flate/deflate.go.html#4794316">hashOffset</a></span>&nbsp;<span class="op" id="4795226">-=</span>&nbsp;<span class="ident" id="4795229"><a href="/gostd/compress/flate/deflate.go.html#4795184">delta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795238"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795239">.</span><span class="ident" id="4795240"><a href="/gostd/compress/flate/deflate.go.html#4794264">chainHead</a></span>&nbsp;<span class="op" id="4795250">-=</span>&nbsp;<span class="ident" id="4795253"><a href="/gostd/compress/flate/deflate.go.html#4795184">delta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795262">for</span>&nbsp;<span class="ident" id="4795266">i</span><span class="op" id="4795267">,</span>&nbsp;<span class="ident" id="4795269">v</span>&nbsp;<span class="op" id="4795271">:=</span>&nbsp;<span class="keyword" id="4795274">range</span>&nbsp;<span class="ident" id="4795280"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795281">.</span><span class="ident" id="4795282"><a href="/gostd/compress/flate/deflate.go.html#4794298">hashPrev</a></span>&nbsp;<span class="op" id="4795291">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795297">if</span>&nbsp;<span class="ident" id="4795300"><a href="/gostd/compress/flate/deflate.go.html#4795269">v</a></span>&nbsp;<span class="op" id="4795302">&gt;</span>&nbsp;<span class="ident" id="4795304"><a href="/gostd/compress/flate/deflate.go.html#4795184">delta</a></span>&nbsp;<span class="op" id="4795310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795317"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795318">.</span><span class="ident" id="4795319"><a href="/gostd/compress/flate/deflate.go.html#4794298">hashPrev</a></span><span class="op" id="4795327">[</span><span class="ident" id="4795328"><a href="/gostd/compress/flate/deflate.go.html#4795266">i</a></span><span class="op" id="4795329">]</span>&nbsp;<span class="op" id="4795331">-=</span>&nbsp;<span class="ident" id="4795334"><a href="/gostd/compress/flate/deflate.go.html#4795184">delta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4795344">}</span>&nbsp;<span class="keyword" id="4795346">else</span>&nbsp;<span class="op" id="4795351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795358"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795359">.</span><span class="ident" id="4795360"><a href="/gostd/compress/flate/deflate.go.html#4794298">hashPrev</a></span><span class="op" id="4795368">[</span><span class="ident" id="4795369"><a href="/gostd/compress/flate/deflate.go.html#4795266">i</a></span><span class="op" id="4795370">]</span>&nbsp;<span class="op" id="4795372">=</span>&nbsp;<span class="num" id="4795374">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4795380">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4795385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795390">for</span>&nbsp;<span class="ident" id="4795394">i</span><span class="op" id="4795395">,</span>&nbsp;<span class="ident" id="4795397">v</span>&nbsp;<span class="op" id="4795399">:=</span>&nbsp;<span class="keyword" id="4795402">range</span>&nbsp;<span class="ident" id="4795408"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795409">.</span><span class="ident" id="4795410"><a href="/gostd/compress/flate/deflate.go.html#4794280">hashHead</a></span>&nbsp;<span class="op" id="4795419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795425">if</span>&nbsp;<span class="ident" id="4795428"><a href="/gostd/compress/flate/deflate.go.html#4795397">v</a></span>&nbsp;<span class="op" id="4795430">&gt;</span>&nbsp;<span class="ident" id="4795432"><a href="/gostd/compress/flate/deflate.go.html#4795184">delta</a></span>&nbsp;<span class="op" id="4795438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795445"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795446">.</span><span class="ident" id="4795447"><a href="/gostd/compress/flate/deflate.go.html#4794280">hashHead</a></span><span class="op" id="4795455">[</span><span class="ident" id="4795456"><a href="/gostd/compress/flate/deflate.go.html#4795394">i</a></span><span class="op" id="4795457">]</span>&nbsp;<span class="op" id="4795459">-=</span>&nbsp;<span class="ident" id="4795462"><a href="/gostd/compress/flate/deflate.go.html#4795184">delta</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4795472">}</span>&nbsp;<span class="keyword" id="4795474">else</span>&nbsp;<span class="op" id="4795479">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795486"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795487">.</span><span class="ident" id="4795488"><a href="/gostd/compress/flate/deflate.go.html#4794280">hashHead</a></span><span class="op" id="4795496">[</span><span class="ident" id="4795497"><a href="/gostd/compress/flate/deflate.go.html#4795394">i</a></span><span class="op" id="4795498">]</span>&nbsp;<span class="op" id="4795500">=</span>&nbsp;<span class="num" id="4795502">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4795508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4795513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4795517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4795520">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795523">n</span>&nbsp;<span class="op" id="4795525">:=</span>&nbsp;<span class="builtinfunc" id="4795528">copy</span><span class="op" id="4795532">(</span><span class="ident" id="4795533"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795534">.</span><span class="ident" id="4795535"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4795541">[</span><span class="ident" id="4795542"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795543">.</span><span class="ident" id="4795544"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span><span class="op" id="4795553">:</span><span class="op" id="4795554">]</span><span class="op" id="4795555">,</span>&nbsp;<span class="ident" id="4795557"><a href="/gostd/compress/flate/deflate.go.html#4794787">b</a></span><span class="op" id="4795558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795561"><a href="/gostd/compress/flate/deflate.go.html#4794760">d</a></span><span class="op" id="4795562">.</span><span class="ident" id="4795563"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span>&nbsp;<span class="op" id="4795573">+=</span>&nbsp;<span class="ident" id="4795576"><a href="/gostd/compress/flate/deflate.go.html#4795523">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795579">return</span>&nbsp;<span class="ident" id="4795586"><a href="/gostd/compress/flate/deflate.go.html#4795523">n</a></span><br>
<span class="lineno"></span><span class="op" id="4795588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="4795591">func</span>&nbsp;<span class="op" id="4795596">(</span><span class="ident" id="4795597">d</span>&nbsp;<span class="op" id="4795599">*</span><span class="ident" id="4795600"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4795610">)</span>&nbsp;<span class="ident" id="4795612">writeBlock</span><span class="op" id="4795622">(</span><span class="ident" id="4795623">tokens</span>&nbsp;<span class="op" id="4795630">[</span><span class="op" id="4795631">]</span><span class="ident" id="4795632"><a href="/gostd/compress/flate/token.go.html#4856145">token</a></span><span class="op" id="4795637">,</span>&nbsp;<span class="ident" id="4795639">index</span>&nbsp;<span class="builtintype" id="4795645">int</span><span class="op" id="4795648">,</span>&nbsp;<span class="ident" id="4795650">eof</span>&nbsp;<span class="builtintype" id="4795654">bool</span><span class="op" id="4795658">)</span>&nbsp;<span class="builtintype" id="4795660">error</span>&nbsp;<span class="op" id="4795666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795669">if</span>&nbsp;<span class="ident" id="4795672"><a href="/gostd/compress/flate/deflate.go.html#4795639">index</a></span>&nbsp;<span class="op" id="4795678">&gt;</span>&nbsp;<span class="num" id="4795680">0</span>&nbsp;<span class="op" id="4795682">||</span>&nbsp;<span class="ident" id="4795685"><a href="/gostd/compress/flate/deflate.go.html#4795650">eof</a></span>&nbsp;<span class="op" id="4795689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795693">var</span>&nbsp;<span class="ident" id="4795697">window</span>&nbsp;<span class="op" id="4795704">[</span><span class="op" id="4795705">]</span><span class="builtintype" id="4795706">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795713">if</span>&nbsp;<span class="ident" id="4795716"><a href="/gostd/compress/flate/deflate.go.html#4795597">d</a></span><span class="op" id="4795717">.</span><span class="ident" id="4795718"><a href="/gostd/compress/flate/deflate.go.html#4794455">blockStart</a></span>&nbsp;<span class="op" id="4795729">&lt;=</span>&nbsp;<span class="ident" id="4795732"><a href="/gostd/compress/flate/deflate.go.html#4795639">index</a></span>&nbsp;<span class="op" id="4795738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795743"><a href="/gostd/compress/flate/deflate.go.html#4795697">window</a></span>&nbsp;<span class="op" id="4795750">=</span>&nbsp;<span class="ident" id="4795752"><a href="/gostd/compress/flate/deflate.go.html#4795597">d</a></span><span class="op" id="4795753">.</span><span class="ident" id="4795754"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4795760">[</span><span class="ident" id="4795761"><a href="/gostd/compress/flate/deflate.go.html#4795597">d</a></span><span class="op" id="4795762">.</span><span class="ident" id="4795763"><a href="/gostd/compress/flate/deflate.go.html#4794455">blockStart</a></span><span class="op" id="4795773">:</span><span class="ident" id="4795774"><a href="/gostd/compress/flate/deflate.go.html#4795639">index</a></span><span class="op" id="4795779">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4795783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795787"><a href="/gostd/compress/flate/deflate.go.html#4795597">d</a></span><span class="op" id="4795788">.</span><span class="ident" id="4795789"><a href="/gostd/compress/flate/deflate.go.html#4794455">blockStart</a></span>&nbsp;<span class="op" id="4795800">=</span>&nbsp;<span class="ident" id="4795802"><a href="/gostd/compress/flate/deflate.go.html#4795639">index</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4795810"><a href="/gostd/compress/flate/deflate.go.html#4795597">d</a></span><span class="op" id="4795811">.</span><span class="ident" id="4795812"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4795813">.</span><span class="ident" id="4795814"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4820796">writeBlock</a></span><span class="op" id="4795824">(</span><span class="ident" id="4795825"><a href="/gostd/compress/flate/deflate.go.html#4795623">tokens</a></span><span class="op" id="4795831">,</span>&nbsp;<span class="ident" id="4795833"><a href="/gostd/compress/flate/deflate.go.html#4795650">eof</a></span><span class="op" id="4795836">,</span>&nbsp;<span class="ident" id="4795838"><a href="/gostd/compress/flate/deflate.go.html#4795697">window</a></span><span class="op" id="4795844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795848">return</span>&nbsp;<span class="ident" id="4795855"><a href="/gostd/compress/flate/deflate.go.html#4795597">d</a></span><span class="op" id="4795856">.</span><span class="ident" id="4795857"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4795858">.</span><span class="ident" id="4795859"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4814195">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4795864">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4795867">return</span>&nbsp;<span class="builtintype" id="4795874">nil</span><br>
<span class="lineno"></span><span class="op" id="4795878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4795881">//&nbsp;Try&nbsp;to&nbsp;find&nbsp;a&nbsp;match&nbsp;starting&nbsp;at&nbsp;index&nbsp;whose&nbsp;length&nbsp;is&nbsp;greater&nbsp;than&nbsp;prevSize.</span><br>
<span class="lineno"></span><span class="comment" id="4795961">//&nbsp;We&nbsp;only&nbsp;look&nbsp;at&nbsp;chainCount&nbsp;possibilities&nbsp;before&nbsp;giving&nbsp;up.</span><br>
<span class="lineno">150</span><span class="keyword" id="4796023">func</span>&nbsp;<span class="op" id="4796028">(</span><span class="ident" id="4796029">d</span>&nbsp;<span class="op" id="4796031">*</span><span class="ident" id="4796032"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4796042">)</span>&nbsp;<span class="ident" id="4796044">findMatch</span><span class="op" id="4796053">(</span><span class="ident" id="4796054">pos</span>&nbsp;<span class="builtintype" id="4796058">int</span><span class="op" id="4796061">,</span>&nbsp;<span class="ident" id="4796063">prevHead</span>&nbsp;<span class="builtintype" id="4796072">int</span><span class="op" id="4796075">,</span>&nbsp;<span class="ident" id="4796077">prevLength</span>&nbsp;<span class="builtintype" id="4796088">int</span><span class="op" id="4796091">,</span>&nbsp;<span class="ident" id="4796093">lookahead</span>&nbsp;<span class="builtintype" id="4796103">int</span><span class="op" id="4796106">)</span>&nbsp;<span class="op" id="4796108">(</span><span class="ident" id="4796109">length</span><span class="op" id="4796115">,</span>&nbsp;<span class="ident" id="4796117">offset</span>&nbsp;<span class="builtintype" id="4796124">int</span><span class="op" id="4796127">,</span>&nbsp;<span class="ident" id="4796129">ok</span>&nbsp;<span class="builtintype" id="4796132">bool</span><span class="op" id="4796136">)</span>&nbsp;<span class="op" id="4796138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796141">minMatchLook</span>&nbsp;<span class="op" id="4796154">:=</span>&nbsp;<span class="ident" id="4796157"><a href="/gostd/compress/flate/deflate.go.html#4792633">maxMatchLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4796173">if</span>&nbsp;<span class="ident" id="4796176"><a href="/gostd/compress/flate/deflate.go.html#4796093">lookahead</a></span>&nbsp;<span class="op" id="4796186">&lt;</span>&nbsp;<span class="ident" id="4796188"><a href="/gostd/compress/flate/deflate.go.html#4796141">minMatchLook</a></span>&nbsp;<span class="op" id="4796201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796205"><a href="/gostd/compress/flate/deflate.go.html#4796141">minMatchLook</a></span>&nbsp;<span class="op" id="4796218">=</span>&nbsp;<span class="ident" id="4796220"><a href="/gostd/compress/flate/deflate.go.html#4796093">lookahead</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4796231">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796235">win</span>&nbsp;<span class="op" id="4796239">:=</span>&nbsp;<span class="ident" id="4796242"><a href="/gostd/compress/flate/deflate.go.html#4796029">d</a></span><span class="op" id="4796243">.</span><span class="ident" id="4796244"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4796250">[</span><span class="num" id="4796251">0</span>&nbsp;<span class="op" id="4796253">:</span>&nbsp;<span class="ident" id="4796255"><a href="/gostd/compress/flate/deflate.go.html#4796054">pos</a></span><span class="op" id="4796258">+</span><span class="ident" id="4796259"><a href="/gostd/compress/flate/deflate.go.html#4796141">minMatchLook</a></span><span class="op" id="4796271">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4796275">//&nbsp;We&nbsp;quit&nbsp;when&nbsp;we&nbsp;get&nbsp;a&nbsp;match&nbsp;that&#39;s&nbsp;at&nbsp;least&nbsp;nice&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796333">nice</span>&nbsp;<span class="op" id="4796338">:=</span>&nbsp;<span class="builtinfunc" id="4796341">len</span><span class="op" id="4796344">(</span><span class="ident" id="4796345"><a href="/gostd/compress/flate/deflate.go.html#4796235">win</a></span><span class="op" id="4796348">)</span>&nbsp;<span class="op" id="4796350">-</span>&nbsp;<span class="ident" id="4796352"><a href="/gostd/compress/flate/deflate.go.html#4796054">pos</a></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4796357">if</span>&nbsp;<span class="ident" id="4796360"><a href="/gostd/compress/flate/deflate.go.html#4796029">d</a></span><span class="op" id="4796361">.</span><span class="ident" id="4796362"><a href="/gostd/compress/flate/deflate.go.html#4793228">nice</a></span>&nbsp;<span class="op" id="4796367">&lt;</span>&nbsp;<span class="ident" id="4796369"><a href="/gostd/compress/flate/deflate.go.html#4796333">nice</a></span>&nbsp;<span class="op" id="4796374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796378"><a href="/gostd/compress/flate/deflate.go.html#4796333">nice</a></span>&nbsp;<span class="op" id="4796383">=</span>&nbsp;<span class="ident" id="4796385"><a href="/gostd/compress/flate/deflate.go.html#4796029">d</a></span><span class="op" id="4796386">.</span><span class="ident" id="4796387"><a href="/gostd/compress/flate/deflate.go.html#4793228">nice</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4796393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4796397">//&nbsp;If&nbsp;we&#39;ve&nbsp;got&nbsp;a&nbsp;match&nbsp;that&#39;s&nbsp;good&nbsp;enough,&nbsp;only&nbsp;look&nbsp;in&nbsp;1/4&nbsp;the&nbsp;chain.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796470">tries</span>&nbsp;<span class="op" id="4796476">:=</span>&nbsp;<span class="ident" id="4796479"><a href="/gostd/compress/flate/deflate.go.html#4796029">d</a></span><span class="op" id="4796480">.</span><span class="ident" id="4796481"><a href="/gostd/compress/flate/deflate.go.html#4793234">chain</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796488"><a href="/gostd/compress/flate/deflate.go.html#4796109">length</a></span>&nbsp;<span class="op" id="4796495">=</span>&nbsp;<span class="ident" id="4796497"><a href="/gostd/compress/flate/deflate.go.html#4796077">prevLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4796509">if</span>&nbsp;<span class="ident" id="4796512"><a href="/gostd/compress/flate/deflate.go.html#4796109">length</a></span>&nbsp;<span class="op" id="4796519">&gt;=</span>&nbsp;<span class="ident" id="4796522"><a href="/gostd/compress/flate/deflate.go.html#4796029">d</a></span><span class="op" id="4796523">.</span><span class="ident" id="4796524"><a href="/gostd/compress/flate/deflate.go.html#4793216">good</a></span>&nbsp;<span class="op" id="4796529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796533"><a href="/gostd/compress/flate/deflate.go.html#4796470">tries</a></span>&nbsp;<span class="op" id="4796539">&gt;&gt;=</span>&nbsp;<span class="num" id="4796543">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4796546">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796550">w0</span>&nbsp;<span class="op" id="4796553">:=</span>&nbsp;<span class="ident" id="4796556"><a href="/gostd/compress/flate/deflate.go.html#4796235">win</a></span><span class="op" id="4796559">[</span><span class="ident" id="4796560"><a href="/gostd/compress/flate/deflate.go.html#4796054">pos</a></span><span class="op" id="4796563">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796566">w1</span>&nbsp;<span class="op" id="4796569">:=</span>&nbsp;<span class="ident" id="4796572"><a href="/gostd/compress/flate/deflate.go.html#4796235">win</a></span><span class="op" id="4796575">[</span><span class="ident" id="4796576"><a href="/gostd/compress/flate/deflate.go.html#4796054">pos</a></span><span class="op" id="4796579">+</span><span class="num" id="4796580">1</span><span class="op" id="4796581">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796584">wEnd</span>&nbsp;<span class="op" id="4796589">:=</span>&nbsp;<span class="ident" id="4796592"><a href="/gostd/compress/flate/deflate.go.html#4796235">win</a></span><span class="op" id="4796595">[</span><span class="ident" id="4796596"><a href="/gostd/compress/flate/deflate.go.html#4796054">pos</a></span><span class="op" id="4796599">+</span><span class="ident" id="4796600"><a href="/gostd/compress/flate/deflate.go.html#4796109">length</a></span><span class="op" id="4796606">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796609">minIndex</span>&nbsp;<span class="op" id="4796618">:=</span>&nbsp;<span class="ident" id="4796621"><a href="/gostd/compress/flate/deflate.go.html#4796054">pos</a></span>&nbsp;<span class="op" id="4796625">-</span>&nbsp;<span class="ident" id="4796627"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4796640">for</span>&nbsp;<span class="ident" id="4796644">i</span>&nbsp;<span class="op" id="4796646">:=</span>&nbsp;<span class="ident" id="4796649"><a href="/gostd/compress/flate/deflate.go.html#4796063">prevHead</a></span><span class="op" id="4796657">;</span>&nbsp;<span class="ident" id="4796659"><a href="/gostd/compress/flate/deflate.go.html#4796470">tries</a></span>&nbsp;<span class="op" id="4796665">&gt;</span>&nbsp;<span class="num" id="4796667">0</span><span class="op" id="4796668">;</span>&nbsp;<span class="ident" id="4796670"><a href="/gostd/compress/flate/deflate.go.html#4796470">tries</a></span><span class="op" id="4796675">--</span>&nbsp;<span class="op" id="4796678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4796682">if</span>&nbsp;<span class="ident" id="4796685"><a href="/gostd/compress/flate/deflate.go.html#4796550">w0</a></span>&nbsp;<span class="op" id="4796688">==</span>&nbsp;<span class="ident" id="4796691"><a href="/gostd/compress/flate/deflate.go.html#4796235">win</a></span><span class="op" id="4796694">[</span><span class="ident" id="4796695"><a href="/gostd/compress/flate/deflate.go.html#4796644">i</a></span><span class="op" id="4796696">]</span>&nbsp;<span class="op" id="4796698">&amp;&amp;</span>&nbsp;<span class="ident" id="4796701"><a href="/gostd/compress/flate/deflate.go.html#4796566">w1</a></span>&nbsp;<span class="op" id="4796704">==</span>&nbsp;<span class="ident" id="4796707"><a href="/gostd/compress/flate/deflate.go.html#4796235">win</a></span><span class="op" id="4796710">[</span><span class="ident" id="4796711"><a href="/gostd/compress/flate/deflate.go.html#4796644">i</a></span><span class="op" id="4796712">+</span><span class="num" id="4796713">1</span><span class="op" id="4796714">]</span>&nbsp;<span class="op" id="4796716">&amp;&amp;</span>&nbsp;<span class="ident" id="4796719"><a href="/gostd/compress/flate/deflate.go.html#4796584">wEnd</a></span>&nbsp;<span class="op" id="4796724">==</span>&nbsp;<span class="ident" id="4796727"><a href="/gostd/compress/flate/deflate.go.html#4796235">win</a></span><span class="op" id="4796730">[</span><span class="ident" id="4796731"><a href="/gostd/compress/flate/deflate.go.html#4796644">i</a></span><span class="op" id="4796732">+</span><span class="ident" id="4796733"><a href="/gostd/compress/flate/deflate.go.html#4796109">length</a></span><span class="op" id="4796739">]</span>&nbsp;<span class="op" id="4796741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4796746">//&nbsp;The&nbsp;hash&nbsp;function&nbsp;ensures&nbsp;that&nbsp;if&nbsp;win[i]&nbsp;and&nbsp;win[i+1]&nbsp;match,&nbsp;win[i+2]&nbsp;matches</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796831">n</span>&nbsp;<span class="op" id="4796833">:=</span>&nbsp;<span class="num" id="4796836">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4796841">for</span>&nbsp;<span class="ident" id="4796845"><a href="/gostd/compress/flate/deflate.go.html#4796054">pos</a></span><span class="op" id="4796848">+</span><span class="ident" id="4796849"><a href="/gostd/compress/flate/deflate.go.html#4796831">n</a></span>&nbsp;<span class="op" id="4796851">&lt;</span>&nbsp;<span class="builtinfunc" id="4796853">len</span><span class="op" id="4796856">(</span><span class="ident" id="4796857"><a href="/gostd/compress/flate/deflate.go.html#4796235">win</a></span><span class="op" id="4796860">)</span>&nbsp;<span class="op" id="4796862">&amp;&amp;</span>&nbsp;<span class="ident" id="4796865"><a href="/gostd/compress/flate/deflate.go.html#4796235">win</a></span><span class="op" id="4796868">[</span><span class="ident" id="4796869"><a href="/gostd/compress/flate/deflate.go.html#4796644">i</a></span><span class="op" id="4796870">+</span><span class="ident" id="4796871"><a href="/gostd/compress/flate/deflate.go.html#4796831">n</a></span><span class="op" id="4796872">]</span>&nbsp;<span class="op" id="4796874">==</span>&nbsp;<span class="ident" id="4796877"><a href="/gostd/compress/flate/deflate.go.html#4796235">win</a></span><span class="op" id="4796880">[</span><span class="ident" id="4796881"><a href="/gostd/compress/flate/deflate.go.html#4796054">pos</a></span><span class="op" id="4796884">+</span><span class="ident" id="4796885"><a href="/gostd/compress/flate/deflate.go.html#4796831">n</a></span><span class="op" id="4796886">]</span>&nbsp;<span class="op" id="4796888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796894"><a href="/gostd/compress/flate/deflate.go.html#4796831">n</a></span><span class="op" id="4796895">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4796901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4796906">if</span>&nbsp;<span class="ident" id="4796909"><a href="/gostd/compress/flate/deflate.go.html#4796831">n</a></span>&nbsp;<span class="op" id="4796911">&gt;</span>&nbsp;<span class="ident" id="4796913"><a href="/gostd/compress/flate/deflate.go.html#4796109">length</a></span>&nbsp;<span class="op" id="4796920">&amp;&amp;</span>&nbsp;<span class="op" id="4796923">(</span><span class="ident" id="4796924"><a href="/gostd/compress/flate/deflate.go.html#4796831">n</a></span>&nbsp;<span class="op" id="4796926">&gt;</span>&nbsp;<span class="num" id="4796928">3</span>&nbsp;<span class="op" id="4796930">||</span>&nbsp;<span class="ident" id="4796933"><a href="/gostd/compress/flate/deflate.go.html#4796054">pos</a></span><span class="op" id="4796936">-</span><span class="ident" id="4796937"><a href="/gostd/compress/flate/deflate.go.html#4796644">i</a></span>&nbsp;<span class="op" id="4796939">&lt;=</span>&nbsp;<span class="num" id="4796942">4096</span><span class="op" id="4796946">)</span>&nbsp;<span class="op" id="4796948">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796954"><a href="/gostd/compress/flate/deflate.go.html#4796109">length</a></span>&nbsp;<span class="op" id="4796961">=</span>&nbsp;<span class="ident" id="4796963"><a href="/gostd/compress/flate/deflate.go.html#4796831">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796969"><a href="/gostd/compress/flate/deflate.go.html#4796117">offset</a></span>&nbsp;<span class="op" id="4796976">=</span>&nbsp;<span class="ident" id="4796978"><a href="/gostd/compress/flate/deflate.go.html#4796054">pos</a></span>&nbsp;<span class="op" id="4796982">-</span>&nbsp;<span class="ident" id="4796984"><a href="/gostd/compress/flate/deflate.go.html#4796644">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4796990"><a href="/gostd/compress/flate/deflate.go.html#4796129">ok</a></span>&nbsp;<span class="op" id="4796993">=</span>&nbsp;<span class="builtintype" id="4796995">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4797004">if</span>&nbsp;<span class="ident" id="4797007"><a href="/gostd/compress/flate/deflate.go.html#4796831">n</a></span>&nbsp;<span class="op" id="4797009">&gt;=</span>&nbsp;<span class="ident" id="4797012"><a href="/gostd/compress/flate/deflate.go.html#4796333">nice</a></span>&nbsp;<span class="op" id="4797017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4797024">//&nbsp;The&nbsp;match&nbsp;is&nbsp;good&nbsp;enough&nbsp;that&nbsp;we&nbsp;don&#39;t&nbsp;try&nbsp;to&nbsp;find&nbsp;a&nbsp;better&nbsp;one.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4797097">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4797107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797113"><a href="/gostd/compress/flate/deflate.go.html#4796584">wEnd</a></span>&nbsp;<span class="op" id="4797118">=</span>&nbsp;<span class="ident" id="4797120"><a href="/gostd/compress/flate/deflate.go.html#4796235">win</a></span><span class="op" id="4797123">[</span><span class="ident" id="4797124"><a href="/gostd/compress/flate/deflate.go.html#4796054">pos</a></span><span class="op" id="4797127">+</span><span class="ident" id="4797128"><a href="/gostd/compress/flate/deflate.go.html#4796831">n</a></span><span class="op" id="4797129">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4797134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4797138">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4797142">if</span>&nbsp;<span class="ident" id="4797145"><a href="/gostd/compress/flate/deflate.go.html#4796644">i</a></span>&nbsp;<span class="op" id="4797147">==</span>&nbsp;<span class="ident" id="4797150"><a href="/gostd/compress/flate/deflate.go.html#4796609">minIndex</a></span>&nbsp;<span class="op" id="4797159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4797164">//&nbsp;hashPrev[i&nbsp;&amp;&nbsp;windowMask]&nbsp;has&nbsp;already&nbsp;been&nbsp;overwritten,&nbsp;so&nbsp;stop&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4797238">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4797246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4797250">if</span>&nbsp;<span class="ident" id="4797253"><a href="/gostd/compress/flate/deflate.go.html#4796644">i</a></span>&nbsp;<span class="op" id="4797255">=</span>&nbsp;<span class="ident" id="4797257"><a href="/gostd/compress/flate/deflate.go.html#4796029">d</a></span><span class="op" id="4797258">.</span><span class="ident" id="4797259"><a href="/gostd/compress/flate/deflate.go.html#4794298">hashPrev</a></span><span class="op" id="4797267">[</span><span class="ident" id="4797268"><a href="/gostd/compress/flate/deflate.go.html#4796644">i</a></span><span class="op" id="4797269">&amp;</span><span class="ident" id="4797270"><a href="/gostd/compress/flate/deflate.go.html#4792472">windowMask</a></span><span class="op" id="4797280">]</span>&nbsp;<span class="op" id="4797282">-</span>&nbsp;<span class="ident" id="4797284"><a href="/gostd/compress/flate/deflate.go.html#4796029">d</a></span><span class="op" id="4797285">.</span><span class="ident" id="4797286"><a href="/gostd/compress/flate/deflate.go.html#4794316">hashOffset</a></span><span class="op" id="4797296">;</span>&nbsp;<span class="ident" id="4797298"><a href="/gostd/compress/flate/deflate.go.html#4796644">i</a></span>&nbsp;<span class="op" id="4797300">&lt;</span>&nbsp;<span class="ident" id="4797302"><a href="/gostd/compress/flate/deflate.go.html#4796609">minIndex</a></span>&nbsp;<span class="op" id="4797311">||</span>&nbsp;<span class="ident" id="4797314"><a href="/gostd/compress/flate/deflate.go.html#4796644">i</a></span>&nbsp;<span class="op" id="4797316">&lt;</span>&nbsp;<span class="num" id="4797318">0</span>&nbsp;<span class="op" id="4797320">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4797325">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4797333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4797336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4797339">return</span><br>
<span class="lineno"></span><span class="op" id="4797346">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="4797349">func</span>&nbsp;<span class="op" id="4797354">(</span><span class="ident" id="4797355">d</span>&nbsp;<span class="op" id="4797357">*</span><span class="ident" id="4797358"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4797368">)</span>&nbsp;<span class="ident" id="4797370">writeStoredBlock</span><span class="op" id="4797386">(</span><span class="ident" id="4797387">buf</span>&nbsp;<span class="op" id="4797391">[</span><span class="op" id="4797392">]</span><span class="builtintype" id="4797393">byte</span><span class="op" id="4797397">)</span>&nbsp;<span class="builtintype" id="4797399">error</span>&nbsp;<span class="op" id="4797405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4797408">if</span>&nbsp;<span class="ident" id="4797411"><a href="/gostd/compress/flate/deflate.go.html#4797355">d</a></span><span class="op" id="4797412">.</span><span class="ident" id="4797413"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4797414">.</span><span class="ident" id="4797415"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4820333">writeStoredHeader</a></span><span class="op" id="4797432">(</span><span class="builtinfunc" id="4797433">len</span><span class="op" id="4797436">(</span><span class="ident" id="4797437"><a href="/gostd/compress/flate/deflate.go.html#4797387">buf</a></span><span class="op" id="4797440">)</span><span class="op" id="4797441">,</span>&nbsp;<span class="builtintype" id="4797443">false</span><span class="op" id="4797448">)</span><span class="op" id="4797449">;</span>&nbsp;<span class="ident" id="4797451"><a href="/gostd/compress/flate/deflate.go.html#4797355">d</a></span><span class="op" id="4797452">.</span><span class="ident" id="4797453"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4797454">.</span><span class="ident" id="4797455"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4814195">err</a></span>&nbsp;<span class="op" id="4797459">!=</span>&nbsp;<span class="builtintype" id="4797462">nil</span>&nbsp;<span class="op" id="4797466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4797470">return</span>&nbsp;<span class="ident" id="4797477"><a href="/gostd/compress/flate/deflate.go.html#4797355">d</a></span><span class="op" id="4797478">.</span><span class="ident" id="4797479"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4797480">.</span><span class="ident" id="4797481"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4814195">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4797486">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797489"><a href="/gostd/compress/flate/deflate.go.html#4797355">d</a></span><span class="op" id="4797490">.</span><span class="ident" id="4797491"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4797492">.</span><span class="ident" id="4797493"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4816016">writeBytes</a></span><span class="op" id="4797503">(</span><span class="ident" id="4797504"><a href="/gostd/compress/flate/deflate.go.html#4797387">buf</a></span><span class="op" id="4797507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4797510">return</span>&nbsp;<span class="ident" id="4797517"><a href="/gostd/compress/flate/deflate.go.html#4797355">d</a></span><span class="op" id="4797518">.</span><span class="ident" id="4797519"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4797520">.</span><span class="ident" id="4797521"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4814195">err</a></span><br>
<span class="lineno"></span><span class="op" id="4797525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4797528">func</span>&nbsp;<span class="op" id="4797533">(</span><span class="ident" id="4797534">d</span>&nbsp;<span class="op" id="4797536">*</span><span class="ident" id="4797537"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4797547">)</span>&nbsp;<span class="ident" id="4797549">initDeflate</span><span class="op" id="4797560">(</span><span class="op" id="4797561">)</span>&nbsp;<span class="op" id="4797563">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797566"><a href="/gostd/compress/flate/deflate.go.html#4797534">d</a></span><span class="op" id="4797567">.</span><span class="ident" id="4797568"><a href="/gostd/compress/flate/deflate.go.html#4794280">hashHead</a></span>&nbsp;<span class="op" id="4797577">=</span>&nbsp;<span class="builtinfunc" id="4797579">make</span><span class="op" id="4797583">(</span><span class="op" id="4797584">[</span><span class="op" id="4797585">]</span><span class="builtintype" id="4797586">int</span><span class="op" id="4797589">,</span>&nbsp;<span class="ident" id="4797591"><a href="/gostd/compress/flate/deflate.go.html#4792971">hashSize</a></span><span class="op" id="4797599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797602"><a href="/gostd/compress/flate/deflate.go.html#4797534">d</a></span><span class="op" id="4797603">.</span><span class="ident" id="4797604"><a href="/gostd/compress/flate/deflate.go.html#4794298">hashPrev</a></span>&nbsp;<span class="op" id="4797613">=</span>&nbsp;<span class="builtinfunc" id="4797615">make</span><span class="op" id="4797619">(</span><span class="op" id="4797620">[</span><span class="op" id="4797621">]</span><span class="builtintype" id="4797622">int</span><span class="op" id="4797625">,</span>&nbsp;<span class="ident" id="4797627"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span><span class="op" id="4797637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797640"><a href="/gostd/compress/flate/deflate.go.html#4797534">d</a></span><span class="op" id="4797641">.</span><span class="ident" id="4797642"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span>&nbsp;<span class="op" id="4797649">=</span>&nbsp;<span class="builtinfunc" id="4797651">make</span><span class="op" id="4797655">(</span><span class="op" id="4797656">[</span><span class="op" id="4797657">]</span><span class="builtintype" id="4797658">byte</span><span class="op" id="4797662">,</span>&nbsp;<span class="num" id="4797664">2</span><span class="op" id="4797665">*</span><span class="ident" id="4797666"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span><span class="op" id="4797676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797679"><a href="/gostd/compress/flate/deflate.go.html#4797534">d</a></span><span class="op" id="4797680">.</span><span class="ident" id="4797681"><a href="/gostd/compress/flate/deflate.go.html#4794316">hashOffset</a></span>&nbsp;<span class="op" id="4797692">=</span>&nbsp;<span class="num" id="4797694">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797697"><a href="/gostd/compress/flate/deflate.go.html#4797534">d</a></span><span class="op" id="4797698">.</span><span class="ident" id="4797699"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span>&nbsp;<span class="op" id="4797706">=</span>&nbsp;<span class="builtinfunc" id="4797708">make</span><span class="op" id="4797712">(</span><span class="op" id="4797713">[</span><span class="op" id="4797714">]</span><span class="ident" id="4797715"><a href="/gostd/compress/flate/token.go.html#4856145">token</a></span><span class="op" id="4797720">,</span>&nbsp;<span class="num" id="4797722">0</span><span class="op" id="4797723">,</span>&nbsp;<span class="ident" id="4797725"><a href="/gostd/compress/flate/deflate.go.html#4792885">maxFlateBlockTokens</a></span><span class="op" id="4797744">+</span><span class="num" id="4797745">1</span><span class="op" id="4797746">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797749"><a href="/gostd/compress/flate/deflate.go.html#4797534">d</a></span><span class="op" id="4797750">.</span><span class="ident" id="4797751"><a href="/gostd/compress/flate/deflate.go.html#4794650">length</a></span>&nbsp;<span class="op" id="4797758">=</span>&nbsp;<span class="ident" id="4797760"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span>&nbsp;<span class="op" id="4797775">-</span>&nbsp;<span class="num" id="4797777">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797780"><a href="/gostd/compress/flate/deflate.go.html#4797534">d</a></span><span class="op" id="4797781">.</span><span class="ident" id="4797782"><a href="/gostd/compress/flate/deflate.go.html#4794670">offset</a></span>&nbsp;<span class="op" id="4797789">=</span>&nbsp;<span class="num" id="4797791">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797794"><a href="/gostd/compress/flate/deflate.go.html#4797534">d</a></span><span class="op" id="4797795">.</span><span class="ident" id="4797796"><a href="/gostd/compress/flate/deflate.go.html#4794518">byteAvailable</a></span>&nbsp;<span class="op" id="4797810">=</span>&nbsp;<span class="builtintype" id="4797812">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797819"><a href="/gostd/compress/flate/deflate.go.html#4797534">d</a></span><span class="op" id="4797820">.</span><span class="ident" id="4797821"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4797827">=</span>&nbsp;<span class="num" id="4797829">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797832"><a href="/gostd/compress/flate/deflate.go.html#4797534">d</a></span><span class="op" id="4797833">.</span><span class="ident" id="4797834"><a href="/gostd/compress/flate/deflate.go.html#4794690">hash</a></span>&nbsp;<span class="op" id="4797839">=</span>&nbsp;<span class="num" id="4797841">0</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797844"><a href="/gostd/compress/flate/deflate.go.html#4797534">d</a></span><span class="op" id="4797845">.</span><span class="ident" id="4797846"><a href="/gostd/compress/flate/deflate.go.html#4794264">chainHead</a></span>&nbsp;<span class="op" id="4797856">=</span>&nbsp;<span class="op" id="4797858">-</span><span class="num" id="4797859">1</span><br>
<span class="lineno"></span><span class="op" id="4797861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4797864">func</span>&nbsp;<span class="op" id="4797869">(</span><span class="ident" id="4797870">d</span>&nbsp;<span class="op" id="4797872">*</span><span class="ident" id="4797873"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4797883">)</span>&nbsp;<span class="ident" id="4797885">deflate</span><span class="op" id="4797892">(</span><span class="op" id="4797893">)</span>&nbsp;<span class="op" id="4797895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4797898">if</span>&nbsp;<span class="ident" id="4797901"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4797902">.</span><span class="ident" id="4797903"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span><span class="op" id="4797912">-</span><span class="ident" id="4797913"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4797914">.</span><span class="ident" id="4797915"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4797921">&lt;</span>&nbsp;<span class="ident" id="4797923"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span><span class="op" id="4797937">+</span><span class="ident" id="4797938"><a href="/gostd/compress/flate/deflate.go.html#4792633">maxMatchLength</a></span>&nbsp;<span class="op" id="4797953">&amp;&amp;</span>&nbsp;<span class="op" id="4797956">!</span><span class="ident" id="4797957"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4797958">.</span><span class="ident" id="4797959"><a href="/gostd/compress/flate/deflate.go.html#4793932">sync</a></span>&nbsp;<span class="op" id="4797964">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4797968">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4797976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4797980"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4797981">.</span><span class="ident" id="4797982"><a href="/gostd/compress/flate/deflate.go.html#4794710">maxInsertIndex</a></span>&nbsp;<span class="op" id="4797997">=</span>&nbsp;<span class="ident" id="4797999"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798000">.</span><span class="ident" id="4798001"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span>&nbsp;<span class="op" id="4798011">-</span>&nbsp;<span class="op" id="4798013">(</span><span class="ident" id="4798014"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span>&nbsp;<span class="op" id="4798029">-</span>&nbsp;<span class="num" id="4798031">1</span><span class="op" id="4798032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798035">if</span>&nbsp;<span class="ident" id="4798038"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798039">.</span><span class="ident" id="4798040"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4798046">&lt;</span>&nbsp;<span class="ident" id="4798048"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798049">.</span><span class="ident" id="4798050"><a href="/gostd/compress/flate/deflate.go.html#4794710">maxInsertIndex</a></span>&nbsp;<span class="op" id="4798065">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4798069"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798070">.</span><span class="ident" id="4798071"><a href="/gostd/compress/flate/deflate.go.html#4794690">hash</a></span>&nbsp;<span class="op" id="4798076">=</span>&nbsp;<span class="builtintype" id="4798078">int</span><span class="op" id="4798081">(</span><span class="ident" id="4798082"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798083">.</span><span class="ident" id="4798084"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4798090">[</span><span class="ident" id="4798091"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798092">.</span><span class="ident" id="4798093"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4798098">]</span><span class="op" id="4798099">)</span><span class="op" id="4798100">&lt;&lt;</span><span class="ident" id="4798102"><a href="/gostd/compress/flate/deflate.go.html#4793051">hashShift</a></span>&nbsp;<span class="op" id="4798112">+</span>&nbsp;<span class="builtintype" id="4798114">int</span><span class="op" id="4798117">(</span><span class="ident" id="4798118"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798119">.</span><span class="ident" id="4798120"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4798126">[</span><span class="ident" id="4798127"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798128">.</span><span class="ident" id="4798129"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4798134">+</span><span class="num" id="4798135">1</span><span class="op" id="4798136">]</span><span class="op" id="4798137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4798140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="4798143">Loop</span><span class="op" id="4798147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798150">for</span>&nbsp;<span class="op" id="4798154">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798158">if</span>&nbsp;<span class="ident" id="4798161"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798162">.</span><span class="ident" id="4798163"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4798169">&gt;</span>&nbsp;<span class="ident" id="4798171"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798172">.</span><span class="ident" id="4798173"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span>&nbsp;<span class="op" id="4798183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4798188">panic</span><span class="op" id="4798193">(</span><span class="string" id="4798194">&#34;index&nbsp;&gt;&nbsp;windowEnd&#34;</span><span class="op" id="4798213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4798217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4798221">lookahead</span>&nbsp;<span class="op" id="4798231">:=</span>&nbsp;<span class="ident" id="4798234"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798235">.</span><span class="ident" id="4798236"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span>&nbsp;<span class="op" id="4798246">-</span>&nbsp;<span class="ident" id="4798248"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798249">.</span><span class="ident" id="4798250"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798258">if</span>&nbsp;<span class="ident" id="4798261"><a href="/gostd/compress/flate/deflate.go.html#4798221">lookahead</a></span>&nbsp;<span class="op" id="4798271">&lt;</span>&nbsp;<span class="ident" id="4798273"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span><span class="op" id="4798287">+</span><span class="ident" id="4798288"><a href="/gostd/compress/flate/deflate.go.html#4792633">maxMatchLength</a></span>&nbsp;<span class="op" id="4798303">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798308">if</span>&nbsp;<span class="op" id="4798311">!</span><span class="ident" id="4798312"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798313">.</span><span class="ident" id="4798314"><a href="/gostd/compress/flate/deflate.go.html#4793932">sync</a></span>&nbsp;<span class="op" id="4798319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798325">break</span>&nbsp;<span class="ident" id="4798331"><a href="/gostd/compress/flate/deflate.go.html#4798143">Loop</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4798339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798344">if</span>&nbsp;<span class="ident" id="4798347"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798348">.</span><span class="ident" id="4798349"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4798355">&gt;</span>&nbsp;<span class="ident" id="4798357"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798358">.</span><span class="ident" id="4798359"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span>&nbsp;<span class="op" id="4798369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4798375">panic</span><span class="op" id="4798380">(</span><span class="string" id="4798381">&#34;index&nbsp;&gt;&nbsp;windowEnd&#34;</span><span class="op" id="4798400">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4798405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798410">if</span>&nbsp;<span class="ident" id="4798413"><a href="/gostd/compress/flate/deflate.go.html#4798221">lookahead</a></span>&nbsp;<span class="op" id="4798423">==</span>&nbsp;<span class="num" id="4798426">0</span>&nbsp;<span class="op" id="4798428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4798434">//&nbsp;Flush&nbsp;current&nbsp;output&nbsp;block&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798476">if</span>&nbsp;<span class="ident" id="4798479"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798480">.</span><span class="ident" id="4798481"><a href="/gostd/compress/flate/deflate.go.html#4794518">byteAvailable</a></span>&nbsp;<span class="op" id="4798495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4798502">//&nbsp;There&nbsp;is&nbsp;still&nbsp;one&nbsp;pending&nbsp;token&nbsp;that&nbsp;needs&nbsp;to&nbsp;be&nbsp;flushed</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4798568"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798569">.</span><span class="ident" id="4798570"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span>&nbsp;<span class="op" id="4798577">=</span>&nbsp;<span class="builtinfunc" id="4798579">append</span><span class="op" id="4798585">(</span><span class="ident" id="4798586"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798587">.</span><span class="ident" id="4798588"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4798594">,</span>&nbsp;<span class="ident" id="4798596"><a href="/gostd/compress/flate/token.go.html#4856207">literalToken</a></span><span class="op" id="4798608">(</span><span class="builtintype" id="4798609">uint32</span><span class="op" id="4798615">(</span><span class="ident" id="4798616"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798617">.</span><span class="ident" id="4798618"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4798624">[</span><span class="ident" id="4798625"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798626">.</span><span class="ident" id="4798627"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4798632">-</span><span class="num" id="4798633">1</span><span class="op" id="4798634">]</span><span class="op" id="4798635">)</span><span class="op" id="4798636">)</span><span class="op" id="4798637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4798644"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798645">.</span><span class="ident" id="4798646"><a href="/gostd/compress/flate/deflate.go.html#4794518">byteAvailable</a></span>&nbsp;<span class="op" id="4798660">=</span>&nbsp;<span class="builtintype" id="4798662">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4798672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798678">if</span>&nbsp;<span class="builtinfunc" id="4798681">len</span><span class="op" id="4798684">(</span><span class="ident" id="4798685"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798686">.</span><span class="ident" id="4798687"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4798693">)</span>&nbsp;<span class="op" id="4798695">&gt;</span>&nbsp;<span class="num" id="4798697">0</span>&nbsp;<span class="op" id="4798699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798706">if</span>&nbsp;<span class="ident" id="4798709"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798710">.</span><span class="ident" id="4798711"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span>&nbsp;<span class="op" id="4798715">=</span>&nbsp;<span class="ident" id="4798717"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798718">.</span><span class="ident" id="4798719"><a href="/gostd/compress/flate/deflate.go.html#4795612">writeBlock</a></span><span class="op" id="4798729">(</span><span class="ident" id="4798730"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798731">.</span><span class="ident" id="4798732"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4798738">,</span>&nbsp;<span class="ident" id="4798740"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798741">.</span><span class="ident" id="4798742"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4798747">,</span>&nbsp;<span class="builtintype" id="4798749">false</span><span class="op" id="4798754">)</span><span class="op" id="4798755">;</span>&nbsp;<span class="ident" id="4798757"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798758">.</span><span class="ident" id="4798759"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span>&nbsp;<span class="op" id="4798763">!=</span>&nbsp;<span class="builtintype" id="4798766">nil</span>&nbsp;<span class="op" id="4798770">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798778">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4798790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4798797"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798798">.</span><span class="ident" id="4798799"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span>&nbsp;<span class="op" id="4798806">=</span>&nbsp;<span class="ident" id="4798808"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798809">.</span><span class="ident" id="4798810"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4798816">[</span><span class="op" id="4798817">:</span><span class="num" id="4798818">0</span><span class="op" id="4798819">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4798825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798831">break</span>&nbsp;<span class="ident" id="4798837"><a href="/gostd/compress/flate/deflate.go.html#4798143">Loop</a></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4798845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4798849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4798853">if</span>&nbsp;<span class="ident" id="4798856"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798857">.</span><span class="ident" id="4798858"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4798864">&lt;</span>&nbsp;<span class="ident" id="4798866"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798867">.</span><span class="ident" id="4798868"><a href="/gostd/compress/flate/deflate.go.html#4794710">maxInsertIndex</a></span>&nbsp;<span class="op" id="4798883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4798888">//&nbsp;Update&nbsp;the&nbsp;hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4798910"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798911">.</span><span class="ident" id="4798912"><a href="/gostd/compress/flate/deflate.go.html#4794690">hash</a></span>&nbsp;<span class="op" id="4798917">=</span>&nbsp;<span class="op" id="4798919">(</span><span class="ident" id="4798920"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798921">.</span><span class="ident" id="4798922"><a href="/gostd/compress/flate/deflate.go.html#4794690">hash</a></span><span class="op" id="4798926">&lt;&lt;</span><span class="ident" id="4798928"><a href="/gostd/compress/flate/deflate.go.html#4793051">hashShift</a></span>&nbsp;<span class="op" id="4798938">+</span>&nbsp;<span class="builtintype" id="4798940">int</span><span class="op" id="4798943">(</span><span class="ident" id="4798944"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798945">.</span><span class="ident" id="4798946"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4798952">[</span><span class="ident" id="4798953"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798954">.</span><span class="ident" id="4798955"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4798960">+</span><span class="num" id="4798961">2</span><span class="op" id="4798962">]</span><span class="op" id="4798963">)</span><span class="op" id="4798964">)</span>&nbsp;<span class="op" id="4798966">&amp;</span>&nbsp;<span class="ident" id="4798968"><a href="/gostd/compress/flate/deflate.go.html#4793008">hashMask</a></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4798980"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798981">.</span><span class="ident" id="4798982"><a href="/gostd/compress/flate/deflate.go.html#4794264">chainHead</a></span>&nbsp;<span class="op" id="4798992">=</span>&nbsp;<span class="ident" id="4798994"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4798995">.</span><span class="ident" id="4798996"><a href="/gostd/compress/flate/deflate.go.html#4794280">hashHead</a></span><span class="op" id="4799004">[</span><span class="ident" id="4799005"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799006">.</span><span class="ident" id="4799007"><a href="/gostd/compress/flate/deflate.go.html#4794690">hash</a></span><span class="op" id="4799011">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799016"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799017">.</span><span class="ident" id="4799018"><a href="/gostd/compress/flate/deflate.go.html#4794298">hashPrev</a></span><span class="op" id="4799026">[</span><span class="ident" id="4799027"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799028">.</span><span class="ident" id="4799029"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4799034">&amp;</span><span class="ident" id="4799035"><a href="/gostd/compress/flate/deflate.go.html#4792472">windowMask</a></span><span class="op" id="4799045">]</span>&nbsp;<span class="op" id="4799047">=</span>&nbsp;<span class="ident" id="4799049"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799050">.</span><span class="ident" id="4799051"><a href="/gostd/compress/flate/deflate.go.html#4794264">chainHead</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799064"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799065">.</span><span class="ident" id="4799066"><a href="/gostd/compress/flate/deflate.go.html#4794280">hashHead</a></span><span class="op" id="4799074">[</span><span class="ident" id="4799075"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799076">.</span><span class="ident" id="4799077"><a href="/gostd/compress/flate/deflate.go.html#4794690">hash</a></span><span class="op" id="4799081">]</span>&nbsp;<span class="op" id="4799083">=</span>&nbsp;<span class="ident" id="4799085"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799086">.</span><span class="ident" id="4799087"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4799093">+</span>&nbsp;<span class="ident" id="4799095"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799096">.</span><span class="ident" id="4799097"><a href="/gostd/compress/flate/deflate.go.html#4794316">hashOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4799110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799114">prevLength</span>&nbsp;<span class="op" id="4799125">:=</span>&nbsp;<span class="ident" id="4799128"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799129">.</span><span class="ident" id="4799130"><a href="/gostd/compress/flate/deflate.go.html#4794650">length</a></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799139">prevOffset</span>&nbsp;<span class="op" id="4799150">:=</span>&nbsp;<span class="ident" id="4799153"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799154">.</span><span class="ident" id="4799155"><a href="/gostd/compress/flate/deflate.go.html#4794670">offset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799164"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799165">.</span><span class="ident" id="4799166"><a href="/gostd/compress/flate/deflate.go.html#4794650">length</a></span>&nbsp;<span class="op" id="4799173">=</span>&nbsp;<span class="ident" id="4799175"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span>&nbsp;<span class="op" id="4799190">-</span>&nbsp;<span class="num" id="4799192">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799196"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799197">.</span><span class="ident" id="4799198"><a href="/gostd/compress/flate/deflate.go.html#4794670">offset</a></span>&nbsp;<span class="op" id="4799205">=</span>&nbsp;<span class="num" id="4799207">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799211">minIndex</span>&nbsp;<span class="op" id="4799220">:=</span>&nbsp;<span class="ident" id="4799223"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799224">.</span><span class="ident" id="4799225"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4799231">-</span>&nbsp;<span class="ident" id="4799233"><a href="/gostd/compress/flate/deflate.go.html#4792431">windowSize</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4799246">if</span>&nbsp;<span class="ident" id="4799249"><a href="/gostd/compress/flate/deflate.go.html#4799211">minIndex</a></span>&nbsp;<span class="op" id="4799258">&lt;</span>&nbsp;<span class="num" id="4799260">0</span>&nbsp;<span class="op" id="4799262">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799267"><a href="/gostd/compress/flate/deflate.go.html#4799211">minIndex</a></span>&nbsp;<span class="op" id="4799276">=</span>&nbsp;<span class="num" id="4799278">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4799282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4799287">if</span>&nbsp;<span class="ident" id="4799290"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799291">.</span><span class="ident" id="4799292"><a href="/gostd/compress/flate/deflate.go.html#4794264">chainHead</a></span><span class="op" id="4799301">-</span><span class="ident" id="4799302"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799303">.</span><span class="ident" id="4799304"><a href="/gostd/compress/flate/deflate.go.html#4794316">hashOffset</a></span>&nbsp;<span class="op" id="4799315">&gt;=</span>&nbsp;<span class="ident" id="4799318"><a href="/gostd/compress/flate/deflate.go.html#4799211">minIndex</a></span>&nbsp;<span class="op" id="4799327">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4799333">(</span><span class="ident" id="4799334"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799335">.</span><span class="ident" id="4799336"><a href="/gostd/compress/flate/deflate.go.html#4793241">fastSkipHashing</a></span>&nbsp;<span class="op" id="4799352">!=</span>&nbsp;<span class="ident" id="4799355"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span>&nbsp;<span class="op" id="4799365">&amp;&amp;</span>&nbsp;<span class="ident" id="4799368"><a href="/gostd/compress/flate/deflate.go.html#4798221">lookahead</a></span>&nbsp;<span class="op" id="4799378">&gt;</span>&nbsp;<span class="ident" id="4799380"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span><span class="op" id="4799394">-</span><span class="num" id="4799395">1</span>&nbsp;<span class="op" id="4799397">||</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799404"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799405">.</span><span class="ident" id="4799406"><a href="/gostd/compress/flate/deflate.go.html#4793241">fastSkipHashing</a></span>&nbsp;<span class="op" id="4799422">==</span>&nbsp;<span class="ident" id="4799425"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span>&nbsp;<span class="op" id="4799435">&amp;&amp;</span>&nbsp;<span class="ident" id="4799438"><a href="/gostd/compress/flate/deflate.go.html#4798221">lookahead</a></span>&nbsp;<span class="op" id="4799448">&gt;</span>&nbsp;<span class="ident" id="4799450"><a href="/gostd/compress/flate/deflate.go.html#4799114">prevLength</a></span>&nbsp;<span class="op" id="4799461">&amp;&amp;</span>&nbsp;<span class="ident" id="4799464"><a href="/gostd/compress/flate/deflate.go.html#4799114">prevLength</a></span>&nbsp;<span class="op" id="4799475">&lt;</span>&nbsp;<span class="ident" id="4799477"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799478">.</span><span class="ident" id="4799479"><a href="/gostd/compress/flate/deflate.go.html#4793222">lazy</a></span><span class="op" id="4799483">)</span>&nbsp;<span class="op" id="4799485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4799490">if</span>&nbsp;<span class="ident" id="4799493">newLength</span><span class="op" id="4799502">,</span>&nbsp;<span class="ident" id="4799504">newOffset</span><span class="op" id="4799513">,</span>&nbsp;<span class="ident" id="4799515">ok</span>&nbsp;<span class="op" id="4799518">:=</span>&nbsp;<span class="ident" id="4799521"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799522">.</span><span class="ident" id="4799523"><a href="/gostd/compress/flate/deflate.go.html#4796044">findMatch</a></span><span class="op" id="4799532">(</span><span class="ident" id="4799533"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799534">.</span><span class="ident" id="4799535"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4799540">,</span>&nbsp;<span class="ident" id="4799542"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799543">.</span><span class="ident" id="4799544"><a href="/gostd/compress/flate/deflate.go.html#4794264">chainHead</a></span><span class="op" id="4799553">-</span><span class="ident" id="4799554"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799555">.</span><span class="ident" id="4799556"><a href="/gostd/compress/flate/deflate.go.html#4794316">hashOffset</a></span><span class="op" id="4799566">,</span>&nbsp;<span class="ident" id="4799568"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span><span class="op" id="4799582">-</span><span class="num" id="4799583">1</span><span class="op" id="4799584">,</span>&nbsp;<span class="ident" id="4799586"><a href="/gostd/compress/flate/deflate.go.html#4798221">lookahead</a></span><span class="op" id="4799595">)</span><span class="op" id="4799596">;</span>&nbsp;<span class="ident" id="4799598"><a href="/gostd/compress/flate/deflate.go.html#4799515">ok</a></span>&nbsp;<span class="op" id="4799601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799607"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799608">.</span><span class="ident" id="4799609"><a href="/gostd/compress/flate/deflate.go.html#4794650">length</a></span>&nbsp;<span class="op" id="4799616">=</span>&nbsp;<span class="ident" id="4799618"><a href="/gostd/compress/flate/deflate.go.html#4799493">newLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799632"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799633">.</span><span class="ident" id="4799634"><a href="/gostd/compress/flate/deflate.go.html#4794670">offset</a></span>&nbsp;<span class="op" id="4799641">=</span>&nbsp;<span class="ident" id="4799643"><a href="/gostd/compress/flate/deflate.go.html#4799504">newOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4799656">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4799660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4799664">if</span>&nbsp;<span class="ident" id="4799667"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799668">.</span><span class="ident" id="4799669"><a href="/gostd/compress/flate/deflate.go.html#4793241">fastSkipHashing</a></span>&nbsp;<span class="op" id="4799685">!=</span>&nbsp;<span class="ident" id="4799688"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span>&nbsp;<span class="op" id="4799698">&amp;&amp;</span>&nbsp;<span class="ident" id="4799701"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799702">.</span><span class="ident" id="4799703"><a href="/gostd/compress/flate/deflate.go.html#4794650">length</a></span>&nbsp;<span class="op" id="4799710">&gt;=</span>&nbsp;<span class="ident" id="4799713"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span>&nbsp;<span class="op" id="4799728">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799734"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799735">.</span><span class="ident" id="4799736"><a href="/gostd/compress/flate/deflate.go.html#4793241">fastSkipHashing</a></span>&nbsp;<span class="op" id="4799752">==</span>&nbsp;<span class="ident" id="4799755"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span>&nbsp;<span class="op" id="4799765">&amp;&amp;</span>&nbsp;<span class="ident" id="4799768"><a href="/gostd/compress/flate/deflate.go.html#4799114">prevLength</a></span>&nbsp;<span class="op" id="4799779">&gt;=</span>&nbsp;<span class="ident" id="4799782"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span>&nbsp;<span class="op" id="4799797">&amp;&amp;</span>&nbsp;<span class="ident" id="4799800"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799801">.</span><span class="ident" id="4799802"><a href="/gostd/compress/flate/deflate.go.html#4794650">length</a></span>&nbsp;<span class="op" id="4799809">&lt;=</span>&nbsp;<span class="ident" id="4799812"><a href="/gostd/compress/flate/deflate.go.html#4799114">prevLength</a></span>&nbsp;<span class="op" id="4799823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4799828">//&nbsp;There&nbsp;was&nbsp;a&nbsp;match&nbsp;at&nbsp;the&nbsp;previous&nbsp;step,&nbsp;and&nbsp;the&nbsp;current&nbsp;match&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4799899">//&nbsp;not&nbsp;better.&nbsp;Output&nbsp;the&nbsp;previous&nbsp;match.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4799944">if</span>&nbsp;<span class="ident" id="4799947"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799948">.</span><span class="ident" id="4799949"><a href="/gostd/compress/flate/deflate.go.html#4793241">fastSkipHashing</a></span>&nbsp;<span class="op" id="4799965">!=</span>&nbsp;<span class="ident" id="4799968"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span>&nbsp;<span class="op" id="4799978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4799984"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4799985">.</span><span class="ident" id="4799986"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span>&nbsp;<span class="op" id="4799993">=</span>&nbsp;<span class="builtinfunc" id="4799995">append</span><span class="op" id="4800001">(</span><span class="ident" id="4800002"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800003">.</span><span class="ident" id="4800004"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4800010">,</span>&nbsp;<span class="ident" id="4800012"><a href="/gostd/compress/flate/token.go.html#4856347">matchToken</a></span><span class="op" id="4800022">(</span><span class="builtintype" id="4800023">uint32</span><span class="op" id="4800029">(</span><span class="ident" id="4800030"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800031">.</span><span class="ident" id="4800032"><a href="/gostd/compress/flate/deflate.go.html#4794650">length</a></span><span class="op" id="4800038">-</span><span class="ident" id="4800039"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span><span class="op" id="4800053">)</span><span class="op" id="4800054">,</span>&nbsp;<span class="builtintype" id="4800056">uint32</span><span class="op" id="4800062">(</span><span class="ident" id="4800063"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800064">.</span><span class="ident" id="4800065"><a href="/gostd/compress/flate/deflate.go.html#4794670">offset</a></span><span class="op" id="4800071">-</span><span class="ident" id="4800072"><a href="/gostd/compress/flate/deflate.go.html#4792699">minOffsetSize</a></span><span class="op" id="4800085">)</span><span class="op" id="4800086">)</span><span class="op" id="4800087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4800092">}</span>&nbsp;<span class="keyword" id="4800094">else</span>&nbsp;<span class="op" id="4800099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4800105"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800106">.</span><span class="ident" id="4800107"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span>&nbsp;<span class="op" id="4800114">=</span>&nbsp;<span class="builtinfunc" id="4800116">append</span><span class="op" id="4800122">(</span><span class="ident" id="4800123"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800124">.</span><span class="ident" id="4800125"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4800131">,</span>&nbsp;<span class="ident" id="4800133"><a href="/gostd/compress/flate/token.go.html#4856347">matchToken</a></span><span class="op" id="4800143">(</span><span class="builtintype" id="4800144">uint32</span><span class="op" id="4800150">(</span><span class="ident" id="4800151"><a href="/gostd/compress/flate/deflate.go.html#4799114">prevLength</a></span><span class="op" id="4800161">-</span><span class="ident" id="4800162"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span><span class="op" id="4800176">)</span><span class="op" id="4800177">,</span>&nbsp;<span class="builtintype" id="4800179">uint32</span><span class="op" id="4800185">(</span><span class="ident" id="4800186"><a href="/gostd/compress/flate/deflate.go.html#4799139">prevOffset</a></span><span class="op" id="4800196">-</span><span class="ident" id="4800197"><a href="/gostd/compress/flate/deflate.go.html#4792699">minOffsetSize</a></span><span class="op" id="4800210">)</span><span class="op" id="4800211">)</span><span class="op" id="4800212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4800217">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4800222">//&nbsp;Insert&nbsp;in&nbsp;the&nbsp;hash&nbsp;table&nbsp;all&nbsp;strings&nbsp;up&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4800293">//&nbsp;index&nbsp;and&nbsp;index-1&nbsp;are&nbsp;already&nbsp;inserted.&nbsp;If&nbsp;there&nbsp;is&nbsp;not&nbsp;enough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4800362">//&nbsp;lookahead,&nbsp;the&nbsp;last&nbsp;two&nbsp;strings&nbsp;are&nbsp;not&nbsp;inserted&nbsp;into&nbsp;the&nbsp;hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4800431">//&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4800444">if</span>&nbsp;<span class="ident" id="4800447"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800448">.</span><span class="ident" id="4800449"><a href="/gostd/compress/flate/deflate.go.html#4794650">length</a></span>&nbsp;<span class="op" id="4800456">&lt;=</span>&nbsp;<span class="ident" id="4800459"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800460">.</span><span class="ident" id="4800461"><a href="/gostd/compress/flate/deflate.go.html#4793241">fastSkipHashing</a></span>&nbsp;<span class="op" id="4800477">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4800483">var</span>&nbsp;<span class="ident" id="4800487">newIndex</span>&nbsp;<span class="builtintype" id="4800496">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4800504">if</span>&nbsp;<span class="ident" id="4800507"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800508">.</span><span class="ident" id="4800509"><a href="/gostd/compress/flate/deflate.go.html#4793241">fastSkipHashing</a></span>&nbsp;<span class="op" id="4800525">!=</span>&nbsp;<span class="ident" id="4800528"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span>&nbsp;<span class="op" id="4800538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4800545"><a href="/gostd/compress/flate/deflate.go.html#4800487">newIndex</a></span>&nbsp;<span class="op" id="4800554">=</span>&nbsp;<span class="ident" id="4800556"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800557">.</span><span class="ident" id="4800558"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4800564">+</span>&nbsp;<span class="ident" id="4800566"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800567">.</span><span class="ident" id="4800568"><a href="/gostd/compress/flate/deflate.go.html#4794650">length</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4800579">}</span>&nbsp;<span class="keyword" id="4800581">else</span>&nbsp;<span class="op" id="4800586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4800593"><a href="/gostd/compress/flate/deflate.go.html#4800487">newIndex</a></span>&nbsp;<span class="op" id="4800602">=</span>&nbsp;<span class="ident" id="4800604"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800605">.</span><span class="ident" id="4800606"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4800612">+</span>&nbsp;<span class="ident" id="4800614"><a href="/gostd/compress/flate/deflate.go.html#4799114">prevLength</a></span>&nbsp;<span class="op" id="4800625">-</span>&nbsp;<span class="num" id="4800627">1</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4800633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4800639">for</span>&nbsp;<span class="ident" id="4800643"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800644">.</span><span class="ident" id="4800645"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4800650">++</span><span class="op" id="4800652">;</span>&nbsp;<span class="ident" id="4800654"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800655">.</span><span class="ident" id="4800656"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4800662">&lt;</span>&nbsp;<span class="ident" id="4800664"><a href="/gostd/compress/flate/deflate.go.html#4800487">newIndex</a></span><span class="op" id="4800672">;</span>&nbsp;<span class="ident" id="4800674"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800675">.</span><span class="ident" id="4800676"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4800681">++</span>&nbsp;<span class="op" id="4800684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4800691">if</span>&nbsp;<span class="ident" id="4800694"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800695">.</span><span class="ident" id="4800696"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4800702">&lt;</span>&nbsp;<span class="ident" id="4800704"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800705">.</span><span class="ident" id="4800706"><a href="/gostd/compress/flate/deflate.go.html#4794710">maxInsertIndex</a></span>&nbsp;<span class="op" id="4800721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4800729"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800730">.</span><span class="ident" id="4800731"><a href="/gostd/compress/flate/deflate.go.html#4794690">hash</a></span>&nbsp;<span class="op" id="4800736">=</span>&nbsp;<span class="op" id="4800738">(</span><span class="ident" id="4800739"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800740">.</span><span class="ident" id="4800741"><a href="/gostd/compress/flate/deflate.go.html#4794690">hash</a></span><span class="op" id="4800745">&lt;&lt;</span><span class="ident" id="4800747"><a href="/gostd/compress/flate/deflate.go.html#4793051">hashShift</a></span>&nbsp;<span class="op" id="4800757">+</span>&nbsp;<span class="builtintype" id="4800759">int</span><span class="op" id="4800762">(</span><span class="ident" id="4800763"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800764">.</span><span class="ident" id="4800765"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4800771">[</span><span class="ident" id="4800772"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800773">.</span><span class="ident" id="4800774"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4800779">+</span><span class="num" id="4800780">2</span><span class="op" id="4800781">]</span><span class="op" id="4800782">)</span><span class="op" id="4800783">)</span>&nbsp;<span class="op" id="4800785">&amp;</span>&nbsp;<span class="ident" id="4800787"><a href="/gostd/compress/flate/deflate.go.html#4793008">hashMask</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4800802">//&nbsp;Get&nbsp;previous&nbsp;value&nbsp;with&nbsp;the&nbsp;same&nbsp;hash.</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4800850">//&nbsp;Our&nbsp;chain&nbsp;should&nbsp;point&nbsp;to&nbsp;the&nbsp;previous&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4800905"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800906">.</span><span class="ident" id="4800907"><a href="/gostd/compress/flate/deflate.go.html#4794298">hashPrev</a></span><span class="op" id="4800915">[</span><span class="ident" id="4800916"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800917">.</span><span class="ident" id="4800918"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4800923">&amp;</span><span class="ident" id="4800924"><a href="/gostd/compress/flate/deflate.go.html#4792472">windowMask</a></span><span class="op" id="4800934">]</span>&nbsp;<span class="op" id="4800936">=</span>&nbsp;<span class="ident" id="4800938"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800939">.</span><span class="ident" id="4800940"><a href="/gostd/compress/flate/deflate.go.html#4794280">hashHead</a></span><span class="op" id="4800948">[</span><span class="ident" id="4800949"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4800950">.</span><span class="ident" id="4800951"><a href="/gostd/compress/flate/deflate.go.html#4794690">hash</a></span><span class="op" id="4800955">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4800963">//&nbsp;Set&nbsp;the&nbsp;head&nbsp;of&nbsp;the&nbsp;hash&nbsp;chain&nbsp;to&nbsp;us.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4801010"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801011">.</span><span class="ident" id="4801012"><a href="/gostd/compress/flate/deflate.go.html#4794280">hashHead</a></span><span class="op" id="4801020">[</span><span class="ident" id="4801021"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801022">.</span><span class="ident" id="4801023"><a href="/gostd/compress/flate/deflate.go.html#4794690">hash</a></span><span class="op" id="4801027">]</span>&nbsp;<span class="op" id="4801029">=</span>&nbsp;<span class="ident" id="4801031"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801032">.</span><span class="ident" id="4801033"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4801039">+</span>&nbsp;<span class="ident" id="4801041"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801042">.</span><span class="ident" id="4801043"><a href="/gostd/compress/flate/deflate.go.html#4794316">hashOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4801059">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4801065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4801071">if</span>&nbsp;<span class="ident" id="4801074"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801075">.</span><span class="ident" id="4801076"><a href="/gostd/compress/flate/deflate.go.html#4793241">fastSkipHashing</a></span>&nbsp;<span class="op" id="4801092">==</span>&nbsp;<span class="ident" id="4801095"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span>&nbsp;<span class="op" id="4801105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4801112"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801113">.</span><span class="ident" id="4801114"><a href="/gostd/compress/flate/deflate.go.html#4794518">byteAvailable</a></span>&nbsp;<span class="op" id="4801128">=</span>&nbsp;<span class="builtintype" id="4801130">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4801141"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801142">.</span><span class="ident" id="4801143"><a href="/gostd/compress/flate/deflate.go.html#4794650">length</a></span>&nbsp;<span class="op" id="4801150">=</span>&nbsp;<span class="ident" id="4801152"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span>&nbsp;<span class="op" id="4801167">-</span>&nbsp;<span class="num" id="4801169">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4801175">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4801180">}</span>&nbsp;<span class="keyword" id="4801182">else</span>&nbsp;<span class="op" id="4801187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4801193">//&nbsp;For&nbsp;matches&nbsp;this&nbsp;long,&nbsp;we&nbsp;don&#39;t&nbsp;bother&nbsp;inserting&nbsp;each&nbsp;individual</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4801265">//&nbsp;item&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4801293"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801294">.</span><span class="ident" id="4801295"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4801301">+=</span>&nbsp;<span class="ident" id="4801304"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801305">.</span><span class="ident" id="4801306"><a href="/gostd/compress/flate/deflate.go.html#4794650">length</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4801317">if</span>&nbsp;<span class="ident" id="4801320"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801321">.</span><span class="ident" id="4801322"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4801328">&lt;</span>&nbsp;<span class="ident" id="4801330"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801331">.</span><span class="ident" id="4801332"><a href="/gostd/compress/flate/deflate.go.html#4794710">maxInsertIndex</a></span>&nbsp;<span class="op" id="4801347">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4801354"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801355">.</span><span class="ident" id="4801356"><a href="/gostd/compress/flate/deflate.go.html#4794690">hash</a></span>&nbsp;<span class="op" id="4801361">=</span>&nbsp;<span class="op" id="4801363">(</span><span class="builtintype" id="4801364">int</span><span class="op" id="4801367">(</span><span class="ident" id="4801368"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801369">.</span><span class="ident" id="4801370"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4801376">[</span><span class="ident" id="4801377"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801378">.</span><span class="ident" id="4801379"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4801384">]</span><span class="op" id="4801385">)</span><span class="op" id="4801386">&lt;&lt;</span><span class="ident" id="4801388"><a href="/gostd/compress/flate/deflate.go.html#4793051">hashShift</a></span>&nbsp;<span class="op" id="4801398">+</span>&nbsp;<span class="builtintype" id="4801400">int</span><span class="op" id="4801403">(</span><span class="ident" id="4801404"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801405">.</span><span class="ident" id="4801406"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4801412">[</span><span class="ident" id="4801413"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801414">.</span><span class="ident" id="4801415"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4801420">+</span><span class="num" id="4801421">1</span><span class="op" id="4801422">]</span><span class="op" id="4801423">)</span><span class="op" id="4801424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4801430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4801435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4801440">if</span>&nbsp;<span class="builtinfunc" id="4801443">len</span><span class="op" id="4801446">(</span><span class="ident" id="4801447"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801448">.</span><span class="ident" id="4801449"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4801455">)</span>&nbsp;<span class="op" id="4801457">==</span>&nbsp;<span class="ident" id="4801460"><a href="/gostd/compress/flate/deflate.go.html#4792885">maxFlateBlockTokens</a></span>&nbsp;<span class="op" id="4801480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4801486">//&nbsp;The&nbsp;block&nbsp;includes&nbsp;the&nbsp;current&nbsp;character</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4801534">if</span>&nbsp;<span class="ident" id="4801537"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801538">.</span><span class="ident" id="4801539"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span>&nbsp;<span class="op" id="4801543">=</span>&nbsp;<span class="ident" id="4801545"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801546">.</span><span class="ident" id="4801547"><a href="/gostd/compress/flate/deflate.go.html#4795612">writeBlock</a></span><span class="op" id="4801557">(</span><span class="ident" id="4801558"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801559">.</span><span class="ident" id="4801560"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4801566">,</span>&nbsp;<span class="ident" id="4801568"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801569">.</span><span class="ident" id="4801570"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4801575">,</span>&nbsp;<span class="builtintype" id="4801577">false</span><span class="op" id="4801582">)</span><span class="op" id="4801583">;</span>&nbsp;<span class="ident" id="4801585"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801586">.</span><span class="ident" id="4801587"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span>&nbsp;<span class="op" id="4801591">!=</span>&nbsp;<span class="builtintype" id="4801594">nil</span>&nbsp;<span class="op" id="4801598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4801605">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4801616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4801622"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801623">.</span><span class="ident" id="4801624"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span>&nbsp;<span class="op" id="4801631">=</span>&nbsp;<span class="ident" id="4801633"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801634">.</span><span class="ident" id="4801635"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4801641">[</span><span class="op" id="4801642">:</span><span class="num" id="4801643">0</span><span class="op" id="4801644">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4801649">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4801653">}</span>&nbsp;<span class="keyword" id="4801655">else</span>&nbsp;<span class="op" id="4801660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4801665">if</span>&nbsp;<span class="ident" id="4801668"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801669">.</span><span class="ident" id="4801670"><a href="/gostd/compress/flate/deflate.go.html#4793241">fastSkipHashing</a></span>&nbsp;<span class="op" id="4801686">!=</span>&nbsp;<span class="ident" id="4801689"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span>&nbsp;<span class="op" id="4801699">||</span>&nbsp;<span class="ident" id="4801702"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801703">.</span><span class="ident" id="4801704"><a href="/gostd/compress/flate/deflate.go.html#4794518">byteAvailable</a></span>&nbsp;<span class="op" id="4801718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4801724">i</span>&nbsp;<span class="op" id="4801726">:=</span>&nbsp;<span class="ident" id="4801729"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801730">.</span><span class="ident" id="4801731"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span>&nbsp;<span class="op" id="4801737">-</span>&nbsp;<span class="num" id="4801739">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4801745">if</span>&nbsp;<span class="ident" id="4801748"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801749">.</span><span class="ident" id="4801750"><a href="/gostd/compress/flate/deflate.go.html#4793241">fastSkipHashing</a></span>&nbsp;<span class="op" id="4801766">!=</span>&nbsp;<span class="ident" id="4801769"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span>&nbsp;<span class="op" id="4801779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4801786"><a href="/gostd/compress/flate/deflate.go.html#4801724">i</a></span>&nbsp;<span class="op" id="4801788">=</span>&nbsp;<span class="ident" id="4801790"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801791">.</span><span class="ident" id="4801792"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4801802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4801808"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801809">.</span><span class="ident" id="4801810"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span>&nbsp;<span class="op" id="4801817">=</span>&nbsp;<span class="builtinfunc" id="4801819">append</span><span class="op" id="4801825">(</span><span class="ident" id="4801826"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801827">.</span><span class="ident" id="4801828"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4801834">,</span>&nbsp;<span class="ident" id="4801836"><a href="/gostd/compress/flate/token.go.html#4856207">literalToken</a></span><span class="op" id="4801848">(</span><span class="builtintype" id="4801849">uint32</span><span class="op" id="4801855">(</span><span class="ident" id="4801856"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801857">.</span><span class="ident" id="4801858"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4801864">[</span><span class="ident" id="4801865"><a href="/gostd/compress/flate/deflate.go.html#4801724">i</a></span><span class="op" id="4801866">]</span><span class="op" id="4801867">)</span><span class="op" id="4801868">)</span><span class="op" id="4801869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4801875">if</span>&nbsp;<span class="builtinfunc" id="4801878">len</span><span class="op" id="4801881">(</span><span class="ident" id="4801882"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801883">.</span><span class="ident" id="4801884"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4801890">)</span>&nbsp;<span class="op" id="4801892">==</span>&nbsp;<span class="ident" id="4801895"><a href="/gostd/compress/flate/deflate.go.html#4792885">maxFlateBlockTokens</a></span>&nbsp;<span class="op" id="4801915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4801922">if</span>&nbsp;<span class="ident" id="4801925"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801926">.</span><span class="ident" id="4801927"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span>&nbsp;<span class="op" id="4801931">=</span>&nbsp;<span class="ident" id="4801933"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801934">.</span><span class="ident" id="4801935"><a href="/gostd/compress/flate/deflate.go.html#4795612">writeBlock</a></span><span class="op" id="4801945">(</span><span class="ident" id="4801946"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801947">.</span><span class="ident" id="4801948"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4801954">,</span>&nbsp;<span class="ident" id="4801956"><a href="/gostd/compress/flate/deflate.go.html#4801724">i</a></span><span class="op" id="4801957">+</span><span class="num" id="4801958">1</span><span class="op" id="4801959">,</span>&nbsp;<span class="builtintype" id="4801961">false</span><span class="op" id="4801966">)</span><span class="op" id="4801967">;</span>&nbsp;<span class="ident" id="4801969"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4801970">.</span><span class="ident" id="4801971"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span>&nbsp;<span class="op" id="4801975">!=</span>&nbsp;<span class="builtintype" id="4801978">nil</span>&nbsp;<span class="op" id="4801982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4801990">return</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4802002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802009"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4802010">.</span><span class="ident" id="4802011"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span>&nbsp;<span class="op" id="4802018">=</span>&nbsp;<span class="ident" id="4802020"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4802021">.</span><span class="ident" id="4802022"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4802028">[</span><span class="op" id="4802029">:</span><span class="num" id="4802030">0</span><span class="op" id="4802031">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4802037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4802042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802047"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4802048">.</span><span class="ident" id="4802049"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4802054">++</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4802060">if</span>&nbsp;<span class="ident" id="4802063"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4802064">.</span><span class="ident" id="4802065"><a href="/gostd/compress/flate/deflate.go.html#4793241">fastSkipHashing</a></span>&nbsp;<span class="op" id="4802081">==</span>&nbsp;<span class="ident" id="4802084"><a href="/gostd/compress/flate/deflate.go.html#4793155">skipNever</a></span>&nbsp;<span class="op" id="4802094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802100"><a href="/gostd/compress/flate/deflate.go.html#4797870">d</a></span><span class="op" id="4802101">.</span><span class="ident" id="4802102"><a href="/gostd/compress/flate/deflate.go.html#4794518">byteAvailable</a></span>&nbsp;<span class="op" id="4802116">=</span>&nbsp;<span class="builtintype" id="4802118">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4802126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4802130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4802133">}</span><br>
<span class="lineno">360</span><span class="op" id="4802135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4802138">func</span>&nbsp;<span class="op" id="4802143">(</span><span class="ident" id="4802144">d</span>&nbsp;<span class="op" id="4802146">*</span><span class="ident" id="4802147"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4802157">)</span>&nbsp;<span class="ident" id="4802159">fillStore</span><span class="op" id="4802168">(</span><span class="ident" id="4802169">b</span>&nbsp;<span class="op" id="4802171">[</span><span class="op" id="4802172">]</span><span class="builtintype" id="4802173">byte</span><span class="op" id="4802177">)</span>&nbsp;<span class="builtintype" id="4802179">int</span>&nbsp;<span class="op" id="4802183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802186">n</span>&nbsp;<span class="op" id="4802188">:=</span>&nbsp;<span class="builtinfunc" id="4802191">copy</span><span class="op" id="4802195">(</span><span class="ident" id="4802196"><a href="/gostd/compress/flate/deflate.go.html#4802144">d</a></span><span class="op" id="4802197">.</span><span class="ident" id="4802198"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4802204">[</span><span class="ident" id="4802205"><a href="/gostd/compress/flate/deflate.go.html#4802144">d</a></span><span class="op" id="4802206">.</span><span class="ident" id="4802207"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span><span class="op" id="4802216">:</span><span class="op" id="4802217">]</span><span class="op" id="4802218">,</span>&nbsp;<span class="ident" id="4802220"><a href="/gostd/compress/flate/deflate.go.html#4802169">b</a></span><span class="op" id="4802221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802224"><a href="/gostd/compress/flate/deflate.go.html#4802144">d</a></span><span class="op" id="4802225">.</span><span class="ident" id="4802226"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span>&nbsp;<span class="op" id="4802236">+=</span>&nbsp;<span class="ident" id="4802239"><a href="/gostd/compress/flate/deflate.go.html#4802186">n</a></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4802242">return</span>&nbsp;<span class="ident" id="4802249"><a href="/gostd/compress/flate/deflate.go.html#4802186">n</a></span><br>
<span class="lineno"></span><span class="op" id="4802251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4802254">func</span>&nbsp;<span class="op" id="4802259">(</span><span class="ident" id="4802260">d</span>&nbsp;<span class="op" id="4802262">*</span><span class="ident" id="4802263"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4802273">)</span>&nbsp;<span class="ident" id="4802275">store</span><span class="op" id="4802280">(</span><span class="op" id="4802281">)</span>&nbsp;<span class="op" id="4802283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4802286">if</span>&nbsp;<span class="ident" id="4802289"><a href="/gostd/compress/flate/deflate.go.html#4802260">d</a></span><span class="op" id="4802290">.</span><span class="ident" id="4802291"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span>&nbsp;<span class="op" id="4802301">&gt;</span>&nbsp;<span class="num" id="4802303">0</span>&nbsp;<span class="op" id="4802305">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802309"><a href="/gostd/compress/flate/deflate.go.html#4802260">d</a></span><span class="op" id="4802310">.</span><span class="ident" id="4802311"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span>&nbsp;<span class="op" id="4802315">=</span>&nbsp;<span class="ident" id="4802317"><a href="/gostd/compress/flate/deflate.go.html#4802260">d</a></span><span class="op" id="4802318">.</span><span class="ident" id="4802319"><a href="/gostd/compress/flate/deflate.go.html#4797370">writeStoredBlock</a></span><span class="op" id="4802335">(</span><span class="ident" id="4802336"><a href="/gostd/compress/flate/deflate.go.html#4802260">d</a></span><span class="op" id="4802337">.</span><span class="ident" id="4802338"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4802344">[</span><span class="op" id="4802345">:</span><span class="ident" id="4802346"><a href="/gostd/compress/flate/deflate.go.html#4802260">d</a></span><span class="op" id="4802347">.</span><span class="ident" id="4802348"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span><span class="op" id="4802357">]</span><span class="op" id="4802358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4802361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802364"><a href="/gostd/compress/flate/deflate.go.html#4802260">d</a></span><span class="op" id="4802365">.</span><span class="ident" id="4802366"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span>&nbsp;<span class="op" id="4802376">=</span>&nbsp;<span class="num" id="4802378">0</span><br>
<span class="lineno"></span><span class="op" id="4802380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="4802383">func</span>&nbsp;<span class="op" id="4802388">(</span><span class="ident" id="4802389">d</span>&nbsp;<span class="op" id="4802391">*</span><span class="ident" id="4802392"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4802402">)</span>&nbsp;<span class="ident" id="4802404">write</span><span class="op" id="4802409">(</span><span class="ident" id="4802410">b</span>&nbsp;<span class="op" id="4802412">[</span><span class="op" id="4802413">]</span><span class="builtintype" id="4802414">byte</span><span class="op" id="4802418">)</span>&nbsp;<span class="op" id="4802420">(</span><span class="ident" id="4802421">n</span>&nbsp;<span class="builtintype" id="4802423">int</span><span class="op" id="4802426">,</span>&nbsp;<span class="ident" id="4802428">err</span>&nbsp;<span class="builtintype" id="4802432">error</span><span class="op" id="4802437">)</span>&nbsp;<span class="op" id="4802439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802442"><a href="/gostd/compress/flate/deflate.go.html#4802421">n</a></span>&nbsp;<span class="op" id="4802444">=</span>&nbsp;<span class="builtinfunc" id="4802446">len</span><span class="op" id="4802449">(</span><span class="ident" id="4802450"><a href="/gostd/compress/flate/deflate.go.html#4802410">b</a></span><span class="op" id="4802451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802454"><a href="/gostd/compress/flate/deflate.go.html#4802410">b</a></span>&nbsp;<span class="op" id="4802456">=</span>&nbsp;<span class="ident" id="4802458"><a href="/gostd/compress/flate/deflate.go.html#4802410">b</a></span><span class="op" id="4802459">[</span><span class="ident" id="4802460"><a href="/gostd/compress/flate/deflate.go.html#4802389">d</a></span><span class="op" id="4802461">.</span><span class="ident" id="4802462"><a href="/gostd/compress/flate/deflate.go.html#4793819">fill</a></span><span class="op" id="4802466">(</span><span class="ident" id="4802467"><a href="/gostd/compress/flate/deflate.go.html#4802389">d</a></span><span class="op" id="4802468">,</span>&nbsp;<span class="ident" id="4802470"><a href="/gostd/compress/flate/deflate.go.html#4802410">b</a></span><span class="op" id="4802471">)</span><span class="op" id="4802472">:</span><span class="op" id="4802473">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4802476">for</span>&nbsp;<span class="builtinfunc" id="4802480">len</span><span class="op" id="4802483">(</span><span class="ident" id="4802484"><a href="/gostd/compress/flate/deflate.go.html#4802410">b</a></span><span class="op" id="4802485">)</span>&nbsp;<span class="op" id="4802487">&gt;</span>&nbsp;<span class="num" id="4802489">0</span>&nbsp;<span class="op" id="4802491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802495"><a href="/gostd/compress/flate/deflate.go.html#4802389">d</a></span><span class="op" id="4802496">.</span><span class="ident" id="4802497"><a href="/gostd/compress/flate/deflate.go.html#4793878">step</a></span><span class="op" id="4802501">(</span><span class="ident" id="4802502"><a href="/gostd/compress/flate/deflate.go.html#4802389">d</a></span><span class="op" id="4802503">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802507"><a href="/gostd/compress/flate/deflate.go.html#4802410">b</a></span>&nbsp;<span class="op" id="4802509">=</span>&nbsp;<span class="ident" id="4802511"><a href="/gostd/compress/flate/deflate.go.html#4802410">b</a></span><span class="op" id="4802512">[</span><span class="ident" id="4802513"><a href="/gostd/compress/flate/deflate.go.html#4802389">d</a></span><span class="op" id="4802514">.</span><span class="ident" id="4802515"><a href="/gostd/compress/flate/deflate.go.html#4793819">fill</a></span><span class="op" id="4802519">(</span><span class="ident" id="4802520"><a href="/gostd/compress/flate/deflate.go.html#4802389">d</a></span><span class="op" id="4802521">,</span>&nbsp;<span class="ident" id="4802523"><a href="/gostd/compress/flate/deflate.go.html#4802410">b</a></span><span class="op" id="4802524">)</span><span class="op" id="4802525">:</span><span class="op" id="4802526">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4802529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4802532">return</span>&nbsp;<span class="ident" id="4802539"><a href="/gostd/compress/flate/deflate.go.html#4802421">n</a></span><span class="op" id="4802540">,</span>&nbsp;<span class="ident" id="4802542"><a href="/gostd/compress/flate/deflate.go.html#4802389">d</a></span><span class="op" id="4802543">.</span><span class="ident" id="4802544"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span><br>
<span class="lineno"></span><span class="op" id="4802548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="4802551">func</span>&nbsp;<span class="op" id="4802556">(</span><span class="ident" id="4802557">d</span>&nbsp;<span class="op" id="4802559">*</span><span class="ident" id="4802560"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4802570">)</span>&nbsp;<span class="ident" id="4802572">syncFlush</span><span class="op" id="4802581">(</span><span class="op" id="4802582">)</span>&nbsp;<span class="builtintype" id="4802584">error</span>&nbsp;<span class="op" id="4802590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802593"><a href="/gostd/compress/flate/deflate.go.html#4802557">d</a></span><span class="op" id="4802594">.</span><span class="ident" id="4802595"><a href="/gostd/compress/flate/deflate.go.html#4793932">sync</a></span>&nbsp;<span class="op" id="4802600">=</span>&nbsp;<span class="builtintype" id="4802602">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802608"><a href="/gostd/compress/flate/deflate.go.html#4802557">d</a></span><span class="op" id="4802609">.</span><span class="ident" id="4802610"><a href="/gostd/compress/flate/deflate.go.html#4793878">step</a></span><span class="op" id="4802614">(</span><span class="ident" id="4802615"><a href="/gostd/compress/flate/deflate.go.html#4802557">d</a></span><span class="op" id="4802616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4802619">if</span>&nbsp;<span class="ident" id="4802622"><a href="/gostd/compress/flate/deflate.go.html#4802557">d</a></span><span class="op" id="4802623">.</span><span class="ident" id="4802624"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span>&nbsp;<span class="op" id="4802628">==</span>&nbsp;<span class="builtintype" id="4802631">nil</span>&nbsp;<span class="op" id="4802635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802639"><a href="/gostd/compress/flate/deflate.go.html#4802557">d</a></span><span class="op" id="4802640">.</span><span class="ident" id="4802641"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4802642">.</span><span class="ident" id="4802643"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4820333">writeStoredHeader</a></span><span class="op" id="4802660">(</span><span class="num" id="4802661">0</span><span class="op" id="4802662">,</span>&nbsp;<span class="builtintype" id="4802664">false</span><span class="op" id="4802669">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802673"><a href="/gostd/compress/flate/deflate.go.html#4802557">d</a></span><span class="op" id="4802674">.</span><span class="ident" id="4802675"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4802676">.</span><span class="ident" id="4802677"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4815551">flush</a></span><span class="op" id="4802682">(</span><span class="op" id="4802683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802687"><a href="/gostd/compress/flate/deflate.go.html#4802557">d</a></span><span class="op" id="4802688">.</span><span class="ident" id="4802689"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span>&nbsp;<span class="op" id="4802693">=</span>&nbsp;<span class="ident" id="4802695"><a href="/gostd/compress/flate/deflate.go.html#4802557">d</a></span><span class="op" id="4802696">.</span><span class="ident" id="4802697"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4802698">.</span><span class="ident" id="4802699"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4814195">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4802704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802707"><a href="/gostd/compress/flate/deflate.go.html#4802557">d</a></span><span class="op" id="4802708">.</span><span class="ident" id="4802709"><a href="/gostd/compress/flate/deflate.go.html#4793932">sync</a></span>&nbsp;<span class="op" id="4802714">=</span>&nbsp;<span class="builtintype" id="4802716">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4802723">return</span>&nbsp;<span class="ident" id="4802730"><a href="/gostd/compress/flate/deflate.go.html#4802557">d</a></span><span class="op" id="4802731">.</span><span class="ident" id="4802732"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span><br>
<span class="lineno">395</span><span class="op" id="4802736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4802739">func</span>&nbsp;<span class="op" id="4802744">(</span><span class="ident" id="4802745">d</span>&nbsp;<span class="op" id="4802747">*</span><span class="ident" id="4802748"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4802758">)</span>&nbsp;<span class="ident" id="4802760">init</span><span class="op" id="4802764">(</span><span class="ident" id="4802765">w</span>&nbsp;<span class="ident" id="4802767"><a href="/gostd/compress/flate/deflate.go.html#4792260">io</a></span><span class="op" id="4802769">.</span><span class="ident" id="4802770"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="4802776">,</span>&nbsp;<span class="ident" id="4802778">level</span>&nbsp;<span class="builtintype" id="4802784">int</span><span class="op" id="4802787">)</span>&nbsp;<span class="op" id="4802789">(</span><span class="ident" id="4802790">err</span>&nbsp;<span class="builtintype" id="4802794">error</span><span class="op" id="4802799">)</span>&nbsp;<span class="op" id="4802801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802804"><a href="/gostd/compress/flate/deflate.go.html#4802745">d</a></span><span class="op" id="4802805">.</span><span class="ident" id="4802806"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span>&nbsp;<span class="op" id="4802808">=</span>&nbsp;<span class="ident" id="4802810"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4814225">newHuffmanBitWriter</a></span><span class="op" id="4802829">(</span><span class="ident" id="4802830"><a href="/gostd/compress/flate/deflate.go.html#4802765">w</a></span><span class="op" id="4802831">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4802835">switch</span>&nbsp;<span class="op" id="4802842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4802845">case</span>&nbsp;<span class="ident" id="4802850"><a href="/gostd/compress/flate/deflate.go.html#4802778">level</a></span>&nbsp;<span class="op" id="4802856">==</span>&nbsp;<span class="ident" id="4802859"><a href="/gostd/compress/flate/deflate.go.html#4792285">NoCompression</a></span><span class="op" id="4802872">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802876"><a href="/gostd/compress/flate/deflate.go.html#4802745">d</a></span><span class="op" id="4802877">.</span><span class="ident" id="4802878"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span>&nbsp;<span class="op" id="4802885">=</span>&nbsp;<span class="builtinfunc" id="4802887">make</span><span class="op" id="4802891">(</span><span class="op" id="4802892">[</span><span class="op" id="4802893">]</span><span class="builtintype" id="4802894">byte</span><span class="op" id="4802898">,</span>&nbsp;<span class="ident" id="4802900"><a href="/gostd/compress/flate/deflate.go.html#4792916">maxStoreBlockSize</a></span><span class="op" id="4802917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802921"><a href="/gostd/compress/flate/deflate.go.html#4802745">d</a></span><span class="op" id="4802922">.</span><span class="ident" id="4802923"><a href="/gostd/compress/flate/deflate.go.html#4793819">fill</a></span>&nbsp;<span class="op" id="4802928">=</span>&nbsp;<span class="op" id="4802930">(</span><span class="op" id="4802931">*</span><span class="ident" id="4802932"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4802942">)</span><span class="op" id="4802943">.</span><span class="ident" id="4802944"><a href="/gostd/compress/flate/deflate.go.html#4802159">fillStore</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4802956"><a href="/gostd/compress/flate/deflate.go.html#4802745">d</a></span><span class="op" id="4802957">.</span><span class="ident" id="4802958"><a href="/gostd/compress/flate/deflate.go.html#4793878">step</a></span>&nbsp;<span class="op" id="4802963">=</span>&nbsp;<span class="op" id="4802965">(</span><span class="op" id="4802966">*</span><span class="ident" id="4802967"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4802977">)</span><span class="op" id="4802978">.</span><span class="ident" id="4802979"><a href="/gostd/compress/flate/deflate.go.html#4802275">store</a></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4802986">case</span>&nbsp;<span class="ident" id="4802991"><a href="/gostd/compress/flate/deflate.go.html#4802778">level</a></span>&nbsp;<span class="op" id="4802997">==</span>&nbsp;<span class="ident" id="4803000"><a href="/gostd/compress/flate/deflate.go.html#4792381">DefaultCompression</a></span><span class="op" id="4803018">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803022"><a href="/gostd/compress/flate/deflate.go.html#4802778">level</a></span>&nbsp;<span class="op" id="4803028">=</span>&nbsp;<span class="num" id="4803030">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4803034">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4803047">case</span>&nbsp;<span class="num" id="4803052">1</span>&nbsp;<span class="op" id="4803054">&lt;=</span>&nbsp;<span class="ident" id="4803057"><a href="/gostd/compress/flate/deflate.go.html#4802778">level</a></span>&nbsp;<span class="op" id="4803063">&amp;&amp;</span>&nbsp;<span class="ident" id="4803066"><a href="/gostd/compress/flate/deflate.go.html#4802778">level</a></span>&nbsp;<span class="op" id="4803072">&lt;=</span>&nbsp;<span class="num" id="4803075">9</span><span class="op" id="4803076">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803080"><a href="/gostd/compress/flate/deflate.go.html#4802745">d</a></span><span class="op" id="4803081">.</span><span class="ident" id="4803082"><a href="/gostd/compress/flate/deflate.go.html#4793752">compressionLevel</a></span>&nbsp;<span class="op" id="4803099">=</span>&nbsp;<span class="ident" id="4803101"><a href="/gostd/compress/flate/deflate.go.html#4793268">levels</a></span><span class="op" id="4803107">[</span><span class="ident" id="4803108"><a href="/gostd/compress/flate/deflate.go.html#4802778">level</a></span><span class="op" id="4803113">]</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803117"><a href="/gostd/compress/flate/deflate.go.html#4802745">d</a></span><span class="op" id="4803118">.</span><span class="ident" id="4803119"><a href="/gostd/compress/flate/deflate.go.html#4797549">initDeflate</a></span><span class="op" id="4803130">(</span><span class="op" id="4803131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803135"><a href="/gostd/compress/flate/deflate.go.html#4802745">d</a></span><span class="op" id="4803136">.</span><span class="ident" id="4803137"><a href="/gostd/compress/flate/deflate.go.html#4793819">fill</a></span>&nbsp;<span class="op" id="4803142">=</span>&nbsp;<span class="op" id="4803144">(</span><span class="op" id="4803145">*</span><span class="ident" id="4803146"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4803156">)</span><span class="op" id="4803157">.</span><span class="ident" id="4803158"><a href="/gostd/compress/flate/deflate.go.html#4794775">fillDeflate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803172"><a href="/gostd/compress/flate/deflate.go.html#4802745">d</a></span><span class="op" id="4803173">.</span><span class="ident" id="4803174"><a href="/gostd/compress/flate/deflate.go.html#4793878">step</a></span>&nbsp;<span class="op" id="4803179">=</span>&nbsp;<span class="op" id="4803181">(</span><span class="op" id="4803182">*</span><span class="ident" id="4803183"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4803193">)</span><span class="op" id="4803194">.</span><span class="ident" id="4803195"><a href="/gostd/compress/flate/deflate.go.html#4797885">deflate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4803204">default</span><span class="op" id="4803211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4803215">return</span>&nbsp;<span class="ident" id="4803222"><a href="/gostd/compress/flate/deflate.go.html#4792253">fmt</a></span><span class="op" id="4803225">.</span><span class="ident" id="4803226"><a href="/gostd/fmt/print.go.html#2143886">Errorf</a></span><span class="op" id="4803232">(</span><span class="string" id="4803233">&#34;flate:&nbsp;invalid&nbsp;compression&nbsp;level&nbsp;%d:&nbsp;want&nbsp;value&nbsp;in&nbsp;range&nbsp;[-1,&nbsp;9]&#34;</span><span class="op" id="4803299">,</span>&nbsp;<span class="ident" id="4803301"><a href="/gostd/compress/flate/deflate.go.html#4802778">level</a></span><span class="op" id="4803306">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4803309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4803312">return</span>&nbsp;<span class="builtintype" id="4803319">nil</span><br>
<span class="lineno"></span><span class="op" id="4803323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4803326">var</span>&nbsp;<span class="ident" id="4803330">zeroes</span>&nbsp;<span class="op" id="4803337">[</span><span class="num" id="4803338">32</span><span class="op" id="4803340">]</span><span class="builtintype" id="4803341">int</span><br>
<span class="lineno">420</span><span class="keyword" id="4803345">var</span>&nbsp;<span class="ident" id="4803349">bzeroes</span>&nbsp;<span class="op" id="4803357">[</span><span class="num" id="4803358">256</span><span class="op" id="4803361">]</span><span class="builtintype" id="4803362">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4803368">func</span>&nbsp;<span class="op" id="4803373">(</span><span class="ident" id="4803374">d</span>&nbsp;<span class="op" id="4803376">*</span><span class="ident" id="4803377"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4803387">)</span>&nbsp;<span class="ident" id="4803389">reset</span><span class="op" id="4803394">(</span><span class="ident" id="4803395">w</span>&nbsp;<span class="ident" id="4803397"><a href="/gostd/compress/flate/deflate.go.html#4792260">io</a></span><span class="op" id="4803399">.</span><span class="ident" id="4803400"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="4803406">)</span>&nbsp;<span class="op" id="4803408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803411"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803412">.</span><span class="ident" id="4803413"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4803414">.</span><span class="ident" id="4803415"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4814722">reset</a></span><span class="op" id="4803420">(</span><span class="ident" id="4803421"><a href="/gostd/compress/flate/deflate.go.html#4803395">w</a></span><span class="op" id="4803422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803425"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803426">.</span><span class="ident" id="4803427"><a href="/gostd/compress/flate/deflate.go.html#4793932">sync</a></span>&nbsp;<span class="op" id="4803432">=</span>&nbsp;<span class="builtintype" id="4803434">false</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803441"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803442">.</span><span class="ident" id="4803443"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span>&nbsp;<span class="op" id="4803447">=</span>&nbsp;<span class="builtintype" id="4803449">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4803454">switch</span>&nbsp;<span class="ident" id="4803461"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803462">.</span><span class="ident" id="4803463"><a href="/gostd/compress/flate/deflate.go.html#4793752">compressionLevel</a></span><span class="op" id="4803479">.</span><span class="ident" id="4803480"><a href="/gostd/compress/flate/deflate.go.html#4793234">chain</a></span>&nbsp;<span class="op" id="4803486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4803489">case</span>&nbsp;<span class="num" id="4803494">0</span><span class="op" id="4803495">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4803499">//&nbsp;level&nbsp;was&nbsp;NoCompression.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4803529">for</span>&nbsp;<span class="ident" id="4803533">i</span>&nbsp;<span class="op" id="4803535">:=</span>&nbsp;<span class="keyword" id="4803538">range</span>&nbsp;<span class="ident" id="4803544"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803545">.</span><span class="ident" id="4803546"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span>&nbsp;<span class="op" id="4803553">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803558"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803559">.</span><span class="ident" id="4803560"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4803566">[</span><span class="ident" id="4803567"><a href="/gostd/compress/flate/deflate.go.html#4803533">i</a></span><span class="op" id="4803568">]</span>&nbsp;<span class="op" id="4803570">=</span>&nbsp;<span class="num" id="4803572">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4803576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803580"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803581">.</span><span class="ident" id="4803582"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span>&nbsp;<span class="op" id="4803592">=</span>&nbsp;<span class="num" id="4803594">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4803597">default</span><span class="op" id="4803604">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803608"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803609">.</span><span class="ident" id="4803610"><a href="/gostd/compress/flate/deflate.go.html#4794264">chainHead</a></span>&nbsp;<span class="op" id="4803620">=</span>&nbsp;<span class="op" id="4803622">-</span><span class="num" id="4803623">1</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4803627">for</span>&nbsp;<span class="ident" id="4803631">s</span>&nbsp;<span class="op" id="4803633">:=</span>&nbsp;<span class="ident" id="4803636"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803637">.</span><span class="ident" id="4803638"><a href="/gostd/compress/flate/deflate.go.html#4794280">hashHead</a></span><span class="op" id="4803646">;</span>&nbsp;<span class="builtinfunc" id="4803648">len</span><span class="op" id="4803651">(</span><span class="ident" id="4803652"><a href="/gostd/compress/flate/deflate.go.html#4803631">s</a></span><span class="op" id="4803653">)</span>&nbsp;<span class="op" id="4803655">&gt;</span>&nbsp;<span class="num" id="4803657">0</span><span class="op" id="4803658">;</span>&nbsp;<span class="op" id="4803660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803665">n</span>&nbsp;<span class="op" id="4803667">:=</span>&nbsp;<span class="builtinfunc" id="4803670">copy</span><span class="op" id="4803674">(</span><span class="ident" id="4803675"><a href="/gostd/compress/flate/deflate.go.html#4803631">s</a></span><span class="op" id="4803676">,</span>&nbsp;<span class="ident" id="4803678"><a href="/gostd/compress/flate/deflate.go.html#4803330">zeroes</a></span><span class="op" id="4803684">[</span><span class="op" id="4803685">:</span><span class="op" id="4803686">]</span><span class="op" id="4803687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803692"><a href="/gostd/compress/flate/deflate.go.html#4803631">s</a></span>&nbsp;<span class="op" id="4803694">=</span>&nbsp;<span class="ident" id="4803696"><a href="/gostd/compress/flate/deflate.go.html#4803631">s</a></span><span class="op" id="4803697">[</span><span class="ident" id="4803698"><a href="/gostd/compress/flate/deflate.go.html#4803665">n</a></span><span class="op" id="4803699">:</span><span class="op" id="4803700">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4803704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4803708">for</span>&nbsp;<span class="ident" id="4803712">s</span>&nbsp;<span class="op" id="4803714">:=</span>&nbsp;<span class="ident" id="4803717"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803718">.</span><span class="ident" id="4803719"><a href="/gostd/compress/flate/deflate.go.html#4794298">hashPrev</a></span><span class="op" id="4803727">;</span>&nbsp;<span class="builtinfunc" id="4803729">len</span><span class="op" id="4803732">(</span><span class="ident" id="4803733"><a href="/gostd/compress/flate/deflate.go.html#4803712">s</a></span><span class="op" id="4803734">)</span>&nbsp;<span class="op" id="4803736">&gt;</span>&nbsp;<span class="num" id="4803738">0</span><span class="op" id="4803739">;</span>&nbsp;<span class="ident" id="4803741"><a href="/gostd/compress/flate/deflate.go.html#4803712">s</a></span>&nbsp;<span class="op" id="4803743">=</span>&nbsp;<span class="ident" id="4803745"><a href="/gostd/compress/flate/deflate.go.html#4803712">s</a></span><span class="op" id="4803746">[</span><span class="builtinfunc" id="4803747">len</span><span class="op" id="4803750">(</span><span class="ident" id="4803751"><a href="/gostd/compress/flate/deflate.go.html#4803330">zeroes</a></span><span class="op" id="4803757">)</span><span class="op" id="4803758">:</span><span class="op" id="4803759">]</span>&nbsp;<span class="op" id="4803761">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4803766">copy</span><span class="op" id="4803770">(</span><span class="ident" id="4803771"><a href="/gostd/compress/flate/deflate.go.html#4803712">s</a></span><span class="op" id="4803772">,</span>&nbsp;<span class="ident" id="4803774"><a href="/gostd/compress/flate/deflate.go.html#4803330">zeroes</a></span><span class="op" id="4803780">[</span><span class="op" id="4803781">:</span><span class="op" id="4803782">]</span><span class="op" id="4803783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4803787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803791"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803792">.</span><span class="ident" id="4803793"><a href="/gostd/compress/flate/deflate.go.html#4794316">hashOffset</a></span>&nbsp;<span class="op" id="4803804">=</span>&nbsp;<span class="num" id="4803806">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803811"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803812">.</span><span class="ident" id="4803813"><a href="/gostd/compress/flate/deflate.go.html#4794395">index</a></span><span class="op" id="4803818">,</span>&nbsp;<span class="ident" id="4803820"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803821">.</span><span class="ident" id="4803822"><a href="/gostd/compress/flate/deflate.go.html#4794436">windowEnd</a></span>&nbsp;<span class="op" id="4803832">=</span>&nbsp;<span class="num" id="4803834">0</span><span class="op" id="4803835">,</span>&nbsp;<span class="num" id="4803837">0</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4803841">for</span>&nbsp;<span class="ident" id="4803845">s</span>&nbsp;<span class="op" id="4803847">:=</span>&nbsp;<span class="ident" id="4803850"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803851">.</span><span class="ident" id="4803852"><a href="/gostd/compress/flate/deflate.go.html#4794414">window</a></span><span class="op" id="4803858">;</span>&nbsp;<span class="builtinfunc" id="4803860">len</span><span class="op" id="4803863">(</span><span class="ident" id="4803864"><a href="/gostd/compress/flate/deflate.go.html#4803845">s</a></span><span class="op" id="4803865">)</span>&nbsp;<span class="op" id="4803867">&gt;</span>&nbsp;<span class="num" id="4803869">0</span><span class="op" id="4803870">;</span>&nbsp;<span class="op" id="4803872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803877">n</span>&nbsp;<span class="op" id="4803879">:=</span>&nbsp;<span class="builtinfunc" id="4803882">copy</span><span class="op" id="4803886">(</span><span class="ident" id="4803887"><a href="/gostd/compress/flate/deflate.go.html#4803845">s</a></span><span class="op" id="4803888">,</span>&nbsp;<span class="ident" id="4803890"><a href="/gostd/compress/flate/deflate.go.html#4803349">bzeroes</a></span><span class="op" id="4803897">[</span><span class="op" id="4803898">:</span><span class="op" id="4803899">]</span><span class="op" id="4803900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803905"><a href="/gostd/compress/flate/deflate.go.html#4803845">s</a></span>&nbsp;<span class="op" id="4803907">=</span>&nbsp;<span class="ident" id="4803909"><a href="/gostd/compress/flate/deflate.go.html#4803845">s</a></span><span class="op" id="4803910">[</span><span class="ident" id="4803911"><a href="/gostd/compress/flate/deflate.go.html#4803877">n</a></span><span class="op" id="4803912">:</span><span class="op" id="4803913">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4803917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803921"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803922">.</span><span class="ident" id="4803923"><a href="/gostd/compress/flate/deflate.go.html#4794455">blockStart</a></span><span class="op" id="4803933">,</span>&nbsp;<span class="ident" id="4803935"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803936">.</span><span class="ident" id="4803937"><a href="/gostd/compress/flate/deflate.go.html#4794518">byteAvailable</a></span>&nbsp;<span class="op" id="4803951">=</span>&nbsp;<span class="num" id="4803953">0</span><span class="op" id="4803954">,</span>&nbsp;<span class="builtintype" id="4803956">false</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4803965"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803966">.</span><span class="ident" id="4803967"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span>&nbsp;<span class="op" id="4803974">=</span>&nbsp;<span class="ident" id="4803976"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4803977">.</span><span class="ident" id="4803978"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4803984">[</span><span class="op" id="4803985">:</span><span class="ident" id="4803986"><a href="/gostd/compress/flate/deflate.go.html#4792885">maxFlateBlockTokens</a></span><span class="op" id="4804005">+</span><span class="num" id="4804006">1</span><span class="op" id="4804007">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4804011">for</span>&nbsp;<span class="ident" id="4804015">i</span>&nbsp;<span class="op" id="4804017">:=</span>&nbsp;<span class="num" id="4804020">0</span><span class="op" id="4804021">;</span>&nbsp;<span class="ident" id="4804023"><a href="/gostd/compress/flate/deflate.go.html#4804015">i</a></span>&nbsp;<span class="op" id="4804025">&lt;=</span>&nbsp;<span class="ident" id="4804028"><a href="/gostd/compress/flate/deflate.go.html#4792885">maxFlateBlockTokens</a></span><span class="op" id="4804047">;</span>&nbsp;<span class="ident" id="4804049"><a href="/gostd/compress/flate/deflate.go.html#4804015">i</a></span><span class="op" id="4804050">++</span>&nbsp;<span class="op" id="4804053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4804058"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4804059">.</span><span class="ident" id="4804060"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4804066">[</span><span class="ident" id="4804067"><a href="/gostd/compress/flate/deflate.go.html#4804015">i</a></span><span class="op" id="4804068">]</span>&nbsp;<span class="op" id="4804070">=</span>&nbsp;<span class="num" id="4804072">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4804076">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4804080"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4804081">.</span><span class="ident" id="4804082"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span>&nbsp;<span class="op" id="4804089">=</span>&nbsp;<span class="ident" id="4804091"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4804092">.</span><span class="ident" id="4804093"><a href="/gostd/compress/flate/deflate.go.html#4794615">tokens</a></span><span class="op" id="4804099">[</span><span class="op" id="4804100">:</span><span class="num" id="4804101">0</span><span class="op" id="4804102">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4804106"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4804107">.</span><span class="ident" id="4804108"><a href="/gostd/compress/flate/deflate.go.html#4794650">length</a></span>&nbsp;<span class="op" id="4804115">=</span>&nbsp;<span class="ident" id="4804117"><a href="/gostd/compress/flate/deflate.go.html#4792555">minMatchLength</a></span>&nbsp;<span class="op" id="4804132">-</span>&nbsp;<span class="num" id="4804134">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4804138"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4804139">.</span><span class="ident" id="4804140"><a href="/gostd/compress/flate/deflate.go.html#4794670">offset</a></span>&nbsp;<span class="op" id="4804147">=</span>&nbsp;<span class="num" id="4804149">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4804153"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4804154">.</span><span class="ident" id="4804155"><a href="/gostd/compress/flate/deflate.go.html#4794690">hash</a></span>&nbsp;<span class="op" id="4804160">=</span>&nbsp;<span class="num" id="4804162">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4804166"><a href="/gostd/compress/flate/deflate.go.html#4803374">d</a></span><span class="op" id="4804167">.</span><span class="ident" id="4804168"><a href="/gostd/compress/flate/deflate.go.html#4794710">maxInsertIndex</a></span>&nbsp;<span class="op" id="4804183">=</span>&nbsp;<span class="num" id="4804185">0</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4804188">}</span><br>
<span class="lineno"></span><span class="op" id="4804190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4804193">func</span>&nbsp;<span class="op" id="4804198">(</span><span class="ident" id="4804199">d</span>&nbsp;<span class="op" id="4804201">*</span><span class="ident" id="4804202"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><span class="op" id="4804212">)</span>&nbsp;<span class="builtinfunc" id="4804214">close</span><span class="op" id="4804219">(</span><span class="op" id="4804220">)</span>&nbsp;<span class="builtintype" id="4804222">error</span>&nbsp;<span class="op" id="4804228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4804231"><a href="/gostd/compress/flate/deflate.go.html#4804199">d</a></span><span class="op" id="4804232">.</span><span class="ident" id="4804233"><a href="/gostd/compress/flate/deflate.go.html#4793932">sync</a></span>&nbsp;<span class="op" id="4804238">=</span>&nbsp;<span class="builtintype" id="4804240">true</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4804246"><a href="/gostd/compress/flate/deflate.go.html#4804199">d</a></span><span class="op" id="4804247">.</span><span class="ident" id="4804248"><a href="/gostd/compress/flate/deflate.go.html#4793878">step</a></span><span class="op" id="4804252">(</span><span class="ident" id="4804253"><a href="/gostd/compress/flate/deflate.go.html#4804199">d</a></span><span class="op" id="4804254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4804257">if</span>&nbsp;<span class="ident" id="4804260"><a href="/gostd/compress/flate/deflate.go.html#4804199">d</a></span><span class="op" id="4804261">.</span><span class="ident" id="4804262"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span>&nbsp;<span class="op" id="4804266">!=</span>&nbsp;<span class="builtintype" id="4804269">nil</span>&nbsp;<span class="op" id="4804273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4804277">return</span>&nbsp;<span class="ident" id="4804284"><a href="/gostd/compress/flate/deflate.go.html#4804199">d</a></span><span class="op" id="4804285">.</span><span class="ident" id="4804286"><a href="/gostd/compress/flate/deflate.go.html#4794730">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4804291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4804294">if</span>&nbsp;<span class="ident" id="4804297"><a href="/gostd/compress/flate/deflate.go.html#4804199">d</a></span><span class="op" id="4804298">.</span><span class="ident" id="4804299"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4804300">.</span><span class="ident" id="4804301"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4820333">writeStoredHeader</a></span><span class="op" id="4804318">(</span><span class="num" id="4804319">0</span><span class="op" id="4804320">,</span>&nbsp;<span class="builtintype" id="4804322">true</span><span class="op" id="4804326">)</span><span class="op" id="4804327">;</span>&nbsp;<span class="ident" id="4804329"><a href="/gostd/compress/flate/deflate.go.html#4804199">d</a></span><span class="op" id="4804330">.</span><span class="ident" id="4804331"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4804332">.</span><span class="ident" id="4804333"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4814195">err</a></span>&nbsp;<span class="op" id="4804337">!=</span>&nbsp;<span class="builtintype" id="4804340">nil</span>&nbsp;<span class="op" id="4804344">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4804348">return</span>&nbsp;<span class="ident" id="4804355"><a href="/gostd/compress/flate/deflate.go.html#4804199">d</a></span><span class="op" id="4804356">.</span><span class="ident" id="4804357"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4804358">.</span><span class="ident" id="4804359"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4814195">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4804364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4804367"><a href="/gostd/compress/flate/deflate.go.html#4804199">d</a></span><span class="op" id="4804368">.</span><span class="ident" id="4804369"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4804370">.</span><span class="ident" id="4804371"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4815551">flush</a></span><span class="op" id="4804376">(</span><span class="op" id="4804377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4804380">return</span>&nbsp;<span class="ident" id="4804387"><a href="/gostd/compress/flate/deflate.go.html#4804199">d</a></span><span class="op" id="4804388">.</span><span class="ident" id="4804389"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4804390">.</span><span class="ident" id="4804391"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4814195">err</a></span><br>
<span class="lineno"></span><span class="op" id="4804395">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="4804398">//&nbsp;NewWriter&nbsp;returns&nbsp;a&nbsp;new&nbsp;Writer&nbsp;compressing&nbsp;data&nbsp;at&nbsp;the&nbsp;given&nbsp;level.</span><br>
<span class="lineno"></span><span class="comment" id="4804469">//&nbsp;Following&nbsp;zlib,&nbsp;levels&nbsp;range&nbsp;from&nbsp;1&nbsp;(BestSpeed)&nbsp;to&nbsp;9&nbsp;(BestCompression);</span><br>
<span class="lineno"></span><span class="comment" id="4804544">//&nbsp;higher&nbsp;levels&nbsp;typically&nbsp;run&nbsp;slower&nbsp;but&nbsp;compress&nbsp;more.&nbsp;Level&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="4804609">//&nbsp;(NoCompression)&nbsp;does&nbsp;not&nbsp;attempt&nbsp;any&nbsp;compression;&nbsp;it&nbsp;only&nbsp;adds&nbsp;the</span><br>
<span class="lineno">480</span><span class="comment" id="4804679">//&nbsp;necessary&nbsp;DEFLATE&nbsp;framing.&nbsp;Level&nbsp;-1&nbsp;(DefaultCompression)&nbsp;uses&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="4804756">//&nbsp;compression&nbsp;level.</span><br>
<span class="lineno"></span><span class="comment" id="4804778">//</span><br>
<span class="lineno"></span><span class="comment" id="4804781">//&nbsp;If&nbsp;level&nbsp;is&nbsp;in&nbsp;the&nbsp;range&nbsp;[-1,&nbsp;9]&nbsp;then&nbsp;the&nbsp;error&nbsp;returned&nbsp;will&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="4804854">//&nbsp;Otherwise&nbsp;the&nbsp;error&nbsp;returned&nbsp;will&nbsp;be&nbsp;non-nil.</span><br>
<span class="lineno">485</span><span class="keyword" id="4804903">func</span>&nbsp;<span class="ident" id="4804908">NewWriter</span><span class="op" id="4804917">(</span><span class="ident" id="4804918">w</span>&nbsp;<span class="ident" id="4804920"><a href="/gostd/compress/flate/deflate.go.html#4792260">io</a></span><span class="op" id="4804922">.</span><span class="ident" id="4804923"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="4804929">,</span>&nbsp;<span class="ident" id="4804931">level</span>&nbsp;<span class="builtintype" id="4804937">int</span><span class="op" id="4804940">)</span>&nbsp;<span class="op" id="4804942">(</span><span class="op" id="4804943">*</span><span class="ident" id="4804944"><a href="/gostd/compress/flate/deflate.go.html#4806024">Writer</a></span><span class="op" id="4804950">,</span>&nbsp;<span class="builtintype" id="4804952">error</span><span class="op" id="4804957">)</span>&nbsp;<span class="op" id="4804959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4804962">var</span>&nbsp;<span class="ident" id="4804966">dw</span>&nbsp;<span class="ident" id="4804969"><a href="/gostd/compress/flate/deflate.go.html#4806024">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4804977">if</span>&nbsp;<span class="ident" id="4804980">err</span>&nbsp;<span class="op" id="4804984">:=</span>&nbsp;<span class="ident" id="4804987"><a href="/gostd/compress/flate/deflate.go.html#4804966">dw</a></span><span class="op" id="4804989">.</span><span class="ident" id="4804990"><a href="/gostd/compress/flate/deflate.go.html#4806041">d</a></span><span class="op" id="4804991">.</span><span class="ident" id="4804992"><a href="/gostd/compress/flate/deflate.go.html#4802760">init</a></span><span class="op" id="4804996">(</span><span class="ident" id="4804997"><a href="/gostd/compress/flate/deflate.go.html#4804918">w</a></span><span class="op" id="4804998">,</span>&nbsp;<span class="ident" id="4805000"><a href="/gostd/compress/flate/deflate.go.html#4804931">level</a></span><span class="op" id="4805005">)</span><span class="op" id="4805006">;</span>&nbsp;<span class="ident" id="4805008"><a href="/gostd/compress/flate/deflate.go.html#4804980">err</a></span>&nbsp;<span class="op" id="4805012">!=</span>&nbsp;<span class="builtintype" id="4805015">nil</span>&nbsp;<span class="op" id="4805019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4805023">return</span>&nbsp;<span class="builtintype" id="4805030">nil</span><span class="op" id="4805033">,</span>&nbsp;<span class="ident" id="4805035"><a href="/gostd/compress/flate/deflate.go.html#4804980">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4805040">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4805043">return</span>&nbsp;<span class="op" id="4805050">&amp;</span><span class="ident" id="4805051"><a href="/gostd/compress/flate/deflate.go.html#4804966">dw</a></span><span class="op" id="4805053">,</span>&nbsp;<span class="builtintype" id="4805055">nil</span><br>
<span class="lineno"></span><span class="op" id="4805059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4805062">//&nbsp;NewWriterDict&nbsp;is&nbsp;like&nbsp;NewWriter&nbsp;but&nbsp;initializes&nbsp;the&nbsp;new</span><br>
<span class="lineno"></span><span class="comment" id="4805121">//&nbsp;Writer&nbsp;with&nbsp;a&nbsp;preset&nbsp;dictionary.&nbsp;&nbsp;The&nbsp;returned&nbsp;Writer&nbsp;behaves</span><br>
<span class="lineno">495</span><span class="comment" id="4805186">//&nbsp;as&nbsp;if&nbsp;the&nbsp;dictionary&nbsp;had&nbsp;been&nbsp;written&nbsp;to&nbsp;it&nbsp;without&nbsp;producing</span><br>
<span class="lineno"></span><span class="comment" id="4805251">//&nbsp;any&nbsp;compressed&nbsp;output.&nbsp;&nbsp;The&nbsp;compressed&nbsp;data&nbsp;written&nbsp;to&nbsp;w</span><br>
<span class="lineno"></span><span class="comment" id="4805311">//&nbsp;can&nbsp;only&nbsp;be&nbsp;decompressed&nbsp;by&nbsp;a&nbsp;Reader&nbsp;initialized&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4805372">//&nbsp;same&nbsp;dictionary.</span><br>
<span class="lineno"></span><span class="keyword" id="4805392">func</span>&nbsp;<span class="ident" id="4805397">NewWriterDict</span><span class="op" id="4805410">(</span><span class="ident" id="4805411">w</span>&nbsp;<span class="ident" id="4805413"><a href="/gostd/compress/flate/deflate.go.html#4792260">io</a></span><span class="op" id="4805415">.</span><span class="ident" id="4805416"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="4805422">,</span>&nbsp;<span class="ident" id="4805424">level</span>&nbsp;<span class="builtintype" id="4805430">int</span><span class="op" id="4805433">,</span>&nbsp;<span class="ident" id="4805435">dict</span>&nbsp;<span class="op" id="4805440">[</span><span class="op" id="4805441">]</span><span class="builtintype" id="4805442">byte</span><span class="op" id="4805446">)</span>&nbsp;<span class="op" id="4805448">(</span><span class="op" id="4805449">*</span><span class="ident" id="4805450"><a href="/gostd/compress/flate/deflate.go.html#4806024">Writer</a></span><span class="op" id="4805456">,</span>&nbsp;<span class="builtintype" id="4805458">error</span><span class="op" id="4805463">)</span>&nbsp;<span class="op" id="4805465">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4805468">dw</span>&nbsp;<span class="op" id="4805471">:=</span>&nbsp;<span class="op" id="4805474">&amp;</span><span class="ident" id="4805475"><a href="/gostd/compress/flate/deflate.go.html#4805716">dictWriter</a></span><span class="op" id="4805485">{</span><span class="ident" id="4805486"><a href="/gostd/compress/flate/deflate.go.html#4805411">w</a></span><span class="op" id="4805487">,</span>&nbsp;<span class="builtintype" id="4805489">false</span><span class="op" id="4805494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4805497">zw</span><span class="op" id="4805499">,</span>&nbsp;<span class="ident" id="4805501">err</span>&nbsp;<span class="op" id="4805505">:=</span>&nbsp;<span class="ident" id="4805508"><a href="/gostd/compress/flate/deflate.go.html#4804908">NewWriter</a></span><span class="op" id="4805517">(</span><span class="ident" id="4805518"><a href="/gostd/compress/flate/deflate.go.html#4805468">dw</a></span><span class="op" id="4805520">,</span>&nbsp;<span class="ident" id="4805522"><a href="/gostd/compress/flate/deflate.go.html#4805424">level</a></span><span class="op" id="4805527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4805530">if</span>&nbsp;<span class="ident" id="4805533"><a href="/gostd/compress/flate/deflate.go.html#4805501">err</a></span>&nbsp;<span class="op" id="4805537">!=</span>&nbsp;<span class="builtintype" id="4805540">nil</span>&nbsp;<span class="op" id="4805544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4805548">return</span>&nbsp;<span class="builtintype" id="4805555">nil</span><span class="op" id="4805558">,</span>&nbsp;<span class="ident" id="4805560"><a href="/gostd/compress/flate/deflate.go.html#4805501">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4805565">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4805568"><a href="/gostd/compress/flate/deflate.go.html#4805497">zw</a></span><span class="op" id="4805570">.</span><span class="ident" id="4805571"><a href="/gostd/compress/flate/deflate.go.html#4806202">Write</a></span><span class="op" id="4805576">(</span><span class="ident" id="4805577"><a href="/gostd/compress/flate/deflate.go.html#4805435">dict</a></span><span class="op" id="4805581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4805584"><a href="/gostd/compress/flate/deflate.go.html#4805497">zw</a></span><span class="op" id="4805586">.</span><span class="ident" id="4805587"><a href="/gostd/compress/flate/deflate.go.html#4806701">Flush</a></span><span class="op" id="4805592">(</span><span class="op" id="4805593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4805596"><a href="/gostd/compress/flate/deflate.go.html#4805468">dw</a></span><span class="op" id="4805598">.</span><span class="ident" id="4805599"><a href="/gostd/compress/flate/deflate.go.html#4805756">enabled</a></span>&nbsp;<span class="op" id="4805607">=</span>&nbsp;<span class="builtintype" id="4805609">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4805615"><a href="/gostd/compress/flate/deflate.go.html#4805497">zw</a></span><span class="op" id="4805617">.</span><span class="ident" id="4805618"><a href="/gostd/compress/flate/deflate.go.html#4806058">dict</a></span>&nbsp;<span class="op" id="4805623">=</span>&nbsp;<span class="builtinfunc" id="4805625">append</span><span class="op" id="4805631">(</span><span class="ident" id="4805632"><a href="/gostd/compress/flate/deflate.go.html#4805497">zw</a></span><span class="op" id="4805634">.</span><span class="ident" id="4805635"><a href="/gostd/compress/flate/deflate.go.html#4806058">dict</a></span><span class="op" id="4805639">,</span>&nbsp;<span class="ident" id="4805641"><a href="/gostd/compress/flate/deflate.go.html#4805435">dict</a></span><span class="op" id="4805645">...</span><span class="op" id="4805648">)</span>&nbsp;<span class="comment" id="4805650">//&nbsp;duplicate&nbsp;dictionary&nbsp;for&nbsp;Reset&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4805693">return</span>&nbsp;<span class="ident" id="4805700"><a href="/gostd/compress/flate/deflate.go.html#4805497">zw</a></span><span class="op" id="4805702">,</span>&nbsp;<span class="ident" id="4805704"><a href="/gostd/compress/flate/deflate.go.html#4805501">err</a></span><br>
<span class="lineno">510</span><span class="op" id="4805708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4805711">type</span>&nbsp;<span class="ident" id="4805716">dictWriter</span>&nbsp;<span class="keyword" id="4805727">struct</span>&nbsp;<span class="op" id="4805734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4805737">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4805745"><a href="/gostd/compress/flate/deflate.go.html#4792260">io</a></span><span class="op" id="4805747">.</span><span class="ident" id="4805748"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4805756">enabled</span>&nbsp;<span class="builtintype" id="4805764">bool</span><br>
<span class="lineno">515</span><span class="op" id="4805769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4805772">func</span>&nbsp;<span class="op" id="4805777">(</span><span class="ident" id="4805778">w</span>&nbsp;<span class="op" id="4805780">*</span><span class="ident" id="4805781"><a href="/gostd/compress/flate/deflate.go.html#4805716">dictWriter</a></span><span class="op" id="4805791">)</span>&nbsp;<span class="ident" id="4805793">Write</span><span class="op" id="4805798">(</span><span class="ident" id="4805799">b</span>&nbsp;<span class="op" id="4805801">[</span><span class="op" id="4805802">]</span><span class="builtintype" id="4805803">byte</span><span class="op" id="4805807">)</span>&nbsp;<span class="op" id="4805809">(</span><span class="ident" id="4805810">n</span>&nbsp;<span class="builtintype" id="4805812">int</span><span class="op" id="4805815">,</span>&nbsp;<span class="ident" id="4805817">err</span>&nbsp;<span class="builtintype" id="4805821">error</span><span class="op" id="4805826">)</span>&nbsp;<span class="op" id="4805828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4805831">if</span>&nbsp;<span class="ident" id="4805834"><a href="/gostd/compress/flate/deflate.go.html#4805778">w</a></span><span class="op" id="4805835">.</span><span class="ident" id="4805836"><a href="/gostd/compress/flate/deflate.go.html#4805756">enabled</a></span>&nbsp;<span class="op" id="4805844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4805848">return</span>&nbsp;<span class="ident" id="4805855"><a href="/gostd/compress/flate/deflate.go.html#4805778">w</a></span><span class="op" id="4805856">.</span><span class="ident" id="4805857"><a href="/gostd/compress/flate/deflate.go.html#4805737">w</a></span><span class="op" id="4805858">.</span><span class="ident" id="4805859"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="4805864">(</span><span class="ident" id="4805865"><a href="/gostd/compress/flate/deflate.go.html#4805799">b</a></span><span class="op" id="4805866">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4805869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4805872">return</span>&nbsp;<span class="builtinfunc" id="4805879">len</span><span class="op" id="4805882">(</span><span class="ident" id="4805883"><a href="/gostd/compress/flate/deflate.go.html#4805799">b</a></span><span class="op" id="4805884">)</span><span class="op" id="4805885">,</span>&nbsp;<span class="builtintype" id="4805887">nil</span><br>
<span class="lineno"></span><span class="op" id="4805891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4805894">//&nbsp;A&nbsp;Writer&nbsp;takes&nbsp;data&nbsp;written&nbsp;to&nbsp;it&nbsp;and&nbsp;writes&nbsp;the&nbsp;compressed</span><br>
<span class="lineno">525</span><span class="comment" id="4805957">//&nbsp;form&nbsp;of&nbsp;that&nbsp;data&nbsp;to&nbsp;an&nbsp;underlying&nbsp;writer&nbsp;(see&nbsp;NewWriter).</span><br>
<span class="lineno"></span><span class="keyword" id="4806019">type</span>&nbsp;<span class="ident" id="4806024">Writer</span>&nbsp;<span class="keyword" id="4806031">struct</span>&nbsp;<span class="op" id="4806038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4806041">d</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4806046"><a href="/gostd/compress/flate/deflate.go.html#4793731">compressor</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4806058">dict</span>&nbsp;<span class="op" id="4806063">[</span><span class="op" id="4806064">]</span><span class="builtintype" id="4806065">byte</span><br>
<span class="lineno"></span><span class="op" id="4806070">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="comment" id="4806073">//&nbsp;Write&nbsp;writes&nbsp;data&nbsp;to&nbsp;w,&nbsp;which&nbsp;will&nbsp;eventually&nbsp;write&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4806132">//&nbsp;compressed&nbsp;form&nbsp;of&nbsp;data&nbsp;to&nbsp;its&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno"></span><span class="keyword" id="4806185">func</span>&nbsp;<span class="op" id="4806190">(</span><span class="ident" id="4806191">w</span>&nbsp;<span class="op" id="4806193">*</span><span class="ident" id="4806194"><a href="/gostd/compress/flate/deflate.go.html#4806024">Writer</a></span><span class="op" id="4806200">)</span>&nbsp;<span class="ident" id="4806202">Write</span><span class="op" id="4806207">(</span><span class="ident" id="4806208">data</span>&nbsp;<span class="op" id="4806213">[</span><span class="op" id="4806214">]</span><span class="builtintype" id="4806215">byte</span><span class="op" id="4806219">)</span>&nbsp;<span class="op" id="4806221">(</span><span class="ident" id="4806222">n</span>&nbsp;<span class="builtintype" id="4806224">int</span><span class="op" id="4806227">,</span>&nbsp;<span class="ident" id="4806229">err</span>&nbsp;<span class="builtintype" id="4806233">error</span><span class="op" id="4806238">)</span>&nbsp;<span class="op" id="4806240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4806243">return</span>&nbsp;<span class="ident" id="4806250"><a href="/gostd/compress/flate/deflate.go.html#4806191">w</a></span><span class="op" id="4806251">.</span><span class="ident" id="4806252"><a href="/gostd/compress/flate/deflate.go.html#4806041">d</a></span><span class="op" id="4806253">.</span><span class="ident" id="4806254"><a href="/gostd/compress/flate/deflate.go.html#4802404">write</a></span><span class="op" id="4806259">(</span><span class="ident" id="4806260"><a href="/gostd/compress/flate/deflate.go.html#4806208">data</a></span><span class="op" id="4806264">)</span><br>
<span class="lineno">535</span><span class="op" id="4806266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4806269">//&nbsp;Flush&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;compressed&nbsp;data&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4806340">//&nbsp;It&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;in&nbsp;compressed&nbsp;network&nbsp;protocols,&nbsp;to&nbsp;ensure&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4806411">//&nbsp;a&nbsp;remote&nbsp;reader&nbsp;has&nbsp;enough&nbsp;data&nbsp;to&nbsp;reconstruct&nbsp;a&nbsp;packet.</span><br>
<span class="lineno">540</span><span class="comment" id="4806471">//&nbsp;Flush&nbsp;does&nbsp;not&nbsp;return&nbsp;until&nbsp;the&nbsp;data&nbsp;has&nbsp;been&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="4806529">//&nbsp;If&nbsp;the&nbsp;underlying&nbsp;writer&nbsp;returns&nbsp;an&nbsp;error,&nbsp;Flush&nbsp;returns&nbsp;that&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4806601">//</span><br>
<span class="lineno"></span><span class="comment" id="4806604">//&nbsp;In&nbsp;the&nbsp;terminology&nbsp;of&nbsp;the&nbsp;zlib&nbsp;library,&nbsp;Flush&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;Z_SYNC_FLUSH.</span><br>
<span class="lineno"></span><span class="keyword" id="4806684">func</span>&nbsp;<span class="op" id="4806689">(</span><span class="ident" id="4806690">w</span>&nbsp;<span class="op" id="4806692">*</span><span class="ident" id="4806693"><a href="/gostd/compress/flate/deflate.go.html#4806024">Writer</a></span><span class="op" id="4806699">)</span>&nbsp;<span class="ident" id="4806701">Flush</span><span class="op" id="4806706">(</span><span class="op" id="4806707">)</span>&nbsp;<span class="builtintype" id="4806709">error</span>&nbsp;<span class="op" id="4806715">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4806718">//&nbsp;For&nbsp;more&nbsp;about&nbsp;flushing:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4806747">//&nbsp;http://www.bolet.org/~pornin/deflate-flush.html</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4806799">return</span>&nbsp;<span class="ident" id="4806806"><a href="/gostd/compress/flate/deflate.go.html#4806690">w</a></span><span class="op" id="4806807">.</span><span class="ident" id="4806808"><a href="/gostd/compress/flate/deflate.go.html#4806041">d</a></span><span class="op" id="4806809">.</span><span class="ident" id="4806810"><a href="/gostd/compress/flate/deflate.go.html#4802572">syncFlush</a></span><span class="op" id="4806819">(</span><span class="op" id="4806820">)</span><br>
<span class="lineno"></span><span class="op" id="4806822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="comment" id="4806825">//&nbsp;Close&nbsp;flushes&nbsp;and&nbsp;closes&nbsp;the&nbsp;writer.</span><br>
<span class="lineno"></span><span class="keyword" id="4806865">func</span>&nbsp;<span class="op" id="4806870">(</span><span class="ident" id="4806871">w</span>&nbsp;<span class="op" id="4806873">*</span><span class="ident" id="4806874"><a href="/gostd/compress/flate/deflate.go.html#4806024">Writer</a></span><span class="op" id="4806880">)</span>&nbsp;<span class="ident" id="4806882">Close</span><span class="op" id="4806887">(</span><span class="op" id="4806888">)</span>&nbsp;<span class="builtintype" id="4806890">error</span>&nbsp;<span class="op" id="4806896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4806899">return</span>&nbsp;<span class="ident" id="4806906"><a href="/gostd/compress/flate/deflate.go.html#4806871">w</a></span><span class="op" id="4806907">.</span><span class="ident" id="4806908"><a href="/gostd/compress/flate/deflate.go.html#4806041">d</a></span><span class="op" id="4806909">.</span><span class="builtinfunc" id="4806910"><a href="/gostd/compress/flate/deflate.go.html#4804214">close</a></span><span class="op" id="4806915">(</span><span class="op" id="4806916">)</span><br>
<span class="lineno"></span><span class="op" id="4806918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="comment" id="4806921">//&nbsp;Reset&nbsp;discards&nbsp;the&nbsp;writer&#39;s&nbsp;state&nbsp;and&nbsp;makes&nbsp;it&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4806985">//&nbsp;the&nbsp;result&nbsp;of&nbsp;NewWriter&nbsp;or&nbsp;NewWriterDict&nbsp;called&nbsp;with&nbsp;dst</span><br>
<span class="lineno"></span><span class="comment" id="4807045">//&nbsp;and&nbsp;w&#39;s&nbsp;level&nbsp;and&nbsp;dictionary.</span><br>
<span class="lineno"></span><span class="keyword" id="4807078">func</span>&nbsp;<span class="op" id="4807083">(</span><span class="ident" id="4807084">w</span>&nbsp;<span class="op" id="4807086">*</span><span class="ident" id="4807087"><a href="/gostd/compress/flate/deflate.go.html#4806024">Writer</a></span><span class="op" id="4807093">)</span>&nbsp;<span class="ident" id="4807095">Reset</span><span class="op" id="4807100">(</span><span class="ident" id="4807101">dst</span>&nbsp;<span class="ident" id="4807105"><a href="/gostd/compress/flate/deflate.go.html#4792260">io</a></span><span class="op" id="4807107">.</span><span class="ident" id="4807108"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="4807114">)</span>&nbsp;<span class="op" id="4807116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4807119">if</span>&nbsp;<span class="ident" id="4807122">dw</span><span class="op" id="4807124">,</span>&nbsp;<span class="ident" id="4807126">ok</span>&nbsp;<span class="op" id="4807129">:=</span>&nbsp;<span class="ident" id="4807132"><a href="/gostd/compress/flate/deflate.go.html#4807084">w</a></span><span class="op" id="4807133">.</span><span class="ident" id="4807134"><a href="/gostd/compress/flate/deflate.go.html#4806041">d</a></span><span class="op" id="4807135">.</span><span class="ident" id="4807136"><a href="/gostd/compress/flate/deflate.go.html#4793771">w</a></span><span class="op" id="4807137">.</span><span class="ident" id="4807138"><a href="/gostd/compress/flate/huffman_bit_writer.go.html#4813802">w</a></span><span class="op" id="4807139">.</span><span class="op" id="4807140">(</span><span class="op" id="4807141">*</span><span class="ident" id="4807142"><a href="/gostd/compress/flate/deflate.go.html#4805716">dictWriter</a></span><span class="op" id="4807152">)</span><span class="op" id="4807153">;</span>&nbsp;<span class="ident" id="4807155"><a href="/gostd/compress/flate/deflate.go.html#4807126">ok</a></span>&nbsp;<span class="op" id="4807158">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4807162">//&nbsp;w&nbsp;was&nbsp;created&nbsp;with&nbsp;NewWriterDict</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807200"><a href="/gostd/compress/flate/deflate.go.html#4807122">dw</a></span><span class="op" id="4807202">.</span><span class="ident" id="4807203"><a href="/gostd/compress/flate/deflate.go.html#4805737">w</a></span>&nbsp;<span class="op" id="4807205">=</span>&nbsp;<span class="ident" id="4807207"><a href="/gostd/compress/flate/deflate.go.html#4807101">dst</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807213"><a href="/gostd/compress/flate/deflate.go.html#4807084">w</a></span><span class="op" id="4807214">.</span><span class="ident" id="4807215"><a href="/gostd/compress/flate/deflate.go.html#4806041">d</a></span><span class="op" id="4807216">.</span><span class="ident" id="4807217"><a href="/gostd/compress/flate/deflate.go.html#4803389">reset</a></span><span class="op" id="4807222">(</span><span class="ident" id="4807223"><a href="/gostd/compress/flate/deflate.go.html#4807122">dw</a></span><span class="op" id="4807225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807229"><a href="/gostd/compress/flate/deflate.go.html#4807122">dw</a></span><span class="op" id="4807231">.</span><span class="ident" id="4807232"><a href="/gostd/compress/flate/deflate.go.html#4805756">enabled</a></span>&nbsp;<span class="op" id="4807240">=</span>&nbsp;<span class="builtintype" id="4807242">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807250"><a href="/gostd/compress/flate/deflate.go.html#4807084">w</a></span><span class="op" id="4807251">.</span><span class="ident" id="4807252"><a href="/gostd/compress/flate/deflate.go.html#4806202">Write</a></span><span class="op" id="4807257">(</span><span class="ident" id="4807258"><a href="/gostd/compress/flate/deflate.go.html#4807084">w</a></span><span class="op" id="4807259">.</span><span class="ident" id="4807260"><a href="/gostd/compress/flate/deflate.go.html#4806058">dict</a></span><span class="op" id="4807264">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807268"><a href="/gostd/compress/flate/deflate.go.html#4807084">w</a></span><span class="op" id="4807269">.</span><span class="ident" id="4807270"><a href="/gostd/compress/flate/deflate.go.html#4806701">Flush</a></span><span class="op" id="4807275">(</span><span class="op" id="4807276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807280"><a href="/gostd/compress/flate/deflate.go.html#4807122">dw</a></span><span class="op" id="4807282">.</span><span class="ident" id="4807283"><a href="/gostd/compress/flate/deflate.go.html#4805756">enabled</a></span>&nbsp;<span class="op" id="4807291">=</span>&nbsp;<span class="builtintype" id="4807293">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4807299">}</span>&nbsp;<span class="keyword" id="4807301">else</span>&nbsp;<span class="op" id="4807306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4807310">//&nbsp;w&nbsp;was&nbsp;created&nbsp;with&nbsp;NewWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4807344"><a href="/gostd/compress/flate/deflate.go.html#4807084">w</a></span><span class="op" id="4807345">.</span><span class="ident" id="4807346"><a href="/gostd/compress/flate/deflate.go.html#4806041">d</a></span><span class="op" id="4807347">.</span><span class="ident" id="4807348"><a href="/gostd/compress/flate/deflate.go.html#4803389">reset</a></span><span class="op" id="4807353">(</span><span class="ident" id="4807354"><a href="/gostd/compress/flate/deflate.go.html#4807101">dst</a></span><span class="op" id="4807357">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4807360">}</span><br>
<span class="lineno"></span><span class="op" id="4807362">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
