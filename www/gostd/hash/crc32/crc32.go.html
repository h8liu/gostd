<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>hash/crc32</h2>
<ul>
<li><a href="/gostd/hash/crc32/crc32.go.html">crc32.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_amd64x.go.html">crc32_amd64x.go</a></li>
<li><a href="/gostd/hash/crc32/crc32_test.go.html">crc32_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4613157">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4613212">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4613266">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4613317">//&nbsp;Package&nbsp;crc32&nbsp;implements&nbsp;the&nbsp;32-bit&nbsp;cyclic&nbsp;redundancy&nbsp;check,&nbsp;or&nbsp;CRC-32,</span><br>
<span class="lineno"></span><span class="comment" id="4613392">//&nbsp;checksum.&nbsp;See&nbsp;http://en.wikipedia.org/wiki/Cyclic_redundancy_check&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="4613466">//&nbsp;information.</span><br>
<span class="lineno"></span><span class="keyword" id="4613482">package</span>&nbsp;<span class="ident" id="4613490">crc32</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4613497">import</span>&nbsp;<span class="op" id="4613504">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4613507">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4613515">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="4613522">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4613525">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;CRC-32&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4613568">const</span>&nbsp;<span class="ident" id="4613574">Size</span>&nbsp;<span class="op" id="4613579">=</span>&nbsp;<span class="num" id="4613581">4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4613584">//&nbsp;Predefined&nbsp;polynomials.</span><br>
<span class="lineno"></span><span class="keyword" id="4613611">const</span>&nbsp;<span class="op" id="4613617">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4613620">//&nbsp;IEEE&nbsp;is&nbsp;by&nbsp;far&nbsp;and&nbsp;away&nbsp;the&nbsp;most&nbsp;common&nbsp;CRC-32&nbsp;polynomial.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4613683">//&nbsp;Used&nbsp;by&nbsp;ethernet&nbsp;(IEEE&nbsp;802.3),&nbsp;v.42,&nbsp;fddi,&nbsp;gzip,&nbsp;zip,&nbsp;png,&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4613750">IEEE</span>&nbsp;<span class="op" id="4613755">=</span>&nbsp;<span class="num" id="4613757">0xedb88320</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4613770">//&nbsp;Castagnoli&#39;s&nbsp;polynomial,&nbsp;used&nbsp;in&nbsp;iSCSI.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4613814">//&nbsp;Has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4613872">//&nbsp;http://dx.doi.org/10.1109/26.231911</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4613912">Castagnoli</span>&nbsp;<span class="op" id="4613923">=</span>&nbsp;<span class="num" id="4613925">0x82f63b78</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4613938">//&nbsp;Koopman&#39;s&nbsp;polynomial.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4613964">//&nbsp;Also&nbsp;has&nbsp;better&nbsp;error&nbsp;detection&nbsp;characteristics&nbsp;than&nbsp;IEEE.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4614027">//&nbsp;http://dx.doi.org/10.1109/DSN.2002.1028931</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4614074">Koopman</span>&nbsp;<span class="op" id="4614082">=</span>&nbsp;<span class="num" id="4614084">0xeb31d82e</span><br>
<span class="lineno"></span><span class="op" id="4614095">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4614098">//&nbsp;Table&nbsp;is&nbsp;a&nbsp;256-word&nbsp;table&nbsp;representing&nbsp;the&nbsp;polynomial&nbsp;for&nbsp;efficient&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="4614181">type</span>&nbsp;<span class="ident" id="4614186">Table</span>&nbsp;<span class="op" id="4614192">[</span><span class="num" id="4614193">256</span><span class="op" id="4614196">]</span><span class="builtintype" id="4614197">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4614205">//&nbsp;castagnoliTable&nbsp;points&nbsp;to&nbsp;a&nbsp;lazily&nbsp;initialized&nbsp;Table&nbsp;for&nbsp;the&nbsp;Castagnoli</span><br>
<span class="lineno"></span><span class="comment" id="4614280">//&nbsp;polynomial.&nbsp;MakeTable&nbsp;will&nbsp;always&nbsp;return&nbsp;this&nbsp;value&nbsp;when&nbsp;asked&nbsp;to&nbsp;make&nbsp;a</span><br>
<span class="lineno">40</span><span class="comment" id="4614356">//&nbsp;Castagnoli&nbsp;table&nbsp;so&nbsp;we&nbsp;can&nbsp;compare&nbsp;against&nbsp;it&nbsp;to&nbsp;find&nbsp;when&nbsp;the&nbsp;caller&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4614432">//&nbsp;using&nbsp;this&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4614458">var</span>&nbsp;<span class="ident" id="4614462">castagnoliTable</span>&nbsp;<span class="op" id="4614478">*</span><span class="ident" id="4614479">Table</span><br>
<span class="lineno"></span><span class="keyword" id="4614485">var</span>&nbsp;<span class="ident" id="4614489">castagnoliOnce</span>&nbsp;<span class="ident" id="4614504">sync</span><span class="op" id="4614508">.</span><span class="ident" id="4614509">Once</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="4614515">func</span>&nbsp;<span class="ident" id="4614520">castagnoliInit</span><span class="op" id="4614534">(</span><span class="op" id="4614535">)</span>&nbsp;<span class="op" id="4614537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4614540">castagnoliTable</span>&nbsp;<span class="op" id="4614556">=</span>&nbsp;<span class="ident" id="4614558">makeTable</span><span class="op" id="4614567">(</span><span class="ident" id="4614568">Castagnoli</span><span class="op" id="4614578">)</span><br>
<span class="lineno"></span><span class="op" id="4614580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4614583">//&nbsp;IEEETable&nbsp;is&nbsp;the&nbsp;table&nbsp;for&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">50</span><span class="keyword" id="4614634">var</span>&nbsp;<span class="ident" id="4614638">IEEETable</span>&nbsp;<span class="op" id="4614648">=</span>&nbsp;<span class="ident" id="4614650">makeTable</span><span class="op" id="4614659">(</span><span class="ident" id="4614660">IEEE</span><span class="op" id="4614664">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4614667">//&nbsp;MakeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4614741">func</span>&nbsp;<span class="ident" id="4614746">MakeTable</span><span class="op" id="4614755">(</span><span class="ident" id="4614756">poly</span>&nbsp;<span class="builtintype" id="4614761">uint32</span><span class="op" id="4614767">)</span>&nbsp;<span class="op" id="4614769">*</span><span class="ident" id="4614770">Table</span>&nbsp;<span class="op" id="4614776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4614779">switch</span>&nbsp;<span class="ident" id="4614786">poly</span>&nbsp;<span class="op" id="4614791">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4614794">case</span>&nbsp;<span class="ident" id="4614799">IEEE</span><span class="op" id="4614803">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4614807">return</span>&nbsp;<span class="ident" id="4614814">IEEETable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4614825">case</span>&nbsp;<span class="ident" id="4614830">Castagnoli</span><span class="op" id="4614840">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4614844">castagnoliOnce</span><span class="op" id="4614858">.</span><span class="ident" id="4614859">Do</span><span class="op" id="4614861">(</span><span class="ident" id="4614862">castagnoliInit</span><span class="op" id="4614876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4614880">return</span>&nbsp;<span class="ident" id="4614887">castagnoliTable</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4614904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4614907">return</span>&nbsp;<span class="ident" id="4614914">makeTable</span><span class="op" id="4614923">(</span><span class="ident" id="4614924">poly</span><span class="op" id="4614928">)</span><br>
<span class="lineno"></span><span class="op" id="4614930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4614933">//&nbsp;makeTable&nbsp;returns&nbsp;the&nbsp;Table&nbsp;constructed&nbsp;from&nbsp;the&nbsp;specified&nbsp;polynomial.</span><br>
<span class="lineno">65</span><span class="keyword" id="4615007">func</span>&nbsp;<span class="ident" id="4615012">makeTable</span><span class="op" id="4615021">(</span><span class="ident" id="4615022">poly</span>&nbsp;<span class="builtintype" id="4615027">uint32</span><span class="op" id="4615033">)</span>&nbsp;<span class="op" id="4615035">*</span><span class="ident" id="4615036">Table</span>&nbsp;<span class="op" id="4615042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615045">t</span>&nbsp;<span class="op" id="4615047">:=</span>&nbsp;<span class="builtinfunc" id="4615050">new</span><span class="op" id="4615053">(</span><span class="ident" id="4615054">Table</span><span class="op" id="4615059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615062">for</span>&nbsp;<span class="ident" id="4615066">i</span>&nbsp;<span class="op" id="4615068">:=</span>&nbsp;<span class="num" id="4615071">0</span><span class="op" id="4615072">;</span>&nbsp;<span class="ident" id="4615074">i</span>&nbsp;<span class="op" id="4615076">&lt;</span>&nbsp;<span class="num" id="4615078">256</span><span class="op" id="4615081">;</span>&nbsp;<span class="ident" id="4615083">i</span><span class="op" id="4615084">++</span>&nbsp;<span class="op" id="4615087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615091">crc</span>&nbsp;<span class="op" id="4615095">:=</span>&nbsp;<span class="builtintype" id="4615098">uint32</span><span class="op" id="4615104">(</span><span class="ident" id="4615105">i</span><span class="op" id="4615106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615110">for</span>&nbsp;<span class="ident" id="4615114">j</span>&nbsp;<span class="op" id="4615116">:=</span>&nbsp;<span class="num" id="4615119">0</span><span class="op" id="4615120">;</span>&nbsp;<span class="ident" id="4615122">j</span>&nbsp;<span class="op" id="4615124">&lt;</span>&nbsp;<span class="num" id="4615126">8</span><span class="op" id="4615127">;</span>&nbsp;<span class="ident" id="4615129">j</span><span class="op" id="4615130">++</span>&nbsp;<span class="op" id="4615133">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615138">if</span>&nbsp;<span class="ident" id="4615141">crc</span><span class="op" id="4615144">&amp;</span><span class="num" id="4615145">1</span>&nbsp;<span class="op" id="4615147">==</span>&nbsp;<span class="num" id="4615150">1</span>&nbsp;<span class="op" id="4615152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615158">crc</span>&nbsp;<span class="op" id="4615162">=</span>&nbsp;<span class="op" id="4615164">(</span><span class="ident" id="4615165">crc</span>&nbsp;<span class="op" id="4615169">&gt;&gt;</span>&nbsp;<span class="num" id="4615172">1</span><span class="op" id="4615173">)</span>&nbsp;<span class="op" id="4615175">^</span>&nbsp;<span class="ident" id="4615177">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4615185">}</span>&nbsp;<span class="keyword" id="4615187">else</span>&nbsp;<span class="op" id="4615192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615198">crc</span>&nbsp;<span class="op" id="4615202">&gt;&gt;=</span>&nbsp;<span class="num" id="4615206">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4615211">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4615215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615219">t</span><span class="op" id="4615220">[</span><span class="ident" id="4615221">i</span><span class="op" id="4615222">]</span>&nbsp;<span class="op" id="4615224">=</span>&nbsp;<span class="ident" id="4615226">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4615231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615234">return</span>&nbsp;<span class="ident" id="4615241">t</span><br>
<span class="lineno"></span><span class="op" id="4615243">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4615246">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4615305">type</span>&nbsp;<span class="ident" id="4615310">digest</span>&nbsp;<span class="keyword" id="4615317">struct</span>&nbsp;<span class="op" id="4615324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615327">crc</span>&nbsp;<span class="builtintype" id="4615331">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615339">tab</span>&nbsp;<span class="op" id="4615343">*</span><span class="ident" id="4615344">Table</span><br>
<span class="lineno">85</span><span class="op" id="4615350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4615353">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="4615416">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="4615466">func</span>&nbsp;<span class="ident" id="4615471">New</span><span class="op" id="4615474">(</span><span class="ident" id="4615475">tab</span>&nbsp;<span class="op" id="4615479">*</span><span class="ident" id="4615480">Table</span><span class="op" id="4615485">)</span>&nbsp;<span class="ident" id="4615487">hash</span><span class="op" id="4615491">.</span><span class="ident" id="4615492">Hash32</span>&nbsp;<span class="op" id="4615499">{</span>&nbsp;<span class="keyword" id="4615501">return</span>&nbsp;<span class="op" id="4615508">&amp;</span><span class="ident" id="4615509">digest</span><span class="op" id="4615515">{</span><span class="num" id="4615516">0</span><span class="op" id="4615517">,</span>&nbsp;<span class="ident" id="4615519">tab</span><span class="op" id="4615522">}</span>&nbsp;<span class="op" id="4615524">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4615527">//&nbsp;NewIEEE&nbsp;creates&nbsp;a&nbsp;new&nbsp;hash.Hash32&nbsp;computing&nbsp;the&nbsp;CRC-32&nbsp;checksum</span><br>
<span class="lineno"></span><span class="comment" id="4615594">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="keyword" id="4615624">func</span>&nbsp;<span class="ident" id="4615629">NewIEEE</span><span class="op" id="4615636">(</span><span class="op" id="4615637">)</span>&nbsp;<span class="ident" id="4615639">hash</span><span class="op" id="4615643">.</span><span class="ident" id="4615644">Hash32</span>&nbsp;<span class="op" id="4615651">{</span>&nbsp;<span class="keyword" id="4615653">return</span>&nbsp;<span class="ident" id="4615660">New</span><span class="op" id="4615663">(</span><span class="ident" id="4615664">IEEETable</span><span class="op" id="4615673">)</span>&nbsp;<span class="op" id="4615675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="4615678">func</span>&nbsp;<span class="op" id="4615683">(</span><span class="ident" id="4615684">d</span>&nbsp;<span class="op" id="4615686">*</span><span class="ident" id="4615687">digest</span><span class="op" id="4615693">)</span>&nbsp;<span class="ident" id="4615695">Size</span><span class="op" id="4615699">(</span><span class="op" id="4615700">)</span>&nbsp;<span class="builtintype" id="4615702">int</span>&nbsp;<span class="op" id="4615706">{</span>&nbsp;<span class="keyword" id="4615708">return</span>&nbsp;<span class="ident" id="4615715">Size</span>&nbsp;<span class="op" id="4615720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4615723">func</span>&nbsp;<span class="op" id="4615728">(</span><span class="ident" id="4615729">d</span>&nbsp;<span class="op" id="4615731">*</span><span class="ident" id="4615732">digest</span><span class="op" id="4615738">)</span>&nbsp;<span class="ident" id="4615740">BlockSize</span><span class="op" id="4615749">(</span><span class="op" id="4615750">)</span>&nbsp;<span class="builtintype" id="4615752">int</span>&nbsp;<span class="op" id="4615756">{</span>&nbsp;<span class="keyword" id="4615758">return</span>&nbsp;<span class="num" id="4615765">1</span>&nbsp;<span class="op" id="4615767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4615770">func</span>&nbsp;<span class="op" id="4615775">(</span><span class="ident" id="4615776">d</span>&nbsp;<span class="op" id="4615778">*</span><span class="ident" id="4615779">digest</span><span class="op" id="4615785">)</span>&nbsp;<span class="ident" id="4615787">Reset</span><span class="op" id="4615792">(</span><span class="op" id="4615793">)</span>&nbsp;<span class="op" id="4615795">{</span>&nbsp;<span class="ident" id="4615797">d</span><span class="op" id="4615798">.</span><span class="ident" id="4615799">crc</span>&nbsp;<span class="op" id="4615803">=</span>&nbsp;<span class="num" id="4615805">0</span>&nbsp;<span class="op" id="4615807">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4615810">func</span>&nbsp;<span class="ident" id="4615815">update</span><span class="op" id="4615821">(</span><span class="ident" id="4615822">crc</span>&nbsp;<span class="builtintype" id="4615826">uint32</span><span class="op" id="4615832">,</span>&nbsp;<span class="ident" id="4615834">tab</span>&nbsp;<span class="op" id="4615838">*</span><span class="ident" id="4615839">Table</span><span class="op" id="4615844">,</span>&nbsp;<span class="ident" id="4615846">p</span>&nbsp;<span class="op" id="4615848">[</span><span class="op" id="4615849">]</span><span class="builtintype" id="4615850">byte</span><span class="op" id="4615854">)</span>&nbsp;<span class="builtintype" id="4615856">uint32</span>&nbsp;<span class="op" id="4615863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615866">crc</span>&nbsp;<span class="op" id="4615870">=</span>&nbsp;<span class="op" id="4615872">^</span><span class="ident" id="4615873">crc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615878">for</span>&nbsp;<span class="ident" id="4615882">_</span><span class="op" id="4615883">,</span>&nbsp;<span class="ident" id="4615885">v</span>&nbsp;<span class="op" id="4615887">:=</span>&nbsp;<span class="keyword" id="4615890">range</span>&nbsp;<span class="ident" id="4615896">p</span>&nbsp;<span class="op" id="4615898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615902">crc</span>&nbsp;<span class="op" id="4615906">=</span>&nbsp;<span class="ident" id="4615908">tab</span><span class="op" id="4615911">[</span><span class="builtintype" id="4615912">byte</span><span class="op" id="4615916">(</span><span class="ident" id="4615917">crc</span><span class="op" id="4615920">)</span><span class="op" id="4615921">^</span><span class="ident" id="4615922">v</span><span class="op" id="4615923">]</span>&nbsp;<span class="op" id="4615925">^</span>&nbsp;<span class="op" id="4615927">(</span><span class="ident" id="4615928">crc</span>&nbsp;<span class="op" id="4615932">&gt;&gt;</span>&nbsp;<span class="num" id="4615935">8</span><span class="op" id="4615936">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4615939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615942">return</span>&nbsp;<span class="op" id="4615949">^</span><span class="ident" id="4615950">crc</span><br>
<span class="lineno"></span><span class="op" id="4615954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4615957">//&nbsp;Update&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;adding&nbsp;the&nbsp;bytes&nbsp;in&nbsp;p&nbsp;to&nbsp;the&nbsp;crc.</span><br>
<span class="lineno">110</span><span class="keyword" id="4616023">func</span>&nbsp;<span class="ident" id="4616028">Update</span><span class="op" id="4616034">(</span><span class="ident" id="4616035">crc</span>&nbsp;<span class="builtintype" id="4616039">uint32</span><span class="op" id="4616045">,</span>&nbsp;<span class="ident" id="4616047">tab</span>&nbsp;<span class="op" id="4616051">*</span><span class="ident" id="4616052">Table</span><span class="op" id="4616057">,</span>&nbsp;<span class="ident" id="4616059">p</span>&nbsp;<span class="op" id="4616061">[</span><span class="op" id="4616062">]</span><span class="builtintype" id="4616063">byte</span><span class="op" id="4616067">)</span>&nbsp;<span class="builtintype" id="4616069">uint32</span>&nbsp;<span class="op" id="4616076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616079">if</span>&nbsp;<span class="ident" id="4616082">tab</span>&nbsp;<span class="op" id="4616086">==</span>&nbsp;<span class="ident" id="4616089">castagnoliTable</span>&nbsp;<span class="op" id="4616105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616109">return</span>&nbsp;<span class="ident" id="4616116">updateCastagnoli</span><span class="op" id="4616132">(</span><span class="ident" id="4616133">crc</span><span class="op" id="4616136">,</span>&nbsp;<span class="ident" id="4616138">p</span><span class="op" id="4616139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4616142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616145">return</span>&nbsp;<span class="ident" id="4616152">update</span><span class="op" id="4616158">(</span><span class="ident" id="4616159">crc</span><span class="op" id="4616162">,</span>&nbsp;<span class="ident" id="4616164">tab</span><span class="op" id="4616167">,</span>&nbsp;<span class="ident" id="4616169">p</span><span class="op" id="4616170">)</span><br>
<span class="lineno">115</span><span class="op" id="4616172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4616175">func</span>&nbsp;<span class="op" id="4616180">(</span><span class="ident" id="4616181">d</span>&nbsp;<span class="op" id="4616183">*</span><span class="ident" id="4616184">digest</span><span class="op" id="4616190">)</span>&nbsp;<span class="ident" id="4616192">Write</span><span class="op" id="4616197">(</span><span class="ident" id="4616198">p</span>&nbsp;<span class="op" id="4616200">[</span><span class="op" id="4616201">]</span><span class="builtintype" id="4616202">byte</span><span class="op" id="4616206">)</span>&nbsp;<span class="op" id="4616208">(</span><span class="ident" id="4616209">n</span>&nbsp;<span class="builtintype" id="4616211">int</span><span class="op" id="4616214">,</span>&nbsp;<span class="ident" id="4616216">err</span>&nbsp;<span class="builtintype" id="4616220">error</span><span class="op" id="4616225">)</span>&nbsp;<span class="op" id="4616227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4616230">d</span><span class="op" id="4616231">.</span><span class="ident" id="4616232">crc</span>&nbsp;<span class="op" id="4616236">=</span>&nbsp;<span class="ident" id="4616238">Update</span><span class="op" id="4616244">(</span><span class="ident" id="4616245">d</span><span class="op" id="4616246">.</span><span class="ident" id="4616247">crc</span><span class="op" id="4616250">,</span>&nbsp;<span class="ident" id="4616252">d</span><span class="op" id="4616253">.</span><span class="ident" id="4616254">tab</span><span class="op" id="4616257">,</span>&nbsp;<span class="ident" id="4616259">p</span><span class="op" id="4616260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616263">return</span>&nbsp;<span class="builtinfunc" id="4616270">len</span><span class="op" id="4616273">(</span><span class="ident" id="4616274">p</span><span class="op" id="4616275">)</span><span class="op" id="4616276">,</span>&nbsp;<span class="ident" id="4616278">nil</span><br>
<span class="lineno">120</span><span class="op" id="4616282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4616285">func</span>&nbsp;<span class="op" id="4616290">(</span><span class="ident" id="4616291">d</span>&nbsp;<span class="op" id="4616293">*</span><span class="ident" id="4616294">digest</span><span class="op" id="4616300">)</span>&nbsp;<span class="ident" id="4616302">Sum32</span><span class="op" id="4616307">(</span><span class="op" id="4616308">)</span>&nbsp;<span class="builtintype" id="4616310">uint32</span>&nbsp;<span class="op" id="4616317">{</span>&nbsp;<span class="keyword" id="4616319">return</span>&nbsp;<span class="ident" id="4616326">d</span><span class="op" id="4616327">.</span><span class="ident" id="4616328">crc</span>&nbsp;<span class="op" id="4616332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4616335">func</span>&nbsp;<span class="op" id="4616340">(</span><span class="ident" id="4616341">d</span>&nbsp;<span class="op" id="4616343">*</span><span class="ident" id="4616344">digest</span><span class="op" id="4616350">)</span>&nbsp;<span class="ident" id="4616352">Sum</span><span class="op" id="4616355">(</span><span class="ident" id="4616356">in</span>&nbsp;<span class="op" id="4616359">[</span><span class="op" id="4616360">]</span><span class="builtintype" id="4616361">byte</span><span class="op" id="4616365">)</span>&nbsp;<span class="op" id="4616367">[</span><span class="op" id="4616368">]</span><span class="builtintype" id="4616369">byte</span>&nbsp;<span class="op" id="4616374">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4616377">s</span>&nbsp;<span class="op" id="4616379">:=</span>&nbsp;<span class="ident" id="4616382">d</span><span class="op" id="4616383">.</span><span class="ident" id="4616384">Sum32</span><span class="op" id="4616389">(</span><span class="op" id="4616390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616393">return</span>&nbsp;<span class="builtinfunc" id="4616400">append</span><span class="op" id="4616406">(</span><span class="ident" id="4616407">in</span><span class="op" id="4616409">,</span>&nbsp;<span class="builtintype" id="4616411">byte</span><span class="op" id="4616415">(</span><span class="ident" id="4616416">s</span><span class="op" id="4616417">&gt;&gt;</span><span class="num" id="4616419">24</span><span class="op" id="4616421">)</span><span class="op" id="4616422">,</span>&nbsp;<span class="builtintype" id="4616424">byte</span><span class="op" id="4616428">(</span><span class="ident" id="4616429">s</span><span class="op" id="4616430">&gt;&gt;</span><span class="num" id="4616432">16</span><span class="op" id="4616434">)</span><span class="op" id="4616435">,</span>&nbsp;<span class="builtintype" id="4616437">byte</span><span class="op" id="4616441">(</span><span class="ident" id="4616442">s</span><span class="op" id="4616443">&gt;&gt;</span><span class="num" id="4616445">8</span><span class="op" id="4616446">)</span><span class="op" id="4616447">,</span>&nbsp;<span class="builtintype" id="4616449">byte</span><span class="op" id="4616453">(</span><span class="ident" id="4616454">s</span><span class="op" id="4616455">)</span><span class="op" id="4616456">)</span><br>
<span class="lineno"></span><span class="op" id="4616458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4616461">//&nbsp;Checksum&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno">130</span><span class="comment" id="4616509">//&nbsp;using&nbsp;the&nbsp;polynomial&nbsp;represented&nbsp;by&nbsp;the&nbsp;Table.</span><br>
<span class="lineno"></span><span class="keyword" id="4616559">func</span>&nbsp;<span class="ident" id="4616564">Checksum</span><span class="op" id="4616572">(</span><span class="ident" id="4616573">data</span>&nbsp;<span class="op" id="4616578">[</span><span class="op" id="4616579">]</span><span class="builtintype" id="4616580">byte</span><span class="op" id="4616584">,</span>&nbsp;<span class="ident" id="4616586">tab</span>&nbsp;<span class="op" id="4616590">*</span><span class="ident" id="4616591">Table</span><span class="op" id="4616596">)</span>&nbsp;<span class="builtintype" id="4616598">uint32</span>&nbsp;<span class="op" id="4616605">{</span>&nbsp;<span class="keyword" id="4616607">return</span>&nbsp;<span class="ident" id="4616614">Update</span><span class="op" id="4616620">(</span><span class="num" id="4616621">0</span><span class="op" id="4616622">,</span>&nbsp;<span class="ident" id="4616624">tab</span><span class="op" id="4616627">,</span>&nbsp;<span class="ident" id="4616629">data</span><span class="op" id="4616633">)</span>&nbsp;<span class="op" id="4616635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4616638">//&nbsp;ChecksumIEEE&nbsp;returns&nbsp;the&nbsp;CRC-32&nbsp;checksum&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="4616690">//&nbsp;using&nbsp;the&nbsp;IEEE&nbsp;polynomial.</span><br>
<span class="lineno">135</span><span class="keyword" id="4616720">func</span>&nbsp;<span class="ident" id="4616725">ChecksumIEEE</span><span class="op" id="4616737">(</span><span class="ident" id="4616738">data</span>&nbsp;<span class="op" id="4616743">[</span><span class="op" id="4616744">]</span><span class="builtintype" id="4616745">byte</span><span class="op" id="4616749">)</span>&nbsp;<span class="builtintype" id="4616751">uint32</span>&nbsp;<span class="op" id="4616758">{</span>&nbsp;<span class="keyword" id="4616760">return</span>&nbsp;<span class="ident" id="4616767">update</span><span class="op" id="4616773">(</span><span class="num" id="4616774">0</span><span class="op" id="4616775">,</span>&nbsp;<span class="ident" id="4616777">IEEETable</span><span class="op" id="4616786">,</span>&nbsp;<span class="ident" id="4616788">data</span><span class="op" id="4616792">)</span>&nbsp;<span class="op" id="4616794">}</span>
</div>
</body>
</html>
