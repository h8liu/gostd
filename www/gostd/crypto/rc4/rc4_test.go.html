<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html" class="current">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7803676">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7803731">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7803785">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7803836">package</span>&nbsp;<span class="ident" id="7803844">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7803849">import</span>&nbsp;<span class="op" id="7803856">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7803859">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7803868">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7803875">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7803885">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7803888">type</span>&nbsp;<span class="ident" id="7803893">rc4Test</span>&nbsp;<span class="keyword" id="7803901">struct</span>&nbsp;<span class="op" id="7803908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7803911">key</span><span class="op" id="7803914">,</span>&nbsp;<span class="ident" id="7803916">keystream</span>&nbsp;<span class="op" id="7803926">[</span><span class="op" id="7803927">]</span><span class="builtintype" id="7803928">byte</span><br>
<span class="lineno">15</span><span class="op" id="7803933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7803936">var</span>&nbsp;<span class="ident" id="7803940">golden</span>&nbsp;<span class="op" id="7803947">=</span>&nbsp;<span class="op" id="7803949">[</span><span class="op" id="7803950">]</span><span class="ident" id="7803951">rc4Test</span><span class="op" id="7803958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7803961">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7804024">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804102">[</span><span class="op" id="7804103">]</span><span class="builtintype" id="7804104">byte</span><span class="op" id="7804108">{</span><span class="num" id="7804109">0x01</span><span class="op" id="7804113">,</span>&nbsp;<span class="num" id="7804115">0x23</span><span class="op" id="7804119">,</span>&nbsp;<span class="num" id="7804121">0x45</span><span class="op" id="7804125">,</span>&nbsp;<span class="num" id="7804127">0x67</span><span class="op" id="7804131">,</span>&nbsp;<span class="num" id="7804133">0x89</span><span class="op" id="7804137">,</span>&nbsp;<span class="num" id="7804139">0xab</span><span class="op" id="7804143">,</span>&nbsp;<span class="num" id="7804145">0xcd</span><span class="op" id="7804149">,</span>&nbsp;<span class="num" id="7804151">0xef</span><span class="op" id="7804155">}</span><span class="op" id="7804156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804160">[</span><span class="op" id="7804161">]</span><span class="builtintype" id="7804162">byte</span><span class="op" id="7804166">{</span><span class="num" id="7804167">0x74</span><span class="op" id="7804171">,</span>&nbsp;<span class="num" id="7804173">0x94</span><span class="op" id="7804177">,</span>&nbsp;<span class="num" id="7804179">0xc2</span><span class="op" id="7804183">,</span>&nbsp;<span class="num" id="7804185">0xe7</span><span class="op" id="7804189">,</span>&nbsp;<span class="num" id="7804191">0x10</span><span class="op" id="7804195">,</span>&nbsp;<span class="num" id="7804197">0x4b</span><span class="op" id="7804201">,</span>&nbsp;<span class="num" id="7804203">0x08</span><span class="op" id="7804207">,</span>&nbsp;<span class="num" id="7804209">0x79</span><span class="op" id="7804213">}</span><span class="op" id="7804214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804217">}</span><span class="op" id="7804218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804221">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804225">[</span><span class="op" id="7804226">]</span><span class="builtintype" id="7804227">byte</span><span class="op" id="7804231">{</span><span class="num" id="7804232">0x00</span><span class="op" id="7804236">,</span>&nbsp;<span class="num" id="7804238">0x00</span><span class="op" id="7804242">,</span>&nbsp;<span class="num" id="7804244">0x00</span><span class="op" id="7804248">,</span>&nbsp;<span class="num" id="7804250">0x00</span><span class="op" id="7804254">,</span>&nbsp;<span class="num" id="7804256">0x00</span><span class="op" id="7804260">,</span>&nbsp;<span class="num" id="7804262">0x00</span><span class="op" id="7804266">,</span>&nbsp;<span class="num" id="7804268">0x00</span><span class="op" id="7804272">,</span>&nbsp;<span class="num" id="7804274">0x00</span><span class="op" id="7804278">}</span><span class="op" id="7804279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804283">[</span><span class="op" id="7804284">]</span><span class="builtintype" id="7804285">byte</span><span class="op" id="7804289">{</span><span class="num" id="7804290">0xde</span><span class="op" id="7804294">,</span>&nbsp;<span class="num" id="7804296">0x18</span><span class="op" id="7804300">,</span>&nbsp;<span class="num" id="7804302">0x89</span><span class="op" id="7804306">,</span>&nbsp;<span class="num" id="7804308">0x41</span><span class="op" id="7804312">,</span>&nbsp;<span class="num" id="7804314">0xa3</span><span class="op" id="7804318">,</span>&nbsp;<span class="num" id="7804320">0x37</span><span class="op" id="7804324">,</span>&nbsp;<span class="num" id="7804326">0x5d</span><span class="op" id="7804330">,</span>&nbsp;<span class="num" id="7804332">0x3a</span><span class="op" id="7804336">}</span><span class="op" id="7804337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804340">}</span><span class="op" id="7804341">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804348">[</span><span class="op" id="7804349">]</span><span class="builtintype" id="7804350">byte</span><span class="op" id="7804354">{</span><span class="num" id="7804355">0xef</span><span class="op" id="7804359">,</span>&nbsp;<span class="num" id="7804361">0x01</span><span class="op" id="7804365">,</span>&nbsp;<span class="num" id="7804367">0x23</span><span class="op" id="7804371">,</span>&nbsp;<span class="num" id="7804373">0x45</span><span class="op" id="7804377">}</span><span class="op" id="7804378">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804382">[</span><span class="op" id="7804383">]</span><span class="builtintype" id="7804384">byte</span><span class="op" id="7804388">{</span><span class="num" id="7804389">0xd6</span><span class="op" id="7804393">,</span>&nbsp;<span class="num" id="7804395">0xa1</span><span class="op" id="7804399">,</span>&nbsp;<span class="num" id="7804401">0x41</span><span class="op" id="7804405">,</span>&nbsp;<span class="num" id="7804407">0xa7</span><span class="op" id="7804411">,</span>&nbsp;<span class="num" id="7804413">0xec</span><span class="op" id="7804417">,</span>&nbsp;<span class="num" id="7804419">0x3c</span><span class="op" id="7804423">,</span>&nbsp;<span class="num" id="7804425">0x38</span><span class="op" id="7804429">,</span>&nbsp;<span class="num" id="7804431">0xdf</span><span class="op" id="7804435">,</span>&nbsp;<span class="num" id="7804437">0xbd</span><span class="op" id="7804441">,</span>&nbsp;<span class="num" id="7804443">0x61</span><span class="op" id="7804447">}</span><span class="op" id="7804448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804451">}</span><span class="op" id="7804452">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7804456">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804531">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804535">[</span><span class="op" id="7804536">]</span><span class="builtintype" id="7804537">byte</span><span class="op" id="7804541">{</span><span class="num" id="7804542">0x4b</span><span class="op" id="7804546">,</span>&nbsp;<span class="num" id="7804548">0x65</span><span class="op" id="7804552">,</span>&nbsp;<span class="num" id="7804554">0x79</span><span class="op" id="7804558">}</span><span class="op" id="7804559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804563">[</span><span class="op" id="7804564">]</span><span class="builtintype" id="7804565">byte</span><span class="op" id="7804569">{</span><span class="num" id="7804570">0xeb</span><span class="op" id="7804574">,</span>&nbsp;<span class="num" id="7804576">0x9f</span><span class="op" id="7804580">,</span>&nbsp;<span class="num" id="7804582">0x77</span><span class="op" id="7804586">,</span>&nbsp;<span class="num" id="7804588">0x81</span><span class="op" id="7804592">,</span>&nbsp;<span class="num" id="7804594">0xb7</span><span class="op" id="7804598">,</span>&nbsp;<span class="num" id="7804600">0x34</span><span class="op" id="7804604">,</span>&nbsp;<span class="num" id="7804606">0xca</span><span class="op" id="7804610">,</span>&nbsp;<span class="num" id="7804612">0x72</span><span class="op" id="7804616">,</span>&nbsp;<span class="num" id="7804618">0xa7</span><span class="op" id="7804622">,</span>&nbsp;<span class="num" id="7804624">0x19</span><span class="op" id="7804628">}</span><span class="op" id="7804629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804632">}</span><span class="op" id="7804633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804640">[</span><span class="op" id="7804641">]</span><span class="builtintype" id="7804642">byte</span><span class="op" id="7804646">{</span><span class="num" id="7804647">0x57</span><span class="op" id="7804651">,</span>&nbsp;<span class="num" id="7804653">0x69</span><span class="op" id="7804657">,</span>&nbsp;<span class="num" id="7804659">0x6b</span><span class="op" id="7804663">,</span>&nbsp;<span class="num" id="7804665">0x69</span><span class="op" id="7804669">}</span><span class="op" id="7804670">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804674">[</span><span class="op" id="7804675">]</span><span class="builtintype" id="7804676">byte</span><span class="op" id="7804680">{</span><span class="num" id="7804681">0x60</span><span class="op" id="7804685">,</span>&nbsp;<span class="num" id="7804687">0x44</span><span class="op" id="7804691">,</span>&nbsp;<span class="num" id="7804693">0xdb</span><span class="op" id="7804697">,</span>&nbsp;<span class="num" id="7804699">0x6d</span><span class="op" id="7804703">,</span>&nbsp;<span class="num" id="7804705">0x41</span><span class="op" id="7804709">,</span>&nbsp;<span class="num" id="7804711">0xb7</span><span class="op" id="7804715">}</span><span class="op" id="7804716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804719">}</span><span class="op" id="7804720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804727">[</span><span class="op" id="7804728">]</span><span class="builtintype" id="7804729">byte</span><span class="op" id="7804733">{</span><span class="num" id="7804734">0x00</span><span class="op" id="7804738">,</span>&nbsp;<span class="num" id="7804740">0x00</span><span class="op" id="7804744">,</span>&nbsp;<span class="num" id="7804746">0x00</span><span class="op" id="7804750">,</span>&nbsp;<span class="num" id="7804752">0x00</span><span class="op" id="7804756">,</span>&nbsp;<span class="num" id="7804758">0x00</span><span class="op" id="7804762">,</span>&nbsp;<span class="num" id="7804764">0x00</span><span class="op" id="7804768">,</span>&nbsp;<span class="num" id="7804770">0x00</span><span class="op" id="7804774">,</span>&nbsp;<span class="num" id="7804776">0x00</span><span class="op" id="7804780">}</span><span class="op" id="7804781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7804785">[</span><span class="op" id="7804786">]</span><span class="builtintype" id="7804787">byte</span><span class="op" id="7804791">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7804796">0xde</span><span class="op" id="7804800">,</span>&nbsp;<span class="num" id="7804802">0x18</span><span class="op" id="7804806">,</span>&nbsp;<span class="num" id="7804808">0x89</span><span class="op" id="7804812">,</span>&nbsp;<span class="num" id="7804814">0x41</span><span class="op" id="7804818">,</span>&nbsp;<span class="num" id="7804820">0xa3</span><span class="op" id="7804824">,</span>&nbsp;<span class="num" id="7804826">0x37</span><span class="op" id="7804830">,</span>&nbsp;<span class="num" id="7804832">0x5d</span><span class="op" id="7804836">,</span>&nbsp;<span class="num" id="7804838">0x3a</span><span class="op" id="7804842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7804847">0x8a</span><span class="op" id="7804851">,</span>&nbsp;<span class="num" id="7804853">0x06</span><span class="op" id="7804857">,</span>&nbsp;<span class="num" id="7804859">0x1e</span><span class="op" id="7804863">,</span>&nbsp;<span class="num" id="7804865">0x67</span><span class="op" id="7804869">,</span>&nbsp;<span class="num" id="7804871">0x57</span><span class="op" id="7804875">,</span>&nbsp;<span class="num" id="7804877">0x6e</span><span class="op" id="7804881">,</span>&nbsp;<span class="num" id="7804883">0x92</span><span class="op" id="7804887">,</span>&nbsp;<span class="num" id="7804889">0x6d</span><span class="op" id="7804893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7804898">0xc7</span><span class="op" id="7804902">,</span>&nbsp;<span class="num" id="7804904">0x1a</span><span class="op" id="7804908">,</span>&nbsp;<span class="num" id="7804910">0x7f</span><span class="op" id="7804914">,</span>&nbsp;<span class="num" id="7804916">0xa3</span><span class="op" id="7804920">,</span>&nbsp;<span class="num" id="7804922">0xf0</span><span class="op" id="7804926">,</span>&nbsp;<span class="num" id="7804928">0xcc</span><span class="op" id="7804932">,</span>&nbsp;<span class="num" id="7804934">0xeb</span><span class="op" id="7804938">,</span>&nbsp;<span class="num" id="7804940">0x97</span><span class="op" id="7804944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7804949">0x45</span><span class="op" id="7804953">,</span>&nbsp;<span class="num" id="7804955">0x2b</span><span class="op" id="7804959">,</span>&nbsp;<span class="num" id="7804961">0x4d</span><span class="op" id="7804965">,</span>&nbsp;<span class="num" id="7804967">0x32</span><span class="op" id="7804971">,</span>&nbsp;<span class="num" id="7804973">0x27</span><span class="op" id="7804977">,</span>&nbsp;<span class="num" id="7804979">0x96</span><span class="op" id="7804983">,</span>&nbsp;<span class="num" id="7804985">0x5f</span><span class="op" id="7804989">,</span>&nbsp;<span class="num" id="7804991">0x9e</span><span class="op" id="7804995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805000">0xa8</span><span class="op" id="7805004">,</span>&nbsp;<span class="num" id="7805006">0xcc</span><span class="op" id="7805010">,</span>&nbsp;<span class="num" id="7805012">0x75</span><span class="op" id="7805016">,</span>&nbsp;<span class="num" id="7805018">0x07</span><span class="op" id="7805022">,</span>&nbsp;<span class="num" id="7805024">0x6d</span><span class="op" id="7805028">,</span>&nbsp;<span class="num" id="7805030">0x9f</span><span class="op" id="7805034">,</span>&nbsp;<span class="num" id="7805036">0xb9</span><span class="op" id="7805040">,</span>&nbsp;<span class="num" id="7805042">0xc5</span><span class="op" id="7805046">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805051">0x41</span><span class="op" id="7805055">,</span>&nbsp;<span class="num" id="7805057">0x7a</span><span class="op" id="7805061">,</span>&nbsp;<span class="num" id="7805063">0xa5</span><span class="op" id="7805067">,</span>&nbsp;<span class="num" id="7805069">0xcb</span><span class="op" id="7805073">,</span>&nbsp;<span class="num" id="7805075">0x30</span><span class="op" id="7805079">,</span>&nbsp;<span class="num" id="7805081">0xfc</span><span class="op" id="7805085">,</span>&nbsp;<span class="num" id="7805087">0x22</span><span class="op" id="7805091">,</span>&nbsp;<span class="num" id="7805093">0x19</span><span class="op" id="7805097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805102">0x8b</span><span class="op" id="7805106">,</span>&nbsp;<span class="num" id="7805108">0x34</span><span class="op" id="7805112">,</span>&nbsp;<span class="num" id="7805114">0x98</span><span class="op" id="7805118">,</span>&nbsp;<span class="num" id="7805120">0x2d</span><span class="op" id="7805124">,</span>&nbsp;<span class="num" id="7805126">0xbb</span><span class="op" id="7805130">,</span>&nbsp;<span class="num" id="7805132">0x62</span><span class="op" id="7805136">,</span>&nbsp;<span class="num" id="7805138">0x9e</span><span class="op" id="7805142">,</span>&nbsp;<span class="num" id="7805144">0xc0</span><span class="op" id="7805148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805153">0x4b</span><span class="op" id="7805157">,</span>&nbsp;<span class="num" id="7805159">0x4f</span><span class="op" id="7805163">,</span>&nbsp;<span class="num" id="7805165">0x8b</span><span class="op" id="7805169">,</span>&nbsp;<span class="num" id="7805171">0x05</span><span class="op" id="7805175">,</span>&nbsp;<span class="num" id="7805177">0xa0</span><span class="op" id="7805181">,</span>&nbsp;<span class="num" id="7805183">0x71</span><span class="op" id="7805187">,</span>&nbsp;<span class="num" id="7805189">0x08</span><span class="op" id="7805193">,</span>&nbsp;<span class="num" id="7805195">0x50</span><span class="op" id="7805199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805204">0x92</span><span class="op" id="7805208">,</span>&nbsp;<span class="num" id="7805210">0xa0</span><span class="op" id="7805214">,</span>&nbsp;<span class="num" id="7805216">0xc3</span><span class="op" id="7805220">,</span>&nbsp;<span class="num" id="7805222">0x58</span><span class="op" id="7805226">,</span>&nbsp;<span class="num" id="7805228">0x4a</span><span class="op" id="7805232">,</span>&nbsp;<span class="num" id="7805234">0x48</span><span class="op" id="7805238">,</span>&nbsp;<span class="num" id="7805240">0xe4</span><span class="op" id="7805244">,</span>&nbsp;<span class="num" id="7805246">0xa3</span><span class="op" id="7805250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805255">0x0a</span><span class="op" id="7805259">,</span>&nbsp;<span class="num" id="7805261">0x39</span><span class="op" id="7805265">,</span>&nbsp;<span class="num" id="7805267">0x7b</span><span class="op" id="7805271">,</span>&nbsp;<span class="num" id="7805273">0x8a</span><span class="op" id="7805277">,</span>&nbsp;<span class="num" id="7805279">0xcd</span><span class="op" id="7805283">,</span>&nbsp;<span class="num" id="7805285">0x1d</span><span class="op" id="7805289">,</span>&nbsp;<span class="num" id="7805291">0x00</span><span class="op" id="7805295">,</span>&nbsp;<span class="num" id="7805297">0x9e</span><span class="op" id="7805301">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805306">0xc8</span><span class="op" id="7805310">,</span>&nbsp;<span class="num" id="7805312">0x7d</span><span class="op" id="7805316">,</span>&nbsp;<span class="num" id="7805318">0x68</span><span class="op" id="7805322">,</span>&nbsp;<span class="num" id="7805324">0x11</span><span class="op" id="7805328">,</span>&nbsp;<span class="num" id="7805330">0xf2</span><span class="op" id="7805334">,</span>&nbsp;<span class="num" id="7805336">0x2c</span><span class="op" id="7805340">,</span>&nbsp;<span class="num" id="7805342">0xf4</span><span class="op" id="7805346">,</span>&nbsp;<span class="num" id="7805348">0x9c</span><span class="op" id="7805352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805357">0xa3</span><span class="op" id="7805361">,</span>&nbsp;<span class="num" id="7805363">0xe5</span><span class="op" id="7805367">,</span>&nbsp;<span class="num" id="7805369">0x93</span><span class="op" id="7805373">,</span>&nbsp;<span class="num" id="7805375">0x54</span><span class="op" id="7805379">,</span>&nbsp;<span class="num" id="7805381">0xb9</span><span class="op" id="7805385">,</span>&nbsp;<span class="num" id="7805387">0x45</span><span class="op" id="7805391">,</span>&nbsp;<span class="num" id="7805393">0x15</span><span class="op" id="7805397">,</span>&nbsp;<span class="num" id="7805399">0x35</span><span class="op" id="7805403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805408">0xa2</span><span class="op" id="7805412">,</span>&nbsp;<span class="num" id="7805414">0x18</span><span class="op" id="7805418">,</span>&nbsp;<span class="num" id="7805420">0x7a</span><span class="op" id="7805424">,</span>&nbsp;<span class="num" id="7805426">0x86</span><span class="op" id="7805430">,</span>&nbsp;<span class="num" id="7805432">0x42</span><span class="op" id="7805436">,</span>&nbsp;<span class="num" id="7805438">0x6c</span><span class="op" id="7805442">,</span>&nbsp;<span class="num" id="7805444">0xca</span><span class="op" id="7805448">,</span>&nbsp;<span class="num" id="7805450">0x7d</span><span class="op" id="7805454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805459">0x5e</span><span class="op" id="7805463">,</span>&nbsp;<span class="num" id="7805465">0x82</span><span class="op" id="7805469">,</span>&nbsp;<span class="num" id="7805471">0x3e</span><span class="op" id="7805475">,</span>&nbsp;<span class="num" id="7805477">0xba</span><span class="op" id="7805481">,</span>&nbsp;<span class="num" id="7805483">0x00</span><span class="op" id="7805487">,</span>&nbsp;<span class="num" id="7805489">0x44</span><span class="op" id="7805493">,</span>&nbsp;<span class="num" id="7805495">0x12</span><span class="op" id="7805499">,</span>&nbsp;<span class="num" id="7805501">0x67</span><span class="op" id="7805505">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805510">0x12</span><span class="op" id="7805514">,</span>&nbsp;<span class="num" id="7805516">0x57</span><span class="op" id="7805520">,</span>&nbsp;<span class="num" id="7805522">0xb8</span><span class="op" id="7805526">,</span>&nbsp;<span class="num" id="7805528">0xd8</span><span class="op" id="7805532">,</span>&nbsp;<span class="num" id="7805534">0x60</span><span class="op" id="7805538">,</span>&nbsp;<span class="num" id="7805540">0xae</span><span class="op" id="7805544">,</span>&nbsp;<span class="num" id="7805546">0x4c</span><span class="op" id="7805550">,</span>&nbsp;<span class="num" id="7805552">0xbd</span><span class="op" id="7805556">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805561">0x4c</span><span class="op" id="7805565">,</span>&nbsp;<span class="num" id="7805567">0x49</span><span class="op" id="7805571">,</span>&nbsp;<span class="num" id="7805573">0x06</span><span class="op" id="7805577">,</span>&nbsp;<span class="num" id="7805579">0xbb</span><span class="op" id="7805583">,</span>&nbsp;<span class="num" id="7805585">0xc5</span><span class="op" id="7805589">,</span>&nbsp;<span class="num" id="7805591">0x35</span><span class="op" id="7805595">,</span>&nbsp;<span class="num" id="7805597">0xef</span><span class="op" id="7805601">,</span>&nbsp;<span class="num" id="7805603">0xe1</span><span class="op" id="7805607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805612">0x58</span><span class="op" id="7805616">,</span>&nbsp;<span class="num" id="7805618">0x7f</span><span class="op" id="7805622">,</span>&nbsp;<span class="num" id="7805624">0x08</span><span class="op" id="7805628">,</span>&nbsp;<span class="num" id="7805630">0xdb</span><span class="op" id="7805634">,</span>&nbsp;<span class="num" id="7805636">0x33</span><span class="op" id="7805640">,</span>&nbsp;<span class="num" id="7805642">0x95</span><span class="op" id="7805646">,</span>&nbsp;<span class="num" id="7805648">0x5c</span><span class="op" id="7805652">,</span>&nbsp;<span class="num" id="7805654">0xdb</span><span class="op" id="7805658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805663">0xcb</span><span class="op" id="7805667">,</span>&nbsp;<span class="num" id="7805669">0xad</span><span class="op" id="7805673">,</span>&nbsp;<span class="num" id="7805675">0x9b</span><span class="op" id="7805679">,</span>&nbsp;<span class="num" id="7805681">0x10</span><span class="op" id="7805685">,</span>&nbsp;<span class="num" id="7805687">0xf5</span><span class="op" id="7805691">,</span>&nbsp;<span class="num" id="7805693">0x3f</span><span class="op" id="7805697">,</span>&nbsp;<span class="num" id="7805699">0xc4</span><span class="op" id="7805703">,</span>&nbsp;<span class="num" id="7805705">0xe5</span><span class="op" id="7805709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805714">0x2c</span><span class="op" id="7805718">,</span>&nbsp;<span class="num" id="7805720">0x59</span><span class="op" id="7805724">,</span>&nbsp;<span class="num" id="7805726">0x15</span><span class="op" id="7805730">,</span>&nbsp;<span class="num" id="7805732">0x65</span><span class="op" id="7805736">,</span>&nbsp;<span class="num" id="7805738">0x51</span><span class="op" id="7805742">,</span>&nbsp;<span class="num" id="7805744">0x84</span><span class="op" id="7805748">,</span>&nbsp;<span class="num" id="7805750">0x87</span><span class="op" id="7805754">,</span>&nbsp;<span class="num" id="7805756">0xfe</span><span class="op" id="7805760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805765">0x08</span><span class="op" id="7805769">,</span>&nbsp;<span class="num" id="7805771">0x4d</span><span class="op" id="7805775">,</span>&nbsp;<span class="num" id="7805777">0x0e</span><span class="op" id="7805781">,</span>&nbsp;<span class="num" id="7805783">0x3f</span><span class="op" id="7805787">,</span>&nbsp;<span class="num" id="7805789">0x03</span><span class="op" id="7805793">,</span>&nbsp;<span class="num" id="7805795">0xde</span><span class="op" id="7805799">,</span>&nbsp;<span class="num" id="7805801">0xbc</span><span class="op" id="7805805">,</span>&nbsp;<span class="num" id="7805807">0xc9</span><span class="op" id="7805811">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805816">0xda</span><span class="op" id="7805820">,</span>&nbsp;<span class="num" id="7805822">0x1c</span><span class="op" id="7805826">,</span>&nbsp;<span class="num" id="7805828">0xe9</span><span class="op" id="7805832">,</span>&nbsp;<span class="num" id="7805834">0x0d</span><span class="op" id="7805838">,</span>&nbsp;<span class="num" id="7805840">0x08</span><span class="op" id="7805844">,</span>&nbsp;<span class="num" id="7805846">0x5c</span><span class="op" id="7805850">,</span>&nbsp;<span class="num" id="7805852">0x2d</span><span class="op" id="7805856">,</span>&nbsp;<span class="num" id="7805858">0x8a</span><span class="op" id="7805862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805867">0x19</span><span class="op" id="7805871">,</span>&nbsp;<span class="num" id="7805873">0xd8</span><span class="op" id="7805877">,</span>&nbsp;<span class="num" id="7805879">0x37</span><span class="op" id="7805883">,</span>&nbsp;<span class="num" id="7805885">0x30</span><span class="op" id="7805889">,</span>&nbsp;<span class="num" id="7805891">0x86</span><span class="op" id="7805895">,</span>&nbsp;<span class="num" id="7805897">0x16</span><span class="op" id="7805901">,</span>&nbsp;<span class="num" id="7805903">0x36</span><span class="op" id="7805907">,</span>&nbsp;<span class="num" id="7805909">0x92</span><span class="op" id="7805913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805918">0x14</span><span class="op" id="7805922">,</span>&nbsp;<span class="num" id="7805924">0x2b</span><span class="op" id="7805928">,</span>&nbsp;<span class="num" id="7805930">0xd8</span><span class="op" id="7805934">,</span>&nbsp;<span class="num" id="7805936">0xfc</span><span class="op" id="7805940">,</span>&nbsp;<span class="num" id="7805942">0x5d</span><span class="op" id="7805946">,</span>&nbsp;<span class="num" id="7805948">0x7a</span><span class="op" id="7805952">,</span>&nbsp;<span class="num" id="7805954">0x73</span><span class="op" id="7805958">,</span>&nbsp;<span class="num" id="7805960">0x49</span><span class="op" id="7805964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7805969">0x6a</span><span class="op" id="7805973">,</span>&nbsp;<span class="num" id="7805975">0x8e</span><span class="op" id="7805979">,</span>&nbsp;<span class="num" id="7805981">0x59</span><span class="op" id="7805985">,</span>&nbsp;<span class="num" id="7805987">0xee</span><span class="op" id="7805991">,</span>&nbsp;<span class="num" id="7805993">0x7e</span><span class="op" id="7805997">,</span>&nbsp;<span class="num" id="7805999">0xcf</span><span class="op" id="7806003">,</span>&nbsp;<span class="num" id="7806005">0x6b</span><span class="op" id="7806009">,</span>&nbsp;<span class="num" id="7806011">0x94</span><span class="op" id="7806015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7806020">0x06</span><span class="op" id="7806024">,</span>&nbsp;<span class="num" id="7806026">0x63</span><span class="op" id="7806030">,</span>&nbsp;<span class="num" id="7806032">0xf4</span><span class="op" id="7806036">,</span>&nbsp;<span class="num" id="7806038">0xa6</span><span class="op" id="7806042">,</span>&nbsp;<span class="num" id="7806044">0xbe</span><span class="op" id="7806048">,</span>&nbsp;<span class="num" id="7806050">0xe6</span><span class="op" id="7806054">,</span>&nbsp;<span class="num" id="7806056">0x5b</span><span class="op" id="7806060">,</span>&nbsp;<span class="num" id="7806062">0xd2</span><span class="op" id="7806066">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7806071">0xc8</span><span class="op" id="7806075">,</span>&nbsp;<span class="num" id="7806077">0x5c</span><span class="op" id="7806081">,</span>&nbsp;<span class="num" id="7806083">0x46</span><span class="op" id="7806087">,</span>&nbsp;<span class="num" id="7806089">0x98</span><span class="op" id="7806093">,</span>&nbsp;<span class="num" id="7806095">0x6c</span><span class="op" id="7806099">,</span>&nbsp;<span class="num" id="7806101">0x1b</span><span class="op" id="7806105">,</span>&nbsp;<span class="num" id="7806107">0xef</span><span class="op" id="7806111">,</span>&nbsp;<span class="num" id="7806113">0x34</span><span class="op" id="7806117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7806122">0x90</span><span class="op" id="7806126">,</span>&nbsp;<span class="num" id="7806128">0xd3</span><span class="op" id="7806132">,</span>&nbsp;<span class="num" id="7806134">0x7b</span><span class="op" id="7806138">,</span>&nbsp;<span class="num" id="7806140">0x38</span><span class="op" id="7806144">,</span>&nbsp;<span class="num" id="7806146">0xda</span><span class="op" id="7806150">,</span>&nbsp;<span class="num" id="7806152">0x85</span><span class="op" id="7806156">,</span>&nbsp;<span class="num" id="7806158">0xd3</span><span class="op" id="7806162">,</span>&nbsp;<span class="num" id="7806164">0x2e</span><span class="op" id="7806168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7806173">0x97</span><span class="op" id="7806177">,</span>&nbsp;<span class="num" id="7806179">0x39</span><span class="op" id="7806183">,</span>&nbsp;<span class="num" id="7806185">0xcb</span><span class="op" id="7806189">,</span>&nbsp;<span class="num" id="7806191">0x23</span><span class="op" id="7806195">,</span>&nbsp;<span class="num" id="7806197">0x4a</span><span class="op" id="7806201">,</span>&nbsp;<span class="num" id="7806203">0x2b</span><span class="op" id="7806207">,</span>&nbsp;<span class="num" id="7806209">0xe7</span><span class="op" id="7806213">,</span>&nbsp;<span class="num" id="7806215">0x40</span><span class="op" id="7806219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7806223">}</span><span class="op" id="7806224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7806227">}</span><span class="op" id="7806228">,</span><br>
<span class="lineno">75</span><span class="op" id="7806230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7806233">func</span>&nbsp;<span class="ident" id="7806238">testEncrypt</span><span class="op" id="7806249">(</span><span class="ident" id="7806250">t</span>&nbsp;<span class="op" id="7806252">*</span><span class="ident" id="7806253">testing</span><span class="op" id="7806260">.</span><span class="ident" id="7806261">T</span><span class="op" id="7806262">,</span>&nbsp;<span class="ident" id="7806264">desc</span>&nbsp;<span class="builtintype" id="7806269">string</span><span class="op" id="7806275">,</span>&nbsp;<span class="ident" id="7806277">c</span>&nbsp;<span class="op" id="7806279">*</span><span class="ident" id="7806280">Cipher</span><span class="op" id="7806286">,</span>&nbsp;<span class="ident" id="7806288">src</span><span class="op" id="7806291">,</span>&nbsp;<span class="ident" id="7806293">expect</span>&nbsp;<span class="op" id="7806300">[</span><span class="op" id="7806301">]</span><span class="builtintype" id="7806302">byte</span><span class="op" id="7806306">)</span>&nbsp;<span class="op" id="7806308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7806311">dst</span>&nbsp;<span class="op" id="7806315">:=</span>&nbsp;<span class="builtinfunc" id="7806318">make</span><span class="op" id="7806322">(</span><span class="op" id="7806323">[</span><span class="op" id="7806324">]</span><span class="builtintype" id="7806325">byte</span><span class="op" id="7806329">,</span>&nbsp;<span class="builtinfunc" id="7806331">len</span><span class="op" id="7806334">(</span><span class="ident" id="7806335">src</span><span class="op" id="7806338">)</span><span class="op" id="7806339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7806342">c</span><span class="op" id="7806343">.</span><span class="ident" id="7806344">XORKeyStream</span><span class="op" id="7806356">(</span><span class="ident" id="7806357">dst</span><span class="op" id="7806360">,</span>&nbsp;<span class="ident" id="7806362">src</span><span class="op" id="7806365">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7806368">for</span>&nbsp;<span class="ident" id="7806372">i</span><span class="op" id="7806373">,</span>&nbsp;<span class="ident" id="7806375">v</span>&nbsp;<span class="op" id="7806377">:=</span>&nbsp;<span class="keyword" id="7806380">range</span>&nbsp;<span class="ident" id="7806386">dst</span>&nbsp;<span class="op" id="7806390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7806394">if</span>&nbsp;<span class="ident" id="7806397">v</span>&nbsp;<span class="op" id="7806399">!=</span>&nbsp;<span class="ident" id="7806402">expect</span><span class="op" id="7806408">[</span><span class="ident" id="7806409">i</span><span class="op" id="7806410">]</span>&nbsp;<span class="op" id="7806412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7806417">t</span><span class="op" id="7806418">.</span><span class="ident" id="7806419">Fatalf</span><span class="op" id="7806425">(</span><span class="string" id="7806426">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="7806470">,</span>&nbsp;<span class="ident" id="7806472">desc</span><span class="op" id="7806476">,</span>&nbsp;<span class="ident" id="7806478">i</span><span class="op" id="7806479">,</span>&nbsp;<span class="ident" id="7806481">dst</span><span class="op" id="7806484">,</span>&nbsp;<span class="ident" id="7806486">expect</span><span class="op" id="7806492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7806496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7806499">}</span><br>
<span class="lineno">85</span><span class="op" id="7806501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7806504">func</span>&nbsp;<span class="ident" id="7806509">TestGolden</span><span class="op" id="7806519">(</span><span class="ident" id="7806520">t</span>&nbsp;<span class="op" id="7806522">*</span><span class="ident" id="7806523">testing</span><span class="op" id="7806530">.</span><span class="ident" id="7806531">T</span><span class="op" id="7806532">)</span>&nbsp;<span class="op" id="7806534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7806537">for</span>&nbsp;<span class="ident" id="7806541">gi</span><span class="op" id="7806543">,</span>&nbsp;<span class="ident" id="7806545">g</span>&nbsp;<span class="op" id="7806547">:=</span>&nbsp;<span class="keyword" id="7806550">range</span>&nbsp;<span class="ident" id="7806556">golden</span>&nbsp;<span class="op" id="7806563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7806567">data</span>&nbsp;<span class="op" id="7806572">:=</span>&nbsp;<span class="builtinfunc" id="7806575">make</span><span class="op" id="7806579">(</span><span class="op" id="7806580">[</span><span class="op" id="7806581">]</span><span class="builtintype" id="7806582">byte</span><span class="op" id="7806586">,</span>&nbsp;<span class="builtinfunc" id="7806588">len</span><span class="op" id="7806591">(</span><span class="ident" id="7806592">g</span><span class="op" id="7806593">.</span><span class="ident" id="7806594">keystream</span><span class="op" id="7806603">)</span><span class="op" id="7806604">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7806608">for</span>&nbsp;<span class="ident" id="7806612">i</span>&nbsp;<span class="op" id="7806614">:=</span>&nbsp;<span class="keyword" id="7806617">range</span>&nbsp;<span class="ident" id="7806623">data</span>&nbsp;<span class="op" id="7806628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7806633">data</span><span class="op" id="7806637">[</span><span class="ident" id="7806638">i</span><span class="op" id="7806639">]</span>&nbsp;<span class="op" id="7806641">=</span>&nbsp;<span class="builtintype" id="7806643">byte</span><span class="op" id="7806647">(</span><span class="ident" id="7806648">i</span><span class="op" id="7806649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7806653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7806658">expect</span>&nbsp;<span class="op" id="7806665">:=</span>&nbsp;<span class="builtinfunc" id="7806668">make</span><span class="op" id="7806672">(</span><span class="op" id="7806673">[</span><span class="op" id="7806674">]</span><span class="builtintype" id="7806675">byte</span><span class="op" id="7806679">,</span>&nbsp;<span class="builtinfunc" id="7806681">len</span><span class="op" id="7806684">(</span><span class="ident" id="7806685">g</span><span class="op" id="7806686">.</span><span class="ident" id="7806687">keystream</span><span class="op" id="7806696">)</span><span class="op" id="7806697">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7806701">for</span>&nbsp;<span class="ident" id="7806705">i</span>&nbsp;<span class="op" id="7806707">:=</span>&nbsp;<span class="keyword" id="7806710">range</span>&nbsp;<span class="ident" id="7806716">expect</span>&nbsp;<span class="op" id="7806723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7806728">expect</span><span class="op" id="7806734">[</span><span class="ident" id="7806735">i</span><span class="op" id="7806736">]</span>&nbsp;<span class="op" id="7806738">=</span>&nbsp;<span class="builtintype" id="7806740">byte</span><span class="op" id="7806744">(</span><span class="ident" id="7806745">i</span><span class="op" id="7806746">)</span>&nbsp;<span class="op" id="7806748">^</span>&nbsp;<span class="ident" id="7806750">g</span><span class="op" id="7806751">.</span><span class="ident" id="7806752">keystream</span><span class="op" id="7806761">[</span><span class="ident" id="7806762">i</span><span class="op" id="7806763">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7806767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7806772">for</span>&nbsp;<span class="ident" id="7806776">size</span>&nbsp;<span class="op" id="7806781">:=</span>&nbsp;<span class="num" id="7806784">1</span><span class="op" id="7806785">;</span>&nbsp;<span class="ident" id="7806787">size</span>&nbsp;<span class="op" id="7806792">&lt;=</span>&nbsp;<span class="builtinfunc" id="7806795">len</span><span class="op" id="7806798">(</span><span class="ident" id="7806799">g</span><span class="op" id="7806800">.</span><span class="ident" id="7806801">keystream</span><span class="op" id="7806810">)</span><span class="op" id="7806811">;</span>&nbsp;<span class="ident" id="7806813">size</span><span class="op" id="7806817">++</span>&nbsp;<span class="op" id="7806820">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7806825">c</span><span class="op" id="7806826">,</span>&nbsp;<span class="ident" id="7806828">err</span>&nbsp;<span class="op" id="7806832">:=</span>&nbsp;<span class="ident" id="7806835">NewCipher</span><span class="op" id="7806844">(</span><span class="ident" id="7806845">g</span><span class="op" id="7806846">.</span><span class="ident" id="7806847">key</span><span class="op" id="7806850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7806855">if</span>&nbsp;<span class="ident" id="7806858">err</span>&nbsp;<span class="op" id="7806862">!=</span>&nbsp;<span class="ident" id="7806865">nil</span>&nbsp;<span class="op" id="7806869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7806875">t</span><span class="op" id="7806876">.</span><span class="ident" id="7806877">Fatalf</span><span class="op" id="7806883">(</span><span class="string" id="7806884">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="7806904">,</span>&nbsp;<span class="ident" id="7806906">gi</span><span class="op" id="7806908">,</span>&nbsp;<span class="ident" id="7806910">err</span><span class="op" id="7806913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7806918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7806924">off</span>&nbsp;<span class="op" id="7806928">:=</span>&nbsp;<span class="num" id="7806931">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7806936">for</span>&nbsp;<span class="ident" id="7806940">off</span>&nbsp;<span class="op" id="7806944">&lt;</span>&nbsp;<span class="builtinfunc" id="7806946">len</span><span class="op" id="7806949">(</span><span class="ident" id="7806950">g</span><span class="op" id="7806951">.</span><span class="ident" id="7806952">keystream</span><span class="op" id="7806961">)</span>&nbsp;<span class="op" id="7806963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7806969">n</span>&nbsp;<span class="op" id="7806971">:=</span>&nbsp;<span class="builtinfunc" id="7806974">len</span><span class="op" id="7806977">(</span><span class="ident" id="7806978">g</span><span class="op" id="7806979">.</span><span class="ident" id="7806980">keystream</span><span class="op" id="7806989">)</span>&nbsp;<span class="op" id="7806991">-</span>&nbsp;<span class="ident" id="7806993">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7807001">if</span>&nbsp;<span class="ident" id="7807004">n</span>&nbsp;<span class="op" id="7807006">&gt;</span>&nbsp;<span class="ident" id="7807008">size</span>&nbsp;<span class="op" id="7807013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807020">n</span>&nbsp;<span class="op" id="7807022">=</span>&nbsp;<span class="ident" id="7807024">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7807033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807039">desc</span>&nbsp;<span class="op" id="7807044">:=</span>&nbsp;<span class="ident" id="7807047">fmt</span><span class="op" id="7807050">.</span><span class="ident" id="7807051">Sprintf</span><span class="op" id="7807058">(</span><span class="string" id="7807059">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="7807072">,</span>&nbsp;<span class="ident" id="7807074">gi</span><span class="op" id="7807076">,</span>&nbsp;<span class="ident" id="7807078">off</span><span class="op" id="7807081">,</span>&nbsp;<span class="ident" id="7807083">off</span><span class="op" id="7807086">+</span><span class="ident" id="7807087">n</span><span class="op" id="7807088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807094">testEncrypt</span><span class="op" id="7807105">(</span><span class="ident" id="7807106">t</span><span class="op" id="7807107">,</span>&nbsp;<span class="ident" id="7807109">desc</span><span class="op" id="7807113">,</span>&nbsp;<span class="ident" id="7807115">c</span><span class="op" id="7807116">,</span>&nbsp;<span class="ident" id="7807118">data</span><span class="op" id="7807122">[</span><span class="ident" id="7807123">off</span><span class="op" id="7807126">:</span><span class="ident" id="7807127">off</span><span class="op" id="7807130">+</span><span class="ident" id="7807131">n</span><span class="op" id="7807132">]</span><span class="op" id="7807133">,</span>&nbsp;<span class="ident" id="7807135">expect</span><span class="op" id="7807141">[</span><span class="ident" id="7807142">off</span><span class="op" id="7807145">:</span><span class="ident" id="7807146">off</span><span class="op" id="7807149">+</span><span class="ident" id="7807150">n</span><span class="op" id="7807151">]</span><span class="op" id="7807152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807158">off</span>&nbsp;<span class="op" id="7807162">+=</span>&nbsp;<span class="ident" id="7807165">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7807170">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7807174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7807177">}</span><br>
<span class="lineno"></span><span class="op" id="7807179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7807182">func</span>&nbsp;<span class="ident" id="7807187">TestBlock</span><span class="op" id="7807196">(</span><span class="ident" id="7807197">t</span>&nbsp;<span class="op" id="7807199">*</span><span class="ident" id="7807200">testing</span><span class="op" id="7807207">.</span><span class="ident" id="7807208">T</span><span class="op" id="7807209">)</span>&nbsp;<span class="op" id="7807211">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807214">testBlock</span><span class="op" id="7807223">(</span><span class="ident" id="7807224">t</span><span class="op" id="7807225">,</span>&nbsp;<span class="op" id="7807227">(</span><span class="op" id="7807228">*</span><span class="ident" id="7807229">Cipher</span><span class="op" id="7807235">)</span><span class="op" id="7807236">.</span><span class="ident" id="7807237">XORKeyStream</span><span class="op" id="7807249">)</span><br>
<span class="lineno"></span><span class="op" id="7807251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7807254">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="7807283">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="7807350">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="7807394">func</span>&nbsp;<span class="ident" id="7807399">TestBlockGeneric</span><span class="op" id="7807415">(</span><span class="ident" id="7807416">t</span>&nbsp;<span class="op" id="7807418">*</span><span class="ident" id="7807419">testing</span><span class="op" id="7807426">.</span><span class="ident" id="7807427">T</span><span class="op" id="7807428">)</span>&nbsp;<span class="op" id="7807430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807433">testBlock</span><span class="op" id="7807442">(</span><span class="ident" id="7807443">t</span><span class="op" id="7807444">,</span>&nbsp;<span class="op" id="7807446">(</span><span class="op" id="7807447">*</span><span class="ident" id="7807448">Cipher</span><span class="op" id="7807454">)</span><span class="op" id="7807455">.</span><span class="ident" id="7807456">xorKeyStreamGeneric</span><span class="op" id="7807475">)</span><br>
<span class="lineno"></span><span class="op" id="7807477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7807480">func</span>&nbsp;<span class="ident" id="7807485">testBlock</span><span class="op" id="7807494">(</span><span class="ident" id="7807495">t</span>&nbsp;<span class="op" id="7807497">*</span><span class="ident" id="7807498">testing</span><span class="op" id="7807505">.</span><span class="ident" id="7807506">T</span><span class="op" id="7807507">,</span>&nbsp;<span class="ident" id="7807509">xor</span>&nbsp;<span class="keyword" id="7807513">func</span><span class="op" id="7807517">(</span><span class="ident" id="7807518">c</span>&nbsp;<span class="op" id="7807520">*</span><span class="ident" id="7807521">Cipher</span><span class="op" id="7807527">,</span>&nbsp;<span class="ident" id="7807529">dst</span><span class="op" id="7807532">,</span>&nbsp;<span class="ident" id="7807534">src</span>&nbsp;<span class="op" id="7807538">[</span><span class="op" id="7807539">]</span><span class="builtintype" id="7807540">byte</span><span class="op" id="7807544">)</span><span class="op" id="7807545">)</span>&nbsp;<span class="op" id="7807547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807550">c1a</span><span class="op" id="7807553">,</span>&nbsp;<span class="ident" id="7807555">_</span>&nbsp;<span class="op" id="7807557">:=</span>&nbsp;<span class="ident" id="7807560">NewCipher</span><span class="op" id="7807569">(</span><span class="ident" id="7807570">golden</span><span class="op" id="7807576">[</span><span class="num" id="7807577">0</span><span class="op" id="7807578">]</span><span class="op" id="7807579">.</span><span class="ident" id="7807580">key</span><span class="op" id="7807583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807586">c1b</span><span class="op" id="7807589">,</span>&nbsp;<span class="ident" id="7807591">_</span>&nbsp;<span class="op" id="7807593">:=</span>&nbsp;<span class="ident" id="7807596">NewCipher</span><span class="op" id="7807605">(</span><span class="ident" id="7807606">golden</span><span class="op" id="7807612">[</span><span class="num" id="7807613">1</span><span class="op" id="7807614">]</span><span class="op" id="7807615">.</span><span class="ident" id="7807616">key</span><span class="op" id="7807619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807622">data1</span>&nbsp;<span class="op" id="7807628">:=</span>&nbsp;<span class="builtinfunc" id="7807631">make</span><span class="op" id="7807635">(</span><span class="op" id="7807636">[</span><span class="op" id="7807637">]</span><span class="builtintype" id="7807638">byte</span><span class="op" id="7807642">,</span>&nbsp;<span class="num" id="7807644">1</span><span class="op" id="7807645">&lt;&lt;</span><span class="num" id="7807647">20</span><span class="op" id="7807649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7807652">for</span>&nbsp;<span class="ident" id="7807656">i</span>&nbsp;<span class="op" id="7807658">:=</span>&nbsp;<span class="keyword" id="7807661">range</span>&nbsp;<span class="ident" id="7807667">data1</span>&nbsp;<span class="op" id="7807673">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807677">xor</span><span class="op" id="7807680">(</span><span class="ident" id="7807681">c1a</span><span class="op" id="7807684">,</span>&nbsp;<span class="ident" id="7807686">data1</span><span class="op" id="7807691">[</span><span class="ident" id="7807692">i</span><span class="op" id="7807693">:</span><span class="ident" id="7807694">i</span><span class="op" id="7807695">+</span><span class="num" id="7807696">1</span><span class="op" id="7807697">]</span><span class="op" id="7807698">,</span>&nbsp;<span class="ident" id="7807700">data1</span><span class="op" id="7807705">[</span><span class="ident" id="7807706">i</span><span class="op" id="7807707">:</span><span class="ident" id="7807708">i</span><span class="op" id="7807709">+</span><span class="num" id="7807710">1</span><span class="op" id="7807711">]</span><span class="op" id="7807712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807716">xor</span><span class="op" id="7807719">(</span><span class="ident" id="7807720">c1b</span><span class="op" id="7807723">,</span>&nbsp;<span class="ident" id="7807725">data1</span><span class="op" id="7807730">[</span><span class="ident" id="7807731">i</span><span class="op" id="7807732">:</span><span class="ident" id="7807733">i</span><span class="op" id="7807734">+</span><span class="num" id="7807735">1</span><span class="op" id="7807736">]</span><span class="op" id="7807737">,</span>&nbsp;<span class="ident" id="7807739">data1</span><span class="op" id="7807744">[</span><span class="ident" id="7807745">i</span><span class="op" id="7807746">:</span><span class="ident" id="7807747">i</span><span class="op" id="7807748">+</span><span class="num" id="7807749">1</span><span class="op" id="7807750">]</span><span class="op" id="7807751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7807754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807758">c2a</span><span class="op" id="7807761">,</span>&nbsp;<span class="ident" id="7807763">_</span>&nbsp;<span class="op" id="7807765">:=</span>&nbsp;<span class="ident" id="7807768">NewCipher</span><span class="op" id="7807777">(</span><span class="ident" id="7807778">golden</span><span class="op" id="7807784">[</span><span class="num" id="7807785">0</span><span class="op" id="7807786">]</span><span class="op" id="7807787">.</span><span class="ident" id="7807788">key</span><span class="op" id="7807791">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807794">c2b</span><span class="op" id="7807797">,</span>&nbsp;<span class="ident" id="7807799">_</span>&nbsp;<span class="op" id="7807801">:=</span>&nbsp;<span class="ident" id="7807804">NewCipher</span><span class="op" id="7807813">(</span><span class="ident" id="7807814">golden</span><span class="op" id="7807820">[</span><span class="num" id="7807821">1</span><span class="op" id="7807822">]</span><span class="op" id="7807823">.</span><span class="ident" id="7807824">key</span><span class="op" id="7807827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807830">data2</span>&nbsp;<span class="op" id="7807836">:=</span>&nbsp;<span class="builtinfunc" id="7807839">make</span><span class="op" id="7807843">(</span><span class="op" id="7807844">[</span><span class="op" id="7807845">]</span><span class="builtintype" id="7807846">byte</span><span class="op" id="7807850">,</span>&nbsp;<span class="num" id="7807852">1</span><span class="op" id="7807853">&lt;&lt;</span><span class="num" id="7807855">20</span><span class="op" id="7807857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807860">xor</span><span class="op" id="7807863">(</span><span class="ident" id="7807864">c2a</span><span class="op" id="7807867">,</span>&nbsp;<span class="ident" id="7807869">data2</span><span class="op" id="7807874">,</span>&nbsp;<span class="ident" id="7807876">data2</span><span class="op" id="7807881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807884">xor</span><span class="op" id="7807887">(</span><span class="ident" id="7807888">c2b</span><span class="op" id="7807891">,</span>&nbsp;<span class="ident" id="7807893">data2</span><span class="op" id="7807898">,</span>&nbsp;<span class="ident" id="7807900">data2</span><span class="op" id="7807905">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7807909">if</span>&nbsp;<span class="op" id="7807912">!</span><span class="ident" id="7807913">bytes</span><span class="op" id="7807918">.</span><span class="ident" id="7807919">Equal</span><span class="op" id="7807924">(</span><span class="ident" id="7807925">data1</span><span class="op" id="7807930">,</span>&nbsp;<span class="ident" id="7807932">data2</span><span class="op" id="7807937">)</span>&nbsp;<span class="op" id="7807939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7807943">t</span><span class="op" id="7807944">.</span><span class="ident" id="7807945">Fatalf</span><span class="op" id="7807951">(</span><span class="string" id="7807952">&#34;bad&nbsp;block&#34;</span><span class="op" id="7807963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7807966">}</span><br>
<span class="lineno"></span><span class="op" id="7807968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7807971">func</span>&nbsp;<span class="ident" id="7807976">benchmark</span><span class="op" id="7807985">(</span><span class="ident" id="7807986">b</span>&nbsp;<span class="op" id="7807988">*</span><span class="ident" id="7807989">testing</span><span class="op" id="7807996">.</span><span class="ident" id="7807997">B</span><span class="op" id="7807998">,</span>&nbsp;<span class="ident" id="7808000">size</span>&nbsp;<span class="ident" id="7808005">int64</span><span class="op" id="7808010">)</span>&nbsp;<span class="op" id="7808012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7808015">buf</span>&nbsp;<span class="op" id="7808019">:=</span>&nbsp;<span class="builtinfunc" id="7808022">make</span><span class="op" id="7808026">(</span><span class="op" id="7808027">[</span><span class="op" id="7808028">]</span><span class="builtintype" id="7808029">byte</span><span class="op" id="7808033">,</span>&nbsp;<span class="ident" id="7808035">size</span><span class="op" id="7808039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7808042">c</span><span class="op" id="7808043">,</span>&nbsp;<span class="ident" id="7808045">err</span>&nbsp;<span class="op" id="7808049">:=</span>&nbsp;<span class="ident" id="7808052">NewCipher</span><span class="op" id="7808061">(</span><span class="ident" id="7808062">golden</span><span class="op" id="7808068">[</span><span class="num" id="7808069">0</span><span class="op" id="7808070">]</span><span class="op" id="7808071">.</span><span class="ident" id="7808072">key</span><span class="op" id="7808075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7808078">if</span>&nbsp;<span class="ident" id="7808081">err</span>&nbsp;<span class="op" id="7808085">!=</span>&nbsp;<span class="ident" id="7808088">nil</span>&nbsp;<span class="op" id="7808092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7808096">panic</span><span class="op" id="7808101">(</span><span class="ident" id="7808102">err</span><span class="op" id="7808105">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7808108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7808111">b</span><span class="op" id="7808112">.</span><span class="ident" id="7808113">SetBytes</span><span class="op" id="7808121">(</span><span class="ident" id="7808122">size</span><span class="op" id="7808126">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7808130">for</span>&nbsp;<span class="ident" id="7808134">i</span>&nbsp;<span class="op" id="7808136">:=</span>&nbsp;<span class="num" id="7808139">0</span><span class="op" id="7808140">;</span>&nbsp;<span class="ident" id="7808142">i</span>&nbsp;<span class="op" id="7808144">&lt;</span>&nbsp;<span class="ident" id="7808146">b</span><span class="op" id="7808147">.</span><span class="ident" id="7808148">N</span><span class="op" id="7808149">;</span>&nbsp;<span class="ident" id="7808151">i</span><span class="op" id="7808152">++</span>&nbsp;<span class="op" id="7808155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7808159">c</span><span class="op" id="7808160">.</span><span class="ident" id="7808161">XORKeyStream</span><span class="op" id="7808173">(</span><span class="ident" id="7808174">buf</span><span class="op" id="7808177">,</span>&nbsp;<span class="ident" id="7808179">buf</span><span class="op" id="7808182">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7808185">}</span><br>
<span class="lineno"></span><span class="op" id="7808187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7808190">func</span>&nbsp;<span class="ident" id="7808195">BenchmarkRC4_128</span><span class="op" id="7808211">(</span><span class="ident" id="7808212">b</span>&nbsp;<span class="op" id="7808214">*</span><span class="ident" id="7808215">testing</span><span class="op" id="7808222">.</span><span class="ident" id="7808223">B</span><span class="op" id="7808224">)</span>&nbsp;<span class="op" id="7808226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7808229">benchmark</span><span class="op" id="7808238">(</span><span class="ident" id="7808239">b</span><span class="op" id="7808240">,</span>&nbsp;<span class="num" id="7808242">128</span><span class="op" id="7808245">)</span><br>
<span class="lineno">165</span><span class="op" id="7808247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7808250">func</span>&nbsp;<span class="ident" id="7808255">BenchmarkRC4_1K</span><span class="op" id="7808270">(</span><span class="ident" id="7808271">b</span>&nbsp;<span class="op" id="7808273">*</span><span class="ident" id="7808274">testing</span><span class="op" id="7808281">.</span><span class="ident" id="7808282">B</span><span class="op" id="7808283">)</span>&nbsp;<span class="op" id="7808285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7808288">benchmark</span><span class="op" id="7808297">(</span><span class="ident" id="7808298">b</span><span class="op" id="7808299">,</span>&nbsp;<span class="num" id="7808301">1024</span><span class="op" id="7808305">)</span><br>
<span class="lineno"></span><span class="op" id="7808307">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7808310">func</span>&nbsp;<span class="ident" id="7808315">BenchmarkRC4_8K</span><span class="op" id="7808330">(</span><span class="ident" id="7808331">b</span>&nbsp;<span class="op" id="7808333">*</span><span class="ident" id="7808334">testing</span><span class="op" id="7808341">.</span><span class="ident" id="7808342">B</span><span class="op" id="7808343">)</span>&nbsp;<span class="op" id="7808345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7808348">benchmark</span><span class="op" id="7808357">(</span><span class="ident" id="7808358">b</span><span class="op" id="7808359">,</span>&nbsp;<span class="num" id="7808361">8096</span><span class="op" id="7808365">)</span><br>
<span class="lineno"></span><span class="op" id="7808367">}</span>
</div>
</body>
</html>
