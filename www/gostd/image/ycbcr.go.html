<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5420404">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5420459">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5420513">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5420564">package</span>&nbsp;<span class="ident" id="5420572">image</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5420579">import</span>&nbsp;<span class="op" id="5420586">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5420589">&#34;image/color&#34;</span><br>
<span class="lineno"></span><span class="op" id="5420603">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="5420606">//&nbsp;YCbCrSubsampleRatio&nbsp;is&nbsp;the&nbsp;chroma&nbsp;subsample&nbsp;ratio&nbsp;used&nbsp;in&nbsp;a&nbsp;YCbCr&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="5420682">type</span>&nbsp;<span class="ident" id="5420687">YCbCrSubsampleRatio</span>&nbsp;<span class="builtintype" id="5420707">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5420712">const</span>&nbsp;<span class="op" id="5420718">(</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420721">YCbCrSubsampleRatio444</span>&nbsp;<span class="ident" id="5420744">YCbCrSubsampleRatio</span>&nbsp;<span class="op" id="5420764">=</span>&nbsp;<span class="ident" id="5420766">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420772">YCbCrSubsampleRatio422</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420796">YCbCrSubsampleRatio420</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5420820">YCbCrSubsampleRatio440</span><br>
<span class="lineno"></span><span class="op" id="5420843">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5420846">func</span>&nbsp;<span class="op" id="5420851">(</span><span class="ident" id="5420852">s</span>&nbsp;<span class="ident" id="5420854">YCbCrSubsampleRatio</span><span class="op" id="5420873">)</span>&nbsp;<span class="ident" id="5420875">String</span><span class="op" id="5420881">(</span><span class="op" id="5420882">)</span>&nbsp;<span class="builtintype" id="5420884">string</span>&nbsp;<span class="op" id="5420891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420894">switch</span>&nbsp;<span class="ident" id="5420901">s</span>&nbsp;<span class="op" id="5420903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420906">case</span>&nbsp;<span class="ident" id="5420911">YCbCrSubsampleRatio444</span><span class="op" id="5420933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420937">return</span>&nbsp;<span class="string" id="5420944">&#34;YCbCrSubsampleRatio444&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5420970">case</span>&nbsp;<span class="ident" id="5420975">YCbCrSubsampleRatio422</span><span class="op" id="5420997">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421001">return</span>&nbsp;<span class="string" id="5421008">&#34;YCbCrSubsampleRatio422&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421034">case</span>&nbsp;<span class="ident" id="5421039">YCbCrSubsampleRatio420</span><span class="op" id="5421061">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421065">return</span>&nbsp;<span class="string" id="5421072">&#34;YCbCrSubsampleRatio420&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421098">case</span>&nbsp;<span class="ident" id="5421103">YCbCrSubsampleRatio440</span><span class="op" id="5421125">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421129">return</span>&nbsp;<span class="string" id="5421136">&#34;YCbCrSubsampleRatio440&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5421162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5421165">return</span>&nbsp;<span class="string" id="5421172">&#34;YCbCrSubsampleRatioUnknown&#34;</span><br>
<span class="lineno"></span><span class="op" id="5421201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="5421204">//&nbsp;YCbCr&nbsp;is&nbsp;an&nbsp;in-memory&nbsp;image&nbsp;of&nbsp;Y&#39;CbCr&nbsp;colors.&nbsp;There&nbsp;is&nbsp;one&nbsp;Y&nbsp;sample&nbsp;per</span><br>
<span class="lineno"></span><span class="comment" id="5421279">//&nbsp;pixel,&nbsp;but&nbsp;each&nbsp;Cb&nbsp;and&nbsp;Cr&nbsp;sample&nbsp;can&nbsp;span&nbsp;one&nbsp;or&nbsp;more&nbsp;pixels.</span><br>
<span class="lineno"></span><span class="comment" id="5421344">//&nbsp;YStride&nbsp;is&nbsp;the&nbsp;Y&nbsp;slice&nbsp;index&nbsp;delta&nbsp;between&nbsp;vertically&nbsp;adjacent&nbsp;pixels.</span><br>
<span class="lineno"></span><span class="comment" id="5421418">//&nbsp;CStride&nbsp;is&nbsp;the&nbsp;Cb&nbsp;and&nbsp;Cr&nbsp;slice&nbsp;index&nbsp;delta&nbsp;between&nbsp;vertically&nbsp;adjacent&nbsp;pixels</span><br>
<span class="lineno"></span><span class="comment" id="5421499">//&nbsp;that&nbsp;map&nbsp;to&nbsp;separate&nbsp;chroma&nbsp;samples.</span><br>
<span class="lineno">40</span><span class="comment" id="5421539">//&nbsp;It&nbsp;is&nbsp;not&nbsp;an&nbsp;absolute&nbsp;requirement,&nbsp;but&nbsp;YStride&nbsp;and&nbsp;len(Y)&nbsp;are&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="5421614">//&nbsp;multiples&nbsp;of&nbsp;8,&nbsp;and:</span><br>
<span class="lineno"></span><span class="comment" id="5421638">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:4:4,&nbsp;CStride&nbsp;==&nbsp;YStride/1&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/1.</span><br>
<span class="lineno"></span><span class="comment" id="5421708">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:2:2,&nbsp;CStride&nbsp;==&nbsp;YStride/2&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/2.</span><br>
<span class="lineno"></span><span class="comment" id="5421778">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:2:0,&nbsp;CStride&nbsp;==&nbsp;YStride/2&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/4.</span><br>
<span class="lineno">45</span><span class="comment" id="5421848">//&nbsp;&nbsp;&nbsp;&nbspFor&nbsp;4:4:0,&nbsp;CStride&nbsp;==&nbsp;YStride/1&nbsp;&amp;&amp;&nbsp;len(Cb)&nbsp;==&nbsp;len(Cr)&nbsp;==&nbsp;len(Y)/2.</span><br>
<span class="lineno"></span><span class="keyword" id="5421918">type</span>&nbsp;<span class="ident" id="5421923">YCbCr</span>&nbsp;<span class="keyword" id="5421929">struct</span>&nbsp;<span class="op" id="5421936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421939">Y</span><span class="op" id="5421940">,</span>&nbsp;<span class="ident" id="5421942">Cb</span><span class="op" id="5421944">,</span>&nbsp;<span class="ident" id="5421946">Cr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5421954">[</span><span class="op" id="5421955">]</span><span class="builtintype" id="5421956">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421963">YStride</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5421978">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5421983">CStride</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5421998">int</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422003">SubsampleRatio</span>&nbsp;<span class="ident" id="5422018">YCbCrSubsampleRatio</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422039">Rect</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5422054">Rectangle</span><br>
<span class="lineno"></span><span class="op" id="5422064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5422067">func</span>&nbsp;<span class="op" id="5422072">(</span><span class="ident" id="5422073">p</span>&nbsp;<span class="op" id="5422075">*</span><span class="ident" id="5422076">YCbCr</span><span class="op" id="5422081">)</span>&nbsp;<span class="ident" id="5422083">ColorModel</span><span class="op" id="5422093">(</span><span class="op" id="5422094">)</span>&nbsp;<span class="ident" id="5422096">color</span><span class="op" id="5422101">.</span><span class="ident" id="5422102">Model</span>&nbsp;<span class="op" id="5422108">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422111">return</span>&nbsp;<span class="ident" id="5422118">color</span><span class="op" id="5422123">.</span><span class="ident" id="5422124">YCbCrModel</span><br>
<span class="lineno"></span><span class="op" id="5422135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5422138">func</span>&nbsp;<span class="op" id="5422143">(</span><span class="ident" id="5422144">p</span>&nbsp;<span class="op" id="5422146">*</span><span class="ident" id="5422147">YCbCr</span><span class="op" id="5422152">)</span>&nbsp;<span class="ident" id="5422154">Bounds</span><span class="op" id="5422160">(</span><span class="op" id="5422161">)</span>&nbsp;<span class="ident" id="5422163">Rectangle</span>&nbsp;<span class="op" id="5422173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422176">return</span>&nbsp;<span class="ident" id="5422183">p</span><span class="op" id="5422184">.</span><span class="ident" id="5422185">Rect</span><br>
<span class="lineno">60</span><span class="op" id="5422190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5422193">func</span>&nbsp;<span class="op" id="5422198">(</span><span class="ident" id="5422199">p</span>&nbsp;<span class="op" id="5422201">*</span><span class="ident" id="5422202">YCbCr</span><span class="op" id="5422207">)</span>&nbsp;<span class="ident" id="5422209">At</span><span class="op" id="5422211">(</span><span class="ident" id="5422212">x</span><span class="op" id="5422213">,</span>&nbsp;<span class="ident" id="5422215">y</span>&nbsp;<span class="builtintype" id="5422217">int</span><span class="op" id="5422220">)</span>&nbsp;<span class="ident" id="5422222">color</span><span class="op" id="5422227">.</span><span class="ident" id="5422228">Color</span>&nbsp;<span class="op" id="5422234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422237">return</span>&nbsp;<span class="ident" id="5422244">p</span><span class="op" id="5422245">.</span><span class="ident" id="5422246">YCbCrAt</span><span class="op" id="5422253">(</span><span class="ident" id="5422254">x</span><span class="op" id="5422255">,</span>&nbsp;<span class="ident" id="5422257">y</span><span class="op" id="5422258">)</span><br>
<span class="lineno"></span><span class="op" id="5422260">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="5422263">func</span>&nbsp;<span class="op" id="5422268">(</span><span class="ident" id="5422269">p</span>&nbsp;<span class="op" id="5422271">*</span><span class="ident" id="5422272">YCbCr</span><span class="op" id="5422277">)</span>&nbsp;<span class="ident" id="5422279">YCbCrAt</span><span class="op" id="5422286">(</span><span class="ident" id="5422287">x</span><span class="op" id="5422288">,</span>&nbsp;<span class="ident" id="5422290">y</span>&nbsp;<span class="builtintype" id="5422292">int</span><span class="op" id="5422295">)</span>&nbsp;<span class="ident" id="5422297">color</span><span class="op" id="5422302">.</span><span class="ident" id="5422303">YCbCr</span>&nbsp;<span class="op" id="5422309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422312">if</span>&nbsp;<span class="op" id="5422315">!</span><span class="op" id="5422316">(</span><span class="ident" id="5422317">Point</span><span class="op" id="5422322">{</span><span class="ident" id="5422323">x</span><span class="op" id="5422324">,</span>&nbsp;<span class="ident" id="5422326">y</span><span class="op" id="5422327">}</span><span class="op" id="5422328">.</span><span class="ident" id="5422329">In</span><span class="op" id="5422331">(</span><span class="ident" id="5422332">p</span><span class="op" id="5422333">.</span><span class="ident" id="5422334">Rect</span><span class="op" id="5422338">)</span><span class="op" id="5422339">)</span>&nbsp;<span class="op" id="5422341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422345">return</span>&nbsp;<span class="ident" id="5422352">color</span><span class="op" id="5422357">.</span><span class="ident" id="5422358">YCbCr</span><span class="op" id="5422363">{</span><span class="op" id="5422364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422367">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422370">yi</span>&nbsp;<span class="op" id="5422373">:=</span>&nbsp;<span class="ident" id="5422376">p</span><span class="op" id="5422377">.</span><span class="ident" id="5422378">YOffset</span><span class="op" id="5422385">(</span><span class="ident" id="5422386">x</span><span class="op" id="5422387">,</span>&nbsp;<span class="ident" id="5422389">y</span><span class="op" id="5422390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422393">ci</span>&nbsp;<span class="op" id="5422396">:=</span>&nbsp;<span class="ident" id="5422399">p</span><span class="op" id="5422400">.</span><span class="ident" id="5422401">COffset</span><span class="op" id="5422408">(</span><span class="ident" id="5422409">x</span><span class="op" id="5422410">,</span>&nbsp;<span class="ident" id="5422412">y</span><span class="op" id="5422413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422416">return</span>&nbsp;<span class="ident" id="5422423">color</span><span class="op" id="5422428">.</span><span class="ident" id="5422429">YCbCr</span><span class="op" id="5422434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422438">p</span><span class="op" id="5422439">.</span><span class="ident" id="5422440">Y</span><span class="op" id="5422441">[</span><span class="ident" id="5422442">yi</span><span class="op" id="5422444">]</span><span class="op" id="5422445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422449">p</span><span class="op" id="5422450">.</span><span class="ident" id="5422451">Cb</span><span class="op" id="5422453">[</span><span class="ident" id="5422454">ci</span><span class="op" id="5422456">]</span><span class="op" id="5422457">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5422461">p</span><span class="op" id="5422462">.</span><span class="ident" id="5422463">Cr</span><span class="op" id="5422465">[</span><span class="ident" id="5422466">ci</span><span class="op" id="5422468">]</span><span class="op" id="5422469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5422472">}</span><br>
<span class="lineno"></span><span class="op" id="5422474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5422477">//&nbsp;YOffset&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Y&nbsp;that&nbsp;corresponds&nbsp;to</span><br>
<span class="lineno">80</span><span class="comment" id="5422552">//&nbsp;the&nbsp;pixel&nbsp;at&nbsp;(x,&nbsp;y).</span><br>
<span class="lineno"></span><span class="keyword" id="5422576">func</span>&nbsp;<span class="op" id="5422581">(</span><span class="ident" id="5422582">p</span>&nbsp;<span class="op" id="5422584">*</span><span class="ident" id="5422585">YCbCr</span><span class="op" id="5422590">)</span>&nbsp;<span class="ident" id="5422592">YOffset</span><span class="op" id="5422599">(</span><span class="ident" id="5422600">x</span><span class="op" id="5422601">,</span>&nbsp;<span class="ident" id="5422603">y</span>&nbsp;<span class="builtintype" id="5422605">int</span><span class="op" id="5422608">)</span>&nbsp;<span class="builtintype" id="5422610">int</span>&nbsp;<span class="op" id="5422614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422617">return</span>&nbsp;<span class="op" id="5422624">(</span><span class="ident" id="5422625">y</span><span class="op" id="5422626">-</span><span class="ident" id="5422627">p</span><span class="op" id="5422628">.</span><span class="ident" id="5422629">Rect</span><span class="op" id="5422633">.</span><span class="ident" id="5422634">Min</span><span class="op" id="5422637">.</span><span class="ident" id="5422638">Y</span><span class="op" id="5422639">)</span><span class="op" id="5422640">*</span><span class="ident" id="5422641">p</span><span class="op" id="5422642">.</span><span class="ident" id="5422643">YStride</span>&nbsp;<span class="op" id="5422651">+</span>&nbsp;<span class="op" id="5422653">(</span><span class="ident" id="5422654">x</span>&nbsp;<span class="op" id="5422656">-</span>&nbsp;<span class="ident" id="5422658">p</span><span class="op" id="5422659">.</span><span class="ident" id="5422660">Rect</span><span class="op" id="5422664">.</span><span class="ident" id="5422665">Min</span><span class="op" id="5422668">.</span><span class="ident" id="5422669">X</span><span class="op" id="5422670">)</span><br>
<span class="lineno"></span><span class="op" id="5422672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="5422675">//&nbsp;COffset&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;first&nbsp;element&nbsp;of&nbsp;Cb&nbsp;or&nbsp;Cr&nbsp;that&nbsp;corresponds</span><br>
<span class="lineno"></span><span class="comment" id="5422754">//&nbsp;to&nbsp;the&nbsp;pixel&nbsp;at&nbsp;(x,&nbsp;y).</span><br>
<span class="lineno"></span><span class="keyword" id="5422781">func</span>&nbsp;<span class="op" id="5422786">(</span><span class="ident" id="5422787">p</span>&nbsp;<span class="op" id="5422789">*</span><span class="ident" id="5422790">YCbCr</span><span class="op" id="5422795">)</span>&nbsp;<span class="ident" id="5422797">COffset</span><span class="op" id="5422804">(</span><span class="ident" id="5422805">x</span><span class="op" id="5422806">,</span>&nbsp;<span class="ident" id="5422808">y</span>&nbsp;<span class="builtintype" id="5422810">int</span><span class="op" id="5422813">)</span>&nbsp;<span class="builtintype" id="5422815">int</span>&nbsp;<span class="op" id="5422819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422822">switch</span>&nbsp;<span class="ident" id="5422829">p</span><span class="op" id="5422830">.</span><span class="ident" id="5422831">SubsampleRatio</span>&nbsp;<span class="op" id="5422846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422849">case</span>&nbsp;<span class="ident" id="5422854">YCbCrSubsampleRatio422</span><span class="op" id="5422876">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422880">return</span>&nbsp;<span class="op" id="5422887">(</span><span class="ident" id="5422888">y</span><span class="op" id="5422889">-</span><span class="ident" id="5422890">p</span><span class="op" id="5422891">.</span><span class="ident" id="5422892">Rect</span><span class="op" id="5422896">.</span><span class="ident" id="5422897">Min</span><span class="op" id="5422900">.</span><span class="ident" id="5422901">Y</span><span class="op" id="5422902">)</span><span class="op" id="5422903">*</span><span class="ident" id="5422904">p</span><span class="op" id="5422905">.</span><span class="ident" id="5422906">CStride</span>&nbsp;<span class="op" id="5422914">+</span>&nbsp;<span class="op" id="5422916">(</span><span class="ident" id="5422917">x</span><span class="op" id="5422918">/</span><span class="num" id="5422919">2</span>&nbsp;<span class="op" id="5422921">-</span>&nbsp;<span class="ident" id="5422923">p</span><span class="op" id="5422924">.</span><span class="ident" id="5422925">Rect</span><span class="op" id="5422929">.</span><span class="ident" id="5422930">Min</span><span class="op" id="5422933">.</span><span class="ident" id="5422934">X</span><span class="op" id="5422935">/</span><span class="num" id="5422936">2</span><span class="op" id="5422937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422940">case</span>&nbsp;<span class="ident" id="5422945">YCbCrSubsampleRatio420</span><span class="op" id="5422967">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5422971">return</span>&nbsp;<span class="op" id="5422978">(</span><span class="ident" id="5422979">y</span><span class="op" id="5422980">/</span><span class="num" id="5422981">2</span><span class="op" id="5422982">-</span><span class="ident" id="5422983">p</span><span class="op" id="5422984">.</span><span class="ident" id="5422985">Rect</span><span class="op" id="5422989">.</span><span class="ident" id="5422990">Min</span><span class="op" id="5422993">.</span><span class="ident" id="5422994">Y</span><span class="op" id="5422995">/</span><span class="num" id="5422996">2</span><span class="op" id="5422997">)</span><span class="op" id="5422998">*</span><span class="ident" id="5422999">p</span><span class="op" id="5423000">.</span><span class="ident" id="5423001">CStride</span>&nbsp;<span class="op" id="5423009">+</span>&nbsp;<span class="op" id="5423011">(</span><span class="ident" id="5423012">x</span><span class="op" id="5423013">/</span><span class="num" id="5423014">2</span>&nbsp;<span class="op" id="5423016">-</span>&nbsp;<span class="ident" id="5423018">p</span><span class="op" id="5423019">.</span><span class="ident" id="5423020">Rect</span><span class="op" id="5423024">.</span><span class="ident" id="5423025">Min</span><span class="op" id="5423028">.</span><span class="ident" id="5423029">X</span><span class="op" id="5423030">/</span><span class="num" id="5423031">2</span><span class="op" id="5423032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423035">case</span>&nbsp;<span class="ident" id="5423040">YCbCrSubsampleRatio440</span><span class="op" id="5423062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423066">return</span>&nbsp;<span class="op" id="5423073">(</span><span class="ident" id="5423074">y</span><span class="op" id="5423075">/</span><span class="num" id="5423076">2</span><span class="op" id="5423077">-</span><span class="ident" id="5423078">p</span><span class="op" id="5423079">.</span><span class="ident" id="5423080">Rect</span><span class="op" id="5423084">.</span><span class="ident" id="5423085">Min</span><span class="op" id="5423088">.</span><span class="ident" id="5423089">Y</span><span class="op" id="5423090">/</span><span class="num" id="5423091">2</span><span class="op" id="5423092">)</span><span class="op" id="5423093">*</span><span class="ident" id="5423094">p</span><span class="op" id="5423095">.</span><span class="ident" id="5423096">CStride</span>&nbsp;<span class="op" id="5423104">+</span>&nbsp;<span class="op" id="5423106">(</span><span class="ident" id="5423107">x</span>&nbsp;<span class="op" id="5423109">-</span>&nbsp;<span class="ident" id="5423111">p</span><span class="op" id="5423112">.</span><span class="ident" id="5423113">Rect</span><span class="op" id="5423117">.</span><span class="ident" id="5423118">Min</span><span class="op" id="5423121">.</span><span class="ident" id="5423122">X</span><span class="op" id="5423123">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423129">//&nbsp;Default&nbsp;to&nbsp;4:4:4&nbsp;subsampling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423163">return</span>&nbsp;<span class="op" id="5423170">(</span><span class="ident" id="5423171">y</span><span class="op" id="5423172">-</span><span class="ident" id="5423173">p</span><span class="op" id="5423174">.</span><span class="ident" id="5423175">Rect</span><span class="op" id="5423179">.</span><span class="ident" id="5423180">Min</span><span class="op" id="5423183">.</span><span class="ident" id="5423184">Y</span><span class="op" id="5423185">)</span><span class="op" id="5423186">*</span><span class="ident" id="5423187">p</span><span class="op" id="5423188">.</span><span class="ident" id="5423189">CStride</span>&nbsp;<span class="op" id="5423197">+</span>&nbsp;<span class="op" id="5423199">(</span><span class="ident" id="5423200">x</span>&nbsp;<span class="op" id="5423202">-</span>&nbsp;<span class="ident" id="5423204">p</span><span class="op" id="5423205">.</span><span class="ident" id="5423206">Rect</span><span class="op" id="5423210">.</span><span class="ident" id="5423211">Min</span><span class="op" id="5423214">.</span><span class="ident" id="5423215">X</span><span class="op" id="5423216">)</span><br>
<span class="lineno"></span><span class="op" id="5423218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="5423221">//&nbsp;SubImage&nbsp;returns&nbsp;an&nbsp;image&nbsp;representing&nbsp;the&nbsp;portion&nbsp;of&nbsp;the&nbsp;image&nbsp;p&nbsp;visible</span><br>
<span class="lineno"></span><span class="comment" id="5423298">//&nbsp;through&nbsp;r.&nbsp;The&nbsp;returned&nbsp;value&nbsp;shares&nbsp;pixels&nbsp;with&nbsp;the&nbsp;original&nbsp;image.</span><br>
<span class="lineno"></span><span class="keyword" id="5423370">func</span>&nbsp;<span class="op" id="5423375">(</span><span class="ident" id="5423376">p</span>&nbsp;<span class="op" id="5423378">*</span><span class="ident" id="5423379">YCbCr</span><span class="op" id="5423384">)</span>&nbsp;<span class="ident" id="5423386">SubImage</span><span class="op" id="5423394">(</span><span class="ident" id="5423395">r</span>&nbsp;<span class="ident" id="5423397">Rectangle</span><span class="op" id="5423406">)</span>&nbsp;<span class="ident" id="5423408">Image</span>&nbsp;<span class="op" id="5423414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423417">r</span>&nbsp;<span class="op" id="5423419">=</span>&nbsp;<span class="ident" id="5423421">r</span><span class="op" id="5423422">.</span><span class="ident" id="5423423">Intersect</span><span class="op" id="5423432">(</span><span class="ident" id="5423433">p</span><span class="op" id="5423434">.</span><span class="ident" id="5423435">Rect</span><span class="op" id="5423439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423442">//&nbsp;If&nbsp;r1&nbsp;and&nbsp;r2&nbsp;are&nbsp;Rectangles,&nbsp;r1.Intersect(r2)&nbsp;is&nbsp;not&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;inside</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423523">//&nbsp;either&nbsp;r1&nbsp;or&nbsp;r2&nbsp;if&nbsp;the&nbsp;intersection&nbsp;is&nbsp;empty.&nbsp;Without&nbsp;explicitly&nbsp;checking&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5423605">//&nbsp;this,&nbsp;the&nbsp;Pix[i:]&nbsp;expression&nbsp;below&nbsp;can&nbsp;panic.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423655">if</span>&nbsp;<span class="ident" id="5423658">r</span><span class="op" id="5423659">.</span><span class="ident" id="5423660">Empty</span><span class="op" id="5423665">(</span><span class="op" id="5423666">)</span>&nbsp;<span class="op" id="5423668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423672">return</span>&nbsp;<span class="op" id="5423679">&amp;</span><span class="ident" id="5423680">YCbCr</span><span class="op" id="5423685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423690">SubsampleRatio</span><span class="op" id="5423704">:</span>&nbsp;<span class="ident" id="5423706">p</span><span class="op" id="5423707">.</span><span class="ident" id="5423708">SubsampleRatio</span><span class="op" id="5423722">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5423729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423732">yi</span>&nbsp;<span class="op" id="5423735">:=</span>&nbsp;<span class="ident" id="5423738">p</span><span class="op" id="5423739">.</span><span class="ident" id="5423740">YOffset</span><span class="op" id="5423747">(</span><span class="ident" id="5423748">r</span><span class="op" id="5423749">.</span><span class="ident" id="5423750">Min</span><span class="op" id="5423753">.</span><span class="ident" id="5423754">X</span><span class="op" id="5423755">,</span>&nbsp;<span class="ident" id="5423757">r</span><span class="op" id="5423758">.</span><span class="ident" id="5423759">Min</span><span class="op" id="5423762">.</span><span class="ident" id="5423763">Y</span><span class="op" id="5423764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423767">ci</span>&nbsp;<span class="op" id="5423770">:=</span>&nbsp;<span class="ident" id="5423773">p</span><span class="op" id="5423774">.</span><span class="ident" id="5423775">COffset</span><span class="op" id="5423782">(</span><span class="ident" id="5423783">r</span><span class="op" id="5423784">.</span><span class="ident" id="5423785">Min</span><span class="op" id="5423788">.</span><span class="ident" id="5423789">X</span><span class="op" id="5423790">,</span>&nbsp;<span class="ident" id="5423792">r</span><span class="op" id="5423793">.</span><span class="ident" id="5423794">Min</span><span class="op" id="5423797">.</span><span class="ident" id="5423798">Y</span><span class="op" id="5423799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5423802">return</span>&nbsp;<span class="op" id="5423809">&amp;</span><span class="ident" id="5423810">YCbCr</span><span class="op" id="5423815">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423819">Y</span><span class="op" id="5423820">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5423835">p</span><span class="op" id="5423836">.</span><span class="ident" id="5423837">Y</span><span class="op" id="5423838">[</span><span class="ident" id="5423839">yi</span><span class="op" id="5423841">:</span><span class="op" id="5423842">]</span><span class="op" id="5423843">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423847">Cb</span><span class="op" id="5423849">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5423863">p</span><span class="op" id="5423864">.</span><span class="ident" id="5423865">Cb</span><span class="op" id="5423867">[</span><span class="ident" id="5423868">ci</span><span class="op" id="5423870">:</span><span class="op" id="5423871">]</span><span class="op" id="5423872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423876">Cr</span><span class="op" id="5423878">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5423892">p</span><span class="op" id="5423893">.</span><span class="ident" id="5423894">Cr</span><span class="op" id="5423896">[</span><span class="ident" id="5423897">ci</span><span class="op" id="5423899">:</span><span class="op" id="5423900">]</span><span class="op" id="5423901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423905">SubsampleRatio</span><span class="op" id="5423919">:</span>&nbsp;<span class="ident" id="5423921">p</span><span class="op" id="5423922">.</span><span class="ident" id="5423923">SubsampleRatio</span><span class="op" id="5423937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423941">YStride</span><span class="op" id="5423948">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5423957">p</span><span class="op" id="5423958">.</span><span class="ident" id="5423959">YStride</span><span class="op" id="5423966">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423970">CStride</span><span class="op" id="5423977">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5423986">p</span><span class="op" id="5423987">.</span><span class="ident" id="5423988">CStride</span><span class="op" id="5423995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5423999">Rect</span><span class="op" id="5424003">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424015">r</span><span class="op" id="5424016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424019">}</span><br>
<span class="lineno"></span><span class="op" id="5424021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="5424024">func</span>&nbsp;<span class="op" id="5424029">(</span><span class="ident" id="5424030">p</span>&nbsp;<span class="op" id="5424032">*</span><span class="ident" id="5424033">YCbCr</span><span class="op" id="5424038">)</span>&nbsp;<span class="ident" id="5424040">Opaque</span><span class="op" id="5424046">(</span><span class="op" id="5424047">)</span>&nbsp;<span class="builtintype" id="5424049">bool</span>&nbsp;<span class="op" id="5424054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424057">return</span>&nbsp;<span class="builtintype" id="5424064">true</span><br>
<span class="lineno"></span><span class="op" id="5424069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5424072">//&nbsp;NewYCbCr&nbsp;returns&nbsp;a&nbsp;new&nbsp;YCbCr&nbsp;with&nbsp;the&nbsp;given&nbsp;bounds&nbsp;and&nbsp;subsample&nbsp;ratio.</span><br>
<span class="lineno">130</span><span class="keyword" id="5424147">func</span>&nbsp;<span class="ident" id="5424152">NewYCbCr</span><span class="op" id="5424160">(</span><span class="ident" id="5424161">r</span>&nbsp;<span class="ident" id="5424163">Rectangle</span><span class="op" id="5424172">,</span>&nbsp;<span class="ident" id="5424174">subsampleRatio</span>&nbsp;<span class="ident" id="5424189">YCbCrSubsampleRatio</span><span class="op" id="5424208">)</span>&nbsp;<span class="op" id="5424210">*</span><span class="ident" id="5424211">YCbCr</span>&nbsp;<span class="op" id="5424217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424220">w</span><span class="op" id="5424221">,</span>&nbsp;<span class="ident" id="5424223">h</span><span class="op" id="5424224">,</span>&nbsp;<span class="ident" id="5424226">cw</span><span class="op" id="5424228">,</span>&nbsp;<span class="ident" id="5424230">ch</span>&nbsp;<span class="op" id="5424233">:=</span>&nbsp;<span class="ident" id="5424236">r</span><span class="op" id="5424237">.</span><span class="ident" id="5424238">Dx</span><span class="op" id="5424240">(</span><span class="op" id="5424241">)</span><span class="op" id="5424242">,</span>&nbsp;<span class="ident" id="5424244">r</span><span class="op" id="5424245">.</span><span class="ident" id="5424246">Dy</span><span class="op" id="5424248">(</span><span class="op" id="5424249">)</span><span class="op" id="5424250">,</span>&nbsp;<span class="num" id="5424252">0</span><span class="op" id="5424253">,</span>&nbsp;<span class="num" id="5424255">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424258">switch</span>&nbsp;<span class="ident" id="5424265">subsampleRatio</span>&nbsp;<span class="op" id="5424280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424283">case</span>&nbsp;<span class="ident" id="5424288">YCbCrSubsampleRatio422</span><span class="op" id="5424310">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424314">cw</span>&nbsp;<span class="op" id="5424317">=</span>&nbsp;<span class="op" id="5424319">(</span><span class="ident" id="5424320">r</span><span class="op" id="5424321">.</span><span class="ident" id="5424322">Max</span><span class="op" id="5424325">.</span><span class="ident" id="5424326">X</span><span class="op" id="5424327">+</span><span class="num" id="5424328">1</span><span class="op" id="5424329">)</span><span class="op" id="5424330">/</span><span class="num" id="5424331">2</span>&nbsp;<span class="op" id="5424333">-</span>&nbsp;<span class="ident" id="5424335">r</span><span class="op" id="5424336">.</span><span class="ident" id="5424337">Min</span><span class="op" id="5424340">.</span><span class="ident" id="5424341">X</span><span class="op" id="5424342">/</span><span class="num" id="5424343">2</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424347">ch</span>&nbsp;<span class="op" id="5424350">=</span>&nbsp;<span class="ident" id="5424352">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424355">case</span>&nbsp;<span class="ident" id="5424360">YCbCrSubsampleRatio420</span><span class="op" id="5424382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424386">cw</span>&nbsp;<span class="op" id="5424389">=</span>&nbsp;<span class="op" id="5424391">(</span><span class="ident" id="5424392">r</span><span class="op" id="5424393">.</span><span class="ident" id="5424394">Max</span><span class="op" id="5424397">.</span><span class="ident" id="5424398">X</span><span class="op" id="5424399">+</span><span class="num" id="5424400">1</span><span class="op" id="5424401">)</span><span class="op" id="5424402">/</span><span class="num" id="5424403">2</span>&nbsp;<span class="op" id="5424405">-</span>&nbsp;<span class="ident" id="5424407">r</span><span class="op" id="5424408">.</span><span class="ident" id="5424409">Min</span><span class="op" id="5424412">.</span><span class="ident" id="5424413">X</span><span class="op" id="5424414">/</span><span class="num" id="5424415">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424419">ch</span>&nbsp;<span class="op" id="5424422">=</span>&nbsp;<span class="op" id="5424424">(</span><span class="ident" id="5424425">r</span><span class="op" id="5424426">.</span><span class="ident" id="5424427">Max</span><span class="op" id="5424430">.</span><span class="ident" id="5424431">Y</span><span class="op" id="5424432">+</span><span class="num" id="5424433">1</span><span class="op" id="5424434">)</span><span class="op" id="5424435">/</span><span class="num" id="5424436">2</span>&nbsp;<span class="op" id="5424438">-</span>&nbsp;<span class="ident" id="5424440">r</span><span class="op" id="5424441">.</span><span class="ident" id="5424442">Min</span><span class="op" id="5424445">.</span><span class="ident" id="5424446">Y</span><span class="op" id="5424447">/</span><span class="num" id="5424448">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424451">case</span>&nbsp;<span class="ident" id="5424456">YCbCrSubsampleRatio440</span><span class="op" id="5424478">:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424482">cw</span>&nbsp;<span class="op" id="5424485">=</span>&nbsp;<span class="ident" id="5424487">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424491">ch</span>&nbsp;<span class="op" id="5424494">=</span>&nbsp;<span class="op" id="5424496">(</span><span class="ident" id="5424497">r</span><span class="op" id="5424498">.</span><span class="ident" id="5424499">Max</span><span class="op" id="5424502">.</span><span class="ident" id="5424503">Y</span><span class="op" id="5424504">+</span><span class="num" id="5424505">1</span><span class="op" id="5424506">)</span><span class="op" id="5424507">/</span><span class="num" id="5424508">2</span>&nbsp;<span class="op" id="5424510">-</span>&nbsp;<span class="ident" id="5424512">r</span><span class="op" id="5424513">.</span><span class="ident" id="5424514">Min</span><span class="op" id="5424517">.</span><span class="ident" id="5424518">Y</span><span class="op" id="5424519">/</span><span class="num" id="5424520">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424523">default</span><span class="op" id="5424530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5424534">//&nbsp;Default&nbsp;to&nbsp;4:4:4&nbsp;subsampling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424569">cw</span>&nbsp;<span class="op" id="5424572">=</span>&nbsp;<span class="ident" id="5424574">w</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424578">ch</span>&nbsp;<span class="op" id="5424581">=</span>&nbsp;<span class="ident" id="5424583">h</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424589">b</span>&nbsp;<span class="op" id="5424591">:=</span>&nbsp;<span class="builtinfunc" id="5424594">make</span><span class="op" id="5424598">(</span><span class="op" id="5424599">[</span><span class="op" id="5424600">]</span><span class="builtintype" id="5424601">byte</span><span class="op" id="5424605">,</span>&nbsp;<span class="ident" id="5424607">w</span><span class="op" id="5424608">*</span><span class="ident" id="5424609">h</span><span class="op" id="5424610">+</span><span class="num" id="5424611">2</span><span class="op" id="5424612">*</span><span class="ident" id="5424613">cw</span><span class="op" id="5424615">*</span><span class="ident" id="5424616">ch</span><span class="op" id="5424618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5424621">return</span>&nbsp;<span class="op" id="5424628">&amp;</span><span class="ident" id="5424629">YCbCr</span><span class="op" id="5424634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424638">Y</span><span class="op" id="5424639">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424654">b</span><span class="op" id="5424655">[</span><span class="op" id="5424656">:</span><span class="ident" id="5424657">w</span><span class="op" id="5424658">*</span><span class="ident" id="5424659">h</span><span class="op" id="5424660">]</span><span class="op" id="5424661">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424665">Cb</span><span class="op" id="5424667">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424681">b</span><span class="op" id="5424682">[</span><span class="ident" id="5424683">w</span><span class="op" id="5424684">*</span><span class="ident" id="5424685">h</span><span class="op" id="5424686">+</span><span class="num" id="5424687">0</span><span class="op" id="5424688">*</span><span class="ident" id="5424689">cw</span><span class="op" id="5424691">*</span><span class="ident" id="5424692">ch</span>&nbsp;<span class="op" id="5424695">:</span>&nbsp;<span class="ident" id="5424697">w</span><span class="op" id="5424698">*</span><span class="ident" id="5424699">h</span><span class="op" id="5424700">+</span><span class="num" id="5424701">1</span><span class="op" id="5424702">*</span><span class="ident" id="5424703">cw</span><span class="op" id="5424705">*</span><span class="ident" id="5424706">ch</span><span class="op" id="5424708">]</span><span class="op" id="5424709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424713">Cr</span><span class="op" id="5424715">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424729">b</span><span class="op" id="5424730">[</span><span class="ident" id="5424731">w</span><span class="op" id="5424732">*</span><span class="ident" id="5424733">h</span><span class="op" id="5424734">+</span><span class="num" id="5424735">1</span><span class="op" id="5424736">*</span><span class="ident" id="5424737">cw</span><span class="op" id="5424739">*</span><span class="ident" id="5424740">ch</span>&nbsp;<span class="op" id="5424743">:</span>&nbsp;<span class="ident" id="5424745">w</span><span class="op" id="5424746">*</span><span class="ident" id="5424747">h</span><span class="op" id="5424748">+</span><span class="num" id="5424749">2</span><span class="op" id="5424750">*</span><span class="ident" id="5424751">cw</span><span class="op" id="5424753">*</span><span class="ident" id="5424754">ch</span><span class="op" id="5424756">]</span><span class="op" id="5424757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424761">SubsampleRatio</span><span class="op" id="5424775">:</span>&nbsp;<span class="ident" id="5424777">subsampleRatio</span><span class="op" id="5424791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424795">YStride</span><span class="op" id="5424802">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424811">w</span><span class="op" id="5424812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424816">CStride</span><span class="op" id="5424823">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424832">cw</span><span class="op" id="5424834">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5424838">Rect</span><span class="op" id="5424842">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5424854">r</span><span class="op" id="5424855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5424858">}</span><br>
<span class="lineno"></span><span class="op" id="5424860">}</span>
</div>
</body>
</html>
