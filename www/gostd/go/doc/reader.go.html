<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5171570">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5171625">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5171679">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5171730">package</span>&nbsp;<span class="ident" id="5171738">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5171743">import</span>&nbsp;<span class="op" id="5171750">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5171753">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5171763">&#34;go/token&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5171775">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5171785">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5171793">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="5171803">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5171806">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5171886">//&nbsp;function/method&nbsp;sets</span><br>
<span class="lineno"></span><span class="comment" id="5171910">//</span><br>
<span class="lineno"></span><span class="comment" id="5171913">//&nbsp;Internally,&nbsp;we&nbsp;treat&nbsp;functions&nbsp;like&nbsp;methods&nbsp;and&nbsp;collect&nbsp;them&nbsp;in&nbsp;method&nbsp;sets.</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5171994">//&nbsp;A&nbsp;methodSet&nbsp;describes&nbsp;a&nbsp;set&nbsp;of&nbsp;methods.&nbsp;Entries&nbsp;where&nbsp;Decl&nbsp;==&nbsp;nil&nbsp;are&nbsp;conflict</span><br>
<span class="lineno"></span><span class="comment" id="5172076">//&nbsp;entries&nbsp;(more&nbsp;then&nbsp;one&nbsp;method&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;at&nbsp;the&nbsp;same&nbsp;embedding&nbsp;level).</span><br>
<span class="lineno"></span><span class="comment" id="5172158">//</span><br>
<span class="lineno"></span><span class="keyword" id="5172161">type</span>&nbsp;<span class="ident" id="5172166">methodSet</span>&nbsp;<span class="keyword" id="5172176">map</span><span class="op" id="5172179">[</span><span class="builtintype" id="5172180">string</span><span class="op" id="5172186">]</span><span class="op" id="5172187">*</span><span class="ident" id="5172188">Func</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="5172194">//&nbsp;recvString&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;recv&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5172255">//&nbsp;form&nbsp;&#34;T&#34;,&nbsp;&#34;*T&#34;,&nbsp;or&nbsp;&#34;BADRECV&#34;&nbsp;(if&nbsp;not&nbsp;a&nbsp;proper&nbsp;receiver&nbsp;type).</span><br>
<span class="lineno"></span><span class="comment" id="5172320">//</span><br>
<span class="lineno"></span><span class="keyword" id="5172323">func</span>&nbsp;<span class="ident" id="5172328">recvString</span><span class="op" id="5172338">(</span><span class="ident" id="5172339">recv</span>&nbsp;<span class="ident" id="5172344">ast</span><span class="op" id="5172347">.</span><span class="ident" id="5172348">Expr</span><span class="op" id="5172352">)</span>&nbsp;<span class="builtintype" id="5172354">string</span>&nbsp;<span class="op" id="5172361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172364">switch</span>&nbsp;<span class="ident" id="5172371">t</span>&nbsp;<span class="op" id="5172373">:=</span>&nbsp;<span class="ident" id="5172376">recv</span><span class="op" id="5172380">.</span><span class="op" id="5172381">(</span><span class="keyword" id="5172382">type</span><span class="op" id="5172386">)</span>&nbsp;<span class="op" id="5172388">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172391">case</span>&nbsp;<span class="op" id="5172396">*</span><span class="ident" id="5172397">ast</span><span class="op" id="5172400">.</span><span class="ident" id="5172401">Ident</span><span class="op" id="5172406">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172410">return</span>&nbsp;<span class="ident" id="5172417">t</span><span class="op" id="5172418">.</span><span class="ident" id="5172419">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172425">case</span>&nbsp;<span class="op" id="5172430">*</span><span class="ident" id="5172431">ast</span><span class="op" id="5172434">.</span><span class="ident" id="5172435">StarExpr</span><span class="op" id="5172443">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172447">return</span>&nbsp;<span class="string" id="5172454">&#34;*&#34;</span>&nbsp;<span class="op" id="5172458">+</span>&nbsp;<span class="ident" id="5172460">recvString</span><span class="op" id="5172470">(</span><span class="ident" id="5172471">t</span><span class="op" id="5172472">.</span><span class="ident" id="5172473">X</span><span class="op" id="5172474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5172477">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172480">return</span>&nbsp;<span class="string" id="5172487">&#34;BADRECV&#34;</span><br>
<span class="lineno"></span><span class="op" id="5172497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5172500">//&nbsp;set&nbsp;creates&nbsp;the&nbsp;corresponding&nbsp;Func&nbsp;for&nbsp;f&nbsp;and&nbsp;adds&nbsp;it&nbsp;to&nbsp;mset.</span><br>
<span class="lineno"></span><span class="comment" id="5172565">//&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;f&#39;s&nbsp;with&nbsp;the&nbsp;same&nbsp;name,&nbsp;set&nbsp;keeps&nbsp;the&nbsp;first</span><br>
<span class="lineno">40</span><span class="comment" id="5172634">//&nbsp;one&nbsp;with&nbsp;documentation;&nbsp;conflicts&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="5172684">//</span><br>
<span class="lineno"></span><span class="keyword" id="5172687">func</span>&nbsp;<span class="op" id="5172692">(</span><span class="ident" id="5172693">mset</span>&nbsp;<span class="ident" id="5172698">methodSet</span><span class="op" id="5172707">)</span>&nbsp;<span class="ident" id="5172709">set</span><span class="op" id="5172712">(</span><span class="ident" id="5172713">f</span>&nbsp;<span class="op" id="5172715">*</span><span class="ident" id="5172716">ast</span><span class="op" id="5172719">.</span><span class="ident" id="5172720">FuncDecl</span><span class="op" id="5172728">)</span>&nbsp;<span class="op" id="5172730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5172733">name</span>&nbsp;<span class="op" id="5172738">:=</span>&nbsp;<span class="ident" id="5172741">f</span><span class="op" id="5172742">.</span><span class="ident" id="5172743">Name</span><span class="op" id="5172747">.</span><span class="ident" id="5172748">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5172754">if</span>&nbsp;<span class="ident" id="5172757">g</span>&nbsp;<span class="op" id="5172759">:=</span>&nbsp;<span class="ident" id="5172762">mset</span><span class="op" id="5172766">[</span><span class="ident" id="5172767">name</span><span class="op" id="5172771">]</span><span class="op" id="5172772">;</span>&nbsp;<span class="ident" id="5172774">g</span>&nbsp;<span class="op" id="5172776">!=</span>&nbsp;<span class="ident" id="5172779">nil</span>&nbsp;<span class="op" id="5172783">&amp;&amp;</span>&nbsp;<span class="ident" id="5172786">g</span><span class="op" id="5172787">.</span><span class="ident" id="5172788">Doc</span>&nbsp;<span class="op" id="5172792">!=</span>&nbsp;<span class="string" id="5172795">&#34;&#34;</span>&nbsp;<span class="op" id="5172798">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172802">//&nbsp;A&nbsp;function&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;has&nbsp;already&nbsp;been&nbsp;registered;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172866">//&nbsp;since&nbsp;it&nbsp;has&nbsp;documentation,&nbsp;assume&nbsp;f&nbsp;is&nbsp;simply&nbsp;another</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172926">//&nbsp;implementation&nbsp;and&nbsp;ignore&nbsp;it.&nbsp;This&nbsp;does&nbsp;not&nbsp;happen&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5172989">//&nbsp;caller&nbsp;is&nbsp;using&nbsp;go/build.ScanDir&nbsp;to&nbsp;determine&nbsp;the&nbsp;list&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173052">//&nbsp;files&nbsp;implementing&nbsp;a&nbsp;package.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173087">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173098">//&nbsp;function&nbsp;doesn&#39;t&nbsp;exist&nbsp;or&nbsp;has&nbsp;no&nbsp;documentation;&nbsp;use&nbsp;f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173156">recv</span>&nbsp;<span class="op" id="5173161">:=</span>&nbsp;<span class="string" id="5173164">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173168">if</span>&nbsp;<span class="ident" id="5173171">f</span><span class="op" id="5173172">.</span><span class="ident" id="5173173">Recv</span>&nbsp;<span class="op" id="5173178">!=</span>&nbsp;<span class="ident" id="5173181">nil</span>&nbsp;<span class="op" id="5173185">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173189">var</span>&nbsp;<span class="ident" id="5173193">typ</span>&nbsp;<span class="ident" id="5173197">ast</span><span class="op" id="5173200">.</span><span class="ident" id="5173201">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173208">//&nbsp;be&nbsp;careful&nbsp;in&nbsp;case&nbsp;of&nbsp;incorrect&nbsp;ASTs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173250">if</span>&nbsp;<span class="ident" id="5173253">list</span>&nbsp;<span class="op" id="5173258">:=</span>&nbsp;<span class="ident" id="5173261">f</span><span class="op" id="5173262">.</span><span class="ident" id="5173263">Recv</span><span class="op" id="5173267">.</span><span class="ident" id="5173268">List</span><span class="op" id="5173272">;</span>&nbsp;<span class="builtinfunc" id="5173274">len</span><span class="op" id="5173277">(</span><span class="ident" id="5173278">list</span><span class="op" id="5173282">)</span>&nbsp;<span class="op" id="5173284">==</span>&nbsp;<span class="num" id="5173287">1</span>&nbsp;<span class="op" id="5173289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173294">typ</span>&nbsp;<span class="op" id="5173298">=</span>&nbsp;<span class="ident" id="5173300">list</span><span class="op" id="5173304">[</span><span class="num" id="5173305">0</span><span class="op" id="5173306">]</span><span class="op" id="5173307">.</span><span class="ident" id="5173308">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173315">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173319">recv</span>&nbsp;<span class="op" id="5173324">=</span>&nbsp;<span class="ident" id="5173326">recvString</span><span class="op" id="5173336">(</span><span class="ident" id="5173337">typ</span><span class="op" id="5173340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173346">mset</span><span class="op" id="5173350">[</span><span class="ident" id="5173351">name</span><span class="op" id="5173355">]</span>&nbsp;<span class="op" id="5173357">=</span>&nbsp;<span class="op" id="5173359">&amp;</span><span class="ident" id="5173360">Func</span><span class="op" id="5173364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173368">Doc</span><span class="op" id="5173371">:</span>&nbsp;&nbsp;<span class="ident" id="5173374">f</span><span class="op" id="5173375">.</span><span class="ident" id="5173376">Doc</span><span class="op" id="5173379">.</span><span class="ident" id="5173380">Text</span><span class="op" id="5173384">(</span><span class="op" id="5173385">)</span><span class="op" id="5173386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173390">Name</span><span class="op" id="5173394">:</span>&nbsp;<span class="ident" id="5173396">name</span><span class="op" id="5173400">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173404">Decl</span><span class="op" id="5173408">:</span>&nbsp;<span class="ident" id="5173410">f</span><span class="op" id="5173411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173415">Recv</span><span class="op" id="5173419">:</span>&nbsp;<span class="ident" id="5173421">recv</span><span class="op" id="5173425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173429">Orig</span><span class="op" id="5173433">:</span>&nbsp;<span class="ident" id="5173435">recv</span><span class="op" id="5173439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173445">f</span><span class="op" id="5173446">.</span><span class="ident" id="5173447">Doc</span>&nbsp;<span class="op" id="5173451">=</span>&nbsp;<span class="ident" id="5173453">nil</span>&nbsp;<span class="comment" id="5173457">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno">70</span><span class="op" id="5173491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5173494">//&nbsp;add&nbsp;adds&nbsp;method&nbsp;m&nbsp;to&nbsp;the&nbsp;method&nbsp;set;&nbsp;m&nbsp;is&nbsp;ignored&nbsp;if&nbsp;the&nbsp;method&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="5173565">//&nbsp;already&nbsp;contains&nbsp;a&nbsp;method&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;at&nbsp;the&nbsp;same&nbsp;or&nbsp;a&nbsp;higher</span><br>
<span class="lineno"></span><span class="comment" id="5173637">//&nbsp;level&nbsp;then&nbsp;m.</span><br>
<span class="lineno">75</span><span class="comment" id="5173654">//</span><br>
<span class="lineno"></span><span class="keyword" id="5173657">func</span>&nbsp;<span class="op" id="5173662">(</span><span class="ident" id="5173663">mset</span>&nbsp;<span class="ident" id="5173668">methodSet</span><span class="op" id="5173677">)</span>&nbsp;<span class="ident" id="5173679">add</span><span class="op" id="5173682">(</span><span class="ident" id="5173683">m</span>&nbsp;<span class="op" id="5173685">*</span><span class="ident" id="5173686">Func</span><span class="op" id="5173690">)</span>&nbsp;<span class="op" id="5173692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173695">old</span>&nbsp;<span class="op" id="5173699">:=</span>&nbsp;<span class="ident" id="5173702">mset</span><span class="op" id="5173706">[</span><span class="ident" id="5173707">m</span><span class="op" id="5173708">.</span><span class="ident" id="5173709">Name</span><span class="op" id="5173713">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173716">if</span>&nbsp;<span class="ident" id="5173719">old</span>&nbsp;<span class="op" id="5173723">==</span>&nbsp;<span class="ident" id="5173726">nil</span>&nbsp;<span class="op" id="5173730">||</span>&nbsp;<span class="ident" id="5173733">m</span><span class="op" id="5173734">.</span><span class="ident" id="5173735">Level</span>&nbsp;<span class="op" id="5173741">&lt;</span>&nbsp;<span class="ident" id="5173743">old</span><span class="op" id="5173746">.</span><span class="ident" id="5173747">Level</span>&nbsp;<span class="op" id="5173753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173757">mset</span><span class="op" id="5173761">[</span><span class="ident" id="5173762">m</span><span class="op" id="5173763">.</span><span class="ident" id="5173764">Name</span><span class="op" id="5173768">]</span>&nbsp;<span class="op" id="5173770">=</span>&nbsp;<span class="ident" id="5173772">m</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173776">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5173787">if</span>&nbsp;<span class="ident" id="5173790">old</span>&nbsp;<span class="op" id="5173794">!=</span>&nbsp;<span class="ident" id="5173797">nil</span>&nbsp;<span class="op" id="5173801">&amp;&amp;</span>&nbsp;<span class="ident" id="5173804">m</span><span class="op" id="5173805">.</span><span class="ident" id="5173806">Level</span>&nbsp;<span class="op" id="5173812">==</span>&nbsp;<span class="ident" id="5173815">old</span><span class="op" id="5173818">.</span><span class="ident" id="5173819">Level</span>&nbsp;<span class="op" id="5173825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5173829">//&nbsp;conflict&nbsp;-&nbsp;mark&nbsp;it&nbsp;using&nbsp;a&nbsp;method&nbsp;with&nbsp;nil&nbsp;Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173882">mset</span><span class="op" id="5173886">[</span><span class="ident" id="5173887">m</span><span class="op" id="5173888">.</span><span class="ident" id="5173889">Name</span><span class="op" id="5173893">]</span>&nbsp;<span class="op" id="5173895">=</span>&nbsp;<span class="op" id="5173897">&amp;</span><span class="ident" id="5173898">Func</span><span class="op" id="5173902">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173907">Name</span><span class="op" id="5173911">:</span>&nbsp;&nbsp;<span class="ident" id="5173914">m</span><span class="op" id="5173915">.</span><span class="ident" id="5173916">Name</span><span class="op" id="5173920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5173925">Level</span><span class="op" id="5173930">:</span>&nbsp;<span class="ident" id="5173932">m</span><span class="op" id="5173933">.</span><span class="ident" id="5173934">Level</span><span class="op" id="5173939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5173946">}</span><br>
<span class="lineno"></span><span class="op" id="5173948">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="5173951">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5174031">//&nbsp;Named&nbsp;types</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5174047">//&nbsp;baseTypeName&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;base&nbsp;type&nbsp;of&nbsp;x&nbsp;(or&nbsp;&#34;&#34;)</span><br>
<span class="lineno">95</span><span class="comment" id="5174110">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;type&nbsp;is&nbsp;imported&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span><span class="comment" id="5174154">//</span><br>
<span class="lineno"></span><span class="keyword" id="5174157">func</span>&nbsp;<span class="ident" id="5174162">baseTypeName</span><span class="op" id="5174174">(</span><span class="ident" id="5174175">x</span>&nbsp;<span class="ident" id="5174177">ast</span><span class="op" id="5174180">.</span><span class="ident" id="5174181">Expr</span><span class="op" id="5174185">)</span>&nbsp;<span class="op" id="5174187">(</span><span class="ident" id="5174188">name</span>&nbsp;<span class="builtintype" id="5174193">string</span><span class="op" id="5174199">,</span>&nbsp;<span class="ident" id="5174201">imported</span>&nbsp;<span class="builtintype" id="5174210">bool</span><span class="op" id="5174214">)</span>&nbsp;<span class="op" id="5174216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174219">switch</span>&nbsp;<span class="ident" id="5174226">t</span>&nbsp;<span class="op" id="5174228">:=</span>&nbsp;<span class="ident" id="5174231">x</span><span class="op" id="5174232">.</span><span class="op" id="5174233">(</span><span class="keyword" id="5174234">type</span><span class="op" id="5174238">)</span>&nbsp;<span class="op" id="5174240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174243">case</span>&nbsp;<span class="op" id="5174248">*</span><span class="ident" id="5174249">ast</span><span class="op" id="5174252">.</span><span class="ident" id="5174253">Ident</span><span class="op" id="5174258">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174262">return</span>&nbsp;<span class="ident" id="5174269">t</span><span class="op" id="5174270">.</span><span class="ident" id="5174271">Name</span><span class="op" id="5174275">,</span>&nbsp;<span class="builtintype" id="5174277">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174284">case</span>&nbsp;<span class="op" id="5174289">*</span><span class="ident" id="5174290">ast</span><span class="op" id="5174293">.</span><span class="ident" id="5174294">SelectorExpr</span><span class="op" id="5174306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174310">if</span>&nbsp;<span class="ident" id="5174313">_</span><span class="op" id="5174314">,</span>&nbsp;<span class="ident" id="5174316">ok</span>&nbsp;<span class="op" id="5174319">:=</span>&nbsp;<span class="ident" id="5174322">t</span><span class="op" id="5174323">.</span><span class="ident" id="5174324">X</span><span class="op" id="5174325">.</span><span class="op" id="5174326">(</span><span class="op" id="5174327">*</span><span class="ident" id="5174328">ast</span><span class="op" id="5174331">.</span><span class="ident" id="5174332">Ident</span><span class="op" id="5174337">)</span><span class="op" id="5174338">;</span>&nbsp;<span class="ident" id="5174340">ok</span>&nbsp;<span class="op" id="5174343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5174348">//&nbsp;only&nbsp;possible&nbsp;for&nbsp;qualified&nbsp;type&nbsp;names;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5174394">//&nbsp;assume&nbsp;type&nbsp;is&nbsp;imported</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174424">return</span>&nbsp;<span class="ident" id="5174431">t</span><span class="op" id="5174432">.</span><span class="ident" id="5174433">Sel</span><span class="op" id="5174436">.</span><span class="ident" id="5174437">Name</span><span class="op" id="5174441">,</span>&nbsp;<span class="builtintype" id="5174443">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174453">case</span>&nbsp;<span class="op" id="5174458">*</span><span class="ident" id="5174459">ast</span><span class="op" id="5174462">.</span><span class="ident" id="5174463">StarExpr</span><span class="op" id="5174471">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174475">return</span>&nbsp;<span class="ident" id="5174482">baseTypeName</span><span class="op" id="5174494">(</span><span class="ident" id="5174495">t</span><span class="op" id="5174496">.</span><span class="ident" id="5174497">X</span><span class="op" id="5174498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5174501">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5174504">return</span><br>
<span class="lineno"></span><span class="op" id="5174511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5174514">//&nbsp;An&nbsp;embeddedSet&nbsp;describes&nbsp;a&nbsp;set&nbsp;of&nbsp;embedded&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="5174567">type</span>&nbsp;<span class="ident" id="5174572">embeddedSet</span>&nbsp;<span class="keyword" id="5174584">map</span><span class="op" id="5174587">[</span><span class="op" id="5174588">*</span><span class="ident" id="5174589">namedType</span><span class="op" id="5174598">]</span><span class="builtintype" id="5174599">bool</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="5174605">//&nbsp;A&nbsp;namedType&nbsp;represents&nbsp;a&nbsp;named&nbsp;unqualified&nbsp;(package&nbsp;local,&nbsp;or&nbsp;possibly</span><br>
<span class="lineno"></span><span class="comment" id="5174679">//&nbsp;predeclared)&nbsp;type.&nbsp;The&nbsp;namedType&nbsp;for&nbsp;a&nbsp;type&nbsp;name&nbsp;is&nbsp;always&nbsp;found&nbsp;via</span><br>
<span class="lineno"></span><span class="comment" id="5174751">//&nbsp;reader.lookupType.</span><br>
<span class="lineno"></span><span class="comment" id="5174773">//</span><br>
<span class="lineno">120</span><span class="keyword" id="5174776">type</span>&nbsp;<span class="ident" id="5174781">namedType</span>&nbsp;<span class="keyword" id="5174791">struct</span>&nbsp;<span class="op" id="5174798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174801">doc</span>&nbsp;&nbsp;<span class="builtintype" id="5174806">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5174819">//&nbsp;doc&nbsp;comment&nbsp;for&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174844">name</span>&nbsp;<span class="builtintype" id="5174849">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5174862">//&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174876">decl</span>&nbsp;<span class="op" id="5174881">*</span><span class="ident" id="5174882">ast</span><span class="op" id="5174885">.</span><span class="ident" id="5174886">GenDecl</span>&nbsp;<span class="comment" id="5174894">//&nbsp;nil&nbsp;if&nbsp;declaration&nbsp;hasn&#39;t&nbsp;been&nbsp;seen&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174939">isEmbedded</span>&nbsp;<span class="builtintype" id="5174950">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5174962">//&nbsp;true&nbsp;if&nbsp;this&nbsp;type&nbsp;is&nbsp;embedded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5174996">isStruct</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5175007">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5175019">//&nbsp;true&nbsp;if&nbsp;this&nbsp;type&nbsp;is&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175053">embedded</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5175064">embeddedSet</span>&nbsp;<span class="comment" id="5175076">//&nbsp;true&nbsp;if&nbsp;the&nbsp;embedded&nbsp;type&nbsp;is&nbsp;a&nbsp;pointer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5175120">//&nbsp;associated&nbsp;declarations</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175148">values</span>&nbsp;&nbsp;<span class="op" id="5175156">[</span><span class="op" id="5175157">]</span><span class="op" id="5175158">*</span><span class="ident" id="5175159">Value</span>&nbsp;<span class="comment" id="5175165">//&nbsp;consts&nbsp;and&nbsp;vars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175185">funcs</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5175193">methodSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175204">methods</span>&nbsp;<span class="ident" id="5175212">methodSet</span><br>
<span class="lineno"></span><span class="op" id="5175222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="5175225">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5175305">//&nbsp;AST&nbsp;reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5175320">//&nbsp;reader&nbsp;accumulates&nbsp;documentation&nbsp;for&nbsp;a&nbsp;single&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="5175378">//&nbsp;It&nbsp;modifies&nbsp;the&nbsp;AST:&nbsp;Comments&nbsp;(declaration&nbsp;documentation)</span><br>
<span class="lineno">140</span><span class="comment" id="5175439">//&nbsp;that&nbsp;have&nbsp;been&nbsp;collected&nbsp;by&nbsp;the&nbsp;reader&nbsp;are&nbsp;set&nbsp;to&nbsp;nil</span><br>
<span class="lineno"></span><span class="comment" id="5175496">//&nbsp;in&nbsp;the&nbsp;respective&nbsp;AST&nbsp;nodes&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;printed</span><br>
<span class="lineno"></span><span class="comment" id="5175556">//&nbsp;twice&nbsp;(once&nbsp;when&nbsp;printing&nbsp;the&nbsp;documentation&nbsp;and&nbsp;once&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="5175617">//&nbsp;printing&nbsp;the&nbsp;corresponding&nbsp;AST&nbsp;node).</span><br>
<span class="lineno"></span><span class="comment" id="5175658">//</span><br>
<span class="lineno">145</span><span class="keyword" id="5175661">type</span>&nbsp;<span class="ident" id="5175666">reader</span>&nbsp;<span class="keyword" id="5175673">struct</span>&nbsp;<span class="op" id="5175680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175683">mode</span>&nbsp;<span class="ident" id="5175688">Mode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5175695">//&nbsp;package&nbsp;properties</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175718">doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5175728">string</span>&nbsp;<span class="comment" id="5175735">//&nbsp;package&nbsp;documentation,&nbsp;if&nbsp;any</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175769">filenames</span>&nbsp;<span class="op" id="5175779">[</span><span class="op" id="5175780">]</span><span class="builtintype" id="5175781">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175789">notes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5175799">map</span><span class="op" id="5175802">[</span><span class="builtintype" id="5175803">string</span><span class="op" id="5175809">]</span><span class="op" id="5175810">[</span><span class="op" id="5175811">]</span><span class="op" id="5175812">*</span><span class="ident" id="5175813">Note</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5175820">//&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175837">imports</span>&nbsp;<span class="keyword" id="5175845">map</span><span class="op" id="5175848">[</span><span class="builtintype" id="5175849">string</span><span class="op" id="5175855">]</span><span class="builtintype" id="5175856">int</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175861">values</span>&nbsp;&nbsp;<span class="op" id="5175869">[</span><span class="op" id="5175870">]</span><span class="op" id="5175871">*</span><span class="ident" id="5175872">Value</span>&nbsp;<span class="comment" id="5175878">//&nbsp;consts&nbsp;and&nbsp;vars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175898">types</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="5175906">map</span><span class="op" id="5175909">[</span><span class="builtintype" id="5175910">string</span><span class="op" id="5175916">]</span><span class="op" id="5175917">*</span><span class="ident" id="5175918">namedType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5175929">funcs</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5175937">methodSet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5175949">//&nbsp;support&nbsp;for&nbsp;package-local&nbsp;error&nbsp;type&nbsp;declarations</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176003">errorDecl</span>&nbsp;<span class="builtintype" id="5176013">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5176034">//&nbsp;if&nbsp;set,&nbsp;type&nbsp;&#34;error&#34;&nbsp;was&nbsp;declared&nbsp;locally</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176080">fixlist</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5176090">[</span><span class="op" id="5176091">]</span><span class="op" id="5176092">*</span><span class="ident" id="5176093">ast</span><span class="op" id="5176096">.</span><span class="ident" id="5176097">InterfaceType</span>&nbsp;<span class="comment" id="5176111">//&nbsp;list&nbsp;of&nbsp;interfaces&nbsp;containing&nbsp;anonymous&nbsp;field&nbsp;&#34;error&#34;</span><br>
<span class="lineno"></span><span class="op" id="5176168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5176171">func</span>&nbsp;<span class="op" id="5176176">(</span><span class="ident" id="5176177">r</span>&nbsp;<span class="op" id="5176179">*</span><span class="ident" id="5176180">reader</span><span class="op" id="5176186">)</span>&nbsp;<span class="ident" id="5176188">isVisible</span><span class="op" id="5176197">(</span><span class="ident" id="5176198">name</span>&nbsp;<span class="builtintype" id="5176203">string</span><span class="op" id="5176209">)</span>&nbsp;<span class="builtintype" id="5176211">bool</span>&nbsp;<span class="op" id="5176216">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176219">return</span>&nbsp;<span class="ident" id="5176226">r</span><span class="op" id="5176227">.</span><span class="ident" id="5176228">mode</span><span class="op" id="5176232">&amp;</span><span class="ident" id="5176233">AllDecls</span>&nbsp;<span class="op" id="5176242">!=</span>&nbsp;<span class="num" id="5176245">0</span>&nbsp;<span class="op" id="5176247">||</span>&nbsp;<span class="ident" id="5176250">ast</span><span class="op" id="5176253">.</span><span class="ident" id="5176254">IsExported</span><span class="op" id="5176264">(</span><span class="ident" id="5176265">name</span><span class="op" id="5176269">)</span><br>
<span class="lineno"></span><span class="op" id="5176271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5176274">//&nbsp;lookupType&nbsp;returns&nbsp;the&nbsp;base&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="5176331">//&nbsp;If&nbsp;the&nbsp;base&nbsp;type&nbsp;has&nbsp;not&nbsp;been&nbsp;encountered&nbsp;yet,&nbsp;a&nbsp;new</span><br>
<span class="lineno">170</span><span class="comment" id="5176387">//&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;but&nbsp;no&nbsp;associated&nbsp;declaration</span><br>
<span class="lineno"></span><span class="comment" id="5176445">//&nbsp;is&nbsp;added&nbsp;to&nbsp;the&nbsp;type&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="5176474">//</span><br>
<span class="lineno"></span><span class="keyword" id="5176477">func</span>&nbsp;<span class="op" id="5176482">(</span><span class="ident" id="5176483">r</span>&nbsp;<span class="op" id="5176485">*</span><span class="ident" id="5176486">reader</span><span class="op" id="5176492">)</span>&nbsp;<span class="ident" id="5176494">lookupType</span><span class="op" id="5176504">(</span><span class="ident" id="5176505">name</span>&nbsp;<span class="builtintype" id="5176510">string</span><span class="op" id="5176516">)</span>&nbsp;<span class="op" id="5176518">*</span><span class="ident" id="5176519">namedType</span>&nbsp;<span class="op" id="5176529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176532">if</span>&nbsp;<span class="ident" id="5176535">name</span>&nbsp;<span class="op" id="5176540">==</span>&nbsp;<span class="string" id="5176543">&#34;&#34;</span>&nbsp;<span class="op" id="5176546">||</span>&nbsp;<span class="ident" id="5176549">name</span>&nbsp;<span class="op" id="5176554">==</span>&nbsp;<span class="string" id="5176557">&#34;_&#34;</span>&nbsp;<span class="op" id="5176561">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176565">return</span>&nbsp;<span class="ident" id="5176572">nil</span>&nbsp;<span class="comment" id="5176576">//&nbsp;no&nbsp;type&nbsp;docs&nbsp;for&nbsp;anonymous&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176616">if</span>&nbsp;<span class="ident" id="5176619">typ</span><span class="op" id="5176622">,</span>&nbsp;<span class="ident" id="5176624">found</span>&nbsp;<span class="op" id="5176630">:=</span>&nbsp;<span class="ident" id="5176633">r</span><span class="op" id="5176634">.</span><span class="ident" id="5176635">types</span><span class="op" id="5176640">[</span><span class="ident" id="5176641">name</span><span class="op" id="5176645">]</span><span class="op" id="5176646">;</span>&nbsp;<span class="ident" id="5176648">found</span>&nbsp;<span class="op" id="5176654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176658">return</span>&nbsp;<span class="ident" id="5176665">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176670">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5176673">//&nbsp;type&nbsp;not&nbsp;found&nbsp;-&nbsp;add&nbsp;one&nbsp;without&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176722">typ</span>&nbsp;<span class="op" id="5176726">:=</span>&nbsp;<span class="op" id="5176729">&amp;</span><span class="ident" id="5176730">namedType</span><span class="op" id="5176739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176743">name</span><span class="op" id="5176747">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5176753">name</span><span class="op" id="5176757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176761">embedded</span><span class="op" id="5176769">:</span>&nbsp;<span class="builtinfunc" id="5176771">make</span><span class="op" id="5176775">(</span><span class="ident" id="5176776">embeddedSet</span><span class="op" id="5176787">)</span><span class="op" id="5176788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176792">funcs</span><span class="op" id="5176797">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5176802">make</span><span class="op" id="5176806">(</span><span class="ident" id="5176807">methodSet</span><span class="op" id="5176816">)</span><span class="op" id="5176817">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176821">methods</span><span class="op" id="5176828">:</span>&nbsp;&nbsp;<span class="builtinfunc" id="5176831">make</span><span class="op" id="5176835">(</span><span class="ident" id="5176836">methodSet</span><span class="op" id="5176845">)</span><span class="op" id="5176846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5176849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5176852">r</span><span class="op" id="5176853">.</span><span class="ident" id="5176854">types</span><span class="op" id="5176859">[</span><span class="ident" id="5176860">name</span><span class="op" id="5176864">]</span>&nbsp;<span class="op" id="5176866">=</span>&nbsp;<span class="ident" id="5176868">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5176873">return</span>&nbsp;<span class="ident" id="5176880">typ</span><br>
<span class="lineno"></span><span class="op" id="5176884">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5176887">//&nbsp;recordAnonymousField&nbsp;registers&nbsp;fieldType&nbsp;as&nbsp;the&nbsp;type&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5176949">//&nbsp;anonymous&nbsp;field&nbsp;in&nbsp;the&nbsp;parent&nbsp;type.&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="5177013">//&nbsp;(qualified&nbsp;name)&nbsp;or&nbsp;the&nbsp;parent&nbsp;is&nbsp;nil,&nbsp;the&nbsp;field&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="5177077">//&nbsp;The&nbsp;function&nbsp;returns&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">195</span><span class="comment" id="5177117">//</span><br>
<span class="lineno"></span><span class="keyword" id="5177120">func</span>&nbsp;<span class="op" id="5177125">(</span><span class="ident" id="5177126">r</span>&nbsp;<span class="op" id="5177128">*</span><span class="ident" id="5177129">reader</span><span class="op" id="5177135">)</span>&nbsp;<span class="ident" id="5177137">recordAnonymousField</span><span class="op" id="5177157">(</span><span class="ident" id="5177158">parent</span>&nbsp;<span class="op" id="5177165">*</span><span class="ident" id="5177166">namedType</span><span class="op" id="5177175">,</span>&nbsp;<span class="ident" id="5177177">fieldType</span>&nbsp;<span class="ident" id="5177187">ast</span><span class="op" id="5177190">.</span><span class="ident" id="5177191">Expr</span><span class="op" id="5177195">)</span>&nbsp;<span class="op" id="5177197">(</span><span class="ident" id="5177198">fname</span>&nbsp;<span class="builtintype" id="5177204">string</span><span class="op" id="5177210">)</span>&nbsp;<span class="op" id="5177212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177215">fname</span><span class="op" id="5177220">,</span>&nbsp;<span class="ident" id="5177222">imp</span>&nbsp;<span class="op" id="5177226">:=</span>&nbsp;<span class="ident" id="5177229">baseTypeName</span><span class="op" id="5177241">(</span><span class="ident" id="5177242">fieldType</span><span class="op" id="5177251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177254">if</span>&nbsp;<span class="ident" id="5177257">parent</span>&nbsp;<span class="op" id="5177264">==</span>&nbsp;<span class="ident" id="5177267">nil</span>&nbsp;<span class="op" id="5177271">||</span>&nbsp;<span class="ident" id="5177274">imp</span>&nbsp;<span class="op" id="5177278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177282">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177293">if</span>&nbsp;<span class="ident" id="5177296">ftype</span>&nbsp;<span class="op" id="5177302">:=</span>&nbsp;<span class="ident" id="5177305">r</span><span class="op" id="5177306">.</span><span class="ident" id="5177307">lookupType</span><span class="op" id="5177317">(</span><span class="ident" id="5177318">fname</span><span class="op" id="5177323">)</span><span class="op" id="5177324">;</span>&nbsp;<span class="ident" id="5177326">ftype</span>&nbsp;<span class="op" id="5177332">!=</span>&nbsp;<span class="ident" id="5177335">nil</span>&nbsp;<span class="op" id="5177339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177343">ftype</span><span class="op" id="5177348">.</span><span class="ident" id="5177349">isEmbedded</span>&nbsp;<span class="op" id="5177360">=</span>&nbsp;<span class="builtintype" id="5177362">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177369">_</span><span class="op" id="5177370">,</span>&nbsp;<span class="ident" id="5177372">ptr</span>&nbsp;<span class="op" id="5177376">:=</span>&nbsp;<span class="ident" id="5177379">fieldType</span><span class="op" id="5177388">.</span><span class="op" id="5177389">(</span><span class="op" id="5177390">*</span><span class="ident" id="5177391">ast</span><span class="op" id="5177394">.</span><span class="ident" id="5177395">StarExpr</span><span class="op" id="5177403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177407">parent</span><span class="op" id="5177413">.</span><span class="ident" id="5177414">embedded</span><span class="op" id="5177422">[</span><span class="ident" id="5177423">ftype</span><span class="op" id="5177428">]</span>&nbsp;<span class="op" id="5177430">=</span>&nbsp;<span class="ident" id="5177432">ptr</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177440">return</span><br>
<span class="lineno"></span><span class="op" id="5177447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5177450">func</span>&nbsp;<span class="op" id="5177455">(</span><span class="ident" id="5177456">r</span>&nbsp;<span class="op" id="5177458">*</span><span class="ident" id="5177459">reader</span><span class="op" id="5177465">)</span>&nbsp;<span class="ident" id="5177467">readDoc</span><span class="op" id="5177474">(</span><span class="ident" id="5177475">comment</span>&nbsp;<span class="op" id="5177483">*</span><span class="ident" id="5177484">ast</span><span class="op" id="5177487">.</span><span class="ident" id="5177488">CommentGroup</span><span class="op" id="5177500">)</span>&nbsp;<span class="op" id="5177502">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177505">//&nbsp;By&nbsp;convention&nbsp;there&nbsp;should&nbsp;be&nbsp;only&nbsp;one&nbsp;package&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177564">//&nbsp;but&nbsp;collect&nbsp;all&nbsp;of&nbsp;them&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;then&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177620">text</span>&nbsp;<span class="op" id="5177625">:=</span>&nbsp;<span class="ident" id="5177628">comment</span><span class="op" id="5177635">.</span><span class="ident" id="5177636">Text</span><span class="op" id="5177640">(</span><span class="op" id="5177641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177644">if</span>&nbsp;<span class="ident" id="5177647">r</span><span class="op" id="5177648">.</span><span class="ident" id="5177649">doc</span>&nbsp;<span class="op" id="5177653">==</span>&nbsp;<span class="string" id="5177656">&#34;&#34;</span>&nbsp;<span class="op" id="5177659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177663">r</span><span class="op" id="5177664">.</span><span class="ident" id="5177665">doc</span>&nbsp;<span class="op" id="5177669">=</span>&nbsp;<span class="ident" id="5177671">text</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177678">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5177686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177689">r</span><span class="op" id="5177690">.</span><span class="ident" id="5177691">doc</span>&nbsp;<span class="op" id="5177695">+=</span>&nbsp;<span class="string" id="5177698">&#34;\n&#34;</span>&nbsp;<span class="op" id="5177703">+</span>&nbsp;<span class="ident" id="5177705">text</span><br>
<span class="lineno"></span><span class="op" id="5177710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="5177713">func</span>&nbsp;<span class="op" id="5177718">(</span><span class="ident" id="5177719">r</span>&nbsp;<span class="op" id="5177721">*</span><span class="ident" id="5177722">reader</span><span class="op" id="5177728">)</span>&nbsp;<span class="ident" id="5177730">remember</span><span class="op" id="5177738">(</span><span class="ident" id="5177739">typ</span>&nbsp;<span class="op" id="5177743">*</span><span class="ident" id="5177744">ast</span><span class="op" id="5177747">.</span><span class="ident" id="5177748">InterfaceType</span><span class="op" id="5177761">)</span>&nbsp;<span class="op" id="5177763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177766">r</span><span class="op" id="5177767">.</span><span class="ident" id="5177768">fixlist</span>&nbsp;<span class="op" id="5177776">=</span>&nbsp;<span class="builtinfunc" id="5177778">append</span><span class="op" id="5177784">(</span><span class="ident" id="5177785">r</span><span class="op" id="5177786">.</span><span class="ident" id="5177787">fixlist</span><span class="op" id="5177794">,</span>&nbsp;<span class="ident" id="5177796">typ</span><span class="op" id="5177799">)</span><br>
<span class="lineno"></span><span class="op" id="5177801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5177804">func</span>&nbsp;<span class="ident" id="5177809">specNames</span><span class="op" id="5177818">(</span><span class="ident" id="5177819">specs</span>&nbsp;<span class="op" id="5177825">[</span><span class="op" id="5177826">]</span><span class="ident" id="5177827">ast</span><span class="op" id="5177830">.</span><span class="ident" id="5177831">Spec</span><span class="op" id="5177835">)</span>&nbsp;<span class="op" id="5177837">[</span><span class="op" id="5177838">]</span><span class="builtintype" id="5177839">string</span>&nbsp;<span class="op" id="5177846">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5177849">names</span>&nbsp;<span class="op" id="5177855">:=</span>&nbsp;<span class="builtinfunc" id="5177858">make</span><span class="op" id="5177862">(</span><span class="op" id="5177863">[</span><span class="op" id="5177864">]</span><span class="builtintype" id="5177865">string</span><span class="op" id="5177871">,</span>&nbsp;<span class="num" id="5177873">0</span><span class="op" id="5177874">,</span>&nbsp;<span class="builtinfunc" id="5177876">len</span><span class="op" id="5177879">(</span><span class="ident" id="5177880">specs</span><span class="op" id="5177885">)</span><span class="op" id="5177886">)</span>&nbsp;<span class="comment" id="5177888">//&nbsp;reasonable&nbsp;estimate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177912">for</span>&nbsp;<span class="ident" id="5177916">_</span><span class="op" id="5177917">,</span>&nbsp;<span class="ident" id="5177919">s</span>&nbsp;<span class="op" id="5177921">:=</span>&nbsp;<span class="keyword" id="5177924">range</span>&nbsp;<span class="ident" id="5177930">specs</span>&nbsp;<span class="op" id="5177936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5177940">//&nbsp;s&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;an&nbsp;*ast.ValueSpec&nbsp;by&nbsp;readValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5177995">for</span>&nbsp;<span class="ident" id="5177999">_</span><span class="op" id="5178000">,</span>&nbsp;<span class="ident" id="5178002">ident</span>&nbsp;<span class="op" id="5178008">:=</span>&nbsp;<span class="keyword" id="5178011">range</span>&nbsp;<span class="ident" id="5178017">s</span><span class="op" id="5178018">.</span><span class="op" id="5178019">(</span><span class="op" id="5178020">*</span><span class="ident" id="5178021">ast</span><span class="op" id="5178024">.</span><span class="ident" id="5178025">ValueSpec</span><span class="op" id="5178034">)</span><span class="op" id="5178035">.</span><span class="ident" id="5178036">Names</span>&nbsp;<span class="op" id="5178042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178047">names</span>&nbsp;<span class="op" id="5178053">=</span>&nbsp;<span class="builtinfunc" id="5178055">append</span><span class="op" id="5178061">(</span><span class="ident" id="5178062">names</span><span class="op" id="5178067">,</span>&nbsp;<span class="ident" id="5178069">ident</span><span class="op" id="5178074">.</span><span class="ident" id="5178075">Name</span><span class="op" id="5178079">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178089">return</span>&nbsp;<span class="ident" id="5178096">names</span><br>
<span class="lineno"></span><span class="op" id="5178102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="5178105">//&nbsp;readValue&nbsp;processes&nbsp;a&nbsp;const&nbsp;or&nbsp;var&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="5178156">//</span><br>
<span class="lineno"></span><span class="keyword" id="5178159">func</span>&nbsp;<span class="op" id="5178164">(</span><span class="ident" id="5178165">r</span>&nbsp;<span class="op" id="5178167">*</span><span class="ident" id="5178168">reader</span><span class="op" id="5178174">)</span>&nbsp;<span class="ident" id="5178176">readValue</span><span class="op" id="5178185">(</span><span class="ident" id="5178186">decl</span>&nbsp;<span class="op" id="5178191">*</span><span class="ident" id="5178192">ast</span><span class="op" id="5178195">.</span><span class="ident" id="5178196">GenDecl</span><span class="op" id="5178203">)</span>&nbsp;<span class="op" id="5178205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178208">//&nbsp;determine&nbsp;if&nbsp;decl&nbsp;should&nbsp;be&nbsp;associated&nbsp;with&nbsp;a&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178263">//&nbsp;Heuristic:&nbsp;For&nbsp;each&nbsp;typed&nbsp;entry,&nbsp;determine&nbsp;the&nbsp;type&nbsp;name,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178333">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;there&nbsp;is&nbsp;exactly&nbsp;one&nbsp;type&nbsp;name&nbsp;that&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178403">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frequent,&nbsp;associate&nbsp;the&nbsp;decl&nbsp;with&nbsp;the&nbsp;respective&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178473">domName</span>&nbsp;<span class="op" id="5178481">:=</span>&nbsp;<span class="string" id="5178484">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178488">domFreq</span>&nbsp;<span class="op" id="5178496">:=</span>&nbsp;<span class="num" id="5178499">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178502">prev</span>&nbsp;<span class="op" id="5178507">:=</span>&nbsp;<span class="string" id="5178510">&#34;&#34;</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178514">n</span>&nbsp;<span class="op" id="5178516">:=</span>&nbsp;<span class="num" id="5178519">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178522">for</span>&nbsp;<span class="ident" id="5178526">_</span><span class="op" id="5178527">,</span>&nbsp;<span class="ident" id="5178529">spec</span>&nbsp;<span class="op" id="5178534">:=</span>&nbsp;<span class="keyword" id="5178537">range</span>&nbsp;<span class="ident" id="5178543">decl</span><span class="op" id="5178547">.</span><span class="ident" id="5178548">Specs</span>&nbsp;<span class="op" id="5178554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178558">s</span><span class="op" id="5178559">,</span>&nbsp;<span class="ident" id="5178561">ok</span>&nbsp;<span class="op" id="5178564">:=</span>&nbsp;<span class="ident" id="5178567">spec</span><span class="op" id="5178571">.</span><span class="op" id="5178572">(</span><span class="op" id="5178573">*</span><span class="ident" id="5178574">ast</span><span class="op" id="5178577">.</span><span class="ident" id="5178578">ValueSpec</span><span class="op" id="5178587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178591">if</span>&nbsp;<span class="op" id="5178594">!</span><span class="ident" id="5178595">ok</span>&nbsp;<span class="op" id="5178598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178603">continue</span>&nbsp;<span class="comment" id="5178612">//&nbsp;should&nbsp;not&nbsp;happen,&nbsp;but&nbsp;be&nbsp;conservative</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178660">name</span>&nbsp;<span class="op" id="5178665">:=</span>&nbsp;<span class="string" id="5178668">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178673">switch</span>&nbsp;<span class="op" id="5178680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178684">case</span>&nbsp;<span class="ident" id="5178689">s</span><span class="op" id="5178690">.</span><span class="ident" id="5178691">Type</span>&nbsp;<span class="op" id="5178696">!=</span>&nbsp;<span class="ident" id="5178699">nil</span><span class="op" id="5178702">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178707">//&nbsp;a&nbsp;type&nbsp;is&nbsp;present;&nbsp;determine&nbsp;its&nbsp;name</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178751">if</span>&nbsp;<span class="ident" id="5178754">n</span><span class="op" id="5178755">,</span>&nbsp;<span class="ident" id="5178757">imp</span>&nbsp;<span class="op" id="5178761">:=</span>&nbsp;<span class="ident" id="5178764">baseTypeName</span><span class="op" id="5178776">(</span><span class="ident" id="5178777">s</span><span class="op" id="5178778">.</span><span class="ident" id="5178779">Type</span><span class="op" id="5178783">)</span><span class="op" id="5178784">;</span>&nbsp;<span class="op" id="5178786">!</span><span class="ident" id="5178787">imp</span>&nbsp;<span class="op" id="5178791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5178797">name</span>&nbsp;<span class="op" id="5178802">=</span>&nbsp;<span class="ident" id="5178804">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5178809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5178813">case</span>&nbsp;<span class="ident" id="5178818">decl</span><span class="op" id="5178822">.</span><span class="ident" id="5178823">Tok</span>&nbsp;<span class="op" id="5178827">==</span>&nbsp;<span class="ident" id="5178830">token</span><span class="op" id="5178835">.</span><span class="ident" id="5178836">CONST</span><span class="op" id="5178841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178846">//&nbsp;no&nbsp;type&nbsp;is&nbsp;present&nbsp;but&nbsp;we&nbsp;have&nbsp;a&nbsp;constant&nbsp;declaration;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178907">//&nbsp;use&nbsp;the&nbsp;previous&nbsp;type&nbsp;name&nbsp;(w/o&nbsp;more&nbsp;type&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5178967">//&nbsp;we&nbsp;cannot&nbsp;handle&nbsp;the&nbsp;case&nbsp;of&nbsp;unnamed&nbsp;variables&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179025">//&nbsp;initializer&nbsp;expressions&nbsp;except&nbsp;for&nbsp;some&nbsp;trivial&nbsp;cases)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179086">name</span>&nbsp;<span class="op" id="5179091">=</span>&nbsp;<span class="ident" id="5179093">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179100">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179104">if</span>&nbsp;<span class="ident" id="5179107">name</span>&nbsp;<span class="op" id="5179112">!=</span>&nbsp;<span class="string" id="5179115">&#34;&#34;</span>&nbsp;<span class="op" id="5179118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179123">//&nbsp;entry&nbsp;has&nbsp;a&nbsp;named&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179152">if</span>&nbsp;<span class="ident" id="5179155">domName</span>&nbsp;<span class="op" id="5179163">!=</span>&nbsp;<span class="string" id="5179166">&#34;&#34;</span>&nbsp;<span class="op" id="5179169">&amp;&amp;</span>&nbsp;<span class="ident" id="5179172">domName</span>&nbsp;<span class="op" id="5179180">!=</span>&nbsp;<span class="ident" id="5179183">name</span>&nbsp;<span class="op" id="5179188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179194">//&nbsp;more&nbsp;than&nbsp;one&nbsp;type&nbsp;name&nbsp;-&nbsp;do&nbsp;not&nbsp;associate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179244">//&nbsp;with&nbsp;any&nbsp;type</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179265">domName</span>&nbsp;<span class="op" id="5179273">=</span>&nbsp;<span class="string" id="5179275">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179282">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179296">domName</span>&nbsp;<span class="op" id="5179304">=</span>&nbsp;<span class="ident" id="5179306">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179314">domFreq</span><span class="op" id="5179321">++</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179330">prev</span>&nbsp;<span class="op" id="5179335">=</span>&nbsp;<span class="ident" id="5179337">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179344">n</span><span class="op" id="5179345">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179353">//&nbsp;nothing&nbsp;to&nbsp;do&nbsp;w/o&nbsp;a&nbsp;legal&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179395">if</span>&nbsp;<span class="ident" id="5179398">n</span>&nbsp;<span class="op" id="5179400">==</span>&nbsp;<span class="num" id="5179403">0</span>&nbsp;<span class="op" id="5179405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179409">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179421">//&nbsp;determine&nbsp;values&nbsp;list&nbsp;with&nbsp;which&nbsp;to&nbsp;associate&nbsp;the&nbsp;Value&nbsp;for&nbsp;this&nbsp;decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179495">values</span>&nbsp;<span class="op" id="5179502">:=</span>&nbsp;<span class="op" id="5179505">&amp;</span><span class="ident" id="5179506">r</span><span class="op" id="5179507">.</span><span class="ident" id="5179508">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179516">const</span>&nbsp;<span class="ident" id="5179522">threshold</span>&nbsp;<span class="op" id="5179532">=</span>&nbsp;<span class="num" id="5179534">0.75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179540">if</span>&nbsp;<span class="ident" id="5179543">domName</span>&nbsp;<span class="op" id="5179551">!=</span>&nbsp;<span class="string" id="5179554">&#34;&#34;</span>&nbsp;<span class="op" id="5179557">&amp;&amp;</span>&nbsp;<span class="ident" id="5179560">r</span><span class="op" id="5179561">.</span><span class="ident" id="5179562">isVisible</span><span class="op" id="5179571">(</span><span class="ident" id="5179572">domName</span><span class="op" id="5179579">)</span>&nbsp;<span class="op" id="5179581">&amp;&amp;</span>&nbsp;<span class="ident" id="5179584">domFreq</span>&nbsp;<span class="op" id="5179592">&gt;=</span>&nbsp;<span class="builtintype" id="5179595">int</span><span class="op" id="5179598">(</span><span class="builtintype" id="5179599">float64</span><span class="op" id="5179606">(</span><span class="builtinfunc" id="5179607">len</span><span class="op" id="5179610">(</span><span class="ident" id="5179611">decl</span><span class="op" id="5179615">.</span><span class="ident" id="5179616">Specs</span><span class="op" id="5179621">)</span><span class="op" id="5179622">)</span><span class="op" id="5179623">*</span><span class="ident" id="5179624">threshold</span><span class="op" id="5179633">)</span>&nbsp;<span class="op" id="5179635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5179639">//&nbsp;typed&nbsp;entries&nbsp;are&nbsp;sufficiently&nbsp;frequent</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5179684">if</span>&nbsp;<span class="ident" id="5179687">typ</span>&nbsp;<span class="op" id="5179691">:=</span>&nbsp;<span class="ident" id="5179694">r</span><span class="op" id="5179695">.</span><span class="ident" id="5179696">lookupType</span><span class="op" id="5179706">(</span><span class="ident" id="5179707">domName</span><span class="op" id="5179714">)</span><span class="op" id="5179715">;</span>&nbsp;<span class="ident" id="5179717">typ</span>&nbsp;<span class="op" id="5179721">!=</span>&nbsp;<span class="ident" id="5179724">nil</span>&nbsp;<span class="op" id="5179728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179733">values</span>&nbsp;<span class="op" id="5179740">=</span>&nbsp;<span class="op" id="5179742">&amp;</span><span class="ident" id="5179743">typ</span><span class="op" id="5179746">.</span><span class="ident" id="5179747">values</span>&nbsp;<span class="comment" id="5179754">//&nbsp;associate&nbsp;with&nbsp;that&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179791">*</span><span class="ident" id="5179792">values</span>&nbsp;<span class="op" id="5179799">=</span>&nbsp;<span class="builtinfunc" id="5179801">append</span><span class="op" id="5179807">(</span><span class="op" id="5179808">*</span><span class="ident" id="5179809">values</span><span class="op" id="5179815">,</span>&nbsp;<span class="op" id="5179817">&amp;</span><span class="ident" id="5179818">Value</span><span class="op" id="5179823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179827">Doc</span><span class="op" id="5179830">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5179834">decl</span><span class="op" id="5179838">.</span><span class="ident" id="5179839">Doc</span><span class="op" id="5179842">.</span><span class="ident" id="5179843">Text</span><span class="op" id="5179847">(</span><span class="op" id="5179848">)</span><span class="op" id="5179849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179853">Names</span><span class="op" id="5179858">:</span>&nbsp;<span class="ident" id="5179860">specNames</span><span class="op" id="5179869">(</span><span class="ident" id="5179870">decl</span><span class="op" id="5179874">.</span><span class="ident" id="5179875">Specs</span><span class="op" id="5179880">)</span><span class="op" id="5179881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179885">Decl</span><span class="op" id="5179889">:</span>&nbsp;&nbsp;<span class="ident" id="5179892">decl</span><span class="op" id="5179896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179900">order</span><span class="op" id="5179905">:</span>&nbsp;<span class="builtinfunc" id="5179907">len</span><span class="op" id="5179910">(</span><span class="op" id="5179911">*</span><span class="ident" id="5179912">values</span><span class="op" id="5179918">)</span><span class="op" id="5179919">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5179922">}</span><span class="op" id="5179923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5179926">decl</span><span class="op" id="5179930">.</span><span class="ident" id="5179931">Doc</span>&nbsp;<span class="op" id="5179935">=</span>&nbsp;<span class="ident" id="5179937">nil</span>&nbsp;<span class="comment" id="5179941">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span><span class="op" id="5179975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5179978">//&nbsp;fields&nbsp;returns&nbsp;a&nbsp;struct&#39;s&nbsp;fields&nbsp;or&nbsp;an&nbsp;interface&#39;s&nbsp;methods.</span><br>
<span class="lineno">305</span><span class="comment" id="5180041">//</span><br>
<span class="lineno"></span><span class="keyword" id="5180044">func</span>&nbsp;<span class="ident" id="5180049">fields</span><span class="op" id="5180055">(</span><span class="ident" id="5180056">typ</span>&nbsp;<span class="ident" id="5180060">ast</span><span class="op" id="5180063">.</span><span class="ident" id="5180064">Expr</span><span class="op" id="5180068">)</span>&nbsp;<span class="op" id="5180070">(</span><span class="ident" id="5180071">list</span>&nbsp;<span class="op" id="5180076">[</span><span class="op" id="5180077">]</span><span class="op" id="5180078">*</span><span class="ident" id="5180079">ast</span><span class="op" id="5180082">.</span><span class="ident" id="5180083">Field</span><span class="op" id="5180088">,</span>&nbsp;<span class="ident" id="5180090">isStruct</span>&nbsp;<span class="builtintype" id="5180099">bool</span><span class="op" id="5180103">)</span>&nbsp;<span class="op" id="5180105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180108">var</span>&nbsp;<span class="ident" id="5180112">fields</span>&nbsp;<span class="op" id="5180119">*</span><span class="ident" id="5180120">ast</span><span class="op" id="5180123">.</span><span class="ident" id="5180124">FieldList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180135">switch</span>&nbsp;<span class="ident" id="5180142">t</span>&nbsp;<span class="op" id="5180144">:=</span>&nbsp;<span class="ident" id="5180147">typ</span><span class="op" id="5180150">.</span><span class="op" id="5180151">(</span><span class="keyword" id="5180152">type</span><span class="op" id="5180156">)</span>&nbsp;<span class="op" id="5180158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180161">case</span>&nbsp;<span class="op" id="5180166">*</span><span class="ident" id="5180167">ast</span><span class="op" id="5180170">.</span><span class="ident" id="5180171">StructType</span><span class="op" id="5180181">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180185">fields</span>&nbsp;<span class="op" id="5180192">=</span>&nbsp;<span class="ident" id="5180194">t</span><span class="op" id="5180195">.</span><span class="ident" id="5180196">Fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180205">isStruct</span>&nbsp;<span class="op" id="5180214">=</span>&nbsp;<span class="builtintype" id="5180216">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180222">case</span>&nbsp;<span class="op" id="5180227">*</span><span class="ident" id="5180228">ast</span><span class="op" id="5180231">.</span><span class="ident" id="5180232">InterfaceType</span><span class="op" id="5180245">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180249">fields</span>&nbsp;<span class="op" id="5180256">=</span>&nbsp;<span class="ident" id="5180258">t</span><span class="op" id="5180259">.</span><span class="ident" id="5180260">Methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5180269">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180272">if</span>&nbsp;<span class="ident" id="5180275">fields</span>&nbsp;<span class="op" id="5180282">!=</span>&nbsp;<span class="ident" id="5180285">nil</span>&nbsp;<span class="op" id="5180289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180293">list</span>&nbsp;<span class="op" id="5180298">=</span>&nbsp;<span class="ident" id="5180300">fields</span><span class="op" id="5180306">.</span><span class="ident" id="5180307">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5180313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180316">return</span><br>
<span class="lineno"></span><span class="op" id="5180323">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5180326">//&nbsp;readType&nbsp;processes&nbsp;a&nbsp;type&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="5180368">//</span><br>
<span class="lineno"></span><span class="keyword" id="5180371">func</span>&nbsp;<span class="op" id="5180376">(</span><span class="ident" id="5180377">r</span>&nbsp;<span class="op" id="5180379">*</span><span class="ident" id="5180380">reader</span><span class="op" id="5180386">)</span>&nbsp;<span class="ident" id="5180388">readType</span><span class="op" id="5180396">(</span><span class="ident" id="5180397">decl</span>&nbsp;<span class="op" id="5180402">*</span><span class="ident" id="5180403">ast</span><span class="op" id="5180406">.</span><span class="ident" id="5180407">GenDecl</span><span class="op" id="5180414">,</span>&nbsp;<span class="ident" id="5180416">spec</span>&nbsp;<span class="op" id="5180421">*</span><span class="ident" id="5180422">ast</span><span class="op" id="5180425">.</span><span class="ident" id="5180426">TypeSpec</span><span class="op" id="5180434">)</span>&nbsp;<span class="op" id="5180436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180439">typ</span>&nbsp;<span class="op" id="5180443">:=</span>&nbsp;<span class="ident" id="5180446">r</span><span class="op" id="5180447">.</span><span class="ident" id="5180448">lookupType</span><span class="op" id="5180458">(</span><span class="ident" id="5180459">spec</span><span class="op" id="5180463">.</span><span class="ident" id="5180464">Name</span><span class="op" id="5180468">.</span><span class="ident" id="5180469">Name</span><span class="op" id="5180473">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180476">if</span>&nbsp;<span class="ident" id="5180479">typ</span>&nbsp;<span class="op" id="5180483">==</span>&nbsp;<span class="ident" id="5180486">nil</span>&nbsp;<span class="op" id="5180490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180494">return</span>&nbsp;<span class="comment" id="5180501">//&nbsp;no&nbsp;name&nbsp;or&nbsp;blank&nbsp;name&nbsp;-&nbsp;ignore&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5180545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180549">//&nbsp;A&nbsp;type&nbsp;should&nbsp;be&nbsp;added&nbsp;at&nbsp;most&nbsp;once,&nbsp;so&nbsp;typ.decl</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180602">//&nbsp;should&nbsp;be&nbsp;nil&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;not,&nbsp;simply&nbsp;overwrite&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180657">typ</span><span class="op" id="5180660">.</span><span class="ident" id="5180661">decl</span>&nbsp;<span class="op" id="5180666">=</span>&nbsp;<span class="ident" id="5180668">decl</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180675">//&nbsp;compute&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180701">doc</span>&nbsp;<span class="op" id="5180705">:=</span>&nbsp;<span class="ident" id="5180708">spec</span><span class="op" id="5180712">.</span><span class="ident" id="5180713">Doc</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180718">spec</span><span class="op" id="5180722">.</span><span class="ident" id="5180723">Doc</span>&nbsp;<span class="op" id="5180727">=</span>&nbsp;<span class="ident" id="5180729">nil</span>&nbsp;<span class="comment" id="5180733">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5180768">if</span>&nbsp;<span class="ident" id="5180771">doc</span>&nbsp;<span class="op" id="5180775">==</span>&nbsp;<span class="ident" id="5180778">nil</span>&nbsp;<span class="op" id="5180782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180786">//&nbsp;no&nbsp;doc&nbsp;associated&nbsp;with&nbsp;the&nbsp;spec,&nbsp;use&nbsp;the&nbsp;declaration&nbsp;doc,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180856">doc</span>&nbsp;<span class="op" id="5180860">=</span>&nbsp;<span class="ident" id="5180862">decl</span><span class="op" id="5180866">.</span><span class="ident" id="5180867">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5180872">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180875">decl</span><span class="op" id="5180879">.</span><span class="ident" id="5180880">Doc</span>&nbsp;<span class="op" id="5180884">=</span>&nbsp;<span class="ident" id="5180886">nil</span>&nbsp;<span class="comment" id="5180890">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5180925">typ</span><span class="op" id="5180928">.</span><span class="ident" id="5180929">doc</span>&nbsp;<span class="op" id="5180933">=</span>&nbsp;<span class="ident" id="5180935">doc</span><span class="op" id="5180938">.</span><span class="ident" id="5180939">Text</span><span class="op" id="5180943">(</span><span class="op" id="5180944">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5180948">//&nbsp;record&nbsp;anonymous&nbsp;fields&nbsp;(they&nbsp;may&nbsp;contribute&nbsp;methods)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181006">//&nbsp;(some&nbsp;fields&nbsp;may&nbsp;have&nbsp;been&nbsp;recorded&nbsp;already&nbsp;when&nbsp;filtering</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181069">//&nbsp;exports,&nbsp;but&nbsp;that&#39;s&nbsp;ok)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5181097">var</span>&nbsp;<span class="ident" id="5181101">list</span>&nbsp;<span class="op" id="5181106">[</span><span class="op" id="5181107">]</span><span class="op" id="5181108">*</span><span class="ident" id="5181109">ast</span><span class="op" id="5181112">.</span><span class="ident" id="5181113">Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5181120">list</span><span class="op" id="5181124">,</span>&nbsp;<span class="ident" id="5181126">typ</span><span class="op" id="5181129">.</span><span class="ident" id="5181130">isStruct</span>&nbsp;<span class="op" id="5181139">=</span>&nbsp;<span class="ident" id="5181141">fields</span><span class="op" id="5181147">(</span><span class="ident" id="5181148">spec</span><span class="op" id="5181152">.</span><span class="ident" id="5181153">Type</span><span class="op" id="5181157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5181160">for</span>&nbsp;<span class="ident" id="5181164">_</span><span class="op" id="5181165">,</span>&nbsp;<span class="ident" id="5181167">field</span>&nbsp;<span class="op" id="5181173">:=</span>&nbsp;<span class="keyword" id="5181176">range</span>&nbsp;<span class="ident" id="5181182">list</span>&nbsp;<span class="op" id="5181187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5181191">if</span>&nbsp;<span class="builtinfunc" id="5181194">len</span><span class="op" id="5181197">(</span><span class="ident" id="5181198">field</span><span class="op" id="5181203">.</span><span class="ident" id="5181204">Names</span><span class="op" id="5181209">)</span>&nbsp;<span class="op" id="5181211">==</span>&nbsp;<span class="num" id="5181214">0</span>&nbsp;<span class="op" id="5181216">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5181221">r</span><span class="op" id="5181222">.</span><span class="ident" id="5181223">recordAnonymousField</span><span class="op" id="5181243">(</span><span class="ident" id="5181244">typ</span><span class="op" id="5181247">,</span>&nbsp;<span class="ident" id="5181249">field</span><span class="op" id="5181254">.</span><span class="ident" id="5181255">Type</span><span class="op" id="5181259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5181263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5181266">}</span><br>
<span class="lineno"></span><span class="op" id="5181268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="5181271">//&nbsp;readFunc&nbsp;processes&nbsp;a&nbsp;func&nbsp;or&nbsp;method&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="5181323">//</span><br>
<span class="lineno"></span><span class="keyword" id="5181326">func</span>&nbsp;<span class="op" id="5181331">(</span><span class="ident" id="5181332">r</span>&nbsp;<span class="op" id="5181334">*</span><span class="ident" id="5181335">reader</span><span class="op" id="5181341">)</span>&nbsp;<span class="ident" id="5181343">readFunc</span><span class="op" id="5181351">(</span><span class="ident" id="5181352">fun</span>&nbsp;<span class="op" id="5181356">*</span><span class="ident" id="5181357">ast</span><span class="op" id="5181360">.</span><span class="ident" id="5181361">FuncDecl</span><span class="op" id="5181369">)</span>&nbsp;<span class="op" id="5181371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181374">//&nbsp;strip&nbsp;function&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5181398">fun</span><span class="op" id="5181401">.</span><span class="ident" id="5181402">Body</span>&nbsp;<span class="op" id="5181407">=</span>&nbsp;<span class="ident" id="5181409">nil</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181415">//&nbsp;associate&nbsp;methods&nbsp;with&nbsp;the&nbsp;receiver&nbsp;type,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5181468">if</span>&nbsp;<span class="ident" id="5181471">fun</span><span class="op" id="5181474">.</span><span class="ident" id="5181475">Recv</span>&nbsp;<span class="op" id="5181480">!=</span>&nbsp;<span class="ident" id="5181483">nil</span>&nbsp;<span class="op" id="5181487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181491">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5181503">recvTypeName</span><span class="op" id="5181515">,</span>&nbsp;<span class="ident" id="5181517">imp</span>&nbsp;<span class="op" id="5181521">:=</span>&nbsp;<span class="ident" id="5181524">baseTypeName</span><span class="op" id="5181536">(</span><span class="ident" id="5181537">fun</span><span class="op" id="5181540">.</span><span class="ident" id="5181541">Recv</span><span class="op" id="5181545">.</span><span class="ident" id="5181546">List</span><span class="op" id="5181550">[</span><span class="num" id="5181551">0</span><span class="op" id="5181552">]</span><span class="op" id="5181553">.</span><span class="ident" id="5181554">Type</span><span class="op" id="5181558">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5181562">if</span>&nbsp;<span class="ident" id="5181565">imp</span>&nbsp;<span class="op" id="5181569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181574">//&nbsp;should&nbsp;not&nbsp;happen&nbsp;(incorrect&nbsp;AST);</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181615">//&nbsp;don&#39;t&nbsp;show&nbsp;this&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5181644">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5181653">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5181657">if</span>&nbsp;<span class="ident" id="5181660">typ</span>&nbsp;<span class="op" id="5181664">:=</span>&nbsp;<span class="ident" id="5181667">r</span><span class="op" id="5181668">.</span><span class="ident" id="5181669">lookupType</span><span class="op" id="5181679">(</span><span class="ident" id="5181680">recvTypeName</span><span class="op" id="5181692">)</span><span class="op" id="5181693">;</span>&nbsp;<span class="ident" id="5181695">typ</span>&nbsp;<span class="op" id="5181699">!=</span>&nbsp;<span class="ident" id="5181702">nil</span>&nbsp;<span class="op" id="5181706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5181711">typ</span><span class="op" id="5181714">.</span><span class="ident" id="5181715">methods</span><span class="op" id="5181722">.</span><span class="ident" id="5181723">set</span><span class="op" id="5181726">(</span><span class="ident" id="5181727">fun</span><span class="op" id="5181730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5181734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181738">//&nbsp;otherwise&nbsp;ignore&nbsp;the&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181771">//&nbsp;TODO(gri):&nbsp;There&nbsp;may&nbsp;be&nbsp;exported&nbsp;methods&nbsp;of&nbsp;non-exported&nbsp;types</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181839">//&nbsp;that&nbsp;can&nbsp;be&nbsp;called&nbsp;because&nbsp;of&nbsp;exported&nbsp;values&nbsp;(consts,&nbsp;vars,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181908">//&nbsp;function&nbsp;results)&nbsp;of&nbsp;that&nbsp;type.&nbsp;Could&nbsp;determine&nbsp;if&nbsp;that&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5181976">//&nbsp;case&nbsp;and&nbsp;then&nbsp;show&nbsp;those&nbsp;methods&nbsp;in&nbsp;an&nbsp;appropriate&nbsp;section.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182041">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5182049">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182053">//&nbsp;associate&nbsp;factory&nbsp;functions&nbsp;with&nbsp;the&nbsp;first&nbsp;visible&nbsp;result&nbsp;type,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182128">if</span>&nbsp;<span class="ident" id="5182131">fun</span><span class="op" id="5182134">.</span><span class="ident" id="5182135">Type</span><span class="op" id="5182139">.</span><span class="ident" id="5182140">Results</span><span class="op" id="5182147">.</span><span class="ident" id="5182148">NumFields</span><span class="op" id="5182157">(</span><span class="op" id="5182158">)</span>&nbsp;<span class="op" id="5182160">&gt;=</span>&nbsp;<span class="num" id="5182163">1</span>&nbsp;<span class="op" id="5182165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182169">res</span>&nbsp;<span class="op" id="5182173">:=</span>&nbsp;<span class="ident" id="5182176">fun</span><span class="op" id="5182179">.</span><span class="ident" id="5182180">Type</span><span class="op" id="5182184">.</span><span class="ident" id="5182185">Results</span><span class="op" id="5182192">.</span><span class="ident" id="5182193">List</span><span class="op" id="5182197">[</span><span class="num" id="5182198">0</span><span class="op" id="5182199">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182203">if</span>&nbsp;<span class="builtinfunc" id="5182206">len</span><span class="op" id="5182209">(</span><span class="ident" id="5182210">res</span><span class="op" id="5182213">.</span><span class="ident" id="5182214">Names</span><span class="op" id="5182219">)</span>&nbsp;<span class="op" id="5182221">&lt;=</span>&nbsp;<span class="num" id="5182224">1</span>&nbsp;<span class="op" id="5182226">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182231">//&nbsp;exactly&nbsp;one&nbsp;(named&nbsp;or&nbsp;anonymous)&nbsp;result&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182288">//&nbsp;with&nbsp;the&nbsp;first&nbsp;type&nbsp;in&nbsp;result&nbsp;signature&nbsp;(there&nbsp;may</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182345">//&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;result)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182376">if</span>&nbsp;<span class="ident" id="5182379">n</span><span class="op" id="5182380">,</span>&nbsp;<span class="ident" id="5182382">imp</span>&nbsp;<span class="op" id="5182386">:=</span>&nbsp;<span class="ident" id="5182389">baseTypeName</span><span class="op" id="5182401">(</span><span class="ident" id="5182402">res</span><span class="op" id="5182405">.</span><span class="ident" id="5182406">Type</span><span class="op" id="5182410">)</span><span class="op" id="5182411">;</span>&nbsp;<span class="op" id="5182413">!</span><span class="ident" id="5182414">imp</span>&nbsp;<span class="op" id="5182418">&amp;&amp;</span>&nbsp;<span class="ident" id="5182421">r</span><span class="op" id="5182422">.</span><span class="ident" id="5182423">isVisible</span><span class="op" id="5182432">(</span><span class="ident" id="5182433">n</span><span class="op" id="5182434">)</span>&nbsp;<span class="op" id="5182436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182442">if</span>&nbsp;<span class="ident" id="5182445">typ</span>&nbsp;<span class="op" id="5182449">:=</span>&nbsp;<span class="ident" id="5182452">r</span><span class="op" id="5182453">.</span><span class="ident" id="5182454">lookupType</span><span class="op" id="5182464">(</span><span class="ident" id="5182465">n</span><span class="op" id="5182466">)</span><span class="op" id="5182467">;</span>&nbsp;<span class="ident" id="5182469">typ</span>&nbsp;<span class="op" id="5182473">!=</span>&nbsp;<span class="ident" id="5182476">nil</span>&nbsp;<span class="op" id="5182480">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182487">//&nbsp;associate&nbsp;function&nbsp;with&nbsp;typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182523">typ</span><span class="op" id="5182526">.</span><span class="ident" id="5182527">funcs</span><span class="op" id="5182532">.</span><span class="ident" id="5182533">set</span><span class="op" id="5182536">(</span><span class="ident" id="5182537">fun</span><span class="op" id="5182540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5182547">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5182558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5182563">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5182567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5182570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5182574">//&nbsp;just&nbsp;an&nbsp;ordinary&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182604">r</span><span class="op" id="5182605">.</span><span class="ident" id="5182606">funcs</span><span class="op" id="5182611">.</span><span class="ident" id="5182612">set</span><span class="op" id="5182615">(</span><span class="ident" id="5182616">fun</span><span class="op" id="5182619">)</span><br>
<span class="lineno">400</span><span class="op" id="5182621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5182624">var</span>&nbsp;<span class="op" id="5182628">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182631">noteMarker</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5182645">=</span>&nbsp;<span class="string" id="5182647">`([A-Z][A-Z]+)\(([^)]+)\):?`</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5182695">//&nbsp;MARKER(uid),&nbsp;MARKER&nbsp;at&nbsp;least&nbsp;2&nbsp;chars,&nbsp;uid&nbsp;at&nbsp;least&nbsp;1&nbsp;char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182757">noteMarkerRx</span>&nbsp;&nbsp;<span class="op" id="5182771">=</span>&nbsp;<span class="ident" id="5182773">regexp</span><span class="op" id="5182779">.</span><span class="ident" id="5182780">MustCompile</span><span class="op" id="5182791">(</span><span class="string" id="5182792">`^[&nbsp;\t]*`</span>&nbsp;<span class="op" id="5182802">+</span>&nbsp;<span class="ident" id="5182804">noteMarker</span><span class="op" id="5182814">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5182821">//&nbsp;MARKER(uid)&nbsp;at&nbsp;text&nbsp;start</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5182851">noteCommentRx</span>&nbsp;<span class="op" id="5182865">=</span>&nbsp;<span class="ident" id="5182867">regexp</span><span class="op" id="5182873">.</span><span class="ident" id="5182874">MustCompile</span><span class="op" id="5182885">(</span><span class="string" id="5182886">`^/[/*][&nbsp;\t]*`</span>&nbsp;<span class="op" id="5182901">+</span>&nbsp;<span class="ident" id="5182903">noteMarker</span><span class="op" id="5182913">)</span>&nbsp;<span class="comment" id="5182915">//&nbsp;MARKER(uid)&nbsp;at&nbsp;comment&nbsp;start</span><br>
<span class="lineno"></span><span class="op" id="5182947">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5182950">//&nbsp;readNote&nbsp;collects&nbsp;a&nbsp;single&nbsp;note&nbsp;from&nbsp;a&nbsp;sequence&nbsp;of&nbsp;comments.</span><br>
<span class="lineno"></span><span class="comment" id="5183014">//</span><br>
<span class="lineno">410</span><span class="keyword" id="5183017">func</span>&nbsp;<span class="op" id="5183022">(</span><span class="ident" id="5183023">r</span>&nbsp;<span class="op" id="5183025">*</span><span class="ident" id="5183026">reader</span><span class="op" id="5183032">)</span>&nbsp;<span class="ident" id="5183034">readNote</span><span class="op" id="5183042">(</span><span class="ident" id="5183043">list</span>&nbsp;<span class="op" id="5183048">[</span><span class="op" id="5183049">]</span><span class="op" id="5183050">*</span><span class="ident" id="5183051">ast</span><span class="op" id="5183054">.</span><span class="ident" id="5183055">Comment</span><span class="op" id="5183062">)</span>&nbsp;<span class="op" id="5183064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183067">text</span>&nbsp;<span class="op" id="5183072">:=</span>&nbsp;<span class="op" id="5183075">(</span><span class="op" id="5183076">&amp;</span><span class="ident" id="5183077">ast</span><span class="op" id="5183080">.</span><span class="ident" id="5183081">CommentGroup</span><span class="op" id="5183093">{</span><span class="ident" id="5183094">List</span><span class="op" id="5183098">:</span>&nbsp;<span class="ident" id="5183100">list</span><span class="op" id="5183104">}</span><span class="op" id="5183105">)</span><span class="op" id="5183106">.</span><span class="ident" id="5183107">Text</span><span class="op" id="5183111">(</span><span class="op" id="5183112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183115">if</span>&nbsp;<span class="ident" id="5183118">m</span>&nbsp;<span class="op" id="5183120">:=</span>&nbsp;<span class="ident" id="5183123">noteMarkerRx</span><span class="op" id="5183135">.</span><span class="ident" id="5183136">FindStringSubmatchIndex</span><span class="op" id="5183159">(</span><span class="ident" id="5183160">text</span><span class="op" id="5183164">)</span><span class="op" id="5183165">;</span>&nbsp;<span class="ident" id="5183167">m</span>&nbsp;<span class="op" id="5183169">!=</span>&nbsp;<span class="ident" id="5183172">nil</span>&nbsp;<span class="op" id="5183176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5183180">//&nbsp;The&nbsp;note&nbsp;body&nbsp;starts&nbsp;after&nbsp;the&nbsp;marker.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5183224">//&nbsp;We&nbsp;remove&nbsp;any&nbsp;formatting&nbsp;so&nbsp;that&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5183271">//&nbsp;get&nbsp;spurious&nbsp;line&nbsp;breaks/indentation&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5183318">//&nbsp;showing&nbsp;the&nbsp;TODO&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183346">body</span>&nbsp;<span class="op" id="5183351">:=</span>&nbsp;<span class="ident" id="5183354">clean</span><span class="op" id="5183359">(</span><span class="ident" id="5183360">text</span><span class="op" id="5183364">[</span><span class="ident" id="5183365">m</span><span class="op" id="5183366">[</span><span class="num" id="5183367">1</span><span class="op" id="5183368">]</span><span class="op" id="5183369">:</span><span class="op" id="5183370">]</span><span class="op" id="5183371">,</span>&nbsp;<span class="ident" id="5183373">keepNL</span><span class="op" id="5183379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183383">if</span>&nbsp;<span class="ident" id="5183386">body</span>&nbsp;<span class="op" id="5183391">!=</span>&nbsp;<span class="string" id="5183394">&#34;&#34;</span>&nbsp;<span class="op" id="5183397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183402">marker</span>&nbsp;<span class="op" id="5183409">:=</span>&nbsp;<span class="ident" id="5183412">text</span><span class="op" id="5183416">[</span><span class="ident" id="5183417">m</span><span class="op" id="5183418">[</span><span class="num" id="5183419">2</span><span class="op" id="5183420">]</span><span class="op" id="5183421">:</span><span class="ident" id="5183422">m</span><span class="op" id="5183423">[</span><span class="num" id="5183424">3</span><span class="op" id="5183425">]</span><span class="op" id="5183426">]</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183431">r</span><span class="op" id="5183432">.</span><span class="ident" id="5183433">notes</span><span class="op" id="5183438">[</span><span class="ident" id="5183439">marker</span><span class="op" id="5183445">]</span>&nbsp;<span class="op" id="5183447">=</span>&nbsp;<span class="builtinfunc" id="5183449">append</span><span class="op" id="5183455">(</span><span class="ident" id="5183456">r</span><span class="op" id="5183457">.</span><span class="ident" id="5183458">notes</span><span class="op" id="5183463">[</span><span class="ident" id="5183464">marker</span><span class="op" id="5183470">]</span><span class="op" id="5183471">,</span>&nbsp;<span class="op" id="5183473">&amp;</span><span class="ident" id="5183474">Note</span><span class="op" id="5183478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183484">Pos</span><span class="op" id="5183487">:</span>&nbsp;&nbsp;<span class="ident" id="5183490">list</span><span class="op" id="5183494">[</span><span class="num" id="5183495">0</span><span class="op" id="5183496">]</span><span class="op" id="5183497">.</span><span class="ident" id="5183498">Pos</span><span class="op" id="5183501">(</span><span class="op" id="5183502">)</span><span class="op" id="5183503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183509">End</span><span class="op" id="5183512">:</span>&nbsp;&nbsp;<span class="ident" id="5183515">list</span><span class="op" id="5183519">[</span><span class="builtinfunc" id="5183520">len</span><span class="op" id="5183523">(</span><span class="ident" id="5183524">list</span><span class="op" id="5183528">)</span><span class="op" id="5183529">-</span><span class="num" id="5183530">1</span><span class="op" id="5183531">]</span><span class="op" id="5183532">.</span><span class="ident" id="5183533">End</span><span class="op" id="5183536">(</span><span class="op" id="5183537">)</span><span class="op" id="5183538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183544">UID</span><span class="op" id="5183547">:</span>&nbsp;&nbsp;<span class="ident" id="5183550">text</span><span class="op" id="5183554">[</span><span class="ident" id="5183555">m</span><span class="op" id="5183556">[</span><span class="num" id="5183557">4</span><span class="op" id="5183558">]</span><span class="op" id="5183559">:</span><span class="ident" id="5183560">m</span><span class="op" id="5183561">[</span><span class="num" id="5183562">5</span><span class="op" id="5183563">]</span><span class="op" id="5183564">]</span><span class="op" id="5183565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5183571">Body</span><span class="op" id="5183575">:</span>&nbsp;<span class="ident" id="5183577">body</span><span class="op" id="5183581">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5183586">}</span><span class="op" id="5183587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5183591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5183594">}</span><br>
<span class="lineno"></span><span class="op" id="5183596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="comment" id="5183599">//&nbsp;readNotes&nbsp;extracts&nbsp;notes&nbsp;from&nbsp;comments.</span><br>
<span class="lineno"></span><span class="comment" id="5183642">//&nbsp;A&nbsp;note&nbsp;must&nbsp;start&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;comment&nbsp;with&nbsp;&#34;MARKER(uid):&#34;</span><br>
<span class="lineno"></span><span class="comment" id="5183713">//&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;the&nbsp;note&nbsp;body&nbsp;(e.g.,&nbsp;&#34;//&nbsp;BUG(gri):&nbsp;fix&nbsp;this&#34;).</span><br>
<span class="lineno"></span><span class="comment" id="5183782">//&nbsp;The&nbsp;note&nbsp;ends&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;comment&nbsp;group&nbsp;or&nbsp;at&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5183850">//&nbsp;another&nbsp;note&nbsp;in&nbsp;the&nbsp;same&nbsp;comment&nbsp;group,&nbsp;whichever&nbsp;comes&nbsp;first.</span><br>
<span class="lineno">435</span><span class="comment" id="5183916">//</span><br>
<span class="lineno"></span><span class="keyword" id="5183919">func</span>&nbsp;<span class="op" id="5183924">(</span><span class="ident" id="5183925">r</span>&nbsp;<span class="op" id="5183927">*</span><span class="ident" id="5183928">reader</span><span class="op" id="5183934">)</span>&nbsp;<span class="ident" id="5183936">readNotes</span><span class="op" id="5183945">(</span><span class="ident" id="5183946">comments</span>&nbsp;<span class="op" id="5183955">[</span><span class="op" id="5183956">]</span><span class="op" id="5183957">*</span><span class="ident" id="5183958">ast</span><span class="op" id="5183961">.</span><span class="ident" id="5183962">CommentGroup</span><span class="op" id="5183974">)</span>&nbsp;<span class="op" id="5183976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5183979">for</span>&nbsp;<span class="ident" id="5183983">_</span><span class="op" id="5183984">,</span>&nbsp;<span class="ident" id="5183986">group</span>&nbsp;<span class="op" id="5183992">:=</span>&nbsp;<span class="keyword" id="5183995">range</span>&nbsp;<span class="ident" id="5184001">comments</span>&nbsp;<span class="op" id="5184010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184014">i</span>&nbsp;<span class="op" id="5184016">:=</span>&nbsp;<span class="op" id="5184019">-</span><span class="num" id="5184020">1</span>&nbsp;<span class="comment" id="5184022">//&nbsp;comment&nbsp;index&nbsp;of&nbsp;most&nbsp;recent&nbsp;note&nbsp;start,&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184082">list</span>&nbsp;<span class="op" id="5184087">:=</span>&nbsp;<span class="ident" id="5184090">group</span><span class="op" id="5184095">.</span><span class="ident" id="5184096">List</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184103">for</span>&nbsp;<span class="ident" id="5184107">j</span><span class="op" id="5184108">,</span>&nbsp;<span class="ident" id="5184110">c</span>&nbsp;<span class="op" id="5184112">:=</span>&nbsp;<span class="keyword" id="5184115">range</span>&nbsp;<span class="ident" id="5184121">list</span>&nbsp;<span class="op" id="5184126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184131">if</span>&nbsp;<span class="ident" id="5184134">noteCommentRx</span><span class="op" id="5184147">.</span><span class="ident" id="5184148">MatchString</span><span class="op" id="5184159">(</span><span class="ident" id="5184160">c</span><span class="op" id="5184161">.</span><span class="ident" id="5184162">Text</span><span class="op" id="5184166">)</span>&nbsp;<span class="op" id="5184168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184174">if</span>&nbsp;<span class="ident" id="5184177">i</span>&nbsp;<span class="op" id="5184179">&gt;=</span>&nbsp;<span class="num" id="5184182">0</span>&nbsp;<span class="op" id="5184184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184191">r</span><span class="op" id="5184192">.</span><span class="ident" id="5184193">readNote</span><span class="op" id="5184201">(</span><span class="ident" id="5184202">list</span><span class="op" id="5184206">[</span><span class="ident" id="5184207">i</span><span class="op" id="5184208">:</span><span class="ident" id="5184209">j</span><span class="op" id="5184210">]</span><span class="op" id="5184211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5184217">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184223">i</span>&nbsp;<span class="op" id="5184225">=</span>&nbsp;<span class="ident" id="5184227">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5184232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5184236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184240">if</span>&nbsp;<span class="ident" id="5184243">i</span>&nbsp;<span class="op" id="5184245">&gt;=</span>&nbsp;<span class="num" id="5184248">0</span>&nbsp;<span class="op" id="5184250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184255">r</span><span class="op" id="5184256">.</span><span class="ident" id="5184257">readNote</span><span class="op" id="5184265">(</span><span class="ident" id="5184266">list</span><span class="op" id="5184270">[</span><span class="ident" id="5184271">i</span><span class="op" id="5184272">:</span><span class="op" id="5184273">]</span><span class="op" id="5184274">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5184278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5184281">}</span><br>
<span class="lineno"></span><span class="op" id="5184283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5184286">//&nbsp;readFile&nbsp;adds&nbsp;the&nbsp;AST&nbsp;for&nbsp;a&nbsp;source&nbsp;file&nbsp;to&nbsp;the&nbsp;reader.</span><br>
<span class="lineno">455</span><span class="comment" id="5184344">//</span><br>
<span class="lineno"></span><span class="keyword" id="5184347">func</span>&nbsp;<span class="op" id="5184352">(</span><span class="ident" id="5184353">r</span>&nbsp;<span class="op" id="5184355">*</span><span class="ident" id="5184356">reader</span><span class="op" id="5184362">)</span>&nbsp;<span class="ident" id="5184364">readFile</span><span class="op" id="5184372">(</span><span class="ident" id="5184373">src</span>&nbsp;<span class="op" id="5184377">*</span><span class="ident" id="5184378">ast</span><span class="op" id="5184381">.</span><span class="ident" id="5184382">File</span><span class="op" id="5184386">)</span>&nbsp;<span class="op" id="5184388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5184391">//&nbsp;add&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184421">if</span>&nbsp;<span class="ident" id="5184424">src</span><span class="op" id="5184427">.</span><span class="ident" id="5184428">Doc</span>&nbsp;<span class="op" id="5184432">!=</span>&nbsp;<span class="ident" id="5184435">nil</span>&nbsp;<span class="op" id="5184439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184443">r</span><span class="op" id="5184444">.</span><span class="ident" id="5184445">readDoc</span><span class="op" id="5184452">(</span><span class="ident" id="5184453">src</span><span class="op" id="5184456">.</span><span class="ident" id="5184457">Doc</span><span class="op" id="5184460">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184464">src</span><span class="op" id="5184467">.</span><span class="ident" id="5184468">Doc</span>&nbsp;<span class="op" id="5184472">=</span>&nbsp;<span class="ident" id="5184474">nil</span>&nbsp;<span class="comment" id="5184478">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5184513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5184517">//&nbsp;add&nbsp;all&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184542">for</span>&nbsp;<span class="ident" id="5184546">_</span><span class="op" id="5184547">,</span>&nbsp;<span class="ident" id="5184549">decl</span>&nbsp;<span class="op" id="5184554">:=</span>&nbsp;<span class="keyword" id="5184557">range</span>&nbsp;<span class="ident" id="5184563">src</span><span class="op" id="5184566">.</span><span class="ident" id="5184567">Decls</span>&nbsp;<span class="op" id="5184573">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184577">switch</span>&nbsp;<span class="ident" id="5184584">d</span>&nbsp;<span class="op" id="5184586">:=</span>&nbsp;<span class="ident" id="5184589">decl</span><span class="op" id="5184593">.</span><span class="op" id="5184594">(</span><span class="keyword" id="5184595">type</span><span class="op" id="5184599">)</span>&nbsp;<span class="op" id="5184601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184605">case</span>&nbsp;<span class="op" id="5184610">*</span><span class="ident" id="5184611">ast</span><span class="op" id="5184614">.</span><span class="ident" id="5184615">GenDecl</span><span class="op" id="5184622">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184627">switch</span>&nbsp;<span class="ident" id="5184634">d</span><span class="op" id="5184635">.</span><span class="ident" id="5184636">Tok</span>&nbsp;<span class="op" id="5184640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184645">case</span>&nbsp;<span class="ident" id="5184650">token</span><span class="op" id="5184655">.</span><span class="ident" id="5184656">IMPORT</span><span class="op" id="5184662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5184668">//&nbsp;imports&nbsp;are&nbsp;handled&nbsp;individually</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184708">for</span>&nbsp;<span class="ident" id="5184712">_</span><span class="op" id="5184713">,</span>&nbsp;<span class="ident" id="5184715">spec</span>&nbsp;<span class="op" id="5184720">:=</span>&nbsp;<span class="keyword" id="5184723">range</span>&nbsp;<span class="ident" id="5184729">d</span><span class="op" id="5184730">.</span><span class="ident" id="5184731">Specs</span>&nbsp;<span class="op" id="5184737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184744">if</span>&nbsp;<span class="ident" id="5184747">s</span><span class="op" id="5184748">,</span>&nbsp;<span class="ident" id="5184750">ok</span>&nbsp;<span class="op" id="5184753">:=</span>&nbsp;<span class="ident" id="5184756">spec</span><span class="op" id="5184760">.</span><span class="op" id="5184761">(</span><span class="op" id="5184762">*</span><span class="ident" id="5184763">ast</span><span class="op" id="5184766">.</span><span class="ident" id="5184767">ImportSpec</span><span class="op" id="5184777">)</span><span class="op" id="5184778">;</span>&nbsp;<span class="ident" id="5184780">ok</span>&nbsp;<span class="op" id="5184783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184791">if</span>&nbsp;<span class="ident" id="5184794">import_</span><span class="op" id="5184801">,</span>&nbsp;<span class="ident" id="5184803">err</span>&nbsp;<span class="op" id="5184807">:=</span>&nbsp;<span class="ident" id="5184810">strconv</span><span class="op" id="5184817">.</span><span class="ident" id="5184818">Unquote</span><span class="op" id="5184825">(</span><span class="ident" id="5184826">s</span><span class="op" id="5184827">.</span><span class="ident" id="5184828">Path</span><span class="op" id="5184832">.</span><span class="ident" id="5184833">Value</span><span class="op" id="5184838">)</span><span class="op" id="5184839">;</span>&nbsp;<span class="ident" id="5184841">err</span>&nbsp;<span class="op" id="5184845">==</span>&nbsp;<span class="ident" id="5184848">nil</span>&nbsp;<span class="op" id="5184852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5184861">r</span><span class="op" id="5184862">.</span><span class="ident" id="5184863">imports</span><span class="op" id="5184870">[</span><span class="ident" id="5184871">import_</span><span class="op" id="5184878">]</span>&nbsp;<span class="op" id="5184880">=</span>&nbsp;<span class="num" id="5184882">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5184890">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5184897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5184903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5184908">case</span>&nbsp;<span class="ident" id="5184913">token</span><span class="op" id="5184918">.</span><span class="ident" id="5184919">CONST</span><span class="op" id="5184924">,</span>&nbsp;<span class="ident" id="5184926">token</span><span class="op" id="5184931">.</span><span class="ident" id="5184932">VAR</span><span class="op" id="5184935">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5184941">//&nbsp;constants&nbsp;and&nbsp;variables&nbsp;are&nbsp;always&nbsp;handled&nbsp;as&nbsp;a&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185002">r</span><span class="op" id="5185003">.</span><span class="ident" id="5185004">readValue</span><span class="op" id="5185013">(</span><span class="ident" id="5185014">d</span><span class="op" id="5185015">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185020">case</span>&nbsp;<span class="ident" id="5185025">token</span><span class="op" id="5185030">.</span><span class="ident" id="5185031">TYPE</span><span class="op" id="5185035">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185041">//&nbsp;types&nbsp;are&nbsp;handled&nbsp;individually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185079">if</span>&nbsp;<span class="builtinfunc" id="5185082">len</span><span class="op" id="5185085">(</span><span class="ident" id="5185086">d</span><span class="op" id="5185087">.</span><span class="ident" id="5185088">Specs</span><span class="op" id="5185093">)</span>&nbsp;<span class="op" id="5185095">==</span>&nbsp;<span class="num" id="5185098">1</span>&nbsp;<span class="op" id="5185100">&amp;&amp;</span>&nbsp;<span class="op" id="5185103">!</span><span class="ident" id="5185104">d</span><span class="op" id="5185105">.</span><span class="ident" id="5185106">Lparen</span><span class="op" id="5185112">.</span><span class="ident" id="5185113">IsValid</span><span class="op" id="5185120">(</span><span class="op" id="5185121">)</span>&nbsp;<span class="op" id="5185123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185130">//&nbsp;common&nbsp;case:&nbsp;single&nbsp;declaration&nbsp;w/o&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185186">//&nbsp;(if&nbsp;a&nbsp;single&nbsp;declaration&nbsp;is&nbsp;parenthesized,</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185237">//&nbsp;create&nbsp;a&nbsp;new&nbsp;fake&nbsp;declaration&nbsp;below,&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185290">//&nbsp;go/doc&nbsp;type&nbsp;declarations&nbsp;always&nbsp;appear&nbsp;w/o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185341">//&nbsp;parentheses)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185362">if</span>&nbsp;<span class="ident" id="5185365">s</span><span class="op" id="5185366">,</span>&nbsp;<span class="ident" id="5185368">ok</span>&nbsp;<span class="op" id="5185371">:=</span>&nbsp;<span class="ident" id="5185374">d</span><span class="op" id="5185375">.</span><span class="ident" id="5185376">Specs</span><span class="op" id="5185381">[</span><span class="num" id="5185382">0</span><span class="op" id="5185383">]</span><span class="op" id="5185384">.</span><span class="op" id="5185385">(</span><span class="op" id="5185386">*</span><span class="ident" id="5185387">ast</span><span class="op" id="5185390">.</span><span class="ident" id="5185391">TypeSpec</span><span class="op" id="5185399">)</span><span class="op" id="5185400">;</span>&nbsp;<span class="ident" id="5185402">ok</span>&nbsp;<span class="op" id="5185405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185413">r</span><span class="op" id="5185414">.</span><span class="ident" id="5185415">readType</span><span class="op" id="5185423">(</span><span class="ident" id="5185424">d</span><span class="op" id="5185425">,</span>&nbsp;<span class="ident" id="5185427">s</span><span class="op" id="5185428">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5185435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185442">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5185452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185458">for</span>&nbsp;<span class="ident" id="5185462">_</span><span class="op" id="5185463">,</span>&nbsp;<span class="ident" id="5185465">spec</span>&nbsp;<span class="op" id="5185470">:=</span>&nbsp;<span class="keyword" id="5185473">range</span>&nbsp;<span class="ident" id="5185479">d</span><span class="op" id="5185480">.</span><span class="ident" id="5185481">Specs</span>&nbsp;<span class="op" id="5185487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5185494">if</span>&nbsp;<span class="ident" id="5185497">s</span><span class="op" id="5185498">,</span>&nbsp;<span class="ident" id="5185500">ok</span>&nbsp;<span class="op" id="5185503">:=</span>&nbsp;<span class="ident" id="5185506">spec</span><span class="op" id="5185510">.</span><span class="op" id="5185511">(</span><span class="op" id="5185512">*</span><span class="ident" id="5185513">ast</span><span class="op" id="5185516">.</span><span class="ident" id="5185517">TypeSpec</span><span class="op" id="5185525">)</span><span class="op" id="5185526">;</span>&nbsp;<span class="ident" id="5185528">ok</span>&nbsp;<span class="op" id="5185531">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185539">//&nbsp;use&nbsp;an&nbsp;individual&nbsp;(possibly&nbsp;fake)&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185594">//&nbsp;for&nbsp;each&nbsp;type;&nbsp;this&nbsp;also&nbsp;ensures&nbsp;that&nbsp;each&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185651">//&nbsp;gets&nbsp;to&nbsp;(re-)use&nbsp;the&nbsp;declaration&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185707">//&nbsp;if&nbsp;there&#39;s&nbsp;none&nbsp;associated&nbsp;with&nbsp;the&nbsp;spec&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185764">fake</span>&nbsp;<span class="op" id="5185769">:=</span>&nbsp;<span class="op" id="5185772">&amp;</span><span class="ident" id="5185773">ast</span><span class="op" id="5185776">.</span><span class="ident" id="5185777">GenDecl</span><span class="op" id="5185784">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5185793">Doc</span><span class="op" id="5185796">:</span>&nbsp;<span class="ident" id="5185798">d</span><span class="op" id="5185799">.</span><span class="ident" id="5185800">Doc</span><span class="op" id="5185803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185812">//&nbsp;don&#39;t&nbsp;use&nbsp;the&nbsp;existing&nbsp;TokPos&nbsp;because&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185863">//&nbsp;will&nbsp;lead&nbsp;to&nbsp;the&nbsp;wrong&nbsp;selection&nbsp;range&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185916">//&nbsp;the&nbsp;fake&nbsp;declaration&nbsp;if&nbsp;there&nbsp;are&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5185965">//&nbsp;than&nbsp;one&nbsp;type&nbsp;in&nbsp;the&nbsp;group&nbsp;(this&nbsp;affects</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186016">//&nbsp;src/cmd/godoc/godoc.go&#39;s&nbsp;posLink_urlFunc)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186068">TokPos</span><span class="op" id="5186074">:</span>&nbsp;<span class="ident" id="5186076">s</span><span class="op" id="5186077">.</span><span class="ident" id="5186078">Pos</span><span class="op" id="5186081">(</span><span class="op" id="5186082">)</span><span class="op" id="5186083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186092">Tok</span><span class="op" id="5186095">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5186100">token</span><span class="op" id="5186105">.</span><span class="ident" id="5186106">TYPE</span><span class="op" id="5186110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186119">Specs</span><span class="op" id="5186124">:</span>&nbsp;&nbsp;<span class="op" id="5186127">[</span><span class="op" id="5186128">]</span><span class="ident" id="5186129">ast</span><span class="op" id="5186132">.</span><span class="ident" id="5186133">Spec</span><span class="op" id="5186137">{</span><span class="ident" id="5186138">s</span><span class="op" id="5186139">}</span><span class="op" id="5186140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5186148">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186156">r</span><span class="op" id="5186157">.</span><span class="ident" id="5186158">readType</span><span class="op" id="5186166">(</span><span class="ident" id="5186167">fake</span><span class="op" id="5186171">,</span>&nbsp;<span class="ident" id="5186173">s</span><span class="op" id="5186174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5186181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5186187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5186192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186196">case</span>&nbsp;<span class="op" id="5186201">*</span><span class="ident" id="5186202">ast</span><span class="op" id="5186205">.</span><span class="ident" id="5186206">FuncDecl</span><span class="op" id="5186214">:</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186219">r</span><span class="op" id="5186220">.</span><span class="ident" id="5186221">readFunc</span><span class="op" id="5186229">(</span><span class="ident" id="5186230">d</span><span class="op" id="5186231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5186235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5186238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186242">//&nbsp;collect&nbsp;MARKER(...):&nbsp;annotations</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186279">r</span><span class="op" id="5186280">.</span><span class="ident" id="5186281">readNotes</span><span class="op" id="5186290">(</span><span class="ident" id="5186291">src</span><span class="op" id="5186294">.</span><span class="ident" id="5186295">Comments</span><span class="op" id="5186303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186306">src</span><span class="op" id="5186309">.</span><span class="ident" id="5186310">Comments</span>&nbsp;<span class="op" id="5186319">=</span>&nbsp;<span class="ident" id="5186321">nil</span>&nbsp;<span class="comment" id="5186325">//&nbsp;consumed&nbsp;unassociated&nbsp;comments&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span><span class="op" id="5186377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5186380">func</span>&nbsp;<span class="op" id="5186385">(</span><span class="ident" id="5186386">r</span>&nbsp;<span class="op" id="5186388">*</span><span class="ident" id="5186389">reader</span><span class="op" id="5186395">)</span>&nbsp;<span class="ident" id="5186397">readPackage</span><span class="op" id="5186408">(</span><span class="ident" id="5186409">pkg</span>&nbsp;<span class="op" id="5186413">*</span><span class="ident" id="5186414">ast</span><span class="op" id="5186417">.</span><span class="ident" id="5186418">Package</span><span class="op" id="5186425">,</span>&nbsp;<span class="ident" id="5186427">mode</span>&nbsp;<span class="ident" id="5186432">Mode</span><span class="op" id="5186436">)</span>&nbsp;<span class="op" id="5186438">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186441">//&nbsp;initialize&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186463">r</span><span class="op" id="5186464">.</span><span class="ident" id="5186465">filenames</span>&nbsp;<span class="op" id="5186475">=</span>&nbsp;<span class="builtinfunc" id="5186477">make</span><span class="op" id="5186481">(</span><span class="op" id="5186482">[</span><span class="op" id="5186483">]</span><span class="builtintype" id="5186484">string</span><span class="op" id="5186490">,</span>&nbsp;<span class="builtinfunc" id="5186492">len</span><span class="op" id="5186495">(</span><span class="ident" id="5186496">pkg</span><span class="op" id="5186499">.</span><span class="ident" id="5186500">Files</span><span class="op" id="5186505">)</span><span class="op" id="5186506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186509">r</span><span class="op" id="5186510">.</span><span class="ident" id="5186511">imports</span>&nbsp;<span class="op" id="5186519">=</span>&nbsp;<span class="builtinfunc" id="5186521">make</span><span class="op" id="5186525">(</span><span class="keyword" id="5186526">map</span><span class="op" id="5186529">[</span><span class="builtintype" id="5186530">string</span><span class="op" id="5186536">]</span><span class="builtintype" id="5186537">int</span><span class="op" id="5186540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186543">r</span><span class="op" id="5186544">.</span><span class="ident" id="5186545">mode</span>&nbsp;<span class="op" id="5186550">=</span>&nbsp;<span class="ident" id="5186552">mode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186558">r</span><span class="op" id="5186559">.</span><span class="ident" id="5186560">types</span>&nbsp;<span class="op" id="5186566">=</span>&nbsp;<span class="builtinfunc" id="5186568">make</span><span class="op" id="5186572">(</span><span class="keyword" id="5186573">map</span><span class="op" id="5186576">[</span><span class="builtintype" id="5186577">string</span><span class="op" id="5186583">]</span><span class="op" id="5186584">*</span><span class="ident" id="5186585">namedType</span><span class="op" id="5186594">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186597">r</span><span class="op" id="5186598">.</span><span class="ident" id="5186599">funcs</span>&nbsp;<span class="op" id="5186605">=</span>&nbsp;<span class="builtinfunc" id="5186607">make</span><span class="op" id="5186611">(</span><span class="ident" id="5186612">methodSet</span><span class="op" id="5186621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186624">r</span><span class="op" id="5186625">.</span><span class="ident" id="5186626">notes</span>&nbsp;<span class="op" id="5186632">=</span>&nbsp;<span class="builtinfunc" id="5186634">make</span><span class="op" id="5186638">(</span><span class="keyword" id="5186639">map</span><span class="op" id="5186642">[</span><span class="builtintype" id="5186643">string</span><span class="op" id="5186649">]</span><span class="op" id="5186650">[</span><span class="op" id="5186651">]</span><span class="op" id="5186652">*</span><span class="ident" id="5186653">Note</span><span class="op" id="5186657">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186661">//&nbsp;sort&nbsp;package&nbsp;files&nbsp;before&nbsp;reading&nbsp;them&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186716">//&nbsp;result&nbsp;does&nbsp;not&nbsp;depend&nbsp;on&nbsp;map&nbsp;iteration&nbsp;order</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186766">i</span>&nbsp;<span class="op" id="5186768">:=</span>&nbsp;<span class="num" id="5186771">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186774">for</span>&nbsp;<span class="ident" id="5186778">filename</span>&nbsp;<span class="op" id="5186787">:=</span>&nbsp;<span class="keyword" id="5186790">range</span>&nbsp;<span class="ident" id="5186796">pkg</span><span class="op" id="5186799">.</span><span class="ident" id="5186800">Files</span>&nbsp;<span class="op" id="5186806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186810">r</span><span class="op" id="5186811">.</span><span class="ident" id="5186812">filenames</span><span class="op" id="5186821">[</span><span class="ident" id="5186822">i</span><span class="op" id="5186823">]</span>&nbsp;<span class="op" id="5186825">=</span>&nbsp;<span class="ident" id="5186827">filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186838">i</span><span class="op" id="5186839">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5186843">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186846">sort</span><span class="op" id="5186850">.</span><span class="ident" id="5186851">Strings</span><span class="op" id="5186858">(</span><span class="ident" id="5186859">r</span><span class="op" id="5186860">.</span><span class="ident" id="5186861">filenames</span><span class="op" id="5186870">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5186874">//&nbsp;process&nbsp;files&nbsp;in&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186908">for</span>&nbsp;<span class="ident" id="5186912">_</span><span class="op" id="5186913">,</span>&nbsp;<span class="ident" id="5186915">filename</span>&nbsp;<span class="op" id="5186924">:=</span>&nbsp;<span class="keyword" id="5186927">range</span>&nbsp;<span class="ident" id="5186933">r</span><span class="op" id="5186934">.</span><span class="ident" id="5186935">filenames</span>&nbsp;<span class="op" id="5186945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5186949">f</span>&nbsp;<span class="op" id="5186951">:=</span>&nbsp;<span class="ident" id="5186954">pkg</span><span class="op" id="5186957">.</span><span class="ident" id="5186958">Files</span><span class="op" id="5186963">[</span><span class="ident" id="5186964">filename</span><span class="op" id="5186972">]</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5186976">if</span>&nbsp;<span class="ident" id="5186979">mode</span><span class="op" id="5186983">&amp;</span><span class="ident" id="5186984">AllDecls</span>&nbsp;<span class="op" id="5186993">==</span>&nbsp;<span class="num" id="5186996">0</span>&nbsp;<span class="op" id="5186998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187003">r</span><span class="op" id="5187004">.</span><span class="ident" id="5187005">fileExports</span><span class="op" id="5187016">(</span><span class="ident" id="5187017">f</span><span class="op" id="5187018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187022">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187026">r</span><span class="op" id="5187027">.</span><span class="ident" id="5187028">readFile</span><span class="op" id="5187036">(</span><span class="ident" id="5187037">f</span><span class="op" id="5187038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187041">}</span><br>
<span class="lineno">550</span><span class="op" id="5187043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5187046">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5187126">//&nbsp;Types</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="5187136">func</span>&nbsp;<span class="ident" id="5187141">customizeRecv</span><span class="op" id="5187154">(</span><span class="ident" id="5187155">f</span>&nbsp;<span class="op" id="5187157">*</span><span class="ident" id="5187158">Func</span><span class="op" id="5187162">,</span>&nbsp;<span class="ident" id="5187164">recvTypeName</span>&nbsp;<span class="builtintype" id="5187177">string</span><span class="op" id="5187183">,</span>&nbsp;<span class="ident" id="5187185">embeddedIsPtr</span>&nbsp;<span class="builtintype" id="5187199">bool</span><span class="op" id="5187203">,</span>&nbsp;<span class="ident" id="5187205">level</span>&nbsp;<span class="builtintype" id="5187211">int</span><span class="op" id="5187214">)</span>&nbsp;<span class="op" id="5187216">*</span><span class="ident" id="5187217">Func</span>&nbsp;<span class="op" id="5187222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187225">if</span>&nbsp;<span class="ident" id="5187228">f</span>&nbsp;<span class="op" id="5187230">==</span>&nbsp;<span class="ident" id="5187233">nil</span>&nbsp;<span class="op" id="5187237">||</span>&nbsp;<span class="ident" id="5187240">f</span><span class="op" id="5187241">.</span><span class="ident" id="5187242">Decl</span>&nbsp;<span class="op" id="5187247">==</span>&nbsp;<span class="ident" id="5187250">nil</span>&nbsp;<span class="op" id="5187254">||</span>&nbsp;<span class="ident" id="5187257">f</span><span class="op" id="5187258">.</span><span class="ident" id="5187259">Decl</span><span class="op" id="5187263">.</span><span class="ident" id="5187264">Recv</span>&nbsp;<span class="op" id="5187269">==</span>&nbsp;<span class="ident" id="5187272">nil</span>&nbsp;<span class="op" id="5187276">||</span>&nbsp;<span class="builtinfunc" id="5187279">len</span><span class="op" id="5187282">(</span><span class="ident" id="5187283">f</span><span class="op" id="5187284">.</span><span class="ident" id="5187285">Decl</span><span class="op" id="5187289">.</span><span class="ident" id="5187290">Recv</span><span class="op" id="5187294">.</span><span class="ident" id="5187295">List</span><span class="op" id="5187299">)</span>&nbsp;<span class="op" id="5187301">!=</span>&nbsp;<span class="num" id="5187304">1</span>&nbsp;<span class="op" id="5187306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187310">return</span>&nbsp;<span class="ident" id="5187317">f</span>&nbsp;<span class="comment" id="5187319">//&nbsp;shouldn&#39;t&nbsp;happen,&nbsp;but&nbsp;be&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5187357">//&nbsp;copy&nbsp;existing&nbsp;receiver&nbsp;field&nbsp;and&nbsp;set&nbsp;new&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187407">newField</span>&nbsp;<span class="op" id="5187416">:=</span>&nbsp;<span class="op" id="5187419">*</span><span class="ident" id="5187420">f</span><span class="op" id="5187421">.</span><span class="ident" id="5187422">Decl</span><span class="op" id="5187426">.</span><span class="ident" id="5187427">Recv</span><span class="op" id="5187431">.</span><span class="ident" id="5187432">List</span><span class="op" id="5187436">[</span><span class="num" id="5187437">0</span><span class="op" id="5187438">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187441">origPos</span>&nbsp;<span class="op" id="5187449">:=</span>&nbsp;<span class="ident" id="5187452">newField</span><span class="op" id="5187460">.</span><span class="ident" id="5187461">Type</span><span class="op" id="5187465">.</span><span class="ident" id="5187466">Pos</span><span class="op" id="5187469">(</span><span class="op" id="5187470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187473">_</span><span class="op" id="5187474">,</span>&nbsp;<span class="ident" id="5187476">origRecvIsPtr</span>&nbsp;<span class="op" id="5187490">:=</span>&nbsp;<span class="ident" id="5187493">newField</span><span class="op" id="5187501">.</span><span class="ident" id="5187502">Type</span><span class="op" id="5187506">.</span><span class="op" id="5187507">(</span><span class="op" id="5187508">*</span><span class="ident" id="5187509">ast</span><span class="op" id="5187512">.</span><span class="ident" id="5187513">StarExpr</span><span class="op" id="5187521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187524">newIdent</span>&nbsp;<span class="op" id="5187533">:=</span>&nbsp;<span class="op" id="5187536">&amp;</span><span class="ident" id="5187537">ast</span><span class="op" id="5187540">.</span><span class="ident" id="5187541">Ident</span><span class="op" id="5187546">{</span><span class="ident" id="5187547">NamePos</span><span class="op" id="5187554">:</span>&nbsp;<span class="ident" id="5187556">origPos</span><span class="op" id="5187563">,</span>&nbsp;<span class="ident" id="5187565">Name</span><span class="op" id="5187569">:</span>&nbsp;<span class="ident" id="5187571">recvTypeName</span><span class="op" id="5187583">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187586">var</span>&nbsp;<span class="ident" id="5187590">typ</span>&nbsp;<span class="ident" id="5187594">ast</span><span class="op" id="5187597">.</span><span class="ident" id="5187598">Expr</span>&nbsp;<span class="op" id="5187603">=</span>&nbsp;<span class="ident" id="5187605">newIdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5187615">if</span>&nbsp;<span class="op" id="5187618">!</span><span class="ident" id="5187619">embeddedIsPtr</span>&nbsp;<span class="op" id="5187633">&amp;&amp;</span>&nbsp;<span class="ident" id="5187636">origRecvIsPtr</span>&nbsp;<span class="op" id="5187650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187654">newIdent</span><span class="op" id="5187662">.</span><span class="ident" id="5187663">NamePos</span><span class="op" id="5187670">++</span>&nbsp;<span class="comment" id="5187673">//&nbsp;&#39;*&#39;&nbsp;is&nbsp;one&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187699">typ</span>&nbsp;<span class="op" id="5187703">=</span>&nbsp;<span class="op" id="5187705">&amp;</span><span class="ident" id="5187706">ast</span><span class="op" id="5187709">.</span><span class="ident" id="5187710">StarExpr</span><span class="op" id="5187718">{</span><span class="ident" id="5187719">Star</span><span class="op" id="5187723">:</span>&nbsp;<span class="ident" id="5187725">origPos</span><span class="op" id="5187732">,</span>&nbsp;<span class="ident" id="5187734">X</span><span class="op" id="5187735">:</span>&nbsp;<span class="ident" id="5187737">newIdent</span><span class="op" id="5187745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5187748">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187751">newField</span><span class="op" id="5187759">.</span><span class="ident" id="5187760">Type</span>&nbsp;<span class="op" id="5187765">=</span>&nbsp;<span class="ident" id="5187767">typ</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5187773">//&nbsp;copy&nbsp;existing&nbsp;receiver&nbsp;field&nbsp;list&nbsp;and&nbsp;set&nbsp;new&nbsp;receiver&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187838">newFieldList</span>&nbsp;<span class="op" id="5187851">:=</span>&nbsp;<span class="op" id="5187854">*</span><span class="ident" id="5187855">f</span><span class="op" id="5187856">.</span><span class="ident" id="5187857">Decl</span><span class="op" id="5187861">.</span><span class="ident" id="5187862">Recv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187868">newFieldList</span><span class="op" id="5187880">.</span><span class="ident" id="5187881">List</span>&nbsp;<span class="op" id="5187886">=</span>&nbsp;<span class="op" id="5187888">[</span><span class="op" id="5187889">]</span><span class="op" id="5187890">*</span><span class="ident" id="5187891">ast</span><span class="op" id="5187894">.</span><span class="ident" id="5187895">Field</span><span class="op" id="5187900">{</span><span class="op" id="5187901">&amp;</span><span class="ident" id="5187902">newField</span><span class="op" id="5187910">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5187914">//&nbsp;copy&nbsp;existing&nbsp;function&nbsp;declaration&nbsp;and&nbsp;set&nbsp;new&nbsp;receiver&nbsp;field&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5187985">newFuncDecl</span>&nbsp;<span class="op" id="5187997">:=</span>&nbsp;<span class="op" id="5188000">*</span><span class="ident" id="5188001">f</span><span class="op" id="5188002">.</span><span class="ident" id="5188003">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188009">newFuncDecl</span><span class="op" id="5188020">.</span><span class="ident" id="5188021">Recv</span>&nbsp;<span class="op" id="5188026">=</span>&nbsp;<span class="op" id="5188028">&amp;</span><span class="ident" id="5188029">newFieldList</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5188044">//&nbsp;copy&nbsp;existing&nbsp;function&nbsp;documentation&nbsp;and&nbsp;set&nbsp;new&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188109">newF</span>&nbsp;<span class="op" id="5188114">:=</span>&nbsp;<span class="op" id="5188117">*</span><span class="ident" id="5188118">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188121">newF</span><span class="op" id="5188125">.</span><span class="ident" id="5188126">Decl</span>&nbsp;<span class="op" id="5188131">=</span>&nbsp;<span class="op" id="5188133">&amp;</span><span class="ident" id="5188134">newFuncDecl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188147">newF</span><span class="op" id="5188151">.</span><span class="ident" id="5188152">Recv</span>&nbsp;<span class="op" id="5188157">=</span>&nbsp;<span class="ident" id="5188159">recvString</span><span class="op" id="5188169">(</span><span class="ident" id="5188170">typ</span><span class="op" id="5188173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5188176">//&nbsp;the&nbsp;Orig&nbsp;field&nbsp;never&nbsp;changes</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188209">newF</span><span class="op" id="5188213">.</span><span class="ident" id="5188214">Level</span>&nbsp;<span class="op" id="5188220">=</span>&nbsp;<span class="ident" id="5188222">level</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188230">return</span>&nbsp;<span class="op" id="5188237">&amp;</span><span class="ident" id="5188238">newF</span><br>
<span class="lineno"></span><span class="op" id="5188243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span><span class="comment" id="5188246">//&nbsp;collectEmbeddedMethods&nbsp;collects&nbsp;the&nbsp;embedded&nbsp;methods&nbsp;of&nbsp;typ&nbsp;in&nbsp;mset.</span><br>
<span class="lineno"></span><span class="comment" id="5188318">//</span><br>
<span class="lineno"></span><span class="keyword" id="5188321">func</span>&nbsp;<span class="op" id="5188326">(</span><span class="ident" id="5188327">r</span>&nbsp;<span class="op" id="5188329">*</span><span class="ident" id="5188330">reader</span><span class="op" id="5188336">)</span>&nbsp;<span class="ident" id="5188338">collectEmbeddedMethods</span><span class="op" id="5188360">(</span><span class="ident" id="5188361">mset</span>&nbsp;<span class="ident" id="5188366">methodSet</span><span class="op" id="5188375">,</span>&nbsp;<span class="ident" id="5188377">typ</span>&nbsp;<span class="op" id="5188381">*</span><span class="ident" id="5188382">namedType</span><span class="op" id="5188391">,</span>&nbsp;<span class="ident" id="5188393">recvTypeName</span>&nbsp;<span class="builtintype" id="5188406">string</span><span class="op" id="5188412">,</span>&nbsp;<span class="ident" id="5188414">embeddedIsPtr</span>&nbsp;<span class="builtintype" id="5188428">bool</span><span class="op" id="5188432">,</span>&nbsp;<span class="ident" id="5188434">level</span>&nbsp;<span class="builtintype" id="5188440">int</span><span class="op" id="5188443">,</span>&nbsp;<span class="ident" id="5188445">visited</span>&nbsp;<span class="ident" id="5188453">embeddedSet</span><span class="op" id="5188464">)</span>&nbsp;<span class="op" id="5188466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188469">visited</span><span class="op" id="5188476">[</span><span class="ident" id="5188477">typ</span><span class="op" id="5188480">]</span>&nbsp;<span class="op" id="5188482">=</span>&nbsp;<span class="builtintype" id="5188484">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188490">for</span>&nbsp;<span class="ident" id="5188494">embedded</span><span class="op" id="5188502">,</span>&nbsp;<span class="ident" id="5188504">isPtr</span>&nbsp;<span class="op" id="5188510">:=</span>&nbsp;<span class="keyword" id="5188513">range</span>&nbsp;<span class="ident" id="5188519">typ</span><span class="op" id="5188522">.</span><span class="ident" id="5188523">embedded</span>&nbsp;<span class="op" id="5188532">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5188536">//&nbsp;Once&nbsp;an&nbsp;embedded&nbsp;type&nbsp;is&nbsp;embedded&nbsp;as&nbsp;a&nbsp;pointer&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5188593">//&nbsp;all&nbsp;embedded&nbsp;types&nbsp;in&nbsp;those&nbsp;types&nbsp;are&nbsp;treated&nbsp;like</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5188649">//&nbsp;pointer&nbsp;types&nbsp;for&nbsp;the&nbsp;purpose&nbsp;of&nbsp;the&nbsp;receiver&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5188705">//&nbsp;computation;&nbsp;i.e.,&nbsp;embeddedIsPtr&nbsp;is&nbsp;sticky&nbsp;for&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5188762">//&nbsp;embedding&nbsp;hierarchy.</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188788">thisEmbeddedIsPtr</span>&nbsp;<span class="op" id="5188806">:=</span>&nbsp;<span class="ident" id="5188809">embeddedIsPtr</span>&nbsp;<span class="op" id="5188823">||</span>&nbsp;<span class="ident" id="5188826">isPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188834">for</span>&nbsp;<span class="ident" id="5188838">_</span><span class="op" id="5188839">,</span>&nbsp;<span class="ident" id="5188841">m</span>&nbsp;<span class="op" id="5188843">:=</span>&nbsp;<span class="keyword" id="5188846">range</span>&nbsp;<span class="ident" id="5188852">embedded</span><span class="op" id="5188860">.</span><span class="ident" id="5188861">methods</span>&nbsp;<span class="op" id="5188869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5188874">//&nbsp;only&nbsp;top-level&nbsp;methods&nbsp;are&nbsp;embedded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5188916">if</span>&nbsp;<span class="ident" id="5188919">m</span><span class="op" id="5188920">.</span><span class="ident" id="5188921">Level</span>&nbsp;<span class="op" id="5188927">==</span>&nbsp;<span class="num" id="5188930">0</span>&nbsp;<span class="op" id="5188932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5188938">mset</span><span class="op" id="5188942">.</span><span class="ident" id="5188943">add</span><span class="op" id="5188946">(</span><span class="ident" id="5188947">customizeRecv</span><span class="op" id="5188960">(</span><span class="ident" id="5188961">m</span><span class="op" id="5188962">,</span>&nbsp;<span class="ident" id="5188964">recvTypeName</span><span class="op" id="5188976">,</span>&nbsp;<span class="ident" id="5188978">thisEmbeddedIsPtr</span><span class="op" id="5188995">,</span>&nbsp;<span class="ident" id="5188997">level</span><span class="op" id="5189002">)</span><span class="op" id="5189003">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189016">if</span>&nbsp;<span class="op" id="5189019">!</span><span class="ident" id="5189020">visited</span><span class="op" id="5189027">[</span><span class="ident" id="5189028">embedded</span><span class="op" id="5189036">]</span>&nbsp;<span class="op" id="5189038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189043">r</span><span class="op" id="5189044">.</span><span class="ident" id="5189045">collectEmbeddedMethods</span><span class="op" id="5189067">(</span><span class="ident" id="5189068">mset</span><span class="op" id="5189072">,</span>&nbsp;<span class="ident" id="5189074">embedded</span><span class="op" id="5189082">,</span>&nbsp;<span class="ident" id="5189084">recvTypeName</span><span class="op" id="5189096">,</span>&nbsp;<span class="ident" id="5189098">thisEmbeddedIsPtr</span><span class="op" id="5189115">,</span>&nbsp;<span class="ident" id="5189117">level</span><span class="op" id="5189122">+</span><span class="num" id="5189123">1</span><span class="op" id="5189124">,</span>&nbsp;<span class="ident" id="5189126">visited</span><span class="op" id="5189133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189137">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5189143">delete</span><span class="op" id="5189149">(</span><span class="ident" id="5189150">visited</span><span class="op" id="5189157">,</span>&nbsp;<span class="ident" id="5189159">typ</span><span class="op" id="5189162">)</span><br>
<span class="lineno"></span><span class="op" id="5189164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5189167">//&nbsp;computeMethodSets&nbsp;determines&nbsp;the&nbsp;actual&nbsp;method&nbsp;sets&nbsp;for&nbsp;each&nbsp;type&nbsp;encountered.</span><br>
<span class="lineno">615</span><span class="comment" id="5189249">//</span><br>
<span class="lineno"></span><span class="keyword" id="5189252">func</span>&nbsp;<span class="op" id="5189257">(</span><span class="ident" id="5189258">r</span>&nbsp;<span class="op" id="5189260">*</span><span class="ident" id="5189261">reader</span><span class="op" id="5189267">)</span>&nbsp;<span class="ident" id="5189269">computeMethodSets</span><span class="op" id="5189286">(</span><span class="op" id="5189287">)</span>&nbsp;<span class="op" id="5189289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189292">for</span>&nbsp;<span class="ident" id="5189296">_</span><span class="op" id="5189297">,</span>&nbsp;<span class="ident" id="5189299">t</span>&nbsp;<span class="op" id="5189301">:=</span>&nbsp;<span class="keyword" id="5189304">range</span>&nbsp;<span class="ident" id="5189310">r</span><span class="op" id="5189311">.</span><span class="ident" id="5189312">types</span>&nbsp;<span class="op" id="5189318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5189322">//&nbsp;collect&nbsp;embedded&nbsp;methods&nbsp;for&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189358">if</span>&nbsp;<span class="ident" id="5189361">t</span><span class="op" id="5189362">.</span><span class="ident" id="5189363">isStruct</span>&nbsp;<span class="op" id="5189372">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5189377">//&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189390">r</span><span class="op" id="5189391">.</span><span class="ident" id="5189392">collectEmbeddedMethods</span><span class="op" id="5189414">(</span><span class="ident" id="5189415">t</span><span class="op" id="5189416">.</span><span class="ident" id="5189417">methods</span><span class="op" id="5189424">,</span>&nbsp;<span class="ident" id="5189426">t</span><span class="op" id="5189427">,</span>&nbsp;<span class="ident" id="5189429">t</span><span class="op" id="5189430">.</span><span class="ident" id="5189431">name</span><span class="op" id="5189435">,</span>&nbsp;<span class="builtintype" id="5189437">false</span><span class="op" id="5189442">,</span>&nbsp;<span class="num" id="5189444">1</span><span class="op" id="5189445">,</span>&nbsp;<span class="builtinfunc" id="5189447">make</span><span class="op" id="5189451">(</span><span class="ident" id="5189452">embeddedSet</span><span class="op" id="5189463">)</span><span class="op" id="5189464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189468">}</span>&nbsp;<span class="keyword" id="5189470">else</span>&nbsp;<span class="op" id="5189475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5189480">//&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5189496">//&nbsp;TODO(gri)&nbsp;fix&nbsp;this</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5189527">//&nbsp;if&nbsp;error&nbsp;was&nbsp;declared&nbsp;locally,&nbsp;don&#39;t&nbsp;treat&nbsp;it&nbsp;as&nbsp;exported&nbsp;field&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189603">if</span>&nbsp;<span class="ident" id="5189606">r</span><span class="op" id="5189607">.</span><span class="ident" id="5189608">errorDecl</span>&nbsp;<span class="op" id="5189618">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189622">for</span>&nbsp;<span class="ident" id="5189626">_</span><span class="op" id="5189627">,</span>&nbsp;<span class="ident" id="5189629">ityp</span>&nbsp;<span class="op" id="5189634">:=</span>&nbsp;<span class="keyword" id="5189637">range</span>&nbsp;<span class="ident" id="5189643">r</span><span class="op" id="5189644">.</span><span class="ident" id="5189645">fixlist</span>&nbsp;<span class="op" id="5189653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5189658">removeErrorField</span><span class="op" id="5189674">(</span><span class="ident" id="5189675">ityp</span><span class="op" id="5189679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5189686">}</span><br>
<span class="lineno"></span><span class="op" id="5189688">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="5189691">//&nbsp;cleanupTypes&nbsp;removes&nbsp;the&nbsp;association&nbsp;of&nbsp;functions&nbsp;and&nbsp;methods&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="5189761">//&nbsp;types&nbsp;that&nbsp;have&nbsp;no&nbsp;declaration.&nbsp;Instead,&nbsp;these&nbsp;functions&nbsp;and&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="5189833">//&nbsp;are&nbsp;shown&nbsp;at&nbsp;the&nbsp;package&nbsp;level.&nbsp;It&nbsp;also&nbsp;removes&nbsp;types&nbsp;with&nbsp;missing</span><br>
<span class="lineno"></span><span class="comment" id="5189903">//&nbsp;declarations&nbsp;or&nbsp;which&nbsp;are&nbsp;not&nbsp;visible.</span><br>
<span class="lineno">640</span><span class="comment" id="5189945">//</span><br>
<span class="lineno"></span><span class="keyword" id="5189948">func</span>&nbsp;<span class="op" id="5189953">(</span><span class="ident" id="5189954">r</span>&nbsp;<span class="op" id="5189956">*</span><span class="ident" id="5189957">reader</span><span class="op" id="5189963">)</span>&nbsp;<span class="ident" id="5189965">cleanupTypes</span><span class="op" id="5189977">(</span><span class="op" id="5189978">)</span>&nbsp;<span class="op" id="5189980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5189983">for</span>&nbsp;<span class="ident" id="5189987">_</span><span class="op" id="5189988">,</span>&nbsp;<span class="ident" id="5189990">t</span>&nbsp;<span class="op" id="5189992">:=</span>&nbsp;<span class="keyword" id="5189995">range</span>&nbsp;<span class="ident" id="5190001">r</span><span class="op" id="5190002">.</span><span class="ident" id="5190003">types</span>&nbsp;<span class="op" id="5190009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190013">visible</span>&nbsp;<span class="op" id="5190021">:=</span>&nbsp;<span class="ident" id="5190024">r</span><span class="op" id="5190025">.</span><span class="ident" id="5190026">isVisible</span><span class="op" id="5190035">(</span><span class="ident" id="5190036">t</span><span class="op" id="5190037">.</span><span class="ident" id="5190038">name</span><span class="op" id="5190042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190046">if</span>&nbsp;<span class="ident" id="5190049">t</span><span class="op" id="5190050">.</span><span class="ident" id="5190051">decl</span>&nbsp;<span class="op" id="5190056">==</span>&nbsp;<span class="ident" id="5190059">nil</span>&nbsp;<span class="op" id="5190063">&amp;&amp;</span>&nbsp;<span class="op" id="5190066">(</span><span class="ident" id="5190067">predeclaredTypes</span><span class="op" id="5190083">[</span><span class="ident" id="5190084">t</span><span class="op" id="5190085">.</span><span class="ident" id="5190086">name</span><span class="op" id="5190090">]</span>&nbsp;<span class="op" id="5190092">||</span>&nbsp;<span class="ident" id="5190095">t</span><span class="op" id="5190096">.</span><span class="ident" id="5190097">isEmbedded</span>&nbsp;<span class="op" id="5190108">&amp;&amp;</span>&nbsp;<span class="ident" id="5190111">visible</span><span class="op" id="5190118">)</span>&nbsp;<span class="op" id="5190120">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190125">//&nbsp;t.name&nbsp;is&nbsp;a&nbsp;predeclared&nbsp;type&nbsp;(and&nbsp;was&nbsp;not&nbsp;redeclared&nbsp;in&nbsp;this&nbsp;package),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190202">//&nbsp;or&nbsp;it&nbsp;was&nbsp;embedded&nbsp;somewhere&nbsp;but&nbsp;its&nbsp;declaration&nbsp;is&nbsp;missing&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190277">//&nbsp;the&nbsp;AST&nbsp;is&nbsp;incomplete):&nbsp;move&nbsp;any&nbsp;associated&nbsp;values,&nbsp;funcs,&nbsp;and&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190354">//&nbsp;back&nbsp;to&nbsp;the&nbsp;top-level&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;lost.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190409">//&nbsp;1)&nbsp;move&nbsp;values</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190430">r</span><span class="op" id="5190431">.</span><span class="ident" id="5190432">values</span>&nbsp;<span class="op" id="5190439">=</span>&nbsp;<span class="builtinfunc" id="5190441">append</span><span class="op" id="5190447">(</span><span class="ident" id="5190448">r</span><span class="op" id="5190449">.</span><span class="ident" id="5190450">values</span><span class="op" id="5190456">,</span>&nbsp;<span class="ident" id="5190458">t</span><span class="op" id="5190459">.</span><span class="ident" id="5190460">values</span><span class="op" id="5190466">...</span><span class="op" id="5190469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190474">//&nbsp;2)&nbsp;move&nbsp;factory&nbsp;functions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190506">for</span>&nbsp;<span class="ident" id="5190510">name</span><span class="op" id="5190514">,</span>&nbsp;<span class="ident" id="5190516">f</span>&nbsp;<span class="op" id="5190518">:=</span>&nbsp;<span class="keyword" id="5190521">range</span>&nbsp;<span class="ident" id="5190527">t</span><span class="op" id="5190528">.</span><span class="ident" id="5190529">funcs</span>&nbsp;<span class="op" id="5190535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190541">//&nbsp;in&nbsp;a&nbsp;correct&nbsp;AST,&nbsp;package-level&nbsp;function&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190595">//&nbsp;are&nbsp;all&nbsp;different&nbsp;-&nbsp;no&nbsp;need&nbsp;to&nbsp;check&nbsp;for&nbsp;conflicts</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190653">r</span><span class="op" id="5190654">.</span><span class="ident" id="5190655">funcs</span><span class="op" id="5190660">[</span><span class="ident" id="5190661">name</span><span class="op" id="5190665">]</span>&nbsp;<span class="op" id="5190667">=</span>&nbsp;<span class="ident" id="5190669">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5190674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190679">//&nbsp;3)&nbsp;move&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190701">for</span>&nbsp;<span class="ident" id="5190705">name</span><span class="op" id="5190709">,</span>&nbsp;<span class="ident" id="5190711">m</span>&nbsp;<span class="op" id="5190713">:=</span>&nbsp;<span class="keyword" id="5190716">range</span>&nbsp;<span class="ident" id="5190722">t</span><span class="op" id="5190723">.</span><span class="ident" id="5190724">methods</span>&nbsp;<span class="op" id="5190732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190738">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;functions&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;-&nbsp;drop&nbsp;them</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190802">if</span>&nbsp;<span class="ident" id="5190805">_</span><span class="op" id="5190806">,</span>&nbsp;<span class="ident" id="5190808">found</span>&nbsp;<span class="op" id="5190814">:=</span>&nbsp;<span class="ident" id="5190817">r</span><span class="op" id="5190818">.</span><span class="ident" id="5190819">funcs</span><span class="op" id="5190824">[</span><span class="ident" id="5190825">name</span><span class="op" id="5190829">]</span><span class="op" id="5190830">;</span>&nbsp;<span class="op" id="5190832">!</span><span class="ident" id="5190833">found</span>&nbsp;<span class="op" id="5190839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5190846">r</span><span class="op" id="5190847">.</span><span class="ident" id="5190848">funcs</span><span class="op" id="5190853">[</span><span class="ident" id="5190854">name</span><span class="op" id="5190858">]</span>&nbsp;<span class="op" id="5190860">=</span>&nbsp;<span class="ident" id="5190862">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5190868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5190873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5190877">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5190881">//&nbsp;remove&nbsp;types&nbsp;w/o&nbsp;declaration&nbsp;or&nbsp;which&nbsp;are&nbsp;not&nbsp;visible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5190940">if</span>&nbsp;<span class="ident" id="5190943">t</span><span class="op" id="5190944">.</span><span class="ident" id="5190945">decl</span>&nbsp;<span class="op" id="5190950">==</span>&nbsp;<span class="ident" id="5190953">nil</span>&nbsp;<span class="op" id="5190957">||</span>&nbsp;<span class="op" id="5190960">!</span><span class="ident" id="5190961">visible</span>&nbsp;<span class="op" id="5190969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5190974">delete</span><span class="op" id="5190980">(</span><span class="ident" id="5190981">r</span><span class="op" id="5190982">.</span><span class="ident" id="5190983">types</span><span class="op" id="5190988">,</span>&nbsp;<span class="ident" id="5190990">t</span><span class="op" id="5190991">.</span><span class="ident" id="5190992">name</span><span class="op" id="5190996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191003">}</span><br>
<span class="lineno">670</span><span class="op" id="5191005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5191008">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="5191088">//&nbsp;Sorting</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="5191100">type</span>&nbsp;<span class="ident" id="5191105">data</span>&nbsp;<span class="keyword" id="5191110">struct</span>&nbsp;<span class="op" id="5191117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191120">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5191125">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191130">swap</span>&nbsp;<span class="keyword" id="5191135">func</span><span class="op" id="5191139">(</span><span class="ident" id="5191140">i</span><span class="op" id="5191141">,</span>&nbsp;<span class="ident" id="5191143">j</span>&nbsp;<span class="builtintype" id="5191145">int</span><span class="op" id="5191148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191151">less</span>&nbsp;<span class="keyword" id="5191156">func</span><span class="op" id="5191160">(</span><span class="ident" id="5191161">i</span><span class="op" id="5191162">,</span>&nbsp;<span class="ident" id="5191164">j</span>&nbsp;<span class="builtintype" id="5191166">int</span><span class="op" id="5191169">)</span>&nbsp;<span class="builtintype" id="5191171">bool</span><br>
<span class="lineno"></span><span class="op" id="5191176">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="5191179">func</span>&nbsp;<span class="op" id="5191184">(</span><span class="ident" id="5191185">d</span>&nbsp;<span class="op" id="5191187">*</span><span class="ident" id="5191188">data</span><span class="op" id="5191192">)</span>&nbsp;<span class="ident" id="5191194">Len</span><span class="op" id="5191197">(</span><span class="op" id="5191198">)</span>&nbsp;<span class="builtintype" id="5191200">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5191214">{</span>&nbsp;<span class="keyword" id="5191216">return</span>&nbsp;<span class="ident" id="5191223">d</span><span class="op" id="5191224">.</span><span class="ident" id="5191225">n</span>&nbsp;<span class="op" id="5191227">}</span><br>
<span class="lineno"></span><span class="keyword" id="5191229">func</span>&nbsp;<span class="op" id="5191234">(</span><span class="ident" id="5191235">d</span>&nbsp;<span class="op" id="5191237">*</span><span class="ident" id="5191238">data</span><span class="op" id="5191242">)</span>&nbsp;<span class="ident" id="5191244">Swap</span><span class="op" id="5191248">(</span><span class="ident" id="5191249">i</span><span class="op" id="5191250">,</span>&nbsp;<span class="ident" id="5191252">j</span>&nbsp;<span class="builtintype" id="5191254">int</span><span class="op" id="5191257">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5191264">{</span>&nbsp;<span class="ident" id="5191266">d</span><span class="op" id="5191267">.</span><span class="ident" id="5191268">swap</span><span class="op" id="5191272">(</span><span class="ident" id="5191273">i</span><span class="op" id="5191274">,</span>&nbsp;<span class="ident" id="5191276">j</span><span class="op" id="5191277">)</span>&nbsp;<span class="op" id="5191279">}</span><br>
<span class="lineno"></span><span class="keyword" id="5191281">func</span>&nbsp;<span class="op" id="5191286">(</span><span class="ident" id="5191287">d</span>&nbsp;<span class="op" id="5191289">*</span><span class="ident" id="5191290">data</span><span class="op" id="5191294">)</span>&nbsp;<span class="ident" id="5191296">Less</span><span class="op" id="5191300">(</span><span class="ident" id="5191301">i</span><span class="op" id="5191302">,</span>&nbsp;<span class="ident" id="5191304">j</span>&nbsp;<span class="builtintype" id="5191306">int</span><span class="op" id="5191309">)</span>&nbsp;<span class="builtintype" id="5191311">bool</span>&nbsp;<span class="op" id="5191316">{</span>&nbsp;<span class="keyword" id="5191318">return</span>&nbsp;<span class="ident" id="5191325">d</span><span class="op" id="5191326">.</span><span class="ident" id="5191327">less</span><span class="op" id="5191331">(</span><span class="ident" id="5191332">i</span><span class="op" id="5191333">,</span>&nbsp;<span class="ident" id="5191335">j</span><span class="op" id="5191336">)</span>&nbsp;<span class="op" id="5191338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="comment" id="5191341">//&nbsp;sortBy&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;sorting</span><br>
<span class="lineno"></span><span class="keyword" id="5191384">func</span>&nbsp;<span class="ident" id="5191389">sortBy</span><span class="op" id="5191395">(</span><span class="ident" id="5191396">less</span>&nbsp;<span class="keyword" id="5191401">func</span><span class="op" id="5191405">(</span><span class="ident" id="5191406">i</span><span class="op" id="5191407">,</span>&nbsp;<span class="ident" id="5191409">j</span>&nbsp;<span class="builtintype" id="5191411">int</span><span class="op" id="5191414">)</span>&nbsp;<span class="builtintype" id="5191416">bool</span><span class="op" id="5191420">,</span>&nbsp;<span class="ident" id="5191422">swap</span>&nbsp;<span class="keyword" id="5191427">func</span><span class="op" id="5191431">(</span><span class="ident" id="5191432">i</span><span class="op" id="5191433">,</span>&nbsp;<span class="ident" id="5191435">j</span>&nbsp;<span class="builtintype" id="5191437">int</span><span class="op" id="5191440">)</span><span class="op" id="5191441">,</span>&nbsp;<span class="ident" id="5191443">n</span>&nbsp;<span class="builtintype" id="5191445">int</span><span class="op" id="5191448">)</span>&nbsp;<span class="op" id="5191450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191453">sort</span><span class="op" id="5191457">.</span><span class="ident" id="5191458">Sort</span><span class="op" id="5191462">(</span><span class="op" id="5191463">&amp;</span><span class="ident" id="5191464">data</span><span class="op" id="5191468">{</span><span class="ident" id="5191469">n</span><span class="op" id="5191470">,</span>&nbsp;<span class="ident" id="5191472">swap</span><span class="op" id="5191476">,</span>&nbsp;<span class="ident" id="5191478">less</span><span class="op" id="5191482">}</span><span class="op" id="5191483">)</span><br>
<span class="lineno"></span><span class="op" id="5191485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="5191488">func</span>&nbsp;<span class="ident" id="5191493">sortedKeys</span><span class="op" id="5191503">(</span><span class="ident" id="5191504">m</span>&nbsp;<span class="keyword" id="5191506">map</span><span class="op" id="5191509">[</span><span class="builtintype" id="5191510">string</span><span class="op" id="5191516">]</span><span class="builtintype" id="5191517">int</span><span class="op" id="5191520">)</span>&nbsp;<span class="op" id="5191522">[</span><span class="op" id="5191523">]</span><span class="builtintype" id="5191524">string</span>&nbsp;<span class="op" id="5191531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191534">list</span>&nbsp;<span class="op" id="5191539">:=</span>&nbsp;<span class="builtinfunc" id="5191542">make</span><span class="op" id="5191546">(</span><span class="op" id="5191547">[</span><span class="op" id="5191548">]</span><span class="builtintype" id="5191549">string</span><span class="op" id="5191555">,</span>&nbsp;<span class="builtinfunc" id="5191557">len</span><span class="op" id="5191560">(</span><span class="ident" id="5191561">m</span><span class="op" id="5191562">)</span><span class="op" id="5191563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191566">i</span>&nbsp;<span class="op" id="5191568">:=</span>&nbsp;<span class="num" id="5191571">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191574">for</span>&nbsp;<span class="ident" id="5191578">key</span>&nbsp;<span class="op" id="5191582">:=</span>&nbsp;<span class="keyword" id="5191585">range</span>&nbsp;<span class="ident" id="5191591">m</span>&nbsp;<span class="op" id="5191593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191597">list</span><span class="op" id="5191601">[</span><span class="ident" id="5191602">i</span><span class="op" id="5191603">]</span>&nbsp;<span class="op" id="5191605">=</span>&nbsp;<span class="ident" id="5191607">key</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191613">i</span><span class="op" id="5191614">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191621">sort</span><span class="op" id="5191625">.</span><span class="ident" id="5191626">Strings</span><span class="op" id="5191633">(</span><span class="ident" id="5191634">list</span><span class="op" id="5191638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191641">return</span>&nbsp;<span class="ident" id="5191648">list</span><br>
<span class="lineno"></span><span class="op" id="5191653">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="comment" id="5191656">//&nbsp;sortingName&nbsp;returns&nbsp;the&nbsp;name&nbsp;to&nbsp;use&nbsp;when&nbsp;sorting&nbsp;d&nbsp;into&nbsp;place.</span><br>
<span class="lineno"></span><span class="comment" id="5191722">//</span><br>
<span class="lineno"></span><span class="keyword" id="5191725">func</span>&nbsp;<span class="ident" id="5191730">sortingName</span><span class="op" id="5191741">(</span><span class="ident" id="5191742">d</span>&nbsp;<span class="op" id="5191744">*</span><span class="ident" id="5191745">ast</span><span class="op" id="5191748">.</span><span class="ident" id="5191749">GenDecl</span><span class="op" id="5191756">)</span>&nbsp;<span class="builtintype" id="5191758">string</span>&nbsp;<span class="op" id="5191765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191768">if</span>&nbsp;<span class="builtinfunc" id="5191771">len</span><span class="op" id="5191774">(</span><span class="ident" id="5191775">d</span><span class="op" id="5191776">.</span><span class="ident" id="5191777">Specs</span><span class="op" id="5191782">)</span>&nbsp;<span class="op" id="5191784">==</span>&nbsp;<span class="num" id="5191787">1</span>&nbsp;<span class="op" id="5191789">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191793">if</span>&nbsp;<span class="ident" id="5191796">s</span><span class="op" id="5191797">,</span>&nbsp;<span class="ident" id="5191799">ok</span>&nbsp;<span class="op" id="5191802">:=</span>&nbsp;<span class="ident" id="5191805">d</span><span class="op" id="5191806">.</span><span class="ident" id="5191807">Specs</span><span class="op" id="5191812">[</span><span class="num" id="5191813">0</span><span class="op" id="5191814">]</span><span class="op" id="5191815">.</span><span class="op" id="5191816">(</span><span class="op" id="5191817">*</span><span class="ident" id="5191818">ast</span><span class="op" id="5191821">.</span><span class="ident" id="5191822">ValueSpec</span><span class="op" id="5191831">)</span><span class="op" id="5191832">;</span>&nbsp;<span class="ident" id="5191834">ok</span>&nbsp;<span class="op" id="5191837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191842">return</span>&nbsp;<span class="ident" id="5191849">s</span><span class="op" id="5191850">.</span><span class="ident" id="5191851">Names</span><span class="op" id="5191856">[</span><span class="num" id="5191857">0</span><span class="op" id="5191858">]</span><span class="op" id="5191859">.</span><span class="ident" id="5191860">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5191870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5191873">return</span>&nbsp;<span class="string" id="5191880">&#34;&#34;</span><br>
<span class="lineno">710</span><span class="op" id="5191883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5191886">func</span>&nbsp;<span class="ident" id="5191891">sortedValues</span><span class="op" id="5191903">(</span><span class="ident" id="5191904">m</span>&nbsp;<span class="op" id="5191906">[</span><span class="op" id="5191907">]</span><span class="op" id="5191908">*</span><span class="ident" id="5191909">Value</span><span class="op" id="5191914">,</span>&nbsp;<span class="ident" id="5191916">tok</span>&nbsp;<span class="ident" id="5191920">token</span><span class="op" id="5191925">.</span><span class="ident" id="5191926">Token</span><span class="op" id="5191931">)</span>&nbsp;<span class="op" id="5191933">[</span><span class="op" id="5191934">]</span><span class="op" id="5191935">*</span><span class="ident" id="5191936">Value</span>&nbsp;<span class="op" id="5191942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5191945">list</span>&nbsp;<span class="op" id="5191950">:=</span>&nbsp;<span class="builtinfunc" id="5191953">make</span><span class="op" id="5191957">(</span><span class="op" id="5191958">[</span><span class="op" id="5191959">]</span><span class="op" id="5191960">*</span><span class="ident" id="5191961">Value</span><span class="op" id="5191966">,</span>&nbsp;<span class="builtinfunc" id="5191968">len</span><span class="op" id="5191971">(</span><span class="ident" id="5191972">m</span><span class="op" id="5191973">)</span><span class="op" id="5191974">)</span>&nbsp;<span class="comment" id="5191976">//&nbsp;big&nbsp;enough&nbsp;in&nbsp;any&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192003">i</span>&nbsp;<span class="op" id="5192005">:=</span>&nbsp;<span class="num" id="5192008">0</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192011">for</span>&nbsp;<span class="ident" id="5192015">_</span><span class="op" id="5192016">,</span>&nbsp;<span class="ident" id="5192018">val</span>&nbsp;<span class="op" id="5192022">:=</span>&nbsp;<span class="keyword" id="5192025">range</span>&nbsp;<span class="ident" id="5192031">m</span>&nbsp;<span class="op" id="5192033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192037">if</span>&nbsp;<span class="ident" id="5192040">val</span><span class="op" id="5192043">.</span><span class="ident" id="5192044">Decl</span><span class="op" id="5192048">.</span><span class="ident" id="5192049">Tok</span>&nbsp;<span class="op" id="5192053">==</span>&nbsp;<span class="ident" id="5192056">tok</span>&nbsp;<span class="op" id="5192060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192065">list</span><span class="op" id="5192069">[</span><span class="ident" id="5192070">i</span><span class="op" id="5192071">]</span>&nbsp;<span class="op" id="5192073">=</span>&nbsp;<span class="ident" id="5192075">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192082">i</span><span class="op" id="5192083">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192088">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192094">list</span>&nbsp;<span class="op" id="5192099">=</span>&nbsp;<span class="ident" id="5192101">list</span><span class="op" id="5192105">[</span><span class="num" id="5192106">0</span><span class="op" id="5192107">:</span><span class="ident" id="5192108">i</span><span class="op" id="5192109">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192113">sortBy</span><span class="op" id="5192119">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192123">func</span><span class="op" id="5192127">(</span><span class="ident" id="5192128">i</span><span class="op" id="5192129">,</span>&nbsp;<span class="ident" id="5192131">j</span>&nbsp;<span class="builtintype" id="5192133">int</span><span class="op" id="5192136">)</span>&nbsp;<span class="builtintype" id="5192138">bool</span>&nbsp;<span class="op" id="5192143">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192148">if</span>&nbsp;<span class="ident" id="5192151">ni</span><span class="op" id="5192153">,</span>&nbsp;<span class="ident" id="5192155">nj</span>&nbsp;<span class="op" id="5192158">:=</span>&nbsp;<span class="ident" id="5192161">sortingName</span><span class="op" id="5192172">(</span><span class="ident" id="5192173">list</span><span class="op" id="5192177">[</span><span class="ident" id="5192178">i</span><span class="op" id="5192179">]</span><span class="op" id="5192180">.</span><span class="ident" id="5192181">Decl</span><span class="op" id="5192185">)</span><span class="op" id="5192186">,</span>&nbsp;<span class="ident" id="5192188">sortingName</span><span class="op" id="5192199">(</span><span class="ident" id="5192200">list</span><span class="op" id="5192204">[</span><span class="ident" id="5192205">j</span><span class="op" id="5192206">]</span><span class="op" id="5192207">.</span><span class="ident" id="5192208">Decl</span><span class="op" id="5192212">)</span><span class="op" id="5192213">;</span>&nbsp;<span class="ident" id="5192215">ni</span>&nbsp;<span class="op" id="5192218">!=</span>&nbsp;<span class="ident" id="5192221">nj</span>&nbsp;<span class="op" id="5192224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192230">return</span>&nbsp;<span class="ident" id="5192237">ni</span>&nbsp;<span class="op" id="5192240">&lt;</span>&nbsp;<span class="ident" id="5192242">nj</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192253">return</span>&nbsp;<span class="ident" id="5192260">list</span><span class="op" id="5192264">[</span><span class="ident" id="5192265">i</span><span class="op" id="5192266">]</span><span class="op" id="5192267">.</span><span class="ident" id="5192268">order</span>&nbsp;<span class="op" id="5192274">&lt;</span>&nbsp;<span class="ident" id="5192276">list</span><span class="op" id="5192280">[</span><span class="ident" id="5192281">j</span><span class="op" id="5192282">]</span><span class="op" id="5192283">.</span><span class="ident" id="5192284">order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192292">}</span><span class="op" id="5192293">,</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192297">func</span><span class="op" id="5192301">(</span><span class="ident" id="5192302">i</span><span class="op" id="5192303">,</span>&nbsp;<span class="ident" id="5192305">j</span>&nbsp;<span class="builtintype" id="5192307">int</span><span class="op" id="5192310">)</span>&nbsp;<span class="op" id="5192312">{</span>&nbsp;<span class="ident" id="5192314">list</span><span class="op" id="5192318">[</span><span class="ident" id="5192319">i</span><span class="op" id="5192320">]</span><span class="op" id="5192321">,</span>&nbsp;<span class="ident" id="5192323">list</span><span class="op" id="5192327">[</span><span class="ident" id="5192328">j</span><span class="op" id="5192329">]</span>&nbsp;<span class="op" id="5192331">=</span>&nbsp;<span class="ident" id="5192333">list</span><span class="op" id="5192337">[</span><span class="ident" id="5192338">j</span><span class="op" id="5192339">]</span><span class="op" id="5192340">,</span>&nbsp;<span class="ident" id="5192342">list</span><span class="op" id="5192346">[</span><span class="ident" id="5192347">i</span><span class="op" id="5192348">]</span>&nbsp;<span class="op" id="5192350">}</span><span class="op" id="5192351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5192355">len</span><span class="op" id="5192358">(</span><span class="ident" id="5192359">list</span><span class="op" id="5192363">)</span><span class="op" id="5192364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192367">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192371">return</span>&nbsp;<span class="ident" id="5192378">list</span><br>
<span class="lineno">735</span><span class="op" id="5192383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5192386">func</span>&nbsp;<span class="ident" id="5192391">sortedTypes</span><span class="op" id="5192402">(</span><span class="ident" id="5192403">m</span>&nbsp;<span class="keyword" id="5192405">map</span><span class="op" id="5192408">[</span><span class="builtintype" id="5192409">string</span><span class="op" id="5192415">]</span><span class="op" id="5192416">*</span><span class="ident" id="5192417">namedType</span><span class="op" id="5192426">,</span>&nbsp;<span class="ident" id="5192428">allMethods</span>&nbsp;<span class="builtintype" id="5192439">bool</span><span class="op" id="5192443">)</span>&nbsp;<span class="op" id="5192445">[</span><span class="op" id="5192446">]</span><span class="op" id="5192447">*</span><span class="ident" id="5192448">Type</span>&nbsp;<span class="op" id="5192453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192456">list</span>&nbsp;<span class="op" id="5192461">:=</span>&nbsp;<span class="builtinfunc" id="5192464">make</span><span class="op" id="5192468">(</span><span class="op" id="5192469">[</span><span class="op" id="5192470">]</span><span class="op" id="5192471">*</span><span class="ident" id="5192472">Type</span><span class="op" id="5192476">,</span>&nbsp;<span class="builtinfunc" id="5192478">len</span><span class="op" id="5192481">(</span><span class="ident" id="5192482">m</span><span class="op" id="5192483">)</span><span class="op" id="5192484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192487">i</span>&nbsp;<span class="op" id="5192489">:=</span>&nbsp;<span class="num" id="5192492">0</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192495">for</span>&nbsp;<span class="ident" id="5192499">_</span><span class="op" id="5192500">,</span>&nbsp;<span class="ident" id="5192502">t</span>&nbsp;<span class="op" id="5192504">:=</span>&nbsp;<span class="keyword" id="5192507">range</span>&nbsp;<span class="ident" id="5192513">m</span>&nbsp;<span class="op" id="5192515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192519">list</span><span class="op" id="5192523">[</span><span class="ident" id="5192524">i</span><span class="op" id="5192525">]</span>&nbsp;<span class="op" id="5192527">=</span>&nbsp;<span class="op" id="5192529">&amp;</span><span class="ident" id="5192530">Type</span><span class="op" id="5192534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192539">Doc</span><span class="op" id="5192542">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192548">t</span><span class="op" id="5192549">.</span><span class="ident" id="5192550">doc</span><span class="op" id="5192553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192558">Name</span><span class="op" id="5192562">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192567">t</span><span class="op" id="5192568">.</span><span class="ident" id="5192569">name</span><span class="op" id="5192573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192578">Decl</span><span class="op" id="5192582">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192587">t</span><span class="op" id="5192588">.</span><span class="ident" id="5192589">decl</span><span class="op" id="5192593">,</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192598">Consts</span><span class="op" id="5192604">:</span>&nbsp;&nbsp;<span class="ident" id="5192607">sortedValues</span><span class="op" id="5192619">(</span><span class="ident" id="5192620">t</span><span class="op" id="5192621">.</span><span class="ident" id="5192622">values</span><span class="op" id="5192628">,</span>&nbsp;<span class="ident" id="5192630">token</span><span class="op" id="5192635">.</span><span class="ident" id="5192636">CONST</span><span class="op" id="5192641">)</span><span class="op" id="5192642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192647">Vars</span><span class="op" id="5192651">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5192656">sortedValues</span><span class="op" id="5192668">(</span><span class="ident" id="5192669">t</span><span class="op" id="5192670">.</span><span class="ident" id="5192671">values</span><span class="op" id="5192677">,</span>&nbsp;<span class="ident" id="5192679">token</span><span class="op" id="5192684">.</span><span class="ident" id="5192685">VAR</span><span class="op" id="5192688">)</span><span class="op" id="5192689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192694">Funcs</span><span class="op" id="5192699">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5192703">sortedFuncs</span><span class="op" id="5192714">(</span><span class="ident" id="5192715">t</span><span class="op" id="5192716">.</span><span class="ident" id="5192717">funcs</span><span class="op" id="5192722">,</span>&nbsp;<span class="builtintype" id="5192724">true</span><span class="op" id="5192728">)</span><span class="op" id="5192729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192734">Methods</span><span class="op" id="5192741">:</span>&nbsp;<span class="ident" id="5192743">sortedFuncs</span><span class="op" id="5192754">(</span><span class="ident" id="5192755">t</span><span class="op" id="5192756">.</span><span class="ident" id="5192757">methods</span><span class="op" id="5192764">,</span>&nbsp;<span class="ident" id="5192766">allMethods</span><span class="op" id="5192776">)</span><span class="op" id="5192777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192781">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192785">i</span><span class="op" id="5192786">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5192794">sortBy</span><span class="op" id="5192800">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192804">func</span><span class="op" id="5192808">(</span><span class="ident" id="5192809">i</span><span class="op" id="5192810">,</span>&nbsp;<span class="ident" id="5192812">j</span>&nbsp;<span class="builtintype" id="5192814">int</span><span class="op" id="5192817">)</span>&nbsp;<span class="builtintype" id="5192819">bool</span>&nbsp;<span class="op" id="5192824">{</span>&nbsp;<span class="keyword" id="5192826">return</span>&nbsp;<span class="ident" id="5192833">list</span><span class="op" id="5192837">[</span><span class="ident" id="5192838">i</span><span class="op" id="5192839">]</span><span class="op" id="5192840">.</span><span class="ident" id="5192841">Name</span>&nbsp;<span class="op" id="5192846">&lt;</span>&nbsp;<span class="ident" id="5192848">list</span><span class="op" id="5192852">[</span><span class="ident" id="5192853">j</span><span class="op" id="5192854">]</span><span class="op" id="5192855">.</span><span class="ident" id="5192856">Name</span>&nbsp;<span class="op" id="5192861">}</span><span class="op" id="5192862">,</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192866">func</span><span class="op" id="5192870">(</span><span class="ident" id="5192871">i</span><span class="op" id="5192872">,</span>&nbsp;<span class="ident" id="5192874">j</span>&nbsp;<span class="builtintype" id="5192876">int</span><span class="op" id="5192879">)</span>&nbsp;<span class="op" id="5192881">{</span>&nbsp;<span class="ident" id="5192883">list</span><span class="op" id="5192887">[</span><span class="ident" id="5192888">i</span><span class="op" id="5192889">]</span><span class="op" id="5192890">,</span>&nbsp;<span class="ident" id="5192892">list</span><span class="op" id="5192896">[</span><span class="ident" id="5192897">j</span><span class="op" id="5192898">]</span>&nbsp;<span class="op" id="5192900">=</span>&nbsp;<span class="ident" id="5192902">list</span><span class="op" id="5192906">[</span><span class="ident" id="5192907">j</span><span class="op" id="5192908">]</span><span class="op" id="5192909">,</span>&nbsp;<span class="ident" id="5192911">list</span><span class="op" id="5192915">[</span><span class="ident" id="5192916">i</span><span class="op" id="5192917">]</span>&nbsp;<span class="op" id="5192919">}</span><span class="op" id="5192920">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5192924">len</span><span class="op" id="5192927">(</span><span class="ident" id="5192928">list</span><span class="op" id="5192932">)</span><span class="op" id="5192933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5192936">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192940">return</span>&nbsp;<span class="ident" id="5192947">list</span><br>
<span class="lineno">760</span><span class="op" id="5192952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5192955">func</span>&nbsp;<span class="ident" id="5192960">removeStar</span><span class="op" id="5192970">(</span><span class="ident" id="5192971">s</span>&nbsp;<span class="builtintype" id="5192973">string</span><span class="op" id="5192979">)</span>&nbsp;<span class="builtintype" id="5192981">string</span>&nbsp;<span class="op" id="5192988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5192991">if</span>&nbsp;<span class="builtinfunc" id="5192994">len</span><span class="op" id="5192997">(</span><span class="ident" id="5192998">s</span><span class="op" id="5192999">)</span>&nbsp;<span class="op" id="5193001">&gt;</span>&nbsp;<span class="num" id="5193003">0</span>&nbsp;<span class="op" id="5193005">&amp;&amp;</span>&nbsp;<span class="ident" id="5193008">s</span><span class="op" id="5193009">[</span><span class="num" id="5193010">0</span><span class="op" id="5193011">]</span>&nbsp;<span class="op" id="5193013">==</span>&nbsp;<span class="string" id="5193016">&#39;*&#39;</span>&nbsp;<span class="op" id="5193020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193024">return</span>&nbsp;<span class="ident" id="5193031">s</span><span class="op" id="5193032">[</span><span class="num" id="5193033">1</span><span class="op" id="5193034">:</span><span class="op" id="5193035">]</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5193038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193041">return</span>&nbsp;<span class="ident" id="5193048">s</span><br>
<span class="lineno"></span><span class="op" id="5193050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5193053">func</span>&nbsp;<span class="ident" id="5193058">sortedFuncs</span><span class="op" id="5193069">(</span><span class="ident" id="5193070">m</span>&nbsp;<span class="ident" id="5193072">methodSet</span><span class="op" id="5193081">,</span>&nbsp;<span class="ident" id="5193083">allMethods</span>&nbsp;<span class="builtintype" id="5193094">bool</span><span class="op" id="5193098">)</span>&nbsp;<span class="op" id="5193100">[</span><span class="op" id="5193101">]</span><span class="op" id="5193102">*</span><span class="ident" id="5193103">Func</span>&nbsp;<span class="op" id="5193108">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193111">list</span>&nbsp;<span class="op" id="5193116">:=</span>&nbsp;<span class="builtinfunc" id="5193119">make</span><span class="op" id="5193123">(</span><span class="op" id="5193124">[</span><span class="op" id="5193125">]</span><span class="op" id="5193126">*</span><span class="ident" id="5193127">Func</span><span class="op" id="5193131">,</span>&nbsp;<span class="builtinfunc" id="5193133">len</span><span class="op" id="5193136">(</span><span class="ident" id="5193137">m</span><span class="op" id="5193138">)</span><span class="op" id="5193139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193142">i</span>&nbsp;<span class="op" id="5193144">:=</span>&nbsp;<span class="num" id="5193147">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193150">for</span>&nbsp;<span class="ident" id="5193154">_</span><span class="op" id="5193155">,</span>&nbsp;<span class="ident" id="5193157">m</span>&nbsp;<span class="op" id="5193159">:=</span>&nbsp;<span class="keyword" id="5193162">range</span>&nbsp;<span class="ident" id="5193168">m</span>&nbsp;<span class="op" id="5193170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5193174">//&nbsp;determine&nbsp;which&nbsp;methods&nbsp;to&nbsp;include</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193214">switch</span>&nbsp;<span class="op" id="5193221">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193225">case</span>&nbsp;<span class="ident" id="5193230">m</span><span class="op" id="5193231">.</span><span class="ident" id="5193232">Decl</span>&nbsp;<span class="op" id="5193237">==</span>&nbsp;<span class="ident" id="5193240">nil</span><span class="op" id="5193243">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5193248">//&nbsp;exclude&nbsp;conflict&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193276">case</span>&nbsp;<span class="ident" id="5193281">allMethods</span><span class="op" id="5193291">,</span>&nbsp;<span class="ident" id="5193293">m</span><span class="op" id="5193294">.</span><span class="ident" id="5193295">Level</span>&nbsp;<span class="op" id="5193301">==</span>&nbsp;<span class="num" id="5193304">0</span><span class="op" id="5193305">,</span>&nbsp;<span class="op" id="5193307">!</span><span class="ident" id="5193308">ast</span><span class="op" id="5193311">.</span><span class="ident" id="5193312">IsExported</span><span class="op" id="5193322">(</span><span class="ident" id="5193323">removeStar</span><span class="op" id="5193333">(</span><span class="ident" id="5193334">m</span><span class="op" id="5193335">.</span><span class="ident" id="5193336">Orig</span><span class="op" id="5193340">)</span><span class="op" id="5193341">)</span><span class="op" id="5193342">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5193347">//&nbsp;forced&nbsp;inclusion,&nbsp;method&nbsp;not&nbsp;embedded,&nbsp;or&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5193402">//&nbsp;embedded&nbsp;but&nbsp;original&nbsp;receiver&nbsp;type&nbsp;not&nbsp;exported</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193457">list</span><span class="op" id="5193461">[</span><span class="ident" id="5193462">i</span><span class="op" id="5193463">]</span>&nbsp;<span class="op" id="5193465">=</span>&nbsp;<span class="ident" id="5193467">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193472">i</span><span class="op" id="5193473">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5193478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5193481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193484">list</span>&nbsp;<span class="op" id="5193489">=</span>&nbsp;<span class="ident" id="5193491">list</span><span class="op" id="5193495">[</span><span class="num" id="5193496">0</span><span class="op" id="5193497">:</span><span class="ident" id="5193498">i</span><span class="op" id="5193499">]</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193502">sortBy</span><span class="op" id="5193508">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193512">func</span><span class="op" id="5193516">(</span><span class="ident" id="5193517">i</span><span class="op" id="5193518">,</span>&nbsp;<span class="ident" id="5193520">j</span>&nbsp;<span class="builtintype" id="5193522">int</span><span class="op" id="5193525">)</span>&nbsp;<span class="builtintype" id="5193527">bool</span>&nbsp;<span class="op" id="5193532">{</span>&nbsp;<span class="keyword" id="5193534">return</span>&nbsp;<span class="ident" id="5193541">list</span><span class="op" id="5193545">[</span><span class="ident" id="5193546">i</span><span class="op" id="5193547">]</span><span class="op" id="5193548">.</span><span class="ident" id="5193549">Name</span>&nbsp;<span class="op" id="5193554">&lt;</span>&nbsp;<span class="ident" id="5193556">list</span><span class="op" id="5193560">[</span><span class="ident" id="5193561">j</span><span class="op" id="5193562">]</span><span class="op" id="5193563">.</span><span class="ident" id="5193564">Name</span>&nbsp;<span class="op" id="5193569">}</span><span class="op" id="5193570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193574">func</span><span class="op" id="5193578">(</span><span class="ident" id="5193579">i</span><span class="op" id="5193580">,</span>&nbsp;<span class="ident" id="5193582">j</span>&nbsp;<span class="builtintype" id="5193584">int</span><span class="op" id="5193587">)</span>&nbsp;<span class="op" id="5193589">{</span>&nbsp;<span class="ident" id="5193591">list</span><span class="op" id="5193595">[</span><span class="ident" id="5193596">i</span><span class="op" id="5193597">]</span><span class="op" id="5193598">,</span>&nbsp;<span class="ident" id="5193600">list</span><span class="op" id="5193604">[</span><span class="ident" id="5193605">j</span><span class="op" id="5193606">]</span>&nbsp;<span class="op" id="5193608">=</span>&nbsp;<span class="ident" id="5193610">list</span><span class="op" id="5193614">[</span><span class="ident" id="5193615">j</span><span class="op" id="5193616">]</span><span class="op" id="5193617">,</span>&nbsp;<span class="ident" id="5193619">list</span><span class="op" id="5193623">[</span><span class="ident" id="5193624">i</span><span class="op" id="5193625">]</span>&nbsp;<span class="op" id="5193627">}</span><span class="op" id="5193628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5193632">len</span><span class="op" id="5193635">(</span><span class="ident" id="5193636">list</span><span class="op" id="5193640">)</span><span class="op" id="5193641">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5193644">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193647">return</span>&nbsp;<span class="ident" id="5193654">list</span><br>
<span class="lineno"></span><span class="op" id="5193659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5193662">//&nbsp;noteBodies&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;note&nbsp;body&nbsp;strings&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;notes.</span><br>
<span class="lineno"></span><span class="comment" id="5193735">//&nbsp;This&nbsp;is&nbsp;only&nbsp;used&nbsp;to&nbsp;populate&nbsp;the&nbsp;deprecated&nbsp;Package.Bugs&nbsp;field.</span><br>
<span class="lineno">795</span><span class="comment" id="5193803">//</span><br>
<span class="lineno"></span><span class="keyword" id="5193806">func</span>&nbsp;<span class="ident" id="5193811">noteBodies</span><span class="op" id="5193821">(</span><span class="ident" id="5193822">notes</span>&nbsp;<span class="op" id="5193828">[</span><span class="op" id="5193829">]</span><span class="op" id="5193830">*</span><span class="ident" id="5193831">Note</span><span class="op" id="5193835">)</span>&nbsp;<span class="op" id="5193837">[</span><span class="op" id="5193838">]</span><span class="builtintype" id="5193839">string</span>&nbsp;<span class="op" id="5193846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193849">var</span>&nbsp;<span class="ident" id="5193853">list</span>&nbsp;<span class="op" id="5193858">[</span><span class="op" id="5193859">]</span><span class="builtintype" id="5193860">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193868">for</span>&nbsp;<span class="ident" id="5193872">_</span><span class="op" id="5193873">,</span>&nbsp;<span class="ident" id="5193875">n</span>&nbsp;<span class="op" id="5193877">:=</span>&nbsp;<span class="keyword" id="5193880">range</span>&nbsp;<span class="ident" id="5193886">notes</span>&nbsp;<span class="op" id="5193892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5193896">list</span>&nbsp;<span class="op" id="5193901">=</span>&nbsp;<span class="builtinfunc" id="5193903">append</span><span class="op" id="5193909">(</span><span class="ident" id="5193910">list</span><span class="op" id="5193914">,</span>&nbsp;<span class="ident" id="5193916">n</span><span class="op" id="5193917">.</span><span class="ident" id="5193918">Body</span><span class="op" id="5193922">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5193925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5193928">return</span>&nbsp;<span class="ident" id="5193935">list</span><br>
<span class="lineno"></span><span class="op" id="5193940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5193943">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">805</span><span class="comment" id="5194023">//&nbsp;Predeclared&nbsp;identifiers</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5194051">var</span>&nbsp;<span class="ident" id="5194055">predeclaredTypes</span>&nbsp;<span class="op" id="5194072">=</span>&nbsp;<span class="keyword" id="5194074">map</span><span class="op" id="5194077">[</span><span class="builtintype" id="5194078">string</span><span class="op" id="5194084">]</span><span class="builtintype" id="5194085">bool</span><span class="op" id="5194089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194092">&#34;bool&#34;</span><span class="op" id="5194098">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194106">true</span><span class="op" id="5194110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194113">&#34;byte&#34;</span><span class="op" id="5194119">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194127">true</span><span class="op" id="5194131">,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194134">&#34;complex64&#34;</span><span class="op" id="5194145">:</span>&nbsp;&nbsp;<span class="builtintype" id="5194148">true</span><span class="op" id="5194152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194155">&#34;complex128&#34;</span><span class="op" id="5194167">:</span>&nbsp;<span class="builtintype" id="5194169">true</span><span class="op" id="5194173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194176">&#34;error&#34;</span><span class="op" id="5194183">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194190">true</span><span class="op" id="5194194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194197">&#34;float32&#34;</span><span class="op" id="5194206">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194211">true</span><span class="op" id="5194215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194218">&#34;float64&#34;</span><span class="op" id="5194227">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194232">true</span><span class="op" id="5194236">,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194239">&#34;int&#34;</span><span class="op" id="5194244">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194253">true</span><span class="op" id="5194257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194260">&#34;int8&#34;</span><span class="op" id="5194266">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194274">true</span><span class="op" id="5194278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194281">&#34;int16&#34;</span><span class="op" id="5194288">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194295">true</span><span class="op" id="5194299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194302">&#34;int32&#34;</span><span class="op" id="5194309">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194316">true</span><span class="op" id="5194320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194323">&#34;int64&#34;</span><span class="op" id="5194330">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194337">true</span><span class="op" id="5194341">,</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194344">&#34;rune&#34;</span><span class="op" id="5194350">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194358">true</span><span class="op" id="5194362">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194365">&#34;string&#34;</span><span class="op" id="5194373">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194379">true</span><span class="op" id="5194383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194386">&#34;uint&#34;</span><span class="op" id="5194392">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194400">true</span><span class="op" id="5194404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194407">&#34;uint8&#34;</span><span class="op" id="5194414">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194421">true</span><span class="op" id="5194425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194428">&#34;uint16&#34;</span><span class="op" id="5194436">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194442">true</span><span class="op" id="5194446">,</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194449">&#34;uint32&#34;</span><span class="op" id="5194457">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194463">true</span><span class="op" id="5194467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194470">&#34;uint64&#34;</span><span class="op" id="5194478">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194484">true</span><span class="op" id="5194488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194491">&#34;uintptr&#34;</span><span class="op" id="5194500">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194505">true</span><span class="op" id="5194509">,</span><br>
<span class="lineno"></span><span class="op" id="5194511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span><span class="keyword" id="5194514">var</span>&nbsp;<span class="ident" id="5194518">predeclaredFuncs</span>&nbsp;<span class="op" id="5194535">=</span>&nbsp;<span class="keyword" id="5194537">map</span><span class="op" id="5194540">[</span><span class="builtintype" id="5194541">string</span><span class="op" id="5194547">]</span><span class="builtintype" id="5194548">bool</span><span class="op" id="5194552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194555">&#34;append&#34;</span><span class="op" id="5194563">:</span>&nbsp;&nbsp;<span class="builtintype" id="5194566">true</span><span class="op" id="5194570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194573">&#34;cap&#34;</span><span class="op" id="5194578">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194584">true</span><span class="op" id="5194588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194591">&#34;close&#34;</span><span class="op" id="5194598">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194602">true</span><span class="op" id="5194606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194609">&#34;complex&#34;</span><span class="op" id="5194618">:</span>&nbsp;<span class="builtintype" id="5194620">true</span><span class="op" id="5194624">,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194627">&#34;copy&#34;</span><span class="op" id="5194633">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194638">true</span><span class="op" id="5194642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194645">&#34;delete&#34;</span><span class="op" id="5194653">:</span>&nbsp;&nbsp;<span class="builtintype" id="5194656">true</span><span class="op" id="5194660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194663">&#34;imag&#34;</span><span class="op" id="5194669">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194674">true</span><span class="op" id="5194678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194681">&#34;len&#34;</span><span class="op" id="5194686">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194692">true</span><span class="op" id="5194696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194699">&#34;make&#34;</span><span class="op" id="5194705">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194710">true</span><span class="op" id="5194714">,</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194717">&#34;new&#34;</span><span class="op" id="5194722">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194728">true</span><span class="op" id="5194732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194735">&#34;panic&#34;</span><span class="op" id="5194742">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194746">true</span><span class="op" id="5194750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194753">&#34;print&#34;</span><span class="op" id="5194760">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194764">true</span><span class="op" id="5194768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194771">&#34;println&#34;</span><span class="op" id="5194780">:</span>&nbsp;<span class="builtintype" id="5194782">true</span><span class="op" id="5194786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194789">&#34;real&#34;</span><span class="op" id="5194795">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194800">true</span><span class="op" id="5194804">,</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194807">&#34;recover&#34;</span><span class="op" id="5194816">:</span>&nbsp;<span class="builtintype" id="5194818">true</span><span class="op" id="5194822">,</span><br>
<span class="lineno"></span><span class="op" id="5194824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5194827">var</span>&nbsp;<span class="ident" id="5194831">predeclaredConstants</span>&nbsp;<span class="op" id="5194852">=</span>&nbsp;<span class="keyword" id="5194854">map</span><span class="op" id="5194857">[</span><span class="builtintype" id="5194858">string</span><span class="op" id="5194864">]</span><span class="builtintype" id="5194865">bool</span><span class="op" id="5194869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194872">&#34;false&#34;</span><span class="op" id="5194879">:</span>&nbsp;<span class="builtintype" id="5194881">true</span><span class="op" id="5194885">,</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194888">&#34;iota&#34;</span><span class="op" id="5194894">:</span>&nbsp;&nbsp;<span class="builtintype" id="5194897">true</span><span class="op" id="5194901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194904">&#34;nil&#34;</span><span class="op" id="5194909">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5194913">true</span><span class="op" id="5194917">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5194920">&#34;true&#34;</span><span class="op" id="5194926">:</span>&nbsp;&nbsp;<span class="builtintype" id="5194929">true</span><span class="op" id="5194933">,</span><br>
<span class="lineno"></span><span class="op" id="5194935">}</span>
</div>
</body>
</html>
