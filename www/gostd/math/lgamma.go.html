<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1605445">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1605500">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1605554">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1605605">package</span>&nbsp;<span class="ident" id="1605613">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1605619">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1605675">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1605729">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1605786">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1605841">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1605871">//</span><br>
<span class="lineno"></span><span class="comment" id="1605874">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1605930">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1605999">//</span><br>
<span class="lineno"></span><span class="comment" id="1606002">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1606061">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1606117">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1606174">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1606191">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1606247">//</span><br>
<span class="lineno">25</span><span class="comment" id="1606250">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="1606285">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="1606345">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="1606401">//</span><br>
<span class="lineno"></span><span class="comment" id="1606404">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="1606415">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="1606457">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="1606517">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1606562">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="1606611">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="1606632">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="1606685">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="1606742">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="1606811">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="1606865">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="1606935">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="1607000">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="1607032">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="1607100">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="1607151">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="1607212">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="1607256">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="1607283">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="1607331">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="1607353">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="1607406">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="1607468">//</span><br>
<span class="lineno"></span><span class="comment" id="1607471">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="1607535">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="1607605">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="1607660">//</span><br>
<span class="lineno"></span><span class="comment" id="1607663">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="1607730">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="1607760">//</span><br>
<span class="lineno"></span><span class="comment" id="1607763">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="1607789">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="1607861">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="1607886">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="1607949">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="1607992">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="1608045">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1608056">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="1608117">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="1608176">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1608190">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="1608229">//</span><br>
<span class="lineno"></span><span class="comment" id="1608232">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="1608284">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="1608330">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="1608346">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="1608395">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="1608465">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1608519">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="1608563">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="1608629">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="1608694">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="1608737">//</span><br>
<span class="lineno"></span><span class="comment" id="1608740">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="1608762">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="1608815">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="1608853">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="1608900">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="1608946">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="1608987">//</span><br>
<span class="lineno"></span><span class="comment" id="1608990">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="1608994">var</span>&nbsp;<span class="ident" id="1608998">_lgamA</span>&nbsp;<span class="op" id="1609005">=</span>&nbsp;<span class="op" id="1609007">[</span><span class="op" id="1609008">...</span><span class="op" id="1609011">]</span><span class="builtintype" id="1609012">float64</span><span class="op" id="1609019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609022">7.72156649015328655494e-02</span><span class="op" id="1609048">,</span>&nbsp;<span class="comment" id="1609050">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609073">3.22467033424113591611e-01</span><span class="op" id="1609099">,</span>&nbsp;<span class="comment" id="1609101">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609124">6.73523010531292681824e-02</span><span class="op" id="1609150">,</span>&nbsp;<span class="comment" id="1609152">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609175">2.05808084325167332806e-02</span><span class="op" id="1609201">,</span>&nbsp;<span class="comment" id="1609203">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609226">7.38555086081402883957e-03</span><span class="op" id="1609252">,</span>&nbsp;<span class="comment" id="1609254">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609277">2.89051383673415629091e-03</span><span class="op" id="1609303">,</span>&nbsp;<span class="comment" id="1609305">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609328">1.19270763183362067845e-03</span><span class="op" id="1609354">,</span>&nbsp;<span class="comment" id="1609356">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609379">5.10069792153511336608e-04</span><span class="op" id="1609405">,</span>&nbsp;<span class="comment" id="1609407">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609430">2.20862790713908385557e-04</span><span class="op" id="1609456">,</span>&nbsp;<span class="comment" id="1609458">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609481">1.08011567247583939954e-04</span><span class="op" id="1609507">,</span>&nbsp;<span class="comment" id="1609509">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609532">2.52144565451257326939e-05</span><span class="op" id="1609558">,</span>&nbsp;<span class="comment" id="1609560">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609583">4.48640949618915160150e-05</span><span class="op" id="1609609">,</span>&nbsp;<span class="comment" id="1609611">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="1609633">}</span><br>
<span class="lineno">105</span><span class="keyword" id="1609635">var</span>&nbsp;<span class="ident" id="1609639">_lgamR</span>&nbsp;<span class="op" id="1609646">=</span>&nbsp;<span class="op" id="1609648">[</span><span class="op" id="1609649">...</span><span class="op" id="1609652">]</span><span class="builtintype" id="1609653">float64</span><span class="op" id="1609660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609663">1.0</span><span class="op" id="1609666">,</span>&nbsp;<span class="comment" id="1609668">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609684">1.39200533467621045958e+00</span><span class="op" id="1609710">,</span>&nbsp;<span class="comment" id="1609712">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609735">7.21935547567138069525e-01</span><span class="op" id="1609761">,</span>&nbsp;<span class="comment" id="1609763">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609786">1.71933865632803078993e-01</span><span class="op" id="1609812">,</span>&nbsp;<span class="comment" id="1609814">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609837">1.86459191715652901344e-02</span><span class="op" id="1609863">,</span>&nbsp;<span class="comment" id="1609865">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609888">7.77942496381893596434e-04</span><span class="op" id="1609914">,</span>&nbsp;<span class="comment" id="1609916">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1609939">7.32668430744625636189e-06</span><span class="op" id="1609965">,</span>&nbsp;<span class="comment" id="1609967">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="1609989">}</span><br>
<span class="lineno"></span><span class="keyword" id="1609991">var</span>&nbsp;<span class="ident" id="1609995">_lgamS</span>&nbsp;<span class="op" id="1610002">=</span>&nbsp;<span class="op" id="1610004">[</span><span class="op" id="1610005">...</span><span class="op" id="1610008">]</span><span class="builtintype" id="1610009">float64</span><span class="op" id="1610016">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1610019">-</span><span class="num" id="1610020">7.72156649015328655494e-02</span><span class="op" id="1610046">,</span>&nbsp;<span class="comment" id="1610048">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1610071">2.14982415960608852501e-01</span><span class="op" id="1610097">,</span>&nbsp;&nbsp;<span class="comment" id="1610100">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1610123">3.25778796408930981787e-01</span><span class="op" id="1610149">,</span>&nbsp;&nbsp;<span class="comment" id="1610152">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1610175">1.46350472652464452805e-01</span><span class="op" id="1610201">,</span>&nbsp;&nbsp;<span class="comment" id="1610204">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1610227">2.66422703033638609560e-02</span><span class="op" id="1610253">,</span>&nbsp;&nbsp;<span class="comment" id="1610256">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1610279">1.84028451407337715652e-03</span><span class="op" id="1610305">,</span>&nbsp;&nbsp;<span class="comment" id="1610308">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1610331">3.19475326584100867617e-05</span><span class="op" id="1610357">,</span>&nbsp;&nbsp;<span class="comment" id="1610360">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="1610382">}</span><br>
<span class="lineno"></span><span class="keyword" id="1610384">var</span>&nbsp;<span class="ident" id="1610388">_lgamT</span>&nbsp;<span class="op" id="1610395">=</span>&nbsp;<span class="op" id="1610397">[</span><span class="op" id="1610398">...</span><span class="op" id="1610401">]</span><span class="builtintype" id="1610402">float64</span><span class="op" id="1610409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1610412">4.83836122723810047042e-01</span><span class="op" id="1610438">,</span>&nbsp;&nbsp;<span class="comment" id="1610441">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1610464">-</span><span class="num" id="1610465">1.47587722994593911752e-01</span><span class="op" id="1610491">,</span>&nbsp;<span class="comment" id="1610493">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1610516">6.46249402391333854778e-02</span><span class="op" id="1610542">,</span>&nbsp;&nbsp;<span class="comment" id="1610545">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1610568">-</span><span class="num" id="1610569">3.27885410759859649565e-02</span><span class="op" id="1610595">,</span>&nbsp;<span class="comment" id="1610597">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1610620">1.79706750811820387126e-02</span><span class="op" id="1610646">,</span>&nbsp;&nbsp;<span class="comment" id="1610649">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1610672">-</span><span class="num" id="1610673">1.03142241298341437450e-02</span><span class="op" id="1610699">,</span>&nbsp;<span class="comment" id="1610701">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1610724">6.10053870246291332635e-03</span><span class="op" id="1610750">,</span>&nbsp;&nbsp;<span class="comment" id="1610753">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1610776">-</span><span class="num" id="1610777">3.68452016781138256760e-03</span><span class="op" id="1610803">,</span>&nbsp;<span class="comment" id="1610805">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1610828">2.25964780900612472250e-03</span><span class="op" id="1610854">,</span>&nbsp;&nbsp;<span class="comment" id="1610857">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1610880">-</span><span class="num" id="1610881">1.40346469989232843813e-03</span><span class="op" id="1610907">,</span>&nbsp;<span class="comment" id="1610909">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1610932">8.81081882437654011382e-04</span><span class="op" id="1610958">,</span>&nbsp;&nbsp;<span class="comment" id="1610961">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1610984">-</span><span class="num" id="1610985">5.38595305356740546715e-04</span><span class="op" id="1611011">,</span>&nbsp;<span class="comment" id="1611013">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611036">3.15632070903625950361e-04</span><span class="op" id="1611062">,</span>&nbsp;&nbsp;<span class="comment" id="1611065">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611088">-</span><span class="num" id="1611089">3.12754168375120860518e-04</span><span class="op" id="1611115">,</span>&nbsp;<span class="comment" id="1611117">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611140">3.35529192635519073543e-04</span><span class="op" id="1611166">,</span>&nbsp;&nbsp;<span class="comment" id="1611169">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="1611191">}</span><br>
<span class="lineno">140</span><span class="keyword" id="1611193">var</span>&nbsp;<span class="ident" id="1611197">_lgamU</span>&nbsp;<span class="op" id="1611204">=</span>&nbsp;<span class="op" id="1611206">[</span><span class="op" id="1611207">...</span><span class="op" id="1611210">]</span><span class="builtintype" id="1611211">float64</span><span class="op" id="1611218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611221">-</span><span class="num" id="1611222">7.72156649015328655494e-02</span><span class="op" id="1611248">,</span>&nbsp;<span class="comment" id="1611250">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611273">6.32827064025093366517e-01</span><span class="op" id="1611299">,</span>&nbsp;&nbsp;<span class="comment" id="1611302">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611325">1.45492250137234768737e+00</span><span class="op" id="1611351">,</span>&nbsp;&nbsp;<span class="comment" id="1611354">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611377">9.77717527963372745603e-01</span><span class="op" id="1611403">,</span>&nbsp;&nbsp;<span class="comment" id="1611406">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611429">2.28963728064692451092e-01</span><span class="op" id="1611455">,</span>&nbsp;&nbsp;<span class="comment" id="1611458">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611481">1.33810918536787660377e-02</span><span class="op" id="1611507">,</span>&nbsp;&nbsp;<span class="comment" id="1611510">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="1611532">}</span><br>
<span class="lineno"></span><span class="keyword" id="1611534">var</span>&nbsp;<span class="ident" id="1611538">_lgamV</span>&nbsp;<span class="op" id="1611545">=</span>&nbsp;<span class="op" id="1611547">[</span><span class="op" id="1611548">...</span><span class="op" id="1611551">]</span><span class="builtintype" id="1611552">float64</span><span class="op" id="1611559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611562">1.0</span><span class="op" id="1611565">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611568">2.45597793713041134822e+00</span><span class="op" id="1611594">,</span>&nbsp;<span class="comment" id="1611596">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611619">2.12848976379893395361e+00</span><span class="op" id="1611645">,</span>&nbsp;<span class="comment" id="1611647">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611670">7.69285150456672783825e-01</span><span class="op" id="1611696">,</span>&nbsp;<span class="comment" id="1611698">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611721">1.04222645593369134254e-01</span><span class="op" id="1611747">,</span>&nbsp;<span class="comment" id="1611749">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611772">3.21709242282423911810e-03</span><span class="op" id="1611798">,</span>&nbsp;<span class="comment" id="1611800">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="1611822">}</span><br>
<span class="lineno"></span><span class="keyword" id="1611824">var</span>&nbsp;<span class="ident" id="1611828">_lgamW</span>&nbsp;<span class="op" id="1611835">=</span>&nbsp;<span class="op" id="1611837">[</span><span class="op" id="1611838">...</span><span class="op" id="1611841">]</span><span class="builtintype" id="1611842">float64</span><span class="op" id="1611849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611852">4.18938533204672725052e-01</span><span class="op" id="1611878">,</span>&nbsp;&nbsp;<span class="comment" id="1611881">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1611904">8.33333333333329678849e-02</span><span class="op" id="1611930">,</span>&nbsp;&nbsp;<span class="comment" id="1611933">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1611956">-</span><span class="num" id="1611957">2.77777777728775536470e-03</span><span class="op" id="1611983">,</span>&nbsp;<span class="comment" id="1611985">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1612008">7.93650558643019558500e-04</span><span class="op" id="1612034">,</span>&nbsp;&nbsp;<span class="comment" id="1612037">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1612060">-</span><span class="num" id="1612061">5.95187557450339963135e-04</span><span class="op" id="1612087">,</span>&nbsp;<span class="comment" id="1612089">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1612112">8.36339918996282139126e-04</span><span class="op" id="1612138">,</span>&nbsp;&nbsp;<span class="comment" id="1612141">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1612164">-</span><span class="num" id="1612165">1.63092934096575273989e-03</span><span class="op" id="1612191">,</span>&nbsp;<span class="comment" id="1612193">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="1612215">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="1612218">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="1612291">//</span><br>
<span class="lineno"></span><span class="comment" id="1612294">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1612316">//&nbsp;&nbsp;&nbsp;&nbspLgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="1612339">//&nbsp;&nbsp;&nbsp;&nbspLgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1612359">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1612386">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="1612409">//&nbsp;&nbsp;&nbsp;&nbspLgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1612430">func</span>&nbsp;<span class="ident" id="1612435">Lgamma</span><span class="op" id="1612441">(</span><span class="ident" id="1612442">x</span>&nbsp;<span class="builtintype" id="1612444">float64</span><span class="op" id="1612451">)</span>&nbsp;<span class="op" id="1612453">(</span><span class="ident" id="1612454">lgamma</span>&nbsp;<span class="builtintype" id="1612461">float64</span><span class="op" id="1612468">,</span>&nbsp;<span class="ident" id="1612470">sign</span>&nbsp;<span class="builtintype" id="1612475">int</span><span class="op" id="1612478">)</span>&nbsp;<span class="op" id="1612480">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1612483">const</span>&nbsp;<span class="op" id="1612489">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612493">Ymin</span>&nbsp;&nbsp;<span class="op" id="1612499">=</span>&nbsp;<span class="num" id="1612501">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612524">Two52</span>&nbsp;<span class="op" id="1612530">=</span>&nbsp;<span class="num" id="1612532">1</span>&nbsp;<span class="op" id="1612534">&lt;&lt;</span>&nbsp;<span class="num" id="1612537">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1612560">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612596">Two53</span>&nbsp;<span class="op" id="1612602">=</span>&nbsp;<span class="num" id="1612604">1</span>&nbsp;<span class="op" id="1612606">&lt;&lt;</span>&nbsp;<span class="num" id="1612609">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1612632">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612668">Two58</span>&nbsp;<span class="op" id="1612674">=</span>&nbsp;<span class="num" id="1612676">1</span>&nbsp;<span class="op" id="1612678">&lt;&lt;</span>&nbsp;<span class="num" id="1612681">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1612704">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612740">Tiny</span>&nbsp;&nbsp;<span class="op" id="1612746">=</span>&nbsp;<span class="num" id="1612748">1.0</span>&nbsp;<span class="op" id="1612752">/</span>&nbsp;<span class="op" id="1612754">(</span><span class="num" id="1612755">1</span>&nbsp;<span class="op" id="1612757">&lt;&lt;</span>&nbsp;<span class="num" id="1612760">70</span><span class="op" id="1612762">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1612776">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612813">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1612819">=</span>&nbsp;<span class="num" id="1612821">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="1612849">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612873">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1612879">=</span>&nbsp;<span class="op" id="1612881">-</span><span class="num" id="1612882">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="1612909">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1612933">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1612957">Tt</span>&nbsp;<span class="op" id="1612960">=</span>&nbsp;<span class="op" id="1612962">-</span><span class="num" id="1612963">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="1612990">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1613016">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613034">sign</span>&nbsp;<span class="op" id="1613039">=</span>&nbsp;<span class="num" id="1613041">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613044">switch</span>&nbsp;<span class="op" id="1613051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613054">case</span>&nbsp;<span class="ident" id="1613059">IsNaN</span><span class="op" id="1613064">(</span><span class="ident" id="1613065">x</span><span class="op" id="1613066">)</span><span class="op" id="1613067">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613071">lgamma</span>&nbsp;<span class="op" id="1613078">=</span>&nbsp;<span class="ident" id="1613080">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613084">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613092">case</span>&nbsp;<span class="ident" id="1613097">IsInf</span><span class="op" id="1613102">(</span><span class="ident" id="1613103">x</span><span class="op" id="1613104">,</span>&nbsp;<span class="num" id="1613106">0</span><span class="op" id="1613107">)</span><span class="op" id="1613108">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613112">lgamma</span>&nbsp;<span class="op" id="1613119">=</span>&nbsp;<span class="ident" id="1613121">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613125">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613133">case</span>&nbsp;<span class="ident" id="1613138">x</span>&nbsp;<span class="op" id="1613140">==</span>&nbsp;<span class="num" id="1613143">0</span><span class="op" id="1613144">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613148">lgamma</span>&nbsp;<span class="op" id="1613155">=</span>&nbsp;<span class="ident" id="1613157">Inf</span><span class="op" id="1613160">(</span><span class="num" id="1613161">1</span><span class="op" id="1613162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613166">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613178">neg</span>&nbsp;<span class="op" id="1613182">:=</span>&nbsp;<span class="builtintype" id="1613185">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613192">if</span>&nbsp;<span class="ident" id="1613195">x</span>&nbsp;<span class="op" id="1613197">&lt;</span>&nbsp;<span class="num" id="1613199">0</span>&nbsp;<span class="op" id="1613201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613205">x</span>&nbsp;<span class="op" id="1613207">=</span>&nbsp;<span class="op" id="1613209">-</span><span class="ident" id="1613210">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613214">neg</span>&nbsp;<span class="op" id="1613218">=</span>&nbsp;<span class="builtintype" id="1613220">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613226">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613230">if</span>&nbsp;<span class="ident" id="1613233">x</span>&nbsp;<span class="op" id="1613235">&lt;</span>&nbsp;<span class="ident" id="1613237">Tiny</span>&nbsp;<span class="op" id="1613242">{</span>&nbsp;<span class="comment" id="1613244">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613283">if</span>&nbsp;<span class="ident" id="1613286">neg</span>&nbsp;<span class="op" id="1613290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613295">sign</span>&nbsp;<span class="op" id="1613300">=</span>&nbsp;<span class="op" id="1613302">-</span><span class="num" id="1613303">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613307">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613311">lgamma</span>&nbsp;<span class="op" id="1613318">=</span>&nbsp;<span class="op" id="1613320">-</span><span class="ident" id="1613321">Log</span><span class="op" id="1613324">(</span><span class="ident" id="1613325">x</span><span class="op" id="1613326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613330">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613341">var</span>&nbsp;<span class="ident" id="1613345">nadj</span>&nbsp;<span class="builtintype" id="1613350">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613359">if</span>&nbsp;<span class="ident" id="1613362">neg</span>&nbsp;<span class="op" id="1613366">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613370">if</span>&nbsp;<span class="ident" id="1613373">x</span>&nbsp;<span class="op" id="1613375">&gt;=</span>&nbsp;<span class="ident" id="1613378">Two52</span>&nbsp;<span class="op" id="1613384">{</span>&nbsp;<span class="comment" id="1613386">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613423">lgamma</span>&nbsp;<span class="op" id="1613430">=</span>&nbsp;<span class="ident" id="1613432">Inf</span><span class="op" id="1613435">(</span><span class="num" id="1613436">1</span><span class="op" id="1613437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613442">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613455">t</span>&nbsp;<span class="op" id="1613457">:=</span>&nbsp;<span class="ident" id="1613460">sinPi</span><span class="op" id="1613465">(</span><span class="ident" id="1613466">x</span><span class="op" id="1613467">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613471">if</span>&nbsp;<span class="ident" id="1613474">t</span>&nbsp;<span class="op" id="1613476">==</span>&nbsp;<span class="num" id="1613479">0</span>&nbsp;<span class="op" id="1613481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613486">lgamma</span>&nbsp;<span class="op" id="1613493">=</span>&nbsp;<span class="ident" id="1613495">Inf</span><span class="op" id="1613498">(</span><span class="num" id="1613499">1</span><span class="op" id="1613500">)</span>&nbsp;<span class="comment" id="1613502">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613517">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613530">nadj</span>&nbsp;<span class="op" id="1613535">=</span>&nbsp;<span class="ident" id="1613537">Log</span><span class="op" id="1613540">(</span><span class="ident" id="1613541">Pi</span>&nbsp;<span class="op" id="1613544">/</span>&nbsp;<span class="ident" id="1613546">Abs</span><span class="op" id="1613549">(</span><span class="ident" id="1613550">t</span><span class="op" id="1613551">*</span><span class="ident" id="1613552">x</span><span class="op" id="1613553">)</span><span class="op" id="1613554">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613558">if</span>&nbsp;<span class="ident" id="1613561">t</span>&nbsp;<span class="op" id="1613563">&lt;</span>&nbsp;<span class="num" id="1613565">0</span>&nbsp;<span class="op" id="1613567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613572">sign</span>&nbsp;<span class="op" id="1613577">=</span>&nbsp;<span class="op" id="1613579">-</span><span class="num" id="1613580">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1613587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613591">switch</span>&nbsp;<span class="op" id="1613598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613601">case</span>&nbsp;<span class="ident" id="1613606">x</span>&nbsp;<span class="op" id="1613608">==</span>&nbsp;<span class="num" id="1613611">1</span>&nbsp;<span class="op" id="1613613">||</span>&nbsp;<span class="ident" id="1613616">x</span>&nbsp;<span class="op" id="1613618">==</span>&nbsp;<span class="num" id="1613621">2</span><span class="op" id="1613622">:</span>&nbsp;<span class="comment" id="1613624">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613647">lgamma</span>&nbsp;<span class="op" id="1613654">=</span>&nbsp;<span class="num" id="1613656">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613660">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613668">case</span>&nbsp;<span class="ident" id="1613673">x</span>&nbsp;<span class="op" id="1613675">&lt;</span>&nbsp;<span class="num" id="1613677">2</span><span class="op" id="1613678">:</span>&nbsp;<span class="comment" id="1613680">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613722">var</span>&nbsp;<span class="ident" id="1613726">y</span>&nbsp;<span class="builtintype" id="1613728">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613738">var</span>&nbsp;<span class="ident" id="1613742">i</span>&nbsp;<span class="builtintype" id="1613744">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613750">if</span>&nbsp;<span class="ident" id="1613753">x</span>&nbsp;<span class="op" id="1613755">&lt;=</span>&nbsp;<span class="num" id="1613758">0.9</span>&nbsp;<span class="op" id="1613762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613767">lgamma</span>&nbsp;<span class="op" id="1613774">=</span>&nbsp;<span class="op" id="1613776">-</span><span class="ident" id="1613777">Log</span><span class="op" id="1613780">(</span><span class="ident" id="1613781">x</span><span class="op" id="1613782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613787">switch</span>&nbsp;<span class="op" id="1613794">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613799">case</span>&nbsp;<span class="ident" id="1613804">x</span>&nbsp;<span class="op" id="1613806">&gt;=</span>&nbsp;<span class="op" id="1613809">(</span><span class="ident" id="1613810">Ymin</span>&nbsp;<span class="op" id="1613815">-</span>&nbsp;<span class="num" id="1613817">1</span>&nbsp;<span class="op" id="1613819">+</span>&nbsp;<span class="num" id="1613821">0.27</span><span class="op" id="1613825">)</span><span class="op" id="1613826">:</span>&nbsp;<span class="comment" id="1613828">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613855">y</span>&nbsp;<span class="op" id="1613857">=</span>&nbsp;<span class="num" id="1613859">1</span>&nbsp;<span class="op" id="1613861">-</span>&nbsp;<span class="ident" id="1613863">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613869">i</span>&nbsp;<span class="op" id="1613871">=</span>&nbsp;<span class="num" id="1613873">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613878">case</span>&nbsp;<span class="ident" id="1613883">x</span>&nbsp;<span class="op" id="1613885">&gt;=</span>&nbsp;<span class="op" id="1613888">(</span><span class="ident" id="1613889">Ymin</span>&nbsp;<span class="op" id="1613894">-</span>&nbsp;<span class="num" id="1613896">1</span>&nbsp;<span class="op" id="1613898">-</span>&nbsp;<span class="num" id="1613900">0.27</span><span class="op" id="1613904">)</span><span class="op" id="1613905">:</span>&nbsp;<span class="comment" id="1613907">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613935">y</span>&nbsp;<span class="op" id="1613937">=</span>&nbsp;<span class="ident" id="1613939">x</span>&nbsp;<span class="op" id="1613941">-</span>&nbsp;<span class="op" id="1613943">(</span><span class="ident" id="1613944">Tc</span>&nbsp;<span class="op" id="1613947">-</span>&nbsp;<span class="num" id="1613949">1</span><span class="op" id="1613950">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613956">i</span>&nbsp;<span class="op" id="1613958">=</span>&nbsp;<span class="num" id="1613960">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1613965">default</span><span class="op" id="1613972">:</span>&nbsp;<span class="comment" id="1613974">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1613996">y</span>&nbsp;<span class="op" id="1613998">=</span>&nbsp;<span class="ident" id="1614000">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614006">i</span>&nbsp;<span class="op" id="1614008">=</span>&nbsp;<span class="num" id="1614010">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1614015">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1614019">}</span>&nbsp;<span class="keyword" id="1614021">else</span>&nbsp;<span class="op" id="1614026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614031">lgamma</span>&nbsp;<span class="op" id="1614038">=</span>&nbsp;<span class="num" id="1614040">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614045">switch</span>&nbsp;<span class="op" id="1614052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614057">case</span>&nbsp;<span class="ident" id="1614062">x</span>&nbsp;<span class="op" id="1614064">&gt;=</span>&nbsp;<span class="op" id="1614067">(</span><span class="ident" id="1614068">Ymin</span>&nbsp;<span class="op" id="1614073">+</span>&nbsp;<span class="num" id="1614075">0.27</span><span class="op" id="1614079">)</span><span class="op" id="1614080">:</span>&nbsp;<span class="comment" id="1614082">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614105">y</span>&nbsp;<span class="op" id="1614107">=</span>&nbsp;<span class="num" id="1614109">2</span>&nbsp;<span class="op" id="1614111">-</span>&nbsp;<span class="ident" id="1614113">x</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614119">i</span>&nbsp;<span class="op" id="1614121">=</span>&nbsp;<span class="num" id="1614123">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614128">case</span>&nbsp;<span class="ident" id="1614133">x</span>&nbsp;<span class="op" id="1614135">&gt;=</span>&nbsp;<span class="op" id="1614138">(</span><span class="ident" id="1614139">Ymin</span>&nbsp;<span class="op" id="1614144">-</span>&nbsp;<span class="num" id="1614146">0.27</span><span class="op" id="1614150">)</span><span class="op" id="1614151">:</span>&nbsp;<span class="comment" id="1614153">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614181">y</span>&nbsp;<span class="op" id="1614183">=</span>&nbsp;<span class="ident" id="1614185">x</span>&nbsp;<span class="op" id="1614187">-</span>&nbsp;<span class="ident" id="1614189">Tc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614196">i</span>&nbsp;<span class="op" id="1614198">=</span>&nbsp;<span class="num" id="1614200">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614205">default</span><span class="op" id="1614212">:</span>&nbsp;<span class="comment" id="1614214">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614238">y</span>&nbsp;<span class="op" id="1614240">=</span>&nbsp;<span class="ident" id="1614242">x</span>&nbsp;<span class="op" id="1614244">-</span>&nbsp;<span class="num" id="1614246">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614252">i</span>&nbsp;<span class="op" id="1614254">=</span>&nbsp;<span class="num" id="1614256">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1614261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1614265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614269">switch</span>&nbsp;<span class="ident" id="1614276">i</span>&nbsp;<span class="op" id="1614278">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614282">case</span>&nbsp;<span class="num" id="1614287">0</span><span class="op" id="1614288">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614293">z</span>&nbsp;<span class="op" id="1614295">:=</span>&nbsp;<span class="ident" id="1614298">y</span>&nbsp;<span class="op" id="1614300">*</span>&nbsp;<span class="ident" id="1614302">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614307">p1</span>&nbsp;<span class="op" id="1614310">:=</span>&nbsp;<span class="ident" id="1614313">_lgamA</span><span class="op" id="1614319">[</span><span class="num" id="1614320">0</span><span class="op" id="1614321">]</span>&nbsp;<span class="op" id="1614323">+</span>&nbsp;<span class="ident" id="1614325">z</span><span class="op" id="1614326">*</span><span class="op" id="1614327">(</span><span class="ident" id="1614328">_lgamA</span><span class="op" id="1614334">[</span><span class="num" id="1614335">2</span><span class="op" id="1614336">]</span><span class="op" id="1614337">+</span><span class="ident" id="1614338">z</span><span class="op" id="1614339">*</span><span class="op" id="1614340">(</span><span class="ident" id="1614341">_lgamA</span><span class="op" id="1614347">[</span><span class="num" id="1614348">4</span><span class="op" id="1614349">]</span><span class="op" id="1614350">+</span><span class="ident" id="1614351">z</span><span class="op" id="1614352">*</span><span class="op" id="1614353">(</span><span class="ident" id="1614354">_lgamA</span><span class="op" id="1614360">[</span><span class="num" id="1614361">6</span><span class="op" id="1614362">]</span><span class="op" id="1614363">+</span><span class="ident" id="1614364">z</span><span class="op" id="1614365">*</span><span class="op" id="1614366">(</span><span class="ident" id="1614367">_lgamA</span><span class="op" id="1614373">[</span><span class="num" id="1614374">8</span><span class="op" id="1614375">]</span><span class="op" id="1614376">+</span><span class="ident" id="1614377">z</span><span class="op" id="1614378">*</span><span class="ident" id="1614379">_lgamA</span><span class="op" id="1614385">[</span><span class="num" id="1614386">10</span><span class="op" id="1614388">]</span><span class="op" id="1614389">)</span><span class="op" id="1614390">)</span><span class="op" id="1614391">)</span><span class="op" id="1614392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614397">p2</span>&nbsp;<span class="op" id="1614400">:=</span>&nbsp;<span class="ident" id="1614403">z</span>&nbsp;<span class="op" id="1614405">*</span>&nbsp;<span class="op" id="1614407">(</span><span class="ident" id="1614408">_lgamA</span><span class="op" id="1614414">[</span><span class="num" id="1614415">1</span><span class="op" id="1614416">]</span>&nbsp;<span class="op" id="1614418">+</span>&nbsp;<span class="ident" id="1614420">z</span><span class="op" id="1614421">*</span><span class="op" id="1614422">(</span><span class="op" id="1614423">+</span><span class="ident" id="1614424">_lgamA</span><span class="op" id="1614430">[</span><span class="num" id="1614431">3</span><span class="op" id="1614432">]</span><span class="op" id="1614433">+</span><span class="ident" id="1614434">z</span><span class="op" id="1614435">*</span><span class="op" id="1614436">(</span><span class="ident" id="1614437">_lgamA</span><span class="op" id="1614443">[</span><span class="num" id="1614444">5</span><span class="op" id="1614445">]</span><span class="op" id="1614446">+</span><span class="ident" id="1614447">z</span><span class="op" id="1614448">*</span><span class="op" id="1614449">(</span><span class="ident" id="1614450">_lgamA</span><span class="op" id="1614456">[</span><span class="num" id="1614457">7</span><span class="op" id="1614458">]</span><span class="op" id="1614459">+</span><span class="ident" id="1614460">z</span><span class="op" id="1614461">*</span><span class="op" id="1614462">(</span><span class="ident" id="1614463">_lgamA</span><span class="op" id="1614469">[</span><span class="num" id="1614470">9</span><span class="op" id="1614471">]</span><span class="op" id="1614472">+</span><span class="ident" id="1614473">z</span><span class="op" id="1614474">*</span><span class="ident" id="1614475">_lgamA</span><span class="op" id="1614481">[</span><span class="num" id="1614482">11</span><span class="op" id="1614484">]</span><span class="op" id="1614485">)</span><span class="op" id="1614486">)</span><span class="op" id="1614487">)</span><span class="op" id="1614488">)</span><span class="op" id="1614489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614494">p</span>&nbsp;<span class="op" id="1614496">:=</span>&nbsp;<span class="ident" id="1614499">y</span><span class="op" id="1614500">*</span><span class="ident" id="1614501">p1</span>&nbsp;<span class="op" id="1614504">+</span>&nbsp;<span class="ident" id="1614506">p2</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614512">lgamma</span>&nbsp;<span class="op" id="1614519">+=</span>&nbsp;<span class="op" id="1614522">(</span><span class="ident" id="1614523">p</span>&nbsp;<span class="op" id="1614525">-</span>&nbsp;<span class="num" id="1614527">0.5</span><span class="op" id="1614530">*</span><span class="ident" id="1614531">y</span><span class="op" id="1614532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614536">case</span>&nbsp;<span class="num" id="1614541">1</span><span class="op" id="1614542">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614547">z</span>&nbsp;<span class="op" id="1614549">:=</span>&nbsp;<span class="ident" id="1614552">y</span>&nbsp;<span class="op" id="1614554">*</span>&nbsp;<span class="ident" id="1614556">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614561">w</span>&nbsp;<span class="op" id="1614563">:=</span>&nbsp;<span class="ident" id="1614566">z</span>&nbsp;<span class="op" id="1614568">*</span>&nbsp;<span class="ident" id="1614570">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614575">p1</span>&nbsp;<span class="op" id="1614578">:=</span>&nbsp;<span class="ident" id="1614581">_lgamT</span><span class="op" id="1614587">[</span><span class="num" id="1614588">0</span><span class="op" id="1614589">]</span>&nbsp;<span class="op" id="1614591">+</span>&nbsp;<span class="ident" id="1614593">w</span><span class="op" id="1614594">*</span><span class="op" id="1614595">(</span><span class="ident" id="1614596">_lgamT</span><span class="op" id="1614602">[</span><span class="num" id="1614603">3</span><span class="op" id="1614604">]</span><span class="op" id="1614605">+</span><span class="ident" id="1614606">w</span><span class="op" id="1614607">*</span><span class="op" id="1614608">(</span><span class="ident" id="1614609">_lgamT</span><span class="op" id="1614615">[</span><span class="num" id="1614616">6</span><span class="op" id="1614617">]</span><span class="op" id="1614618">+</span><span class="ident" id="1614619">w</span><span class="op" id="1614620">*</span><span class="op" id="1614621">(</span><span class="ident" id="1614622">_lgamT</span><span class="op" id="1614628">[</span><span class="num" id="1614629">9</span><span class="op" id="1614630">]</span><span class="op" id="1614631">+</span><span class="ident" id="1614632">w</span><span class="op" id="1614633">*</span><span class="ident" id="1614634">_lgamT</span><span class="op" id="1614640">[</span><span class="num" id="1614641">12</span><span class="op" id="1614643">]</span><span class="op" id="1614644">)</span><span class="op" id="1614645">)</span><span class="op" id="1614646">)</span>&nbsp;<span class="comment" id="1614648">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614668">p2</span>&nbsp;<span class="op" id="1614671">:=</span>&nbsp;<span class="ident" id="1614674">_lgamT</span><span class="op" id="1614680">[</span><span class="num" id="1614681">1</span><span class="op" id="1614682">]</span>&nbsp;<span class="op" id="1614684">+</span>&nbsp;<span class="ident" id="1614686">w</span><span class="op" id="1614687">*</span><span class="op" id="1614688">(</span><span class="ident" id="1614689">_lgamT</span><span class="op" id="1614695">[</span><span class="num" id="1614696">4</span><span class="op" id="1614697">]</span><span class="op" id="1614698">+</span><span class="ident" id="1614699">w</span><span class="op" id="1614700">*</span><span class="op" id="1614701">(</span><span class="ident" id="1614702">_lgamT</span><span class="op" id="1614708">[</span><span class="num" id="1614709">7</span><span class="op" id="1614710">]</span><span class="op" id="1614711">+</span><span class="ident" id="1614712">w</span><span class="op" id="1614713">*</span><span class="op" id="1614714">(</span><span class="ident" id="1614715">_lgamT</span><span class="op" id="1614721">[</span><span class="num" id="1614722">10</span><span class="op" id="1614724">]</span><span class="op" id="1614725">+</span><span class="ident" id="1614726">w</span><span class="op" id="1614727">*</span><span class="ident" id="1614728">_lgamT</span><span class="op" id="1614734">[</span><span class="num" id="1614735">13</span><span class="op" id="1614737">]</span><span class="op" id="1614738">)</span><span class="op" id="1614739">)</span><span class="op" id="1614740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614745">p3</span>&nbsp;<span class="op" id="1614748">:=</span>&nbsp;<span class="ident" id="1614751">_lgamT</span><span class="op" id="1614757">[</span><span class="num" id="1614758">2</span><span class="op" id="1614759">]</span>&nbsp;<span class="op" id="1614761">+</span>&nbsp;<span class="ident" id="1614763">w</span><span class="op" id="1614764">*</span><span class="op" id="1614765">(</span><span class="ident" id="1614766">_lgamT</span><span class="op" id="1614772">[</span><span class="num" id="1614773">5</span><span class="op" id="1614774">]</span><span class="op" id="1614775">+</span><span class="ident" id="1614776">w</span><span class="op" id="1614777">*</span><span class="op" id="1614778">(</span><span class="ident" id="1614779">_lgamT</span><span class="op" id="1614785">[</span><span class="num" id="1614786">8</span><span class="op" id="1614787">]</span><span class="op" id="1614788">+</span><span class="ident" id="1614789">w</span><span class="op" id="1614790">*</span><span class="op" id="1614791">(</span><span class="ident" id="1614792">_lgamT</span><span class="op" id="1614798">[</span><span class="num" id="1614799">11</span><span class="op" id="1614801">]</span><span class="op" id="1614802">+</span><span class="ident" id="1614803">w</span><span class="op" id="1614804">*</span><span class="ident" id="1614805">_lgamT</span><span class="op" id="1614811">[</span><span class="num" id="1614812">14</span><span class="op" id="1614814">]</span><span class="op" id="1614815">)</span><span class="op" id="1614816">)</span><span class="op" id="1614817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614822">p</span>&nbsp;<span class="op" id="1614824">:=</span>&nbsp;<span class="ident" id="1614827">z</span><span class="op" id="1614828">*</span><span class="ident" id="1614829">p1</span>&nbsp;<span class="op" id="1614832">-</span>&nbsp;<span class="op" id="1614834">(</span><span class="ident" id="1614835">Tt</span>&nbsp;<span class="op" id="1614838">-</span>&nbsp;<span class="ident" id="1614840">w</span><span class="op" id="1614841">*</span><span class="op" id="1614842">(</span><span class="ident" id="1614843">p2</span><span class="op" id="1614845">+</span><span class="ident" id="1614846">y</span><span class="op" id="1614847">*</span><span class="ident" id="1614848">p3</span><span class="op" id="1614850">)</span><span class="op" id="1614851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614856">lgamma</span>&nbsp;<span class="op" id="1614863">+=</span>&nbsp;<span class="op" id="1614866">(</span><span class="ident" id="1614867">Tf</span>&nbsp;<span class="op" id="1614870">+</span>&nbsp;<span class="ident" id="1614872">p</span><span class="op" id="1614873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1614877">case</span>&nbsp;<span class="num" id="1614882">2</span><span class="op" id="1614883">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614888">p1</span>&nbsp;<span class="op" id="1614891">:=</span>&nbsp;<span class="ident" id="1614894">y</span>&nbsp;<span class="op" id="1614896">*</span>&nbsp;<span class="op" id="1614898">(</span><span class="ident" id="1614899">_lgamU</span><span class="op" id="1614905">[</span><span class="num" id="1614906">0</span><span class="op" id="1614907">]</span>&nbsp;<span class="op" id="1614909">+</span>&nbsp;<span class="ident" id="1614911">y</span><span class="op" id="1614912">*</span><span class="op" id="1614913">(</span><span class="ident" id="1614914">_lgamU</span><span class="op" id="1614920">[</span><span class="num" id="1614921">1</span><span class="op" id="1614922">]</span><span class="op" id="1614923">+</span><span class="ident" id="1614924">y</span><span class="op" id="1614925">*</span><span class="op" id="1614926">(</span><span class="ident" id="1614927">_lgamU</span><span class="op" id="1614933">[</span><span class="num" id="1614934">2</span><span class="op" id="1614935">]</span><span class="op" id="1614936">+</span><span class="ident" id="1614937">y</span><span class="op" id="1614938">*</span><span class="op" id="1614939">(</span><span class="ident" id="1614940">_lgamU</span><span class="op" id="1614946">[</span><span class="num" id="1614947">3</span><span class="op" id="1614948">]</span><span class="op" id="1614949">+</span><span class="ident" id="1614950">y</span><span class="op" id="1614951">*</span><span class="op" id="1614952">(</span><span class="ident" id="1614953">_lgamU</span><span class="op" id="1614959">[</span><span class="num" id="1614960">4</span><span class="op" id="1614961">]</span><span class="op" id="1614962">+</span><span class="ident" id="1614963">y</span><span class="op" id="1614964">*</span><span class="ident" id="1614965">_lgamU</span><span class="op" id="1614971">[</span><span class="num" id="1614972">5</span><span class="op" id="1614973">]</span><span class="op" id="1614974">)</span><span class="op" id="1614975">)</span><span class="op" id="1614976">)</span><span class="op" id="1614977">)</span><span class="op" id="1614978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1614983">p2</span>&nbsp;<span class="op" id="1614986">:=</span>&nbsp;<span class="num" id="1614989">1</span>&nbsp;<span class="op" id="1614991">+</span>&nbsp;<span class="ident" id="1614993">y</span><span class="op" id="1614994">*</span><span class="op" id="1614995">(</span><span class="ident" id="1614996">_lgamV</span><span class="op" id="1615002">[</span><span class="num" id="1615003">1</span><span class="op" id="1615004">]</span><span class="op" id="1615005">+</span><span class="ident" id="1615006">y</span><span class="op" id="1615007">*</span><span class="op" id="1615008">(</span><span class="ident" id="1615009">_lgamV</span><span class="op" id="1615015">[</span><span class="num" id="1615016">2</span><span class="op" id="1615017">]</span><span class="op" id="1615018">+</span><span class="ident" id="1615019">y</span><span class="op" id="1615020">*</span><span class="op" id="1615021">(</span><span class="ident" id="1615022">_lgamV</span><span class="op" id="1615028">[</span><span class="num" id="1615029">3</span><span class="op" id="1615030">]</span><span class="op" id="1615031">+</span><span class="ident" id="1615032">y</span><span class="op" id="1615033">*</span><span class="op" id="1615034">(</span><span class="ident" id="1615035">_lgamV</span><span class="op" id="1615041">[</span><span class="num" id="1615042">4</span><span class="op" id="1615043">]</span><span class="op" id="1615044">+</span><span class="ident" id="1615045">y</span><span class="op" id="1615046">*</span><span class="ident" id="1615047">_lgamV</span><span class="op" id="1615053">[</span><span class="num" id="1615054">5</span><span class="op" id="1615055">]</span><span class="op" id="1615056">)</span><span class="op" id="1615057">)</span><span class="op" id="1615058">)</span><span class="op" id="1615059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615064">lgamma</span>&nbsp;<span class="op" id="1615071">+=</span>&nbsp;<span class="op" id="1615074">(</span><span class="op" id="1615075">-</span><span class="num" id="1615076">0.5</span><span class="op" id="1615079">*</span><span class="ident" id="1615080">y</span>&nbsp;<span class="op" id="1615082">+</span>&nbsp;<span class="ident" id="1615084">p1</span><span class="op" id="1615086">/</span><span class="ident" id="1615087">p2</span><span class="op" id="1615089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1615093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615096">case</span>&nbsp;<span class="ident" id="1615101">x</span>&nbsp;<span class="op" id="1615103">&lt;</span>&nbsp;<span class="num" id="1615105">8</span><span class="op" id="1615106">:</span>&nbsp;<span class="comment" id="1615108">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615124">i</span>&nbsp;<span class="op" id="1615126">:=</span>&nbsp;<span class="builtintype" id="1615129">int</span><span class="op" id="1615132">(</span><span class="ident" id="1615133">x</span><span class="op" id="1615134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615138">y</span>&nbsp;<span class="op" id="1615140">:=</span>&nbsp;<span class="ident" id="1615143">x</span>&nbsp;<span class="op" id="1615145">-</span>&nbsp;<span class="builtintype" id="1615147">float64</span><span class="op" id="1615154">(</span><span class="ident" id="1615155">i</span><span class="op" id="1615156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615160">p</span>&nbsp;<span class="op" id="1615162">:=</span>&nbsp;<span class="ident" id="1615165">y</span>&nbsp;<span class="op" id="1615167">*</span>&nbsp;<span class="op" id="1615169">(</span><span class="ident" id="1615170">_lgamS</span><span class="op" id="1615176">[</span><span class="num" id="1615177">0</span><span class="op" id="1615178">]</span>&nbsp;<span class="op" id="1615180">+</span>&nbsp;<span class="ident" id="1615182">y</span><span class="op" id="1615183">*</span><span class="op" id="1615184">(</span><span class="ident" id="1615185">_lgamS</span><span class="op" id="1615191">[</span><span class="num" id="1615192">1</span><span class="op" id="1615193">]</span><span class="op" id="1615194">+</span><span class="ident" id="1615195">y</span><span class="op" id="1615196">*</span><span class="op" id="1615197">(</span><span class="ident" id="1615198">_lgamS</span><span class="op" id="1615204">[</span><span class="num" id="1615205">2</span><span class="op" id="1615206">]</span><span class="op" id="1615207">+</span><span class="ident" id="1615208">y</span><span class="op" id="1615209">*</span><span class="op" id="1615210">(</span><span class="ident" id="1615211">_lgamS</span><span class="op" id="1615217">[</span><span class="num" id="1615218">3</span><span class="op" id="1615219">]</span><span class="op" id="1615220">+</span><span class="ident" id="1615221">y</span><span class="op" id="1615222">*</span><span class="op" id="1615223">(</span><span class="ident" id="1615224">_lgamS</span><span class="op" id="1615230">[</span><span class="num" id="1615231">4</span><span class="op" id="1615232">]</span><span class="op" id="1615233">+</span><span class="ident" id="1615234">y</span><span class="op" id="1615235">*</span><span class="op" id="1615236">(</span><span class="ident" id="1615237">_lgamS</span><span class="op" id="1615243">[</span><span class="num" id="1615244">5</span><span class="op" id="1615245">]</span><span class="op" id="1615246">+</span><span class="ident" id="1615247">y</span><span class="op" id="1615248">*</span><span class="ident" id="1615249">_lgamS</span><span class="op" id="1615255">[</span><span class="num" id="1615256">6</span><span class="op" id="1615257">]</span><span class="op" id="1615258">)</span><span class="op" id="1615259">)</span><span class="op" id="1615260">)</span><span class="op" id="1615261">)</span><span class="op" id="1615262">)</span><span class="op" id="1615263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615267">q</span>&nbsp;<span class="op" id="1615269">:=</span>&nbsp;<span class="num" id="1615272">1</span>&nbsp;<span class="op" id="1615274">+</span>&nbsp;<span class="ident" id="1615276">y</span><span class="op" id="1615277">*</span><span class="op" id="1615278">(</span><span class="ident" id="1615279">_lgamR</span><span class="op" id="1615285">[</span><span class="num" id="1615286">1</span><span class="op" id="1615287">]</span><span class="op" id="1615288">+</span><span class="ident" id="1615289">y</span><span class="op" id="1615290">*</span><span class="op" id="1615291">(</span><span class="ident" id="1615292">_lgamR</span><span class="op" id="1615298">[</span><span class="num" id="1615299">2</span><span class="op" id="1615300">]</span><span class="op" id="1615301">+</span><span class="ident" id="1615302">y</span><span class="op" id="1615303">*</span><span class="op" id="1615304">(</span><span class="ident" id="1615305">_lgamR</span><span class="op" id="1615311">[</span><span class="num" id="1615312">3</span><span class="op" id="1615313">]</span><span class="op" id="1615314">+</span><span class="ident" id="1615315">y</span><span class="op" id="1615316">*</span><span class="op" id="1615317">(</span><span class="ident" id="1615318">_lgamR</span><span class="op" id="1615324">[</span><span class="num" id="1615325">4</span><span class="op" id="1615326">]</span><span class="op" id="1615327">+</span><span class="ident" id="1615328">y</span><span class="op" id="1615329">*</span><span class="op" id="1615330">(</span><span class="ident" id="1615331">_lgamR</span><span class="op" id="1615337">[</span><span class="num" id="1615338">5</span><span class="op" id="1615339">]</span><span class="op" id="1615340">+</span><span class="ident" id="1615341">y</span><span class="op" id="1615342">*</span><span class="ident" id="1615343">_lgamR</span><span class="op" id="1615349">[</span><span class="num" id="1615350">6</span><span class="op" id="1615351">]</span><span class="op" id="1615352">)</span><span class="op" id="1615353">)</span><span class="op" id="1615354">)</span><span class="op" id="1615355">)</span><span class="op" id="1615356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615360">lgamma</span>&nbsp;<span class="op" id="1615367">=</span>&nbsp;<span class="num" id="1615369">0.5</span><span class="op" id="1615372">*</span><span class="ident" id="1615373">y</span>&nbsp;<span class="op" id="1615375">+</span>&nbsp;<span class="ident" id="1615377">p</span><span class="op" id="1615378">/</span><span class="ident" id="1615379">q</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615383">z</span>&nbsp;<span class="op" id="1615385">:=</span>&nbsp;<span class="num" id="1615388">1.0</span>&nbsp;<span class="comment" id="1615392">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615430">switch</span>&nbsp;<span class="ident" id="1615437">i</span>&nbsp;<span class="op" id="1615439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615443">case</span>&nbsp;<span class="num" id="1615448">7</span><span class="op" id="1615449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615454">z</span>&nbsp;<span class="op" id="1615456">*=</span>&nbsp;<span class="op" id="1615459">(</span><span class="ident" id="1615460">y</span>&nbsp;<span class="op" id="1615462">+</span>&nbsp;<span class="num" id="1615464">6</span><span class="op" id="1615465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615470">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615484">case</span>&nbsp;<span class="num" id="1615489">6</span><span class="op" id="1615490">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615495">z</span>&nbsp;<span class="op" id="1615497">*=</span>&nbsp;<span class="op" id="1615500">(</span><span class="ident" id="1615501">y</span>&nbsp;<span class="op" id="1615503">+</span>&nbsp;<span class="num" id="1615505">5</span><span class="op" id="1615506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615511">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615525">case</span>&nbsp;<span class="num" id="1615530">5</span><span class="op" id="1615531">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615536">z</span>&nbsp;<span class="op" id="1615538">*=</span>&nbsp;<span class="op" id="1615541">(</span><span class="ident" id="1615542">y</span>&nbsp;<span class="op" id="1615544">+</span>&nbsp;<span class="num" id="1615546">4</span><span class="op" id="1615547">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615552">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615566">case</span>&nbsp;<span class="num" id="1615571">4</span><span class="op" id="1615572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615577">z</span>&nbsp;<span class="op" id="1615579">*=</span>&nbsp;<span class="op" id="1615582">(</span><span class="ident" id="1615583">y</span>&nbsp;<span class="op" id="1615585">+</span>&nbsp;<span class="num" id="1615587">3</span><span class="op" id="1615588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615593">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615607">case</span>&nbsp;<span class="num" id="1615612">3</span><span class="op" id="1615613">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615618">z</span>&nbsp;<span class="op" id="1615620">*=</span>&nbsp;<span class="op" id="1615623">(</span><span class="ident" id="1615624">y</span>&nbsp;<span class="op" id="1615626">+</span>&nbsp;<span class="num" id="1615628">2</span><span class="op" id="1615629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615634">lgamma</span>&nbsp;<span class="op" id="1615641">+=</span>&nbsp;<span class="ident" id="1615644">Log</span><span class="op" id="1615647">(</span><span class="ident" id="1615648">z</span><span class="op" id="1615649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1615653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615656">case</span>&nbsp;<span class="ident" id="1615661">x</span>&nbsp;<span class="op" id="1615663">&lt;</span>&nbsp;<span class="ident" id="1615665">Two58</span><span class="op" id="1615670">:</span>&nbsp;<span class="comment" id="1615672">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615692">t</span>&nbsp;<span class="op" id="1615694">:=</span>&nbsp;<span class="ident" id="1615697">Log</span><span class="op" id="1615700">(</span><span class="ident" id="1615701">x</span><span class="op" id="1615702">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615706">z</span>&nbsp;<span class="op" id="1615708">:=</span>&nbsp;<span class="num" id="1615711">1</span>&nbsp;<span class="op" id="1615713">/</span>&nbsp;<span class="ident" id="1615715">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615719">y</span>&nbsp;<span class="op" id="1615721">:=</span>&nbsp;<span class="ident" id="1615724">z</span>&nbsp;<span class="op" id="1615726">*</span>&nbsp;<span class="ident" id="1615728">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615732">w</span>&nbsp;<span class="op" id="1615734">:=</span>&nbsp;<span class="ident" id="1615737">_lgamW</span><span class="op" id="1615743">[</span><span class="num" id="1615744">0</span><span class="op" id="1615745">]</span>&nbsp;<span class="op" id="1615747">+</span>&nbsp;<span class="ident" id="1615749">z</span><span class="op" id="1615750">*</span><span class="op" id="1615751">(</span><span class="ident" id="1615752">_lgamW</span><span class="op" id="1615758">[</span><span class="num" id="1615759">1</span><span class="op" id="1615760">]</span><span class="op" id="1615761">+</span><span class="ident" id="1615762">y</span><span class="op" id="1615763">*</span><span class="op" id="1615764">(</span><span class="ident" id="1615765">_lgamW</span><span class="op" id="1615771">[</span><span class="num" id="1615772">2</span><span class="op" id="1615773">]</span><span class="op" id="1615774">+</span><span class="ident" id="1615775">y</span><span class="op" id="1615776">*</span><span class="op" id="1615777">(</span><span class="ident" id="1615778">_lgamW</span><span class="op" id="1615784">[</span><span class="num" id="1615785">3</span><span class="op" id="1615786">]</span><span class="op" id="1615787">+</span><span class="ident" id="1615788">y</span><span class="op" id="1615789">*</span><span class="op" id="1615790">(</span><span class="ident" id="1615791">_lgamW</span><span class="op" id="1615797">[</span><span class="num" id="1615798">4</span><span class="op" id="1615799">]</span><span class="op" id="1615800">+</span><span class="ident" id="1615801">y</span><span class="op" id="1615802">*</span><span class="op" id="1615803">(</span><span class="ident" id="1615804">_lgamW</span><span class="op" id="1615810">[</span><span class="num" id="1615811">5</span><span class="op" id="1615812">]</span><span class="op" id="1615813">+</span><span class="ident" id="1615814">y</span><span class="op" id="1615815">*</span><span class="ident" id="1615816">_lgamW</span><span class="op" id="1615822">[</span><span class="num" id="1615823">6</span><span class="op" id="1615824">]</span><span class="op" id="1615825">)</span><span class="op" id="1615826">)</span><span class="op" id="1615827">)</span><span class="op" id="1615828">)</span><span class="op" id="1615829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615833">lgamma</span>&nbsp;<span class="op" id="1615840">=</span>&nbsp;<span class="op" id="1615842">(</span><span class="ident" id="1615843">x</span><span class="op" id="1615844">-</span><span class="num" id="1615845">0.5</span><span class="op" id="1615848">)</span><span class="op" id="1615849">*</span><span class="op" id="1615850">(</span><span class="ident" id="1615851">t</span><span class="op" id="1615852">-</span><span class="num" id="1615853">1</span><span class="op" id="1615854">)</span>&nbsp;<span class="op" id="1615856">+</span>&nbsp;<span class="ident" id="1615858">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615861">default</span><span class="op" id="1615868">:</span>&nbsp;<span class="comment" id="1615870">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615893">lgamma</span>&nbsp;<span class="op" id="1615900">=</span>&nbsp;<span class="ident" id="1615902">x</span>&nbsp;<span class="op" id="1615904">*</span>&nbsp;<span class="op" id="1615906">(</span><span class="ident" id="1615907">Log</span><span class="op" id="1615910">(</span><span class="ident" id="1615911">x</span><span class="op" id="1615912">)</span>&nbsp;<span class="op" id="1615914">-</span>&nbsp;<span class="num" id="1615916">1</span><span class="op" id="1615917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1615920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615923">if</span>&nbsp;<span class="ident" id="1615926">neg</span>&nbsp;<span class="op" id="1615930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1615934">lgamma</span>&nbsp;<span class="op" id="1615941">=</span>&nbsp;<span class="ident" id="1615943">nadj</span>&nbsp;<span class="op" id="1615948">-</span>&nbsp;<span class="ident" id="1615950">lgamma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1615958">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1615961">return</span><br>
<span class="lineno"></span><span class="op" id="1615968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1615971">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="1616019">func</span>&nbsp;<span class="ident" id="1616024">sinPi</span><span class="op" id="1616029">(</span><span class="ident" id="1616030">x</span>&nbsp;<span class="builtintype" id="1616032">float64</span><span class="op" id="1616039">)</span>&nbsp;<span class="builtintype" id="1616041">float64</span>&nbsp;<span class="op" id="1616049">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616052">const</span>&nbsp;<span class="op" id="1616058">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616062">Two52</span>&nbsp;<span class="op" id="1616068">=</span>&nbsp;<span class="num" id="1616070">1</span>&nbsp;<span class="op" id="1616072">&lt;&lt;</span>&nbsp;<span class="num" id="1616075">52</span>&nbsp;<span class="comment" id="1616078">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616114">Two53</span>&nbsp;<span class="op" id="1616120">=</span>&nbsp;<span class="num" id="1616122">1</span>&nbsp;<span class="op" id="1616124">&lt;&lt;</span>&nbsp;<span class="num" id="1616127">53</span>&nbsp;<span class="comment" id="1616130">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1616165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616168">if</span>&nbsp;<span class="ident" id="1616171">x</span>&nbsp;<span class="op" id="1616173">&lt;</span>&nbsp;<span class="num" id="1616175">0.25</span>&nbsp;<span class="op" id="1616180">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616184">return</span>&nbsp;<span class="op" id="1616191">-</span><span class="ident" id="1616192">Sin</span><span class="op" id="1616195">(</span><span class="ident" id="1616196">Pi</span>&nbsp;<span class="op" id="1616199">*</span>&nbsp;<span class="ident" id="1616201">x</span><span class="op" id="1616202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1616205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1616209">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616232">z</span>&nbsp;<span class="op" id="1616234">:=</span>&nbsp;<span class="ident" id="1616237">Floor</span><span class="op" id="1616242">(</span><span class="ident" id="1616243">x</span><span class="op" id="1616244">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616247">var</span>&nbsp;<span class="ident" id="1616251">n</span>&nbsp;<span class="builtintype" id="1616253">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616258">if</span>&nbsp;<span class="ident" id="1616261">z</span>&nbsp;<span class="op" id="1616263">!=</span>&nbsp;<span class="ident" id="1616266">x</span>&nbsp;<span class="op" id="1616268">{</span>&nbsp;<span class="comment" id="1616270">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616283">x</span>&nbsp;<span class="op" id="1616285">=</span>&nbsp;<span class="ident" id="1616287">Mod</span><span class="op" id="1616290">(</span><span class="ident" id="1616291">x</span><span class="op" id="1616292">,</span>&nbsp;<span class="num" id="1616294">2</span><span class="op" id="1616295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616299">n</span>&nbsp;<span class="op" id="1616301">=</span>&nbsp;<span class="builtintype" id="1616303">int</span><span class="op" id="1616306">(</span><span class="ident" id="1616307">x</span>&nbsp;<span class="op" id="1616309">*</span>&nbsp;<span class="num" id="1616311">4</span><span class="op" id="1616312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1616315">}</span>&nbsp;<span class="keyword" id="1616317">else</span>&nbsp;<span class="op" id="1616322">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616326">if</span>&nbsp;<span class="ident" id="1616329">x</span>&nbsp;<span class="op" id="1616331">&gt;=</span>&nbsp;<span class="ident" id="1616334">Two53</span>&nbsp;<span class="op" id="1616340">{</span>&nbsp;<span class="comment" id="1616342">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616363">x</span>&nbsp;<span class="op" id="1616365">=</span>&nbsp;<span class="num" id="1616367">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616372">n</span>&nbsp;<span class="op" id="1616374">=</span>&nbsp;<span class="num" id="1616376">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1616380">}</span>&nbsp;<span class="keyword" id="1616382">else</span>&nbsp;<span class="op" id="1616387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616392">if</span>&nbsp;<span class="ident" id="1616395">x</span>&nbsp;<span class="op" id="1616397">&lt;</span>&nbsp;<span class="ident" id="1616399">Two52</span>&nbsp;<span class="op" id="1616405">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616411">z</span>&nbsp;<span class="op" id="1616413">=</span>&nbsp;<span class="ident" id="1616415">x</span>&nbsp;<span class="op" id="1616417">+</span>&nbsp;<span class="ident" id="1616419">Two52</span>&nbsp;<span class="comment" id="1616425">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1616437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616442">n</span>&nbsp;<span class="op" id="1616444">=</span>&nbsp;<span class="builtintype" id="1616446">int</span><span class="op" id="1616449">(</span><span class="num" id="1616450">1</span>&nbsp;<span class="op" id="1616452">&amp;</span>&nbsp;<span class="ident" id="1616454">Float64bits</span><span class="op" id="1616465">(</span><span class="ident" id="1616466">z</span><span class="op" id="1616467">)</span><span class="op" id="1616468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616473">x</span>&nbsp;<span class="op" id="1616475">=</span>&nbsp;<span class="builtintype" id="1616477">float64</span><span class="op" id="1616484">(</span><span class="ident" id="1616485">n</span><span class="op" id="1616486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616491">n</span>&nbsp;<span class="op" id="1616493">&lt;&lt;=</span>&nbsp;<span class="num" id="1616497">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1616501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1616504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616507">switch</span>&nbsp;<span class="ident" id="1616514">n</span>&nbsp;<span class="op" id="1616516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616519">case</span>&nbsp;<span class="num" id="1616524">0</span><span class="op" id="1616525">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616529">x</span>&nbsp;<span class="op" id="1616531">=</span>&nbsp;<span class="ident" id="1616533">Sin</span><span class="op" id="1616536">(</span><span class="ident" id="1616537">Pi</span>&nbsp;<span class="op" id="1616540">*</span>&nbsp;<span class="ident" id="1616542">x</span><span class="op" id="1616543">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616546">case</span>&nbsp;<span class="num" id="1616551">1</span><span class="op" id="1616552">,</span>&nbsp;<span class="num" id="1616554">2</span><span class="op" id="1616555">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616559">x</span>&nbsp;<span class="op" id="1616561">=</span>&nbsp;<span class="ident" id="1616563">Cos</span><span class="op" id="1616566">(</span><span class="ident" id="1616567">Pi</span>&nbsp;<span class="op" id="1616570">*</span>&nbsp;<span class="op" id="1616572">(</span><span class="num" id="1616573">0.5</span>&nbsp;<span class="op" id="1616577">-</span>&nbsp;<span class="ident" id="1616579">x</span><span class="op" id="1616580">)</span><span class="op" id="1616581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616584">case</span>&nbsp;<span class="num" id="1616589">3</span><span class="op" id="1616590">,</span>&nbsp;<span class="num" id="1616592">4</span><span class="op" id="1616593">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616597">x</span>&nbsp;<span class="op" id="1616599">=</span>&nbsp;<span class="ident" id="1616601">Sin</span><span class="op" id="1616604">(</span><span class="ident" id="1616605">Pi</span>&nbsp;<span class="op" id="1616608">*</span>&nbsp;<span class="op" id="1616610">(</span><span class="num" id="1616611">1</span>&nbsp;<span class="op" id="1616613">-</span>&nbsp;<span class="ident" id="1616615">x</span><span class="op" id="1616616">)</span><span class="op" id="1616617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616620">case</span>&nbsp;<span class="num" id="1616625">5</span><span class="op" id="1616626">,</span>&nbsp;<span class="num" id="1616628">6</span><span class="op" id="1616629">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616633">x</span>&nbsp;<span class="op" id="1616635">=</span>&nbsp;<span class="op" id="1616637">-</span><span class="ident" id="1616638">Cos</span><span class="op" id="1616641">(</span><span class="ident" id="1616642">Pi</span>&nbsp;<span class="op" id="1616645">*</span>&nbsp;<span class="op" id="1616647">(</span><span class="ident" id="1616648">x</span>&nbsp;<span class="op" id="1616650">-</span>&nbsp;<span class="num" id="1616652">1.5</span><span class="op" id="1616655">)</span><span class="op" id="1616656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616659">default</span><span class="op" id="1616666">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1616670">x</span>&nbsp;<span class="op" id="1616672">=</span>&nbsp;<span class="ident" id="1616674">Sin</span><span class="op" id="1616677">(</span><span class="ident" id="1616678">Pi</span>&nbsp;<span class="op" id="1616681">*</span>&nbsp;<span class="op" id="1616683">(</span><span class="ident" id="1616684">x</span>&nbsp;<span class="op" id="1616686">-</span>&nbsp;<span class="num" id="1616688">2</span><span class="op" id="1616689">)</span><span class="op" id="1616690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1616693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1616696">return</span>&nbsp;<span class="op" id="1616703">-</span><span class="ident" id="1616704">x</span><br>
<span class="lineno">365</span><span class="op" id="1616706">}</span>
</div>
</body>
</html>
