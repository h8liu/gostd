<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html" class="current">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7452290">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7452345">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7452399">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7452450">package</span>&nbsp;<span class="ident" id="7452458">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7452464">import</span>&nbsp;<span class="op" id="7452471">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7452474">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7452484">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7452487">var</span>&nbsp;<span class="ident" id="7452491">typeTests</span>&nbsp;<span class="op" id="7452501">=</span>&nbsp;<span class="ident" id="7452503">initMimeForTests</span><span class="op" id="7452519">(</span><span class="op" id="7452520">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7452523">func</span>&nbsp;<span class="ident" id="7452528">TestTypeByExtension</span><span class="op" id="7452547">(</span><span class="ident" id="7452548">t</span>&nbsp;<span class="op" id="7452550">*</span><span class="ident" id="7452551">testing</span><span class="op" id="7452558">.</span><span class="ident" id="7452559">T</span><span class="op" id="7452560">)</span>&nbsp;<span class="op" id="7452562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452565">for</span>&nbsp;<span class="ident" id="7452569">ext</span><span class="op" id="7452572">,</span>&nbsp;<span class="ident" id="7452574">want</span>&nbsp;<span class="op" id="7452579">:=</span>&nbsp;<span class="keyword" id="7452582">range</span>&nbsp;<span class="ident" id="7452588">typeTests</span>&nbsp;<span class="op" id="7452598">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452602">val</span>&nbsp;<span class="op" id="7452606">:=</span>&nbsp;<span class="ident" id="7452609">TypeByExtension</span><span class="op" id="7452624">(</span><span class="ident" id="7452625">ext</span><span class="op" id="7452628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452632">if</span>&nbsp;<span class="ident" id="7452635">val</span>&nbsp;<span class="op" id="7452639">!=</span>&nbsp;<span class="ident" id="7452642">want</span>&nbsp;<span class="op" id="7452647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452652">t</span><span class="op" id="7452653">.</span><span class="ident" id="7452654">Errorf</span><span class="op" id="7452660">(</span><span class="string" id="7452661">&#34;TypeByExtension(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7452696">,</span>&nbsp;<span class="ident" id="7452698">ext</span><span class="op" id="7452701">,</span>&nbsp;<span class="ident" id="7452703">val</span><span class="op" id="7452706">,</span>&nbsp;<span class="ident" id="7452708">want</span><span class="op" id="7452712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452719">}</span><br>
<span class="lineno">20</span><span class="op" id="7452721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7452724">func</span>&nbsp;<span class="ident" id="7452729">TestTypeByExtensionCase</span><span class="op" id="7452752">(</span><span class="ident" id="7452753">t</span>&nbsp;<span class="op" id="7452755">*</span><span class="ident" id="7452756">testing</span><span class="op" id="7452763">.</span><span class="ident" id="7452764">T</span><span class="op" id="7452765">)</span>&nbsp;<span class="op" id="7452767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452770">const</span>&nbsp;<span class="ident" id="7452776">custom</span>&nbsp;<span class="op" id="7452783">=</span>&nbsp;<span class="string" id="7452785">&#34;test/test;&nbsp;charset=iso-8859-1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452818">const</span>&nbsp;<span class="ident" id="7452824">caps</span>&nbsp;<span class="op" id="7452829">=</span>&nbsp;<span class="string" id="7452831">&#34;test/test;&nbsp;WAS=ALLCAPS&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452857">if</span>&nbsp;<span class="ident" id="7452860">err</span>&nbsp;<span class="op" id="7452864">:=</span>&nbsp;<span class="ident" id="7452867">AddExtensionType</span><span class="op" id="7452883">(</span><span class="string" id="7452884">&#34;.TEST&#34;</span><span class="op" id="7452891">,</span>&nbsp;<span class="ident" id="7452893">caps</span><span class="op" id="7452897">)</span><span class="op" id="7452898">;</span>&nbsp;<span class="ident" id="7452900">err</span>&nbsp;<span class="op" id="7452904">!=</span>&nbsp;<span class="ident" id="7452907">nil</span>&nbsp;<span class="op" id="7452911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7452915">t</span><span class="op" id="7452916">.</span><span class="ident" id="7452917">Fatalf</span><span class="op" id="7452923">(</span><span class="string" id="7452924">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="7452955">,</span>&nbsp;<span class="ident" id="7452957">err</span><span class="op" id="7452960">,</span>&nbsp;<span class="ident" id="7452962">custom</span><span class="op" id="7452968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7452971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7452974">if</span>&nbsp;<span class="ident" id="7452977">err</span>&nbsp;<span class="op" id="7452981">:=</span>&nbsp;<span class="ident" id="7452984">AddExtensionType</span><span class="op" id="7453000">(</span><span class="string" id="7453001">&#34;.tesT&#34;</span><span class="op" id="7453008">,</span>&nbsp;<span class="ident" id="7453010">custom</span><span class="op" id="7453016">)</span><span class="op" id="7453017">;</span>&nbsp;<span class="ident" id="7453019">err</span>&nbsp;<span class="op" id="7453023">!=</span>&nbsp;<span class="ident" id="7453026">nil</span>&nbsp;<span class="op" id="7453030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453034">t</span><span class="op" id="7453035">.</span><span class="ident" id="7453036">Fatalf</span><span class="op" id="7453042">(</span><span class="string" id="7453043">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="7453074">,</span>&nbsp;<span class="ident" id="7453076">err</span><span class="op" id="7453079">,</span>&nbsp;<span class="ident" id="7453081">custom</span><span class="op" id="7453087">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7453094">//&nbsp;case-sensitive&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7453120">if</span>&nbsp;<span class="ident" id="7453123">got</span>&nbsp;<span class="op" id="7453127">:=</span>&nbsp;<span class="ident" id="7453130">TypeByExtension</span><span class="op" id="7453145">(</span><span class="string" id="7453146">&#34;.tesT&#34;</span><span class="op" id="7453153">)</span><span class="op" id="7453154">;</span>&nbsp;<span class="ident" id="7453156">got</span>&nbsp;<span class="op" id="7453160">!=</span>&nbsp;<span class="ident" id="7453163">custom</span>&nbsp;<span class="op" id="7453170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453174">t</span><span class="op" id="7453175">.</span><span class="ident" id="7453176">Fatalf</span><span class="op" id="7453182">(</span><span class="string" id="7453183">&#34;for&nbsp;.tesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7453211">,</span>&nbsp;<span class="ident" id="7453213">got</span><span class="op" id="7453216">,</span>&nbsp;<span class="ident" id="7453218">custom</span><span class="op" id="7453224">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7453230">if</span>&nbsp;<span class="ident" id="7453233">got</span>&nbsp;<span class="op" id="7453237">:=</span>&nbsp;<span class="ident" id="7453240">TypeByExtension</span><span class="op" id="7453255">(</span><span class="string" id="7453256">&#34;.TEST&#34;</span><span class="op" id="7453263">)</span><span class="op" id="7453264">;</span>&nbsp;<span class="ident" id="7453266">got</span>&nbsp;<span class="op" id="7453270">!=</span>&nbsp;<span class="ident" id="7453273">caps</span>&nbsp;<span class="op" id="7453278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453282">t</span><span class="op" id="7453283">.</span><span class="ident" id="7453284">Fatalf</span><span class="op" id="7453290">(</span><span class="string" id="7453291">&#34;for&nbsp;.TEST,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7453319">,</span>&nbsp;<span class="ident" id="7453321">got</span><span class="op" id="7453324">,</span>&nbsp;<span class="ident" id="7453326">caps</span><span class="op" id="7453330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7453337">//&nbsp;case-insensitive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7453358">if</span>&nbsp;<span class="ident" id="7453361">got</span>&nbsp;<span class="op" id="7453365">:=</span>&nbsp;<span class="ident" id="7453368">TypeByExtension</span><span class="op" id="7453383">(</span><span class="string" id="7453384">&#34;.TesT&#34;</span><span class="op" id="7453391">)</span><span class="op" id="7453392">;</span>&nbsp;<span class="ident" id="7453394">got</span>&nbsp;<span class="op" id="7453398">!=</span>&nbsp;<span class="ident" id="7453401">custom</span>&nbsp;<span class="op" id="7453408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453412">t</span><span class="op" id="7453413">.</span><span class="ident" id="7453414">Fatalf</span><span class="op" id="7453420">(</span><span class="string" id="7453421">&#34;for&nbsp;.TesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7453449">,</span>&nbsp;<span class="ident" id="7453451">got</span><span class="op" id="7453454">,</span>&nbsp;<span class="ident" id="7453456">custom</span><span class="op" id="7453462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453465">}</span><br>
<span class="lineno"></span><span class="op" id="7453467">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7453470">func</span>&nbsp;<span class="ident" id="7453475">TestLookupMallocs</span><span class="op" id="7453492">(</span><span class="ident" id="7453493">t</span>&nbsp;<span class="op" id="7453495">*</span><span class="ident" id="7453496">testing</span><span class="op" id="7453503">.</span><span class="ident" id="7453504">T</span><span class="op" id="7453505">)</span>&nbsp;<span class="op" id="7453507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453510">n</span>&nbsp;<span class="op" id="7453512">:=</span>&nbsp;<span class="ident" id="7453515">testing</span><span class="op" id="7453522">.</span><span class="ident" id="7453523">AllocsPerRun</span><span class="op" id="7453535">(</span><span class="num" id="7453536">10000</span><span class="op" id="7453541">,</span>&nbsp;<span class="keyword" id="7453543">func</span><span class="op" id="7453547">(</span><span class="op" id="7453548">)</span>&nbsp;<span class="op" id="7453550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453554">TypeByExtension</span><span class="op" id="7453569">(</span><span class="string" id="7453570">&#34;.html&#34;</span><span class="op" id="7453577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453581">TypeByExtension</span><span class="op" id="7453596">(</span><span class="string" id="7453597">&#34;.HtML&#34;</span><span class="op" id="7453604">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453607">}</span><span class="op" id="7453608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7453611">if</span>&nbsp;<span class="ident" id="7453614">n</span>&nbsp;<span class="op" id="7453616">&gt;</span>&nbsp;<span class="num" id="7453618">0</span>&nbsp;<span class="op" id="7453620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7453624">t</span><span class="op" id="7453625">.</span><span class="ident" id="7453626">Errorf</span><span class="op" id="7453632">(</span><span class="string" id="7453633">&#34;allocs&nbsp;=&nbsp;%v;&nbsp;want&nbsp;0&#34;</span><span class="op" id="7453654">,</span>&nbsp;<span class="ident" id="7453656">n</span><span class="op" id="7453657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7453660">}</span><br>
<span class="lineno"></span><span class="op" id="7453662">}</span>
</div>
</body>
</html>
