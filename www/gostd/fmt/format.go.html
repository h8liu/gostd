<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html" class="current">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2383381">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2383436">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2383490">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2383541">package</span>&nbsp;<span class="ident" id="2383549">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2383554">import</span>&nbsp;<span class="op" id="2383561">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2383564">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2383572">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2383583">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2383598">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2383601">const</span>&nbsp;<span class="op" id="2383607">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383610">//&nbsp;%b&nbsp;of&nbsp;an&nbsp;int64,&nbsp;plus&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2383643">//&nbsp;Hex&nbsp;can&nbsp;add&nbsp;0x&nbsp;and&nbsp;we&nbsp;handle&nbsp;it&nbsp;specially.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2383690">nByte</span>&nbsp;<span class="op" id="2383696">=</span>&nbsp;<span class="num" id="2383698">65</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2383703">ldigits</span>&nbsp;<span class="op" id="2383711">=</span>&nbsp;<span class="string" id="2383713">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2383733">udigits</span>&nbsp;<span class="op" id="2383741">=</span>&nbsp;<span class="string" id="2383743">&#34;0123456789ABCDEF&#34;</span><br>
<span class="lineno">20</span><span class="op" id="2383762">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2383765">const</span>&nbsp;<span class="op" id="2383771">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2383774">signed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2383783">=</span>&nbsp;<span class="builtintype" id="2383785">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2383791">unsigned</span>&nbsp;<span class="op" id="2383800">=</span>&nbsp;<span class="builtintype" id="2383802">false</span><br>
<span class="lineno">25</span><span class="op" id="2383808">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2383811">var</span>&nbsp;<span class="ident" id="2383815">padZeroBytes</span>&nbsp;<span class="op" id="2383828">=</span>&nbsp;<span class="builtinfunc" id="2383830">make</span><span class="op" id="2383834">(</span><span class="op" id="2383835">[</span><span class="op" id="2383836">]</span><span class="builtintype" id="2383837">byte</span><span class="op" id="2383841">,</span>&nbsp;<span class="ident" id="2383843">nByte</span><span class="op" id="2383848">)</span><br>
<span class="lineno"></span><span class="keyword" id="2383850">var</span>&nbsp;<span class="ident" id="2383854">padSpaceBytes</span>&nbsp;<span class="op" id="2383868">=</span>&nbsp;<span class="builtinfunc" id="2383870">make</span><span class="op" id="2383874">(</span><span class="op" id="2383875">[</span><span class="op" id="2383876">]</span><span class="builtintype" id="2383877">byte</span><span class="op" id="2383881">,</span>&nbsp;<span class="ident" id="2383883">nByte</span><span class="op" id="2383888">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="2383891">func</span>&nbsp;<span class="ident" id="2383896">init</span><span class="op" id="2383900">(</span><span class="op" id="2383901">)</span>&nbsp;<span class="op" id="2383903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2383906">for</span>&nbsp;<span class="ident" id="2383910">i</span>&nbsp;<span class="op" id="2383912">:=</span>&nbsp;<span class="num" id="2383915">0</span><span class="op" id="2383916">;</span>&nbsp;<span class="ident" id="2383918">i</span>&nbsp;<span class="op" id="2383920">&lt;</span>&nbsp;<span class="ident" id="2383922">nByte</span><span class="op" id="2383927">;</span>&nbsp;<span class="ident" id="2383929">i</span><span class="op" id="2383930">++</span>&nbsp;<span class="op" id="2383933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2383937">padZeroBytes</span><span class="op" id="2383949">[</span><span class="ident" id="2383950">i</span><span class="op" id="2383951">]</span>&nbsp;<span class="op" id="2383953">=</span>&nbsp;<span class="string" id="2383955">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2383961">padSpaceBytes</span><span class="op" id="2383974">[</span><span class="ident" id="2383975">i</span><span class="op" id="2383976">]</span>&nbsp;<span class="op" id="2383978">=</span>&nbsp;<span class="string" id="2383980">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2383985">}</span><br>
<span class="lineno">35</span><span class="op" id="2383987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2383990">//&nbsp;flags&nbsp;placed&nbsp;in&nbsp;a&nbsp;separate&nbsp;struct&nbsp;for&nbsp;easy&nbsp;clearing.</span><br>
<span class="lineno"></span><span class="keyword" id="2384046">type</span>&nbsp;<span class="ident" id="2384051">fmtFlags</span>&nbsp;<span class="keyword" id="2384060">struct</span>&nbsp;<span class="op" id="2384067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384070">widPresent</span>&nbsp;&nbsp;<span class="builtintype" id="2384082">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384088">precPresent</span>&nbsp;<span class="builtintype" id="2384100">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384106">minus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2384118">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384124">plus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2384136">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384142">sharp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2384154">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384160">space</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2384172">bool</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384178">unicode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2384190">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384196">uniQuote</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2384208">bool</span>&nbsp;<span class="comment" id="2384213">//&nbsp;Use&nbsp;&#39;x&#39;=&nbsp;prefix&nbsp;for&nbsp;%U&nbsp;if&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384254">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2384266">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2384273">//&nbsp;For&nbsp;the&nbsp;formats&nbsp;%+v&nbsp;%#v,&nbsp;we&nbsp;set&nbsp;the&nbsp;plusV/sharpV&nbsp;flags</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2384332">//&nbsp;and&nbsp;clear&nbsp;the&nbsp;plus/sharp&nbsp;flags&nbsp;since&nbsp;%+v&nbsp;and&nbsp;%#v&nbsp;are&nbsp;in&nbsp;effect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2384399">//&nbsp;different,&nbsp;flagless&nbsp;formats&nbsp;set&nbsp;at&nbsp;the&nbsp;top&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384453">plusV</span>&nbsp;&nbsp;<span class="builtintype" id="2384460">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384466">sharpV</span>&nbsp;<span class="builtintype" id="2384473">bool</span><br>
<span class="lineno"></span><span class="op" id="2384478">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2384481">//&nbsp;A&nbsp;fmt&nbsp;is&nbsp;the&nbsp;raw&nbsp;formatter&nbsp;used&nbsp;by&nbsp;Printf&nbsp;etc.</span><br>
<span class="lineno"></span><span class="comment" id="2384531">//&nbsp;It&nbsp;prints&nbsp;into&nbsp;a&nbsp;buffer&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="2384590">type</span>&nbsp;<span class="ident" id="2384595">fmt</span>&nbsp;<span class="keyword" id="2384599">struct</span>&nbsp;<span class="op" id="2384606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384609">intbuf</span>&nbsp;<span class="op" id="2384616">[</span><span class="ident" id="2384617">nByte</span><span class="op" id="2384622">]</span><span class="builtintype" id="2384623">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384629">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2384636">*</span><span class="ident" id="2384637">buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2384645">//&nbsp;width,&nbsp;precision</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384666">wid</span>&nbsp;&nbsp;<span class="builtintype" id="2384671">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384676">prec</span>&nbsp;<span class="builtintype" id="2384681">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384686">fmtFlags</span><br>
<span class="lineno">65</span><span class="op" id="2384695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2384698">func</span>&nbsp;<span class="op" id="2384703">(</span><span class="ident" id="2384704">f</span>&nbsp;<span class="op" id="2384706">*</span><span class="ident" id="2384707">fmt</span><span class="op" id="2384710">)</span>&nbsp;<span class="ident" id="2384712">clearflags</span><span class="op" id="2384722">(</span><span class="op" id="2384723">)</span>&nbsp;<span class="op" id="2384725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384728">f</span><span class="op" id="2384729">.</span><span class="ident" id="2384730">fmtFlags</span>&nbsp;<span class="op" id="2384739">=</span>&nbsp;<span class="ident" id="2384741">fmtFlags</span><span class="op" id="2384749">{</span><span class="op" id="2384750">}</span><br>
<span class="lineno"></span><span class="op" id="2384752">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2384755">func</span>&nbsp;<span class="op" id="2384760">(</span><span class="ident" id="2384761">f</span>&nbsp;<span class="op" id="2384763">*</span><span class="ident" id="2384764">fmt</span><span class="op" id="2384767">)</span>&nbsp;<span class="ident" id="2384769">init</span><span class="op" id="2384773">(</span><span class="ident" id="2384774">buf</span>&nbsp;<span class="op" id="2384778">*</span><span class="ident" id="2384779">buffer</span><span class="op" id="2384785">)</span>&nbsp;<span class="op" id="2384787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384790">f</span><span class="op" id="2384791">.</span><span class="ident" id="2384792">buf</span>&nbsp;<span class="op" id="2384796">=</span>&nbsp;<span class="ident" id="2384798">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384803">f</span><span class="op" id="2384804">.</span><span class="ident" id="2384805">clearflags</span><span class="op" id="2384815">(</span><span class="op" id="2384816">)</span><br>
<span class="lineno"></span><span class="op" id="2384818">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2384821">//&nbsp;computePadding&nbsp;computes&nbsp;left&nbsp;and&nbsp;right&nbsp;padding&nbsp;widths&nbsp;(only&nbsp;one&nbsp;will&nbsp;be&nbsp;non-zero).</span><br>
<span class="lineno"></span><span class="keyword" id="2384907">func</span>&nbsp;<span class="op" id="2384912">(</span><span class="ident" id="2384913">f</span>&nbsp;<span class="op" id="2384915">*</span><span class="ident" id="2384916">fmt</span><span class="op" id="2384919">)</span>&nbsp;<span class="ident" id="2384921">computePadding</span><span class="op" id="2384935">(</span><span class="ident" id="2384936">width</span>&nbsp;<span class="builtintype" id="2384942">int</span><span class="op" id="2384945">)</span>&nbsp;<span class="op" id="2384947">(</span><span class="ident" id="2384948">padding</span>&nbsp;<span class="op" id="2384956">[</span><span class="op" id="2384957">]</span><span class="builtintype" id="2384958">byte</span><span class="op" id="2384962">,</span>&nbsp;<span class="ident" id="2384964">leftWidth</span><span class="op" id="2384973">,</span>&nbsp;<span class="ident" id="2384975">rightWidth</span>&nbsp;<span class="builtintype" id="2384986">int</span><span class="op" id="2384989">)</span>&nbsp;<span class="op" id="2384991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2384994">left</span>&nbsp;<span class="op" id="2384999">:=</span>&nbsp;<span class="op" id="2385002">!</span><span class="ident" id="2385003">f</span><span class="op" id="2385004">.</span><span class="ident" id="2385005">minus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385012">w</span>&nbsp;<span class="op" id="2385014">:=</span>&nbsp;<span class="ident" id="2385017">f</span><span class="op" id="2385018">.</span><span class="ident" id="2385019">wid</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385024">if</span>&nbsp;<span class="ident" id="2385027">w</span>&nbsp;<span class="op" id="2385029">&lt;</span>&nbsp;<span class="num" id="2385031">0</span>&nbsp;<span class="op" id="2385033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385037">left</span>&nbsp;<span class="op" id="2385042">=</span>&nbsp;<span class="builtintype" id="2385044">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385052">w</span>&nbsp;<span class="op" id="2385054">=</span>&nbsp;<span class="op" id="2385056">-</span><span class="ident" id="2385057">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2385060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385063">w</span>&nbsp;<span class="op" id="2385065">-=</span>&nbsp;<span class="ident" id="2385068">width</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385075">if</span>&nbsp;<span class="ident" id="2385078">w</span>&nbsp;<span class="op" id="2385080">&gt;</span>&nbsp;<span class="num" id="2385082">0</span>&nbsp;<span class="op" id="2385084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385088">if</span>&nbsp;<span class="ident" id="2385091">left</span>&nbsp;<span class="op" id="2385096">&amp;&amp;</span>&nbsp;<span class="ident" id="2385099">f</span><span class="op" id="2385100">.</span><span class="ident" id="2385101">zero</span>&nbsp;<span class="op" id="2385106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385111">return</span>&nbsp;<span class="ident" id="2385118">padZeroBytes</span><span class="op" id="2385130">,</span>&nbsp;<span class="ident" id="2385132">w</span><span class="op" id="2385133">,</span>&nbsp;<span class="num" id="2385135">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2385139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385143">if</span>&nbsp;<span class="ident" id="2385146">left</span>&nbsp;<span class="op" id="2385151">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385156">return</span>&nbsp;<span class="ident" id="2385163">padSpaceBytes</span><span class="op" id="2385176">,</span>&nbsp;<span class="ident" id="2385178">w</span><span class="op" id="2385179">,</span>&nbsp;<span class="num" id="2385181">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2385185">}</span>&nbsp;<span class="keyword" id="2385187">else</span>&nbsp;<span class="op" id="2385192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2385197">//&nbsp;can&#39;t&nbsp;be&nbsp;zero&nbsp;padding&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385238">return</span>&nbsp;<span class="ident" id="2385245">padSpaceBytes</span><span class="op" id="2385258">,</span>&nbsp;<span class="num" id="2385260">0</span><span class="op" id="2385261">,</span>&nbsp;<span class="ident" id="2385263">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2385267">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2385270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385273">return</span><br>
<span class="lineno"></span><span class="op" id="2385280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2385283">//&nbsp;writePadding&nbsp;generates&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding.</span><br>
<span class="lineno">100</span><span class="keyword" id="2385329">func</span>&nbsp;<span class="op" id="2385334">(</span><span class="ident" id="2385335">f</span>&nbsp;<span class="op" id="2385337">*</span><span class="ident" id="2385338">fmt</span><span class="op" id="2385341">)</span>&nbsp;<span class="ident" id="2385343">writePadding</span><span class="op" id="2385355">(</span><span class="ident" id="2385356">n</span>&nbsp;<span class="builtintype" id="2385358">int</span><span class="op" id="2385361">,</span>&nbsp;<span class="ident" id="2385363">padding</span>&nbsp;<span class="op" id="2385371">[</span><span class="op" id="2385372">]</span><span class="builtintype" id="2385373">byte</span><span class="op" id="2385377">)</span>&nbsp;<span class="op" id="2385379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385382">for</span>&nbsp;<span class="ident" id="2385386">n</span>&nbsp;<span class="op" id="2385388">&gt;</span>&nbsp;<span class="num" id="2385390">0</span>&nbsp;<span class="op" id="2385392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385396">m</span>&nbsp;<span class="op" id="2385398">:=</span>&nbsp;<span class="ident" id="2385401">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385405">if</span>&nbsp;<span class="ident" id="2385408">m</span>&nbsp;<span class="op" id="2385410">&gt;</span>&nbsp;<span class="ident" id="2385412">nByte</span>&nbsp;<span class="op" id="2385418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385423">m</span>&nbsp;<span class="op" id="2385425">=</span>&nbsp;<span class="ident" id="2385427">nByte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2385435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385439">f</span><span class="op" id="2385440">.</span><span class="ident" id="2385441">buf</span><span class="op" id="2385444">.</span><span class="ident" id="2385445">Write</span><span class="op" id="2385450">(</span><span class="ident" id="2385451">padding</span><span class="op" id="2385458">[</span><span class="num" id="2385459">0</span><span class="op" id="2385460">:</span><span class="ident" id="2385461">m</span><span class="op" id="2385462">]</span><span class="op" id="2385463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385467">n</span>&nbsp;<span class="op" id="2385469">-=</span>&nbsp;<span class="ident" id="2385472">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2385475">}</span><br>
<span class="lineno"></span><span class="op" id="2385477">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2385480">//&nbsp;pad&nbsp;appends&nbsp;b&nbsp;to&nbsp;f.buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2385559">func</span>&nbsp;<span class="op" id="2385564">(</span><span class="ident" id="2385565">f</span>&nbsp;<span class="op" id="2385567">*</span><span class="ident" id="2385568">fmt</span><span class="op" id="2385571">)</span>&nbsp;<span class="ident" id="2385573">pad</span><span class="op" id="2385576">(</span><span class="ident" id="2385577">b</span>&nbsp;<span class="op" id="2385579">[</span><span class="op" id="2385580">]</span><span class="builtintype" id="2385581">byte</span><span class="op" id="2385585">)</span>&nbsp;<span class="op" id="2385587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385590">if</span>&nbsp;<span class="op" id="2385593">!</span><span class="ident" id="2385594">f</span><span class="op" id="2385595">.</span><span class="ident" id="2385596">widPresent</span>&nbsp;<span class="op" id="2385607">||</span>&nbsp;<span class="ident" id="2385610">f</span><span class="op" id="2385611">.</span><span class="ident" id="2385612">wid</span>&nbsp;<span class="op" id="2385616">==</span>&nbsp;<span class="num" id="2385619">0</span>&nbsp;<span class="op" id="2385621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385625">f</span><span class="op" id="2385626">.</span><span class="ident" id="2385627">buf</span><span class="op" id="2385630">.</span><span class="ident" id="2385631">Write</span><span class="op" id="2385636">(</span><span class="ident" id="2385637">b</span><span class="op" id="2385638">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385642">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2385650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385653">padding</span><span class="op" id="2385660">,</span>&nbsp;<span class="ident" id="2385662">left</span><span class="op" id="2385666">,</span>&nbsp;<span class="ident" id="2385668">right</span>&nbsp;<span class="op" id="2385674">:=</span>&nbsp;<span class="ident" id="2385677">f</span><span class="op" id="2385678">.</span><span class="ident" id="2385679">computePadding</span><span class="op" id="2385693">(</span><span class="ident" id="2385694">utf8</span><span class="op" id="2385698">.</span><span class="ident" id="2385699">RuneCount</span><span class="op" id="2385708">(</span><span class="ident" id="2385709">b</span><span class="op" id="2385710">)</span><span class="op" id="2385711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385714">if</span>&nbsp;<span class="ident" id="2385717">left</span>&nbsp;<span class="op" id="2385722">&gt;</span>&nbsp;<span class="num" id="2385724">0</span>&nbsp;<span class="op" id="2385726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385730">f</span><span class="op" id="2385731">.</span><span class="ident" id="2385732">writePadding</span><span class="op" id="2385744">(</span><span class="ident" id="2385745">left</span><span class="op" id="2385749">,</span>&nbsp;<span class="ident" id="2385751">padding</span><span class="op" id="2385758">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2385761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385764">f</span><span class="op" id="2385765">.</span><span class="ident" id="2385766">buf</span><span class="op" id="2385769">.</span><span class="ident" id="2385770">Write</span><span class="op" id="2385775">(</span><span class="ident" id="2385776">b</span><span class="op" id="2385777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385780">if</span>&nbsp;<span class="ident" id="2385783">right</span>&nbsp;<span class="op" id="2385789">&gt;</span>&nbsp;<span class="num" id="2385791">0</span>&nbsp;<span class="op" id="2385793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385797">f</span><span class="op" id="2385798">.</span><span class="ident" id="2385799">writePadding</span><span class="op" id="2385811">(</span><span class="ident" id="2385812">right</span><span class="op" id="2385817">,</span>&nbsp;<span class="ident" id="2385819">padding</span><span class="op" id="2385826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2385829">}</span><br>
<span class="lineno">125</span><span class="op" id="2385831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2385834">//&nbsp;padString&nbsp;appends&nbsp;s&nbsp;to&nbsp;buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2385917">func</span>&nbsp;<span class="op" id="2385922">(</span><span class="ident" id="2385923">f</span>&nbsp;<span class="op" id="2385925">*</span><span class="ident" id="2385926">fmt</span><span class="op" id="2385929">)</span>&nbsp;<span class="ident" id="2385931">padString</span><span class="op" id="2385940">(</span><span class="ident" id="2385941">s</span>&nbsp;<span class="builtintype" id="2385943">string</span><span class="op" id="2385949">)</span>&nbsp;<span class="op" id="2385951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2385954">if</span>&nbsp;<span class="op" id="2385957">!</span><span class="ident" id="2385958">f</span><span class="op" id="2385959">.</span><span class="ident" id="2385960">widPresent</span>&nbsp;<span class="op" id="2385971">||</span>&nbsp;<span class="ident" id="2385974">f</span><span class="op" id="2385975">.</span><span class="ident" id="2385976">wid</span>&nbsp;<span class="op" id="2385980">==</span>&nbsp;<span class="num" id="2385983">0</span>&nbsp;<span class="op" id="2385985">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2385989">f</span><span class="op" id="2385990">.</span><span class="ident" id="2385991">buf</span><span class="op" id="2385994">.</span><span class="ident" id="2385995">WriteString</span><span class="op" id="2386006">(</span><span class="ident" id="2386007">s</span><span class="op" id="2386008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386012">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2386020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386023">padding</span><span class="op" id="2386030">,</span>&nbsp;<span class="ident" id="2386032">left</span><span class="op" id="2386036">,</span>&nbsp;<span class="ident" id="2386038">right</span>&nbsp;<span class="op" id="2386044">:=</span>&nbsp;<span class="ident" id="2386047">f</span><span class="op" id="2386048">.</span><span class="ident" id="2386049">computePadding</span><span class="op" id="2386063">(</span><span class="ident" id="2386064">utf8</span><span class="op" id="2386068">.</span><span class="ident" id="2386069">RuneCountInString</span><span class="op" id="2386086">(</span><span class="ident" id="2386087">s</span><span class="op" id="2386088">)</span><span class="op" id="2386089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386092">if</span>&nbsp;<span class="ident" id="2386095">left</span>&nbsp;<span class="op" id="2386100">&gt;</span>&nbsp;<span class="num" id="2386102">0</span>&nbsp;<span class="op" id="2386104">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386108">f</span><span class="op" id="2386109">.</span><span class="ident" id="2386110">writePadding</span><span class="op" id="2386122">(</span><span class="ident" id="2386123">left</span><span class="op" id="2386127">,</span>&nbsp;<span class="ident" id="2386129">padding</span><span class="op" id="2386136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2386139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386142">f</span><span class="op" id="2386143">.</span><span class="ident" id="2386144">buf</span><span class="op" id="2386147">.</span><span class="ident" id="2386148">WriteString</span><span class="op" id="2386159">(</span><span class="ident" id="2386160">s</span><span class="op" id="2386161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386164">if</span>&nbsp;<span class="ident" id="2386167">right</span>&nbsp;<span class="op" id="2386173">&gt;</span>&nbsp;<span class="num" id="2386175">0</span>&nbsp;<span class="op" id="2386177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386181">f</span><span class="op" id="2386182">.</span><span class="ident" id="2386183">writePadding</span><span class="op" id="2386195">(</span><span class="ident" id="2386196">right</span><span class="op" id="2386201">,</span>&nbsp;<span class="ident" id="2386203">padding</span><span class="op" id="2386210">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2386213">}</span><br>
<span class="lineno"></span><span class="op" id="2386215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2386218">var</span>&nbsp;<span class="op" id="2386222">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386225">trueBytes</span>&nbsp;&nbsp;<span class="op" id="2386236">=</span>&nbsp;<span class="op" id="2386238">[</span><span class="op" id="2386239">]</span><span class="builtintype" id="2386240">byte</span><span class="op" id="2386244">(</span><span class="string" id="2386245">&#34;true&#34;</span><span class="op" id="2386251">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386254">falseBytes</span>&nbsp;<span class="op" id="2386265">=</span>&nbsp;<span class="op" id="2386267">[</span><span class="op" id="2386268">]</span><span class="builtintype" id="2386269">byte</span><span class="op" id="2386273">(</span><span class="string" id="2386274">&#34;false&#34;</span><span class="op" id="2386281">)</span><br>
<span class="lineno"></span><span class="op" id="2386283">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2386286">//&nbsp;fmt_boolean&nbsp;formats&nbsp;a&nbsp;boolean.</span><br>
<span class="lineno"></span><span class="keyword" id="2386320">func</span>&nbsp;<span class="op" id="2386325">(</span><span class="ident" id="2386326">f</span>&nbsp;<span class="op" id="2386328">*</span><span class="ident" id="2386329">fmt</span><span class="op" id="2386332">)</span>&nbsp;<span class="ident" id="2386334">fmt_boolean</span><span class="op" id="2386345">(</span><span class="ident" id="2386346">v</span>&nbsp;<span class="builtintype" id="2386348">bool</span><span class="op" id="2386352">)</span>&nbsp;<span class="op" id="2386354">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386357">if</span>&nbsp;<span class="ident" id="2386360">v</span>&nbsp;<span class="op" id="2386362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386366">f</span><span class="op" id="2386367">.</span><span class="ident" id="2386368">pad</span><span class="op" id="2386371">(</span><span class="ident" id="2386372">trueBytes</span><span class="op" id="2386381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2386384">}</span>&nbsp;<span class="keyword" id="2386386">else</span>&nbsp;<span class="op" id="2386391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386395">f</span><span class="op" id="2386396">.</span><span class="ident" id="2386397">pad</span><span class="op" id="2386400">(</span><span class="ident" id="2386401">falseBytes</span><span class="op" id="2386411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2386414">}</span><br>
<span class="lineno">155</span><span class="op" id="2386416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2386419">//&nbsp;integer;&nbsp;interprets&nbsp;prec&nbsp;but&nbsp;not&nbsp;wid.&nbsp;&nbsp;Once&nbsp;formatted,&nbsp;result&nbsp;is&nbsp;sent&nbsp;to&nbsp;pad()</span><br>
<span class="lineno"></span><span class="comment" id="2386501">//&nbsp;and&nbsp;then&nbsp;flags&nbsp;are&nbsp;cleared.</span><br>
<span class="lineno"></span><span class="keyword" id="2386532">func</span>&nbsp;<span class="op" id="2386537">(</span><span class="ident" id="2386538">f</span>&nbsp;<span class="op" id="2386540">*</span><span class="ident" id="2386541">fmt</span><span class="op" id="2386544">)</span>&nbsp;<span class="ident" id="2386546">integer</span><span class="op" id="2386553">(</span><span class="ident" id="2386554">a</span>&nbsp;<span class="builtintype" id="2386556">int64</span><span class="op" id="2386561">,</span>&nbsp;<span class="ident" id="2386563">base</span>&nbsp;<span class="builtintype" id="2386568">uint64</span><span class="op" id="2386574">,</span>&nbsp;<span class="ident" id="2386576">signedness</span>&nbsp;<span class="builtintype" id="2386587">bool</span><span class="op" id="2386591">,</span>&nbsp;<span class="ident" id="2386593">digits</span>&nbsp;<span class="builtintype" id="2386600">string</span><span class="op" id="2386606">)</span>&nbsp;<span class="op" id="2386608">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2386611">//&nbsp;precision&nbsp;of&nbsp;0&nbsp;and&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;&#34;print&nbsp;nothing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386667">if</span>&nbsp;<span class="ident" id="2386670">f</span><span class="op" id="2386671">.</span><span class="ident" id="2386672">precPresent</span>&nbsp;<span class="op" id="2386684">&amp;&amp;</span>&nbsp;<span class="ident" id="2386687">f</span><span class="op" id="2386688">.</span><span class="ident" id="2386689">prec</span>&nbsp;<span class="op" id="2386694">==</span>&nbsp;<span class="num" id="2386697">0</span>&nbsp;<span class="op" id="2386699">&amp;&amp;</span>&nbsp;<span class="ident" id="2386702">a</span>&nbsp;<span class="op" id="2386704">==</span>&nbsp;<span class="num" id="2386707">0</span>&nbsp;<span class="op" id="2386709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386713">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2386721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386725">var</span>&nbsp;<span class="ident" id="2386729">buf</span>&nbsp;<span class="op" id="2386733">[</span><span class="op" id="2386734">]</span><span class="builtintype" id="2386735">byte</span>&nbsp;<span class="op" id="2386740">=</span>&nbsp;<span class="ident" id="2386742">f</span><span class="op" id="2386743">.</span><span class="ident" id="2386744">intbuf</span><span class="op" id="2386750">[</span><span class="num" id="2386751">0</span><span class="op" id="2386752">:</span><span class="op" id="2386753">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386756">if</span>&nbsp;<span class="ident" id="2386759">f</span><span class="op" id="2386760">.</span><span class="ident" id="2386761">widPresent</span>&nbsp;<span class="op" id="2386772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386776">width</span>&nbsp;<span class="op" id="2386782">:=</span>&nbsp;<span class="ident" id="2386785">f</span><span class="op" id="2386786">.</span><span class="ident" id="2386787">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386793">if</span>&nbsp;<span class="ident" id="2386796">base</span>&nbsp;<span class="op" id="2386801">==</span>&nbsp;<span class="num" id="2386804">16</span>&nbsp;<span class="op" id="2386807">&amp;&amp;</span>&nbsp;<span class="ident" id="2386810">f</span><span class="op" id="2386811">.</span><span class="ident" id="2386812">sharp</span>&nbsp;<span class="op" id="2386818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2386823">//&nbsp;Also&nbsp;adds&nbsp;&#34;0x&#34;.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386845">width</span>&nbsp;<span class="op" id="2386851">+=</span>&nbsp;<span class="num" id="2386854">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2386858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2386862">if</span>&nbsp;<span class="ident" id="2386865">width</span>&nbsp;<span class="op" id="2386871">&gt;</span>&nbsp;<span class="ident" id="2386873">nByte</span>&nbsp;<span class="op" id="2386879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2386884">//&nbsp;We&#39;re&nbsp;going&nbsp;to&nbsp;need&nbsp;a&nbsp;bigger&nbsp;boat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386925">buf</span>&nbsp;<span class="op" id="2386929">=</span>&nbsp;<span class="builtinfunc" id="2386931">make</span><span class="op" id="2386935">(</span><span class="op" id="2386936">[</span><span class="op" id="2386937">]</span><span class="builtintype" id="2386938">byte</span><span class="op" id="2386942">,</span>&nbsp;<span class="ident" id="2386944">width</span><span class="op" id="2386949">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2386953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2386956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2386960">negative</span>&nbsp;<span class="op" id="2386969">:=</span>&nbsp;<span class="ident" id="2386972">signedness</span>&nbsp;<span class="op" id="2386983">==</span>&nbsp;<span class="ident" id="2386986">signed</span>&nbsp;<span class="op" id="2386993">&amp;&amp;</span>&nbsp;<span class="ident" id="2386996">a</span>&nbsp;<span class="op" id="2386998">&lt;</span>&nbsp;<span class="num" id="2387000">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2387003">if</span>&nbsp;<span class="ident" id="2387006">negative</span>&nbsp;<span class="op" id="2387015">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387019">a</span>&nbsp;<span class="op" id="2387021">=</span>&nbsp;<span class="op" id="2387023">-</span><span class="ident" id="2387024">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2387027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387031">//&nbsp;two&nbsp;ways&nbsp;to&nbsp;ask&nbsp;for&nbsp;extra&nbsp;leading&nbsp;zero&nbsp;digits:&nbsp;%.3d&nbsp;or&nbsp;%03d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387096">//&nbsp;apparently&nbsp;the&nbsp;first&nbsp;cancels&nbsp;the&nbsp;second.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387141">prec</span>&nbsp;<span class="op" id="2387146">:=</span>&nbsp;<span class="num" id="2387149">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2387152">if</span>&nbsp;<span class="ident" id="2387155">f</span><span class="op" id="2387156">.</span><span class="ident" id="2387157">precPresent</span>&nbsp;<span class="op" id="2387169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387173">prec</span>&nbsp;<span class="op" id="2387178">=</span>&nbsp;<span class="ident" id="2387180">f</span><span class="op" id="2387181">.</span><span class="ident" id="2387182">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387189">f</span><span class="op" id="2387190">.</span><span class="ident" id="2387191">zero</span>&nbsp;<span class="op" id="2387196">=</span>&nbsp;<span class="builtintype" id="2387198">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2387205">}</span>&nbsp;<span class="keyword" id="2387207">else</span>&nbsp;<span class="keyword" id="2387212">if</span>&nbsp;<span class="ident" id="2387215">f</span><span class="op" id="2387216">.</span><span class="ident" id="2387217">zero</span>&nbsp;<span class="op" id="2387222">&amp;&amp;</span>&nbsp;<span class="ident" id="2387225">f</span><span class="op" id="2387226">.</span><span class="ident" id="2387227">widPresent</span>&nbsp;<span class="op" id="2387238">&amp;&amp;</span>&nbsp;<span class="op" id="2387241">!</span><span class="ident" id="2387242">f</span><span class="op" id="2387243">.</span><span class="ident" id="2387244">minus</span>&nbsp;<span class="op" id="2387250">&amp;&amp;</span>&nbsp;<span class="ident" id="2387253">f</span><span class="op" id="2387254">.</span><span class="ident" id="2387255">wid</span>&nbsp;<span class="op" id="2387259">&gt;</span>&nbsp;<span class="num" id="2387261">0</span>&nbsp;<span class="op" id="2387263">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387267">prec</span>&nbsp;<span class="op" id="2387272">=</span>&nbsp;<span class="ident" id="2387274">f</span><span class="op" id="2387275">.</span><span class="ident" id="2387276">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2387282">if</span>&nbsp;<span class="ident" id="2387285">negative</span>&nbsp;<span class="op" id="2387294">||</span>&nbsp;<span class="ident" id="2387297">f</span><span class="op" id="2387298">.</span><span class="ident" id="2387299">plus</span>&nbsp;<span class="op" id="2387304">||</span>&nbsp;<span class="ident" id="2387307">f</span><span class="op" id="2387308">.</span><span class="ident" id="2387309">space</span>&nbsp;<span class="op" id="2387315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387320">prec</span><span class="op" id="2387324">--</span>&nbsp;<span class="comment" id="2387327">//&nbsp;leave&nbsp;room&nbsp;for&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2387352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2387355">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387359">//&nbsp;format&nbsp;a&nbsp;into&nbsp;buf,&nbsp;ending&nbsp;at&nbsp;buf[i].&nbsp;&nbsp;(printing&nbsp;is&nbsp;easier&nbsp;right-to-left.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387437">//&nbsp;a&nbsp;is&nbsp;made&nbsp;into&nbsp;unsigned&nbsp;ua.&nbsp;&nbsp;we&nbsp;could&nbsp;make&nbsp;things</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387491">//&nbsp;marginally&nbsp;faster&nbsp;by&nbsp;splitting&nbsp;the&nbsp;32-bit&nbsp;case&nbsp;out&nbsp;into&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387562">//&nbsp;block&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;duplication,&nbsp;so&nbsp;ua&nbsp;has&nbsp;64&nbsp;bits.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387627">i</span>&nbsp;<span class="op" id="2387629">:=</span>&nbsp;<span class="builtinfunc" id="2387632">len</span><span class="op" id="2387635">(</span><span class="ident" id="2387636">buf</span><span class="op" id="2387639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387642">ua</span>&nbsp;<span class="op" id="2387645">:=</span>&nbsp;<span class="builtintype" id="2387648">uint64</span><span class="op" id="2387654">(</span><span class="ident" id="2387655">a</span><span class="op" id="2387656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387659">//&nbsp;use&nbsp;constants&nbsp;for&nbsp;the&nbsp;division&nbsp;and&nbsp;modulo&nbsp;for&nbsp;more&nbsp;efficient&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2387730">//&nbsp;switch&nbsp;cases&nbsp;ordered&nbsp;by&nbsp;popularity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2387770">switch</span>&nbsp;<span class="ident" id="2387777">base</span>&nbsp;<span class="op" id="2387782">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2387785">case</span>&nbsp;<span class="num" id="2387790">10</span><span class="op" id="2387792">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2387796">for</span>&nbsp;<span class="ident" id="2387800">ua</span>&nbsp;<span class="op" id="2387803">&gt;=</span>&nbsp;<span class="num" id="2387806">10</span>&nbsp;<span class="op" id="2387809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387814">i</span><span class="op" id="2387815">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387821">next</span>&nbsp;<span class="op" id="2387826">:=</span>&nbsp;<span class="ident" id="2387829">ua</span>&nbsp;<span class="op" id="2387832">/</span>&nbsp;<span class="num" id="2387834">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387840">buf</span><span class="op" id="2387843">[</span><span class="ident" id="2387844">i</span><span class="op" id="2387845">]</span>&nbsp;<span class="op" id="2387847">=</span>&nbsp;<span class="builtintype" id="2387849">byte</span><span class="op" id="2387853">(</span><span class="string" id="2387854">&#39;0&#39;</span>&nbsp;<span class="op" id="2387858">+</span>&nbsp;<span class="ident" id="2387860">ua</span>&nbsp;<span class="op" id="2387863">-</span>&nbsp;<span class="ident" id="2387865">next</span><span class="op" id="2387869">*</span><span class="num" id="2387870">10</span><span class="op" id="2387872">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387877">ua</span>&nbsp;<span class="op" id="2387880">=</span>&nbsp;<span class="ident" id="2387882">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2387889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2387892">case</span>&nbsp;<span class="num" id="2387897">16</span><span class="op" id="2387899">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2387903">for</span>&nbsp;<span class="ident" id="2387907">ua</span>&nbsp;<span class="op" id="2387910">&gt;=</span>&nbsp;<span class="num" id="2387913">16</span>&nbsp;<span class="op" id="2387916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387921">i</span><span class="op" id="2387922">--</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387928">buf</span><span class="op" id="2387931">[</span><span class="ident" id="2387932">i</span><span class="op" id="2387933">]</span>&nbsp;<span class="op" id="2387935">=</span>&nbsp;<span class="ident" id="2387937">digits</span><span class="op" id="2387943">[</span><span class="ident" id="2387944">ua</span><span class="op" id="2387946">&amp;</span><span class="num" id="2387947">0xF</span><span class="op" id="2387950">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387955">ua</span>&nbsp;<span class="op" id="2387958">&gt;&gt;=</span>&nbsp;<span class="num" id="2387962">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2387966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2387969">case</span>&nbsp;<span class="num" id="2387974">8</span><span class="op" id="2387975">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2387979">for</span>&nbsp;<span class="ident" id="2387983">ua</span>&nbsp;<span class="op" id="2387986">&gt;=</span>&nbsp;<span class="num" id="2387989">8</span>&nbsp;<span class="op" id="2387991">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2387996">i</span><span class="op" id="2387997">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388003">buf</span><span class="op" id="2388006">[</span><span class="ident" id="2388007">i</span><span class="op" id="2388008">]</span>&nbsp;<span class="op" id="2388010">=</span>&nbsp;<span class="builtintype" id="2388012">byte</span><span class="op" id="2388016">(</span><span class="string" id="2388017">&#39;0&#39;</span>&nbsp;<span class="op" id="2388021">+</span>&nbsp;<span class="ident" id="2388023">ua</span><span class="op" id="2388025">&amp;</span><span class="num" id="2388026">7</span><span class="op" id="2388027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388032">ua</span>&nbsp;<span class="op" id="2388035">&gt;&gt;=</span>&nbsp;<span class="num" id="2388039">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388046">case</span>&nbsp;<span class="num" id="2388051">2</span><span class="op" id="2388052">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388056">for</span>&nbsp;<span class="ident" id="2388060">ua</span>&nbsp;<span class="op" id="2388063">&gt;=</span>&nbsp;<span class="num" id="2388066">2</span>&nbsp;<span class="op" id="2388068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388073">i</span><span class="op" id="2388074">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388080">buf</span><span class="op" id="2388083">[</span><span class="ident" id="2388084">i</span><span class="op" id="2388085">]</span>&nbsp;<span class="op" id="2388087">=</span>&nbsp;<span class="builtintype" id="2388089">byte</span><span class="op" id="2388093">(</span><span class="string" id="2388094">&#39;0&#39;</span>&nbsp;<span class="op" id="2388098">+</span>&nbsp;<span class="ident" id="2388100">ua</span><span class="op" id="2388102">&amp;</span><span class="num" id="2388103">1</span><span class="op" id="2388104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388109">ua</span>&nbsp;<span class="op" id="2388112">&gt;&gt;=</span>&nbsp;<span class="num" id="2388116">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388120">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388123">default</span><span class="op" id="2388130">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2388134">panic</span><span class="op" id="2388139">(</span><span class="string" id="2388140">&#34;fmt:&nbsp;unknown&nbsp;base;&nbsp;can&#39;t&nbsp;happen&#34;</span><span class="op" id="2388173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388179">i</span><span class="op" id="2388180">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388184">buf</span><span class="op" id="2388187">[</span><span class="ident" id="2388188">i</span><span class="op" id="2388189">]</span>&nbsp;<span class="op" id="2388191">=</span>&nbsp;<span class="ident" id="2388193">digits</span><span class="op" id="2388199">[</span><span class="ident" id="2388200">ua</span><span class="op" id="2388202">]</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388205">for</span>&nbsp;<span class="ident" id="2388209">i</span>&nbsp;<span class="op" id="2388211">&gt;</span>&nbsp;<span class="num" id="2388213">0</span>&nbsp;<span class="op" id="2388215">&amp;&amp;</span>&nbsp;<span class="ident" id="2388218">prec</span>&nbsp;<span class="op" id="2388223">&gt;</span>&nbsp;<span class="builtinfunc" id="2388225">len</span><span class="op" id="2388228">(</span><span class="ident" id="2388229">buf</span><span class="op" id="2388232">)</span><span class="op" id="2388233">-</span><span class="ident" id="2388234">i</span>&nbsp;<span class="op" id="2388236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388240">i</span><span class="op" id="2388241">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388246">buf</span><span class="op" id="2388249">[</span><span class="ident" id="2388250">i</span><span class="op" id="2388251">]</span>&nbsp;<span class="op" id="2388253">=</span>&nbsp;<span class="string" id="2388255">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2388264">//&nbsp;Various&nbsp;prefixes:&nbsp;0x,&nbsp;-,&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388298">if</span>&nbsp;<span class="ident" id="2388301">f</span><span class="op" id="2388302">.</span><span class="ident" id="2388303">sharp</span>&nbsp;<span class="op" id="2388309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388313">switch</span>&nbsp;<span class="ident" id="2388320">base</span>&nbsp;<span class="op" id="2388325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388329">case</span>&nbsp;<span class="num" id="2388334">8</span><span class="op" id="2388335">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388340">if</span>&nbsp;<span class="ident" id="2388343">buf</span><span class="op" id="2388346">[</span><span class="ident" id="2388347">i</span><span class="op" id="2388348">]</span>&nbsp;<span class="op" id="2388350">!=</span>&nbsp;<span class="string" id="2388353">&#39;0&#39;</span>&nbsp;<span class="op" id="2388357">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388363">i</span><span class="op" id="2388364">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388371">buf</span><span class="op" id="2388374">[</span><span class="ident" id="2388375">i</span><span class="op" id="2388376">]</span>&nbsp;<span class="op" id="2388378">=</span>&nbsp;<span class="string" id="2388380">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388391">case</span>&nbsp;<span class="num" id="2388396">16</span><span class="op" id="2388398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388403">i</span><span class="op" id="2388404">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388410">buf</span><span class="op" id="2388413">[</span><span class="ident" id="2388414">i</span><span class="op" id="2388415">]</span>&nbsp;<span class="op" id="2388417">=</span>&nbsp;<span class="string" id="2388419">&#39;x&#39;</span>&nbsp;<span class="op" id="2388423">+</span>&nbsp;<span class="ident" id="2388425">digits</span><span class="op" id="2388431">[</span><span class="num" id="2388432">10</span><span class="op" id="2388434">]</span>&nbsp;<span class="op" id="2388436">-</span>&nbsp;<span class="string" id="2388438">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388445">i</span><span class="op" id="2388446">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388452">buf</span><span class="op" id="2388455">[</span><span class="ident" id="2388456">i</span><span class="op" id="2388457">]</span>&nbsp;<span class="op" id="2388459">=</span>&nbsp;<span class="string" id="2388461">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388470">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388473">if</span>&nbsp;<span class="ident" id="2388476">f</span><span class="op" id="2388477">.</span><span class="ident" id="2388478">unicode</span>&nbsp;<span class="op" id="2388486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388490">i</span><span class="op" id="2388491">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388496">buf</span><span class="op" id="2388499">[</span><span class="ident" id="2388500">i</span><span class="op" id="2388501">]</span>&nbsp;<span class="op" id="2388503">=</span>&nbsp;<span class="string" id="2388505">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388511">i</span><span class="op" id="2388512">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388517">buf</span><span class="op" id="2388520">[</span><span class="ident" id="2388521">i</span><span class="op" id="2388522">]</span>&nbsp;<span class="op" id="2388524">=</span>&nbsp;<span class="string" id="2388526">&#39;U&#39;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388535">if</span>&nbsp;<span class="ident" id="2388538">negative</span>&nbsp;<span class="op" id="2388547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388551">i</span><span class="op" id="2388552">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388557">buf</span><span class="op" id="2388560">[</span><span class="ident" id="2388561">i</span><span class="op" id="2388562">]</span>&nbsp;<span class="op" id="2388564">=</span>&nbsp;<span class="string" id="2388566">&#39;-&#39;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388571">}</span>&nbsp;<span class="keyword" id="2388573">else</span>&nbsp;<span class="keyword" id="2388578">if</span>&nbsp;<span class="ident" id="2388581">f</span><span class="op" id="2388582">.</span><span class="ident" id="2388583">plus</span>&nbsp;<span class="op" id="2388588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388592">i</span><span class="op" id="2388593">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388598">buf</span><span class="op" id="2388601">[</span><span class="ident" id="2388602">i</span><span class="op" id="2388603">]</span>&nbsp;<span class="op" id="2388605">=</span>&nbsp;<span class="string" id="2388607">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388612">}</span>&nbsp;<span class="keyword" id="2388614">else</span>&nbsp;<span class="keyword" id="2388619">if</span>&nbsp;<span class="ident" id="2388622">f</span><span class="op" id="2388623">.</span><span class="ident" id="2388624">space</span>&nbsp;<span class="op" id="2388630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388634">i</span><span class="op" id="2388635">--</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388640">buf</span><span class="op" id="2388643">[</span><span class="ident" id="2388644">i</span><span class="op" id="2388645">]</span>&nbsp;<span class="op" id="2388647">=</span>&nbsp;<span class="string" id="2388649">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2388654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2388658">//&nbsp;If&nbsp;we&nbsp;want&nbsp;a&nbsp;quoted&nbsp;char&nbsp;for&nbsp;%#U,&nbsp;move&nbsp;the&nbsp;data&nbsp;up&nbsp;to&nbsp;make&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2388727">if</span>&nbsp;<span class="ident" id="2388730">f</span><span class="op" id="2388731">.</span><span class="ident" id="2388732">unicode</span>&nbsp;<span class="op" id="2388740">&amp;&amp;</span>&nbsp;<span class="ident" id="2388743">f</span><span class="op" id="2388744">.</span><span class="ident" id="2388745">uniQuote</span>&nbsp;<span class="op" id="2388754">&amp;&amp;</span>&nbsp;<span class="ident" id="2388757">a</span>&nbsp;<span class="op" id="2388759">&gt;=</span>&nbsp;<span class="num" id="2388762">0</span>&nbsp;<span class="op" id="2388764">&amp;&amp;</span>&nbsp;<span class="ident" id="2388767">a</span>&nbsp;<span class="op" id="2388769">&lt;=</span>&nbsp;<span class="ident" id="2388772">utf8</span><span class="op" id="2388776">.</span><span class="ident" id="2388777">MaxRune</span>&nbsp;<span class="op" id="2388785">&amp;&amp;</span>&nbsp;<span class="ident" id="2388788">strconv</span><span class="op" id="2388795">.</span><span class="ident" id="2388796">IsPrint</span><span class="op" id="2388803">(</span><span class="builtintype" id="2388804">rune</span><span class="op" id="2388808">(</span><span class="ident" id="2388809">a</span><span class="op" id="2388810">)</span><span class="op" id="2388811">)</span>&nbsp;<span class="op" id="2388813">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388817">runeWidth</span>&nbsp;<span class="op" id="2388827">:=</span>&nbsp;<span class="ident" id="2388830">utf8</span><span class="op" id="2388834">.</span><span class="ident" id="2388835">RuneLen</span><span class="op" id="2388842">(</span><span class="builtintype" id="2388843">rune</span><span class="op" id="2388847">(</span><span class="ident" id="2388848">a</span><span class="op" id="2388849">)</span><span class="op" id="2388850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388854">width</span>&nbsp;<span class="op" id="2388860">:=</span>&nbsp;<span class="num" id="2388863">1</span>&nbsp;<span class="op" id="2388865">+</span>&nbsp;<span class="num" id="2388867">1</span>&nbsp;<span class="op" id="2388869">+</span>&nbsp;<span class="ident" id="2388871">runeWidth</span>&nbsp;<span class="op" id="2388881">+</span>&nbsp;<span class="num" id="2388883">1</span>&nbsp;<span class="comment" id="2388885">//&nbsp;space,&nbsp;quote,&nbsp;rune,&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2388916">copy</span><span class="op" id="2388920">(</span><span class="ident" id="2388921">buf</span><span class="op" id="2388924">[</span><span class="ident" id="2388925">i</span><span class="op" id="2388926">-</span><span class="ident" id="2388927">width</span><span class="op" id="2388932">:</span><span class="op" id="2388933">]</span><span class="op" id="2388934">,</span>&nbsp;<span class="ident" id="2388936">buf</span><span class="op" id="2388939">[</span><span class="ident" id="2388940">i</span><span class="op" id="2388941">:</span><span class="op" id="2388942">]</span><span class="op" id="2388943">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2388947">//&nbsp;guaranteed&nbsp;to&nbsp;have&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2388984">i</span>&nbsp;<span class="op" id="2388986">-=</span>&nbsp;<span class="ident" id="2388989">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2388997">//&nbsp;Now&nbsp;put&nbsp;&#34;&nbsp;&#39;x&#39;&#34;&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389029">j</span>&nbsp;<span class="op" id="2389031">:=</span>&nbsp;<span class="builtinfunc" id="2389034">len</span><span class="op" id="2389037">(</span><span class="ident" id="2389038">buf</span><span class="op" id="2389041">)</span>&nbsp;<span class="op" id="2389043">-</span>&nbsp;<span class="ident" id="2389045">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389053">buf</span><span class="op" id="2389056">[</span><span class="ident" id="2389057">j</span><span class="op" id="2389058">]</span>&nbsp;<span class="op" id="2389060">=</span>&nbsp;<span class="string" id="2389062">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389068">j</span><span class="op" id="2389069">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389074">buf</span><span class="op" id="2389077">[</span><span class="ident" id="2389078">j</span><span class="op" id="2389079">]</span>&nbsp;<span class="op" id="2389081">=</span>&nbsp;<span class="string" id="2389083">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389090">j</span><span class="op" id="2389091">++</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389096">utf8</span><span class="op" id="2389100">.</span><span class="ident" id="2389101">EncodeRune</span><span class="op" id="2389111">(</span><span class="ident" id="2389112">buf</span><span class="op" id="2389115">[</span><span class="ident" id="2389116">j</span><span class="op" id="2389117">:</span><span class="op" id="2389118">]</span><span class="op" id="2389119">,</span>&nbsp;<span class="builtintype" id="2389121">rune</span><span class="op" id="2389125">(</span><span class="ident" id="2389126">a</span><span class="op" id="2389127">)</span><span class="op" id="2389128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389132">j</span>&nbsp;<span class="op" id="2389134">+=</span>&nbsp;<span class="ident" id="2389137">runeWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389149">buf</span><span class="op" id="2389152">[</span><span class="ident" id="2389153">j</span><span class="op" id="2389154">]</span>&nbsp;<span class="op" id="2389156">=</span>&nbsp;<span class="string" id="2389158">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389168">f</span><span class="op" id="2389169">.</span><span class="ident" id="2389170">pad</span><span class="op" id="2389173">(</span><span class="ident" id="2389174">buf</span><span class="op" id="2389177">[</span><span class="ident" id="2389178">i</span><span class="op" id="2389179">:</span><span class="op" id="2389180">]</span><span class="op" id="2389181">)</span><br>
<span class="lineno"></span><span class="op" id="2389183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2389186">//&nbsp;truncate&nbsp;truncates&nbsp;the&nbsp;string&nbsp;to&nbsp;the&nbsp;specified&nbsp;precision,&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2389259">func</span>&nbsp;<span class="op" id="2389264">(</span><span class="ident" id="2389265">f</span>&nbsp;<span class="op" id="2389267">*</span><span class="ident" id="2389268">fmt</span><span class="op" id="2389271">)</span>&nbsp;<span class="ident" id="2389273">truncate</span><span class="op" id="2389281">(</span><span class="ident" id="2389282">s</span>&nbsp;<span class="builtintype" id="2389284">string</span><span class="op" id="2389290">)</span>&nbsp;<span class="builtintype" id="2389292">string</span>&nbsp;<span class="op" id="2389299">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389302">if</span>&nbsp;<span class="ident" id="2389305">f</span><span class="op" id="2389306">.</span><span class="ident" id="2389307">precPresent</span>&nbsp;<span class="op" id="2389319">&amp;&amp;</span>&nbsp;<span class="ident" id="2389322">f</span><span class="op" id="2389323">.</span><span class="ident" id="2389324">prec</span>&nbsp;<span class="op" id="2389329">&lt;</span>&nbsp;<span class="ident" id="2389331">utf8</span><span class="op" id="2389335">.</span><span class="ident" id="2389336">RuneCountInString</span><span class="op" id="2389353">(</span><span class="ident" id="2389354">s</span><span class="op" id="2389355">)</span>&nbsp;<span class="op" id="2389357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389361">n</span>&nbsp;<span class="op" id="2389363">:=</span>&nbsp;<span class="ident" id="2389366">f</span><span class="op" id="2389367">.</span><span class="ident" id="2389368">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389375">for</span>&nbsp;<span class="ident" id="2389379">i</span>&nbsp;<span class="op" id="2389381">:=</span>&nbsp;<span class="keyword" id="2389384">range</span>&nbsp;<span class="ident" id="2389390">s</span>&nbsp;<span class="op" id="2389392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389397">if</span>&nbsp;<span class="ident" id="2389400">n</span>&nbsp;<span class="op" id="2389402">==</span>&nbsp;<span class="num" id="2389405">0</span>&nbsp;<span class="op" id="2389407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389413">s</span>&nbsp;<span class="op" id="2389415">=</span>&nbsp;<span class="ident" id="2389417">s</span><span class="op" id="2389418">[</span><span class="op" id="2389419">:</span><span class="ident" id="2389420">i</span><span class="op" id="2389421">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389427">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389441">n</span><span class="op" id="2389442">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389450">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389453">return</span>&nbsp;<span class="ident" id="2389460">s</span><br>
<span class="lineno"></span><span class="op" id="2389462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2389465">//&nbsp;fmt_s&nbsp;formats&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2389492">func</span>&nbsp;<span class="op" id="2389497">(</span><span class="ident" id="2389498">f</span>&nbsp;<span class="op" id="2389500">*</span><span class="ident" id="2389501">fmt</span><span class="op" id="2389504">)</span>&nbsp;<span class="ident" id="2389506">fmt_s</span><span class="op" id="2389511">(</span><span class="ident" id="2389512">s</span>&nbsp;<span class="builtintype" id="2389514">string</span><span class="op" id="2389520">)</span>&nbsp;<span class="op" id="2389522">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389525">s</span>&nbsp;<span class="op" id="2389527">=</span>&nbsp;<span class="ident" id="2389529">f</span><span class="op" id="2389530">.</span><span class="ident" id="2389531">truncate</span><span class="op" id="2389539">(</span><span class="ident" id="2389540">s</span><span class="op" id="2389541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389544">f</span><span class="op" id="2389545">.</span><span class="ident" id="2389546">padString</span><span class="op" id="2389555">(</span><span class="ident" id="2389556">s</span><span class="op" id="2389557">)</span><br>
<span class="lineno"></span><span class="op" id="2389559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2389562">//&nbsp;fmt_sbx&nbsp;formats&nbsp;a&nbsp;string&nbsp;or&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">315</span><span class="keyword" id="2389644">func</span>&nbsp;<span class="op" id="2389649">(</span><span class="ident" id="2389650">f</span>&nbsp;<span class="op" id="2389652">*</span><span class="ident" id="2389653">fmt</span><span class="op" id="2389656">)</span>&nbsp;<span class="ident" id="2389658">fmt_sbx</span><span class="op" id="2389665">(</span><span class="ident" id="2389666">s</span>&nbsp;<span class="builtintype" id="2389668">string</span><span class="op" id="2389674">,</span>&nbsp;<span class="ident" id="2389676">b</span>&nbsp;<span class="op" id="2389678">[</span><span class="op" id="2389679">]</span><span class="builtintype" id="2389680">byte</span><span class="op" id="2389684">,</span>&nbsp;<span class="ident" id="2389686">digits</span>&nbsp;<span class="builtintype" id="2389693">string</span><span class="op" id="2389699">)</span>&nbsp;<span class="op" id="2389701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389704">n</span>&nbsp;<span class="op" id="2389706">:=</span>&nbsp;<span class="builtinfunc" id="2389709">len</span><span class="op" id="2389712">(</span><span class="ident" id="2389713">b</span><span class="op" id="2389714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389717">if</span>&nbsp;<span class="ident" id="2389720">b</span>&nbsp;<span class="op" id="2389722">==</span>&nbsp;<span class="builtintype" id="2389725">nil</span>&nbsp;<span class="op" id="2389729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389733">n</span>&nbsp;<span class="op" id="2389735">=</span>&nbsp;<span class="builtinfunc" id="2389737">len</span><span class="op" id="2389740">(</span><span class="ident" id="2389741">s</span><span class="op" id="2389742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389745">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389748">x</span>&nbsp;<span class="op" id="2389750">:=</span>&nbsp;<span class="ident" id="2389753">digits</span><span class="op" id="2389759">[</span><span class="num" id="2389760">10</span><span class="op" id="2389762">]</span>&nbsp;<span class="op" id="2389764">-</span>&nbsp;<span class="string" id="2389766">&#39;a&#39;</span>&nbsp;<span class="op" id="2389770">+</span>&nbsp;<span class="string" id="2389772">&#39;x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2389777">//&nbsp;TODO:&nbsp;Avoid&nbsp;buffer&nbsp;by&nbsp;pre-padding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389816">var</span>&nbsp;<span class="ident" id="2389820">buf</span>&nbsp;<span class="op" id="2389824">[</span><span class="op" id="2389825">]</span><span class="builtintype" id="2389826">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389832">for</span>&nbsp;<span class="ident" id="2389836">i</span>&nbsp;<span class="op" id="2389838">:=</span>&nbsp;<span class="num" id="2389841">0</span><span class="op" id="2389842">;</span>&nbsp;<span class="ident" id="2389844">i</span>&nbsp;<span class="op" id="2389846">&lt;</span>&nbsp;<span class="ident" id="2389848">n</span><span class="op" id="2389849">;</span>&nbsp;<span class="ident" id="2389851">i</span><span class="op" id="2389852">++</span>&nbsp;<span class="op" id="2389855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389859">if</span>&nbsp;<span class="ident" id="2389862">i</span>&nbsp;<span class="op" id="2389864">&gt;</span>&nbsp;<span class="num" id="2389866">0</span>&nbsp;<span class="op" id="2389868">&amp;&amp;</span>&nbsp;<span class="ident" id="2389871">f</span><span class="op" id="2389872">.</span><span class="ident" id="2389873">space</span>&nbsp;<span class="op" id="2389879">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389884">buf</span>&nbsp;<span class="op" id="2389888">=</span>&nbsp;<span class="builtinfunc" id="2389890">append</span><span class="op" id="2389896">(</span><span class="ident" id="2389897">buf</span><span class="op" id="2389900">,</span>&nbsp;<span class="string" id="2389902">&#39;&nbsp;&#39;</span><span class="op" id="2389905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389913">if</span>&nbsp;<span class="ident" id="2389916">f</span><span class="op" id="2389917">.</span><span class="ident" id="2389918">sharp</span>&nbsp;<span class="op" id="2389924">&amp;&amp;</span>&nbsp;<span class="op" id="2389927">(</span><span class="ident" id="2389928">f</span><span class="op" id="2389929">.</span><span class="ident" id="2389930">space</span>&nbsp;<span class="op" id="2389936">||</span>&nbsp;<span class="ident" id="2389939">i</span>&nbsp;<span class="op" id="2389941">==</span>&nbsp;<span class="num" id="2389944">0</span><span class="op" id="2389945">)</span>&nbsp;<span class="op" id="2389947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2389952">buf</span>&nbsp;<span class="op" id="2389956">=</span>&nbsp;<span class="builtinfunc" id="2389958">append</span><span class="op" id="2389964">(</span><span class="ident" id="2389965">buf</span><span class="op" id="2389968">,</span>&nbsp;<span class="string" id="2389970">&#39;0&#39;</span><span class="op" id="2389973">,</span>&nbsp;<span class="ident" id="2389975">x</span><span class="op" id="2389976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2389980">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389984">var</span>&nbsp;<span class="ident" id="2389988">c</span>&nbsp;<span class="builtintype" id="2389990">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2389997">if</span>&nbsp;<span class="ident" id="2390000">b</span>&nbsp;<span class="op" id="2390002">==</span>&nbsp;<span class="builtintype" id="2390005">nil</span>&nbsp;<span class="op" id="2390009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390014">c</span>&nbsp;<span class="op" id="2390016">=</span>&nbsp;<span class="ident" id="2390018">s</span><span class="op" id="2390019">[</span><span class="ident" id="2390020">i</span><span class="op" id="2390021">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390025">}</span>&nbsp;<span class="keyword" id="2390027">else</span>&nbsp;<span class="op" id="2390032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390037">c</span>&nbsp;<span class="op" id="2390039">=</span>&nbsp;<span class="ident" id="2390041">b</span><span class="op" id="2390042">[</span><span class="ident" id="2390043">i</span><span class="op" id="2390044">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390052">buf</span>&nbsp;<span class="op" id="2390056">=</span>&nbsp;<span class="builtinfunc" id="2390058">append</span><span class="op" id="2390064">(</span><span class="ident" id="2390065">buf</span><span class="op" id="2390068">,</span>&nbsp;<span class="ident" id="2390070">digits</span><span class="op" id="2390076">[</span><span class="ident" id="2390077">c</span><span class="op" id="2390078">&gt;&gt;</span><span class="num" id="2390080">4</span><span class="op" id="2390081">]</span><span class="op" id="2390082">,</span>&nbsp;<span class="ident" id="2390084">digits</span><span class="op" id="2390090">[</span><span class="ident" id="2390091">c</span><span class="op" id="2390092">&amp;</span><span class="num" id="2390093">0xF</span><span class="op" id="2390096">]</span><span class="op" id="2390097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390103">f</span><span class="op" id="2390104">.</span><span class="ident" id="2390105">pad</span><span class="op" id="2390108">(</span><span class="ident" id="2390109">buf</span><span class="op" id="2390112">)</span><br>
<span class="lineno"></span><span class="op" id="2390114">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="2390117">//&nbsp;fmt_sx&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2390184">func</span>&nbsp;<span class="op" id="2390189">(</span><span class="ident" id="2390190">f</span>&nbsp;<span class="op" id="2390192">*</span><span class="ident" id="2390193">fmt</span><span class="op" id="2390196">)</span>&nbsp;<span class="ident" id="2390198">fmt_sx</span><span class="op" id="2390204">(</span><span class="ident" id="2390205">s</span><span class="op" id="2390206">,</span>&nbsp;<span class="ident" id="2390208">digits</span>&nbsp;<span class="builtintype" id="2390215">string</span><span class="op" id="2390221">)</span>&nbsp;<span class="op" id="2390223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390226">if</span>&nbsp;<span class="ident" id="2390229">f</span><span class="op" id="2390230">.</span><span class="ident" id="2390231">precPresent</span>&nbsp;<span class="op" id="2390243">&amp;&amp;</span>&nbsp;<span class="ident" id="2390246">f</span><span class="op" id="2390247">.</span><span class="ident" id="2390248">prec</span>&nbsp;<span class="op" id="2390253">&lt;</span>&nbsp;<span class="builtinfunc" id="2390255">len</span><span class="op" id="2390258">(</span><span class="ident" id="2390259">s</span><span class="op" id="2390260">)</span>&nbsp;<span class="op" id="2390262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390266">s</span>&nbsp;<span class="op" id="2390268">=</span>&nbsp;<span class="ident" id="2390270">s</span><span class="op" id="2390271">[</span><span class="op" id="2390272">:</span><span class="ident" id="2390273">f</span><span class="op" id="2390274">.</span><span class="ident" id="2390275">prec</span><span class="op" id="2390279">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390285">f</span><span class="op" id="2390286">.</span><span class="ident" id="2390287">fmt_sbx</span><span class="op" id="2390294">(</span><span class="ident" id="2390295">s</span><span class="op" id="2390296">,</span>&nbsp;<span class="builtintype" id="2390298">nil</span><span class="op" id="2390301">,</span>&nbsp;<span class="ident" id="2390303">digits</span><span class="op" id="2390309">)</span><br>
<span class="lineno"></span><span class="op" id="2390311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2390314">//&nbsp;fmt_bx&nbsp;formats&nbsp;a&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">350</span><span class="keyword" id="2390385">func</span>&nbsp;<span class="op" id="2390390">(</span><span class="ident" id="2390391">f</span>&nbsp;<span class="op" id="2390393">*</span><span class="ident" id="2390394">fmt</span><span class="op" id="2390397">)</span>&nbsp;<span class="ident" id="2390399">fmt_bx</span><span class="op" id="2390405">(</span><span class="ident" id="2390406">b</span>&nbsp;<span class="op" id="2390408">[</span><span class="op" id="2390409">]</span><span class="builtintype" id="2390410">byte</span><span class="op" id="2390414">,</span>&nbsp;<span class="ident" id="2390416">digits</span>&nbsp;<span class="builtintype" id="2390423">string</span><span class="op" id="2390429">)</span>&nbsp;<span class="op" id="2390431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390434">if</span>&nbsp;<span class="ident" id="2390437">f</span><span class="op" id="2390438">.</span><span class="ident" id="2390439">precPresent</span>&nbsp;<span class="op" id="2390451">&amp;&amp;</span>&nbsp;<span class="ident" id="2390454">f</span><span class="op" id="2390455">.</span><span class="ident" id="2390456">prec</span>&nbsp;<span class="op" id="2390461">&lt;</span>&nbsp;<span class="builtinfunc" id="2390463">len</span><span class="op" id="2390466">(</span><span class="ident" id="2390467">b</span><span class="op" id="2390468">)</span>&nbsp;<span class="op" id="2390470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390474">b</span>&nbsp;<span class="op" id="2390476">=</span>&nbsp;<span class="ident" id="2390478">b</span><span class="op" id="2390479">[</span><span class="op" id="2390480">:</span><span class="ident" id="2390481">f</span><span class="op" id="2390482">.</span><span class="ident" id="2390483">prec</span><span class="op" id="2390487">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390493">f</span><span class="op" id="2390494">.</span><span class="ident" id="2390495">fmt_sbx</span><span class="op" id="2390502">(</span><span class="string" id="2390503">&#34;&#34;</span><span class="op" id="2390505">,</span>&nbsp;<span class="ident" id="2390507">b</span><span class="op" id="2390508">,</span>&nbsp;<span class="ident" id="2390510">digits</span><span class="op" id="2390516">)</span><br>
<span class="lineno">355</span><span class="op" id="2390518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2390521">//&nbsp;fmt_q&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;double-quoted,&nbsp;escaped&nbsp;Go&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="2390595">func</span>&nbsp;<span class="op" id="2390600">(</span><span class="ident" id="2390601">f</span>&nbsp;<span class="op" id="2390603">*</span><span class="ident" id="2390604">fmt</span><span class="op" id="2390607">)</span>&nbsp;<span class="ident" id="2390609">fmt_q</span><span class="op" id="2390614">(</span><span class="ident" id="2390615">s</span>&nbsp;<span class="builtintype" id="2390617">string</span><span class="op" id="2390623">)</span>&nbsp;<span class="op" id="2390625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390628">s</span>&nbsp;<span class="op" id="2390630">=</span>&nbsp;<span class="ident" id="2390632">f</span><span class="op" id="2390633">.</span><span class="ident" id="2390634">truncate</span><span class="op" id="2390642">(</span><span class="ident" id="2390643">s</span><span class="op" id="2390644">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390647">var</span>&nbsp;<span class="ident" id="2390651">quoted</span>&nbsp;<span class="builtintype" id="2390658">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390666">if</span>&nbsp;<span class="ident" id="2390669">f</span><span class="op" id="2390670">.</span><span class="ident" id="2390671">sharp</span>&nbsp;<span class="op" id="2390677">&amp;&amp;</span>&nbsp;<span class="ident" id="2390680">strconv</span><span class="op" id="2390687">.</span><span class="ident" id="2390688">CanBackquote</span><span class="op" id="2390700">(</span><span class="ident" id="2390701">s</span><span class="op" id="2390702">)</span>&nbsp;<span class="op" id="2390704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390708">quoted</span>&nbsp;<span class="op" id="2390715">=</span>&nbsp;<span class="string" id="2390717">&#34;`&#34;</span>&nbsp;<span class="op" id="2390721">+</span>&nbsp;<span class="ident" id="2390723">s</span>&nbsp;<span class="op" id="2390725">+</span>&nbsp;<span class="string" id="2390727">&#34;`&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390732">}</span>&nbsp;<span class="keyword" id="2390734">else</span>&nbsp;<span class="op" id="2390739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2390743">if</span>&nbsp;<span class="ident" id="2390746">f</span><span class="op" id="2390747">.</span><span class="ident" id="2390748">plus</span>&nbsp;<span class="op" id="2390753">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390758">quoted</span>&nbsp;<span class="op" id="2390765">=</span>&nbsp;<span class="ident" id="2390767">strconv</span><span class="op" id="2390774">.</span><span class="ident" id="2390775">QuoteToASCII</span><span class="op" id="2390787">(</span><span class="ident" id="2390788">s</span><span class="op" id="2390789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390793">}</span>&nbsp;<span class="keyword" id="2390795">else</span>&nbsp;<span class="op" id="2390800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390805">quoted</span>&nbsp;<span class="op" id="2390812">=</span>&nbsp;<span class="ident" id="2390814">strconv</span><span class="op" id="2390821">.</span><span class="ident" id="2390822">Quote</span><span class="op" id="2390827">(</span><span class="ident" id="2390828">s</span><span class="op" id="2390829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2390836">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2390839">f</span><span class="op" id="2390840">.</span><span class="ident" id="2390841">padString</span><span class="op" id="2390850">(</span><span class="ident" id="2390851">quoted</span><span class="op" id="2390857">)</span><br>
<span class="lineno"></span><span class="op" id="2390859">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2390862">//&nbsp;fmt_qc&nbsp;formats&nbsp;the&nbsp;integer&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;escaped&nbsp;Go&nbsp;character&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2390943">//&nbsp;If&nbsp;the&nbsp;character&nbsp;is&nbsp;not&nbsp;valid&nbsp;Unicode,&nbsp;it&nbsp;will&nbsp;print&nbsp;&#39;\ufffd&#39;.</span><br>
<span class="lineno">375</span><span class="keyword" id="2391009">func</span>&nbsp;<span class="op" id="2391014">(</span><span class="ident" id="2391015">f</span>&nbsp;<span class="op" id="2391017">*</span><span class="ident" id="2391018">fmt</span><span class="op" id="2391021">)</span>&nbsp;<span class="ident" id="2391023">fmt_qc</span><span class="op" id="2391029">(</span><span class="ident" id="2391030">c</span>&nbsp;<span class="builtintype" id="2391032">int64</span><span class="op" id="2391037">)</span>&nbsp;<span class="op" id="2391039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391042">var</span>&nbsp;<span class="ident" id="2391046">quoted</span>&nbsp;<span class="op" id="2391053">[</span><span class="op" id="2391054">]</span><span class="builtintype" id="2391055">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391061">if</span>&nbsp;<span class="ident" id="2391064">f</span><span class="op" id="2391065">.</span><span class="ident" id="2391066">plus</span>&nbsp;<span class="op" id="2391071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391075">quoted</span>&nbsp;<span class="op" id="2391082">=</span>&nbsp;<span class="ident" id="2391084">strconv</span><span class="op" id="2391091">.</span><span class="ident" id="2391092">AppendQuoteRuneToASCII</span><span class="op" id="2391114">(</span><span class="ident" id="2391115">f</span><span class="op" id="2391116">.</span><span class="ident" id="2391117">intbuf</span><span class="op" id="2391123">[</span><span class="num" id="2391124">0</span><span class="op" id="2391125">:</span><span class="num" id="2391126">0</span><span class="op" id="2391127">]</span><span class="op" id="2391128">,</span>&nbsp;<span class="builtintype" id="2391130">rune</span><span class="op" id="2391134">(</span><span class="ident" id="2391135">c</span><span class="op" id="2391136">)</span><span class="op" id="2391137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391140">}</span>&nbsp;<span class="keyword" id="2391142">else</span>&nbsp;<span class="op" id="2391147">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391151">quoted</span>&nbsp;<span class="op" id="2391158">=</span>&nbsp;<span class="ident" id="2391160">strconv</span><span class="op" id="2391167">.</span><span class="ident" id="2391168">AppendQuoteRune</span><span class="op" id="2391183">(</span><span class="ident" id="2391184">f</span><span class="op" id="2391185">.</span><span class="ident" id="2391186">intbuf</span><span class="op" id="2391192">[</span><span class="num" id="2391193">0</span><span class="op" id="2391194">:</span><span class="num" id="2391195">0</span><span class="op" id="2391196">]</span><span class="op" id="2391197">,</span>&nbsp;<span class="builtintype" id="2391199">rune</span><span class="op" id="2391203">(</span><span class="ident" id="2391204">c</span><span class="op" id="2391205">)</span><span class="op" id="2391206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391212">f</span><span class="op" id="2391213">.</span><span class="ident" id="2391214">pad</span><span class="op" id="2391217">(</span><span class="ident" id="2391218">quoted</span><span class="op" id="2391224">)</span><br>
<span class="lineno"></span><span class="op" id="2391226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="2391229">//&nbsp;floating-point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2391248">func</span>&nbsp;<span class="ident" id="2391253">doPrec</span><span class="op" id="2391259">(</span><span class="ident" id="2391260">f</span>&nbsp;<span class="op" id="2391262">*</span><span class="ident" id="2391263">fmt</span><span class="op" id="2391266">,</span>&nbsp;<span class="ident" id="2391268">def</span>&nbsp;<span class="builtintype" id="2391272">int</span><span class="op" id="2391275">)</span>&nbsp;<span class="builtintype" id="2391277">int</span>&nbsp;<span class="op" id="2391281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391284">if</span>&nbsp;<span class="ident" id="2391287">f</span><span class="op" id="2391288">.</span><span class="ident" id="2391289">precPresent</span>&nbsp;<span class="op" id="2391301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391305">return</span>&nbsp;<span class="ident" id="2391312">f</span><span class="op" id="2391313">.</span><span class="ident" id="2391314">prec</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391323">return</span>&nbsp;<span class="ident" id="2391330">def</span><br>
<span class="lineno"></span><span class="op" id="2391334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2391337">//&nbsp;formatFloat&nbsp;formats&nbsp;a&nbsp;float64;&nbsp;it&nbsp;is&nbsp;an&nbsp;efficient&nbsp;equivalent&nbsp;to&nbsp;&nbsp;f.pad(strconv.FormatFloat()...).</span><br>
<span class="lineno">395</span><span class="keyword" id="2391438">func</span>&nbsp;<span class="op" id="2391443">(</span><span class="ident" id="2391444">f</span>&nbsp;<span class="op" id="2391446">*</span><span class="ident" id="2391447">fmt</span><span class="op" id="2391450">)</span>&nbsp;<span class="ident" id="2391452">formatFloat</span><span class="op" id="2391463">(</span><span class="ident" id="2391464">v</span>&nbsp;<span class="builtintype" id="2391466">float64</span><span class="op" id="2391473">,</span>&nbsp;<span class="ident" id="2391475">verb</span>&nbsp;<span class="builtintype" id="2391480">byte</span><span class="op" id="2391484">,</span>&nbsp;<span class="ident" id="2391486">prec</span><span class="op" id="2391490">,</span>&nbsp;<span class="ident" id="2391492">n</span>&nbsp;<span class="builtintype" id="2391494">int</span><span class="op" id="2391497">)</span>&nbsp;<span class="op" id="2391499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2391502">//&nbsp;Format&nbsp;number,&nbsp;reserving&nbsp;space&nbsp;for&nbsp;leading&nbsp;+&nbsp;sign&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391567">num</span>&nbsp;<span class="op" id="2391571">:=</span>&nbsp;<span class="ident" id="2391574">strconv</span><span class="op" id="2391581">.</span><span class="ident" id="2391582">AppendFloat</span><span class="op" id="2391593">(</span><span class="ident" id="2391594">f</span><span class="op" id="2391595">.</span><span class="ident" id="2391596">intbuf</span><span class="op" id="2391602">[</span><span class="num" id="2391603">0</span><span class="op" id="2391604">:</span><span class="num" id="2391605">1</span><span class="op" id="2391606">]</span><span class="op" id="2391607">,</span>&nbsp;<span class="ident" id="2391609">v</span><span class="op" id="2391610">,</span>&nbsp;<span class="ident" id="2391612">verb</span><span class="op" id="2391616">,</span>&nbsp;<span class="ident" id="2391618">prec</span><span class="op" id="2391622">,</span>&nbsp;<span class="ident" id="2391624">n</span><span class="op" id="2391625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391628">if</span>&nbsp;<span class="ident" id="2391631">num</span><span class="op" id="2391634">[</span><span class="num" id="2391635">1</span><span class="op" id="2391636">]</span>&nbsp;<span class="op" id="2391638">==</span>&nbsp;<span class="string" id="2391641">&#39;-&#39;</span>&nbsp;<span class="op" id="2391645">||</span>&nbsp;<span class="ident" id="2391648">num</span><span class="op" id="2391651">[</span><span class="num" id="2391652">1</span><span class="op" id="2391653">]</span>&nbsp;<span class="op" id="2391655">==</span>&nbsp;<span class="string" id="2391658">&#39;+&#39;</span>&nbsp;<span class="op" id="2391662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391666">num</span>&nbsp;<span class="op" id="2391670">=</span>&nbsp;<span class="ident" id="2391672">num</span><span class="op" id="2391675">[</span><span class="num" id="2391676">1</span><span class="op" id="2391677">:</span><span class="op" id="2391678">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391681">}</span>&nbsp;<span class="keyword" id="2391683">else</span>&nbsp;<span class="op" id="2391688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391692">num</span><span class="op" id="2391695">[</span><span class="num" id="2391696">0</span><span class="op" id="2391697">]</span>&nbsp;<span class="op" id="2391699">=</span>&nbsp;<span class="string" id="2391701">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2391709">//&nbsp;Special&nbsp;handling&nbsp;for&nbsp;infinity,&nbsp;which&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;a&nbsp;number&nbsp;so&nbsp;shouldn&#39;t&nbsp;be&nbsp;padded&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391812">if</span>&nbsp;<span class="ident" id="2391815">math</span><span class="op" id="2391819">.</span><span class="ident" id="2391820">IsInf</span><span class="op" id="2391825">(</span><span class="ident" id="2391826">v</span><span class="op" id="2391827">,</span>&nbsp;<span class="num" id="2391829">0</span><span class="op" id="2391830">)</span>&nbsp;<span class="op" id="2391832">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391836">if</span>&nbsp;<span class="ident" id="2391839">f</span><span class="op" id="2391840">.</span><span class="ident" id="2391841">zero</span>&nbsp;<span class="op" id="2391846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2391851">defer</span>&nbsp;<span class="keyword" id="2391857">func</span><span class="op" id="2391861">(</span><span class="op" id="2391862">)</span>&nbsp;<span class="op" id="2391864">{</span>&nbsp;<span class="ident" id="2391866">f</span><span class="op" id="2391867">.</span><span class="ident" id="2391868">zero</span>&nbsp;<span class="op" id="2391873">=</span>&nbsp;<span class="builtintype" id="2391875">true</span>&nbsp;<span class="op" id="2391880">}</span><span class="op" id="2391881">(</span><span class="op" id="2391882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2391887">f</span><span class="op" id="2391888">.</span><span class="ident" id="2391889">zero</span>&nbsp;<span class="op" id="2391894">=</span>&nbsp;<span class="builtintype" id="2391896">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2391907">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2391910">//&nbsp;num&nbsp;is&nbsp;now&nbsp;a&nbsp;signed&nbsp;version&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2391957">//&nbsp;If&nbsp;we&#39;re&nbsp;zero&nbsp;padding,&nbsp;want&nbsp;the&nbsp;sign&nbsp;before&nbsp;the&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2392024">//&nbsp;Achieve&nbsp;this&nbsp;by&nbsp;writing&nbsp;the&nbsp;sign&nbsp;out&nbsp;and&nbsp;then&nbsp;padding&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392103">if</span>&nbsp;<span class="ident" id="2392106">f</span><span class="op" id="2392107">.</span><span class="ident" id="2392108">zero</span>&nbsp;<span class="op" id="2392113">&amp;&amp;</span>&nbsp;<span class="ident" id="2392116">f</span><span class="op" id="2392117">.</span><span class="ident" id="2392118">widPresent</span>&nbsp;<span class="op" id="2392129">&amp;&amp;</span>&nbsp;<span class="ident" id="2392132">f</span><span class="op" id="2392133">.</span><span class="ident" id="2392134">wid</span>&nbsp;<span class="op" id="2392138">&gt;</span>&nbsp;<span class="builtinfunc" id="2392140">len</span><span class="op" id="2392143">(</span><span class="ident" id="2392144">num</span><span class="op" id="2392147">)</span>&nbsp;<span class="op" id="2392149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392153">if</span>&nbsp;<span class="ident" id="2392156">f</span><span class="op" id="2392157">.</span><span class="ident" id="2392158">space</span>&nbsp;<span class="op" id="2392164">&amp;&amp;</span>&nbsp;<span class="ident" id="2392167">v</span>&nbsp;<span class="op" id="2392169">&gt;=</span>&nbsp;<span class="num" id="2392172">0</span>&nbsp;<span class="op" id="2392174">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392179">f</span><span class="op" id="2392180">.</span><span class="ident" id="2392181">buf</span><span class="op" id="2392184">.</span><span class="ident" id="2392185">WriteByte</span><span class="op" id="2392194">(</span><span class="string" id="2392195">&#39;&nbsp;&#39;</span><span class="op" id="2392198">)</span>&nbsp;<span class="comment" id="2392200">//&nbsp;This&nbsp;is&nbsp;what&nbsp;C&nbsp;does:&nbsp;even&nbsp;with&nbsp;zero,&nbsp;f.space&nbsp;means&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392264">f</span><span class="op" id="2392265">.</span><span class="ident" id="2392266">wid</span><span class="op" id="2392269">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392274">}</span>&nbsp;<span class="keyword" id="2392276">else</span>&nbsp;<span class="keyword" id="2392281">if</span>&nbsp;<span class="ident" id="2392284">f</span><span class="op" id="2392285">.</span><span class="ident" id="2392286">plus</span>&nbsp;<span class="op" id="2392291">||</span>&nbsp;<span class="ident" id="2392294">v</span>&nbsp;<span class="op" id="2392296">&lt;</span>&nbsp;<span class="num" id="2392298">0</span>&nbsp;<span class="op" id="2392300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392305">f</span><span class="op" id="2392306">.</span><span class="ident" id="2392307">buf</span><span class="op" id="2392310">.</span><span class="ident" id="2392311">WriteByte</span><span class="op" id="2392320">(</span><span class="ident" id="2392321">num</span><span class="op" id="2392324">[</span><span class="num" id="2392325">0</span><span class="op" id="2392326">]</span><span class="op" id="2392327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392332">f</span><span class="op" id="2392333">.</span><span class="ident" id="2392334">wid</span><span class="op" id="2392337">--</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392346">f</span><span class="op" id="2392347">.</span><span class="ident" id="2392348">pad</span><span class="op" id="2392351">(</span><span class="ident" id="2392352">num</span><span class="op" id="2392355">[</span><span class="num" id="2392356">1</span><span class="op" id="2392357">:</span><span class="op" id="2392358">]</span><span class="op" id="2392359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392363">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2392374">//&nbsp;f.space&nbsp;says&nbsp;to&nbsp;replace&nbsp;a&nbsp;leading&nbsp;+&nbsp;with&nbsp;a&nbsp;space.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392428">if</span>&nbsp;<span class="ident" id="2392431">f</span><span class="op" id="2392432">.</span><span class="ident" id="2392433">space</span>&nbsp;<span class="op" id="2392439">&amp;&amp;</span>&nbsp;<span class="ident" id="2392442">num</span><span class="op" id="2392445">[</span><span class="num" id="2392446">0</span><span class="op" id="2392447">]</span>&nbsp;<span class="op" id="2392449">==</span>&nbsp;<span class="string" id="2392452">&#39;+&#39;</span>&nbsp;<span class="op" id="2392456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392460">num</span><span class="op" id="2392463">[</span><span class="num" id="2392464">0</span><span class="op" id="2392465">]</span>&nbsp;<span class="op" id="2392467">=</span>&nbsp;<span class="string" id="2392469">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392475">f</span><span class="op" id="2392476">.</span><span class="ident" id="2392477">pad</span><span class="op" id="2392480">(</span><span class="ident" id="2392481">num</span><span class="op" id="2392484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392488">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392496">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2392499">//&nbsp;Now&nbsp;we&nbsp;know&nbsp;the&nbsp;sign&nbsp;is&nbsp;attached&nbsp;directly&nbsp;to&nbsp;the&nbsp;number,&nbsp;if&nbsp;present&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2392579">//&nbsp;We&nbsp;want&nbsp;a&nbsp;sign&nbsp;if&nbsp;asked&nbsp;for,&nbsp;if&nbsp;it&#39;s&nbsp;negative,&nbsp;or&nbsp;if&nbsp;it&#39;s&nbsp;infinity&nbsp;(+Inf&nbsp;vs.&nbsp;-Inf).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392667">if</span>&nbsp;<span class="ident" id="2392670">f</span><span class="op" id="2392671">.</span><span class="ident" id="2392672">plus</span>&nbsp;<span class="op" id="2392677">||</span>&nbsp;<span class="ident" id="2392680">num</span><span class="op" id="2392683">[</span><span class="num" id="2392684">0</span><span class="op" id="2392685">]</span>&nbsp;<span class="op" id="2392687">==</span>&nbsp;<span class="string" id="2392690">&#39;-&#39;</span>&nbsp;<span class="op" id="2392694">||</span>&nbsp;<span class="ident" id="2392697">math</span><span class="op" id="2392701">.</span><span class="ident" id="2392702">IsInf</span><span class="op" id="2392707">(</span><span class="ident" id="2392708">v</span><span class="op" id="2392709">,</span>&nbsp;<span class="num" id="2392711">0</span><span class="op" id="2392712">)</span>&nbsp;<span class="op" id="2392714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392718">f</span><span class="op" id="2392719">.</span><span class="ident" id="2392720">pad</span><span class="op" id="2392723">(</span><span class="ident" id="2392724">num</span><span class="op" id="2392727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392731">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2392739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2392742">//&nbsp;No&nbsp;sign&nbsp;to&nbsp;show&nbsp;and&nbsp;the&nbsp;number&nbsp;is&nbsp;positive;&nbsp;just&nbsp;print&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2392822">f</span><span class="op" id="2392823">.</span><span class="ident" id="2392824">pad</span><span class="op" id="2392827">(</span><span class="ident" id="2392828">num</span><span class="op" id="2392831">[</span><span class="num" id="2392832">1</span><span class="op" id="2392833">:</span><span class="op" id="2392834">]</span><span class="op" id="2392835">)</span><br>
<span class="lineno"></span><span class="op" id="2392837">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="2392840">//&nbsp;fmt_e64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2392892">func</span>&nbsp;<span class="op" id="2392897">(</span><span class="ident" id="2392898">f</span>&nbsp;<span class="op" id="2392900">*</span><span class="ident" id="2392901">fmt</span><span class="op" id="2392904">)</span>&nbsp;<span class="ident" id="2392906">fmt_e64</span><span class="op" id="2392913">(</span><span class="ident" id="2392914">v</span>&nbsp;<span class="builtintype" id="2392916">float64</span><span class="op" id="2392923">)</span>&nbsp;<span class="op" id="2392925">{</span>&nbsp;<span class="ident" id="2392927">f</span><span class="op" id="2392928">.</span><span class="ident" id="2392929">formatFloat</span><span class="op" id="2392940">(</span><span class="ident" id="2392941">v</span><span class="op" id="2392942">,</span>&nbsp;<span class="string" id="2392944">&#39;e&#39;</span><span class="op" id="2392947">,</span>&nbsp;<span class="ident" id="2392949">doPrec</span><span class="op" id="2392955">(</span><span class="ident" id="2392956">f</span><span class="op" id="2392957">,</span>&nbsp;<span class="num" id="2392959">6</span><span class="op" id="2392960">)</span><span class="op" id="2392961">,</span>&nbsp;<span class="num" id="2392963">64</span><span class="op" id="2392965">)</span>&nbsp;<span class="op" id="2392967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2392970">//&nbsp;fmt_E64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2393022">func</span>&nbsp;<span class="op" id="2393027">(</span><span class="ident" id="2393028">f</span>&nbsp;<span class="op" id="2393030">*</span><span class="ident" id="2393031">fmt</span><span class="op" id="2393034">)</span>&nbsp;<span class="ident" id="2393036">fmt_E64</span><span class="op" id="2393043">(</span><span class="ident" id="2393044">v</span>&nbsp;<span class="builtintype" id="2393046">float64</span><span class="op" id="2393053">)</span>&nbsp;<span class="op" id="2393055">{</span>&nbsp;<span class="ident" id="2393057">f</span><span class="op" id="2393058">.</span><span class="ident" id="2393059">formatFloat</span><span class="op" id="2393070">(</span><span class="ident" id="2393071">v</span><span class="op" id="2393072">,</span>&nbsp;<span class="string" id="2393074">&#39;E&#39;</span><span class="op" id="2393077">,</span>&nbsp;<span class="ident" id="2393079">doPrec</span><span class="op" id="2393085">(</span><span class="ident" id="2393086">f</span><span class="op" id="2393087">,</span>&nbsp;<span class="num" id="2393089">6</span><span class="op" id="2393090">)</span><span class="op" id="2393091">,</span>&nbsp;<span class="num" id="2393093">64</span><span class="op" id="2393095">)</span>&nbsp;<span class="op" id="2393097">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="comment" id="2393100">//&nbsp;fmt_f64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2393148">func</span>&nbsp;<span class="op" id="2393153">(</span><span class="ident" id="2393154">f</span>&nbsp;<span class="op" id="2393156">*</span><span class="ident" id="2393157">fmt</span><span class="op" id="2393160">)</span>&nbsp;<span class="ident" id="2393162">fmt_f64</span><span class="op" id="2393169">(</span><span class="ident" id="2393170">v</span>&nbsp;<span class="builtintype" id="2393172">float64</span><span class="op" id="2393179">)</span>&nbsp;<span class="op" id="2393181">{</span>&nbsp;<span class="ident" id="2393183">f</span><span class="op" id="2393184">.</span><span class="ident" id="2393185">formatFloat</span><span class="op" id="2393196">(</span><span class="ident" id="2393197">v</span><span class="op" id="2393198">,</span>&nbsp;<span class="string" id="2393200">&#39;f&#39;</span><span class="op" id="2393203">,</span>&nbsp;<span class="ident" id="2393205">doPrec</span><span class="op" id="2393211">(</span><span class="ident" id="2393212">f</span><span class="op" id="2393213">,</span>&nbsp;<span class="num" id="2393215">6</span><span class="op" id="2393216">)</span><span class="op" id="2393217">,</span>&nbsp;<span class="num" id="2393219">64</span><span class="op" id="2393221">)</span>&nbsp;<span class="op" id="2393223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2393226">//&nbsp;fmt_g64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">450</span><span class="keyword" id="2393297">func</span>&nbsp;<span class="op" id="2393302">(</span><span class="ident" id="2393303">f</span>&nbsp;<span class="op" id="2393305">*</span><span class="ident" id="2393306">fmt</span><span class="op" id="2393309">)</span>&nbsp;<span class="ident" id="2393311">fmt_g64</span><span class="op" id="2393318">(</span><span class="ident" id="2393319">v</span>&nbsp;<span class="builtintype" id="2393321">float64</span><span class="op" id="2393328">)</span>&nbsp;<span class="op" id="2393330">{</span>&nbsp;<span class="ident" id="2393332">f</span><span class="op" id="2393333">.</span><span class="ident" id="2393334">formatFloat</span><span class="op" id="2393345">(</span><span class="ident" id="2393346">v</span><span class="op" id="2393347">,</span>&nbsp;<span class="string" id="2393349">&#39;g&#39;</span><span class="op" id="2393352">,</span>&nbsp;<span class="ident" id="2393354">doPrec</span><span class="op" id="2393360">(</span><span class="ident" id="2393361">f</span><span class="op" id="2393362">,</span>&nbsp;<span class="op" id="2393364">-</span><span class="num" id="2393365">1</span><span class="op" id="2393366">)</span><span class="op" id="2393367">,</span>&nbsp;<span class="num" id="2393369">64</span><span class="op" id="2393371">)</span>&nbsp;<span class="op" id="2393373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2393376">//&nbsp;fmt_G64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2393447">func</span>&nbsp;<span class="op" id="2393452">(</span><span class="ident" id="2393453">f</span>&nbsp;<span class="op" id="2393455">*</span><span class="ident" id="2393456">fmt</span><span class="op" id="2393459">)</span>&nbsp;<span class="ident" id="2393461">fmt_G64</span><span class="op" id="2393468">(</span><span class="ident" id="2393469">v</span>&nbsp;<span class="builtintype" id="2393471">float64</span><span class="op" id="2393478">)</span>&nbsp;<span class="op" id="2393480">{</span>&nbsp;<span class="ident" id="2393482">f</span><span class="op" id="2393483">.</span><span class="ident" id="2393484">formatFloat</span><span class="op" id="2393495">(</span><span class="ident" id="2393496">v</span><span class="op" id="2393497">,</span>&nbsp;<span class="string" id="2393499">&#39;G&#39;</span><span class="op" id="2393502">,</span>&nbsp;<span class="ident" id="2393504">doPrec</span><span class="op" id="2393510">(</span><span class="ident" id="2393511">f</span><span class="op" id="2393512">,</span>&nbsp;<span class="op" id="2393514">-</span><span class="num" id="2393515">1</span><span class="op" id="2393516">)</span><span class="op" id="2393517">,</span>&nbsp;<span class="num" id="2393519">64</span><span class="op" id="2393521">)</span>&nbsp;<span class="op" id="2393523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="2393526">//&nbsp;fmt_fb64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2393601">func</span>&nbsp;<span class="op" id="2393606">(</span><span class="ident" id="2393607">f</span>&nbsp;<span class="op" id="2393609">*</span><span class="ident" id="2393610">fmt</span><span class="op" id="2393613">)</span>&nbsp;<span class="ident" id="2393615">fmt_fb64</span><span class="op" id="2393623">(</span><span class="ident" id="2393624">v</span>&nbsp;<span class="builtintype" id="2393626">float64</span><span class="op" id="2393633">)</span>&nbsp;<span class="op" id="2393635">{</span>&nbsp;<span class="ident" id="2393637">f</span><span class="op" id="2393638">.</span><span class="ident" id="2393639">formatFloat</span><span class="op" id="2393650">(</span><span class="ident" id="2393651">v</span><span class="op" id="2393652">,</span>&nbsp;<span class="string" id="2393654">&#39;b&#39;</span><span class="op" id="2393657">,</span>&nbsp;<span class="num" id="2393659">0</span><span class="op" id="2393660">,</span>&nbsp;<span class="num" id="2393662">64</span><span class="op" id="2393664">)</span>&nbsp;<span class="op" id="2393666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2393669">//&nbsp;float32</span><br>
<span class="lineno"></span><span class="comment" id="2393680">//&nbsp;cannot&nbsp;defer&nbsp;to&nbsp;float64&nbsp;versions</span><br>
<span class="lineno">460</span><span class="comment" id="2393716">//&nbsp;because&nbsp;it&nbsp;will&nbsp;get&nbsp;rounding&nbsp;wrong&nbsp;in&nbsp;corner&nbsp;cases.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2393772">//&nbsp;fmt_e32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2393824">func</span>&nbsp;<span class="op" id="2393829">(</span><span class="ident" id="2393830">f</span>&nbsp;<span class="op" id="2393832">*</span><span class="ident" id="2393833">fmt</span><span class="op" id="2393836">)</span>&nbsp;<span class="ident" id="2393838">fmt_e32</span><span class="op" id="2393845">(</span><span class="ident" id="2393846">v</span>&nbsp;<span class="builtintype" id="2393848">float32</span><span class="op" id="2393855">)</span>&nbsp;<span class="op" id="2393857">{</span>&nbsp;<span class="ident" id="2393859">f</span><span class="op" id="2393860">.</span><span class="ident" id="2393861">formatFloat</span><span class="op" id="2393872">(</span><span class="builtintype" id="2393873">float64</span><span class="op" id="2393880">(</span><span class="ident" id="2393881">v</span><span class="op" id="2393882">)</span><span class="op" id="2393883">,</span>&nbsp;<span class="string" id="2393885">&#39;e&#39;</span><span class="op" id="2393888">,</span>&nbsp;<span class="ident" id="2393890">doPrec</span><span class="op" id="2393896">(</span><span class="ident" id="2393897">f</span><span class="op" id="2393898">,</span>&nbsp;<span class="num" id="2393900">6</span><span class="op" id="2393901">)</span><span class="op" id="2393902">,</span>&nbsp;<span class="num" id="2393904">32</span><span class="op" id="2393906">)</span>&nbsp;<span class="op" id="2393908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="2393911">//&nbsp;fmt_E32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2393963">func</span>&nbsp;<span class="op" id="2393968">(</span><span class="ident" id="2393969">f</span>&nbsp;<span class="op" id="2393971">*</span><span class="ident" id="2393972">fmt</span><span class="op" id="2393975">)</span>&nbsp;<span class="ident" id="2393977">fmt_E32</span><span class="op" id="2393984">(</span><span class="ident" id="2393985">v</span>&nbsp;<span class="builtintype" id="2393987">float32</span><span class="op" id="2393994">)</span>&nbsp;<span class="op" id="2393996">{</span>&nbsp;<span class="ident" id="2393998">f</span><span class="op" id="2393999">.</span><span class="ident" id="2394000">formatFloat</span><span class="op" id="2394011">(</span><span class="builtintype" id="2394012">float64</span><span class="op" id="2394019">(</span><span class="ident" id="2394020">v</span><span class="op" id="2394021">)</span><span class="op" id="2394022">,</span>&nbsp;<span class="string" id="2394024">&#39;E&#39;</span><span class="op" id="2394027">,</span>&nbsp;<span class="ident" id="2394029">doPrec</span><span class="op" id="2394035">(</span><span class="ident" id="2394036">f</span><span class="op" id="2394037">,</span>&nbsp;<span class="num" id="2394039">6</span><span class="op" id="2394040">)</span><span class="op" id="2394041">,</span>&nbsp;<span class="num" id="2394043">32</span><span class="op" id="2394045">)</span>&nbsp;<span class="op" id="2394047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2394050">//&nbsp;fmt_f32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2394098">func</span>&nbsp;<span class="op" id="2394103">(</span><span class="ident" id="2394104">f</span>&nbsp;<span class="op" id="2394106">*</span><span class="ident" id="2394107">fmt</span><span class="op" id="2394110">)</span>&nbsp;<span class="ident" id="2394112">fmt_f32</span><span class="op" id="2394119">(</span><span class="ident" id="2394120">v</span>&nbsp;<span class="builtintype" id="2394122">float32</span><span class="op" id="2394129">)</span>&nbsp;<span class="op" id="2394131">{</span>&nbsp;<span class="ident" id="2394133">f</span><span class="op" id="2394134">.</span><span class="ident" id="2394135">formatFloat</span><span class="op" id="2394146">(</span><span class="builtintype" id="2394147">float64</span><span class="op" id="2394154">(</span><span class="ident" id="2394155">v</span><span class="op" id="2394156">)</span><span class="op" id="2394157">,</span>&nbsp;<span class="string" id="2394159">&#39;f&#39;</span><span class="op" id="2394162">,</span>&nbsp;<span class="ident" id="2394164">doPrec</span><span class="op" id="2394170">(</span><span class="ident" id="2394171">f</span><span class="op" id="2394172">,</span>&nbsp;<span class="num" id="2394174">6</span><span class="op" id="2394175">)</span><span class="op" id="2394176">,</span>&nbsp;<span class="num" id="2394178">32</span><span class="op" id="2394180">)</span>&nbsp;<span class="op" id="2394182">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="2394185">//&nbsp;fmt_g32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2394256">func</span>&nbsp;<span class="op" id="2394261">(</span><span class="ident" id="2394262">f</span>&nbsp;<span class="op" id="2394264">*</span><span class="ident" id="2394265">fmt</span><span class="op" id="2394268">)</span>&nbsp;<span class="ident" id="2394270">fmt_g32</span><span class="op" id="2394277">(</span><span class="ident" id="2394278">v</span>&nbsp;<span class="builtintype" id="2394280">float32</span><span class="op" id="2394287">)</span>&nbsp;<span class="op" id="2394289">{</span>&nbsp;<span class="ident" id="2394291">f</span><span class="op" id="2394292">.</span><span class="ident" id="2394293">formatFloat</span><span class="op" id="2394304">(</span><span class="builtintype" id="2394305">float64</span><span class="op" id="2394312">(</span><span class="ident" id="2394313">v</span><span class="op" id="2394314">)</span><span class="op" id="2394315">,</span>&nbsp;<span class="string" id="2394317">&#39;g&#39;</span><span class="op" id="2394320">,</span>&nbsp;<span class="ident" id="2394322">doPrec</span><span class="op" id="2394328">(</span><span class="ident" id="2394329">f</span><span class="op" id="2394330">,</span>&nbsp;<span class="op" id="2394332">-</span><span class="num" id="2394333">1</span><span class="op" id="2394334">)</span><span class="op" id="2394335">,</span>&nbsp;<span class="num" id="2394337">32</span><span class="op" id="2394339">)</span>&nbsp;<span class="op" id="2394341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2394344">//&nbsp;fmt_G32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">475</span><span class="keyword" id="2394415">func</span>&nbsp;<span class="op" id="2394420">(</span><span class="ident" id="2394421">f</span>&nbsp;<span class="op" id="2394423">*</span><span class="ident" id="2394424">fmt</span><span class="op" id="2394427">)</span>&nbsp;<span class="ident" id="2394429">fmt_G32</span><span class="op" id="2394436">(</span><span class="ident" id="2394437">v</span>&nbsp;<span class="builtintype" id="2394439">float32</span><span class="op" id="2394446">)</span>&nbsp;<span class="op" id="2394448">{</span>&nbsp;<span class="ident" id="2394450">f</span><span class="op" id="2394451">.</span><span class="ident" id="2394452">formatFloat</span><span class="op" id="2394463">(</span><span class="builtintype" id="2394464">float64</span><span class="op" id="2394471">(</span><span class="ident" id="2394472">v</span><span class="op" id="2394473">)</span><span class="op" id="2394474">,</span>&nbsp;<span class="string" id="2394476">&#39;G&#39;</span><span class="op" id="2394479">,</span>&nbsp;<span class="ident" id="2394481">doPrec</span><span class="op" id="2394487">(</span><span class="ident" id="2394488">f</span><span class="op" id="2394489">,</span>&nbsp;<span class="op" id="2394491">-</span><span class="num" id="2394492">1</span><span class="op" id="2394493">)</span><span class="op" id="2394494">,</span>&nbsp;<span class="num" id="2394496">32</span><span class="op" id="2394498">)</span>&nbsp;<span class="op" id="2394500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2394503">//&nbsp;fmt_fb32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2394578">func</span>&nbsp;<span class="op" id="2394583">(</span><span class="ident" id="2394584">f</span>&nbsp;<span class="op" id="2394586">*</span><span class="ident" id="2394587">fmt</span><span class="op" id="2394590">)</span>&nbsp;<span class="ident" id="2394592">fmt_fb32</span><span class="op" id="2394600">(</span><span class="ident" id="2394601">v</span>&nbsp;<span class="builtintype" id="2394603">float32</span><span class="op" id="2394610">)</span>&nbsp;<span class="op" id="2394612">{</span>&nbsp;<span class="ident" id="2394614">f</span><span class="op" id="2394615">.</span><span class="ident" id="2394616">formatFloat</span><span class="op" id="2394627">(</span><span class="builtintype" id="2394628">float64</span><span class="op" id="2394635">(</span><span class="ident" id="2394636">v</span><span class="op" id="2394637">)</span><span class="op" id="2394638">,</span>&nbsp;<span class="string" id="2394640">&#39;b&#39;</span><span class="op" id="2394643">,</span>&nbsp;<span class="num" id="2394645">0</span><span class="op" id="2394646">,</span>&nbsp;<span class="num" id="2394648">32</span><span class="op" id="2394650">)</span>&nbsp;<span class="op" id="2394652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="2394655">//&nbsp;fmt_c64&nbsp;formats&nbsp;a&nbsp;complex64&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2394709">func</span>&nbsp;<span class="op" id="2394714">(</span><span class="ident" id="2394715">f</span>&nbsp;<span class="op" id="2394717">*</span><span class="ident" id="2394718">fmt</span><span class="op" id="2394721">)</span>&nbsp;<span class="ident" id="2394723">fmt_c64</span><span class="op" id="2394730">(</span><span class="ident" id="2394731">v</span>&nbsp;<span class="builtintype" id="2394733">complex64</span><span class="op" id="2394742">,</span>&nbsp;<span class="ident" id="2394744">verb</span>&nbsp;<span class="builtintype" id="2394749">rune</span><span class="op" id="2394753">)</span>&nbsp;<span class="op" id="2394755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394758">f</span><span class="op" id="2394759">.</span><span class="ident" id="2394760">fmt_complex</span><span class="op" id="2394771">(</span><span class="builtintype" id="2394772">float64</span><span class="op" id="2394779">(</span><span class="builtinfunc" id="2394780">real</span><span class="op" id="2394784">(</span><span class="ident" id="2394785">v</span><span class="op" id="2394786">)</span><span class="op" id="2394787">)</span><span class="op" id="2394788">,</span>&nbsp;<span class="builtintype" id="2394790">float64</span><span class="op" id="2394797">(</span><span class="builtinfunc" id="2394798">imag</span><span class="op" id="2394802">(</span><span class="ident" id="2394803">v</span><span class="op" id="2394804">)</span><span class="op" id="2394805">)</span><span class="op" id="2394806">,</span>&nbsp;<span class="num" id="2394808">32</span><span class="op" id="2394810">,</span>&nbsp;<span class="ident" id="2394812">verb</span><span class="op" id="2394816">)</span><br>
<span class="lineno"></span><span class="op" id="2394818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="2394821">//&nbsp;fmt_c128&nbsp;formats&nbsp;a&nbsp;complex128&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2394877">func</span>&nbsp;<span class="op" id="2394882">(</span><span class="ident" id="2394883">f</span>&nbsp;<span class="op" id="2394885">*</span><span class="ident" id="2394886">fmt</span><span class="op" id="2394889">)</span>&nbsp;<span class="ident" id="2394891">fmt_c128</span><span class="op" id="2394899">(</span><span class="ident" id="2394900">v</span>&nbsp;<span class="builtintype" id="2394902">complex128</span><span class="op" id="2394912">,</span>&nbsp;<span class="ident" id="2394914">verb</span>&nbsp;<span class="builtintype" id="2394919">rune</span><span class="op" id="2394923">)</span>&nbsp;<span class="op" id="2394925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394928">f</span><span class="op" id="2394929">.</span><span class="ident" id="2394930">fmt_complex</span><span class="op" id="2394941">(</span><span class="builtinfunc" id="2394942">real</span><span class="op" id="2394946">(</span><span class="ident" id="2394947">v</span><span class="op" id="2394948">)</span><span class="op" id="2394949">,</span>&nbsp;<span class="builtinfunc" id="2394951">imag</span><span class="op" id="2394955">(</span><span class="ident" id="2394956">v</span><span class="op" id="2394957">)</span><span class="op" id="2394958">,</span>&nbsp;<span class="num" id="2394960">64</span><span class="op" id="2394962">,</span>&nbsp;<span class="ident" id="2394964">verb</span><span class="op" id="2394968">)</span><br>
<span class="lineno"></span><span class="op" id="2394970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span><span class="comment" id="2394973">//&nbsp;fmt_complex&nbsp;formats&nbsp;a&nbsp;complex&nbsp;number&nbsp;as&nbsp;(r+ji).</span><br>
<span class="lineno"></span><span class="keyword" id="2395024">func</span>&nbsp;<span class="op" id="2395029">(</span><span class="ident" id="2395030">f</span>&nbsp;<span class="op" id="2395032">*</span><span class="ident" id="2395033">fmt</span><span class="op" id="2395036">)</span>&nbsp;<span class="ident" id="2395038">fmt_complex</span><span class="op" id="2395049">(</span><span class="ident" id="2395050">r</span><span class="op" id="2395051">,</span>&nbsp;<span class="ident" id="2395053">j</span>&nbsp;<span class="builtintype" id="2395055">float64</span><span class="op" id="2395062">,</span>&nbsp;<span class="ident" id="2395064">size</span>&nbsp;<span class="builtintype" id="2395069">int</span><span class="op" id="2395072">,</span>&nbsp;<span class="ident" id="2395074">verb</span>&nbsp;<span class="builtintype" id="2395079">rune</span><span class="op" id="2395083">)</span>&nbsp;<span class="op" id="2395085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395088">f</span><span class="op" id="2395089">.</span><span class="ident" id="2395090">buf</span><span class="op" id="2395093">.</span><span class="ident" id="2395094">WriteByte</span><span class="op" id="2395103">(</span><span class="string" id="2395104">&#39;(&#39;</span><span class="op" id="2395107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395110">oldPlus</span>&nbsp;<span class="op" id="2395118">:=</span>&nbsp;<span class="ident" id="2395121">f</span><span class="op" id="2395122">.</span><span class="ident" id="2395123">plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395129">oldSpace</span>&nbsp;<span class="op" id="2395138">:=</span>&nbsp;<span class="ident" id="2395141">f</span><span class="op" id="2395142">.</span><span class="ident" id="2395143">space</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395150">oldWid</span>&nbsp;<span class="op" id="2395157">:=</span>&nbsp;<span class="ident" id="2395160">f</span><span class="op" id="2395161">.</span><span class="ident" id="2395162">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395167">for</span>&nbsp;<span class="ident" id="2395171">i</span>&nbsp;<span class="op" id="2395173">:=</span>&nbsp;<span class="num" id="2395176">0</span><span class="op" id="2395177">;</span>&nbsp;<span class="op" id="2395179">;</span>&nbsp;<span class="ident" id="2395181">i</span><span class="op" id="2395182">++</span>&nbsp;<span class="op" id="2395185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395189">switch</span>&nbsp;<span class="ident" id="2395196">verb</span>&nbsp;<span class="op" id="2395201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395205">case</span>&nbsp;<span class="string" id="2395210">&#39;b&#39;</span><span class="op" id="2395213">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395218">f</span><span class="op" id="2395219">.</span><span class="ident" id="2395220">formatFloat</span><span class="op" id="2395231">(</span><span class="ident" id="2395232">r</span><span class="op" id="2395233">,</span>&nbsp;<span class="string" id="2395235">&#39;b&#39;</span><span class="op" id="2395238">,</span>&nbsp;<span class="num" id="2395240">0</span><span class="op" id="2395241">,</span>&nbsp;<span class="ident" id="2395243">size</span><span class="op" id="2395247">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395251">case</span>&nbsp;<span class="string" id="2395256">&#39;e&#39;</span><span class="op" id="2395259">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395264">f</span><span class="op" id="2395265">.</span><span class="ident" id="2395266">formatFloat</span><span class="op" id="2395277">(</span><span class="ident" id="2395278">r</span><span class="op" id="2395279">,</span>&nbsp;<span class="string" id="2395281">&#39;e&#39;</span><span class="op" id="2395284">,</span>&nbsp;<span class="ident" id="2395286">doPrec</span><span class="op" id="2395292">(</span><span class="ident" id="2395293">f</span><span class="op" id="2395294">,</span>&nbsp;<span class="num" id="2395296">6</span><span class="op" id="2395297">)</span><span class="op" id="2395298">,</span>&nbsp;<span class="ident" id="2395300">size</span><span class="op" id="2395304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395308">case</span>&nbsp;<span class="string" id="2395313">&#39;E&#39;</span><span class="op" id="2395316">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395321">f</span><span class="op" id="2395322">.</span><span class="ident" id="2395323">formatFloat</span><span class="op" id="2395334">(</span><span class="ident" id="2395335">r</span><span class="op" id="2395336">,</span>&nbsp;<span class="string" id="2395338">&#39;E&#39;</span><span class="op" id="2395341">,</span>&nbsp;<span class="ident" id="2395343">doPrec</span><span class="op" id="2395349">(</span><span class="ident" id="2395350">f</span><span class="op" id="2395351">,</span>&nbsp;<span class="num" id="2395353">6</span><span class="op" id="2395354">)</span><span class="op" id="2395355">,</span>&nbsp;<span class="ident" id="2395357">size</span><span class="op" id="2395361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395365">case</span>&nbsp;<span class="string" id="2395370">&#39;f&#39;</span><span class="op" id="2395373">,</span>&nbsp;<span class="string" id="2395375">&#39;F&#39;</span><span class="op" id="2395378">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395383">f</span><span class="op" id="2395384">.</span><span class="ident" id="2395385">formatFloat</span><span class="op" id="2395396">(</span><span class="ident" id="2395397">r</span><span class="op" id="2395398">,</span>&nbsp;<span class="string" id="2395400">&#39;f&#39;</span><span class="op" id="2395403">,</span>&nbsp;<span class="ident" id="2395405">doPrec</span><span class="op" id="2395411">(</span><span class="ident" id="2395412">f</span><span class="op" id="2395413">,</span>&nbsp;<span class="num" id="2395415">6</span><span class="op" id="2395416">)</span><span class="op" id="2395417">,</span>&nbsp;<span class="ident" id="2395419">size</span><span class="op" id="2395423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395427">case</span>&nbsp;<span class="string" id="2395432">&#39;g&#39;</span><span class="op" id="2395435">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395440">f</span><span class="op" id="2395441">.</span><span class="ident" id="2395442">formatFloat</span><span class="op" id="2395453">(</span><span class="ident" id="2395454">r</span><span class="op" id="2395455">,</span>&nbsp;<span class="string" id="2395457">&#39;g&#39;</span><span class="op" id="2395460">,</span>&nbsp;<span class="ident" id="2395462">doPrec</span><span class="op" id="2395468">(</span><span class="ident" id="2395469">f</span><span class="op" id="2395470">,</span>&nbsp;<span class="op" id="2395472">-</span><span class="num" id="2395473">1</span><span class="op" id="2395474">)</span><span class="op" id="2395475">,</span>&nbsp;<span class="ident" id="2395477">size</span><span class="op" id="2395481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395485">case</span>&nbsp;<span class="string" id="2395490">&#39;G&#39;</span><span class="op" id="2395493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395498">f</span><span class="op" id="2395499">.</span><span class="ident" id="2395500">formatFloat</span><span class="op" id="2395511">(</span><span class="ident" id="2395512">r</span><span class="op" id="2395513">,</span>&nbsp;<span class="string" id="2395515">&#39;G&#39;</span><span class="op" id="2395518">,</span>&nbsp;<span class="ident" id="2395520">doPrec</span><span class="op" id="2395526">(</span><span class="ident" id="2395527">f</span><span class="op" id="2395528">,</span>&nbsp;<span class="op" id="2395530">-</span><span class="num" id="2395531">1</span><span class="op" id="2395532">)</span><span class="op" id="2395533">,</span>&nbsp;<span class="ident" id="2395535">size</span><span class="op" id="2395539">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395547">if</span>&nbsp;<span class="ident" id="2395550">i</span>&nbsp;<span class="op" id="2395552">!=</span>&nbsp;<span class="num" id="2395555">0</span>&nbsp;<span class="op" id="2395557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395562">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2395574">//&nbsp;Imaginary&nbsp;part&nbsp;always&nbsp;has&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395613">f</span><span class="op" id="2395614">.</span><span class="ident" id="2395615">plus</span>&nbsp;<span class="op" id="2395620">=</span>&nbsp;<span class="builtintype" id="2395622">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395629">f</span><span class="op" id="2395630">.</span><span class="ident" id="2395631">space</span>&nbsp;<span class="op" id="2395637">=</span>&nbsp;<span class="builtintype" id="2395639">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395647">f</span><span class="op" id="2395648">.</span><span class="ident" id="2395649">wid</span>&nbsp;<span class="op" id="2395653">=</span>&nbsp;<span class="ident" id="2395655">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395664">r</span>&nbsp;<span class="op" id="2395666">=</span>&nbsp;<span class="ident" id="2395668">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395671">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395674">f</span><span class="op" id="2395675">.</span><span class="ident" id="2395676">space</span>&nbsp;<span class="op" id="2395682">=</span>&nbsp;<span class="ident" id="2395684">oldSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395694">f</span><span class="op" id="2395695">.</span><span class="ident" id="2395696">plus</span>&nbsp;<span class="op" id="2395701">=</span>&nbsp;<span class="ident" id="2395703">oldPlus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395712">f</span><span class="op" id="2395713">.</span><span class="ident" id="2395714">wid</span>&nbsp;<span class="op" id="2395718">=</span>&nbsp;<span class="ident" id="2395720">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395728">f</span><span class="op" id="2395729">.</span><span class="ident" id="2395730">buf</span><span class="op" id="2395733">.</span><span class="ident" id="2395734">Write</span><span class="op" id="2395739">(</span><span class="ident" id="2395740">irparenBytes</span><span class="op" id="2395752">)</span><br>
<span class="lineno"></span><span class="op" id="2395754">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
