<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>path</h2>
<ul>
<li><a href="/gostd/path/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/path/match.go.html">match.go</a></li>
<li><a href="/gostd/path/match_test.go.html">match_test.go</a></li>
<li><a href="/gostd/path/path.go.html">path.go</a></li>
<li><a href="/gostd/path/path_test.go.html">path_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2791111">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2791166">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2791220">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2791271">//&nbsp;Package&nbsp;path&nbsp;implements&nbsp;utility&nbsp;routines&nbsp;for&nbsp;manipulating&nbsp;slash-separated</span><br>
<span class="lineno"></span><span class="comment" id="2791348">//&nbsp;paths.</span><br>
<span class="lineno"></span><span class="keyword" id="2791358">package</span>&nbsp;<span class="ident" id="2791366">path</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2791372">import</span>&nbsp;<span class="op" id="2791379">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2791382">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="2791392">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2791395">//&nbsp;A&nbsp;lazybuf&nbsp;is&nbsp;a&nbsp;lazily&nbsp;constructed&nbsp;path&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="comment" id="2791445">//&nbsp;It&nbsp;supports&nbsp;append,&nbsp;reading&nbsp;previously&nbsp;appended&nbsp;bytes,</span><br>
<span class="lineno">15</span><span class="comment" id="2791503">//&nbsp;and&nbsp;retrieving&nbsp;the&nbsp;final&nbsp;string.&nbsp;It&nbsp;does&nbsp;not&nbsp;allocate&nbsp;a&nbsp;buffer</span><br>
<span class="lineno"></span><span class="comment" id="2791569">//&nbsp;to&nbsp;hold&nbsp;the&nbsp;output&nbsp;until&nbsp;that&nbsp;output&nbsp;diverges&nbsp;from&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="2791626">type</span>&nbsp;<span class="ident" id="2791631">lazybuf</span>&nbsp;<span class="keyword" id="2791639">struct</span>&nbsp;<span class="op" id="2791646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791649">s</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2791653">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791661">buf</span>&nbsp;<span class="op" id="2791665">[</span><span class="op" id="2791666">]</span><span class="builtintype" id="2791667">byte</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791673">w</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2791677">int</span><br>
<span class="lineno"></span><span class="op" id="2791681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2791684">func</span>&nbsp;<span class="op" id="2791689">(</span><span class="ident" id="2791690">b</span>&nbsp;<span class="op" id="2791692">*</span><span class="ident" id="2791693">lazybuf</span><span class="op" id="2791700">)</span>&nbsp;<span class="ident" id="2791702">index</span><span class="op" id="2791707">(</span><span class="ident" id="2791708">i</span>&nbsp;<span class="builtintype" id="2791710">int</span><span class="op" id="2791713">)</span>&nbsp;<span class="builtintype" id="2791715">byte</span>&nbsp;<span class="op" id="2791720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791723">if</span>&nbsp;<span class="ident" id="2791726">b</span><span class="op" id="2791727">.</span><span class="ident" id="2791728">buf</span>&nbsp;<span class="op" id="2791732">!=</span>&nbsp;<span class="ident" id="2791735">nil</span>&nbsp;<span class="op" id="2791739">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791743">return</span>&nbsp;<span class="ident" id="2791750">b</span><span class="op" id="2791751">.</span><span class="ident" id="2791752">buf</span><span class="op" id="2791755">[</span><span class="ident" id="2791756">i</span><span class="op" id="2791757">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791763">return</span>&nbsp;<span class="ident" id="2791770">b</span><span class="op" id="2791771">.</span><span class="ident" id="2791772">s</span><span class="op" id="2791773">[</span><span class="ident" id="2791774">i</span><span class="op" id="2791775">]</span><br>
<span class="lineno"></span><span class="op" id="2791777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="2791780">func</span>&nbsp;<span class="op" id="2791785">(</span><span class="ident" id="2791786">b</span>&nbsp;<span class="op" id="2791788">*</span><span class="ident" id="2791789">lazybuf</span><span class="op" id="2791796">)</span>&nbsp;<span class="builtinfunc" id="2791798">append</span><span class="op" id="2791804">(</span><span class="ident" id="2791805">c</span>&nbsp;<span class="builtintype" id="2791807">byte</span><span class="op" id="2791811">)</span>&nbsp;<span class="op" id="2791813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791816">if</span>&nbsp;<span class="ident" id="2791819">b</span><span class="op" id="2791820">.</span><span class="ident" id="2791821">buf</span>&nbsp;<span class="op" id="2791825">==</span>&nbsp;<span class="ident" id="2791828">nil</span>&nbsp;<span class="op" id="2791832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791836">if</span>&nbsp;<span class="ident" id="2791839">b</span><span class="op" id="2791840">.</span><span class="ident" id="2791841">w</span>&nbsp;<span class="op" id="2791843">&lt;</span>&nbsp;<span class="builtinfunc" id="2791845">len</span><span class="op" id="2791848">(</span><span class="ident" id="2791849">b</span><span class="op" id="2791850">.</span><span class="ident" id="2791851">s</span><span class="op" id="2791852">)</span>&nbsp;<span class="op" id="2791854">&amp;&amp;</span>&nbsp;<span class="ident" id="2791857">b</span><span class="op" id="2791858">.</span><span class="ident" id="2791859">s</span><span class="op" id="2791860">[</span><span class="ident" id="2791861">b</span><span class="op" id="2791862">.</span><span class="ident" id="2791863">w</span><span class="op" id="2791864">]</span>&nbsp;<span class="op" id="2791866">==</span>&nbsp;<span class="ident" id="2791869">c</span>&nbsp;<span class="op" id="2791871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791876">b</span><span class="op" id="2791877">.</span><span class="ident" id="2791878">w</span><span class="op" id="2791879">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2791885">return</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791898">b</span><span class="op" id="2791899">.</span><span class="ident" id="2791900">buf</span>&nbsp;<span class="op" id="2791904">=</span>&nbsp;<span class="builtinfunc" id="2791906">make</span><span class="op" id="2791910">(</span><span class="op" id="2791911">[</span><span class="op" id="2791912">]</span><span class="builtintype" id="2791913">byte</span><span class="op" id="2791917">,</span>&nbsp;<span class="builtinfunc" id="2791919">len</span><span class="op" id="2791922">(</span><span class="ident" id="2791923">b</span><span class="op" id="2791924">.</span><span class="ident" id="2791925">s</span><span class="op" id="2791926">)</span><span class="op" id="2791927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2791931">copy</span><span class="op" id="2791935">(</span><span class="ident" id="2791936">b</span><span class="op" id="2791937">.</span><span class="ident" id="2791938">buf</span><span class="op" id="2791941">,</span>&nbsp;<span class="ident" id="2791943">b</span><span class="op" id="2791944">.</span><span class="ident" id="2791945">s</span><span class="op" id="2791946">[</span><span class="op" id="2791947">:</span><span class="ident" id="2791948">b</span><span class="op" id="2791949">.</span><span class="ident" id="2791950">w</span><span class="op" id="2791951">]</span><span class="op" id="2791952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2791955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791958">b</span><span class="op" id="2791959">.</span><span class="ident" id="2791960">buf</span><span class="op" id="2791963">[</span><span class="ident" id="2791964">b</span><span class="op" id="2791965">.</span><span class="ident" id="2791966">w</span><span class="op" id="2791967">]</span>&nbsp;<span class="op" id="2791969">=</span>&nbsp;<span class="ident" id="2791971">c</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2791974">b</span><span class="op" id="2791975">.</span><span class="ident" id="2791976">w</span><span class="op" id="2791977">++</span><br>
<span class="lineno"></span><span class="op" id="2791980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2791983">func</span>&nbsp;<span class="op" id="2791988">(</span><span class="ident" id="2791989">b</span>&nbsp;<span class="op" id="2791991">*</span><span class="ident" id="2791992">lazybuf</span><span class="op" id="2791999">)</span>&nbsp;<span class="builtintype" id="2792001">string</span><span class="op" id="2792007">(</span><span class="op" id="2792008">)</span>&nbsp;<span class="builtintype" id="2792010">string</span>&nbsp;<span class="op" id="2792017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2792020">if</span>&nbsp;<span class="ident" id="2792023">b</span><span class="op" id="2792024">.</span><span class="ident" id="2792025">buf</span>&nbsp;<span class="op" id="2792029">==</span>&nbsp;<span class="ident" id="2792032">nil</span>&nbsp;<span class="op" id="2792036">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2792040">return</span>&nbsp;<span class="ident" id="2792047">b</span><span class="op" id="2792048">.</span><span class="ident" id="2792049">s</span><span class="op" id="2792050">[</span><span class="op" id="2792051">:</span><span class="ident" id="2792052">b</span><span class="op" id="2792053">.</span><span class="ident" id="2792054">w</span><span class="op" id="2792055">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2792058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2792061">return</span>&nbsp;<span class="builtintype" id="2792068">string</span><span class="op" id="2792074">(</span><span class="ident" id="2792075">b</span><span class="op" id="2792076">.</span><span class="ident" id="2792077">buf</span><span class="op" id="2792080">[</span><span class="op" id="2792081">:</span><span class="ident" id="2792082">b</span><span class="op" id="2792083">.</span><span class="ident" id="2792084">w</span><span class="op" id="2792085">]</span><span class="op" id="2792086">)</span><br>
<span class="lineno"></span><span class="op" id="2792088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="2792091">//&nbsp;Clean&nbsp;returns&nbsp;the&nbsp;shortest&nbsp;path&nbsp;name&nbsp;equivalent&nbsp;to&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="2792150">//&nbsp;by&nbsp;purely&nbsp;lexical&nbsp;processing.&nbsp;&nbsp;It&nbsp;applies&nbsp;the&nbsp;following&nbsp;rules</span><br>
<span class="lineno"></span><span class="comment" id="2792215">//&nbsp;iteratively&nbsp;until&nbsp;no&nbsp;further&nbsp;processing&nbsp;can&nbsp;be&nbsp;done:</span><br>
<span class="lineno"></span><span class="comment" id="2792271">//</span><br>
<span class="lineno"></span><span class="comment" id="2792274">//&nbsp;&nbsp;&nbsp;&nbsp1.&nbsp;Replace&nbsp;multiple&nbsp;slashes&nbsp;with&nbsp;a&nbsp;single&nbsp;slash.</span><br>
<span class="lineno">55</span><span class="comment" id="2792326">//&nbsp;&nbsp;&nbsp;&nbsp2.&nbsp;Eliminate&nbsp;each&nbsp;.&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;current&nbsp;directory).</span><br>
<span class="lineno"></span><span class="comment" id="2792392">//&nbsp;&nbsp;&nbsp;&nbsp3.&nbsp;Eliminate&nbsp;each&nbsp;inner&nbsp;..&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;parent&nbsp;directory)</span><br>
<span class="lineno"></span><span class="comment" id="2792463">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;along&nbsp;with&nbsp;the&nbsp;non-..&nbsp;element&nbsp;that&nbsp;precedes&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2792517">//&nbsp;&nbsp;&nbsp;&nbsp4.&nbsp;Eliminate&nbsp;..&nbsp;elements&nbsp;that&nbsp;begin&nbsp;a&nbsp;rooted&nbsp;path:</span><br>
<span class="lineno"></span><span class="comment" id="2792571">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;is,&nbsp;replace&nbsp;&#34;/..&#34;&nbsp;by&nbsp;&#34;/&#34;&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;path.</span><br>
<span class="lineno">60</span><span class="comment" id="2792635">//</span><br>
<span class="lineno"></span><span class="comment" id="2792638">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;ends&nbsp;in&nbsp;a&nbsp;slash&nbsp;only&nbsp;if&nbsp;it&nbsp;is&nbsp;the&nbsp;root&nbsp;&#34;/&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2792703">//</span><br>
<span class="lineno"></span><span class="comment" id="2792706">//&nbsp;If&nbsp;the&nbsp;result&nbsp;of&nbsp;this&nbsp;process&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,&nbsp;Clean</span><br>
<span class="lineno"></span><span class="comment" id="2792765">//&nbsp;returns&nbsp;the&nbsp;string&nbsp;&#34;.&#34;.</span><br>
<span class="lineno">65</span><span class="comment" id="2792792">//</span><br>
<span class="lineno"></span><span class="comment" id="2792795">//&nbsp;See&nbsp;also&nbsp;Rob&nbsp;Pike,&nbsp;``Lexical&nbsp;File&nbsp;Names&nbsp;in&nbsp;Plan&nbsp;9&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2792851">//&nbsp;Getting&nbsp;Dot-Dot&nbsp;Right,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="2792879">//&nbsp;http://plan9.bell-labs.com/sys/doc/lexnames.html</span><br>
<span class="lineno"></span><span class="keyword" id="2792931">func</span>&nbsp;<span class="ident" id="2792936">Clean</span><span class="op" id="2792941">(</span><span class="ident" id="2792942">path</span>&nbsp;<span class="builtintype" id="2792947">string</span><span class="op" id="2792953">)</span>&nbsp;<span class="builtintype" id="2792955">string</span>&nbsp;<span class="op" id="2792962">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2792965">if</span>&nbsp;<span class="ident" id="2792968">path</span>&nbsp;<span class="op" id="2792973">==</span>&nbsp;<span class="string" id="2792976">&#34;&#34;</span>&nbsp;<span class="op" id="2792979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2792983">return</span>&nbsp;<span class="string" id="2792990">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2792995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2792999">rooted</span>&nbsp;<span class="op" id="2793006">:=</span>&nbsp;<span class="ident" id="2793009">path</span><span class="op" id="2793013">[</span><span class="num" id="2793014">0</span><span class="op" id="2793015">]</span>&nbsp;<span class="op" id="2793017">==</span>&nbsp;<span class="string" id="2793020">&#39;/&#39;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793025">n</span>&nbsp;<span class="op" id="2793027">:=</span>&nbsp;<span class="builtinfunc" id="2793030">len</span><span class="op" id="2793033">(</span><span class="ident" id="2793034">path</span><span class="op" id="2793038">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2793042">//&nbsp;Invariants:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2793058">//&nbsp;&nbsp;&nbsp;&nbspreading&nbsp;from&nbsp;path;&nbsp;r&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;process.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2793117">//&nbsp;&nbsp;&nbsp;&nbspwriting&nbsp;to&nbsp;buf;&nbsp;w&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;write.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2793171">//&nbsp;&nbsp;&nbsp;&nbspdotdot&nbsp;is&nbsp;index&nbsp;in&nbsp;buf&nbsp;where&nbsp;..&nbsp;must&nbsp;stop,&nbsp;either&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2793233">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspit&nbsp;is&nbsp;the&nbsp;leading&nbsp;slash&nbsp;or&nbsp;it&nbsp;is&nbsp;a&nbsp;leading&nbsp;../../..&nbsp;prefix.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793298">out</span>&nbsp;<span class="op" id="2793302">:=</span>&nbsp;<span class="ident" id="2793305">lazybuf</span><span class="op" id="2793312">{</span><span class="ident" id="2793313">s</span><span class="op" id="2793314">:</span>&nbsp;<span class="ident" id="2793316">path</span><span class="op" id="2793320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793323">r</span><span class="op" id="2793324">,</span>&nbsp;<span class="ident" id="2793326">dotdot</span>&nbsp;<span class="op" id="2793333">:=</span>&nbsp;<span class="num" id="2793336">0</span><span class="op" id="2793337">,</span>&nbsp;<span class="num" id="2793339">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793342">if</span>&nbsp;<span class="ident" id="2793345">rooted</span>&nbsp;<span class="op" id="2793352">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793356">out</span><span class="op" id="2793359">.</span><span class="builtinfunc" id="2793360">append</span><span class="op" id="2793366">(</span><span class="string" id="2793367">&#39;/&#39;</span><span class="op" id="2793370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793374">r</span><span class="op" id="2793375">,</span>&nbsp;<span class="ident" id="2793377">dotdot</span>&nbsp;<span class="op" id="2793384">=</span>&nbsp;<span class="num" id="2793386">1</span><span class="op" id="2793387">,</span>&nbsp;<span class="num" id="2793389">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2793392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793396">for</span>&nbsp;<span class="ident" id="2793400">r</span>&nbsp;<span class="op" id="2793402">&lt;</span>&nbsp;<span class="ident" id="2793404">n</span>&nbsp;<span class="op" id="2793406">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793410">switch</span>&nbsp;<span class="op" id="2793417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793421">case</span>&nbsp;<span class="ident" id="2793426">path</span><span class="op" id="2793430">[</span><span class="ident" id="2793431">r</span><span class="op" id="2793432">]</span>&nbsp;<span class="op" id="2793434">==</span>&nbsp;<span class="string" id="2793437">&#39;/&#39;</span><span class="op" id="2793440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2793445">//&nbsp;empty&nbsp;path&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793470">r</span><span class="op" id="2793471">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793476">case</span>&nbsp;<span class="ident" id="2793481">path</span><span class="op" id="2793485">[</span><span class="ident" id="2793486">r</span><span class="op" id="2793487">]</span>&nbsp;<span class="op" id="2793489">==</span>&nbsp;<span class="string" id="2793492">&#39;.&#39;</span>&nbsp;<span class="op" id="2793496">&amp;&amp;</span>&nbsp;<span class="op" id="2793499">(</span><span class="ident" id="2793500">r</span><span class="op" id="2793501">+</span><span class="num" id="2793502">1</span>&nbsp;<span class="op" id="2793504">==</span>&nbsp;<span class="ident" id="2793507">n</span>&nbsp;<span class="op" id="2793509">||</span>&nbsp;<span class="ident" id="2793512">path</span><span class="op" id="2793516">[</span><span class="ident" id="2793517">r</span><span class="op" id="2793518">+</span><span class="num" id="2793519">1</span><span class="op" id="2793520">]</span>&nbsp;<span class="op" id="2793522">==</span>&nbsp;<span class="string" id="2793525">&#39;/&#39;</span><span class="op" id="2793528">)</span><span class="op" id="2793529">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2793534">//&nbsp;.&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793550">r</span><span class="op" id="2793551">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793556">case</span>&nbsp;<span class="ident" id="2793561">path</span><span class="op" id="2793565">[</span><span class="ident" id="2793566">r</span><span class="op" id="2793567">]</span>&nbsp;<span class="op" id="2793569">==</span>&nbsp;<span class="string" id="2793572">&#39;.&#39;</span>&nbsp;<span class="op" id="2793576">&amp;&amp;</span>&nbsp;<span class="ident" id="2793579">path</span><span class="op" id="2793583">[</span><span class="ident" id="2793584">r</span><span class="op" id="2793585">+</span><span class="num" id="2793586">1</span><span class="op" id="2793587">]</span>&nbsp;<span class="op" id="2793589">==</span>&nbsp;<span class="string" id="2793592">&#39;.&#39;</span>&nbsp;<span class="op" id="2793596">&amp;&amp;</span>&nbsp;<span class="op" id="2793599">(</span><span class="ident" id="2793600">r</span><span class="op" id="2793601">+</span><span class="num" id="2793602">2</span>&nbsp;<span class="op" id="2793604">==</span>&nbsp;<span class="ident" id="2793607">n</span>&nbsp;<span class="op" id="2793609">||</span>&nbsp;<span class="ident" id="2793612">path</span><span class="op" id="2793616">[</span><span class="ident" id="2793617">r</span><span class="op" id="2793618">+</span><span class="num" id="2793619">2</span><span class="op" id="2793620">]</span>&nbsp;<span class="op" id="2793622">==</span>&nbsp;<span class="string" id="2793625">&#39;/&#39;</span><span class="op" id="2793628">)</span><span class="op" id="2793629">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2793634">//&nbsp;..&nbsp;element:&nbsp;remove&nbsp;to&nbsp;last&nbsp;/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793669">r</span>&nbsp;<span class="op" id="2793671">+=</span>&nbsp;<span class="num" id="2793674">2</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793679">switch</span>&nbsp;<span class="op" id="2793686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793691">case</span>&nbsp;<span class="ident" id="2793696">out</span><span class="op" id="2793699">.</span><span class="ident" id="2793700">w</span>&nbsp;<span class="op" id="2793702">&gt;</span>&nbsp;<span class="ident" id="2793704">dotdot</span><span class="op" id="2793710">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2793716">//&nbsp;can&nbsp;backtrack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793737">out</span><span class="op" id="2793740">.</span><span class="ident" id="2793741">w</span><span class="op" id="2793742">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793749">for</span>&nbsp;<span class="ident" id="2793753">out</span><span class="op" id="2793756">.</span><span class="ident" id="2793757">w</span>&nbsp;<span class="op" id="2793759">&gt;</span>&nbsp;<span class="ident" id="2793761">dotdot</span>&nbsp;<span class="op" id="2793768">&amp;&amp;</span>&nbsp;<span class="ident" id="2793771">out</span><span class="op" id="2793774">.</span><span class="ident" id="2793775">index</span><span class="op" id="2793780">(</span><span class="ident" id="2793781">out</span><span class="op" id="2793784">.</span><span class="ident" id="2793785">w</span><span class="op" id="2793786">)</span>&nbsp;<span class="op" id="2793788">!=</span>&nbsp;<span class="string" id="2793791">&#39;/&#39;</span>&nbsp;<span class="op" id="2793795">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793802">out</span><span class="op" id="2793805">.</span><span class="ident" id="2793806">w</span><span class="op" id="2793807">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2793814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793819">case</span>&nbsp;<span class="op" id="2793824">!</span><span class="ident" id="2793825">rooted</span><span class="op" id="2793831">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2793837">//&nbsp;cannot&nbsp;backtrack,&nbsp;but&nbsp;not&nbsp;rooted,&nbsp;so&nbsp;append&nbsp;..&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2793900">if</span>&nbsp;<span class="ident" id="2793903">out</span><span class="op" id="2793906">.</span><span class="ident" id="2793907">w</span>&nbsp;<span class="op" id="2793909">&gt;</span>&nbsp;<span class="num" id="2793911">0</span>&nbsp;<span class="op" id="2793913">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793920">out</span><span class="op" id="2793923">.</span><span class="builtinfunc" id="2793924">append</span><span class="op" id="2793930">(</span><span class="string" id="2793931">&#39;/&#39;</span><span class="op" id="2793934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2793940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793946">out</span><span class="op" id="2793949">.</span><span class="builtinfunc" id="2793950">append</span><span class="op" id="2793956">(</span><span class="string" id="2793957">&#39;.&#39;</span><span class="op" id="2793960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793966">out</span><span class="op" id="2793969">.</span><span class="builtinfunc" id="2793970">append</span><span class="op" id="2793976">(</span><span class="string" id="2793977">&#39;.&#39;</span><span class="op" id="2793980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2793986">dotdot</span>&nbsp;<span class="op" id="2793993">=</span>&nbsp;<span class="ident" id="2793995">out</span><span class="op" id="2793998">.</span><span class="ident" id="2793999">w</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2794004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794008">default</span><span class="op" id="2794015">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2794020">//&nbsp;real&nbsp;path&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2794045">//&nbsp;add&nbsp;slash&nbsp;if&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794071">if</span>&nbsp;<span class="ident" id="2794074">rooted</span>&nbsp;<span class="op" id="2794081">&amp;&amp;</span>&nbsp;<span class="ident" id="2794084">out</span><span class="op" id="2794087">.</span><span class="ident" id="2794088">w</span>&nbsp;<span class="op" id="2794090">!=</span>&nbsp;<span class="num" id="2794093">1</span>&nbsp;<span class="op" id="2794095">||</span>&nbsp;<span class="op" id="2794098">!</span><span class="ident" id="2794099">rooted</span>&nbsp;<span class="op" id="2794106">&amp;&amp;</span>&nbsp;<span class="ident" id="2794109">out</span><span class="op" id="2794112">.</span><span class="ident" id="2794113">w</span>&nbsp;<span class="op" id="2794115">!=</span>&nbsp;<span class="num" id="2794118">0</span>&nbsp;<span class="op" id="2794120">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794126">out</span><span class="op" id="2794129">.</span><span class="builtinfunc" id="2794130">append</span><span class="op" id="2794136">(</span><span class="string" id="2794137">&#39;/&#39;</span><span class="op" id="2794140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2794145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2794150">//&nbsp;copy&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794169">for</span>&nbsp;<span class="op" id="2794173">;</span>&nbsp;<span class="ident" id="2794175">r</span>&nbsp;<span class="op" id="2794177">&lt;</span>&nbsp;<span class="ident" id="2794179">n</span>&nbsp;<span class="op" id="2794181">&amp;&amp;</span>&nbsp;<span class="ident" id="2794184">path</span><span class="op" id="2794188">[</span><span class="ident" id="2794189">r</span><span class="op" id="2794190">]</span>&nbsp;<span class="op" id="2794192">!=</span>&nbsp;<span class="string" id="2794195">&#39;/&#39;</span><span class="op" id="2794198">;</span>&nbsp;<span class="ident" id="2794200">r</span><span class="op" id="2794201">++</span>&nbsp;<span class="op" id="2794204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794210">out</span><span class="op" id="2794213">.</span><span class="builtinfunc" id="2794214">append</span><span class="op" id="2794220">(</span><span class="ident" id="2794221">path</span><span class="op" id="2794225">[</span><span class="ident" id="2794226">r</span><span class="op" id="2794227">]</span><span class="op" id="2794228">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2794233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2794237">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2794240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2794244">//&nbsp;Turn&nbsp;empty&nbsp;string&nbsp;into&nbsp;&#34;.&#34;</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794275">if</span>&nbsp;<span class="ident" id="2794278">out</span><span class="op" id="2794281">.</span><span class="ident" id="2794282">w</span>&nbsp;<span class="op" id="2794284">==</span>&nbsp;<span class="num" id="2794287">0</span>&nbsp;<span class="op" id="2794289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794293">return</span>&nbsp;<span class="string" id="2794300">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2794305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794309">return</span>&nbsp;<span class="ident" id="2794316">out</span><span class="op" id="2794319">.</span><span class="builtintype" id="2794320">string</span><span class="op" id="2794326">(</span><span class="op" id="2794327">)</span><br>
<span class="lineno">135</span><span class="op" id="2794329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2794332">//&nbsp;Split&nbsp;splits&nbsp;path&nbsp;immediately&nbsp;following&nbsp;the&nbsp;final&nbsp;slash.</span><br>
<span class="lineno"></span><span class="comment" id="2794392">//&nbsp;separating&nbsp;it&nbsp;into&nbsp;a&nbsp;directory&nbsp;and&nbsp;file&nbsp;name&nbsp;component.</span><br>
<span class="lineno"></span><span class="comment" id="2794451">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;slash&nbsp;path,&nbsp;Split&nbsp;returns&nbsp;an&nbsp;empty&nbsp;dir&nbsp;and</span><br>
<span class="lineno">140</span><span class="comment" id="2794512">//&nbsp;file&nbsp;set&nbsp;to&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="2794533">//&nbsp;The&nbsp;returned&nbsp;values&nbsp;have&nbsp;the&nbsp;property&nbsp;that&nbsp;path&nbsp;=&nbsp;dir+file.</span><br>
<span class="lineno"></span><span class="keyword" id="2794596">func</span>&nbsp;<span class="ident" id="2794601">Split</span><span class="op" id="2794606">(</span><span class="ident" id="2794607">path</span>&nbsp;<span class="builtintype" id="2794612">string</span><span class="op" id="2794618">)</span>&nbsp;<span class="op" id="2794620">(</span><span class="ident" id="2794621">dir</span><span class="op" id="2794624">,</span>&nbsp;<span class="ident" id="2794626">file</span>&nbsp;<span class="builtintype" id="2794631">string</span><span class="op" id="2794637">)</span>&nbsp;<span class="op" id="2794639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2794642">i</span>&nbsp;<span class="op" id="2794644">:=</span>&nbsp;<span class="ident" id="2794647">strings</span><span class="op" id="2794654">.</span><span class="ident" id="2794655">LastIndex</span><span class="op" id="2794664">(</span><span class="ident" id="2794665">path</span><span class="op" id="2794669">,</span>&nbsp;<span class="string" id="2794671">&#34;/&#34;</span><span class="op" id="2794674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794677">return</span>&nbsp;<span class="ident" id="2794684">path</span><span class="op" id="2794688">[</span><span class="op" id="2794689">:</span><span class="ident" id="2794690">i</span><span class="op" id="2794691">+</span><span class="num" id="2794692">1</span><span class="op" id="2794693">]</span><span class="op" id="2794694">,</span>&nbsp;<span class="ident" id="2794696">path</span><span class="op" id="2794700">[</span><span class="ident" id="2794701">i</span><span class="op" id="2794702">+</span><span class="num" id="2794703">1</span><span class="op" id="2794704">:</span><span class="op" id="2794705">]</span><br>
<span class="lineno">145</span><span class="op" id="2794707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2794710">//&nbsp;Join&nbsp;joins&nbsp;any&nbsp;number&nbsp;of&nbsp;path&nbsp;elements&nbsp;into&nbsp;a&nbsp;single&nbsp;path,&nbsp;adding&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2794781">//&nbsp;separating&nbsp;slash&nbsp;if&nbsp;necessary.&nbsp;The&nbsp;result&nbsp;is&nbsp;Cleaned;&nbsp;in&nbsp;particular,</span><br>
<span class="lineno"></span><span class="comment" id="2794853">//&nbsp;all&nbsp;empty&nbsp;strings&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">150</span><span class="keyword" id="2794887">func</span>&nbsp;<span class="ident" id="2794892">Join</span><span class="op" id="2794896">(</span><span class="ident" id="2794897">elem</span>&nbsp;<span class="op" id="2794902">...</span><span class="builtintype" id="2794905">string</span><span class="op" id="2794911">)</span>&nbsp;<span class="builtintype" id="2794913">string</span>&nbsp;<span class="op" id="2794920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794923">for</span>&nbsp;<span class="ident" id="2794927">i</span><span class="op" id="2794928">,</span>&nbsp;<span class="ident" id="2794930">e</span>&nbsp;<span class="op" id="2794932">:=</span>&nbsp;<span class="keyword" id="2794935">range</span>&nbsp;<span class="ident" id="2794941">elem</span>&nbsp;<span class="op" id="2794946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794950">if</span>&nbsp;<span class="ident" id="2794953">e</span>&nbsp;<span class="op" id="2794955">!=</span>&nbsp;<span class="string" id="2794958">&#34;&#34;</span>&nbsp;<span class="op" id="2794961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2794966">return</span>&nbsp;<span class="ident" id="2794973">Clean</span><span class="op" id="2794978">(</span><span class="ident" id="2794979">strings</span><span class="op" id="2794986">.</span><span class="ident" id="2794987">Join</span><span class="op" id="2794991">(</span><span class="ident" id="2794992">elem</span><span class="op" id="2794996">[</span><span class="ident" id="2794997">i</span><span class="op" id="2794998">:</span><span class="op" id="2794999">]</span><span class="op" id="2795000">,</span>&nbsp;<span class="string" id="2795002">&#34;/&#34;</span><span class="op" id="2795005">)</span><span class="op" id="2795006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2795010">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2795013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795016">return</span>&nbsp;<span class="string" id="2795023">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2795026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2795029">//&nbsp;Ext&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;extension&nbsp;used&nbsp;by&nbsp;path.</span><br>
<span class="lineno">160</span><span class="comment" id="2795082">//&nbsp;The&nbsp;extension&nbsp;is&nbsp;the&nbsp;suffix&nbsp;beginning&nbsp;at&nbsp;the&nbsp;final&nbsp;dot</span><br>
<span class="lineno"></span><span class="comment" id="2795140">//&nbsp;in&nbsp;the&nbsp;final&nbsp;slash-separated&nbsp;element&nbsp;of&nbsp;path;</span><br>
<span class="lineno"></span><span class="comment" id="2795189">//&nbsp;it&nbsp;is&nbsp;empty&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="2795224">func</span>&nbsp;<span class="ident" id="2795229">Ext</span><span class="op" id="2795232">(</span><span class="ident" id="2795233">path</span>&nbsp;<span class="builtintype" id="2795238">string</span><span class="op" id="2795244">)</span>&nbsp;<span class="builtintype" id="2795246">string</span>&nbsp;<span class="op" id="2795253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795256">for</span>&nbsp;<span class="ident" id="2795260">i</span>&nbsp;<span class="op" id="2795262">:=</span>&nbsp;<span class="builtinfunc" id="2795265">len</span><span class="op" id="2795268">(</span><span class="ident" id="2795269">path</span><span class="op" id="2795273">)</span>&nbsp;<span class="op" id="2795275">-</span>&nbsp;<span class="num" id="2795277">1</span><span class="op" id="2795278">;</span>&nbsp;<span class="ident" id="2795280">i</span>&nbsp;<span class="op" id="2795282">&gt;=</span>&nbsp;<span class="num" id="2795285">0</span>&nbsp;<span class="op" id="2795287">&amp;&amp;</span>&nbsp;<span class="ident" id="2795290">path</span><span class="op" id="2795294">[</span><span class="ident" id="2795295">i</span><span class="op" id="2795296">]</span>&nbsp;<span class="op" id="2795298">!=</span>&nbsp;<span class="string" id="2795301">&#39;/&#39;</span><span class="op" id="2795304">;</span>&nbsp;<span class="ident" id="2795306">i</span><span class="op" id="2795307">--</span>&nbsp;<span class="op" id="2795310">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795314">if</span>&nbsp;<span class="ident" id="2795317">path</span><span class="op" id="2795321">[</span><span class="ident" id="2795322">i</span><span class="op" id="2795323">]</span>&nbsp;<span class="op" id="2795325">==</span>&nbsp;<span class="string" id="2795328">&#39;.&#39;</span>&nbsp;<span class="op" id="2795332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795337">return</span>&nbsp;<span class="ident" id="2795344">path</span><span class="op" id="2795348">[</span><span class="ident" id="2795349">i</span><span class="op" id="2795350">:</span><span class="op" id="2795351">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2795355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2795358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795361">return</span>&nbsp;<span class="string" id="2795368">&#34;&#34;</span><br>
<span class="lineno">170</span><span class="op" id="2795371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2795374">//&nbsp;Base&nbsp;returns&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="2795416">//&nbsp;Trailing&nbsp;slashes&nbsp;are&nbsp;removed&nbsp;before&nbsp;extracting&nbsp;the&nbsp;last&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="2795484">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Base&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno">175</span><span class="comment" id="2795527">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;slashes,&nbsp;Base&nbsp;returns&nbsp;&#34;/&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="2795590">func</span>&nbsp;<span class="ident" id="2795595">Base</span><span class="op" id="2795599">(</span><span class="ident" id="2795600">path</span>&nbsp;<span class="builtintype" id="2795605">string</span><span class="op" id="2795611">)</span>&nbsp;<span class="builtintype" id="2795613">string</span>&nbsp;<span class="op" id="2795620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795623">if</span>&nbsp;<span class="ident" id="2795626">path</span>&nbsp;<span class="op" id="2795631">==</span>&nbsp;<span class="string" id="2795634">&#34;&#34;</span>&nbsp;<span class="op" id="2795637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795641">return</span>&nbsp;<span class="string" id="2795648">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2795653">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795656">//&nbsp;Strip&nbsp;trailing&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795684">for</span>&nbsp;<span class="builtinfunc" id="2795688">len</span><span class="op" id="2795691">(</span><span class="ident" id="2795692">path</span><span class="op" id="2795696">)</span>&nbsp;<span class="op" id="2795698">&gt;</span>&nbsp;<span class="num" id="2795700">0</span>&nbsp;<span class="op" id="2795702">&amp;&amp;</span>&nbsp;<span class="ident" id="2795705">path</span><span class="op" id="2795709">[</span><span class="builtinfunc" id="2795710">len</span><span class="op" id="2795713">(</span><span class="ident" id="2795714">path</span><span class="op" id="2795718">)</span><span class="op" id="2795719">-</span><span class="num" id="2795720">1</span><span class="op" id="2795721">]</span>&nbsp;<span class="op" id="2795723">==</span>&nbsp;<span class="string" id="2795726">&#39;/&#39;</span>&nbsp;<span class="op" id="2795730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795734">path</span>&nbsp;<span class="op" id="2795739">=</span>&nbsp;<span class="ident" id="2795741">path</span><span class="op" id="2795745">[</span><span class="num" id="2795746">0</span>&nbsp;<span class="op" id="2795748">:</span>&nbsp;<span class="builtinfunc" id="2795750">len</span><span class="op" id="2795753">(</span><span class="ident" id="2795754">path</span><span class="op" id="2795758">)</span><span class="op" id="2795759">-</span><span class="num" id="2795760">1</span><span class="op" id="2795761">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2795764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795767">//&nbsp;Find&nbsp;the&nbsp;last&nbsp;element</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795793">if</span>&nbsp;<span class="ident" id="2795796">i</span>&nbsp;<span class="op" id="2795798">:=</span>&nbsp;<span class="ident" id="2795801">strings</span><span class="op" id="2795808">.</span><span class="ident" id="2795809">LastIndex</span><span class="op" id="2795818">(</span><span class="ident" id="2795819">path</span><span class="op" id="2795823">,</span>&nbsp;<span class="string" id="2795825">&#34;/&#34;</span><span class="op" id="2795828">)</span><span class="op" id="2795829">;</span>&nbsp;<span class="ident" id="2795831">i</span>&nbsp;<span class="op" id="2795833">&gt;=</span>&nbsp;<span class="num" id="2795836">0</span>&nbsp;<span class="op" id="2795838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2795842">path</span>&nbsp;<span class="op" id="2795847">=</span>&nbsp;<span class="ident" id="2795849">path</span><span class="op" id="2795853">[</span><span class="ident" id="2795854">i</span><span class="op" id="2795855">+</span><span class="num" id="2795856">1</span><span class="op" id="2795857">:</span><span class="op" id="2795858">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2795861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2795864">//&nbsp;If&nbsp;empty&nbsp;now,&nbsp;it&nbsp;had&nbsp;only&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795903">if</span>&nbsp;<span class="ident" id="2795906">path</span>&nbsp;<span class="op" id="2795911">==</span>&nbsp;<span class="string" id="2795914">&#34;&#34;</span>&nbsp;<span class="op" id="2795917">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795921">return</span>&nbsp;<span class="string" id="2795928">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2795933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2795936">return</span>&nbsp;<span class="ident" id="2795943">path</span><br>
<span class="lineno"></span><span class="op" id="2795948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="2795951">//&nbsp;IsAbs&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;path&nbsp;is&nbsp;absolute.</span><br>
<span class="lineno"></span><span class="keyword" id="2795998">func</span>&nbsp;<span class="ident" id="2796003">IsAbs</span><span class="op" id="2796008">(</span><span class="ident" id="2796009">path</span>&nbsp;<span class="builtintype" id="2796014">string</span><span class="op" id="2796020">)</span>&nbsp;<span class="builtintype" id="2796022">bool</span>&nbsp;<span class="op" id="2796027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796030">return</span>&nbsp;<span class="builtinfunc" id="2796037">len</span><span class="op" id="2796040">(</span><span class="ident" id="2796041">path</span><span class="op" id="2796045">)</span>&nbsp;<span class="op" id="2796047">&gt;</span>&nbsp;<span class="num" id="2796049">0</span>&nbsp;<span class="op" id="2796051">&amp;&amp;</span>&nbsp;<span class="ident" id="2796054">path</span><span class="op" id="2796058">[</span><span class="num" id="2796059">0</span><span class="op" id="2796060">]</span>&nbsp;<span class="op" id="2796062">==</span>&nbsp;<span class="string" id="2796065">&#39;/&#39;</span><br>
<span class="lineno"></span><span class="op" id="2796069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="2796072">//&nbsp;Dir&nbsp;returns&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path,&nbsp;typically&nbsp;the&nbsp;path&#39;s&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="2796153">//&nbsp;After&nbsp;dropping&nbsp;the&nbsp;final&nbsp;element&nbsp;using&nbsp;Split,&nbsp;the&nbsp;path&nbsp;is&nbsp;Cleaned&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="2796235">//&nbsp;slashes&nbsp;are&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="2796259">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Dir&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2796301">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;slashes&nbsp;followed&nbsp;by&nbsp;non-slash&nbsp;bytes,&nbsp;Dir</span><br>
<span class="lineno">205</span><span class="comment" id="2796378">//&nbsp;returns&nbsp;a&nbsp;single&nbsp;slash.&nbsp;In&nbsp;any&nbsp;other&nbsp;case,&nbsp;the&nbsp;returned&nbsp;path&nbsp;does&nbsp;not&nbsp;end&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2796460">//&nbsp;slash.</span><br>
<span class="lineno"></span><span class="keyword" id="2796470">func</span>&nbsp;<span class="ident" id="2796475">Dir</span><span class="op" id="2796478">(</span><span class="ident" id="2796479">path</span>&nbsp;<span class="builtintype" id="2796484">string</span><span class="op" id="2796490">)</span>&nbsp;<span class="builtintype" id="2796492">string</span>&nbsp;<span class="op" id="2796499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2796502">dir</span><span class="op" id="2796505">,</span>&nbsp;<span class="ident" id="2796507">_</span>&nbsp;<span class="op" id="2796509">:=</span>&nbsp;<span class="ident" id="2796512">Split</span><span class="op" id="2796517">(</span><span class="ident" id="2796518">path</span><span class="op" id="2796522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2796525">return</span>&nbsp;<span class="ident" id="2796532">Clean</span><span class="op" id="2796537">(</span><span class="ident" id="2796538">dir</span><span class="op" id="2796541">)</span><br>
<span class="lineno">210</span><span class="op" id="2796543">}</span>
</div>
</body>
</html>
