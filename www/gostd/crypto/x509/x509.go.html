<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html" class="current">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3933979">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3934034">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3934088">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3934139">//&nbsp;Package&nbsp;x509&nbsp;parses&nbsp;X.509-encoded&nbsp;keys&nbsp;and&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="3934199">package</span>&nbsp;<span class="ident" id="3934207">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3934213">import</span>&nbsp;<span class="op" id="3934220">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934223">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934232">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934242">&#34;crypto/dsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934256">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934272">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934291">&#34;crypto/rsa&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934305">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934320">_</span>&nbsp;<span class="string" id="3934322">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934339">_</span>&nbsp;<span class="string" id="3934341">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934358">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934378">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934395">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934411">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934421">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934427">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934439">&#34;net&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934446">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3934457">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3934464">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3934467">//&nbsp;pkixPublicKey&nbsp;reflects&nbsp;a&nbsp;PKIX&nbsp;public&nbsp;key&nbsp;structure.&nbsp;See&nbsp;SubjectPublicKeyInfo</span><br>
<span class="lineno">30</span><span class="comment" id="3934547">//&nbsp;in&nbsp;RFC&nbsp;3280.</span><br>
<span class="lineno"></span><span class="keyword" id="3934563">type</span>&nbsp;<span class="ident" id="3934568">pkixPublicKey</span>&nbsp;<span class="keyword" id="3934582">struct</span>&nbsp;<span class="op" id="3934589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934592">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934602">pkix</span><span class="op" id="3934606">.</span><span class="ident" id="3934607">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934628">BitString</span>&nbsp;<span class="ident" id="3934638">asn1</span><span class="op" id="3934642">.</span><span class="ident" id="3934643">BitString</span><br>
<span class="lineno"></span><span class="op" id="3934653">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3934656">//&nbsp;ParsePKIXPublicKey&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;public&nbsp;key.&nbsp;These&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="3934728">//&nbsp;typically&nbsp;found&nbsp;in&nbsp;PEM&nbsp;blocks&nbsp;with&nbsp;&#34;BEGIN&nbsp;PUBLIC&nbsp;KEY&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3934786">func</span>&nbsp;<span class="ident" id="3934791">ParsePKIXPublicKey</span><span class="op" id="3934809">(</span><span class="ident" id="3934810">derBytes</span>&nbsp;<span class="op" id="3934819">[</span><span class="op" id="3934820">]</span><span class="builtintype" id="3934821">byte</span><span class="op" id="3934825">)</span>&nbsp;<span class="op" id="3934827">(</span><span class="ident" id="3934828">pub</span>&nbsp;<span class="keyword" id="3934832">interface</span><span class="op" id="3934841">{</span><span class="op" id="3934842">}</span><span class="op" id="3934843">,</span>&nbsp;<span class="ident" id="3934845">err</span>&nbsp;<span class="builtintype" id="3934849">error</span><span class="op" id="3934854">)</span>&nbsp;<span class="op" id="3934856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934859">var</span>&nbsp;<span class="ident" id="3934863">pki</span>&nbsp;<span class="ident" id="3934867">publicKeyInfo</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934882">if</span>&nbsp;<span class="ident" id="3934885">_</span><span class="op" id="3934886">,</span>&nbsp;<span class="ident" id="3934888">err</span>&nbsp;<span class="op" id="3934892">=</span>&nbsp;<span class="ident" id="3934894">asn1</span><span class="op" id="3934898">.</span><span class="ident" id="3934899">Unmarshal</span><span class="op" id="3934908">(</span><span class="ident" id="3934909">derBytes</span><span class="op" id="3934917">,</span>&nbsp;<span class="op" id="3934919">&amp;</span><span class="ident" id="3934920">pki</span><span class="op" id="3934923">)</span><span class="op" id="3934924">;</span>&nbsp;<span class="ident" id="3934926">err</span>&nbsp;<span class="op" id="3934930">!=</span>&nbsp;<span class="builtintype" id="3934933">nil</span>&nbsp;<span class="op" id="3934937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3934941">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3934949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3934952">algo</span>&nbsp;<span class="op" id="3934957">:=</span>&nbsp;<span class="ident" id="3934960">getPublicKeyAlgorithmFromOID</span><span class="op" id="3934988">(</span><span class="ident" id="3934989">pki</span><span class="op" id="3934992">.</span><span class="ident" id="3934993">Algorithm</span><span class="op" id="3935002">.</span><span class="ident" id="3935003">Algorithm</span><span class="op" id="3935012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935015">if</span>&nbsp;<span class="ident" id="3935018">algo</span>&nbsp;<span class="op" id="3935023">==</span>&nbsp;<span class="ident" id="3935026">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="3935052">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935056">return</span>&nbsp;<span class="builtintype" id="3935063">nil</span><span class="op" id="3935066">,</span>&nbsp;<span class="ident" id="3935068">errors</span><span class="op" id="3935074">.</span><span class="ident" id="3935075">New</span><span class="op" id="3935078">(</span><span class="string" id="3935079">&#34;x509:&nbsp;unknown&nbsp;public&nbsp;key&nbsp;algorithm&#34;</span><span class="op" id="3935115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3935118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935121">return</span>&nbsp;<span class="ident" id="3935128">parsePublicKey</span><span class="op" id="3935142">(</span><span class="ident" id="3935143">algo</span><span class="op" id="3935147">,</span>&nbsp;<span class="op" id="3935149">&amp;</span><span class="ident" id="3935150">pki</span><span class="op" id="3935153">)</span><br>
<span class="lineno"></span><span class="op" id="3935155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="3935158">func</span>&nbsp;<span class="ident" id="3935163">marshalPublicKey</span><span class="op" id="3935179">(</span><span class="ident" id="3935180">pub</span>&nbsp;<span class="keyword" id="3935184">interface</span><span class="op" id="3935193">{</span><span class="op" id="3935194">}</span><span class="op" id="3935195">)</span>&nbsp;<span class="op" id="3935197">(</span><span class="ident" id="3935198">publicKeyBytes</span>&nbsp;<span class="op" id="3935213">[</span><span class="op" id="3935214">]</span><span class="builtintype" id="3935215">byte</span><span class="op" id="3935219">,</span>&nbsp;<span class="ident" id="3935221">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="3935240">pkix</span><span class="op" id="3935244">.</span><span class="ident" id="3935245">AlgorithmIdentifier</span><span class="op" id="3935264">,</span>&nbsp;<span class="ident" id="3935266">err</span>&nbsp;<span class="builtintype" id="3935270">error</span><span class="op" id="3935275">)</span>&nbsp;<span class="op" id="3935277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935280">switch</span>&nbsp;<span class="ident" id="3935287">pub</span>&nbsp;<span class="op" id="3935291">:=</span>&nbsp;<span class="ident" id="3935294">pub</span><span class="op" id="3935297">.</span><span class="op" id="3935298">(</span><span class="keyword" id="3935299">type</span><span class="op" id="3935303">)</span>&nbsp;<span class="op" id="3935305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935308">case</span>&nbsp;<span class="op" id="3935313">*</span><span class="ident" id="3935314">rsa</span><span class="op" id="3935317">.</span><span class="ident" id="3935318">PublicKey</span><span class="op" id="3935327">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935331">publicKeyBytes</span><span class="op" id="3935345">,</span>&nbsp;<span class="ident" id="3935347">err</span>&nbsp;<span class="op" id="3935351">=</span>&nbsp;<span class="ident" id="3935353">asn1</span><span class="op" id="3935357">.</span><span class="ident" id="3935358">Marshal</span><span class="op" id="3935365">(</span><span class="ident" id="3935366">rsaPublicKey</span><span class="op" id="3935378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935383">N</span><span class="op" id="3935384">:</span>&nbsp;<span class="ident" id="3935386">pub</span><span class="op" id="3935389">.</span><span class="ident" id="3935390">N</span><span class="op" id="3935391">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935396">E</span><span class="op" id="3935397">:</span>&nbsp;<span class="ident" id="3935399">pub</span><span class="op" id="3935402">.</span><span class="ident" id="3935403">E</span><span class="op" id="3935404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3935408">}</span><span class="op" id="3935409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935413">publicKeyAlgorithm</span><span class="op" id="3935431">.</span><span class="ident" id="3935432">Algorithm</span>&nbsp;<span class="op" id="3935442">=</span>&nbsp;<span class="ident" id="3935444">oidPublicKeyRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3935462">//&nbsp;This&nbsp;is&nbsp;a&nbsp;NULL&nbsp;parameters&nbsp;value&nbsp;which&nbsp;is&nbsp;technically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3935520">//&nbsp;superfluous,&nbsp;but&nbsp;most&nbsp;other&nbsp;code&nbsp;includes&nbsp;it&nbsp;and,&nbsp;by</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3935578">//&nbsp;doing&nbsp;this,&nbsp;we&nbsp;match&nbsp;their&nbsp;public&nbsp;key&nbsp;hashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935629">publicKeyAlgorithm</span><span class="op" id="3935647">.</span><span class="ident" id="3935648">Parameters</span>&nbsp;<span class="op" id="3935659">=</span>&nbsp;<span class="ident" id="3935661">asn1</span><span class="op" id="3935665">.</span><span class="ident" id="3935666">RawValue</span><span class="op" id="3935674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935679">Tag</span><span class="op" id="3935682">:</span>&nbsp;<span class="num" id="3935684">5</span><span class="op" id="3935685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3935689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935692">case</span>&nbsp;<span class="op" id="3935697">*</span><span class="ident" id="3935698">ecdsa</span><span class="op" id="3935703">.</span><span class="ident" id="3935704">PublicKey</span><span class="op" id="3935713">:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935717">publicKeyBytes</span>&nbsp;<span class="op" id="3935732">=</span>&nbsp;<span class="ident" id="3935734">elliptic</span><span class="op" id="3935742">.</span><span class="ident" id="3935743">Marshal</span><span class="op" id="3935750">(</span><span class="ident" id="3935751">pub</span><span class="op" id="3935754">.</span><span class="ident" id="3935755">Curve</span><span class="op" id="3935760">,</span>&nbsp;<span class="ident" id="3935762">pub</span><span class="op" id="3935765">.</span><span class="ident" id="3935766">X</span><span class="op" id="3935767">,</span>&nbsp;<span class="ident" id="3935769">pub</span><span class="op" id="3935772">.</span><span class="ident" id="3935773">Y</span><span class="op" id="3935774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935778">oid</span><span class="op" id="3935781">,</span>&nbsp;<span class="ident" id="3935783">ok</span>&nbsp;<span class="op" id="3935786">:=</span>&nbsp;<span class="ident" id="3935789">oidFromNamedCurve</span><span class="op" id="3935806">(</span><span class="ident" id="3935807">pub</span><span class="op" id="3935810">.</span><span class="ident" id="3935811">Curve</span><span class="op" id="3935816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935820">if</span>&nbsp;<span class="op" id="3935823">!</span><span class="ident" id="3935824">ok</span>&nbsp;<span class="op" id="3935827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935832">return</span>&nbsp;<span class="builtintype" id="3935839">nil</span><span class="op" id="3935842">,</span>&nbsp;<span class="ident" id="3935844">pkix</span><span class="op" id="3935848">.</span><span class="ident" id="3935849">AlgorithmIdentifier</span><span class="op" id="3935868">{</span><span class="op" id="3935869">}</span><span class="op" id="3935870">,</span>&nbsp;<span class="ident" id="3935872">errors</span><span class="op" id="3935878">.</span><span class="ident" id="3935879">New</span><span class="op" id="3935882">(</span><span class="string" id="3935883">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3935917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3935921">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3935925">publicKeyAlgorithm</span><span class="op" id="3935943">.</span><span class="ident" id="3935944">Algorithm</span>&nbsp;<span class="op" id="3935954">=</span>&nbsp;<span class="ident" id="3935956">oidPublicKeyECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3935976">var</span>&nbsp;<span class="ident" id="3935980">paramBytes</span>&nbsp;<span class="op" id="3935991">[</span><span class="op" id="3935992">]</span><span class="builtintype" id="3935993">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936000">paramBytes</span><span class="op" id="3936010">,</span>&nbsp;<span class="ident" id="3936012">err</span>&nbsp;<span class="op" id="3936016">=</span>&nbsp;<span class="ident" id="3936018">asn1</span><span class="op" id="3936022">.</span><span class="ident" id="3936023">Marshal</span><span class="op" id="3936030">(</span><span class="ident" id="3936031">oid</span><span class="op" id="3936034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936038">if</span>&nbsp;<span class="ident" id="3936041">err</span>&nbsp;<span class="op" id="3936045">!=</span>&nbsp;<span class="builtintype" id="3936048">nil</span>&nbsp;<span class="op" id="3936052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936057">return</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936070">publicKeyAlgorithm</span><span class="op" id="3936088">.</span><span class="ident" id="3936089">Parameters</span><span class="op" id="3936099">.</span><span class="ident" id="3936100">FullBytes</span>&nbsp;<span class="op" id="3936110">=</span>&nbsp;<span class="ident" id="3936112">paramBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936124">default</span><span class="op" id="3936131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936135">return</span>&nbsp;<span class="builtintype" id="3936142">nil</span><span class="op" id="3936145">,</span>&nbsp;<span class="ident" id="3936147">pkix</span><span class="op" id="3936151">.</span><span class="ident" id="3936152">AlgorithmIdentifier</span><span class="op" id="3936171">{</span><span class="op" id="3936172">}</span><span class="op" id="3936173">,</span>&nbsp;<span class="ident" id="3936175">errors</span><span class="op" id="3936181">.</span><span class="ident" id="3936182">New</span><span class="op" id="3936185">(</span><span class="string" id="3936186">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;public&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="3936234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936237">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936241">return</span>&nbsp;<span class="ident" id="3936248">publicKeyBytes</span><span class="op" id="3936262">,</span>&nbsp;<span class="ident" id="3936264">publicKeyAlgorithm</span><span class="op" id="3936282">,</span>&nbsp;<span class="builtintype" id="3936284">nil</span><br>
<span class="lineno"></span><span class="op" id="3936288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3936291">//&nbsp;MarshalPKIXPublicKey&nbsp;serialises&nbsp;a&nbsp;public&nbsp;key&nbsp;to&nbsp;DER-encoded&nbsp;PKIX&nbsp;format.</span><br>
<span class="lineno">85</span><span class="keyword" id="3936367">func</span>&nbsp;<span class="ident" id="3936372">MarshalPKIXPublicKey</span><span class="op" id="3936392">(</span><span class="ident" id="3936393">pub</span>&nbsp;<span class="keyword" id="3936397">interface</span><span class="op" id="3936406">{</span><span class="op" id="3936407">}</span><span class="op" id="3936408">)</span>&nbsp;<span class="op" id="3936410">(</span><span class="op" id="3936411">[</span><span class="op" id="3936412">]</span><span class="builtintype" id="3936413">byte</span><span class="op" id="3936417">,</span>&nbsp;<span class="builtintype" id="3936419">error</span><span class="op" id="3936424">)</span>&nbsp;<span class="op" id="3936426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936429">var</span>&nbsp;<span class="ident" id="3936433">publicKeyBytes</span>&nbsp;<span class="op" id="3936448">[</span><span class="op" id="3936449">]</span><span class="builtintype" id="3936450">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936456">var</span>&nbsp;<span class="ident" id="3936460">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="3936479">pkix</span><span class="op" id="3936483">.</span><span class="ident" id="3936484">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936505">var</span>&nbsp;<span class="ident" id="3936509">err</span>&nbsp;<span class="builtintype" id="3936513">error</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936521">if</span>&nbsp;<span class="ident" id="3936524">publicKeyBytes</span><span class="op" id="3936538">,</span>&nbsp;<span class="ident" id="3936540">publicKeyAlgorithm</span><span class="op" id="3936558">,</span>&nbsp;<span class="ident" id="3936560">err</span>&nbsp;<span class="op" id="3936564">=</span>&nbsp;<span class="ident" id="3936566">marshalPublicKey</span><span class="op" id="3936582">(</span><span class="ident" id="3936583">pub</span><span class="op" id="3936586">)</span><span class="op" id="3936587">;</span>&nbsp;<span class="ident" id="3936589">err</span>&nbsp;<span class="op" id="3936593">!=</span>&nbsp;<span class="builtintype" id="3936596">nil</span>&nbsp;<span class="op" id="3936600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936604">return</span>&nbsp;<span class="builtintype" id="3936611">nil</span><span class="op" id="3936614">,</span>&nbsp;<span class="ident" id="3936616">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936625">pkix</span>&nbsp;<span class="op" id="3936630">:=</span>&nbsp;<span class="ident" id="3936633">pkixPublicKey</span><span class="op" id="3936646">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936650">Algo</span><span class="op" id="3936654">:</span>&nbsp;<span class="ident" id="3936656">publicKeyAlgorithm</span><span class="op" id="3936674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936678">BitString</span><span class="op" id="3936687">:</span>&nbsp;<span class="ident" id="3936689">asn1</span><span class="op" id="3936693">.</span><span class="ident" id="3936694">BitString</span><span class="op" id="3936703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936708">Bytes</span><span class="op" id="3936713">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936719">publicKeyBytes</span><span class="op" id="3936733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936738">BitLength</span><span class="op" id="3936747">:</span>&nbsp;<span class="num" id="3936749">8</span>&nbsp;<span class="op" id="3936751">*</span>&nbsp;<span class="builtinfunc" id="3936753">len</span><span class="op" id="3936756">(</span><span class="ident" id="3936757">publicKeyBytes</span><span class="op" id="3936771">)</span><span class="op" id="3936772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936776">}</span><span class="op" id="3936777">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3936780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936784">ret</span><span class="op" id="3936787">,</span>&nbsp;<span class="ident" id="3936789">_</span>&nbsp;<span class="op" id="3936791">:=</span>&nbsp;<span class="ident" id="3936794">asn1</span><span class="op" id="3936798">.</span><span class="ident" id="3936799">Marshal</span><span class="op" id="3936806">(</span><span class="ident" id="3936807">pkix</span><span class="op" id="3936811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3936814">return</span>&nbsp;<span class="ident" id="3936821">ret</span><span class="op" id="3936824">,</span>&nbsp;<span class="builtintype" id="3936826">nil</span><br>
<span class="lineno"></span><span class="op" id="3936830">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3936833">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificates.:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3936906">type</span>&nbsp;<span class="ident" id="3936911">certificate</span>&nbsp;<span class="keyword" id="3936923">struct</span>&nbsp;<span class="op" id="3936930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936933">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936952">asn1</span><span class="op" id="3936956">.</span><span class="ident" id="3936957">RawContent</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936969">TBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3936988">tbsCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937004">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3937023">pkix</span><span class="op" id="3937027">.</span><span class="ident" id="3937028">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937049">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937068">asn1</span><span class="op" id="3937072">.</span><span class="ident" id="3937073">BitString</span><br>
<span class="lineno"></span><span class="op" id="3937083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="3937086">type</span>&nbsp;<span class="ident" id="3937091">tbsCertificate</span>&nbsp;<span class="keyword" id="3937106">struct</span>&nbsp;<span class="op" id="3937113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937116">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937135">asn1</span><span class="op" id="3937139">.</span><span class="ident" id="3937140">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937152">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3937171">int</span>&nbsp;<span class="string" id="3937175">`asn1:&#34;optional,explicit,default:1,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937219">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3937238">*</span><span class="ident" id="3937239">big</span><span class="op" id="3937242">.</span><span class="ident" id="3937243">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937248">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3937267">pkix</span><span class="op" id="3937271">.</span><span class="ident" id="3937272">AlgorithmIdentifier</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937293">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937312">asn1</span><span class="op" id="3937316">.</span><span class="ident" id="3937317">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937327">Validity</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937346">validity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937356">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937375">asn1</span><span class="op" id="3937379">.</span><span class="ident" id="3937380">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937390">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937409">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937424">UniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937443">asn1</span><span class="op" id="3937447">.</span><span class="ident" id="3937448">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3937460">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937485">SubjectUniqueId</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937504">asn1</span><span class="op" id="3937508">.</span><span class="ident" id="3937509">BitString</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3937521">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937546">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3937565">[</span><span class="op" id="3937566">]</span><span class="ident" id="3937567">pkix</span><span class="op" id="3937571">.</span><span class="ident" id="3937572">Extension</span>&nbsp;<span class="string" id="3937582">`asn1:&#34;optional,explicit,tag:3&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3937615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3937618">type</span>&nbsp;<span class="ident" id="3937623">dsaAlgorithmParameters</span>&nbsp;<span class="keyword" id="3937646">struct</span>&nbsp;<span class="op" id="3937653">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937656">P</span><span class="op" id="3937657">,</span>&nbsp;<span class="ident" id="3937659">Q</span><span class="op" id="3937660">,</span>&nbsp;<span class="ident" id="3937662">G</span>&nbsp;<span class="op" id="3937664">*</span><span class="ident" id="3937665">big</span><span class="op" id="3937668">.</span><span class="ident" id="3937669">Int</span><br>
<span class="lineno"></span><span class="op" id="3937673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3937676">type</span>&nbsp;<span class="ident" id="3937681">dsaSignature</span>&nbsp;<span class="keyword" id="3937694">struct</span>&nbsp;<span class="op" id="3937701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937704">R</span><span class="op" id="3937705">,</span>&nbsp;<span class="ident" id="3937707">S</span>&nbsp;<span class="op" id="3937709">*</span><span class="ident" id="3937710">big</span><span class="op" id="3937713">.</span><span class="ident" id="3937714">Int</span><br>
<span class="lineno">135</span><span class="op" id="3937718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3937721">type</span>&nbsp;<span class="ident" id="3937726">ecdsaSignature</span>&nbsp;<span class="ident" id="3937741">dsaSignature</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3937755">type</span>&nbsp;<span class="ident" id="3937760">validity</span>&nbsp;<span class="keyword" id="3937769">struct</span>&nbsp;<span class="op" id="3937776">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937779">NotBefore</span><span class="op" id="3937788">,</span>&nbsp;<span class="ident" id="3937790">NotAfter</span>&nbsp;<span class="ident" id="3937799">time</span><span class="op" id="3937803">.</span><span class="ident" id="3937804">Time</span><br>
<span class="lineno"></span><span class="op" id="3937809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3937812">type</span>&nbsp;<span class="ident" id="3937817">publicKeyInfo</span>&nbsp;<span class="keyword" id="3937831">struct</span>&nbsp;<span class="op" id="3937838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937841">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937851">asn1</span><span class="op" id="3937855">.</span><span class="ident" id="3937856">RawContent</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937868">Algorithm</span>&nbsp;<span class="ident" id="3937878">pkix</span><span class="op" id="3937882">.</span><span class="ident" id="3937883">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937904">PublicKey</span>&nbsp;<span class="ident" id="3937914">asn1</span><span class="op" id="3937918">.</span><span class="ident" id="3937919">BitString</span><br>
<span class="lineno"></span><span class="op" id="3937929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3937932">//&nbsp;RFC&nbsp;5280,&nbsp;&nbsp;4.2.1.1</span><br>
<span class="lineno">150</span><span class="keyword" id="3937954">type</span>&nbsp;<span class="ident" id="3937959">authKeyId</span>&nbsp;<span class="keyword" id="3937969">struct</span>&nbsp;<span class="op" id="3937976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3937979">Id</span>&nbsp;<span class="op" id="3937982">[</span><span class="op" id="3937983">]</span><span class="builtintype" id="3937984">byte</span>&nbsp;<span class="string" id="3937989">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3938013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3938016">type</span>&nbsp;<span class="ident" id="3938021">SignatureAlgorithm</span>&nbsp;<span class="builtintype" id="3938040">int</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="3938045">const</span>&nbsp;<span class="op" id="3938051">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938054">UnknownSignatureAlgorithm</span>&nbsp;<span class="ident" id="3938080">SignatureAlgorithm</span>&nbsp;<span class="op" id="3938099">=</span>&nbsp;<span class="ident" id="3938101">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938107">MD2WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938119">MD5WithRSA</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938131">SHA1WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938144">SHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938159">SHA384WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938174">SHA512WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938189">DSAWithSHA1</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938202">DSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938217">ECDSAWithSHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938232">ECDSAWithSHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938249">ECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938266">ECDSAWithSHA512</span><br>
<span class="lineno">170</span><span class="op" id="3938282">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3938285">type</span>&nbsp;<span class="ident" id="3938290">PublicKeyAlgorithm</span>&nbsp;<span class="builtintype" id="3938309">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3938314">const</span>&nbsp;<span class="op" id="3938320">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938323">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="ident" id="3938349">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3938368">=</span>&nbsp;<span class="ident" id="3938370">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938376">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938381">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3938386">ECDSA</span><br>
<span class="lineno"></span><span class="op" id="3938392">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="3938395">//&nbsp;OIDs&nbsp;for&nbsp;signature&nbsp;algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3938428">//</span><br>
<span class="lineno"></span><span class="comment" id="3938431">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3938465">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno">185</span><span class="comment" id="3938528">//</span><br>
<span class="lineno"></span><span class="comment" id="3938531">//</span><br>
<span class="lineno"></span><span class="comment" id="3938534">//&nbsp;RFC&nbsp;3279&nbsp;2.2.1&nbsp;RSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3938577">//</span><br>
<span class="lineno"></span><span class="comment" id="3938580">//&nbsp;md2WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;2&nbsp;}</span><br>
<span class="lineno">190</span><span class="comment" id="3938639">//</span><br>
<span class="lineno"></span><span class="comment" id="3938642">//&nbsp;md5WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;4&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3938701">//</span><br>
<span class="lineno"></span><span class="comment" id="3938704">//&nbsp;sha-1WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;5&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3938765">//</span><br>
<span class="lineno">195</span><span class="comment" id="3938768">//&nbsp;dsaWithSha1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3938807">//&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3938868">//</span><br>
<span class="lineno"></span><span class="comment" id="3938871">//&nbsp;RFC&nbsp;3279&nbsp;2.2.3&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="3938915">//</span><br>
<span class="lineno">200</span><span class="comment" id="3938918">//&nbsp;ecdsa-with-SHA1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3938961">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-x962(10045)</span><br>
<span class="lineno"></span><span class="comment" id="3939014">//&nbsp;&nbsp;&nbsp;&nbsp;signatures(4)&nbsp;ecdsa-with-SHA1(1)}</span><br>
<span class="lineno"></span><span class="comment" id="3939054">//</span><br>
<span class="lineno"></span><span class="comment" id="3939057">//</span><br>
<span class="lineno">205</span><span class="comment" id="3939060">//&nbsp;RFC&nbsp;4055&nbsp;5&nbsp;PKCS&nbsp;#1&nbsp;Version&nbsp;1.5</span><br>
<span class="lineno"></span><span class="comment" id="3939094">//</span><br>
<span class="lineno"></span><span class="comment" id="3939097">//&nbsp;sha256WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;11&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3939160">//</span><br>
<span class="lineno"></span><span class="comment" id="3939163">//&nbsp;sha384WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;12&nbsp;}</span><br>
<span class="lineno">210</span><span class="comment" id="3939226">//</span><br>
<span class="lineno"></span><span class="comment" id="3939229">//&nbsp;sha512WithRSAEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;pkcs-1&nbsp;13&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3939292">//</span><br>
<span class="lineno"></span><span class="comment" id="3939295">//</span><br>
<span class="lineno"></span><span class="comment" id="3939298">//&nbsp;RFC&nbsp;5758&nbsp;3.1&nbsp;DSA&nbsp;Signature&nbsp;Algorithms</span><br>
<span class="lineno">215</span><span class="comment" id="3939339">//</span><br>
<span class="lineno"></span><span class="comment" id="3939342">//&nbsp;dsaWithSha256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3939383">//&nbsp;&nbsp;&nbsp;&nbsp;joint-iso-ccitt(2)&nbsp;country(16)&nbsp;us(840)&nbsp;organization(1)&nbsp;gov(101)</span><br>
<span class="lineno"></span><span class="comment" id="3939453">//&nbsp;&nbsp;&nbsp;&nbsp;csor(3)&nbsp;algorithms(4)&nbsp;id-dsa-with-sha2(3)&nbsp;2}</span><br>
<span class="lineno"></span><span class="comment" id="3939504">//</span><br>
<span class="lineno">220</span><span class="comment" id="3939507">//&nbsp;RFC&nbsp;5758&nbsp;3.2&nbsp;ECDSA&nbsp;Signature&nbsp;Algorithm</span><br>
<span class="lineno"></span><span class="comment" id="3939549">//</span><br>
<span class="lineno"></span><span class="comment" id="3939552">//&nbsp;ecdsa-with-SHA256&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="3939619">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3939688">//</span><br>
<span class="lineno">225</span><span class="comment" id="3939691">//&nbsp;ecdsa-with-SHA384&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="3939758">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3939827">//</span><br>
<span class="lineno"></span><span class="comment" id="3939830">//&nbsp;ecdsa-with-SHA512&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)</span><br>
<span class="lineno"></span><span class="comment" id="3939897">//&nbsp;&nbsp;&nbsp;&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;signatures(4)&nbsp;ecdsa-with-SHA2(3)&nbsp;4&nbsp;}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3939967">var</span>&nbsp;<span class="op" id="3939971">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3939974">oidSignatureMD2WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3940002">=</span>&nbsp;<span class="ident" id="3940004">asn1</span><span class="op" id="3940008">.</span><span class="ident" id="3940009">ObjectIdentifier</span><span class="op" id="3940025">{</span><span class="num" id="3940026">1</span><span class="op" id="3940027">,</span>&nbsp;<span class="num" id="3940029">2</span><span class="op" id="3940030">,</span>&nbsp;<span class="num" id="3940032">840</span><span class="op" id="3940035">,</span>&nbsp;<span class="num" id="3940037">113549</span><span class="op" id="3940043">,</span>&nbsp;<span class="num" id="3940045">1</span><span class="op" id="3940046">,</span>&nbsp;<span class="num" id="3940048">1</span><span class="op" id="3940049">,</span>&nbsp;<span class="num" id="3940051">2</span><span class="op" id="3940052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940055">oidSignatureMD5WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3940083">=</span>&nbsp;<span class="ident" id="3940085">asn1</span><span class="op" id="3940089">.</span><span class="ident" id="3940090">ObjectIdentifier</span><span class="op" id="3940106">{</span><span class="num" id="3940107">1</span><span class="op" id="3940108">,</span>&nbsp;<span class="num" id="3940110">2</span><span class="op" id="3940111">,</span>&nbsp;<span class="num" id="3940113">840</span><span class="op" id="3940116">,</span>&nbsp;<span class="num" id="3940118">113549</span><span class="op" id="3940124">,</span>&nbsp;<span class="num" id="3940126">1</span><span class="op" id="3940127">,</span>&nbsp;<span class="num" id="3940129">1</span><span class="op" id="3940130">,</span>&nbsp;<span class="num" id="3940132">4</span><span class="op" id="3940133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940136">oidSignatureSHA1WithRSA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3940164">=</span>&nbsp;<span class="ident" id="3940166">asn1</span><span class="op" id="3940170">.</span><span class="ident" id="3940171">ObjectIdentifier</span><span class="op" id="3940187">{</span><span class="num" id="3940188">1</span><span class="op" id="3940189">,</span>&nbsp;<span class="num" id="3940191">2</span><span class="op" id="3940192">,</span>&nbsp;<span class="num" id="3940194">840</span><span class="op" id="3940197">,</span>&nbsp;<span class="num" id="3940199">113549</span><span class="op" id="3940205">,</span>&nbsp;<span class="num" id="3940207">1</span><span class="op" id="3940208">,</span>&nbsp;<span class="num" id="3940210">1</span><span class="op" id="3940211">,</span>&nbsp;<span class="num" id="3940213">5</span><span class="op" id="3940214">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940217">oidSignatureSHA256WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3940245">=</span>&nbsp;<span class="ident" id="3940247">asn1</span><span class="op" id="3940251">.</span><span class="ident" id="3940252">ObjectIdentifier</span><span class="op" id="3940268">{</span><span class="num" id="3940269">1</span><span class="op" id="3940270">,</span>&nbsp;<span class="num" id="3940272">2</span><span class="op" id="3940273">,</span>&nbsp;<span class="num" id="3940275">840</span><span class="op" id="3940278">,</span>&nbsp;<span class="num" id="3940280">113549</span><span class="op" id="3940286">,</span>&nbsp;<span class="num" id="3940288">1</span><span class="op" id="3940289">,</span>&nbsp;<span class="num" id="3940291">1</span><span class="op" id="3940292">,</span>&nbsp;<span class="num" id="3940294">11</span><span class="op" id="3940296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940299">oidSignatureSHA384WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3940327">=</span>&nbsp;<span class="ident" id="3940329">asn1</span><span class="op" id="3940333">.</span><span class="ident" id="3940334">ObjectIdentifier</span><span class="op" id="3940350">{</span><span class="num" id="3940351">1</span><span class="op" id="3940352">,</span>&nbsp;<span class="num" id="3940354">2</span><span class="op" id="3940355">,</span>&nbsp;<span class="num" id="3940357">840</span><span class="op" id="3940360">,</span>&nbsp;<span class="num" id="3940362">113549</span><span class="op" id="3940368">,</span>&nbsp;<span class="num" id="3940370">1</span><span class="op" id="3940371">,</span>&nbsp;<span class="num" id="3940373">1</span><span class="op" id="3940374">,</span>&nbsp;<span class="num" id="3940376">12</span><span class="op" id="3940378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940381">oidSignatureSHA512WithRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3940409">=</span>&nbsp;<span class="ident" id="3940411">asn1</span><span class="op" id="3940415">.</span><span class="ident" id="3940416">ObjectIdentifier</span><span class="op" id="3940432">{</span><span class="num" id="3940433">1</span><span class="op" id="3940434">,</span>&nbsp;<span class="num" id="3940436">2</span><span class="op" id="3940437">,</span>&nbsp;<span class="num" id="3940439">840</span><span class="op" id="3940442">,</span>&nbsp;<span class="num" id="3940444">113549</span><span class="op" id="3940450">,</span>&nbsp;<span class="num" id="3940452">1</span><span class="op" id="3940453">,</span>&nbsp;<span class="num" id="3940455">1</span><span class="op" id="3940456">,</span>&nbsp;<span class="num" id="3940458">13</span><span class="op" id="3940460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940463">oidSignatureDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3940491">=</span>&nbsp;<span class="ident" id="3940493">asn1</span><span class="op" id="3940497">.</span><span class="ident" id="3940498">ObjectIdentifier</span><span class="op" id="3940514">{</span><span class="num" id="3940515">1</span><span class="op" id="3940516">,</span>&nbsp;<span class="num" id="3940518">2</span><span class="op" id="3940519">,</span>&nbsp;<span class="num" id="3940521">840</span><span class="op" id="3940524">,</span>&nbsp;<span class="num" id="3940526">10040</span><span class="op" id="3940531">,</span>&nbsp;<span class="num" id="3940533">4</span><span class="op" id="3940534">,</span>&nbsp;<span class="num" id="3940536">3</span><span class="op" id="3940537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940540">oidSignatureDSAWithSHA256</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3940568">=</span>&nbsp;<span class="ident" id="3940570">asn1</span><span class="op" id="3940574">.</span><span class="ident" id="3940575">ObjectIdentifier</span><span class="op" id="3940591">{</span><span class="num" id="3940592">2</span><span class="op" id="3940593">,</span>&nbsp;<span class="num" id="3940595">16</span><span class="op" id="3940597">,</span>&nbsp;<span class="num" id="3940599">840</span><span class="op" id="3940602">,</span>&nbsp;<span class="num" id="3940604">1</span><span class="op" id="3940605">,</span>&nbsp;<span class="num" id="3940607">101</span><span class="op" id="3940610">,</span>&nbsp;<span class="num" id="3940612">4</span><span class="op" id="3940613">,</span>&nbsp;<span class="num" id="3940615">3</span><span class="op" id="3940616">,</span>&nbsp;<span class="num" id="3940618">2</span><span class="op" id="3940619">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940622">oidSignatureECDSAWithSHA1</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3940650">=</span>&nbsp;<span class="ident" id="3940652">asn1</span><span class="op" id="3940656">.</span><span class="ident" id="3940657">ObjectIdentifier</span><span class="op" id="3940673">{</span><span class="num" id="3940674">1</span><span class="op" id="3940675">,</span>&nbsp;<span class="num" id="3940677">2</span><span class="op" id="3940678">,</span>&nbsp;<span class="num" id="3940680">840</span><span class="op" id="3940683">,</span>&nbsp;<span class="num" id="3940685">10045</span><span class="op" id="3940690">,</span>&nbsp;<span class="num" id="3940692">4</span><span class="op" id="3940693">,</span>&nbsp;<span class="num" id="3940695">1</span><span class="op" id="3940696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940699">oidSignatureECDSAWithSHA256</span>&nbsp;<span class="op" id="3940727">=</span>&nbsp;<span class="ident" id="3940729">asn1</span><span class="op" id="3940733">.</span><span class="ident" id="3940734">ObjectIdentifier</span><span class="op" id="3940750">{</span><span class="num" id="3940751">1</span><span class="op" id="3940752">,</span>&nbsp;<span class="num" id="3940754">2</span><span class="op" id="3940755">,</span>&nbsp;<span class="num" id="3940757">840</span><span class="op" id="3940760">,</span>&nbsp;<span class="num" id="3940762">10045</span><span class="op" id="3940767">,</span>&nbsp;<span class="num" id="3940769">4</span><span class="op" id="3940770">,</span>&nbsp;<span class="num" id="3940772">3</span><span class="op" id="3940773">,</span>&nbsp;<span class="num" id="3940775">2</span><span class="op" id="3940776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940779">oidSignatureECDSAWithSHA384</span>&nbsp;<span class="op" id="3940807">=</span>&nbsp;<span class="ident" id="3940809">asn1</span><span class="op" id="3940813">.</span><span class="ident" id="3940814">ObjectIdentifier</span><span class="op" id="3940830">{</span><span class="num" id="3940831">1</span><span class="op" id="3940832">,</span>&nbsp;<span class="num" id="3940834">2</span><span class="op" id="3940835">,</span>&nbsp;<span class="num" id="3940837">840</span><span class="op" id="3940840">,</span>&nbsp;<span class="num" id="3940842">10045</span><span class="op" id="3940847">,</span>&nbsp;<span class="num" id="3940849">4</span><span class="op" id="3940850">,</span>&nbsp;<span class="num" id="3940852">3</span><span class="op" id="3940853">,</span>&nbsp;<span class="num" id="3940855">3</span><span class="op" id="3940856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940859">oidSignatureECDSAWithSHA512</span>&nbsp;<span class="op" id="3940887">=</span>&nbsp;<span class="ident" id="3940889">asn1</span><span class="op" id="3940893">.</span><span class="ident" id="3940894">ObjectIdentifier</span><span class="op" id="3940910">{</span><span class="num" id="3940911">1</span><span class="op" id="3940912">,</span>&nbsp;<span class="num" id="3940914">2</span><span class="op" id="3940915">,</span>&nbsp;<span class="num" id="3940917">840</span><span class="op" id="3940920">,</span>&nbsp;<span class="num" id="3940922">10045</span><span class="op" id="3940927">,</span>&nbsp;<span class="num" id="3940929">4</span><span class="op" id="3940930">,</span>&nbsp;<span class="num" id="3940932">3</span><span class="op" id="3940933">,</span>&nbsp;<span class="num" id="3940935">4</span><span class="op" id="3940936">}</span><br>
<span class="lineno"></span><span class="op" id="3940938">)</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="3940941">var</span>&nbsp;<span class="ident" id="3940945">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="3940971">=</span>&nbsp;<span class="op" id="3940973">[</span><span class="op" id="3940974">]</span><span class="keyword" id="3940975">struct</span>&nbsp;<span class="op" id="3940982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940985">algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3940996">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941016">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941027">asn1</span><span class="op" id="3941031">.</span><span class="ident" id="3941032">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941050">pubKeyAlgo</span>&nbsp;<span class="ident" id="3941061">PublicKeyAlgorithm</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941081">hash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3941092">crypto</span><span class="op" id="3941098">.</span><span class="ident" id="3941099">Hash</span><br>
<span class="lineno"></span><span class="op" id="3941104">}</span><span class="op" id="3941105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941108">{</span><span class="ident" id="3941109">MD2WithRSA</span><span class="op" id="3941119">,</span>&nbsp;<span class="ident" id="3941121">oidSignatureMD2WithRSA</span><span class="op" id="3941143">,</span>&nbsp;<span class="ident" id="3941145">RSA</span><span class="op" id="3941148">,</span>&nbsp;<span class="ident" id="3941150">crypto</span><span class="op" id="3941156">.</span><span class="ident" id="3941157">Hash</span><span class="op" id="3941161">(</span><span class="num" id="3941162">0</span><span class="op" id="3941163">)</span>&nbsp;<span class="comment" id="3941165">/*&nbsp;no&nbsp;value&nbsp;for&nbsp;MD2&nbsp;*/</span><span class="op" id="3941187">}</span><span class="op" id="3941188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941191">{</span><span class="ident" id="3941192">MD5WithRSA</span><span class="op" id="3941202">,</span>&nbsp;<span class="ident" id="3941204">oidSignatureMD5WithRSA</span><span class="op" id="3941226">,</span>&nbsp;<span class="ident" id="3941228">RSA</span><span class="op" id="3941231">,</span>&nbsp;<span class="ident" id="3941233">crypto</span><span class="op" id="3941239">.</span><span class="ident" id="3941240">MD5</span><span class="op" id="3941243">}</span><span class="op" id="3941244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941247">{</span><span class="ident" id="3941248">SHA1WithRSA</span><span class="op" id="3941259">,</span>&nbsp;<span class="ident" id="3941261">oidSignatureSHA1WithRSA</span><span class="op" id="3941284">,</span>&nbsp;<span class="ident" id="3941286">RSA</span><span class="op" id="3941289">,</span>&nbsp;<span class="ident" id="3941291">crypto</span><span class="op" id="3941297">.</span><span class="ident" id="3941298">SHA1</span><span class="op" id="3941302">}</span><span class="op" id="3941303">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941306">{</span><span class="ident" id="3941307">SHA256WithRSA</span><span class="op" id="3941320">,</span>&nbsp;<span class="ident" id="3941322">oidSignatureSHA256WithRSA</span><span class="op" id="3941347">,</span>&nbsp;<span class="ident" id="3941349">RSA</span><span class="op" id="3941352">,</span>&nbsp;<span class="ident" id="3941354">crypto</span><span class="op" id="3941360">.</span><span class="ident" id="3941361">SHA256</span><span class="op" id="3941367">}</span><span class="op" id="3941368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941371">{</span><span class="ident" id="3941372">SHA384WithRSA</span><span class="op" id="3941385">,</span>&nbsp;<span class="ident" id="3941387">oidSignatureSHA384WithRSA</span><span class="op" id="3941412">,</span>&nbsp;<span class="ident" id="3941414">RSA</span><span class="op" id="3941417">,</span>&nbsp;<span class="ident" id="3941419">crypto</span><span class="op" id="3941425">.</span><span class="ident" id="3941426">SHA384</span><span class="op" id="3941432">}</span><span class="op" id="3941433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941436">{</span><span class="ident" id="3941437">SHA512WithRSA</span><span class="op" id="3941450">,</span>&nbsp;<span class="ident" id="3941452">oidSignatureSHA512WithRSA</span><span class="op" id="3941477">,</span>&nbsp;<span class="ident" id="3941479">RSA</span><span class="op" id="3941482">,</span>&nbsp;<span class="ident" id="3941484">crypto</span><span class="op" id="3941490">.</span><span class="ident" id="3941491">SHA512</span><span class="op" id="3941497">}</span><span class="op" id="3941498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941501">{</span><span class="ident" id="3941502">DSAWithSHA1</span><span class="op" id="3941513">,</span>&nbsp;<span class="ident" id="3941515">oidSignatureDSAWithSHA1</span><span class="op" id="3941538">,</span>&nbsp;<span class="ident" id="3941540">DSA</span><span class="op" id="3941543">,</span>&nbsp;<span class="ident" id="3941545">crypto</span><span class="op" id="3941551">.</span><span class="ident" id="3941552">SHA1</span><span class="op" id="3941556">}</span><span class="op" id="3941557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941560">{</span><span class="ident" id="3941561">DSAWithSHA256</span><span class="op" id="3941574">,</span>&nbsp;<span class="ident" id="3941576">oidSignatureDSAWithSHA256</span><span class="op" id="3941601">,</span>&nbsp;<span class="ident" id="3941603">DSA</span><span class="op" id="3941606">,</span>&nbsp;<span class="ident" id="3941608">crypto</span><span class="op" id="3941614">.</span><span class="ident" id="3941615">SHA256</span><span class="op" id="3941621">}</span><span class="op" id="3941622">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941625">{</span><span class="ident" id="3941626">ECDSAWithSHA1</span><span class="op" id="3941639">,</span>&nbsp;<span class="ident" id="3941641">oidSignatureECDSAWithSHA1</span><span class="op" id="3941666">,</span>&nbsp;<span class="ident" id="3941668">ECDSA</span><span class="op" id="3941673">,</span>&nbsp;<span class="ident" id="3941675">crypto</span><span class="op" id="3941681">.</span><span class="ident" id="3941682">SHA1</span><span class="op" id="3941686">}</span><span class="op" id="3941687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941690">{</span><span class="ident" id="3941691">ECDSAWithSHA256</span><span class="op" id="3941706">,</span>&nbsp;<span class="ident" id="3941708">oidSignatureECDSAWithSHA256</span><span class="op" id="3941735">,</span>&nbsp;<span class="ident" id="3941737">ECDSA</span><span class="op" id="3941742">,</span>&nbsp;<span class="ident" id="3941744">crypto</span><span class="op" id="3941750">.</span><span class="ident" id="3941751">SHA256</span><span class="op" id="3941757">}</span><span class="op" id="3941758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941761">{</span><span class="ident" id="3941762">ECDSAWithSHA384</span><span class="op" id="3941777">,</span>&nbsp;<span class="ident" id="3941779">oidSignatureECDSAWithSHA384</span><span class="op" id="3941806">,</span>&nbsp;<span class="ident" id="3941808">ECDSA</span><span class="op" id="3941813">,</span>&nbsp;<span class="ident" id="3941815">crypto</span><span class="op" id="3941821">.</span><span class="ident" id="3941822">SHA384</span><span class="op" id="3941828">}</span><span class="op" id="3941829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3941832">{</span><span class="ident" id="3941833">ECDSAWithSHA512</span><span class="op" id="3941848">,</span>&nbsp;<span class="ident" id="3941850">oidSignatureECDSAWithSHA512</span><span class="op" id="3941877">,</span>&nbsp;<span class="ident" id="3941879">ECDSA</span><span class="op" id="3941884">,</span>&nbsp;<span class="ident" id="3941886">crypto</span><span class="op" id="3941892">.</span><span class="ident" id="3941893">SHA512</span><span class="op" id="3941899">}</span><span class="op" id="3941900">,</span><br>
<span class="lineno"></span><span class="op" id="3941902">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="3941905">func</span>&nbsp;<span class="ident" id="3941910">getSignatureAlgorithmFromOID</span><span class="op" id="3941938">(</span><span class="ident" id="3941939">oid</span>&nbsp;<span class="ident" id="3941943">asn1</span><span class="op" id="3941947">.</span><span class="ident" id="3941948">ObjectIdentifier</span><span class="op" id="3941964">)</span>&nbsp;<span class="ident" id="3941966">SignatureAlgorithm</span>&nbsp;<span class="op" id="3941985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3941988">for</span>&nbsp;<span class="ident" id="3941992">_</span><span class="op" id="3941993">,</span>&nbsp;<span class="ident" id="3941995">details</span>&nbsp;<span class="op" id="3942003">:=</span>&nbsp;<span class="keyword" id="3942006">range</span>&nbsp;<span class="ident" id="3942012">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="3942038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942042">if</span>&nbsp;<span class="ident" id="3942045">oid</span><span class="op" id="3942048">.</span><span class="ident" id="3942049">Equal</span><span class="op" id="3942054">(</span><span class="ident" id="3942055">details</span><span class="op" id="3942062">.</span><span class="ident" id="3942063">oid</span><span class="op" id="3942066">)</span>&nbsp;<span class="op" id="3942068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942073">return</span>&nbsp;<span class="ident" id="3942080">details</span><span class="op" id="3942087">.</span><span class="ident" id="3942088">algo</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3942098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942101">return</span>&nbsp;<span class="ident" id="3942108">UnknownSignatureAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="3942134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="3942137">//&nbsp;RFC&nbsp;3279,&nbsp;2.3&nbsp;Public&nbsp;Key&nbsp;Algorithms</span><br>
<span class="lineno"></span><span class="comment" id="3942176">//</span><br>
<span class="lineno"></span><span class="comment" id="3942179">//&nbsp;pkcs-1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="3942244">//&nbsp;&nbsp;&nbsp;&nbsp;rsadsi(113549)&nbsp;pkcs(1)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3942277">//</span><br>
<span class="lineno">280</span><span class="comment" id="3942280">//&nbsp;rsaEncryption&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;pkcs1-1&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3942334">//</span><br>
<span class="lineno"></span><span class="comment" id="3942337">//&nbsp;id-dsa&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::==&nbsp;{&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)</span><br>
<span class="lineno"></span><span class="comment" id="3942402">//&nbsp;&nbsp;&nbsp;&nbsp;x9-57(10040)&nbsp;x9cm(4)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3942433">//</span><br>
<span class="lineno">285</span><span class="comment" id="3942436">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1&nbsp;Unrestricted&nbsp;Algorithm&nbsp;Identifier&nbsp;and&nbsp;Parameters</span><br>
<span class="lineno"></span><span class="comment" id="3942504">//</span><br>
<span class="lineno"></span><span class="comment" id="3942507">//&nbsp;id-ecPublicKey&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3942549">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;keyType(2)&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="3942621">var</span>&nbsp;<span class="op" id="3942625">(</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942628">oidPublicKeyRSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3942646">=</span>&nbsp;<span class="ident" id="3942648">asn1</span><span class="op" id="3942652">.</span><span class="ident" id="3942653">ObjectIdentifier</span><span class="op" id="3942669">{</span><span class="num" id="3942670">1</span><span class="op" id="3942671">,</span>&nbsp;<span class="num" id="3942673">2</span><span class="op" id="3942674">,</span>&nbsp;<span class="num" id="3942676">840</span><span class="op" id="3942679">,</span>&nbsp;<span class="num" id="3942681">113549</span><span class="op" id="3942687">,</span>&nbsp;<span class="num" id="3942689">1</span><span class="op" id="3942690">,</span>&nbsp;<span class="num" id="3942692">1</span><span class="op" id="3942693">,</span>&nbsp;<span class="num" id="3942695">1</span><span class="op" id="3942696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942699">oidPublicKeyDSA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3942717">=</span>&nbsp;<span class="ident" id="3942719">asn1</span><span class="op" id="3942723">.</span><span class="ident" id="3942724">ObjectIdentifier</span><span class="op" id="3942740">{</span><span class="num" id="3942741">1</span><span class="op" id="3942742">,</span>&nbsp;<span class="num" id="3942744">2</span><span class="op" id="3942745">,</span>&nbsp;<span class="num" id="3942747">840</span><span class="op" id="3942750">,</span>&nbsp;<span class="num" id="3942752">10040</span><span class="op" id="3942757">,</span>&nbsp;<span class="num" id="3942759">4</span><span class="op" id="3942760">,</span>&nbsp;<span class="num" id="3942762">1</span><span class="op" id="3942763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3942766">oidPublicKeyECDSA</span>&nbsp;<span class="op" id="3942784">=</span>&nbsp;<span class="ident" id="3942786">asn1</span><span class="op" id="3942790">.</span><span class="ident" id="3942791">ObjectIdentifier</span><span class="op" id="3942807">{</span><span class="num" id="3942808">1</span><span class="op" id="3942809">,</span>&nbsp;<span class="num" id="3942811">2</span><span class="op" id="3942812">,</span>&nbsp;<span class="num" id="3942814">840</span><span class="op" id="3942817">,</span>&nbsp;<span class="num" id="3942819">10045</span><span class="op" id="3942824">,</span>&nbsp;<span class="num" id="3942826">2</span><span class="op" id="3942827">,</span>&nbsp;<span class="num" id="3942829">1</span><span class="op" id="3942830">}</span><br>
<span class="lineno"></span><span class="op" id="3942832">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="keyword" id="3942835">func</span>&nbsp;<span class="ident" id="3942840">getPublicKeyAlgorithmFromOID</span><span class="op" id="3942868">(</span><span class="ident" id="3942869">oid</span>&nbsp;<span class="ident" id="3942873">asn1</span><span class="op" id="3942877">.</span><span class="ident" id="3942878">ObjectIdentifier</span><span class="op" id="3942894">)</span>&nbsp;<span class="ident" id="3942896">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3942915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942918">switch</span>&nbsp;<span class="op" id="3942925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942928">case</span>&nbsp;<span class="ident" id="3942933">oid</span><span class="op" id="3942936">.</span><span class="ident" id="3942937">Equal</span><span class="op" id="3942942">(</span><span class="ident" id="3942943">oidPublicKeyRSA</span><span class="op" id="3942958">)</span><span class="op" id="3942959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942963">return</span>&nbsp;<span class="ident" id="3942970">RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3942975">case</span>&nbsp;<span class="ident" id="3942980">oid</span><span class="op" id="3942983">.</span><span class="ident" id="3942984">Equal</span><span class="op" id="3942989">(</span><span class="ident" id="3942990">oidPublicKeyDSA</span><span class="op" id="3943005">)</span><span class="op" id="3943006">:</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943010">return</span>&nbsp;<span class="ident" id="3943017">DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943022">case</span>&nbsp;<span class="ident" id="3943027">oid</span><span class="op" id="3943030">.</span><span class="ident" id="3943031">Equal</span><span class="op" id="3943036">(</span><span class="ident" id="3943037">oidPublicKeyECDSA</span><span class="op" id="3943054">)</span><span class="op" id="3943055">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943059">return</span>&nbsp;<span class="ident" id="3943066">ECDSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3943073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943076">return</span>&nbsp;<span class="ident" id="3943083">UnknownPublicKeyAlgorithm</span><br>
<span class="lineno">305</span><span class="op" id="3943109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3943112">//&nbsp;RFC&nbsp;5480,&nbsp;2.1.1.1.&nbsp;Named&nbsp;Curve</span><br>
<span class="lineno"></span><span class="comment" id="3943146">//</span><br>
<span class="lineno"></span><span class="comment" id="3943149">//&nbsp;secp224r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">310</span><span class="comment" id="3943186">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;33&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3943253">//</span><br>
<span class="lineno"></span><span class="comment" id="3943256">//&nbsp;secp256r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3943293">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;member-body(2)&nbsp;us(840)&nbsp;ansi-X9-62(10045)&nbsp;curves(3)</span><br>
<span class="lineno"></span><span class="comment" id="3943356">//&nbsp;&nbsp;&nbsp;prime(1)&nbsp;7&nbsp;}</span><br>
<span class="lineno">315</span><span class="comment" id="3943374">//</span><br>
<span class="lineno"></span><span class="comment" id="3943377">//&nbsp;secp384r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="3943414">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;34&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3943481">//</span><br>
<span class="lineno"></span><span class="comment" id="3943484">//&nbsp;secp521r1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{</span><br>
<span class="lineno">320</span><span class="comment" id="3943521">//&nbsp;&nbsp;&nbsp;iso(1)&nbsp;identified-organization(3)&nbsp;certicom(132)&nbsp;curve(0)&nbsp;35&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3943588">//</span><br>
<span class="lineno"></span><span class="comment" id="3943591">//&nbsp;NB:&nbsp;secp256r1&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;prime256v1</span><br>
<span class="lineno"></span><span class="keyword" id="3943636">var</span>&nbsp;<span class="op" id="3943640">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943643">oidNamedCurveP224</span>&nbsp;<span class="op" id="3943661">=</span>&nbsp;<span class="ident" id="3943663">asn1</span><span class="op" id="3943667">.</span><span class="ident" id="3943668">ObjectIdentifier</span><span class="op" id="3943684">{</span><span class="num" id="3943685">1</span><span class="op" id="3943686">,</span>&nbsp;<span class="num" id="3943688">3</span><span class="op" id="3943689">,</span>&nbsp;<span class="num" id="3943691">132</span><span class="op" id="3943694">,</span>&nbsp;<span class="num" id="3943696">0</span><span class="op" id="3943697">,</span>&nbsp;<span class="num" id="3943699">33</span><span class="op" id="3943701">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943704">oidNamedCurveP256</span>&nbsp;<span class="op" id="3943722">=</span>&nbsp;<span class="ident" id="3943724">asn1</span><span class="op" id="3943728">.</span><span class="ident" id="3943729">ObjectIdentifier</span><span class="op" id="3943745">{</span><span class="num" id="3943746">1</span><span class="op" id="3943747">,</span>&nbsp;<span class="num" id="3943749">2</span><span class="op" id="3943750">,</span>&nbsp;<span class="num" id="3943752">840</span><span class="op" id="3943755">,</span>&nbsp;<span class="num" id="3943757">10045</span><span class="op" id="3943762">,</span>&nbsp;<span class="num" id="3943764">3</span><span class="op" id="3943765">,</span>&nbsp;<span class="num" id="3943767">1</span><span class="op" id="3943768">,</span>&nbsp;<span class="num" id="3943770">7</span><span class="op" id="3943771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943774">oidNamedCurveP384</span>&nbsp;<span class="op" id="3943792">=</span>&nbsp;<span class="ident" id="3943794">asn1</span><span class="op" id="3943798">.</span><span class="ident" id="3943799">ObjectIdentifier</span><span class="op" id="3943815">{</span><span class="num" id="3943816">1</span><span class="op" id="3943817">,</span>&nbsp;<span class="num" id="3943819">3</span><span class="op" id="3943820">,</span>&nbsp;<span class="num" id="3943822">132</span><span class="op" id="3943825">,</span>&nbsp;<span class="num" id="3943827">0</span><span class="op" id="3943828">,</span>&nbsp;<span class="num" id="3943830">34</span><span class="op" id="3943832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3943835">oidNamedCurveP521</span>&nbsp;<span class="op" id="3943853">=</span>&nbsp;<span class="ident" id="3943855">asn1</span><span class="op" id="3943859">.</span><span class="ident" id="3943860">ObjectIdentifier</span><span class="op" id="3943876">{</span><span class="num" id="3943877">1</span><span class="op" id="3943878">,</span>&nbsp;<span class="num" id="3943880">3</span><span class="op" id="3943881">,</span>&nbsp;<span class="num" id="3943883">132</span><span class="op" id="3943886">,</span>&nbsp;<span class="num" id="3943888">0</span><span class="op" id="3943889">,</span>&nbsp;<span class="num" id="3943891">35</span><span class="op" id="3943893">}</span><br>
<span class="lineno"></span><span class="op" id="3943895">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="3943898">func</span>&nbsp;<span class="ident" id="3943903">namedCurveFromOID</span><span class="op" id="3943920">(</span><span class="ident" id="3943921">oid</span>&nbsp;<span class="ident" id="3943925">asn1</span><span class="op" id="3943929">.</span><span class="ident" id="3943930">ObjectIdentifier</span><span class="op" id="3943946">)</span>&nbsp;<span class="ident" id="3943948">elliptic</span><span class="op" id="3943956">.</span><span class="ident" id="3943957">Curve</span>&nbsp;<span class="op" id="3943963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943966">switch</span>&nbsp;<span class="op" id="3943973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3943976">case</span>&nbsp;<span class="ident" id="3943981">oid</span><span class="op" id="3943984">.</span><span class="ident" id="3943985">Equal</span><span class="op" id="3943990">(</span><span class="ident" id="3943991">oidNamedCurveP224</span><span class="op" id="3944008">)</span><span class="op" id="3944009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944013">return</span>&nbsp;<span class="ident" id="3944020">elliptic</span><span class="op" id="3944028">.</span><span class="ident" id="3944029">P224</span><span class="op" id="3944033">(</span><span class="op" id="3944034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944037">case</span>&nbsp;<span class="ident" id="3944042">oid</span><span class="op" id="3944045">.</span><span class="ident" id="3944046">Equal</span><span class="op" id="3944051">(</span><span class="ident" id="3944052">oidNamedCurveP256</span><span class="op" id="3944069">)</span><span class="op" id="3944070">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944074">return</span>&nbsp;<span class="ident" id="3944081">elliptic</span><span class="op" id="3944089">.</span><span class="ident" id="3944090">P256</span><span class="op" id="3944094">(</span><span class="op" id="3944095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944098">case</span>&nbsp;<span class="ident" id="3944103">oid</span><span class="op" id="3944106">.</span><span class="ident" id="3944107">Equal</span><span class="op" id="3944112">(</span><span class="ident" id="3944113">oidNamedCurveP384</span><span class="op" id="3944130">)</span><span class="op" id="3944131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944135">return</span>&nbsp;<span class="ident" id="3944142">elliptic</span><span class="op" id="3944150">.</span><span class="ident" id="3944151">P384</span><span class="op" id="3944155">(</span><span class="op" id="3944156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944159">case</span>&nbsp;<span class="ident" id="3944164">oid</span><span class="op" id="3944167">.</span><span class="ident" id="3944168">Equal</span><span class="op" id="3944173">(</span><span class="ident" id="3944174">oidNamedCurveP521</span><span class="op" id="3944191">)</span><span class="op" id="3944192">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944196">return</span>&nbsp;<span class="ident" id="3944203">elliptic</span><span class="op" id="3944211">.</span><span class="ident" id="3944212">P521</span><span class="op" id="3944216">(</span><span class="op" id="3944217">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944223">return</span>&nbsp;<span class="builtintype" id="3944230">nil</span><br>
<span class="lineno"></span><span class="op" id="3944234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3944237">func</span>&nbsp;<span class="ident" id="3944242">oidFromNamedCurve</span><span class="op" id="3944259">(</span><span class="ident" id="3944260">curve</span>&nbsp;<span class="ident" id="3944266">elliptic</span><span class="op" id="3944274">.</span><span class="ident" id="3944275">Curve</span><span class="op" id="3944280">)</span>&nbsp;<span class="op" id="3944282">(</span><span class="ident" id="3944283">asn1</span><span class="op" id="3944287">.</span><span class="ident" id="3944288">ObjectIdentifier</span><span class="op" id="3944304">,</span>&nbsp;<span class="builtintype" id="3944306">bool</span><span class="op" id="3944310">)</span>&nbsp;<span class="op" id="3944312">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944315">switch</span>&nbsp;<span class="ident" id="3944322">curve</span>&nbsp;<span class="op" id="3944328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944331">case</span>&nbsp;<span class="ident" id="3944336">elliptic</span><span class="op" id="3944344">.</span><span class="ident" id="3944345">P224</span><span class="op" id="3944349">(</span><span class="op" id="3944350">)</span><span class="op" id="3944351">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944355">return</span>&nbsp;<span class="ident" id="3944362">oidNamedCurveP224</span><span class="op" id="3944379">,</span>&nbsp;<span class="builtintype" id="3944381">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944387">case</span>&nbsp;<span class="ident" id="3944392">elliptic</span><span class="op" id="3944400">.</span><span class="ident" id="3944401">P256</span><span class="op" id="3944405">(</span><span class="op" id="3944406">)</span><span class="op" id="3944407">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944411">return</span>&nbsp;<span class="ident" id="3944418">oidNamedCurveP256</span><span class="op" id="3944435">,</span>&nbsp;<span class="builtintype" id="3944437">true</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944443">case</span>&nbsp;<span class="ident" id="3944448">elliptic</span><span class="op" id="3944456">.</span><span class="ident" id="3944457">P384</span><span class="op" id="3944461">(</span><span class="op" id="3944462">)</span><span class="op" id="3944463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944467">return</span>&nbsp;<span class="ident" id="3944474">oidNamedCurveP384</span><span class="op" id="3944491">,</span>&nbsp;<span class="builtintype" id="3944493">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944499">case</span>&nbsp;<span class="ident" id="3944504">elliptic</span><span class="op" id="3944512">.</span><span class="ident" id="3944513">P521</span><span class="op" id="3944517">(</span><span class="op" id="3944518">)</span><span class="op" id="3944519">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944523">return</span>&nbsp;<span class="ident" id="3944530">oidNamedCurveP521</span><span class="op" id="3944547">,</span>&nbsp;<span class="builtintype" id="3944549">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3944555">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3944559">return</span>&nbsp;<span class="builtintype" id="3944566">nil</span><span class="op" id="3944569">,</span>&nbsp;<span class="builtintype" id="3944571">false</span><br>
<span class="lineno"></span><span class="op" id="3944577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3944580">//&nbsp;KeyUsage&nbsp;represents&nbsp;the&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.&nbsp;It&#39;s</span><br>
<span class="lineno">360</span><span class="comment" id="3944659">//&nbsp;a&nbsp;bitmap&nbsp;of&nbsp;the&nbsp;KeyUsage*&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3944699">type</span>&nbsp;<span class="ident" id="3944704">KeyUsage</span>&nbsp;<span class="builtintype" id="3944713">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3944718">const</span>&nbsp;<span class="op" id="3944724">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944727">KeyUsageDigitalSignature</span>&nbsp;<span class="ident" id="3944752">KeyUsage</span>&nbsp;<span class="op" id="3944761">=</span>&nbsp;<span class="num" id="3944763">1</span>&nbsp;<span class="op" id="3944765">&lt;&lt;</span>&nbsp;<span class="ident" id="3944768">iota</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944774">KeyUsageContentCommitment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944801">KeyUsageKeyEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944826">KeyUsageDataEncipherment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944852">KeyUsageKeyAgreement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944874">KeyUsageCertSign</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944892">KeyUsageCRLSign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944909">KeyUsageEncipherOnly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3944931">KeyUsageDecipherOnly</span><br>
<span class="lineno"></span><span class="op" id="3944952">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="3944955">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><span class="comment" id="3944997">//</span><br>
<span class="lineno"></span><span class="comment" id="3945000">//&nbsp;anyExtendedKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce-extKeyUsage&nbsp;0&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3945069">//</span><br>
<span class="lineno"></span><span class="comment" id="3945072">//&nbsp;id-kp&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-pkix&nbsp;3&nbsp;}</span><br>
<span class="lineno">380</span><span class="comment" id="3945117">//</span><br>
<span class="lineno"></span><span class="comment" id="3945120">//&nbsp;id-kp-serverAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;1&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3945186">//&nbsp;id-kp-clientAuth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;2&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3945252">//&nbsp;id-kp-codeSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;3&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3945318">//&nbsp;id-kp-emailProtection&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;4&nbsp;}</span><br>
<span class="lineno">385</span><span class="comment" id="3945384">//&nbsp;id-kp-timeStamping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;8&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="3945450">//&nbsp;id-kp-OCSPSigning&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-kp&nbsp;9&nbsp;}</span><br>
<span class="lineno"></span><span class="keyword" id="3945516">var</span>&nbsp;<span class="op" id="3945520">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945523">oidExtKeyUsageAny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3945564">=</span>&nbsp;<span class="ident" id="3945566">asn1</span><span class="op" id="3945570">.</span><span class="ident" id="3945571">ObjectIdentifier</span><span class="op" id="3945587">{</span><span class="num" id="3945588">2</span><span class="op" id="3945589">,</span>&nbsp;<span class="num" id="3945591">5</span><span class="op" id="3945592">,</span>&nbsp;<span class="num" id="3945594">29</span><span class="op" id="3945596">,</span>&nbsp;<span class="num" id="3945598">37</span><span class="op" id="3945600">,</span>&nbsp;<span class="num" id="3945602">0</span><span class="op" id="3945603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945606">oidExtKeyUsageServerAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3945647">=</span>&nbsp;<span class="ident" id="3945649">asn1</span><span class="op" id="3945653">.</span><span class="ident" id="3945654">ObjectIdentifier</span><span class="op" id="3945670">{</span><span class="num" id="3945671">1</span><span class="op" id="3945672">,</span>&nbsp;<span class="num" id="3945674">3</span><span class="op" id="3945675">,</span>&nbsp;<span class="num" id="3945677">6</span><span class="op" id="3945678">,</span>&nbsp;<span class="num" id="3945680">1</span><span class="op" id="3945681">,</span>&nbsp;<span class="num" id="3945683">5</span><span class="op" id="3945684">,</span>&nbsp;<span class="num" id="3945686">5</span><span class="op" id="3945687">,</span>&nbsp;<span class="num" id="3945689">7</span><span class="op" id="3945690">,</span>&nbsp;<span class="num" id="3945692">3</span><span class="op" id="3945693">,</span>&nbsp;<span class="num" id="3945695">1</span><span class="op" id="3945696">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945699">oidExtKeyUsageClientAuth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3945740">=</span>&nbsp;<span class="ident" id="3945742">asn1</span><span class="op" id="3945746">.</span><span class="ident" id="3945747">ObjectIdentifier</span><span class="op" id="3945763">{</span><span class="num" id="3945764">1</span><span class="op" id="3945765">,</span>&nbsp;<span class="num" id="3945767">3</span><span class="op" id="3945768">,</span>&nbsp;<span class="num" id="3945770">6</span><span class="op" id="3945771">,</span>&nbsp;<span class="num" id="3945773">1</span><span class="op" id="3945774">,</span>&nbsp;<span class="num" id="3945776">5</span><span class="op" id="3945777">,</span>&nbsp;<span class="num" id="3945779">5</span><span class="op" id="3945780">,</span>&nbsp;<span class="num" id="3945782">7</span><span class="op" id="3945783">,</span>&nbsp;<span class="num" id="3945785">3</span><span class="op" id="3945786">,</span>&nbsp;<span class="num" id="3945788">2</span><span class="op" id="3945789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945792">oidExtKeyUsageCodeSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3945833">=</span>&nbsp;<span class="ident" id="3945835">asn1</span><span class="op" id="3945839">.</span><span class="ident" id="3945840">ObjectIdentifier</span><span class="op" id="3945856">{</span><span class="num" id="3945857">1</span><span class="op" id="3945858">,</span>&nbsp;<span class="num" id="3945860">3</span><span class="op" id="3945861">,</span>&nbsp;<span class="num" id="3945863">6</span><span class="op" id="3945864">,</span>&nbsp;<span class="num" id="3945866">1</span><span class="op" id="3945867">,</span>&nbsp;<span class="num" id="3945869">5</span><span class="op" id="3945870">,</span>&nbsp;<span class="num" id="3945872">5</span><span class="op" id="3945873">,</span>&nbsp;<span class="num" id="3945875">7</span><span class="op" id="3945876">,</span>&nbsp;<span class="num" id="3945878">3</span><span class="op" id="3945879">,</span>&nbsp;<span class="num" id="3945881">3</span><span class="op" id="3945882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945885">oidExtKeyUsageEmailProtection</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3945926">=</span>&nbsp;<span class="ident" id="3945928">asn1</span><span class="op" id="3945932">.</span><span class="ident" id="3945933">ObjectIdentifier</span><span class="op" id="3945949">{</span><span class="num" id="3945950">1</span><span class="op" id="3945951">,</span>&nbsp;<span class="num" id="3945953">3</span><span class="op" id="3945954">,</span>&nbsp;<span class="num" id="3945956">6</span><span class="op" id="3945957">,</span>&nbsp;<span class="num" id="3945959">1</span><span class="op" id="3945960">,</span>&nbsp;<span class="num" id="3945962">5</span><span class="op" id="3945963">,</span>&nbsp;<span class="num" id="3945965">5</span><span class="op" id="3945966">,</span>&nbsp;<span class="num" id="3945968">7</span><span class="op" id="3945969">,</span>&nbsp;<span class="num" id="3945971">3</span><span class="op" id="3945972">,</span>&nbsp;<span class="num" id="3945974">4</span><span class="op" id="3945975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3945978">oidExtKeyUsageIPSECEndSystem</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946019">=</span>&nbsp;<span class="ident" id="3946021">asn1</span><span class="op" id="3946025">.</span><span class="ident" id="3946026">ObjectIdentifier</span><span class="op" id="3946042">{</span><span class="num" id="3946043">1</span><span class="op" id="3946044">,</span>&nbsp;<span class="num" id="3946046">3</span><span class="op" id="3946047">,</span>&nbsp;<span class="num" id="3946049">6</span><span class="op" id="3946050">,</span>&nbsp;<span class="num" id="3946052">1</span><span class="op" id="3946053">,</span>&nbsp;<span class="num" id="3946055">5</span><span class="op" id="3946056">,</span>&nbsp;<span class="num" id="3946058">5</span><span class="op" id="3946059">,</span>&nbsp;<span class="num" id="3946061">7</span><span class="op" id="3946062">,</span>&nbsp;<span class="num" id="3946064">3</span><span class="op" id="3946065">,</span>&nbsp;<span class="num" id="3946067">5</span><span class="op" id="3946068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946071">oidExtKeyUsageIPSECTunnel</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946112">=</span>&nbsp;<span class="ident" id="3946114">asn1</span><span class="op" id="3946118">.</span><span class="ident" id="3946119">ObjectIdentifier</span><span class="op" id="3946135">{</span><span class="num" id="3946136">1</span><span class="op" id="3946137">,</span>&nbsp;<span class="num" id="3946139">3</span><span class="op" id="3946140">,</span>&nbsp;<span class="num" id="3946142">6</span><span class="op" id="3946143">,</span>&nbsp;<span class="num" id="3946145">1</span><span class="op" id="3946146">,</span>&nbsp;<span class="num" id="3946148">5</span><span class="op" id="3946149">,</span>&nbsp;<span class="num" id="3946151">5</span><span class="op" id="3946152">,</span>&nbsp;<span class="num" id="3946154">7</span><span class="op" id="3946155">,</span>&nbsp;<span class="num" id="3946157">3</span><span class="op" id="3946158">,</span>&nbsp;<span class="num" id="3946160">6</span><span class="op" id="3946161">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946164">oidExtKeyUsageIPSECUser</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946205">=</span>&nbsp;<span class="ident" id="3946207">asn1</span><span class="op" id="3946211">.</span><span class="ident" id="3946212">ObjectIdentifier</span><span class="op" id="3946228">{</span><span class="num" id="3946229">1</span><span class="op" id="3946230">,</span>&nbsp;<span class="num" id="3946232">3</span><span class="op" id="3946233">,</span>&nbsp;<span class="num" id="3946235">6</span><span class="op" id="3946236">,</span>&nbsp;<span class="num" id="3946238">1</span><span class="op" id="3946239">,</span>&nbsp;<span class="num" id="3946241">5</span><span class="op" id="3946242">,</span>&nbsp;<span class="num" id="3946244">5</span><span class="op" id="3946245">,</span>&nbsp;<span class="num" id="3946247">7</span><span class="op" id="3946248">,</span>&nbsp;<span class="num" id="3946250">3</span><span class="op" id="3946251">,</span>&nbsp;<span class="num" id="3946253">7</span><span class="op" id="3946254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946257">oidExtKeyUsageTimeStamping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946298">=</span>&nbsp;<span class="ident" id="3946300">asn1</span><span class="op" id="3946304">.</span><span class="ident" id="3946305">ObjectIdentifier</span><span class="op" id="3946321">{</span><span class="num" id="3946322">1</span><span class="op" id="3946323">,</span>&nbsp;<span class="num" id="3946325">3</span><span class="op" id="3946326">,</span>&nbsp;<span class="num" id="3946328">6</span><span class="op" id="3946329">,</span>&nbsp;<span class="num" id="3946331">1</span><span class="op" id="3946332">,</span>&nbsp;<span class="num" id="3946334">5</span><span class="op" id="3946335">,</span>&nbsp;<span class="num" id="3946337">5</span><span class="op" id="3946338">,</span>&nbsp;<span class="num" id="3946340">7</span><span class="op" id="3946341">,</span>&nbsp;<span class="num" id="3946343">3</span><span class="op" id="3946344">,</span>&nbsp;<span class="num" id="3946346">8</span><span class="op" id="3946347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946350">oidExtKeyUsageOCSPSigning</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3946391">=</span>&nbsp;<span class="ident" id="3946393">asn1</span><span class="op" id="3946397">.</span><span class="ident" id="3946398">ObjectIdentifier</span><span class="op" id="3946414">{</span><span class="num" id="3946415">1</span><span class="op" id="3946416">,</span>&nbsp;<span class="num" id="3946418">3</span><span class="op" id="3946419">,</span>&nbsp;<span class="num" id="3946421">6</span><span class="op" id="3946422">,</span>&nbsp;<span class="num" id="3946424">1</span><span class="op" id="3946425">,</span>&nbsp;<span class="num" id="3946427">5</span><span class="op" id="3946428">,</span>&nbsp;<span class="num" id="3946430">5</span><span class="op" id="3946431">,</span>&nbsp;<span class="num" id="3946433">7</span><span class="op" id="3946434">,</span>&nbsp;<span class="num" id="3946436">3</span><span class="op" id="3946437">,</span>&nbsp;<span class="num" id="3946439">9</span><span class="op" id="3946440">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946443">oidExtKeyUsageMicrosoftServerGatedCrypto</span>&nbsp;<span class="op" id="3946484">=</span>&nbsp;<span class="ident" id="3946486">asn1</span><span class="op" id="3946490">.</span><span class="ident" id="3946491">ObjectIdentifier</span><span class="op" id="3946507">{</span><span class="num" id="3946508">1</span><span class="op" id="3946509">,</span>&nbsp;<span class="num" id="3946511">3</span><span class="op" id="3946512">,</span>&nbsp;<span class="num" id="3946514">6</span><span class="op" id="3946515">,</span>&nbsp;<span class="num" id="3946517">1</span><span class="op" id="3946518">,</span>&nbsp;<span class="num" id="3946520">4</span><span class="op" id="3946521">,</span>&nbsp;<span class="num" id="3946523">1</span><span class="op" id="3946524">,</span>&nbsp;<span class="num" id="3946526">311</span><span class="op" id="3946529">,</span>&nbsp;<span class="num" id="3946531">10</span><span class="op" id="3946533">,</span>&nbsp;<span class="num" id="3946535">3</span><span class="op" id="3946536">,</span>&nbsp;<span class="num" id="3946538">3</span><span class="op" id="3946539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946542">oidExtKeyUsageNetscapeServerGatedCrypto</span>&nbsp;&nbsp;<span class="op" id="3946583">=</span>&nbsp;<span class="ident" id="3946585">asn1</span><span class="op" id="3946589">.</span><span class="ident" id="3946590">ObjectIdentifier</span><span class="op" id="3946606">{</span><span class="num" id="3946607">2</span><span class="op" id="3946608">,</span>&nbsp;<span class="num" id="3946610">16</span><span class="op" id="3946612">,</span>&nbsp;<span class="num" id="3946614">840</span><span class="op" id="3946617">,</span>&nbsp;<span class="num" id="3946619">1</span><span class="op" id="3946620">,</span>&nbsp;<span class="num" id="3946622">113730</span><span class="op" id="3946628">,</span>&nbsp;<span class="num" id="3946630">4</span><span class="op" id="3946631">,</span>&nbsp;<span class="num" id="3946633">1</span><span class="op" id="3946634">}</span><br>
<span class="lineno">400</span><span class="op" id="3946636">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3946639">//&nbsp;ExtKeyUsage&nbsp;represents&nbsp;an&nbsp;extended&nbsp;set&nbsp;of&nbsp;actions&nbsp;that&nbsp;are&nbsp;valid&nbsp;for&nbsp;a&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="3946724">//&nbsp;Each&nbsp;of&nbsp;the&nbsp;ExtKeyUsage*&nbsp;constants&nbsp;define&nbsp;a&nbsp;unique&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="3946786">type</span>&nbsp;<span class="ident" id="3946791">ExtKeyUsage</span>&nbsp;<span class="builtintype" id="3946803">int</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="keyword" id="3946808">const</span>&nbsp;<span class="op" id="3946814">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946817">ExtKeyUsageAny</span>&nbsp;<span class="ident" id="3946832">ExtKeyUsage</span>&nbsp;<span class="op" id="3946844">=</span>&nbsp;<span class="ident" id="3946846">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946852">ExtKeyUsageServerAuth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946875">ExtKeyUsageClientAuth</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946898">ExtKeyUsageCodeSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946922">ExtKeyUsageEmailProtection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946950">ExtKeyUsageIPSECEndSystem</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3946977">ExtKeyUsageIPSECTunnel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947001">ExtKeyUsageIPSECUser</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947023">ExtKeyUsageTimeStamping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947048">ExtKeyUsageOCSPSigning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947072">ExtKeyUsageMicrosoftServerGatedCrypto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947111">ExtKeyUsageNetscapeServerGatedCrypto</span><br>
<span class="lineno"></span><span class="op" id="3947148">)</span><br>
<span class="lineno">420</span><br>
<span class="lineno"></span><span class="comment" id="3947151">//&nbsp;extKeyUsageOIDs&nbsp;contains&nbsp;the&nbsp;mapping&nbsp;between&nbsp;an&nbsp;ExtKeyUsage&nbsp;and&nbsp;its&nbsp;OID.</span><br>
<span class="lineno"></span><span class="keyword" id="3947227">var</span>&nbsp;<span class="ident" id="3947231">extKeyUsageOIDs</span>&nbsp;<span class="op" id="3947247">=</span>&nbsp;<span class="op" id="3947249">[</span><span class="op" id="3947250">]</span><span class="keyword" id="3947251">struct</span>&nbsp;<span class="op" id="3947258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947261">extKeyUsage</span>&nbsp;<span class="ident" id="3947273">ExtKeyUsage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947286">oid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3947298">asn1</span><span class="op" id="3947302">.</span><span class="ident" id="3947303">ObjectIdentifier</span><br>
<span class="lineno">425</span><span class="op" id="3947320">}</span><span class="op" id="3947321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947324">{</span><span class="ident" id="3947325">ExtKeyUsageAny</span><span class="op" id="3947339">,</span>&nbsp;<span class="ident" id="3947341">oidExtKeyUsageAny</span><span class="op" id="3947358">}</span><span class="op" id="3947359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947362">{</span><span class="ident" id="3947363">ExtKeyUsageServerAuth</span><span class="op" id="3947384">,</span>&nbsp;<span class="ident" id="3947386">oidExtKeyUsageServerAuth</span><span class="op" id="3947410">}</span><span class="op" id="3947411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947414">{</span><span class="ident" id="3947415">ExtKeyUsageClientAuth</span><span class="op" id="3947436">,</span>&nbsp;<span class="ident" id="3947438">oidExtKeyUsageClientAuth</span><span class="op" id="3947462">}</span><span class="op" id="3947463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947466">{</span><span class="ident" id="3947467">ExtKeyUsageCodeSigning</span><span class="op" id="3947489">,</span>&nbsp;<span class="ident" id="3947491">oidExtKeyUsageCodeSigning</span><span class="op" id="3947516">}</span><span class="op" id="3947517">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947520">{</span><span class="ident" id="3947521">ExtKeyUsageEmailProtection</span><span class="op" id="3947547">,</span>&nbsp;<span class="ident" id="3947549">oidExtKeyUsageEmailProtection</span><span class="op" id="3947578">}</span><span class="op" id="3947579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947582">{</span><span class="ident" id="3947583">ExtKeyUsageIPSECEndSystem</span><span class="op" id="3947608">,</span>&nbsp;<span class="ident" id="3947610">oidExtKeyUsageIPSECEndSystem</span><span class="op" id="3947638">}</span><span class="op" id="3947639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947642">{</span><span class="ident" id="3947643">ExtKeyUsageIPSECTunnel</span><span class="op" id="3947665">,</span>&nbsp;<span class="ident" id="3947667">oidExtKeyUsageIPSECTunnel</span><span class="op" id="3947692">}</span><span class="op" id="3947693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947696">{</span><span class="ident" id="3947697">ExtKeyUsageIPSECUser</span><span class="op" id="3947717">,</span>&nbsp;<span class="ident" id="3947719">oidExtKeyUsageIPSECUser</span><span class="op" id="3947742">}</span><span class="op" id="3947743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947746">{</span><span class="ident" id="3947747">ExtKeyUsageTimeStamping</span><span class="op" id="3947770">,</span>&nbsp;<span class="ident" id="3947772">oidExtKeyUsageTimeStamping</span><span class="op" id="3947798">}</span><span class="op" id="3947799">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947802">{</span><span class="ident" id="3947803">ExtKeyUsageOCSPSigning</span><span class="op" id="3947825">,</span>&nbsp;<span class="ident" id="3947827">oidExtKeyUsageOCSPSigning</span><span class="op" id="3947852">}</span><span class="op" id="3947853">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947856">{</span><span class="ident" id="3947857">ExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="3947894">,</span>&nbsp;<span class="ident" id="3947896">oidExtKeyUsageMicrosoftServerGatedCrypto</span><span class="op" id="3947936">}</span><span class="op" id="3947937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3947940">{</span><span class="ident" id="3947941">ExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="3947977">,</span>&nbsp;<span class="ident" id="3947979">oidExtKeyUsageNetscapeServerGatedCrypto</span><span class="op" id="3948018">}</span><span class="op" id="3948019">,</span><br>
<span class="lineno"></span><span class="op" id="3948021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="keyword" id="3948024">func</span>&nbsp;<span class="ident" id="3948029">extKeyUsageFromOID</span><span class="op" id="3948047">(</span><span class="ident" id="3948048">oid</span>&nbsp;<span class="ident" id="3948052">asn1</span><span class="op" id="3948056">.</span><span class="ident" id="3948057">ObjectIdentifier</span><span class="op" id="3948073">)</span>&nbsp;<span class="op" id="3948075">(</span><span class="ident" id="3948076">eku</span>&nbsp;<span class="ident" id="3948080">ExtKeyUsage</span><span class="op" id="3948091">,</span>&nbsp;<span class="ident" id="3948093">ok</span>&nbsp;<span class="builtintype" id="3948096">bool</span><span class="op" id="3948100">)</span>&nbsp;<span class="op" id="3948102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948105">for</span>&nbsp;<span class="ident" id="3948109">_</span><span class="op" id="3948110">,</span>&nbsp;<span class="ident" id="3948112">pair</span>&nbsp;<span class="op" id="3948117">:=</span>&nbsp;<span class="keyword" id="3948120">range</span>&nbsp;<span class="ident" id="3948126">extKeyUsageOIDs</span>&nbsp;<span class="op" id="3948142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948146">if</span>&nbsp;<span class="ident" id="3948149">oid</span><span class="op" id="3948152">.</span><span class="ident" id="3948153">Equal</span><span class="op" id="3948158">(</span><span class="ident" id="3948159">pair</span><span class="op" id="3948163">.</span><span class="ident" id="3948164">oid</span><span class="op" id="3948167">)</span>&nbsp;<span class="op" id="3948169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948174">return</span>&nbsp;<span class="ident" id="3948181">pair</span><span class="op" id="3948185">.</span><span class="ident" id="3948186">extKeyUsage</span><span class="op" id="3948197">,</span>&nbsp;<span class="builtintype" id="3948199">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948206">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948212">return</span><br>
<span class="lineno"></span><span class="op" id="3948219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3948222">func</span>&nbsp;<span class="ident" id="3948227">oidFromExtKeyUsage</span><span class="op" id="3948245">(</span><span class="ident" id="3948246">eku</span>&nbsp;<span class="ident" id="3948250">ExtKeyUsage</span><span class="op" id="3948261">)</span>&nbsp;<span class="op" id="3948263">(</span><span class="ident" id="3948264">oid</span>&nbsp;<span class="ident" id="3948268">asn1</span><span class="op" id="3948272">.</span><span class="ident" id="3948273">ObjectIdentifier</span><span class="op" id="3948289">,</span>&nbsp;<span class="ident" id="3948291">ok</span>&nbsp;<span class="builtintype" id="3948294">bool</span><span class="op" id="3948298">)</span>&nbsp;<span class="op" id="3948300">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948303">for</span>&nbsp;<span class="ident" id="3948307">_</span><span class="op" id="3948308">,</span>&nbsp;<span class="ident" id="3948310">pair</span>&nbsp;<span class="op" id="3948315">:=</span>&nbsp;<span class="keyword" id="3948318">range</span>&nbsp;<span class="ident" id="3948324">extKeyUsageOIDs</span>&nbsp;<span class="op" id="3948340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948344">if</span>&nbsp;<span class="ident" id="3948347">eku</span>&nbsp;<span class="op" id="3948351">==</span>&nbsp;<span class="ident" id="3948354">pair</span><span class="op" id="3948358">.</span><span class="ident" id="3948359">extKeyUsage</span>&nbsp;<span class="op" id="3948371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948376">return</span>&nbsp;<span class="ident" id="3948383">pair</span><span class="op" id="3948387">.</span><span class="ident" id="3948388">oid</span><span class="op" id="3948391">,</span>&nbsp;<span class="builtintype" id="3948393">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948403">}</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948406">return</span><br>
<span class="lineno"></span><span class="op" id="3948413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3948416">//&nbsp;A&nbsp;Certificate&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="3948466">type</span>&nbsp;<span class="ident" id="3948471">Certificate</span>&nbsp;<span class="keyword" id="3948483">struct</span>&nbsp;<span class="op" id="3948490">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948493">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948517">[</span><span class="op" id="3948518">]</span><span class="builtintype" id="3948519">byte</span>&nbsp;<span class="comment" id="3948524">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(certificate,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948605">RawTBSCertificate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948629">[</span><span class="op" id="3948630">]</span><span class="builtintype" id="3948631">byte</span>&nbsp;<span class="comment" id="3948636">//&nbsp;Certificate&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948683">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="3948707">[</span><span class="op" id="3948708">]</span><span class="builtintype" id="3948709">byte</span>&nbsp;<span class="comment" id="3948714">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948752">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948776">[</span><span class="op" id="3948777">]</span><span class="builtintype" id="3948778">byte</span>&nbsp;<span class="comment" id="3948783">//&nbsp;DER&nbsp;encoded&nbsp;Subject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948807">RawIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948831">[</span><span class="op" id="3948832">]</span><span class="builtintype" id="3948833">byte</span>&nbsp;<span class="comment" id="3948838">//&nbsp;DER&nbsp;encoded&nbsp;Issuer</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948862">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3948881">[</span><span class="op" id="3948882">]</span><span class="builtintype" id="3948883">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948889">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3948908">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948929">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="3948948">PublicKeyAlgorithm</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3948968">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3948987">interface</span><span class="op" id="3948996">{</span><span class="op" id="3948997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949001">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3949021">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949026">SerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949046">*</span><span class="ident" id="3949047">big</span><span class="op" id="3949050">.</span><span class="ident" id="3949051">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949056">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949076">pkix</span><span class="op" id="3949080">.</span><span class="ident" id="3949081">Name</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949087">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949107">pkix</span><span class="op" id="3949111">.</span><span class="ident" id="3949112">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949118">NotBefore</span><span class="op" id="3949127">,</span>&nbsp;<span class="ident" id="3949129">NotAfter</span>&nbsp;<span class="ident" id="3949138">time</span><span class="op" id="3949142">.</span><span class="ident" id="3949143">Time</span>&nbsp;<span class="comment" id="3949148">//&nbsp;Validity&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949169">KeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949189">KeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3949200">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;certificates,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3949273">//&nbsp;this&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;non-critical&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3949342">//&nbsp;parsed&nbsp;by&nbsp;this&nbsp;package.&nbsp;When&nbsp;marshaling&nbsp;certificates,&nbsp;the&nbsp;Extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3949415">//&nbsp;field&nbsp;is&nbsp;ignored,&nbsp;see&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949458">Extensions</span>&nbsp;<span class="op" id="3949469">[</span><span class="op" id="3949470">]</span><span class="ident" id="3949471">pkix</span><span class="op" id="3949475">.</span><span class="ident" id="3949476">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3949488">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3949556">//&nbsp;marshaled&nbsp;certificates.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3949626">//&nbsp;otherwise&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields.&nbsp;The&nbsp;ExtraExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3949699">//&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;certificates,&nbsp;see&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949769">ExtraExtensions</span>&nbsp;<span class="op" id="3949785">[</span><span class="op" id="3949786">]</span><span class="ident" id="3949787">pkix</span><span class="op" id="3949791">.</span><span class="ident" id="3949792">Extension</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949804">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3949823">[</span><span class="op" id="3949824">]</span><span class="ident" id="3949825">ExtKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3949847">//&nbsp;Sequence&nbsp;of&nbsp;extended&nbsp;key&nbsp;usages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949884">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="3949903">[</span><span class="op" id="3949904">]</span><span class="ident" id="3949905">asn1</span><span class="op" id="3949909">.</span><span class="ident" id="3949910">ObjectIdentifier</span>&nbsp;<span class="comment" id="3949927">//&nbsp;Encountered&nbsp;extended&nbsp;key&nbsp;usages&nbsp;unknown&nbsp;to&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3949989">BasicConstraintsValid</span>&nbsp;<span class="builtintype" id="3950011">bool</span>&nbsp;<span class="comment" id="3950016">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;next&nbsp;two&nbsp;fields&nbsp;are&nbsp;valid.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950064">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3950086">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950092">MaxPathLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3950114">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3950119">//&nbsp;MaxPathLenZero&nbsp;indicates&nbsp;that&nbsp;BasicConstraintsValid==true&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3950185">//&nbsp;MaxPathLen==0&nbsp;should&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;an&nbsp;actual&nbsp;maximum&nbsp;path&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3950258">//&nbsp;of&nbsp;zero.&nbsp;Otherwise,&nbsp;that&nbsp;combination&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;MaxPathLen</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3950328">//&nbsp;not&nbsp;being&nbsp;set.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950347">MaxPathLenZero</span>&nbsp;<span class="builtintype" id="3950362">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950369">SubjectKeyId</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3950384">[</span><span class="op" id="3950385">]</span><span class="builtintype" id="3950386">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950392">AuthorityKeyId</span>&nbsp;<span class="op" id="3950407">[</span><span class="op" id="3950408">]</span><span class="builtintype" id="3950409">byte</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3950416">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1&nbsp;(Authority&nbsp;Information&nbsp;Access)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950469">OCSPServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3950491">[</span><span class="op" id="3950492">]</span><span class="builtintype" id="3950493">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950501">IssuingCertificateURL</span>&nbsp;<span class="op" id="3950523">[</span><span class="op" id="3950524">]</span><span class="builtintype" id="3950525">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3950534">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950568">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3950583">[</span><span class="op" id="3950584">]</span><span class="builtintype" id="3950585">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950593">EmailAddresses</span>&nbsp;<span class="op" id="3950608">[</span><span class="op" id="3950609">]</span><span class="builtintype" id="3950610">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950618">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3950633">[</span><span class="op" id="3950634">]</span><span class="ident" id="3950635">net</span><span class="op" id="3950638">.</span><span class="ident" id="3950639">IP</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3950644">//&nbsp;Name&nbsp;constraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950665">PermittedDNSDomainsCritical</span>&nbsp;<span class="builtintype" id="3950693">bool</span>&nbsp;<span class="comment" id="3950698">//&nbsp;if&nbsp;true&nbsp;then&nbsp;the&nbsp;name&nbsp;constraints&nbsp;are&nbsp;marked&nbsp;critical.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950757">PermittedDNSDomains</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3950785">[</span><span class="op" id="3950786">]</span><span class="builtintype" id="3950787">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3950796">//&nbsp;CRL&nbsp;Distribution&nbsp;Points</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950824">CRLDistributionPoints</span>&nbsp;<span class="op" id="3950846">[</span><span class="op" id="3950847">]</span><span class="builtintype" id="3950848">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3950857">PolicyIdentifiers</span>&nbsp;<span class="op" id="3950875">[</span><span class="op" id="3950876">]</span><span class="ident" id="3950877">asn1</span><span class="op" id="3950881">.</span><span class="ident" id="3950882">ObjectIdentifier</span><br>
<span class="lineno"></span><span class="op" id="3950899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="3950902">//&nbsp;ErrUnsupportedAlgorithm&nbsp;results&nbsp;from&nbsp;attempting&nbsp;to&nbsp;perform&nbsp;an&nbsp;operation&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3950982">//&nbsp;involves&nbsp;algorithms&nbsp;that&nbsp;are&nbsp;not&nbsp;currently&nbsp;implemented.</span><br>
<span class="lineno"></span><span class="keyword" id="3951041">var</span>&nbsp;<span class="ident" id="3951045">ErrUnsupportedAlgorithm</span>&nbsp;<span class="op" id="3951069">=</span>&nbsp;<span class="ident" id="3951071">errors</span><span class="op" id="3951077">.</span><span class="ident" id="3951078">New</span><span class="op" id="3951081">(</span><span class="string" id="3951082">&#34;x509:&nbsp;cannot&nbsp;verify&nbsp;signature:&nbsp;algorithm&nbsp;unimplemented&#34;</span><span class="op" id="3951138">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3951141">//&nbsp;ConstraintViolationError&nbsp;results&nbsp;when&nbsp;a&nbsp;requested&nbsp;usage&nbsp;is&nbsp;not&nbsp;permitted&nbsp;by</span><br>
<span class="lineno">530</span><span class="comment" id="3951220">//&nbsp;a&nbsp;certificate.&nbsp;For&nbsp;example:&nbsp;checking&nbsp;a&nbsp;signature&nbsp;when&nbsp;the&nbsp;public&nbsp;key&nbsp;isn&#39;t&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3951300">//&nbsp;certificate&nbsp;signing&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3951328">type</span>&nbsp;<span class="ident" id="3951333">ConstraintViolationError</span>&nbsp;<span class="keyword" id="3951358">struct</span><span class="op" id="3951364">{</span><span class="op" id="3951365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3951368">func</span>&nbsp;<span class="op" id="3951373">(</span><span class="ident" id="3951374">ConstraintViolationError</span><span class="op" id="3951398">)</span>&nbsp;<span class="ident" id="3951400">Error</span><span class="op" id="3951405">(</span><span class="op" id="3951406">)</span>&nbsp;<span class="builtintype" id="3951408">string</span>&nbsp;<span class="op" id="3951415">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951418">return</span>&nbsp;<span class="string" id="3951425">&#34;x509:&nbsp;invalid&nbsp;signature:&nbsp;parent&nbsp;certificate&nbsp;cannot&nbsp;sign&nbsp;this&nbsp;kind&nbsp;of&nbsp;certificate&#34;</span><br>
<span class="lineno"></span><span class="op" id="3951508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3951511">func</span>&nbsp;<span class="op" id="3951516">(</span><span class="ident" id="3951517">c</span>&nbsp;<span class="op" id="3951519">*</span><span class="ident" id="3951520">Certificate</span><span class="op" id="3951531">)</span>&nbsp;<span class="ident" id="3951533">Equal</span><span class="op" id="3951538">(</span><span class="ident" id="3951539">other</span>&nbsp;<span class="op" id="3951545">*</span><span class="ident" id="3951546">Certificate</span><span class="op" id="3951557">)</span>&nbsp;<span class="builtintype" id="3951559">bool</span>&nbsp;<span class="op" id="3951564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3951567">return</span>&nbsp;<span class="ident" id="3951574">bytes</span><span class="op" id="3951579">.</span><span class="ident" id="3951580">Equal</span><span class="op" id="3951585">(</span><span class="ident" id="3951586">c</span><span class="op" id="3951587">.</span><span class="ident" id="3951588">Raw</span><span class="op" id="3951591">,</span>&nbsp;<span class="ident" id="3951593">other</span><span class="op" id="3951598">.</span><span class="ident" id="3951599">Raw</span><span class="op" id="3951602">)</span><br>
<span class="lineno">540</span><span class="op" id="3951604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3951607">//&nbsp;Entrust&nbsp;have&nbsp;a&nbsp;broken&nbsp;root&nbsp;certificate&nbsp;(CN=Entrust.net&nbsp;Certification</span><br>
<span class="lineno"></span><span class="comment" id="3951679">//&nbsp;Authority&nbsp;(2048))&nbsp;which&nbsp;isn&#39;t&nbsp;marked&nbsp;as&nbsp;a&nbsp;CA&nbsp;certificate&nbsp;and&nbsp;is&nbsp;thus&nbsp;invalid</span><br>
<span class="lineno"></span><span class="comment" id="3951759">//&nbsp;according&nbsp;to&nbsp;PKIX.</span><br>
<span class="lineno">545</span><span class="comment" id="3951781">//&nbsp;We&nbsp;recognise&nbsp;this&nbsp;certificate&nbsp;by&nbsp;its&nbsp;SubjectPublicKeyInfo&nbsp;and&nbsp;exempt&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3951856">//&nbsp;from&nbsp;the&nbsp;Basic&nbsp;Constraints&nbsp;requirement.</span><br>
<span class="lineno"></span><span class="comment" id="3951899">//&nbsp;See&nbsp;http://www.entrust.net/knowledge-base/technote.cfm?tn=7869</span><br>
<span class="lineno"></span><span class="comment" id="3951965">//</span><br>
<span class="lineno"></span><span class="comment" id="3951968">//&nbsp;TODO(agl):&nbsp;remove&nbsp;this&nbsp;hack&nbsp;once&nbsp;their&nbsp;reissued&nbsp;root&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno">550</span><span class="comment" id="3952040">//&nbsp;widespread.</span><br>
<span class="lineno"></span><span class="keyword" id="3952055">var</span>&nbsp;<span class="ident" id="3952059">entrustBrokenSPKI</span>&nbsp;<span class="op" id="3952077">=</span>&nbsp;<span class="op" id="3952079">[</span><span class="op" id="3952080">]</span><span class="builtintype" id="3952081">byte</span><span class="op" id="3952085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952088">0x30</span><span class="op" id="3952092">,</span>&nbsp;<span class="num" id="3952094">0x82</span><span class="op" id="3952098">,</span>&nbsp;<span class="num" id="3952100">0x01</span><span class="op" id="3952104">,</span>&nbsp;<span class="num" id="3952106">0x22</span><span class="op" id="3952110">,</span>&nbsp;<span class="num" id="3952112">0x30</span><span class="op" id="3952116">,</span>&nbsp;<span class="num" id="3952118">0x0d</span><span class="op" id="3952122">,</span>&nbsp;<span class="num" id="3952124">0x06</span><span class="op" id="3952128">,</span>&nbsp;<span class="num" id="3952130">0x09</span><span class="op" id="3952134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952137">0x2a</span><span class="op" id="3952141">,</span>&nbsp;<span class="num" id="3952143">0x86</span><span class="op" id="3952147">,</span>&nbsp;<span class="num" id="3952149">0x48</span><span class="op" id="3952153">,</span>&nbsp;<span class="num" id="3952155">0x86</span><span class="op" id="3952159">,</span>&nbsp;<span class="num" id="3952161">0xf7</span><span class="op" id="3952165">,</span>&nbsp;<span class="num" id="3952167">0x0d</span><span class="op" id="3952171">,</span>&nbsp;<span class="num" id="3952173">0x01</span><span class="op" id="3952177">,</span>&nbsp;<span class="num" id="3952179">0x01</span><span class="op" id="3952183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952186">0x01</span><span class="op" id="3952190">,</span>&nbsp;<span class="num" id="3952192">0x05</span><span class="op" id="3952196">,</span>&nbsp;<span class="num" id="3952198">0x00</span><span class="op" id="3952202">,</span>&nbsp;<span class="num" id="3952204">0x03</span><span class="op" id="3952208">,</span>&nbsp;<span class="num" id="3952210">0x82</span><span class="op" id="3952214">,</span>&nbsp;<span class="num" id="3952216">0x01</span><span class="op" id="3952220">,</span>&nbsp;<span class="num" id="3952222">0x0f</span><span class="op" id="3952226">,</span>&nbsp;<span class="num" id="3952228">0x00</span><span class="op" id="3952232">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952235">0x30</span><span class="op" id="3952239">,</span>&nbsp;<span class="num" id="3952241">0x82</span><span class="op" id="3952245">,</span>&nbsp;<span class="num" id="3952247">0x01</span><span class="op" id="3952251">,</span>&nbsp;<span class="num" id="3952253">0x0a</span><span class="op" id="3952257">,</span>&nbsp;<span class="num" id="3952259">0x02</span><span class="op" id="3952263">,</span>&nbsp;<span class="num" id="3952265">0x82</span><span class="op" id="3952269">,</span>&nbsp;<span class="num" id="3952271">0x01</span><span class="op" id="3952275">,</span>&nbsp;<span class="num" id="3952277">0x01</span><span class="op" id="3952281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952284">0x00</span><span class="op" id="3952288">,</span>&nbsp;<span class="num" id="3952290">0x97</span><span class="op" id="3952294">,</span>&nbsp;<span class="num" id="3952296">0xa3</span><span class="op" id="3952300">,</span>&nbsp;<span class="num" id="3952302">0x2d</span><span class="op" id="3952306">,</span>&nbsp;<span class="num" id="3952308">0x3c</span><span class="op" id="3952312">,</span>&nbsp;<span class="num" id="3952314">0x9e</span><span class="op" id="3952318">,</span>&nbsp;<span class="num" id="3952320">0xde</span><span class="op" id="3952324">,</span>&nbsp;<span class="num" id="3952326">0x05</span><span class="op" id="3952330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952333">0xda</span><span class="op" id="3952337">,</span>&nbsp;<span class="num" id="3952339">0x13</span><span class="op" id="3952343">,</span>&nbsp;<span class="num" id="3952345">0xc2</span><span class="op" id="3952349">,</span>&nbsp;<span class="num" id="3952351">0x11</span><span class="op" id="3952355">,</span>&nbsp;<span class="num" id="3952357">0x8d</span><span class="op" id="3952361">,</span>&nbsp;<span class="num" id="3952363">0x9d</span><span class="op" id="3952367">,</span>&nbsp;<span class="num" id="3952369">0x8e</span><span class="op" id="3952373">,</span>&nbsp;<span class="num" id="3952375">0xe3</span><span class="op" id="3952379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952382">0x7f</span><span class="op" id="3952386">,</span>&nbsp;<span class="num" id="3952388">0xc7</span><span class="op" id="3952392">,</span>&nbsp;<span class="num" id="3952394">0x4b</span><span class="op" id="3952398">,</span>&nbsp;<span class="num" id="3952400">0x7e</span><span class="op" id="3952404">,</span>&nbsp;<span class="num" id="3952406">0x5a</span><span class="op" id="3952410">,</span>&nbsp;<span class="num" id="3952412">0x9f</span><span class="op" id="3952416">,</span>&nbsp;<span class="num" id="3952418">0xb3</span><span class="op" id="3952422">,</span>&nbsp;<span class="num" id="3952424">0xff</span><span class="op" id="3952428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952431">0x62</span><span class="op" id="3952435">,</span>&nbsp;<span class="num" id="3952437">0xab</span><span class="op" id="3952441">,</span>&nbsp;<span class="num" id="3952443">0x73</span><span class="op" id="3952447">,</span>&nbsp;<span class="num" id="3952449">0xc8</span><span class="op" id="3952453">,</span>&nbsp;<span class="num" id="3952455">0x28</span><span class="op" id="3952459">,</span>&nbsp;<span class="num" id="3952461">0x6b</span><span class="op" id="3952465">,</span>&nbsp;<span class="num" id="3952467">0xba</span><span class="op" id="3952471">,</span>&nbsp;<span class="num" id="3952473">0x10</span><span class="op" id="3952477">,</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952480">0x64</span><span class="op" id="3952484">,</span>&nbsp;<span class="num" id="3952486">0x82</span><span class="op" id="3952490">,</span>&nbsp;<span class="num" id="3952492">0x87</span><span class="op" id="3952496">,</span>&nbsp;<span class="num" id="3952498">0x13</span><span class="op" id="3952502">,</span>&nbsp;<span class="num" id="3952504">0xcd</span><span class="op" id="3952508">,</span>&nbsp;<span class="num" id="3952510">0x57</span><span class="op" id="3952514">,</span>&nbsp;<span class="num" id="3952516">0x18</span><span class="op" id="3952520">,</span>&nbsp;<span class="num" id="3952522">0xff</span><span class="op" id="3952526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952529">0x28</span><span class="op" id="3952533">,</span>&nbsp;<span class="num" id="3952535">0xce</span><span class="op" id="3952539">,</span>&nbsp;<span class="num" id="3952541">0xc0</span><span class="op" id="3952545">,</span>&nbsp;<span class="num" id="3952547">0xe6</span><span class="op" id="3952551">,</span>&nbsp;<span class="num" id="3952553">0x0e</span><span class="op" id="3952557">,</span>&nbsp;<span class="num" id="3952559">0x06</span><span class="op" id="3952563">,</span>&nbsp;<span class="num" id="3952565">0x91</span><span class="op" id="3952569">,</span>&nbsp;<span class="num" id="3952571">0x50</span><span class="op" id="3952575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952578">0x29</span><span class="op" id="3952582">,</span>&nbsp;<span class="num" id="3952584">0x83</span><span class="op" id="3952588">,</span>&nbsp;<span class="num" id="3952590">0xd1</span><span class="op" id="3952594">,</span>&nbsp;<span class="num" id="3952596">0xf2</span><span class="op" id="3952600">,</span>&nbsp;<span class="num" id="3952602">0xc3</span><span class="op" id="3952606">,</span>&nbsp;<span class="num" id="3952608">0x2a</span><span class="op" id="3952612">,</span>&nbsp;<span class="num" id="3952614">0xdb</span><span class="op" id="3952618">,</span>&nbsp;<span class="num" id="3952620">0xd8</span><span class="op" id="3952624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952627">0xdb</span><span class="op" id="3952631">,</span>&nbsp;<span class="num" id="3952633">0x4e</span><span class="op" id="3952637">,</span>&nbsp;<span class="num" id="3952639">0x04</span><span class="op" id="3952643">,</span>&nbsp;<span class="num" id="3952645">0xcc</span><span class="op" id="3952649">,</span>&nbsp;<span class="num" id="3952651">0x00</span><span class="op" id="3952655">,</span>&nbsp;<span class="num" id="3952657">0xeb</span><span class="op" id="3952661">,</span>&nbsp;<span class="num" id="3952663">0x8b</span><span class="op" id="3952667">,</span>&nbsp;<span class="num" id="3952669">0xb6</span><span class="op" id="3952673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952676">0x96</span><span class="op" id="3952680">,</span>&nbsp;<span class="num" id="3952682">0xdc</span><span class="op" id="3952686">,</span>&nbsp;<span class="num" id="3952688">0xbc</span><span class="op" id="3952692">,</span>&nbsp;<span class="num" id="3952694">0xaa</span><span class="op" id="3952698">,</span>&nbsp;<span class="num" id="3952700">0xfa</span><span class="op" id="3952704">,</span>&nbsp;<span class="num" id="3952706">0x52</span><span class="op" id="3952710">,</span>&nbsp;<span class="num" id="3952712">0x77</span><span class="op" id="3952716">,</span>&nbsp;<span class="num" id="3952718">0x04</span><span class="op" id="3952722">,</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952725">0xc1</span><span class="op" id="3952729">,</span>&nbsp;<span class="num" id="3952731">0xdb</span><span class="op" id="3952735">,</span>&nbsp;<span class="num" id="3952737">0x19</span><span class="op" id="3952741">,</span>&nbsp;<span class="num" id="3952743">0xe4</span><span class="op" id="3952747">,</span>&nbsp;<span class="num" id="3952749">0xae</span><span class="op" id="3952753">,</span>&nbsp;<span class="num" id="3952755">0x9c</span><span class="op" id="3952759">,</span>&nbsp;<span class="num" id="3952761">0xfd</span><span class="op" id="3952765">,</span>&nbsp;<span class="num" id="3952767">0x3c</span><span class="op" id="3952771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952774">0x8b</span><span class="op" id="3952778">,</span>&nbsp;<span class="num" id="3952780">0x03</span><span class="op" id="3952784">,</span>&nbsp;<span class="num" id="3952786">0xef</span><span class="op" id="3952790">,</span>&nbsp;<span class="num" id="3952792">0x4d</span><span class="op" id="3952796">,</span>&nbsp;<span class="num" id="3952798">0xbc</span><span class="op" id="3952802">,</span>&nbsp;<span class="num" id="3952804">0x1a</span><span class="op" id="3952808">,</span>&nbsp;<span class="num" id="3952810">0x03</span><span class="op" id="3952814">,</span>&nbsp;<span class="num" id="3952816">0x65</span><span class="op" id="3952820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952823">0xf9</span><span class="op" id="3952827">,</span>&nbsp;<span class="num" id="3952829">0xc1</span><span class="op" id="3952833">,</span>&nbsp;<span class="num" id="3952835">0xb1</span><span class="op" id="3952839">,</span>&nbsp;<span class="num" id="3952841">0x3f</span><span class="op" id="3952845">,</span>&nbsp;<span class="num" id="3952847">0x72</span><span class="op" id="3952851">,</span>&nbsp;<span class="num" id="3952853">0x86</span><span class="op" id="3952857">,</span>&nbsp;<span class="num" id="3952859">0xf2</span><span class="op" id="3952863">,</span>&nbsp;<span class="num" id="3952865">0x38</span><span class="op" id="3952869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952872">0xaa</span><span class="op" id="3952876">,</span>&nbsp;<span class="num" id="3952878">0x19</span><span class="op" id="3952882">,</span>&nbsp;<span class="num" id="3952884">0xae</span><span class="op" id="3952888">,</span>&nbsp;<span class="num" id="3952890">0x10</span><span class="op" id="3952894">,</span>&nbsp;<span class="num" id="3952896">0x88</span><span class="op" id="3952900">,</span>&nbsp;<span class="num" id="3952902">0x78</span><span class="op" id="3952906">,</span>&nbsp;<span class="num" id="3952908">0x28</span><span class="op" id="3952912">,</span>&nbsp;<span class="num" id="3952914">0xda</span><span class="op" id="3952918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952921">0x75</span><span class="op" id="3952925">,</span>&nbsp;<span class="num" id="3952927">0xc3</span><span class="op" id="3952931">,</span>&nbsp;<span class="num" id="3952933">0x3d</span><span class="op" id="3952937">,</span>&nbsp;<span class="num" id="3952939">0x02</span><span class="op" id="3952943">,</span>&nbsp;<span class="num" id="3952945">0x82</span><span class="op" id="3952949">,</span>&nbsp;<span class="num" id="3952951">0x02</span><span class="op" id="3952955">,</span>&nbsp;<span class="num" id="3952957">0x9c</span><span class="op" id="3952961">,</span>&nbsp;<span class="num" id="3952963">0xb9</span><span class="op" id="3952967">,</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3952970">0xc1</span><span class="op" id="3952974">,</span>&nbsp;<span class="num" id="3952976">0x65</span><span class="op" id="3952980">,</span>&nbsp;<span class="num" id="3952982">0x77</span><span class="op" id="3952986">,</span>&nbsp;<span class="num" id="3952988">0x76</span><span class="op" id="3952992">,</span>&nbsp;<span class="num" id="3952994">0x24</span><span class="op" id="3952998">,</span>&nbsp;<span class="num" id="3953000">0x4c</span><span class="op" id="3953004">,</span>&nbsp;<span class="num" id="3953006">0x98</span><span class="op" id="3953010">,</span>&nbsp;<span class="num" id="3953012">0xf7</span><span class="op" id="3953016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953019">0x6d</span><span class="op" id="3953023">,</span>&nbsp;<span class="num" id="3953025">0x31</span><span class="op" id="3953029">,</span>&nbsp;<span class="num" id="3953031">0x38</span><span class="op" id="3953035">,</span>&nbsp;<span class="num" id="3953037">0xfb</span><span class="op" id="3953041">,</span>&nbsp;<span class="num" id="3953043">0xdb</span><span class="op" id="3953047">,</span>&nbsp;<span class="num" id="3953049">0xfe</span><span class="op" id="3953053">,</span>&nbsp;<span class="num" id="3953055">0xdb</span><span class="op" id="3953059">,</span>&nbsp;<span class="num" id="3953061">0x37</span><span class="op" id="3953065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953068">0x02</span><span class="op" id="3953072">,</span>&nbsp;<span class="num" id="3953074">0x76</span><span class="op" id="3953078">,</span>&nbsp;<span class="num" id="3953080">0xa1</span><span class="op" id="3953084">,</span>&nbsp;<span class="num" id="3953086">0x18</span><span class="op" id="3953090">,</span>&nbsp;<span class="num" id="3953092">0x97</span><span class="op" id="3953096">,</span>&nbsp;<span class="num" id="3953098">0xa6</span><span class="op" id="3953102">,</span>&nbsp;<span class="num" id="3953104">0xcc</span><span class="op" id="3953108">,</span>&nbsp;<span class="num" id="3953110">0xde</span><span class="op" id="3953114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953117">0x20</span><span class="op" id="3953121">,</span>&nbsp;<span class="num" id="3953123">0x09</span><span class="op" id="3953127">,</span>&nbsp;<span class="num" id="3953129">0x49</span><span class="op" id="3953133">,</span>&nbsp;<span class="num" id="3953135">0x36</span><span class="op" id="3953139">,</span>&nbsp;<span class="num" id="3953141">0x24</span><span class="op" id="3953145">,</span>&nbsp;<span class="num" id="3953147">0x69</span><span class="op" id="3953151">,</span>&nbsp;<span class="num" id="3953153">0x42</span><span class="op" id="3953157">,</span>&nbsp;<span class="num" id="3953159">0xf6</span><span class="op" id="3953163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953166">0xe4</span><span class="op" id="3953170">,</span>&nbsp;<span class="num" id="3953172">0x37</span><span class="op" id="3953176">,</span>&nbsp;<span class="num" id="3953178">0x62</span><span class="op" id="3953182">,</span>&nbsp;<span class="num" id="3953184">0xf1</span><span class="op" id="3953188">,</span>&nbsp;<span class="num" id="3953190">0x59</span><span class="op" id="3953194">,</span>&nbsp;<span class="num" id="3953196">0x6d</span><span class="op" id="3953200">,</span>&nbsp;<span class="num" id="3953202">0xa9</span><span class="op" id="3953206">,</span>&nbsp;<span class="num" id="3953208">0x3c</span><span class="op" id="3953212">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953215">0xed</span><span class="op" id="3953219">,</span>&nbsp;<span class="num" id="3953221">0x34</span><span class="op" id="3953225">,</span>&nbsp;<span class="num" id="3953227">0x9c</span><span class="op" id="3953231">,</span>&nbsp;<span class="num" id="3953233">0xa3</span><span class="op" id="3953237">,</span>&nbsp;<span class="num" id="3953239">0x8e</span><span class="op" id="3953243">,</span>&nbsp;<span class="num" id="3953245">0xdb</span><span class="op" id="3953249">,</span>&nbsp;<span class="num" id="3953251">0xdc</span><span class="op" id="3953255">,</span>&nbsp;<span class="num" id="3953257">0x3a</span><span class="op" id="3953261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953264">0xd7</span><span class="op" id="3953268">,</span>&nbsp;<span class="num" id="3953270">0xf7</span><span class="op" id="3953274">,</span>&nbsp;<span class="num" id="3953276">0x0a</span><span class="op" id="3953280">,</span>&nbsp;<span class="num" id="3953282">0x6f</span><span class="op" id="3953286">,</span>&nbsp;<span class="num" id="3953288">0xef</span><span class="op" id="3953292">,</span>&nbsp;<span class="num" id="3953294">0x2e</span><span class="op" id="3953298">,</span>&nbsp;<span class="num" id="3953300">0xd8</span><span class="op" id="3953304">,</span>&nbsp;<span class="num" id="3953306">0xd5</span><span class="op" id="3953310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953313">0x93</span><span class="op" id="3953317">,</span>&nbsp;<span class="num" id="3953319">0x5a</span><span class="op" id="3953323">,</span>&nbsp;<span class="num" id="3953325">0x7a</span><span class="op" id="3953329">,</span>&nbsp;<span class="num" id="3953331">0xed</span><span class="op" id="3953335">,</span>&nbsp;<span class="num" id="3953337">0x08</span><span class="op" id="3953341">,</span>&nbsp;<span class="num" id="3953343">0x49</span><span class="op" id="3953347">,</span>&nbsp;<span class="num" id="3953349">0x68</span><span class="op" id="3953353">,</span>&nbsp;<span class="num" id="3953355">0xe2</span><span class="op" id="3953359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953362">0x41</span><span class="op" id="3953366">,</span>&nbsp;<span class="num" id="3953368">0xe3</span><span class="op" id="3953372">,</span>&nbsp;<span class="num" id="3953374">0x5a</span><span class="op" id="3953378">,</span>&nbsp;<span class="num" id="3953380">0x90</span><span class="op" id="3953384">,</span>&nbsp;<span class="num" id="3953386">0xc1</span><span class="op" id="3953390">,</span>&nbsp;<span class="num" id="3953392">0x86</span><span class="op" id="3953396">,</span>&nbsp;<span class="num" id="3953398">0x55</span><span class="op" id="3953402">,</span>&nbsp;<span class="num" id="3953404">0xfc</span><span class="op" id="3953408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953411">0x51</span><span class="op" id="3953415">,</span>&nbsp;<span class="num" id="3953417">0x43</span><span class="op" id="3953421">,</span>&nbsp;<span class="num" id="3953423">0x9d</span><span class="op" id="3953427">,</span>&nbsp;<span class="num" id="3953429">0xe0</span><span class="op" id="3953433">,</span>&nbsp;<span class="num" id="3953435">0xb2</span><span class="op" id="3953439">,</span>&nbsp;<span class="num" id="3953441">0xc4</span><span class="op" id="3953445">,</span>&nbsp;<span class="num" id="3953447">0x67</span><span class="op" id="3953451">,</span>&nbsp;<span class="num" id="3953453">0xb4</span><span class="op" id="3953457">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953460">0xcb</span><span class="op" id="3953464">,</span>&nbsp;<span class="num" id="3953466">0x32</span><span class="op" id="3953470">,</span>&nbsp;<span class="num" id="3953472">0x31</span><span class="op" id="3953476">,</span>&nbsp;<span class="num" id="3953478">0x25</span><span class="op" id="3953482">,</span>&nbsp;<span class="num" id="3953484">0xf0</span><span class="op" id="3953488">,</span>&nbsp;<span class="num" id="3953490">0x54</span><span class="op" id="3953494">,</span>&nbsp;<span class="num" id="3953496">0x9f</span><span class="op" id="3953500">,</span>&nbsp;<span class="num" id="3953502">0x4b</span><span class="op" id="3953506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953509">0xd1</span><span class="op" id="3953513">,</span>&nbsp;<span class="num" id="3953515">0x6f</span><span class="op" id="3953519">,</span>&nbsp;<span class="num" id="3953521">0xdb</span><span class="op" id="3953525">,</span>&nbsp;<span class="num" id="3953527">0xd4</span><span class="op" id="3953531">,</span>&nbsp;<span class="num" id="3953533">0xdd</span><span class="op" id="3953537">,</span>&nbsp;<span class="num" id="3953539">0xfc</span><span class="op" id="3953543">,</span>&nbsp;<span class="num" id="3953545">0xaf</span><span class="op" id="3953549">,</span>&nbsp;<span class="num" id="3953551">0x5e</span><span class="op" id="3953555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953558">0x6c</span><span class="op" id="3953562">,</span>&nbsp;<span class="num" id="3953564">0x78</span><span class="op" id="3953568">,</span>&nbsp;<span class="num" id="3953570">0x90</span><span class="op" id="3953574">,</span>&nbsp;<span class="num" id="3953576">0x95</span><span class="op" id="3953580">,</span>&nbsp;<span class="num" id="3953582">0xde</span><span class="op" id="3953586">,</span>&nbsp;<span class="num" id="3953588">0xca</span><span class="op" id="3953592">,</span>&nbsp;<span class="num" id="3953594">0x3a</span><span class="op" id="3953598">,</span>&nbsp;<span class="num" id="3953600">0x48</span><span class="op" id="3953604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953607">0xb9</span><span class="op" id="3953611">,</span>&nbsp;<span class="num" id="3953613">0x79</span><span class="op" id="3953617">,</span>&nbsp;<span class="num" id="3953619">0x3c</span><span class="op" id="3953623">,</span>&nbsp;<span class="num" id="3953625">0x9b</span><span class="op" id="3953629">,</span>&nbsp;<span class="num" id="3953631">0x19</span><span class="op" id="3953635">,</span>&nbsp;<span class="num" id="3953637">0xd6</span><span class="op" id="3953641">,</span>&nbsp;<span class="num" id="3953643">0x75</span><span class="op" id="3953647">,</span>&nbsp;<span class="num" id="3953649">0x05</span><span class="op" id="3953653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953656">0xa0</span><span class="op" id="3953660">,</span>&nbsp;<span class="num" id="3953662">0xf9</span><span class="op" id="3953666">,</span>&nbsp;<span class="num" id="3953668">0x88</span><span class="op" id="3953672">,</span>&nbsp;<span class="num" id="3953674">0xd7</span><span class="op" id="3953678">,</span>&nbsp;<span class="num" id="3953680">0xc1</span><span class="op" id="3953684">,</span>&nbsp;<span class="num" id="3953686">0xe8</span><span class="op" id="3953690">,</span>&nbsp;<span class="num" id="3953692">0xa5</span><span class="op" id="3953696">,</span>&nbsp;<span class="num" id="3953698">0x09</span><span class="op" id="3953702">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953705">0xe4</span><span class="op" id="3953709">,</span>&nbsp;<span class="num" id="3953711">0x1a</span><span class="op" id="3953715">,</span>&nbsp;<span class="num" id="3953717">0x15</span><span class="op" id="3953721">,</span>&nbsp;<span class="num" id="3953723">0xdc</span><span class="op" id="3953727">,</span>&nbsp;<span class="num" id="3953729">0x87</span><span class="op" id="3953733">,</span>&nbsp;<span class="num" id="3953735">0x23</span><span class="op" id="3953739">,</span>&nbsp;<span class="num" id="3953741">0xaa</span><span class="op" id="3953745">,</span>&nbsp;<span class="num" id="3953747">0xb2</span><span class="op" id="3953751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953754">0x75</span><span class="op" id="3953758">,</span>&nbsp;<span class="num" id="3953760">0x8c</span><span class="op" id="3953764">,</span>&nbsp;<span class="num" id="3953766">0x63</span><span class="op" id="3953770">,</span>&nbsp;<span class="num" id="3953772">0x25</span><span class="op" id="3953776">,</span>&nbsp;<span class="num" id="3953778">0x87</span><span class="op" id="3953782">,</span>&nbsp;<span class="num" id="3953784">0xd8</span><span class="op" id="3953788">,</span>&nbsp;<span class="num" id="3953790">0xf8</span><span class="op" id="3953794">,</span>&nbsp;<span class="num" id="3953796">0x3d</span><span class="op" id="3953800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953803">0xa6</span><span class="op" id="3953807">,</span>&nbsp;<span class="num" id="3953809">0xc2</span><span class="op" id="3953813">,</span>&nbsp;<span class="num" id="3953815">0xcc</span><span class="op" id="3953819">,</span>&nbsp;<span class="num" id="3953821">0x66</span><span class="op" id="3953825">,</span>&nbsp;<span class="num" id="3953827">0xff</span><span class="op" id="3953831">,</span>&nbsp;<span class="num" id="3953833">0xa5</span><span class="op" id="3953837">,</span>&nbsp;<span class="num" id="3953839">0x66</span><span class="op" id="3953843">,</span>&nbsp;<span class="num" id="3953845">0x68</span><span class="op" id="3953849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3953852">0x55</span><span class="op" id="3953856">,</span>&nbsp;<span class="num" id="3953858">0x02</span><span class="op" id="3953862">,</span>&nbsp;<span class="num" id="3953864">0x03</span><span class="op" id="3953868">,</span>&nbsp;<span class="num" id="3953870">0x01</span><span class="op" id="3953874">,</span>&nbsp;<span class="num" id="3953876">0x00</span><span class="op" id="3953880">,</span>&nbsp;<span class="num" id="3953882">0x01</span><span class="op" id="3953886">,</span><br>
<span class="lineno"></span><span class="op" id="3953888">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="3953891">//&nbsp;CheckSignatureFrom&nbsp;verifies&nbsp;that&nbsp;the&nbsp;signature&nbsp;on&nbsp;c&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature</span><br>
<span class="lineno"></span><span class="comment" id="3953967">//&nbsp;from&nbsp;parent.</span><br>
<span class="lineno"></span><span class="keyword" id="3953983">func</span>&nbsp;<span class="op" id="3953988">(</span><span class="ident" id="3953989">c</span>&nbsp;<span class="op" id="3953991">*</span><span class="ident" id="3953992">Certificate</span><span class="op" id="3954003">)</span>&nbsp;<span class="ident" id="3954005">CheckSignatureFrom</span><span class="op" id="3954023">(</span><span class="ident" id="3954024">parent</span>&nbsp;<span class="op" id="3954031">*</span><span class="ident" id="3954032">Certificate</span><span class="op" id="3954043">)</span>&nbsp;<span class="op" id="3954045">(</span><span class="ident" id="3954046">err</span>&nbsp;<span class="builtintype" id="3954050">error</span><span class="op" id="3954055">)</span>&nbsp;<span class="op" id="3954057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3954060">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9:</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3954083">//&nbsp;&#34;If&nbsp;the&nbsp;basic&nbsp;constraints&nbsp;extension&nbsp;is&nbsp;not&nbsp;present&nbsp;in&nbsp;a&nbsp;version&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3954153">//&nbsp;certificate,&nbsp;or&nbsp;the&nbsp;extension&nbsp;is&nbsp;present&nbsp;but&nbsp;the&nbsp;cA&nbsp;boolean&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3954224">//&nbsp;asserted,&nbsp;then&nbsp;the&nbsp;certified&nbsp;public&nbsp;key&nbsp;MUST&nbsp;NOT&nbsp;be&nbsp;used&nbsp;to&nbsp;verify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3954295">//&nbsp;certificate&nbsp;signatures.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3954324">//&nbsp;(except&nbsp;for&nbsp;Entrust,&nbsp;see&nbsp;comment&nbsp;above&nbsp;entrustBrokenSPKI)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954386">if</span>&nbsp;<span class="op" id="3954389">(</span><span class="ident" id="3954390">parent</span><span class="op" id="3954396">.</span><span class="ident" id="3954397">Version</span>&nbsp;<span class="op" id="3954405">==</span>&nbsp;<span class="num" id="3954408">3</span>&nbsp;<span class="op" id="3954410">&amp;&amp;</span>&nbsp;<span class="op" id="3954413">!</span><span class="ident" id="3954414">parent</span><span class="op" id="3954420">.</span><span class="ident" id="3954421">BasicConstraintsValid</span>&nbsp;<span class="op" id="3954443">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3954448">parent</span><span class="op" id="3954454">.</span><span class="ident" id="3954455">BasicConstraintsValid</span>&nbsp;<span class="op" id="3954477">&amp;&amp;</span>&nbsp;<span class="op" id="3954480">!</span><span class="ident" id="3954481">parent</span><span class="op" id="3954487">.</span><span class="ident" id="3954488">IsCA</span><span class="op" id="3954492">)</span>&nbsp;<span class="op" id="3954494">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954499">!</span><span class="ident" id="3954500">bytes</span><span class="op" id="3954505">.</span><span class="ident" id="3954506">Equal</span><span class="op" id="3954511">(</span><span class="ident" id="3954512">c</span><span class="op" id="3954513">.</span><span class="ident" id="3954514">RawSubjectPublicKeyInfo</span><span class="op" id="3954537">,</span>&nbsp;<span class="ident" id="3954539">entrustBrokenSPKI</span><span class="op" id="3954556">)</span>&nbsp;<span class="op" id="3954558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954562">return</span>&nbsp;<span class="ident" id="3954569">ConstraintViolationError</span><span class="op" id="3954593">{</span><span class="op" id="3954594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954597">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954601">if</span>&nbsp;<span class="ident" id="3954604">parent</span><span class="op" id="3954610">.</span><span class="ident" id="3954611">KeyUsage</span>&nbsp;<span class="op" id="3954620">!=</span>&nbsp;<span class="num" id="3954623">0</span>&nbsp;<span class="op" id="3954625">&amp;&amp;</span>&nbsp;<span class="ident" id="3954628">parent</span><span class="op" id="3954634">.</span><span class="ident" id="3954635">KeyUsage</span><span class="op" id="3954643">&amp;</span><span class="ident" id="3954644">KeyUsageCertSign</span>&nbsp;<span class="op" id="3954661">==</span>&nbsp;<span class="num" id="3954664">0</span>&nbsp;<span class="op" id="3954666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954670">return</span>&nbsp;<span class="ident" id="3954677">ConstraintViolationError</span><span class="op" id="3954701">{</span><span class="op" id="3954702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954709">if</span>&nbsp;<span class="ident" id="3954712">parent</span><span class="op" id="3954718">.</span><span class="ident" id="3954719">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3954738">==</span>&nbsp;<span class="ident" id="3954741">UnknownPublicKeyAlgorithm</span>&nbsp;<span class="op" id="3954767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954771">return</span>&nbsp;<span class="ident" id="3954778">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3954803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3954807">//&nbsp;TODO(agl):&nbsp;don&#39;t&nbsp;ignore&nbsp;the&nbsp;path&nbsp;length&nbsp;constraint.</span><br>
<span class="lineno">615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3954864">return</span>&nbsp;<span class="ident" id="3954871">parent</span><span class="op" id="3954877">.</span><span class="ident" id="3954878">CheckSignature</span><span class="op" id="3954892">(</span><span class="ident" id="3954893">c</span><span class="op" id="3954894">.</span><span class="ident" id="3954895">SignatureAlgorithm</span><span class="op" id="3954913">,</span>&nbsp;<span class="ident" id="3954915">c</span><span class="op" id="3954916">.</span><span class="ident" id="3954917">RawTBSCertificate</span><span class="op" id="3954934">,</span>&nbsp;<span class="ident" id="3954936">c</span><span class="op" id="3954937">.</span><span class="ident" id="3954938">Signature</span><span class="op" id="3954947">)</span><br>
<span class="lineno"></span><span class="op" id="3954949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3954952">//&nbsp;CheckSignature&nbsp;verifies&nbsp;that&nbsp;signature&nbsp;is&nbsp;a&nbsp;valid&nbsp;signature&nbsp;over&nbsp;signed&nbsp;from</span><br>
<span class="lineno">620</span><span class="comment" id="3955032">//&nbsp;c&#39;s&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3955051">func</span>&nbsp;<span class="op" id="3955056">(</span><span class="ident" id="3955057">c</span>&nbsp;<span class="op" id="3955059">*</span><span class="ident" id="3955060">Certificate</span><span class="op" id="3955071">)</span>&nbsp;<span class="ident" id="3955073">CheckSignature</span><span class="op" id="3955087">(</span><span class="ident" id="3955088">algo</span>&nbsp;<span class="ident" id="3955093">SignatureAlgorithm</span><span class="op" id="3955111">,</span>&nbsp;<span class="ident" id="3955113">signed</span><span class="op" id="3955119">,</span>&nbsp;<span class="ident" id="3955121">signature</span>&nbsp;<span class="op" id="3955131">[</span><span class="op" id="3955132">]</span><span class="builtintype" id="3955133">byte</span><span class="op" id="3955137">)</span>&nbsp;<span class="op" id="3955139">(</span><span class="ident" id="3955140">err</span>&nbsp;<span class="builtintype" id="3955144">error</span><span class="op" id="3955149">)</span>&nbsp;<span class="op" id="3955151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955154">var</span>&nbsp;<span class="ident" id="3955158">hashType</span>&nbsp;<span class="ident" id="3955167">crypto</span><span class="op" id="3955173">.</span><span class="ident" id="3955174">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955181">switch</span>&nbsp;<span class="ident" id="3955188">algo</span>&nbsp;<span class="op" id="3955193">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955196">case</span>&nbsp;<span class="ident" id="3955201">SHA1WithRSA</span><span class="op" id="3955212">,</span>&nbsp;<span class="ident" id="3955214">DSAWithSHA1</span><span class="op" id="3955225">,</span>&nbsp;<span class="ident" id="3955227">ECDSAWithSHA1</span><span class="op" id="3955240">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955244">hashType</span>&nbsp;<span class="op" id="3955253">=</span>&nbsp;<span class="ident" id="3955255">crypto</span><span class="op" id="3955261">.</span><span class="ident" id="3955262">SHA1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955268">case</span>&nbsp;<span class="ident" id="3955273">SHA256WithRSA</span><span class="op" id="3955286">,</span>&nbsp;<span class="ident" id="3955288">DSAWithSHA256</span><span class="op" id="3955301">,</span>&nbsp;<span class="ident" id="3955303">ECDSAWithSHA256</span><span class="op" id="3955318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955322">hashType</span>&nbsp;<span class="op" id="3955331">=</span>&nbsp;<span class="ident" id="3955333">crypto</span><span class="op" id="3955339">.</span><span class="ident" id="3955340">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955348">case</span>&nbsp;<span class="ident" id="3955353">SHA384WithRSA</span><span class="op" id="3955366">,</span>&nbsp;<span class="ident" id="3955368">ECDSAWithSHA384</span><span class="op" id="3955383">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955387">hashType</span>&nbsp;<span class="op" id="3955396">=</span>&nbsp;<span class="ident" id="3955398">crypto</span><span class="op" id="3955404">.</span><span class="ident" id="3955405">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955413">case</span>&nbsp;<span class="ident" id="3955418">SHA512WithRSA</span><span class="op" id="3955431">,</span>&nbsp;<span class="ident" id="3955433">ECDSAWithSHA512</span><span class="op" id="3955448">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955452">hashType</span>&nbsp;<span class="op" id="3955461">=</span>&nbsp;<span class="ident" id="3955463">crypto</span><span class="op" id="3955469">.</span><span class="ident" id="3955470">SHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955478">default</span><span class="op" id="3955485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955489">return</span>&nbsp;<span class="ident" id="3955496">ErrUnsupportedAlgorithm</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3955521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955525">if</span>&nbsp;<span class="op" id="3955528">!</span><span class="ident" id="3955529">hashType</span><span class="op" id="3955537">.</span><span class="ident" id="3955538">Available</span><span class="op" id="3955547">(</span><span class="op" id="3955548">)</span>&nbsp;<span class="op" id="3955550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955554">return</span>&nbsp;<span class="ident" id="3955561">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3955586">}</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955589">h</span>&nbsp;<span class="op" id="3955591">:=</span>&nbsp;<span class="ident" id="3955594">hashType</span><span class="op" id="3955602">.</span><span class="ident" id="3955603">New</span><span class="op" id="3955606">(</span><span class="op" id="3955607">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955611">h</span><span class="op" id="3955612">.</span><span class="ident" id="3955613">Write</span><span class="op" id="3955618">(</span><span class="ident" id="3955619">signed</span><span class="op" id="3955625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955628">digest</span>&nbsp;<span class="op" id="3955635">:=</span>&nbsp;<span class="ident" id="3955638">h</span><span class="op" id="3955639">.</span><span class="ident" id="3955640">Sum</span><span class="op" id="3955643">(</span><span class="builtintype" id="3955644">nil</span><span class="op" id="3955647">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955651">switch</span>&nbsp;<span class="ident" id="3955658">pub</span>&nbsp;<span class="op" id="3955662">:=</span>&nbsp;<span class="ident" id="3955665">c</span><span class="op" id="3955666">.</span><span class="ident" id="3955667">PublicKey</span><span class="op" id="3955676">.</span><span class="op" id="3955677">(</span><span class="keyword" id="3955678">type</span><span class="op" id="3955682">)</span>&nbsp;<span class="op" id="3955684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955687">case</span>&nbsp;<span class="op" id="3955692">*</span><span class="ident" id="3955693">rsa</span><span class="op" id="3955696">.</span><span class="ident" id="3955697">PublicKey</span><span class="op" id="3955706">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955710">return</span>&nbsp;<span class="ident" id="3955717">rsa</span><span class="op" id="3955720">.</span><span class="ident" id="3955721">VerifyPKCS1v15</span><span class="op" id="3955735">(</span><span class="ident" id="3955736">pub</span><span class="op" id="3955739">,</span>&nbsp;<span class="ident" id="3955741">hashType</span><span class="op" id="3955749">,</span>&nbsp;<span class="ident" id="3955751">digest</span><span class="op" id="3955757">,</span>&nbsp;<span class="ident" id="3955759">signature</span><span class="op" id="3955768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955771">case</span>&nbsp;<span class="op" id="3955776">*</span><span class="ident" id="3955777">dsa</span><span class="op" id="3955780">.</span><span class="ident" id="3955781">PublicKey</span><span class="op" id="3955790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3955794">dsaSig</span>&nbsp;<span class="op" id="3955801">:=</span>&nbsp;<span class="builtinfunc" id="3955804">new</span><span class="op" id="3955807">(</span><span class="ident" id="3955808">dsaSignature</span><span class="op" id="3955820">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955824">if</span>&nbsp;<span class="ident" id="3955827">_</span><span class="op" id="3955828">,</span>&nbsp;<span class="ident" id="3955830">err</span>&nbsp;<span class="op" id="3955834">:=</span>&nbsp;<span class="ident" id="3955837">asn1</span><span class="op" id="3955841">.</span><span class="ident" id="3955842">Unmarshal</span><span class="op" id="3955851">(</span><span class="ident" id="3955852">signature</span><span class="op" id="3955861">,</span>&nbsp;<span class="ident" id="3955863">dsaSig</span><span class="op" id="3955869">)</span><span class="op" id="3955870">;</span>&nbsp;<span class="ident" id="3955872">err</span>&nbsp;<span class="op" id="3955876">!=</span>&nbsp;<span class="builtintype" id="3955879">nil</span>&nbsp;<span class="op" id="3955883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955888">return</span>&nbsp;<span class="ident" id="3955895">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3955901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955905">if</span>&nbsp;<span class="ident" id="3955908">dsaSig</span><span class="op" id="3955914">.</span><span class="ident" id="3955915">R</span><span class="op" id="3955916">.</span><span class="ident" id="3955917">Sign</span><span class="op" id="3955921">(</span><span class="op" id="3955922">)</span>&nbsp;<span class="op" id="3955924">&lt;=</span>&nbsp;<span class="num" id="3955927">0</span>&nbsp;<span class="op" id="3955929">||</span>&nbsp;<span class="ident" id="3955932">dsaSig</span><span class="op" id="3955938">.</span><span class="ident" id="3955939">S</span><span class="op" id="3955940">.</span><span class="ident" id="3955941">Sign</span><span class="op" id="3955945">(</span><span class="op" id="3955946">)</span>&nbsp;<span class="op" id="3955948">&lt;=</span>&nbsp;<span class="num" id="3955951">0</span>&nbsp;<span class="op" id="3955953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3955958">return</span>&nbsp;<span class="ident" id="3955965">errors</span><span class="op" id="3955971">.</span><span class="ident" id="3955972">New</span><span class="op" id="3955975">(</span><span class="string" id="3955976">&#34;x509:&nbsp;DSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="3956031">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956039">if</span>&nbsp;<span class="op" id="3956042">!</span><span class="ident" id="3956043">dsa</span><span class="op" id="3956046">.</span><span class="ident" id="3956047">Verify</span><span class="op" id="3956053">(</span><span class="ident" id="3956054">pub</span><span class="op" id="3956057">,</span>&nbsp;<span class="ident" id="3956059">digest</span><span class="op" id="3956065">,</span>&nbsp;<span class="ident" id="3956067">dsaSig</span><span class="op" id="3956073">.</span><span class="ident" id="3956074">R</span><span class="op" id="3956075">,</span>&nbsp;<span class="ident" id="3956077">dsaSig</span><span class="op" id="3956083">.</span><span class="ident" id="3956084">S</span><span class="op" id="3956085">)</span>&nbsp;<span class="op" id="3956087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956092">return</span>&nbsp;<span class="ident" id="3956099">errors</span><span class="op" id="3956105">.</span><span class="ident" id="3956106">New</span><span class="op" id="3956109">(</span><span class="string" id="3956110">&#34;x509:&nbsp;DSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="3956142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956150">return</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956158">case</span>&nbsp;<span class="op" id="3956163">*</span><span class="ident" id="3956164">ecdsa</span><span class="op" id="3956169">.</span><span class="ident" id="3956170">PublicKey</span><span class="op" id="3956179">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956183">ecdsaSig</span>&nbsp;<span class="op" id="3956192">:=</span>&nbsp;<span class="builtinfunc" id="3956195">new</span><span class="op" id="3956198">(</span><span class="ident" id="3956199">ecdsaSignature</span><span class="op" id="3956213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956217">if</span>&nbsp;<span class="ident" id="3956220">_</span><span class="op" id="3956221">,</span>&nbsp;<span class="ident" id="3956223">err</span>&nbsp;<span class="op" id="3956227">:=</span>&nbsp;<span class="ident" id="3956230">asn1</span><span class="op" id="3956234">.</span><span class="ident" id="3956235">Unmarshal</span><span class="op" id="3956244">(</span><span class="ident" id="3956245">signature</span><span class="op" id="3956254">,</span>&nbsp;<span class="ident" id="3956256">ecdsaSig</span><span class="op" id="3956264">)</span><span class="op" id="3956265">;</span>&nbsp;<span class="ident" id="3956267">err</span>&nbsp;<span class="op" id="3956271">!=</span>&nbsp;<span class="builtintype" id="3956274">nil</span>&nbsp;<span class="op" id="3956278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956283">return</span>&nbsp;<span class="ident" id="3956290">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956296">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956300">if</span>&nbsp;<span class="ident" id="3956303">ecdsaSig</span><span class="op" id="3956311">.</span><span class="ident" id="3956312">R</span><span class="op" id="3956313">.</span><span class="ident" id="3956314">Sign</span><span class="op" id="3956318">(</span><span class="op" id="3956319">)</span>&nbsp;<span class="op" id="3956321">&lt;=</span>&nbsp;<span class="num" id="3956324">0</span>&nbsp;<span class="op" id="3956326">||</span>&nbsp;<span class="ident" id="3956329">ecdsaSig</span><span class="op" id="3956337">.</span><span class="ident" id="3956338">S</span><span class="op" id="3956339">.</span><span class="ident" id="3956340">Sign</span><span class="op" id="3956344">(</span><span class="op" id="3956345">)</span>&nbsp;<span class="op" id="3956347">&lt;=</span>&nbsp;<span class="num" id="3956350">0</span>&nbsp;<span class="op" id="3956352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956357">return</span>&nbsp;<span class="ident" id="3956364">errors</span><span class="op" id="3956370">.</span><span class="ident" id="3956371">New</span><span class="op" id="3956374">(</span><span class="string" id="3956375">&#34;x509:&nbsp;ECDSA&nbsp;signature&nbsp;contained&nbsp;zero&nbsp;or&nbsp;negative&nbsp;values&#34;</span><span class="op" id="3956432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956440">if</span>&nbsp;<span class="op" id="3956443">!</span><span class="ident" id="3956444">ecdsa</span><span class="op" id="3956449">.</span><span class="ident" id="3956450">Verify</span><span class="op" id="3956456">(</span><span class="ident" id="3956457">pub</span><span class="op" id="3956460">,</span>&nbsp;<span class="ident" id="3956462">digest</span><span class="op" id="3956468">,</span>&nbsp;<span class="ident" id="3956470">ecdsaSig</span><span class="op" id="3956478">.</span><span class="ident" id="3956479">R</span><span class="op" id="3956480">,</span>&nbsp;<span class="ident" id="3956482">ecdsaSig</span><span class="op" id="3956490">.</span><span class="ident" id="3956491">S</span><span class="op" id="3956492">)</span>&nbsp;<span class="op" id="3956494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956499">return</span>&nbsp;<span class="ident" id="3956506">errors</span><span class="op" id="3956512">.</span><span class="ident" id="3956513">New</span><span class="op" id="3956516">(</span><span class="string" id="3956517">&#34;x509:&nbsp;ECDSA&nbsp;verification&nbsp;failure&#34;</span><span class="op" id="3956551">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956559">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3956567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956570">return</span>&nbsp;<span class="ident" id="3956577">ErrUnsupportedAlgorithm</span><br>
<span class="lineno"></span><span class="op" id="3956601">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span><span class="comment" id="3956604">//&nbsp;CheckCRLSignature&nbsp;checks&nbsp;that&nbsp;the&nbsp;signature&nbsp;in&nbsp;crl&nbsp;is&nbsp;from&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3956669">func</span>&nbsp;<span class="op" id="3956674">(</span><span class="ident" id="3956675">c</span>&nbsp;<span class="op" id="3956677">*</span><span class="ident" id="3956678">Certificate</span><span class="op" id="3956689">)</span>&nbsp;<span class="ident" id="3956691">CheckCRLSignature</span><span class="op" id="3956708">(</span><span class="ident" id="3956709">crl</span>&nbsp;<span class="op" id="3956713">*</span><span class="ident" id="3956714">pkix</span><span class="op" id="3956718">.</span><span class="ident" id="3956719">CertificateList</span><span class="op" id="3956734">)</span>&nbsp;<span class="op" id="3956736">(</span><span class="ident" id="3956737">err</span>&nbsp;<span class="builtintype" id="3956741">error</span><span class="op" id="3956746">)</span>&nbsp;<span class="op" id="3956748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3956751">algo</span>&nbsp;<span class="op" id="3956756">:=</span>&nbsp;<span class="ident" id="3956759">getSignatureAlgorithmFromOID</span><span class="op" id="3956787">(</span><span class="ident" id="3956788">crl</span><span class="op" id="3956791">.</span><span class="ident" id="3956792">SignatureAlgorithm</span><span class="op" id="3956810">.</span><span class="ident" id="3956811">Algorithm</span><span class="op" id="3956820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3956823">return</span>&nbsp;<span class="ident" id="3956830">c</span><span class="op" id="3956831">.</span><span class="ident" id="3956832">CheckSignature</span><span class="op" id="3956846">(</span><span class="ident" id="3956847">algo</span><span class="op" id="3956851">,</span>&nbsp;<span class="ident" id="3956853">crl</span><span class="op" id="3956856">.</span><span class="ident" id="3956857">TBSCertList</span><span class="op" id="3956868">.</span><span class="ident" id="3956869">Raw</span><span class="op" id="3956872">,</span>&nbsp;<span class="ident" id="3956874">crl</span><span class="op" id="3956877">.</span><span class="ident" id="3956878">SignatureValue</span><span class="op" id="3956892">.</span><span class="ident" id="3956893">RightAlign</span><span class="op" id="3956903">(</span><span class="op" id="3956904">)</span><span class="op" id="3956905">)</span><br>
<span class="lineno">680</span><span class="op" id="3956907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3956910">type</span>&nbsp;<span class="ident" id="3956915">UnhandledCriticalExtension</span>&nbsp;<span class="keyword" id="3956942">struct</span><span class="op" id="3956948">{</span><span class="op" id="3956949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3956952">func</span>&nbsp;<span class="op" id="3956957">(</span><span class="ident" id="3956958">h</span>&nbsp;<span class="ident" id="3956960">UnhandledCriticalExtension</span><span class="op" id="3956986">)</span>&nbsp;<span class="ident" id="3956988">Error</span><span class="op" id="3956993">(</span><span class="op" id="3956994">)</span>&nbsp;<span class="builtintype" id="3956996">string</span>&nbsp;<span class="op" id="3957003">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3957006">return</span>&nbsp;<span class="string" id="3957013">&#34;x509:&nbsp;unhandled&nbsp;critical&nbsp;extension&#34;</span><br>
<span class="lineno"></span><span class="op" id="3957050">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3957053">type</span>&nbsp;<span class="ident" id="3957058">basicConstraints</span>&nbsp;<span class="keyword" id="3957075">struct</span>&nbsp;<span class="op" id="3957082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957085">IsCA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3957096">bool</span>&nbsp;<span class="string" id="3957101">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957120">MaxPathLen</span>&nbsp;<span class="builtintype" id="3957131">int</span>&nbsp;&nbsp;<span class="string" id="3957136">`asn1:&#34;optional,default:-1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3957165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3957168">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4</span><br>
<span class="lineno"></span><span class="keyword" id="3957188">type</span>&nbsp;<span class="ident" id="3957193">policyInformation</span>&nbsp;<span class="keyword" id="3957211">struct</span>&nbsp;<span class="op" id="3957218">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957221">Policy</span>&nbsp;<span class="ident" id="3957228">asn1</span><span class="op" id="3957232">.</span><span class="ident" id="3957233">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3957251">//&nbsp;policyQualifiers&nbsp;omitted</span><br>
<span class="lineno"></span><span class="op" id="3957279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3957282">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno">700</span><span class="keyword" id="3957304">type</span>&nbsp;<span class="ident" id="3957309">nameConstraints</span>&nbsp;<span class="keyword" id="3957325">struct</span>&nbsp;<span class="op" id="3957332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957335">Permitted</span>&nbsp;<span class="op" id="3957345">[</span><span class="op" id="3957346">]</span><span class="ident" id="3957347">generalSubtree</span>&nbsp;<span class="string" id="3957362">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957387">Excluded</span>&nbsp;&nbsp;<span class="op" id="3957397">[</span><span class="op" id="3957398">]</span><span class="ident" id="3957399">generalSubtree</span>&nbsp;<span class="string" id="3957414">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3957438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="keyword" id="3957441">type</span>&nbsp;<span class="ident" id="3957446">generalSubtree</span>&nbsp;<span class="keyword" id="3957461">struct</span>&nbsp;<span class="op" id="3957468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957471">Name</span>&nbsp;<span class="builtintype" id="3957476">string</span>&nbsp;<span class="string" id="3957483">`asn1:&#34;tag:2,optional,ia5&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3957511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3957514">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.2.1</span><br>
<span class="lineno">710</span><span class="keyword" id="3957535">type</span>&nbsp;<span class="ident" id="3957540">authorityInfoAccess</span>&nbsp;<span class="keyword" id="3957560">struct</span>&nbsp;<span class="op" id="3957567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957570">Method</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3957579">asn1</span><span class="op" id="3957583">.</span><span class="ident" id="3957584">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957602">Location</span>&nbsp;<span class="ident" id="3957611">asn1</span><span class="op" id="3957615">.</span><span class="ident" id="3957616">RawValue</span><br>
<span class="lineno"></span><span class="op" id="3957625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="3957628">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno"></span><span class="keyword" id="3957650">type</span>&nbsp;<span class="ident" id="3957655">distributionPoint</span>&nbsp;<span class="keyword" id="3957673">struct</span>&nbsp;<span class="op" id="3957680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957683">DistributionPoint</span>&nbsp;<span class="ident" id="3957701">distributionPointName</span>&nbsp;<span class="string" id="3957723">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957748">Reason</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957766">asn1</span><span class="op" id="3957770">.</span><span class="ident" id="3957771">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3957788">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957813">CRLIssuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957831">asn1</span><span class="op" id="3957835">.</span><span class="ident" id="3957836">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3957853">`asn1:&#34;optional,tag:2&#34;`</span><br>
<span class="lineno">720</span><span class="op" id="3957877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3957880">type</span>&nbsp;<span class="ident" id="3957885">distributionPointName</span>&nbsp;<span class="keyword" id="3957907">struct</span>&nbsp;<span class="op" id="3957914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957917">FullName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957930">asn1</span><span class="op" id="3957934">.</span><span class="ident" id="3957935">RawValue</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3957947">`asn1:&#34;optional,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3957972">RelativeName</span>&nbsp;<span class="ident" id="3957985">pkix</span><span class="op" id="3957989">.</span><span class="ident" id="3957990">RDNSequence</span>&nbsp;<span class="string" id="3958002">`asn1:&#34;optional,tag:1&#34;`</span><br>
<span class="lineno">725</span><span class="op" id="3958026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3958029">func</span>&nbsp;<span class="ident" id="3958034">parsePublicKey</span><span class="op" id="3958048">(</span><span class="ident" id="3958049">algo</span>&nbsp;<span class="ident" id="3958054">PublicKeyAlgorithm</span><span class="op" id="3958072">,</span>&nbsp;<span class="ident" id="3958074">keyData</span>&nbsp;<span class="op" id="3958082">*</span><span class="ident" id="3958083">publicKeyInfo</span><span class="op" id="3958096">)</span>&nbsp;<span class="op" id="3958098">(</span><span class="keyword" id="3958099">interface</span><span class="op" id="3958108">{</span><span class="op" id="3958109">}</span><span class="op" id="3958110">,</span>&nbsp;<span class="builtintype" id="3958112">error</span><span class="op" id="3958117">)</span>&nbsp;<span class="op" id="3958119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3958122">asn1Data</span>&nbsp;<span class="op" id="3958131">:=</span>&nbsp;<span class="ident" id="3958134">keyData</span><span class="op" id="3958141">.</span><span class="ident" id="3958142">PublicKey</span><span class="op" id="3958151">.</span><span class="ident" id="3958152">RightAlign</span><span class="op" id="3958162">(</span><span class="op" id="3958163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958166">switch</span>&nbsp;<span class="ident" id="3958173">algo</span>&nbsp;<span class="op" id="3958178">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958181">case</span>&nbsp;<span class="ident" id="3958186">RSA</span><span class="op" id="3958189">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3958193">p</span>&nbsp;<span class="op" id="3958195">:=</span>&nbsp;<span class="builtinfunc" id="3958198">new</span><span class="op" id="3958201">(</span><span class="ident" id="3958202">rsaPublicKey</span><span class="op" id="3958214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3958218">_</span><span class="op" id="3958219">,</span>&nbsp;<span class="ident" id="3958221">err</span>&nbsp;<span class="op" id="3958225">:=</span>&nbsp;<span class="ident" id="3958228">asn1</span><span class="op" id="3958232">.</span><span class="ident" id="3958233">Unmarshal</span><span class="op" id="3958242">(</span><span class="ident" id="3958243">asn1Data</span><span class="op" id="3958251">,</span>&nbsp;<span class="ident" id="3958253">p</span><span class="op" id="3958254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958258">if</span>&nbsp;<span class="ident" id="3958261">err</span>&nbsp;<span class="op" id="3958265">!=</span>&nbsp;<span class="builtintype" id="3958268">nil</span>&nbsp;<span class="op" id="3958272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958277">return</span>&nbsp;<span class="builtintype" id="3958284">nil</span><span class="op" id="3958287">,</span>&nbsp;<span class="ident" id="3958289">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958300">if</span>&nbsp;<span class="ident" id="3958303">p</span><span class="op" id="3958304">.</span><span class="ident" id="3958305">N</span><span class="op" id="3958306">.</span><span class="ident" id="3958307">Sign</span><span class="op" id="3958311">(</span><span class="op" id="3958312">)</span>&nbsp;<span class="op" id="3958314">&lt;=</span>&nbsp;<span class="num" id="3958317">0</span>&nbsp;<span class="op" id="3958319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958324">return</span>&nbsp;<span class="builtintype" id="3958331">nil</span><span class="op" id="3958334">,</span>&nbsp;<span class="ident" id="3958336">errors</span><span class="op" id="3958342">.</span><span class="ident" id="3958343">New</span><span class="op" id="3958346">(</span><span class="string" id="3958347">&#34;x509:&nbsp;RSA&nbsp;modulus&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="3958391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958395">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958399">if</span>&nbsp;<span class="ident" id="3958402">p</span><span class="op" id="3958403">.</span><span class="ident" id="3958404">E</span>&nbsp;<span class="op" id="3958406">&lt;=</span>&nbsp;<span class="num" id="3958409">0</span>&nbsp;<span class="op" id="3958411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958416">return</span>&nbsp;<span class="builtintype" id="3958423">nil</span><span class="op" id="3958426">,</span>&nbsp;<span class="ident" id="3958428">errors</span><span class="op" id="3958434">.</span><span class="ident" id="3958435">New</span><span class="op" id="3958438">(</span><span class="string" id="3958439">&#34;x509:&nbsp;RSA&nbsp;public&nbsp;exponent&nbsp;is&nbsp;not&nbsp;a&nbsp;positive&nbsp;number&#34;</span><span class="op" id="3958491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3958500">pub</span>&nbsp;<span class="op" id="3958504">:=</span>&nbsp;<span class="op" id="3958507">&amp;</span><span class="ident" id="3958508">rsa</span><span class="op" id="3958511">.</span><span class="ident" id="3958512">PublicKey</span><span class="op" id="3958521">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3958526">E</span><span class="op" id="3958527">:</span>&nbsp;<span class="ident" id="3958529">p</span><span class="op" id="3958530">.</span><span class="ident" id="3958531">E</span><span class="op" id="3958532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3958537">N</span><span class="op" id="3958538">:</span>&nbsp;<span class="ident" id="3958540">p</span><span class="op" id="3958541">.</span><span class="ident" id="3958542">N</span><span class="op" id="3958543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958551">return</span>&nbsp;<span class="ident" id="3958558">pub</span><span class="op" id="3958561">,</span>&nbsp;<span class="builtintype" id="3958563">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958568">case</span>&nbsp;<span class="ident" id="3958573">DSA</span><span class="op" id="3958576">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958580">var</span>&nbsp;<span class="ident" id="3958584">p</span>&nbsp;<span class="op" id="3958586">*</span><span class="ident" id="3958587">big</span><span class="op" id="3958590">.</span><span class="ident" id="3958591">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3958597">_</span><span class="op" id="3958598">,</span>&nbsp;<span class="ident" id="3958600">err</span>&nbsp;<span class="op" id="3958604">:=</span>&nbsp;<span class="ident" id="3958607">asn1</span><span class="op" id="3958611">.</span><span class="ident" id="3958612">Unmarshal</span><span class="op" id="3958621">(</span><span class="ident" id="3958622">asn1Data</span><span class="op" id="3958630">,</span>&nbsp;<span class="op" id="3958632">&amp;</span><span class="ident" id="3958633">p</span><span class="op" id="3958634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958638">if</span>&nbsp;<span class="ident" id="3958641">err</span>&nbsp;<span class="op" id="3958645">!=</span>&nbsp;<span class="builtintype" id="3958648">nil</span>&nbsp;<span class="op" id="3958652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958657">return</span>&nbsp;<span class="builtintype" id="3958664">nil</span><span class="op" id="3958667">,</span>&nbsp;<span class="ident" id="3958669">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958675">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3958679">paramsData</span>&nbsp;<span class="op" id="3958690">:=</span>&nbsp;<span class="ident" id="3958693">keyData</span><span class="op" id="3958700">.</span><span class="ident" id="3958701">Algorithm</span><span class="op" id="3958710">.</span><span class="ident" id="3958711">Parameters</span><span class="op" id="3958721">.</span><span class="ident" id="3958722">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3958734">params</span>&nbsp;<span class="op" id="3958741">:=</span>&nbsp;<span class="builtinfunc" id="3958744">new</span><span class="op" id="3958747">(</span><span class="ident" id="3958748">dsaAlgorithmParameters</span><span class="op" id="3958770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3958774">_</span><span class="op" id="3958775">,</span>&nbsp;<span class="ident" id="3958777">err</span>&nbsp;<span class="op" id="3958781">=</span>&nbsp;<span class="ident" id="3958783">asn1</span><span class="op" id="3958787">.</span><span class="ident" id="3958788">Unmarshal</span><span class="op" id="3958797">(</span><span class="ident" id="3958798">paramsData</span><span class="op" id="3958808">,</span>&nbsp;<span class="ident" id="3958810">params</span><span class="op" id="3958816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958820">if</span>&nbsp;<span class="ident" id="3958823">err</span>&nbsp;<span class="op" id="3958827">!=</span>&nbsp;<span class="builtintype" id="3958830">nil</span>&nbsp;<span class="op" id="3958834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958839">return</span>&nbsp;<span class="builtintype" id="3958846">nil</span><span class="op" id="3958849">,</span>&nbsp;<span class="ident" id="3958851">err</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3958857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958861">if</span>&nbsp;<span class="ident" id="3958864">p</span><span class="op" id="3958865">.</span><span class="ident" id="3958866">Sign</span><span class="op" id="3958870">(</span><span class="op" id="3958871">)</span>&nbsp;<span class="op" id="3958873">&lt;=</span>&nbsp;<span class="num" id="3958876">0</span>&nbsp;<span class="op" id="3958878">||</span>&nbsp;<span class="ident" id="3958881">params</span><span class="op" id="3958887">.</span><span class="ident" id="3958888">P</span><span class="op" id="3958889">.</span><span class="ident" id="3958890">Sign</span><span class="op" id="3958894">(</span><span class="op" id="3958895">)</span>&nbsp;<span class="op" id="3958897">&lt;=</span>&nbsp;<span class="num" id="3958900">0</span>&nbsp;<span class="op" id="3958902">||</span>&nbsp;<span class="ident" id="3958905">params</span><span class="op" id="3958911">.</span><span class="ident" id="3958912">Q</span><span class="op" id="3958913">.</span><span class="ident" id="3958914">Sign</span><span class="op" id="3958918">(</span><span class="op" id="3958919">)</span>&nbsp;<span class="op" id="3958921">&lt;=</span>&nbsp;<span class="num" id="3958924">0</span>&nbsp;<span class="op" id="3958926">||</span>&nbsp;<span class="ident" id="3958929">params</span><span class="op" id="3958935">.</span><span class="ident" id="3958936">G</span><span class="op" id="3958937">.</span><span class="ident" id="3958938">Sign</span><span class="op" id="3958942">(</span><span class="op" id="3958943">)</span>&nbsp;<span class="op" id="3958945">&lt;=</span>&nbsp;<span class="num" id="3958948">0</span>&nbsp;<span class="op" id="3958950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3958955">return</span>&nbsp;<span class="builtintype" id="3958962">nil</span><span class="op" id="3958965">,</span>&nbsp;<span class="ident" id="3958967">errors</span><span class="op" id="3958973">.</span><span class="ident" id="3958974">New</span><span class="op" id="3958977">(</span><span class="string" id="3958978">&#34;x509:&nbsp;zero&nbsp;or&nbsp;negative&nbsp;DSA&nbsp;parameter&#34;</span><span class="op" id="3959016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3959020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959024">pub</span>&nbsp;<span class="op" id="3959028">:=</span>&nbsp;<span class="op" id="3959031">&amp;</span><span class="ident" id="3959032">dsa</span><span class="op" id="3959035">.</span><span class="ident" id="3959036">PublicKey</span><span class="op" id="3959045">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959050">Parameters</span><span class="op" id="3959060">:</span>&nbsp;<span class="ident" id="3959062">dsa</span><span class="op" id="3959065">.</span><span class="ident" id="3959066">Parameters</span><span class="op" id="3959076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959082">P</span><span class="op" id="3959083">:</span>&nbsp;<span class="ident" id="3959085">params</span><span class="op" id="3959091">.</span><span class="ident" id="3959092">P</span><span class="op" id="3959093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959099">Q</span><span class="op" id="3959100">:</span>&nbsp;<span class="ident" id="3959102">params</span><span class="op" id="3959108">.</span><span class="ident" id="3959109">Q</span><span class="op" id="3959110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959116">G</span><span class="op" id="3959117">:</span>&nbsp;<span class="ident" id="3959119">params</span><span class="op" id="3959125">.</span><span class="ident" id="3959126">G</span><span class="op" id="3959127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3959132">}</span><span class="op" id="3959133">,</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959138">Y</span><span class="op" id="3959139">:</span>&nbsp;<span class="ident" id="3959141">p</span><span class="op" id="3959142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3959146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3959150">return</span>&nbsp;<span class="ident" id="3959157">pub</span><span class="op" id="3959160">,</span>&nbsp;<span class="builtintype" id="3959162">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3959167">case</span>&nbsp;<span class="ident" id="3959172">ECDSA</span><span class="op" id="3959177">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959181">paramsData</span>&nbsp;<span class="op" id="3959192">:=</span>&nbsp;<span class="ident" id="3959195">keyData</span><span class="op" id="3959202">.</span><span class="ident" id="3959203">Algorithm</span><span class="op" id="3959212">.</span><span class="ident" id="3959213">Parameters</span><span class="op" id="3959223">.</span><span class="ident" id="3959224">FullBytes</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959236">namedCurveOID</span>&nbsp;<span class="op" id="3959250">:=</span>&nbsp;<span class="builtinfunc" id="3959253">new</span><span class="op" id="3959256">(</span><span class="ident" id="3959257">asn1</span><span class="op" id="3959261">.</span><span class="ident" id="3959262">ObjectIdentifier</span><span class="op" id="3959278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959282">_</span><span class="op" id="3959283">,</span>&nbsp;<span class="ident" id="3959285">err</span>&nbsp;<span class="op" id="3959289">:=</span>&nbsp;<span class="ident" id="3959292">asn1</span><span class="op" id="3959296">.</span><span class="ident" id="3959297">Unmarshal</span><span class="op" id="3959306">(</span><span class="ident" id="3959307">paramsData</span><span class="op" id="3959317">,</span>&nbsp;<span class="ident" id="3959319">namedCurveOID</span><span class="op" id="3959332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3959336">if</span>&nbsp;<span class="ident" id="3959339">err</span>&nbsp;<span class="op" id="3959343">!=</span>&nbsp;<span class="builtintype" id="3959346">nil</span>&nbsp;<span class="op" id="3959350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3959355">return</span>&nbsp;<span class="builtintype" id="3959362">nil</span><span class="op" id="3959365">,</span>&nbsp;<span class="ident" id="3959367">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3959373">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959377">namedCurve</span>&nbsp;<span class="op" id="3959388">:=</span>&nbsp;<span class="ident" id="3959391">namedCurveFromOID</span><span class="op" id="3959408">(</span><span class="op" id="3959409">*</span><span class="ident" id="3959410">namedCurveOID</span><span class="op" id="3959423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3959427">if</span>&nbsp;<span class="ident" id="3959430">namedCurve</span>&nbsp;<span class="op" id="3959441">==</span>&nbsp;<span class="builtintype" id="3959444">nil</span>&nbsp;<span class="op" id="3959448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3959453">return</span>&nbsp;<span class="builtintype" id="3959460">nil</span><span class="op" id="3959463">,</span>&nbsp;<span class="ident" id="3959465">errors</span><span class="op" id="3959471">.</span><span class="ident" id="3959472">New</span><span class="op" id="3959475">(</span><span class="string" id="3959476">&#34;x509:&nbsp;unsupported&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3959510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3959514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959518">x</span><span class="op" id="3959519">,</span>&nbsp;<span class="ident" id="3959521">y</span>&nbsp;<span class="op" id="3959523">:=</span>&nbsp;<span class="ident" id="3959526">elliptic</span><span class="op" id="3959534">.</span><span class="ident" id="3959535">Unmarshal</span><span class="op" id="3959544">(</span><span class="ident" id="3959545">namedCurve</span><span class="op" id="3959555">,</span>&nbsp;<span class="ident" id="3959557">asn1Data</span><span class="op" id="3959565">)</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3959569">if</span>&nbsp;<span class="ident" id="3959572">x</span>&nbsp;<span class="op" id="3959574">==</span>&nbsp;<span class="builtintype" id="3959577">nil</span>&nbsp;<span class="op" id="3959581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3959586">return</span>&nbsp;<span class="builtintype" id="3959593">nil</span><span class="op" id="3959596">,</span>&nbsp;<span class="ident" id="3959598">errors</span><span class="op" id="3959604">.</span><span class="ident" id="3959605">New</span><span class="op" id="3959608">(</span><span class="string" id="3959609">&#34;x509:&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;elliptic&nbsp;curve&nbsp;point&#34;</span><span class="op" id="3959657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3959661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959665">pub</span>&nbsp;<span class="op" id="3959669">:=</span>&nbsp;<span class="op" id="3959672">&amp;</span><span class="ident" id="3959673">ecdsa</span><span class="op" id="3959678">.</span><span class="ident" id="3959679">PublicKey</span><span class="op" id="3959688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959693">Curve</span><span class="op" id="3959698">:</span>&nbsp;<span class="ident" id="3959700">namedCurve</span><span class="op" id="3959710">,</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959715">X</span><span class="op" id="3959716">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959722">x</span><span class="op" id="3959723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959728">Y</span><span class="op" id="3959729">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3959735">y</span><span class="op" id="3959736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3959740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3959744">return</span>&nbsp;<span class="ident" id="3959751">pub</span><span class="op" id="3959754">,</span>&nbsp;<span class="builtintype" id="3959756">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3959761">default</span><span class="op" id="3959768">:</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3959772">return</span>&nbsp;<span class="builtintype" id="3959779">nil</span><span class="op" id="3959782">,</span>&nbsp;<span class="builtintype" id="3959784">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3959789">}</span><br>
<span class="lineno"></span><span class="op" id="3959791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3959794">func</span>&nbsp;<span class="ident" id="3959799">parseSANExtension</span><span class="op" id="3959816">(</span><span class="ident" id="3959817">value</span>&nbsp;<span class="op" id="3959823">[</span><span class="op" id="3959824">]</span><span class="builtintype" id="3959825">byte</span><span class="op" id="3959829">)</span>&nbsp;<span class="op" id="3959831">(</span><span class="ident" id="3959832">dnsNames</span><span class="op" id="3959840">,</span>&nbsp;<span class="ident" id="3959842">emailAddresses</span>&nbsp;<span class="op" id="3959857">[</span><span class="op" id="3959858">]</span><span class="builtintype" id="3959859">string</span><span class="op" id="3959865">,</span>&nbsp;<span class="ident" id="3959867">ipAddresses</span>&nbsp;<span class="op" id="3959879">[</span><span class="op" id="3959880">]</span><span class="ident" id="3959881">net</span><span class="op" id="3959884">.</span><span class="ident" id="3959885">IP</span><span class="op" id="3959887">,</span>&nbsp;<span class="ident" id="3959889">err</span>&nbsp;<span class="builtintype" id="3959893">error</span><span class="op" id="3959898">)</span>&nbsp;<span class="op" id="3959900">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3959903">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3959926">//&nbsp;SubjectAltName&nbsp;::=&nbsp;GeneralNames</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3959962">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3959966">//&nbsp;GeneralNames&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralName</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3960025">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3960029">//&nbsp;GeneralName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3960058">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3960118">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rfc822Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3960178">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dNSName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3960238">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x400Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORAddress,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3960298">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directoryName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3960353">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ediPartyName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EDIPartyName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3960416">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uniformResourceIdentifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[6]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IA5String,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3960476">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[7]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCTET&nbsp;STRING,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3960539">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;registeredID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3960608">var</span>&nbsp;<span class="ident" id="3960612">seq</span>&nbsp;<span class="ident" id="3960616">asn1</span><span class="op" id="3960620">.</span><span class="ident" id="3960621">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3960631">if</span>&nbsp;<span class="ident" id="3960634">_</span><span class="op" id="3960635">,</span>&nbsp;<span class="ident" id="3960637">err</span>&nbsp;<span class="op" id="3960641">=</span>&nbsp;<span class="ident" id="3960643">asn1</span><span class="op" id="3960647">.</span><span class="ident" id="3960648">Unmarshal</span><span class="op" id="3960657">(</span><span class="ident" id="3960658">value</span><span class="op" id="3960663">,</span>&nbsp;<span class="op" id="3960665">&amp;</span><span class="ident" id="3960666">seq</span><span class="op" id="3960669">)</span><span class="op" id="3960670">;</span>&nbsp;<span class="ident" id="3960672">err</span>&nbsp;<span class="op" id="3960676">!=</span>&nbsp;<span class="builtintype" id="3960679">nil</span>&nbsp;<span class="op" id="3960683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3960687">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3960695">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3960698">if</span>&nbsp;<span class="op" id="3960701">!</span><span class="ident" id="3960702">seq</span><span class="op" id="3960705">.</span><span class="ident" id="3960706">IsCompound</span>&nbsp;<span class="op" id="3960717">||</span>&nbsp;<span class="ident" id="3960720">seq</span><span class="op" id="3960723">.</span><span class="ident" id="3960724">Tag</span>&nbsp;<span class="op" id="3960728">!=</span>&nbsp;<span class="num" id="3960731">16</span>&nbsp;<span class="op" id="3960734">||</span>&nbsp;<span class="ident" id="3960737">seq</span><span class="op" id="3960740">.</span><span class="ident" id="3960741">Class</span>&nbsp;<span class="op" id="3960747">!=</span>&nbsp;<span class="num" id="3960750">0</span>&nbsp;<span class="op" id="3960752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3960756">err</span>&nbsp;<span class="op" id="3960760">=</span>&nbsp;<span class="ident" id="3960762">asn1</span><span class="op" id="3960766">.</span><span class="ident" id="3960767">StructuralError</span><span class="op" id="3960782">{</span><span class="ident" id="3960783">Msg</span><span class="op" id="3960786">:</span>&nbsp;<span class="string" id="3960788">&#34;bad&nbsp;SAN&nbsp;sequence&#34;</span><span class="op" id="3960806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3960810">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3960818">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3960822">rest</span>&nbsp;<span class="op" id="3960827">:=</span>&nbsp;<span class="ident" id="3960830">seq</span><span class="op" id="3960833">.</span><span class="ident" id="3960834">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3960841">for</span>&nbsp;<span class="builtinfunc" id="3960845">len</span><span class="op" id="3960848">(</span><span class="ident" id="3960849">rest</span><span class="op" id="3960853">)</span>&nbsp;<span class="op" id="3960855">&gt;</span>&nbsp;<span class="num" id="3960857">0</span>&nbsp;<span class="op" id="3960859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3960863">var</span>&nbsp;<span class="ident" id="3960867">v</span>&nbsp;<span class="ident" id="3960869">asn1</span><span class="op" id="3960873">.</span><span class="ident" id="3960874">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3960885">rest</span><span class="op" id="3960889">,</span>&nbsp;<span class="ident" id="3960891">err</span>&nbsp;<span class="op" id="3960895">=</span>&nbsp;<span class="ident" id="3960897">asn1</span><span class="op" id="3960901">.</span><span class="ident" id="3960902">Unmarshal</span><span class="op" id="3960911">(</span><span class="ident" id="3960912">rest</span><span class="op" id="3960916">,</span>&nbsp;<span class="op" id="3960918">&amp;</span><span class="ident" id="3960919">v</span><span class="op" id="3960920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3960924">if</span>&nbsp;<span class="ident" id="3960927">err</span>&nbsp;<span class="op" id="3960931">!=</span>&nbsp;<span class="builtintype" id="3960934">nil</span>&nbsp;<span class="op" id="3960938">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3960943">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3960952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3960956">switch</span>&nbsp;<span class="ident" id="3960963">v</span><span class="op" id="3960964">.</span><span class="ident" id="3960965">Tag</span>&nbsp;<span class="op" id="3960969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3960973">case</span>&nbsp;<span class="num" id="3960978">1</span><span class="op" id="3960979">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3960984">emailAddresses</span>&nbsp;<span class="op" id="3960999">=</span>&nbsp;<span class="builtinfunc" id="3961001">append</span><span class="op" id="3961007">(</span><span class="ident" id="3961008">emailAddresses</span><span class="op" id="3961022">,</span>&nbsp;<span class="builtintype" id="3961024">string</span><span class="op" id="3961030">(</span><span class="ident" id="3961031">v</span><span class="op" id="3961032">.</span><span class="ident" id="3961033">Bytes</span><span class="op" id="3961038">)</span><span class="op" id="3961039">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3961043">case</span>&nbsp;<span class="num" id="3961048">2</span><span class="op" id="3961049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961054">dnsNames</span>&nbsp;<span class="op" id="3961063">=</span>&nbsp;<span class="builtinfunc" id="3961065">append</span><span class="op" id="3961071">(</span><span class="ident" id="3961072">dnsNames</span><span class="op" id="3961080">,</span>&nbsp;<span class="builtintype" id="3961082">string</span><span class="op" id="3961088">(</span><span class="ident" id="3961089">v</span><span class="op" id="3961090">.</span><span class="ident" id="3961091">Bytes</span><span class="op" id="3961096">)</span><span class="op" id="3961097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3961101">case</span>&nbsp;<span class="num" id="3961106">7</span><span class="op" id="3961107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3961112">switch</span>&nbsp;<span class="builtinfunc" id="3961119">len</span><span class="op" id="3961122">(</span><span class="ident" id="3961123">v</span><span class="op" id="3961124">.</span><span class="ident" id="3961125">Bytes</span><span class="op" id="3961130">)</span>&nbsp;<span class="op" id="3961132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3961137">case</span>&nbsp;<span class="ident" id="3961142">net</span><span class="op" id="3961145">.</span><span class="ident" id="3961146">IPv4len</span><span class="op" id="3961153">,</span>&nbsp;<span class="ident" id="3961155">net</span><span class="op" id="3961158">.</span><span class="ident" id="3961159">IPv6len</span><span class="op" id="3961166">:</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961172">ipAddresses</span>&nbsp;<span class="op" id="3961184">=</span>&nbsp;<span class="builtinfunc" id="3961186">append</span><span class="op" id="3961192">(</span><span class="ident" id="3961193">ipAddresses</span><span class="op" id="3961204">,</span>&nbsp;<span class="ident" id="3961206">v</span><span class="op" id="3961207">.</span><span class="ident" id="3961208">Bytes</span><span class="op" id="3961213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3961218">default</span><span class="op" id="3961225">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961231">err</span>&nbsp;<span class="op" id="3961235">=</span>&nbsp;<span class="ident" id="3961237">errors</span><span class="op" id="3961243">.</span><span class="ident" id="3961244">New</span><span class="op" id="3961247">(</span><span class="string" id="3961248">&#34;x509:&nbsp;certificate&nbsp;contained&nbsp;IP&nbsp;address&nbsp;of&nbsp;length&nbsp;&#34;</span>&nbsp;<span class="op" id="3961300">+</span>&nbsp;<span class="ident" id="3961302">strconv</span><span class="op" id="3961309">.</span><span class="ident" id="3961310">Itoa</span><span class="op" id="3961314">(</span><span class="builtinfunc" id="3961315">len</span><span class="op" id="3961318">(</span><span class="ident" id="3961319">v</span><span class="op" id="3961320">.</span><span class="ident" id="3961321">Bytes</span><span class="op" id="3961326">)</span><span class="op" id="3961327">)</span><span class="op" id="3961328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3961334">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3961344">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3961348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3961351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3961355">return</span><br>
<span class="lineno"></span><span class="op" id="3961362">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="keyword" id="3961365">func</span>&nbsp;<span class="ident" id="3961370">parseCertificate</span><span class="op" id="3961386">(</span><span class="ident" id="3961387">in</span>&nbsp;<span class="op" id="3961390">*</span><span class="ident" id="3961391">certificate</span><span class="op" id="3961402">)</span>&nbsp;<span class="op" id="3961404">(</span><span class="op" id="3961405">*</span><span class="ident" id="3961406">Certificate</span><span class="op" id="3961417">,</span>&nbsp;<span class="builtintype" id="3961419">error</span><span class="op" id="3961424">)</span>&nbsp;<span class="op" id="3961426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961429">out</span>&nbsp;<span class="op" id="3961433">:=</span>&nbsp;<span class="builtinfunc" id="3961436">new</span><span class="op" id="3961439">(</span><span class="ident" id="3961440">Certificate</span><span class="op" id="3961451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961454">out</span><span class="op" id="3961457">.</span><span class="ident" id="3961458">Raw</span>&nbsp;<span class="op" id="3961462">=</span>&nbsp;<span class="ident" id="3961464">in</span><span class="op" id="3961466">.</span><span class="ident" id="3961467">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961472">out</span><span class="op" id="3961475">.</span><span class="ident" id="3961476">RawTBSCertificate</span>&nbsp;<span class="op" id="3961494">=</span>&nbsp;<span class="ident" id="3961496">in</span><span class="op" id="3961498">.</span><span class="ident" id="3961499">TBSCertificate</span><span class="op" id="3961513">.</span><span class="ident" id="3961514">Raw</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961519">out</span><span class="op" id="3961522">.</span><span class="ident" id="3961523">RawSubjectPublicKeyInfo</span>&nbsp;<span class="op" id="3961547">=</span>&nbsp;<span class="ident" id="3961549">in</span><span class="op" id="3961551">.</span><span class="ident" id="3961552">TBSCertificate</span><span class="op" id="3961566">.</span><span class="ident" id="3961567">PublicKey</span><span class="op" id="3961576">.</span><span class="ident" id="3961577">Raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961582">out</span><span class="op" id="3961585">.</span><span class="ident" id="3961586">RawSubject</span>&nbsp;<span class="op" id="3961597">=</span>&nbsp;<span class="ident" id="3961599">in</span><span class="op" id="3961601">.</span><span class="ident" id="3961602">TBSCertificate</span><span class="op" id="3961616">.</span><span class="ident" id="3961617">Subject</span><span class="op" id="3961624">.</span><span class="ident" id="3961625">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961636">out</span><span class="op" id="3961639">.</span><span class="ident" id="3961640">RawIssuer</span>&nbsp;<span class="op" id="3961650">=</span>&nbsp;<span class="ident" id="3961652">in</span><span class="op" id="3961654">.</span><span class="ident" id="3961655">TBSCertificate</span><span class="op" id="3961669">.</span><span class="ident" id="3961670">Issuer</span><span class="op" id="3961676">.</span><span class="ident" id="3961677">FullBytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961689">out</span><span class="op" id="3961692">.</span><span class="ident" id="3961693">Signature</span>&nbsp;<span class="op" id="3961703">=</span>&nbsp;<span class="ident" id="3961705">in</span><span class="op" id="3961707">.</span><span class="ident" id="3961708">SignatureValue</span><span class="op" id="3961722">.</span><span class="ident" id="3961723">RightAlign</span><span class="op" id="3961733">(</span><span class="op" id="3961734">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961737">out</span><span class="op" id="3961740">.</span><span class="ident" id="3961741">SignatureAlgorithm</span>&nbsp;<span class="op" id="3961760">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961764">getSignatureAlgorithmFromOID</span><span class="op" id="3961792">(</span><span class="ident" id="3961793">in</span><span class="op" id="3961795">.</span><span class="ident" id="3961796">TBSCertificate</span><span class="op" id="3961810">.</span><span class="ident" id="3961811">SignatureAlgorithm</span><span class="op" id="3961829">.</span><span class="ident" id="3961830">Algorithm</span><span class="op" id="3961839">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961843">out</span><span class="op" id="3961846">.</span><span class="ident" id="3961847">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="3961866">=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961870">getPublicKeyAlgorithmFromOID</span><span class="op" id="3961898">(</span><span class="ident" id="3961899">in</span><span class="op" id="3961901">.</span><span class="ident" id="3961902">TBSCertificate</span><span class="op" id="3961916">.</span><span class="ident" id="3961917">PublicKey</span><span class="op" id="3961926">.</span><span class="ident" id="3961927">Algorithm</span><span class="op" id="3961936">.</span><span class="ident" id="3961937">Algorithm</span><span class="op" id="3961946">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3961949">var</span>&nbsp;<span class="ident" id="3961953">err</span>&nbsp;<span class="builtintype" id="3961957">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3961964">out</span><span class="op" id="3961967">.</span><span class="ident" id="3961968">PublicKey</span><span class="op" id="3961977">,</span>&nbsp;<span class="ident" id="3961979">err</span>&nbsp;<span class="op" id="3961983">=</span>&nbsp;<span class="ident" id="3961985">parsePublicKey</span><span class="op" id="3961999">(</span><span class="ident" id="3962000">out</span><span class="op" id="3962003">.</span><span class="ident" id="3962004">PublicKeyAlgorithm</span><span class="op" id="3962022">,</span>&nbsp;<span class="op" id="3962024">&amp;</span><span class="ident" id="3962025">in</span><span class="op" id="3962027">.</span><span class="ident" id="3962028">TBSCertificate</span><span class="op" id="3962042">.</span><span class="ident" id="3962043">PublicKey</span><span class="op" id="3962052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962055">if</span>&nbsp;<span class="ident" id="3962058">err</span>&nbsp;<span class="op" id="3962062">!=</span>&nbsp;<span class="builtintype" id="3962065">nil</span>&nbsp;<span class="op" id="3962069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962073">return</span>&nbsp;<span class="builtintype" id="3962080">nil</span><span class="op" id="3962083">,</span>&nbsp;<span class="ident" id="3962085">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3962090">}</span><br>
<span class="lineno">870</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962094">if</span>&nbsp;<span class="ident" id="3962097">in</span><span class="op" id="3962099">.</span><span class="ident" id="3962100">TBSCertificate</span><span class="op" id="3962114">.</span><span class="ident" id="3962115">SerialNumber</span><span class="op" id="3962127">.</span><span class="ident" id="3962128">Sign</span><span class="op" id="3962132">(</span><span class="op" id="3962133">)</span>&nbsp;<span class="op" id="3962135">&lt;</span>&nbsp;<span class="num" id="3962137">0</span>&nbsp;<span class="op" id="3962139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962143">return</span>&nbsp;<span class="builtintype" id="3962150">nil</span><span class="op" id="3962153">,</span>&nbsp;<span class="ident" id="3962155">errors</span><span class="op" id="3962161">.</span><span class="ident" id="3962162">New</span><span class="op" id="3962165">(</span><span class="string" id="3962166">&#34;x509:&nbsp;negative&nbsp;serial&nbsp;number&#34;</span><span class="op" id="3962196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3962199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3962203">out</span><span class="op" id="3962206">.</span><span class="ident" id="3962207">Version</span>&nbsp;<span class="op" id="3962215">=</span>&nbsp;<span class="ident" id="3962217">in</span><span class="op" id="3962219">.</span><span class="ident" id="3962220">TBSCertificate</span><span class="op" id="3962234">.</span><span class="ident" id="3962235">Version</span>&nbsp;<span class="op" id="3962243">+</span>&nbsp;<span class="num" id="3962245">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3962248">out</span><span class="op" id="3962251">.</span><span class="ident" id="3962252">SerialNumber</span>&nbsp;<span class="op" id="3962265">=</span>&nbsp;<span class="ident" id="3962267">in</span><span class="op" id="3962269">.</span><span class="ident" id="3962270">TBSCertificate</span><span class="op" id="3962284">.</span><span class="ident" id="3962285">SerialNumber</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962300">var</span>&nbsp;<span class="ident" id="3962304">issuer</span><span class="op" id="3962310">,</span>&nbsp;<span class="ident" id="3962312">subject</span>&nbsp;<span class="ident" id="3962320">pkix</span><span class="op" id="3962324">.</span><span class="ident" id="3962325">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962338">if</span>&nbsp;<span class="ident" id="3962341">_</span><span class="op" id="3962342">,</span>&nbsp;<span class="ident" id="3962344">err</span>&nbsp;<span class="op" id="3962348">:=</span>&nbsp;<span class="ident" id="3962351">asn1</span><span class="op" id="3962355">.</span><span class="ident" id="3962356">Unmarshal</span><span class="op" id="3962365">(</span><span class="ident" id="3962366">in</span><span class="op" id="3962368">.</span><span class="ident" id="3962369">TBSCertificate</span><span class="op" id="3962383">.</span><span class="ident" id="3962384">Subject</span><span class="op" id="3962391">.</span><span class="ident" id="3962392">FullBytes</span><span class="op" id="3962401">,</span>&nbsp;<span class="op" id="3962403">&amp;</span><span class="ident" id="3962404">subject</span><span class="op" id="3962411">)</span><span class="op" id="3962412">;</span>&nbsp;<span class="ident" id="3962414">err</span>&nbsp;<span class="op" id="3962418">!=</span>&nbsp;<span class="builtintype" id="3962421">nil</span>&nbsp;<span class="op" id="3962425">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962429">return</span>&nbsp;<span class="builtintype" id="3962436">nil</span><span class="op" id="3962439">,</span>&nbsp;<span class="ident" id="3962441">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3962446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962449">if</span>&nbsp;<span class="ident" id="3962452">_</span><span class="op" id="3962453">,</span>&nbsp;<span class="ident" id="3962455">err</span>&nbsp;<span class="op" id="3962459">:=</span>&nbsp;<span class="ident" id="3962462">asn1</span><span class="op" id="3962466">.</span><span class="ident" id="3962467">Unmarshal</span><span class="op" id="3962476">(</span><span class="ident" id="3962477">in</span><span class="op" id="3962479">.</span><span class="ident" id="3962480">TBSCertificate</span><span class="op" id="3962494">.</span><span class="ident" id="3962495">Issuer</span><span class="op" id="3962501">.</span><span class="ident" id="3962502">FullBytes</span><span class="op" id="3962511">,</span>&nbsp;<span class="op" id="3962513">&amp;</span><span class="ident" id="3962514">issuer</span><span class="op" id="3962520">)</span><span class="op" id="3962521">;</span>&nbsp;<span class="ident" id="3962523">err</span>&nbsp;<span class="op" id="3962527">!=</span>&nbsp;<span class="builtintype" id="3962530">nil</span>&nbsp;<span class="op" id="3962534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962538">return</span>&nbsp;<span class="builtintype" id="3962545">nil</span><span class="op" id="3962548">,</span>&nbsp;<span class="ident" id="3962550">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3962555">}</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3962559">out</span><span class="op" id="3962562">.</span><span class="ident" id="3962563">Issuer</span><span class="op" id="3962569">.</span><span class="ident" id="3962570">FillFromRDNSequence</span><span class="op" id="3962589">(</span><span class="op" id="3962590">&amp;</span><span class="ident" id="3962591">issuer</span><span class="op" id="3962597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3962600">out</span><span class="op" id="3962603">.</span><span class="ident" id="3962604">Subject</span><span class="op" id="3962611">.</span><span class="ident" id="3962612">FillFromRDNSequence</span><span class="op" id="3962631">(</span><span class="op" id="3962632">&amp;</span><span class="ident" id="3962633">subject</span><span class="op" id="3962640">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3962644">out</span><span class="op" id="3962647">.</span><span class="ident" id="3962648">NotBefore</span>&nbsp;<span class="op" id="3962658">=</span>&nbsp;<span class="ident" id="3962660">in</span><span class="op" id="3962662">.</span><span class="ident" id="3962663">TBSCertificate</span><span class="op" id="3962677">.</span><span class="ident" id="3962678">Validity</span><span class="op" id="3962686">.</span><span class="ident" id="3962687">NotBefore</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3962698">out</span><span class="op" id="3962701">.</span><span class="ident" id="3962702">NotAfter</span>&nbsp;<span class="op" id="3962711">=</span>&nbsp;<span class="ident" id="3962713">in</span><span class="op" id="3962715">.</span><span class="ident" id="3962716">TBSCertificate</span><span class="op" id="3962730">.</span><span class="ident" id="3962731">Validity</span><span class="op" id="3962739">.</span><span class="ident" id="3962740">NotAfter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962751">for</span>&nbsp;<span class="ident" id="3962755">_</span><span class="op" id="3962756">,</span>&nbsp;<span class="ident" id="3962758">e</span>&nbsp;<span class="op" id="3962760">:=</span>&nbsp;<span class="keyword" id="3962763">range</span>&nbsp;<span class="ident" id="3962769">in</span><span class="op" id="3962771">.</span><span class="ident" id="3962772">TBSCertificate</span><span class="op" id="3962786">.</span><span class="ident" id="3962787">Extensions</span>&nbsp;<span class="op" id="3962798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3962802">out</span><span class="op" id="3962805">.</span><span class="ident" id="3962806">Extensions</span>&nbsp;<span class="op" id="3962817">=</span>&nbsp;<span class="builtinfunc" id="3962819">append</span><span class="op" id="3962825">(</span><span class="ident" id="3962826">out</span><span class="op" id="3962829">.</span><span class="ident" id="3962830">Extensions</span><span class="op" id="3962840">,</span>&nbsp;<span class="ident" id="3962842">e</span><span class="op" id="3962843">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962848">if</span>&nbsp;<span class="builtinfunc" id="3962851">len</span><span class="op" id="3962854">(</span><span class="ident" id="3962855">e</span><span class="op" id="3962856">.</span><span class="ident" id="3962857">Id</span><span class="op" id="3962859">)</span>&nbsp;<span class="op" id="3962861">==</span>&nbsp;<span class="num" id="3962864">4</span>&nbsp;<span class="op" id="3962866">&amp;&amp;</span>&nbsp;<span class="ident" id="3962869">e</span><span class="op" id="3962870">.</span><span class="ident" id="3962871">Id</span><span class="op" id="3962873">[</span><span class="num" id="3962874">0</span><span class="op" id="3962875">]</span>&nbsp;<span class="op" id="3962877">==</span>&nbsp;<span class="num" id="3962880">2</span>&nbsp;<span class="op" id="3962882">&amp;&amp;</span>&nbsp;<span class="ident" id="3962885">e</span><span class="op" id="3962886">.</span><span class="ident" id="3962887">Id</span><span class="op" id="3962889">[</span><span class="num" id="3962890">1</span><span class="op" id="3962891">]</span>&nbsp;<span class="op" id="3962893">==</span>&nbsp;<span class="num" id="3962896">5</span>&nbsp;<span class="op" id="3962898">&amp;&amp;</span>&nbsp;<span class="ident" id="3962901">e</span><span class="op" id="3962902">.</span><span class="ident" id="3962903">Id</span><span class="op" id="3962905">[</span><span class="num" id="3962906">2</span><span class="op" id="3962907">]</span>&nbsp;<span class="op" id="3962909">==</span>&nbsp;<span class="num" id="3962912">29</span>&nbsp;<span class="op" id="3962915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962920">switch</span>&nbsp;<span class="ident" id="3962927">e</span><span class="op" id="3962928">.</span><span class="ident" id="3962929">Id</span><span class="op" id="3962931">[</span><span class="num" id="3962932">3</span><span class="op" id="3962933">]</span>&nbsp;<span class="op" id="3962935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962940">case</span>&nbsp;<span class="num" id="3962945">15</span><span class="op" id="3962947">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3962953">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3962978">var</span>&nbsp;<span class="ident" id="3962982">usageBits</span>&nbsp;<span class="ident" id="3962992">asn1</span><span class="op" id="3962996">.</span><span class="ident" id="3962997">BitString</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963011">_</span><span class="op" id="3963012">,</span>&nbsp;<span class="ident" id="3963014">err</span>&nbsp;<span class="op" id="3963018">:=</span>&nbsp;<span class="ident" id="3963021">asn1</span><span class="op" id="3963025">.</span><span class="ident" id="3963026">Unmarshal</span><span class="op" id="3963035">(</span><span class="ident" id="3963036">e</span><span class="op" id="3963037">.</span><span class="ident" id="3963038">Value</span><span class="op" id="3963043">,</span>&nbsp;<span class="op" id="3963045">&amp;</span><span class="ident" id="3963046">usageBits</span><span class="op" id="3963055">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963062">if</span>&nbsp;<span class="ident" id="3963065">err</span>&nbsp;<span class="op" id="3963069">==</span>&nbsp;<span class="builtintype" id="3963072">nil</span>&nbsp;<span class="op" id="3963076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963083">var</span>&nbsp;<span class="ident" id="3963087">usage</span>&nbsp;<span class="builtintype" id="3963093">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963102">for</span>&nbsp;<span class="ident" id="3963106">i</span>&nbsp;<span class="op" id="3963108">:=</span>&nbsp;<span class="num" id="3963111">0</span><span class="op" id="3963112">;</span>&nbsp;<span class="ident" id="3963114">i</span>&nbsp;<span class="op" id="3963116">&lt;</span>&nbsp;<span class="num" id="3963118">9</span><span class="op" id="3963119">;</span>&nbsp;<span class="ident" id="3963121">i</span><span class="op" id="3963122">++</span>&nbsp;<span class="op" id="3963125">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963133">if</span>&nbsp;<span class="ident" id="3963136">usageBits</span><span class="op" id="3963145">.</span><span class="ident" id="3963146">At</span><span class="op" id="3963148">(</span><span class="ident" id="3963149">i</span><span class="op" id="3963150">)</span>&nbsp;<span class="op" id="3963152">!=</span>&nbsp;<span class="num" id="3963155">0</span>&nbsp;<span class="op" id="3963157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963166">usage</span>&nbsp;<span class="op" id="3963172">|=</span>&nbsp;<span class="num" id="3963175">1</span>&nbsp;<span class="op" id="3963177">&lt;&lt;</span>&nbsp;<span class="builtintype" id="3963180">uint</span><span class="op" id="3963184">(</span><span class="ident" id="3963185">i</span><span class="op" id="3963186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963208">out</span><span class="op" id="3963211">.</span><span class="ident" id="3963212">KeyUsage</span>&nbsp;<span class="op" id="3963221">=</span>&nbsp;<span class="ident" id="3963223">KeyUsage</span><span class="op" id="3963231">(</span><span class="ident" id="3963232">usage</span><span class="op" id="3963237">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963244">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963262">case</span>&nbsp;<span class="num" id="3963267">19</span><span class="op" id="3963269">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3963275">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963300">var</span>&nbsp;<span class="ident" id="3963304">constraints</span>&nbsp;<span class="ident" id="3963316">basicConstraints</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963337">_</span><span class="op" id="3963338">,</span>&nbsp;<span class="ident" id="3963340">err</span>&nbsp;<span class="op" id="3963344">:=</span>&nbsp;<span class="ident" id="3963347">asn1</span><span class="op" id="3963351">.</span><span class="ident" id="3963352">Unmarshal</span><span class="op" id="3963361">(</span><span class="ident" id="3963362">e</span><span class="op" id="3963363">.</span><span class="ident" id="3963364">Value</span><span class="op" id="3963369">,</span>&nbsp;<span class="op" id="3963371">&amp;</span><span class="ident" id="3963372">constraints</span><span class="op" id="3963383">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963390">if</span>&nbsp;<span class="ident" id="3963393">err</span>&nbsp;<span class="op" id="3963397">==</span>&nbsp;<span class="builtintype" id="3963400">nil</span>&nbsp;<span class="op" id="3963404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963411">out</span><span class="op" id="3963414">.</span><span class="ident" id="3963415">BasicConstraintsValid</span>&nbsp;<span class="op" id="3963437">=</span>&nbsp;<span class="builtintype" id="3963439">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963449">out</span><span class="op" id="3963452">.</span><span class="ident" id="3963453">IsCA</span>&nbsp;<span class="op" id="3963458">=</span>&nbsp;<span class="ident" id="3963460">constraints</span><span class="op" id="3963471">.</span><span class="ident" id="3963472">IsCA</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963482">out</span><span class="op" id="3963485">.</span><span class="ident" id="3963486">MaxPathLen</span>&nbsp;<span class="op" id="3963497">=</span>&nbsp;<span class="ident" id="3963499">constraints</span><span class="op" id="3963510">.</span><span class="ident" id="3963511">MaxPathLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963527">out</span><span class="op" id="3963530">.</span><span class="ident" id="3963531">MaxPathLenZero</span>&nbsp;<span class="op" id="3963546">=</span>&nbsp;<span class="ident" id="3963548">out</span><span class="op" id="3963551">.</span><span class="ident" id="3963552">MaxPathLen</span>&nbsp;<span class="op" id="3963563">==</span>&nbsp;<span class="num" id="3963566">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963573">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963591">case</span>&nbsp;<span class="num" id="3963596">17</span><span class="op" id="3963598">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3963604">out</span><span class="op" id="3963607">.</span><span class="ident" id="3963608">DNSNames</span><span class="op" id="3963616">,</span>&nbsp;<span class="ident" id="3963618">out</span><span class="op" id="3963621">.</span><span class="ident" id="3963622">EmailAddresses</span><span class="op" id="3963636">,</span>&nbsp;<span class="ident" id="3963638">out</span><span class="op" id="3963641">.</span><span class="ident" id="3963642">IPAddresses</span><span class="op" id="3963653">,</span>&nbsp;<span class="ident" id="3963655">err</span>&nbsp;<span class="op" id="3963659">=</span>&nbsp;<span class="ident" id="3963661">parseSANExtension</span><span class="op" id="3963678">(</span><span class="ident" id="3963679">e</span><span class="op" id="3963680">.</span><span class="ident" id="3963681">Value</span><span class="op" id="3963686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963692">if</span>&nbsp;<span class="ident" id="3963695">err</span>&nbsp;<span class="op" id="3963699">!=</span>&nbsp;<span class="builtintype" id="3963702">nil</span>&nbsp;<span class="op" id="3963706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963713">return</span>&nbsp;<span class="builtintype" id="3963720">nil</span><span class="op" id="3963723">,</span>&nbsp;<span class="ident" id="3963725">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963740">if</span>&nbsp;<span class="builtinfunc" id="3963743">len</span><span class="op" id="3963746">(</span><span class="ident" id="3963747">out</span><span class="op" id="3963750">.</span><span class="ident" id="3963751">DNSNames</span><span class="op" id="3963759">)</span>&nbsp;<span class="op" id="3963761">&gt;</span>&nbsp;<span class="num" id="3963763">0</span>&nbsp;<span class="op" id="3963765">||</span>&nbsp;<span class="builtinfunc" id="3963768">len</span><span class="op" id="3963771">(</span><span class="ident" id="3963772">out</span><span class="op" id="3963775">.</span><span class="ident" id="3963776">EmailAddresses</span><span class="op" id="3963790">)</span>&nbsp;<span class="op" id="3963792">&gt;</span>&nbsp;<span class="num" id="3963794">0</span>&nbsp;<span class="op" id="3963796">||</span>&nbsp;<span class="builtinfunc" id="3963799">len</span><span class="op" id="3963802">(</span><span class="ident" id="3963803">out</span><span class="op" id="3963806">.</span><span class="ident" id="3963807">IPAddresses</span><span class="op" id="3963818">)</span>&nbsp;<span class="op" id="3963820">&gt;</span>&nbsp;<span class="num" id="3963822">0</span>&nbsp;<span class="op" id="3963824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963831">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3963844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3963850">//&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;parse&nbsp;any&nbsp;of&nbsp;the&nbsp;names&nbsp;then&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3963901">//&nbsp;fall&nbsp;through&nbsp;to&nbsp;the&nbsp;critical&nbsp;check&nbsp;below.</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3963950">case</span>&nbsp;<span class="num" id="3963955">30</span><span class="op" id="3963957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3963963">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.10</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3963990">//&nbsp;NameConstraints&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3964028">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permittedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3964098">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excludedSubtrees&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralSubtrees&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3964169">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3964176">//&nbsp;GeneralSubtrees&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;GeneralSubtree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3964244">//</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3964251">//&nbsp;GeneralSubtree&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3964288">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralName,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3964337">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;DEFAULT&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3964397">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maximum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseDistance&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3964457">//</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3964464">//&nbsp;BaseDistance&nbsp;::=&nbsp;INTEGER&nbsp;(0..MAX)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964506">var</span>&nbsp;<span class="ident" id="3964510">constraints</span>&nbsp;<span class="ident" id="3964522">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964542">_</span><span class="op" id="3964543">,</span>&nbsp;<span class="ident" id="3964545">err</span>&nbsp;<span class="op" id="3964549">:=</span>&nbsp;<span class="ident" id="3964552">asn1</span><span class="op" id="3964556">.</span><span class="ident" id="3964557">Unmarshal</span><span class="op" id="3964566">(</span><span class="ident" id="3964567">e</span><span class="op" id="3964568">.</span><span class="ident" id="3964569">Value</span><span class="op" id="3964574">,</span>&nbsp;<span class="op" id="3964576">&amp;</span><span class="ident" id="3964577">constraints</span><span class="op" id="3964588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964594">if</span>&nbsp;<span class="ident" id="3964597">err</span>&nbsp;<span class="op" id="3964601">!=</span>&nbsp;<span class="builtintype" id="3964604">nil</span>&nbsp;<span class="op" id="3964608">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964615">return</span>&nbsp;<span class="builtintype" id="3964622">nil</span><span class="op" id="3964625">,</span>&nbsp;<span class="ident" id="3964627">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3964635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964642">if</span>&nbsp;<span class="builtinfunc" id="3964645">len</span><span class="op" id="3964648">(</span><span class="ident" id="3964649">constraints</span><span class="op" id="3964660">.</span><span class="ident" id="3964661">Excluded</span><span class="op" id="3964669">)</span>&nbsp;<span class="op" id="3964671">&gt;</span>&nbsp;<span class="num" id="3964673">0</span>&nbsp;<span class="op" id="3964675">&amp;&amp;</span>&nbsp;<span class="ident" id="3964678">e</span><span class="op" id="3964679">.</span><span class="ident" id="3964680">Critical</span>&nbsp;<span class="op" id="3964689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964696">return</span>&nbsp;<span class="ident" id="3964703">out</span><span class="op" id="3964706">,</span>&nbsp;<span class="ident" id="3964708">UnhandledCriticalExtension</span><span class="op" id="3964734">{</span><span class="op" id="3964735">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3964741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964748">for</span>&nbsp;<span class="ident" id="3964752">_</span><span class="op" id="3964753">,</span>&nbsp;<span class="ident" id="3964755">subtree</span>&nbsp;<span class="op" id="3964763">:=</span>&nbsp;<span class="keyword" id="3964766">range</span>&nbsp;<span class="ident" id="3964772">constraints</span><span class="op" id="3964783">.</span><span class="ident" id="3964784">Permitted</span>&nbsp;<span class="op" id="3964794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964801">if</span>&nbsp;<span class="builtinfunc" id="3964804">len</span><span class="op" id="3964807">(</span><span class="ident" id="3964808">subtree</span><span class="op" id="3964815">.</span><span class="ident" id="3964816">Name</span><span class="op" id="3964820">)</span>&nbsp;<span class="op" id="3964822">==</span>&nbsp;<span class="num" id="3964825">0</span>&nbsp;<span class="op" id="3964827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964835">if</span>&nbsp;<span class="ident" id="3964838">e</span><span class="op" id="3964839">.</span><span class="ident" id="3964840">Critical</span>&nbsp;<span class="op" id="3964849">{</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964858">return</span>&nbsp;<span class="ident" id="3964865">out</span><span class="op" id="3964868">,</span>&nbsp;<span class="ident" id="3964870">UnhandledCriticalExtension</span><span class="op" id="3964896">{</span><span class="op" id="3964897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3964905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3964913">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3964927">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3964934">out</span><span class="op" id="3964937">.</span><span class="ident" id="3964938">PermittedDNSDomains</span>&nbsp;<span class="op" id="3964958">=</span>&nbsp;<span class="builtinfunc" id="3964960">append</span><span class="op" id="3964966">(</span><span class="ident" id="3964967">out</span><span class="op" id="3964970">.</span><span class="ident" id="3964971">PermittedDNSDomains</span><span class="op" id="3964990">,</span>&nbsp;<span class="ident" id="3964992">subtree</span><span class="op" id="3964999">.</span><span class="ident" id="3965000">Name</span><span class="op" id="3965004">)</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965016">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965029">case</span>&nbsp;<span class="num" id="3965034">31</span><span class="op" id="3965036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3965042">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.14</span><br>
<span class="lineno">975</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3965069">//&nbsp;CRLDistributionPoints&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;DistributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3965146">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3965153">//&nbsp;DistributionPoint&nbsp;::=&nbsp;SEQUENCE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3965193">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distributionPoint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DistributionPointName&nbsp;OPTIONAL,</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3965268">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasons&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReasonFlags&nbsp;OPTIONAL,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3965333">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cRLIssuer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames&nbsp;OPTIONAL&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3965400">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3965407">//&nbsp;DistributionPointName&nbsp;::=&nbsp;CHOICE&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3965449">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fullName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneralNames,</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3965506">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nameRelativeToCRLIssuer&nbsp;[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RelativeDistinguishedName&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965578">var</span>&nbsp;<span class="ident" id="3965582">cdp</span>&nbsp;<span class="op" id="3965586">[</span><span class="op" id="3965587">]</span><span class="ident" id="3965588">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965610">_</span><span class="op" id="3965611">,</span>&nbsp;<span class="ident" id="3965613">err</span>&nbsp;<span class="op" id="3965617">:=</span>&nbsp;<span class="ident" id="3965620">asn1</span><span class="op" id="3965624">.</span><span class="ident" id="3965625">Unmarshal</span><span class="op" id="3965634">(</span><span class="ident" id="3965635">e</span><span class="op" id="3965636">.</span><span class="ident" id="3965637">Value</span><span class="op" id="3965642">,</span>&nbsp;<span class="op" id="3965644">&amp;</span><span class="ident" id="3965645">cdp</span><span class="op" id="3965648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965654">if</span>&nbsp;<span class="ident" id="3965657">err</span>&nbsp;<span class="op" id="3965661">!=</span>&nbsp;<span class="builtintype" id="3965664">nil</span>&nbsp;<span class="op" id="3965668">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965675">return</span>&nbsp;<span class="builtintype" id="3965682">nil</span><span class="op" id="3965685">,</span>&nbsp;<span class="ident" id="3965687">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965702">for</span>&nbsp;<span class="ident" id="3965706">_</span><span class="op" id="3965707">,</span>&nbsp;<span class="ident" id="3965709">dp</span>&nbsp;<span class="op" id="3965712">:=</span>&nbsp;<span class="keyword" id="3965715">range</span>&nbsp;<span class="ident" id="3965721">cdp</span>&nbsp;<span class="op" id="3965725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965732">var</span>&nbsp;<span class="ident" id="3965736">n</span>&nbsp;<span class="ident" id="3965738">asn1</span><span class="op" id="3965742">.</span><span class="ident" id="3965743">RawValue</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965757">_</span><span class="op" id="3965758">,</span>&nbsp;<span class="ident" id="3965760">err</span>&nbsp;<span class="op" id="3965764">=</span>&nbsp;<span class="ident" id="3965766">asn1</span><span class="op" id="3965770">.</span><span class="ident" id="3965771">Unmarshal</span><span class="op" id="3965780">(</span><span class="ident" id="3965781">dp</span><span class="op" id="3965783">.</span><span class="ident" id="3965784">DistributionPoint</span><span class="op" id="3965801">.</span><span class="ident" id="3965802">FullName</span><span class="op" id="3965810">.</span><span class="ident" id="3965811">Bytes</span><span class="op" id="3965816">,</span>&nbsp;<span class="op" id="3965818">&amp;</span><span class="ident" id="3965819">n</span><span class="op" id="3965820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965827">if</span>&nbsp;<span class="ident" id="3965830">err</span>&nbsp;<span class="op" id="3965834">!=</span>&nbsp;<span class="builtintype" id="3965837">nil</span>&nbsp;<span class="op" id="3965841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965849">return</span>&nbsp;<span class="builtintype" id="3965856">nil</span><span class="op" id="3965859">,</span>&nbsp;<span class="ident" id="3965861">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965878">if</span>&nbsp;<span class="ident" id="3965881">n</span><span class="op" id="3965882">.</span><span class="ident" id="3965883">Tag</span>&nbsp;<span class="op" id="3965887">==</span>&nbsp;<span class="num" id="3965890">6</span>&nbsp;<span class="op" id="3965892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3965900">out</span><span class="op" id="3965903">.</span><span class="ident" id="3965904">CRLDistributionPoints</span>&nbsp;<span class="op" id="3965926">=</span>&nbsp;<span class="builtinfunc" id="3965928">append</span><span class="op" id="3965934">(</span><span class="ident" id="3965935">out</span><span class="op" id="3965938">.</span><span class="ident" id="3965939">CRLDistributionPoints</span><span class="op" id="3965960">,</span>&nbsp;<span class="builtintype" id="3965962">string</span><span class="op" id="3965968">(</span><span class="ident" id="3965969">n</span><span class="op" id="3965970">.</span><span class="ident" id="3965971">Bytes</span><span class="op" id="3965976">)</span><span class="op" id="3965977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3965990">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3965996">continue</span><br>
<span class="lineno">1005</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966009">case</span>&nbsp;<span class="num" id="3966014">35</span><span class="op" id="3966016">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3966022">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966047">var</span>&nbsp;<span class="ident" id="3966051">a</span>&nbsp;<span class="ident" id="3966053">authKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3966067">_</span><span class="op" id="3966068">,</span>&nbsp;<span class="ident" id="3966070">err</span>&nbsp;<span class="op" id="3966074">=</span>&nbsp;<span class="ident" id="3966076">asn1</span><span class="op" id="3966080">.</span><span class="ident" id="3966081">Unmarshal</span><span class="op" id="3966090">(</span><span class="ident" id="3966091">e</span><span class="op" id="3966092">.</span><span class="ident" id="3966093">Value</span><span class="op" id="3966098">,</span>&nbsp;<span class="op" id="3966100">&amp;</span><span class="ident" id="3966101">a</span><span class="op" id="3966102">)</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966108">if</span>&nbsp;<span class="ident" id="3966111">err</span>&nbsp;<span class="op" id="3966115">!=</span>&nbsp;<span class="builtintype" id="3966118">nil</span>&nbsp;<span class="op" id="3966122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966129">return</span>&nbsp;<span class="builtintype" id="3966136">nil</span><span class="op" id="3966139">,</span>&nbsp;<span class="ident" id="3966141">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3966149">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3966155">out</span><span class="op" id="3966158">.</span><span class="ident" id="3966159">AuthorityKeyId</span>&nbsp;<span class="op" id="3966174">=</span>&nbsp;<span class="ident" id="3966176">a</span><span class="op" id="3966177">.</span><span class="ident" id="3966178">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966185">continue</span><br>
<span class="lineno">1015</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966198">case</span>&nbsp;<span class="num" id="3966203">37</span><span class="op" id="3966205">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3966211">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.12.&nbsp;&nbsp;Extended&nbsp;Key&nbsp;Usage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3966259">//&nbsp;id-ce-extKeyUsage&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;::=&nbsp;{&nbsp;id-ce&nbsp;37&nbsp;}</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3966319">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3966326">//&nbsp;ExtKeyUsageSyntax&nbsp;::=&nbsp;SEQUENCE&nbsp;SIZE&nbsp;(1..MAX)&nbsp;OF&nbsp;KeyPurposeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3966394">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3966401">//&nbsp;KeyPurposeId&nbsp;::=&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966444">var</span>&nbsp;<span class="ident" id="3966448">keyUsage</span>&nbsp;<span class="op" id="3966457">[</span><span class="op" id="3966458">]</span><span class="ident" id="3966459">asn1</span><span class="op" id="3966463">.</span><span class="ident" id="3966464">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3966485">_</span><span class="op" id="3966486">,</span>&nbsp;<span class="ident" id="3966488">err</span>&nbsp;<span class="op" id="3966492">=</span>&nbsp;<span class="ident" id="3966494">asn1</span><span class="op" id="3966498">.</span><span class="ident" id="3966499">Unmarshal</span><span class="op" id="3966508">(</span><span class="ident" id="3966509">e</span><span class="op" id="3966510">.</span><span class="ident" id="3966511">Value</span><span class="op" id="3966516">,</span>&nbsp;<span class="op" id="3966518">&amp;</span><span class="ident" id="3966519">keyUsage</span><span class="op" id="3966527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966533">if</span>&nbsp;<span class="ident" id="3966536">err</span>&nbsp;<span class="op" id="3966540">!=</span>&nbsp;<span class="builtintype" id="3966543">nil</span>&nbsp;<span class="op" id="3966547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966554">return</span>&nbsp;<span class="builtintype" id="3966561">nil</span><span class="op" id="3966564">,</span>&nbsp;<span class="ident" id="3966566">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3966574">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966581">for</span>&nbsp;<span class="ident" id="3966585">_</span><span class="op" id="3966586">,</span>&nbsp;<span class="ident" id="3966588">u</span>&nbsp;<span class="op" id="3966590">:=</span>&nbsp;<span class="keyword" id="3966593">range</span>&nbsp;<span class="ident" id="3966599">keyUsage</span>&nbsp;<span class="op" id="3966608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966615">if</span>&nbsp;<span class="ident" id="3966618">extKeyUsage</span><span class="op" id="3966629">,</span>&nbsp;<span class="ident" id="3966631">ok</span>&nbsp;<span class="op" id="3966634">:=</span>&nbsp;<span class="ident" id="3966637">extKeyUsageFromOID</span><span class="op" id="3966655">(</span><span class="ident" id="3966656">u</span><span class="op" id="3966657">)</span><span class="op" id="3966658">;</span>&nbsp;<span class="ident" id="3966660">ok</span>&nbsp;<span class="op" id="3966663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3966671">out</span><span class="op" id="3966674">.</span><span class="ident" id="3966675">ExtKeyUsage</span>&nbsp;<span class="op" id="3966687">=</span>&nbsp;<span class="builtinfunc" id="3966689">append</span><span class="op" id="3966695">(</span><span class="ident" id="3966696">out</span><span class="op" id="3966699">.</span><span class="ident" id="3966700">ExtKeyUsage</span><span class="op" id="3966711">,</span>&nbsp;<span class="ident" id="3966713">extKeyUsage</span><span class="op" id="3966724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3966731">}</span>&nbsp;<span class="keyword" id="3966733">else</span>&nbsp;<span class="op" id="3966738">{</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3966746">out</span><span class="op" id="3966749">.</span><span class="ident" id="3966750">UnknownExtKeyUsage</span>&nbsp;<span class="op" id="3966769">=</span>&nbsp;<span class="builtinfunc" id="3966771">append</span><span class="op" id="3966777">(</span><span class="ident" id="3966778">out</span><span class="op" id="3966781">.</span><span class="ident" id="3966782">UnknownExtKeyUsage</span><span class="op" id="3966800">,</span>&nbsp;<span class="ident" id="3966802">u</span><span class="op" id="3966803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3966810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3966816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966823">continue</span><br>
<span class="lineno">1040</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966836">case</span>&nbsp;<span class="num" id="3966841">14</span><span class="op" id="3966843">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3966849">//&nbsp;RFC&nbsp;5280,&nbsp;4.2.1.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966874">var</span>&nbsp;<span class="ident" id="3966878">keyid</span>&nbsp;<span class="op" id="3966884">[</span><span class="op" id="3966885">]</span><span class="builtintype" id="3966886">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3966895">_</span><span class="op" id="3966896">,</span>&nbsp;<span class="ident" id="3966898">err</span>&nbsp;<span class="op" id="3966902">=</span>&nbsp;<span class="ident" id="3966904">asn1</span><span class="op" id="3966908">.</span><span class="ident" id="3966909">Unmarshal</span><span class="op" id="3966918">(</span><span class="ident" id="3966919">e</span><span class="op" id="3966920">.</span><span class="ident" id="3966921">Value</span><span class="op" id="3966926">,</span>&nbsp;<span class="op" id="3966928">&amp;</span><span class="ident" id="3966929">keyid</span><span class="op" id="3966934">)</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966940">if</span>&nbsp;<span class="ident" id="3966943">err</span>&nbsp;<span class="op" id="3966947">!=</span>&nbsp;<span class="builtintype" id="3966950">nil</span>&nbsp;<span class="op" id="3966954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3966961">return</span>&nbsp;<span class="builtintype" id="3966968">nil</span><span class="op" id="3966971">,</span>&nbsp;<span class="ident" id="3966973">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3966981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3966987">out</span><span class="op" id="3966990">.</span><span class="ident" id="3966991">SubjectKeyId</span>&nbsp;<span class="op" id="3967004">=</span>&nbsp;<span class="ident" id="3967006">keyid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967016">continue</span><br>
<span class="lineno">1050</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967029">case</span>&nbsp;<span class="num" id="3967034">32</span><span class="op" id="3967036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3967042">//&nbsp;RFC&nbsp;5280&nbsp;4.2.1.4:&nbsp;Certificate&nbsp;Policies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967088">var</span>&nbsp;<span class="ident" id="3967092">policies</span>&nbsp;<span class="op" id="3967101">[</span><span class="op" id="3967102">]</span><span class="ident" id="3967103">policyInformation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967125">if</span>&nbsp;<span class="ident" id="3967128">_</span><span class="op" id="3967129">,</span>&nbsp;<span class="ident" id="3967131">err</span>&nbsp;<span class="op" id="3967135">=</span>&nbsp;<span class="ident" id="3967137">asn1</span><span class="op" id="3967141">.</span><span class="ident" id="3967142">Unmarshal</span><span class="op" id="3967151">(</span><span class="ident" id="3967152">e</span><span class="op" id="3967153">.</span><span class="ident" id="3967154">Value</span><span class="op" id="3967159">,</span>&nbsp;<span class="op" id="3967161">&amp;</span><span class="ident" id="3967162">policies</span><span class="op" id="3967170">)</span><span class="op" id="3967171">;</span>&nbsp;<span class="ident" id="3967173">err</span>&nbsp;<span class="op" id="3967177">!=</span>&nbsp;<span class="builtintype" id="3967180">nil</span>&nbsp;<span class="op" id="3967184">{</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967191">return</span>&nbsp;<span class="builtintype" id="3967198">nil</span><span class="op" id="3967201">,</span>&nbsp;<span class="ident" id="3967203">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3967211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3967217">out</span><span class="op" id="3967220">.</span><span class="ident" id="3967221">PolicyIdentifiers</span>&nbsp;<span class="op" id="3967239">=</span>&nbsp;<span class="builtinfunc" id="3967241">make</span><span class="op" id="3967245">(</span><span class="op" id="3967246">[</span><span class="op" id="3967247">]</span><span class="ident" id="3967248">asn1</span><span class="op" id="3967252">.</span><span class="ident" id="3967253">ObjectIdentifier</span><span class="op" id="3967269">,</span>&nbsp;<span class="builtinfunc" id="3967271">len</span><span class="op" id="3967274">(</span><span class="ident" id="3967275">policies</span><span class="op" id="3967283">)</span><span class="op" id="3967284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967290">for</span>&nbsp;<span class="ident" id="3967294">i</span><span class="op" id="3967295">,</span>&nbsp;<span class="ident" id="3967297">policy</span>&nbsp;<span class="op" id="3967304">:=</span>&nbsp;<span class="keyword" id="3967307">range</span>&nbsp;<span class="ident" id="3967313">policies</span>&nbsp;<span class="op" id="3967322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3967329">out</span><span class="op" id="3967332">.</span><span class="ident" id="3967333">PolicyIdentifiers</span><span class="op" id="3967350">[</span><span class="ident" id="3967351">i</span><span class="op" id="3967352">]</span>&nbsp;<span class="op" id="3967354">=</span>&nbsp;<span class="ident" id="3967356">policy</span><span class="op" id="3967362">.</span><span class="ident" id="3967363">Policy</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3967374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3967379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3967383">}</span>&nbsp;<span class="keyword" id="3967385">else</span>&nbsp;<span class="keyword" id="3967390">if</span>&nbsp;<span class="ident" id="3967393">e</span><span class="op" id="3967394">.</span><span class="ident" id="3967395">Id</span><span class="op" id="3967397">.</span><span class="ident" id="3967398">Equal</span><span class="op" id="3967403">(</span><span class="ident" id="3967404">oidExtensionAuthorityInfoAccess</span><span class="op" id="3967435">)</span>&nbsp;<span class="op" id="3967437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3967442">//&nbsp;RFC&nbsp;5280&nbsp;4.2.2.1:&nbsp;Authority&nbsp;Information&nbsp;Access</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967495">var</span>&nbsp;<span class="ident" id="3967499">aia</span>&nbsp;<span class="op" id="3967503">[</span><span class="op" id="3967504">]</span><span class="ident" id="3967505">authorityInfoAccess</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967528">if</span>&nbsp;<span class="ident" id="3967531">_</span><span class="op" id="3967532">,</span>&nbsp;<span class="ident" id="3967534">err</span>&nbsp;<span class="op" id="3967538">=</span>&nbsp;<span class="ident" id="3967540">asn1</span><span class="op" id="3967544">.</span><span class="ident" id="3967545">Unmarshal</span><span class="op" id="3967554">(</span><span class="ident" id="3967555">e</span><span class="op" id="3967556">.</span><span class="ident" id="3967557">Value</span><span class="op" id="3967562">,</span>&nbsp;<span class="op" id="3967564">&amp;</span><span class="ident" id="3967565">aia</span><span class="op" id="3967568">)</span><span class="op" id="3967569">;</span>&nbsp;<span class="ident" id="3967571">err</span>&nbsp;<span class="op" id="3967575">!=</span>&nbsp;<span class="builtintype" id="3967578">nil</span>&nbsp;<span class="op" id="3967582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967588">return</span>&nbsp;<span class="builtintype" id="3967595">nil</span><span class="op" id="3967598">,</span>&nbsp;<span class="ident" id="3967600">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3967607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967613">for</span>&nbsp;<span class="ident" id="3967617">_</span><span class="op" id="3967618">,</span>&nbsp;<span class="ident" id="3967620">v</span>&nbsp;<span class="op" id="3967622">:=</span>&nbsp;<span class="keyword" id="3967625">range</span>&nbsp;<span class="ident" id="3967631">aia</span>&nbsp;<span class="op" id="3967635">{</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3967641">//&nbsp;GeneralName:&nbsp;uniformResourceIdentifier&nbsp;[6]&nbsp;IA5String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967701">if</span>&nbsp;<span class="ident" id="3967704">v</span><span class="op" id="3967705">.</span><span class="ident" id="3967706">Location</span><span class="op" id="3967714">.</span><span class="ident" id="3967715">Tag</span>&nbsp;<span class="op" id="3967719">!=</span>&nbsp;<span class="num" id="3967722">6</span>&nbsp;<span class="op" id="3967724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967731">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3967744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3967750">if</span>&nbsp;<span class="ident" id="3967753">v</span><span class="op" id="3967754">.</span><span class="ident" id="3967755">Method</span><span class="op" id="3967761">.</span><span class="ident" id="3967762">Equal</span><span class="op" id="3967767">(</span><span class="ident" id="3967768">oidAuthorityInfoAccessOcsp</span><span class="op" id="3967794">)</span>&nbsp;<span class="op" id="3967796">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3967803">out</span><span class="op" id="3967806">.</span><span class="ident" id="3967807">OCSPServer</span>&nbsp;<span class="op" id="3967818">=</span>&nbsp;<span class="builtinfunc" id="3967820">append</span><span class="op" id="3967826">(</span><span class="ident" id="3967827">out</span><span class="op" id="3967830">.</span><span class="ident" id="3967831">OCSPServer</span><span class="op" id="3967841">,</span>&nbsp;<span class="builtintype" id="3967843">string</span><span class="op" id="3967849">(</span><span class="ident" id="3967850">v</span><span class="op" id="3967851">.</span><span class="ident" id="3967852">Location</span><span class="op" id="3967860">.</span><span class="ident" id="3967861">Bytes</span><span class="op" id="3967866">)</span><span class="op" id="3967867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3967873">}</span>&nbsp;<span class="keyword" id="3967875">else</span>&nbsp;<span class="keyword" id="3967880">if</span>&nbsp;<span class="ident" id="3967883">v</span><span class="op" id="3967884">.</span><span class="ident" id="3967885">Method</span><span class="op" id="3967891">.</span><span class="ident" id="3967892">Equal</span><span class="op" id="3967897">(</span><span class="ident" id="3967898">oidAuthorityInfoAccessIssuers</span><span class="op" id="3967927">)</span>&nbsp;<span class="op" id="3967929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3967936">out</span><span class="op" id="3967939">.</span><span class="ident" id="3967940">IssuingCertificateURL</span>&nbsp;<span class="op" id="3967962">=</span>&nbsp;<span class="builtinfunc" id="3967964">append</span><span class="op" id="3967970">(</span><span class="ident" id="3967971">out</span><span class="op" id="3967974">.</span><span class="ident" id="3967975">IssuingCertificateURL</span><span class="op" id="3967996">,</span>&nbsp;<span class="builtintype" id="3967998">string</span><span class="op" id="3968004">(</span><span class="ident" id="3968005">v</span><span class="op" id="3968006">.</span><span class="ident" id="3968007">Location</span><span class="op" id="3968015">.</span><span class="ident" id="3968016">Bytes</span><span class="op" id="3968021">)</span><span class="op" id="3968022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3968028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3968033">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3968037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968042">if</span>&nbsp;<span class="ident" id="3968045">e</span><span class="op" id="3968046">.</span><span class="ident" id="3968047">Critical</span>&nbsp;<span class="op" id="3968056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968061">return</span>&nbsp;<span class="ident" id="3968068">out</span><span class="op" id="3968071">,</span>&nbsp;<span class="ident" id="3968073">UnhandledCriticalExtension</span><span class="op" id="3968099">{</span><span class="op" id="3968100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3968104">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3968107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968111">return</span>&nbsp;<span class="ident" id="3968118">out</span><span class="op" id="3968121">,</span>&nbsp;<span class="builtintype" id="3968123">nil</span><br>
<span class="lineno"></span><span class="op" id="3968127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1090</span><span class="comment" id="3968130">//&nbsp;ParseCertificate&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3968209">func</span>&nbsp;<span class="ident" id="3968214">ParseCertificate</span><span class="op" id="3968230">(</span><span class="ident" id="3968231">asn1Data</span>&nbsp;<span class="op" id="3968240">[</span><span class="op" id="3968241">]</span><span class="builtintype" id="3968242">byte</span><span class="op" id="3968246">)</span>&nbsp;<span class="op" id="3968248">(</span><span class="op" id="3968249">*</span><span class="ident" id="3968250">Certificate</span><span class="op" id="3968261">,</span>&nbsp;<span class="builtintype" id="3968263">error</span><span class="op" id="3968268">)</span>&nbsp;<span class="op" id="3968270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968273">var</span>&nbsp;<span class="ident" id="3968277">cert</span>&nbsp;<span class="ident" id="3968282">certificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3968295">rest</span><span class="op" id="3968299">,</span>&nbsp;<span class="ident" id="3968301">err</span>&nbsp;<span class="op" id="3968305">:=</span>&nbsp;<span class="ident" id="3968308">asn1</span><span class="op" id="3968312">.</span><span class="ident" id="3968313">Unmarshal</span><span class="op" id="3968322">(</span><span class="ident" id="3968323">asn1Data</span><span class="op" id="3968331">,</span>&nbsp;<span class="op" id="3968333">&amp;</span><span class="ident" id="3968334">cert</span><span class="op" id="3968338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968341">if</span>&nbsp;<span class="ident" id="3968344">err</span>&nbsp;<span class="op" id="3968348">!=</span>&nbsp;<span class="builtintype" id="3968351">nil</span>&nbsp;<span class="op" id="3968355">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968359">return</span>&nbsp;<span class="builtintype" id="3968366">nil</span><span class="op" id="3968369">,</span>&nbsp;<span class="ident" id="3968371">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3968376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968379">if</span>&nbsp;<span class="builtinfunc" id="3968382">len</span><span class="op" id="3968385">(</span><span class="ident" id="3968386">rest</span><span class="op" id="3968390">)</span>&nbsp;<span class="op" id="3968392">&gt;</span>&nbsp;<span class="num" id="3968394">0</span>&nbsp;<span class="op" id="3968396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968400">return</span>&nbsp;<span class="builtintype" id="3968407">nil</span><span class="op" id="3968410">,</span>&nbsp;<span class="ident" id="3968412">asn1</span><span class="op" id="3968416">.</span><span class="ident" id="3968417">SyntaxError</span><span class="op" id="3968428">{</span><span class="ident" id="3968429">Msg</span><span class="op" id="3968432">:</span>&nbsp;<span class="string" id="3968434">&#34;trailing&nbsp;data&#34;</span><span class="op" id="3968449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3968452">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968456">return</span>&nbsp;<span class="ident" id="3968463">parseCertificate</span><span class="op" id="3968479">(</span><span class="op" id="3968480">&amp;</span><span class="ident" id="3968481">cert</span><span class="op" id="3968485">)</span><br>
<span class="lineno"></span><span class="op" id="3968487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3968490">//&nbsp;ParseCertificates&nbsp;parses&nbsp;one&nbsp;or&nbsp;more&nbsp;certificates&nbsp;from&nbsp;the&nbsp;given&nbsp;ASN.1&nbsp;DER</span><br>
<span class="lineno">1105</span><span class="comment" id="3968568">//&nbsp;data.&nbsp;The&nbsp;certificates&nbsp;must&nbsp;be&nbsp;concatenated&nbsp;with&nbsp;no&nbsp;intermediate&nbsp;padding.</span><br>
<span class="lineno"></span><span class="keyword" id="3968645">func</span>&nbsp;<span class="ident" id="3968650">ParseCertificates</span><span class="op" id="3968667">(</span><span class="ident" id="3968668">asn1Data</span>&nbsp;<span class="op" id="3968677">[</span><span class="op" id="3968678">]</span><span class="builtintype" id="3968679">byte</span><span class="op" id="3968683">)</span>&nbsp;<span class="op" id="3968685">(</span><span class="op" id="3968686">[</span><span class="op" id="3968687">]</span><span class="op" id="3968688">*</span><span class="ident" id="3968689">Certificate</span><span class="op" id="3968700">,</span>&nbsp;<span class="builtintype" id="3968702">error</span><span class="op" id="3968707">)</span>&nbsp;<span class="op" id="3968709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968712">var</span>&nbsp;<span class="ident" id="3968716">v</span>&nbsp;<span class="op" id="3968718">[</span><span class="op" id="3968719">]</span><span class="op" id="3968720">*</span><span class="ident" id="3968721">certificate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968735">for</span>&nbsp;<span class="builtinfunc" id="3968739">len</span><span class="op" id="3968742">(</span><span class="ident" id="3968743">asn1Data</span><span class="op" id="3968751">)</span>&nbsp;<span class="op" id="3968753">&gt;</span>&nbsp;<span class="num" id="3968755">0</span>&nbsp;<span class="op" id="3968757">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3968761">cert</span>&nbsp;<span class="op" id="3968766">:=</span>&nbsp;<span class="builtinfunc" id="3968769">new</span><span class="op" id="3968772">(</span><span class="ident" id="3968773">certificate</span><span class="op" id="3968784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968788">var</span>&nbsp;<span class="ident" id="3968792">err</span>&nbsp;<span class="builtintype" id="3968796">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3968804">asn1Data</span><span class="op" id="3968812">,</span>&nbsp;<span class="ident" id="3968814">err</span>&nbsp;<span class="op" id="3968818">=</span>&nbsp;<span class="ident" id="3968820">asn1</span><span class="op" id="3968824">.</span><span class="ident" id="3968825">Unmarshal</span><span class="op" id="3968834">(</span><span class="ident" id="3968835">asn1Data</span><span class="op" id="3968843">,</span>&nbsp;<span class="ident" id="3968845">cert</span><span class="op" id="3968849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968853">if</span>&nbsp;<span class="ident" id="3968856">err</span>&nbsp;<span class="op" id="3968860">!=</span>&nbsp;<span class="builtintype" id="3968863">nil</span>&nbsp;<span class="op" id="3968867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968872">return</span>&nbsp;<span class="builtintype" id="3968879">nil</span><span class="op" id="3968882">,</span>&nbsp;<span class="ident" id="3968884">err</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3968890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3968894">v</span>&nbsp;<span class="op" id="3968896">=</span>&nbsp;<span class="builtinfunc" id="3968898">append</span><span class="op" id="3968904">(</span><span class="ident" id="3968905">v</span><span class="op" id="3968906">,</span>&nbsp;<span class="ident" id="3968908">cert</span><span class="op" id="3968912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3968915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3968919">ret</span>&nbsp;<span class="op" id="3968923">:=</span>&nbsp;<span class="builtinfunc" id="3968926">make</span><span class="op" id="3968930">(</span><span class="op" id="3968931">[</span><span class="op" id="3968932">]</span><span class="op" id="3968933">*</span><span class="ident" id="3968934">Certificate</span><span class="op" id="3968945">,</span>&nbsp;<span class="builtinfunc" id="3968947">len</span><span class="op" id="3968950">(</span><span class="ident" id="3968951">v</span><span class="op" id="3968952">)</span><span class="op" id="3968953">)</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3968956">for</span>&nbsp;<span class="ident" id="3968960">i</span><span class="op" id="3968961">,</span>&nbsp;<span class="ident" id="3968963">ci</span>&nbsp;<span class="op" id="3968966">:=</span>&nbsp;<span class="keyword" id="3968969">range</span>&nbsp;<span class="ident" id="3968975">v</span>&nbsp;<span class="op" id="3968977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3968981">cert</span><span class="op" id="3968985">,</span>&nbsp;<span class="ident" id="3968987">err</span>&nbsp;<span class="op" id="3968991">:=</span>&nbsp;<span class="ident" id="3968994">parseCertificate</span><span class="op" id="3969010">(</span><span class="ident" id="3969011">ci</span><span class="op" id="3969013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3969017">if</span>&nbsp;<span class="ident" id="3969020">err</span>&nbsp;<span class="op" id="3969024">!=</span>&nbsp;<span class="builtintype" id="3969027">nil</span>&nbsp;<span class="op" id="3969031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3969036">return</span>&nbsp;<span class="builtintype" id="3969043">nil</span><span class="op" id="3969046">,</span>&nbsp;<span class="ident" id="3969048">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3969054">}</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969058">ret</span><span class="op" id="3969061">[</span><span class="ident" id="3969062">i</span><span class="op" id="3969063">]</span>&nbsp;<span class="op" id="3969065">=</span>&nbsp;<span class="ident" id="3969067">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3969073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3969077">return</span>&nbsp;<span class="ident" id="3969084">ret</span><span class="op" id="3969087">,</span>&nbsp;<span class="builtintype" id="3969089">nil</span><br>
<span class="lineno"></span><span class="op" id="3969093">}</span><br>
<span class="lineno">1130</span><br>
<span class="lineno"></span><span class="keyword" id="3969096">func</span>&nbsp;<span class="ident" id="3969101">reverseBitsInAByte</span><span class="op" id="3969119">(</span><span class="ident" id="3969120">in</span>&nbsp;<span class="builtintype" id="3969123">byte</span><span class="op" id="3969127">)</span>&nbsp;<span class="builtintype" id="3969129">byte</span>&nbsp;<span class="op" id="3969134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969137">b1</span>&nbsp;<span class="op" id="3969140">:=</span>&nbsp;<span class="ident" id="3969143">in</span><span class="op" id="3969145">&gt;&gt;</span><span class="num" id="3969147">4</span>&nbsp;<span class="op" id="3969149">|</span>&nbsp;<span class="ident" id="3969151">in</span><span class="op" id="3969153">&lt;&lt;</span><span class="num" id="3969155">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969158">b2</span>&nbsp;<span class="op" id="3969161">:=</span>&nbsp;<span class="ident" id="3969164">b1</span><span class="op" id="3969166">&gt;&gt;</span><span class="num" id="3969168">2</span><span class="op" id="3969169">&amp;</span><span class="num" id="3969170">0x33</span>&nbsp;<span class="op" id="3969175">|</span>&nbsp;<span class="ident" id="3969177">b1</span><span class="op" id="3969179">&lt;&lt;</span><span class="num" id="3969181">2</span><span class="op" id="3969182">&amp;</span><span class="num" id="3969183">0xcc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969189">b3</span>&nbsp;<span class="op" id="3969192">:=</span>&nbsp;<span class="ident" id="3969195">b2</span><span class="op" id="3969197">&gt;&gt;</span><span class="num" id="3969199">1</span><span class="op" id="3969200">&amp;</span><span class="num" id="3969201">0x55</span>&nbsp;<span class="op" id="3969206">|</span>&nbsp;<span class="ident" id="3969208">b2</span><span class="op" id="3969210">&lt;&lt;</span><span class="num" id="3969212">1</span><span class="op" id="3969213">&amp;</span><span class="num" id="3969214">0xaa</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3969220">return</span>&nbsp;<span class="ident" id="3969227">b3</span><br>
<span class="lineno"></span><span class="op" id="3969230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3969233">var</span>&nbsp;<span class="op" id="3969237">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969240">oidExtensionSubjectKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3969274">=</span>&nbsp;<span class="op" id="3969276">[</span><span class="op" id="3969277">]</span><span class="builtintype" id="3969278">int</span><span class="op" id="3969281">{</span><span class="num" id="3969282">2</span><span class="op" id="3969283">,</span>&nbsp;<span class="num" id="3969285">5</span><span class="op" id="3969286">,</span>&nbsp;<span class="num" id="3969288">29</span><span class="op" id="3969290">,</span>&nbsp;<span class="num" id="3969292">14</span><span class="op" id="3969294">}</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969297">oidExtensionKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3969331">=</span>&nbsp;<span class="op" id="3969333">[</span><span class="op" id="3969334">]</span><span class="builtintype" id="3969335">int</span><span class="op" id="3969338">{</span><span class="num" id="3969339">2</span><span class="op" id="3969340">,</span>&nbsp;<span class="num" id="3969342">5</span><span class="op" id="3969343">,</span>&nbsp;<span class="num" id="3969345">29</span><span class="op" id="3969347">,</span>&nbsp;<span class="num" id="3969349">15</span><span class="op" id="3969351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969354">oidExtensionExtendedKeyUsage</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3969388">=</span>&nbsp;<span class="op" id="3969390">[</span><span class="op" id="3969391">]</span><span class="builtintype" id="3969392">int</span><span class="op" id="3969395">{</span><span class="num" id="3969396">2</span><span class="op" id="3969397">,</span>&nbsp;<span class="num" id="3969399">5</span><span class="op" id="3969400">,</span>&nbsp;<span class="num" id="3969402">29</span><span class="op" id="3969404">,</span>&nbsp;<span class="num" id="3969406">37</span><span class="op" id="3969408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969411">oidExtensionAuthorityKeyId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3969445">=</span>&nbsp;<span class="op" id="3969447">[</span><span class="op" id="3969448">]</span><span class="builtintype" id="3969449">int</span><span class="op" id="3969452">{</span><span class="num" id="3969453">2</span><span class="op" id="3969454">,</span>&nbsp;<span class="num" id="3969456">5</span><span class="op" id="3969457">,</span>&nbsp;<span class="num" id="3969459">29</span><span class="op" id="3969461">,</span>&nbsp;<span class="num" id="3969463">35</span><span class="op" id="3969465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969468">oidExtensionBasicConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3969502">=</span>&nbsp;<span class="op" id="3969504">[</span><span class="op" id="3969505">]</span><span class="builtintype" id="3969506">int</span><span class="op" id="3969509">{</span><span class="num" id="3969510">2</span><span class="op" id="3969511">,</span>&nbsp;<span class="num" id="3969513">5</span><span class="op" id="3969514">,</span>&nbsp;<span class="num" id="3969516">29</span><span class="op" id="3969518">,</span>&nbsp;<span class="num" id="3969520">19</span><span class="op" id="3969522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969525">oidExtensionSubjectAltName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3969559">=</span>&nbsp;<span class="op" id="3969561">[</span><span class="op" id="3969562">]</span><span class="builtintype" id="3969563">int</span><span class="op" id="3969566">{</span><span class="num" id="3969567">2</span><span class="op" id="3969568">,</span>&nbsp;<span class="num" id="3969570">5</span><span class="op" id="3969571">,</span>&nbsp;<span class="num" id="3969573">29</span><span class="op" id="3969575">,</span>&nbsp;<span class="num" id="3969577">17</span><span class="op" id="3969579">}</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969582">oidExtensionCertificatePolicies</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3969616">=</span>&nbsp;<span class="op" id="3969618">[</span><span class="op" id="3969619">]</span><span class="builtintype" id="3969620">int</span><span class="op" id="3969623">{</span><span class="num" id="3969624">2</span><span class="op" id="3969625">,</span>&nbsp;<span class="num" id="3969627">5</span><span class="op" id="3969628">,</span>&nbsp;<span class="num" id="3969630">29</span><span class="op" id="3969632">,</span>&nbsp;<span class="num" id="3969634">32</span><span class="op" id="3969636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969639">oidExtensionNameConstraints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3969673">=</span>&nbsp;<span class="op" id="3969675">[</span><span class="op" id="3969676">]</span><span class="builtintype" id="3969677">int</span><span class="op" id="3969680">{</span><span class="num" id="3969681">2</span><span class="op" id="3969682">,</span>&nbsp;<span class="num" id="3969684">5</span><span class="op" id="3969685">,</span>&nbsp;<span class="num" id="3969687">29</span><span class="op" id="3969689">,</span>&nbsp;<span class="num" id="3969691">30</span><span class="op" id="3969693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969696">oidExtensionCRLDistributionPoints</span>&nbsp;<span class="op" id="3969730">=</span>&nbsp;<span class="op" id="3969732">[</span><span class="op" id="3969733">]</span><span class="builtintype" id="3969734">int</span><span class="op" id="3969737">{</span><span class="num" id="3969738">2</span><span class="op" id="3969739">,</span>&nbsp;<span class="num" id="3969741">5</span><span class="op" id="3969742">,</span>&nbsp;<span class="num" id="3969744">29</span><span class="op" id="3969746">,</span>&nbsp;<span class="num" id="3969748">31</span><span class="op" id="3969750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969753">oidExtensionAuthorityInfoAccess</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3969787">=</span>&nbsp;<span class="op" id="3969789">[</span><span class="op" id="3969790">]</span><span class="builtintype" id="3969791">int</span><span class="op" id="3969794">{</span><span class="num" id="3969795">1</span><span class="op" id="3969796">,</span>&nbsp;<span class="num" id="3969798">3</span><span class="op" id="3969799">,</span>&nbsp;<span class="num" id="3969801">6</span><span class="op" id="3969802">,</span>&nbsp;<span class="num" id="3969804">1</span><span class="op" id="3969805">,</span>&nbsp;<span class="num" id="3969807">5</span><span class="op" id="3969808">,</span>&nbsp;<span class="num" id="3969810">5</span><span class="op" id="3969811">,</span>&nbsp;<span class="num" id="3969813">7</span><span class="op" id="3969814">,</span>&nbsp;<span class="num" id="3969816">1</span><span class="op" id="3969817">,</span>&nbsp;<span class="num" id="3969819">1</span><span class="op" id="3969820">}</span><br>
<span class="lineno"></span><span class="op" id="3969822">)</span><br>
<span class="lineno">1150</span><br>
<span class="lineno"></span><span class="keyword" id="3969825">var</span>&nbsp;<span class="op" id="3969829">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969832">oidAuthorityInfoAccessOcsp</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3969862">=</span>&nbsp;<span class="ident" id="3969864">asn1</span><span class="op" id="3969868">.</span><span class="ident" id="3969869">ObjectIdentifier</span><span class="op" id="3969885">{</span><span class="num" id="3969886">1</span><span class="op" id="3969887">,</span>&nbsp;<span class="num" id="3969889">3</span><span class="op" id="3969890">,</span>&nbsp;<span class="num" id="3969892">6</span><span class="op" id="3969893">,</span>&nbsp;<span class="num" id="3969895">1</span><span class="op" id="3969896">,</span>&nbsp;<span class="num" id="3969898">5</span><span class="op" id="3969899">,</span>&nbsp;<span class="num" id="3969901">5</span><span class="op" id="3969902">,</span>&nbsp;<span class="num" id="3969904">7</span><span class="op" id="3969905">,</span>&nbsp;<span class="num" id="3969907">48</span><span class="op" id="3969909">,</span>&nbsp;<span class="num" id="3969911">1</span><span class="op" id="3969912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3969915">oidAuthorityInfoAccessIssuers</span>&nbsp;<span class="op" id="3969945">=</span>&nbsp;<span class="ident" id="3969947">asn1</span><span class="op" id="3969951">.</span><span class="ident" id="3969952">ObjectIdentifier</span><span class="op" id="3969968">{</span><span class="num" id="3969969">1</span><span class="op" id="3969970">,</span>&nbsp;<span class="num" id="3969972">3</span><span class="op" id="3969973">,</span>&nbsp;<span class="num" id="3969975">6</span><span class="op" id="3969976">,</span>&nbsp;<span class="num" id="3969978">1</span><span class="op" id="3969979">,</span>&nbsp;<span class="num" id="3969981">5</span><span class="op" id="3969982">,</span>&nbsp;<span class="num" id="3969984">5</span><span class="op" id="3969985">,</span>&nbsp;<span class="num" id="3969987">7</span><span class="op" id="3969988">,</span>&nbsp;<span class="num" id="3969990">48</span><span class="op" id="3969992">,</span>&nbsp;<span class="num" id="3969994">2</span><span class="op" id="3969995">}</span><br>
<span class="lineno"></span><span class="op" id="3969997">)</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="comment" id="3970000">//&nbsp;oidNotInExtensions&nbsp;returns&nbsp;whether&nbsp;an&nbsp;extension&nbsp;with&nbsp;the&nbsp;given&nbsp;oid&nbsp;exists&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3970080">//&nbsp;extensions.</span><br>
<span class="lineno"></span><span class="keyword" id="3970095">func</span>&nbsp;<span class="ident" id="3970100">oidInExtensions</span><span class="op" id="3970115">(</span><span class="ident" id="3970116">oid</span>&nbsp;<span class="ident" id="3970120">asn1</span><span class="op" id="3970124">.</span><span class="ident" id="3970125">ObjectIdentifier</span><span class="op" id="3970141">,</span>&nbsp;<span class="ident" id="3970143">extensions</span>&nbsp;<span class="op" id="3970154">[</span><span class="op" id="3970155">]</span><span class="ident" id="3970156">pkix</span><span class="op" id="3970160">.</span><span class="ident" id="3970161">Extension</span><span class="op" id="3970170">)</span>&nbsp;<span class="builtintype" id="3970172">bool</span>&nbsp;<span class="op" id="3970177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3970180">for</span>&nbsp;<span class="ident" id="3970184">_</span><span class="op" id="3970185">,</span>&nbsp;<span class="ident" id="3970187">e</span>&nbsp;<span class="op" id="3970189">:=</span>&nbsp;<span class="keyword" id="3970192">range</span>&nbsp;<span class="ident" id="3970198">extensions</span>&nbsp;<span class="op" id="3970209">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3970213">if</span>&nbsp;<span class="ident" id="3970216">e</span><span class="op" id="3970217">.</span><span class="ident" id="3970218">Id</span><span class="op" id="3970220">.</span><span class="ident" id="3970221">Equal</span><span class="op" id="3970226">(</span><span class="ident" id="3970227">oid</span><span class="op" id="3970230">)</span>&nbsp;<span class="op" id="3970232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3970237">return</span>&nbsp;<span class="builtintype" id="3970244">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3970251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3970254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3970257">return</span>&nbsp;<span class="builtintype" id="3970264">false</span><br>
<span class="lineno">1165</span><span class="op" id="3970270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3970273">//&nbsp;marshalSANs&nbsp;marshals&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses&nbsp;into&nbsp;a&nbsp;the&nbsp;contents&nbsp;of&nbsp;an&nbsp;X.509</span><br>
<span class="lineno"></span><span class="comment" id="3970349">//&nbsp;SubjectAlternativeName&nbsp;extension.</span><br>
<span class="lineno"></span><span class="keyword" id="3970386">func</span>&nbsp;<span class="ident" id="3970391">marshalSANs</span><span class="op" id="3970402">(</span><span class="ident" id="3970403">dnsNames</span><span class="op" id="3970411">,</span>&nbsp;<span class="ident" id="3970413">emailAddresses</span>&nbsp;<span class="op" id="3970428">[</span><span class="op" id="3970429">]</span><span class="builtintype" id="3970430">string</span><span class="op" id="3970436">,</span>&nbsp;<span class="ident" id="3970438">ipAddresses</span>&nbsp;<span class="op" id="3970450">[</span><span class="op" id="3970451">]</span><span class="ident" id="3970452">net</span><span class="op" id="3970455">.</span><span class="ident" id="3970456">IP</span><span class="op" id="3970458">)</span>&nbsp;<span class="op" id="3970460">(</span><span class="ident" id="3970461">derBytes</span>&nbsp;<span class="op" id="3970470">[</span><span class="op" id="3970471">]</span><span class="builtintype" id="3970472">byte</span><span class="op" id="3970476">,</span>&nbsp;<span class="ident" id="3970478">err</span>&nbsp;<span class="builtintype" id="3970482">error</span><span class="op" id="3970487">)</span>&nbsp;<span class="op" id="3970489">{</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3970492">var</span>&nbsp;<span class="ident" id="3970496">rawValues</span>&nbsp;<span class="op" id="3970506">[</span><span class="op" id="3970507">]</span><span class="ident" id="3970508">asn1</span><span class="op" id="3970512">.</span><span class="ident" id="3970513">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3970523">for</span>&nbsp;<span class="ident" id="3970527">_</span><span class="op" id="3970528">,</span>&nbsp;<span class="ident" id="3970530">name</span>&nbsp;<span class="op" id="3970535">:=</span>&nbsp;<span class="keyword" id="3970538">range</span>&nbsp;<span class="ident" id="3970544">dnsNames</span>&nbsp;<span class="op" id="3970553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3970557">rawValues</span>&nbsp;<span class="op" id="3970567">=</span>&nbsp;<span class="builtinfunc" id="3970569">append</span><span class="op" id="3970575">(</span><span class="ident" id="3970576">rawValues</span><span class="op" id="3970585">,</span>&nbsp;<span class="ident" id="3970587">asn1</span><span class="op" id="3970591">.</span><span class="ident" id="3970592">RawValue</span><span class="op" id="3970600">{</span><span class="ident" id="3970601">Tag</span><span class="op" id="3970604">:</span>&nbsp;<span class="num" id="3970606">2</span><span class="op" id="3970607">,</span>&nbsp;<span class="ident" id="3970609">Class</span><span class="op" id="3970614">:</span>&nbsp;<span class="num" id="3970616">2</span><span class="op" id="3970617">,</span>&nbsp;<span class="ident" id="3970619">Bytes</span><span class="op" id="3970624">:</span>&nbsp;<span class="op" id="3970626">[</span><span class="op" id="3970627">]</span><span class="builtintype" id="3970628">byte</span><span class="op" id="3970632">(</span><span class="ident" id="3970633">name</span><span class="op" id="3970637">)</span><span class="op" id="3970638">}</span><span class="op" id="3970639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3970642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3970645">for</span>&nbsp;<span class="ident" id="3970649">_</span><span class="op" id="3970650">,</span>&nbsp;<span class="ident" id="3970652">email</span>&nbsp;<span class="op" id="3970658">:=</span>&nbsp;<span class="keyword" id="3970661">range</span>&nbsp;<span class="ident" id="3970667">emailAddresses</span>&nbsp;<span class="op" id="3970682">{</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3970686">rawValues</span>&nbsp;<span class="op" id="3970696">=</span>&nbsp;<span class="builtinfunc" id="3970698">append</span><span class="op" id="3970704">(</span><span class="ident" id="3970705">rawValues</span><span class="op" id="3970714">,</span>&nbsp;<span class="ident" id="3970716">asn1</span><span class="op" id="3970720">.</span><span class="ident" id="3970721">RawValue</span><span class="op" id="3970729">{</span><span class="ident" id="3970730">Tag</span><span class="op" id="3970733">:</span>&nbsp;<span class="num" id="3970735">1</span><span class="op" id="3970736">,</span>&nbsp;<span class="ident" id="3970738">Class</span><span class="op" id="3970743">:</span>&nbsp;<span class="num" id="3970745">2</span><span class="op" id="3970746">,</span>&nbsp;<span class="ident" id="3970748">Bytes</span><span class="op" id="3970753">:</span>&nbsp;<span class="op" id="3970755">[</span><span class="op" id="3970756">]</span><span class="builtintype" id="3970757">byte</span><span class="op" id="3970761">(</span><span class="ident" id="3970762">email</span><span class="op" id="3970767">)</span><span class="op" id="3970768">}</span><span class="op" id="3970769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3970772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3970775">for</span>&nbsp;<span class="ident" id="3970779">_</span><span class="op" id="3970780">,</span>&nbsp;<span class="ident" id="3970782">rawIP</span>&nbsp;<span class="op" id="3970788">:=</span>&nbsp;<span class="keyword" id="3970791">range</span>&nbsp;<span class="ident" id="3970797">ipAddresses</span>&nbsp;<span class="op" id="3970809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3970813">//&nbsp;If&nbsp;possible,&nbsp;we&nbsp;always&nbsp;want&nbsp;to&nbsp;encode&nbsp;IPv4&nbsp;addresses&nbsp;in&nbsp;4&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3970883">ip</span>&nbsp;<span class="op" id="3970886">:=</span>&nbsp;<span class="ident" id="3970889">rawIP</span><span class="op" id="3970894">.</span><span class="ident" id="3970895">To4</span><span class="op" id="3970898">(</span><span class="op" id="3970899">)</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3970903">if</span>&nbsp;<span class="ident" id="3970906">ip</span>&nbsp;<span class="op" id="3970909">==</span>&nbsp;<span class="builtintype" id="3970912">nil</span>&nbsp;<span class="op" id="3970916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3970921">ip</span>&nbsp;<span class="op" id="3970924">=</span>&nbsp;<span class="ident" id="3970926">rawIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3970934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3970938">rawValues</span>&nbsp;<span class="op" id="3970948">=</span>&nbsp;<span class="builtinfunc" id="3970950">append</span><span class="op" id="3970956">(</span><span class="ident" id="3970957">rawValues</span><span class="op" id="3970966">,</span>&nbsp;<span class="ident" id="3970968">asn1</span><span class="op" id="3970972">.</span><span class="ident" id="3970973">RawValue</span><span class="op" id="3970981">{</span><span class="ident" id="3970982">Tag</span><span class="op" id="3970985">:</span>&nbsp;<span class="num" id="3970987">7</span><span class="op" id="3970988">,</span>&nbsp;<span class="ident" id="3970990">Class</span><span class="op" id="3970995">:</span>&nbsp;<span class="num" id="3970997">2</span><span class="op" id="3970998">,</span>&nbsp;<span class="ident" id="3971000">Bytes</span><span class="op" id="3971005">:</span>&nbsp;<span class="ident" id="3971007">ip</span><span class="op" id="3971009">}</span><span class="op" id="3971010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3971013">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971016">return</span>&nbsp;<span class="ident" id="3971023">asn1</span><span class="op" id="3971027">.</span><span class="ident" id="3971028">Marshal</span><span class="op" id="3971035">(</span><span class="ident" id="3971036">rawValues</span><span class="op" id="3971045">)</span><br>
<span class="lineno"></span><span class="op" id="3971047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3971050">func</span>&nbsp;<span class="ident" id="3971055">buildExtensions</span><span class="op" id="3971070">(</span><span class="ident" id="3971071">template</span>&nbsp;<span class="op" id="3971080">*</span><span class="ident" id="3971081">Certificate</span><span class="op" id="3971092">)</span>&nbsp;<span class="op" id="3971094">(</span><span class="ident" id="3971095">ret</span>&nbsp;<span class="op" id="3971099">[</span><span class="op" id="3971100">]</span><span class="ident" id="3971101">pkix</span><span class="op" id="3971105">.</span><span class="ident" id="3971106">Extension</span><span class="op" id="3971115">,</span>&nbsp;<span class="ident" id="3971117">err</span>&nbsp;<span class="builtintype" id="3971121">error</span><span class="op" id="3971126">)</span>&nbsp;<span class="op" id="3971128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971131">ret</span>&nbsp;<span class="op" id="3971135">=</span>&nbsp;<span class="builtinfunc" id="3971137">make</span><span class="op" id="3971141">(</span><span class="op" id="3971142">[</span><span class="op" id="3971143">]</span><span class="ident" id="3971144">pkix</span><span class="op" id="3971148">.</span><span class="ident" id="3971149">Extension</span><span class="op" id="3971158">,</span>&nbsp;<span class="num" id="3971160">10</span>&nbsp;<span class="comment" id="3971163">/*&nbsp;maximum&nbsp;number&nbsp;of&nbsp;elements.&nbsp;*/</span><span class="op" id="3971196">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971199">n</span>&nbsp;<span class="op" id="3971201">:=</span>&nbsp;<span class="num" id="3971204">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971208">if</span>&nbsp;<span class="ident" id="3971211">template</span><span class="op" id="3971219">.</span><span class="ident" id="3971220">KeyUsage</span>&nbsp;<span class="op" id="3971229">!=</span>&nbsp;<span class="num" id="3971232">0</span>&nbsp;<span class="op" id="3971234">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3971239">!</span><span class="ident" id="3971240">oidInExtensions</span><span class="op" id="3971255">(</span><span class="ident" id="3971256">oidExtensionKeyUsage</span><span class="op" id="3971276">,</span>&nbsp;<span class="ident" id="3971278">template</span><span class="op" id="3971286">.</span><span class="ident" id="3971287">ExtraExtensions</span><span class="op" id="3971302">)</span>&nbsp;<span class="op" id="3971304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971308">ret</span><span class="op" id="3971311">[</span><span class="ident" id="3971312">n</span><span class="op" id="3971313">]</span><span class="op" id="3971314">.</span><span class="ident" id="3971315">Id</span>&nbsp;<span class="op" id="3971318">=</span>&nbsp;<span class="ident" id="3971320">oidExtensionKeyUsage</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971343">ret</span><span class="op" id="3971346">[</span><span class="ident" id="3971347">n</span><span class="op" id="3971348">]</span><span class="op" id="3971349">.</span><span class="ident" id="3971350">Critical</span>&nbsp;<span class="op" id="3971359">=</span>&nbsp;<span class="builtintype" id="3971361">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971369">var</span>&nbsp;<span class="ident" id="3971373">a</span>&nbsp;<span class="op" id="3971375">[</span><span class="num" id="3971376">2</span><span class="op" id="3971377">]</span><span class="builtintype" id="3971378">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971385">a</span><span class="op" id="3971386">[</span><span class="num" id="3971387">0</span><span class="op" id="3971388">]</span>&nbsp;<span class="op" id="3971390">=</span>&nbsp;<span class="ident" id="3971392">reverseBitsInAByte</span><span class="op" id="3971410">(</span><span class="builtintype" id="3971411">byte</span><span class="op" id="3971415">(</span><span class="ident" id="3971416">template</span><span class="op" id="3971424">.</span><span class="ident" id="3971425">KeyUsage</span><span class="op" id="3971433">)</span><span class="op" id="3971434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971438">a</span><span class="op" id="3971439">[</span><span class="num" id="3971440">1</span><span class="op" id="3971441">]</span>&nbsp;<span class="op" id="3971443">=</span>&nbsp;<span class="ident" id="3971445">reverseBitsInAByte</span><span class="op" id="3971463">(</span><span class="builtintype" id="3971464">byte</span><span class="op" id="3971468">(</span><span class="ident" id="3971469">template</span><span class="op" id="3971477">.</span><span class="ident" id="3971478">KeyUsage</span>&nbsp;<span class="op" id="3971487">&gt;&gt;</span>&nbsp;<span class="num" id="3971490">8</span><span class="op" id="3971491">)</span><span class="op" id="3971492">)</span><br>
<span class="lineno">1200</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971497">l</span>&nbsp;<span class="op" id="3971499">:=</span>&nbsp;<span class="num" id="3971502">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971506">if</span>&nbsp;<span class="ident" id="3971509">a</span><span class="op" id="3971510">[</span><span class="num" id="3971511">1</span><span class="op" id="3971512">]</span>&nbsp;<span class="op" id="3971514">!=</span>&nbsp;<span class="num" id="3971517">0</span>&nbsp;<span class="op" id="3971519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971524">l</span>&nbsp;<span class="op" id="3971526">=</span>&nbsp;<span class="num" id="3971528">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3971532">}</span><br>
<span class="lineno">1205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971537">ret</span><span class="op" id="3971540">[</span><span class="ident" id="3971541">n</span><span class="op" id="3971542">]</span><span class="op" id="3971543">.</span><span class="ident" id="3971544">Value</span><span class="op" id="3971549">,</span>&nbsp;<span class="ident" id="3971551">err</span>&nbsp;<span class="op" id="3971555">=</span>&nbsp;<span class="ident" id="3971557">asn1</span><span class="op" id="3971561">.</span><span class="ident" id="3971562">Marshal</span><span class="op" id="3971569">(</span><span class="ident" id="3971570">asn1</span><span class="op" id="3971574">.</span><span class="ident" id="3971575">BitString</span><span class="op" id="3971584">{</span><span class="ident" id="3971585">Bytes</span><span class="op" id="3971590">:</span>&nbsp;<span class="ident" id="3971592">a</span><span class="op" id="3971593">[</span><span class="num" id="3971594">0</span><span class="op" id="3971595">:</span><span class="ident" id="3971596">l</span><span class="op" id="3971597">]</span><span class="op" id="3971598">,</span>&nbsp;<span class="ident" id="3971600">BitLength</span><span class="op" id="3971609">:</span>&nbsp;<span class="ident" id="3971611">l</span>&nbsp;<span class="op" id="3971613">*</span>&nbsp;<span class="num" id="3971615">8</span><span class="op" id="3971616">}</span><span class="op" id="3971617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971621">if</span>&nbsp;<span class="ident" id="3971624">err</span>&nbsp;<span class="op" id="3971628">!=</span>&nbsp;<span class="builtintype" id="3971631">nil</span>&nbsp;<span class="op" id="3971635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971640">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3971649">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971653">n</span><span class="op" id="3971654">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3971658">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971662">if</span>&nbsp;<span class="op" id="3971665">(</span><span class="builtinfunc" id="3971666">len</span><span class="op" id="3971669">(</span><span class="ident" id="3971670">template</span><span class="op" id="3971678">.</span><span class="ident" id="3971679">ExtKeyUsage</span><span class="op" id="3971690">)</span>&nbsp;<span class="op" id="3971692">&gt;</span>&nbsp;<span class="num" id="3971694">0</span>&nbsp;<span class="op" id="3971696">||</span>&nbsp;<span class="builtinfunc" id="3971699">len</span><span class="op" id="3971702">(</span><span class="ident" id="3971703">template</span><span class="op" id="3971711">.</span><span class="ident" id="3971712">UnknownExtKeyUsage</span><span class="op" id="3971730">)</span>&nbsp;<span class="op" id="3971732">&gt;</span>&nbsp;<span class="num" id="3971734">0</span><span class="op" id="3971735">)</span>&nbsp;<span class="op" id="3971737">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3971742">!</span><span class="ident" id="3971743">oidInExtensions</span><span class="op" id="3971758">(</span><span class="ident" id="3971759">oidExtensionExtendedKeyUsage</span><span class="op" id="3971787">,</span>&nbsp;<span class="ident" id="3971789">template</span><span class="op" id="3971797">.</span><span class="ident" id="3971798">ExtraExtensions</span><span class="op" id="3971813">)</span>&nbsp;<span class="op" id="3971815">{</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971819">ret</span><span class="op" id="3971822">[</span><span class="ident" id="3971823">n</span><span class="op" id="3971824">]</span><span class="op" id="3971825">.</span><span class="ident" id="3971826">Id</span>&nbsp;<span class="op" id="3971829">=</span>&nbsp;<span class="ident" id="3971831">oidExtensionExtendedKeyUsage</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971863">var</span>&nbsp;<span class="ident" id="3971867">oids</span>&nbsp;<span class="op" id="3971872">[</span><span class="op" id="3971873">]</span><span class="ident" id="3971874">asn1</span><span class="op" id="3971878">.</span><span class="ident" id="3971879">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971898">for</span>&nbsp;<span class="ident" id="3971902">_</span><span class="op" id="3971903">,</span>&nbsp;<span class="ident" id="3971905">u</span>&nbsp;<span class="op" id="3971907">:=</span>&nbsp;<span class="keyword" id="3971910">range</span>&nbsp;<span class="ident" id="3971916">template</span><span class="op" id="3971924">.</span><span class="ident" id="3971925">ExtKeyUsage</span>&nbsp;<span class="op" id="3971937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3971942">if</span>&nbsp;<span class="ident" id="3971945">oid</span><span class="op" id="3971948">,</span>&nbsp;<span class="ident" id="3971950">ok</span>&nbsp;<span class="op" id="3971953">:=</span>&nbsp;<span class="ident" id="3971956">oidFromExtKeyUsage</span><span class="op" id="3971974">(</span><span class="ident" id="3971975">u</span><span class="op" id="3971976">)</span><span class="op" id="3971977">;</span>&nbsp;<span class="ident" id="3971979">ok</span>&nbsp;<span class="op" id="3971982">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3971988">oids</span>&nbsp;<span class="op" id="3971993">=</span>&nbsp;<span class="builtinfunc" id="3971995">append</span><span class="op" id="3972001">(</span><span class="ident" id="3972002">oids</span><span class="op" id="3972006">,</span>&nbsp;<span class="ident" id="3972008">oid</span><span class="op" id="3972011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972016">}</span>&nbsp;<span class="keyword" id="3972018">else</span>&nbsp;<span class="op" id="3972023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3972029">panic</span><span class="op" id="3972034">(</span><span class="string" id="3972035">&#34;internal&nbsp;error&#34;</span><span class="op" id="3972051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972060">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972065">oids</span>&nbsp;<span class="op" id="3972070">=</span>&nbsp;<span class="builtinfunc" id="3972072">append</span><span class="op" id="3972078">(</span><span class="ident" id="3972079">oids</span><span class="op" id="3972083">,</span>&nbsp;<span class="ident" id="3972085">template</span><span class="op" id="3972093">.</span><span class="ident" id="3972094">UnknownExtKeyUsage</span><span class="op" id="3972112">...</span><span class="op" id="3972115">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972120">ret</span><span class="op" id="3972123">[</span><span class="ident" id="3972124">n</span><span class="op" id="3972125">]</span><span class="op" id="3972126">.</span><span class="ident" id="3972127">Value</span><span class="op" id="3972132">,</span>&nbsp;<span class="ident" id="3972134">err</span>&nbsp;<span class="op" id="3972138">=</span>&nbsp;<span class="ident" id="3972140">asn1</span><span class="op" id="3972144">.</span><span class="ident" id="3972145">Marshal</span><span class="op" id="3972152">(</span><span class="ident" id="3972153">oids</span><span class="op" id="3972157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972161">if</span>&nbsp;<span class="ident" id="3972164">err</span>&nbsp;<span class="op" id="3972168">!=</span>&nbsp;<span class="builtintype" id="3972171">nil</span>&nbsp;<span class="op" id="3972175">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972180">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972193">n</span><span class="op" id="3972194">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972202">if</span>&nbsp;<span class="ident" id="3972205">template</span><span class="op" id="3972213">.</span><span class="ident" id="3972214">BasicConstraintsValid</span>&nbsp;<span class="op" id="3972236">&amp;&amp;</span>&nbsp;<span class="op" id="3972239">!</span><span class="ident" id="3972240">oidInExtensions</span><span class="op" id="3972255">(</span><span class="ident" id="3972256">oidExtensionBasicConstraints</span><span class="op" id="3972284">,</span>&nbsp;<span class="ident" id="3972286">template</span><span class="op" id="3972294">.</span><span class="ident" id="3972295">ExtraExtensions</span><span class="op" id="3972310">)</span>&nbsp;<span class="op" id="3972312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3972316">//&nbsp;Leaving&nbsp;MaxPathLen&nbsp;as&nbsp;zero&nbsp;indicates&nbsp;that&nbsp;no&nbsp;maximum&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3972379">//&nbsp;length&nbsp;is&nbsp;desired,&nbsp;unless&nbsp;MaxPathLenZero&nbsp;is&nbsp;set.&nbsp;A&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3972444">//&nbsp;-1&nbsp;causes&nbsp;encoding/asn1&nbsp;to&nbsp;omit&nbsp;the&nbsp;value&nbsp;as&nbsp;desired.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972503">maxPathLen</span>&nbsp;<span class="op" id="3972514">:=</span>&nbsp;<span class="ident" id="3972517">template</span><span class="op" id="3972525">.</span><span class="ident" id="3972526">MaxPathLen</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972539">if</span>&nbsp;<span class="ident" id="3972542">maxPathLen</span>&nbsp;<span class="op" id="3972553">==</span>&nbsp;<span class="num" id="3972556">0</span>&nbsp;<span class="op" id="3972558">&amp;&amp;</span>&nbsp;<span class="op" id="3972561">!</span><span class="ident" id="3972562">template</span><span class="op" id="3972570">.</span><span class="ident" id="3972571">MaxPathLenZero</span>&nbsp;<span class="op" id="3972586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972591">maxPathLen</span>&nbsp;<span class="op" id="3972602">=</span>&nbsp;<span class="op" id="3972604">-</span><span class="num" id="3972605">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972613">ret</span><span class="op" id="3972616">[</span><span class="ident" id="3972617">n</span><span class="op" id="3972618">]</span><span class="op" id="3972619">.</span><span class="ident" id="3972620">Id</span>&nbsp;<span class="op" id="3972623">=</span>&nbsp;<span class="ident" id="3972625">oidExtensionBasicConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972656">ret</span><span class="op" id="3972659">[</span><span class="ident" id="3972660">n</span><span class="op" id="3972661">]</span><span class="op" id="3972662">.</span><span class="ident" id="3972663">Value</span><span class="op" id="3972668">,</span>&nbsp;<span class="ident" id="3972670">err</span>&nbsp;<span class="op" id="3972674">=</span>&nbsp;<span class="ident" id="3972676">asn1</span><span class="op" id="3972680">.</span><span class="ident" id="3972681">Marshal</span><span class="op" id="3972688">(</span><span class="ident" id="3972689">basicConstraints</span><span class="op" id="3972705">{</span><span class="ident" id="3972706">template</span><span class="op" id="3972714">.</span><span class="ident" id="3972715">IsCA</span><span class="op" id="3972719">,</span>&nbsp;<span class="ident" id="3972721">maxPathLen</span><span class="op" id="3972731">}</span><span class="op" id="3972732">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972736">ret</span><span class="op" id="3972739">[</span><span class="ident" id="3972740">n</span><span class="op" id="3972741">]</span><span class="op" id="3972742">.</span><span class="ident" id="3972743">Critical</span>&nbsp;<span class="op" id="3972752">=</span>&nbsp;<span class="builtintype" id="3972754">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972761">if</span>&nbsp;<span class="ident" id="3972764">err</span>&nbsp;<span class="op" id="3972768">!=</span>&nbsp;<span class="builtintype" id="3972771">nil</span>&nbsp;<span class="op" id="3972775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972780">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972793">n</span><span class="op" id="3972794">++</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3972798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3972802">if</span>&nbsp;<span class="builtinfunc" id="3972805">len</span><span class="op" id="3972808">(</span><span class="ident" id="3972809">template</span><span class="op" id="3972817">.</span><span class="ident" id="3972818">SubjectKeyId</span><span class="op" id="3972830">)</span>&nbsp;<span class="op" id="3972832">&gt;</span>&nbsp;<span class="num" id="3972834">0</span>&nbsp;<span class="op" id="3972836">&amp;&amp;</span>&nbsp;<span class="op" id="3972839">!</span><span class="ident" id="3972840">oidInExtensions</span><span class="op" id="3972855">(</span><span class="ident" id="3972856">oidExtensionSubjectKeyId</span><span class="op" id="3972880">,</span>&nbsp;<span class="ident" id="3972882">template</span><span class="op" id="3972890">.</span><span class="ident" id="3972891">ExtraExtensions</span><span class="op" id="3972906">)</span>&nbsp;<span class="op" id="3972908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972912">ret</span><span class="op" id="3972915">[</span><span class="ident" id="3972916">n</span><span class="op" id="3972917">]</span><span class="op" id="3972918">.</span><span class="ident" id="3972919">Id</span>&nbsp;<span class="op" id="3972922">=</span>&nbsp;<span class="ident" id="3972924">oidExtensionSubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3972951">ret</span><span class="op" id="3972954">[</span><span class="ident" id="3972955">n</span><span class="op" id="3972956">]</span><span class="op" id="3972957">.</span><span class="ident" id="3972958">Value</span><span class="op" id="3972963">,</span>&nbsp;<span class="ident" id="3972965">err</span>&nbsp;<span class="op" id="3972969">=</span>&nbsp;<span class="ident" id="3972971">asn1</span><span class="op" id="3972975">.</span><span class="ident" id="3972976">Marshal</span><span class="op" id="3972983">(</span><span class="ident" id="3972984">template</span><span class="op" id="3972992">.</span><span class="ident" id="3972993">SubjectKeyId</span><span class="op" id="3973005">)</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3973009">if</span>&nbsp;<span class="ident" id="3973012">err</span>&nbsp;<span class="op" id="3973016">!=</span>&nbsp;<span class="builtintype" id="3973019">nil</span>&nbsp;<span class="op" id="3973023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3973028">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3973037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3973041">n</span><span class="op" id="3973042">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3973046">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3973050">if</span>&nbsp;<span class="builtinfunc" id="3973053">len</span><span class="op" id="3973056">(</span><span class="ident" id="3973057">template</span><span class="op" id="3973065">.</span><span class="ident" id="3973066">AuthorityKeyId</span><span class="op" id="3973080">)</span>&nbsp;<span class="op" id="3973082">&gt;</span>&nbsp;<span class="num" id="3973084">0</span>&nbsp;<span class="op" id="3973086">&amp;&amp;</span>&nbsp;<span class="op" id="3973089">!</span><span class="ident" id="3973090">oidInExtensions</span><span class="op" id="3973105">(</span><span class="ident" id="3973106">oidExtensionAuthorityKeyId</span><span class="op" id="3973132">,</span>&nbsp;<span class="ident" id="3973134">template</span><span class="op" id="3973142">.</span><span class="ident" id="3973143">ExtraExtensions</span><span class="op" id="3973158">)</span>&nbsp;<span class="op" id="3973160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3973164">ret</span><span class="op" id="3973167">[</span><span class="ident" id="3973168">n</span><span class="op" id="3973169">]</span><span class="op" id="3973170">.</span><span class="ident" id="3973171">Id</span>&nbsp;<span class="op" id="3973174">=</span>&nbsp;<span class="ident" id="3973176">oidExtensionAuthorityKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3973205">ret</span><span class="op" id="3973208">[</span><span class="ident" id="3973209">n</span><span class="op" id="3973210">]</span><span class="op" id="3973211">.</span><span class="ident" id="3973212">Value</span><span class="op" id="3973217">,</span>&nbsp;<span class="ident" id="3973219">err</span>&nbsp;<span class="op" id="3973223">=</span>&nbsp;<span class="ident" id="3973225">asn1</span><span class="op" id="3973229">.</span><span class="ident" id="3973230">Marshal</span><span class="op" id="3973237">(</span><span class="ident" id="3973238">authKeyId</span><span class="op" id="3973247">{</span><span class="ident" id="3973248">template</span><span class="op" id="3973256">.</span><span class="ident" id="3973257">AuthorityKeyId</span><span class="op" id="3973271">}</span><span class="op" id="3973272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3973276">if</span>&nbsp;<span class="ident" id="3973279">err</span>&nbsp;<span class="op" id="3973283">!=</span>&nbsp;<span class="builtintype" id="3973286">nil</span>&nbsp;<span class="op" id="3973290">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3973295">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3973304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3973308">n</span><span class="op" id="3973309">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3973313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3973317">if</span>&nbsp;<span class="op" id="3973320">(</span><span class="builtinfunc" id="3973321">len</span><span class="op" id="3973324">(</span><span class="ident" id="3973325">template</span><span class="op" id="3973333">.</span><span class="ident" id="3973334">OCSPServer</span><span class="op" id="3973344">)</span>&nbsp;<span class="op" id="3973346">&gt;</span>&nbsp;<span class="num" id="3973348">0</span>&nbsp;<span class="op" id="3973350">||</span>&nbsp;<span class="builtinfunc" id="3973353">len</span><span class="op" id="3973356">(</span><span class="ident" id="3973357">template</span><span class="op" id="3973365">.</span><span class="ident" id="3973366">IssuingCertificateURL</span><span class="op" id="3973387">)</span>&nbsp;<span class="op" id="3973389">&gt;</span>&nbsp;<span class="num" id="3973391">0</span><span class="op" id="3973392">)</span>&nbsp;<span class="op" id="3973394">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3973399">!</span><span class="ident" id="3973400">oidInExtensions</span><span class="op" id="3973415">(</span><span class="ident" id="3973416">oidExtensionAuthorityInfoAccess</span><span class="op" id="3973447">,</span>&nbsp;<span class="ident" id="3973449">template</span><span class="op" id="3973457">.</span><span class="ident" id="3973458">ExtraExtensions</span><span class="op" id="3973473">)</span>&nbsp;<span class="op" id="3973475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3973479">ret</span><span class="op" id="3973482">[</span><span class="ident" id="3973483">n</span><span class="op" id="3973484">]</span><span class="op" id="3973485">.</span><span class="ident" id="3973486">Id</span>&nbsp;<span class="op" id="3973489">=</span>&nbsp;<span class="ident" id="3973491">oidExtensionAuthorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3973525">var</span>&nbsp;<span class="ident" id="3973529">aiaValues</span>&nbsp;<span class="op" id="3973539">[</span><span class="op" id="3973540">]</span><span class="ident" id="3973541">authorityInfoAccess</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3973563">for</span>&nbsp;<span class="ident" id="3973567">_</span><span class="op" id="3973568">,</span>&nbsp;<span class="ident" id="3973570">name</span>&nbsp;<span class="op" id="3973575">:=</span>&nbsp;<span class="keyword" id="3973578">range</span>&nbsp;<span class="ident" id="3973584">template</span><span class="op" id="3973592">.</span><span class="ident" id="3973593">OCSPServer</span>&nbsp;<span class="op" id="3973604">{</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3973609">aiaValues</span>&nbsp;<span class="op" id="3973619">=</span>&nbsp;<span class="builtinfunc" id="3973621">append</span><span class="op" id="3973627">(</span><span class="ident" id="3973628">aiaValues</span><span class="op" id="3973637">,</span>&nbsp;<span class="ident" id="3973639">authorityInfoAccess</span><span class="op" id="3973658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3973664">Method</span><span class="op" id="3973670">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3973674">oidAuthorityInfoAccessOcsp</span><span class="op" id="3973700">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3973706">Location</span><span class="op" id="3973714">:</span>&nbsp;<span class="ident" id="3973716">asn1</span><span class="op" id="3973720">.</span><span class="ident" id="3973721">RawValue</span><span class="op" id="3973729">{</span><span class="ident" id="3973730">Tag</span><span class="op" id="3973733">:</span>&nbsp;<span class="num" id="3973735">6</span><span class="op" id="3973736">,</span>&nbsp;<span class="ident" id="3973738">Class</span><span class="op" id="3973743">:</span>&nbsp;<span class="num" id="3973745">2</span><span class="op" id="3973746">,</span>&nbsp;<span class="ident" id="3973748">Bytes</span><span class="op" id="3973753">:</span>&nbsp;<span class="op" id="3973755">[</span><span class="op" id="3973756">]</span><span class="builtintype" id="3973757">byte</span><span class="op" id="3973761">(</span><span class="ident" id="3973762">name</span><span class="op" id="3973766">)</span><span class="op" id="3973767">}</span><span class="op" id="3973768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3973773">}</span><span class="op" id="3973774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3973778">}</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3973782">for</span>&nbsp;<span class="ident" id="3973786">_</span><span class="op" id="3973787">,</span>&nbsp;<span class="ident" id="3973789">name</span>&nbsp;<span class="op" id="3973794">:=</span>&nbsp;<span class="keyword" id="3973797">range</span>&nbsp;<span class="ident" id="3973803">template</span><span class="op" id="3973811">.</span><span class="ident" id="3973812">IssuingCertificateURL</span>&nbsp;<span class="op" id="3973834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3973839">aiaValues</span>&nbsp;<span class="op" id="3973849">=</span>&nbsp;<span class="builtinfunc" id="3973851">append</span><span class="op" id="3973857">(</span><span class="ident" id="3973858">aiaValues</span><span class="op" id="3973867">,</span>&nbsp;<span class="ident" id="3973869">authorityInfoAccess</span><span class="op" id="3973888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3973894">Method</span><span class="op" id="3973900">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3973904">oidAuthorityInfoAccessIssuers</span><span class="op" id="3973933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3973939">Location</span><span class="op" id="3973947">:</span>&nbsp;<span class="ident" id="3973949">asn1</span><span class="op" id="3973953">.</span><span class="ident" id="3973954">RawValue</span><span class="op" id="3973962">{</span><span class="ident" id="3973963">Tag</span><span class="op" id="3973966">:</span>&nbsp;<span class="num" id="3973968">6</span><span class="op" id="3973969">,</span>&nbsp;<span class="ident" id="3973971">Class</span><span class="op" id="3973976">:</span>&nbsp;<span class="num" id="3973978">2</span><span class="op" id="3973979">,</span>&nbsp;<span class="ident" id="3973981">Bytes</span><span class="op" id="3973986">:</span>&nbsp;<span class="op" id="3973988">[</span><span class="op" id="3973989">]</span><span class="builtintype" id="3973990">byte</span><span class="op" id="3973994">(</span><span class="ident" id="3973995">name</span><span class="op" id="3973999">)</span><span class="op" id="3974000">}</span><span class="op" id="3974001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974006">}</span><span class="op" id="3974007">)</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974015">ret</span><span class="op" id="3974018">[</span><span class="ident" id="3974019">n</span><span class="op" id="3974020">]</span><span class="op" id="3974021">.</span><span class="ident" id="3974022">Value</span><span class="op" id="3974027">,</span>&nbsp;<span class="ident" id="3974029">err</span>&nbsp;<span class="op" id="3974033">=</span>&nbsp;<span class="ident" id="3974035">asn1</span><span class="op" id="3974039">.</span><span class="ident" id="3974040">Marshal</span><span class="op" id="3974047">(</span><span class="ident" id="3974048">aiaValues</span><span class="op" id="3974057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3974061">if</span>&nbsp;<span class="ident" id="3974064">err</span>&nbsp;<span class="op" id="3974068">!=</span>&nbsp;<span class="builtintype" id="3974071">nil</span>&nbsp;<span class="op" id="3974075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3974080">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974089">}</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974093">n</span><span class="op" id="3974094">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3974102">if</span>&nbsp;<span class="op" id="3974105">(</span><span class="builtinfunc" id="3974106">len</span><span class="op" id="3974109">(</span><span class="ident" id="3974110">template</span><span class="op" id="3974118">.</span><span class="ident" id="3974119">DNSNames</span><span class="op" id="3974127">)</span>&nbsp;<span class="op" id="3974129">&gt;</span>&nbsp;<span class="num" id="3974131">0</span>&nbsp;<span class="op" id="3974133">||</span>&nbsp;<span class="builtinfunc" id="3974136">len</span><span class="op" id="3974139">(</span><span class="ident" id="3974140">template</span><span class="op" id="3974148">.</span><span class="ident" id="3974149">EmailAddresses</span><span class="op" id="3974163">)</span>&nbsp;<span class="op" id="3974165">&gt;</span>&nbsp;<span class="num" id="3974167">0</span>&nbsp;<span class="op" id="3974169">||</span>&nbsp;<span class="builtinfunc" id="3974172">len</span><span class="op" id="3974175">(</span><span class="ident" id="3974176">template</span><span class="op" id="3974184">.</span><span class="ident" id="3974185">IPAddresses</span><span class="op" id="3974196">)</span>&nbsp;<span class="op" id="3974198">&gt;</span>&nbsp;<span class="num" id="3974200">0</span><span class="op" id="3974201">)</span>&nbsp;<span class="op" id="3974203">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974208">!</span><span class="ident" id="3974209">oidInExtensions</span><span class="op" id="3974224">(</span><span class="ident" id="3974225">oidExtensionSubjectAltName</span><span class="op" id="3974251">,</span>&nbsp;<span class="ident" id="3974253">template</span><span class="op" id="3974261">.</span><span class="ident" id="3974262">ExtraExtensions</span><span class="op" id="3974277">)</span>&nbsp;<span class="op" id="3974279">{</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974283">ret</span><span class="op" id="3974286">[</span><span class="ident" id="3974287">n</span><span class="op" id="3974288">]</span><span class="op" id="3974289">.</span><span class="ident" id="3974290">Id</span>&nbsp;<span class="op" id="3974293">=</span>&nbsp;<span class="ident" id="3974295">oidExtensionSubjectAltName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974324">ret</span><span class="op" id="3974327">[</span><span class="ident" id="3974328">n</span><span class="op" id="3974329">]</span><span class="op" id="3974330">.</span><span class="ident" id="3974331">Value</span><span class="op" id="3974336">,</span>&nbsp;<span class="ident" id="3974338">err</span>&nbsp;<span class="op" id="3974342">=</span>&nbsp;<span class="ident" id="3974344">marshalSANs</span><span class="op" id="3974355">(</span><span class="ident" id="3974356">template</span><span class="op" id="3974364">.</span><span class="ident" id="3974365">DNSNames</span><span class="op" id="3974373">,</span>&nbsp;<span class="ident" id="3974375">template</span><span class="op" id="3974383">.</span><span class="ident" id="3974384">EmailAddresses</span><span class="op" id="3974398">,</span>&nbsp;<span class="ident" id="3974400">template</span><span class="op" id="3974408">.</span><span class="ident" id="3974409">IPAddresses</span><span class="op" id="3974420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3974424">if</span>&nbsp;<span class="ident" id="3974427">err</span>&nbsp;<span class="op" id="3974431">!=</span>&nbsp;<span class="builtintype" id="3974434">nil</span>&nbsp;<span class="op" id="3974438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3974443">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974452">}</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974456">n</span><span class="op" id="3974457">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3974465">if</span>&nbsp;<span class="builtinfunc" id="3974468">len</span><span class="op" id="3974471">(</span><span class="ident" id="3974472">template</span><span class="op" id="3974480">.</span><span class="ident" id="3974481">PolicyIdentifiers</span><span class="op" id="3974498">)</span>&nbsp;<span class="op" id="3974500">&gt;</span>&nbsp;<span class="num" id="3974502">0</span>&nbsp;<span class="op" id="3974504">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974509">!</span><span class="ident" id="3974510">oidInExtensions</span><span class="op" id="3974525">(</span><span class="ident" id="3974526">oidExtensionCertificatePolicies</span><span class="op" id="3974557">,</span>&nbsp;<span class="ident" id="3974559">template</span><span class="op" id="3974567">.</span><span class="ident" id="3974568">ExtraExtensions</span><span class="op" id="3974583">)</span>&nbsp;<span class="op" id="3974585">{</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974589">ret</span><span class="op" id="3974592">[</span><span class="ident" id="3974593">n</span><span class="op" id="3974594">]</span><span class="op" id="3974595">.</span><span class="ident" id="3974596">Id</span>&nbsp;<span class="op" id="3974599">=</span>&nbsp;<span class="ident" id="3974601">oidExtensionCertificatePolicies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974635">policies</span>&nbsp;<span class="op" id="3974644">:=</span>&nbsp;<span class="builtinfunc" id="3974647">make</span><span class="op" id="3974651">(</span><span class="op" id="3974652">[</span><span class="op" id="3974653">]</span><span class="ident" id="3974654">policyInformation</span><span class="op" id="3974671">,</span>&nbsp;<span class="builtinfunc" id="3974673">len</span><span class="op" id="3974676">(</span><span class="ident" id="3974677">template</span><span class="op" id="3974685">.</span><span class="ident" id="3974686">PolicyIdentifiers</span><span class="op" id="3974703">)</span><span class="op" id="3974704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3974708">for</span>&nbsp;<span class="ident" id="3974712">i</span><span class="op" id="3974713">,</span>&nbsp;<span class="ident" id="3974715">policy</span>&nbsp;<span class="op" id="3974722">:=</span>&nbsp;<span class="keyword" id="3974725">range</span>&nbsp;<span class="ident" id="3974731">template</span><span class="op" id="3974739">.</span><span class="ident" id="3974740">PolicyIdentifiers</span>&nbsp;<span class="op" id="3974758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974763">policies</span><span class="op" id="3974771">[</span><span class="ident" id="3974772">i</span><span class="op" id="3974773">]</span><span class="op" id="3974774">.</span><span class="ident" id="3974775">Policy</span>&nbsp;<span class="op" id="3974782">=</span>&nbsp;<span class="ident" id="3974784">policy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974793">}</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974797">ret</span><span class="op" id="3974800">[</span><span class="ident" id="3974801">n</span><span class="op" id="3974802">]</span><span class="op" id="3974803">.</span><span class="ident" id="3974804">Value</span><span class="op" id="3974809">,</span>&nbsp;<span class="ident" id="3974811">err</span>&nbsp;<span class="op" id="3974815">=</span>&nbsp;<span class="ident" id="3974817">asn1</span><span class="op" id="3974821">.</span><span class="ident" id="3974822">Marshal</span><span class="op" id="3974829">(</span><span class="ident" id="3974830">policies</span><span class="op" id="3974838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3974842">if</span>&nbsp;<span class="ident" id="3974845">err</span>&nbsp;<span class="op" id="3974849">!=</span>&nbsp;<span class="builtintype" id="3974852">nil</span>&nbsp;<span class="op" id="3974856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3974861">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3974874">n</span><span class="op" id="3974875">++</span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3974883">if</span>&nbsp;<span class="builtinfunc" id="3974886">len</span><span class="op" id="3974889">(</span><span class="ident" id="3974890">template</span><span class="op" id="3974898">.</span><span class="ident" id="3974899">PermittedDNSDomains</span><span class="op" id="3974918">)</span>&nbsp;<span class="op" id="3974920">&gt;</span>&nbsp;<span class="num" id="3974922">0</span>&nbsp;<span class="op" id="3974924">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3974929">!</span><span class="ident" id="3974930">oidInExtensions</span><span class="op" id="3974945">(</span><span class="ident" id="3974946">oidExtensionNameConstraints</span><span class="op" id="3974973">,</span>&nbsp;<span class="ident" id="3974975">template</span><span class="op" id="3974983">.</span><span class="ident" id="3974984">ExtraExtensions</span><span class="op" id="3974999">)</span>&nbsp;<span class="op" id="3975001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975005">ret</span><span class="op" id="3975008">[</span><span class="ident" id="3975009">n</span><span class="op" id="3975010">]</span><span class="op" id="3975011">.</span><span class="ident" id="3975012">Id</span>&nbsp;<span class="op" id="3975015">=</span>&nbsp;<span class="ident" id="3975017">oidExtensionNameConstraints</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975047">ret</span><span class="op" id="3975050">[</span><span class="ident" id="3975051">n</span><span class="op" id="3975052">]</span><span class="op" id="3975053">.</span><span class="ident" id="3975054">Critical</span>&nbsp;<span class="op" id="3975063">=</span>&nbsp;<span class="ident" id="3975065">template</span><span class="op" id="3975073">.</span><span class="ident" id="3975074">PermittedDNSDomainsCritical</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975105">var</span>&nbsp;<span class="ident" id="3975109">out</span>&nbsp;<span class="ident" id="3975113">nameConstraints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975131">out</span><span class="op" id="3975134">.</span><span class="ident" id="3975135">Permitted</span>&nbsp;<span class="op" id="3975145">=</span>&nbsp;<span class="builtinfunc" id="3975147">make</span><span class="op" id="3975151">(</span><span class="op" id="3975152">[</span><span class="op" id="3975153">]</span><span class="ident" id="3975154">generalSubtree</span><span class="op" id="3975168">,</span>&nbsp;<span class="builtinfunc" id="3975170">len</span><span class="op" id="3975173">(</span><span class="ident" id="3975174">template</span><span class="op" id="3975182">.</span><span class="ident" id="3975183">PermittedDNSDomains</span><span class="op" id="3975202">)</span><span class="op" id="3975203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975207">for</span>&nbsp;<span class="ident" id="3975211">i</span><span class="op" id="3975212">,</span>&nbsp;<span class="ident" id="3975214">permitted</span>&nbsp;<span class="op" id="3975224">:=</span>&nbsp;<span class="keyword" id="3975227">range</span>&nbsp;<span class="ident" id="3975233">template</span><span class="op" id="3975241">.</span><span class="ident" id="3975242">PermittedDNSDomains</span>&nbsp;<span class="op" id="3975262">{</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975267">out</span><span class="op" id="3975270">.</span><span class="ident" id="3975271">Permitted</span><span class="op" id="3975280">[</span><span class="ident" id="3975281">i</span><span class="op" id="3975282">]</span>&nbsp;<span class="op" id="3975284">=</span>&nbsp;<span class="ident" id="3975286">generalSubtree</span><span class="op" id="3975300">{</span><span class="ident" id="3975301">Name</span><span class="op" id="3975305">:</span>&nbsp;<span class="ident" id="3975307">permitted</span><span class="op" id="3975316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975324">ret</span><span class="op" id="3975327">[</span><span class="ident" id="3975328">n</span><span class="op" id="3975329">]</span><span class="op" id="3975330">.</span><span class="ident" id="3975331">Value</span><span class="op" id="3975336">,</span>&nbsp;<span class="ident" id="3975338">err</span>&nbsp;<span class="op" id="3975342">=</span>&nbsp;<span class="ident" id="3975344">asn1</span><span class="op" id="3975348">.</span><span class="ident" id="3975349">Marshal</span><span class="op" id="3975356">(</span><span class="ident" id="3975357">out</span><span class="op" id="3975360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975364">if</span>&nbsp;<span class="ident" id="3975367">err</span>&nbsp;<span class="op" id="3975371">!=</span>&nbsp;<span class="builtintype" id="3975374">nil</span>&nbsp;<span class="op" id="3975378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975383">return</span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975396">n</span><span class="op" id="3975397">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975405">if</span>&nbsp;<span class="builtinfunc" id="3975408">len</span><span class="op" id="3975411">(</span><span class="ident" id="3975412">template</span><span class="op" id="3975420">.</span><span class="ident" id="3975421">CRLDistributionPoints</span><span class="op" id="3975442">)</span>&nbsp;<span class="op" id="3975444">&gt;</span>&nbsp;<span class="num" id="3975446">0</span>&nbsp;<span class="op" id="3975448">&amp;&amp;</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975453">!</span><span class="ident" id="3975454">oidInExtensions</span><span class="op" id="3975469">(</span><span class="ident" id="3975470">oidExtensionCRLDistributionPoints</span><span class="op" id="3975503">,</span>&nbsp;<span class="ident" id="3975505">template</span><span class="op" id="3975513">.</span><span class="ident" id="3975514">ExtraExtensions</span><span class="op" id="3975529">)</span>&nbsp;<span class="op" id="3975531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975535">ret</span><span class="op" id="3975538">[</span><span class="ident" id="3975539">n</span><span class="op" id="3975540">]</span><span class="op" id="3975541">.</span><span class="ident" id="3975542">Id</span>&nbsp;<span class="op" id="3975545">=</span>&nbsp;<span class="ident" id="3975547">oidExtensionCRLDistributionPoints</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975584">var</span>&nbsp;<span class="ident" id="3975588">crlDp</span>&nbsp;<span class="op" id="3975594">[</span><span class="op" id="3975595">]</span><span class="ident" id="3975596">distributionPoint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3975616">for</span>&nbsp;<span class="ident" id="3975620">_</span><span class="op" id="3975621">,</span>&nbsp;<span class="ident" id="3975623">name</span>&nbsp;<span class="op" id="3975628">:=</span>&nbsp;<span class="keyword" id="3975631">range</span>&nbsp;<span class="ident" id="3975637">template</span><span class="op" id="3975645">.</span><span class="ident" id="3975646">CRLDistributionPoints</span>&nbsp;<span class="op" id="3975668">{</span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975673">rawFullName</span><span class="op" id="3975684">,</span>&nbsp;<span class="ident" id="3975686">_</span>&nbsp;<span class="op" id="3975688">:=</span>&nbsp;<span class="ident" id="3975691">asn1</span><span class="op" id="3975695">.</span><span class="ident" id="3975696">Marshal</span><span class="op" id="3975703">(</span><span class="ident" id="3975704">asn1</span><span class="op" id="3975708">.</span><span class="ident" id="3975709">RawValue</span><span class="op" id="3975717">{</span><span class="ident" id="3975718">Tag</span><span class="op" id="3975721">:</span>&nbsp;<span class="num" id="3975723">6</span><span class="op" id="3975724">,</span>&nbsp;<span class="ident" id="3975726">Class</span><span class="op" id="3975731">:</span>&nbsp;<span class="num" id="3975733">2</span><span class="op" id="3975734">,</span>&nbsp;<span class="ident" id="3975736">Bytes</span><span class="op" id="3975741">:</span>&nbsp;<span class="op" id="3975743">[</span><span class="op" id="3975744">]</span><span class="builtintype" id="3975745">byte</span><span class="op" id="3975749">(</span><span class="ident" id="3975750">name</span><span class="op" id="3975754">)</span><span class="op" id="3975755">}</span><span class="op" id="3975756">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975762">dp</span>&nbsp;<span class="op" id="3975765">:=</span>&nbsp;<span class="ident" id="3975768">distributionPoint</span><span class="op" id="3975785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975791">DistributionPoint</span><span class="op" id="3975808">:</span>&nbsp;<span class="ident" id="3975810">distributionPointName</span><span class="op" id="3975831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975838">FullName</span><span class="op" id="3975846">:</span>&nbsp;<span class="ident" id="3975848">asn1</span><span class="op" id="3975852">.</span><span class="ident" id="3975853">RawValue</span><span class="op" id="3975861">{</span><span class="ident" id="3975862">Tag</span><span class="op" id="3975865">:</span>&nbsp;<span class="num" id="3975867">0</span><span class="op" id="3975868">,</span>&nbsp;<span class="ident" id="3975870">Class</span><span class="op" id="3975875">:</span>&nbsp;<span class="num" id="3975877">2</span><span class="op" id="3975878">,</span>&nbsp;<span class="ident" id="3975880">IsCompound</span><span class="op" id="3975890">:</span>&nbsp;<span class="builtintype" id="3975892">true</span><span class="op" id="3975896">,</span>&nbsp;<span class="ident" id="3975898">Bytes</span><span class="op" id="3975903">:</span>&nbsp;<span class="ident" id="3975905">rawFullName</span><span class="op" id="3975916">}</span><span class="op" id="3975917">,</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975923">}</span><span class="op" id="3975924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975934">crlDp</span>&nbsp;<span class="op" id="3975940">=</span>&nbsp;<span class="builtinfunc" id="3975942">append</span><span class="op" id="3975948">(</span><span class="ident" id="3975949">crlDp</span><span class="op" id="3975954">,</span>&nbsp;<span class="ident" id="3975956">dp</span><span class="op" id="3975958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3975962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3975967">ret</span><span class="op" id="3975970">[</span><span class="ident" id="3975971">n</span><span class="op" id="3975972">]</span><span class="op" id="3975973">.</span><span class="ident" id="3975974">Value</span><span class="op" id="3975979">,</span>&nbsp;<span class="ident" id="3975981">err</span>&nbsp;<span class="op" id="3975985">=</span>&nbsp;<span class="ident" id="3975987">asn1</span><span class="op" id="3975991">.</span><span class="ident" id="3975992">Marshal</span><span class="op" id="3975999">(</span><span class="ident" id="3976000">crlDp</span><span class="op" id="3976005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976009">if</span>&nbsp;<span class="ident" id="3976012">err</span>&nbsp;<span class="op" id="3976016">!=</span>&nbsp;<span class="builtintype" id="3976019">nil</span>&nbsp;<span class="op" id="3976023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976028">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3976037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976041">n</span><span class="op" id="3976042">++</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3976046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3976050">//&nbsp;Adding&nbsp;another&nbsp;extension&nbsp;here?&nbsp;Remember&nbsp;to&nbsp;update&nbsp;the&nbsp;maximum&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3976123">//&nbsp;of&nbsp;elements&nbsp;in&nbsp;the&nbsp;make()&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976182">return</span>&nbsp;<span class="builtinfunc" id="3976189">append</span><span class="op" id="3976195">(</span><span class="ident" id="3976196">ret</span><span class="op" id="3976199">[</span><span class="op" id="3976200">:</span><span class="ident" id="3976201">n</span><span class="op" id="3976202">]</span><span class="op" id="3976203">,</span>&nbsp;<span class="ident" id="3976205">template</span><span class="op" id="3976213">.</span><span class="ident" id="3976214">ExtraExtensions</span><span class="op" id="3976229">...</span><span class="op" id="3976232">)</span><span class="op" id="3976233">,</span>&nbsp;<span class="builtintype" id="3976235">nil</span><br>
<span class="lineno"></span><span class="op" id="3976239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3976242">func</span>&nbsp;<span class="ident" id="3976247">subjectBytes</span><span class="op" id="3976259">(</span><span class="ident" id="3976260">cert</span>&nbsp;<span class="op" id="3976265">*</span><span class="ident" id="3976266">Certificate</span><span class="op" id="3976277">)</span>&nbsp;<span class="op" id="3976279">(</span><span class="op" id="3976280">[</span><span class="op" id="3976281">]</span><span class="builtintype" id="3976282">byte</span><span class="op" id="3976286">,</span>&nbsp;<span class="builtintype" id="3976288">error</span><span class="op" id="3976293">)</span>&nbsp;<span class="op" id="3976295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976298">if</span>&nbsp;<span class="builtinfunc" id="3976301">len</span><span class="op" id="3976304">(</span><span class="ident" id="3976305">cert</span><span class="op" id="3976309">.</span><span class="ident" id="3976310">RawSubject</span><span class="op" id="3976320">)</span>&nbsp;<span class="op" id="3976322">&gt;</span>&nbsp;<span class="num" id="3976324">0</span>&nbsp;<span class="op" id="3976326">{</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976330">return</span>&nbsp;<span class="ident" id="3976337">cert</span><span class="op" id="3976341">.</span><span class="ident" id="3976342">RawSubject</span><span class="op" id="3976352">,</span>&nbsp;<span class="builtintype" id="3976354">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3976359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976363">return</span>&nbsp;<span class="ident" id="3976370">asn1</span><span class="op" id="3976374">.</span><span class="ident" id="3976375">Marshal</span><span class="op" id="3976382">(</span><span class="ident" id="3976383">cert</span><span class="op" id="3976387">.</span><span class="ident" id="3976388">Subject</span><span class="op" id="3976395">.</span><span class="ident" id="3976396">ToRDNSequence</span><span class="op" id="3976409">(</span><span class="op" id="3976410">)</span><span class="op" id="3976411">)</span><br>
<span class="lineno"></span><span class="op" id="3976413">}</span><br>
<span class="lineno">1370</span><br>
<span class="lineno"></span><span class="comment" id="3976416">//&nbsp;signingParamsForPrivateKey&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;to&nbsp;use&nbsp;for&nbsp;signing&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3976493">//&nbsp;priv.&nbsp;If&nbsp;requestedSigAlgo&nbsp;is&nbsp;not&nbsp;zero&nbsp;then&nbsp;it&nbsp;overrides&nbsp;the&nbsp;default</span><br>
<span class="lineno"></span><span class="comment" id="3976564">//&nbsp;signature&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3976588">func</span>&nbsp;<span class="ident" id="3976593">signingParamsForPrivateKey</span><span class="op" id="3976619">(</span><span class="ident" id="3976620">priv</span>&nbsp;<span class="keyword" id="3976625">interface</span><span class="op" id="3976634">{</span><span class="op" id="3976635">}</span><span class="op" id="3976636">,</span>&nbsp;<span class="ident" id="3976638">requestedSigAlgo</span>&nbsp;<span class="ident" id="3976655">SignatureAlgorithm</span><span class="op" id="3976673">)</span>&nbsp;<span class="op" id="3976675">(</span><span class="ident" id="3976676">hashFunc</span>&nbsp;<span class="ident" id="3976685">crypto</span><span class="op" id="3976691">.</span><span class="ident" id="3976692">Hash</span><span class="op" id="3976696">,</span>&nbsp;<span class="ident" id="3976698">sigAlgo</span>&nbsp;<span class="ident" id="3976706">pkix</span><span class="op" id="3976710">.</span><span class="ident" id="3976711">AlgorithmIdentifier</span><span class="op" id="3976730">,</span>&nbsp;<span class="ident" id="3976732">err</span>&nbsp;<span class="builtintype" id="3976736">error</span><span class="op" id="3976741">)</span>&nbsp;<span class="op" id="3976743">{</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976746">var</span>&nbsp;<span class="ident" id="3976750">pubType</span>&nbsp;<span class="ident" id="3976758">PublicKeyAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976779">switch</span>&nbsp;<span class="ident" id="3976786">priv</span>&nbsp;<span class="op" id="3976791">:=</span>&nbsp;<span class="ident" id="3976794">priv</span><span class="op" id="3976798">.</span><span class="op" id="3976799">(</span><span class="keyword" id="3976800">type</span><span class="op" id="3976804">)</span>&nbsp;<span class="op" id="3976806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976809">case</span>&nbsp;<span class="op" id="3976814">*</span><span class="ident" id="3976815">rsa</span><span class="op" id="3976818">.</span><span class="ident" id="3976819">PrivateKey</span><span class="op" id="3976829">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976833">pubType</span>&nbsp;<span class="op" id="3976841">=</span>&nbsp;<span class="ident" id="3976843">RSA</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976849">sigAlgo</span><span class="op" id="3976856">.</span><span class="ident" id="3976857">Algorithm</span>&nbsp;<span class="op" id="3976867">=</span>&nbsp;<span class="ident" id="3976869">oidSignatureSHA256WithRSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976897">hashFunc</span>&nbsp;<span class="op" id="3976906">=</span>&nbsp;<span class="ident" id="3976908">crypto</span><span class="op" id="3976914">.</span><span class="ident" id="3976915">SHA256</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976924">case</span>&nbsp;<span class="op" id="3976929">*</span><span class="ident" id="3976930">ecdsa</span><span class="op" id="3976935">.</span><span class="ident" id="3976936">PrivateKey</span><span class="op" id="3976946">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3976950">pubType</span>&nbsp;<span class="op" id="3976958">=</span>&nbsp;<span class="ident" id="3976960">ECDSA</span><br>
<span class="lineno">1385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976969">switch</span>&nbsp;<span class="ident" id="3976976">priv</span><span class="op" id="3976980">.</span><span class="ident" id="3976981">Curve</span>&nbsp;<span class="op" id="3976987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3976991">case</span>&nbsp;<span class="ident" id="3976996">elliptic</span><span class="op" id="3977004">.</span><span class="ident" id="3977005">P224</span><span class="op" id="3977009">(</span><span class="op" id="3977010">)</span><span class="op" id="3977011">,</span>&nbsp;<span class="ident" id="3977013">elliptic</span><span class="op" id="3977021">.</span><span class="ident" id="3977022">P256</span><span class="op" id="3977026">(</span><span class="op" id="3977027">)</span><span class="op" id="3977028">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977033">hashFunc</span>&nbsp;<span class="op" id="3977042">=</span>&nbsp;<span class="ident" id="3977044">crypto</span><span class="op" id="3977050">.</span><span class="ident" id="3977051">SHA256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977061">sigAlgo</span><span class="op" id="3977068">.</span><span class="ident" id="3977069">Algorithm</span>&nbsp;<span class="op" id="3977079">=</span>&nbsp;<span class="ident" id="3977081">oidSignatureECDSAWithSHA256</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977111">case</span>&nbsp;<span class="ident" id="3977116">elliptic</span><span class="op" id="3977124">.</span><span class="ident" id="3977125">P384</span><span class="op" id="3977129">(</span><span class="op" id="3977130">)</span><span class="op" id="3977131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977136">hashFunc</span>&nbsp;<span class="op" id="3977145">=</span>&nbsp;<span class="ident" id="3977147">crypto</span><span class="op" id="3977153">.</span><span class="ident" id="3977154">SHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977164">sigAlgo</span><span class="op" id="3977171">.</span><span class="ident" id="3977172">Algorithm</span>&nbsp;<span class="op" id="3977182">=</span>&nbsp;<span class="ident" id="3977184">oidSignatureECDSAWithSHA384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977214">case</span>&nbsp;<span class="ident" id="3977219">elliptic</span><span class="op" id="3977227">.</span><span class="ident" id="3977228">P521</span><span class="op" id="3977232">(</span><span class="op" id="3977233">)</span><span class="op" id="3977234">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977239">hashFunc</span>&nbsp;<span class="op" id="3977248">=</span>&nbsp;<span class="ident" id="3977250">crypto</span><span class="op" id="3977256">.</span><span class="ident" id="3977257">SHA512</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977267">sigAlgo</span><span class="op" id="3977274">.</span><span class="ident" id="3977275">Algorithm</span>&nbsp;<span class="op" id="3977285">=</span>&nbsp;<span class="ident" id="3977287">oidSignatureECDSAWithSHA512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977317">default</span><span class="op" id="3977324">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977329">err</span>&nbsp;<span class="op" id="3977333">=</span>&nbsp;<span class="ident" id="3977335">errors</span><span class="op" id="3977341">.</span><span class="ident" id="3977342">New</span><span class="op" id="3977345">(</span><span class="string" id="3977346">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3977376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977384">default</span><span class="op" id="3977391">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977395">err</span>&nbsp;<span class="op" id="3977399">=</span>&nbsp;<span class="ident" id="3977401">errors</span><span class="op" id="3977407">.</span><span class="ident" id="3977408">New</span><span class="op" id="3977411">(</span><span class="string" id="3977412">&#34;x509:&nbsp;only&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;private&nbsp;keys&nbsp;supported&#34;</span><span class="op" id="3977461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977468">if</span>&nbsp;<span class="ident" id="3977471">err</span>&nbsp;<span class="op" id="3977475">!=</span>&nbsp;<span class="builtintype" id="3977478">nil</span>&nbsp;<span class="op" id="3977482">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977486">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977498">if</span>&nbsp;<span class="ident" id="3977501">requestedSigAlgo</span>&nbsp;<span class="op" id="3977518">==</span>&nbsp;<span class="num" id="3977521">0</span>&nbsp;<span class="op" id="3977523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977527">return</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977539">found</span>&nbsp;<span class="op" id="3977545">:=</span>&nbsp;<span class="builtintype" id="3977548">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977555">for</span>&nbsp;<span class="ident" id="3977559">_</span><span class="op" id="3977560">,</span>&nbsp;<span class="ident" id="3977562">details</span>&nbsp;<span class="op" id="3977570">:=</span>&nbsp;<span class="keyword" id="3977573">range</span>&nbsp;<span class="ident" id="3977579">signatureAlgorithmDetails</span>&nbsp;<span class="op" id="3977605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977609">if</span>&nbsp;<span class="ident" id="3977612">details</span><span class="op" id="3977619">.</span><span class="ident" id="3977620">algo</span>&nbsp;<span class="op" id="3977625">==</span>&nbsp;<span class="ident" id="3977628">requestedSigAlgo</span>&nbsp;<span class="op" id="3977645">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977650">if</span>&nbsp;<span class="ident" id="3977653">details</span><span class="op" id="3977660">.</span><span class="ident" id="3977661">pubKeyAlgo</span>&nbsp;<span class="op" id="3977672">!=</span>&nbsp;<span class="ident" id="3977675">pubType</span>&nbsp;<span class="op" id="3977683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977689">err</span>&nbsp;<span class="op" id="3977693">=</span>&nbsp;<span class="ident" id="3977695">errors</span><span class="op" id="3977701">.</span><span class="ident" id="3977702">New</span><span class="op" id="3977705">(</span><span class="string" id="3977706">&#34;x509:&nbsp;requested&nbsp;SignatureAlgorithm&nbsp;does&nbsp;not&nbsp;match&nbsp;private&nbsp;key&nbsp;type&#34;</span><span class="op" id="3977774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977780">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977795">sigAlgo</span><span class="op" id="3977802">.</span><span class="ident" id="3977803">Algorithm</span><span class="op" id="3977812">,</span>&nbsp;<span class="ident" id="3977814">hashFunc</span>&nbsp;<span class="op" id="3977823">=</span>&nbsp;<span class="ident" id="3977825">details</span><span class="op" id="3977832">.</span><span class="ident" id="3977833">oid</span><span class="op" id="3977836">,</span>&nbsp;<span class="ident" id="3977838">details</span><span class="op" id="3977845">.</span><span class="ident" id="3977846">hash</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977854">if</span>&nbsp;<span class="ident" id="3977857">hashFunc</span>&nbsp;<span class="op" id="3977866">==</span>&nbsp;<span class="num" id="3977869">0</span>&nbsp;<span class="op" id="3977871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977877">err</span>&nbsp;<span class="op" id="3977881">=</span>&nbsp;<span class="ident" id="3977883">errors</span><span class="op" id="3977889">.</span><span class="ident" id="3977890">New</span><span class="op" id="3977893">(</span><span class="string" id="3977894">&#34;x509:&nbsp;cannot&nbsp;sign&nbsp;with&nbsp;hash&nbsp;function&nbsp;requested&#34;</span><span class="op" id="3977942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977948">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3977963">found</span>&nbsp;<span class="op" id="3977969">=</span>&nbsp;<span class="builtintype" id="3977971">true</span><br>
<span class="lineno">1425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977979">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3977990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3977994">if</span>&nbsp;<span class="op" id="3977997">!</span><span class="ident" id="3977998">found</span>&nbsp;<span class="op" id="3978004">{</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3978008">err</span>&nbsp;<span class="op" id="3978012">=</span>&nbsp;<span class="ident" id="3978014">errors</span><span class="op" id="3978020">.</span><span class="ident" id="3978021">New</span><span class="op" id="3978024">(</span><span class="string" id="3978025">&#34;x509:&nbsp;unknown&nbsp;SignatureAlgorithm&#34;</span><span class="op" id="3978059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3978062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3978066">return</span><br>
<span class="lineno"></span><span class="op" id="3978073">}</span><br>
<span class="lineno">1435</span><br>
<span class="lineno"></span><span class="comment" id="3978076">//&nbsp;CreateCertificate&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3978148">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;SerialNumber,&nbsp;Subject,&nbsp;NotBefore,</span><br>
<span class="lineno"></span><span class="comment" id="3978225">//&nbsp;NotAfter,&nbsp;KeyUsage,&nbsp;ExtKeyUsage,&nbsp;UnknownExtKeyUsage,&nbsp;BasicConstraintsValid,</span><br>
<span class="lineno"></span><span class="comment" id="3978304">//&nbsp;IsCA,&nbsp;MaxPathLen,&nbsp;SubjectKeyId,&nbsp;DNSNames,&nbsp;PermittedDNSDomainsCritical,</span><br>
<span class="lineno">1440</span><span class="comment" id="3978378">//&nbsp;PermittedDNSDomains,&nbsp;SignatureAlgorithm.</span><br>
<span class="lineno"></span><span class="comment" id="3978422">//</span><br>
<span class="lineno"></span><span class="comment" id="3978425">//&nbsp;The&nbsp;certificate&nbsp;is&nbsp;signed&nbsp;by&nbsp;parent.&nbsp;If&nbsp;parent&nbsp;is&nbsp;equal&nbsp;to&nbsp;template&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3978505">//&nbsp;certificate&nbsp;is&nbsp;self-signed.&nbsp;The&nbsp;parameter&nbsp;pub&nbsp;is&nbsp;the&nbsp;public&nbsp;key&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3978579">//&nbsp;signee&nbsp;and&nbsp;priv&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1445</span><span class="comment" id="3978632">//</span><br>
<span class="lineno"></span><span class="comment" id="3978635">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="3978693">//</span><br>
<span class="lineno"></span><span class="comment" id="3978696">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;and&nbsp;ECDSA&nbsp;(*rsa.PublicKey&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3978765">//&nbsp;*ecdsa.PublicKey&nbsp;for&nbsp;pub,&nbsp;*rsa.PrivateKey&nbsp;or&nbsp;*ecdsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno">1450</span><span class="keyword" id="3978842">func</span>&nbsp;<span class="ident" id="3978847">CreateCertificate</span><span class="op" id="3978864">(</span><span class="ident" id="3978865">rand</span>&nbsp;<span class="ident" id="3978870">io</span><span class="op" id="3978872">.</span><span class="ident" id="3978873">Reader</span><span class="op" id="3978879">,</span>&nbsp;<span class="ident" id="3978881">template</span><span class="op" id="3978889">,</span>&nbsp;<span class="ident" id="3978891">parent</span>&nbsp;<span class="op" id="3978898">*</span><span class="ident" id="3978899">Certificate</span><span class="op" id="3978910">,</span>&nbsp;<span class="ident" id="3978912">pub</span>&nbsp;<span class="keyword" id="3978916">interface</span><span class="op" id="3978925">{</span><span class="op" id="3978926">}</span><span class="op" id="3978927">,</span>&nbsp;<span class="ident" id="3978929">priv</span>&nbsp;<span class="keyword" id="3978934">interface</span><span class="op" id="3978943">{</span><span class="op" id="3978944">}</span><span class="op" id="3978945">)</span>&nbsp;<span class="op" id="3978947">(</span><span class="ident" id="3978948">cert</span>&nbsp;<span class="op" id="3978953">[</span><span class="op" id="3978954">]</span><span class="builtintype" id="3978955">byte</span><span class="op" id="3978959">,</span>&nbsp;<span class="ident" id="3978961">err</span>&nbsp;<span class="builtintype" id="3978965">error</span><span class="op" id="3978970">)</span>&nbsp;<span class="op" id="3978972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3978975">hashFunc</span><span class="op" id="3978983">,</span>&nbsp;<span class="ident" id="3978985">signatureAlgorithm</span><span class="op" id="3979003">,</span>&nbsp;<span class="ident" id="3979005">err</span>&nbsp;<span class="op" id="3979009">:=</span>&nbsp;<span class="ident" id="3979012">signingParamsForPrivateKey</span><span class="op" id="3979038">(</span><span class="ident" id="3979039">priv</span><span class="op" id="3979043">,</span>&nbsp;<span class="ident" id="3979045">template</span><span class="op" id="3979053">.</span><span class="ident" id="3979054">SignatureAlgorithm</span><span class="op" id="3979072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979075">if</span>&nbsp;<span class="ident" id="3979078">err</span>&nbsp;<span class="op" id="3979082">!=</span>&nbsp;<span class="builtintype" id="3979085">nil</span>&nbsp;<span class="op" id="3979089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979093">return</span>&nbsp;<span class="builtintype" id="3979100">nil</span><span class="op" id="3979103">,</span>&nbsp;<span class="ident" id="3979105">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3979110">}</span><br>
<span class="lineno">1455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979114">publicKeyBytes</span><span class="op" id="3979128">,</span>&nbsp;<span class="ident" id="3979130">publicKeyAlgorithm</span><span class="op" id="3979148">,</span>&nbsp;<span class="ident" id="3979150">err</span>&nbsp;<span class="op" id="3979154">:=</span>&nbsp;<span class="ident" id="3979157">marshalPublicKey</span><span class="op" id="3979173">(</span><span class="ident" id="3979174">pub</span><span class="op" id="3979177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979180">if</span>&nbsp;<span class="ident" id="3979183">err</span>&nbsp;<span class="op" id="3979187">!=</span>&nbsp;<span class="builtintype" id="3979190">nil</span>&nbsp;<span class="op" id="3979194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979198">return</span>&nbsp;<span class="builtintype" id="3979205">nil</span><span class="op" id="3979208">,</span>&nbsp;<span class="ident" id="3979210">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3979215">}</span><br>
<span class="lineno">1460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979219">if</span>&nbsp;<span class="ident" id="3979222">err</span>&nbsp;<span class="op" id="3979226">!=</span>&nbsp;<span class="builtintype" id="3979229">nil</span>&nbsp;<span class="op" id="3979233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979237">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3979245">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979249">if</span>&nbsp;<span class="builtinfunc" id="3979252">len</span><span class="op" id="3979255">(</span><span class="ident" id="3979256">parent</span><span class="op" id="3979262">.</span><span class="ident" id="3979263">SubjectKeyId</span><span class="op" id="3979275">)</span>&nbsp;<span class="op" id="3979277">&gt;</span>&nbsp;<span class="num" id="3979279">0</span>&nbsp;<span class="op" id="3979281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979285">template</span><span class="op" id="3979293">.</span><span class="ident" id="3979294">AuthorityKeyId</span>&nbsp;<span class="op" id="3979309">=</span>&nbsp;<span class="ident" id="3979311">parent</span><span class="op" id="3979317">.</span><span class="ident" id="3979318">SubjectKeyId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3979332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979336">extensions</span><span class="op" id="3979346">,</span>&nbsp;<span class="ident" id="3979348">err</span>&nbsp;<span class="op" id="3979352">:=</span>&nbsp;<span class="ident" id="3979355">buildExtensions</span><span class="op" id="3979370">(</span><span class="ident" id="3979371">template</span><span class="op" id="3979379">)</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979382">if</span>&nbsp;<span class="ident" id="3979385">err</span>&nbsp;<span class="op" id="3979389">!=</span>&nbsp;<span class="builtintype" id="3979392">nil</span>&nbsp;<span class="op" id="3979396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979400">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3979408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979412">asn1Issuer</span><span class="op" id="3979422">,</span>&nbsp;<span class="ident" id="3979424">err</span>&nbsp;<span class="op" id="3979428">:=</span>&nbsp;<span class="ident" id="3979431">subjectBytes</span><span class="op" id="3979443">(</span><span class="ident" id="3979444">parent</span><span class="op" id="3979450">)</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979453">if</span>&nbsp;<span class="ident" id="3979456">err</span>&nbsp;<span class="op" id="3979460">!=</span>&nbsp;<span class="builtintype" id="3979463">nil</span>&nbsp;<span class="op" id="3979467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979471">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3979479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979483">asn1Subject</span><span class="op" id="3979494">,</span>&nbsp;<span class="ident" id="3979496">err</span>&nbsp;<span class="op" id="3979500">:=</span>&nbsp;<span class="ident" id="3979503">subjectBytes</span><span class="op" id="3979515">(</span><span class="ident" id="3979516">template</span><span class="op" id="3979524">)</span><br>
<span class="lineno">1480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979527">if</span>&nbsp;<span class="ident" id="3979530">err</span>&nbsp;<span class="op" id="3979534">!=</span>&nbsp;<span class="builtintype" id="3979537">nil</span>&nbsp;<span class="op" id="3979541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3979545">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3979553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979557">encodedPublicKey</span>&nbsp;<span class="op" id="3979574">:=</span>&nbsp;<span class="ident" id="3979577">asn1</span><span class="op" id="3979581">.</span><span class="ident" id="3979582">BitString</span><span class="op" id="3979591">{</span><span class="ident" id="3979592">BitLength</span><span class="op" id="3979601">:</span>&nbsp;<span class="builtinfunc" id="3979603">len</span><span class="op" id="3979606">(</span><span class="ident" id="3979607">publicKeyBytes</span><span class="op" id="3979621">)</span>&nbsp;<span class="op" id="3979623">*</span>&nbsp;<span class="num" id="3979625">8</span><span class="op" id="3979626">,</span>&nbsp;<span class="ident" id="3979628">Bytes</span><span class="op" id="3979633">:</span>&nbsp;<span class="ident" id="3979635">publicKeyBytes</span><span class="op" id="3979649">}</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979652">c</span>&nbsp;<span class="op" id="3979654">:=</span>&nbsp;<span class="ident" id="3979657">tbsCertificate</span><span class="op" id="3979671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979675">Version</span><span class="op" id="3979682">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3979695">2</span><span class="op" id="3979696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979700">SerialNumber</span><span class="op" id="3979712">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979720">template</span><span class="op" id="3979728">.</span><span class="ident" id="3979729">SerialNumber</span><span class="op" id="3979741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979745">SignatureAlgorithm</span><span class="op" id="3979763">:</span>&nbsp;<span class="ident" id="3979765">signatureAlgorithm</span><span class="op" id="3979783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979787">Issuer</span><span class="op" id="3979793">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979807">asn1</span><span class="op" id="3979811">.</span><span class="ident" id="3979812">RawValue</span><span class="op" id="3979820">{</span><span class="ident" id="3979821">FullBytes</span><span class="op" id="3979830">:</span>&nbsp;<span class="ident" id="3979832">asn1Issuer</span><span class="op" id="3979842">}</span><span class="op" id="3979843">,</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979847">Validity</span><span class="op" id="3979855">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979867">validity</span><span class="op" id="3979875">{</span><span class="ident" id="3979876">template</span><span class="op" id="3979884">.</span><span class="ident" id="3979885">NotBefore</span><span class="op" id="3979894">.</span><span class="ident" id="3979895">UTC</span><span class="op" id="3979898">(</span><span class="op" id="3979899">)</span><span class="op" id="3979900">,</span>&nbsp;<span class="ident" id="3979902">template</span><span class="op" id="3979910">.</span><span class="ident" id="3979911">NotAfter</span><span class="op" id="3979919">.</span><span class="ident" id="3979920">UTC</span><span class="op" id="3979923">(</span><span class="op" id="3979924">)</span><span class="op" id="3979925">}</span><span class="op" id="3979926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979930">Subject</span><span class="op" id="3979937">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979950">asn1</span><span class="op" id="3979954">.</span><span class="ident" id="3979955">RawValue</span><span class="op" id="3979963">{</span><span class="ident" id="3979964">FullBytes</span><span class="op" id="3979973">:</span>&nbsp;<span class="ident" id="3979975">asn1Subject</span><span class="op" id="3979986">}</span><span class="op" id="3979987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3979991">PublicKey</span><span class="op" id="3980000">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980011">publicKeyInfo</span><span class="op" id="3980024">{</span><span class="builtintype" id="3980025">nil</span><span class="op" id="3980028">,</span>&nbsp;<span class="ident" id="3980030">publicKeyAlgorithm</span><span class="op" id="3980048">,</span>&nbsp;<span class="ident" id="3980050">encodedPublicKey</span><span class="op" id="3980066">}</span><span class="op" id="3980067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980071">Extensions</span><span class="op" id="3980081">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980091">extensions</span><span class="op" id="3980101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3980104">}</span><br>
<span class="lineno">1495</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980108">tbsCertContents</span><span class="op" id="3980123">,</span>&nbsp;<span class="ident" id="3980125">err</span>&nbsp;<span class="op" id="3980129">:=</span>&nbsp;<span class="ident" id="3980132">asn1</span><span class="op" id="3980136">.</span><span class="ident" id="3980137">Marshal</span><span class="op" id="3980144">(</span><span class="ident" id="3980145">c</span><span class="op" id="3980146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3980149">if</span>&nbsp;<span class="ident" id="3980152">err</span>&nbsp;<span class="op" id="3980156">!=</span>&nbsp;<span class="builtintype" id="3980159">nil</span>&nbsp;<span class="op" id="3980163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3980167">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3980175">}</span><br>
<span class="lineno">1500</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980179">c</span><span class="op" id="3980180">.</span><span class="ident" id="3980181">Raw</span>&nbsp;<span class="op" id="3980185">=</span>&nbsp;<span class="ident" id="3980187">tbsCertContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980205">h</span>&nbsp;<span class="op" id="3980207">:=</span>&nbsp;<span class="ident" id="3980210">hashFunc</span><span class="op" id="3980218">.</span><span class="ident" id="3980219">New</span><span class="op" id="3980222">(</span><span class="op" id="3980223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980226">h</span><span class="op" id="3980227">.</span><span class="ident" id="3980228">Write</span><span class="op" id="3980233">(</span><span class="ident" id="3980234">tbsCertContents</span><span class="op" id="3980249">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980252">digest</span>&nbsp;<span class="op" id="3980259">:=</span>&nbsp;<span class="ident" id="3980262">h</span><span class="op" id="3980263">.</span><span class="ident" id="3980264">Sum</span><span class="op" id="3980267">(</span><span class="builtintype" id="3980268">nil</span><span class="op" id="3980271">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3980275">var</span>&nbsp;<span class="ident" id="3980279">signature</span>&nbsp;<span class="op" id="3980289">[</span><span class="op" id="3980290">]</span><span class="builtintype" id="3980291">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3980298">switch</span>&nbsp;<span class="ident" id="3980305">priv</span>&nbsp;<span class="op" id="3980310">:=</span>&nbsp;<span class="ident" id="3980313">priv</span><span class="op" id="3980317">.</span><span class="op" id="3980318">(</span><span class="keyword" id="3980319">type</span><span class="op" id="3980323">)</span>&nbsp;<span class="op" id="3980325">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3980328">case</span>&nbsp;<span class="op" id="3980333">*</span><span class="ident" id="3980334">rsa</span><span class="op" id="3980337">.</span><span class="ident" id="3980338">PrivateKey</span><span class="op" id="3980348">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980352">signature</span><span class="op" id="3980361">,</span>&nbsp;<span class="ident" id="3980363">err</span>&nbsp;<span class="op" id="3980367">=</span>&nbsp;<span class="ident" id="3980369">rsa</span><span class="op" id="3980372">.</span><span class="ident" id="3980373">SignPKCS1v15</span><span class="op" id="3980385">(</span><span class="ident" id="3980386">rand</span><span class="op" id="3980390">,</span>&nbsp;<span class="ident" id="3980392">priv</span><span class="op" id="3980396">,</span>&nbsp;<span class="ident" id="3980398">hashFunc</span><span class="op" id="3980406">,</span>&nbsp;<span class="ident" id="3980408">digest</span><span class="op" id="3980414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3980417">case</span>&nbsp;<span class="op" id="3980422">*</span><span class="ident" id="3980423">ecdsa</span><span class="op" id="3980428">.</span><span class="ident" id="3980429">PrivateKey</span><span class="op" id="3980439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3980443">var</span>&nbsp;<span class="ident" id="3980447">r</span><span class="op" id="3980448">,</span>&nbsp;<span class="ident" id="3980450">s</span>&nbsp;<span class="op" id="3980452">*</span><span class="ident" id="3980453">big</span><span class="op" id="3980456">.</span><span class="ident" id="3980457">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3980463">if</span>&nbsp;<span class="ident" id="3980466">r</span><span class="op" id="3980467">,</span>&nbsp;<span class="ident" id="3980469">s</span><span class="op" id="3980470">,</span>&nbsp;<span class="ident" id="3980472">err</span>&nbsp;<span class="op" id="3980476">=</span>&nbsp;<span class="ident" id="3980478">ecdsa</span><span class="op" id="3980483">.</span><span class="ident" id="3980484">Sign</span><span class="op" id="3980488">(</span><span class="ident" id="3980489">rand</span><span class="op" id="3980493">,</span>&nbsp;<span class="ident" id="3980495">priv</span><span class="op" id="3980499">,</span>&nbsp;<span class="ident" id="3980501">digest</span><span class="op" id="3980507">)</span><span class="op" id="3980508">;</span>&nbsp;<span class="ident" id="3980510">err</span>&nbsp;<span class="op" id="3980514">==</span>&nbsp;<span class="builtintype" id="3980517">nil</span>&nbsp;<span class="op" id="3980521">{</span><br>
<span class="lineno">1515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980526">signature</span><span class="op" id="3980535">,</span>&nbsp;<span class="ident" id="3980537">err</span>&nbsp;<span class="op" id="3980541">=</span>&nbsp;<span class="ident" id="3980543">asn1</span><span class="op" id="3980547">.</span><span class="ident" id="3980548">Marshal</span><span class="op" id="3980555">(</span><span class="ident" id="3980556">ecdsaSignature</span><span class="op" id="3980570">{</span><span class="ident" id="3980571">r</span><span class="op" id="3980572">,</span>&nbsp;<span class="ident" id="3980574">s</span><span class="op" id="3980575">}</span><span class="op" id="3980576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3980580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3980583">default</span><span class="op" id="3980590">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3980594">panic</span><span class="op" id="3980599">(</span><span class="string" id="3980600">&#34;internal&nbsp;error&#34;</span><span class="op" id="3980616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3980619">}</span><br>
<span class="lineno">1520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3980623">if</span>&nbsp;<span class="ident" id="3980626">err</span>&nbsp;<span class="op" id="3980630">!=</span>&nbsp;<span class="builtintype" id="3980633">nil</span>&nbsp;<span class="op" id="3980637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3980641">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3980649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980653">cert</span><span class="op" id="3980657">,</span>&nbsp;<span class="ident" id="3980659">err</span>&nbsp;<span class="op" id="3980663">=</span>&nbsp;<span class="ident" id="3980665">asn1</span><span class="op" id="3980669">.</span><span class="ident" id="3980670">Marshal</span><span class="op" id="3980677">(</span><span class="ident" id="3980678">certificate</span><span class="op" id="3980689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3980693">nil</span><span class="op" id="3980696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980700">c</span><span class="op" id="3980701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980705">signatureAlgorithm</span><span class="op" id="3980723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3980727">asn1</span><span class="op" id="3980731">.</span><span class="ident" id="3980732">BitString</span><span class="op" id="3980741">{</span><span class="ident" id="3980742">Bytes</span><span class="op" id="3980747">:</span>&nbsp;<span class="ident" id="3980749">signature</span><span class="op" id="3980758">,</span>&nbsp;<span class="ident" id="3980760">BitLength</span><span class="op" id="3980769">:</span>&nbsp;<span class="builtinfunc" id="3980771">len</span><span class="op" id="3980774">(</span><span class="ident" id="3980775">signature</span><span class="op" id="3980784">)</span>&nbsp;<span class="op" id="3980786">*</span>&nbsp;<span class="num" id="3980788">8</span><span class="op" id="3980789">}</span><span class="op" id="3980790">,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3980793">}</span><span class="op" id="3980794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3980797">return</span><br>
<span class="lineno"></span><span class="op" id="3980804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3980807">//&nbsp;pemCRLPrefix&nbsp;is&nbsp;the&nbsp;magic&nbsp;string&nbsp;that&nbsp;indicates&nbsp;that&nbsp;we&nbsp;have&nbsp;a&nbsp;PEM&nbsp;encoded</span><br>
<span class="lineno">1535</span><span class="comment" id="3980885">//&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="3980893">var</span>&nbsp;<span class="ident" id="3980897">pemCRLPrefix</span>&nbsp;<span class="op" id="3980910">=</span>&nbsp;<span class="op" id="3980912">[</span><span class="op" id="3980913">]</span><span class="builtintype" id="3980914">byte</span><span class="op" id="3980918">(</span><span class="string" id="3980919">&#34;-----BEGIN&nbsp;X509&nbsp;CRL&#34;</span><span class="op" id="3980940">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3980943">//&nbsp;pemType&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;PEM&nbsp;encoded&nbsp;CRL.</span><br>
<span class="lineno"></span><span class="keyword" id="3980988">var</span>&nbsp;<span class="ident" id="3980992">pemType</span>&nbsp;<span class="op" id="3981000">=</span>&nbsp;<span class="string" id="3981002">&#34;X509&nbsp;CRL&#34;</span><br>
<span class="lineno">1540</span><br>
<span class="lineno"></span><span class="comment" id="3981014">//&nbsp;ParseCRL&nbsp;parses&nbsp;a&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.&nbsp;It&#39;s&nbsp;often&nbsp;the&nbsp;case&nbsp;that&nbsp;PEM</span><br>
<span class="lineno"></span><span class="comment" id="3981090">//&nbsp;encoded&nbsp;CRLs&nbsp;will&nbsp;appear&nbsp;where&nbsp;they&nbsp;should&nbsp;be&nbsp;DER&nbsp;encoded,&nbsp;so&nbsp;this&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="3981169">//&nbsp;will&nbsp;transparently&nbsp;handle&nbsp;PEM&nbsp;encoding&nbsp;as&nbsp;long&nbsp;as&nbsp;there&nbsp;isn&#39;t&nbsp;any&nbsp;leading</span><br>
<span class="lineno"></span><span class="comment" id="3981246">//&nbsp;garbage.</span><br>
<span class="lineno">1545</span><span class="keyword" id="3981258">func</span>&nbsp;<span class="ident" id="3981263">ParseCRL</span><span class="op" id="3981271">(</span><span class="ident" id="3981272">crlBytes</span>&nbsp;<span class="op" id="3981281">[</span><span class="op" id="3981282">]</span><span class="builtintype" id="3981283">byte</span><span class="op" id="3981287">)</span>&nbsp;<span class="op" id="3981289">(</span><span class="ident" id="3981290">certList</span>&nbsp;<span class="op" id="3981299">*</span><span class="ident" id="3981300">pkix</span><span class="op" id="3981304">.</span><span class="ident" id="3981305">CertificateList</span><span class="op" id="3981320">,</span>&nbsp;<span class="ident" id="3981322">err</span>&nbsp;<span class="builtintype" id="3981326">error</span><span class="op" id="3981331">)</span>&nbsp;<span class="op" id="3981333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3981336">if</span>&nbsp;<span class="ident" id="3981339">bytes</span><span class="op" id="3981344">.</span><span class="ident" id="3981345">HasPrefix</span><span class="op" id="3981354">(</span><span class="ident" id="3981355">crlBytes</span><span class="op" id="3981363">,</span>&nbsp;<span class="ident" id="3981365">pemCRLPrefix</span><span class="op" id="3981377">)</span>&nbsp;<span class="op" id="3981379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3981383">block</span><span class="op" id="3981388">,</span>&nbsp;<span class="ident" id="3981390">_</span>&nbsp;<span class="op" id="3981392">:=</span>&nbsp;<span class="ident" id="3981395">pem</span><span class="op" id="3981398">.</span><span class="ident" id="3981399">Decode</span><span class="op" id="3981405">(</span><span class="ident" id="3981406">crlBytes</span><span class="op" id="3981414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3981418">if</span>&nbsp;<span class="ident" id="3981421">block</span>&nbsp;<span class="op" id="3981427">!=</span>&nbsp;<span class="builtintype" id="3981430">nil</span>&nbsp;<span class="op" id="3981434">&amp;&amp;</span>&nbsp;<span class="ident" id="3981437">block</span><span class="op" id="3981442">.</span><span class="ident" id="3981443">Type</span>&nbsp;<span class="op" id="3981448">==</span>&nbsp;<span class="ident" id="3981451">pemType</span>&nbsp;<span class="op" id="3981459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3981464">crlBytes</span>&nbsp;<span class="op" id="3981473">=</span>&nbsp;<span class="ident" id="3981475">block</span><span class="op" id="3981480">.</span><span class="ident" id="3981481">Bytes</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3981489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3981492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3981495">return</span>&nbsp;<span class="ident" id="3981502">ParseDERCRL</span><span class="op" id="3981513">(</span><span class="ident" id="3981514">crlBytes</span><span class="op" id="3981522">)</span><br>
<span class="lineno"></span><span class="op" id="3981524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1555</span><span class="comment" id="3981527">//&nbsp;ParseDERCRL&nbsp;parses&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3981589">func</span>&nbsp;<span class="ident" id="3981594">ParseDERCRL</span><span class="op" id="3981605">(</span><span class="ident" id="3981606">derBytes</span>&nbsp;<span class="op" id="3981615">[</span><span class="op" id="3981616">]</span><span class="builtintype" id="3981617">byte</span><span class="op" id="3981621">)</span>&nbsp;<span class="op" id="3981623">(</span><span class="ident" id="3981624">certList</span>&nbsp;<span class="op" id="3981633">*</span><span class="ident" id="3981634">pkix</span><span class="op" id="3981638">.</span><span class="ident" id="3981639">CertificateList</span><span class="op" id="3981654">,</span>&nbsp;<span class="ident" id="3981656">err</span>&nbsp;<span class="builtintype" id="3981660">error</span><span class="op" id="3981665">)</span>&nbsp;<span class="op" id="3981667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3981670">certList</span>&nbsp;<span class="op" id="3981679">=</span>&nbsp;<span class="builtinfunc" id="3981681">new</span><span class="op" id="3981684">(</span><span class="ident" id="3981685">pkix</span><span class="op" id="3981689">.</span><span class="ident" id="3981690">CertificateList</span><span class="op" id="3981705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3981708">_</span><span class="op" id="3981709">,</span>&nbsp;<span class="ident" id="3981711">err</span>&nbsp;<span class="op" id="3981715">=</span>&nbsp;<span class="ident" id="3981717">asn1</span><span class="op" id="3981721">.</span><span class="ident" id="3981722">Unmarshal</span><span class="op" id="3981731">(</span><span class="ident" id="3981732">derBytes</span><span class="op" id="3981740">,</span>&nbsp;<span class="ident" id="3981742">certList</span><span class="op" id="3981750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3981753">if</span>&nbsp;<span class="ident" id="3981756">err</span>&nbsp;<span class="op" id="3981760">!=</span>&nbsp;<span class="builtintype" id="3981763">nil</span>&nbsp;<span class="op" id="3981767">{</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3981771">certList</span>&nbsp;<span class="op" id="3981780">=</span>&nbsp;<span class="builtintype" id="3981782">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3981787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3981790">return</span><br>
<span class="lineno"></span><span class="op" id="3981797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1565</span><span class="comment" id="3981800">//&nbsp;CreateCRL&nbsp;returns&nbsp;a&nbsp;DER&nbsp;encoded&nbsp;CRL,&nbsp;signed&nbsp;by&nbsp;this&nbsp;Certificate,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3981873">//&nbsp;contains&nbsp;the&nbsp;given&nbsp;list&nbsp;of&nbsp;revoked&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="comment" id="3981925">//</span><br>
<span class="lineno"></span><span class="comment" id="3981928">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;type&nbsp;is&nbsp;RSA&nbsp;(*rsa.PrivateKey&nbsp;for&nbsp;priv).</span><br>
<span class="lineno"></span><span class="keyword" id="3981994">func</span>&nbsp;<span class="op" id="3981999">(</span><span class="ident" id="3982000">c</span>&nbsp;<span class="op" id="3982002">*</span><span class="ident" id="3982003">Certificate</span><span class="op" id="3982014">)</span>&nbsp;<span class="ident" id="3982016">CreateCRL</span><span class="op" id="3982025">(</span><span class="ident" id="3982026">rand</span>&nbsp;<span class="ident" id="3982031">io</span><span class="op" id="3982033">.</span><span class="ident" id="3982034">Reader</span><span class="op" id="3982040">,</span>&nbsp;<span class="ident" id="3982042">priv</span>&nbsp;<span class="keyword" id="3982047">interface</span><span class="op" id="3982056">{</span><span class="op" id="3982057">}</span><span class="op" id="3982058">,</span>&nbsp;<span class="ident" id="3982060">revokedCerts</span>&nbsp;<span class="op" id="3982073">[</span><span class="op" id="3982074">]</span><span class="ident" id="3982075">pkix</span><span class="op" id="3982079">.</span><span class="ident" id="3982080">RevokedCertificate</span><span class="op" id="3982098">,</span>&nbsp;<span class="ident" id="3982100">now</span><span class="op" id="3982103">,</span>&nbsp;<span class="ident" id="3982105">expiry</span>&nbsp;<span class="ident" id="3982112">time</span><span class="op" id="3982116">.</span><span class="ident" id="3982117">Time</span><span class="op" id="3982121">)</span>&nbsp;<span class="op" id="3982123">(</span><span class="ident" id="3982124">crlBytes</span>&nbsp;<span class="op" id="3982133">[</span><span class="op" id="3982134">]</span><span class="builtintype" id="3982135">byte</span><span class="op" id="3982139">,</span>&nbsp;<span class="ident" id="3982141">err</span>&nbsp;<span class="builtintype" id="3982145">error</span><span class="op" id="3982150">)</span>&nbsp;<span class="op" id="3982152">{</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982155">rsaPriv</span><span class="op" id="3982162">,</span>&nbsp;<span class="ident" id="3982164">ok</span>&nbsp;<span class="op" id="3982167">:=</span>&nbsp;<span class="ident" id="3982170">priv</span><span class="op" id="3982174">.</span><span class="op" id="3982175">(</span><span class="op" id="3982176">*</span><span class="ident" id="3982177">rsa</span><span class="op" id="3982180">.</span><span class="ident" id="3982181">PrivateKey</span><span class="op" id="3982191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3982194">if</span>&nbsp;<span class="op" id="3982197">!</span><span class="ident" id="3982198">ok</span>&nbsp;<span class="op" id="3982201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3982205">return</span>&nbsp;<span class="builtintype" id="3982212">nil</span><span class="op" id="3982215">,</span>&nbsp;<span class="ident" id="3982217">errors</span><span class="op" id="3982223">.</span><span class="ident" id="3982224">New</span><span class="op" id="3982227">(</span><span class="string" id="3982228">&#34;x509:&nbsp;non-RSA&nbsp;private&nbsp;keys&nbsp;not&nbsp;supported&#34;</span><span class="op" id="3982270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3982273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982276">tbsCertList</span>&nbsp;<span class="op" id="3982288">:=</span>&nbsp;<span class="ident" id="3982291">pkix</span><span class="op" id="3982295">.</span><span class="ident" id="3982296">TBSCertificateList</span><span class="op" id="3982314">{</span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982318">Version</span><span class="op" id="3982325">:</span>&nbsp;<span class="num" id="3982327">2</span><span class="op" id="3982328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982332">Signature</span><span class="op" id="3982341">:</span>&nbsp;<span class="ident" id="3982343">pkix</span><span class="op" id="3982347">.</span><span class="ident" id="3982348">AlgorithmIdentifier</span><span class="op" id="3982367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982372">Algorithm</span><span class="op" id="3982381">:</span>&nbsp;<span class="ident" id="3982383">oidSignatureSHA1WithRSA</span><span class="op" id="3982406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3982410">}</span><span class="op" id="3982411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982415">Issuer</span><span class="op" id="3982421">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982436">c</span><span class="op" id="3982437">.</span><span class="ident" id="3982438">Subject</span><span class="op" id="3982445">.</span><span class="ident" id="3982446">ToRDNSequence</span><span class="op" id="3982459">(</span><span class="op" id="3982460">)</span><span class="op" id="3982461">,</span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982465">ThisUpdate</span><span class="op" id="3982475">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982486">now</span><span class="op" id="3982489">.</span><span class="ident" id="3982490">UTC</span><span class="op" id="3982493">(</span><span class="op" id="3982494">)</span><span class="op" id="3982495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982499">NextUpdate</span><span class="op" id="3982509">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982520">expiry</span><span class="op" id="3982526">.</span><span class="ident" id="3982527">UTC</span><span class="op" id="3982530">(</span><span class="op" id="3982531">)</span><span class="op" id="3982532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982536">RevokedCertificates</span><span class="op" id="3982555">:</span>&nbsp;<span class="ident" id="3982557">revokedCerts</span><span class="op" id="3982569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3982572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982576">tbsCertListContents</span><span class="op" id="3982595">,</span>&nbsp;<span class="ident" id="3982597">err</span>&nbsp;<span class="op" id="3982601">:=</span>&nbsp;<span class="ident" id="3982604">asn1</span><span class="op" id="3982608">.</span><span class="ident" id="3982609">Marshal</span><span class="op" id="3982616">(</span><span class="ident" id="3982617">tbsCertList</span><span class="op" id="3982628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3982631">if</span>&nbsp;<span class="ident" id="3982634">err</span>&nbsp;<span class="op" id="3982638">!=</span>&nbsp;<span class="builtintype" id="3982641">nil</span>&nbsp;<span class="op" id="3982645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3982649">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3982657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982661">h</span>&nbsp;<span class="op" id="3982663">:=</span>&nbsp;<span class="ident" id="3982666">sha1</span><span class="op" id="3982670">.</span><span class="ident" id="3982671">New</span><span class="op" id="3982674">(</span><span class="op" id="3982675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982678">h</span><span class="op" id="3982679">.</span><span class="ident" id="3982680">Write</span><span class="op" id="3982685">(</span><span class="ident" id="3982686">tbsCertListContents</span><span class="op" id="3982705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982708">digest</span>&nbsp;<span class="op" id="3982715">:=</span>&nbsp;<span class="ident" id="3982718">h</span><span class="op" id="3982719">.</span><span class="ident" id="3982720">Sum</span><span class="op" id="3982723">(</span><span class="builtintype" id="3982724">nil</span><span class="op" id="3982727">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982731">signature</span><span class="op" id="3982740">,</span>&nbsp;<span class="ident" id="3982742">err</span>&nbsp;<span class="op" id="3982746">:=</span>&nbsp;<span class="ident" id="3982749">rsa</span><span class="op" id="3982752">.</span><span class="ident" id="3982753">SignPKCS1v15</span><span class="op" id="3982765">(</span><span class="ident" id="3982766">rand</span><span class="op" id="3982770">,</span>&nbsp;<span class="ident" id="3982772">rsaPriv</span><span class="op" id="3982779">,</span>&nbsp;<span class="ident" id="3982781">crypto</span><span class="op" id="3982787">.</span><span class="ident" id="3982788">SHA1</span><span class="op" id="3982792">,</span>&nbsp;<span class="ident" id="3982794">digest</span><span class="op" id="3982800">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3982803">if</span>&nbsp;<span class="ident" id="3982806">err</span>&nbsp;<span class="op" id="3982810">!=</span>&nbsp;<span class="builtintype" id="3982813">nil</span>&nbsp;<span class="op" id="3982817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3982821">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3982829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3982833">return</span>&nbsp;<span class="ident" id="3982840">asn1</span><span class="op" id="3982844">.</span><span class="ident" id="3982845">Marshal</span><span class="op" id="3982852">(</span><span class="ident" id="3982853">pkix</span><span class="op" id="3982857">.</span><span class="ident" id="3982858">CertificateList</span><span class="op" id="3982873">{</span><br>
<span class="lineno">1600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982877">TBSCertList</span><span class="op" id="3982888">:</span>&nbsp;<span class="ident" id="3982890">tbsCertList</span><span class="op" id="3982901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982905">SignatureAlgorithm</span><span class="op" id="3982923">:</span>&nbsp;<span class="ident" id="3982925">pkix</span><span class="op" id="3982929">.</span><span class="ident" id="3982930">AlgorithmIdentifier</span><span class="op" id="3982949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982954">Algorithm</span><span class="op" id="3982963">:</span>&nbsp;<span class="ident" id="3982965">oidSignatureSHA1WithRSA</span><span class="op" id="3982988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3982992">}</span><span class="op" id="3982993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3982997">SignatureValue</span><span class="op" id="3983011">:</span>&nbsp;<span class="ident" id="3983013">asn1</span><span class="op" id="3983017">.</span><span class="ident" id="3983018">BitString</span><span class="op" id="3983027">{</span><span class="ident" id="3983028">Bytes</span><span class="op" id="3983033">:</span>&nbsp;<span class="ident" id="3983035">signature</span><span class="op" id="3983044">,</span>&nbsp;<span class="ident" id="3983046">BitLength</span><span class="op" id="3983055">:</span>&nbsp;<span class="builtinfunc" id="3983057">len</span><span class="op" id="3983060">(</span><span class="ident" id="3983061">signature</span><span class="op" id="3983070">)</span>&nbsp;<span class="op" id="3983072">*</span>&nbsp;<span class="num" id="3983074">8</span><span class="op" id="3983075">}</span><span class="op" id="3983076">,</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3983079">}</span><span class="op" id="3983080">)</span><br>
<span class="lineno"></span><span class="op" id="3983082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3983085">//&nbsp;CertificateRequest&nbsp;represents&nbsp;a&nbsp;PKCS&nbsp;#10,&nbsp;certificate&nbsp;signature&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="3983161">type</span>&nbsp;<span class="ident" id="3983166">CertificateRequest</span>&nbsp;<span class="keyword" id="3983185">struct</span>&nbsp;<span class="op" id="3983192">{</span><br>
<span class="lineno">1610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3983195">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3983220">[</span><span class="op" id="3983221">]</span><span class="builtintype" id="3983222">byte</span>&nbsp;<span class="comment" id="3983227">//&nbsp;Complete&nbsp;ASN.1&nbsp;DER&nbsp;content&nbsp;(CSR,&nbsp;signature&nbsp;algorithm&nbsp;and&nbsp;signature).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3983300">RawTBSCertificateRequest</span>&nbsp;<span class="op" id="3983325">[</span><span class="op" id="3983326">]</span><span class="builtintype" id="3983327">byte</span>&nbsp;<span class="comment" id="3983332">//&nbsp;Certificate&nbsp;request&nbsp;info&nbsp;part&nbsp;of&nbsp;raw&nbsp;ASN.1&nbsp;DER&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3983392">RawSubjectPublicKeyInfo</span>&nbsp;&nbsp;<span class="op" id="3983417">[</span><span class="op" id="3983418">]</span><span class="builtintype" id="3983419">byte</span>&nbsp;<span class="comment" id="3983424">//&nbsp;DER&nbsp;encoded&nbsp;SubjectPublicKeyInfo.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3983462">RawSubject</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3983487">[</span><span class="op" id="3983488">]</span><span class="builtintype" id="3983489">byte</span>&nbsp;<span class="comment" id="3983494">//&nbsp;DER&nbsp;encoded&nbsp;Subject.</span><br>
<span class="lineno"></span><br>
<span class="lineno">1615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3983520">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3983539">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3983544">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3983563">[</span><span class="op" id="3983564">]</span><span class="builtintype" id="3983565">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3983571">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3983590">SignatureAlgorithm</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3983611">PublicKeyAlgorithm</span>&nbsp;<span class="ident" id="3983630">PublicKeyAlgorithm</span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3983650">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3983669">interface</span><span class="op" id="3983678">{</span><span class="op" id="3983679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3983683">Subject</span>&nbsp;<span class="ident" id="3983691">pkix</span><span class="op" id="3983695">.</span><span class="ident" id="3983696">Name</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3983703">//&nbsp;Attributes&nbsp;is&nbsp;a&nbsp;collection&nbsp;of&nbsp;attributes&nbsp;providing</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3983758">//&nbsp;additional&nbsp;information&nbsp;about&nbsp;the&nbsp;subject&nbsp;of&nbsp;the&nbsp;certificate.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3983823">//&nbsp;See&nbsp;RFC&nbsp;2986&nbsp;section&nbsp;4.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3983853">Attributes</span>&nbsp;<span class="op" id="3983864">[</span><span class="op" id="3983865">]</span><span class="ident" id="3983866">pkix</span><span class="op" id="3983870">.</span><span class="ident" id="3983871">AttributeTypeAndValueSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3983898">//&nbsp;Extensions&nbsp;contains&nbsp;raw&nbsp;X.509&nbsp;extensions.&nbsp;When&nbsp;parsing&nbsp;CSRs,&nbsp;this</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3983968">//&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;extract&nbsp;extensions&nbsp;that&nbsp;are&nbsp;not&nbsp;parsed&nbsp;by&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3984034">//&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984047">Extensions</span>&nbsp;<span class="op" id="3984058">[</span><span class="op" id="3984059">]</span><span class="ident" id="3984060">pkix</span><span class="op" id="3984064">.</span><span class="ident" id="3984065">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3984077">//&nbsp;ExtraExtensions&nbsp;contains&nbsp;extensions&nbsp;to&nbsp;be&nbsp;copied,&nbsp;raw,&nbsp;into&nbsp;any</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3984145">//&nbsp;marshaled&nbsp;CSR.&nbsp;Values&nbsp;override&nbsp;any&nbsp;extensions&nbsp;that&nbsp;would&nbsp;otherwise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3984216">//&nbsp;be&nbsp;produced&nbsp;based&nbsp;on&nbsp;the&nbsp;other&nbsp;fields&nbsp;but&nbsp;are&nbsp;overridden&nbsp;by&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3984284">//&nbsp;extensions&nbsp;specified&nbsp;in&nbsp;Attributes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3984324">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3984328">//&nbsp;The&nbsp;ExtraExtensions&nbsp;field&nbsp;is&nbsp;not&nbsp;populated&nbsp;when&nbsp;parsing&nbsp;CSRs,&nbsp;see</span><br>
<span class="lineno">1640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3984398">//&nbsp;Extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984414">ExtraExtensions</span>&nbsp;<span class="op" id="3984430">[</span><span class="op" id="3984431">]</span><span class="ident" id="3984432">pkix</span><span class="op" id="3984436">.</span><span class="ident" id="3984437">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3984449">//&nbsp;Subject&nbsp;Alternate&nbsp;Name&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984484">DNSNames</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3984499">[</span><span class="op" id="3984500">]</span><span class="builtintype" id="3984501">string</span><br>
<span class="lineno">1645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984509">EmailAddresses</span>&nbsp;<span class="op" id="3984524">[</span><span class="op" id="3984525">]</span><span class="builtintype" id="3984526">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984534">IPAddresses</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3984549">[</span><span class="op" id="3984550">]</span><span class="ident" id="3984551">net</span><span class="op" id="3984554">.</span><span class="ident" id="3984555">IP</span><br>
<span class="lineno"></span><span class="op" id="3984558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3984561">//&nbsp;These&nbsp;structures&nbsp;reflect&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;X.509&nbsp;certificate</span><br>
<span class="lineno">1650</span><span class="comment" id="3984630">//&nbsp;signature&nbsp;requests&nbsp;(see&nbsp;RFC&nbsp;2986):</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3984669">type</span>&nbsp;<span class="ident" id="3984674">tbsCertificateRequest</span>&nbsp;<span class="keyword" id="3984696">struct</span>&nbsp;<span class="op" id="3984703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984706">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984717">asn1</span><span class="op" id="3984721">.</span><span class="ident" id="3984722">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984734">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3984745">int</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984750">Subject</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984761">asn1</span><span class="op" id="3984765">.</span><span class="ident" id="3984766">RawValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984776">PublicKey</span>&nbsp;&nbsp;<span class="ident" id="3984787">publicKeyInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984802">Attributes</span>&nbsp;<span class="op" id="3984813">[</span><span class="op" id="3984814">]</span><span class="ident" id="3984815">pkix</span><span class="op" id="3984819">.</span><span class="ident" id="3984820">AttributeTypeAndValueSET</span>&nbsp;<span class="string" id="3984845">`asn1:&#34;tag:0&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3984860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1660</span><span class="keyword" id="3984863">type</span>&nbsp;<span class="ident" id="3984868">certificateRequest</span>&nbsp;<span class="keyword" id="3984887">struct</span>&nbsp;<span class="op" id="3984894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984897">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984916">asn1</span><span class="op" id="3984920">.</span><span class="ident" id="3984921">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984933">TBSCSR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984952">tbsCertificateRequest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3984975">SignatureAlgorithm</span>&nbsp;<span class="ident" id="3984994">pkix</span><span class="op" id="3984998">.</span><span class="ident" id="3984999">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3985020">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3985039">asn1</span><span class="op" id="3985043">.</span><span class="ident" id="3985044">BitString</span><br>
<span class="lineno">1665</span><span class="op" id="3985054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3985057">//&nbsp;oidExtensionRequest&nbsp;is&nbsp;a&nbsp;PKCS#9&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;that&nbsp;indicates&nbsp;requested</span><br>
<span class="lineno"></span><span class="comment" id="3985135">//&nbsp;extensions&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span><span class="keyword" id="3985159">var</span>&nbsp;<span class="ident" id="3985163">oidExtensionRequest</span>&nbsp;<span class="op" id="3985183">=</span>&nbsp;<span class="ident" id="3985185">asn1</span><span class="op" id="3985189">.</span><span class="ident" id="3985190">ObjectIdentifier</span><span class="op" id="3985206">{</span><span class="num" id="3985207">1</span><span class="op" id="3985208">,</span>&nbsp;<span class="num" id="3985210">2</span><span class="op" id="3985211">,</span>&nbsp;<span class="num" id="3985213">840</span><span class="op" id="3985216">,</span>&nbsp;<span class="num" id="3985218">113549</span><span class="op" id="3985224">,</span>&nbsp;<span class="num" id="3985226">1</span><span class="op" id="3985227">,</span>&nbsp;<span class="num" id="3985229">9</span><span class="op" id="3985230">,</span>&nbsp;<span class="num" id="3985232">14</span><span class="op" id="3985234">}</span><br>
<span class="lineno">1670</span><br>
<span class="lineno"></span><span class="comment" id="3985237">//&nbsp;CreateCertificateRequest&nbsp;creates&nbsp;a&nbsp;new&nbsp;certificate&nbsp;based&nbsp;on&nbsp;a&nbsp;template.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3985316">//&nbsp;following&nbsp;members&nbsp;of&nbsp;template&nbsp;are&nbsp;used:&nbsp;Subject,&nbsp;Attributes,</span><br>
<span class="lineno"></span><span class="comment" id="3985380">//&nbsp;SignatureAlgorithm,&nbsp;Extensions,&nbsp;DNSNames,&nbsp;EmailAddresses,&nbsp;and&nbsp;IPAddresses.</span><br>
<span class="lineno"></span><span class="comment" id="3985458">//&nbsp;The&nbsp;private&nbsp;key&nbsp;is&nbsp;the&nbsp;private&nbsp;key&nbsp;of&nbsp;the&nbsp;signer.</span><br>
<span class="lineno">1675</span><span class="comment" id="3985511">//</span><br>
<span class="lineno"></span><span class="comment" id="3985514">//&nbsp;The&nbsp;returned&nbsp;slice&nbsp;is&nbsp;the&nbsp;certificate&nbsp;request&nbsp;in&nbsp;DER&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="3985580">//</span><br>
<span class="lineno"></span><span class="comment" id="3985583">//&nbsp;The&nbsp;only&nbsp;supported&nbsp;key&nbsp;types&nbsp;are&nbsp;RSA&nbsp;(*rsa.PrivateKey)&nbsp;and&nbsp;ECDSA</span><br>
<span class="lineno"></span><span class="comment" id="3985651">//&nbsp;(*ecdsa.PrivateKey).</span><br>
<span class="lineno">1680</span><span class="keyword" id="3985675">func</span>&nbsp;<span class="ident" id="3985680">CreateCertificateRequest</span><span class="op" id="3985704">(</span><span class="ident" id="3985705">rand</span>&nbsp;<span class="ident" id="3985710">io</span><span class="op" id="3985712">.</span><span class="ident" id="3985713">Reader</span><span class="op" id="3985719">,</span>&nbsp;<span class="ident" id="3985721">template</span>&nbsp;<span class="op" id="3985730">*</span><span class="ident" id="3985731">CertificateRequest</span><span class="op" id="3985749">,</span>&nbsp;<span class="ident" id="3985751">priv</span>&nbsp;<span class="keyword" id="3985756">interface</span><span class="op" id="3985765">{</span><span class="op" id="3985766">}</span><span class="op" id="3985767">)</span>&nbsp;<span class="op" id="3985769">(</span><span class="ident" id="3985770">csr</span>&nbsp;<span class="op" id="3985774">[</span><span class="op" id="3985775">]</span><span class="builtintype" id="3985776">byte</span><span class="op" id="3985780">,</span>&nbsp;<span class="ident" id="3985782">err</span>&nbsp;<span class="builtintype" id="3985786">error</span><span class="op" id="3985791">)</span>&nbsp;<span class="op" id="3985793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3985796">hashFunc</span><span class="op" id="3985804">,</span>&nbsp;<span class="ident" id="3985806">sigAlgo</span><span class="op" id="3985813">,</span>&nbsp;<span class="ident" id="3985815">err</span>&nbsp;<span class="op" id="3985819">:=</span>&nbsp;<span class="ident" id="3985822">signingParamsForPrivateKey</span><span class="op" id="3985848">(</span><span class="ident" id="3985849">priv</span><span class="op" id="3985853">,</span>&nbsp;<span class="ident" id="3985855">template</span><span class="op" id="3985863">.</span><span class="ident" id="3985864">SignatureAlgorithm</span><span class="op" id="3985882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3985885">if</span>&nbsp;<span class="ident" id="3985888">err</span>&nbsp;<span class="op" id="3985892">!=</span>&nbsp;<span class="builtintype" id="3985895">nil</span>&nbsp;<span class="op" id="3985899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3985903">return</span>&nbsp;<span class="builtintype" id="3985910">nil</span><span class="op" id="3985913">,</span>&nbsp;<span class="ident" id="3985915">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3985920">}</span><br>
<span class="lineno">1685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3985924">var</span>&nbsp;<span class="ident" id="3985928">publicKeyBytes</span>&nbsp;<span class="op" id="3985943">[</span><span class="op" id="3985944">]</span><span class="builtintype" id="3985945">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3985951">var</span>&nbsp;<span class="ident" id="3985955">publicKeyAlgorithm</span>&nbsp;<span class="ident" id="3985974">pkix</span><span class="op" id="3985978">.</span><span class="ident" id="3985979">AlgorithmIdentifier</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986001">switch</span>&nbsp;<span class="ident" id="3986008">priv</span>&nbsp;<span class="op" id="3986013">:=</span>&nbsp;<span class="ident" id="3986016">priv</span><span class="op" id="3986020">.</span><span class="op" id="3986021">(</span><span class="keyword" id="3986022">type</span><span class="op" id="3986026">)</span>&nbsp;<span class="op" id="3986028">{</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986031">case</span>&nbsp;<span class="op" id="3986036">*</span><span class="ident" id="3986037">rsa</span><span class="op" id="3986040">.</span><span class="ident" id="3986041">PrivateKey</span><span class="op" id="3986051">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3986055">publicKeyBytes</span><span class="op" id="3986069">,</span>&nbsp;<span class="ident" id="3986071">publicKeyAlgorithm</span><span class="op" id="3986089">,</span>&nbsp;<span class="ident" id="3986091">err</span>&nbsp;<span class="op" id="3986095">=</span>&nbsp;<span class="ident" id="3986097">marshalPublicKey</span><span class="op" id="3986113">(</span><span class="op" id="3986114">&amp;</span><span class="ident" id="3986115">priv</span><span class="op" id="3986119">.</span><span class="ident" id="3986120">PublicKey</span><span class="op" id="3986129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986132">case</span>&nbsp;<span class="op" id="3986137">*</span><span class="ident" id="3986138">ecdsa</span><span class="op" id="3986143">.</span><span class="ident" id="3986144">PrivateKey</span><span class="op" id="3986154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3986158">publicKeyBytes</span><span class="op" id="3986172">,</span>&nbsp;<span class="ident" id="3986174">publicKeyAlgorithm</span><span class="op" id="3986192">,</span>&nbsp;<span class="ident" id="3986194">err</span>&nbsp;<span class="op" id="3986198">=</span>&nbsp;<span class="ident" id="3986200">marshalPublicKey</span><span class="op" id="3986216">(</span><span class="op" id="3986217">&amp;</span><span class="ident" id="3986218">priv</span><span class="op" id="3986222">.</span><span class="ident" id="3986223">PublicKey</span><span class="op" id="3986232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986235">default</span><span class="op" id="3986242">:</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3986246">panic</span><span class="op" id="3986251">(</span><span class="string" id="3986252">&#34;internal&nbsp;error&#34;</span><span class="op" id="3986268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3986271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986275">if</span>&nbsp;<span class="ident" id="3986278">err</span>&nbsp;<span class="op" id="3986282">!=</span>&nbsp;<span class="builtintype" id="3986285">nil</span>&nbsp;<span class="op" id="3986289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986293">return</span>&nbsp;<span class="builtintype" id="3986300">nil</span><span class="op" id="3986303">,</span>&nbsp;<span class="ident" id="3986305">err</span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3986310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986314">var</span>&nbsp;<span class="ident" id="3986318">extensions</span>&nbsp;<span class="op" id="3986329">[</span><span class="op" id="3986330">]</span><span class="ident" id="3986331">pkix</span><span class="op" id="3986335">.</span><span class="ident" id="3986336">Extension</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986348">if</span>&nbsp;<span class="op" id="3986351">(</span><span class="builtinfunc" id="3986352">len</span><span class="op" id="3986355">(</span><span class="ident" id="3986356">template</span><span class="op" id="3986364">.</span><span class="ident" id="3986365">DNSNames</span><span class="op" id="3986373">)</span>&nbsp;<span class="op" id="3986375">&gt;</span>&nbsp;<span class="num" id="3986377">0</span>&nbsp;<span class="op" id="3986379">||</span>&nbsp;<span class="builtinfunc" id="3986382">len</span><span class="op" id="3986385">(</span><span class="ident" id="3986386">template</span><span class="op" id="3986394">.</span><span class="ident" id="3986395">EmailAddresses</span><span class="op" id="3986409">)</span>&nbsp;<span class="op" id="3986411">&gt;</span>&nbsp;<span class="num" id="3986413">0</span>&nbsp;<span class="op" id="3986415">||</span>&nbsp;<span class="builtinfunc" id="3986418">len</span><span class="op" id="3986421">(</span><span class="ident" id="3986422">template</span><span class="op" id="3986430">.</span><span class="ident" id="3986431">IPAddresses</span><span class="op" id="3986442">)</span>&nbsp;<span class="op" id="3986444">&gt;</span>&nbsp;<span class="num" id="3986446">0</span><span class="op" id="3986447">)</span>&nbsp;<span class="op" id="3986449">&amp;&amp;</span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3986454">!</span><span class="ident" id="3986455">oidInExtensions</span><span class="op" id="3986470">(</span><span class="ident" id="3986471">oidExtensionSubjectAltName</span><span class="op" id="3986497">,</span>&nbsp;<span class="ident" id="3986499">template</span><span class="op" id="3986507">.</span><span class="ident" id="3986508">ExtraExtensions</span><span class="op" id="3986523">)</span>&nbsp;<span class="op" id="3986525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3986529">sanBytes</span><span class="op" id="3986537">,</span>&nbsp;<span class="ident" id="3986539">err</span>&nbsp;<span class="op" id="3986543">:=</span>&nbsp;<span class="ident" id="3986546">marshalSANs</span><span class="op" id="3986557">(</span><span class="ident" id="3986558">template</span><span class="op" id="3986566">.</span><span class="ident" id="3986567">DNSNames</span><span class="op" id="3986575">,</span>&nbsp;<span class="ident" id="3986577">template</span><span class="op" id="3986585">.</span><span class="ident" id="3986586">EmailAddresses</span><span class="op" id="3986600">,</span>&nbsp;<span class="ident" id="3986602">template</span><span class="op" id="3986610">.</span><span class="ident" id="3986611">IPAddresses</span><span class="op" id="3986622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986626">if</span>&nbsp;<span class="ident" id="3986629">err</span>&nbsp;<span class="op" id="3986633">!=</span>&nbsp;<span class="builtintype" id="3986636">nil</span>&nbsp;<span class="op" id="3986640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986645">return</span>&nbsp;<span class="builtintype" id="3986652">nil</span><span class="op" id="3986655">,</span>&nbsp;<span class="ident" id="3986657">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3986663">}</span><br>
<span class="lineno">1710</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3986668">extensions</span>&nbsp;<span class="op" id="3986679">=</span>&nbsp;<span class="builtinfunc" id="3986681">append</span><span class="op" id="3986687">(</span><span class="ident" id="3986688">extensions</span><span class="op" id="3986698">,</span>&nbsp;<span class="ident" id="3986700">pkix</span><span class="op" id="3986704">.</span><span class="ident" id="3986705">Extension</span><span class="op" id="3986714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3986719">Id</span><span class="op" id="3986721">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3986726">oidExtensionSubjectAltName</span><span class="op" id="3986752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3986757">Value</span><span class="op" id="3986762">:</span>&nbsp;<span class="ident" id="3986764">sanBytes</span><span class="op" id="3986772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3986776">}</span><span class="op" id="3986777">)</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3986780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3986784">extensions</span>&nbsp;<span class="op" id="3986795">=</span>&nbsp;<span class="builtinfunc" id="3986797">append</span><span class="op" id="3986803">(</span><span class="ident" id="3986804">extensions</span><span class="op" id="3986814">,</span>&nbsp;<span class="ident" id="3986816">template</span><span class="op" id="3986824">.</span><span class="ident" id="3986825">ExtraExtensions</span><span class="op" id="3986840">...</span><span class="op" id="3986843">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986847">var</span>&nbsp;<span class="ident" id="3986851">attributes</span>&nbsp;<span class="op" id="3986862">[</span><span class="op" id="3986863">]</span><span class="ident" id="3986864">pkix</span><span class="op" id="3986868">.</span><span class="ident" id="3986869">AttributeTypeAndValueSET</span><br>
<span class="lineno">1720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3986895">attributes</span>&nbsp;<span class="op" id="3986906">=</span>&nbsp;<span class="builtinfunc" id="3986908">append</span><span class="op" id="3986914">(</span><span class="ident" id="3986915">attributes</span><span class="op" id="3986925">,</span>&nbsp;<span class="ident" id="3986927">template</span><span class="op" id="3986935">.</span><span class="ident" id="3986936">Attributes</span><span class="op" id="3986946">...</span><span class="op" id="3986949">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3986953">if</span>&nbsp;<span class="builtinfunc" id="3986956">len</span><span class="op" id="3986959">(</span><span class="ident" id="3986960">extensions</span><span class="op" id="3986970">)</span>&nbsp;<span class="op" id="3986972">&gt;</span>&nbsp;<span class="num" id="3986974">0</span>&nbsp;<span class="op" id="3986976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3986980">//&nbsp;specifiedExtensions&nbsp;contains&nbsp;all&nbsp;the&nbsp;extensions&nbsp;that&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3987041">//&nbsp;found&nbsp;specified&nbsp;via&nbsp;template.Attributes.</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3987087">specifiedExtensions</span>&nbsp;<span class="op" id="3987107">:=</span>&nbsp;<span class="builtinfunc" id="3987110">make</span><span class="op" id="3987114">(</span><span class="keyword" id="3987115">map</span><span class="op" id="3987118">[</span><span class="builtintype" id="3987119">string</span><span class="op" id="3987125">]</span><span class="builtintype" id="3987126">bool</span><span class="op" id="3987130">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3987135">for</span>&nbsp;<span class="ident" id="3987139">_</span><span class="op" id="3987140">,</span>&nbsp;<span class="ident" id="3987142">atvSet</span>&nbsp;<span class="op" id="3987149">:=</span>&nbsp;<span class="keyword" id="3987152">range</span>&nbsp;<span class="ident" id="3987158">template</span><span class="op" id="3987166">.</span><span class="ident" id="3987167">Attributes</span>&nbsp;<span class="op" id="3987178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3987183">if</span>&nbsp;<span class="op" id="3987186">!</span><span class="ident" id="3987187">atvSet</span><span class="op" id="3987193">.</span><span class="ident" id="3987194">Type</span><span class="op" id="3987198">.</span><span class="ident" id="3987199">Equal</span><span class="op" id="3987204">(</span><span class="ident" id="3987205">oidExtensionRequest</span><span class="op" id="3987224">)</span>&nbsp;<span class="op" id="3987226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3987232">continue</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3987244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3987250">for</span>&nbsp;<span class="ident" id="3987254">_</span><span class="op" id="3987255">,</span>&nbsp;<span class="ident" id="3987257">atvs</span>&nbsp;<span class="op" id="3987262">:=</span>&nbsp;<span class="keyword" id="3987265">range</span>&nbsp;<span class="ident" id="3987271">atvSet</span><span class="op" id="3987277">.</span><span class="ident" id="3987278">Value</span>&nbsp;<span class="op" id="3987284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3987290">for</span>&nbsp;<span class="ident" id="3987294">_</span><span class="op" id="3987295">,</span>&nbsp;<span class="ident" id="3987297">atv</span>&nbsp;<span class="op" id="3987301">:=</span>&nbsp;<span class="keyword" id="3987304">range</span>&nbsp;<span class="ident" id="3987310">atvs</span>&nbsp;<span class="op" id="3987315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3987322">specifiedExtensions</span><span class="op" id="3987341">[</span><span class="ident" id="3987342">atv</span><span class="op" id="3987345">.</span><span class="ident" id="3987346">Type</span><span class="op" id="3987350">.</span><span class="ident" id="3987351">String</span><span class="op" id="3987357">(</span><span class="op" id="3987358">)</span><span class="op" id="3987359">]</span>&nbsp;<span class="op" id="3987361">=</span>&nbsp;<span class="builtintype" id="3987363">true</span><br>
<span class="lineno">1735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3987372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3987377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3987381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3987386">atvs</span>&nbsp;<span class="op" id="3987391">:=</span>&nbsp;<span class="builtinfunc" id="3987394">make</span><span class="op" id="3987398">(</span><span class="op" id="3987399">[</span><span class="op" id="3987400">]</span><span class="ident" id="3987401">pkix</span><span class="op" id="3987405">.</span><span class="ident" id="3987406">AttributeTypeAndValue</span><span class="op" id="3987427">,</span>&nbsp;<span class="num" id="3987429">0</span><span class="op" id="3987430">,</span>&nbsp;<span class="builtinfunc" id="3987432">len</span><span class="op" id="3987435">(</span><span class="ident" id="3987436">extensions</span><span class="op" id="3987446">)</span><span class="op" id="3987447">)</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3987451">for</span>&nbsp;<span class="ident" id="3987455">_</span><span class="op" id="3987456">,</span>&nbsp;<span class="ident" id="3987458">e</span>&nbsp;<span class="op" id="3987460">:=</span>&nbsp;<span class="keyword" id="3987463">range</span>&nbsp;<span class="ident" id="3987469">extensions</span>&nbsp;<span class="op" id="3987480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3987485">if</span>&nbsp;<span class="ident" id="3987488">specifiedExtensions</span><span class="op" id="3987507">[</span><span class="ident" id="3987508">e</span><span class="op" id="3987509">.</span><span class="ident" id="3987510">Id</span><span class="op" id="3987512">.</span><span class="ident" id="3987513">String</span><span class="op" id="3987519">(</span><span class="op" id="3987520">)</span><span class="op" id="3987521">]</span>&nbsp;<span class="op" id="3987523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3987529">//&nbsp;Attributes&nbsp;already&nbsp;contained&nbsp;a&nbsp;value&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3987577">//&nbsp;this&nbsp;extension&nbsp;and&nbsp;it&nbsp;takes&nbsp;priority.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3987622">continue</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3987634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3987640">atvs</span>&nbsp;<span class="op" id="3987645">=</span>&nbsp;<span class="builtinfunc" id="3987647">append</span><span class="op" id="3987653">(</span><span class="ident" id="3987654">atvs</span><span class="op" id="3987658">,</span>&nbsp;<span class="ident" id="3987660">pkix</span><span class="op" id="3987664">.</span><span class="ident" id="3987665">AttributeTypeAndValue</span><span class="op" id="3987686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3987692">//&nbsp;There&nbsp;is&nbsp;no&nbsp;place&nbsp;for&nbsp;the&nbsp;critical&nbsp;flag&nbsp;in&nbsp;a&nbsp;CSR.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3987749">Type</span><span class="op" id="3987753">:</span>&nbsp;&nbsp;<span class="ident" id="3987756">e</span><span class="op" id="3987757">.</span><span class="ident" id="3987758">Id</span><span class="op" id="3987760">,</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3987766">Value</span><span class="op" id="3987771">:</span>&nbsp;<span class="ident" id="3987773">e</span><span class="op" id="3987774">.</span><span class="ident" id="3987775">Value</span><span class="op" id="3987780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3987785">}</span><span class="op" id="3987786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3987790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3987795">//&nbsp;Append&nbsp;the&nbsp;extensions&nbsp;to&nbsp;an&nbsp;existing&nbsp;attribute&nbsp;if&nbsp;possible.</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3987860">appended</span>&nbsp;<span class="op" id="3987869">:=</span>&nbsp;<span class="builtintype" id="3987872">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3987880">for</span>&nbsp;<span class="ident" id="3987884">_</span><span class="op" id="3987885">,</span>&nbsp;<span class="ident" id="3987887">atvSet</span>&nbsp;<span class="op" id="3987894">:=</span>&nbsp;<span class="keyword" id="3987897">range</span>&nbsp;<span class="ident" id="3987903">attributes</span>&nbsp;<span class="op" id="3987914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3987919">if</span>&nbsp;<span class="op" id="3987922">!</span><span class="ident" id="3987923">atvSet</span><span class="op" id="3987929">.</span><span class="ident" id="3987930">Type</span><span class="op" id="3987934">.</span><span class="ident" id="3987935">Equal</span><span class="op" id="3987940">(</span><span class="ident" id="3987941">oidExtensionRequest</span><span class="op" id="3987960">)</span>&nbsp;<span class="op" id="3987962">||</span>&nbsp;<span class="builtinfunc" id="3987965">len</span><span class="op" id="3987968">(</span><span class="ident" id="3987969">atvSet</span><span class="op" id="3987975">.</span><span class="ident" id="3987976">Value</span><span class="op" id="3987981">)</span>&nbsp;<span class="op" id="3987983">==</span>&nbsp;<span class="num" id="3987986">0</span>&nbsp;<span class="op" id="3987988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3987994">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988006">}</span><br>
<span class="lineno">1760</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988012">atvSet</span><span class="op" id="3988018">.</span><span class="ident" id="3988019">Value</span><span class="op" id="3988024">[</span><span class="num" id="3988025">0</span><span class="op" id="3988026">]</span>&nbsp;<span class="op" id="3988028">=</span>&nbsp;<span class="builtinfunc" id="3988030">append</span><span class="op" id="3988036">(</span><span class="ident" id="3988037">atvSet</span><span class="op" id="3988043">.</span><span class="ident" id="3988044">Value</span><span class="op" id="3988049">[</span><span class="num" id="3988050">0</span><span class="op" id="3988051">]</span><span class="op" id="3988052">,</span>&nbsp;<span class="ident" id="3988054">atvs</span><span class="op" id="3988058">...</span><span class="op" id="3988061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988066">appended</span>&nbsp;<span class="op" id="3988075">=</span>&nbsp;<span class="builtintype" id="3988077">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3988085">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988093">}</span><br>
<span class="lineno">1765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3988098">//&nbsp;Otherwise,&nbsp;add&nbsp;a&nbsp;new&nbsp;attribute&nbsp;for&nbsp;the&nbsp;extensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3988154">if</span>&nbsp;<span class="op" id="3988157">!</span><span class="ident" id="3988158">appended</span>&nbsp;<span class="op" id="3988167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988172">attributes</span>&nbsp;<span class="op" id="3988183">=</span>&nbsp;<span class="builtinfunc" id="3988185">append</span><span class="op" id="3988191">(</span><span class="ident" id="3988192">attributes</span><span class="op" id="3988202">,</span>&nbsp;<span class="ident" id="3988204">pkix</span><span class="op" id="3988208">.</span><span class="ident" id="3988209">AttributeTypeAndValueSET</span><span class="op" id="3988233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988239">Type</span><span class="op" id="3988243">:</span>&nbsp;<span class="ident" id="3988245">oidExtensionRequest</span><span class="op" id="3988264">,</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988270">Value</span><span class="op" id="3988275">:</span>&nbsp;<span class="op" id="3988277">[</span><span class="op" id="3988278">]</span><span class="op" id="3988279">[</span><span class="op" id="3988280">]</span><span class="ident" id="3988281">pkix</span><span class="op" id="3988285">.</span><span class="ident" id="3988286">AttributeTypeAndValue</span><span class="op" id="3988307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988314">atvs</span><span class="op" id="3988318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988324">}</span><span class="op" id="3988325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988330">}</span><span class="op" id="3988331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988335">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988342">asn1Subject</span>&nbsp;<span class="op" id="3988354">:=</span>&nbsp;<span class="ident" id="3988357">template</span><span class="op" id="3988365">.</span><span class="ident" id="3988366">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3988378">if</span>&nbsp;<span class="builtinfunc" id="3988381">len</span><span class="op" id="3988384">(</span><span class="ident" id="3988385">asn1Subject</span><span class="op" id="3988396">)</span>&nbsp;<span class="op" id="3988398">==</span>&nbsp;<span class="num" id="3988401">0</span>&nbsp;<span class="op" id="3988403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988407">asn1Subject</span><span class="op" id="3988418">,</span>&nbsp;<span class="ident" id="3988420">err</span>&nbsp;<span class="op" id="3988424">=</span>&nbsp;<span class="ident" id="3988426">asn1</span><span class="op" id="3988430">.</span><span class="ident" id="3988431">Marshal</span><span class="op" id="3988438">(</span><span class="ident" id="3988439">template</span><span class="op" id="3988447">.</span><span class="ident" id="3988448">Subject</span><span class="op" id="3988455">.</span><span class="ident" id="3988456">ToRDNSequence</span><span class="op" id="3988469">(</span><span class="op" id="3988470">)</span><span class="op" id="3988471">)</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3988475">if</span>&nbsp;<span class="ident" id="3988478">err</span>&nbsp;<span class="op" id="3988482">!=</span>&nbsp;<span class="builtintype" id="3988485">nil</span>&nbsp;<span class="op" id="3988489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3988494">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988510">tbsCSR</span>&nbsp;<span class="op" id="3988517">:=</span>&nbsp;<span class="ident" id="3988520">tbsCertificateRequest</span><span class="op" id="3988541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988545">Version</span><span class="op" id="3988552">:</span>&nbsp;<span class="num" id="3988554">0</span><span class="op" id="3988555">,</span>&nbsp;<span class="comment" id="3988557">//&nbsp;PKCS&nbsp;#10,&nbsp;RFC&nbsp;2986</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988581">Subject</span><span class="op" id="3988588">:</span>&nbsp;<span class="ident" id="3988590">asn1</span><span class="op" id="3988594">.</span><span class="ident" id="3988595">RawValue</span><span class="op" id="3988603">{</span><span class="ident" id="3988604">FullBytes</span><span class="op" id="3988613">:</span>&nbsp;<span class="ident" id="3988615">asn1Subject</span><span class="op" id="3988626">}</span><span class="op" id="3988627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988631">PublicKey</span><span class="op" id="3988640">:</span>&nbsp;<span class="ident" id="3988642">publicKeyInfo</span><span class="op" id="3988655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988660">Algorithm</span><span class="op" id="3988669">:</span>&nbsp;<span class="ident" id="3988671">publicKeyAlgorithm</span><span class="op" id="3988689">,</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988694">PublicKey</span><span class="op" id="3988703">:</span>&nbsp;<span class="ident" id="3988705">asn1</span><span class="op" id="3988709">.</span><span class="ident" id="3988710">BitString</span><span class="op" id="3988719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988725">Bytes</span><span class="op" id="3988730">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988736">publicKeyBytes</span><span class="op" id="3988750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988756">BitLength</span><span class="op" id="3988765">:</span>&nbsp;<span class="builtinfunc" id="3988767">len</span><span class="op" id="3988770">(</span><span class="ident" id="3988771">publicKeyBytes</span><span class="op" id="3988785">)</span>&nbsp;<span class="op" id="3988787">*</span>&nbsp;<span class="num" id="3988789">8</span><span class="op" id="3988790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988795">}</span><span class="op" id="3988796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988800">}</span><span class="op" id="3988801">,</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988805">Attributes</span><span class="op" id="3988815">:</span>&nbsp;<span class="ident" id="3988817">attributes</span><span class="op" id="3988827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988834">tbsCSRContents</span><span class="op" id="3988848">,</span>&nbsp;<span class="ident" id="3988850">err</span>&nbsp;<span class="op" id="3988854">:=</span>&nbsp;<span class="ident" id="3988857">asn1</span><span class="op" id="3988861">.</span><span class="ident" id="3988862">Marshal</span><span class="op" id="3988869">(</span><span class="ident" id="3988870">tbsCSR</span><span class="op" id="3988876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3988879">if</span>&nbsp;<span class="ident" id="3988882">err</span>&nbsp;<span class="op" id="3988886">!=</span>&nbsp;<span class="builtintype" id="3988889">nil</span>&nbsp;<span class="op" id="3988893">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3988897">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3988905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988908">tbsCSR</span><span class="op" id="3988914">.</span><span class="ident" id="3988915">Raw</span>&nbsp;<span class="op" id="3988919">=</span>&nbsp;<span class="ident" id="3988921">tbsCSRContents</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988938">h</span>&nbsp;<span class="op" id="3988940">:=</span>&nbsp;<span class="ident" id="3988943">hashFunc</span><span class="op" id="3988951">.</span><span class="ident" id="3988952">New</span><span class="op" id="3988955">(</span><span class="op" id="3988956">)</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988959">h</span><span class="op" id="3988960">.</span><span class="ident" id="3988961">Write</span><span class="op" id="3988966">(</span><span class="ident" id="3988967">tbsCSRContents</span><span class="op" id="3988981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3988984">digest</span>&nbsp;<span class="op" id="3988991">:=</span>&nbsp;<span class="ident" id="3988994">h</span><span class="op" id="3988995">.</span><span class="ident" id="3988996">Sum</span><span class="op" id="3988999">(</span><span class="builtintype" id="3989000">nil</span><span class="op" id="3989003">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989007">var</span>&nbsp;<span class="ident" id="3989011">signature</span>&nbsp;<span class="op" id="3989021">[</span><span class="op" id="3989022">]</span><span class="builtintype" id="3989023">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989029">switch</span>&nbsp;<span class="ident" id="3989036">priv</span>&nbsp;<span class="op" id="3989041">:=</span>&nbsp;<span class="ident" id="3989044">priv</span><span class="op" id="3989048">.</span><span class="op" id="3989049">(</span><span class="keyword" id="3989050">type</span><span class="op" id="3989054">)</span>&nbsp;<span class="op" id="3989056">{</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989059">case</span>&nbsp;<span class="op" id="3989064">*</span><span class="ident" id="3989065">rsa</span><span class="op" id="3989068">.</span><span class="ident" id="3989069">PrivateKey</span><span class="op" id="3989079">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3989083">signature</span><span class="op" id="3989092">,</span>&nbsp;<span class="ident" id="3989094">err</span>&nbsp;<span class="op" id="3989098">=</span>&nbsp;<span class="ident" id="3989100">rsa</span><span class="op" id="3989103">.</span><span class="ident" id="3989104">SignPKCS1v15</span><span class="op" id="3989116">(</span><span class="ident" id="3989117">rand</span><span class="op" id="3989121">,</span>&nbsp;<span class="ident" id="3989123">priv</span><span class="op" id="3989127">,</span>&nbsp;<span class="ident" id="3989129">hashFunc</span><span class="op" id="3989137">,</span>&nbsp;<span class="ident" id="3989139">digest</span><span class="op" id="3989145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989148">case</span>&nbsp;<span class="op" id="3989153">*</span><span class="ident" id="3989154">ecdsa</span><span class="op" id="3989159">.</span><span class="ident" id="3989160">PrivateKey</span><span class="op" id="3989170">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989174">var</span>&nbsp;<span class="ident" id="3989178">r</span><span class="op" id="3989179">,</span>&nbsp;<span class="ident" id="3989181">s</span>&nbsp;<span class="op" id="3989183">*</span><span class="ident" id="3989184">big</span><span class="op" id="3989187">.</span><span class="ident" id="3989188">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989194">if</span>&nbsp;<span class="ident" id="3989197">r</span><span class="op" id="3989198">,</span>&nbsp;<span class="ident" id="3989200">s</span><span class="op" id="3989201">,</span>&nbsp;<span class="ident" id="3989203">err</span>&nbsp;<span class="op" id="3989207">=</span>&nbsp;<span class="ident" id="3989209">ecdsa</span><span class="op" id="3989214">.</span><span class="ident" id="3989215">Sign</span><span class="op" id="3989219">(</span><span class="ident" id="3989220">rand</span><span class="op" id="3989224">,</span>&nbsp;<span class="ident" id="3989226">priv</span><span class="op" id="3989230">,</span>&nbsp;<span class="ident" id="3989232">digest</span><span class="op" id="3989238">)</span><span class="op" id="3989239">;</span>&nbsp;<span class="ident" id="3989241">err</span>&nbsp;<span class="op" id="3989245">==</span>&nbsp;<span class="builtintype" id="3989248">nil</span>&nbsp;<span class="op" id="3989252">{</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3989257">signature</span><span class="op" id="3989266">,</span>&nbsp;<span class="ident" id="3989268">err</span>&nbsp;<span class="op" id="3989272">=</span>&nbsp;<span class="ident" id="3989274">asn1</span><span class="op" id="3989278">.</span><span class="ident" id="3989279">Marshal</span><span class="op" id="3989286">(</span><span class="ident" id="3989287">ecdsaSignature</span><span class="op" id="3989301">{</span><span class="ident" id="3989302">r</span><span class="op" id="3989303">,</span>&nbsp;<span class="ident" id="3989305">s</span><span class="op" id="3989306">}</span><span class="op" id="3989307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3989311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989314">default</span><span class="op" id="3989321">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3989325">panic</span><span class="op" id="3989330">(</span><span class="string" id="3989331">&#34;internal&nbsp;error&#34;</span><span class="op" id="3989347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3989350">}</span><br>
<span class="lineno">1820</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989354">if</span>&nbsp;<span class="ident" id="3989357">err</span>&nbsp;<span class="op" id="3989361">!=</span>&nbsp;<span class="builtintype" id="3989364">nil</span>&nbsp;<span class="op" id="3989368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989372">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3989380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989384">return</span>&nbsp;<span class="ident" id="3989391">asn1</span><span class="op" id="3989395">.</span><span class="ident" id="3989396">Marshal</span><span class="op" id="3989403">(</span><span class="ident" id="3989404">certificateRequest</span><span class="op" id="3989422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3989426">TBSCSR</span><span class="op" id="3989432">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3989446">tbsCSR</span><span class="op" id="3989452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3989456">SignatureAlgorithm</span><span class="op" id="3989474">:</span>&nbsp;<span class="ident" id="3989476">sigAlgo</span><span class="op" id="3989483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3989487">SignatureValue</span><span class="op" id="3989501">:</span>&nbsp;<span class="ident" id="3989503">asn1</span><span class="op" id="3989507">.</span><span class="ident" id="3989508">BitString</span><span class="op" id="3989517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3989522">Bytes</span><span class="op" id="3989527">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3989533">signature</span><span class="op" id="3989542">,</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3989547">BitLength</span><span class="op" id="3989556">:</span>&nbsp;<span class="builtinfunc" id="3989558">len</span><span class="op" id="3989561">(</span><span class="ident" id="3989562">signature</span><span class="op" id="3989571">)</span>&nbsp;<span class="op" id="3989573">*</span>&nbsp;<span class="num" id="3989575">8</span><span class="op" id="3989576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3989580">}</span><span class="op" id="3989581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3989584">}</span><span class="op" id="3989585">)</span><br>
<span class="lineno"></span><span class="op" id="3989587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1835</span><span class="comment" id="3989590">//&nbsp;ParseCertificateRequest&nbsp;parses&nbsp;a&nbsp;single&nbsp;certificate&nbsp;request&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3989662">//&nbsp;given&nbsp;ASN.1&nbsp;DER&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3989687">func</span>&nbsp;<span class="ident" id="3989692">ParseCertificateRequest</span><span class="op" id="3989715">(</span><span class="ident" id="3989716">asn1Data</span>&nbsp;<span class="op" id="3989725">[</span><span class="op" id="3989726">]</span><span class="builtintype" id="3989727">byte</span><span class="op" id="3989731">)</span>&nbsp;<span class="op" id="3989733">(</span><span class="op" id="3989734">*</span><span class="ident" id="3989735">CertificateRequest</span><span class="op" id="3989753">,</span>&nbsp;<span class="builtintype" id="3989755">error</span><span class="op" id="3989760">)</span>&nbsp;<span class="op" id="3989762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989765">var</span>&nbsp;<span class="ident" id="3989769">csr</span>&nbsp;<span class="ident" id="3989773">certificateRequest</span><br>
<span class="lineno"></span><br>
<span class="lineno">1840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3989794">rest</span><span class="op" id="3989798">,</span>&nbsp;<span class="ident" id="3989800">err</span>&nbsp;<span class="op" id="3989804">:=</span>&nbsp;<span class="ident" id="3989807">asn1</span><span class="op" id="3989811">.</span><span class="ident" id="3989812">Unmarshal</span><span class="op" id="3989821">(</span><span class="ident" id="3989822">asn1Data</span><span class="op" id="3989830">,</span>&nbsp;<span class="op" id="3989832">&amp;</span><span class="ident" id="3989833">csr</span><span class="op" id="3989836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989839">if</span>&nbsp;<span class="ident" id="3989842">err</span>&nbsp;<span class="op" id="3989846">!=</span>&nbsp;<span class="builtintype" id="3989849">nil</span>&nbsp;<span class="op" id="3989853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989857">return</span>&nbsp;<span class="builtintype" id="3989864">nil</span><span class="op" id="3989867">,</span>&nbsp;<span class="ident" id="3989869">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3989874">}</span>&nbsp;<span class="keyword" id="3989876">else</span>&nbsp;<span class="keyword" id="3989881">if</span>&nbsp;<span class="builtinfunc" id="3989884">len</span><span class="op" id="3989887">(</span><span class="ident" id="3989888">rest</span><span class="op" id="3989892">)</span>&nbsp;<span class="op" id="3989894">!=</span>&nbsp;<span class="num" id="3989897">0</span>&nbsp;<span class="op" id="3989899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989903">return</span>&nbsp;<span class="builtintype" id="3989910">nil</span><span class="op" id="3989913">,</span>&nbsp;<span class="ident" id="3989915">asn1</span><span class="op" id="3989919">.</span><span class="ident" id="3989920">SyntaxError</span><span class="op" id="3989931">{</span><span class="ident" id="3989932">Msg</span><span class="op" id="3989935">:</span>&nbsp;<span class="string" id="3989937">&#34;trailing&nbsp;data&#34;</span><span class="op" id="3989952">}</span><br>
<span class="lineno">1845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3989955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3989959">return</span>&nbsp;<span class="ident" id="3989966">parseCertificateRequest</span><span class="op" id="3989989">(</span><span class="op" id="3989990">&amp;</span><span class="ident" id="3989991">csr</span><span class="op" id="3989994">)</span><br>
<span class="lineno"></span><span class="op" id="3989996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="3989999">func</span>&nbsp;<span class="ident" id="3990004">parseCertificateRequest</span><span class="op" id="3990027">(</span><span class="ident" id="3990028">in</span>&nbsp;<span class="op" id="3990031">*</span><span class="ident" id="3990032">certificateRequest</span><span class="op" id="3990050">)</span>&nbsp;<span class="op" id="3990052">(</span><span class="op" id="3990053">*</span><span class="ident" id="3990054">CertificateRequest</span><span class="op" id="3990072">,</span>&nbsp;<span class="builtintype" id="3990074">error</span><span class="op" id="3990079">)</span>&nbsp;<span class="op" id="3990081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990084">out</span>&nbsp;<span class="op" id="3990088">:=</span>&nbsp;<span class="op" id="3990091">&amp;</span><span class="ident" id="3990092">CertificateRequest</span><span class="op" id="3990110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990114">Raw</span><span class="op" id="3990117">:</span>&nbsp;<span class="ident" id="3990119">in</span><span class="op" id="3990121">.</span><span class="ident" id="3990122">Raw</span><span class="op" id="3990125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990129">RawTBSCertificateRequest</span><span class="op" id="3990153">:</span>&nbsp;<span class="ident" id="3990155">in</span><span class="op" id="3990157">.</span><span class="ident" id="3990158">TBSCSR</span><span class="op" id="3990164">.</span><span class="ident" id="3990165">Raw</span><span class="op" id="3990168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990172">RawSubjectPublicKeyInfo</span><span class="op" id="3990195">:</span>&nbsp;&nbsp;<span class="ident" id="3990198">in</span><span class="op" id="3990200">.</span><span class="ident" id="3990201">TBSCSR</span><span class="op" id="3990207">.</span><span class="ident" id="3990208">PublicKey</span><span class="op" id="3990217">.</span><span class="ident" id="3990218">Raw</span><span class="op" id="3990221">,</span><br>
<span class="lineno">1855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990225">RawSubject</span><span class="op" id="3990235">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990251">in</span><span class="op" id="3990253">.</span><span class="ident" id="3990254">TBSCSR</span><span class="op" id="3990260">.</span><span class="ident" id="3990261">Subject</span><span class="op" id="3990268">.</span><span class="ident" id="3990269">FullBytes</span><span class="op" id="3990278">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990283">Signature</span><span class="op" id="3990292">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990303">in</span><span class="op" id="3990305">.</span><span class="ident" id="3990306">SignatureValue</span><span class="op" id="3990320">.</span><span class="ident" id="3990321">RightAlign</span><span class="op" id="3990331">(</span><span class="op" id="3990332">)</span><span class="op" id="3990333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990337">SignatureAlgorithm</span><span class="op" id="3990355">:</span>&nbsp;<span class="ident" id="3990357">getSignatureAlgorithmFromOID</span><span class="op" id="3990385">(</span><span class="ident" id="3990386">in</span><span class="op" id="3990388">.</span><span class="ident" id="3990389">SignatureAlgorithm</span><span class="op" id="3990407">.</span><span class="ident" id="3990408">Algorithm</span><span class="op" id="3990417">)</span><span class="op" id="3990418">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">1860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990423">PublicKeyAlgorithm</span><span class="op" id="3990441">:</span>&nbsp;<span class="ident" id="3990443">getPublicKeyAlgorithmFromOID</span><span class="op" id="3990471">(</span><span class="ident" id="3990472">in</span><span class="op" id="3990474">.</span><span class="ident" id="3990475">TBSCSR</span><span class="op" id="3990481">.</span><span class="ident" id="3990482">PublicKey</span><span class="op" id="3990491">.</span><span class="ident" id="3990492">Algorithm</span><span class="op" id="3990501">.</span><span class="ident" id="3990502">Algorithm</span><span class="op" id="3990511">)</span><span class="op" id="3990512">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990517">Version</span><span class="op" id="3990524">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990529">in</span><span class="op" id="3990531">.</span><span class="ident" id="3990532">TBSCSR</span><span class="op" id="3990538">.</span><span class="ident" id="3990539">Version</span><span class="op" id="3990546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990550">Attributes</span><span class="op" id="3990560">:</span>&nbsp;<span class="ident" id="3990562">in</span><span class="op" id="3990564">.</span><span class="ident" id="3990565">TBSCSR</span><span class="op" id="3990571">.</span><span class="ident" id="3990572">Attributes</span><span class="op" id="3990582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3990585">}</span><br>
<span class="lineno">1865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3990589">var</span>&nbsp;<span class="ident" id="3990593">err</span>&nbsp;<span class="builtintype" id="3990597">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990604">out</span><span class="op" id="3990607">.</span><span class="ident" id="3990608">PublicKey</span><span class="op" id="3990617">,</span>&nbsp;<span class="ident" id="3990619">err</span>&nbsp;<span class="op" id="3990623">=</span>&nbsp;<span class="ident" id="3990625">parsePublicKey</span><span class="op" id="3990639">(</span><span class="ident" id="3990640">out</span><span class="op" id="3990643">.</span><span class="ident" id="3990644">PublicKeyAlgorithm</span><span class="op" id="3990662">,</span>&nbsp;<span class="op" id="3990664">&amp;</span><span class="ident" id="3990665">in</span><span class="op" id="3990667">.</span><span class="ident" id="3990668">TBSCSR</span><span class="op" id="3990674">.</span><span class="ident" id="3990675">PublicKey</span><span class="op" id="3990684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3990687">if</span>&nbsp;<span class="ident" id="3990690">err</span>&nbsp;<span class="op" id="3990694">!=</span>&nbsp;<span class="builtintype" id="3990697">nil</span>&nbsp;<span class="op" id="3990701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3990705">return</span>&nbsp;<span class="builtintype" id="3990712">nil</span><span class="op" id="3990715">,</span>&nbsp;<span class="ident" id="3990717">err</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3990722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3990726">var</span>&nbsp;<span class="ident" id="3990730">subject</span>&nbsp;<span class="ident" id="3990738">pkix</span><span class="op" id="3990742">.</span><span class="ident" id="3990743">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3990756">if</span>&nbsp;<span class="ident" id="3990759">_</span><span class="op" id="3990760">,</span>&nbsp;<span class="ident" id="3990762">err</span>&nbsp;<span class="op" id="3990766">:=</span>&nbsp;<span class="ident" id="3990769">asn1</span><span class="op" id="3990773">.</span><span class="ident" id="3990774">Unmarshal</span><span class="op" id="3990783">(</span><span class="ident" id="3990784">in</span><span class="op" id="3990786">.</span><span class="ident" id="3990787">TBSCSR</span><span class="op" id="3990793">.</span><span class="ident" id="3990794">Subject</span><span class="op" id="3990801">.</span><span class="ident" id="3990802">FullBytes</span><span class="op" id="3990811">,</span>&nbsp;<span class="op" id="3990813">&amp;</span><span class="ident" id="3990814">subject</span><span class="op" id="3990821">)</span><span class="op" id="3990822">;</span>&nbsp;<span class="ident" id="3990824">err</span>&nbsp;<span class="op" id="3990828">!=</span>&nbsp;<span class="builtintype" id="3990831">nil</span>&nbsp;<span class="op" id="3990835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3990839">return</span>&nbsp;<span class="builtintype" id="3990846">nil</span><span class="op" id="3990849">,</span>&nbsp;<span class="ident" id="3990851">err</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3990856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3990860">out</span><span class="op" id="3990863">.</span><span class="ident" id="3990864">Subject</span><span class="op" id="3990871">.</span><span class="ident" id="3990872">FillFromRDNSequence</span><span class="op" id="3990891">(</span><span class="op" id="3990892">&amp;</span><span class="ident" id="3990893">subject</span><span class="op" id="3990900">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3990904">var</span>&nbsp;<span class="ident" id="3990908">extensions</span>&nbsp;<span class="op" id="3990919">[</span><span class="op" id="3990920">]</span><span class="ident" id="3990921">pkix</span><span class="op" id="3990925">.</span><span class="ident" id="3990926">AttributeTypeAndValue</span><br>
<span class="lineno">1880</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3990950">for</span>&nbsp;<span class="ident" id="3990954">_</span><span class="op" id="3990955">,</span>&nbsp;<span class="ident" id="3990957">atvSet</span>&nbsp;<span class="op" id="3990964">:=</span>&nbsp;<span class="keyword" id="3990967">range</span>&nbsp;<span class="ident" id="3990973">in</span><span class="op" id="3990975">.</span><span class="ident" id="3990976">TBSCSR</span><span class="op" id="3990982">.</span><span class="ident" id="3990983">Attributes</span>&nbsp;<span class="op" id="3990994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3990998">if</span>&nbsp;<span class="op" id="3991001">!</span><span class="ident" id="3991002">atvSet</span><span class="op" id="3991008">.</span><span class="ident" id="3991009">Type</span><span class="op" id="3991013">.</span><span class="ident" id="3991014">Equal</span><span class="op" id="3991019">(</span><span class="ident" id="3991020">oidExtensionRequest</span><span class="op" id="3991039">)</span>&nbsp;<span class="op" id="3991041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991046">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991057">}</span><br>
<span class="lineno">1885</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991062">for</span>&nbsp;<span class="ident" id="3991066">_</span><span class="op" id="3991067">,</span>&nbsp;<span class="ident" id="3991069">atvs</span>&nbsp;<span class="op" id="3991074">:=</span>&nbsp;<span class="keyword" id="3991077">range</span>&nbsp;<span class="ident" id="3991083">atvSet</span><span class="op" id="3991089">.</span><span class="ident" id="3991090">Value</span>&nbsp;<span class="op" id="3991096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991101">extensions</span>&nbsp;<span class="op" id="3991112">=</span>&nbsp;<span class="builtinfunc" id="3991114">append</span><span class="op" id="3991120">(</span><span class="ident" id="3991121">extensions</span><span class="op" id="3991131">,</span>&nbsp;<span class="ident" id="3991133">atvs</span><span class="op" id="3991137">...</span><span class="op" id="3991140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991147">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991151">out</span><span class="op" id="3991154">.</span><span class="ident" id="3991155">Extensions</span>&nbsp;<span class="op" id="3991166">=</span>&nbsp;<span class="builtinfunc" id="3991168">make</span><span class="op" id="3991172">(</span><span class="op" id="3991173">[</span><span class="op" id="3991174">]</span><span class="ident" id="3991175">pkix</span><span class="op" id="3991179">.</span><span class="ident" id="3991180">Extension</span><span class="op" id="3991189">,</span>&nbsp;<span class="num" id="3991191">0</span><span class="op" id="3991192">,</span>&nbsp;<span class="builtinfunc" id="3991194">len</span><span class="op" id="3991197">(</span><span class="ident" id="3991198">extensions</span><span class="op" id="3991208">)</span><span class="op" id="3991209">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991213">for</span>&nbsp;<span class="ident" id="3991217">_</span><span class="op" id="3991218">,</span>&nbsp;<span class="ident" id="3991220">e</span>&nbsp;<span class="op" id="3991222">:=</span>&nbsp;<span class="keyword" id="3991225">range</span>&nbsp;<span class="ident" id="3991231">extensions</span>&nbsp;<span class="op" id="3991242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991246">value</span><span class="op" id="3991251">,</span>&nbsp;<span class="ident" id="3991253">ok</span>&nbsp;<span class="op" id="3991256">:=</span>&nbsp;<span class="ident" id="3991259">e</span><span class="op" id="3991260">.</span><span class="ident" id="3991261">Value</span><span class="op" id="3991266">.</span><span class="op" id="3991267">(</span><span class="op" id="3991268">[</span><span class="op" id="3991269">]</span><span class="builtintype" id="3991270">byte</span><span class="op" id="3991274">)</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991278">if</span>&nbsp;<span class="op" id="3991281">!</span><span class="ident" id="3991282">ok</span>&nbsp;<span class="op" id="3991285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991290">return</span>&nbsp;<span class="builtintype" id="3991297">nil</span><span class="op" id="3991300">,</span>&nbsp;<span class="ident" id="3991302">errors</span><span class="op" id="3991308">.</span><span class="ident" id="3991309">New</span><span class="op" id="3991312">(</span><span class="string" id="3991313">&#34;x509:&nbsp;extension&nbsp;attribute&nbsp;contained&nbsp;non-OCTET&nbsp;STRING&nbsp;data&#34;</span><span class="op" id="3991372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991381">out</span><span class="op" id="3991384">.</span><span class="ident" id="3991385">Extensions</span>&nbsp;<span class="op" id="3991396">=</span>&nbsp;<span class="builtinfunc" id="3991398">append</span><span class="op" id="3991404">(</span><span class="ident" id="3991405">out</span><span class="op" id="3991408">.</span><span class="ident" id="3991409">Extensions</span><span class="op" id="3991419">,</span>&nbsp;<span class="ident" id="3991421">pkix</span><span class="op" id="3991425">.</span><span class="ident" id="3991426">Extension</span><span class="op" id="3991435">{</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991440">Id</span><span class="op" id="3991442">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991447">e</span><span class="op" id="3991448">.</span><span class="ident" id="3991449">Type</span><span class="op" id="3991453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991458">Value</span><span class="op" id="3991463">:</span>&nbsp;<span class="ident" id="3991465">value</span><span class="op" id="3991470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991474">}</span><span class="op" id="3991475">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991480">if</span>&nbsp;<span class="builtinfunc" id="3991483">len</span><span class="op" id="3991486">(</span><span class="ident" id="3991487">e</span><span class="op" id="3991488">.</span><span class="ident" id="3991489">Type</span><span class="op" id="3991493">)</span>&nbsp;<span class="op" id="3991495">==</span>&nbsp;<span class="num" id="3991498">4</span>&nbsp;<span class="op" id="3991500">&amp;&amp;</span>&nbsp;<span class="ident" id="3991503">e</span><span class="op" id="3991504">.</span><span class="ident" id="3991505">Type</span><span class="op" id="3991509">[</span><span class="num" id="3991510">0</span><span class="op" id="3991511">]</span>&nbsp;<span class="op" id="3991513">==</span>&nbsp;<span class="num" id="3991516">2</span>&nbsp;<span class="op" id="3991518">&amp;&amp;</span>&nbsp;<span class="ident" id="3991521">e</span><span class="op" id="3991522">.</span><span class="ident" id="3991523">Type</span><span class="op" id="3991527">[</span><span class="num" id="3991528">1</span><span class="op" id="3991529">]</span>&nbsp;<span class="op" id="3991531">==</span>&nbsp;<span class="num" id="3991534">5</span>&nbsp;<span class="op" id="3991536">&amp;&amp;</span>&nbsp;<span class="ident" id="3991539">e</span><span class="op" id="3991540">.</span><span class="ident" id="3991541">Type</span><span class="op" id="3991545">[</span><span class="num" id="3991546">2</span><span class="op" id="3991547">]</span>&nbsp;<span class="op" id="3991549">==</span>&nbsp;<span class="num" id="3991552">29</span>&nbsp;<span class="op" id="3991555">{</span><br>
<span class="lineno">1905</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991560">switch</span>&nbsp;<span class="ident" id="3991567">e</span><span class="op" id="3991568">.</span><span class="ident" id="3991569">Type</span><span class="op" id="3991573">[</span><span class="num" id="3991574">3</span><span class="op" id="3991575">]</span>&nbsp;<span class="op" id="3991577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991582">case</span>&nbsp;<span class="num" id="3991587">17</span><span class="op" id="3991589">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3991595">out</span><span class="op" id="3991598">.</span><span class="ident" id="3991599">DNSNames</span><span class="op" id="3991607">,</span>&nbsp;<span class="ident" id="3991609">out</span><span class="op" id="3991612">.</span><span class="ident" id="3991613">EmailAddresses</span><span class="op" id="3991627">,</span>&nbsp;<span class="ident" id="3991629">out</span><span class="op" id="3991632">.</span><span class="ident" id="3991633">IPAddresses</span><span class="op" id="3991644">,</span>&nbsp;<span class="ident" id="3991646">err</span>&nbsp;<span class="op" id="3991650">=</span>&nbsp;<span class="ident" id="3991652">parseSANExtension</span><span class="op" id="3991669">(</span><span class="ident" id="3991670">value</span><span class="op" id="3991675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991681">if</span>&nbsp;<span class="ident" id="3991684">err</span>&nbsp;<span class="op" id="3991688">!=</span>&nbsp;<span class="builtintype" id="3991691">nil</span>&nbsp;<span class="op" id="3991695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991702">return</span>&nbsp;<span class="builtintype" id="3991709">nil</span><span class="op" id="3991712">,</span>&nbsp;<span class="ident" id="3991714">err</span><br>
<span class="lineno">1910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3991734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1915</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3991738">return</span>&nbsp;<span class="ident" id="3991745">out</span><span class="op" id="3991748">,</span>&nbsp;<span class="builtintype" id="3991750">nil</span><br>
<span class="lineno"></span><span class="op" id="3991754">}</span>
</div>
</body>
</html>
