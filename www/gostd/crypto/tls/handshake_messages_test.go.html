<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7252911">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7252966">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7253020">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7253071">package</span>&nbsp;<span class="ident" id="7253079">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7253084">import</span>&nbsp;<span class="op" id="7253091">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7253094">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7253107">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7253118">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7253129">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="7253145">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7253148">var</span>&nbsp;<span class="ident" id="7253152">tests</span>&nbsp;<span class="op" id="7253158">=</span>&nbsp;<span class="op" id="7253160">[</span><span class="op" id="7253161">]</span><span class="keyword" id="7253162">interface</span><span class="op" id="7253171">{</span><span class="op" id="7253172">}</span><span class="op" id="7253173">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253176">&amp;</span><span class="ident" id="7253177">clientHelloMsg</span><span class="op" id="7253191">{</span><span class="op" id="7253192">}</span><span class="op" id="7253193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253196">&amp;</span><span class="ident" id="7253197">serverHelloMsg</span><span class="op" id="7253211">{</span><span class="op" id="7253212">}</span><span class="op" id="7253213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253216">&amp;</span><span class="ident" id="7253217">finishedMsg</span><span class="op" id="7253228">{</span><span class="op" id="7253229">}</span><span class="op" id="7253230">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253234">&amp;</span><span class="ident" id="7253235">certificateMsg</span><span class="op" id="7253249">{</span><span class="op" id="7253250">}</span><span class="op" id="7253251">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253254">&amp;</span><span class="ident" id="7253255">certificateRequestMsg</span><span class="op" id="7253276">{</span><span class="op" id="7253277">}</span><span class="op" id="7253278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253281">&amp;</span><span class="ident" id="7253282">certificateVerifyMsg</span><span class="op" id="7253302">{</span><span class="op" id="7253303">}</span><span class="op" id="7253304">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253307">&amp;</span><span class="ident" id="7253308">certificateStatusMsg</span><span class="op" id="7253328">{</span><span class="op" id="7253329">}</span><span class="op" id="7253330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253333">&amp;</span><span class="ident" id="7253334">clientKeyExchangeMsg</span><span class="op" id="7253354">{</span><span class="op" id="7253355">}</span><span class="op" id="7253356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253359">&amp;</span><span class="ident" id="7253360">nextProtoMsg</span><span class="op" id="7253372">{</span><span class="op" id="7253373">}</span><span class="op" id="7253374">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253377">&amp;</span><span class="ident" id="7253378">newSessionTicketMsg</span><span class="op" id="7253397">{</span><span class="op" id="7253398">}</span><span class="op" id="7253399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253402">&amp;</span><span class="ident" id="7253403">sessionState</span><span class="op" id="7253415">{</span><span class="op" id="7253416">}</span><span class="op" id="7253417">,</span><br>
<span class="lineno"></span><span class="op" id="7253419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7253422">type</span>&nbsp;<span class="ident" id="7253427">testMessage</span>&nbsp;<span class="keyword" id="7253439">interface</span>&nbsp;<span class="op" id="7253449">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253452">marshal</span><span class="op" id="7253459">(</span><span class="op" id="7253460">)</span>&nbsp;<span class="op" id="7253462">[</span><span class="op" id="7253463">]</span><span class="builtintype" id="7253464">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253470">unmarshal</span><span class="op" id="7253479">(</span><span class="op" id="7253480">[</span><span class="op" id="7253481">]</span><span class="builtintype" id="7253482">byte</span><span class="op" id="7253486">)</span>&nbsp;<span class="builtintype" id="7253488">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253494">equal</span><span class="op" id="7253499">(</span><span class="keyword" id="7253500">interface</span><span class="op" id="7253509">{</span><span class="op" id="7253510">}</span><span class="op" id="7253511">)</span>&nbsp;<span class="builtintype" id="7253513">bool</span><br>
<span class="lineno"></span><span class="op" id="7253518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7253521">func</span>&nbsp;<span class="ident" id="7253526">TestMarshalUnmarshal</span><span class="op" id="7253546">(</span><span class="ident" id="7253547">t</span>&nbsp;<span class="op" id="7253549">*</span><span class="ident" id="7253550">testing</span><span class="op" id="7253557">.</span><span class="ident" id="7253558">T</span><span class="op" id="7253559">)</span>&nbsp;<span class="op" id="7253561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253564">rand</span>&nbsp;<span class="op" id="7253569">:=</span>&nbsp;<span class="ident" id="7253572">rand</span><span class="op" id="7253576">.</span><span class="ident" id="7253577">New</span><span class="op" id="7253580">(</span><span class="ident" id="7253581">rand</span><span class="op" id="7253585">.</span><span class="ident" id="7253586">NewSource</span><span class="op" id="7253595">(</span><span class="num" id="7253596">0</span><span class="op" id="7253597">)</span><span class="op" id="7253598">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253602">for</span>&nbsp;<span class="ident" id="7253606">i</span><span class="op" id="7253607">,</span>&nbsp;<span class="ident" id="7253609">iface</span>&nbsp;<span class="op" id="7253615">:=</span>&nbsp;<span class="keyword" id="7253618">range</span>&nbsp;<span class="ident" id="7253624">tests</span>&nbsp;<span class="op" id="7253630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253634">ty</span>&nbsp;<span class="op" id="7253637">:=</span>&nbsp;<span class="ident" id="7253640">reflect</span><span class="op" id="7253647">.</span><span class="ident" id="7253648">ValueOf</span><span class="op" id="7253655">(</span><span class="ident" id="7253656">iface</span><span class="op" id="7253661">)</span><span class="op" id="7253662">.</span><span class="ident" id="7253663">Type</span><span class="op" id="7253667">(</span><span class="op" id="7253668">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253673">n</span>&nbsp;<span class="op" id="7253675">:=</span>&nbsp;<span class="num" id="7253678">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253684">if</span>&nbsp;<span class="ident" id="7253687">testing</span><span class="op" id="7253694">.</span><span class="ident" id="7253695">Short</span><span class="op" id="7253700">(</span><span class="op" id="7253701">)</span>&nbsp;<span class="op" id="7253703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253708">n</span>&nbsp;<span class="op" id="7253710">=</span>&nbsp;<span class="num" id="7253712">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253716">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253720">for</span>&nbsp;<span class="ident" id="7253724">j</span>&nbsp;<span class="op" id="7253726">:=</span>&nbsp;<span class="num" id="7253729">0</span><span class="op" id="7253730">;</span>&nbsp;<span class="ident" id="7253732">j</span>&nbsp;<span class="op" id="7253734">&lt;</span>&nbsp;<span class="ident" id="7253736">n</span><span class="op" id="7253737">;</span>&nbsp;<span class="ident" id="7253739">j</span><span class="op" id="7253740">++</span>&nbsp;<span class="op" id="7253743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253748">v</span><span class="op" id="7253749">,</span>&nbsp;<span class="ident" id="7253751">ok</span>&nbsp;<span class="op" id="7253754">:=</span>&nbsp;<span class="ident" id="7253757">quick</span><span class="op" id="7253762">.</span><span class="ident" id="7253763">Value</span><span class="op" id="7253768">(</span><span class="ident" id="7253769">ty</span><span class="op" id="7253771">,</span>&nbsp;<span class="ident" id="7253773">rand</span><span class="op" id="7253777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253782">if</span>&nbsp;<span class="op" id="7253785">!</span><span class="ident" id="7253786">ok</span>&nbsp;<span class="op" id="7253789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253795">t</span><span class="op" id="7253796">.</span><span class="ident" id="7253797">Errorf</span><span class="op" id="7253803">(</span><span class="string" id="7253804">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="7253833">,</span>&nbsp;<span class="ident" id="7253835">i</span><span class="op" id="7253836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253842">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7253851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253857">m1</span>&nbsp;<span class="op" id="7253860">:=</span>&nbsp;<span class="ident" id="7253863">v</span><span class="op" id="7253864">.</span><span class="ident" id="7253865">Interface</span><span class="op" id="7253874">(</span><span class="op" id="7253875">)</span><span class="op" id="7253876">.</span><span class="op" id="7253877">(</span><span class="ident" id="7253878">testMessage</span><span class="op" id="7253889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253894">marshaled</span>&nbsp;<span class="op" id="7253904">:=</span>&nbsp;<span class="ident" id="7253907">m1</span><span class="op" id="7253909">.</span><span class="ident" id="7253910">marshal</span><span class="op" id="7253917">(</span><span class="op" id="7253918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253923">m2</span>&nbsp;<span class="op" id="7253926">:=</span>&nbsp;<span class="ident" id="7253929">iface</span><span class="op" id="7253934">.</span><span class="op" id="7253935">(</span><span class="ident" id="7253936">testMessage</span><span class="op" id="7253947">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7253952">if</span>&nbsp;<span class="op" id="7253955">!</span><span class="ident" id="7253956">m2</span><span class="op" id="7253958">.</span><span class="ident" id="7253959">unmarshal</span><span class="op" id="7253968">(</span><span class="ident" id="7253969">marshaled</span><span class="op" id="7253978">)</span>&nbsp;<span class="op" id="7253980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7253986">t</span><span class="op" id="7253987">.</span><span class="ident" id="7253988">Errorf</span><span class="op" id="7253994">(</span><span class="string" id="7253995">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="7254027">,</span>&nbsp;<span class="ident" id="7254029">i</span><span class="op" id="7254030">,</span>&nbsp;<span class="ident" id="7254032">m1</span><span class="op" id="7254034">,</span>&nbsp;<span class="ident" id="7254036">marshaled</span><span class="op" id="7254045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254051">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254065">m2</span><span class="op" id="7254067">.</span><span class="ident" id="7254068">marshal</span><span class="op" id="7254075">(</span><span class="op" id="7254076">)</span>&nbsp;<span class="comment" id="7254078">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254126">if</span>&nbsp;<span class="op" id="7254129">!</span><span class="ident" id="7254130">m1</span><span class="op" id="7254132">.</span><span class="ident" id="7254133">equal</span><span class="op" id="7254138">(</span><span class="ident" id="7254139">m2</span><span class="op" id="7254141">)</span>&nbsp;<span class="op" id="7254143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254149">t</span><span class="op" id="7254150">.</span><span class="ident" id="7254151">Errorf</span><span class="op" id="7254157">(</span><span class="string" id="7254158">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="7254183">,</span>&nbsp;<span class="ident" id="7254185">i</span><span class="op" id="7254186">,</span>&nbsp;<span class="ident" id="7254188">m2</span><span class="op" id="7254190">,</span>&nbsp;<span class="ident" id="7254192">m1</span><span class="op" id="7254194">,</span>&nbsp;<span class="ident" id="7254196">marshaled</span><span class="op" id="7254205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254211">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254220">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254226">if</span>&nbsp;<span class="ident" id="7254229">i</span>&nbsp;<span class="op" id="7254231">&gt;=</span>&nbsp;<span class="num" id="7254234">3</span>&nbsp;<span class="op" id="7254236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7254242">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7254293">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7254341">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7254393">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7254439">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254479">for</span>&nbsp;<span class="ident" id="7254483">j</span>&nbsp;<span class="op" id="7254485">:=</span>&nbsp;<span class="num" id="7254488">0</span><span class="op" id="7254489">;</span>&nbsp;<span class="ident" id="7254491">j</span>&nbsp;<span class="op" id="7254493">&lt;</span>&nbsp;<span class="builtinfunc" id="7254495">len</span><span class="op" id="7254498">(</span><span class="ident" id="7254499">marshaled</span><span class="op" id="7254508">)</span><span class="op" id="7254509">;</span>&nbsp;<span class="ident" id="7254511">j</span><span class="op" id="7254512">++</span>&nbsp;<span class="op" id="7254515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254522">if</span>&nbsp;<span class="ident" id="7254525">m2</span><span class="op" id="7254527">.</span><span class="ident" id="7254528">unmarshal</span><span class="op" id="7254537">(</span><span class="ident" id="7254538">marshaled</span><span class="op" id="7254547">[</span><span class="num" id="7254548">0</span><span class="op" id="7254549">:</span><span class="ident" id="7254550">j</span><span class="op" id="7254551">]</span><span class="op" id="7254552">)</span>&nbsp;<span class="op" id="7254554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254562">t</span><span class="op" id="7254563">.</span><span class="ident" id="7254564">Errorf</span><span class="op" id="7254570">(</span><span class="string" id="7254571">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="7254617">,</span>&nbsp;<span class="ident" id="7254619">i</span><span class="op" id="7254620">,</span>&nbsp;<span class="ident" id="7254622">j</span><span class="op" id="7254623">,</span>&nbsp;<span class="ident" id="7254625">m1</span><span class="op" id="7254627">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254635">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254661">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254664">}</span><br>
<span class="lineno"></span><span class="op" id="7254666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7254669">func</span>&nbsp;<span class="ident" id="7254674">TestFuzz</span><span class="op" id="7254682">(</span><span class="ident" id="7254683">t</span>&nbsp;<span class="op" id="7254685">*</span><span class="ident" id="7254686">testing</span><span class="op" id="7254693">.</span><span class="ident" id="7254694">T</span><span class="op" id="7254695">)</span>&nbsp;<span class="op" id="7254697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254700">rand</span>&nbsp;<span class="op" id="7254705">:=</span>&nbsp;<span class="ident" id="7254708">rand</span><span class="op" id="7254712">.</span><span class="ident" id="7254713">New</span><span class="op" id="7254716">(</span><span class="ident" id="7254717">rand</span><span class="op" id="7254721">.</span><span class="ident" id="7254722">NewSource</span><span class="op" id="7254731">(</span><span class="num" id="7254732">0</span><span class="op" id="7254733">)</span><span class="op" id="7254734">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254737">for</span>&nbsp;<span class="ident" id="7254741">_</span><span class="op" id="7254742">,</span>&nbsp;<span class="ident" id="7254744">iface</span>&nbsp;<span class="op" id="7254750">:=</span>&nbsp;<span class="keyword" id="7254753">range</span>&nbsp;<span class="ident" id="7254759">tests</span>&nbsp;<span class="op" id="7254765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254769">m</span>&nbsp;<span class="op" id="7254771">:=</span>&nbsp;<span class="ident" id="7254774">iface</span><span class="op" id="7254779">.</span><span class="op" id="7254780">(</span><span class="ident" id="7254781">testMessage</span><span class="op" id="7254792">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7254797">for</span>&nbsp;<span class="ident" id="7254801">j</span>&nbsp;<span class="op" id="7254803">:=</span>&nbsp;<span class="num" id="7254806">0</span><span class="op" id="7254807">;</span>&nbsp;<span class="ident" id="7254809">j</span>&nbsp;<span class="op" id="7254811">&lt;</span>&nbsp;<span class="num" id="7254813">1000</span><span class="op" id="7254817">;</span>&nbsp;<span class="ident" id="7254819">j</span><span class="op" id="7254820">++</span>&nbsp;<span class="op" id="7254823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7254828">len</span>&nbsp;<span class="op" id="7254832">:=</span>&nbsp;<span class="ident" id="7254835">rand</span><span class="op" id="7254839">.</span><span class="ident" id="7254840">Intn</span><span class="op" id="7254844">(</span><span class="num" id="7254845">100</span><span class="op" id="7254848">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254853">bytes</span>&nbsp;<span class="op" id="7254859">:=</span>&nbsp;<span class="ident" id="7254862">randomBytes</span><span class="op" id="7254873">(</span><span class="builtinfunc" id="7254874">len</span><span class="op" id="7254877">,</span>&nbsp;<span class="ident" id="7254879">rand</span><span class="op" id="7254883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7254888">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7254948">m</span><span class="op" id="7254949">.</span><span class="ident" id="7254950">unmarshal</span><span class="op" id="7254959">(</span><span class="ident" id="7254960">bytes</span><span class="op" id="7254965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7254972">}</span><br>
<span class="lineno">95</span><span class="op" id="7254974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7254977">func</span>&nbsp;<span class="ident" id="7254982">randomBytes</span><span class="op" id="7254993">(</span><span class="ident" id="7254994">n</span>&nbsp;<span class="builtintype" id="7254996">int</span><span class="op" id="7254999">,</span>&nbsp;<span class="ident" id="7255001">rand</span>&nbsp;<span class="op" id="7255006">*</span><span class="ident" id="7255007">rand</span><span class="op" id="7255011">.</span><span class="ident" id="7255012">Rand</span><span class="op" id="7255016">)</span>&nbsp;<span class="op" id="7255018">[</span><span class="op" id="7255019">]</span><span class="builtintype" id="7255020">byte</span>&nbsp;<span class="op" id="7255025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255028">r</span>&nbsp;<span class="op" id="7255030">:=</span>&nbsp;<span class="builtinfunc" id="7255033">make</span><span class="op" id="7255037">(</span><span class="op" id="7255038">[</span><span class="op" id="7255039">]</span><span class="builtintype" id="7255040">byte</span><span class="op" id="7255044">,</span>&nbsp;<span class="ident" id="7255046">n</span><span class="op" id="7255047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7255050">for</span>&nbsp;<span class="ident" id="7255054">i</span>&nbsp;<span class="op" id="7255056">:=</span>&nbsp;<span class="num" id="7255059">0</span><span class="op" id="7255060">;</span>&nbsp;<span class="ident" id="7255062">i</span>&nbsp;<span class="op" id="7255064">&lt;</span>&nbsp;<span class="ident" id="7255066">n</span><span class="op" id="7255067">;</span>&nbsp;<span class="ident" id="7255069">i</span><span class="op" id="7255070">++</span>&nbsp;<span class="op" id="7255073">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255077">r</span><span class="op" id="7255078">[</span><span class="ident" id="7255079">i</span><span class="op" id="7255080">]</span>&nbsp;<span class="op" id="7255082">=</span>&nbsp;<span class="builtintype" id="7255084">byte</span><span class="op" id="7255088">(</span><span class="ident" id="7255089">rand</span><span class="op" id="7255093">.</span><span class="ident" id="7255094">Int31</span><span class="op" id="7255099">(</span><span class="op" id="7255100">)</span><span class="op" id="7255101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7255104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7255107">return</span>&nbsp;<span class="ident" id="7255114">r</span><br>
<span class="lineno"></span><span class="op" id="7255116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="7255119">func</span>&nbsp;<span class="ident" id="7255124">randomString</span><span class="op" id="7255136">(</span><span class="ident" id="7255137">n</span>&nbsp;<span class="builtintype" id="7255139">int</span><span class="op" id="7255142">,</span>&nbsp;<span class="ident" id="7255144">rand</span>&nbsp;<span class="op" id="7255149">*</span><span class="ident" id="7255150">rand</span><span class="op" id="7255154">.</span><span class="ident" id="7255155">Rand</span><span class="op" id="7255159">)</span>&nbsp;<span class="builtintype" id="7255161">string</span>&nbsp;<span class="op" id="7255168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255171">b</span>&nbsp;<span class="op" id="7255173">:=</span>&nbsp;<span class="ident" id="7255176">randomBytes</span><span class="op" id="7255187">(</span><span class="ident" id="7255188">n</span><span class="op" id="7255189">,</span>&nbsp;<span class="ident" id="7255191">rand</span><span class="op" id="7255195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7255198">return</span>&nbsp;<span class="builtintype" id="7255205">string</span><span class="op" id="7255211">(</span><span class="ident" id="7255212">b</span><span class="op" id="7255213">)</span><br>
<span class="lineno"></span><span class="op" id="7255215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7255218">func</span>&nbsp;<span class="op" id="7255223">(</span><span class="op" id="7255224">*</span><span class="ident" id="7255225">clientHelloMsg</span><span class="op" id="7255239">)</span>&nbsp;<span class="ident" id="7255241">Generate</span><span class="op" id="7255249">(</span><span class="ident" id="7255250">rand</span>&nbsp;<span class="op" id="7255255">*</span><span class="ident" id="7255256">rand</span><span class="op" id="7255260">.</span><span class="ident" id="7255261">Rand</span><span class="op" id="7255265">,</span>&nbsp;<span class="ident" id="7255267">size</span>&nbsp;<span class="builtintype" id="7255272">int</span><span class="op" id="7255275">)</span>&nbsp;<span class="ident" id="7255277">reflect</span><span class="op" id="7255284">.</span><span class="ident" id="7255285">Value</span>&nbsp;<span class="op" id="7255291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255294">m</span>&nbsp;<span class="op" id="7255296">:=</span>&nbsp;<span class="op" id="7255299">&amp;</span><span class="ident" id="7255300">clientHelloMsg</span><span class="op" id="7255314">{</span><span class="op" id="7255315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255318">m</span><span class="op" id="7255319">.</span><span class="ident" id="7255320">vers</span>&nbsp;<span class="op" id="7255325">=</span>&nbsp;<span class="builtintype" id="7255327">uint16</span><span class="op" id="7255333">(</span><span class="ident" id="7255334">rand</span><span class="op" id="7255338">.</span><span class="ident" id="7255339">Intn</span><span class="op" id="7255343">(</span><span class="num" id="7255344">65536</span><span class="op" id="7255349">)</span><span class="op" id="7255350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255353">m</span><span class="op" id="7255354">.</span><span class="ident" id="7255355">random</span>&nbsp;<span class="op" id="7255362">=</span>&nbsp;<span class="ident" id="7255364">randomBytes</span><span class="op" id="7255375">(</span><span class="num" id="7255376">32</span><span class="op" id="7255378">,</span>&nbsp;<span class="ident" id="7255380">rand</span><span class="op" id="7255384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255387">m</span><span class="op" id="7255388">.</span><span class="ident" id="7255389">sessionId</span>&nbsp;<span class="op" id="7255399">=</span>&nbsp;<span class="ident" id="7255401">randomBytes</span><span class="op" id="7255412">(</span><span class="ident" id="7255413">rand</span><span class="op" id="7255417">.</span><span class="ident" id="7255418">Intn</span><span class="op" id="7255422">(</span><span class="num" id="7255423">32</span><span class="op" id="7255425">)</span><span class="op" id="7255426">,</span>&nbsp;<span class="ident" id="7255428">rand</span><span class="op" id="7255432">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255435">m</span><span class="op" id="7255436">.</span><span class="ident" id="7255437">cipherSuites</span>&nbsp;<span class="op" id="7255450">=</span>&nbsp;<span class="builtinfunc" id="7255452">make</span><span class="op" id="7255456">(</span><span class="op" id="7255457">[</span><span class="op" id="7255458">]</span><span class="builtintype" id="7255459">uint16</span><span class="op" id="7255465">,</span>&nbsp;<span class="ident" id="7255467">rand</span><span class="op" id="7255471">.</span><span class="ident" id="7255472">Intn</span><span class="op" id="7255476">(</span><span class="num" id="7255477">63</span><span class="op" id="7255479">)</span><span class="op" id="7255480">+</span><span class="num" id="7255481">1</span><span class="op" id="7255482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7255485">for</span>&nbsp;<span class="ident" id="7255489">i</span>&nbsp;<span class="op" id="7255491">:=</span>&nbsp;<span class="num" id="7255494">0</span><span class="op" id="7255495">;</span>&nbsp;<span class="ident" id="7255497">i</span>&nbsp;<span class="op" id="7255499">&lt;</span>&nbsp;<span class="builtinfunc" id="7255501">len</span><span class="op" id="7255504">(</span><span class="ident" id="7255505">m</span><span class="op" id="7255506">.</span><span class="ident" id="7255507">cipherSuites</span><span class="op" id="7255519">)</span><span class="op" id="7255520">;</span>&nbsp;<span class="ident" id="7255522">i</span><span class="op" id="7255523">++</span>&nbsp;<span class="op" id="7255526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255530">m</span><span class="op" id="7255531">.</span><span class="ident" id="7255532">cipherSuites</span><span class="op" id="7255544">[</span><span class="ident" id="7255545">i</span><span class="op" id="7255546">]</span>&nbsp;<span class="op" id="7255548">=</span>&nbsp;<span class="builtintype" id="7255550">uint16</span><span class="op" id="7255556">(</span><span class="ident" id="7255557">rand</span><span class="op" id="7255561">.</span><span class="ident" id="7255562">Int31</span><span class="op" id="7255567">(</span><span class="op" id="7255568">)</span><span class="op" id="7255569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7255572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255575">m</span><span class="op" id="7255576">.</span><span class="ident" id="7255577">compressionMethods</span>&nbsp;<span class="op" id="7255596">=</span>&nbsp;<span class="ident" id="7255598">randomBytes</span><span class="op" id="7255609">(</span><span class="ident" id="7255610">rand</span><span class="op" id="7255614">.</span><span class="ident" id="7255615">Intn</span><span class="op" id="7255619">(</span><span class="num" id="7255620">63</span><span class="op" id="7255622">)</span><span class="op" id="7255623">+</span><span class="num" id="7255624">1</span><span class="op" id="7255625">,</span>&nbsp;<span class="ident" id="7255627">rand</span><span class="op" id="7255631">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7255634">if</span>&nbsp;<span class="ident" id="7255637">rand</span><span class="op" id="7255641">.</span><span class="ident" id="7255642">Intn</span><span class="op" id="7255646">(</span><span class="num" id="7255647">10</span><span class="op" id="7255649">)</span>&nbsp;<span class="op" id="7255651">&gt;</span>&nbsp;<span class="num" id="7255653">5</span>&nbsp;<span class="op" id="7255655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255659">m</span><span class="op" id="7255660">.</span><span class="ident" id="7255661">nextProtoNeg</span>&nbsp;<span class="op" id="7255674">=</span>&nbsp;<span class="builtintype" id="7255676">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7255682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7255685">if</span>&nbsp;<span class="ident" id="7255688">rand</span><span class="op" id="7255692">.</span><span class="ident" id="7255693">Intn</span><span class="op" id="7255697">(</span><span class="num" id="7255698">10</span><span class="op" id="7255700">)</span>&nbsp;<span class="op" id="7255702">&gt;</span>&nbsp;<span class="num" id="7255704">5</span>&nbsp;<span class="op" id="7255706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255710">m</span><span class="op" id="7255711">.</span><span class="ident" id="7255712">serverName</span>&nbsp;<span class="op" id="7255723">=</span>&nbsp;<span class="ident" id="7255725">randomString</span><span class="op" id="7255737">(</span><span class="ident" id="7255738">rand</span><span class="op" id="7255742">.</span><span class="ident" id="7255743">Intn</span><span class="op" id="7255747">(</span><span class="num" id="7255748">255</span><span class="op" id="7255751">)</span><span class="op" id="7255752">,</span>&nbsp;<span class="ident" id="7255754">rand</span><span class="op" id="7255758">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7255761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255764">m</span><span class="op" id="7255765">.</span><span class="ident" id="7255766">ocspStapling</span>&nbsp;<span class="op" id="7255779">=</span>&nbsp;<span class="ident" id="7255781">rand</span><span class="op" id="7255785">.</span><span class="ident" id="7255786">Intn</span><span class="op" id="7255790">(</span><span class="num" id="7255791">10</span><span class="op" id="7255793">)</span>&nbsp;<span class="op" id="7255795">&gt;</span>&nbsp;<span class="num" id="7255797">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255800">m</span><span class="op" id="7255801">.</span><span class="ident" id="7255802">supportedPoints</span>&nbsp;<span class="op" id="7255818">=</span>&nbsp;<span class="ident" id="7255820">randomBytes</span><span class="op" id="7255831">(</span><span class="ident" id="7255832">rand</span><span class="op" id="7255836">.</span><span class="ident" id="7255837">Intn</span><span class="op" id="7255841">(</span><span class="num" id="7255842">5</span><span class="op" id="7255843">)</span><span class="op" id="7255844">+</span><span class="num" id="7255845">1</span><span class="op" id="7255846">,</span>&nbsp;<span class="ident" id="7255848">rand</span><span class="op" id="7255852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255855">m</span><span class="op" id="7255856">.</span><span class="ident" id="7255857">supportedCurves</span>&nbsp;<span class="op" id="7255873">=</span>&nbsp;<span class="builtinfunc" id="7255875">make</span><span class="op" id="7255879">(</span><span class="op" id="7255880">[</span><span class="op" id="7255881">]</span><span class="ident" id="7255882">CurveID</span><span class="op" id="7255889">,</span>&nbsp;<span class="ident" id="7255891">rand</span><span class="op" id="7255895">.</span><span class="ident" id="7255896">Intn</span><span class="op" id="7255900">(</span><span class="num" id="7255901">5</span><span class="op" id="7255902">)</span><span class="op" id="7255903">+</span><span class="num" id="7255904">1</span><span class="op" id="7255905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7255908">for</span>&nbsp;<span class="ident" id="7255912">i</span>&nbsp;<span class="op" id="7255914">:=</span>&nbsp;<span class="keyword" id="7255917">range</span>&nbsp;<span class="ident" id="7255923">m</span><span class="op" id="7255924">.</span><span class="ident" id="7255925">supportedCurves</span>&nbsp;<span class="op" id="7255941">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7255945">m</span><span class="op" id="7255946">.</span><span class="ident" id="7255947">supportedCurves</span><span class="op" id="7255962">[</span><span class="ident" id="7255963">i</span><span class="op" id="7255964">]</span>&nbsp;<span class="op" id="7255966">=</span>&nbsp;<span class="ident" id="7255968">CurveID</span><span class="op" id="7255975">(</span><span class="ident" id="7255976">rand</span><span class="op" id="7255980">.</span><span class="ident" id="7255981">Intn</span><span class="op" id="7255985">(</span><span class="num" id="7255986">30000</span><span class="op" id="7255991">)</span><span class="op" id="7255992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7255995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7255998">if</span>&nbsp;<span class="ident" id="7256001">rand</span><span class="op" id="7256005">.</span><span class="ident" id="7256006">Intn</span><span class="op" id="7256010">(</span><span class="num" id="7256011">10</span><span class="op" id="7256013">)</span>&nbsp;<span class="op" id="7256015">&gt;</span>&nbsp;<span class="num" id="7256017">5</span>&nbsp;<span class="op" id="7256019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256023">m</span><span class="op" id="7256024">.</span><span class="ident" id="7256025">ticketSupported</span>&nbsp;<span class="op" id="7256041">=</span>&nbsp;<span class="builtintype" id="7256043">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7256050">if</span>&nbsp;<span class="ident" id="7256053">rand</span><span class="op" id="7256057">.</span><span class="ident" id="7256058">Intn</span><span class="op" id="7256062">(</span><span class="num" id="7256063">10</span><span class="op" id="7256065">)</span>&nbsp;<span class="op" id="7256067">&gt;</span>&nbsp;<span class="num" id="7256069">5</span>&nbsp;<span class="op" id="7256071">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256076">m</span><span class="op" id="7256077">.</span><span class="ident" id="7256078">sessionTicket</span>&nbsp;<span class="op" id="7256092">=</span>&nbsp;<span class="ident" id="7256094">randomBytes</span><span class="op" id="7256105">(</span><span class="ident" id="7256106">rand</span><span class="op" id="7256110">.</span><span class="ident" id="7256111">Intn</span><span class="op" id="7256115">(</span><span class="num" id="7256116">300</span><span class="op" id="7256119">)</span><span class="op" id="7256120">,</span>&nbsp;<span class="ident" id="7256122">rand</span><span class="op" id="7256126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7256130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7256133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7256136">if</span>&nbsp;<span class="ident" id="7256139">rand</span><span class="op" id="7256143">.</span><span class="ident" id="7256144">Intn</span><span class="op" id="7256148">(</span><span class="num" id="7256149">10</span><span class="op" id="7256151">)</span>&nbsp;<span class="op" id="7256153">&gt;</span>&nbsp;<span class="num" id="7256155">5</span>&nbsp;<span class="op" id="7256157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256161">m</span><span class="op" id="7256162">.</span><span class="ident" id="7256163">signatureAndHashes</span>&nbsp;<span class="op" id="7256182">=</span>&nbsp;<span class="ident" id="7256184">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7256217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256220">m</span><span class="op" id="7256221">.</span><span class="ident" id="7256222">alpnProtocols</span>&nbsp;<span class="op" id="7256236">=</span>&nbsp;<span class="builtinfunc" id="7256238">make</span><span class="op" id="7256242">(</span><span class="op" id="7256243">[</span><span class="op" id="7256244">]</span><span class="builtintype" id="7256245">string</span><span class="op" id="7256251">,</span>&nbsp;<span class="ident" id="7256253">rand</span><span class="op" id="7256257">.</span><span class="ident" id="7256258">Intn</span><span class="op" id="7256262">(</span><span class="num" id="7256263">5</span><span class="op" id="7256264">)</span><span class="op" id="7256265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7256268">for</span>&nbsp;<span class="ident" id="7256272">i</span>&nbsp;<span class="op" id="7256274">:=</span>&nbsp;<span class="keyword" id="7256277">range</span>&nbsp;<span class="ident" id="7256283">m</span><span class="op" id="7256284">.</span><span class="ident" id="7256285">alpnProtocols</span>&nbsp;<span class="op" id="7256299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256303">m</span><span class="op" id="7256304">.</span><span class="ident" id="7256305">alpnProtocols</span><span class="op" id="7256318">[</span><span class="ident" id="7256319">i</span><span class="op" id="7256320">]</span>&nbsp;<span class="op" id="7256322">=</span>&nbsp;<span class="ident" id="7256324">randomString</span><span class="op" id="7256336">(</span><span class="ident" id="7256337">rand</span><span class="op" id="7256341">.</span><span class="ident" id="7256342">Intn</span><span class="op" id="7256346">(</span><span class="num" id="7256347">20</span><span class="op" id="7256349">)</span><span class="op" id="7256350">+</span><span class="num" id="7256351">1</span><span class="op" id="7256352">,</span>&nbsp;<span class="ident" id="7256354">rand</span><span class="op" id="7256358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7256361">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7256365">return</span>&nbsp;<span class="ident" id="7256372">reflect</span><span class="op" id="7256379">.</span><span class="ident" id="7256380">ValueOf</span><span class="op" id="7256387">(</span><span class="ident" id="7256388">m</span><span class="op" id="7256389">)</span><br>
<span class="lineno"></span><span class="op" id="7256391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7256394">func</span>&nbsp;<span class="op" id="7256399">(</span><span class="op" id="7256400">*</span><span class="ident" id="7256401">serverHelloMsg</span><span class="op" id="7256415">)</span>&nbsp;<span class="ident" id="7256417">Generate</span><span class="op" id="7256425">(</span><span class="ident" id="7256426">rand</span>&nbsp;<span class="op" id="7256431">*</span><span class="ident" id="7256432">rand</span><span class="op" id="7256436">.</span><span class="ident" id="7256437">Rand</span><span class="op" id="7256441">,</span>&nbsp;<span class="ident" id="7256443">size</span>&nbsp;<span class="builtintype" id="7256448">int</span><span class="op" id="7256451">)</span>&nbsp;<span class="ident" id="7256453">reflect</span><span class="op" id="7256460">.</span><span class="ident" id="7256461">Value</span>&nbsp;<span class="op" id="7256467">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256470">m</span>&nbsp;<span class="op" id="7256472">:=</span>&nbsp;<span class="op" id="7256475">&amp;</span><span class="ident" id="7256476">serverHelloMsg</span><span class="op" id="7256490">{</span><span class="op" id="7256491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256494">m</span><span class="op" id="7256495">.</span><span class="ident" id="7256496">vers</span>&nbsp;<span class="op" id="7256501">=</span>&nbsp;<span class="builtintype" id="7256503">uint16</span><span class="op" id="7256509">(</span><span class="ident" id="7256510">rand</span><span class="op" id="7256514">.</span><span class="ident" id="7256515">Intn</span><span class="op" id="7256519">(</span><span class="num" id="7256520">65536</span><span class="op" id="7256525">)</span><span class="op" id="7256526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256529">m</span><span class="op" id="7256530">.</span><span class="ident" id="7256531">random</span>&nbsp;<span class="op" id="7256538">=</span>&nbsp;<span class="ident" id="7256540">randomBytes</span><span class="op" id="7256551">(</span><span class="num" id="7256552">32</span><span class="op" id="7256554">,</span>&nbsp;<span class="ident" id="7256556">rand</span><span class="op" id="7256560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256563">m</span><span class="op" id="7256564">.</span><span class="ident" id="7256565">sessionId</span>&nbsp;<span class="op" id="7256575">=</span>&nbsp;<span class="ident" id="7256577">randomBytes</span><span class="op" id="7256588">(</span><span class="ident" id="7256589">rand</span><span class="op" id="7256593">.</span><span class="ident" id="7256594">Intn</span><span class="op" id="7256598">(</span><span class="num" id="7256599">32</span><span class="op" id="7256601">)</span><span class="op" id="7256602">,</span>&nbsp;<span class="ident" id="7256604">rand</span><span class="op" id="7256608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256611">m</span><span class="op" id="7256612">.</span><span class="ident" id="7256613">cipherSuite</span>&nbsp;<span class="op" id="7256625">=</span>&nbsp;<span class="builtintype" id="7256627">uint16</span><span class="op" id="7256633">(</span><span class="ident" id="7256634">rand</span><span class="op" id="7256638">.</span><span class="ident" id="7256639">Int31</span><span class="op" id="7256644">(</span><span class="op" id="7256645">)</span><span class="op" id="7256646">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256649">m</span><span class="op" id="7256650">.</span><span class="ident" id="7256651">compressionMethod</span>&nbsp;<span class="op" id="7256669">=</span>&nbsp;<span class="builtintype" id="7256671">uint8</span><span class="op" id="7256676">(</span><span class="ident" id="7256677">rand</span><span class="op" id="7256681">.</span><span class="ident" id="7256682">Intn</span><span class="op" id="7256686">(</span><span class="num" id="7256687">256</span><span class="op" id="7256690">)</span><span class="op" id="7256691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7256695">if</span>&nbsp;<span class="ident" id="7256698">rand</span><span class="op" id="7256702">.</span><span class="ident" id="7256703">Intn</span><span class="op" id="7256707">(</span><span class="num" id="7256708">10</span><span class="op" id="7256710">)</span>&nbsp;<span class="op" id="7256712">&gt;</span>&nbsp;<span class="num" id="7256714">5</span>&nbsp;<span class="op" id="7256716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256720">m</span><span class="op" id="7256721">.</span><span class="ident" id="7256722">nextProtoNeg</span>&nbsp;<span class="op" id="7256735">=</span>&nbsp;<span class="builtintype" id="7256737">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256745">n</span>&nbsp;<span class="op" id="7256747">:=</span>&nbsp;<span class="ident" id="7256750">rand</span><span class="op" id="7256754">.</span><span class="ident" id="7256755">Intn</span><span class="op" id="7256759">(</span><span class="num" id="7256760">10</span><span class="op" id="7256762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256766">m</span><span class="op" id="7256767">.</span><span class="ident" id="7256768">nextProtos</span>&nbsp;<span class="op" id="7256779">=</span>&nbsp;<span class="builtinfunc" id="7256781">make</span><span class="op" id="7256785">(</span><span class="op" id="7256786">[</span><span class="op" id="7256787">]</span><span class="builtintype" id="7256788">string</span><span class="op" id="7256794">,</span>&nbsp;<span class="ident" id="7256796">n</span><span class="op" id="7256797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7256801">for</span>&nbsp;<span class="ident" id="7256805">i</span>&nbsp;<span class="op" id="7256807">:=</span>&nbsp;<span class="num" id="7256810">0</span><span class="op" id="7256811">;</span>&nbsp;<span class="ident" id="7256813">i</span>&nbsp;<span class="op" id="7256815">&lt;</span>&nbsp;<span class="ident" id="7256817">n</span><span class="op" id="7256818">;</span>&nbsp;<span class="ident" id="7256820">i</span><span class="op" id="7256821">++</span>&nbsp;<span class="op" id="7256824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256829">m</span><span class="op" id="7256830">.</span><span class="ident" id="7256831">nextProtos</span><span class="op" id="7256841">[</span><span class="ident" id="7256842">i</span><span class="op" id="7256843">]</span>&nbsp;<span class="op" id="7256845">=</span>&nbsp;<span class="ident" id="7256847">randomString</span><span class="op" id="7256859">(</span><span class="num" id="7256860">20</span><span class="op" id="7256862">,</span>&nbsp;<span class="ident" id="7256864">rand</span><span class="op" id="7256868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7256872">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7256875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7256879">if</span>&nbsp;<span class="ident" id="7256882">rand</span><span class="op" id="7256886">.</span><span class="ident" id="7256887">Intn</span><span class="op" id="7256891">(</span><span class="num" id="7256892">10</span><span class="op" id="7256894">)</span>&nbsp;<span class="op" id="7256896">&gt;</span>&nbsp;<span class="num" id="7256898">5</span>&nbsp;<span class="op" id="7256900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256904">m</span><span class="op" id="7256905">.</span><span class="ident" id="7256906">ocspStapling</span>&nbsp;<span class="op" id="7256919">=</span>&nbsp;<span class="builtintype" id="7256921">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7256927">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7256930">if</span>&nbsp;<span class="ident" id="7256933">rand</span><span class="op" id="7256937">.</span><span class="ident" id="7256938">Intn</span><span class="op" id="7256942">(</span><span class="num" id="7256943">10</span><span class="op" id="7256945">)</span>&nbsp;<span class="op" id="7256947">&gt;</span>&nbsp;<span class="num" id="7256949">5</span>&nbsp;<span class="op" id="7256951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256955">m</span><span class="op" id="7256956">.</span><span class="ident" id="7256957">ticketSupported</span>&nbsp;<span class="op" id="7256973">=</span>&nbsp;<span class="builtintype" id="7256975">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7256981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7256984">m</span><span class="op" id="7256985">.</span><span class="ident" id="7256986">alpnProtocol</span>&nbsp;<span class="op" id="7256999">=</span>&nbsp;<span class="ident" id="7257001">randomString</span><span class="op" id="7257013">(</span><span class="ident" id="7257014">rand</span><span class="op" id="7257018">.</span><span class="ident" id="7257019">Intn</span><span class="op" id="7257023">(</span><span class="num" id="7257024">32</span><span class="op" id="7257026">)</span><span class="op" id="7257027">+</span><span class="num" id="7257028">1</span><span class="op" id="7257029">,</span>&nbsp;<span class="ident" id="7257031">rand</span><span class="op" id="7257035">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7257039">return</span>&nbsp;<span class="ident" id="7257046">reflect</span><span class="op" id="7257053">.</span><span class="ident" id="7257054">ValueOf</span><span class="op" id="7257061">(</span><span class="ident" id="7257062">m</span><span class="op" id="7257063">)</span><br>
<span class="lineno"></span><span class="op" id="7257065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7257068">func</span>&nbsp;<span class="op" id="7257073">(</span><span class="op" id="7257074">*</span><span class="ident" id="7257075">certificateMsg</span><span class="op" id="7257089">)</span>&nbsp;<span class="ident" id="7257091">Generate</span><span class="op" id="7257099">(</span><span class="ident" id="7257100">rand</span>&nbsp;<span class="op" id="7257105">*</span><span class="ident" id="7257106">rand</span><span class="op" id="7257110">.</span><span class="ident" id="7257111">Rand</span><span class="op" id="7257115">,</span>&nbsp;<span class="ident" id="7257117">size</span>&nbsp;<span class="builtintype" id="7257122">int</span><span class="op" id="7257125">)</span>&nbsp;<span class="ident" id="7257127">reflect</span><span class="op" id="7257134">.</span><span class="ident" id="7257135">Value</span>&nbsp;<span class="op" id="7257141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7257144">m</span>&nbsp;<span class="op" id="7257146">:=</span>&nbsp;<span class="op" id="7257149">&amp;</span><span class="ident" id="7257150">certificateMsg</span><span class="op" id="7257164">{</span><span class="op" id="7257165">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7257168">numCerts</span>&nbsp;<span class="op" id="7257177">:=</span>&nbsp;<span class="ident" id="7257180">rand</span><span class="op" id="7257184">.</span><span class="ident" id="7257185">Intn</span><span class="op" id="7257189">(</span><span class="num" id="7257190">20</span><span class="op" id="7257192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7257195">m</span><span class="op" id="7257196">.</span><span class="ident" id="7257197">certificates</span>&nbsp;<span class="op" id="7257210">=</span>&nbsp;<span class="builtinfunc" id="7257212">make</span><span class="op" id="7257216">(</span><span class="op" id="7257217">[</span><span class="op" id="7257218">]</span><span class="op" id="7257219">[</span><span class="op" id="7257220">]</span><span class="builtintype" id="7257221">byte</span><span class="op" id="7257225">,</span>&nbsp;<span class="ident" id="7257227">numCerts</span><span class="op" id="7257235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7257238">for</span>&nbsp;<span class="ident" id="7257242">i</span>&nbsp;<span class="op" id="7257244">:=</span>&nbsp;<span class="num" id="7257247">0</span><span class="op" id="7257248">;</span>&nbsp;<span class="ident" id="7257250">i</span>&nbsp;<span class="op" id="7257252">&lt;</span>&nbsp;<span class="ident" id="7257254">numCerts</span><span class="op" id="7257262">;</span>&nbsp;<span class="ident" id="7257264">i</span><span class="op" id="7257265">++</span>&nbsp;<span class="op" id="7257268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7257272">m</span><span class="op" id="7257273">.</span><span class="ident" id="7257274">certificates</span><span class="op" id="7257286">[</span><span class="ident" id="7257287">i</span><span class="op" id="7257288">]</span>&nbsp;<span class="op" id="7257290">=</span>&nbsp;<span class="ident" id="7257292">randomBytes</span><span class="op" id="7257303">(</span><span class="ident" id="7257304">rand</span><span class="op" id="7257308">.</span><span class="ident" id="7257309">Intn</span><span class="op" id="7257313">(</span><span class="num" id="7257314">10</span><span class="op" id="7257316">)</span><span class="op" id="7257317">+</span><span class="num" id="7257318">1</span><span class="op" id="7257319">,</span>&nbsp;<span class="ident" id="7257321">rand</span><span class="op" id="7257325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7257328">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7257331">return</span>&nbsp;<span class="ident" id="7257338">reflect</span><span class="op" id="7257345">.</span><span class="ident" id="7257346">ValueOf</span><span class="op" id="7257353">(</span><span class="ident" id="7257354">m</span><span class="op" id="7257355">)</span><br>
<span class="lineno"></span><span class="op" id="7257357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7257360">func</span>&nbsp;<span class="op" id="7257365">(</span><span class="op" id="7257366">*</span><span class="ident" id="7257367">certificateRequestMsg</span><span class="op" id="7257388">)</span>&nbsp;<span class="ident" id="7257390">Generate</span><span class="op" id="7257398">(</span><span class="ident" id="7257399">rand</span>&nbsp;<span class="op" id="7257404">*</span><span class="ident" id="7257405">rand</span><span class="op" id="7257409">.</span><span class="ident" id="7257410">Rand</span><span class="op" id="7257414">,</span>&nbsp;<span class="ident" id="7257416">size</span>&nbsp;<span class="builtintype" id="7257421">int</span><span class="op" id="7257424">)</span>&nbsp;<span class="ident" id="7257426">reflect</span><span class="op" id="7257433">.</span><span class="ident" id="7257434">Value</span>&nbsp;<span class="op" id="7257440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7257443">m</span>&nbsp;<span class="op" id="7257445">:=</span>&nbsp;<span class="op" id="7257448">&amp;</span><span class="ident" id="7257449">certificateRequestMsg</span><span class="op" id="7257470">{</span><span class="op" id="7257471">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7257474">m</span><span class="op" id="7257475">.</span><span class="ident" id="7257476">certificateTypes</span>&nbsp;<span class="op" id="7257493">=</span>&nbsp;<span class="ident" id="7257495">randomBytes</span><span class="op" id="7257506">(</span><span class="ident" id="7257507">rand</span><span class="op" id="7257511">.</span><span class="ident" id="7257512">Intn</span><span class="op" id="7257516">(</span><span class="num" id="7257517">5</span><span class="op" id="7257518">)</span><span class="op" id="7257519">+</span><span class="num" id="7257520">1</span><span class="op" id="7257521">,</span>&nbsp;<span class="ident" id="7257523">rand</span><span class="op" id="7257527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7257530">numCAs</span>&nbsp;<span class="op" id="7257537">:=</span>&nbsp;<span class="ident" id="7257540">rand</span><span class="op" id="7257544">.</span><span class="ident" id="7257545">Intn</span><span class="op" id="7257549">(</span><span class="num" id="7257550">100</span><span class="op" id="7257553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7257556">m</span><span class="op" id="7257557">.</span><span class="ident" id="7257558">certificateAuthorities</span>&nbsp;<span class="op" id="7257581">=</span>&nbsp;<span class="builtinfunc" id="7257583">make</span><span class="op" id="7257587">(</span><span class="op" id="7257588">[</span><span class="op" id="7257589">]</span><span class="op" id="7257590">[</span><span class="op" id="7257591">]</span><span class="builtintype" id="7257592">byte</span><span class="op" id="7257596">,</span>&nbsp;<span class="ident" id="7257598">numCAs</span><span class="op" id="7257604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7257607">for</span>&nbsp;<span class="ident" id="7257611">i</span>&nbsp;<span class="op" id="7257613">:=</span>&nbsp;<span class="num" id="7257616">0</span><span class="op" id="7257617">;</span>&nbsp;<span class="ident" id="7257619">i</span>&nbsp;<span class="op" id="7257621">&lt;</span>&nbsp;<span class="ident" id="7257623">numCAs</span><span class="op" id="7257629">;</span>&nbsp;<span class="ident" id="7257631">i</span><span class="op" id="7257632">++</span>&nbsp;<span class="op" id="7257635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7257639">m</span><span class="op" id="7257640">.</span><span class="ident" id="7257641">certificateAuthorities</span><span class="op" id="7257663">[</span><span class="ident" id="7257664">i</span><span class="op" id="7257665">]</span>&nbsp;<span class="op" id="7257667">=</span>&nbsp;<span class="ident" id="7257669">randomBytes</span><span class="op" id="7257680">(</span><span class="ident" id="7257681">rand</span><span class="op" id="7257685">.</span><span class="ident" id="7257686">Intn</span><span class="op" id="7257690">(</span><span class="num" id="7257691">15</span><span class="op" id="7257693">)</span><span class="op" id="7257694">+</span><span class="num" id="7257695">1</span><span class="op" id="7257696">,</span>&nbsp;<span class="ident" id="7257698">rand</span><span class="op" id="7257702">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7257705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7257708">return</span>&nbsp;<span class="ident" id="7257715">reflect</span><span class="op" id="7257722">.</span><span class="ident" id="7257723">ValueOf</span><span class="op" id="7257730">(</span><span class="ident" id="7257731">m</span><span class="op" id="7257732">)</span><br>
<span class="lineno"></span><span class="op" id="7257734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7257737">func</span>&nbsp;<span class="op" id="7257742">(</span><span class="op" id="7257743">*</span><span class="ident" id="7257744">certificateVerifyMsg</span><span class="op" id="7257764">)</span>&nbsp;<span class="ident" id="7257766">Generate</span><span class="op" id="7257774">(</span><span class="ident" id="7257775">rand</span>&nbsp;<span class="op" id="7257780">*</span><span class="ident" id="7257781">rand</span><span class="op" id="7257785">.</span><span class="ident" id="7257786">Rand</span><span class="op" id="7257790">,</span>&nbsp;<span class="ident" id="7257792">size</span>&nbsp;<span class="builtintype" id="7257797">int</span><span class="op" id="7257800">)</span>&nbsp;<span class="ident" id="7257802">reflect</span><span class="op" id="7257809">.</span><span class="ident" id="7257810">Value</span>&nbsp;<span class="op" id="7257816">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7257819">m</span>&nbsp;<span class="op" id="7257821">:=</span>&nbsp;<span class="op" id="7257824">&amp;</span><span class="ident" id="7257825">certificateVerifyMsg</span><span class="op" id="7257845">{</span><span class="op" id="7257846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7257849">m</span><span class="op" id="7257850">.</span><span class="ident" id="7257851">signature</span>&nbsp;<span class="op" id="7257861">=</span>&nbsp;<span class="ident" id="7257863">randomBytes</span><span class="op" id="7257874">(</span><span class="ident" id="7257875">rand</span><span class="op" id="7257879">.</span><span class="ident" id="7257880">Intn</span><span class="op" id="7257884">(</span><span class="num" id="7257885">15</span><span class="op" id="7257887">)</span><span class="op" id="7257888">+</span><span class="num" id="7257889">1</span><span class="op" id="7257890">,</span>&nbsp;<span class="ident" id="7257892">rand</span><span class="op" id="7257896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7257899">return</span>&nbsp;<span class="ident" id="7257906">reflect</span><span class="op" id="7257913">.</span><span class="ident" id="7257914">ValueOf</span><span class="op" id="7257921">(</span><span class="ident" id="7257922">m</span><span class="op" id="7257923">)</span><br>
<span class="lineno"></span><span class="op" id="7257925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="7257928">func</span>&nbsp;<span class="op" id="7257933">(</span><span class="op" id="7257934">*</span><span class="ident" id="7257935">certificateStatusMsg</span><span class="op" id="7257955">)</span>&nbsp;<span class="ident" id="7257957">Generate</span><span class="op" id="7257965">(</span><span class="ident" id="7257966">rand</span>&nbsp;<span class="op" id="7257971">*</span><span class="ident" id="7257972">rand</span><span class="op" id="7257976">.</span><span class="ident" id="7257977">Rand</span><span class="op" id="7257981">,</span>&nbsp;<span class="ident" id="7257983">size</span>&nbsp;<span class="builtintype" id="7257988">int</span><span class="op" id="7257991">)</span>&nbsp;<span class="ident" id="7257993">reflect</span><span class="op" id="7258000">.</span><span class="ident" id="7258001">Value</span>&nbsp;<span class="op" id="7258007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258010">m</span>&nbsp;<span class="op" id="7258012">:=</span>&nbsp;<span class="op" id="7258015">&amp;</span><span class="ident" id="7258016">certificateStatusMsg</span><span class="op" id="7258036">{</span><span class="op" id="7258037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7258040">if</span>&nbsp;<span class="ident" id="7258043">rand</span><span class="op" id="7258047">.</span><span class="ident" id="7258048">Intn</span><span class="op" id="7258052">(</span><span class="num" id="7258053">10</span><span class="op" id="7258055">)</span>&nbsp;<span class="op" id="7258057">&gt;</span>&nbsp;<span class="num" id="7258059">5</span>&nbsp;<span class="op" id="7258061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258065">m</span><span class="op" id="7258066">.</span><span class="ident" id="7258067">statusType</span>&nbsp;<span class="op" id="7258078">=</span>&nbsp;<span class="ident" id="7258080">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258097">m</span><span class="op" id="7258098">.</span><span class="ident" id="7258099">response</span>&nbsp;<span class="op" id="7258108">=</span>&nbsp;<span class="ident" id="7258110">randomBytes</span><span class="op" id="7258121">(</span><span class="ident" id="7258122">rand</span><span class="op" id="7258126">.</span><span class="ident" id="7258127">Intn</span><span class="op" id="7258131">(</span><span class="num" id="7258132">10</span><span class="op" id="7258134">)</span><span class="op" id="7258135">+</span><span class="num" id="7258136">1</span><span class="op" id="7258137">,</span>&nbsp;<span class="ident" id="7258139">rand</span><span class="op" id="7258143">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7258146">}</span>&nbsp;<span class="keyword" id="7258148">else</span>&nbsp;<span class="op" id="7258153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258157">m</span><span class="op" id="7258158">.</span><span class="ident" id="7258159">statusType</span>&nbsp;<span class="op" id="7258170">=</span>&nbsp;<span class="num" id="7258172">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7258176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7258179">return</span>&nbsp;<span class="ident" id="7258186">reflect</span><span class="op" id="7258193">.</span><span class="ident" id="7258194">ValueOf</span><span class="op" id="7258201">(</span><span class="ident" id="7258202">m</span><span class="op" id="7258203">)</span><br>
<span class="lineno"></span><span class="op" id="7258205">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="7258208">func</span>&nbsp;<span class="op" id="7258213">(</span><span class="op" id="7258214">*</span><span class="ident" id="7258215">clientKeyExchangeMsg</span><span class="op" id="7258235">)</span>&nbsp;<span class="ident" id="7258237">Generate</span><span class="op" id="7258245">(</span><span class="ident" id="7258246">rand</span>&nbsp;<span class="op" id="7258251">*</span><span class="ident" id="7258252">rand</span><span class="op" id="7258256">.</span><span class="ident" id="7258257">Rand</span><span class="op" id="7258261">,</span>&nbsp;<span class="ident" id="7258263">size</span>&nbsp;<span class="builtintype" id="7258268">int</span><span class="op" id="7258271">)</span>&nbsp;<span class="ident" id="7258273">reflect</span><span class="op" id="7258280">.</span><span class="ident" id="7258281">Value</span>&nbsp;<span class="op" id="7258287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258290">m</span>&nbsp;<span class="op" id="7258292">:=</span>&nbsp;<span class="op" id="7258295">&amp;</span><span class="ident" id="7258296">clientKeyExchangeMsg</span><span class="op" id="7258316">{</span><span class="op" id="7258317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258320">m</span><span class="op" id="7258321">.</span><span class="ident" id="7258322">ciphertext</span>&nbsp;<span class="op" id="7258333">=</span>&nbsp;<span class="ident" id="7258335">randomBytes</span><span class="op" id="7258346">(</span><span class="ident" id="7258347">rand</span><span class="op" id="7258351">.</span><span class="ident" id="7258352">Intn</span><span class="op" id="7258356">(</span><span class="num" id="7258357">1000</span><span class="op" id="7258361">)</span><span class="op" id="7258362">+</span><span class="num" id="7258363">1</span><span class="op" id="7258364">,</span>&nbsp;<span class="ident" id="7258366">rand</span><span class="op" id="7258370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7258373">return</span>&nbsp;<span class="ident" id="7258380">reflect</span><span class="op" id="7258387">.</span><span class="ident" id="7258388">ValueOf</span><span class="op" id="7258395">(</span><span class="ident" id="7258396">m</span><span class="op" id="7258397">)</span><br>
<span class="lineno">220</span><span class="op" id="7258399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7258402">func</span>&nbsp;<span class="op" id="7258407">(</span><span class="op" id="7258408">*</span><span class="ident" id="7258409">finishedMsg</span><span class="op" id="7258420">)</span>&nbsp;<span class="ident" id="7258422">Generate</span><span class="op" id="7258430">(</span><span class="ident" id="7258431">rand</span>&nbsp;<span class="op" id="7258436">*</span><span class="ident" id="7258437">rand</span><span class="op" id="7258441">.</span><span class="ident" id="7258442">Rand</span><span class="op" id="7258446">,</span>&nbsp;<span class="ident" id="7258448">size</span>&nbsp;<span class="builtintype" id="7258453">int</span><span class="op" id="7258456">)</span>&nbsp;<span class="ident" id="7258458">reflect</span><span class="op" id="7258465">.</span><span class="ident" id="7258466">Value</span>&nbsp;<span class="op" id="7258472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258475">m</span>&nbsp;<span class="op" id="7258477">:=</span>&nbsp;<span class="op" id="7258480">&amp;</span><span class="ident" id="7258481">finishedMsg</span><span class="op" id="7258492">{</span><span class="op" id="7258493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258496">m</span><span class="op" id="7258497">.</span><span class="ident" id="7258498">verifyData</span>&nbsp;<span class="op" id="7258509">=</span>&nbsp;<span class="ident" id="7258511">randomBytes</span><span class="op" id="7258522">(</span><span class="num" id="7258523">12</span><span class="op" id="7258525">,</span>&nbsp;<span class="ident" id="7258527">rand</span><span class="op" id="7258531">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7258534">return</span>&nbsp;<span class="ident" id="7258541">reflect</span><span class="op" id="7258548">.</span><span class="ident" id="7258549">ValueOf</span><span class="op" id="7258556">(</span><span class="ident" id="7258557">m</span><span class="op" id="7258558">)</span><br>
<span class="lineno"></span><span class="op" id="7258560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7258563">func</span>&nbsp;<span class="op" id="7258568">(</span><span class="op" id="7258569">*</span><span class="ident" id="7258570">nextProtoMsg</span><span class="op" id="7258582">)</span>&nbsp;<span class="ident" id="7258584">Generate</span><span class="op" id="7258592">(</span><span class="ident" id="7258593">rand</span>&nbsp;<span class="op" id="7258598">*</span><span class="ident" id="7258599">rand</span><span class="op" id="7258603">.</span><span class="ident" id="7258604">Rand</span><span class="op" id="7258608">,</span>&nbsp;<span class="ident" id="7258610">size</span>&nbsp;<span class="builtintype" id="7258615">int</span><span class="op" id="7258618">)</span>&nbsp;<span class="ident" id="7258620">reflect</span><span class="op" id="7258627">.</span><span class="ident" id="7258628">Value</span>&nbsp;<span class="op" id="7258634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258637">m</span>&nbsp;<span class="op" id="7258639">:=</span>&nbsp;<span class="op" id="7258642">&amp;</span><span class="ident" id="7258643">nextProtoMsg</span><span class="op" id="7258655">{</span><span class="op" id="7258656">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258659">m</span><span class="op" id="7258660">.</span><span class="ident" id="7258661">proto</span>&nbsp;<span class="op" id="7258667">=</span>&nbsp;<span class="ident" id="7258669">randomString</span><span class="op" id="7258681">(</span><span class="ident" id="7258682">rand</span><span class="op" id="7258686">.</span><span class="ident" id="7258687">Intn</span><span class="op" id="7258691">(</span><span class="num" id="7258692">255</span><span class="op" id="7258695">)</span><span class="op" id="7258696">,</span>&nbsp;<span class="ident" id="7258698">rand</span><span class="op" id="7258702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7258705">return</span>&nbsp;<span class="ident" id="7258712">reflect</span><span class="op" id="7258719">.</span><span class="ident" id="7258720">ValueOf</span><span class="op" id="7258727">(</span><span class="ident" id="7258728">m</span><span class="op" id="7258729">)</span><br>
<span class="lineno"></span><span class="op" id="7258731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7258734">func</span>&nbsp;<span class="op" id="7258739">(</span><span class="op" id="7258740">*</span><span class="ident" id="7258741">newSessionTicketMsg</span><span class="op" id="7258760">)</span>&nbsp;<span class="ident" id="7258762">Generate</span><span class="op" id="7258770">(</span><span class="ident" id="7258771">rand</span>&nbsp;<span class="op" id="7258776">*</span><span class="ident" id="7258777">rand</span><span class="op" id="7258781">.</span><span class="ident" id="7258782">Rand</span><span class="op" id="7258786">,</span>&nbsp;<span class="ident" id="7258788">size</span>&nbsp;<span class="builtintype" id="7258793">int</span><span class="op" id="7258796">)</span>&nbsp;<span class="ident" id="7258798">reflect</span><span class="op" id="7258805">.</span><span class="ident" id="7258806">Value</span>&nbsp;<span class="op" id="7258812">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258815">m</span>&nbsp;<span class="op" id="7258817">:=</span>&nbsp;<span class="op" id="7258820">&amp;</span><span class="ident" id="7258821">newSessionTicketMsg</span><span class="op" id="7258840">{</span><span class="op" id="7258841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258844">m</span><span class="op" id="7258845">.</span><span class="ident" id="7258846">ticket</span>&nbsp;<span class="op" id="7258853">=</span>&nbsp;<span class="ident" id="7258855">randomBytes</span><span class="op" id="7258866">(</span><span class="ident" id="7258867">rand</span><span class="op" id="7258871">.</span><span class="ident" id="7258872">Intn</span><span class="op" id="7258876">(</span><span class="num" id="7258877">4</span><span class="op" id="7258878">)</span><span class="op" id="7258879">,</span>&nbsp;<span class="ident" id="7258881">rand</span><span class="op" id="7258885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7258888">return</span>&nbsp;<span class="ident" id="7258895">reflect</span><span class="op" id="7258902">.</span><span class="ident" id="7258903">ValueOf</span><span class="op" id="7258910">(</span><span class="ident" id="7258911">m</span><span class="op" id="7258912">)</span><br>
<span class="lineno"></span><span class="op" id="7258914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7258917">func</span>&nbsp;<span class="op" id="7258922">(</span><span class="op" id="7258923">*</span><span class="ident" id="7258924">sessionState</span><span class="op" id="7258936">)</span>&nbsp;<span class="ident" id="7258938">Generate</span><span class="op" id="7258946">(</span><span class="ident" id="7258947">rand</span>&nbsp;<span class="op" id="7258952">*</span><span class="ident" id="7258953">rand</span><span class="op" id="7258957">.</span><span class="ident" id="7258958">Rand</span><span class="op" id="7258962">,</span>&nbsp;<span class="ident" id="7258964">size</span>&nbsp;<span class="builtintype" id="7258969">int</span><span class="op" id="7258972">)</span>&nbsp;<span class="ident" id="7258974">reflect</span><span class="op" id="7258981">.</span><span class="ident" id="7258982">Value</span>&nbsp;<span class="op" id="7258988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7258991">s</span>&nbsp;<span class="op" id="7258993">:=</span>&nbsp;<span class="op" id="7258996">&amp;</span><span class="ident" id="7258997">sessionState</span><span class="op" id="7259009">{</span><span class="op" id="7259010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7259013">s</span><span class="op" id="7259014">.</span><span class="ident" id="7259015">vers</span>&nbsp;<span class="op" id="7259020">=</span>&nbsp;<span class="builtintype" id="7259022">uint16</span><span class="op" id="7259028">(</span><span class="ident" id="7259029">rand</span><span class="op" id="7259033">.</span><span class="ident" id="7259034">Intn</span><span class="op" id="7259038">(</span><span class="num" id="7259039">10000</span><span class="op" id="7259044">)</span><span class="op" id="7259045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7259048">s</span><span class="op" id="7259049">.</span><span class="ident" id="7259050">cipherSuite</span>&nbsp;<span class="op" id="7259062">=</span>&nbsp;<span class="builtintype" id="7259064">uint16</span><span class="op" id="7259070">(</span><span class="ident" id="7259071">rand</span><span class="op" id="7259075">.</span><span class="ident" id="7259076">Intn</span><span class="op" id="7259080">(</span><span class="num" id="7259081">10000</span><span class="op" id="7259086">)</span><span class="op" id="7259087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7259090">s</span><span class="op" id="7259091">.</span><span class="ident" id="7259092">masterSecret</span>&nbsp;<span class="op" id="7259105">=</span>&nbsp;<span class="ident" id="7259107">randomBytes</span><span class="op" id="7259118">(</span><span class="ident" id="7259119">rand</span><span class="op" id="7259123">.</span><span class="ident" id="7259124">Intn</span><span class="op" id="7259128">(</span><span class="num" id="7259129">100</span><span class="op" id="7259132">)</span><span class="op" id="7259133">,</span>&nbsp;<span class="ident" id="7259135">rand</span><span class="op" id="7259139">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7259142">numCerts</span>&nbsp;<span class="op" id="7259151">:=</span>&nbsp;<span class="ident" id="7259154">rand</span><span class="op" id="7259158">.</span><span class="ident" id="7259159">Intn</span><span class="op" id="7259163">(</span><span class="num" id="7259164">20</span><span class="op" id="7259166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7259169">s</span><span class="op" id="7259170">.</span><span class="ident" id="7259171">certificates</span>&nbsp;<span class="op" id="7259184">=</span>&nbsp;<span class="builtinfunc" id="7259186">make</span><span class="op" id="7259190">(</span><span class="op" id="7259191">[</span><span class="op" id="7259192">]</span><span class="op" id="7259193">[</span><span class="op" id="7259194">]</span><span class="builtintype" id="7259195">byte</span><span class="op" id="7259199">,</span>&nbsp;<span class="ident" id="7259201">numCerts</span><span class="op" id="7259209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7259212">for</span>&nbsp;<span class="ident" id="7259216">i</span>&nbsp;<span class="op" id="7259218">:=</span>&nbsp;<span class="num" id="7259221">0</span><span class="op" id="7259222">;</span>&nbsp;<span class="ident" id="7259224">i</span>&nbsp;<span class="op" id="7259226">&lt;</span>&nbsp;<span class="ident" id="7259228">numCerts</span><span class="op" id="7259236">;</span>&nbsp;<span class="ident" id="7259238">i</span><span class="op" id="7259239">++</span>&nbsp;<span class="op" id="7259242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7259246">s</span><span class="op" id="7259247">.</span><span class="ident" id="7259248">certificates</span><span class="op" id="7259260">[</span><span class="ident" id="7259261">i</span><span class="op" id="7259262">]</span>&nbsp;<span class="op" id="7259264">=</span>&nbsp;<span class="ident" id="7259266">randomBytes</span><span class="op" id="7259277">(</span><span class="ident" id="7259278">rand</span><span class="op" id="7259282">.</span><span class="ident" id="7259283">Intn</span><span class="op" id="7259287">(</span><span class="num" id="7259288">10</span><span class="op" id="7259290">)</span><span class="op" id="7259291">+</span><span class="num" id="7259292">1</span><span class="op" id="7259293">,</span>&nbsp;<span class="ident" id="7259295">rand</span><span class="op" id="7259299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7259302">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7259305">return</span>&nbsp;<span class="ident" id="7259312">reflect</span><span class="op" id="7259319">.</span><span class="ident" id="7259320">ValueOf</span><span class="op" id="7259327">(</span><span class="ident" id="7259328">s</span><span class="op" id="7259329">)</span><br>
<span class="lineno"></span><span class="op" id="7259331">}</span>
</div>
</body>
</html>
