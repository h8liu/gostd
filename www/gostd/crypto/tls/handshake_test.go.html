<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html" class="current">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7826660">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7826715">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7826769">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7826820">package</span>&nbsp;<span class="ident" id="7826828">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7826833">import</span>&nbsp;<span class="op" id="7826840">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826843">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826852">&#34;encoding/hex&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826868">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826878">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826886">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826893">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826899">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826912">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826919">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826930">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826941">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="7826948">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="7826951">//&nbsp;TLS&nbsp;reference&nbsp;tests&nbsp;run&nbsp;a&nbsp;connection&nbsp;against&nbsp;a&nbsp;reference&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="7827026">//&nbsp;(OpenSSL)&nbsp;of&nbsp;TLS&nbsp;and&nbsp;record&nbsp;the&nbsp;bytes&nbsp;of&nbsp;the&nbsp;resulting&nbsp;connection.&nbsp;The&nbsp;Go</span><br>
<span class="lineno"></span><span class="comment" id="7827103">//&nbsp;code,&nbsp;during&nbsp;a&nbsp;test,&nbsp;is&nbsp;configured&nbsp;with&nbsp;deterministic&nbsp;randomness&nbsp;and&nbsp;so&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="7827182">//&nbsp;reference&nbsp;test&nbsp;can&nbsp;be&nbsp;reproduced&nbsp;exactly&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno">25</span><span class="comment" id="7827241">//</span><br>
<span class="lineno"></span><span class="comment" id="7827244">//&nbsp;In&nbsp;order&nbsp;to&nbsp;save&nbsp;everyone&nbsp;who&nbsp;wishes&nbsp;to&nbsp;run&nbsp;the&nbsp;tests&nbsp;from&nbsp;needing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="7827318">//&nbsp;reference&nbsp;implementation&nbsp;installed,&nbsp;the&nbsp;reference&nbsp;connections&nbsp;are&nbsp;saved&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="7827396">//&nbsp;files&nbsp;in&nbsp;the&nbsp;testdata&nbsp;directory.&nbsp;Thus&nbsp;running&nbsp;the&nbsp;tests&nbsp;involves&nbsp;nothing</span><br>
<span class="lineno"></span><span class="comment" id="7827472">//&nbsp;external,&nbsp;but&nbsp;creating&nbsp;and&nbsp;updating&nbsp;them&nbsp;requires&nbsp;the&nbsp;reference</span><br>
<span class="lineno">30</span><span class="comment" id="7827539">//&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="comment" id="7827558">//</span><br>
<span class="lineno"></span><span class="comment" id="7827561">//&nbsp;Tests&nbsp;can&nbsp;be&nbsp;updated&nbsp;by&nbsp;running&nbsp;them&nbsp;with&nbsp;the&nbsp;-update&nbsp;flag.&nbsp;This&nbsp;will&nbsp;cause</span><br>
<span class="lineno"></span><span class="comment" id="7827640">//&nbsp;the&nbsp;test&nbsp;files.&nbsp;Generally&nbsp;one&nbsp;should&nbsp;combine&nbsp;the&nbsp;-update&nbsp;flag&nbsp;with&nbsp;-test.run</span><br>
<span class="lineno"></span><span class="comment" id="7827720">//&nbsp;to&nbsp;updated&nbsp;a&nbsp;specific&nbsp;test.&nbsp;Since&nbsp;the&nbsp;reference&nbsp;implementation&nbsp;will&nbsp;always</span><br>
<span class="lineno">35</span><span class="comment" id="7827798">//&nbsp;generate&nbsp;fresh&nbsp;random&nbsp;numbers,&nbsp;large&nbsp;parts&nbsp;of&nbsp;the&nbsp;reference&nbsp;connection&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="7827877">//&nbsp;always&nbsp;change.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7827896">var</span>&nbsp;<span class="ident" id="7827900">update</span>&nbsp;<span class="op" id="7827907">=</span>&nbsp;<span class="ident" id="7827909">flag</span><span class="op" id="7827913">.</span><span class="ident" id="7827914">Bool</span><span class="op" id="7827918">(</span><span class="string" id="7827919">&#34;update&#34;</span><span class="op" id="7827927">,</span>&nbsp;<span class="builtintype" id="7827929">false</span><span class="op" id="7827934">,</span>&nbsp;<span class="string" id="7827936">&#34;update&nbsp;golden&nbsp;files&nbsp;on&nbsp;disk&#34;</span><span class="op" id="7827965">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="7827968">//&nbsp;recordingConn&nbsp;is&nbsp;a&nbsp;net.Conn&nbsp;that&nbsp;records&nbsp;the&nbsp;traffic&nbsp;that&nbsp;passes&nbsp;through&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="7828048">//&nbsp;WriteTo&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;produce&nbsp;output&nbsp;that&nbsp;can&nbsp;be&nbsp;later&nbsp;be&nbsp;loaded&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="7828122">//&nbsp;ParseTestData.</span><br>
<span class="lineno"></span><span class="keyword" id="7828140">type</span>&nbsp;<span class="ident" id="7828145">recordingConn</span>&nbsp;<span class="keyword" id="7828159">struct</span>&nbsp;<span class="op" id="7828166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828169">net</span><span class="op" id="7828172">.</span><span class="ident" id="7828173">Conn</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828179">sync</span><span class="op" id="7828183">.</span><span class="ident" id="7828184">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828191">flows</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7828199">[</span><span class="op" id="7828200">]</span><span class="op" id="7828201">[</span><span class="op" id="7828202">]</span><span class="builtintype" id="7828203">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828209">reading</span>&nbsp;<span class="builtintype" id="7828217">bool</span><br>
<span class="lineno"></span><span class="op" id="7828222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="7828225">func</span>&nbsp;<span class="op" id="7828230">(</span><span class="ident" id="7828231">r</span>&nbsp;<span class="op" id="7828233">*</span><span class="ident" id="7828234">recordingConn</span><span class="op" id="7828247">)</span>&nbsp;<span class="ident" id="7828249">Read</span><span class="op" id="7828253">(</span><span class="ident" id="7828254">b</span>&nbsp;<span class="op" id="7828256">[</span><span class="op" id="7828257">]</span><span class="builtintype" id="7828258">byte</span><span class="op" id="7828262">)</span>&nbsp;<span class="op" id="7828264">(</span><span class="ident" id="7828265">n</span>&nbsp;<span class="builtintype" id="7828267">int</span><span class="op" id="7828270">,</span>&nbsp;<span class="ident" id="7828272">err</span>&nbsp;<span class="builtintype" id="7828276">error</span><span class="op" id="7828281">)</span>&nbsp;<span class="op" id="7828283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7828286">if</span>&nbsp;<span class="ident" id="7828289">n</span><span class="op" id="7828290">,</span>&nbsp;<span class="ident" id="7828292">err</span>&nbsp;<span class="op" id="7828296">=</span>&nbsp;<span class="ident" id="7828298">r</span><span class="op" id="7828299">.</span><span class="ident" id="7828300">Conn</span><span class="op" id="7828304">.</span><span class="ident" id="7828305">Read</span><span class="op" id="7828309">(</span><span class="ident" id="7828310">b</span><span class="op" id="7828311">)</span><span class="op" id="7828312">;</span>&nbsp;<span class="ident" id="7828314">n</span>&nbsp;<span class="op" id="7828316">==</span>&nbsp;<span class="num" id="7828319">0</span>&nbsp;<span class="op" id="7828321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7828325">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7828333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828336">b</span>&nbsp;<span class="op" id="7828338">=</span>&nbsp;<span class="ident" id="7828340">b</span><span class="op" id="7828341">[</span><span class="op" id="7828342">:</span><span class="ident" id="7828343">n</span><span class="op" id="7828344">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828348">r</span><span class="op" id="7828349">.</span><span class="ident" id="7828350">Lock</span><span class="op" id="7828354">(</span><span class="op" id="7828355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7828358">defer</span>&nbsp;<span class="ident" id="7828364">r</span><span class="op" id="7828365">.</span><span class="ident" id="7828366">Unlock</span><span class="op" id="7828372">(</span><span class="op" id="7828373">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7828377">if</span>&nbsp;<span class="ident" id="7828380">l</span>&nbsp;<span class="op" id="7828382">:=</span>&nbsp;<span class="builtinfunc" id="7828385">len</span><span class="op" id="7828388">(</span><span class="ident" id="7828389">r</span><span class="op" id="7828390">.</span><span class="ident" id="7828391">flows</span><span class="op" id="7828396">)</span><span class="op" id="7828397">;</span>&nbsp;<span class="ident" id="7828399">l</span>&nbsp;<span class="op" id="7828401">==</span>&nbsp;<span class="num" id="7828404">0</span>&nbsp;<span class="op" id="7828406">||</span>&nbsp;<span class="op" id="7828409">!</span><span class="ident" id="7828410">r</span><span class="op" id="7828411">.</span><span class="ident" id="7828412">reading</span>&nbsp;<span class="op" id="7828420">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828424">buf</span>&nbsp;<span class="op" id="7828428">:=</span>&nbsp;<span class="builtinfunc" id="7828431">make</span><span class="op" id="7828435">(</span><span class="op" id="7828436">[</span><span class="op" id="7828437">]</span><span class="builtintype" id="7828438">byte</span><span class="op" id="7828442">,</span>&nbsp;<span class="builtinfunc" id="7828444">len</span><span class="op" id="7828447">(</span><span class="ident" id="7828448">b</span><span class="op" id="7828449">)</span><span class="op" id="7828450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7828454">copy</span><span class="op" id="7828458">(</span><span class="ident" id="7828459">buf</span><span class="op" id="7828462">,</span>&nbsp;<span class="ident" id="7828464">b</span><span class="op" id="7828465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828469">r</span><span class="op" id="7828470">.</span><span class="ident" id="7828471">flows</span>&nbsp;<span class="op" id="7828477">=</span>&nbsp;<span class="builtinfunc" id="7828479">append</span><span class="op" id="7828485">(</span><span class="ident" id="7828486">r</span><span class="op" id="7828487">.</span><span class="ident" id="7828488">flows</span><span class="op" id="7828493">,</span>&nbsp;<span class="ident" id="7828495">buf</span><span class="op" id="7828498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7828501">}</span>&nbsp;<span class="keyword" id="7828503">else</span>&nbsp;<span class="op" id="7828508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828512">r</span><span class="op" id="7828513">.</span><span class="ident" id="7828514">flows</span><span class="op" id="7828519">[</span><span class="ident" id="7828520">l</span><span class="op" id="7828521">-</span><span class="num" id="7828522">1</span><span class="op" id="7828523">]</span>&nbsp;<span class="op" id="7828525">=</span>&nbsp;<span class="builtinfunc" id="7828527">append</span><span class="op" id="7828533">(</span><span class="ident" id="7828534">r</span><span class="op" id="7828535">.</span><span class="ident" id="7828536">flows</span><span class="op" id="7828541">[</span><span class="ident" id="7828542">l</span><span class="op" id="7828543">-</span><span class="num" id="7828544">1</span><span class="op" id="7828545">]</span><span class="op" id="7828546">,</span>&nbsp;<span class="ident" id="7828548">b</span><span class="op" id="7828549">[</span><span class="op" id="7828550">:</span><span class="ident" id="7828551">n</span><span class="op" id="7828552">]</span><span class="op" id="7828553">...</span><span class="op" id="7828556">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7828559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828562">r</span><span class="op" id="7828563">.</span><span class="ident" id="7828564">reading</span>&nbsp;<span class="op" id="7828572">=</span>&nbsp;<span class="builtintype" id="7828574">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7828580">return</span><br>
<span class="lineno"></span><span class="op" id="7828587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="7828590">func</span>&nbsp;<span class="op" id="7828595">(</span><span class="ident" id="7828596">r</span>&nbsp;<span class="op" id="7828598">*</span><span class="ident" id="7828599">recordingConn</span><span class="op" id="7828612">)</span>&nbsp;<span class="ident" id="7828614">Write</span><span class="op" id="7828619">(</span><span class="ident" id="7828620">b</span>&nbsp;<span class="op" id="7828622">[</span><span class="op" id="7828623">]</span><span class="builtintype" id="7828624">byte</span><span class="op" id="7828628">)</span>&nbsp;<span class="op" id="7828630">(</span><span class="ident" id="7828631">n</span>&nbsp;<span class="builtintype" id="7828633">int</span><span class="op" id="7828636">,</span>&nbsp;<span class="ident" id="7828638">err</span>&nbsp;<span class="builtintype" id="7828642">error</span><span class="op" id="7828647">)</span>&nbsp;<span class="op" id="7828649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7828652">if</span>&nbsp;<span class="ident" id="7828655">n</span><span class="op" id="7828656">,</span>&nbsp;<span class="ident" id="7828658">err</span>&nbsp;<span class="op" id="7828662">=</span>&nbsp;<span class="ident" id="7828664">r</span><span class="op" id="7828665">.</span><span class="ident" id="7828666">Conn</span><span class="op" id="7828670">.</span><span class="ident" id="7828671">Write</span><span class="op" id="7828676">(</span><span class="ident" id="7828677">b</span><span class="op" id="7828678">)</span><span class="op" id="7828679">;</span>&nbsp;<span class="ident" id="7828681">n</span>&nbsp;<span class="op" id="7828683">==</span>&nbsp;<span class="num" id="7828686">0</span>&nbsp;<span class="op" id="7828688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7828692">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7828700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828703">b</span>&nbsp;<span class="op" id="7828705">=</span>&nbsp;<span class="ident" id="7828707">b</span><span class="op" id="7828708">[</span><span class="op" id="7828709">:</span><span class="ident" id="7828710">n</span><span class="op" id="7828711">]</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828715">r</span><span class="op" id="7828716">.</span><span class="ident" id="7828717">Lock</span><span class="op" id="7828721">(</span><span class="op" id="7828722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7828725">defer</span>&nbsp;<span class="ident" id="7828731">r</span><span class="op" id="7828732">.</span><span class="ident" id="7828733">Unlock</span><span class="op" id="7828739">(</span><span class="op" id="7828740">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7828744">if</span>&nbsp;<span class="ident" id="7828747">l</span>&nbsp;<span class="op" id="7828749">:=</span>&nbsp;<span class="builtinfunc" id="7828752">len</span><span class="op" id="7828755">(</span><span class="ident" id="7828756">r</span><span class="op" id="7828757">.</span><span class="ident" id="7828758">flows</span><span class="op" id="7828763">)</span><span class="op" id="7828764">;</span>&nbsp;<span class="ident" id="7828766">l</span>&nbsp;<span class="op" id="7828768">==</span>&nbsp;<span class="num" id="7828771">0</span>&nbsp;<span class="op" id="7828773">||</span>&nbsp;<span class="ident" id="7828776">r</span><span class="op" id="7828777">.</span><span class="ident" id="7828778">reading</span>&nbsp;<span class="op" id="7828786">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828790">buf</span>&nbsp;<span class="op" id="7828794">:=</span>&nbsp;<span class="builtinfunc" id="7828797">make</span><span class="op" id="7828801">(</span><span class="op" id="7828802">[</span><span class="op" id="7828803">]</span><span class="builtintype" id="7828804">byte</span><span class="op" id="7828808">,</span>&nbsp;<span class="builtinfunc" id="7828810">len</span><span class="op" id="7828813">(</span><span class="ident" id="7828814">b</span><span class="op" id="7828815">)</span><span class="op" id="7828816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7828820">copy</span><span class="op" id="7828824">(</span><span class="ident" id="7828825">buf</span><span class="op" id="7828828">,</span>&nbsp;<span class="ident" id="7828830">b</span><span class="op" id="7828831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828835">r</span><span class="op" id="7828836">.</span><span class="ident" id="7828837">flows</span>&nbsp;<span class="op" id="7828843">=</span>&nbsp;<span class="builtinfunc" id="7828845">append</span><span class="op" id="7828851">(</span><span class="ident" id="7828852">r</span><span class="op" id="7828853">.</span><span class="ident" id="7828854">flows</span><span class="op" id="7828859">,</span>&nbsp;<span class="ident" id="7828861">buf</span><span class="op" id="7828864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7828867">}</span>&nbsp;<span class="keyword" id="7828869">else</span>&nbsp;<span class="op" id="7828874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828878">r</span><span class="op" id="7828879">.</span><span class="ident" id="7828880">flows</span><span class="op" id="7828885">[</span><span class="ident" id="7828886">l</span><span class="op" id="7828887">-</span><span class="num" id="7828888">1</span><span class="op" id="7828889">]</span>&nbsp;<span class="op" id="7828891">=</span>&nbsp;<span class="builtinfunc" id="7828893">append</span><span class="op" id="7828899">(</span><span class="ident" id="7828900">r</span><span class="op" id="7828901">.</span><span class="ident" id="7828902">flows</span><span class="op" id="7828907">[</span><span class="ident" id="7828908">l</span><span class="op" id="7828909">-</span><span class="num" id="7828910">1</span><span class="op" id="7828911">]</span><span class="op" id="7828912">,</span>&nbsp;<span class="ident" id="7828914">b</span><span class="op" id="7828915">[</span><span class="op" id="7828916">:</span><span class="ident" id="7828917">n</span><span class="op" id="7828918">]</span><span class="op" id="7828919">...</span><span class="op" id="7828922">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7828925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7828928">r</span><span class="op" id="7828929">.</span><span class="ident" id="7828930">reading</span>&nbsp;<span class="op" id="7828938">=</span>&nbsp;<span class="builtintype" id="7828940">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7828947">return</span><br>
<span class="lineno"></span><span class="op" id="7828954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="7828957">//&nbsp;WriteTo&nbsp;writes&nbsp;Go&nbsp;source&nbsp;code&nbsp;to&nbsp;w&nbsp;that&nbsp;contains&nbsp;the&nbsp;recorded&nbsp;traffic.</span><br>
<span class="lineno"></span><span class="keyword" id="7829031">func</span>&nbsp;<span class="op" id="7829036">(</span><span class="ident" id="7829037">r</span>&nbsp;<span class="op" id="7829039">*</span><span class="ident" id="7829040">recordingConn</span><span class="op" id="7829053">)</span>&nbsp;<span class="ident" id="7829055">WriteTo</span><span class="op" id="7829062">(</span><span class="ident" id="7829063">w</span>&nbsp;<span class="ident" id="7829065">io</span><span class="op" id="7829067">.</span><span class="ident" id="7829068">Writer</span><span class="op" id="7829074">)</span>&nbsp;<span class="op" id="7829076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7829079">//&nbsp;TLS&nbsp;always&nbsp;starts&nbsp;with&nbsp;a&nbsp;client&nbsp;to&nbsp;server&nbsp;flow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7829131">clientToServer</span>&nbsp;<span class="op" id="7829146">:=</span>&nbsp;<span class="builtintype" id="7829149">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7829156">for</span>&nbsp;<span class="ident" id="7829160">i</span><span class="op" id="7829161">,</span>&nbsp;<span class="ident" id="7829163">flow</span>&nbsp;<span class="op" id="7829168">:=</span>&nbsp;<span class="keyword" id="7829171">range</span>&nbsp;<span class="ident" id="7829177">r</span><span class="op" id="7829178">.</span><span class="ident" id="7829179">flows</span>&nbsp;<span class="op" id="7829185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7829189">source</span><span class="op" id="7829195">,</span>&nbsp;<span class="ident" id="7829197">dest</span>&nbsp;<span class="op" id="7829202">:=</span>&nbsp;<span class="string" id="7829205">&#34;client&#34;</span><span class="op" id="7829213">,</span>&nbsp;<span class="string" id="7829215">&#34;server&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7829226">if</span>&nbsp;<span class="op" id="7829229">!</span><span class="ident" id="7829230">clientToServer</span>&nbsp;<span class="op" id="7829245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7829250">source</span><span class="op" id="7829256">,</span>&nbsp;<span class="ident" id="7829258">dest</span>&nbsp;<span class="op" id="7829263">=</span>&nbsp;<span class="ident" id="7829265">dest</span><span class="op" id="7829269">,</span>&nbsp;<span class="ident" id="7829271">source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7829280">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7829284">fmt</span><span class="op" id="7829287">.</span><span class="ident" id="7829288">Fprintf</span><span class="op" id="7829295">(</span><span class="ident" id="7829296">w</span><span class="op" id="7829297">,</span>&nbsp;<span class="string" id="7829299">&#34;&gt;&gt;&gt;&nbsp;Flow&nbsp;%d&nbsp;(%s&nbsp;to&nbsp;%s)\n&#34;</span><span class="op" id="7829325">,</span>&nbsp;<span class="ident" id="7829327">i</span><span class="op" id="7829328">+</span><span class="num" id="7829329">1</span><span class="op" id="7829330">,</span>&nbsp;<span class="ident" id="7829332">source</span><span class="op" id="7829338">,</span>&nbsp;<span class="ident" id="7829340">dest</span><span class="op" id="7829344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7829348">dumper</span>&nbsp;<span class="op" id="7829355">:=</span>&nbsp;<span class="ident" id="7829358">hex</span><span class="op" id="7829361">.</span><span class="ident" id="7829362">Dumper</span><span class="op" id="7829368">(</span><span class="ident" id="7829369">w</span><span class="op" id="7829370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7829374">dumper</span><span class="op" id="7829380">.</span><span class="ident" id="7829381">Write</span><span class="op" id="7829386">(</span><span class="ident" id="7829387">flow</span><span class="op" id="7829391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7829395">dumper</span><span class="op" id="7829401">.</span><span class="ident" id="7829402">Close</span><span class="op" id="7829407">(</span><span class="op" id="7829408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7829412">clientToServer</span>&nbsp;<span class="op" id="7829427">=</span>&nbsp;<span class="op" id="7829429">!</span><span class="ident" id="7829430">clientToServer</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7829446">}</span><br>
<span class="lineno"></span><span class="op" id="7829448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7829451">func</span>&nbsp;<span class="ident" id="7829456">parseTestData</span><span class="op" id="7829469">(</span><span class="ident" id="7829470">r</span>&nbsp;<span class="ident" id="7829472">io</span><span class="op" id="7829474">.</span><span class="ident" id="7829475">Reader</span><span class="op" id="7829481">)</span>&nbsp;<span class="op" id="7829483">(</span><span class="ident" id="7829484">flows</span>&nbsp;<span class="op" id="7829490">[</span><span class="op" id="7829491">]</span><span class="op" id="7829492">[</span><span class="op" id="7829493">]</span><span class="builtintype" id="7829494">byte</span><span class="op" id="7829498">,</span>&nbsp;<span class="ident" id="7829500">err</span>&nbsp;<span class="builtintype" id="7829504">error</span><span class="op" id="7829509">)</span>&nbsp;<span class="op" id="7829511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7829514">var</span>&nbsp;<span class="ident" id="7829518">currentFlow</span>&nbsp;<span class="op" id="7829530">[</span><span class="op" id="7829531">]</span><span class="builtintype" id="7829532">byte</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7829539">scanner</span>&nbsp;<span class="op" id="7829547">:=</span>&nbsp;<span class="ident" id="7829550">bufio</span><span class="op" id="7829555">.</span><span class="ident" id="7829556">NewScanner</span><span class="op" id="7829566">(</span><span class="ident" id="7829567">r</span><span class="op" id="7829568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7829571">for</span>&nbsp;<span class="ident" id="7829575">scanner</span><span class="op" id="7829582">.</span><span class="ident" id="7829583">Scan</span><span class="op" id="7829587">(</span><span class="op" id="7829588">)</span>&nbsp;<span class="op" id="7829590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7829594">line</span>&nbsp;<span class="op" id="7829599">:=</span>&nbsp;<span class="ident" id="7829602">scanner</span><span class="op" id="7829609">.</span><span class="ident" id="7829610">Text</span><span class="op" id="7829614">(</span><span class="op" id="7829615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7829619">//&nbsp;If&nbsp;the&nbsp;line&nbsp;starts&nbsp;with&nbsp;&#34;&gt;&gt;&gt;&nbsp;&#34;&nbsp;then&nbsp;it&nbsp;marks&nbsp;the&nbsp;beginning</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7829683">//&nbsp;of&nbsp;a&nbsp;new&nbsp;flow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7829703">if</span>&nbsp;<span class="ident" id="7829706">strings</span><span class="op" id="7829713">.</span><span class="ident" id="7829714">HasPrefix</span><span class="op" id="7829723">(</span><span class="ident" id="7829724">line</span><span class="op" id="7829728">,</span>&nbsp;<span class="string" id="7829730">&#34;&gt;&gt;&gt;&nbsp;&#34;</span><span class="op" id="7829736">)</span>&nbsp;<span class="op" id="7829738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7829743">if</span>&nbsp;<span class="builtinfunc" id="7829746">len</span><span class="op" id="7829749">(</span><span class="ident" id="7829750">currentFlow</span><span class="op" id="7829761">)</span>&nbsp;<span class="op" id="7829763">&gt;</span>&nbsp;<span class="num" id="7829765">0</span>&nbsp;<span class="op" id="7829767">||</span>&nbsp;<span class="builtinfunc" id="7829770">len</span><span class="op" id="7829773">(</span><span class="ident" id="7829774">flows</span><span class="op" id="7829779">)</span>&nbsp;<span class="op" id="7829781">&gt;</span>&nbsp;<span class="num" id="7829783">0</span>&nbsp;<span class="op" id="7829785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7829791">flows</span>&nbsp;<span class="op" id="7829797">=</span>&nbsp;<span class="builtinfunc" id="7829799">append</span><span class="op" id="7829805">(</span><span class="ident" id="7829806">flows</span><span class="op" id="7829811">,</span>&nbsp;<span class="ident" id="7829813">currentFlow</span><span class="op" id="7829824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7829830">currentFlow</span>&nbsp;<span class="op" id="7829842">=</span>&nbsp;<span class="builtintype" id="7829844">nil</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7829851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7829856">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7829867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7829872">//&nbsp;Otherwise&nbsp;the&nbsp;line&nbsp;is&nbsp;a&nbsp;line&nbsp;of&nbsp;hex&nbsp;dump&nbsp;that&nbsp;looks&nbsp;like:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7829935">//&nbsp;00000170&nbsp;&nbsp;fc&nbsp;f5&nbsp;06&nbsp;bf&nbsp;(...)&nbsp;&nbsp;|.....X{&amp;?......!|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7829988">//&nbsp;(Some&nbsp;bytes&nbsp;have&nbsp;been&nbsp;omitted&nbsp;from&nbsp;the&nbsp;middle&nbsp;section.)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7830050">if</span>&nbsp;<span class="ident" id="7830053">i</span>&nbsp;<span class="op" id="7830055">:=</span>&nbsp;<span class="ident" id="7830058">strings</span><span class="op" id="7830065">.</span><span class="ident" id="7830066">IndexByte</span><span class="op" id="7830075">(</span><span class="ident" id="7830076">line</span><span class="op" id="7830080">,</span>&nbsp;<span class="string" id="7830082">&#39;&nbsp;&#39;</span><span class="op" id="7830085">)</span><span class="op" id="7830086">;</span>&nbsp;<span class="ident" id="7830088">i</span>&nbsp;<span class="op" id="7830090">&gt;=</span>&nbsp;<span class="num" id="7830093">0</span>&nbsp;<span class="op" id="7830095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7830100">line</span>&nbsp;<span class="op" id="7830105">=</span>&nbsp;<span class="ident" id="7830107">line</span><span class="op" id="7830111">[</span><span class="ident" id="7830112">i</span><span class="op" id="7830113">:</span><span class="op" id="7830114">]</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7830118">}</span>&nbsp;<span class="keyword" id="7830120">else</span>&nbsp;<span class="op" id="7830125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7830130">return</span>&nbsp;<span class="builtintype" id="7830137">nil</span><span class="op" id="7830140">,</span>&nbsp;<span class="ident" id="7830142">errors</span><span class="op" id="7830148">.</span><span class="ident" id="7830149">New</span><span class="op" id="7830152">(</span><span class="string" id="7830153">&#34;invalid&nbsp;test&nbsp;data&#34;</span><span class="op" id="7830172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7830176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7830181">if</span>&nbsp;<span class="ident" id="7830184">i</span>&nbsp;<span class="op" id="7830186">:=</span>&nbsp;<span class="ident" id="7830189">strings</span><span class="op" id="7830196">.</span><span class="ident" id="7830197">IndexByte</span><span class="op" id="7830206">(</span><span class="ident" id="7830207">line</span><span class="op" id="7830211">,</span>&nbsp;<span class="string" id="7830213">&#39;|&#39;</span><span class="op" id="7830216">)</span><span class="op" id="7830217">;</span>&nbsp;<span class="ident" id="7830219">i</span>&nbsp;<span class="op" id="7830221">&gt;=</span>&nbsp;<span class="num" id="7830224">0</span>&nbsp;<span class="op" id="7830226">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7830231">line</span>&nbsp;<span class="op" id="7830236">=</span>&nbsp;<span class="ident" id="7830238">line</span><span class="op" id="7830242">[</span><span class="op" id="7830243">:</span><span class="ident" id="7830244">i</span><span class="op" id="7830245">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7830249">}</span>&nbsp;<span class="keyword" id="7830251">else</span>&nbsp;<span class="op" id="7830256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7830261">return</span>&nbsp;<span class="builtintype" id="7830268">nil</span><span class="op" id="7830271">,</span>&nbsp;<span class="ident" id="7830273">errors</span><span class="op" id="7830279">.</span><span class="ident" id="7830280">New</span><span class="op" id="7830283">(</span><span class="string" id="7830284">&#34;invalid&nbsp;test&nbsp;data&#34;</span><span class="op" id="7830303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7830307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7830312">hexBytes</span>&nbsp;<span class="op" id="7830321">:=</span>&nbsp;<span class="ident" id="7830324">strings</span><span class="op" id="7830331">.</span><span class="ident" id="7830332">Fields</span><span class="op" id="7830338">(</span><span class="ident" id="7830339">line</span><span class="op" id="7830343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7830347">for</span>&nbsp;<span class="ident" id="7830351">_</span><span class="op" id="7830352">,</span>&nbsp;<span class="ident" id="7830354">hexByte</span>&nbsp;<span class="op" id="7830362">:=</span>&nbsp;<span class="keyword" id="7830365">range</span>&nbsp;<span class="ident" id="7830371">hexBytes</span>&nbsp;<span class="op" id="7830380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7830385">val</span><span class="op" id="7830388">,</span>&nbsp;<span class="ident" id="7830390">err</span>&nbsp;<span class="op" id="7830394">:=</span>&nbsp;<span class="ident" id="7830397">strconv</span><span class="op" id="7830404">.</span><span class="ident" id="7830405">ParseUint</span><span class="op" id="7830414">(</span><span class="ident" id="7830415">hexByte</span><span class="op" id="7830422">,</span>&nbsp;<span class="num" id="7830424">16</span><span class="op" id="7830426">,</span>&nbsp;<span class="num" id="7830428">8</span><span class="op" id="7830429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7830434">if</span>&nbsp;<span class="ident" id="7830437">err</span>&nbsp;<span class="op" id="7830441">!=</span>&nbsp;<span class="builtintype" id="7830444">nil</span>&nbsp;<span class="op" id="7830448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7830454">return</span>&nbsp;<span class="builtintype" id="7830461">nil</span><span class="op" id="7830464">,</span>&nbsp;<span class="ident" id="7830466">errors</span><span class="op" id="7830472">.</span><span class="ident" id="7830473">New</span><span class="op" id="7830476">(</span><span class="string" id="7830477">&#34;invalid&nbsp;hex&nbsp;byte&nbsp;in&nbsp;test&nbsp;data:&nbsp;&#34;</span>&nbsp;<span class="op" id="7830511">+</span>&nbsp;<span class="ident" id="7830513">err</span><span class="op" id="7830516">.</span><span class="ident" id="7830517">Error</span><span class="op" id="7830522">(</span><span class="op" id="7830523">)</span><span class="op" id="7830524">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7830529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7830534">currentFlow</span>&nbsp;<span class="op" id="7830546">=</span>&nbsp;<span class="builtinfunc" id="7830548">append</span><span class="op" id="7830554">(</span><span class="ident" id="7830555">currentFlow</span><span class="op" id="7830566">,</span>&nbsp;<span class="builtintype" id="7830568">byte</span><span class="op" id="7830572">(</span><span class="ident" id="7830573">val</span><span class="op" id="7830576">)</span><span class="op" id="7830577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7830581">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7830584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7830588">if</span>&nbsp;<span class="builtinfunc" id="7830591">len</span><span class="op" id="7830594">(</span><span class="ident" id="7830595">currentFlow</span><span class="op" id="7830606">)</span>&nbsp;<span class="op" id="7830608">&gt;</span>&nbsp;<span class="num" id="7830610">0</span>&nbsp;<span class="op" id="7830612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7830616">flows</span>&nbsp;<span class="op" id="7830622">=</span>&nbsp;<span class="builtinfunc" id="7830624">append</span><span class="op" id="7830630">(</span><span class="ident" id="7830631">flows</span><span class="op" id="7830636">,</span>&nbsp;<span class="ident" id="7830638">currentFlow</span><span class="op" id="7830649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7830652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7830656">return</span>&nbsp;<span class="ident" id="7830663">flows</span><span class="op" id="7830668">,</span>&nbsp;<span class="builtintype" id="7830670">nil</span><br>
<span class="lineno">155</span><span class="op" id="7830674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7830677">//&nbsp;tempFile&nbsp;creates&nbsp;a&nbsp;temp&nbsp;file&nbsp;containing&nbsp;contents&nbsp;and&nbsp;returns&nbsp;its&nbsp;path.</span><br>
<span class="lineno"></span><span class="keyword" id="7830751">func</span>&nbsp;<span class="ident" id="7830756">tempFile</span><span class="op" id="7830764">(</span><span class="ident" id="7830765">contents</span>&nbsp;<span class="builtintype" id="7830774">string</span><span class="op" id="7830780">)</span>&nbsp;<span class="builtintype" id="7830782">string</span>&nbsp;<span class="op" id="7830789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7830792">file</span><span class="op" id="7830796">,</span>&nbsp;<span class="ident" id="7830798">err</span>&nbsp;<span class="op" id="7830802">:=</span>&nbsp;<span class="ident" id="7830805">ioutil</span><span class="op" id="7830811">.</span><span class="ident" id="7830812">TempFile</span><span class="op" id="7830820">(</span><span class="string" id="7830821">&#34;&#34;</span><span class="op" id="7830823">,</span>&nbsp;<span class="string" id="7830825">&#34;go-tls-test&#34;</span><span class="op" id="7830838">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7830841">if</span>&nbsp;<span class="ident" id="7830844">err</span>&nbsp;<span class="op" id="7830848">!=</span>&nbsp;<span class="builtintype" id="7830851">nil</span>&nbsp;<span class="op" id="7830855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7830859">panic</span><span class="op" id="7830864">(</span><span class="string" id="7830865">&#34;failed&nbsp;to&nbsp;create&nbsp;temp&nbsp;file:&nbsp;&#34;</span>&nbsp;<span class="op" id="7830896">+</span>&nbsp;<span class="ident" id="7830898">err</span><span class="op" id="7830901">.</span><span class="ident" id="7830902">Error</span><span class="op" id="7830907">(</span><span class="op" id="7830908">)</span><span class="op" id="7830909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7830912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7830915">path</span>&nbsp;<span class="op" id="7830920">:=</span>&nbsp;<span class="ident" id="7830923">file</span><span class="op" id="7830927">.</span><span class="ident" id="7830928">Name</span><span class="op" id="7830932">(</span><span class="op" id="7830933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7830936">file</span><span class="op" id="7830940">.</span><span class="ident" id="7830941">WriteString</span><span class="op" id="7830952">(</span><span class="ident" id="7830953">contents</span><span class="op" id="7830961">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7830964">file</span><span class="op" id="7830968">.</span><span class="ident" id="7830969">Close</span><span class="op" id="7830974">(</span><span class="op" id="7830975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7830978">return</span>&nbsp;<span class="ident" id="7830985">path</span><br>
<span class="lineno"></span><span class="op" id="7830990">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
