<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2348699">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2348754">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2348808">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2348859">package</span>&nbsp;<span class="ident" id="2348867">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2348871">import</span>&nbsp;<span class="op" id="2348878">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2348881">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2348887">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="2348897">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2348900">//&nbsp;MkdirAll&nbsp;creates&nbsp;a&nbsp;directory&nbsp;named&nbsp;path,</span><br>
<span class="lineno"></span><span class="comment" id="2348944">//&nbsp;along&nbsp;with&nbsp;any&nbsp;necessary&nbsp;parents,&nbsp;and&nbsp;returns&nbsp;nil,</span><br>
<span class="lineno"></span><span class="comment" id="2348998">//&nbsp;or&nbsp;else&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno">15</span><span class="comment" id="2349027">//&nbsp;The&nbsp;permission&nbsp;bits&nbsp;perm&nbsp;are&nbsp;used&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2349072">//&nbsp;directories&nbsp;that&nbsp;MkdirAll&nbsp;creates.</span><br>
<span class="lineno"></span><span class="comment" id="2349110">//&nbsp;If&nbsp;path&nbsp;is&nbsp;already&nbsp;a&nbsp;directory,&nbsp;MkdirAll&nbsp;does&nbsp;nothing</span><br>
<span class="lineno"></span><span class="comment" id="2349167">//&nbsp;and&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2349187">func</span>&nbsp;<span class="ident" id="2349192">MkdirAll</span><span class="op" id="2349200">(</span><span class="ident" id="2349201">path</span>&nbsp;<span class="builtintype" id="2349206">string</span><span class="op" id="2349212">,</span>&nbsp;<span class="ident" id="2349214">perm</span>&nbsp;<span class="ident" id="2349219">FileMode</span><span class="op" id="2349227">)</span>&nbsp;<span class="builtintype" id="2349229">error</span>&nbsp;<span class="op" id="2349235">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2349238">//&nbsp;Fast&nbsp;path:&nbsp;if&nbsp;we&nbsp;can&nbsp;tell&nbsp;whether&nbsp;path&nbsp;is&nbsp;a&nbsp;directory&nbsp;or&nbsp;file,&nbsp;stop&nbsp;with&nbsp;success&nbsp;or&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2349333">dir</span><span class="op" id="2349336">,</span>&nbsp;<span class="ident" id="2349338">err</span>&nbsp;<span class="op" id="2349342">:=</span>&nbsp;<span class="ident" id="2349345">Stat</span><span class="op" id="2349349">(</span><span class="ident" id="2349350">path</span><span class="op" id="2349354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349357">if</span>&nbsp;<span class="ident" id="2349360">err</span>&nbsp;<span class="op" id="2349364">==</span>&nbsp;<span class="ident" id="2349367">nil</span>&nbsp;<span class="op" id="2349371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349375">if</span>&nbsp;<span class="ident" id="2349378">dir</span><span class="op" id="2349381">.</span><span class="ident" id="2349382">IsDir</span><span class="op" id="2349387">(</span><span class="op" id="2349388">)</span>&nbsp;<span class="op" id="2349390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349395">return</span>&nbsp;<span class="ident" id="2349402">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349412">return</span>&nbsp;<span class="op" id="2349419">&amp;</span><span class="ident" id="2349420">PathError</span><span class="op" id="2349429">{</span><span class="string" id="2349430">&#34;mkdir&#34;</span><span class="op" id="2349437">,</span>&nbsp;<span class="ident" id="2349439">path</span><span class="op" id="2349443">,</span>&nbsp;<span class="ident" id="2349445">syscall</span><span class="op" id="2349452">.</span><span class="ident" id="2349453">ENOTDIR</span><span class="op" id="2349460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2349467">//&nbsp;Slow&nbsp;path:&nbsp;make&nbsp;sure&nbsp;parent&nbsp;exists&nbsp;and&nbsp;then&nbsp;call&nbsp;Mkdir&nbsp;for&nbsp;path.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2349536">i</span>&nbsp;<span class="op" id="2349538">:=</span>&nbsp;<span class="builtinfunc" id="2349541">len</span><span class="op" id="2349544">(</span><span class="ident" id="2349545">path</span><span class="op" id="2349549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349552">for</span>&nbsp;<span class="ident" id="2349556">i</span>&nbsp;<span class="op" id="2349558">&gt;</span>&nbsp;<span class="num" id="2349560">0</span>&nbsp;<span class="op" id="2349562">&amp;&amp;</span>&nbsp;<span class="ident" id="2349565">IsPathSeparator</span><span class="op" id="2349580">(</span><span class="ident" id="2349581">path</span><span class="op" id="2349585">[</span><span class="ident" id="2349586">i</span><span class="op" id="2349587">-</span><span class="num" id="2349588">1</span><span class="op" id="2349589">]</span><span class="op" id="2349590">)</span>&nbsp;<span class="op" id="2349592">{</span>&nbsp;<span class="comment" id="2349594">//&nbsp;Skip&nbsp;trailing&nbsp;path&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2349629">i</span><span class="op" id="2349630">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2349638">j</span>&nbsp;<span class="op" id="2349640">:=</span>&nbsp;<span class="ident" id="2349643">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349646">for</span>&nbsp;<span class="ident" id="2349650">j</span>&nbsp;<span class="op" id="2349652">&gt;</span>&nbsp;<span class="num" id="2349654">0</span>&nbsp;<span class="op" id="2349656">&amp;&amp;</span>&nbsp;<span class="op" id="2349659">!</span><span class="ident" id="2349660">IsPathSeparator</span><span class="op" id="2349675">(</span><span class="ident" id="2349676">path</span><span class="op" id="2349680">[</span><span class="ident" id="2349681">j</span><span class="op" id="2349682">-</span><span class="num" id="2349683">1</span><span class="op" id="2349684">]</span><span class="op" id="2349685">)</span>&nbsp;<span class="op" id="2349687">{</span>&nbsp;<span class="comment" id="2349689">//&nbsp;Scan&nbsp;backward&nbsp;over&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2349722">j</span><span class="op" id="2349723">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349731">if</span>&nbsp;<span class="ident" id="2349734">j</span>&nbsp;<span class="op" id="2349736">&gt;</span>&nbsp;<span class="num" id="2349738">1</span>&nbsp;<span class="op" id="2349740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2349744">//&nbsp;Create&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2349763">err</span>&nbsp;<span class="op" id="2349767">=</span>&nbsp;<span class="ident" id="2349769">MkdirAll</span><span class="op" id="2349777">(</span><span class="ident" id="2349778">path</span><span class="op" id="2349782">[</span><span class="num" id="2349783">0</span><span class="op" id="2349784">:</span><span class="ident" id="2349785">j</span><span class="op" id="2349786">-</span><span class="num" id="2349787">1</span><span class="op" id="2349788">]</span><span class="op" id="2349789">,</span>&nbsp;<span class="ident" id="2349791">perm</span><span class="op" id="2349795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349799">if</span>&nbsp;<span class="ident" id="2349802">err</span>&nbsp;<span class="op" id="2349806">!=</span>&nbsp;<span class="ident" id="2349809">nil</span>&nbsp;<span class="op" id="2349813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349818">return</span>&nbsp;<span class="ident" id="2349825">err</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2349834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2349838">//&nbsp;Parent&nbsp;now&nbsp;exists;&nbsp;invoke&nbsp;Mkdir&nbsp;and&nbsp;use&nbsp;its&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2349894">err</span>&nbsp;<span class="op" id="2349898">=</span>&nbsp;<span class="ident" id="2349900">Mkdir</span><span class="op" id="2349905">(</span><span class="ident" id="2349906">path</span><span class="op" id="2349910">,</span>&nbsp;<span class="ident" id="2349912">perm</span><span class="op" id="2349916">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2349919">if</span>&nbsp;<span class="ident" id="2349922">err</span>&nbsp;<span class="op" id="2349926">!=</span>&nbsp;<span class="ident" id="2349929">nil</span>&nbsp;<span class="op" id="2349933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2349937">//&nbsp;Handle&nbsp;arguments&nbsp;like&nbsp;&#34;foo/.&#34;&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2349975">//&nbsp;double-checking&nbsp;that&nbsp;directory&nbsp;doesn&#39;t&nbsp;exist.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2350026">dir</span><span class="op" id="2350029">,</span>&nbsp;<span class="ident" id="2350031">err1</span>&nbsp;<span class="op" id="2350036">:=</span>&nbsp;<span class="ident" id="2350039">Lstat</span><span class="op" id="2350044">(</span><span class="ident" id="2350045">path</span><span class="op" id="2350049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350053">if</span>&nbsp;<span class="ident" id="2350056">err1</span>&nbsp;<span class="op" id="2350061">==</span>&nbsp;<span class="ident" id="2350064">nil</span>&nbsp;<span class="op" id="2350068">&amp;&amp;</span>&nbsp;<span class="ident" id="2350071">dir</span><span class="op" id="2350074">.</span><span class="ident" id="2350075">IsDir</span><span class="op" id="2350080">(</span><span class="op" id="2350081">)</span>&nbsp;<span class="op" id="2350083">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350088">return</span>&nbsp;<span class="ident" id="2350095">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350105">return</span>&nbsp;<span class="ident" id="2350112">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350120">return</span>&nbsp;<span class="ident" id="2350127">nil</span><br>
<span class="lineno">60</span><span class="op" id="2350131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2350134">//&nbsp;RemoveAll&nbsp;removes&nbsp;path&nbsp;and&nbsp;any&nbsp;children&nbsp;it&nbsp;contains.</span><br>
<span class="lineno"></span><span class="comment" id="2350190">//&nbsp;It&nbsp;removes&nbsp;everything&nbsp;it&nbsp;can&nbsp;but&nbsp;returns&nbsp;the&nbsp;first&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2350250">//&nbsp;it&nbsp;encounters.&nbsp;&nbsp;If&nbsp;the&nbsp;path&nbsp;does&nbsp;not&nbsp;exist,&nbsp;RemoveAll</span><br>
<span class="lineno">65</span><span class="comment" id="2350307">//&nbsp;returns&nbsp;nil&nbsp;(no&nbsp;error).</span><br>
<span class="lineno"></span><span class="keyword" id="2350334">func</span>&nbsp;<span class="ident" id="2350339">RemoveAll</span><span class="op" id="2350348">(</span><span class="ident" id="2350349">path</span>&nbsp;<span class="builtintype" id="2350354">string</span><span class="op" id="2350360">)</span>&nbsp;<span class="builtintype" id="2350362">error</span>&nbsp;<span class="op" id="2350368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2350371">//&nbsp;Simple&nbsp;case:&nbsp;if&nbsp;Remove&nbsp;works,&nbsp;we&#39;re&nbsp;done.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2350417">err</span>&nbsp;<span class="op" id="2350421">:=</span>&nbsp;<span class="ident" id="2350424">Remove</span><span class="op" id="2350430">(</span><span class="ident" id="2350431">path</span><span class="op" id="2350435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350438">if</span>&nbsp;<span class="ident" id="2350441">err</span>&nbsp;<span class="op" id="2350445">==</span>&nbsp;<span class="ident" id="2350448">nil</span>&nbsp;<span class="op" id="2350452">||</span>&nbsp;<span class="ident" id="2350455">IsNotExist</span><span class="op" id="2350465">(</span><span class="ident" id="2350466">err</span><span class="op" id="2350469">)</span>&nbsp;<span class="op" id="2350471">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350475">return</span>&nbsp;<span class="ident" id="2350482">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2350491">//&nbsp;Otherwise,&nbsp;is&nbsp;this&nbsp;a&nbsp;directory&nbsp;we&nbsp;need&nbsp;to&nbsp;recurse&nbsp;into?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2350551">dir</span><span class="op" id="2350554">,</span>&nbsp;<span class="ident" id="2350556">serr</span>&nbsp;<span class="op" id="2350561">:=</span>&nbsp;<span class="ident" id="2350564">Lstat</span><span class="op" id="2350569">(</span><span class="ident" id="2350570">path</span><span class="op" id="2350574">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350577">if</span>&nbsp;<span class="ident" id="2350580">serr</span>&nbsp;<span class="op" id="2350585">!=</span>&nbsp;<span class="ident" id="2350588">nil</span>&nbsp;<span class="op" id="2350592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350596">if</span>&nbsp;<span class="ident" id="2350599">serr</span><span class="op" id="2350603">,</span>&nbsp;<span class="ident" id="2350605">ok</span>&nbsp;<span class="op" id="2350608">:=</span>&nbsp;<span class="ident" id="2350611">serr</span><span class="op" id="2350615">.</span><span class="op" id="2350616">(</span><span class="op" id="2350617">*</span><span class="ident" id="2350618">PathError</span><span class="op" id="2350627">)</span><span class="op" id="2350628">;</span>&nbsp;<span class="ident" id="2350630">ok</span>&nbsp;<span class="op" id="2350633">&amp;&amp;</span>&nbsp;<span class="op" id="2350636">(</span><span class="ident" id="2350637">IsNotExist</span><span class="op" id="2350647">(</span><span class="ident" id="2350648">serr</span><span class="op" id="2350652">.</span><span class="ident" id="2350653">Err</span><span class="op" id="2350656">)</span>&nbsp;<span class="op" id="2350658">||</span>&nbsp;<span class="ident" id="2350661">serr</span><span class="op" id="2350665">.</span><span class="ident" id="2350666">Err</span>&nbsp;<span class="op" id="2350670">==</span>&nbsp;<span class="ident" id="2350673">syscall</span><span class="op" id="2350680">.</span><span class="ident" id="2350681">ENOTDIR</span><span class="op" id="2350688">)</span>&nbsp;<span class="op" id="2350690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350695">return</span>&nbsp;<span class="ident" id="2350702">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350712">return</span>&nbsp;<span class="ident" id="2350719">serr</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350725">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350728">if</span>&nbsp;<span class="op" id="2350731">!</span><span class="ident" id="2350732">dir</span><span class="op" id="2350735">.</span><span class="ident" id="2350736">IsDir</span><span class="op" id="2350741">(</span><span class="op" id="2350742">)</span>&nbsp;<span class="op" id="2350744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2350748">//&nbsp;Not&nbsp;a&nbsp;directory;&nbsp;return&nbsp;the&nbsp;error&nbsp;from&nbsp;Remove.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350800">return</span>&nbsp;<span class="ident" id="2350807">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2350812">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2350816">//&nbsp;Directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2350831">fd</span><span class="op" id="2350833">,</span>&nbsp;<span class="ident" id="2350835">err</span>&nbsp;<span class="op" id="2350839">:=</span>&nbsp;<span class="ident" id="2350842">Open</span><span class="op" id="2350846">(</span><span class="ident" id="2350847">path</span><span class="op" id="2350851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350854">if</span>&nbsp;<span class="ident" id="2350857">err</span>&nbsp;<span class="op" id="2350861">!=</span>&nbsp;<span class="ident" id="2350864">nil</span>&nbsp;<span class="op" id="2350868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350872">if</span>&nbsp;<span class="ident" id="2350875">IsNotExist</span><span class="op" id="2350885">(</span><span class="ident" id="2350886">err</span><span class="op" id="2350889">)</span>&nbsp;<span class="op" id="2350891">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2350896">//&nbsp;Race.&nbsp;It&nbsp;was&nbsp;deleted&nbsp;between&nbsp;the&nbsp;Lstat&nbsp;and&nbsp;Open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2350951">//&nbsp;Return&nbsp;nil&nbsp;per&nbsp;RemoveAll&#39;s&nbsp;docs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2350990">return</span>&nbsp;<span class="ident" id="2350997">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351007">return</span>&nbsp;<span class="ident" id="2351014">err</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2351023">//&nbsp;Remove&nbsp;contents&nbsp;&amp;&nbsp;return&nbsp;first&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2351065">err</span>&nbsp;<span class="op" id="2351069">=</span>&nbsp;<span class="ident" id="2351071">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351076">for</span>&nbsp;<span class="op" id="2351080">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2351084">names</span><span class="op" id="2351089">,</span>&nbsp;<span class="ident" id="2351091">err1</span>&nbsp;<span class="op" id="2351096">:=</span>&nbsp;<span class="ident" id="2351099">fd</span><span class="op" id="2351101">.</span><span class="ident" id="2351102">Readdirnames</span><span class="op" id="2351114">(</span><span class="num" id="2351115">100</span><span class="op" id="2351118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351122">for</span>&nbsp;<span class="ident" id="2351126">_</span><span class="op" id="2351127">,</span>&nbsp;<span class="ident" id="2351129">name</span>&nbsp;<span class="op" id="2351134">:=</span>&nbsp;<span class="keyword" id="2351137">range</span>&nbsp;<span class="ident" id="2351143">names</span>&nbsp;<span class="op" id="2351149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2351154">err1</span>&nbsp;<span class="op" id="2351159">:=</span>&nbsp;<span class="ident" id="2351162">RemoveAll</span><span class="op" id="2351171">(</span><span class="ident" id="2351172">path</span>&nbsp;<span class="op" id="2351177">+</span>&nbsp;<span class="builtintype" id="2351179">string</span><span class="op" id="2351185">(</span><span class="ident" id="2351186">PathSeparator</span><span class="op" id="2351199">)</span>&nbsp;<span class="op" id="2351201">+</span>&nbsp;<span class="ident" id="2351203">name</span><span class="op" id="2351207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351212">if</span>&nbsp;<span class="ident" id="2351215">err</span>&nbsp;<span class="op" id="2351219">==</span>&nbsp;<span class="ident" id="2351222">nil</span>&nbsp;<span class="op" id="2351226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2351232">err</span>&nbsp;<span class="op" id="2351236">=</span>&nbsp;<span class="ident" id="2351238">err1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351254">if</span>&nbsp;<span class="ident" id="2351257">err1</span>&nbsp;<span class="op" id="2351262">==</span>&nbsp;<span class="ident" id="2351265">io</span><span class="op" id="2351267">.</span><span class="ident" id="2351268">EOF</span>&nbsp;<span class="op" id="2351272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351277">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351285">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2351289">//&nbsp;If&nbsp;Readdirnames&nbsp;returned&nbsp;an&nbsp;error,&nbsp;use&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351337">if</span>&nbsp;<span class="ident" id="2351340">err</span>&nbsp;<span class="op" id="2351344">==</span>&nbsp;<span class="ident" id="2351347">nil</span>&nbsp;<span class="op" id="2351351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2351356">err</span>&nbsp;<span class="op" id="2351360">=</span>&nbsp;<span class="ident" id="2351362">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351373">if</span>&nbsp;<span class="builtinfunc" id="2351376">len</span><span class="op" id="2351379">(</span><span class="ident" id="2351380">names</span><span class="op" id="2351385">)</span>&nbsp;<span class="op" id="2351387">==</span>&nbsp;<span class="num" id="2351390">0</span>&nbsp;<span class="op" id="2351392">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351397">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2351412">//&nbsp;Close&nbsp;directory,&nbsp;because&nbsp;windows&nbsp;won&#39;t&nbsp;remove&nbsp;opened&nbsp;directory.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2351480">fd</span><span class="op" id="2351482">.</span><span class="ident" id="2351483">Close</span><span class="op" id="2351488">(</span><span class="op" id="2351489">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2351493">//&nbsp;Remove&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2351515">err1</span>&nbsp;<span class="op" id="2351520">:=</span>&nbsp;<span class="ident" id="2351523">Remove</span><span class="op" id="2351529">(</span><span class="ident" id="2351530">path</span><span class="op" id="2351534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351537">if</span>&nbsp;<span class="ident" id="2351540">err1</span>&nbsp;<span class="op" id="2351545">==</span>&nbsp;<span class="ident" id="2351548">nil</span>&nbsp;<span class="op" id="2351552">||</span>&nbsp;<span class="ident" id="2351555">IsNotExist</span><span class="op" id="2351565">(</span><span class="ident" id="2351566">err1</span><span class="op" id="2351570">)</span>&nbsp;<span class="op" id="2351572">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351576">return</span>&nbsp;<span class="ident" id="2351583">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351591">if</span>&nbsp;<span class="ident" id="2351594">err</span>&nbsp;<span class="op" id="2351598">==</span>&nbsp;<span class="ident" id="2351601">nil</span>&nbsp;<span class="op" id="2351605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2351609">err</span>&nbsp;<span class="op" id="2351613">=</span>&nbsp;<span class="ident" id="2351615">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2351621">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2351624">return</span>&nbsp;<span class="ident" id="2351631">err</span><br>
<span class="lineno"></span><span class="op" id="2351635">}</span>
</div>
</body>
</html>
