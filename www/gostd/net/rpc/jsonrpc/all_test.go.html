<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/rpc/jsonrpc</h2>
<ul>
<li><a href="/gostd/net/rpc/jsonrpc/all_test.go.html" class="current">all_test.go</a></li>
<li><a href="/gostd/net/rpc/jsonrpc/client.go.html">client.go</a></li>
<li><a href="/gostd/net/rpc/jsonrpc/server.go.html">server.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8334449">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8334505">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8334559">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8334610">package</span>&nbsp;<span class="ident" id="8334618">jsonrpc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8334627">import</span>&nbsp;<span class="op" id="8334634">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8334637">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8334646">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8334663">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8334673">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8334680">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8334686">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8334699">&#34;net&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8334706">&#34;net/rpc&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8334717">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8334728">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8334738">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8334741">type</span>&nbsp;<span class="ident" id="8334746">Args</span>&nbsp;<span class="keyword" id="8334751">struct</span>&nbsp;<span class="op" id="8334758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8334761">A</span><span class="op" id="8334762">,</span>&nbsp;<span class="ident" id="8334764">B</span>&nbsp;<span class="builtintype" id="8334766">int</span><br>
<span class="lineno"></span><span class="op" id="8334770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8334773">type</span>&nbsp;<span class="ident" id="8334778">Reply</span>&nbsp;<span class="keyword" id="8334784">struct</span>&nbsp;<span class="op" id="8334791">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8334794">C</span>&nbsp;<span class="builtintype" id="8334796">int</span><br>
<span class="lineno"></span><span class="op" id="8334800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8334803">type</span>&nbsp;<span class="ident" id="8334808">Arith</span>&nbsp;<span class="builtintype" id="8334814">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="8334819">type</span>&nbsp;<span class="ident" id="8334824">ArithAddResp</span>&nbsp;<span class="keyword" id="8334837">struct</span>&nbsp;<span class="op" id="8334844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8334847">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8334854">interface</span><span class="op" id="8334863">{</span><span class="op" id="8334864">}</span>&nbsp;<span class="string" id="8334866">`json:&#34;id&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8334879">Result</span>&nbsp;<span class="ident" id="8334886"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334778">Reply</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8334898">`json:&#34;result&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8334915">Error</span>&nbsp;&nbsp;<span class="keyword" id="8334922">interface</span><span class="op" id="8334931">{</span><span class="op" id="8334932">}</span>&nbsp;<span class="string" id="8334934">`json:&#34;error&#34;`</span><br>
<span class="lineno"></span><span class="op" id="8334949">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="8334952">func</span>&nbsp;<span class="op" id="8334957">(</span><span class="ident" id="8334958">t</span>&nbsp;<span class="op" id="8334960">*</span><span class="ident" id="8334961"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334808">Arith</a></span><span class="op" id="8334966">)</span>&nbsp;<span class="ident" id="8334968">Add</span><span class="op" id="8334971">(</span><span class="ident" id="8334972">args</span>&nbsp;<span class="op" id="8334977">*</span><span class="ident" id="8334978"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334746">Args</a></span><span class="op" id="8334982">,</span>&nbsp;<span class="ident" id="8334984">reply</span>&nbsp;<span class="op" id="8334990">*</span><span class="ident" id="8334991"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334778">Reply</a></span><span class="op" id="8334996">)</span>&nbsp;<span class="builtintype" id="8334998">error</span>&nbsp;<span class="op" id="8335004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8335007"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334984">reply</a></span><span class="op" id="8335012">.</span><span class="ident" id="8335013"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span>&nbsp;<span class="op" id="8335015">=</span>&nbsp;<span class="ident" id="8335017"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334972">args</a></span><span class="op" id="8335021">.</span><span class="ident" id="8335022"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334761">A</a></span>&nbsp;<span class="op" id="8335024">+</span>&nbsp;<span class="ident" id="8335026"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334972">args</a></span><span class="op" id="8335030">.</span><span class="ident" id="8335031"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334764">B</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335034">return</span>&nbsp;<span class="builtintype" id="8335041">nil</span><br>
<span class="lineno"></span><span class="op" id="8335045">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="8335048">func</span>&nbsp;<span class="op" id="8335053">(</span><span class="ident" id="8335054">t</span>&nbsp;<span class="op" id="8335056">*</span><span class="ident" id="8335057"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334808">Arith</a></span><span class="op" id="8335062">)</span>&nbsp;<span class="ident" id="8335064">Mul</span><span class="op" id="8335067">(</span><span class="ident" id="8335068">args</span>&nbsp;<span class="op" id="8335073">*</span><span class="ident" id="8335074"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334746">Args</a></span><span class="op" id="8335078">,</span>&nbsp;<span class="ident" id="8335080">reply</span>&nbsp;<span class="op" id="8335086">*</span><span class="ident" id="8335087"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334778">Reply</a></span><span class="op" id="8335092">)</span>&nbsp;<span class="builtintype" id="8335094">error</span>&nbsp;<span class="op" id="8335100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8335103"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335080">reply</a></span><span class="op" id="8335108">.</span><span class="ident" id="8335109"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span>&nbsp;<span class="op" id="8335111">=</span>&nbsp;<span class="ident" id="8335113"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335068">args</a></span><span class="op" id="8335117">.</span><span class="ident" id="8335118"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334761">A</a></span>&nbsp;<span class="op" id="8335120">*</span>&nbsp;<span class="ident" id="8335122"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335068">args</a></span><span class="op" id="8335126">.</span><span class="ident" id="8335127"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334764">B</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335130">return</span>&nbsp;<span class="builtintype" id="8335137">nil</span><br>
<span class="lineno"></span><span class="op" id="8335141">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8335144">func</span>&nbsp;<span class="op" id="8335149">(</span><span class="ident" id="8335150">t</span>&nbsp;<span class="op" id="8335152">*</span><span class="ident" id="8335153"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334808">Arith</a></span><span class="op" id="8335158">)</span>&nbsp;<span class="ident" id="8335160">Div</span><span class="op" id="8335163">(</span><span class="ident" id="8335164">args</span>&nbsp;<span class="op" id="8335169">*</span><span class="ident" id="8335170"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334746">Args</a></span><span class="op" id="8335174">,</span>&nbsp;<span class="ident" id="8335176">reply</span>&nbsp;<span class="op" id="8335182">*</span><span class="ident" id="8335183"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334778">Reply</a></span><span class="op" id="8335188">)</span>&nbsp;<span class="builtintype" id="8335190">error</span>&nbsp;<span class="op" id="8335196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335199">if</span>&nbsp;<span class="ident" id="8335202"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335164">args</a></span><span class="op" id="8335206">.</span><span class="ident" id="8335207"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334764">B</a></span>&nbsp;<span class="op" id="8335209">==</span>&nbsp;<span class="num" id="8335212">0</span>&nbsp;<span class="op" id="8335214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335218">return</span>&nbsp;<span class="ident" id="8335225"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334663">errors</a></span><span class="op" id="8335231">.</span><span class="ident" id="8335232"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="8335235">(</span><span class="string" id="8335236">&#34;divide&nbsp;by&nbsp;zero&#34;</span><span class="op" id="8335252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8335255">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8335258"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335176">reply</a></span><span class="op" id="8335263">.</span><span class="ident" id="8335264"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span>&nbsp;<span class="op" id="8335266">=</span>&nbsp;<span class="ident" id="8335268"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335164">args</a></span><span class="op" id="8335272">.</span><span class="ident" id="8335273"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334761">A</a></span>&nbsp;<span class="op" id="8335275">/</span>&nbsp;<span class="ident" id="8335277"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335164">args</a></span><span class="op" id="8335281">.</span><span class="ident" id="8335282"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334764">B</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335285">return</span>&nbsp;<span class="builtintype" id="8335292">nil</span><br>
<span class="lineno"></span><span class="op" id="8335296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8335299">func</span>&nbsp;<span class="op" id="8335304">(</span><span class="ident" id="8335305">t</span>&nbsp;<span class="op" id="8335307">*</span><span class="ident" id="8335308"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334808">Arith</a></span><span class="op" id="8335313">)</span>&nbsp;<span class="ident" id="8335315">Error</span><span class="op" id="8335320">(</span><span class="ident" id="8335321">args</span>&nbsp;<span class="op" id="8335326">*</span><span class="ident" id="8335327"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334746">Args</a></span><span class="op" id="8335331">,</span>&nbsp;<span class="ident" id="8335333">reply</span>&nbsp;<span class="op" id="8335339">*</span><span class="ident" id="8335340"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334778">Reply</a></span><span class="op" id="8335345">)</span>&nbsp;<span class="builtintype" id="8335347">error</span>&nbsp;<span class="op" id="8335353">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8335356">panic</span><span class="op" id="8335361">(</span><span class="string" id="8335362">&#34;ERROR&#34;</span><span class="op" id="8335369">)</span><br>
<span class="lineno"></span><span class="op" id="8335371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8335374">func</span>&nbsp;<span class="ident" id="8335379">init</span><span class="op" id="8335383">(</span><span class="op" id="8335384">)</span>&nbsp;<span class="op" id="8335386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8335389"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334706">rpc</a></span><span class="op" id="8335392">.</span><span class="ident" id="8335393"><a href="/gostd/net/rpc/server.go.html#5290520">Register</a></span><span class="op" id="8335401">(</span><span class="builtinfunc" id="8335402">new</span><span class="op" id="8335405">(</span><span class="ident" id="8335406"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334808">Arith</a></span><span class="op" id="8335411">)</span><span class="op" id="8335412">)</span><br>
<span class="lineno">60</span><span class="op" id="8335414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8335417">func</span>&nbsp;<span class="ident" id="8335422">TestServerNoParams</span><span class="op" id="8335440">(</span><span class="ident" id="8335441">t</span>&nbsp;<span class="op" id="8335443">*</span><span class="ident" id="8335444"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334728">testing</a></span><span class="op" id="8335451">.</span><span class="ident" id="8335452"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8335453">)</span>&nbsp;<span class="op" id="8335455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8335458">cli</span><span class="op" id="8335461">,</span>&nbsp;<span class="ident" id="8335463">srv</span>&nbsp;<span class="op" id="8335467">:=</span>&nbsp;<span class="ident" id="8335470"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334699">net</a></span><span class="op" id="8335473">.</span><span class="ident" id="8335474"><a href="/gostd/net/pipe.go.html#3349719">Pipe</a></span><span class="op" id="8335478">(</span><span class="op" id="8335479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335482">defer</span>&nbsp;<span class="ident" id="8335488"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335458">cli</a></span><span class="op" id="8335491">.</span><span class="ident" id="8335492"><a href="/gostd/net/net.go.html#3334987">Close</a></span><span class="op" id="8335497">(</span><span class="op" id="8335498">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335501">go</span>&nbsp;<span class="ident" id="8335504"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6146522">ServeConn</a></span><span class="op" id="8335513">(</span><span class="ident" id="8335514"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335463">srv</a></span><span class="op" id="8335517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8335520">dec</span>&nbsp;<span class="op" id="8335524">:=</span>&nbsp;<span class="ident" id="8335527"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334646">json</a></span><span class="op" id="8335531">.</span><span class="ident" id="8335532"><a href="/gostd/encoding/json/stream.go.html#4044448">NewDecoder</a></span><span class="op" id="8335542">(</span><span class="ident" id="8335543"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335458">cli</a></span><span class="op" id="8335546">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8335550"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334673">fmt</a></span><span class="op" id="8335553">.</span><span class="ident" id="8335554"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="8335561">(</span><span class="ident" id="8335562"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335458">cli</a></span><span class="op" id="8335565">,</span>&nbsp;<span class="string" id="8335567">`{&#34;method&#34;:&nbsp;&#34;Arith.Add&#34;,&nbsp;&#34;id&#34;:&nbsp;&#34;123&#34;}`</span><span class="op" id="8335605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335608">var</span>&nbsp;<span class="ident" id="8335612">resp</span>&nbsp;<span class="ident" id="8335617"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334824">ArithAddResp</a></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335631">if</span>&nbsp;<span class="ident" id="8335634">err</span>&nbsp;<span class="op" id="8335638">:=</span>&nbsp;<span class="ident" id="8335641"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335520">dec</a></span><span class="op" id="8335644">.</span><span class="ident" id="8335645"><a href="/gostd/encoding/json/stream.go.html#4044912">Decode</a></span><span class="op" id="8335651">(</span><span class="op" id="8335652">&amp;</span><span class="ident" id="8335653"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335612">resp</a></span><span class="op" id="8335657">)</span><span class="op" id="8335658">;</span>&nbsp;<span class="ident" id="8335660"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335634">err</a></span>&nbsp;<span class="op" id="8335664">!=</span>&nbsp;<span class="builtintype" id="8335667">nil</span>&nbsp;<span class="op" id="8335671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8335675"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335441">t</a></span><span class="op" id="8335676">.</span><span class="ident" id="8335677"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8335683">(</span><span class="string" id="8335684">&#34;Decode&nbsp;after&nbsp;no&nbsp;params:&nbsp;%s&#34;</span><span class="op" id="8335712">,</span>&nbsp;<span class="ident" id="8335714"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335634">err</a></span><span class="op" id="8335717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8335720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335723">if</span>&nbsp;<span class="ident" id="8335726"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335612">resp</a></span><span class="op" id="8335730">.</span><span class="ident" id="8335731"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334915">Error</a></span>&nbsp;<span class="op" id="8335737">==</span>&nbsp;<span class="builtintype" id="8335740">nil</span>&nbsp;<span class="op" id="8335744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8335748"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335441">t</a></span><span class="op" id="8335749">.</span><span class="ident" id="8335750"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8335756">(</span><span class="string" id="8335757">&#34;Expected&nbsp;error,&nbsp;got&nbsp;nil&#34;</span><span class="op" id="8335782">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8335785">}</span><br>
<span class="lineno"></span><span class="op" id="8335787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8335790">func</span>&nbsp;<span class="ident" id="8335795">TestServerEmptyMessage</span><span class="op" id="8335817">(</span><span class="ident" id="8335818">t</span>&nbsp;<span class="op" id="8335820">*</span><span class="ident" id="8335821"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334728">testing</a></span><span class="op" id="8335828">.</span><span class="ident" id="8335829"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8335830">)</span>&nbsp;<span class="op" id="8335832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8335835">cli</span><span class="op" id="8335838">,</span>&nbsp;<span class="ident" id="8335840">srv</span>&nbsp;<span class="op" id="8335844">:=</span>&nbsp;<span class="ident" id="8335847"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334699">net</a></span><span class="op" id="8335850">.</span><span class="ident" id="8335851"><a href="/gostd/net/pipe.go.html#3349719">Pipe</a></span><span class="op" id="8335855">(</span><span class="op" id="8335856">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335859">defer</span>&nbsp;<span class="ident" id="8335865"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335835">cli</a></span><span class="op" id="8335868">.</span><span class="ident" id="8335869"><a href="/gostd/net/net.go.html#3334987">Close</a></span><span class="op" id="8335874">(</span><span class="op" id="8335875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335878">go</span>&nbsp;<span class="ident" id="8335881"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6146522">ServeConn</a></span><span class="op" id="8335890">(</span><span class="ident" id="8335891"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335840">srv</a></span><span class="op" id="8335894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8335897">dec</span>&nbsp;<span class="op" id="8335901">:=</span>&nbsp;<span class="ident" id="8335904"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334646">json</a></span><span class="op" id="8335908">.</span><span class="ident" id="8335909"><a href="/gostd/encoding/json/stream.go.html#4044448">NewDecoder</a></span><span class="op" id="8335919">(</span><span class="ident" id="8335920"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335835">cli</a></span><span class="op" id="8335923">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8335927"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334673">fmt</a></span><span class="op" id="8335930">.</span><span class="ident" id="8335931"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="8335938">(</span><span class="ident" id="8335939"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335835">cli</a></span><span class="op" id="8335942">,</span>&nbsp;<span class="string" id="8335944">&#34;{}&#34;</span><span class="op" id="8335948">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335951">var</span>&nbsp;<span class="ident" id="8335955">resp</span>&nbsp;<span class="ident" id="8335960"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334824">ArithAddResp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8335974">if</span>&nbsp;<span class="ident" id="8335977">err</span>&nbsp;<span class="op" id="8335981">:=</span>&nbsp;<span class="ident" id="8335984"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335897">dec</a></span><span class="op" id="8335987">.</span><span class="ident" id="8335988"><a href="/gostd/encoding/json/stream.go.html#4044912">Decode</a></span><span class="op" id="8335994">(</span><span class="op" id="8335995">&amp;</span><span class="ident" id="8335996"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335955">resp</a></span><span class="op" id="8336000">)</span><span class="op" id="8336001">;</span>&nbsp;<span class="ident" id="8336003"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335977">err</a></span>&nbsp;<span class="op" id="8336007">!=</span>&nbsp;<span class="builtintype" id="8336010">nil</span>&nbsp;<span class="op" id="8336014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8336018"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335818">t</a></span><span class="op" id="8336019">.</span><span class="ident" id="8336020"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8336026">(</span><span class="string" id="8336027">&#34;Decode&nbsp;after&nbsp;empty:&nbsp;%s&#34;</span><span class="op" id="8336051">,</span>&nbsp;<span class="ident" id="8336053"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335977">err</a></span><span class="op" id="8336056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8336059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8336062">if</span>&nbsp;<span class="ident" id="8336065"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335955">resp</a></span><span class="op" id="8336069">.</span><span class="ident" id="8336070"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334915">Error</a></span>&nbsp;<span class="op" id="8336076">==</span>&nbsp;<span class="builtintype" id="8336079">nil</span>&nbsp;<span class="op" id="8336083">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8336087"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8335818">t</a></span><span class="op" id="8336088">.</span><span class="ident" id="8336089"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8336095">(</span><span class="string" id="8336096">&#34;Expected&nbsp;error,&nbsp;got&nbsp;nil&#34;</span><span class="op" id="8336121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8336124">}</span><br>
<span class="lineno"></span><span class="op" id="8336126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8336129">func</span>&nbsp;<span class="ident" id="8336134">TestServer</span><span class="op" id="8336144">(</span><span class="ident" id="8336145">t</span>&nbsp;<span class="op" id="8336147">*</span><span class="ident" id="8336148"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334728">testing</a></span><span class="op" id="8336155">.</span><span class="ident" id="8336156"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8336157">)</span>&nbsp;<span class="op" id="8336159">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8336162">cli</span><span class="op" id="8336165">,</span>&nbsp;<span class="ident" id="8336167">srv</span>&nbsp;<span class="op" id="8336171">:=</span>&nbsp;<span class="ident" id="8336174"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334699">net</a></span><span class="op" id="8336177">.</span><span class="ident" id="8336178"><a href="/gostd/net/pipe.go.html#3349719">Pipe</a></span><span class="op" id="8336182">(</span><span class="op" id="8336183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8336186">defer</span>&nbsp;<span class="ident" id="8336192"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336162">cli</a></span><span class="op" id="8336195">.</span><span class="ident" id="8336196"><a href="/gostd/net/net.go.html#3334987">Close</a></span><span class="op" id="8336201">(</span><span class="op" id="8336202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8336205">go</span>&nbsp;<span class="ident" id="8336208"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6146522">ServeConn</a></span><span class="op" id="8336217">(</span><span class="ident" id="8336218"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336167">srv</a></span><span class="op" id="8336221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8336224">dec</span>&nbsp;<span class="op" id="8336228">:=</span>&nbsp;<span class="ident" id="8336231"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334646">json</a></span><span class="op" id="8336235">.</span><span class="ident" id="8336236"><a href="/gostd/encoding/json/stream.go.html#4044448">NewDecoder</a></span><span class="op" id="8336246">(</span><span class="ident" id="8336247"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336162">cli</a></span><span class="op" id="8336250">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8336254">//&nbsp;Send&nbsp;hand-coded&nbsp;requests&nbsp;to&nbsp;server,&nbsp;parse&nbsp;responses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8336311">for</span>&nbsp;<span class="ident" id="8336315">i</span>&nbsp;<span class="op" id="8336317">:=</span>&nbsp;<span class="num" id="8336320">0</span><span class="op" id="8336321">;</span>&nbsp;<span class="ident" id="8336323"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336315">i</a></span>&nbsp;<span class="op" id="8336325">&lt;</span>&nbsp;<span class="num" id="8336327">10</span><span class="op" id="8336329">;</span>&nbsp;<span class="ident" id="8336331"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336315">i</a></span><span class="op" id="8336332">++</span>&nbsp;<span class="op" id="8336335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8336339"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334673">fmt</a></span><span class="op" id="8336342">.</span><span class="ident" id="8336343"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="8336350">(</span><span class="ident" id="8336351"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336162">cli</a></span><span class="op" id="8336354">,</span>&nbsp;<span class="string" id="8336356">`{&#34;method&#34;:&nbsp;&#34;Arith.Add&#34;,&nbsp;&#34;id&#34;:&nbsp;&#34;\u%04d&#34;,&nbsp;&#34;params&#34;:&nbsp;[{&#34;A&#34;:&nbsp;%d,&nbsp;&#34;B&#34;:&nbsp;%d}]}`</span><span class="op" id="8336429">,</span>&nbsp;<span class="ident" id="8336431"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336315">i</a></span><span class="op" id="8336432">,</span>&nbsp;<span class="ident" id="8336434"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336315">i</a></span><span class="op" id="8336435">,</span>&nbsp;<span class="ident" id="8336437"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336315">i</a></span><span class="op" id="8336438">+</span><span class="num" id="8336439">1</span><span class="op" id="8336440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8336444">var</span>&nbsp;<span class="ident" id="8336448">resp</span>&nbsp;<span class="ident" id="8336453"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334824">ArithAddResp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8336468">err</span>&nbsp;<span class="op" id="8336472">:=</span>&nbsp;<span class="ident" id="8336475"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336224">dec</a></span><span class="op" id="8336478">.</span><span class="ident" id="8336479"><a href="/gostd/encoding/json/stream.go.html#4044912">Decode</a></span><span class="op" id="8336485">(</span><span class="op" id="8336486">&amp;</span><span class="ident" id="8336487"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336448">resp</a></span><span class="op" id="8336491">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8336495">if</span>&nbsp;<span class="ident" id="8336498"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336468">err</a></span>&nbsp;<span class="op" id="8336502">!=</span>&nbsp;<span class="builtintype" id="8336505">nil</span>&nbsp;<span class="op" id="8336509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8336514"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336145">t</a></span><span class="op" id="8336515">.</span><span class="ident" id="8336516"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8336522">(</span><span class="string" id="8336523">&#34;Decode:&nbsp;%s&#34;</span><span class="op" id="8336535">,</span>&nbsp;<span class="ident" id="8336537"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336468">err</a></span><span class="op" id="8336540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8336544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8336548">if</span>&nbsp;<span class="ident" id="8336551"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336448">resp</a></span><span class="op" id="8336555">.</span><span class="ident" id="8336556"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334915">Error</a></span>&nbsp;<span class="op" id="8336562">!=</span>&nbsp;<span class="builtintype" id="8336565">nil</span>&nbsp;<span class="op" id="8336569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8336574"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336145">t</a></span><span class="op" id="8336575">.</span><span class="ident" id="8336576"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8336582">(</span><span class="string" id="8336583">&#34;resp.Error:&nbsp;%s&#34;</span><span class="op" id="8336599">,</span>&nbsp;<span class="ident" id="8336601"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336448">resp</a></span><span class="op" id="8336605">.</span><span class="ident" id="8336606"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334915">Error</a></span><span class="op" id="8336611">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8336615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8336619">if</span>&nbsp;<span class="ident" id="8336622"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336448">resp</a></span><span class="op" id="8336626">.</span><span class="ident" id="8336627"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334847">Id</a></span><span class="op" id="8336629">.</span><span class="op" id="8336630">(</span><span class="builtintype" id="8336631">string</span><span class="op" id="8336637">)</span>&nbsp;<span class="op" id="8336639">!=</span>&nbsp;<span class="builtintype" id="8336642">string</span><span class="op" id="8336648">(</span><span class="ident" id="8336649"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336315">i</a></span><span class="op" id="8336650">)</span>&nbsp;<span class="op" id="8336652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8336657"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336145">t</a></span><span class="op" id="8336658">.</span><span class="ident" id="8336659"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8336665">(</span><span class="string" id="8336666">&#34;resp:&nbsp;bad&nbsp;id&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8336691">,</span>&nbsp;<span class="ident" id="8336693"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336448">resp</a></span><span class="op" id="8336697">.</span><span class="ident" id="8336698"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334847">Id</a></span><span class="op" id="8336700">.</span><span class="op" id="8336701">(</span><span class="builtintype" id="8336702">string</span><span class="op" id="8336708">)</span><span class="op" id="8336709">,</span>&nbsp;<span class="builtintype" id="8336711">string</span><span class="op" id="8336717">(</span><span class="ident" id="8336718"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336315">i</a></span><span class="op" id="8336719">)</span><span class="op" id="8336720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8336724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8336728">if</span>&nbsp;<span class="ident" id="8336731"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336448">resp</a></span><span class="op" id="8336735">.</span><span class="ident" id="8336736"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334879">Result</a></span><span class="op" id="8336742">.</span><span class="ident" id="8336743"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span>&nbsp;<span class="op" id="8336745">!=</span>&nbsp;<span class="num" id="8336748">2</span><span class="op" id="8336749">*</span><span class="ident" id="8336750"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336315">i</a></span><span class="op" id="8336751">+</span><span class="num" id="8336752">1</span>&nbsp;<span class="op" id="8336754">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8336759"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336145">t</a></span><span class="op" id="8336760">.</span><span class="ident" id="8336761"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8336767">(</span><span class="string" id="8336768">&#34;resp:&nbsp;bad&nbsp;result:&nbsp;%d+%d=%d&#34;</span><span class="op" id="8336796">,</span>&nbsp;<span class="ident" id="8336798"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336315">i</a></span><span class="op" id="8336799">,</span>&nbsp;<span class="ident" id="8336801"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336315">i</a></span><span class="op" id="8336802">+</span><span class="num" id="8336803">1</span><span class="op" id="8336804">,</span>&nbsp;<span class="ident" id="8336806"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336448">resp</a></span><span class="op" id="8336810">.</span><span class="ident" id="8336811"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334879">Result</a></span><span class="op" id="8336817">.</span><span class="ident" id="8336818"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span><span class="op" id="8336819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8336823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8336826">}</span><br>
<span class="lineno"></span><span class="op" id="8336828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="8336831">func</span>&nbsp;<span class="ident" id="8336836">TestClient</span><span class="op" id="8336846">(</span><span class="ident" id="8336847">t</span>&nbsp;<span class="op" id="8336849">*</span><span class="ident" id="8336850"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334728">testing</a></span><span class="op" id="8336857">.</span><span class="ident" id="8336858"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8336859">)</span>&nbsp;<span class="op" id="8336861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8336864">//&nbsp;Assume&nbsp;server&nbsp;is&nbsp;okay&nbsp;(TestServer&nbsp;is&nbsp;above).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8336913">//&nbsp;Test&nbsp;client&nbsp;against&nbsp;server.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8336945">cli</span><span class="op" id="8336948">,</span>&nbsp;<span class="ident" id="8336950">srv</span>&nbsp;<span class="op" id="8336954">:=</span>&nbsp;<span class="ident" id="8336957"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334699">net</a></span><span class="op" id="8336960">.</span><span class="ident" id="8336961"><a href="/gostd/net/pipe.go.html#3349719">Pipe</a></span><span class="op" id="8336965">(</span><span class="op" id="8336966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8336969">go</span>&nbsp;<span class="ident" id="8336972"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6146522">ServeConn</a></span><span class="op" id="8336981">(</span><span class="ident" id="8336982"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336950">srv</a></span><span class="op" id="8336985">)</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8336989">client</span>&nbsp;<span class="op" id="8336996">:=</span>&nbsp;<span class="ident" id="8336999"><a href="/gostd/net/rpc/jsonrpc/client.go.html#6142978">NewClient</a></span><span class="op" id="8337008">(</span><span class="ident" id="8337009"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336945">cli</a></span><span class="op" id="8337012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8337015">defer</span>&nbsp;<span class="ident" id="8337021"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336989">client</a></span><span class="op" id="8337027">.</span><span class="ident" id="8337028"><a href="/gostd/net/rpc/client.go.html#5268682">Close</a></span><span class="op" id="8337033">(</span><span class="op" id="8337034">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8337038">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337060">args</span>&nbsp;<span class="op" id="8337065">:=</span>&nbsp;<span class="op" id="8337068">&amp;</span><span class="ident" id="8337069"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334746">Args</a></span><span class="op" id="8337073">{</span><span class="num" id="8337074">7</span><span class="op" id="8337075">,</span>&nbsp;<span class="num" id="8337077">8</span><span class="op" id="8337078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337081">reply</span>&nbsp;<span class="op" id="8337087">:=</span>&nbsp;<span class="builtinfunc" id="8337090">new</span><span class="op" id="8337093">(</span><span class="ident" id="8337094"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334778">Reply</a></span><span class="op" id="8337099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337102">err</span>&nbsp;<span class="op" id="8337106">:=</span>&nbsp;<span class="ident" id="8337109"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336989">client</a></span><span class="op" id="8337115">.</span><span class="ident" id="8337116"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="8337120">(</span><span class="string" id="8337121">&#34;Arith.Add&#34;</span><span class="op" id="8337132">,</span>&nbsp;<span class="ident" id="8337134"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337138">,</span>&nbsp;<span class="ident" id="8337140"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337081">reply</a></span><span class="op" id="8337145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8337148">if</span>&nbsp;<span class="ident" id="8337151"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337102">err</a></span>&nbsp;<span class="op" id="8337155">!=</span>&nbsp;<span class="builtintype" id="8337158">nil</span>&nbsp;<span class="op" id="8337162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337166"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336847">t</a></span><span class="op" id="8337167">.</span><span class="ident" id="8337168"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8337174">(</span><span class="string" id="8337175">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="8337217">,</span>&nbsp;<span class="ident" id="8337219"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337102">err</a></span><span class="op" id="8337222">.</span><span class="ident" id="8337223">Error</span><span class="op" id="8337228">(</span><span class="op" id="8337229">)</span><span class="op" id="8337230">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8337233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8337236">if</span>&nbsp;<span class="ident" id="8337239"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337081">reply</a></span><span class="op" id="8337244">.</span><span class="ident" id="8337245"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span>&nbsp;<span class="op" id="8337247">!=</span>&nbsp;<span class="ident" id="8337250"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337254">.</span><span class="ident" id="8337255"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334761">A</a></span><span class="op" id="8337256">+</span><span class="ident" id="8337257"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337261">.</span><span class="ident" id="8337262"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334764">B</a></span>&nbsp;<span class="op" id="8337264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337268"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336847">t</a></span><span class="op" id="8337269">.</span><span class="ident" id="8337270"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8337276">(</span><span class="string" id="8337277">&#34;Add:&nbsp;got&nbsp;%d&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8337302">,</span>&nbsp;<span class="ident" id="8337304"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337081">reply</a></span><span class="op" id="8337309">.</span><span class="ident" id="8337310"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span><span class="op" id="8337311">,</span>&nbsp;<span class="ident" id="8337313"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337317">.</span><span class="ident" id="8337318"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334761">A</a></span><span class="op" id="8337319">+</span><span class="ident" id="8337320"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337324">.</span><span class="ident" id="8337325"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334764">B</a></span><span class="op" id="8337326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8337329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337333"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span>&nbsp;<span class="op" id="8337338">=</span>&nbsp;<span class="op" id="8337340">&amp;</span><span class="ident" id="8337341"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334746">Args</a></span><span class="op" id="8337345">{</span><span class="num" id="8337346">7</span><span class="op" id="8337347">,</span>&nbsp;<span class="num" id="8337349">8</span><span class="op" id="8337350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337353"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337081">reply</a></span>&nbsp;<span class="op" id="8337359">=</span>&nbsp;<span class="builtinfunc" id="8337361">new</span><span class="op" id="8337364">(</span><span class="ident" id="8337365"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334778">Reply</a></span><span class="op" id="8337370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337373"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337102">err</a></span>&nbsp;<span class="op" id="8337377">=</span>&nbsp;<span class="ident" id="8337379"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336989">client</a></span><span class="op" id="8337385">.</span><span class="ident" id="8337386"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="8337390">(</span><span class="string" id="8337391">&#34;Arith.Mul&#34;</span><span class="op" id="8337402">,</span>&nbsp;<span class="ident" id="8337404"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337408">,</span>&nbsp;<span class="ident" id="8337410"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337081">reply</a></span><span class="op" id="8337415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8337418">if</span>&nbsp;<span class="ident" id="8337421"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337102">err</a></span>&nbsp;<span class="op" id="8337425">!=</span>&nbsp;<span class="builtintype" id="8337428">nil</span>&nbsp;<span class="op" id="8337432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337436"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336847">t</a></span><span class="op" id="8337437">.</span><span class="ident" id="8337438"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8337444">(</span><span class="string" id="8337445">&#34;Mul:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="8337487">,</span>&nbsp;<span class="ident" id="8337489"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337102">err</a></span><span class="op" id="8337492">.</span><span class="ident" id="8337493">Error</span><span class="op" id="8337498">(</span><span class="op" id="8337499">)</span><span class="op" id="8337500">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8337503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8337506">if</span>&nbsp;<span class="ident" id="8337509"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337081">reply</a></span><span class="op" id="8337514">.</span><span class="ident" id="8337515"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span>&nbsp;<span class="op" id="8337517">!=</span>&nbsp;<span class="ident" id="8337520"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337524">.</span><span class="ident" id="8337525"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334761">A</a></span><span class="op" id="8337526">*</span><span class="ident" id="8337527"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337531">.</span><span class="ident" id="8337532"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334764">B</a></span>&nbsp;<span class="op" id="8337534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337538"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336847">t</a></span><span class="op" id="8337539">.</span><span class="ident" id="8337540"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8337546">(</span><span class="string" id="8337547">&#34;Mul:&nbsp;got&nbsp;%d&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8337572">,</span>&nbsp;<span class="ident" id="8337574"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337081">reply</a></span><span class="op" id="8337579">.</span><span class="ident" id="8337580"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span><span class="op" id="8337581">,</span>&nbsp;<span class="ident" id="8337583"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337587">.</span><span class="ident" id="8337588"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334761">A</a></span><span class="op" id="8337589">*</span><span class="ident" id="8337590"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337594">.</span><span class="ident" id="8337595"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334764">B</a></span><span class="op" id="8337596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8337599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8337603">//&nbsp;Out&nbsp;of&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337621"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span>&nbsp;<span class="op" id="8337626">=</span>&nbsp;<span class="op" id="8337628">&amp;</span><span class="ident" id="8337629"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334746">Args</a></span><span class="op" id="8337633">{</span><span class="num" id="8337634">7</span><span class="op" id="8337635">,</span>&nbsp;<span class="num" id="8337637">8</span><span class="op" id="8337638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337641">mulReply</span>&nbsp;<span class="op" id="8337650">:=</span>&nbsp;<span class="builtinfunc" id="8337653">new</span><span class="op" id="8337656">(</span><span class="ident" id="8337657"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334778">Reply</a></span><span class="op" id="8337662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337665">mulCall</span>&nbsp;<span class="op" id="8337673">:=</span>&nbsp;<span class="ident" id="8337676"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336989">client</a></span><span class="op" id="8337682">.</span><span class="ident" id="8337683"><a href="/gostd/net/rpc/client.go.html#5269205">Go</a></span><span class="op" id="8337685">(</span><span class="string" id="8337686">&#34;Arith.Mul&#34;</span><span class="op" id="8337697">,</span>&nbsp;<span class="ident" id="8337699"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337703">,</span>&nbsp;<span class="ident" id="8337705"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337641">mulReply</a></span><span class="op" id="8337713">,</span>&nbsp;<span class="builtintype" id="8337715">nil</span><span class="op" id="8337718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337721">addReply</span>&nbsp;<span class="op" id="8337730">:=</span>&nbsp;<span class="builtinfunc" id="8337733">new</span><span class="op" id="8337736">(</span><span class="ident" id="8337737"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334778">Reply</a></span><span class="op" id="8337742">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337745">addCall</span>&nbsp;<span class="op" id="8337753">:=</span>&nbsp;<span class="ident" id="8337756"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336989">client</a></span><span class="op" id="8337762">.</span><span class="ident" id="8337763"><a href="/gostd/net/rpc/client.go.html#5269205">Go</a></span><span class="op" id="8337765">(</span><span class="string" id="8337766">&#34;Arith.Add&#34;</span><span class="op" id="8337777">,</span>&nbsp;<span class="ident" id="8337779"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337783">,</span>&nbsp;<span class="ident" id="8337785"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337721">addReply</a></span><span class="op" id="8337793">,</span>&nbsp;<span class="builtintype" id="8337795">nil</span><span class="op" id="8337798">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337802"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337745">addCall</a></span>&nbsp;<span class="op" id="8337810">=</span>&nbsp;<span class="op" id="8337812">&lt;-</span><span class="ident" id="8337814"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337745">addCall</a></span><span class="op" id="8337821">.</span><span class="ident" id="8337822"><a href="/gostd/net/rpc/client.go.html#5262112">Done</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8337828">if</span>&nbsp;<span class="ident" id="8337831"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337745">addCall</a></span><span class="op" id="8337838">.</span><span class="ident" id="8337839"><a href="/gostd/net/rpc/client.go.html#5262046">Error</a></span>&nbsp;<span class="op" id="8337845">!=</span>&nbsp;<span class="builtintype" id="8337848">nil</span>&nbsp;<span class="op" id="8337852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337856"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336847">t</a></span><span class="op" id="8337857">.</span><span class="ident" id="8337858"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8337864">(</span><span class="string" id="8337865">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="8337907">,</span>&nbsp;<span class="ident" id="8337909"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337745">addCall</a></span><span class="op" id="8337916">.</span><span class="ident" id="8337917"><a href="/gostd/net/rpc/client.go.html#5262046">Error</a></span><span class="op" id="8337922">.</span><span class="ident" id="8337923">Error</span><span class="op" id="8337928">(</span><span class="op" id="8337929">)</span><span class="op" id="8337930">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8337933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8337936">if</span>&nbsp;<span class="ident" id="8337939"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337721">addReply</a></span><span class="op" id="8337947">.</span><span class="ident" id="8337948"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span>&nbsp;<span class="op" id="8337950">!=</span>&nbsp;<span class="ident" id="8337953"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337957">.</span><span class="ident" id="8337958"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334761">A</a></span><span class="op" id="8337959">+</span><span class="ident" id="8337960"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8337964">.</span><span class="ident" id="8337965"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334764">B</a></span>&nbsp;<span class="op" id="8337967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8337971"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336847">t</a></span><span class="op" id="8337972">.</span><span class="ident" id="8337973"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8337979">(</span><span class="string" id="8337980">&#34;Add:&nbsp;got&nbsp;%d&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8338005">,</span>&nbsp;<span class="ident" id="8338007"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337721">addReply</a></span><span class="op" id="8338015">.</span><span class="ident" id="8338016"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span><span class="op" id="8338017">,</span>&nbsp;<span class="ident" id="8338019"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8338023">.</span><span class="ident" id="8338024"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334761">A</a></span><span class="op" id="8338025">+</span><span class="ident" id="8338026"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8338030">.</span><span class="ident" id="8338031"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334764">B</a></span><span class="op" id="8338032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8338035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338039"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337665">mulCall</a></span>&nbsp;<span class="op" id="8338047">=</span>&nbsp;<span class="op" id="8338049">&lt;-</span><span class="ident" id="8338051"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337665">mulCall</a></span><span class="op" id="8338058">.</span><span class="ident" id="8338059"><a href="/gostd/net/rpc/client.go.html#5262112">Done</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8338065">if</span>&nbsp;<span class="ident" id="8338068"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337665">mulCall</a></span><span class="op" id="8338075">.</span><span class="ident" id="8338076"><a href="/gostd/net/rpc/client.go.html#5262046">Error</a></span>&nbsp;<span class="op" id="8338082">!=</span>&nbsp;<span class="builtintype" id="8338085">nil</span>&nbsp;<span class="op" id="8338089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338093"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336847">t</a></span><span class="op" id="8338094">.</span><span class="ident" id="8338095"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8338101">(</span><span class="string" id="8338102">&#34;Mul:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="8338144">,</span>&nbsp;<span class="ident" id="8338146"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337665">mulCall</a></span><span class="op" id="8338153">.</span><span class="ident" id="8338154"><a href="/gostd/net/rpc/client.go.html#5262046">Error</a></span><span class="op" id="8338159">.</span><span class="ident" id="8338160">Error</span><span class="op" id="8338165">(</span><span class="op" id="8338166">)</span><span class="op" id="8338167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8338170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8338173">if</span>&nbsp;<span class="ident" id="8338176"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337641">mulReply</a></span><span class="op" id="8338184">.</span><span class="ident" id="8338185"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span>&nbsp;<span class="op" id="8338187">!=</span>&nbsp;<span class="ident" id="8338190"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8338194">.</span><span class="ident" id="8338195"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334761">A</a></span><span class="op" id="8338196">*</span><span class="ident" id="8338197"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8338201">.</span><span class="ident" id="8338202"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334764">B</a></span>&nbsp;<span class="op" id="8338204">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338208"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336847">t</a></span><span class="op" id="8338209">.</span><span class="ident" id="8338210"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8338216">(</span><span class="string" id="8338217">&#34;Mul:&nbsp;got&nbsp;%d&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="8338242">,</span>&nbsp;<span class="ident" id="8338244"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337641">mulReply</a></span><span class="op" id="8338252">.</span><span class="ident" id="8338253"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334794">C</a></span><span class="op" id="8338254">,</span>&nbsp;<span class="ident" id="8338256"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8338260">.</span><span class="ident" id="8338261"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334761">A</a></span><span class="op" id="8338262">*</span><span class="ident" id="8338263"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8338267">.</span><span class="ident" id="8338268"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334764">B</a></span><span class="op" id="8338269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8338272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8338276">//&nbsp;Error&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338291"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span>&nbsp;<span class="op" id="8338296">=</span>&nbsp;<span class="op" id="8338298">&amp;</span><span class="ident" id="8338299"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334746">Args</a></span><span class="op" id="8338303">{</span><span class="num" id="8338304">7</span><span class="op" id="8338305">,</span>&nbsp;<span class="num" id="8338307">0</span><span class="op" id="8338308">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338311"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337081">reply</a></span>&nbsp;<span class="op" id="8338317">=</span>&nbsp;<span class="builtinfunc" id="8338319">new</span><span class="op" id="8338322">(</span><span class="ident" id="8338323"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334778">Reply</a></span><span class="op" id="8338328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338331"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337102">err</a></span>&nbsp;<span class="op" id="8338335">=</span>&nbsp;<span class="ident" id="8338337"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336989">client</a></span><span class="op" id="8338343">.</span><span class="ident" id="8338344"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="8338348">(</span><span class="string" id="8338349">&#34;Arith.Div&#34;</span><span class="op" id="8338360">,</span>&nbsp;<span class="ident" id="8338362"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337060">args</a></span><span class="op" id="8338366">,</span>&nbsp;<span class="ident" id="8338368"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337081">reply</a></span><span class="op" id="8338373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8338376">//&nbsp;expect&nbsp;an&nbsp;error:&nbsp;zero&nbsp;divide</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8338409">if</span>&nbsp;<span class="ident" id="8338412"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337102">err</a></span>&nbsp;<span class="op" id="8338416">==</span>&nbsp;<span class="builtintype" id="8338419">nil</span>&nbsp;<span class="op" id="8338423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338427"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336847">t</a></span><span class="op" id="8338428">.</span><span class="ident" id="8338429"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8338434">(</span><span class="string" id="8338435">&#34;Div:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="8338456">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8338459">}</span>&nbsp;<span class="keyword" id="8338461">else</span>&nbsp;<span class="keyword" id="8338466">if</span>&nbsp;<span class="ident" id="8338469"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337102">err</a></span><span class="op" id="8338472">.</span><span class="ident" id="8338473">Error</span><span class="op" id="8338478">(</span><span class="op" id="8338479">)</span>&nbsp;<span class="op" id="8338481">!=</span>&nbsp;<span class="string" id="8338484">&#34;divide&nbsp;by&nbsp;zero&#34;</span>&nbsp;<span class="op" id="8338501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338505"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8336847">t</a></span><span class="op" id="8338506">.</span><span class="ident" id="8338507"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8338512">(</span><span class="string" id="8338513">&#34;Div:&nbsp;expected&nbsp;divide&nbsp;by&nbsp;zero&nbsp;error;&nbsp;got&#34;</span><span class="op" id="8338554">,</span>&nbsp;<span class="ident" id="8338556"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8337102">err</a></span><span class="op" id="8338559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8338562">}</span><br>
<span class="lineno"></span><span class="op" id="8338564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="8338567">func</span>&nbsp;<span class="ident" id="8338572">TestMalformedInput</span><span class="op" id="8338590">(</span><span class="ident" id="8338591">t</span>&nbsp;<span class="op" id="8338593">*</span><span class="ident" id="8338594"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334728">testing</a></span><span class="op" id="8338601">.</span><span class="ident" id="8338602"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8338603">)</span>&nbsp;<span class="op" id="8338605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338608">cli</span><span class="op" id="8338611">,</span>&nbsp;<span class="ident" id="8338613">srv</span>&nbsp;<span class="op" id="8338617">:=</span>&nbsp;<span class="ident" id="8338620"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334699">net</a></span><span class="op" id="8338623">.</span><span class="ident" id="8338624"><a href="/gostd/net/pipe.go.html#3349719">Pipe</a></span><span class="op" id="8338628">(</span><span class="op" id="8338629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8338632">go</span>&nbsp;<span class="ident" id="8338635"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8338608">cli</a></span><span class="op" id="8338638">.</span><span class="ident" id="8338639"><a href="/gostd/net/net.go.html#3334839">Write</a></span><span class="op" id="8338644">(</span><span class="op" id="8338645">[</span><span class="op" id="8338646">]</span><span class="builtintype" id="8338647">byte</span><span class="op" id="8338651">(</span><span class="string" id="8338652">`{id:1}`</span><span class="op" id="8338660">)</span><span class="op" id="8338661">)</span>&nbsp;<span class="comment" id="8338663">//&nbsp;invalid&nbsp;json</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338680"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6146522">ServeConn</a></span><span class="op" id="8338689">(</span><span class="ident" id="8338690"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8338613">srv</a></span><span class="op" id="8338693">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8338711">//&nbsp;must&nbsp;return,&nbsp;not&nbsp;loop</span><br>
<span class="lineno"></span><span class="op" id="8338736">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="keyword" id="8338739">func</span>&nbsp;<span class="ident" id="8338744">TestMalformedOutput</span><span class="op" id="8338763">(</span><span class="ident" id="8338764">t</span>&nbsp;<span class="op" id="8338766">*</span><span class="ident" id="8338767"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334728">testing</a></span><span class="op" id="8338774">.</span><span class="ident" id="8338775"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8338776">)</span>&nbsp;<span class="op" id="8338778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338781">cli</span><span class="op" id="8338784">,</span>&nbsp;<span class="ident" id="8338786">srv</span>&nbsp;<span class="op" id="8338790">:=</span>&nbsp;<span class="ident" id="8338793"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334699">net</a></span><span class="op" id="8338796">.</span><span class="ident" id="8338797"><a href="/gostd/net/pipe.go.html#3349719">Pipe</a></span><span class="op" id="8338801">(</span><span class="op" id="8338802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8338805">go</span>&nbsp;<span class="ident" id="8338808"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8338786">srv</a></span><span class="op" id="8338811">.</span><span class="ident" id="8338812"><a href="/gostd/net/net.go.html#3334839">Write</a></span><span class="op" id="8338817">(</span><span class="op" id="8338818">[</span><span class="op" id="8338819">]</span><span class="builtintype" id="8338820">byte</span><span class="op" id="8338824">(</span><span class="string" id="8338825">`{&#34;id&#34;:0,&#34;result&#34;:null,&#34;error&#34;:null}`</span><span class="op" id="8338862">)</span><span class="op" id="8338863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8338866">go</span>&nbsp;<span class="ident" id="8338869"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334686">ioutil</a></span><span class="op" id="8338875">.</span><span class="ident" id="8338876"><a href="/gostd/io/ioutil/ioutil.go.html#3765117">ReadAll</a></span><span class="op" id="8338883">(</span><span class="ident" id="8338884"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8338786">srv</a></span><span class="op" id="8338887">)</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338891">client</span>&nbsp;<span class="op" id="8338898">:=</span>&nbsp;<span class="ident" id="8338901"><a href="/gostd/net/rpc/jsonrpc/client.go.html#6142978">NewClient</a></span><span class="op" id="8338910">(</span><span class="ident" id="8338911"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8338781">cli</a></span><span class="op" id="8338914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8338917">defer</span>&nbsp;<span class="ident" id="8338923"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8338891">client</a></span><span class="op" id="8338929">.</span><span class="ident" id="8338930"><a href="/gostd/net/rpc/client.go.html#5268682">Close</a></span><span class="op" id="8338935">(</span><span class="op" id="8338936">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338940">args</span>&nbsp;<span class="op" id="8338945">:=</span>&nbsp;<span class="op" id="8338948">&amp;</span><span class="ident" id="8338949"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334746">Args</a></span><span class="op" id="8338953">{</span><span class="num" id="8338954">7</span><span class="op" id="8338955">,</span>&nbsp;<span class="num" id="8338957">8</span><span class="op" id="8338958">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338961">reply</span>&nbsp;<span class="op" id="8338967">:=</span>&nbsp;<span class="builtinfunc" id="8338970">new</span><span class="op" id="8338973">(</span><span class="ident" id="8338974"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334778">Reply</a></span><span class="op" id="8338979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8338982">err</span>&nbsp;<span class="op" id="8338986">:=</span>&nbsp;<span class="ident" id="8338989"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8338891">client</a></span><span class="op" id="8338995">.</span><span class="ident" id="8338996"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="8339000">(</span><span class="string" id="8339001">&#34;Arith.Add&#34;</span><span class="op" id="8339012">,</span>&nbsp;<span class="ident" id="8339014"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8338940">args</a></span><span class="op" id="8339018">,</span>&nbsp;<span class="ident" id="8339020"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8338961">reply</a></span><span class="op" id="8339025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8339028">if</span>&nbsp;<span class="ident" id="8339031"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8338982">err</a></span>&nbsp;<span class="op" id="8339035">==</span>&nbsp;<span class="builtintype" id="8339038">nil</span>&nbsp;<span class="op" id="8339042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339046"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8338764">t</a></span><span class="op" id="8339047">.</span><span class="ident" id="8339048"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="8339053">(</span><span class="string" id="8339054">&#34;expected&nbsp;error&#34;</span><span class="op" id="8339070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8339073">}</span><br>
<span class="lineno">205</span><span class="op" id="8339075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8339078">func</span>&nbsp;<span class="ident" id="8339083">TestServerErrorHasNullResult</span><span class="op" id="8339111">(</span><span class="ident" id="8339112">t</span>&nbsp;<span class="op" id="8339114">*</span><span class="ident" id="8339115"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334728">testing</a></span><span class="op" id="8339122">.</span><span class="ident" id="8339123"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8339124">)</span>&nbsp;<span class="op" id="8339126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8339129">var</span>&nbsp;<span class="ident" id="8339133">out</span>&nbsp;<span class="ident" id="8339137"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334637">bytes</a></span><span class="op" id="8339142">.</span><span class="ident" id="8339143"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339151">sc</span>&nbsp;<span class="op" id="8339154">:=</span>&nbsp;<span class="ident" id="8339157"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6144328">NewServerCodec</a></span><span class="op" id="8339171">(</span><span class="keyword" id="8339172">struct</span>&nbsp;<span class="op" id="8339179">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339183"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334680">io</a></span><span class="op" id="8339185">.</span><span class="ident" id="8339186"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339195"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334680">io</a></span><span class="op" id="8339197">.</span><span class="ident" id="8339198"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339207"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334680">io</a></span><span class="op" id="8339209">.</span><span class="ident" id="8339210"><a href="/gostd/io/io.go.html#1422563">Closer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8339218">}</span><span class="op" id="8339219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339223"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339183">Reader</a></span><span class="op" id="8339229">:</span>&nbsp;<span class="ident" id="8339231"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334717">strings</a></span><span class="op" id="8339238">.</span><span class="ident" id="8339239"><a href="/gostd/strings/reader.go.html#2948317">NewReader</a></span><span class="op" id="8339248">(</span><span class="string" id="8339249">`{&#34;method&#34;:&nbsp;&#34;Arith.Add&#34;,&nbsp;&#34;id&#34;:&nbsp;&#34;123&#34;,&nbsp;&#34;params&#34;:&nbsp;[]}`</span><span class="op" id="8339301">)</span><span class="op" id="8339302">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339306"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339195">Writer</a></span><span class="op" id="8339312">:</span>&nbsp;<span class="op" id="8339314">&amp;</span><span class="ident" id="8339315"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339133">out</a></span><span class="op" id="8339318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339322"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339207">Closer</a></span><span class="op" id="8339328">:</span>&nbsp;<span class="ident" id="8339330"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334686">ioutil</a></span><span class="op" id="8339336">.</span><span class="ident" id="8339337"><a href="/gostd/io/ioutil/ioutil.go.html#3767601">NopCloser</a></span><span class="op" id="8339346">(</span><span class="builtintype" id="8339347">nil</span><span class="op" id="8339350">)</span><span class="op" id="8339351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8339354">}</span><span class="op" id="8339355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339358">r</span>&nbsp;<span class="op" id="8339360">:=</span>&nbsp;<span class="builtinfunc" id="8339363">new</span><span class="op" id="8339366">(</span><span class="ident" id="8339367"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334706">rpc</a></span><span class="op" id="8339370">.</span><span class="ident" id="8339371"><a href="/gostd/net/rpc/server.go.html#5277366">Request</a></span><span class="op" id="8339378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8339381">if</span>&nbsp;<span class="ident" id="8339384">err</span>&nbsp;<span class="op" id="8339388">:=</span>&nbsp;<span class="ident" id="8339391"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339151">sc</a></span><span class="op" id="8339393">.</span><span class="ident" id="8339394"><a href="/gostd/net/rpc/server.go.html#5291309">ReadRequestHeader</a></span><span class="op" id="8339411">(</span><span class="ident" id="8339412"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339358">r</a></span><span class="op" id="8339413">)</span><span class="op" id="8339414">;</span>&nbsp;<span class="ident" id="8339416"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339384">err</a></span>&nbsp;<span class="op" id="8339420">!=</span>&nbsp;<span class="builtintype" id="8339423">nil</span>&nbsp;<span class="op" id="8339427">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339431"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339112">t</a></span><span class="op" id="8339432">.</span><span class="ident" id="8339433"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8339438">(</span><span class="ident" id="8339439"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339384">err</a></span><span class="op" id="8339442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8339445">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8339448">const</span>&nbsp;<span class="ident" id="8339454">valueText</span>&nbsp;<span class="op" id="8339464">=</span>&nbsp;<span class="string" id="8339466">&#34;the&nbsp;value&nbsp;we&nbsp;don&#39;t&nbsp;want&nbsp;to&nbsp;see&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8339500">const</span>&nbsp;<span class="ident" id="8339506">errorText</span>&nbsp;<span class="op" id="8339516">=</span>&nbsp;<span class="string" id="8339518">&#34;some&nbsp;error&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339532">err</span>&nbsp;<span class="op" id="8339536">:=</span>&nbsp;<span class="ident" id="8339539"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339151">sc</a></span><span class="op" id="8339541">.</span><span class="ident" id="8339542"><a href="/gostd/net/rpc/server.go.html#5291454">WriteResponse</a></span><span class="op" id="8339555">(</span><span class="op" id="8339556">&amp;</span><span class="ident" id="8339557"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334706">rpc</a></span><span class="op" id="8339560">.</span><span class="ident" id="8339561"><a href="/gostd/net/rpc/server.go.html#5277724">Response</a></span><span class="op" id="8339569">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339573"><a href="/gostd/net/rpc/server.go.html#5277743">ServiceMethod</a></span><span class="op" id="8339586">:</span>&nbsp;<span class="string" id="8339588">&#34;Method&#34;</span><span class="op" id="8339596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339600"><a href="/gostd/net/rpc/server.go.html#5277798">Seq</a></span><span class="op" id="8339603">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8339615">1</span><span class="op" id="8339616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339620"><a href="/gostd/net/rpc/server.go.html#5277853">Error</a></span><span class="op" id="8339625">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339635"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339506">errorText</a></span><span class="op" id="8339644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8339647">}</span><span class="op" id="8339648">,</span>&nbsp;<span class="ident" id="8339650"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339454">valueText</a></span><span class="op" id="8339659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8339662">if</span>&nbsp;<span class="ident" id="8339665"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339532">err</a></span>&nbsp;<span class="op" id="8339669">!=</span>&nbsp;<span class="builtintype" id="8339672">nil</span>&nbsp;<span class="op" id="8339676">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339680"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339112">t</a></span><span class="op" id="8339681">.</span><span class="ident" id="8339682"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="8339687">(</span><span class="ident" id="8339688"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339532">err</a></span><span class="op" id="8339691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8339694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8339697">if</span>&nbsp;<span class="op" id="8339700">!</span><span class="ident" id="8339701"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334717">strings</a></span><span class="op" id="8339708">.</span><span class="ident" id="8339709"><a href="/gostd/strings/strings.go.html#2968416">Contains</a></span><span class="op" id="8339717">(</span><span class="ident" id="8339718"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339133">out</a></span><span class="op" id="8339721">.</span><span class="ident" id="8339722"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="8339728">(</span><span class="op" id="8339729">)</span><span class="op" id="8339730">,</span>&nbsp;<span class="ident" id="8339732"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339506">errorText</a></span><span class="op" id="8339741">)</span>&nbsp;<span class="op" id="8339743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339747"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339112">t</a></span><span class="op" id="8339748">.</span><span class="ident" id="8339749"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="8339755">(</span><span class="string" id="8339756">&#34;Response&nbsp;didn&#39;t&nbsp;contain&nbsp;expected&nbsp;error&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="8339803">,</span>&nbsp;<span class="ident" id="8339805"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339506">errorText</a></span><span class="op" id="8339814">,</span>&nbsp;<span class="op" id="8339816">&amp;</span><span class="ident" id="8339817"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339133">out</a></span><span class="op" id="8339820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8339823">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8339826">if</span>&nbsp;<span class="ident" id="8339829"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334717">strings</a></span><span class="op" id="8339836">.</span><span class="ident" id="8339837"><a href="/gostd/strings/strings.go.html#2968416">Contains</a></span><span class="op" id="8339845">(</span><span class="ident" id="8339846"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339133">out</a></span><span class="op" id="8339849">.</span><span class="ident" id="8339850"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="8339856">(</span><span class="op" id="8339857">)</span><span class="op" id="8339858">,</span>&nbsp;<span class="ident" id="8339860"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339454">valueText</a></span><span class="op" id="8339869">)</span>&nbsp;<span class="op" id="8339871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339875"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339112">t</a></span><span class="op" id="8339876">.</span><span class="ident" id="8339877"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="8339883">(</span><span class="string" id="8339884">&#34;Response&nbsp;contains&nbsp;both&nbsp;an&nbsp;error&nbsp;and&nbsp;value:&nbsp;%s&#34;</span><span class="op" id="8339931">,</span>&nbsp;<span class="op" id="8339933">&amp;</span><span class="ident" id="8339934"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339133">out</a></span><span class="op" id="8339937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8339940">}</span><br>
<span class="lineno"></span><span class="op" id="8339942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="8339945">func</span>&nbsp;<span class="ident" id="8339950">TestUnexpectedError</span><span class="op" id="8339969">(</span><span class="ident" id="8339970">t</span>&nbsp;<span class="op" id="8339972">*</span><span class="ident" id="8339973"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334728">testing</a></span><span class="op" id="8339980">.</span><span class="ident" id="8339981"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="8339982">)</span>&nbsp;<span class="op" id="8339984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8339987">cli</span><span class="op" id="8339990">,</span>&nbsp;<span class="ident" id="8339992">srv</span>&nbsp;<span class="op" id="8339996">:=</span>&nbsp;<span class="ident" id="8339999"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340233">myPipe</a></span><span class="op" id="8340005">(</span><span class="op" id="8340006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8340009">go</span>&nbsp;<span class="ident" id="8340012"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339987">cli</a></span><span class="op" id="8340015">.</span><span class="ident" id="8340016"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340378">PipeWriter</a></span><span class="op" id="8340026">.</span><span class="ident" id="8340027"><a href="/gostd/io/pipe.go.html#1439738">CloseWithError</a></span><span class="op" id="8340041">(</span><span class="ident" id="8340042"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334663">errors</a></span><span class="op" id="8340048">.</span><span class="ident" id="8340049"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="8340052">(</span><span class="string" id="8340053">&#34;unexpected&nbsp;error!&#34;</span><span class="op" id="8340072">)</span><span class="op" id="8340073">)</span>&nbsp;<span class="comment" id="8340075">//&nbsp;reader&nbsp;will&nbsp;get&nbsp;this&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8340106"><a href="/gostd/net/rpc/jsonrpc/server.go.html#6146522">ServeConn</a></span><span class="op" id="8340115">(</span><span class="ident" id="8340116"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8339992">srv</a></span><span class="op" id="8340119">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8340172">//&nbsp;must&nbsp;return,&nbsp;not&nbsp;loop</span><br>
<span class="lineno"></span><span class="op" id="8340197">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="8340200">//&nbsp;Copied&nbsp;from&nbsp;package&nbsp;net.</span><br>
<span class="lineno"></span><span class="keyword" id="8340228">func</span>&nbsp;<span class="ident" id="8340233">myPipe</span><span class="op" id="8340239">(</span><span class="op" id="8340240">)</span>&nbsp;<span class="op" id="8340242">(</span><span class="op" id="8340243">*</span><span class="ident" id="8340244"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340347">pipe</a></span><span class="op" id="8340248">,</span>&nbsp;<span class="op" id="8340250">*</span><span class="ident" id="8340251"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340347">pipe</a></span><span class="op" id="8340255">)</span>&nbsp;<span class="op" id="8340257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8340260">r1</span><span class="op" id="8340262">,</span>&nbsp;<span class="ident" id="8340264">w1</span>&nbsp;<span class="op" id="8340267">:=</span>&nbsp;<span class="ident" id="8340270"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334680">io</a></span><span class="op" id="8340272">.</span><span class="ident" id="8340273"><a href="/gostd/io/pipe.go.html#1440333">Pipe</a></span><span class="op" id="8340277">(</span><span class="op" id="8340278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8340281">r2</span><span class="op" id="8340283">,</span>&nbsp;<span class="ident" id="8340285">w2</span>&nbsp;<span class="op" id="8340288">:=</span>&nbsp;<span class="ident" id="8340291"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334680">io</a></span><span class="op" id="8340293">.</span><span class="ident" id="8340294"><a href="/gostd/io/pipe.go.html#1440333">Pipe</a></span><span class="op" id="8340298">(</span><span class="op" id="8340299">)</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8340303">return</span>&nbsp;<span class="op" id="8340310">&amp;</span><span class="ident" id="8340311"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340347">pipe</a></span><span class="op" id="8340315">{</span><span class="ident" id="8340316"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340260">r1</a></span><span class="op" id="8340318">,</span>&nbsp;<span class="ident" id="8340320"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340285">w2</a></span><span class="op" id="8340322">}</span><span class="op" id="8340323">,</span>&nbsp;<span class="op" id="8340325">&amp;</span><span class="ident" id="8340326"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340347">pipe</a></span><span class="op" id="8340330">{</span><span class="ident" id="8340331"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340281">r2</a></span><span class="op" id="8340333">,</span>&nbsp;<span class="ident" id="8340335"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340264">w1</a></span><span class="op" id="8340337">}</span><br>
<span class="lineno"></span><span class="op" id="8340339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8340342">type</span>&nbsp;<span class="ident" id="8340347">pipe</span>&nbsp;<span class="keyword" id="8340352">struct</span>&nbsp;<span class="op" id="8340359">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8340362">*</span><span class="ident" id="8340363"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334680">io</a></span><span class="op" id="8340365">.</span><span class="ident" id="8340366"><a href="/gostd/io/pipe.go.html#1438221">PipeReader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8340378">*</span><span class="ident" id="8340379"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334680">io</a></span><span class="op" id="8340381">.</span><span class="ident" id="8340382"><a href="/gostd/io/pipe.go.html#1439021">PipeWriter</a></span><br>
<span class="lineno"></span><span class="op" id="8340393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8340396">type</span>&nbsp;<span class="ident" id="8340401">pipeAddr</span>&nbsp;<span class="builtintype" id="8340410">int</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="8340415">func</span>&nbsp;<span class="op" id="8340420">(</span><span class="ident" id="8340421"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340401">pipeAddr</a></span><span class="op" id="8340429">)</span>&nbsp;<span class="ident" id="8340431">Network</span><span class="op" id="8340438">(</span><span class="op" id="8340439">)</span>&nbsp;<span class="builtintype" id="8340441">string</span>&nbsp;<span class="op" id="8340448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8340451">return</span>&nbsp;<span class="string" id="8340458">&#34;pipe&#34;</span><br>
<span class="lineno"></span><span class="op" id="8340465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="8340468">func</span>&nbsp;<span class="op" id="8340473">(</span><span class="ident" id="8340474"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340401">pipeAddr</a></span><span class="op" id="8340482">)</span>&nbsp;<span class="ident" id="8340484">String</span><span class="op" id="8340490">(</span><span class="op" id="8340491">)</span>&nbsp;<span class="builtintype" id="8340493">string</span>&nbsp;<span class="op" id="8340500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8340503">return</span>&nbsp;<span class="string" id="8340510">&#34;pipe&#34;</span><br>
<span class="lineno"></span><span class="op" id="8340517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8340520">func</span>&nbsp;<span class="op" id="8340525">(</span><span class="ident" id="8340526">p</span>&nbsp;<span class="op" id="8340528">*</span><span class="ident" id="8340529"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340347">pipe</a></span><span class="op" id="8340533">)</span>&nbsp;<span class="ident" id="8340535">Close</span><span class="op" id="8340540">(</span><span class="op" id="8340541">)</span>&nbsp;<span class="builtintype" id="8340543">error</span>&nbsp;<span class="op" id="8340549">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8340552">err</span>&nbsp;<span class="op" id="8340556">:=</span>&nbsp;<span class="ident" id="8340559"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340526">p</a></span><span class="op" id="8340560">.</span><span class="ident" id="8340561"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340362">PipeReader</a></span><span class="op" id="8340571">.</span><span class="ident" id="8340572"><a href="/gostd/io/pipe.go.html#1438720">Close</a></span><span class="op" id="8340577">(</span><span class="op" id="8340578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8340581">err1</span>&nbsp;<span class="op" id="8340586">:=</span>&nbsp;<span class="ident" id="8340589"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340526">p</a></span><span class="op" id="8340590">.</span><span class="ident" id="8340591"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340378">PipeWriter</a></span><span class="op" id="8340601">.</span><span class="ident" id="8340602"><a href="/gostd/io/pipe.go.html#1439540">Close</a></span><span class="op" id="8340607">(</span><span class="op" id="8340608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8340611">if</span>&nbsp;<span class="ident" id="8340614"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340552">err</a></span>&nbsp;<span class="op" id="8340618">==</span>&nbsp;<span class="builtintype" id="8340621">nil</span>&nbsp;<span class="op" id="8340625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8340629"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340552">err</a></span>&nbsp;<span class="op" id="8340633">=</span>&nbsp;<span class="ident" id="8340635"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340581">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8340641">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8340644">return</span>&nbsp;<span class="ident" id="8340651"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340552">err</a></span><br>
<span class="lineno"></span><span class="op" id="8340655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8340658">func</span>&nbsp;<span class="op" id="8340663">(</span><span class="ident" id="8340664">p</span>&nbsp;<span class="op" id="8340666">*</span><span class="ident" id="8340667"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340347">pipe</a></span><span class="op" id="8340671">)</span>&nbsp;<span class="ident" id="8340673">LocalAddr</span><span class="op" id="8340682">(</span><span class="op" id="8340683">)</span>&nbsp;<span class="ident" id="8340685"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334699">net</a></span><span class="op" id="8340688">.</span><span class="ident" id="8340689"><a href="/gostd/net/net.go.html#3334179">Addr</a></span>&nbsp;<span class="op" id="8340694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8340697">return</span>&nbsp;<span class="ident" id="8340704"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340401">pipeAddr</a></span><span class="op" id="8340712">(</span><span class="num" id="8340713">0</span><span class="op" id="8340714">)</span><br>
<span class="lineno">280</span><span class="op" id="8340716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8340719">func</span>&nbsp;<span class="op" id="8340724">(</span><span class="ident" id="8340725">p</span>&nbsp;<span class="op" id="8340727">*</span><span class="ident" id="8340728"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340347">pipe</a></span><span class="op" id="8340732">)</span>&nbsp;<span class="ident" id="8340734">RemoteAddr</span><span class="op" id="8340744">(</span><span class="op" id="8340745">)</span>&nbsp;<span class="ident" id="8340747"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334699">net</a></span><span class="op" id="8340750">.</span><span class="ident" id="8340751"><a href="/gostd/net/net.go.html#3334179">Addr</a></span>&nbsp;<span class="op" id="8340756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8340759">return</span>&nbsp;<span class="ident" id="8340766"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340401">pipeAddr</a></span><span class="op" id="8340774">(</span><span class="num" id="8340775">0</span><span class="op" id="8340776">)</span><br>
<span class="lineno"></span><span class="op" id="8340778">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="keyword" id="8340781">func</span>&nbsp;<span class="op" id="8340786">(</span><span class="ident" id="8340787">p</span>&nbsp;<span class="op" id="8340789">*</span><span class="ident" id="8340790"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340347">pipe</a></span><span class="op" id="8340794">)</span>&nbsp;<span class="ident" id="8340796">SetTimeout</span><span class="op" id="8340806">(</span><span class="ident" id="8340807">nsec</span>&nbsp;<span class="builtintype" id="8340812">int64</span><span class="op" id="8340817">)</span>&nbsp;<span class="builtintype" id="8340819">error</span>&nbsp;<span class="op" id="8340825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8340828">return</span>&nbsp;<span class="ident" id="8340835"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334663">errors</a></span><span class="op" id="8340841">.</span><span class="ident" id="8340842"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="8340845">(</span><span class="string" id="8340846">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;timeouts&#34;</span><span class="op" id="8340882">)</span><br>
<span class="lineno"></span><span class="op" id="8340884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="keyword" id="8340887">func</span>&nbsp;<span class="op" id="8340892">(</span><span class="ident" id="8340893">p</span>&nbsp;<span class="op" id="8340895">*</span><span class="ident" id="8340896"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340347">pipe</a></span><span class="op" id="8340900">)</span>&nbsp;<span class="ident" id="8340902">SetReadTimeout</span><span class="op" id="8340916">(</span><span class="ident" id="8340917">nsec</span>&nbsp;<span class="builtintype" id="8340922">int64</span><span class="op" id="8340927">)</span>&nbsp;<span class="builtintype" id="8340929">error</span>&nbsp;<span class="op" id="8340935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8340938">return</span>&nbsp;<span class="ident" id="8340945"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334663">errors</a></span><span class="op" id="8340951">.</span><span class="ident" id="8340952"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="8340955">(</span><span class="string" id="8340956">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;timeouts&#34;</span><span class="op" id="8340992">)</span><br>
<span class="lineno"></span><span class="op" id="8340994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8340997">func</span>&nbsp;<span class="op" id="8341002">(</span><span class="ident" id="8341003">p</span>&nbsp;<span class="op" id="8341005">*</span><span class="ident" id="8341006"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8340347">pipe</a></span><span class="op" id="8341010">)</span>&nbsp;<span class="ident" id="8341012">SetWriteTimeout</span><span class="op" id="8341027">(</span><span class="ident" id="8341028">nsec</span>&nbsp;<span class="builtintype" id="8341033">int64</span><span class="op" id="8341038">)</span>&nbsp;<span class="builtintype" id="8341040">error</span>&nbsp;<span class="op" id="8341046">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8341049">return</span>&nbsp;<span class="ident" id="8341056"><a href="/gostd/net/rpc/jsonrpc/all_test.go.html#8334663">errors</a></span><span class="op" id="8341062">.</span><span class="ident" id="8341063"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="8341066">(</span><span class="string" id="8341067">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;timeouts&#34;</span><span class="op" id="8341103">)</span><br>
<span class="lineno"></span><span class="op" id="8341105">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
