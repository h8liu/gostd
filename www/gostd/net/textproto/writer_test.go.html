<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html" class="current">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6727944">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6728000">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6728054">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6728105">package</span>&nbsp;<span class="ident" id="6728113">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6728124">import</span>&nbsp;<span class="op" id="6728131">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6728134">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6728143">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6728152">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6728162">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6728165">func</span>&nbsp;<span class="ident" id="6728170">TestPrintfLine</span><span class="op" id="6728184">(</span><span class="ident" id="6728185">t</span>&nbsp;<span class="op" id="6728187">*</span><span class="ident" id="6728188">testing</span><span class="op" id="6728195">.</span><span class="ident" id="6728196">T</span><span class="op" id="6728197">)</span>&nbsp;<span class="op" id="6728199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728202">var</span>&nbsp;<span class="ident" id="6728206">buf</span>&nbsp;<span class="ident" id="6728210">bytes</span><span class="op" id="6728215">.</span><span class="ident" id="6728216">Buffer</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728224">w</span>&nbsp;<span class="op" id="6728226">:=</span>&nbsp;<span class="ident" id="6728229">NewWriter</span><span class="op" id="6728238">(</span><span class="ident" id="6728239">bufio</span><span class="op" id="6728244">.</span><span class="ident" id="6728245">NewWriter</span><span class="op" id="6728254">(</span><span class="op" id="6728255">&amp;</span><span class="ident" id="6728256">buf</span><span class="op" id="6728259">)</span><span class="op" id="6728260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728263">err</span>&nbsp;<span class="op" id="6728267">:=</span>&nbsp;<span class="ident" id="6728270">w</span><span class="op" id="6728271">.</span><span class="ident" id="6728272">PrintfLine</span><span class="op" id="6728282">(</span><span class="string" id="6728283">&#34;foo&nbsp;%d&#34;</span><span class="op" id="6728291">,</span>&nbsp;<span class="num" id="6728293">123</span><span class="op" id="6728296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728299">if</span>&nbsp;<span class="ident" id="6728302">s</span>&nbsp;<span class="op" id="6728304">:=</span>&nbsp;<span class="ident" id="6728307">buf</span><span class="op" id="6728310">.</span><span class="ident" id="6728311">String</span><span class="op" id="6728317">(</span><span class="op" id="6728318">)</span><span class="op" id="6728319">;</span>&nbsp;<span class="ident" id="6728321">s</span>&nbsp;<span class="op" id="6728323">!=</span>&nbsp;<span class="string" id="6728326">&#34;foo&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="6728340">||</span>&nbsp;<span class="ident" id="6728343">err</span>&nbsp;<span class="op" id="6728347">!=</span>&nbsp;<span class="builtintype" id="6728350">nil</span>&nbsp;<span class="op" id="6728354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728358">t</span><span class="op" id="6728359">.</span><span class="ident" id="6728360">Fatalf</span><span class="op" id="6728366">(</span><span class="string" id="6728367">&#34;s=%q;&nbsp;err=%s&#34;</span><span class="op" id="6728381">,</span>&nbsp;<span class="ident" id="6728383">s</span><span class="op" id="6728384">,</span>&nbsp;<span class="ident" id="6728386">err</span><span class="op" id="6728389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6728392">}</span><br>
<span class="lineno">20</span><span class="op" id="6728394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6728397">func</span>&nbsp;<span class="ident" id="6728402">TestDotWriter</span><span class="op" id="6728415">(</span><span class="ident" id="6728416">t</span>&nbsp;<span class="op" id="6728418">*</span><span class="ident" id="6728419">testing</span><span class="op" id="6728426">.</span><span class="ident" id="6728427">T</span><span class="op" id="6728428">)</span>&nbsp;<span class="op" id="6728430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728433">var</span>&nbsp;<span class="ident" id="6728437">buf</span>&nbsp;<span class="ident" id="6728441">bytes</span><span class="op" id="6728446">.</span><span class="ident" id="6728447">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728455">w</span>&nbsp;<span class="op" id="6728457">:=</span>&nbsp;<span class="ident" id="6728460">NewWriter</span><span class="op" id="6728469">(</span><span class="ident" id="6728470">bufio</span><span class="op" id="6728475">.</span><span class="ident" id="6728476">NewWriter</span><span class="op" id="6728485">(</span><span class="op" id="6728486">&amp;</span><span class="ident" id="6728487">buf</span><span class="op" id="6728490">)</span><span class="op" id="6728491">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728494">d</span>&nbsp;<span class="op" id="6728496">:=</span>&nbsp;<span class="ident" id="6728499">w</span><span class="op" id="6728500">.</span><span class="ident" id="6728501">DotWriter</span><span class="op" id="6728510">(</span><span class="op" id="6728511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728514">n</span><span class="op" id="6728515">,</span>&nbsp;<span class="ident" id="6728517">err</span>&nbsp;<span class="op" id="6728521">:=</span>&nbsp;<span class="ident" id="6728524">d</span><span class="op" id="6728525">.</span><span class="ident" id="6728526">Write</span><span class="op" id="6728531">(</span><span class="op" id="6728532">[</span><span class="op" id="6728533">]</span><span class="builtintype" id="6728534">byte</span><span class="op" id="6728538">(</span><span class="string" id="6728539">&#34;abc\n.def\n..ghi\n.jkl\n.&#34;</span><span class="op" id="6728566">)</span><span class="op" id="6728567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728570">if</span>&nbsp;<span class="ident" id="6728573">n</span>&nbsp;<span class="op" id="6728575">!=</span>&nbsp;<span class="num" id="6728578">21</span>&nbsp;<span class="op" id="6728581">||</span>&nbsp;<span class="ident" id="6728584">err</span>&nbsp;<span class="op" id="6728588">!=</span>&nbsp;<span class="builtintype" id="6728591">nil</span>&nbsp;<span class="op" id="6728595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728599">t</span><span class="op" id="6728600">.</span><span class="ident" id="6728601">Fatalf</span><span class="op" id="6728607">(</span><span class="string" id="6728608">&#34;Write:&nbsp;%d,&nbsp;%s&#34;</span><span class="op" id="6728623">,</span>&nbsp;<span class="ident" id="6728625">n</span><span class="op" id="6728626">,</span>&nbsp;<span class="ident" id="6728628">err</span><span class="op" id="6728631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6728634">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728637">d</span><span class="op" id="6728638">.</span><span class="ident" id="6728639">Close</span><span class="op" id="6728644">(</span><span class="op" id="6728645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728648">want</span>&nbsp;<span class="op" id="6728653">:=</span>&nbsp;<span class="string" id="6728656">&#34;abc\r\n..def\r\n...ghi\r\n..jkl\r\n..\r\n.\r\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6728706">if</span>&nbsp;<span class="ident" id="6728709">s</span>&nbsp;<span class="op" id="6728711">:=</span>&nbsp;<span class="ident" id="6728714">buf</span><span class="op" id="6728717">.</span><span class="ident" id="6728718">String</span><span class="op" id="6728724">(</span><span class="op" id="6728725">)</span><span class="op" id="6728726">;</span>&nbsp;<span class="ident" id="6728728">s</span>&nbsp;<span class="op" id="6728730">!=</span>&nbsp;<span class="ident" id="6728733">want</span>&nbsp;<span class="op" id="6728738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6728742">t</span><span class="op" id="6728743">.</span><span class="ident" id="6728744">Fatalf</span><span class="op" id="6728750">(</span><span class="string" id="6728751">&#34;wrote&nbsp;%q&#34;</span><span class="op" id="6728761">,</span>&nbsp;<span class="ident" id="6728763">s</span><span class="op" id="6728764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6728767">}</span><br>
<span class="lineno">35</span><span class="op" id="6728769">}</span>
</div>
</body>
</html>
