<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8516523">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8516579">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8516633">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8516684">package</span>&nbsp;<span class="ident" id="8516692">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8516698">import</span>&nbsp;<span class="op" id="8516705">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8516708">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8516717">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8516727">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8516734">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8516740">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8516753">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8516764">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8516775">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8516785">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8516788">type</span>&nbsp;<span class="ident" id="8516793">reqWriteTest</span>&nbsp;<span class="keyword" id="8516806">struct</span>&nbsp;<span class="op" id="8516813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516816">Req</span>&nbsp;&nbsp;<span class="ident" id="8516821">Request</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516830">Body</span>&nbsp;<span class="keyword" id="8516835">interface</span><span class="op" id="8516844">{</span><span class="op" id="8516845">}</span>&nbsp;<span class="comment" id="8516847">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8516913">//&nbsp;Any&nbsp;of&nbsp;these&nbsp;three&nbsp;may&nbsp;be&nbsp;empty&nbsp;to&nbsp;skip&nbsp;that&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8516968">WantWrite</span>&nbsp;<span class="builtintype" id="8516978">string</span>&nbsp;<span class="comment" id="8516985">//&nbsp;Request.Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517003">WantProxy</span>&nbsp;<span class="builtintype" id="8517013">string</span>&nbsp;<span class="comment" id="8517020">//&nbsp;Request.WriteProxy</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517044">WantError</span>&nbsp;<span class="builtintype" id="8517054">error</span>&nbsp;<span class="comment" id="8517060">//&nbsp;wanted&nbsp;error&nbsp;from&nbsp;Request.Write</span><br>
<span class="lineno"></span><span class="op" id="8517095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8517098">var</span>&nbsp;<span class="ident" id="8517102">reqWriteTests</span>&nbsp;<span class="op" id="8517116">=</span>&nbsp;<span class="op" id="8517118">[</span><span class="op" id="8517119">]</span><span class="ident" id="8517120">reqWriteTest</span><span class="op" id="8517132">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8517135">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;no&nbsp;body;&nbsp;no&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517191">Req</span><span class="op" id="8517194">:</span>&nbsp;<span class="ident" id="8517196">Request</span><span class="op" id="8517203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517208">Method</span><span class="op" id="8517214">:</span>&nbsp;<span class="string" id="8517216">&#34;GET&#34;</span><span class="op" id="8517221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517226">URL</span><span class="op" id="8517229">:</span>&nbsp;<span class="op" id="8517231">&amp;</span><span class="ident" id="8517232">url</span><span class="op" id="8517235">.</span><span class="ident" id="8517236">URL</span><span class="op" id="8517239">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517245">Scheme</span><span class="op" id="8517251">:</span>&nbsp;<span class="string" id="8517253">&#34;http&#34;</span><span class="op" id="8517259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517265">Host</span><span class="op" id="8517269">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8517273">&#34;www.techcrunch.com&#34;</span><span class="op" id="8517293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517299">Path</span><span class="op" id="8517303">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8517307">&#34;/&#34;</span><span class="op" id="8517310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517315">}</span><span class="op" id="8517316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517321">Proto</span><span class="op" id="8517326">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8517333">&#34;HTTP/1.1&#34;</span><span class="op" id="8517343">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517348">ProtoMajor</span><span class="op" id="8517358">:</span>&nbsp;<span class="num" id="8517360">1</span><span class="op" id="8517361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517366">ProtoMinor</span><span class="op" id="8517376">:</span>&nbsp;<span class="num" id="8517378">1</span><span class="op" id="8517379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517384">Header</span><span class="op" id="8517390">:</span>&nbsp;<span class="ident" id="8517392">Header</span><span class="op" id="8517398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8517404">&#34;Accept&#34;</span><span class="op" id="8517412">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8517424">{</span><span class="string" id="8517425">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#34;</span><span class="op" id="8517490">}</span><span class="op" id="8517491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8517497">&#34;Accept-Charset&#34;</span><span class="op" id="8517513">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8517517">{</span><span class="string" id="8517518">&#34;ISO-8859-1,utf-8;q=0.7,*;q=0.7&#34;</span><span class="op" id="8517550">}</span><span class="op" id="8517551">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8517557">&#34;Accept-Encoding&#34;</span><span class="op" id="8517574">:</span>&nbsp;&nbsp;<span class="op" id="8517577">{</span><span class="string" id="8517578">&#34;gzip,deflate&#34;</span><span class="op" id="8517592">}</span><span class="op" id="8517593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8517599">&#34;Accept-Language&#34;</span><span class="op" id="8517616">:</span>&nbsp;&nbsp;<span class="op" id="8517619">{</span><span class="string" id="8517620">&#34;en-us,en;q=0.5&#34;</span><span class="op" id="8517636">}</span><span class="op" id="8517637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8517643">&#34;Keep-Alive&#34;</span><span class="op" id="8517655">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8517663">{</span><span class="string" id="8517664">&#34;300&#34;</span><span class="op" id="8517669">}</span><span class="op" id="8517670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8517676">&#34;Proxy-Connection&#34;</span><span class="op" id="8517694">:</span>&nbsp;<span class="op" id="8517696">{</span><span class="string" id="8517697">&#34;keep-alive&#34;</span><span class="op" id="8517709">}</span><span class="op" id="8517710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8517716">&#34;User-Agent&#34;</span><span class="op" id="8517728">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8517736">{</span><span class="string" id="8517737">&#34;Fake&#34;</span><span class="op" id="8517743">}</span><span class="op" id="8517744">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517749">}</span><span class="op" id="8517750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517755">Body</span><span class="op" id="8517759">:</span>&nbsp;&nbsp;<span class="ident" id="8517762">nil</span><span class="op" id="8517765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517770">Close</span><span class="op" id="8517775">:</span>&nbsp;<span class="builtintype" id="8517777">false</span><span class="op" id="8517782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517787">Host</span><span class="op" id="8517791">:</span>&nbsp;&nbsp;<span class="string" id="8517794">&#34;www.techcrunch.com&#34;</span><span class="op" id="8517814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517819">Form</span><span class="op" id="8517823">:</span>&nbsp;&nbsp;<span class="keyword" id="8517826">map</span><span class="op" id="8517829">[</span><span class="builtintype" id="8517830">string</span><span class="op" id="8517836">]</span><span class="op" id="8517837">[</span><span class="op" id="8517838">]</span><span class="builtintype" id="8517839">string</span><span class="op" id="8517845">{</span><span class="op" id="8517846">}</span><span class="op" id="8517847">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8517851">}</span><span class="op" id="8517852">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8517857">WantWrite</span><span class="op" id="8517866">:</span>&nbsp;<span class="string" id="8517868">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8517889">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8517894">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="8517925">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8517930">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="8517953">+</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8517958">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="8518036">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518041">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="8518094">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518099">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="8518135">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518140">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="8518178">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518183">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="8518205">+</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518210">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="8518248">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518253">WantProxy</span><span class="op" id="8518262">:</span>&nbsp;<span class="string" id="8518264">&#34;GET&nbsp;http://www.techcrunch.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8518310">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518315">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="8518346">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518351">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="8518374">+</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518379">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="8518457">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518462">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="8518515">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518520">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="8518556">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518561">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="8518599">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518604">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="8518626">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8518631">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="8518669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518672">}</span><span class="op" id="8518673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8518676">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518732">Req</span><span class="op" id="8518735">:</span>&nbsp;<span class="ident" id="8518737">Request</span><span class="op" id="8518744">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518749">Method</span><span class="op" id="8518755">:</span>&nbsp;<span class="string" id="8518757">&#34;GET&#34;</span><span class="op" id="8518762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518767">URL</span><span class="op" id="8518770">:</span>&nbsp;<span class="op" id="8518772">&amp;</span><span class="ident" id="8518773">url</span><span class="op" id="8518776">.</span><span class="ident" id="8518777">URL</span><span class="op" id="8518780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518786">Scheme</span><span class="op" id="8518792">:</span>&nbsp;<span class="string" id="8518794">&#34;http&#34;</span><span class="op" id="8518800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518806">Host</span><span class="op" id="8518810">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8518814">&#34;www.google.com&#34;</span><span class="op" id="8518830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518836">Path</span><span class="op" id="8518840">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8518844">&#34;/search&#34;</span><span class="op" id="8518853">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518858">}</span><span class="op" id="8518859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518864">ProtoMajor</span><span class="op" id="8518874">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8518882">1</span><span class="op" id="8518883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518888">ProtoMinor</span><span class="op" id="8518898">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8518906">1</span><span class="op" id="8518907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518912">Header</span><span class="op" id="8518918">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8518930">Header</span><span class="op" id="8518936">{</span><span class="op" id="8518937">}</span><span class="op" id="8518938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518943">TransferEncoding</span><span class="op" id="8518959">:</span>&nbsp;<span class="op" id="8518961">[</span><span class="op" id="8518962">]</span><span class="builtintype" id="8518963">string</span><span class="op" id="8518969">{</span><span class="string" id="8518970">&#34;chunked&#34;</span><span class="op" id="8518979">}</span><span class="op" id="8518980">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8518984">}</span><span class="op" id="8518985">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8518990">Body</span><span class="op" id="8518994">:</span>&nbsp;<span class="op" id="8518996">[</span><span class="op" id="8518997">]</span><span class="builtintype" id="8518998">byte</span><span class="op" id="8519002">(</span><span class="string" id="8519003">&#34;abcdef&#34;</span><span class="op" id="8519011">)</span><span class="op" id="8519012">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519017">WantWrite</span><span class="op" id="8519026">:</span>&nbsp;<span class="string" id="8519028">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8519055">+</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8519060">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8519087">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8519092">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8519130">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8519135">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8519172">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519177">chunk</span><span class="op" id="8519182">(</span><span class="string" id="8519183">&#34;abcdef&#34;</span><span class="op" id="8519191">)</span>&nbsp;<span class="op" id="8519193">+</span>&nbsp;<span class="ident" id="8519195">chunk</span><span class="op" id="8519200">(</span><span class="string" id="8519201">&#34;&#34;</span><span class="op" id="8519203">)</span><span class="op" id="8519204">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519209">WantProxy</span><span class="op" id="8519218">:</span>&nbsp;<span class="string" id="8519220">&#34;GET&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8519268">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8519273">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8519300">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8519305">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8519343">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8519348">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8519385">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519390">chunk</span><span class="op" id="8519395">(</span><span class="string" id="8519396">&#34;abcdef&#34;</span><span class="op" id="8519404">)</span>&nbsp;<span class="op" id="8519406">+</span>&nbsp;<span class="ident" id="8519408">chunk</span><span class="op" id="8519413">(</span><span class="string" id="8519414">&#34;&#34;</span><span class="op" id="8519416">)</span><span class="op" id="8519417">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519420">}</span><span class="op" id="8519421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8519424">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519485">Req</span><span class="op" id="8519488">:</span>&nbsp;<span class="ident" id="8519490">Request</span><span class="op" id="8519497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519502">Method</span><span class="op" id="8519508">:</span>&nbsp;<span class="string" id="8519510">&#34;POST&#34;</span><span class="op" id="8519516">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519521">URL</span><span class="op" id="8519524">:</span>&nbsp;<span class="op" id="8519526">&amp;</span><span class="ident" id="8519527">url</span><span class="op" id="8519530">.</span><span class="ident" id="8519531">URL</span><span class="op" id="8519534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519540">Scheme</span><span class="op" id="8519546">:</span>&nbsp;<span class="string" id="8519548">&#34;http&#34;</span><span class="op" id="8519554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519560">Host</span><span class="op" id="8519564">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8519568">&#34;www.google.com&#34;</span><span class="op" id="8519584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519590">Path</span><span class="op" id="8519594">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8519598">&#34;/search&#34;</span><span class="op" id="8519607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519612">}</span><span class="op" id="8519613">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519618">ProtoMajor</span><span class="op" id="8519628">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8519636">1</span><span class="op" id="8519637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519642">ProtoMinor</span><span class="op" id="8519652">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8519660">1</span><span class="op" id="8519661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519666">Header</span><span class="op" id="8519672">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8519684">Header</span><span class="op" id="8519690">{</span><span class="op" id="8519691">}</span><span class="op" id="8519692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519697">Close</span><span class="op" id="8519702">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8519715">true</span><span class="op" id="8519719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519724">TransferEncoding</span><span class="op" id="8519740">:</span>&nbsp;<span class="op" id="8519742">[</span><span class="op" id="8519743">]</span><span class="builtintype" id="8519744">string</span><span class="op" id="8519750">{</span><span class="string" id="8519751">&#34;chunked&#34;</span><span class="op" id="8519760">}</span><span class="op" id="8519761">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8519765">}</span><span class="op" id="8519766">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519771">Body</span><span class="op" id="8519775">:</span>&nbsp;<span class="op" id="8519777">[</span><span class="op" id="8519778">]</span><span class="builtintype" id="8519779">byte</span><span class="op" id="8519783">(</span><span class="string" id="8519784">&#34;abcdef&#34;</span><span class="op" id="8519792">)</span><span class="op" id="8519793">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519798">WantWrite</span><span class="op" id="8519807">:</span>&nbsp;<span class="string" id="8519809">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8519837">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8519842">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8519869">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8519874">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8519912">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8519917">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8519941">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8519946">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8519983">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8519988">chunk</span><span class="op" id="8519993">(</span><span class="string" id="8519994">&#34;abcdef&#34;</span><span class="op" id="8520002">)</span>&nbsp;<span class="op" id="8520004">+</span>&nbsp;<span class="ident" id="8520006">chunk</span><span class="op" id="8520011">(</span><span class="string" id="8520012">&#34;&#34;</span><span class="op" id="8520014">)</span><span class="op" id="8520015">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520020">WantProxy</span><span class="op" id="8520029">:</span>&nbsp;<span class="string" id="8520031">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8520080">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520085">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8520112">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520117">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8520155">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520160">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8520184">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520189">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8520226">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520231">chunk</span><span class="op" id="8520236">(</span><span class="string" id="8520237">&#34;abcdef&#34;</span><span class="op" id="8520245">)</span>&nbsp;<span class="op" id="8520247">+</span>&nbsp;<span class="ident" id="8520249">chunk</span><span class="op" id="8520254">(</span><span class="string" id="8520255">&#34;&#34;</span><span class="op" id="8520257">)</span><span class="op" id="8520258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520261">}</span><span class="op" id="8520262">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8520266">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length,&nbsp;no&nbsp;chunking</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520321">Req</span><span class="op" id="8520324">:</span>&nbsp;<span class="ident" id="8520326">Request</span><span class="op" id="8520333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520338">Method</span><span class="op" id="8520344">:</span>&nbsp;<span class="string" id="8520346">&#34;POST&#34;</span><span class="op" id="8520352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520357">URL</span><span class="op" id="8520360">:</span>&nbsp;<span class="op" id="8520362">&amp;</span><span class="ident" id="8520363">url</span><span class="op" id="8520366">.</span><span class="ident" id="8520367">URL</span><span class="op" id="8520370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520376">Scheme</span><span class="op" id="8520382">:</span>&nbsp;<span class="string" id="8520384">&#34;http&#34;</span><span class="op" id="8520390">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520396">Host</span><span class="op" id="8520400">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8520404">&#34;www.google.com&#34;</span><span class="op" id="8520420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520426">Path</span><span class="op" id="8520430">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8520434">&#34;/search&#34;</span><span class="op" id="8520443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520448">}</span><span class="op" id="8520449">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520454">ProtoMajor</span><span class="op" id="8520464">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8520469">1</span><span class="op" id="8520470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520475">ProtoMinor</span><span class="op" id="8520485">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8520490">1</span><span class="op" id="8520491">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520496">Header</span><span class="op" id="8520502">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8520511">Header</span><span class="op" id="8520517">{</span><span class="op" id="8520518">}</span><span class="op" id="8520519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520524">Close</span><span class="op" id="8520529">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8520539">true</span><span class="op" id="8520543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520548">ContentLength</span><span class="op" id="8520561">:</span>&nbsp;<span class="num" id="8520563">6</span><span class="op" id="8520564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8520568">}</span><span class="op" id="8520569">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520574">Body</span><span class="op" id="8520578">:</span>&nbsp;<span class="op" id="8520580">[</span><span class="op" id="8520581">]</span><span class="builtintype" id="8520582">byte</span><span class="op" id="8520586">(</span><span class="string" id="8520587">&#34;abcdef&#34;</span><span class="op" id="8520595">)</span><span class="op" id="8520596">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520601">WantWrite</span><span class="op" id="8520610">:</span>&nbsp;<span class="string" id="8520612">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8520640">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520645">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8520672">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520677">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8520715">+</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520720">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8520744">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520749">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8520773">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520778">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8520785">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520790">&#34;abcdef&#34;</span><span class="op" id="8520798">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8520803">WantProxy</span><span class="op" id="8520812">:</span>&nbsp;<span class="string" id="8520814">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8520863">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520868">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8520895">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520900">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8520938">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520943">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8520967">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8520972">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8520996">+</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521001">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8521008">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521013">&#34;abcdef&#34;</span><span class="op" id="8521021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521024">}</span><span class="op" id="8521025">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8521029">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length&nbsp;in&nbsp;headers</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521082">Req</span><span class="op" id="8521085">:</span>&nbsp;<span class="ident" id="8521087">Request</span><span class="op" id="8521094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521099">Method</span><span class="op" id="8521105">:</span>&nbsp;<span class="string" id="8521107">&#34;POST&#34;</span><span class="op" id="8521113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521118">URL</span><span class="op" id="8521121">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8521126">mustParseURL</span><span class="op" id="8521138">(</span><span class="string" id="8521139">&#34;http://example.com/&#34;</span><span class="op" id="8521160">)</span><span class="op" id="8521161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521166">Host</span><span class="op" id="8521170">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8521174">&#34;example.com&#34;</span><span class="op" id="8521187">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521192">Header</span><span class="op" id="8521198">:</span>&nbsp;<span class="ident" id="8521200">Header</span><span class="op" id="8521206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521212">&#34;Content-Length&#34;</span><span class="op" id="8521228">:</span>&nbsp;<span class="op" id="8521230">[</span><span class="op" id="8521231">]</span><span class="builtintype" id="8521232">string</span><span class="op" id="8521238">{</span><span class="string" id="8521239">&#34;10&#34;</span><span class="op" id="8521243">}</span><span class="op" id="8521244">,</span>&nbsp;<span class="comment" id="8521246">//&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521260">}</span><span class="op" id="8521261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521266">ContentLength</span><span class="op" id="8521279">:</span>&nbsp;<span class="num" id="8521281">6</span><span class="op" id="8521282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521286">}</span><span class="op" id="8521287">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521292">Body</span><span class="op" id="8521296">:</span>&nbsp;<span class="op" id="8521298">[</span><span class="op" id="8521299">]</span><span class="builtintype" id="8521300">byte</span><span class="op" id="8521304">(</span><span class="string" id="8521305">&#34;abcdef&#34;</span><span class="op" id="8521313">)</span><span class="op" id="8521314">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521319">WantWrite</span><span class="op" id="8521328">:</span>&nbsp;<span class="string" id="8521330">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8521352">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521357">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8521381">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521386">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8521424">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521429">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8521453">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521458">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8521465">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521470">&#34;abcdef&#34;</span><span class="op" id="8521478">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521483">WantProxy</span><span class="op" id="8521492">:</span>&nbsp;<span class="string" id="8521494">&#34;POST&nbsp;http://example.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8521534">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521539">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8521563">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521568">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8521606">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521611">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8521635">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521640">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8521647">+</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521652">&#34;abcdef&#34;</span><span class="op" id="8521660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521663">}</span><span class="op" id="8521664">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8521668">//&nbsp;default&nbsp;to&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521692">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521696">Req</span><span class="op" id="8521699">:</span>&nbsp;<span class="ident" id="8521701">Request</span><span class="op" id="8521708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521713">Method</span><span class="op" id="8521719">:</span>&nbsp;<span class="string" id="8521721">&#34;GET&#34;</span><span class="op" id="8521726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521731">URL</span><span class="op" id="8521734">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8521739">mustParseURL</span><span class="op" id="8521751">(</span><span class="string" id="8521752">&#34;/search&#34;</span><span class="op" id="8521761">)</span><span class="op" id="8521762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521767">Host</span><span class="op" id="8521771">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8521775">&#34;www.google.com&#34;</span><span class="op" id="8521791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521795">}</span><span class="op" id="8521796">,</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521801">WantWrite</span><span class="op" id="8521810">:</span>&nbsp;<span class="string" id="8521812">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8521839">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521844">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8521871">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521876">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8521914">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8521919">&#34;\r\n&#34;</span><span class="op" id="8521925">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521928">}</span><span class="op" id="8521929">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8521933">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;0&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8521987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8521991">Req</span><span class="op" id="8521994">:</span>&nbsp;<span class="ident" id="8521996">Request</span><span class="op" id="8522003">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522008">Method</span><span class="op" id="8522014">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8522023">&#34;POST&#34;</span><span class="op" id="8522029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522034">URL</span><span class="op" id="8522037">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8522049">mustParseURL</span><span class="op" id="8522061">(</span><span class="string" id="8522062">&#34;/&#34;</span><span class="op" id="8522065">)</span><span class="op" id="8522066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522071">Host</span><span class="op" id="8522075">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8522086">&#34;example.com&#34;</span><span class="op" id="8522099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522104">ProtoMajor</span><span class="op" id="8522114">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8522119">1</span><span class="op" id="8522120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522125">ProtoMinor</span><span class="op" id="8522135">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8522140">1</span><span class="op" id="8522141">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522146">ContentLength</span><span class="op" id="8522159">:</span>&nbsp;<span class="num" id="8522161">0</span><span class="op" id="8522162">,</span>&nbsp;<span class="comment" id="8522164">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522189">}</span><span class="op" id="8522190">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522195">Body</span><span class="op" id="8522199">:</span>&nbsp;<span class="keyword" id="8522201">func</span><span class="op" id="8522205">(</span><span class="op" id="8522206">)</span>&nbsp;<span class="ident" id="8522208">io</span><span class="op" id="8522210">.</span><span class="ident" id="8522211">ReadCloser</span>&nbsp;<span class="op" id="8522222">{</span>&nbsp;<span class="keyword" id="8522224">return</span>&nbsp;<span class="ident" id="8522231">ioutil</span><span class="op" id="8522237">.</span><span class="ident" id="8522238">NopCloser</span><span class="op" id="8522247">(</span><span class="ident" id="8522248">io</span><span class="op" id="8522250">.</span><span class="ident" id="8522251">LimitReader</span><span class="op" id="8522262">(</span><span class="ident" id="8522263">strings</span><span class="op" id="8522270">.</span><span class="ident" id="8522271">NewReader</span><span class="op" id="8522280">(</span><span class="string" id="8522281">&#34;xx&#34;</span><span class="op" id="8522285">)</span><span class="op" id="8522286">,</span>&nbsp;<span class="num" id="8522288">0</span><span class="op" id="8522289">)</span><span class="op" id="8522290">)</span>&nbsp;<span class="op" id="8522292">}</span><span class="op" id="8522293">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8522298">//&nbsp;RFC&nbsp;2616&nbsp;Section&nbsp;14.13&nbsp;says&nbsp;Content-Length&nbsp;should&nbsp;be&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8522366">//&nbsp;unless&nbsp;body&nbsp;is&nbsp;prohibited&nbsp;by&nbsp;the&nbsp;request&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8522420">//&nbsp;Also,&nbsp;nginx&nbsp;expects&nbsp;it&nbsp;for&nbsp;POST&nbsp;and&nbsp;PUT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522466">WantWrite</span><span class="op" id="8522475">:</span>&nbsp;<span class="string" id="8522477">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8522499">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8522504">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8522528">+</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8522533">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8522571">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8522576">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="8522600">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8522605">&#34;\r\n&#34;</span><span class="op" id="8522611">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522616">WantProxy</span><span class="op" id="8522625">:</span>&nbsp;<span class="string" id="8522627">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8522649">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8522654">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8522678">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8522683">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8522721">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8522726">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="8522750">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8522755">&#34;\r\n&#34;</span><span class="op" id="8522761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522764">}</span><span class="op" id="8522765">,</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8522769">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;1&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8522823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522827">Req</span><span class="op" id="8522830">:</span>&nbsp;<span class="ident" id="8522832">Request</span><span class="op" id="8522839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522844">Method</span><span class="op" id="8522850">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8522859">&#34;POST&#34;</span><span class="op" id="8522865">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522870">URL</span><span class="op" id="8522873">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8522885">mustParseURL</span><span class="op" id="8522897">(</span><span class="string" id="8522898">&#34;/&#34;</span><span class="op" id="8522901">)</span><span class="op" id="8522902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522907">Host</span><span class="op" id="8522911">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8522922">&#34;example.com&#34;</span><span class="op" id="8522935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522940">ProtoMajor</span><span class="op" id="8522950">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8522955">1</span><span class="op" id="8522956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522961">ProtoMinor</span><span class="op" id="8522971">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8522976">1</span><span class="op" id="8522977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8522982">ContentLength</span><span class="op" id="8522995">:</span>&nbsp;<span class="num" id="8522997">0</span><span class="op" id="8522998">,</span>&nbsp;<span class="comment" id="8523000">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523025">}</span><span class="op" id="8523026">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523031">Body</span><span class="op" id="8523035">:</span>&nbsp;<span class="keyword" id="8523037">func</span><span class="op" id="8523041">(</span><span class="op" id="8523042">)</span>&nbsp;<span class="ident" id="8523044">io</span><span class="op" id="8523046">.</span><span class="ident" id="8523047">ReadCloser</span>&nbsp;<span class="op" id="8523058">{</span>&nbsp;<span class="keyword" id="8523060">return</span>&nbsp;<span class="ident" id="8523067">ioutil</span><span class="op" id="8523073">.</span><span class="ident" id="8523074">NopCloser</span><span class="op" id="8523083">(</span><span class="ident" id="8523084">io</span><span class="op" id="8523086">.</span><span class="ident" id="8523087">LimitReader</span><span class="op" id="8523098">(</span><span class="ident" id="8523099">strings</span><span class="op" id="8523106">.</span><span class="ident" id="8523107">NewReader</span><span class="op" id="8523116">(</span><span class="string" id="8523117">&#34;xx&#34;</span><span class="op" id="8523121">)</span><span class="op" id="8523122">,</span>&nbsp;<span class="num" id="8523124">1</span><span class="op" id="8523125">)</span><span class="op" id="8523126">)</span>&nbsp;<span class="op" id="8523128">}</span><span class="op" id="8523129">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523134">WantWrite</span><span class="op" id="8523143">:</span>&nbsp;<span class="string" id="8523145">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8523167">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8523172">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8523196">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8523201">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8523239">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8523244">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8523281">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523286">chunk</span><span class="op" id="8523291">(</span><span class="string" id="8523292">&#34;x&#34;</span><span class="op" id="8523295">)</span>&nbsp;<span class="op" id="8523297">+</span>&nbsp;<span class="ident" id="8523299">chunk</span><span class="op" id="8523304">(</span><span class="string" id="8523305">&#34;&#34;</span><span class="op" id="8523307">)</span><span class="op" id="8523308">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523313">WantProxy</span><span class="op" id="8523322">:</span>&nbsp;<span class="string" id="8523324">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8523346">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8523351">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8523375">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8523380">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8523418">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8523423">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8523460">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523465">chunk</span><span class="op" id="8523470">(</span><span class="string" id="8523471">&#34;x&#34;</span><span class="op" id="8523474">)</span>&nbsp;<span class="op" id="8523476">+</span>&nbsp;<span class="ident" id="8523478">chunk</span><span class="op" id="8523483">(</span><span class="string" id="8523484">&#34;&#34;</span><span class="op" id="8523486">)</span><span class="op" id="8523487">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523490">}</span><span class="op" id="8523491">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8523495">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;10&nbsp;but&nbsp;a&nbsp;5&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523557">Req</span><span class="op" id="8523560">:</span>&nbsp;<span class="ident" id="8523562">Request</span><span class="op" id="8523569">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523574">Method</span><span class="op" id="8523580">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8523589">&#34;POST&#34;</span><span class="op" id="8523595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523600">URL</span><span class="op" id="8523603">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8523615">mustParseURL</span><span class="op" id="8523627">(</span><span class="string" id="8523628">&#34;/&#34;</span><span class="op" id="8523631">)</span><span class="op" id="8523632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523637">Host</span><span class="op" id="8523641">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8523652">&#34;example.com&#34;</span><span class="op" id="8523665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523670">ProtoMajor</span><span class="op" id="8523680">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8523685">1</span><span class="op" id="8523686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523691">ProtoMinor</span><span class="op" id="8523701">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8523706">1</span><span class="op" id="8523707">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523712">ContentLength</span><span class="op" id="8523725">:</span>&nbsp;<span class="num" id="8523727">10</span><span class="op" id="8523729">,</span>&nbsp;<span class="comment" id="8523731">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;send&nbsp;only&nbsp;5&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523773">}</span><span class="op" id="8523774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523778">Body</span><span class="op" id="8523782">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8523789">[</span><span class="op" id="8523790">]</span><span class="builtintype" id="8523791">byte</span><span class="op" id="8523795">(</span><span class="string" id="8523796">&#34;12345&#34;</span><span class="op" id="8523803">)</span><span class="op" id="8523804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523808">WantError</span><span class="op" id="8523817">:</span>&nbsp;<span class="ident" id="8523819">errors</span><span class="op" id="8523825">.</span><span class="ident" id="8523826">New</span><span class="op" id="8523829">(</span><span class="string" id="8523830">&#34;http:&nbsp;ContentLength=10&nbsp;with&nbsp;Body&nbsp;length&nbsp;5&#34;</span><span class="op" id="8523873">)</span><span class="op" id="8523874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523877">}</span><span class="op" id="8523878">,</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8523882">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;4&nbsp;but&nbsp;an&nbsp;8&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8523940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523944">Req</span><span class="op" id="8523947">:</span>&nbsp;<span class="ident" id="8523949">Request</span><span class="op" id="8523956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523961">Method</span><span class="op" id="8523967">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8523976">&#34;POST&#34;</span><span class="op" id="8523982">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8523987">URL</span><span class="op" id="8523990">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8524002">mustParseURL</span><span class="op" id="8524014">(</span><span class="string" id="8524015">&#34;/&#34;</span><span class="op" id="8524018">)</span><span class="op" id="8524019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524024">Host</span><span class="op" id="8524028">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8524039">&#34;example.com&#34;</span><span class="op" id="8524052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524057">ProtoMajor</span><span class="op" id="8524067">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8524072">1</span><span class="op" id="8524073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524078">ProtoMinor</span><span class="op" id="8524088">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8524093">1</span><span class="op" id="8524094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524099">ContentLength</span><span class="op" id="8524112">:</span>&nbsp;<span class="num" id="8524114">4</span><span class="op" id="8524115">,</span>&nbsp;<span class="comment" id="8524117">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;try&nbsp;to&nbsp;send&nbsp;8&nbsp;bytes</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524161">}</span><span class="op" id="8524162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524166">Body</span><span class="op" id="8524170">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8524177">[</span><span class="op" id="8524178">]</span><span class="builtintype" id="8524179">byte</span><span class="op" id="8524183">(</span><span class="string" id="8524184">&#34;12345678&#34;</span><span class="op" id="8524194">)</span><span class="op" id="8524195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524199">WantError</span><span class="op" id="8524208">:</span>&nbsp;<span class="ident" id="8524210">errors</span><span class="op" id="8524216">.</span><span class="ident" id="8524217">New</span><span class="op" id="8524220">(</span><span class="string" id="8524221">&#34;http:&nbsp;ContentLength=4&nbsp;with&nbsp;Body&nbsp;length&nbsp;8&#34;</span><span class="op" id="8524263">)</span><span class="op" id="8524264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524267">}</span><span class="op" id="8524268">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8524272">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;5&nbsp;ContentLength&nbsp;and&nbsp;nil&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524325">Req</span><span class="op" id="8524328">:</span>&nbsp;<span class="ident" id="8524330">Request</span><span class="op" id="8524337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524342">Method</span><span class="op" id="8524348">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8524357">&#34;POST&#34;</span><span class="op" id="8524363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524368">URL</span><span class="op" id="8524371">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8524383">mustParseURL</span><span class="op" id="8524395">(</span><span class="string" id="8524396">&#34;/&#34;</span><span class="op" id="8524399">)</span><span class="op" id="8524400">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524405">Host</span><span class="op" id="8524409">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8524420">&#34;example.com&#34;</span><span class="op" id="8524433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524438">ProtoMajor</span><span class="op" id="8524448">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8524453">1</span><span class="op" id="8524454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524459">ProtoMinor</span><span class="op" id="8524469">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8524474">1</span><span class="op" id="8524475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524480">ContentLength</span><span class="op" id="8524493">:</span>&nbsp;<span class="num" id="8524495">5</span><span class="op" id="8524496">,</span>&nbsp;<span class="comment" id="8524498">//&nbsp;but&nbsp;we&#39;ll&nbsp;omit&nbsp;the&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524527">}</span><span class="op" id="8524528">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524532">WantError</span><span class="op" id="8524541">:</span>&nbsp;<span class="ident" id="8524543">errors</span><span class="op" id="8524549">.</span><span class="ident" id="8524550">New</span><span class="op" id="8524553">(</span><span class="string" id="8524554">&#34;http:&nbsp;Request.ContentLength=5&nbsp;with&nbsp;nil&nbsp;Body&#34;</span><span class="op" id="8524599">)</span><span class="op" id="8524600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524603">}</span><span class="op" id="8524604">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8524608">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;with&nbsp;1&nbsp;byte&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524688">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524692">Req</span><span class="op" id="8524695">:</span>&nbsp;<span class="ident" id="8524697">Request</span><span class="op" id="8524704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524709">Method</span><span class="op" id="8524715">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8524724">&#34;POST&#34;</span><span class="op" id="8524730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524735">URL</span><span class="op" id="8524738">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8524750">mustParseURL</span><span class="op" id="8524762">(</span><span class="string" id="8524763">&#34;/&#34;</span><span class="op" id="8524766">)</span><span class="op" id="8524767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524772">Host</span><span class="op" id="8524776">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8524787">&#34;example.com&#34;</span><span class="op" id="8524800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524805">ProtoMajor</span><span class="op" id="8524815">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8524820">1</span><span class="op" id="8524821">,</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524826">ProtoMinor</span><span class="op" id="8524836">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8524841">1</span><span class="op" id="8524842">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524847">ContentLength</span><span class="op" id="8524860">:</span>&nbsp;<span class="num" id="8524862">0</span><span class="op" id="8524863">,</span>&nbsp;<span class="comment" id="8524865">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8524890">}</span><span class="op" id="8524891">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524896">Body</span><span class="op" id="8524900">:</span>&nbsp;<span class="keyword" id="8524902">func</span><span class="op" id="8524906">(</span><span class="op" id="8524907">)</span>&nbsp;<span class="ident" id="8524909">io</span><span class="op" id="8524911">.</span><span class="ident" id="8524912">ReadCloser</span>&nbsp;<span class="op" id="8524923">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524928">err</span>&nbsp;<span class="op" id="8524932">:=</span>&nbsp;<span class="ident" id="8524935">errors</span><span class="op" id="8524941">.</span><span class="ident" id="8524942">New</span><span class="op" id="8524945">(</span><span class="string" id="8524946">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8524967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8524972">errReader</span>&nbsp;<span class="op" id="8524982">:=</span>&nbsp;<span class="op" id="8524985">&amp;</span><span class="ident" id="8524986">errorReader</span><span class="op" id="8524997">{</span><span class="ident" id="8524998">err</span><span class="op" id="8525001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8525006">return</span>&nbsp;<span class="ident" id="8525013">ioutil</span><span class="op" id="8525019">.</span><span class="ident" id="8525020">NopCloser</span><span class="op" id="8525029">(</span><span class="ident" id="8525030">io</span><span class="op" id="8525032">.</span><span class="ident" id="8525033">MultiReader</span><span class="op" id="8525044">(</span><span class="ident" id="8525045">strings</span><span class="op" id="8525052">.</span><span class="ident" id="8525053">NewReader</span><span class="op" id="8525062">(</span><span class="string" id="8525063">&#34;x&#34;</span><span class="op" id="8525066">)</span><span class="op" id="8525067">,</span>&nbsp;<span class="ident" id="8525069">errReader</span><span class="op" id="8525078">)</span><span class="op" id="8525079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525083">}</span><span class="op" id="8525084">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525089">WantError</span><span class="op" id="8525098">:</span>&nbsp;<span class="ident" id="8525100">errors</span><span class="op" id="8525106">.</span><span class="ident" id="8525107">New</span><span class="op" id="8525110">(</span><span class="string" id="8525111">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8525132">)</span><span class="op" id="8525133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525136">}</span><span class="op" id="8525137">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8525141">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;without&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525217">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525221">Req</span><span class="op" id="8525224">:</span>&nbsp;<span class="ident" id="8525226">Request</span><span class="op" id="8525233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525238">Method</span><span class="op" id="8525244">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8525253">&#34;POST&#34;</span><span class="op" id="8525259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525264">URL</span><span class="op" id="8525267">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8525279">mustParseURL</span><span class="op" id="8525291">(</span><span class="string" id="8525292">&#34;/&#34;</span><span class="op" id="8525295">)</span><span class="op" id="8525296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525301">Host</span><span class="op" id="8525305">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8525316">&#34;example.com&#34;</span><span class="op" id="8525329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525334">ProtoMajor</span><span class="op" id="8525344">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8525349">1</span><span class="op" id="8525350">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525355">ProtoMinor</span><span class="op" id="8525365">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8525370">1</span><span class="op" id="8525371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525376">ContentLength</span><span class="op" id="8525389">:</span>&nbsp;<span class="num" id="8525391">0</span><span class="op" id="8525392">,</span>&nbsp;<span class="comment" id="8525394">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525419">}</span><span class="op" id="8525420">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525425">Body</span><span class="op" id="8525429">:</span>&nbsp;<span class="keyword" id="8525431">func</span><span class="op" id="8525435">(</span><span class="op" id="8525436">)</span>&nbsp;<span class="ident" id="8525438">io</span><span class="op" id="8525440">.</span><span class="ident" id="8525441">ReadCloser</span>&nbsp;<span class="op" id="8525452">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525457">err</span>&nbsp;<span class="op" id="8525461">:=</span>&nbsp;<span class="ident" id="8525464">errors</span><span class="op" id="8525470">.</span><span class="ident" id="8525471">New</span><span class="op" id="8525474">(</span><span class="string" id="8525475">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8525496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525501">errReader</span>&nbsp;<span class="op" id="8525511">:=</span>&nbsp;<span class="op" id="8525514">&amp;</span><span class="ident" id="8525515">errorReader</span><span class="op" id="8525526">{</span><span class="ident" id="8525527">err</span><span class="op" id="8525530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8525535">return</span>&nbsp;<span class="ident" id="8525542">ioutil</span><span class="op" id="8525548">.</span><span class="ident" id="8525549">NopCloser</span><span class="op" id="8525558">(</span><span class="ident" id="8525559">errReader</span><span class="op" id="8525568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525572">}</span><span class="op" id="8525573">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525578">WantError</span><span class="op" id="8525587">:</span>&nbsp;<span class="ident" id="8525589">errors</span><span class="op" id="8525595">.</span><span class="ident" id="8525596">New</span><span class="op" id="8525599">(</span><span class="string" id="8525600">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8525621">)</span><span class="op" id="8525622">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525625">}</span><span class="op" id="8525626">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8525630">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8525713">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525751">Req</span><span class="op" id="8525754">:</span>&nbsp;<span class="ident" id="8525756">Request</span><span class="op" id="8525763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525768">Method</span><span class="op" id="8525774">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8525780">&#34;GET&#34;</span><span class="op" id="8525785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525790">URL</span><span class="op" id="8525793">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8525802">mustParseURL</span><span class="op" id="8525814">(</span><span class="string" id="8525815">&#34;/foo&#34;</span><span class="op" id="8525821">)</span><span class="op" id="8525822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525827">ProtoMajor</span><span class="op" id="8525837">:</span>&nbsp;<span class="num" id="8525839">1</span><span class="op" id="8525840">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525845">ProtoMinor</span><span class="op" id="8525855">:</span>&nbsp;<span class="num" id="8525857">0</span><span class="op" id="8525858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525863">Header</span><span class="op" id="8525869">:</span>&nbsp;<span class="ident" id="8525871">Header</span><span class="op" id="8525877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8525883">&#34;X-Foo&#34;</span><span class="op" id="8525890">:</span>&nbsp;<span class="op" id="8525892">[</span><span class="op" id="8525893">]</span><span class="builtintype" id="8525894">string</span><span class="op" id="8525900">{</span><span class="string" id="8525901">&#34;X-Bar&#34;</span><span class="op" id="8525908">}</span><span class="op" id="8525909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525914">}</span><span class="op" id="8525915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8525919">}</span><span class="op" id="8525920">,</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8525925">WantWrite</span><span class="op" id="8525934">:</span>&nbsp;<span class="string" id="8525936">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8525960">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8525965">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="8525978">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8525983">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8526021">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8526026">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="8526048">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526051">}</span><span class="op" id="8526052">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8526056">//&nbsp;If&nbsp;no&nbsp;Request.Host&nbsp;and&nbsp;no&nbsp;Request.URL.Host,&nbsp;we&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8526112">//&nbsp;an&nbsp;empty&nbsp;Host&nbsp;header,&nbsp;and&nbsp;don&#39;t&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8526152">//&nbsp;Request.Header[&#34;Host&#34;].&nbsp;This&nbsp;is&nbsp;just&nbsp;testing&nbsp;that</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8526206">//&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;Go&nbsp;1.0&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526247">Req</span><span class="op" id="8526250">:</span>&nbsp;<span class="ident" id="8526252">Request</span><span class="op" id="8526259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526264">Method</span><span class="op" id="8526270">:</span>&nbsp;<span class="string" id="8526272">&#34;GET&#34;</span><span class="op" id="8526277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526282">Host</span><span class="op" id="8526286">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8526290">&#34;&#34;</span><span class="op" id="8526292">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526297">URL</span><span class="op" id="8526300">:</span>&nbsp;<span class="op" id="8526302">&amp;</span><span class="ident" id="8526303">url</span><span class="op" id="8526306">.</span><span class="ident" id="8526307">URL</span><span class="op" id="8526310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526316">Scheme</span><span class="op" id="8526322">:</span>&nbsp;<span class="string" id="8526324">&#34;http&#34;</span><span class="op" id="8526330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526336">Host</span><span class="op" id="8526340">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8526344">&#34;&#34;</span><span class="op" id="8526346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526352">Path</span><span class="op" id="8526356">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8526360">&#34;/search&#34;</span><span class="op" id="8526369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526374">}</span><span class="op" id="8526375">,</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526380">ProtoMajor</span><span class="op" id="8526390">:</span>&nbsp;<span class="num" id="8526392">1</span><span class="op" id="8526393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526398">ProtoMinor</span><span class="op" id="8526408">:</span>&nbsp;<span class="num" id="8526410">1</span><span class="op" id="8526411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526416">Header</span><span class="op" id="8526422">:</span>&nbsp;<span class="ident" id="8526424">Header</span><span class="op" id="8526430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8526436">&#34;Host&#34;</span><span class="op" id="8526442">:</span>&nbsp;<span class="op" id="8526444">[</span><span class="op" id="8526445">]</span><span class="builtintype" id="8526446">string</span><span class="op" id="8526452">{</span><span class="string" id="8526453">&#34;bad.example.com&#34;</span><span class="op" id="8526470">}</span><span class="op" id="8526471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526476">}</span><span class="op" id="8526477">,</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526481">}</span><span class="op" id="8526482">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526487">WantWrite</span><span class="op" id="8526496">:</span>&nbsp;<span class="string" id="8526498">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8526525">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8526530">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="8526543">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8526548">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="8526589">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526592">}</span><span class="op" id="8526593">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8526597">//&nbsp;Opaque&nbsp;test&nbsp;#1&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526647">Req</span><span class="op" id="8526650">:</span>&nbsp;<span class="ident" id="8526652">Request</span><span class="op" id="8526659">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526664">Method</span><span class="op" id="8526670">:</span>&nbsp;<span class="string" id="8526672">&#34;GET&#34;</span><span class="op" id="8526677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526682">URL</span><span class="op" id="8526685">:</span>&nbsp;<span class="op" id="8526687">&amp;</span><span class="ident" id="8526688">url</span><span class="op" id="8526691">.</span><span class="ident" id="8526692">URL</span><span class="op" id="8526695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526701">Scheme</span><span class="op" id="8526707">:</span>&nbsp;<span class="string" id="8526709">&#34;http&#34;</span><span class="op" id="8526715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526721">Host</span><span class="op" id="8526725">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8526729">&#34;www.google.com&#34;</span><span class="op" id="8526745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526751">Opaque</span><span class="op" id="8526757">:</span>&nbsp;<span class="string" id="8526759">&#34;/%2F/%2F/&#34;</span><span class="op" id="8526770">,</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526775">}</span><span class="op" id="8526776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526781">ProtoMajor</span><span class="op" id="8526791">:</span>&nbsp;<span class="num" id="8526793">1</span><span class="op" id="8526794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526799">ProtoMinor</span><span class="op" id="8526809">:</span>&nbsp;<span class="num" id="8526811">1</span><span class="op" id="8526812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526817">Header</span><span class="op" id="8526823">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8526829">Header</span><span class="op" id="8526835">{</span><span class="op" id="8526836">}</span><span class="op" id="8526837">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526841">}</span><span class="op" id="8526842">,</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8526847">WantWrite</span><span class="op" id="8526856">:</span>&nbsp;<span class="string" id="8526858">&#34;GET&nbsp;/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8526887">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8526892">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8526919">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8526924">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="8526965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8526968">}</span><span class="op" id="8526969">,</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8526973">//&nbsp;Opaque&nbsp;test&nbsp;#2&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8527019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527023">Req</span><span class="op" id="8527026">:</span>&nbsp;<span class="ident" id="8527028">Request</span><span class="op" id="8527035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527040">Method</span><span class="op" id="8527046">:</span>&nbsp;<span class="string" id="8527048">&#34;GET&#34;</span><span class="op" id="8527053">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527058">URL</span><span class="op" id="8527061">:</span>&nbsp;<span class="op" id="8527063">&amp;</span><span class="ident" id="8527064">url</span><span class="op" id="8527067">.</span><span class="ident" id="8527068">URL</span><span class="op" id="8527071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527077">Scheme</span><span class="op" id="8527083">:</span>&nbsp;<span class="string" id="8527085">&#34;http&#34;</span><span class="op" id="8527091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527097">Host</span><span class="op" id="8527101">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8527105">&#34;x.google.com&#34;</span><span class="op" id="8527119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527125">Opaque</span><span class="op" id="8527131">:</span>&nbsp;<span class="string" id="8527133">&#34;//y.google.com/%2F/%2F/&#34;</span><span class="op" id="8527158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8527163">}</span><span class="op" id="8527164">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527169">ProtoMajor</span><span class="op" id="8527179">:</span>&nbsp;<span class="num" id="8527181">1</span><span class="op" id="8527182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527187">ProtoMinor</span><span class="op" id="8527197">:</span>&nbsp;<span class="num" id="8527199">1</span><span class="op" id="8527200">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527205">Header</span><span class="op" id="8527211">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8527217">Header</span><span class="op" id="8527223">{</span><span class="op" id="8527224">}</span><span class="op" id="8527225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8527229">}</span><span class="op" id="8527230">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527235">WantWrite</span><span class="op" id="8527244">:</span>&nbsp;<span class="string" id="8527246">&#34;GET&nbsp;http://y.google.com/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8527294">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8527299">&#34;Host:&nbsp;x.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8527324">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8527329">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="8527370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8527373">}</span><span class="op" id="8527374">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8527378">//&nbsp;Testing&nbsp;custom&nbsp;case&nbsp;in&nbsp;header&nbsp;keys.&nbsp;Issue&nbsp;5022.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8527430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527434">Req</span><span class="op" id="8527437">:</span>&nbsp;<span class="ident" id="8527439">Request</span><span class="op" id="8527446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527451">Method</span><span class="op" id="8527457">:</span>&nbsp;<span class="string" id="8527459">&#34;GET&#34;</span><span class="op" id="8527464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527469">URL</span><span class="op" id="8527472">:</span>&nbsp;<span class="op" id="8527474">&amp;</span><span class="ident" id="8527475">url</span><span class="op" id="8527478">.</span><span class="ident" id="8527479">URL</span><span class="op" id="8527482">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527488">Scheme</span><span class="op" id="8527494">:</span>&nbsp;<span class="string" id="8527496">&#34;http&#34;</span><span class="op" id="8527502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527508">Host</span><span class="op" id="8527512">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8527516">&#34;www.google.com&#34;</span><span class="op" id="8527532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527538">Path</span><span class="op" id="8527542">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8527546">&#34;/&#34;</span><span class="op" id="8527549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8527554">}</span><span class="op" id="8527555">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527560">Proto</span><span class="op" id="8527565">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8527572">&#34;HTTP/1.1&#34;</span><span class="op" id="8527582">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527587">ProtoMajor</span><span class="op" id="8527597">:</span>&nbsp;<span class="num" id="8527599">1</span><span class="op" id="8527600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527605">ProtoMinor</span><span class="op" id="8527615">:</span>&nbsp;<span class="num" id="8527617">1</span><span class="op" id="8527618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527623">Header</span><span class="op" id="8527629">:</span>&nbsp;<span class="ident" id="8527631">Header</span><span class="op" id="8527637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8527643">&#34;ALL-CAPS&#34;</span><span class="op" id="8527653">:</span>&nbsp;<span class="op" id="8527655">{</span><span class="string" id="8527656">&#34;x&#34;</span><span class="op" id="8527659">}</span><span class="op" id="8527660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8527665">}</span><span class="op" id="8527666">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8527670">}</span><span class="op" id="8527671">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527676">WantWrite</span><span class="op" id="8527685">:</span>&nbsp;<span class="string" id="8527687">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8527708">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8527713">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8527740">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8527745">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8527783">+</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8527788">&#34;ALL-CAPS:&nbsp;x\r\n&#34;</span>&nbsp;<span class="op" id="8527806">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8527811">&#34;\r\n&#34;</span><span class="op" id="8527817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8527820">}</span><span class="op" id="8527821">,</span><br>
<span class="lineno"></span><span class="op" id="8527823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="8527826">func</span>&nbsp;<span class="ident" id="8527831">TestRequestWrite</span><span class="op" id="8527847">(</span><span class="ident" id="8527848">t</span>&nbsp;<span class="op" id="8527850">*</span><span class="ident" id="8527851">testing</span><span class="op" id="8527858">.</span><span class="ident" id="8527859">T</span><span class="op" id="8527860">)</span>&nbsp;<span class="op" id="8527862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8527865">for</span>&nbsp;<span class="ident" id="8527869">i</span>&nbsp;<span class="op" id="8527871">:=</span>&nbsp;<span class="keyword" id="8527874">range</span>&nbsp;<span class="ident" id="8527880">reqWriteTests</span>&nbsp;<span class="op" id="8527894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527898">tt</span>&nbsp;<span class="op" id="8527901">:=</span>&nbsp;<span class="op" id="8527904">&amp;</span><span class="ident" id="8527905">reqWriteTests</span><span class="op" id="8527918">[</span><span class="ident" id="8527919">i</span><span class="op" id="8527920">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8527925">setBody</span>&nbsp;<span class="op" id="8527933">:=</span>&nbsp;<span class="keyword" id="8527936">func</span><span class="op" id="8527940">(</span><span class="op" id="8527941">)</span>&nbsp;<span class="op" id="8527943">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8527948">if</span>&nbsp;<span class="ident" id="8527951">tt</span><span class="op" id="8527953">.</span><span class="ident" id="8527954">Body</span>&nbsp;<span class="op" id="8527959">==</span>&nbsp;<span class="ident" id="8527962">nil</span>&nbsp;<span class="op" id="8527966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8527972">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8527982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8527987">switch</span>&nbsp;<span class="ident" id="8527994">b</span>&nbsp;<span class="op" id="8527996">:=</span>&nbsp;<span class="ident" id="8527999">tt</span><span class="op" id="8528001">.</span><span class="ident" id="8528002">Body</span><span class="op" id="8528006">.</span><span class="op" id="8528007">(</span><span class="keyword" id="8528008">type</span><span class="op" id="8528012">)</span>&nbsp;<span class="op" id="8528014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528019">case</span>&nbsp;<span class="op" id="8528024">[</span><span class="op" id="8528025">]</span><span class="builtintype" id="8528026">byte</span><span class="op" id="8528030">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528036">tt</span><span class="op" id="8528038">.</span><span class="ident" id="8528039">Req</span><span class="op" id="8528042">.</span><span class="ident" id="8528043">Body</span>&nbsp;<span class="op" id="8528048">=</span>&nbsp;<span class="ident" id="8528050">ioutil</span><span class="op" id="8528056">.</span><span class="ident" id="8528057">NopCloser</span><span class="op" id="8528066">(</span><span class="ident" id="8528067">bytes</span><span class="op" id="8528072">.</span><span class="ident" id="8528073">NewReader</span><span class="op" id="8528082">(</span><span class="ident" id="8528083">b</span><span class="op" id="8528084">)</span><span class="op" id="8528085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528090">case</span>&nbsp;<span class="keyword" id="8528095">func</span><span class="op" id="8528099">(</span><span class="op" id="8528100">)</span>&nbsp;<span class="ident" id="8528102">io</span><span class="op" id="8528104">.</span><span class="ident" id="8528105">ReadCloser</span><span class="op" id="8528115">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528121">tt</span><span class="op" id="8528123">.</span><span class="ident" id="8528124">Req</span><span class="op" id="8528127">.</span><span class="ident" id="8528128">Body</span>&nbsp;<span class="op" id="8528133">=</span>&nbsp;<span class="ident" id="8528135">b</span><span class="op" id="8528136">(</span><span class="op" id="8528137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8528142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8528146">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528150">setBody</span><span class="op" id="8528157">(</span><span class="op" id="8528158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528162">if</span>&nbsp;<span class="ident" id="8528165">tt</span><span class="op" id="8528167">.</span><span class="ident" id="8528168">Req</span><span class="op" id="8528171">.</span><span class="ident" id="8528172">Header</span>&nbsp;<span class="op" id="8528179">==</span>&nbsp;<span class="ident" id="8528182">nil</span>&nbsp;<span class="op" id="8528186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528191">tt</span><span class="op" id="8528193">.</span><span class="ident" id="8528194">Req</span><span class="op" id="8528197">.</span><span class="ident" id="8528198">Header</span>&nbsp;<span class="op" id="8528205">=</span>&nbsp;<span class="builtinfunc" id="8528207">make</span><span class="op" id="8528211">(</span><span class="ident" id="8528212">Header</span><span class="op" id="8528218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8528222">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528227">var</span>&nbsp;<span class="ident" id="8528231">braw</span>&nbsp;<span class="ident" id="8528236">bytes</span><span class="op" id="8528241">.</span><span class="ident" id="8528242">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528251">err</span>&nbsp;<span class="op" id="8528255">:=</span>&nbsp;<span class="ident" id="8528258">tt</span><span class="op" id="8528260">.</span><span class="ident" id="8528261">Req</span><span class="op" id="8528264">.</span><span class="ident" id="8528265">Write</span><span class="op" id="8528270">(</span><span class="op" id="8528271">&amp;</span><span class="ident" id="8528272">braw</span><span class="op" id="8528276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528280">if</span>&nbsp;<span class="ident" id="8528283">g</span><span class="op" id="8528284">,</span>&nbsp;<span class="ident" id="8528286">e</span>&nbsp;<span class="op" id="8528288">:=</span>&nbsp;<span class="ident" id="8528291">fmt</span><span class="op" id="8528294">.</span><span class="ident" id="8528295">Sprintf</span><span class="op" id="8528302">(</span><span class="string" id="8528303">&#34;%v&#34;</span><span class="op" id="8528307">,</span>&nbsp;<span class="ident" id="8528309">err</span><span class="op" id="8528312">)</span><span class="op" id="8528313">,</span>&nbsp;<span class="ident" id="8528315">fmt</span><span class="op" id="8528318">.</span><span class="ident" id="8528319">Sprintf</span><span class="op" id="8528326">(</span><span class="string" id="8528327">&#34;%v&#34;</span><span class="op" id="8528331">,</span>&nbsp;<span class="ident" id="8528333">tt</span><span class="op" id="8528335">.</span><span class="ident" id="8528336">WantError</span><span class="op" id="8528345">)</span><span class="op" id="8528346">;</span>&nbsp;<span class="ident" id="8528348">g</span>&nbsp;<span class="op" id="8528350">!=</span>&nbsp;<span class="ident" id="8528353">e</span>&nbsp;<span class="op" id="8528355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528360">t</span><span class="op" id="8528361">.</span><span class="ident" id="8528362">Errorf</span><span class="op" id="8528368">(</span><span class="string" id="8528369">&#34;writing&nbsp;#%d,&nbsp;err&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8528401">,</span>&nbsp;<span class="ident" id="8528403">i</span><span class="op" id="8528404">,</span>&nbsp;<span class="ident" id="8528406">g</span><span class="op" id="8528407">,</span>&nbsp;<span class="ident" id="8528409">e</span><span class="op" id="8528410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528415">continue</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8528426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528430">if</span>&nbsp;<span class="ident" id="8528433">err</span>&nbsp;<span class="op" id="8528437">!=</span>&nbsp;<span class="ident" id="8528440">nil</span>&nbsp;<span class="op" id="8528444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528449">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8528460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528465">if</span>&nbsp;<span class="ident" id="8528468">tt</span><span class="op" id="8528470">.</span><span class="ident" id="8528471">WantWrite</span>&nbsp;<span class="op" id="8528481">!=</span>&nbsp;<span class="string" id="8528484">&#34;&#34;</span>&nbsp;<span class="op" id="8528487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528492">sraw</span>&nbsp;<span class="op" id="8528497">:=</span>&nbsp;<span class="ident" id="8528500">braw</span><span class="op" id="8528504">.</span><span class="ident" id="8528505">String</span><span class="op" id="8528511">(</span><span class="op" id="8528512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528517">if</span>&nbsp;<span class="ident" id="8528520">sraw</span>&nbsp;<span class="op" id="8528525">!=</span>&nbsp;<span class="ident" id="8528528">tt</span><span class="op" id="8528530">.</span><span class="ident" id="8528531">WantWrite</span>&nbsp;<span class="op" id="8528541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528547">t</span><span class="op" id="8528548">.</span><span class="ident" id="8528549">Errorf</span><span class="op" id="8528555">(</span><span class="string" id="8528556">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8528593">,</span>&nbsp;<span class="ident" id="8528595">i</span><span class="op" id="8528596">,</span>&nbsp;<span class="ident" id="8528598">tt</span><span class="op" id="8528600">.</span><span class="ident" id="8528601">WantWrite</span><span class="op" id="8528610">,</span>&nbsp;<span class="ident" id="8528612">sraw</span><span class="op" id="8528616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528622">continue</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8528634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8528638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528643">if</span>&nbsp;<span class="ident" id="8528646">tt</span><span class="op" id="8528648">.</span><span class="ident" id="8528649">WantProxy</span>&nbsp;<span class="op" id="8528659">!=</span>&nbsp;<span class="string" id="8528662">&#34;&#34;</span>&nbsp;<span class="op" id="8528665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528670">setBody</span><span class="op" id="8528677">(</span><span class="op" id="8528678">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528683">var</span>&nbsp;<span class="ident" id="8528687">praw</span>&nbsp;<span class="ident" id="8528692">bytes</span><span class="op" id="8528697">.</span><span class="ident" id="8528698">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528708">err</span>&nbsp;<span class="op" id="8528712">=</span>&nbsp;<span class="ident" id="8528714">tt</span><span class="op" id="8528716">.</span><span class="ident" id="8528717">Req</span><span class="op" id="8528720">.</span><span class="ident" id="8528721">WriteProxy</span><span class="op" id="8528731">(</span><span class="op" id="8528732">&amp;</span><span class="ident" id="8528733">praw</span><span class="op" id="8528737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528742">if</span>&nbsp;<span class="ident" id="8528745">err</span>&nbsp;<span class="op" id="8528749">!=</span>&nbsp;<span class="ident" id="8528752">nil</span>&nbsp;<span class="op" id="8528756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528762">t</span><span class="op" id="8528763">.</span><span class="ident" id="8528764">Errorf</span><span class="op" id="8528770">(</span><span class="string" id="8528771">&#34;WriteProxy&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="8528791">,</span>&nbsp;<span class="ident" id="8528793">i</span><span class="op" id="8528794">,</span>&nbsp;<span class="ident" id="8528796">err</span><span class="op" id="8528799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528805">continue</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8528817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528822">sraw</span>&nbsp;<span class="op" id="8528827">:=</span>&nbsp;<span class="ident" id="8528830">praw</span><span class="op" id="8528834">.</span><span class="ident" id="8528835">String</span><span class="op" id="8528841">(</span><span class="op" id="8528842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528847">if</span>&nbsp;<span class="ident" id="8528850">sraw</span>&nbsp;<span class="op" id="8528855">!=</span>&nbsp;<span class="ident" id="8528858">tt</span><span class="op" id="8528860">.</span><span class="ident" id="8528861">WantProxy</span>&nbsp;<span class="op" id="8528871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8528877">t</span><span class="op" id="8528878">.</span><span class="ident" id="8528879">Errorf</span><span class="op" id="8528885">(</span><span class="string" id="8528886">&#34;Test&nbsp;Proxy&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8528929">,</span>&nbsp;<span class="ident" id="8528931">i</span><span class="op" id="8528932">,</span>&nbsp;<span class="ident" id="8528934">tt</span><span class="op" id="8528936">.</span><span class="ident" id="8528937">WantProxy</span><span class="op" id="8528946">,</span>&nbsp;<span class="ident" id="8528948">sraw</span><span class="op" id="8528952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8528958">continue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8528970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8528974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8528977">}</span><br>
<span class="lineno"></span><span class="op" id="8528979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="8528982">type</span>&nbsp;<span class="ident" id="8528987">closeChecker</span>&nbsp;<span class="keyword" id="8529000">struct</span>&nbsp;<span class="op" id="8529007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529010">io</span><span class="op" id="8529012">.</span><span class="ident" id="8529013">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529021">closed</span>&nbsp;<span class="builtintype" id="8529028">bool</span><br>
<span class="lineno"></span><span class="op" id="8529033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="8529036">func</span>&nbsp;<span class="op" id="8529041">(</span><span class="ident" id="8529042">rc</span>&nbsp;<span class="op" id="8529045">*</span><span class="ident" id="8529046">closeChecker</span><span class="op" id="8529058">)</span>&nbsp;<span class="ident" id="8529060">Close</span><span class="op" id="8529065">(</span><span class="op" id="8529066">)</span>&nbsp;<span class="builtintype" id="8529068">error</span>&nbsp;<span class="op" id="8529074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529077">rc</span><span class="op" id="8529079">.</span><span class="ident" id="8529080">closed</span>&nbsp;<span class="op" id="8529087">=</span>&nbsp;<span class="builtintype" id="8529089">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8529095">return</span>&nbsp;<span class="ident" id="8529102">nil</span><br>
<span class="lineno"></span><span class="op" id="8529106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="8529109">//&nbsp;TestRequestWriteClosesBody&nbsp;tests&nbsp;that&nbsp;Request.Write&nbsp;does&nbsp;close&nbsp;its&nbsp;request.Body.</span><br>
<span class="lineno"></span><span class="comment" id="8529193">//&nbsp;It&nbsp;also&nbsp;indirectly&nbsp;tests&nbsp;NewRequest&nbsp;and&nbsp;that&nbsp;it&nbsp;doesn&#39;t&nbsp;wrap&nbsp;an&nbsp;existing&nbsp;Closer</span><br>
<span class="lineno"></span><span class="comment" id="8529276">//&nbsp;inside&nbsp;a&nbsp;NopCloser,&nbsp;and&nbsp;that&nbsp;it&nbsp;serializes&nbsp;it&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="8529336">func</span>&nbsp;<span class="ident" id="8529341">TestRequestWriteClosesBody</span><span class="op" id="8529367">(</span><span class="ident" id="8529368">t</span>&nbsp;<span class="op" id="8529370">*</span><span class="ident" id="8529371">testing</span><span class="op" id="8529378">.</span><span class="ident" id="8529379">T</span><span class="op" id="8529380">)</span>&nbsp;<span class="op" id="8529382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529385">rc</span>&nbsp;<span class="op" id="8529388">:=</span>&nbsp;<span class="op" id="8529391">&amp;</span><span class="ident" id="8529392">closeChecker</span><span class="op" id="8529404">{</span><span class="ident" id="8529405">Reader</span><span class="op" id="8529411">:</span>&nbsp;<span class="ident" id="8529413">strings</span><span class="op" id="8529420">.</span><span class="ident" id="8529421">NewReader</span><span class="op" id="8529430">(</span><span class="string" id="8529431">&#34;my&nbsp;body&#34;</span><span class="op" id="8529440">)</span><span class="op" id="8529441">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529444">req</span><span class="op" id="8529447">,</span>&nbsp;<span class="ident" id="8529449">_</span>&nbsp;<span class="op" id="8529451">:=</span>&nbsp;<span class="ident" id="8529454">NewRequest</span><span class="op" id="8529464">(</span><span class="string" id="8529465">&#34;POST&#34;</span><span class="op" id="8529471">,</span>&nbsp;<span class="string" id="8529473">&#34;http://foo.com/&#34;</span><span class="op" id="8529490">,</span>&nbsp;<span class="ident" id="8529492">rc</span><span class="op" id="8529494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8529497">if</span>&nbsp;<span class="ident" id="8529500">req</span><span class="op" id="8529503">.</span><span class="ident" id="8529504">ContentLength</span>&nbsp;<span class="op" id="8529518">!=</span>&nbsp;<span class="num" id="8529521">0</span>&nbsp;<span class="op" id="8529523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529527">t</span><span class="op" id="8529528">.</span><span class="ident" id="8529529">Errorf</span><span class="op" id="8529535">(</span><span class="string" id="8529536">&#34;got&nbsp;req.ContentLength&nbsp;%d,&nbsp;want&nbsp;0&#34;</span><span class="op" id="8529570">,</span>&nbsp;<span class="ident" id="8529572">req</span><span class="op" id="8529575">.</span><span class="ident" id="8529576">ContentLength</span><span class="op" id="8529589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8529592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529595">buf</span>&nbsp;<span class="op" id="8529599">:=</span>&nbsp;<span class="builtinfunc" id="8529602">new</span><span class="op" id="8529605">(</span><span class="ident" id="8529606">bytes</span><span class="op" id="8529611">.</span><span class="ident" id="8529612">Buffer</span><span class="op" id="8529618">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529621">req</span><span class="op" id="8529624">.</span><span class="ident" id="8529625">Write</span><span class="op" id="8529630">(</span><span class="ident" id="8529631">buf</span><span class="op" id="8529634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8529637">if</span>&nbsp;<span class="op" id="8529640">!</span><span class="ident" id="8529641">rc</span><span class="op" id="8529643">.</span><span class="ident" id="8529644">closed</span>&nbsp;<span class="op" id="8529651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529655">t</span><span class="op" id="8529656">.</span><span class="ident" id="8529657">Error</span><span class="op" id="8529662">(</span><span class="string" id="8529663">&#34;body&nbsp;not&nbsp;closed&nbsp;after&nbsp;write&#34;</span><span class="op" id="8529692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8529695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8529698">expected</span>&nbsp;<span class="op" id="8529707">:=</span>&nbsp;<span class="string" id="8529710">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8529732">+</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529736">&#34;Host:&nbsp;foo.com\r\n&#34;</span>&nbsp;<span class="op" id="8529756">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529760">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8529798">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8529802">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8529839">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8529843">//&nbsp;TODO:&nbsp;currently&nbsp;we&nbsp;don&#39;t&nbsp;buffer&nbsp;before&nbsp;chunking,&nbsp;so&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8529909">//&nbsp;single&nbsp;&#34;m&#34;&nbsp;chunk&nbsp;before&nbsp;the&nbsp;other&nbsp;chunks,&nbsp;as&nbsp;this&nbsp;was&nbsp;the&nbsp;1-byte</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8529979">//&nbsp;read&nbsp;from&nbsp;our&nbsp;MultiReader&nbsp;where&nbsp;we&nbsp;stiched&nbsp;the&nbsp;Body&nbsp;back&nbsp;together</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8530050">//&nbsp;after&nbsp;sniffing&nbsp;whether&nbsp;the&nbsp;Body&nbsp;was&nbsp;0&nbsp;bytes&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530107">chunk</span><span class="op" id="8530112">(</span><span class="string" id="8530113">&#34;m&#34;</span><span class="op" id="8530116">)</span>&nbsp;<span class="op" id="8530118">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530122">chunk</span><span class="op" id="8530127">(</span><span class="string" id="8530128">&#34;y&nbsp;body&#34;</span><span class="op" id="8530136">)</span>&nbsp;<span class="op" id="8530138">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530142">chunk</span><span class="op" id="8530147">(</span><span class="string" id="8530148">&#34;&#34;</span><span class="op" id="8530150">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530153">if</span>&nbsp;<span class="ident" id="8530156">buf</span><span class="op" id="8530159">.</span><span class="ident" id="8530160">String</span><span class="op" id="8530166">(</span><span class="op" id="8530167">)</span>&nbsp;<span class="op" id="8530169">!=</span>&nbsp;<span class="ident" id="8530172">expected</span>&nbsp;<span class="op" id="8530181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530185">t</span><span class="op" id="8530186">.</span><span class="ident" id="8530187">Errorf</span><span class="op" id="8530193">(</span><span class="string" id="8530194">&#34;write:\n&nbsp;got:&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="8530222">,</span>&nbsp;<span class="ident" id="8530224">buf</span><span class="op" id="8530227">.</span><span class="ident" id="8530228">String</span><span class="op" id="8530234">(</span><span class="op" id="8530235">)</span><span class="op" id="8530236">,</span>&nbsp;<span class="ident" id="8530238">expected</span><span class="op" id="8530246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8530249">}</span><br>
<span class="lineno"></span><span class="op" id="8530251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="8530254">func</span>&nbsp;<span class="ident" id="8530259">chunk</span><span class="op" id="8530264">(</span><span class="ident" id="8530265">s</span>&nbsp;<span class="builtintype" id="8530267">string</span><span class="op" id="8530273">)</span>&nbsp;<span class="builtintype" id="8530275">string</span>&nbsp;<span class="op" id="8530282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530285">return</span>&nbsp;<span class="ident" id="8530292">fmt</span><span class="op" id="8530295">.</span><span class="ident" id="8530296">Sprintf</span><span class="op" id="8530303">(</span><span class="string" id="8530304">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="8530318">,</span>&nbsp;<span class="builtinfunc" id="8530320">len</span><span class="op" id="8530323">(</span><span class="ident" id="8530324">s</span><span class="op" id="8530325">)</span><span class="op" id="8530326">,</span>&nbsp;<span class="ident" id="8530328">s</span><span class="op" id="8530329">)</span><br>
<span class="lineno"></span><span class="op" id="8530331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8530334">func</span>&nbsp;<span class="ident" id="8530339">mustParseURL</span><span class="op" id="8530351">(</span><span class="ident" id="8530352">s</span>&nbsp;<span class="builtintype" id="8530354">string</span><span class="op" id="8530360">)</span>&nbsp;<span class="op" id="8530362">*</span><span class="ident" id="8530363">url</span><span class="op" id="8530366">.</span><span class="ident" id="8530367">URL</span>&nbsp;<span class="op" id="8530371">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530374">u</span><span class="op" id="8530375">,</span>&nbsp;<span class="ident" id="8530377">err</span>&nbsp;<span class="op" id="8530381">:=</span>&nbsp;<span class="ident" id="8530384">url</span><span class="op" id="8530387">.</span><span class="ident" id="8530388">Parse</span><span class="op" id="8530393">(</span><span class="ident" id="8530394">s</span><span class="op" id="8530395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530398">if</span>&nbsp;<span class="ident" id="8530401">err</span>&nbsp;<span class="op" id="8530405">!=</span>&nbsp;<span class="ident" id="8530408">nil</span>&nbsp;<span class="op" id="8530412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="8530416">panic</span><span class="op" id="8530421">(</span><span class="ident" id="8530422">fmt</span><span class="op" id="8530425">.</span><span class="ident" id="8530426">Sprintf</span><span class="op" id="8530433">(</span><span class="string" id="8530434">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="8530460">,</span>&nbsp;<span class="ident" id="8530462">s</span><span class="op" id="8530463">,</span>&nbsp;<span class="ident" id="8530465">err</span><span class="op" id="8530468">)</span><span class="op" id="8530469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8530472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8530475">return</span>&nbsp;<span class="ident" id="8530482">u</span><br>
<span class="lineno">565</span><span class="op" id="8530484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8530487">type</span>&nbsp;<span class="ident" id="8530492">writerFunc</span>&nbsp;<span class="keyword" id="8530503">func</span><span class="op" id="8530507">(</span><span class="op" id="8530508">[</span><span class="op" id="8530509">]</span><span class="builtintype" id="8530510">byte</span><span class="op" id="8530514">)</span>&nbsp;<span class="op" id="8530516">(</span><span class="builtintype" id="8530517">int</span><span class="op" id="8530520">,</span>&nbsp;<span class="builtintype" id="8530522">error</span><span class="op" id="8530527">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8530530">func</span>&nbsp;<span class="op" id="8530535">(</span><span class="ident" id="8530536">f</span>&nbsp;<span class="ident" id="8530538">writerFunc</span><span class="op" id="8530548">)</span>&nbsp;<span class="ident" id="8530550">Write</span><span class="op" id="8530555">(</span><span class="ident" id="8530556">p</span>&nbsp;<span class="op" id="8530558">[</span><span class="op" id="8530559">]</span><span class="builtintype" id="8530560">byte</span><span class="op" id="8530564">)</span>&nbsp;<span class="op" id="8530566">(</span><span class="builtintype" id="8530567">int</span><span class="op" id="8530570">,</span>&nbsp;<span class="builtintype" id="8530572">error</span><span class="op" id="8530577">)</span>&nbsp;<span class="op" id="8530579">{</span>&nbsp;<span class="keyword" id="8530581">return</span>&nbsp;<span class="ident" id="8530588">f</span><span class="op" id="8530589">(</span><span class="ident" id="8530590">p</span><span class="op" id="8530591">)</span>&nbsp;<span class="op" id="8530593">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="8530596">//&nbsp;TestRequestWriteError&nbsp;tests&nbsp;the&nbsp;Write&nbsp;err&nbsp;!=&nbsp;nil&nbsp;checks&nbsp;in&nbsp;(*Request).write.</span><br>
<span class="lineno"></span><span class="keyword" id="8530676">func</span>&nbsp;<span class="ident" id="8530681">TestRequestWriteError</span><span class="op" id="8530702">(</span><span class="ident" id="8530703">t</span>&nbsp;<span class="op" id="8530705">*</span><span class="ident" id="8530706">testing</span><span class="op" id="8530713">.</span><span class="ident" id="8530714">T</span><span class="op" id="8530715">)</span>&nbsp;<span class="op" id="8530717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530720">failAfter</span><span class="op" id="8530729">,</span>&nbsp;<span class="ident" id="8530731">writeCount</span>&nbsp;<span class="op" id="8530742">:=</span>&nbsp;<span class="num" id="8530745">0</span><span class="op" id="8530746">,</span>&nbsp;<span class="num" id="8530748">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530751">errFail</span>&nbsp;<span class="op" id="8530759">:=</span>&nbsp;<span class="ident" id="8530762">errors</span><span class="op" id="8530768">.</span><span class="ident" id="8530769">New</span><span class="op" id="8530772">(</span><span class="string" id="8530773">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="8530793">)</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8530797">//&nbsp;w&nbsp;is&nbsp;the&nbsp;buffered&nbsp;io.Writer&nbsp;to&nbsp;write&nbsp;the&nbsp;request&nbsp;to.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8530858">//&nbsp;fails&nbsp;exactly&nbsp;once&nbsp;on&nbsp;its&nbsp;Nth&nbsp;Write&nbsp;call,&nbsp;as&nbsp;controlled&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8530921">//&nbsp;failAfter.&nbsp;It&nbsp;also&nbsp;tracks&nbsp;the&nbsp;number&nbsp;of&nbsp;calls&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8530974">//&nbsp;writeCount.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8530990">w</span>&nbsp;<span class="op" id="8530992">:=</span>&nbsp;<span class="keyword" id="8530995">struct</span>&nbsp;<span class="op" id="8531002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531006">io</span><span class="op" id="8531008">.</span><span class="ident" id="8531009">ByteWriter</span>&nbsp;<span class="comment" id="8531020">//&nbsp;to&nbsp;avoid&nbsp;being&nbsp;wrapped&nbsp;by&nbsp;a&nbsp;bufio.Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531066">io</span><span class="op" id="8531068">.</span><span class="ident" id="8531069">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531077">}</span><span class="op" id="8531078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531082">nil</span><span class="op" id="8531085">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531089">writerFunc</span><span class="op" id="8531099">(</span><span class="keyword" id="8531100">func</span><span class="op" id="8531104">(</span><span class="ident" id="8531105">p</span>&nbsp;<span class="op" id="8531107">[</span><span class="op" id="8531108">]</span><span class="builtintype" id="8531109">byte</span><span class="op" id="8531113">)</span>&nbsp;<span class="op" id="8531115">(</span><span class="ident" id="8531116">n</span>&nbsp;<span class="builtintype" id="8531118">int</span><span class="op" id="8531121">,</span>&nbsp;<span class="ident" id="8531123">err</span>&nbsp;<span class="builtintype" id="8531127">error</span><span class="op" id="8531132">)</span>&nbsp;<span class="op" id="8531134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531139">writeCount</span><span class="op" id="8531149">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531155">if</span>&nbsp;<span class="ident" id="8531158">failAfter</span>&nbsp;<span class="op" id="8531168">==</span>&nbsp;<span class="num" id="8531171">0</span>&nbsp;<span class="op" id="8531173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531179">err</span>&nbsp;<span class="op" id="8531183">=</span>&nbsp;<span class="ident" id="8531185">errFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531196">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531201">failAfter</span><span class="op" id="8531210">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531216">return</span>&nbsp;<span class="builtinfunc" id="8531223">len</span><span class="op" id="8531226">(</span><span class="ident" id="8531227">p</span><span class="op" id="8531228">)</span><span class="op" id="8531229">,</span>&nbsp;<span class="ident" id="8531231">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531237">}</span><span class="op" id="8531238">)</span><span class="op" id="8531239">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531246">req</span><span class="op" id="8531249">,</span>&nbsp;<span class="ident" id="8531251">_</span>&nbsp;<span class="op" id="8531253">:=</span>&nbsp;<span class="ident" id="8531256">NewRequest</span><span class="op" id="8531266">(</span><span class="string" id="8531267">&#34;GET&#34;</span><span class="op" id="8531272">,</span>&nbsp;<span class="string" id="8531274">&#34;http://example.com/&#34;</span><span class="op" id="8531295">,</span>&nbsp;<span class="ident" id="8531297">nil</span><span class="op" id="8531300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531303">const</span>&nbsp;<span class="ident" id="8531309">writeCalls</span>&nbsp;<span class="op" id="8531320">=</span>&nbsp;<span class="num" id="8531322">4</span>&nbsp;<span class="comment" id="8531324">//&nbsp;number&nbsp;of&nbsp;Write&nbsp;calls&nbsp;in&nbsp;current&nbsp;implementation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531376">sawGood</span>&nbsp;<span class="op" id="8531384">:=</span>&nbsp;<span class="builtintype" id="8531387">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531394">for</span>&nbsp;<span class="ident" id="8531398">n</span>&nbsp;<span class="op" id="8531400">:=</span>&nbsp;<span class="num" id="8531403">0</span><span class="op" id="8531404">;</span>&nbsp;<span class="ident" id="8531406">n</span>&nbsp;<span class="op" id="8531408">&lt;=</span>&nbsp;<span class="ident" id="8531411">writeCalls</span><span class="op" id="8531421">+</span><span class="num" id="8531422">2</span><span class="op" id="8531423">;</span>&nbsp;<span class="ident" id="8531425">n</span><span class="op" id="8531426">++</span>&nbsp;<span class="op" id="8531429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531433">failAfter</span>&nbsp;<span class="op" id="8531443">=</span>&nbsp;<span class="ident" id="8531445">n</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531449">writeCount</span>&nbsp;<span class="op" id="8531460">=</span>&nbsp;<span class="num" id="8531462">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531466">err</span>&nbsp;<span class="op" id="8531470">:=</span>&nbsp;<span class="ident" id="8531473">req</span><span class="op" id="8531476">.</span><span class="ident" id="8531477">Write</span><span class="op" id="8531482">(</span><span class="ident" id="8531483">w</span><span class="op" id="8531484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531488">var</span>&nbsp;<span class="ident" id="8531492">wantErr</span>&nbsp;<span class="builtintype" id="8531500">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531508">if</span>&nbsp;<span class="ident" id="8531511">n</span>&nbsp;<span class="op" id="8531513">&lt;</span>&nbsp;<span class="ident" id="8531515">writeCalls</span>&nbsp;<span class="op" id="8531526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531531">wantErr</span>&nbsp;<span class="op" id="8531539">=</span>&nbsp;<span class="ident" id="8531541">errFail</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531555">if</span>&nbsp;<span class="ident" id="8531558">err</span>&nbsp;<span class="op" id="8531562">!=</span>&nbsp;<span class="ident" id="8531565">wantErr</span>&nbsp;<span class="op" id="8531573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531578">t</span><span class="op" id="8531579">.</span><span class="ident" id="8531580">Errorf</span><span class="op" id="8531586">(</span><span class="string" id="8531587">&#34;for&nbsp;fail-after&nbsp;%d&nbsp;Writes,&nbsp;err&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8531632">,</span>&nbsp;<span class="ident" id="8531634">n</span><span class="op" id="8531635">,</span>&nbsp;<span class="ident" id="8531637">err</span><span class="op" id="8531640">,</span>&nbsp;<span class="ident" id="8531642">wantErr</span><span class="op" id="8531649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531654">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531665">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531669">if</span>&nbsp;<span class="ident" id="8531672">err</span>&nbsp;<span class="op" id="8531676">==</span>&nbsp;<span class="ident" id="8531679">nil</span>&nbsp;<span class="op" id="8531683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531688">sawGood</span>&nbsp;<span class="op" id="8531696">=</span>&nbsp;<span class="builtintype" id="8531698">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531706">if</span>&nbsp;<span class="ident" id="8531709">writeCount</span>&nbsp;<span class="op" id="8531720">!=</span>&nbsp;<span class="ident" id="8531723">writeCalls</span>&nbsp;<span class="op" id="8531734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531740">t</span><span class="op" id="8531741">.</span><span class="ident" id="8531742">Fatalf</span><span class="op" id="8531748">(</span><span class="string" id="8531749">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="8531790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531795">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531803">if</span>&nbsp;<span class="ident" id="8531806">writeCount</span>&nbsp;<span class="op" id="8531817">&gt;</span>&nbsp;<span class="ident" id="8531819">writeCalls</span>&nbsp;<span class="op" id="8531830">||</span>&nbsp;<span class="ident" id="8531833">writeCount</span>&nbsp;<span class="op" id="8531844">&gt;</span>&nbsp;<span class="ident" id="8531846">n</span><span class="op" id="8531847">+</span><span class="num" id="8531848">1</span>&nbsp;<span class="op" id="8531850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531855">t</span><span class="op" id="8531856">.</span><span class="ident" id="8531857">Errorf</span><span class="op" id="8531863">(</span><span class="string" id="8531864">&#34;for&nbsp;fail-after&nbsp;%d,&nbsp;saw&nbsp;unexpectedly&nbsp;high&nbsp;(%d)&nbsp;write&nbsp;calls&#34;</span><span class="op" id="8531923">,</span>&nbsp;<span class="ident" id="8531925">n</span><span class="op" id="8531926">,</span>&nbsp;<span class="ident" id="8531928">writeCount</span><span class="op" id="8531938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8531945">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8531948">if</span>&nbsp;<span class="op" id="8531951">!</span><span class="ident" id="8531952">sawGood</span>&nbsp;<span class="op" id="8531960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8531964">t</span><span class="op" id="8531965">.</span><span class="ident" id="8531966">Fatalf</span><span class="op" id="8531972">(</span><span class="string" id="8531973">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="8532014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8532017">}</span><br>
<span class="lineno"></span><span class="op" id="8532019">}</span>
</div>
</body>
</html>
