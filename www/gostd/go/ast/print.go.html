<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/ast</h2>
<ul>
<li><a href="/gostd/go/ast/ast.go.html">ast.go</a></li>
<li><a href="/gostd/go/ast/ast_test.go.html">ast_test.go</a></li>
<li><a href="/gostd/go/ast/commentmap.go.html">commentmap.go</a></li>
<li><a href="/gostd/go/ast/commentmap_test.go.html">commentmap_test.go</a></li>
<li><a href="/gostd/go/ast/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/ast/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/ast/filter_test.go.html">filter_test.go</a></li>
<li><a href="/gostd/go/ast/import.go.html">import.go</a></li>
<li><a href="/gostd/go/ast/print.go.html">print.go</a></li>
<li><a href="/gostd/go/ast/print_test.go.html">print_test.go</a></li>
<li><a href="/gostd/go/ast/resolve.go.html">resolve.go</a></li>
<li><a href="/gostd/go/ast/scope.go.html">scope.go</a></li>
<li><a href="/gostd/go/ast/walk.go.html">walk.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5328299">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5328354">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5328408">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5328459">//&nbsp;This&nbsp;file&nbsp;contains&nbsp;printing&nbsp;support&nbsp;for&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5328509">package</span>&nbsp;<span class="ident" id="5328517">ast</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5328522">import</span>&nbsp;<span class="op" id="5328529">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5328532">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5328539">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5328551">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5328557">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5328563">&#34;reflect&#34;</span><br>
<span class="lineno">15</span><span class="op" id="5328573">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5328576">//&nbsp;A&nbsp;FieldFilter&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;Fprint&nbsp;to&nbsp;control&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="keyword" id="5328642">type</span>&nbsp;<span class="ident" id="5328647">FieldFilter</span>&nbsp;<span class="keyword" id="5328659">func</span><span class="op" id="5328663">(</span><span class="ident" id="5328664">name</span>&nbsp;<span class="builtintype" id="5328669">string</span><span class="op" id="5328675">,</span>&nbsp;<span class="ident" id="5328677">value</span>&nbsp;<span class="ident" id="5328683">reflect</span><span class="op" id="5328690">.</span><span class="ident" id="5328691">Value</span><span class="op" id="5328696">)</span>&nbsp;<span class="builtintype" id="5328698">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5328704">//&nbsp;NotNilFilter&nbsp;returns&nbsp;true&nbsp;for&nbsp;field&nbsp;values&nbsp;that&nbsp;are&nbsp;not&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="5328768">//&nbsp;it&nbsp;returns&nbsp;false&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="5328799">func</span>&nbsp;<span class="ident" id="5328804">NotNilFilter</span><span class="op" id="5328816">(</span><span class="ident" id="5328817">_</span>&nbsp;<span class="builtintype" id="5328819">string</span><span class="op" id="5328825">,</span>&nbsp;<span class="ident" id="5328827">v</span>&nbsp;<span class="ident" id="5328829">reflect</span><span class="op" id="5328836">.</span><span class="ident" id="5328837">Value</span><span class="op" id="5328842">)</span>&nbsp;<span class="builtintype" id="5328844">bool</span>&nbsp;<span class="op" id="5328849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5328852">switch</span>&nbsp;<span class="ident" id="5328859">v</span><span class="op" id="5328860">.</span><span class="ident" id="5328861">Kind</span><span class="op" id="5328865">(</span><span class="op" id="5328866">)</span>&nbsp;<span class="op" id="5328868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5328871">case</span>&nbsp;<span class="ident" id="5328876">reflect</span><span class="op" id="5328883">.</span><span class="ident" id="5328884">Chan</span><span class="op" id="5328888">,</span>&nbsp;<span class="ident" id="5328890">reflect</span><span class="op" id="5328897">.</span><span class="ident" id="5328898">Func</span><span class="op" id="5328902">,</span>&nbsp;<span class="ident" id="5328904">reflect</span><span class="op" id="5328911">.</span><span class="ident" id="5328912">Interface</span><span class="op" id="5328921">,</span>&nbsp;<span class="ident" id="5328923">reflect</span><span class="op" id="5328930">.</span><span class="ident" id="5328931">Map</span><span class="op" id="5328934">,</span>&nbsp;<span class="ident" id="5328936">reflect</span><span class="op" id="5328943">.</span><span class="ident" id="5328944">Ptr</span><span class="op" id="5328947">,</span>&nbsp;<span class="ident" id="5328949">reflect</span><span class="op" id="5328956">.</span><span class="ident" id="5328957">Slice</span><span class="op" id="5328962">:</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5328966">return</span>&nbsp;<span class="op" id="5328973">!</span><span class="ident" id="5328974">v</span><span class="op" id="5328975">.</span><span class="ident" id="5328976">IsNil</span><span class="op" id="5328981">(</span><span class="op" id="5328982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5328985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5328988">return</span>&nbsp;<span class="builtintype" id="5328995">true</span><br>
<span class="lineno"></span><span class="op" id="5329000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="5329003">//&nbsp;Fprint&nbsp;prints&nbsp;the&nbsp;(sub-)tree&nbsp;starting&nbsp;at&nbsp;AST&nbsp;node&nbsp;x&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="5329064">//&nbsp;If&nbsp;fset&nbsp;!=&nbsp;nil,&nbsp;position&nbsp;information&nbsp;is&nbsp;interpreted&nbsp;relative</span><br>
<span class="lineno"></span><span class="comment" id="5329128">//&nbsp;to&nbsp;that&nbsp;file&nbsp;set.&nbsp;Otherwise&nbsp;positions&nbsp;are&nbsp;printed&nbsp;as&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="5329192">//&nbsp;values&nbsp;(file&nbsp;set&nbsp;specific&nbsp;offsets).</span><br>
<span class="lineno"></span><span class="comment" id="5329231">//</span><br>
<span class="lineno">35</span><span class="comment" id="5329234">//&nbsp;A&nbsp;non-nil&nbsp;FieldFilter&nbsp;f&nbsp;may&nbsp;be&nbsp;provided&nbsp;to&nbsp;control&nbsp;the&nbsp;output:</span><br>
<span class="lineno"></span><span class="comment" id="5329300">//&nbsp;struct&nbsp;fields&nbsp;for&nbsp;which&nbsp;f(fieldname,&nbsp;fieldvalue)&nbsp;is&nbsp;true&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="5329364">//&nbsp;printed;&nbsp;all&nbsp;others&nbsp;are&nbsp;filtered&nbsp;from&nbsp;the&nbsp;output.&nbsp;Unexported</span><br>
<span class="lineno"></span><span class="comment" id="5329428">//&nbsp;struct&nbsp;fields&nbsp;are&nbsp;never&nbsp;printed.</span><br>
<span class="lineno"></span><span class="comment" id="5329464">//</span><br>
<span class="lineno">40</span><span class="keyword" id="5329467">func</span>&nbsp;<span class="ident" id="5329472">Fprint</span><span class="op" id="5329478">(</span><span class="ident" id="5329479">w</span>&nbsp;<span class="ident" id="5329481">io</span><span class="op" id="5329483">.</span><span class="ident" id="5329484">Writer</span><span class="op" id="5329490">,</span>&nbsp;<span class="ident" id="5329492">fset</span>&nbsp;<span class="op" id="5329497">*</span><span class="ident" id="5329498">token</span><span class="op" id="5329503">.</span><span class="ident" id="5329504">FileSet</span><span class="op" id="5329511">,</span>&nbsp;<span class="ident" id="5329513">x</span>&nbsp;<span class="keyword" id="5329515">interface</span><span class="op" id="5329524">{</span><span class="op" id="5329525">}</span><span class="op" id="5329526">,</span>&nbsp;<span class="ident" id="5329528">f</span>&nbsp;<span class="ident" id="5329530">FieldFilter</span><span class="op" id="5329541">)</span>&nbsp;<span class="op" id="5329543">(</span><span class="ident" id="5329544">err</span>&nbsp;<span class="builtintype" id="5329548">error</span><span class="op" id="5329553">)</span>&nbsp;<span class="op" id="5329555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5329558">//&nbsp;setup&nbsp;printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5329576">p</span>&nbsp;<span class="op" id="5329578">:=</span>&nbsp;<span class="ident" id="5329581">printer</span><span class="op" id="5329588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5329592">output</span><span class="op" id="5329598">:</span>&nbsp;<span class="ident" id="5329600">w</span><span class="op" id="5329601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5329605">fset</span><span class="op" id="5329609">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5329613">fset</span><span class="op" id="5329617">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5329621">filter</span><span class="op" id="5329627">:</span>&nbsp;<span class="ident" id="5329629">f</span><span class="op" id="5329630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5329634">ptrmap</span><span class="op" id="5329640">:</span>&nbsp;<span class="builtinfunc" id="5329642">make</span><span class="op" id="5329646">(</span><span class="keyword" id="5329647">map</span><span class="op" id="5329650">[</span><span class="keyword" id="5329651">interface</span><span class="op" id="5329660">{</span><span class="op" id="5329661">}</span><span class="op" id="5329662">]</span><span class="builtintype" id="5329663">int</span><span class="op" id="5329666">)</span><span class="op" id="5329667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5329671">last</span><span class="op" id="5329675">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="5329679">&#39;\n&#39;</span><span class="op" id="5329683">,</span>&nbsp;<span class="comment" id="5329685">//&nbsp;force&nbsp;printing&nbsp;of&nbsp;line&nbsp;number&nbsp;on&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5329733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5329737">//&nbsp;install&nbsp;error&nbsp;handler</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5329763">defer</span>&nbsp;<span class="keyword" id="5329769">func</span><span class="op" id="5329773">(</span><span class="op" id="5329774">)</span>&nbsp;<span class="op" id="5329776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5329780">if</span>&nbsp;<span class="ident" id="5329783">e</span>&nbsp;<span class="op" id="5329785">:=</span>&nbsp;<span class="builtinfunc" id="5329788">recover</span><span class="op" id="5329795">(</span><span class="op" id="5329796">)</span><span class="op" id="5329797">;</span>&nbsp;<span class="ident" id="5329799">e</span>&nbsp;<span class="op" id="5329801">!=</span>&nbsp;<span class="ident" id="5329804">nil</span>&nbsp;<span class="op" id="5329808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5329813">err</span>&nbsp;<span class="op" id="5329817">=</span>&nbsp;<span class="ident" id="5329819">e</span><span class="op" id="5329820">.</span><span class="op" id="5329821">(</span><span class="ident" id="5329822">localError</span><span class="op" id="5329832">)</span><span class="op" id="5329833">.</span><span class="ident" id="5329834">err</span>&nbsp;<span class="comment" id="5329838">//&nbsp;re-panics&nbsp;if&nbsp;it&#39;s&nbsp;not&nbsp;a&nbsp;localError</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5329878">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5329881">}</span><span class="op" id="5329882">(</span><span class="op" id="5329883">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5329887">//&nbsp;print&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5329899">if</span>&nbsp;<span class="ident" id="5329902">x</span>&nbsp;<span class="op" id="5329904">==</span>&nbsp;<span class="ident" id="5329907">nil</span>&nbsp;<span class="op" id="5329911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5329915">p</span><span class="op" id="5329916">.</span><span class="ident" id="5329917">printf</span><span class="op" id="5329923">(</span><span class="string" id="5329924">&#34;nil\n&#34;</span><span class="op" id="5329931">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5329935">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5329943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5329946">p</span><span class="op" id="5329947">.</span><span class="builtinfunc" id="5329948">print</span><span class="op" id="5329953">(</span><span class="ident" id="5329954">reflect</span><span class="op" id="5329961">.</span><span class="ident" id="5329962">ValueOf</span><span class="op" id="5329969">(</span><span class="ident" id="5329970">x</span><span class="op" id="5329971">)</span><span class="op" id="5329972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5329975">p</span><span class="op" id="5329976">.</span><span class="ident" id="5329977">printf</span><span class="op" id="5329983">(</span><span class="string" id="5329984">&#34;\n&#34;</span><span class="op" id="5329988">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5329992">return</span><br>
<span class="lineno"></span><span class="op" id="5329999">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5330002">//&nbsp;Print&nbsp;prints&nbsp;x&nbsp;to&nbsp;standard&nbsp;output,&nbsp;skipping&nbsp;nil&nbsp;fields.</span><br>
<span class="lineno"></span><span class="comment" id="5330061">//&nbsp;Print(fset,&nbsp;x)&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;Fprint(os.Stdout,&nbsp;fset,&nbsp;x,&nbsp;NotNilFilter).</span><br>
<span class="lineno">70</span><span class="keyword" id="5330136">func</span>&nbsp;<span class="ident" id="5330141">Print</span><span class="op" id="5330146">(</span><span class="ident" id="5330147">fset</span>&nbsp;<span class="op" id="5330152">*</span><span class="ident" id="5330153">token</span><span class="op" id="5330158">.</span><span class="ident" id="5330159">FileSet</span><span class="op" id="5330166">,</span>&nbsp;<span class="ident" id="5330168">x</span>&nbsp;<span class="keyword" id="5330170">interface</span><span class="op" id="5330179">{</span><span class="op" id="5330180">}</span><span class="op" id="5330181">)</span>&nbsp;<span class="builtintype" id="5330183">error</span>&nbsp;<span class="op" id="5330189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5330192">return</span>&nbsp;<span class="ident" id="5330199">Fprint</span><span class="op" id="5330205">(</span><span class="ident" id="5330206">os</span><span class="op" id="5330208">.</span><span class="ident" id="5330209">Stdout</span><span class="op" id="5330215">,</span>&nbsp;<span class="ident" id="5330217">fset</span><span class="op" id="5330221">,</span>&nbsp;<span class="ident" id="5330223">x</span><span class="op" id="5330224">,</span>&nbsp;<span class="ident" id="5330226">NotNilFilter</span><span class="op" id="5330238">)</span><br>
<span class="lineno"></span><span class="op" id="5330240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5330243">type</span>&nbsp;<span class="ident" id="5330248">printer</span>&nbsp;<span class="keyword" id="5330256">struct</span>&nbsp;<span class="op" id="5330263">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5330266">output</span>&nbsp;<span class="ident" id="5330273">io</span><span class="op" id="5330275">.</span><span class="ident" id="5330276">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5330284">fset</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5330291">*</span><span class="ident" id="5330292">token</span><span class="op" id="5330297">.</span><span class="ident" id="5330298">FileSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5330307">filter</span>&nbsp;<span class="ident" id="5330314">FieldFilter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5330327">ptrmap</span>&nbsp;<span class="keyword" id="5330334">map</span><span class="op" id="5330337">[</span><span class="keyword" id="5330338">interface</span><span class="op" id="5330347">{</span><span class="op" id="5330348">}</span><span class="op" id="5330349">]</span><span class="builtintype" id="5330350">int</span>&nbsp;<span class="comment" id="5330354">//&nbsp;*T&nbsp;-&gt;&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5330376">indent</span>&nbsp;<span class="builtintype" id="5330383">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5330403">//&nbsp;current&nbsp;indentation&nbsp;level</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5330433">last</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5330440">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5330460">//&nbsp;the&nbsp;last&nbsp;byte&nbsp;processed&nbsp;by&nbsp;Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5330497">line</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5330504">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5330524">//&nbsp;current&nbsp;line&nbsp;number</span><br>
<span class="lineno"></span><span class="op" id="5330547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5330550">var</span>&nbsp;<span class="ident" id="5330554">indent</span>&nbsp;<span class="op" id="5330561">=</span>&nbsp;<span class="op" id="5330563">[</span><span class="op" id="5330564">]</span><span class="builtintype" id="5330565">byte</span><span class="op" id="5330569">(</span><span class="string" id="5330570">&#34;.&nbsp;&nbsp;&#34;</span><span class="op" id="5330575">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="5330578">func</span>&nbsp;<span class="op" id="5330583">(</span><span class="ident" id="5330584">p</span>&nbsp;<span class="op" id="5330586">*</span><span class="ident" id="5330587">printer</span><span class="op" id="5330594">)</span>&nbsp;<span class="ident" id="5330596">Write</span><span class="op" id="5330601">(</span><span class="ident" id="5330602">data</span>&nbsp;<span class="op" id="5330607">[</span><span class="op" id="5330608">]</span><span class="builtintype" id="5330609">byte</span><span class="op" id="5330613">)</span>&nbsp;<span class="op" id="5330615">(</span><span class="ident" id="5330616">n</span>&nbsp;<span class="builtintype" id="5330618">int</span><span class="op" id="5330621">,</span>&nbsp;<span class="ident" id="5330623">err</span>&nbsp;<span class="builtintype" id="5330627">error</span><span class="op" id="5330632">)</span>&nbsp;<span class="op" id="5330634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5330637">var</span>&nbsp;<span class="ident" id="5330641">m</span>&nbsp;<span class="builtintype" id="5330643">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5330648">for</span>&nbsp;<span class="ident" id="5330652">i</span><span class="op" id="5330653">,</span>&nbsp;<span class="ident" id="5330655">b</span>&nbsp;<span class="op" id="5330657">:=</span>&nbsp;<span class="keyword" id="5330660">range</span>&nbsp;<span class="ident" id="5330666">data</span>&nbsp;<span class="op" id="5330671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5330675">//&nbsp;invariant:&nbsp;data[0:n]&nbsp;has&nbsp;been&nbsp;written</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5330718">if</span>&nbsp;<span class="ident" id="5330721">b</span>&nbsp;<span class="op" id="5330723">==</span>&nbsp;<span class="string" id="5330726">&#39;\n&#39;</span>&nbsp;<span class="op" id="5330731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5330736">m</span><span class="op" id="5330737">,</span>&nbsp;<span class="ident" id="5330739">err</span>&nbsp;<span class="op" id="5330743">=</span>&nbsp;<span class="ident" id="5330745">p</span><span class="op" id="5330746">.</span><span class="ident" id="5330747">output</span><span class="op" id="5330753">.</span><span class="ident" id="5330754">Write</span><span class="op" id="5330759">(</span><span class="ident" id="5330760">data</span><span class="op" id="5330764">[</span><span class="ident" id="5330765">n</span>&nbsp;<span class="op" id="5330767">:</span>&nbsp;<span class="ident" id="5330769">i</span><span class="op" id="5330770">+</span><span class="num" id="5330771">1</span><span class="op" id="5330772">]</span><span class="op" id="5330773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5330778">n</span>&nbsp;<span class="op" id="5330780">+=</span>&nbsp;<span class="ident" id="5330783">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5330788">if</span>&nbsp;<span class="ident" id="5330791">err</span>&nbsp;<span class="op" id="5330795">!=</span>&nbsp;<span class="ident" id="5330798">nil</span>&nbsp;<span class="op" id="5330802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5330808">return</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5330818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5330823">p</span><span class="op" id="5330824">.</span><span class="ident" id="5330825">line</span><span class="op" id="5330829">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5330834">}</span>&nbsp;<span class="keyword" id="5330836">else</span>&nbsp;<span class="keyword" id="5330841">if</span>&nbsp;<span class="ident" id="5330844">p</span><span class="op" id="5330845">.</span><span class="ident" id="5330846">last</span>&nbsp;<span class="op" id="5330851">==</span>&nbsp;<span class="string" id="5330854">&#39;\n&#39;</span>&nbsp;<span class="op" id="5330859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5330864">_</span><span class="op" id="5330865">,</span>&nbsp;<span class="ident" id="5330867">err</span>&nbsp;<span class="op" id="5330871">=</span>&nbsp;<span class="ident" id="5330873">fmt</span><span class="op" id="5330876">.</span><span class="ident" id="5330877">Fprintf</span><span class="op" id="5330884">(</span><span class="ident" id="5330885">p</span><span class="op" id="5330886">.</span><span class="ident" id="5330887">output</span><span class="op" id="5330893">,</span>&nbsp;<span class="string" id="5330895">&#34;%6d&nbsp;&nbsp;&#34;</span><span class="op" id="5330902">,</span>&nbsp;<span class="ident" id="5330904">p</span><span class="op" id="5330905">.</span><span class="ident" id="5330906">line</span><span class="op" id="5330910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5330915">if</span>&nbsp;<span class="ident" id="5330918">err</span>&nbsp;<span class="op" id="5330922">!=</span>&nbsp;<span class="ident" id="5330925">nil</span>&nbsp;<span class="op" id="5330929">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5330935">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5330945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5330950">for</span>&nbsp;<span class="ident" id="5330954">j</span>&nbsp;<span class="op" id="5330956">:=</span>&nbsp;<span class="ident" id="5330959">p</span><span class="op" id="5330960">.</span><span class="ident" id="5330961">indent</span><span class="op" id="5330967">;</span>&nbsp;<span class="ident" id="5330969">j</span>&nbsp;<span class="op" id="5330971">&gt;</span>&nbsp;<span class="num" id="5330973">0</span><span class="op" id="5330974">;</span>&nbsp;<span class="ident" id="5330976">j</span><span class="op" id="5330977">--</span>&nbsp;<span class="op" id="5330980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5330986">_</span><span class="op" id="5330987">,</span>&nbsp;<span class="ident" id="5330989">err</span>&nbsp;<span class="op" id="5330993">=</span>&nbsp;<span class="ident" id="5330995">p</span><span class="op" id="5330996">.</span><span class="ident" id="5330997">output</span><span class="op" id="5331003">.</span><span class="ident" id="5331004">Write</span><span class="op" id="5331009">(</span><span class="ident" id="5331010">indent</span><span class="op" id="5331016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5331022">if</span>&nbsp;<span class="ident" id="5331025">err</span>&nbsp;<span class="op" id="5331029">!=</span>&nbsp;<span class="ident" id="5331032">nil</span>&nbsp;<span class="op" id="5331036">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5331043">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5331054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5331059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5331063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5331067">p</span><span class="op" id="5331068">.</span><span class="ident" id="5331069">last</span>&nbsp;<span class="op" id="5331074">=</span>&nbsp;<span class="ident" id="5331076">b</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5331079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5331082">if</span>&nbsp;<span class="builtinfunc" id="5331085">len</span><span class="op" id="5331088">(</span><span class="ident" id="5331089">data</span><span class="op" id="5331093">)</span>&nbsp;<span class="op" id="5331095">&gt;</span>&nbsp;<span class="ident" id="5331097">n</span>&nbsp;<span class="op" id="5331099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5331103">m</span><span class="op" id="5331104">,</span>&nbsp;<span class="ident" id="5331106">err</span>&nbsp;<span class="op" id="5331110">=</span>&nbsp;<span class="ident" id="5331112">p</span><span class="op" id="5331113">.</span><span class="ident" id="5331114">output</span><span class="op" id="5331120">.</span><span class="ident" id="5331121">Write</span><span class="op" id="5331126">(</span><span class="ident" id="5331127">data</span><span class="op" id="5331131">[</span><span class="ident" id="5331132">n</span><span class="op" id="5331133">:</span><span class="op" id="5331134">]</span><span class="op" id="5331135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5331139">n</span>&nbsp;<span class="op" id="5331141">+=</span>&nbsp;<span class="ident" id="5331144">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5331147">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5331150">return</span><br>
<span class="lineno"></span><span class="op" id="5331157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5331160">//&nbsp;localError&nbsp;wraps&nbsp;locally&nbsp;caught&nbsp;errors&nbsp;so&nbsp;we&nbsp;can&nbsp;distinguish</span><br>
<span class="lineno"></span><span class="comment" id="5331224">//&nbsp;them&nbsp;from&nbsp;genuine&nbsp;panics&nbsp;which&nbsp;we&nbsp;don&#39;t&nbsp;want&nbsp;to&nbsp;return&nbsp;as&nbsp;errors.</span><br>
<span class="lineno">120</span><span class="keyword" id="5331293">type</span>&nbsp;<span class="ident" id="5331298">localError</span>&nbsp;<span class="keyword" id="5331309">struct</span>&nbsp;<span class="op" id="5331316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5331319">err</span>&nbsp;<span class="builtintype" id="5331323">error</span><br>
<span class="lineno"></span><span class="op" id="5331329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5331332">//&nbsp;printf&nbsp;is&nbsp;a&nbsp;convenience&nbsp;wrapper&nbsp;that&nbsp;takes&nbsp;care&nbsp;of&nbsp;print&nbsp;errors.</span><br>
<span class="lineno">125</span><span class="keyword" id="5331400">func</span>&nbsp;<span class="op" id="5331405">(</span><span class="ident" id="5331406">p</span>&nbsp;<span class="op" id="5331408">*</span><span class="ident" id="5331409">printer</span><span class="op" id="5331416">)</span>&nbsp;<span class="ident" id="5331418">printf</span><span class="op" id="5331424">(</span><span class="ident" id="5331425">format</span>&nbsp;<span class="builtintype" id="5331432">string</span><span class="op" id="5331438">,</span>&nbsp;<span class="ident" id="5331440">args</span>&nbsp;<span class="op" id="5331445">...</span><span class="keyword" id="5331448">interface</span><span class="op" id="5331457">{</span><span class="op" id="5331458">}</span><span class="op" id="5331459">)</span>&nbsp;<span class="op" id="5331461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5331464">if</span>&nbsp;<span class="ident" id="5331467">_</span><span class="op" id="5331468">,</span>&nbsp;<span class="ident" id="5331470">err</span>&nbsp;<span class="op" id="5331474">:=</span>&nbsp;<span class="ident" id="5331477">fmt</span><span class="op" id="5331480">.</span><span class="ident" id="5331481">Fprintf</span><span class="op" id="5331488">(</span><span class="ident" id="5331489">p</span><span class="op" id="5331490">,</span>&nbsp;<span class="ident" id="5331492">format</span><span class="op" id="5331498">,</span>&nbsp;<span class="ident" id="5331500">args</span><span class="op" id="5331504">...</span><span class="op" id="5331507">)</span><span class="op" id="5331508">;</span>&nbsp;<span class="ident" id="5331510">err</span>&nbsp;<span class="op" id="5331514">!=</span>&nbsp;<span class="ident" id="5331517">nil</span>&nbsp;<span class="op" id="5331521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5331525">panic</span><span class="op" id="5331530">(</span><span class="ident" id="5331531">localError</span><span class="op" id="5331541">{</span><span class="ident" id="5331542">err</span><span class="op" id="5331545">}</span><span class="op" id="5331546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5331549">}</span><br>
<span class="lineno"></span><span class="op" id="5331551">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="5331554">//&nbsp;Implementation&nbsp;note:&nbsp;Print&nbsp;is&nbsp;written&nbsp;for&nbsp;AST&nbsp;nodes&nbsp;but&nbsp;could&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5331622">//&nbsp;used&nbsp;to&nbsp;print&nbsp;arbitrary&nbsp;data&nbsp;structures;&nbsp;such&nbsp;a&nbsp;version&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="5331688">//&nbsp;probably&nbsp;be&nbsp;in&nbsp;a&nbsp;different&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="5331727">//</span><br>
<span class="lineno">135</span><span class="comment" id="5331730">//&nbsp;Note:&nbsp;This&nbsp;code&nbsp;detects&nbsp;(some)&nbsp;cycles&nbsp;created&nbsp;via&nbsp;pointers&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="5331796">//&nbsp;not&nbsp;cycles&nbsp;that&nbsp;are&nbsp;created&nbsp;via&nbsp;slices&nbsp;or&nbsp;maps&nbsp;containing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5331861">//&nbsp;same&nbsp;slice&nbsp;or&nbsp;map.&nbsp;Code&nbsp;for&nbsp;general&nbsp;data&nbsp;structures&nbsp;probably</span><br>
<span class="lineno"></span><span class="comment" id="5331925">//&nbsp;should&nbsp;catch&nbsp;those&nbsp;as&nbsp;well.</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="5331957">func</span>&nbsp;<span class="op" id="5331962">(</span><span class="ident" id="5331963">p</span>&nbsp;<span class="op" id="5331965">*</span><span class="ident" id="5331966">printer</span><span class="op" id="5331973">)</span>&nbsp;<span class="builtinfunc" id="5331975">print</span><span class="op" id="5331980">(</span><span class="ident" id="5331981">x</span>&nbsp;<span class="ident" id="5331983">reflect</span><span class="op" id="5331990">.</span><span class="ident" id="5331991">Value</span><span class="op" id="5331996">)</span>&nbsp;<span class="op" id="5331998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5332001">if</span>&nbsp;<span class="op" id="5332004">!</span><span class="ident" id="5332005">NotNilFilter</span><span class="op" id="5332017">(</span><span class="string" id="5332018">&#34;&#34;</span><span class="op" id="5332020">,</span>&nbsp;<span class="ident" id="5332022">x</span><span class="op" id="5332023">)</span>&nbsp;<span class="op" id="5332025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332029">p</span><span class="op" id="5332030">.</span><span class="ident" id="5332031">printf</span><span class="op" id="5332037">(</span><span class="string" id="5332038">&#34;nil&#34;</span><span class="op" id="5332043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5332047">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5332055">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5332059">switch</span>&nbsp;<span class="ident" id="5332066">x</span><span class="op" id="5332067">.</span><span class="ident" id="5332068">Kind</span><span class="op" id="5332072">(</span><span class="op" id="5332073">)</span>&nbsp;<span class="op" id="5332075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5332078">case</span>&nbsp;<span class="ident" id="5332083">reflect</span><span class="op" id="5332090">.</span><span class="ident" id="5332091">Interface</span><span class="op" id="5332100">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332104">p</span><span class="op" id="5332105">.</span><span class="builtinfunc" id="5332106">print</span><span class="op" id="5332111">(</span><span class="ident" id="5332112">x</span><span class="op" id="5332113">.</span><span class="ident" id="5332114">Elem</span><span class="op" id="5332118">(</span><span class="op" id="5332119">)</span><span class="op" id="5332120">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5332124">case</span>&nbsp;<span class="ident" id="5332129">reflect</span><span class="op" id="5332136">.</span><span class="ident" id="5332137">Map</span><span class="op" id="5332140">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332144">p</span><span class="op" id="5332145">.</span><span class="ident" id="5332146">printf</span><span class="op" id="5332152">(</span><span class="string" id="5332153">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="5332170">,</span>&nbsp;<span class="ident" id="5332172">x</span><span class="op" id="5332173">.</span><span class="ident" id="5332174">Type</span><span class="op" id="5332178">(</span><span class="op" id="5332179">)</span><span class="op" id="5332180">,</span>&nbsp;<span class="ident" id="5332182">x</span><span class="op" id="5332183">.</span><span class="ident" id="5332184">Len</span><span class="op" id="5332187">(</span><span class="op" id="5332188">)</span><span class="op" id="5332189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5332193">if</span>&nbsp;<span class="ident" id="5332196">x</span><span class="op" id="5332197">.</span><span class="ident" id="5332198">Len</span><span class="op" id="5332201">(</span><span class="op" id="5332202">)</span>&nbsp;<span class="op" id="5332204">&gt;</span>&nbsp;<span class="num" id="5332206">0</span>&nbsp;<span class="op" id="5332208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332213">p</span><span class="op" id="5332214">.</span><span class="ident" id="5332215">indent</span><span class="op" id="5332221">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332227">p</span><span class="op" id="5332228">.</span><span class="ident" id="5332229">printf</span><span class="op" id="5332235">(</span><span class="string" id="5332236">&#34;\n&#34;</span><span class="op" id="5332240">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5332245">for</span>&nbsp;<span class="ident" id="5332249">_</span><span class="op" id="5332250">,</span>&nbsp;<span class="ident" id="5332252">key</span>&nbsp;<span class="op" id="5332256">:=</span>&nbsp;<span class="keyword" id="5332259">range</span>&nbsp;<span class="ident" id="5332265">x</span><span class="op" id="5332266">.</span><span class="ident" id="5332267">MapKeys</span><span class="op" id="5332274">(</span><span class="op" id="5332275">)</span>&nbsp;<span class="op" id="5332277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332283">p</span><span class="op" id="5332284">.</span><span class="builtinfunc" id="5332285">print</span><span class="op" id="5332290">(</span><span class="ident" id="5332291">key</span><span class="op" id="5332294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332300">p</span><span class="op" id="5332301">.</span><span class="ident" id="5332302">printf</span><span class="op" id="5332308">(</span><span class="string" id="5332309">&#34;:&nbsp;&#34;</span><span class="op" id="5332313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332319">p</span><span class="op" id="5332320">.</span><span class="builtinfunc" id="5332321">print</span><span class="op" id="5332326">(</span><span class="ident" id="5332327">x</span><span class="op" id="5332328">.</span><span class="ident" id="5332329">MapIndex</span><span class="op" id="5332337">(</span><span class="ident" id="5332338">key</span><span class="op" id="5332341">)</span><span class="op" id="5332342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332348">p</span><span class="op" id="5332349">.</span><span class="ident" id="5332350">printf</span><span class="op" id="5332356">(</span><span class="string" id="5332357">&#34;\n&#34;</span><span class="op" id="5332361">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5332366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332371">p</span><span class="op" id="5332372">.</span><span class="ident" id="5332373">indent</span><span class="op" id="5332379">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5332384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332388">p</span><span class="op" id="5332389">.</span><span class="ident" id="5332390">printf</span><span class="op" id="5332396">(</span><span class="string" id="5332397">&#34;}&#34;</span><span class="op" id="5332400">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5332404">case</span>&nbsp;<span class="ident" id="5332409">reflect</span><span class="op" id="5332416">.</span><span class="ident" id="5332417">Ptr</span><span class="op" id="5332420">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332424">p</span><span class="op" id="5332425">.</span><span class="ident" id="5332426">printf</span><span class="op" id="5332432">(</span><span class="string" id="5332433">&#34;*&#34;</span><span class="op" id="5332436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5332440">//&nbsp;type-checked&nbsp;ASTs&nbsp;may&nbsp;contain&nbsp;cycles&nbsp;-&nbsp;use&nbsp;ptrmap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5332495">//&nbsp;to&nbsp;keep&nbsp;track&nbsp;of&nbsp;objects&nbsp;that&nbsp;have&nbsp;been&nbsp;printed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5332548">//&nbsp;already&nbsp;and&nbsp;print&nbsp;the&nbsp;respective&nbsp;line&nbsp;number&nbsp;instead</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332606">ptr</span>&nbsp;<span class="op" id="5332610">:=</span>&nbsp;<span class="ident" id="5332613">x</span><span class="op" id="5332614">.</span><span class="ident" id="5332615">Interface</span><span class="op" id="5332624">(</span><span class="op" id="5332625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5332629">if</span>&nbsp;<span class="ident" id="5332632">line</span><span class="op" id="5332636">,</span>&nbsp;<span class="ident" id="5332638">exists</span>&nbsp;<span class="op" id="5332645">:=</span>&nbsp;<span class="ident" id="5332648">p</span><span class="op" id="5332649">.</span><span class="ident" id="5332650">ptrmap</span><span class="op" id="5332656">[</span><span class="ident" id="5332657">ptr</span><span class="op" id="5332660">]</span><span class="op" id="5332661">;</span>&nbsp;<span class="ident" id="5332663">exists</span>&nbsp;<span class="op" id="5332670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332675">p</span><span class="op" id="5332676">.</span><span class="ident" id="5332677">printf</span><span class="op" id="5332683">(</span><span class="string" id="5332684">&#34;(obj&nbsp;@&nbsp;%d)&#34;</span><span class="op" id="5332696">,</span>&nbsp;<span class="ident" id="5332698">line</span><span class="op" id="5332702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5332706">}</span>&nbsp;<span class="keyword" id="5332708">else</span>&nbsp;<span class="op" id="5332713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332718">p</span><span class="op" id="5332719">.</span><span class="ident" id="5332720">ptrmap</span><span class="op" id="5332726">[</span><span class="ident" id="5332727">ptr</span><span class="op" id="5332730">]</span>&nbsp;<span class="op" id="5332732">=</span>&nbsp;<span class="ident" id="5332734">p</span><span class="op" id="5332735">.</span><span class="ident" id="5332736">line</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332744">p</span><span class="op" id="5332745">.</span><span class="builtinfunc" id="5332746">print</span><span class="op" id="5332751">(</span><span class="ident" id="5332752">x</span><span class="op" id="5332753">.</span><span class="ident" id="5332754">Elem</span><span class="op" id="5332758">(</span><span class="op" id="5332759">)</span><span class="op" id="5332760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5332764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5332768">case</span>&nbsp;<span class="ident" id="5332773">reflect</span><span class="op" id="5332780">.</span><span class="ident" id="5332781">Array</span><span class="op" id="5332786">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332790">p</span><span class="op" id="5332791">.</span><span class="ident" id="5332792">printf</span><span class="op" id="5332798">(</span><span class="string" id="5332799">&#34;%s&nbsp;{&#34;</span><span class="op" id="5332805">,</span>&nbsp;<span class="ident" id="5332807">x</span><span class="op" id="5332808">.</span><span class="ident" id="5332809">Type</span><span class="op" id="5332813">(</span><span class="op" id="5332814">)</span><span class="op" id="5332815">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5332819">if</span>&nbsp;<span class="ident" id="5332822">x</span><span class="op" id="5332823">.</span><span class="ident" id="5332824">Len</span><span class="op" id="5332827">(</span><span class="op" id="5332828">)</span>&nbsp;<span class="op" id="5332830">&gt;</span>&nbsp;<span class="num" id="5332832">0</span>&nbsp;<span class="op" id="5332834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332839">p</span><span class="op" id="5332840">.</span><span class="ident" id="5332841">indent</span><span class="op" id="5332847">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332853">p</span><span class="op" id="5332854">.</span><span class="ident" id="5332855">printf</span><span class="op" id="5332861">(</span><span class="string" id="5332862">&#34;\n&#34;</span><span class="op" id="5332866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5332871">for</span>&nbsp;<span class="ident" id="5332875">i</span><span class="op" id="5332876">,</span>&nbsp;<span class="ident" id="5332878">n</span>&nbsp;<span class="op" id="5332880">:=</span>&nbsp;<span class="num" id="5332883">0</span><span class="op" id="5332884">,</span>&nbsp;<span class="ident" id="5332886">x</span><span class="op" id="5332887">.</span><span class="ident" id="5332888">Len</span><span class="op" id="5332891">(</span><span class="op" id="5332892">)</span><span class="op" id="5332893">;</span>&nbsp;<span class="ident" id="5332895">i</span>&nbsp;<span class="op" id="5332897">&lt;</span>&nbsp;<span class="ident" id="5332899">n</span><span class="op" id="5332900">;</span>&nbsp;<span class="ident" id="5332902">i</span><span class="op" id="5332903">++</span>&nbsp;<span class="op" id="5332906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332912">p</span><span class="op" id="5332913">.</span><span class="ident" id="5332914">printf</span><span class="op" id="5332920">(</span><span class="string" id="5332921">&#34;%d:&nbsp;&#34;</span><span class="op" id="5332927">,</span>&nbsp;<span class="ident" id="5332929">i</span><span class="op" id="5332930">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332936">p</span><span class="op" id="5332937">.</span><span class="builtinfunc" id="5332938">print</span><span class="op" id="5332943">(</span><span class="ident" id="5332944">x</span><span class="op" id="5332945">.</span><span class="ident" id="5332946">Index</span><span class="op" id="5332951">(</span><span class="ident" id="5332952">i</span><span class="op" id="5332953">)</span><span class="op" id="5332954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332960">p</span><span class="op" id="5332961">.</span><span class="ident" id="5332962">printf</span><span class="op" id="5332968">(</span><span class="string" id="5332969">&#34;\n&#34;</span><span class="op" id="5332973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5332978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5332983">p</span><span class="op" id="5332984">.</span><span class="ident" id="5332985">indent</span><span class="op" id="5332991">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5332996">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333000">p</span><span class="op" id="5333001">.</span><span class="ident" id="5333002">printf</span><span class="op" id="5333008">(</span><span class="string" id="5333009">&#34;}&#34;</span><span class="op" id="5333012">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333016">case</span>&nbsp;<span class="ident" id="5333021">reflect</span><span class="op" id="5333028">.</span><span class="ident" id="5333029">Slice</span><span class="op" id="5333034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333038">if</span>&nbsp;<span class="ident" id="5333041">s</span><span class="op" id="5333042">,</span>&nbsp;<span class="ident" id="5333044">ok</span>&nbsp;<span class="op" id="5333047">:=</span>&nbsp;<span class="ident" id="5333050">x</span><span class="op" id="5333051">.</span><span class="ident" id="5333052">Interface</span><span class="op" id="5333061">(</span><span class="op" id="5333062">)</span><span class="op" id="5333063">.</span><span class="op" id="5333064">(</span><span class="op" id="5333065">[</span><span class="op" id="5333066">]</span><span class="builtintype" id="5333067">byte</span><span class="op" id="5333071">)</span><span class="op" id="5333072">;</span>&nbsp;<span class="ident" id="5333074">ok</span>&nbsp;<span class="op" id="5333077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333082">p</span><span class="op" id="5333083">.</span><span class="ident" id="5333084">printf</span><span class="op" id="5333090">(</span><span class="string" id="5333091">&#34;%#q&#34;</span><span class="op" id="5333096">,</span>&nbsp;<span class="ident" id="5333098">s</span><span class="op" id="5333099">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333104">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5333113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333117">p</span><span class="op" id="5333118">.</span><span class="ident" id="5333119">printf</span><span class="op" id="5333125">(</span><span class="string" id="5333126">&#34;%s&nbsp;(len&nbsp;=&nbsp;%d)&nbsp;{&#34;</span><span class="op" id="5333143">,</span>&nbsp;<span class="ident" id="5333145">x</span><span class="op" id="5333146">.</span><span class="ident" id="5333147">Type</span><span class="op" id="5333151">(</span><span class="op" id="5333152">)</span><span class="op" id="5333153">,</span>&nbsp;<span class="ident" id="5333155">x</span><span class="op" id="5333156">.</span><span class="ident" id="5333157">Len</span><span class="op" id="5333160">(</span><span class="op" id="5333161">)</span><span class="op" id="5333162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333166">if</span>&nbsp;<span class="ident" id="5333169">x</span><span class="op" id="5333170">.</span><span class="ident" id="5333171">Len</span><span class="op" id="5333174">(</span><span class="op" id="5333175">)</span>&nbsp;<span class="op" id="5333177">&gt;</span>&nbsp;<span class="num" id="5333179">0</span>&nbsp;<span class="op" id="5333181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333186">p</span><span class="op" id="5333187">.</span><span class="ident" id="5333188">indent</span><span class="op" id="5333194">++</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333200">p</span><span class="op" id="5333201">.</span><span class="ident" id="5333202">printf</span><span class="op" id="5333208">(</span><span class="string" id="5333209">&#34;\n&#34;</span><span class="op" id="5333213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333218">for</span>&nbsp;<span class="ident" id="5333222">i</span><span class="op" id="5333223">,</span>&nbsp;<span class="ident" id="5333225">n</span>&nbsp;<span class="op" id="5333227">:=</span>&nbsp;<span class="num" id="5333230">0</span><span class="op" id="5333231">,</span>&nbsp;<span class="ident" id="5333233">x</span><span class="op" id="5333234">.</span><span class="ident" id="5333235">Len</span><span class="op" id="5333238">(</span><span class="op" id="5333239">)</span><span class="op" id="5333240">;</span>&nbsp;<span class="ident" id="5333242">i</span>&nbsp;<span class="op" id="5333244">&lt;</span>&nbsp;<span class="ident" id="5333246">n</span><span class="op" id="5333247">;</span>&nbsp;<span class="ident" id="5333249">i</span><span class="op" id="5333250">++</span>&nbsp;<span class="op" id="5333253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333259">p</span><span class="op" id="5333260">.</span><span class="ident" id="5333261">printf</span><span class="op" id="5333267">(</span><span class="string" id="5333268">&#34;%d:&nbsp;&#34;</span><span class="op" id="5333274">,</span>&nbsp;<span class="ident" id="5333276">i</span><span class="op" id="5333277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333283">p</span><span class="op" id="5333284">.</span><span class="builtinfunc" id="5333285">print</span><span class="op" id="5333290">(</span><span class="ident" id="5333291">x</span><span class="op" id="5333292">.</span><span class="ident" id="5333293">Index</span><span class="op" id="5333298">(</span><span class="ident" id="5333299">i</span><span class="op" id="5333300">)</span><span class="op" id="5333301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333307">p</span><span class="op" id="5333308">.</span><span class="ident" id="5333309">printf</span><span class="op" id="5333315">(</span><span class="string" id="5333316">&#34;\n&#34;</span><span class="op" id="5333320">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5333325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333330">p</span><span class="op" id="5333331">.</span><span class="ident" id="5333332">indent</span><span class="op" id="5333338">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5333343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333347">p</span><span class="op" id="5333348">.</span><span class="ident" id="5333349">printf</span><span class="op" id="5333355">(</span><span class="string" id="5333356">&#34;}&#34;</span><span class="op" id="5333359">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333363">case</span>&nbsp;<span class="ident" id="5333368">reflect</span><span class="op" id="5333375">.</span><span class="ident" id="5333376">Struct</span><span class="op" id="5333382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333386">t</span>&nbsp;<span class="op" id="5333388">:=</span>&nbsp;<span class="ident" id="5333391">x</span><span class="op" id="5333392">.</span><span class="ident" id="5333393">Type</span><span class="op" id="5333397">(</span><span class="op" id="5333398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333402">p</span><span class="op" id="5333403">.</span><span class="ident" id="5333404">printf</span><span class="op" id="5333410">(</span><span class="string" id="5333411">&#34;%s&nbsp;{&#34;</span><span class="op" id="5333417">,</span>&nbsp;<span class="ident" id="5333419">t</span><span class="op" id="5333420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333424">p</span><span class="op" id="5333425">.</span><span class="ident" id="5333426">indent</span><span class="op" id="5333432">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333437">first</span>&nbsp;<span class="op" id="5333443">:=</span>&nbsp;<span class="builtintype" id="5333446">true</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333453">for</span>&nbsp;<span class="ident" id="5333457">i</span><span class="op" id="5333458">,</span>&nbsp;<span class="ident" id="5333460">n</span>&nbsp;<span class="op" id="5333462">:=</span>&nbsp;<span class="num" id="5333465">0</span><span class="op" id="5333466">,</span>&nbsp;<span class="ident" id="5333468">t</span><span class="op" id="5333469">.</span><span class="ident" id="5333470">NumField</span><span class="op" id="5333478">(</span><span class="op" id="5333479">)</span><span class="op" id="5333480">;</span>&nbsp;<span class="ident" id="5333482">i</span>&nbsp;<span class="op" id="5333484">&lt;</span>&nbsp;<span class="ident" id="5333486">n</span><span class="op" id="5333487">;</span>&nbsp;<span class="ident" id="5333489">i</span><span class="op" id="5333490">++</span>&nbsp;<span class="op" id="5333493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5333498">//&nbsp;exclude&nbsp;non-exported&nbsp;fields&nbsp;because&nbsp;their</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5333546">//&nbsp;values&nbsp;cannot&nbsp;be&nbsp;accessed&nbsp;via&nbsp;reflection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333593">if</span>&nbsp;<span class="ident" id="5333596">name</span>&nbsp;<span class="op" id="5333601">:=</span>&nbsp;<span class="ident" id="5333604">t</span><span class="op" id="5333605">.</span><span class="ident" id="5333606">Field</span><span class="op" id="5333611">(</span><span class="ident" id="5333612">i</span><span class="op" id="5333613">)</span><span class="op" id="5333614">.</span><span class="ident" id="5333615">Name</span><span class="op" id="5333619">;</span>&nbsp;<span class="ident" id="5333621">IsExported</span><span class="op" id="5333631">(</span><span class="ident" id="5333632">name</span><span class="op" id="5333636">)</span>&nbsp;<span class="op" id="5333638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333644">value</span>&nbsp;<span class="op" id="5333650">:=</span>&nbsp;<span class="ident" id="5333653">x</span><span class="op" id="5333654">.</span><span class="ident" id="5333655">Field</span><span class="op" id="5333660">(</span><span class="ident" id="5333661">i</span><span class="op" id="5333662">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333668">if</span>&nbsp;<span class="ident" id="5333671">p</span><span class="op" id="5333672">.</span><span class="ident" id="5333673">filter</span>&nbsp;<span class="op" id="5333680">==</span>&nbsp;<span class="ident" id="5333683">nil</span>&nbsp;<span class="op" id="5333687">||</span>&nbsp;<span class="ident" id="5333690">p</span><span class="op" id="5333691">.</span><span class="ident" id="5333692">filter</span><span class="op" id="5333698">(</span><span class="ident" id="5333699">name</span><span class="op" id="5333703">,</span>&nbsp;<span class="ident" id="5333705">value</span><span class="op" id="5333710">)</span>&nbsp;<span class="op" id="5333712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333719">if</span>&nbsp;<span class="ident" id="5333722">first</span>&nbsp;<span class="op" id="5333728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333736">p</span><span class="op" id="5333737">.</span><span class="ident" id="5333738">printf</span><span class="op" id="5333744">(</span><span class="string" id="5333745">&#34;\n&#34;</span><span class="op" id="5333749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333757">first</span>&nbsp;<span class="op" id="5333763">=</span>&nbsp;<span class="builtintype" id="5333765">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5333776">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333783">p</span><span class="op" id="5333784">.</span><span class="ident" id="5333785">printf</span><span class="op" id="5333791">(</span><span class="string" id="5333792">&#34;%s:&nbsp;&#34;</span><span class="op" id="5333798">,</span>&nbsp;<span class="ident" id="5333800">name</span><span class="op" id="5333804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333811">p</span><span class="op" id="5333812">.</span><span class="builtinfunc" id="5333813">print</span><span class="op" id="5333818">(</span><span class="ident" id="5333819">value</span><span class="op" id="5333824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333831">p</span><span class="op" id="5333832">.</span><span class="ident" id="5333833">printf</span><span class="op" id="5333839">(</span><span class="string" id="5333840">&#34;\n&#34;</span><span class="op" id="5333844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5333850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5333855">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5333859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333863">p</span><span class="op" id="5333864">.</span><span class="ident" id="5333865">indent</span><span class="op" id="5333871">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333876">p</span><span class="op" id="5333877">.</span><span class="ident" id="5333878">printf</span><span class="op" id="5333884">(</span><span class="string" id="5333885">&#34;}&#34;</span><span class="op" id="5333888">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333892">default</span><span class="op" id="5333899">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333903">v</span>&nbsp;<span class="op" id="5333905">:=</span>&nbsp;<span class="ident" id="5333908">x</span><span class="op" id="5333909">.</span><span class="ident" id="5333910">Interface</span><span class="op" id="5333919">(</span><span class="op" id="5333920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333924">switch</span>&nbsp;<span class="ident" id="5333931">v</span>&nbsp;<span class="op" id="5333933">:=</span>&nbsp;<span class="ident" id="5333936">v</span><span class="op" id="5333937">.</span><span class="op" id="5333938">(</span><span class="keyword" id="5333939">type</span><span class="op" id="5333943">)</span>&nbsp;<span class="op" id="5333945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5333949">case</span>&nbsp;<span class="builtintype" id="5333954">string</span><span class="op" id="5333960">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5333965">//&nbsp;print&nbsp;strings&nbsp;in&nbsp;quotes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5333995">p</span><span class="op" id="5333996">.</span><span class="ident" id="5333997">printf</span><span class="op" id="5334003">(</span><span class="string" id="5334004">&#34;%q&#34;</span><span class="op" id="5334008">,</span>&nbsp;<span class="ident" id="5334010">v</span><span class="op" id="5334011">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5334016">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5334025">case</span>&nbsp;<span class="ident" id="5334030">token</span><span class="op" id="5334035">.</span><span class="ident" id="5334036">Pos</span><span class="op" id="5334039">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5334044">//&nbsp;position&nbsp;values&nbsp;can&nbsp;be&nbsp;printed&nbsp;nicely&nbsp;if&nbsp;we&nbsp;have&nbsp;a&nbsp;file&nbsp;set</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5334110">if</span>&nbsp;<span class="ident" id="5334113">p</span><span class="op" id="5334114">.</span><span class="ident" id="5334115">fset</span>&nbsp;<span class="op" id="5334120">!=</span>&nbsp;<span class="ident" id="5334123">nil</span>&nbsp;<span class="op" id="5334127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5334133">p</span><span class="op" id="5334134">.</span><span class="ident" id="5334135">printf</span><span class="op" id="5334141">(</span><span class="string" id="5334142">&#34;%s&#34;</span><span class="op" id="5334146">,</span>&nbsp;<span class="ident" id="5334148">p</span><span class="op" id="5334149">.</span><span class="ident" id="5334150">fset</span><span class="op" id="5334154">.</span><span class="ident" id="5334155">Position</span><span class="op" id="5334163">(</span><span class="ident" id="5334164">v</span><span class="op" id="5334165">)</span><span class="op" id="5334166">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5334172">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5334182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5334186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5334190">//&nbsp;default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5334203">p</span><span class="op" id="5334204">.</span><span class="ident" id="5334205">printf</span><span class="op" id="5334211">(</span><span class="string" id="5334212">&#34;%v&#34;</span><span class="op" id="5334216">,</span>&nbsp;<span class="ident" id="5334218">v</span><span class="op" id="5334219">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5334222">}</span><br>
<span class="lineno"></span><span class="op" id="5334224">}</span>
</div>
</body>
</html>
