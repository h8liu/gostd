<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7946812">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7946867">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7946921">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7946972">package</span>&nbsp;<span class="ident" id="7946980">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7946990">//&nbsp;Tests&nbsp;for&nbsp;mulitple-template&nbsp;parsing&nbsp;and&nbsp;execution.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7947045">import</span>&nbsp;<span class="op" id="7947052">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7947055">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7947064">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7947071">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7947082">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7947093">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7947115">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7947118">const</span>&nbsp;<span class="op" id="7947124">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947127">noError</span>&nbsp;&nbsp;<span class="op" id="7947136">=</span>&nbsp;<span class="builtintype" id="7947138">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947144">hasError</span>&nbsp;<span class="op" id="7947153">=</span>&nbsp;<span class="builtintype" id="7947155">false</span><br>
<span class="lineno">20</span><span class="op" id="7947161">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7947164">type</span>&nbsp;<span class="ident" id="7947169">multiParseTest</span>&nbsp;<span class="keyword" id="7947184">struct</span>&nbsp;<span class="op" id="7947191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947194">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7947202">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947210">input</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7947218">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947226">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7947234">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947240">names</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7947248">[</span><span class="op" id="7947249">]</span><span class="builtintype" id="7947250">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947258">results</span>&nbsp;<span class="op" id="7947266">[</span><span class="op" id="7947267">]</span><span class="builtintype" id="7947268">string</span><br>
<span class="lineno"></span><span class="op" id="7947275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7947278">var</span>&nbsp;<span class="ident" id="7947282">multiParseTests</span>&nbsp;<span class="op" id="7947298">=</span>&nbsp;<span class="op" id="7947300">[</span><span class="op" id="7947301">]</span><span class="ident" id="7947302">multiParseTest</span><span class="op" id="7947316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947319">{</span><span class="string" id="7947320">&#34;empty&#34;</span><span class="op" id="7947327">,</span>&nbsp;<span class="string" id="7947329">&#34;&#34;</span><span class="op" id="7947331">,</span>&nbsp;<span class="ident" id="7947333">noError</span><span class="op" id="7947340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947344">nil</span><span class="op" id="7947347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947351">nil</span><span class="op" id="7947354">}</span><span class="op" id="7947355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947358">{</span><span class="string" id="7947359">&#34;one&#34;</span><span class="op" id="7947364">,</span>&nbsp;<span class="string" id="7947366">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}`</span><span class="op" id="7947396">,</span>&nbsp;<span class="ident" id="7947398">noError</span><span class="op" id="7947405">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947409">[</span><span class="op" id="7947410">]</span><span class="builtintype" id="7947411">string</span><span class="op" id="7947417">{</span><span class="string" id="7947418">&#34;foo&#34;</span><span class="op" id="7947423">}</span><span class="op" id="7947424">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947428">[</span><span class="op" id="7947429">]</span><span class="builtintype" id="7947430">string</span><span class="op" id="7947436">{</span><span class="string" id="7947437">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7947444">}</span><span class="op" id="7947445">}</span><span class="op" id="7947446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947449">{</span><span class="string" id="7947450">&#34;two&#34;</span><span class="op" id="7947455">,</span>&nbsp;<span class="string" id="7947457">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;{{end}}{{define&nbsp;&#34;bar&#34;}}&nbsp;BAR&nbsp;{{end}}`</span><span class="op" id="7947515">,</span>&nbsp;<span class="ident" id="7947517">noError</span><span class="op" id="7947524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947528">[</span><span class="op" id="7947529">]</span><span class="builtintype" id="7947530">string</span><span class="op" id="7947536">{</span><span class="string" id="7947537">&#34;foo&#34;</span><span class="op" id="7947542">,</span>&nbsp;<span class="string" id="7947544">&#34;bar&#34;</span><span class="op" id="7947549">}</span><span class="op" id="7947550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947554">[</span><span class="op" id="7947555">]</span><span class="builtintype" id="7947556">string</span><span class="op" id="7947562">{</span><span class="string" id="7947563">&#34;&nbsp;FOO&nbsp;&#34;</span><span class="op" id="7947570">,</span>&nbsp;<span class="string" id="7947572">&#34;&nbsp;BAR&nbsp;&#34;</span><span class="op" id="7947579">}</span><span class="op" id="7947580">}</span><span class="op" id="7947581">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7947584">//&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947595">{</span><span class="string" id="7947596">&#34;missing&nbsp;end&#34;</span><span class="op" id="7947609">,</span>&nbsp;<span class="string" id="7947611">`{{define&nbsp;&#34;foo&#34;}}&nbsp;FOO&nbsp;`</span><span class="op" id="7947634">,</span>&nbsp;<span class="ident" id="7947636">hasError</span><span class="op" id="7947644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947648">nil</span><span class="op" id="7947651">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947655">nil</span><span class="op" id="7947658">}</span><span class="op" id="7947659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7947662">{</span><span class="string" id="7947663">&#34;malformed&nbsp;name&#34;</span><span class="op" id="7947679">,</span>&nbsp;<span class="string" id="7947681">`{{define&nbsp;&#34;foo}}&nbsp;FOO&nbsp;`</span><span class="op" id="7947703">,</span>&nbsp;<span class="ident" id="7947705">hasError</span><span class="op" id="7947713">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947717">nil</span><span class="op" id="7947720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947724">nil</span><span class="op" id="7947727">}</span><span class="op" id="7947728">,</span><br>
<span class="lineno"></span><span class="op" id="7947730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7947733">func</span>&nbsp;<span class="ident" id="7947738">TestMultiParse</span><span class="op" id="7947752">(</span><span class="ident" id="7947753">t</span>&nbsp;<span class="op" id="7947755">*</span><span class="ident" id="7947756">testing</span><span class="op" id="7947763">.</span><span class="ident" id="7947764">T</span><span class="op" id="7947765">)</span>&nbsp;<span class="op" id="7947767">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7947770">for</span>&nbsp;<span class="ident" id="7947774">_</span><span class="op" id="7947775">,</span>&nbsp;<span class="ident" id="7947777">test</span>&nbsp;<span class="op" id="7947782">:=</span>&nbsp;<span class="keyword" id="7947785">range</span>&nbsp;<span class="ident" id="7947791">multiParseTests</span>&nbsp;<span class="op" id="7947807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947811">template</span><span class="op" id="7947819">,</span>&nbsp;<span class="ident" id="7947821">err</span>&nbsp;<span class="op" id="7947825">:=</span>&nbsp;<span class="ident" id="7947828">New</span><span class="op" id="7947831">(</span><span class="string" id="7947832">&#34;root&#34;</span><span class="op" id="7947838">)</span><span class="op" id="7947839">.</span><span class="ident" id="7947840">Parse</span><span class="op" id="7947845">(</span><span class="ident" id="7947846">test</span><span class="op" id="7947850">.</span><span class="ident" id="7947851">input</span><span class="op" id="7947856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7947860">switch</span>&nbsp;<span class="op" id="7947867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7947871">case</span>&nbsp;<span class="ident" id="7947876">err</span>&nbsp;<span class="op" id="7947880">==</span>&nbsp;<span class="ident" id="7947883">nil</span>&nbsp;<span class="op" id="7947887">&amp;&amp;</span>&nbsp;<span class="op" id="7947890">!</span><span class="ident" id="7947891">test</span><span class="op" id="7947895">.</span><span class="ident" id="7947896">ok</span><span class="op" id="7947898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7947903">t</span><span class="op" id="7947904">.</span><span class="ident" id="7947905">Errorf</span><span class="op" id="7947911">(</span><span class="string" id="7947912">&#34;%q:&nbsp;expected&nbsp;error;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7947942">,</span>&nbsp;<span class="ident" id="7947944">test</span><span class="op" id="7947948">.</span><span class="ident" id="7947949">name</span><span class="op" id="7947953">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7947958">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7947969">case</span>&nbsp;<span class="ident" id="7947974">err</span>&nbsp;<span class="op" id="7947978">!=</span>&nbsp;<span class="ident" id="7947981">nil</span>&nbsp;<span class="op" id="7947985">&amp;&amp;</span>&nbsp;<span class="ident" id="7947988">test</span><span class="op" id="7947992">.</span><span class="ident" id="7947993">ok</span><span class="op" id="7947995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7948000">t</span><span class="op" id="7948001">.</span><span class="ident" id="7948002">Errorf</span><span class="op" id="7948008">(</span><span class="string" id="7948009">&#34;%q:&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="7948035">,</span>&nbsp;<span class="ident" id="7948037">test</span><span class="op" id="7948041">.</span><span class="ident" id="7948042">name</span><span class="op" id="7948046">,</span>&nbsp;<span class="ident" id="7948048">err</span><span class="op" id="7948051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7948056">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7948067">case</span>&nbsp;<span class="ident" id="7948072">err</span>&nbsp;<span class="op" id="7948076">!=</span>&nbsp;<span class="ident" id="7948079">nil</span>&nbsp;<span class="op" id="7948083">&amp;&amp;</span>&nbsp;<span class="op" id="7948086">!</span><span class="ident" id="7948087">test</span><span class="op" id="7948091">.</span><span class="ident" id="7948092">ok</span><span class="op" id="7948094">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7948099">//&nbsp;expected&nbsp;error,&nbsp;got&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7948129">if</span>&nbsp;<span class="op" id="7948132">*</span><span class="ident" id="7948133">debug</span>&nbsp;<span class="op" id="7948139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7948145">fmt</span><span class="op" id="7948148">.</span><span class="ident" id="7948149">Printf</span><span class="op" id="7948155">(</span><span class="string" id="7948156">&#34;%s:&nbsp;%s\n\t%s\n&#34;</span><span class="op" id="7948172">,</span>&nbsp;<span class="ident" id="7948174">test</span><span class="op" id="7948178">.</span><span class="ident" id="7948179">name</span><span class="op" id="7948183">,</span>&nbsp;<span class="ident" id="7948185">test</span><span class="op" id="7948189">.</span><span class="ident" id="7948190">input</span><span class="op" id="7948195">,</span>&nbsp;<span class="ident" id="7948197">err</span><span class="op" id="7948200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7948205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7948210">continue</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7948221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7948225">if</span>&nbsp;<span class="ident" id="7948228">template</span>&nbsp;<span class="op" id="7948237">==</span>&nbsp;<span class="ident" id="7948240">nil</span>&nbsp;<span class="op" id="7948244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7948249">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7948260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7948264">if</span>&nbsp;<span class="builtinfunc" id="7948267">len</span><span class="op" id="7948270">(</span><span class="ident" id="7948271">template</span><span class="op" id="7948279">.</span><span class="ident" id="7948280">tmpl</span><span class="op" id="7948284">)</span>&nbsp;<span class="op" id="7948286">!=</span>&nbsp;<span class="builtinfunc" id="7948289">len</span><span class="op" id="7948292">(</span><span class="ident" id="7948293">test</span><span class="op" id="7948297">.</span><span class="ident" id="7948298">names</span><span class="op" id="7948303">)</span><span class="op" id="7948304">+</span><span class="num" id="7948305">1</span>&nbsp;<span class="op" id="7948307">{</span>&nbsp;<span class="comment" id="7948309">//&nbsp;+1&nbsp;for&nbsp;root</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7948327">t</span><span class="op" id="7948328">.</span><span class="ident" id="7948329">Errorf</span><span class="op" id="7948335">(</span><span class="string" id="7948336">&#34;%s:&nbsp;wrong&nbsp;number&nbsp;of&nbsp;templates;&nbsp;wanted&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7948385">,</span>&nbsp;<span class="ident" id="7948387">test</span><span class="op" id="7948391">.</span><span class="ident" id="7948392">name</span><span class="op" id="7948396">,</span>&nbsp;<span class="builtinfunc" id="7948398">len</span><span class="op" id="7948401">(</span><span class="ident" id="7948402">test</span><span class="op" id="7948406">.</span><span class="ident" id="7948407">names</span><span class="op" id="7948412">)</span><span class="op" id="7948413">,</span>&nbsp;<span class="builtinfunc" id="7948415">len</span><span class="op" id="7948418">(</span><span class="ident" id="7948419">template</span><span class="op" id="7948427">.</span><span class="ident" id="7948428">tmpl</span><span class="op" id="7948432">)</span><span class="op" id="7948433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7948438">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7948449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7948453">for</span>&nbsp;<span class="ident" id="7948457">i</span><span class="op" id="7948458">,</span>&nbsp;<span class="ident" id="7948460">name</span>&nbsp;<span class="op" id="7948465">:=</span>&nbsp;<span class="keyword" id="7948468">range</span>&nbsp;<span class="ident" id="7948474">test</span><span class="op" id="7948478">.</span><span class="ident" id="7948479">names</span>&nbsp;<span class="op" id="7948485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7948490">tmpl</span><span class="op" id="7948494">,</span>&nbsp;<span class="ident" id="7948496">ok</span>&nbsp;<span class="op" id="7948499">:=</span>&nbsp;<span class="ident" id="7948502">template</span><span class="op" id="7948510">.</span><span class="ident" id="7948511">tmpl</span><span class="op" id="7948515">[</span><span class="ident" id="7948516">name</span><span class="op" id="7948520">]</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7948525">if</span>&nbsp;<span class="op" id="7948528">!</span><span class="ident" id="7948529">ok</span>&nbsp;<span class="op" id="7948532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7948538">t</span><span class="op" id="7948539">.</span><span class="ident" id="7948540">Errorf</span><span class="op" id="7948546">(</span><span class="string" id="7948547">&#34;%s:&nbsp;can&#39;t&nbsp;find&nbsp;template&nbsp;%q&#34;</span><span class="op" id="7948575">,</span>&nbsp;<span class="ident" id="7948577">test</span><span class="op" id="7948581">.</span><span class="ident" id="7948582">name</span><span class="op" id="7948586">,</span>&nbsp;<span class="ident" id="7948588">name</span><span class="op" id="7948592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7948598">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7948610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7948615">result</span>&nbsp;<span class="op" id="7948622">:=</span>&nbsp;<span class="ident" id="7948625">tmpl</span><span class="op" id="7948629">.</span><span class="ident" id="7948630">Root</span><span class="op" id="7948634">.</span><span class="ident" id="7948635">String</span><span class="op" id="7948641">(</span><span class="op" id="7948642">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7948647">if</span>&nbsp;<span class="ident" id="7948650">result</span>&nbsp;<span class="op" id="7948657">!=</span>&nbsp;<span class="ident" id="7948660">test</span><span class="op" id="7948664">.</span><span class="ident" id="7948665">results</span><span class="op" id="7948672">[</span><span class="ident" id="7948673">i</span><span class="op" id="7948674">]</span>&nbsp;<span class="op" id="7948676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7948682">t</span><span class="op" id="7948683">.</span><span class="ident" id="7948684">Errorf</span><span class="op" id="7948690">(</span><span class="string" id="7948691">&#34;%s=(%q):&nbsp;got\n\t%v\nexpected\n\t%v&#34;</span><span class="op" id="7948727">,</span>&nbsp;<span class="ident" id="7948729">test</span><span class="op" id="7948733">.</span><span class="ident" id="7948734">name</span><span class="op" id="7948738">,</span>&nbsp;<span class="ident" id="7948740">test</span><span class="op" id="7948744">.</span><span class="ident" id="7948745">input</span><span class="op" id="7948750">,</span>&nbsp;<span class="ident" id="7948752">result</span><span class="op" id="7948758">,</span>&nbsp;<span class="ident" id="7948760">test</span><span class="op" id="7948764">.</span><span class="ident" id="7948765">results</span><span class="op" id="7948772">[</span><span class="ident" id="7948773">i</span><span class="op" id="7948774">]</span><span class="op" id="7948775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7948780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7948784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7948787">}</span><br>
<span class="lineno">85</span><span class="op" id="7948789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7948792">var</span>&nbsp;<span class="ident" id="7948796">multiExecTests</span>&nbsp;<span class="op" id="7948811">=</span>&nbsp;<span class="op" id="7948813">[</span><span class="op" id="7948814">]</span><span class="ident" id="7948815">execTest</span><span class="op" id="7948823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7948826">{</span><span class="string" id="7948827">&#34;empty&#34;</span><span class="op" id="7948834">,</span>&nbsp;<span class="string" id="7948836">&#34;&#34;</span><span class="op" id="7948838">,</span>&nbsp;<span class="string" id="7948840">&#34;&#34;</span><span class="op" id="7948842">,</span>&nbsp;<span class="ident" id="7948844">nil</span><span class="op" id="7948847">,</span>&nbsp;<span class="builtintype" id="7948849">true</span><span class="op" id="7948853">}</span><span class="op" id="7948854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7948857">{</span><span class="string" id="7948858">&#34;text&#34;</span><span class="op" id="7948864">,</span>&nbsp;<span class="string" id="7948866">&#34;some&nbsp;text&#34;</span><span class="op" id="7948877">,</span>&nbsp;<span class="string" id="7948879">&#34;some&nbsp;text&#34;</span><span class="op" id="7948890">,</span>&nbsp;<span class="ident" id="7948892">nil</span><span class="op" id="7948895">,</span>&nbsp;<span class="builtintype" id="7948897">true</span><span class="op" id="7948901">}</span><span class="op" id="7948902">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7948905">{</span><span class="string" id="7948906">&#34;invoke&nbsp;x&#34;</span><span class="op" id="7948916">,</span>&nbsp;<span class="string" id="7948918">`{{template&nbsp;&#34;x&#34;&nbsp;.SI}}`</span><span class="op" id="7948940">,</span>&nbsp;<span class="string" id="7948942">&#34;TEXT&#34;</span><span class="op" id="7948948">,</span>&nbsp;<span class="ident" id="7948950">tVal</span><span class="op" id="7948954">,</span>&nbsp;<span class="builtintype" id="7948956">true</span><span class="op" id="7948960">}</span><span class="op" id="7948961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7948964">{</span><span class="string" id="7948965">&#34;invoke&nbsp;x&nbsp;no&nbsp;args&#34;</span><span class="op" id="7948983">,</span>&nbsp;<span class="string" id="7948985">`{{template&nbsp;&#34;x&#34;}}`</span><span class="op" id="7949003">,</span>&nbsp;<span class="string" id="7949005">&#34;TEXT&#34;</span><span class="op" id="7949011">,</span>&nbsp;<span class="ident" id="7949013">tVal</span><span class="op" id="7949017">,</span>&nbsp;<span class="builtintype" id="7949019">true</span><span class="op" id="7949023">}</span><span class="op" id="7949024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7949027">{</span><span class="string" id="7949028">&#34;invoke&nbsp;dot&nbsp;int&#34;</span><span class="op" id="7949044">,</span>&nbsp;<span class="string" id="7949046">`{{template&nbsp;&#34;dot&#34;&nbsp;.I}}`</span><span class="op" id="7949069">,</span>&nbsp;<span class="string" id="7949071">&#34;17&#34;</span><span class="op" id="7949075">,</span>&nbsp;<span class="ident" id="7949077">tVal</span><span class="op" id="7949081">,</span>&nbsp;<span class="builtintype" id="7949083">true</span><span class="op" id="7949087">}</span><span class="op" id="7949088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7949091">{</span><span class="string" id="7949092">&#34;invoke&nbsp;dot&nbsp;[]int&#34;</span><span class="op" id="7949110">,</span>&nbsp;<span class="string" id="7949112">`{{template&nbsp;&#34;dot&#34;&nbsp;.SI}}`</span><span class="op" id="7949136">,</span>&nbsp;<span class="string" id="7949138">&#34;[3&nbsp;4&nbsp;5]&#34;</span><span class="op" id="7949147">,</span>&nbsp;<span class="ident" id="7949149">tVal</span><span class="op" id="7949153">,</span>&nbsp;<span class="builtintype" id="7949155">true</span><span class="op" id="7949159">}</span><span class="op" id="7949160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7949163">{</span><span class="string" id="7949164">&#34;invoke&nbsp;dotV&#34;</span><span class="op" id="7949177">,</span>&nbsp;<span class="string" id="7949179">`{{template&nbsp;&#34;dotV&#34;&nbsp;.U}}`</span><span class="op" id="7949203">,</span>&nbsp;<span class="string" id="7949205">&#34;v&#34;</span><span class="op" id="7949208">,</span>&nbsp;<span class="ident" id="7949210">tVal</span><span class="op" id="7949214">,</span>&nbsp;<span class="builtintype" id="7949216">true</span><span class="op" id="7949220">}</span><span class="op" id="7949221">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7949224">{</span><span class="string" id="7949225">&#34;invoke&nbsp;nested&nbsp;int&#34;</span><span class="op" id="7949244">,</span>&nbsp;<span class="string" id="7949246">`{{template&nbsp;&#34;nested&#34;&nbsp;.I}}`</span><span class="op" id="7949272">,</span>&nbsp;<span class="string" id="7949274">&#34;17&#34;</span><span class="op" id="7949278">,</span>&nbsp;<span class="ident" id="7949280">tVal</span><span class="op" id="7949284">,</span>&nbsp;<span class="builtintype" id="7949286">true</span><span class="op" id="7949290">}</span><span class="op" id="7949291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7949294">{</span><span class="string" id="7949295">&#34;variable&nbsp;declared&nbsp;by&nbsp;template&#34;</span><span class="op" id="7949326">,</span>&nbsp;<span class="string" id="7949328">`{{template&nbsp;&#34;nested&#34;&nbsp;$x:=.SI}},{{index&nbsp;$x&nbsp;1}}`</span><span class="op" id="7949374">,</span>&nbsp;<span class="string" id="7949376">&#34;[3&nbsp;4&nbsp;5],4&#34;</span><span class="op" id="7949387">,</span>&nbsp;<span class="ident" id="7949389">tVal</span><span class="op" id="7949393">,</span>&nbsp;<span class="builtintype" id="7949395">true</span><span class="op" id="7949399">}</span><span class="op" id="7949400">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7949404">//&nbsp;User-defined&nbsp;function:&nbsp;test&nbsp;argument&nbsp;evaluator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7949456">{</span><span class="string" id="7949457">&#34;testFunc&nbsp;literal&#34;</span><span class="op" id="7949475">,</span>&nbsp;<span class="string" id="7949477">`{{oneArg&nbsp;&#34;joe&#34;}}`</span><span class="op" id="7949495">,</span>&nbsp;<span class="string" id="7949497">&#34;oneArg=joe&#34;</span><span class="op" id="7949509">,</span>&nbsp;<span class="ident" id="7949511">tVal</span><span class="op" id="7949515">,</span>&nbsp;<span class="builtintype" id="7949517">true</span><span class="op" id="7949521">}</span><span class="op" id="7949522">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7949525">{</span><span class="string" id="7949526">&#34;testFunc&nbsp;.&#34;</span><span class="op" id="7949538">,</span>&nbsp;<span class="string" id="7949540">`{{oneArg&nbsp;.}}`</span><span class="op" id="7949554">,</span>&nbsp;<span class="string" id="7949556">&#34;oneArg=joe&#34;</span><span class="op" id="7949568">,</span>&nbsp;<span class="string" id="7949570">&#34;joe&#34;</span><span class="op" id="7949575">,</span>&nbsp;<span class="builtintype" id="7949577">true</span><span class="op" id="7949581">}</span><span class="op" id="7949582">,</span><br>
<span class="lineno"></span><span class="op" id="7949584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7949587">//&nbsp;These&nbsp;strings&nbsp;are&nbsp;also&nbsp;in&nbsp;testdata/*.</span><br>
<span class="lineno"></span><span class="keyword" id="7949628">const</span>&nbsp;<span class="ident" id="7949634">multiText1</span>&nbsp;<span class="op" id="7949645">=</span>&nbsp;<span class="string" id="7949647">`<br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;x&#34;}}TEXT{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dotV&#34;}}{{.V}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7949711">const</span>&nbsp;<span class="ident" id="7949717">multiText2</span>&nbsp;<span class="op" id="7949728">=</span>&nbsp;<span class="string" id="7949730">`<br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;dot&#34;}}{{.}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;nested&#34;}}{{template&nbsp;&#34;dot&#34;&nbsp;.}}{{end}}<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7949813">func</span>&nbsp;<span class="ident" id="7949818">TestMultiExecute</span><span class="op" id="7949834">(</span><span class="ident" id="7949835">t</span>&nbsp;<span class="op" id="7949837">*</span><span class="ident" id="7949838">testing</span><span class="op" id="7949845">.</span><span class="ident" id="7949846">T</span><span class="op" id="7949847">)</span>&nbsp;<span class="op" id="7949849">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7949852">//&nbsp;Declare&nbsp;a&nbsp;couple&nbsp;of&nbsp;templates&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7949893">template</span><span class="op" id="7949901">,</span>&nbsp;<span class="ident" id="7949903">err</span>&nbsp;<span class="op" id="7949907">:=</span>&nbsp;<span class="ident" id="7949910">New</span><span class="op" id="7949913">(</span><span class="string" id="7949914">&#34;root&#34;</span><span class="op" id="7949920">)</span><span class="op" id="7949921">.</span><span class="ident" id="7949922">Parse</span><span class="op" id="7949927">(</span><span class="ident" id="7949928">multiText1</span><span class="op" id="7949938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7949941">if</span>&nbsp;<span class="ident" id="7949944">err</span>&nbsp;<span class="op" id="7949948">!=</span>&nbsp;<span class="ident" id="7949951">nil</span>&nbsp;<span class="op" id="7949955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7949959">t</span><span class="op" id="7949960">.</span><span class="ident" id="7949961">Fatalf</span><span class="op" id="7949967">(</span><span class="string" id="7949968">&#34;parse&nbsp;error&nbsp;for&nbsp;1:&nbsp;%s&#34;</span><span class="op" id="7949991">,</span>&nbsp;<span class="ident" id="7949993">err</span><span class="op" id="7949996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7949999">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950002">_</span><span class="op" id="7950003">,</span>&nbsp;<span class="ident" id="7950005">err</span>&nbsp;<span class="op" id="7950009">=</span>&nbsp;<span class="ident" id="7950011">template</span><span class="op" id="7950019">.</span><span class="ident" id="7950020">Parse</span><span class="op" id="7950025">(</span><span class="ident" id="7950026">multiText2</span><span class="op" id="7950036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7950039">if</span>&nbsp;<span class="ident" id="7950042">err</span>&nbsp;<span class="op" id="7950046">!=</span>&nbsp;<span class="ident" id="7950049">nil</span>&nbsp;<span class="op" id="7950053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950057">t</span><span class="op" id="7950058">.</span><span class="ident" id="7950059">Fatalf</span><span class="op" id="7950065">(</span><span class="string" id="7950066">&#34;parse&nbsp;error&nbsp;for&nbsp;2:&nbsp;%s&#34;</span><span class="op" id="7950089">,</span>&nbsp;<span class="ident" id="7950091">err</span><span class="op" id="7950094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7950097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950100">testExecute</span><span class="op" id="7950111">(</span><span class="ident" id="7950112">multiExecTests</span><span class="op" id="7950126">,</span>&nbsp;<span class="ident" id="7950128">template</span><span class="op" id="7950136">,</span>&nbsp;<span class="ident" id="7950138">t</span><span class="op" id="7950139">)</span><br>
<span class="lineno">125</span><span class="op" id="7950141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7950144">func</span>&nbsp;<span class="ident" id="7950149">TestParseFiles</span><span class="op" id="7950163">(</span><span class="ident" id="7950164">t</span>&nbsp;<span class="op" id="7950166">*</span><span class="ident" id="7950167">testing</span><span class="op" id="7950174">.</span><span class="ident" id="7950175">T</span><span class="op" id="7950176">)</span>&nbsp;<span class="op" id="7950178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950181">_</span><span class="op" id="7950182">,</span>&nbsp;<span class="ident" id="7950184">err</span>&nbsp;<span class="op" id="7950188">:=</span>&nbsp;<span class="ident" id="7950191">ParseFiles</span><span class="op" id="7950201">(</span><span class="string" id="7950202">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7950218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7950221">if</span>&nbsp;<span class="ident" id="7950224">err</span>&nbsp;<span class="op" id="7950228">==</span>&nbsp;<span class="ident" id="7950231">nil</span>&nbsp;<span class="op" id="7950235">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950239">t</span><span class="op" id="7950240">.</span><span class="ident" id="7950241">Error</span><span class="op" id="7950246">(</span><span class="string" id="7950247">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7950295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7950298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950301">template</span>&nbsp;<span class="op" id="7950310">:=</span>&nbsp;<span class="ident" id="7950313">New</span><span class="op" id="7950316">(</span><span class="string" id="7950317">&#34;root&#34;</span><span class="op" id="7950323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950326">_</span><span class="op" id="7950327">,</span>&nbsp;<span class="ident" id="7950329">err</span>&nbsp;<span class="op" id="7950333">=</span>&nbsp;<span class="ident" id="7950335">template</span><span class="op" id="7950343">.</span><span class="ident" id="7950344">ParseFiles</span><span class="op" id="7950354">(</span><span class="string" id="7950355">&#34;testdata/file1.tmpl&#34;</span><span class="op" id="7950376">,</span>&nbsp;<span class="string" id="7950378">&#34;testdata/file2.tmpl&#34;</span><span class="op" id="7950399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7950402">if</span>&nbsp;<span class="ident" id="7950405">err</span>&nbsp;<span class="op" id="7950409">!=</span>&nbsp;<span class="ident" id="7950412">nil</span>&nbsp;<span class="op" id="7950416">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950420">t</span><span class="op" id="7950421">.</span><span class="ident" id="7950422">Fatalf</span><span class="op" id="7950428">(</span><span class="string" id="7950429">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7950454">,</span>&nbsp;<span class="ident" id="7950456">err</span><span class="op" id="7950459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7950462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950465">testExecute</span><span class="op" id="7950476">(</span><span class="ident" id="7950477">multiExecTests</span><span class="op" id="7950491">,</span>&nbsp;<span class="ident" id="7950493">template</span><span class="op" id="7950501">,</span>&nbsp;<span class="ident" id="7950503">t</span><span class="op" id="7950504">)</span><br>
<span class="lineno"></span><span class="op" id="7950506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span><span class="keyword" id="7950509">func</span>&nbsp;<span class="ident" id="7950514">TestParseGlob</span><span class="op" id="7950527">(</span><span class="ident" id="7950528">t</span>&nbsp;<span class="op" id="7950530">*</span><span class="ident" id="7950531">testing</span><span class="op" id="7950538">.</span><span class="ident" id="7950539">T</span><span class="op" id="7950540">)</span>&nbsp;<span class="op" id="7950542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950545">_</span><span class="op" id="7950546">,</span>&nbsp;<span class="ident" id="7950548">err</span>&nbsp;<span class="op" id="7950552">:=</span>&nbsp;<span class="ident" id="7950555">ParseGlob</span><span class="op" id="7950564">(</span><span class="string" id="7950565">&#34;DOES&nbsp;NOT&nbsp;EXIST&#34;</span><span class="op" id="7950581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7950584">if</span>&nbsp;<span class="ident" id="7950587">err</span>&nbsp;<span class="op" id="7950591">==</span>&nbsp;<span class="ident" id="7950594">nil</span>&nbsp;<span class="op" id="7950598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950602">t</span><span class="op" id="7950603">.</span><span class="ident" id="7950604">Error</span><span class="op" id="7950609">(</span><span class="string" id="7950610">&#34;expected&nbsp;error&nbsp;for&nbsp;non-existent&nbsp;file;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7950658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7950661">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950664">_</span><span class="op" id="7950665">,</span>&nbsp;<span class="ident" id="7950667">err</span>&nbsp;<span class="op" id="7950671">=</span>&nbsp;<span class="ident" id="7950673">New</span><span class="op" id="7950676">(</span><span class="string" id="7950677">&#34;error&#34;</span><span class="op" id="7950684">)</span><span class="op" id="7950685">.</span><span class="ident" id="7950686">ParseGlob</span><span class="op" id="7950695">(</span><span class="string" id="7950696">&#34;[x&#34;</span><span class="op" id="7950700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7950703">if</span>&nbsp;<span class="ident" id="7950706">err</span>&nbsp;<span class="op" id="7950710">==</span>&nbsp;<span class="ident" id="7950713">nil</span>&nbsp;<span class="op" id="7950717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950721">t</span><span class="op" id="7950722">.</span><span class="ident" id="7950723">Error</span><span class="op" id="7950728">(</span><span class="string" id="7950729">&#34;expected&nbsp;error&nbsp;for&nbsp;bad&nbsp;pattern;&nbsp;got&nbsp;none&#34;</span><span class="op" id="7950771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7950774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950777">template</span>&nbsp;<span class="op" id="7950786">:=</span>&nbsp;<span class="ident" id="7950789">New</span><span class="op" id="7950792">(</span><span class="string" id="7950793">&#34;root&#34;</span><span class="op" id="7950799">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950802">_</span><span class="op" id="7950803">,</span>&nbsp;<span class="ident" id="7950805">err</span>&nbsp;<span class="op" id="7950809">=</span>&nbsp;<span class="ident" id="7950811">template</span><span class="op" id="7950819">.</span><span class="ident" id="7950820">ParseGlob</span><span class="op" id="7950829">(</span><span class="string" id="7950830">&#34;testdata/file*.tmpl&#34;</span><span class="op" id="7950851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7950854">if</span>&nbsp;<span class="ident" id="7950857">err</span>&nbsp;<span class="op" id="7950861">!=</span>&nbsp;<span class="ident" id="7950864">nil</span>&nbsp;<span class="op" id="7950868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950872">t</span><span class="op" id="7950873">.</span><span class="ident" id="7950874">Fatalf</span><span class="op" id="7950880">(</span><span class="string" id="7950881">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7950906">,</span>&nbsp;<span class="ident" id="7950908">err</span><span class="op" id="7950911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7950914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7950917">testExecute</span><span class="op" id="7950928">(</span><span class="ident" id="7950929">multiExecTests</span><span class="op" id="7950943">,</span>&nbsp;<span class="ident" id="7950945">template</span><span class="op" id="7950953">,</span>&nbsp;<span class="ident" id="7950955">t</span><span class="op" id="7950956">)</span><br>
<span class="lineno">155</span><span class="op" id="7950958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7950961">//&nbsp;In&nbsp;these&nbsp;tests,&nbsp;actual&nbsp;content&nbsp;(not&nbsp;just&nbsp;template&nbsp;definitions)&nbsp;comes&nbsp;from&nbsp;the&nbsp;parsed&nbsp;files.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7951057">var</span>&nbsp;<span class="ident" id="7951061">templateFileExecTests</span>&nbsp;<span class="op" id="7951083">=</span>&nbsp;<span class="op" id="7951085">[</span><span class="op" id="7951086">]</span><span class="ident" id="7951087">execTest</span><span class="op" id="7951095">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7951098">{</span><span class="string" id="7951099">&#34;test&#34;</span><span class="op" id="7951105">,</span>&nbsp;<span class="string" id="7951107">`{{template&nbsp;&#34;tmpl1.tmpl&#34;}}{{template&nbsp;&#34;tmpl2.tmpl&#34;}}`</span><span class="op" id="7951159">,</span>&nbsp;<span class="string" id="7951161">&#34;template1\n\ny\ntemplate2\n\nx\n&#34;</span><span class="op" id="7951195">,</span>&nbsp;<span class="num" id="7951197">0</span><span class="op" id="7951198">,</span>&nbsp;<span class="builtintype" id="7951200">true</span><span class="op" id="7951204">}</span><span class="op" id="7951205">,</span><br>
<span class="lineno"></span><span class="op" id="7951207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7951210">func</span>&nbsp;<span class="ident" id="7951215">TestParseFilesWithData</span><span class="op" id="7951237">(</span><span class="ident" id="7951238">t</span>&nbsp;<span class="op" id="7951240">*</span><span class="ident" id="7951241">testing</span><span class="op" id="7951248">.</span><span class="ident" id="7951249">T</span><span class="op" id="7951250">)</span>&nbsp;<span class="op" id="7951252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7951255">template</span><span class="op" id="7951263">,</span>&nbsp;<span class="ident" id="7951265">err</span>&nbsp;<span class="op" id="7951269">:=</span>&nbsp;<span class="ident" id="7951272">New</span><span class="op" id="7951275">(</span><span class="string" id="7951276">&#34;root&#34;</span><span class="op" id="7951282">)</span><span class="op" id="7951283">.</span><span class="ident" id="7951284">ParseFiles</span><span class="op" id="7951294">(</span><span class="string" id="7951295">&#34;testdata/tmpl1.tmpl&#34;</span><span class="op" id="7951316">,</span>&nbsp;<span class="string" id="7951318">&#34;testdata/tmpl2.tmpl&#34;</span><span class="op" id="7951339">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7951342">if</span>&nbsp;<span class="ident" id="7951345">err</span>&nbsp;<span class="op" id="7951349">!=</span>&nbsp;<span class="ident" id="7951352">nil</span>&nbsp;<span class="op" id="7951356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7951360">t</span><span class="op" id="7951361">.</span><span class="ident" id="7951362">Fatalf</span><span class="op" id="7951368">(</span><span class="string" id="7951369">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7951394">,</span>&nbsp;<span class="ident" id="7951396">err</span><span class="op" id="7951399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7951402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7951405">testExecute</span><span class="op" id="7951416">(</span><span class="ident" id="7951417">templateFileExecTests</span><span class="op" id="7951438">,</span>&nbsp;<span class="ident" id="7951440">template</span><span class="op" id="7951448">,</span>&nbsp;<span class="ident" id="7951450">t</span><span class="op" id="7951451">)</span><br>
<span class="lineno"></span><span class="op" id="7951453">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7951456">func</span>&nbsp;<span class="ident" id="7951461">TestParseGlobWithData</span><span class="op" id="7951482">(</span><span class="ident" id="7951483">t</span>&nbsp;<span class="op" id="7951485">*</span><span class="ident" id="7951486">testing</span><span class="op" id="7951493">.</span><span class="ident" id="7951494">T</span><span class="op" id="7951495">)</span>&nbsp;<span class="op" id="7951497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7951500">template</span><span class="op" id="7951508">,</span>&nbsp;<span class="ident" id="7951510">err</span>&nbsp;<span class="op" id="7951514">:=</span>&nbsp;<span class="ident" id="7951517">New</span><span class="op" id="7951520">(</span><span class="string" id="7951521">&#34;root&#34;</span><span class="op" id="7951527">)</span><span class="op" id="7951528">.</span><span class="ident" id="7951529">ParseGlob</span><span class="op" id="7951538">(</span><span class="string" id="7951539">&#34;testdata/tmpl*.tmpl&#34;</span><span class="op" id="7951560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7951563">if</span>&nbsp;<span class="ident" id="7951566">err</span>&nbsp;<span class="op" id="7951570">!=</span>&nbsp;<span class="ident" id="7951573">nil</span>&nbsp;<span class="op" id="7951577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7951581">t</span><span class="op" id="7951582">.</span><span class="ident" id="7951583">Fatalf</span><span class="op" id="7951589">(</span><span class="string" id="7951590">&#34;error&nbsp;parsing&nbsp;files:&nbsp;%v&#34;</span><span class="op" id="7951615">,</span>&nbsp;<span class="ident" id="7951617">err</span><span class="op" id="7951620">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7951623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7951626">testExecute</span><span class="op" id="7951637">(</span><span class="ident" id="7951638">templateFileExecTests</span><span class="op" id="7951659">,</span>&nbsp;<span class="ident" id="7951661">template</span><span class="op" id="7951669">,</span>&nbsp;<span class="ident" id="7951671">t</span><span class="op" id="7951672">)</span><br>
<span class="lineno"></span><span class="op" id="7951674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7951677">const</span>&nbsp;<span class="op" id="7951683">(</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7951686">cloneText1</span>&nbsp;<span class="op" id="7951697">=</span>&nbsp;<span class="string" id="7951699">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;b&#34;}}{{template&nbsp;&#34;c&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7951756">cloneText2</span>&nbsp;<span class="op" id="7951767">=</span>&nbsp;<span class="string" id="7951769">`{{define&nbsp;&#34;b&#34;}}b{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7951795">cloneText3</span>&nbsp;<span class="op" id="7951806">=</span>&nbsp;<span class="string" id="7951808">`{{define&nbsp;&#34;c&#34;}}root{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7951837">cloneText4</span>&nbsp;<span class="op" id="7951848">=</span>&nbsp;<span class="string" id="7951850">`{{define&nbsp;&#34;c&#34;}}clone{{end}}`</span><br>
<span class="lineno"></span><span class="op" id="7951879">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="7951882">func</span>&nbsp;<span class="ident" id="7951887">TestClone</span><span class="op" id="7951896">(</span><span class="ident" id="7951897">t</span>&nbsp;<span class="op" id="7951899">*</span><span class="ident" id="7951900">testing</span><span class="op" id="7951907">.</span><span class="ident" id="7951908">T</span><span class="op" id="7951909">)</span>&nbsp;<span class="op" id="7951911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7951914">//&nbsp;Create&nbsp;some&nbsp;templates&nbsp;and&nbsp;clone&nbsp;the&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7951960">root</span><span class="op" id="7951964">,</span>&nbsp;<span class="ident" id="7951966">err</span>&nbsp;<span class="op" id="7951970">:=</span>&nbsp;<span class="ident" id="7951973">New</span><span class="op" id="7951976">(</span><span class="string" id="7951977">&#34;root&#34;</span><span class="op" id="7951983">)</span><span class="op" id="7951984">.</span><span class="ident" id="7951985">Parse</span><span class="op" id="7951990">(</span><span class="ident" id="7951991">cloneText1</span><span class="op" id="7952001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7952004">if</span>&nbsp;<span class="ident" id="7952007">err</span>&nbsp;<span class="op" id="7952011">!=</span>&nbsp;<span class="ident" id="7952014">nil</span>&nbsp;<span class="op" id="7952018">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952022">t</span><span class="op" id="7952023">.</span><span class="ident" id="7952024">Fatal</span><span class="op" id="7952029">(</span><span class="ident" id="7952030">err</span><span class="op" id="7952033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7952036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952039">_</span><span class="op" id="7952040">,</span>&nbsp;<span class="ident" id="7952042">err</span>&nbsp;<span class="op" id="7952046">=</span>&nbsp;<span class="ident" id="7952048">root</span><span class="op" id="7952052">.</span><span class="ident" id="7952053">Parse</span><span class="op" id="7952058">(</span><span class="ident" id="7952059">cloneText2</span><span class="op" id="7952069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7952072">if</span>&nbsp;<span class="ident" id="7952075">err</span>&nbsp;<span class="op" id="7952079">!=</span>&nbsp;<span class="ident" id="7952082">nil</span>&nbsp;<span class="op" id="7952086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952090">t</span><span class="op" id="7952091">.</span><span class="ident" id="7952092">Fatal</span><span class="op" id="7952097">(</span><span class="ident" id="7952098">err</span><span class="op" id="7952101">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7952104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952107">clone</span>&nbsp;<span class="op" id="7952113">:=</span>&nbsp;<span class="ident" id="7952116">Must</span><span class="op" id="7952120">(</span><span class="ident" id="7952121">root</span><span class="op" id="7952125">.</span><span class="ident" id="7952126">Clone</span><span class="op" id="7952131">(</span><span class="op" id="7952132">)</span><span class="op" id="7952133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7952136">//&nbsp;Add&nbsp;variants&nbsp;to&nbsp;both.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952162">_</span><span class="op" id="7952163">,</span>&nbsp;<span class="ident" id="7952165">err</span>&nbsp;<span class="op" id="7952169">=</span>&nbsp;<span class="ident" id="7952171">root</span><span class="op" id="7952175">.</span><span class="ident" id="7952176">Parse</span><span class="op" id="7952181">(</span><span class="ident" id="7952182">cloneText3</span><span class="op" id="7952192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7952195">if</span>&nbsp;<span class="ident" id="7952198">err</span>&nbsp;<span class="op" id="7952202">!=</span>&nbsp;<span class="ident" id="7952205">nil</span>&nbsp;<span class="op" id="7952209">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952213">t</span><span class="op" id="7952214">.</span><span class="ident" id="7952215">Fatal</span><span class="op" id="7952220">(</span><span class="ident" id="7952221">err</span><span class="op" id="7952224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7952227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952230">_</span><span class="op" id="7952231">,</span>&nbsp;<span class="ident" id="7952233">err</span>&nbsp;<span class="op" id="7952237">=</span>&nbsp;<span class="ident" id="7952239">clone</span><span class="op" id="7952244">.</span><span class="ident" id="7952245">Parse</span><span class="op" id="7952250">(</span><span class="ident" id="7952251">cloneText4</span><span class="op" id="7952261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7952264">if</span>&nbsp;<span class="ident" id="7952267">err</span>&nbsp;<span class="op" id="7952271">!=</span>&nbsp;<span class="ident" id="7952274">nil</span>&nbsp;<span class="op" id="7952278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952282">t</span><span class="op" id="7952283">.</span><span class="ident" id="7952284">Fatal</span><span class="op" id="7952289">(</span><span class="ident" id="7952290">err</span><span class="op" id="7952293">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7952296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7952299">//&nbsp;Verify&nbsp;that&nbsp;the&nbsp;clone&nbsp;is&nbsp;self-consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7952345">for</span>&nbsp;<span class="ident" id="7952349">k</span><span class="op" id="7952350">,</span>&nbsp;<span class="ident" id="7952352">v</span>&nbsp;<span class="op" id="7952354">:=</span>&nbsp;<span class="keyword" id="7952357">range</span>&nbsp;<span class="ident" id="7952363">clone</span><span class="op" id="7952368">.</span><span class="ident" id="7952369">tmpl</span>&nbsp;<span class="op" id="7952374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7952378">if</span>&nbsp;<span class="ident" id="7952381">k</span>&nbsp;<span class="op" id="7952383">==</span>&nbsp;<span class="ident" id="7952386">clone</span><span class="op" id="7952391">.</span><span class="ident" id="7952392">name</span>&nbsp;<span class="op" id="7952397">&amp;&amp;</span>&nbsp;<span class="ident" id="7952400">v</span><span class="op" id="7952401">.</span><span class="ident" id="7952402">tmpl</span><span class="op" id="7952406">[</span><span class="ident" id="7952407">k</span><span class="op" id="7952408">]</span>&nbsp;<span class="op" id="7952410">!=</span>&nbsp;<span class="ident" id="7952413">clone</span>&nbsp;<span class="op" id="7952419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952424">t</span><span class="op" id="7952425">.</span><span class="ident" id="7952426">Error</span><span class="op" id="7952431">(</span><span class="string" id="7952432">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;root&#34;</span><span class="op" id="7952461">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7952465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7952469">if</span>&nbsp;<span class="ident" id="7952472">v</span>&nbsp;<span class="op" id="7952474">!=</span>&nbsp;<span class="ident" id="7952477">v</span><span class="op" id="7952478">.</span><span class="ident" id="7952479">tmpl</span><span class="op" id="7952483">[</span><span class="ident" id="7952484">v</span><span class="op" id="7952485">.</span><span class="ident" id="7952486">name</span><span class="op" id="7952490">]</span>&nbsp;<span class="op" id="7952492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952497">t</span><span class="op" id="7952498">.</span><span class="ident" id="7952499">Errorf</span><span class="op" id="7952505">(</span><span class="string" id="7952506">&#34;clone&nbsp;does&nbsp;not&nbsp;contain&nbsp;self&nbsp;for&nbsp;%q&#34;</span><span class="op" id="7952542">,</span>&nbsp;<span class="ident" id="7952544">k</span><span class="op" id="7952545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7952549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7952552">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7952555">//&nbsp;Execute&nbsp;root.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7952573">var</span>&nbsp;<span class="ident" id="7952577">b</span>&nbsp;<span class="ident" id="7952579">bytes</span><span class="op" id="7952584">.</span><span class="ident" id="7952585">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952593">err</span>&nbsp;<span class="op" id="7952597">=</span>&nbsp;<span class="ident" id="7952599">root</span><span class="op" id="7952603">.</span><span class="ident" id="7952604">ExecuteTemplate</span><span class="op" id="7952619">(</span><span class="op" id="7952620">&amp;</span><span class="ident" id="7952621">b</span><span class="op" id="7952622">,</span>&nbsp;<span class="string" id="7952624">&#34;a&#34;</span><span class="op" id="7952627">,</span>&nbsp;<span class="num" id="7952629">0</span><span class="op" id="7952630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7952633">if</span>&nbsp;<span class="ident" id="7952636">err</span>&nbsp;<span class="op" id="7952640">!=</span>&nbsp;<span class="ident" id="7952643">nil</span>&nbsp;<span class="op" id="7952647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952651">t</span><span class="op" id="7952652">.</span><span class="ident" id="7952653">Fatal</span><span class="op" id="7952658">(</span><span class="ident" id="7952659">err</span><span class="op" id="7952662">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7952665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7952668">if</span>&nbsp;<span class="ident" id="7952671">b</span><span class="op" id="7952672">.</span><span class="ident" id="7952673">String</span><span class="op" id="7952679">(</span><span class="op" id="7952680">)</span>&nbsp;<span class="op" id="7952682">!=</span>&nbsp;<span class="string" id="7952685">&#34;broot&#34;</span>&nbsp;<span class="op" id="7952693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952697">t</span><span class="op" id="7952698">.</span><span class="ident" id="7952699">Errorf</span><span class="op" id="7952705">(</span><span class="string" id="7952706">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7952726">,</span>&nbsp;<span class="string" id="7952728">&#34;broot&#34;</span><span class="op" id="7952735">,</span>&nbsp;<span class="ident" id="7952737">b</span><span class="op" id="7952738">.</span><span class="ident" id="7952739">String</span><span class="op" id="7952745">(</span><span class="op" id="7952746">)</span><span class="op" id="7952747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7952750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7952753">//&nbsp;Execute&nbsp;copy.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952771">b</span><span class="op" id="7952772">.</span><span class="ident" id="7952773">Reset</span><span class="op" id="7952778">(</span><span class="op" id="7952779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952782">err</span>&nbsp;<span class="op" id="7952786">=</span>&nbsp;<span class="ident" id="7952788">clone</span><span class="op" id="7952793">.</span><span class="ident" id="7952794">ExecuteTemplate</span><span class="op" id="7952809">(</span><span class="op" id="7952810">&amp;</span><span class="ident" id="7952811">b</span><span class="op" id="7952812">,</span>&nbsp;<span class="string" id="7952814">&#34;a&#34;</span><span class="op" id="7952817">,</span>&nbsp;<span class="num" id="7952819">0</span><span class="op" id="7952820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7952823">if</span>&nbsp;<span class="ident" id="7952826">err</span>&nbsp;<span class="op" id="7952830">!=</span>&nbsp;<span class="ident" id="7952833">nil</span>&nbsp;<span class="op" id="7952837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952841">t</span><span class="op" id="7952842">.</span><span class="ident" id="7952843">Fatal</span><span class="op" id="7952848">(</span><span class="ident" id="7952849">err</span><span class="op" id="7952852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7952855">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7952858">if</span>&nbsp;<span class="ident" id="7952861">b</span><span class="op" id="7952862">.</span><span class="ident" id="7952863">String</span><span class="op" id="7952869">(</span><span class="op" id="7952870">)</span>&nbsp;<span class="op" id="7952872">!=</span>&nbsp;<span class="string" id="7952875">&#34;bclone&#34;</span>&nbsp;<span class="op" id="7952884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7952888">t</span><span class="op" id="7952889">.</span><span class="ident" id="7952890">Errorf</span><span class="op" id="7952896">(</span><span class="string" id="7952897">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7952917">,</span>&nbsp;<span class="string" id="7952919">&#34;bclone&#34;</span><span class="op" id="7952927">,</span>&nbsp;<span class="ident" id="7952929">b</span><span class="op" id="7952930">.</span><span class="ident" id="7952931">String</span><span class="op" id="7952937">(</span><span class="op" id="7952938">)</span><span class="op" id="7952939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7952942">}</span><br>
<span class="lineno"></span><span class="op" id="7952944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7952947">func</span>&nbsp;<span class="ident" id="7952952">TestAddParseTree</span><span class="op" id="7952968">(</span><span class="ident" id="7952969">t</span>&nbsp;<span class="op" id="7952971">*</span><span class="ident" id="7952972">testing</span><span class="op" id="7952979">.</span><span class="ident" id="7952980">T</span><span class="op" id="7952981">)</span>&nbsp;<span class="op" id="7952983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7952986">//&nbsp;Create&nbsp;some&nbsp;templates.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953013">root</span><span class="op" id="7953017">,</span>&nbsp;<span class="ident" id="7953019">err</span>&nbsp;<span class="op" id="7953023">:=</span>&nbsp;<span class="ident" id="7953026">New</span><span class="op" id="7953029">(</span><span class="string" id="7953030">&#34;root&#34;</span><span class="op" id="7953036">)</span><span class="op" id="7953037">.</span><span class="ident" id="7953038">Parse</span><span class="op" id="7953043">(</span><span class="ident" id="7953044">cloneText1</span><span class="op" id="7953054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7953057">if</span>&nbsp;<span class="ident" id="7953060">err</span>&nbsp;<span class="op" id="7953064">!=</span>&nbsp;<span class="ident" id="7953067">nil</span>&nbsp;<span class="op" id="7953071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953075">t</span><span class="op" id="7953076">.</span><span class="ident" id="7953077">Fatal</span><span class="op" id="7953082">(</span><span class="ident" id="7953083">err</span><span class="op" id="7953086">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7953089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953092">_</span><span class="op" id="7953093">,</span>&nbsp;<span class="ident" id="7953095">err</span>&nbsp;<span class="op" id="7953099">=</span>&nbsp;<span class="ident" id="7953101">root</span><span class="op" id="7953105">.</span><span class="ident" id="7953106">Parse</span><span class="op" id="7953111">(</span><span class="ident" id="7953112">cloneText2</span><span class="op" id="7953122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7953125">if</span>&nbsp;<span class="ident" id="7953128">err</span>&nbsp;<span class="op" id="7953132">!=</span>&nbsp;<span class="ident" id="7953135">nil</span>&nbsp;<span class="op" id="7953139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953143">t</span><span class="op" id="7953144">.</span><span class="ident" id="7953145">Fatal</span><span class="op" id="7953150">(</span><span class="ident" id="7953151">err</span><span class="op" id="7953154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7953157">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7953160">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953186">tree</span><span class="op" id="7953190">,</span>&nbsp;<span class="ident" id="7953192">err</span>&nbsp;<span class="op" id="7953196">:=</span>&nbsp;<span class="ident" id="7953199">parse</span><span class="op" id="7953204">.</span><span class="ident" id="7953205">Parse</span><span class="op" id="7953210">(</span><span class="string" id="7953211">&#34;cloneText3&#34;</span><span class="op" id="7953223">,</span>&nbsp;<span class="ident" id="7953225">cloneText3</span><span class="op" id="7953235">,</span>&nbsp;<span class="string" id="7953237">&#34;&#34;</span><span class="op" id="7953239">,</span>&nbsp;<span class="string" id="7953241">&#34;&#34;</span><span class="op" id="7953243">,</span>&nbsp;<span class="ident" id="7953245">nil</span><span class="op" id="7953248">,</span>&nbsp;<span class="ident" id="7953250">builtins</span><span class="op" id="7953258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7953261">if</span>&nbsp;<span class="ident" id="7953264">err</span>&nbsp;<span class="op" id="7953268">!=</span>&nbsp;<span class="ident" id="7953271">nil</span>&nbsp;<span class="op" id="7953275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953279">t</span><span class="op" id="7953280">.</span><span class="ident" id="7953281">Fatal</span><span class="op" id="7953286">(</span><span class="ident" id="7953287">err</span><span class="op" id="7953290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7953293">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953296">added</span><span class="op" id="7953301">,</span>&nbsp;<span class="ident" id="7953303">err</span>&nbsp;<span class="op" id="7953307">:=</span>&nbsp;<span class="ident" id="7953310">root</span><span class="op" id="7953314">.</span><span class="ident" id="7953315">AddParseTree</span><span class="op" id="7953327">(</span><span class="string" id="7953328">&#34;c&#34;</span><span class="op" id="7953331">,</span>&nbsp;<span class="ident" id="7953333">tree</span><span class="op" id="7953337">[</span><span class="string" id="7953338">&#34;c&#34;</span><span class="op" id="7953341">]</span><span class="op" id="7953342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7953345">//&nbsp;Execute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7953358">var</span>&nbsp;<span class="ident" id="7953362">b</span>&nbsp;<span class="ident" id="7953364">bytes</span><span class="op" id="7953369">.</span><span class="ident" id="7953370">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953378">err</span>&nbsp;<span class="op" id="7953382">=</span>&nbsp;<span class="ident" id="7953384">added</span><span class="op" id="7953389">.</span><span class="ident" id="7953390">ExecuteTemplate</span><span class="op" id="7953405">(</span><span class="op" id="7953406">&amp;</span><span class="ident" id="7953407">b</span><span class="op" id="7953408">,</span>&nbsp;<span class="string" id="7953410">&#34;a&#34;</span><span class="op" id="7953413">,</span>&nbsp;<span class="num" id="7953415">0</span><span class="op" id="7953416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7953419">if</span>&nbsp;<span class="ident" id="7953422">err</span>&nbsp;<span class="op" id="7953426">!=</span>&nbsp;<span class="ident" id="7953429">nil</span>&nbsp;<span class="op" id="7953433">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953437">t</span><span class="op" id="7953438">.</span><span class="ident" id="7953439">Fatal</span><span class="op" id="7953444">(</span><span class="ident" id="7953445">err</span><span class="op" id="7953448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7953451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7953454">if</span>&nbsp;<span class="ident" id="7953457">b</span><span class="op" id="7953458">.</span><span class="ident" id="7953459">String</span><span class="op" id="7953465">(</span><span class="op" id="7953466">)</span>&nbsp;<span class="op" id="7953468">!=</span>&nbsp;<span class="string" id="7953471">&#34;broot&#34;</span>&nbsp;<span class="op" id="7953479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953483">t</span><span class="op" id="7953484">.</span><span class="ident" id="7953485">Errorf</span><span class="op" id="7953491">(</span><span class="string" id="7953492">&#34;expected&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7953512">,</span>&nbsp;<span class="string" id="7953514">&#34;broot&#34;</span><span class="op" id="7953521">,</span>&nbsp;<span class="ident" id="7953523">b</span><span class="op" id="7953524">.</span><span class="ident" id="7953525">String</span><span class="op" id="7953531">(</span><span class="op" id="7953532">)</span><span class="op" id="7953533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7953536">}</span><br>
<span class="lineno">260</span><span class="op" id="7953538">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7953541">//&nbsp;Issue&nbsp;7032</span><br>
<span class="lineno"></span><span class="keyword" id="7953555">func</span>&nbsp;<span class="ident" id="7953560">TestAddParseTreeToUnparsedTemplate</span><span class="op" id="7953594">(</span><span class="ident" id="7953595">t</span>&nbsp;<span class="op" id="7953597">*</span><span class="ident" id="7953598">testing</span><span class="op" id="7953605">.</span><span class="ident" id="7953606">T</span><span class="op" id="7953607">)</span>&nbsp;<span class="op" id="7953609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953612">master</span>&nbsp;<span class="op" id="7953619">:=</span>&nbsp;<span class="string" id="7953622">&#34;{{define&nbsp;\&#34;master\&#34;}}{{end}}&#34;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953654">tmpl</span>&nbsp;<span class="op" id="7953659">:=</span>&nbsp;<span class="ident" id="7953662">New</span><span class="op" id="7953665">(</span><span class="string" id="7953666">&#34;master&#34;</span><span class="op" id="7953674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953677">tree</span><span class="op" id="7953681">,</span>&nbsp;<span class="ident" id="7953683">err</span>&nbsp;<span class="op" id="7953687">:=</span>&nbsp;<span class="ident" id="7953690">parse</span><span class="op" id="7953695">.</span><span class="ident" id="7953696">Parse</span><span class="op" id="7953701">(</span><span class="string" id="7953702">&#34;master&#34;</span><span class="op" id="7953710">,</span>&nbsp;<span class="ident" id="7953712">master</span><span class="op" id="7953718">,</span>&nbsp;<span class="string" id="7953720">&#34;&#34;</span><span class="op" id="7953722">,</span>&nbsp;<span class="string" id="7953724">&#34;&#34;</span><span class="op" id="7953726">,</span>&nbsp;<span class="ident" id="7953728">nil</span><span class="op" id="7953731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7953734">if</span>&nbsp;<span class="ident" id="7953737">err</span>&nbsp;<span class="op" id="7953741">!=</span>&nbsp;<span class="ident" id="7953744">nil</span>&nbsp;<span class="op" id="7953748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953752">t</span><span class="op" id="7953753">.</span><span class="ident" id="7953754">Fatalf</span><span class="op" id="7953760">(</span><span class="string" id="7953761">&#34;unexpected&nbsp;parse&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="7953787">,</span>&nbsp;<span class="ident" id="7953789">err</span><span class="op" id="7953792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7953795">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953798">masterTree</span>&nbsp;<span class="op" id="7953809">:=</span>&nbsp;<span class="ident" id="7953812">tree</span><span class="op" id="7953816">[</span><span class="string" id="7953817">&#34;master&#34;</span><span class="op" id="7953825">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7953828">tmpl</span><span class="op" id="7953832">.</span><span class="ident" id="7953833">AddParseTree</span><span class="op" id="7953845">(</span><span class="string" id="7953846">&#34;master&#34;</span><span class="op" id="7953854">,</span>&nbsp;<span class="ident" id="7953856">masterTree</span><span class="op" id="7953866">)</span>&nbsp;<span class="comment" id="7953868">//&nbsp;used&nbsp;to&nbsp;panic</span><br>
<span class="lineno"></span><span class="op" id="7953885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7953888">func</span>&nbsp;<span class="ident" id="7953893">TestRedefinition</span><span class="op" id="7953909">(</span><span class="ident" id="7953910">t</span>&nbsp;<span class="op" id="7953912">*</span><span class="ident" id="7953913">testing</span><span class="op" id="7953920">.</span><span class="ident" id="7953921">T</span><span class="op" id="7953922">)</span>&nbsp;<span class="op" id="7953924">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7953927">var</span>&nbsp;<span class="ident" id="7953931">tmpl</span>&nbsp;<span class="op" id="7953936">*</span><span class="ident" id="7953937">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7953947">var</span>&nbsp;<span class="ident" id="7953951">err</span>&nbsp;<span class="builtintype" id="7953955">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7953962">if</span>&nbsp;<span class="ident" id="7953965">tmpl</span><span class="op" id="7953969">,</span>&nbsp;<span class="ident" id="7953971">err</span>&nbsp;<span class="op" id="7953975">=</span>&nbsp;<span class="ident" id="7953977">New</span><span class="op" id="7953980">(</span><span class="string" id="7953981">&#34;tmpl1&#34;</span><span class="op" id="7953988">)</span><span class="op" id="7953989">.</span><span class="ident" id="7953990">Parse</span><span class="op" id="7953995">(</span><span class="string" id="7953996">`{{define&nbsp;&#34;test&#34;}}foo{{end}}`</span><span class="op" id="7954025">)</span><span class="op" id="7954026">;</span>&nbsp;<span class="ident" id="7954028">err</span>&nbsp;<span class="op" id="7954032">!=</span>&nbsp;<span class="ident" id="7954035">nil</span>&nbsp;<span class="op" id="7954039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7954043">t</span><span class="op" id="7954044">.</span><span class="ident" id="7954045">Fatalf</span><span class="op" id="7954051">(</span><span class="string" id="7954052">&#34;parse&nbsp;1:&nbsp;%v&#34;</span><span class="op" id="7954065">,</span>&nbsp;<span class="ident" id="7954067">err</span><span class="op" id="7954070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7954073">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7954076">if</span>&nbsp;<span class="ident" id="7954079">_</span><span class="op" id="7954080">,</span>&nbsp;<span class="ident" id="7954082">err</span>&nbsp;<span class="op" id="7954086">=</span>&nbsp;<span class="ident" id="7954088">tmpl</span><span class="op" id="7954092">.</span><span class="ident" id="7954093">Parse</span><span class="op" id="7954098">(</span><span class="string" id="7954099">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7954128">)</span><span class="op" id="7954129">;</span>&nbsp;<span class="ident" id="7954131">err</span>&nbsp;<span class="op" id="7954135">==</span>&nbsp;<span class="ident" id="7954138">nil</span>&nbsp;<span class="op" id="7954142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7954146">t</span><span class="op" id="7954147">.</span><span class="ident" id="7954148">Fatal</span><span class="op" id="7954153">(</span><span class="string" id="7954154">&#34;expected&nbsp;error&#34;</span><span class="op" id="7954170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7954173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7954176">if</span>&nbsp;<span class="op" id="7954179">!</span><span class="ident" id="7954180">strings</span><span class="op" id="7954187">.</span><span class="ident" id="7954188">Contains</span><span class="op" id="7954196">(</span><span class="ident" id="7954197">err</span><span class="op" id="7954200">.</span><span class="ident" id="7954201">Error</span><span class="op" id="7954206">(</span><span class="op" id="7954207">)</span><span class="op" id="7954208">,</span>&nbsp;<span class="string" id="7954210">&#34;redefinition&#34;</span><span class="op" id="7954224">)</span>&nbsp;<span class="op" id="7954226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7954230">t</span><span class="op" id="7954231">.</span><span class="ident" id="7954232">Fatalf</span><span class="op" id="7954238">(</span><span class="string" id="7954239">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7954276">,</span>&nbsp;<span class="ident" id="7954278">err</span><span class="op" id="7954281">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7954284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7954287">if</span>&nbsp;<span class="ident" id="7954290">_</span><span class="op" id="7954291">,</span>&nbsp;<span class="ident" id="7954293">err</span>&nbsp;<span class="op" id="7954297">=</span>&nbsp;<span class="ident" id="7954299">tmpl</span><span class="op" id="7954303">.</span><span class="ident" id="7954304">New</span><span class="op" id="7954307">(</span><span class="string" id="7954308">&#34;tmpl2&#34;</span><span class="op" id="7954315">)</span><span class="op" id="7954316">.</span><span class="ident" id="7954317">Parse</span><span class="op" id="7954322">(</span><span class="string" id="7954323">`{{define&nbsp;&#34;test&#34;}}bar{{end}}`</span><span class="op" id="7954352">)</span><span class="op" id="7954353">;</span>&nbsp;<span class="ident" id="7954355">err</span>&nbsp;<span class="op" id="7954359">==</span>&nbsp;<span class="ident" id="7954362">nil</span>&nbsp;<span class="op" id="7954366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7954370">t</span><span class="op" id="7954371">.</span><span class="ident" id="7954372">Fatal</span><span class="op" id="7954377">(</span><span class="string" id="7954378">&#34;expected&nbsp;error&#34;</span><span class="op" id="7954394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7954397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7954400">if</span>&nbsp;<span class="op" id="7954403">!</span><span class="ident" id="7954404">strings</span><span class="op" id="7954411">.</span><span class="ident" id="7954412">Contains</span><span class="op" id="7954420">(</span><span class="ident" id="7954421">err</span><span class="op" id="7954424">.</span><span class="ident" id="7954425">Error</span><span class="op" id="7954430">(</span><span class="op" id="7954431">)</span><span class="op" id="7954432">,</span>&nbsp;<span class="string" id="7954434">&#34;redefinition&#34;</span><span class="op" id="7954448">)</span>&nbsp;<span class="op" id="7954450">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7954454">t</span><span class="op" id="7954455">.</span><span class="ident" id="7954456">Fatalf</span><span class="op" id="7954462">(</span><span class="string" id="7954463">&#34;expected&nbsp;redefinition&nbsp;error;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7954500">,</span>&nbsp;<span class="ident" id="7954502">err</span><span class="op" id="7954505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7954508">}</span><br>
<span class="lineno"></span><span class="op" id="7954510">}</span>
</div>
</body>
</html>
