<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7818980">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7819036">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7819090">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7819141">package</span>&nbsp;<span class="ident" id="7819149">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7819155">import</span>&nbsp;<span class="op" id="7819162">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819165">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819174">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819183">&#34;compress/gzip&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819200">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819215">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819222">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819228">&#34;io/ioutil&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819241">&#34;net/http/internal&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819262">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819273">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819284">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819294">&#34;strings&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819305">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7819315">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7819318">type</span>&nbsp;<span class="ident" id="7819323">respTest</span>&nbsp;<span class="keyword" id="7819332">struct</span>&nbsp;<span class="op" id="7819339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7819342">Raw</span>&nbsp;&nbsp;<span class="builtintype" id="7819347">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7819355">Resp</span>&nbsp;<span class="ident" id="7819360">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7819370">Body</span>&nbsp;<span class="builtintype" id="7819375">string</span><br>
<span class="lineno"></span><span class="op" id="7819382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7819385">func</span>&nbsp;<span class="ident" id="7819390">dummyReq</span><span class="op" id="7819398">(</span><span class="ident" id="7819399">method</span>&nbsp;<span class="builtintype" id="7819406">string</span><span class="op" id="7819412">)</span>&nbsp;<span class="op" id="7819414">*</span><span class="ident" id="7819415">Request</span>&nbsp;<span class="op" id="7819423">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7819426">return</span>&nbsp;<span class="op" id="7819433">&amp;</span><span class="ident" id="7819434">Request</span><span class="op" id="7819441">{</span><span class="ident" id="7819442">Method</span><span class="op" id="7819448">:</span>&nbsp;<span class="ident" id="7819450">method</span><span class="op" id="7819456">}</span><br>
<span class="lineno"></span><span class="op" id="7819458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7819461">func</span>&nbsp;<span class="ident" id="7819466">dummyReq11</span><span class="op" id="7819476">(</span><span class="ident" id="7819477">method</span>&nbsp;<span class="builtintype" id="7819484">string</span><span class="op" id="7819490">)</span>&nbsp;<span class="op" id="7819492">*</span><span class="ident" id="7819493">Request</span>&nbsp;<span class="op" id="7819501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7819504">return</span>&nbsp;<span class="op" id="7819511">&amp;</span><span class="ident" id="7819512">Request</span><span class="op" id="7819519">{</span><span class="ident" id="7819520">Method</span><span class="op" id="7819526">:</span>&nbsp;<span class="ident" id="7819528">method</span><span class="op" id="7819534">,</span>&nbsp;<span class="ident" id="7819536">Proto</span><span class="op" id="7819541">:</span>&nbsp;<span class="string" id="7819543">&#34;HTTP/1.1&#34;</span><span class="op" id="7819553">,</span>&nbsp;<span class="ident" id="7819555">ProtoMajor</span><span class="op" id="7819565">:</span>&nbsp;<span class="num" id="7819567">1</span><span class="op" id="7819568">,</span>&nbsp;<span class="ident" id="7819570">ProtoMinor</span><span class="op" id="7819580">:</span>&nbsp;<span class="num" id="7819582">1</span><span class="op" id="7819583">}</span><br>
<span class="lineno">35</span><span class="op" id="7819585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7819588">var</span>&nbsp;<span class="ident" id="7819592">respTests</span>&nbsp;<span class="op" id="7819602">=</span>&nbsp;<span class="op" id="7819604">[</span><span class="op" id="7819605">]</span><span class="ident" id="7819606">respTest</span><span class="op" id="7819614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7819617">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7819664">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819668">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7819690">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819695">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7819719">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819724">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7819731">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819736">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7819749">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7819754">Response</span><span class="op" id="7819762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7819767">Status</span><span class="op" id="7819773">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7819779">&#34;200&nbsp;OK&#34;</span><span class="op" id="7819787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7819792">StatusCode</span><span class="op" id="7819802">:</span>&nbsp;<span class="num" id="7819804">200</span><span class="op" id="7819807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7819812">Proto</span><span class="op" id="7819817">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7819824">&#34;HTTP/1.0&#34;</span><span class="op" id="7819834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7819839">ProtoMajor</span><span class="op" id="7819849">:</span>&nbsp;<span class="num" id="7819851">1</span><span class="op" id="7819852">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7819857">ProtoMinor</span><span class="op" id="7819867">:</span>&nbsp;<span class="num" id="7819869">0</span><span class="op" id="7819870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7819875">Request</span><span class="op" id="7819882">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7819887">dummyReq</span><span class="op" id="7819895">(</span><span class="string" id="7819896">&#34;GET&#34;</span><span class="op" id="7819901">)</span><span class="op" id="7819902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7819907">Header</span><span class="op" id="7819913">:</span>&nbsp;<span class="ident" id="7819915">Header</span><span class="op" id="7819921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7819927">&#34;Connection&#34;</span><span class="op" id="7819939">:</span>&nbsp;<span class="op" id="7819941">{</span><span class="string" id="7819942">&#34;close&#34;</span><span class="op" id="7819949">}</span><span class="op" id="7819950">,</span>&nbsp;<span class="comment" id="7819952">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7819977">}</span><span class="op" id="7819978">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7819983">Close</span><span class="op" id="7819988">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7819998">true</span><span class="op" id="7820002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820007">ContentLength</span><span class="op" id="7820020">:</span>&nbsp;<span class="op" id="7820022">-</span><span class="num" id="7820023">1</span><span class="op" id="7820024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7820028">}</span><span class="op" id="7820029">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820034">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7820047">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7820050">}</span><span class="op" id="7820051">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7820055">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;response&nbsp;without&nbsp;Content-Length&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7820113">//&nbsp;Connection&nbsp;headers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7820137">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820141">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7820163">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820168">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7820175">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820180">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7820193">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820198">Response</span><span class="op" id="7820206">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820211">Status</span><span class="op" id="7820217">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7820226">&#34;200&nbsp;OK&#34;</span><span class="op" id="7820234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820239">StatusCode</span><span class="op" id="7820249">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7820254">200</span><span class="op" id="7820257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820262">Proto</span><span class="op" id="7820267">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7820277">&#34;HTTP/1.1&#34;</span><span class="op" id="7820287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820292">ProtoMajor</span><span class="op" id="7820302">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7820307">1</span><span class="op" id="7820308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820313">ProtoMinor</span><span class="op" id="7820323">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7820328">1</span><span class="op" id="7820329">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820334">Header</span><span class="op" id="7820340">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7820349">Header</span><span class="op" id="7820355">{</span><span class="op" id="7820356">}</span><span class="op" id="7820357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820362">Request</span><span class="op" id="7820369">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7820377">dummyReq</span><span class="op" id="7820385">(</span><span class="string" id="7820386">&#34;GET&#34;</span><span class="op" id="7820391">)</span><span class="op" id="7820392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820397">Close</span><span class="op" id="7820402">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7820412">true</span><span class="op" id="7820416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820421">ContentLength</span><span class="op" id="7820434">:</span>&nbsp;<span class="op" id="7820436">-</span><span class="num" id="7820437">1</span><span class="op" id="7820438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7820442">}</span><span class="op" id="7820443">,</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820448">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7820461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7820464">}</span><span class="op" id="7820465">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7820469">//&nbsp;Unchunked&nbsp;HTTP/1.1&nbsp;204&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7820529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820533">&#34;HTTP/1.1&nbsp;204&nbsp;No&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="7820563">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820568">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7820575">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820580">&#34;Body&nbsp;should&nbsp;not&nbsp;be&nbsp;read!\n&#34;</span><span class="op" id="7820608">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820613">Response</span><span class="op" id="7820621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820626">Status</span><span class="op" id="7820632">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7820641">&#34;204&nbsp;No&nbsp;Content&#34;</span><span class="op" id="7820657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820662">StatusCode</span><span class="op" id="7820672">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7820677">204</span><span class="op" id="7820680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820685">Proto</span><span class="op" id="7820690">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7820700">&#34;HTTP/1.1&#34;</span><span class="op" id="7820710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820715">ProtoMajor</span><span class="op" id="7820725">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7820730">1</span><span class="op" id="7820731">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820736">ProtoMinor</span><span class="op" id="7820746">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7820751">1</span><span class="op" id="7820752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820757">Header</span><span class="op" id="7820763">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7820772">Header</span><span class="op" id="7820778">{</span><span class="op" id="7820779">}</span><span class="op" id="7820780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820785">Request</span><span class="op" id="7820792">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7820800">dummyReq</span><span class="op" id="7820808">(</span><span class="string" id="7820809">&#34;GET&#34;</span><span class="op" id="7820814">)</span><span class="op" id="7820815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820820">Close</span><span class="op" id="7820825">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7820835">false</span><span class="op" id="7820840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7820845">ContentLength</span><span class="op" id="7820858">:</span>&nbsp;<span class="num" id="7820860">0</span><span class="op" id="7820861">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7820865">}</span><span class="op" id="7820866">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820871">&#34;&#34;</span><span class="op" id="7820873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7820876">}</span><span class="op" id="7820877">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7820881">//&nbsp;Unchunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7820925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820929">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7820951">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820956">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="7820981">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7820986">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7821010">+</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821015">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7821022">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821027">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7821040">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821045">Response</span><span class="op" id="7821053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821058">Status</span><span class="op" id="7821064">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7821070">&#34;200&nbsp;OK&#34;</span><span class="op" id="7821078">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821083">StatusCode</span><span class="op" id="7821093">:</span>&nbsp;<span class="num" id="7821095">200</span><span class="op" id="7821098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821103">Proto</span><span class="op" id="7821108">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7821115">&#34;HTTP/1.0&#34;</span><span class="op" id="7821125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821130">ProtoMajor</span><span class="op" id="7821140">:</span>&nbsp;<span class="num" id="7821142">1</span><span class="op" id="7821143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821148">ProtoMinor</span><span class="op" id="7821158">:</span>&nbsp;<span class="num" id="7821160">0</span><span class="op" id="7821161">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821166">Request</span><span class="op" id="7821173">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7821178">dummyReq</span><span class="op" id="7821186">(</span><span class="string" id="7821187">&#34;GET&#34;</span><span class="op" id="7821192">)</span><span class="op" id="7821193">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821198">Header</span><span class="op" id="7821204">:</span>&nbsp;<span class="ident" id="7821206">Header</span><span class="op" id="7821212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821218">&#34;Connection&#34;</span><span class="op" id="7821230">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7821236">{</span><span class="string" id="7821237">&#34;close&#34;</span><span class="op" id="7821244">}</span><span class="op" id="7821245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821251">&#34;Content-Length&#34;</span><span class="op" id="7821267">:</span>&nbsp;<span class="op" id="7821269">{</span><span class="string" id="7821270">&#34;10&#34;</span><span class="op" id="7821274">}</span><span class="op" id="7821275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821280">}</span><span class="op" id="7821281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821286">Close</span><span class="op" id="7821291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7821301">true</span><span class="op" id="7821305">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821310">ContentLength</span><span class="op" id="7821323">:</span>&nbsp;<span class="num" id="7821325">10</span><span class="op" id="7821327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821331">}</span><span class="op" id="7821332">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821337">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7821350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821353">}</span><span class="op" id="7821354">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7821358">//&nbsp;Chunked&nbsp;response&nbsp;without&nbsp;Content-Length.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821407">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7821429">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821434">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="7821467">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821472">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7821479">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821484">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="7821493">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821498">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="7821516">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821521">&#34;09\r\n&#34;</span>&nbsp;<span class="op" id="7821530">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821535">&#34;continued\r\n&#34;</span>&nbsp;<span class="op" id="7821551">+</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821556">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="7821564">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821569">&#34;\r\n&#34;</span><span class="op" id="7821575">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821580">Response</span><span class="op" id="7821588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821593">Status</span><span class="op" id="7821599">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7821611">&#34;200&nbsp;OK&#34;</span><span class="op" id="7821619">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821624">StatusCode</span><span class="op" id="7821634">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7821642">200</span><span class="op" id="7821645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821650">Proto</span><span class="op" id="7821655">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7821668">&#34;HTTP/1.1&#34;</span><span class="op" id="7821678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821683">ProtoMajor</span><span class="op" id="7821693">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7821701">1</span><span class="op" id="7821702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821707">ProtoMinor</span><span class="op" id="7821717">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7821725">1</span><span class="op" id="7821726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821731">Request</span><span class="op" id="7821738">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7821749">dummyReq</span><span class="op" id="7821757">(</span><span class="string" id="7821758">&#34;GET&#34;</span><span class="op" id="7821763">)</span><span class="op" id="7821764">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821769">Header</span><span class="op" id="7821775">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7821787">Header</span><span class="op" id="7821793">{</span><span class="op" id="7821794">}</span><span class="op" id="7821795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821800">Close</span><span class="op" id="7821805">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7821818">false</span><span class="op" id="7821823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821828">ContentLength</span><span class="op" id="7821841">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7821846">-</span><span class="num" id="7821847">1</span><span class="op" id="7821848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7821853">TransferEncoding</span><span class="op" id="7821869">:</span>&nbsp;<span class="op" id="7821871">[</span><span class="op" id="7821872">]</span><span class="builtintype" id="7821873">string</span><span class="op" id="7821879">{</span><span class="string" id="7821880">&#34;chunked&#34;</span><span class="op" id="7821889">}</span><span class="op" id="7821890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821894">}</span><span class="op" id="7821895">,</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821900">&#34;Body&nbsp;here\ncontinued&#34;</span><span class="op" id="7821922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821925">}</span><span class="op" id="7821926">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7821930">//&nbsp;Chunked&nbsp;response&nbsp;with&nbsp;Content-Length.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7821972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7821976">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7821998">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7822003">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="7822036">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7822041">&#34;Content-Length:&nbsp;10\r\n&#34;</span>&nbsp;<span class="op" id="7822066">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7822071">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7822078">+</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7822083">&#34;0a\r\n&#34;</span>&nbsp;<span class="op" id="7822092">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7822097">&#34;Body&nbsp;here\n\r\n&#34;</span>&nbsp;<span class="op" id="7822115">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7822120">&#34;0\r\n&#34;</span>&nbsp;<span class="op" id="7822128">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7822133">&#34;\r\n&#34;</span><span class="op" id="7822139">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822144">Response</span><span class="op" id="7822152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822157">Status</span><span class="op" id="7822163">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7822175">&#34;200&nbsp;OK&#34;</span><span class="op" id="7822183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822188">StatusCode</span><span class="op" id="7822198">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7822206">200</span><span class="op" id="7822209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822214">Proto</span><span class="op" id="7822219">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7822232">&#34;HTTP/1.1&#34;</span><span class="op" id="7822242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822247">ProtoMajor</span><span class="op" id="7822257">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7822265">1</span><span class="op" id="7822266">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822271">ProtoMinor</span><span class="op" id="7822281">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7822289">1</span><span class="op" id="7822290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822295">Request</span><span class="op" id="7822302">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7822313">dummyReq</span><span class="op" id="7822321">(</span><span class="string" id="7822322">&#34;GET&#34;</span><span class="op" id="7822327">)</span><span class="op" id="7822328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822333">Header</span><span class="op" id="7822339">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7822351">Header</span><span class="op" id="7822357">{</span><span class="op" id="7822358">}</span><span class="op" id="7822359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822364">Close</span><span class="op" id="7822369">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7822382">false</span><span class="op" id="7822387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822392">ContentLength</span><span class="op" id="7822405">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7822410">-</span><span class="num" id="7822411">1</span><span class="op" id="7822412">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822417">TransferEncoding</span><span class="op" id="7822433">:</span>&nbsp;<span class="op" id="7822435">[</span><span class="op" id="7822436">]</span><span class="builtintype" id="7822437">string</span><span class="op" id="7822443">{</span><span class="string" id="7822444">&#34;chunked&#34;</span><span class="op" id="7822453">}</span><span class="op" id="7822454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822458">}</span><span class="op" id="7822459">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7822464">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7822477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822480">}</span><span class="op" id="7822481">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7822485">//&nbsp;Chunked&nbsp;response&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7822540">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7822562">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7822567">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span>&nbsp;<span class="op" id="7822600">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7822605">&#34;\r\n&#34;</span><span class="op" id="7822611">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822616">Response</span><span class="op" id="7822624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822629">Status</span><span class="op" id="7822635">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7822647">&#34;200&nbsp;OK&#34;</span><span class="op" id="7822655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822660">StatusCode</span><span class="op" id="7822670">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7822678">200</span><span class="op" id="7822681">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822686">Proto</span><span class="op" id="7822691">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7822704">&#34;HTTP/1.1&#34;</span><span class="op" id="7822714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822719">ProtoMajor</span><span class="op" id="7822729">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7822737">1</span><span class="op" id="7822738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822743">ProtoMinor</span><span class="op" id="7822753">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7822761">1</span><span class="op" id="7822762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822767">Request</span><span class="op" id="7822774">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7822785">dummyReq</span><span class="op" id="7822793">(</span><span class="string" id="7822794">&#34;HEAD&#34;</span><span class="op" id="7822800">)</span><span class="op" id="7822801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822806">Header</span><span class="op" id="7822812">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7822824">Header</span><span class="op" id="7822830">{</span><span class="op" id="7822831">}</span><span class="op" id="7822832">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822837">TransferEncoding</span><span class="op" id="7822853">:</span>&nbsp;<span class="op" id="7822855">[</span><span class="op" id="7822856">]</span><span class="builtintype" id="7822857">string</span><span class="op" id="7822863">{</span><span class="string" id="7822864">&#34;chunked&#34;</span><span class="op" id="7822873">}</span><span class="op" id="7822874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822879">Close</span><span class="op" id="7822884">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7822897">false</span><span class="op" id="7822902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7822907">ContentLength</span><span class="op" id="7822920">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7822925">-</span><span class="num" id="7822926">1</span><span class="op" id="7822927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822931">}</span><span class="op" id="7822932">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7822937">&#34;&#34;</span><span class="op" id="7822939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822942">}</span><span class="op" id="7822943">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7822947">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7822996">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7823000">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7823022">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7823027">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="7823053">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7823058">&#34;\r\n&#34;</span><span class="op" id="7823064">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823069">Response</span><span class="op" id="7823077">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823082">Status</span><span class="op" id="7823088">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7823100">&#34;200&nbsp;OK&#34;</span><span class="op" id="7823108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823113">StatusCode</span><span class="op" id="7823123">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7823131">200</span><span class="op" id="7823134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823139">Proto</span><span class="op" id="7823144">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7823157">&#34;HTTP/1.0&#34;</span><span class="op" id="7823167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823172">ProtoMajor</span><span class="op" id="7823182">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7823190">1</span><span class="op" id="7823191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823196">ProtoMinor</span><span class="op" id="7823206">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7823214">0</span><span class="op" id="7823215">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823220">Request</span><span class="op" id="7823227">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7823238">dummyReq</span><span class="op" id="7823246">(</span><span class="string" id="7823247">&#34;HEAD&#34;</span><span class="op" id="7823253">)</span><span class="op" id="7823254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823259">Header</span><span class="op" id="7823265">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7823277">Header</span><span class="op" id="7823283">{</span><span class="string" id="7823284">&#34;Content-Length&#34;</span><span class="op" id="7823300">:</span>&nbsp;<span class="op" id="7823302">{</span><span class="string" id="7823303">&#34;256&#34;</span><span class="op" id="7823308">}</span><span class="op" id="7823309">}</span><span class="op" id="7823310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823315">TransferEncoding</span><span class="op" id="7823331">:</span>&nbsp;<span class="ident" id="7823333">nil</span><span class="op" id="7823336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823341">Close</span><span class="op" id="7823346">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7823359">true</span><span class="op" id="7823363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823368">ContentLength</span><span class="op" id="7823381">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7823386">256</span><span class="op" id="7823389">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7823393">}</span><span class="op" id="7823394">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7823399">&#34;&#34;</span><span class="op" id="7823401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7823404">}</span><span class="op" id="7823405">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7823409">//&nbsp;Content-Length&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request&nbsp;with&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7823472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7823476">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7823498">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7823503">&#34;Content-Length:&nbsp;256\r\n&#34;</span>&nbsp;<span class="op" id="7823529">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7823534">&#34;\r\n&#34;</span><span class="op" id="7823540">,</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823545">Response</span><span class="op" id="7823553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823558">Status</span><span class="op" id="7823564">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7823576">&#34;200&nbsp;OK&#34;</span><span class="op" id="7823584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823589">StatusCode</span><span class="op" id="7823599">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7823607">200</span><span class="op" id="7823610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823615">Proto</span><span class="op" id="7823620">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7823633">&#34;HTTP/1.1&#34;</span><span class="op" id="7823643">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823648">ProtoMajor</span><span class="op" id="7823658">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7823666">1</span><span class="op" id="7823667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823672">ProtoMinor</span><span class="op" id="7823682">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7823690">1</span><span class="op" id="7823691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823696">Request</span><span class="op" id="7823703">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7823714">dummyReq</span><span class="op" id="7823722">(</span><span class="string" id="7823723">&#34;HEAD&#34;</span><span class="op" id="7823729">)</span><span class="op" id="7823730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823735">Header</span><span class="op" id="7823741">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7823753">Header</span><span class="op" id="7823759">{</span><span class="string" id="7823760">&#34;Content-Length&#34;</span><span class="op" id="7823776">:</span>&nbsp;<span class="op" id="7823778">{</span><span class="string" id="7823779">&#34;256&#34;</span><span class="op" id="7823784">}</span><span class="op" id="7823785">}</span><span class="op" id="7823786">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823791">TransferEncoding</span><span class="op" id="7823807">:</span>&nbsp;<span class="ident" id="7823809">nil</span><span class="op" id="7823812">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823817">Close</span><span class="op" id="7823822">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7823835">false</span><span class="op" id="7823840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823845">ContentLength</span><span class="op" id="7823858">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7823863">256</span><span class="op" id="7823866">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7823870">}</span><span class="op" id="7823871">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7823876">&#34;&#34;</span><span class="op" id="7823878">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7823881">}</span><span class="op" id="7823882">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7823886">//&nbsp;No&nbsp;Content-Length&nbsp;or&nbsp;Chunked&nbsp;in&nbsp;response&nbsp;to&nbsp;a&nbsp;HEAD&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7823949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7823953">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7823975">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7823980">&#34;\r\n&#34;</span><span class="op" id="7823986">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7823991">Response</span><span class="op" id="7823999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824004">Status</span><span class="op" id="7824010">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7824022">&#34;200&nbsp;OK&#34;</span><span class="op" id="7824030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824035">StatusCode</span><span class="op" id="7824045">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7824053">200</span><span class="op" id="7824056">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824061">Proto</span><span class="op" id="7824066">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7824079">&#34;HTTP/1.0&#34;</span><span class="op" id="7824089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824094">ProtoMajor</span><span class="op" id="7824104">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7824112">1</span><span class="op" id="7824113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824118">ProtoMinor</span><span class="op" id="7824128">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7824136">0</span><span class="op" id="7824137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824142">Request</span><span class="op" id="7824149">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7824160">dummyReq</span><span class="op" id="7824168">(</span><span class="string" id="7824169">&#34;HEAD&#34;</span><span class="op" id="7824175">)</span><span class="op" id="7824176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824181">Header</span><span class="op" id="7824187">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7824199">Header</span><span class="op" id="7824205">{</span><span class="op" id="7824206">}</span><span class="op" id="7824207">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824212">TransferEncoding</span><span class="op" id="7824228">:</span>&nbsp;<span class="ident" id="7824230">nil</span><span class="op" id="7824233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824238">Close</span><span class="op" id="7824243">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7824256">true</span><span class="op" id="7824260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824265">ContentLength</span><span class="op" id="7824278">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7824283">-</span><span class="num" id="7824284">1</span><span class="op" id="7824285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824289">}</span><span class="op" id="7824290">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7824295">&#34;&#34;</span><span class="op" id="7824297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824300">}</span><span class="op" id="7824301">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7824305">//&nbsp;explicit&nbsp;Content-Length&nbsp;of&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824339">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7824343">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7824365">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7824370">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7824394">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7824399">&#34;\r\n&#34;</span><span class="op" id="7824405">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824410">Response</span><span class="op" id="7824418">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824423">Status</span><span class="op" id="7824429">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7824435">&#34;200&nbsp;OK&#34;</span><span class="op" id="7824443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824448">StatusCode</span><span class="op" id="7824458">:</span>&nbsp;<span class="num" id="7824460">200</span><span class="op" id="7824463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824468">Proto</span><span class="op" id="7824473">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7824480">&#34;HTTP/1.1&#34;</span><span class="op" id="7824490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824495">ProtoMajor</span><span class="op" id="7824505">:</span>&nbsp;<span class="num" id="7824507">1</span><span class="op" id="7824508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824513">ProtoMinor</span><span class="op" id="7824523">:</span>&nbsp;<span class="num" id="7824525">1</span><span class="op" id="7824526">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824531">Request</span><span class="op" id="7824538">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7824543">dummyReq</span><span class="op" id="7824551">(</span><span class="string" id="7824552">&#34;GET&#34;</span><span class="op" id="7824557">)</span><span class="op" id="7824558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824563">Header</span><span class="op" id="7824569">:</span>&nbsp;<span class="ident" id="7824571">Header</span><span class="op" id="7824577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7824583">&#34;Content-Length&#34;</span><span class="op" id="7824599">:</span>&nbsp;<span class="op" id="7824601">{</span><span class="string" id="7824602">&#34;0&#34;</span><span class="op" id="7824605">}</span><span class="op" id="7824606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824611">}</span><span class="op" id="7824612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824617">Close</span><span class="op" id="7824622">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7824632">false</span><span class="op" id="7824637">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824642">ContentLength</span><span class="op" id="7824655">:</span>&nbsp;<span class="num" id="7824657">0</span><span class="op" id="7824658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824662">}</span><span class="op" id="7824663">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7824668">&#34;&#34;</span><span class="op" id="7824670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824673">}</span><span class="op" id="7824674">,</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7824678">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;but&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7824739">//&nbsp;(permitted&nbsp;by&nbsp;RFC&nbsp;2616)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7824767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7824771">&#34;HTTP/1.0&nbsp;303&nbsp;\r\n\r\n&#34;</span><span class="op" id="7824794">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824798">Response</span><span class="op" id="7824806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824811">Status</span><span class="op" id="7824817">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7824826">&#34;303&nbsp;&#34;</span><span class="op" id="7824832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824837">StatusCode</span><span class="op" id="7824847">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7824852">303</span><span class="op" id="7824855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824860">Proto</span><span class="op" id="7824865">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7824875">&#34;HTTP/1.0&#34;</span><span class="op" id="7824885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824890">ProtoMajor</span><span class="op" id="7824900">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7824905">1</span><span class="op" id="7824906">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824911">ProtoMinor</span><span class="op" id="7824921">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7824926">0</span><span class="op" id="7824927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824932">Request</span><span class="op" id="7824939">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7824947">dummyReq</span><span class="op" id="7824955">(</span><span class="string" id="7824956">&#34;GET&#34;</span><span class="op" id="7824961">)</span><span class="op" id="7824962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824967">Header</span><span class="op" id="7824973">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7824982">Header</span><span class="op" id="7824988">{</span><span class="op" id="7824989">}</span><span class="op" id="7824990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7824995">Close</span><span class="op" id="7825000">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7825010">true</span><span class="op" id="7825014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825019">ContentLength</span><span class="op" id="7825032">:</span>&nbsp;<span class="op" id="7825034">-</span><span class="num" id="7825035">1</span><span class="op" id="7825036">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825040">}</span><span class="op" id="7825041">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7825046">&#34;&#34;</span><span class="op" id="7825048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825051">}</span><span class="op" id="7825052">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7825056">//&nbsp;Status&nbsp;line&nbsp;without&nbsp;a&nbsp;Reason-Phrase,&nbsp;and&nbsp;no&nbsp;trailing&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7825120">//&nbsp;(not&nbsp;permitted&nbsp;by&nbsp;RFC&nbsp;2616,&nbsp;but&nbsp;we&#39;ll&nbsp;accept&nbsp;it&nbsp;anyway)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7825184">&#34;HTTP/1.0&nbsp;303\r\n\r\n&#34;</span><span class="op" id="7825206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825210">Response</span><span class="op" id="7825218">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825223">Status</span><span class="op" id="7825229">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7825238">&#34;303&nbsp;&#34;</span><span class="op" id="7825244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825249">StatusCode</span><span class="op" id="7825259">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7825264">303</span><span class="op" id="7825267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825272">Proto</span><span class="op" id="7825277">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7825287">&#34;HTTP/1.0&#34;</span><span class="op" id="7825297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825302">ProtoMajor</span><span class="op" id="7825312">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7825317">1</span><span class="op" id="7825318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825323">ProtoMinor</span><span class="op" id="7825333">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7825338">0</span><span class="op" id="7825339">,</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825344">Request</span><span class="op" id="7825351">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7825359">dummyReq</span><span class="op" id="7825367">(</span><span class="string" id="7825368">&#34;GET&#34;</span><span class="op" id="7825373">)</span><span class="op" id="7825374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825379">Header</span><span class="op" id="7825385">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7825394">Header</span><span class="op" id="7825400">{</span><span class="op" id="7825401">}</span><span class="op" id="7825402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825407">Close</span><span class="op" id="7825412">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7825422">true</span><span class="op" id="7825426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825431">ContentLength</span><span class="op" id="7825444">:</span>&nbsp;<span class="op" id="7825446">-</span><span class="num" id="7825447">1</span><span class="op" id="7825448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825452">}</span><span class="op" id="7825453">,</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7825458">&#34;&#34;</span><span class="op" id="7825460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825463">}</span><span class="op" id="7825464">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7825468">//&nbsp;golang.org/issue/4767:&nbsp;don&#39;t&nbsp;special-case&nbsp;multipart/byteranges&nbsp;responses</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7825549">`HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content<br>
<span class="lineno"></span>Connection:&nbsp;close<br>
<span class="lineno"></span>Content-Type:&nbsp;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef<br>
<span class="lineno"></span><br>
<span class="lineno">340</span>some&nbsp;body`</span><span class="op" id="7825670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825674">Response</span><span class="op" id="7825682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825687">Status</span><span class="op" id="7825693">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7825699">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="7825720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825725">StatusCode</span><span class="op" id="7825735">:</span>&nbsp;<span class="num" id="7825737">206</span><span class="op" id="7825740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825745">Proto</span><span class="op" id="7825750">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7825757">&#34;HTTP/1.1&#34;</span><span class="op" id="7825767">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825772">ProtoMajor</span><span class="op" id="7825782">:</span>&nbsp;<span class="num" id="7825784">1</span><span class="op" id="7825785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825790">ProtoMinor</span><span class="op" id="7825800">:</span>&nbsp;<span class="num" id="7825802">1</span><span class="op" id="7825803">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825808">Request</span><span class="op" id="7825815">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7825820">dummyReq</span><span class="op" id="7825828">(</span><span class="string" id="7825829">&#34;GET&#34;</span><span class="op" id="7825834">)</span><span class="op" id="7825835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825840">Header</span><span class="op" id="7825846">:</span>&nbsp;<span class="ident" id="7825848">Header</span><span class="op" id="7825854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7825860">&#34;Content-Type&#34;</span><span class="op" id="7825874">:</span>&nbsp;<span class="op" id="7825876">[</span><span class="op" id="7825877">]</span><span class="builtintype" id="7825878">string</span><span class="op" id="7825884">{</span><span class="string" id="7825885">&#34;multipart/byteranges;&nbsp;boundary=18a75608c8f47cef&#34;</span><span class="op" id="7825934">}</span><span class="op" id="7825935">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825940">}</span><span class="op" id="7825941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825946">Close</span><span class="op" id="7825951">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7825961">true</span><span class="op" id="7825965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7825970">ContentLength</span><span class="op" id="7825983">:</span>&nbsp;<span class="op" id="7825985">-</span><span class="num" id="7825986">1</span><span class="op" id="7825987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7825991">}</span><span class="op" id="7825992">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7825997">&#34;some&nbsp;body&#34;</span><span class="op" id="7826008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7826011">}</span><span class="op" id="7826012">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7826016">//&nbsp;Unchunked&nbsp;response&nbsp;without&nbsp;Content-Length,&nbsp;Request&nbsp;is&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7826078">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826082">&#34;HTTP/1.0&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7826104">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826109">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7826133">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826138">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7826145">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826150">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7826163">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826168">Response</span><span class="op" id="7826176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826181">Status</span><span class="op" id="7826187">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826193">&#34;200&nbsp;OK&#34;</span><span class="op" id="7826201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826206">StatusCode</span><span class="op" id="7826216">:</span>&nbsp;<span class="num" id="7826218">200</span><span class="op" id="7826221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826226">Proto</span><span class="op" id="7826231">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826238">&#34;HTTP/1.0&#34;</span><span class="op" id="7826248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826253">ProtoMajor</span><span class="op" id="7826263">:</span>&nbsp;<span class="num" id="7826265">1</span><span class="op" id="7826266">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826271">ProtoMinor</span><span class="op" id="7826281">:</span>&nbsp;<span class="num" id="7826283">0</span><span class="op" id="7826284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826289">Header</span><span class="op" id="7826295">:</span>&nbsp;<span class="ident" id="7826297">Header</span><span class="op" id="7826303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826309">&#34;Connection&#34;</span><span class="op" id="7826321">:</span>&nbsp;<span class="op" id="7826323">{</span><span class="string" id="7826324">&#34;close&#34;</span><span class="op" id="7826331">}</span><span class="op" id="7826332">,</span>&nbsp;<span class="comment" id="7826334">//&nbsp;TODO(rsc):&nbsp;Delete?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7826359">}</span><span class="op" id="7826360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826365">Close</span><span class="op" id="7826370">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7826380">true</span><span class="op" id="7826384">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826389">ContentLength</span><span class="op" id="7826402">:</span>&nbsp;<span class="op" id="7826404">-</span><span class="num" id="7826405">1</span><span class="op" id="7826406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7826410">}</span><span class="op" id="7826411">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826416">&#34;Body&nbsp;here\n&#34;</span><span class="op" id="7826429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7826432">}</span><span class="op" id="7826433">,</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7826437">//&nbsp;206&nbsp;Partial&nbsp;Content.&nbsp;golang.org/issue/8923</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7826484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826488">&#34;HTTP/1.1&nbsp;206&nbsp;Partial&nbsp;Content\r\n&#34;</span>&nbsp;<span class="op" id="7826523">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826528">&#34;Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8\r\n&#34;</span>&nbsp;<span class="op" id="7826574">+</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826579">&#34;Accept-Ranges:&nbsp;bytes\r\n&#34;</span>&nbsp;<span class="op" id="7826606">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826611">&#34;Content-Range:&nbsp;bytes&nbsp;0-5/1862\r\n&#34;</span>&nbsp;<span class="op" id="7826647">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826652">&#34;Content-Length:&nbsp;6\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7826680">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826685">&#34;foobar&#34;</span><span class="op" id="7826693">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826698">Response</span><span class="op" id="7826706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826711">Status</span><span class="op" id="7826717">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826723">&#34;206&nbsp;Partial&nbsp;Content&#34;</span><span class="op" id="7826744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826749">StatusCode</span><span class="op" id="7826759">:</span>&nbsp;<span class="num" id="7826761">206</span><span class="op" id="7826764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826769">Proto</span><span class="op" id="7826774">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7826781">&#34;HTTP/1.1&#34;</span><span class="op" id="7826791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826796">ProtoMajor</span><span class="op" id="7826806">:</span>&nbsp;<span class="num" id="7826808">1</span><span class="op" id="7826809">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826814">ProtoMinor</span><span class="op" id="7826824">:</span>&nbsp;<span class="num" id="7826826">1</span><span class="op" id="7826827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826832">Request</span><span class="op" id="7826839">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7826844">dummyReq</span><span class="op" id="7826852">(</span><span class="string" id="7826853">&#34;GET&#34;</span><span class="op" id="7826858">)</span><span class="op" id="7826859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7826864">Header</span><span class="op" id="7826870">:</span>&nbsp;<span class="ident" id="7826872">Header</span><span class="op" id="7826878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826884">&#34;Accept-Ranges&#34;</span><span class="op" id="7826899">:</span>&nbsp;&nbsp;<span class="op" id="7826902">[</span><span class="op" id="7826903">]</span><span class="builtintype" id="7826904">string</span><span class="op" id="7826910">{</span><span class="string" id="7826911">&#34;bytes&#34;</span><span class="op" id="7826918">}</span><span class="op" id="7826919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826925">&#34;Content-Length&#34;</span><span class="op" id="7826941">:</span>&nbsp;<span class="op" id="7826943">[</span><span class="op" id="7826944">]</span><span class="builtintype" id="7826945">string</span><span class="op" id="7826951">{</span><span class="string" id="7826952">&#34;6&#34;</span><span class="op" id="7826955">}</span><span class="op" id="7826956">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7826962">&#34;Content-Type&#34;</span><span class="op" id="7826976">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7826980">[</span><span class="op" id="7826981">]</span><span class="builtintype" id="7826982">string</span><span class="op" id="7826988">{</span><span class="string" id="7826989">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="7827016">}</span><span class="op" id="7827017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7827023">&#34;Content-Range&#34;</span><span class="op" id="7827038">:</span>&nbsp;&nbsp;<span class="op" id="7827041">[</span><span class="op" id="7827042">]</span><span class="builtintype" id="7827043">string</span><span class="op" id="7827049">{</span><span class="string" id="7827050">&#34;bytes&nbsp;0-5/1862&#34;</span><span class="op" id="7827066">}</span><span class="op" id="7827067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827072">}</span><span class="op" id="7827073">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827078">ContentLength</span><span class="op" id="7827091">:</span>&nbsp;<span class="num" id="7827093">6</span><span class="op" id="7827094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827098">}</span><span class="op" id="7827099">,</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7827104">&#34;foobar&#34;</span><span class="op" id="7827112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827115">}</span><span class="op" id="7827116">,</span><br>
<span class="lineno"></span><span class="op" id="7827118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="7827121">func</span>&nbsp;<span class="ident" id="7827126">TestReadResponse</span><span class="op" id="7827142">(</span><span class="ident" id="7827143">t</span>&nbsp;<span class="op" id="7827145">*</span><span class="ident" id="7827146">testing</span><span class="op" id="7827153">.</span><span class="ident" id="7827154">T</span><span class="op" id="7827155">)</span>&nbsp;<span class="op" id="7827157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827160">for</span>&nbsp;<span class="ident" id="7827164">i</span><span class="op" id="7827165">,</span>&nbsp;<span class="ident" id="7827167">tt</span>&nbsp;<span class="op" id="7827170">:=</span>&nbsp;<span class="keyword" id="7827173">range</span>&nbsp;<span class="ident" id="7827179">respTests</span>&nbsp;<span class="op" id="7827189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827193">resp</span><span class="op" id="7827197">,</span>&nbsp;<span class="ident" id="7827199">err</span>&nbsp;<span class="op" id="7827203">:=</span>&nbsp;<span class="ident" id="7827206">ReadResponse</span><span class="op" id="7827218">(</span><span class="ident" id="7827219">bufio</span><span class="op" id="7827224">.</span><span class="ident" id="7827225">NewReader</span><span class="op" id="7827234">(</span><span class="ident" id="7827235">strings</span><span class="op" id="7827242">.</span><span class="ident" id="7827243">NewReader</span><span class="op" id="7827252">(</span><span class="ident" id="7827253">tt</span><span class="op" id="7827255">.</span><span class="ident" id="7827256">Raw</span><span class="op" id="7827259">)</span><span class="op" id="7827260">)</span><span class="op" id="7827261">,</span>&nbsp;<span class="ident" id="7827263">tt</span><span class="op" id="7827265">.</span><span class="ident" id="7827266">Resp</span><span class="op" id="7827270">.</span><span class="ident" id="7827271">Request</span><span class="op" id="7827278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827282">if</span>&nbsp;<span class="ident" id="7827285">err</span>&nbsp;<span class="op" id="7827289">!=</span>&nbsp;<span class="ident" id="7827292">nil</span>&nbsp;<span class="op" id="7827296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827301">t</span><span class="op" id="7827302">.</span><span class="ident" id="7827303">Errorf</span><span class="op" id="7827309">(</span><span class="string" id="7827310">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="7827319">,</span>&nbsp;<span class="ident" id="7827321">i</span><span class="op" id="7827322">,</span>&nbsp;<span class="ident" id="7827324">err</span><span class="op" id="7827327">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827332">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827347">rbody</span>&nbsp;<span class="op" id="7827353">:=</span>&nbsp;<span class="ident" id="7827356">resp</span><span class="op" id="7827360">.</span><span class="ident" id="7827361">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827368">resp</span><span class="op" id="7827372">.</span><span class="ident" id="7827373">Body</span>&nbsp;<span class="op" id="7827378">=</span>&nbsp;<span class="ident" id="7827380">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827386">diff</span><span class="op" id="7827390">(</span><span class="ident" id="7827391">t</span><span class="op" id="7827392">,</span>&nbsp;<span class="ident" id="7827394">fmt</span><span class="op" id="7827397">.</span><span class="ident" id="7827398">Sprintf</span><span class="op" id="7827405">(</span><span class="string" id="7827406">&#34;#%d&nbsp;Response&#34;</span><span class="op" id="7827420">,</span>&nbsp;<span class="ident" id="7827422">i</span><span class="op" id="7827423">)</span><span class="op" id="7827424">,</span>&nbsp;<span class="ident" id="7827426">resp</span><span class="op" id="7827430">,</span>&nbsp;<span class="op" id="7827432">&amp;</span><span class="ident" id="7827433">tt</span><span class="op" id="7827435">.</span><span class="ident" id="7827436">Resp</span><span class="op" id="7827440">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827444">var</span>&nbsp;<span class="ident" id="7827448">bout</span>&nbsp;<span class="ident" id="7827453">bytes</span><span class="op" id="7827458">.</span><span class="ident" id="7827459">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827468">if</span>&nbsp;<span class="ident" id="7827471">rbody</span>&nbsp;<span class="op" id="7827477">!=</span>&nbsp;<span class="ident" id="7827480">nil</span>&nbsp;<span class="op" id="7827484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827489">_</span><span class="op" id="7827490">,</span>&nbsp;<span class="ident" id="7827492">err</span>&nbsp;<span class="op" id="7827496">=</span>&nbsp;<span class="ident" id="7827498">io</span><span class="op" id="7827500">.</span><span class="ident" id="7827501">Copy</span><span class="op" id="7827505">(</span><span class="op" id="7827506">&amp;</span><span class="ident" id="7827507">bout</span><span class="op" id="7827511">,</span>&nbsp;<span class="ident" id="7827513">rbody</span><span class="op" id="7827518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827523">if</span>&nbsp;<span class="ident" id="7827526">err</span>&nbsp;<span class="op" id="7827530">!=</span>&nbsp;<span class="ident" id="7827533">nil</span>&nbsp;<span class="op" id="7827537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827543">t</span><span class="op" id="7827544">.</span><span class="ident" id="7827545">Errorf</span><span class="op" id="7827551">(</span><span class="string" id="7827552">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="7827561">,</span>&nbsp;<span class="ident" id="7827563">i</span><span class="op" id="7827564">,</span>&nbsp;<span class="ident" id="7827566">err</span><span class="op" id="7827569">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827575">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827592">rbody</span><span class="op" id="7827597">.</span><span class="ident" id="7827598">Close</span><span class="op" id="7827603">(</span><span class="op" id="7827604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827612">body</span>&nbsp;<span class="op" id="7827617">:=</span>&nbsp;<span class="ident" id="7827620">bout</span><span class="op" id="7827624">.</span><span class="ident" id="7827625">String</span><span class="op" id="7827631">(</span><span class="op" id="7827632">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827636">if</span>&nbsp;<span class="ident" id="7827639">body</span>&nbsp;<span class="op" id="7827644">!=</span>&nbsp;<span class="ident" id="7827647">tt</span><span class="op" id="7827649">.</span><span class="ident" id="7827650">Body</span>&nbsp;<span class="op" id="7827655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827660">t</span><span class="op" id="7827661">.</span><span class="ident" id="7827662">Errorf</span><span class="op" id="7827668">(</span><span class="string" id="7827669">&#34;#%d:&nbsp;Body&nbsp;=&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7827693">,</span>&nbsp;<span class="ident" id="7827695">i</span><span class="op" id="7827696">,</span>&nbsp;<span class="ident" id="7827698">body</span><span class="op" id="7827702">,</span>&nbsp;<span class="ident" id="7827704">tt</span><span class="op" id="7827706">.</span><span class="ident" id="7827707">Body</span><span class="op" id="7827711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827715">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827718">}</span><br>
<span class="lineno"></span><span class="op" id="7827720">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="7827723">func</span>&nbsp;<span class="ident" id="7827728">TestWriteResponse</span><span class="op" id="7827745">(</span><span class="ident" id="7827746">t</span>&nbsp;<span class="op" id="7827748">*</span><span class="ident" id="7827749">testing</span><span class="op" id="7827756">.</span><span class="ident" id="7827757">T</span><span class="op" id="7827758">)</span>&nbsp;<span class="op" id="7827760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827763">for</span>&nbsp;<span class="ident" id="7827767">i</span><span class="op" id="7827768">,</span>&nbsp;<span class="ident" id="7827770">tt</span>&nbsp;<span class="op" id="7827773">:=</span>&nbsp;<span class="keyword" id="7827776">range</span>&nbsp;<span class="ident" id="7827782">respTests</span>&nbsp;<span class="op" id="7827792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827796">resp</span><span class="op" id="7827800">,</span>&nbsp;<span class="ident" id="7827802">err</span>&nbsp;<span class="op" id="7827806">:=</span>&nbsp;<span class="ident" id="7827809">ReadResponse</span><span class="op" id="7827821">(</span><span class="ident" id="7827822">bufio</span><span class="op" id="7827827">.</span><span class="ident" id="7827828">NewReader</span><span class="op" id="7827837">(</span><span class="ident" id="7827838">strings</span><span class="op" id="7827845">.</span><span class="ident" id="7827846">NewReader</span><span class="op" id="7827855">(</span><span class="ident" id="7827856">tt</span><span class="op" id="7827858">.</span><span class="ident" id="7827859">Raw</span><span class="op" id="7827862">)</span><span class="op" id="7827863">)</span><span class="op" id="7827864">,</span>&nbsp;<span class="ident" id="7827866">tt</span><span class="op" id="7827868">.</span><span class="ident" id="7827869">Resp</span><span class="op" id="7827873">.</span><span class="ident" id="7827874">Request</span><span class="op" id="7827881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827885">if</span>&nbsp;<span class="ident" id="7827888">err</span>&nbsp;<span class="op" id="7827892">!=</span>&nbsp;<span class="ident" id="7827895">nil</span>&nbsp;<span class="op" id="7827899">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827904">t</span><span class="op" id="7827905">.</span><span class="ident" id="7827906">Errorf</span><span class="op" id="7827912">(</span><span class="string" id="7827913">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="7827922">,</span>&nbsp;<span class="ident" id="7827924">i</span><span class="op" id="7827925">,</span>&nbsp;<span class="ident" id="7827927">err</span><span class="op" id="7827930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827935">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7827946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7827950">err</span>&nbsp;<span class="op" id="7827954">=</span>&nbsp;<span class="ident" id="7827956">resp</span><span class="op" id="7827960">.</span><span class="ident" id="7827961">Write</span><span class="op" id="7827966">(</span><span class="ident" id="7827967">ioutil</span><span class="op" id="7827973">.</span><span class="ident" id="7827974">Discard</span><span class="op" id="7827981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7827985">if</span>&nbsp;<span class="ident" id="7827988">err</span>&nbsp;<span class="op" id="7827992">!=</span>&nbsp;<span class="ident" id="7827995">nil</span>&nbsp;<span class="op" id="7827999">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828004">t</span><span class="op" id="7828005">.</span><span class="ident" id="7828006">Errorf</span><span class="op" id="7828012">(</span><span class="string" id="7828013">&#34;#%d:&nbsp;%v&#34;</span><span class="op" id="7828022">,</span>&nbsp;<span class="ident" id="7828024">i</span><span class="op" id="7828025">,</span>&nbsp;<span class="ident" id="7828027">err</span><span class="op" id="7828030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828035">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828049">}</span><br>
<span class="lineno"></span><span class="op" id="7828051">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="7828054">var</span>&nbsp;<span class="ident" id="7828058">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="7828089">=</span>&nbsp;<span class="op" id="7828091">[</span><span class="op" id="7828092">]</span><span class="keyword" id="7828093">struct</span>&nbsp;<span class="op" id="7828100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828103">chunked</span><span class="op" id="7828110">,</span>&nbsp;<span class="ident" id="7828112">compressed</span>&nbsp;<span class="builtintype" id="7828123">bool</span><br>
<span class="lineno"></span><span class="op" id="7828128">}</span><span class="op" id="7828129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828132">{</span><span class="builtintype" id="7828133">false</span><span class="op" id="7828138">,</span>&nbsp;<span class="builtintype" id="7828140">false</span><span class="op" id="7828145">}</span><span class="op" id="7828146">,</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828149">{</span><span class="builtintype" id="7828150">true</span><span class="op" id="7828154">,</span>&nbsp;<span class="builtintype" id="7828156">false</span><span class="op" id="7828161">}</span><span class="op" id="7828162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828165">{</span><span class="builtintype" id="7828166">true</span><span class="op" id="7828170">,</span>&nbsp;<span class="builtintype" id="7828172">true</span><span class="op" id="7828176">}</span><span class="op" id="7828177">,</span><br>
<span class="lineno"></span><span class="op" id="7828179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7828182">//&nbsp;TestReadResponseCloseInMiddle&nbsp;tests&nbsp;that&nbsp;closing&nbsp;a&nbsp;body&nbsp;after</span><br>
<span class="lineno">460</span><span class="comment" id="7828247">//&nbsp;reading&nbsp;only&nbsp;part&nbsp;of&nbsp;its&nbsp;contents&nbsp;advances&nbsp;the&nbsp;read&nbsp;to&nbsp;the&nbsp;end&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="7828316">//&nbsp;the&nbsp;request,&nbsp;right&nbsp;up&nbsp;until&nbsp;the&nbsp;next&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="7828365">func</span>&nbsp;<span class="ident" id="7828370">TestReadResponseCloseInMiddle</span><span class="op" id="7828399">(</span><span class="ident" id="7828400">t</span>&nbsp;<span class="op" id="7828402">*</span><span class="ident" id="7828403">testing</span><span class="op" id="7828410">.</span><span class="ident" id="7828411">T</span><span class="op" id="7828412">)</span>&nbsp;<span class="op" id="7828414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828417">for</span>&nbsp;<span class="ident" id="7828421">_</span><span class="op" id="7828422">,</span>&nbsp;<span class="ident" id="7828424">test</span>&nbsp;<span class="op" id="7828429">:=</span>&nbsp;<span class="keyword" id="7828432">range</span>&nbsp;<span class="ident" id="7828438">readResponseCloseInMiddleTests</span>&nbsp;<span class="op" id="7828469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828473">fatalf</span>&nbsp;<span class="op" id="7828480">:=</span>&nbsp;<span class="keyword" id="7828483">func</span><span class="op" id="7828487">(</span><span class="ident" id="7828488">format</span>&nbsp;<span class="builtintype" id="7828495">string</span><span class="op" id="7828501">,</span>&nbsp;<span class="ident" id="7828503">args</span>&nbsp;<span class="op" id="7828508">...</span><span class="keyword" id="7828511">interface</span><span class="op" id="7828520">{</span><span class="op" id="7828521">}</span><span class="op" id="7828522">)</span>&nbsp;<span class="op" id="7828524">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828529">args</span>&nbsp;<span class="op" id="7828534">=</span>&nbsp;<span class="builtinfunc" id="7828536">append</span><span class="op" id="7828542">(</span><span class="op" id="7828543">[</span><span class="op" id="7828544">]</span><span class="keyword" id="7828545">interface</span><span class="op" id="7828554">{</span><span class="op" id="7828555">}</span><span class="op" id="7828556">{</span><span class="ident" id="7828557">test</span><span class="op" id="7828561">.</span><span class="ident" id="7828562">chunked</span><span class="op" id="7828569">,</span>&nbsp;<span class="ident" id="7828571">test</span><span class="op" id="7828575">.</span><span class="ident" id="7828576">compressed</span><span class="op" id="7828586">}</span><span class="op" id="7828587">,</span>&nbsp;<span class="ident" id="7828589">args</span><span class="op" id="7828593">...</span><span class="op" id="7828596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828601">t</span><span class="op" id="7828602">.</span><span class="ident" id="7828603">Fatalf</span><span class="op" id="7828609">(</span><span class="string" id="7828610">&#34;on&nbsp;test&nbsp;chunked=%v,&nbsp;compressed=%v:&nbsp;&#34;</span><span class="op" id="7828647">+</span><span class="ident" id="7828648">format</span><span class="op" id="7828654">,</span>&nbsp;<span class="ident" id="7828656">args</span><span class="op" id="7828660">...</span><span class="op" id="7828663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828671">checkErr</span>&nbsp;<span class="op" id="7828680">:=</span>&nbsp;<span class="keyword" id="7828683">func</span><span class="op" id="7828687">(</span><span class="ident" id="7828688">err</span>&nbsp;<span class="builtintype" id="7828692">error</span><span class="op" id="7828697">,</span>&nbsp;<span class="ident" id="7828699">msg</span>&nbsp;<span class="builtintype" id="7828703">string</span><span class="op" id="7828709">)</span>&nbsp;<span class="op" id="7828711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828716">if</span>&nbsp;<span class="ident" id="7828719">err</span>&nbsp;<span class="op" id="7828723">==</span>&nbsp;<span class="ident" id="7828726">nil</span>&nbsp;<span class="op" id="7828730">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828736">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828751">fatalf</span><span class="op" id="7828757">(</span><span class="ident" id="7828758">msg</span><span class="op" id="7828761">+</span><span class="string" id="7828762">&#34;:&nbsp;%v&#34;</span><span class="op" id="7828768">,</span>&nbsp;<span class="ident" id="7828770">err</span><span class="op" id="7828773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828781">var</span>&nbsp;<span class="ident" id="7828785">buf</span>&nbsp;<span class="ident" id="7828789">bytes</span><span class="op" id="7828794">.</span><span class="ident" id="7828795">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828804">buf</span><span class="op" id="7828807">.</span><span class="ident" id="7828808">WriteString</span><span class="op" id="7828819">(</span><span class="string" id="7828820">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span><span class="op" id="7828841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828845">if</span>&nbsp;<span class="ident" id="7828848">test</span><span class="op" id="7828852">.</span><span class="ident" id="7828853">chunked</span>&nbsp;<span class="op" id="7828861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828866">buf</span><span class="op" id="7828869">.</span><span class="ident" id="7828870">WriteString</span><span class="op" id="7828881">(</span><span class="string" id="7828882">&#34;Transfer-Encoding:&nbsp;chunked\r\n&#34;</span><span class="op" id="7828914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828918">}</span>&nbsp;<span class="keyword" id="7828920">else</span>&nbsp;<span class="op" id="7828925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7828930">buf</span><span class="op" id="7828933">.</span><span class="ident" id="7828934">WriteString</span><span class="op" id="7828945">(</span><span class="string" id="7828946">&#34;Content-Length:&nbsp;1000000\r\n&#34;</span><span class="op" id="7828975">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7828979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7828983">var</span>&nbsp;<span class="ident" id="7828987">wr</span>&nbsp;<span class="ident" id="7828990">io</span><span class="op" id="7828992">.</span><span class="ident" id="7828993">Writer</span>&nbsp;<span class="op" id="7829000">=</span>&nbsp;<span class="op" id="7829002">&amp;</span><span class="ident" id="7829003">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829009">if</span>&nbsp;<span class="ident" id="7829012">test</span><span class="op" id="7829016">.</span><span class="ident" id="7829017">chunked</span>&nbsp;<span class="op" id="7829025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829030">wr</span>&nbsp;<span class="op" id="7829033">=</span>&nbsp;<span class="ident" id="7829035">internal</span><span class="op" id="7829043">.</span><span class="ident" id="7829044">NewChunkedWriter</span><span class="op" id="7829060">(</span><span class="ident" id="7829061">wr</span><span class="op" id="7829063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829067">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829071">if</span>&nbsp;<span class="ident" id="7829074">test</span><span class="op" id="7829078">.</span><span class="ident" id="7829079">compressed</span>&nbsp;<span class="op" id="7829090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829095">buf</span><span class="op" id="7829098">.</span><span class="ident" id="7829099">WriteString</span><span class="op" id="7829110">(</span><span class="string" id="7829111">&#34;Content-Encoding:&nbsp;gzip\r\n&#34;</span><span class="op" id="7829139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829144">wr</span>&nbsp;<span class="op" id="7829147">=</span>&nbsp;<span class="ident" id="7829149">gzip</span><span class="op" id="7829153">.</span><span class="ident" id="7829154">NewWriter</span><span class="op" id="7829163">(</span><span class="ident" id="7829164">wr</span><span class="op" id="7829166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829174">buf</span><span class="op" id="7829177">.</span><span class="ident" id="7829178">WriteString</span><span class="op" id="7829189">(</span><span class="string" id="7829190">&#34;\r\n&#34;</span><span class="op" id="7829196">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829201">chunk</span>&nbsp;<span class="op" id="7829207">:=</span>&nbsp;<span class="ident" id="7829210">bytes</span><span class="op" id="7829215">.</span><span class="ident" id="7829216">Repeat</span><span class="op" id="7829222">(</span><span class="op" id="7829223">[</span><span class="op" id="7829224">]</span><span class="builtintype" id="7829225">byte</span><span class="op" id="7829229">{</span><span class="string" id="7829230">&#39;x&#39;</span><span class="op" id="7829233">}</span><span class="op" id="7829234">,</span>&nbsp;<span class="num" id="7829236">1000</span><span class="op" id="7829240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829244">for</span>&nbsp;<span class="ident" id="7829248">i</span>&nbsp;<span class="op" id="7829250">:=</span>&nbsp;<span class="num" id="7829253">0</span><span class="op" id="7829254">;</span>&nbsp;<span class="ident" id="7829256">i</span>&nbsp;<span class="op" id="7829258">&lt;</span>&nbsp;<span class="num" id="7829260">1000</span><span class="op" id="7829264">;</span>&nbsp;<span class="ident" id="7829266">i</span><span class="op" id="7829267">++</span>&nbsp;<span class="op" id="7829270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829275">if</span>&nbsp;<span class="ident" id="7829278">test</span><span class="op" id="7829282">.</span><span class="ident" id="7829283">compressed</span>&nbsp;<span class="op" id="7829294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7829300">//&nbsp;Otherwise&nbsp;this&nbsp;compresses&nbsp;too&nbsp;well.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829343">_</span><span class="op" id="7829344">,</span>&nbsp;<span class="ident" id="7829346">err</span>&nbsp;<span class="op" id="7829350">:=</span>&nbsp;<span class="ident" id="7829353">io</span><span class="op" id="7829355">.</span><span class="ident" id="7829356">ReadFull</span><span class="op" id="7829364">(</span><span class="ident" id="7829365">rand</span><span class="op" id="7829369">.</span><span class="ident" id="7829370">Reader</span><span class="op" id="7829376">,</span>&nbsp;<span class="ident" id="7829378">chunk</span><span class="op" id="7829383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829389">checkErr</span><span class="op" id="7829397">(</span><span class="ident" id="7829398">err</span><span class="op" id="7829401">,</span>&nbsp;<span class="string" id="7829403">&#34;rand.Reader&nbsp;ReadFull&#34;</span><span class="op" id="7829425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829435">wr</span><span class="op" id="7829437">.</span><span class="ident" id="7829438">Write</span><span class="op" id="7829443">(</span><span class="ident" id="7829444">chunk</span><span class="op" id="7829449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829453">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829457">if</span>&nbsp;<span class="ident" id="7829460">test</span><span class="op" id="7829464">.</span><span class="ident" id="7829465">compressed</span>&nbsp;<span class="op" id="7829476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829481">err</span>&nbsp;<span class="op" id="7829485">:=</span>&nbsp;<span class="ident" id="7829488">wr</span><span class="op" id="7829490">.</span><span class="op" id="7829491">(</span><span class="op" id="7829492">*</span><span class="ident" id="7829493">gzip</span><span class="op" id="7829497">.</span><span class="ident" id="7829498">Writer</span><span class="op" id="7829504">)</span><span class="op" id="7829505">.</span><span class="ident" id="7829506">Close</span><span class="op" id="7829511">(</span><span class="op" id="7829512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829517">checkErr</span><span class="op" id="7829525">(</span><span class="ident" id="7829526">err</span><span class="op" id="7829529">,</span>&nbsp;<span class="string" id="7829531">&#34;compressor&nbsp;close&#34;</span><span class="op" id="7829549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829557">if</span>&nbsp;<span class="ident" id="7829560">test</span><span class="op" id="7829564">.</span><span class="ident" id="7829565">chunked</span>&nbsp;<span class="op" id="7829573">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829578">buf</span><span class="op" id="7829581">.</span><span class="ident" id="7829582">WriteString</span><span class="op" id="7829593">(</span><span class="string" id="7829594">&#34;0\r\n\r\n&#34;</span><span class="op" id="7829605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829613">buf</span><span class="op" id="7829616">.</span><span class="ident" id="7829617">WriteString</span><span class="op" id="7829628">(</span><span class="string" id="7829629">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="7829648">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829653">bufr</span>&nbsp;<span class="op" id="7829658">:=</span>&nbsp;<span class="ident" id="7829661">bufio</span><span class="op" id="7829666">.</span><span class="ident" id="7829667">NewReader</span><span class="op" id="7829676">(</span><span class="op" id="7829677">&amp;</span><span class="ident" id="7829678">buf</span><span class="op" id="7829681">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829685">resp</span><span class="op" id="7829689">,</span>&nbsp;<span class="ident" id="7829691">err</span>&nbsp;<span class="op" id="7829695">:=</span>&nbsp;<span class="ident" id="7829698">ReadResponse</span><span class="op" id="7829710">(</span><span class="ident" id="7829711">bufr</span><span class="op" id="7829715">,</span>&nbsp;<span class="ident" id="7829717">dummyReq</span><span class="op" id="7829725">(</span><span class="string" id="7829726">&#34;GET&#34;</span><span class="op" id="7829731">)</span><span class="op" id="7829732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829736">checkErr</span><span class="op" id="7829744">(</span><span class="ident" id="7829745">err</span><span class="op" id="7829748">,</span>&nbsp;<span class="string" id="7829750">&#34;ReadResponse&#34;</span><span class="op" id="7829764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829768">expectedLength</span>&nbsp;<span class="op" id="7829783">:=</span>&nbsp;<span class="ident" id="7829786">int64</span><span class="op" id="7829791">(</span><span class="op" id="7829792">-</span><span class="num" id="7829793">1</span><span class="op" id="7829794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829798">if</span>&nbsp;<span class="op" id="7829801">!</span><span class="ident" id="7829802">test</span><span class="op" id="7829806">.</span><span class="ident" id="7829807">chunked</span>&nbsp;<span class="op" id="7829815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829820">expectedLength</span>&nbsp;<span class="op" id="7829835">=</span>&nbsp;<span class="num" id="7829837">1000000</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829851">if</span>&nbsp;<span class="ident" id="7829854">resp</span><span class="op" id="7829858">.</span><span class="ident" id="7829859">ContentLength</span>&nbsp;<span class="op" id="7829873">!=</span>&nbsp;<span class="ident" id="7829876">expectedLength</span>&nbsp;<span class="op" id="7829891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7829896">fatalf</span><span class="op" id="7829902">(</span><span class="string" id="7829903">&#34;expected&nbsp;response&nbsp;length&nbsp;%d,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7829940">,</span>&nbsp;<span class="ident" id="7829942">expectedLength</span><span class="op" id="7829956">,</span>&nbsp;<span class="ident" id="7829958">resp</span><span class="op" id="7829962">.</span><span class="ident" id="7829963">ContentLength</span><span class="op" id="7829976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7829980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7829984">if</span>&nbsp;<span class="ident" id="7829987">resp</span><span class="op" id="7829991">.</span><span class="ident" id="7829992">Body</span>&nbsp;<span class="op" id="7829997">==</span>&nbsp;<span class="ident" id="7830000">nil</span>&nbsp;<span class="op" id="7830004">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830009">fatalf</span><span class="op" id="7830015">(</span><span class="string" id="7830016">&#34;nil&nbsp;body&#34;</span><span class="op" id="7830026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7830030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7830034">if</span>&nbsp;<span class="ident" id="7830037">test</span><span class="op" id="7830041">.</span><span class="ident" id="7830042">compressed</span>&nbsp;<span class="op" id="7830053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830058">gzReader</span><span class="op" id="7830066">,</span>&nbsp;<span class="ident" id="7830068">err</span>&nbsp;<span class="op" id="7830072">:=</span>&nbsp;<span class="ident" id="7830075">gzip</span><span class="op" id="7830079">.</span><span class="ident" id="7830080">NewReader</span><span class="op" id="7830089">(</span><span class="ident" id="7830090">resp</span><span class="op" id="7830094">.</span><span class="ident" id="7830095">Body</span><span class="op" id="7830099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830104">checkErr</span><span class="op" id="7830112">(</span><span class="ident" id="7830113">err</span><span class="op" id="7830116">,</span>&nbsp;<span class="string" id="7830118">&#34;gzip.NewReader&#34;</span><span class="op" id="7830134">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830139">resp</span><span class="op" id="7830143">.</span><span class="ident" id="7830144">Body</span>&nbsp;<span class="op" id="7830149">=</span>&nbsp;<span class="op" id="7830151">&amp;</span><span class="ident" id="7830152">readerAndCloser</span><span class="op" id="7830167">{</span><span class="ident" id="7830168">gzReader</span><span class="op" id="7830176">,</span>&nbsp;<span class="ident" id="7830178">resp</span><span class="op" id="7830182">.</span><span class="ident" id="7830183">Body</span><span class="op" id="7830187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7830191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830196">rbuf</span>&nbsp;<span class="op" id="7830201">:=</span>&nbsp;<span class="builtinfunc" id="7830204">make</span><span class="op" id="7830208">(</span><span class="op" id="7830209">[</span><span class="op" id="7830210">]</span><span class="builtintype" id="7830211">byte</span><span class="op" id="7830215">,</span>&nbsp;<span class="num" id="7830217">2500</span><span class="op" id="7830221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830225">n</span><span class="op" id="7830226">,</span>&nbsp;<span class="ident" id="7830228">err</span>&nbsp;<span class="op" id="7830232">:=</span>&nbsp;<span class="ident" id="7830235">io</span><span class="op" id="7830237">.</span><span class="ident" id="7830238">ReadFull</span><span class="op" id="7830246">(</span><span class="ident" id="7830247">resp</span><span class="op" id="7830251">.</span><span class="ident" id="7830252">Body</span><span class="op" id="7830256">,</span>&nbsp;<span class="ident" id="7830258">rbuf</span><span class="op" id="7830262">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830266">checkErr</span><span class="op" id="7830274">(</span><span class="ident" id="7830275">err</span><span class="op" id="7830278">,</span>&nbsp;<span class="string" id="7830280">&#34;2500&nbsp;byte&nbsp;ReadFull&#34;</span><span class="op" id="7830300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7830304">if</span>&nbsp;<span class="ident" id="7830307">n</span>&nbsp;<span class="op" id="7830309">!=</span>&nbsp;<span class="num" id="7830312">2500</span>&nbsp;<span class="op" id="7830317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830322">fatalf</span><span class="op" id="7830328">(</span><span class="string" id="7830329">&#34;ReadFull&nbsp;only&nbsp;read&nbsp;%d&nbsp;bytes&#34;</span><span class="op" id="7830358">,</span>&nbsp;<span class="ident" id="7830360">n</span><span class="op" id="7830361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7830365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7830369">if</span>&nbsp;<span class="ident" id="7830372">test</span><span class="op" id="7830376">.</span><span class="ident" id="7830377">compressed</span>&nbsp;<span class="op" id="7830388">==</span>&nbsp;<span class="builtintype" id="7830391">false</span>&nbsp;<span class="op" id="7830397">&amp;&amp;</span>&nbsp;<span class="op" id="7830400">!</span><span class="ident" id="7830401">bytes</span><span class="op" id="7830406">.</span><span class="ident" id="7830407">Equal</span><span class="op" id="7830412">(</span><span class="ident" id="7830413">bytes</span><span class="op" id="7830418">.</span><span class="ident" id="7830419">Repeat</span><span class="op" id="7830425">(</span><span class="op" id="7830426">[</span><span class="op" id="7830427">]</span><span class="builtintype" id="7830428">byte</span><span class="op" id="7830432">{</span><span class="string" id="7830433">&#39;x&#39;</span><span class="op" id="7830436">}</span><span class="op" id="7830437">,</span>&nbsp;<span class="num" id="7830439">2500</span><span class="op" id="7830443">)</span><span class="op" id="7830444">,</span>&nbsp;<span class="ident" id="7830446">rbuf</span><span class="op" id="7830450">)</span>&nbsp;<span class="op" id="7830452">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830457">fatalf</span><span class="op" id="7830463">(</span><span class="string" id="7830464">&#34;ReadFull&nbsp;didn&#39;t&nbsp;read&nbsp;2500&nbsp;&#39;x&#39;;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7830503">,</span>&nbsp;<span class="builtintype" id="7830505">string</span><span class="op" id="7830511">(</span><span class="ident" id="7830512">rbuf</span><span class="op" id="7830516">)</span><span class="op" id="7830517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7830521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830525">resp</span><span class="op" id="7830529">.</span><span class="ident" id="7830530">Body</span><span class="op" id="7830534">.</span><span class="ident" id="7830535">Close</span><span class="op" id="7830540">(</span><span class="op" id="7830541">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830546">rest</span><span class="op" id="7830550">,</span>&nbsp;<span class="ident" id="7830552">err</span>&nbsp;<span class="op" id="7830556">:=</span>&nbsp;<span class="ident" id="7830559">ioutil</span><span class="op" id="7830565">.</span><span class="ident" id="7830566">ReadAll</span><span class="op" id="7830573">(</span><span class="ident" id="7830574">bufr</span><span class="op" id="7830578">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830582">checkErr</span><span class="op" id="7830590">(</span><span class="ident" id="7830591">err</span><span class="op" id="7830594">,</span>&nbsp;<span class="string" id="7830596">&#34;ReadAll&nbsp;on&nbsp;remainder&#34;</span><span class="op" id="7830618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7830622">if</span>&nbsp;<span class="ident" id="7830625">e</span><span class="op" id="7830626">,</span>&nbsp;<span class="ident" id="7830628">g</span>&nbsp;<span class="op" id="7830630">:=</span>&nbsp;<span class="string" id="7830633">&#34;Next&nbsp;Request&nbsp;Here&#34;</span><span class="op" id="7830652">,</span>&nbsp;<span class="builtintype" id="7830654">string</span><span class="op" id="7830660">(</span><span class="ident" id="7830661">rest</span><span class="op" id="7830665">)</span><span class="op" id="7830666">;</span>&nbsp;<span class="ident" id="7830668">e</span>&nbsp;<span class="op" id="7830670">!=</span>&nbsp;<span class="ident" id="7830673">g</span>&nbsp;<span class="op" id="7830675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830680">g</span>&nbsp;<span class="op" id="7830682">=</span>&nbsp;<span class="ident" id="7830684">regexp</span><span class="op" id="7830690">.</span><span class="ident" id="7830691">MustCompile</span><span class="op" id="7830702">(</span><span class="string" id="7830703">`(xx+)`</span><span class="op" id="7830710">)</span><span class="op" id="7830711">.</span><span class="ident" id="7830712">ReplaceAllStringFunc</span><span class="op" id="7830732">(</span><span class="ident" id="7830733">g</span><span class="op" id="7830734">,</span>&nbsp;<span class="keyword" id="7830736">func</span><span class="op" id="7830740">(</span><span class="ident" id="7830741">match</span>&nbsp;<span class="builtintype" id="7830747">string</span><span class="op" id="7830753">)</span>&nbsp;<span class="builtintype" id="7830755">string</span>&nbsp;<span class="op" id="7830762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7830768">return</span>&nbsp;<span class="ident" id="7830775">fmt</span><span class="op" id="7830778">.</span><span class="ident" id="7830779">Sprintf</span><span class="op" id="7830786">(</span><span class="string" id="7830787">&#34;x(repeated&nbsp;x%d)&#34;</span><span class="op" id="7830804">,</span>&nbsp;<span class="builtinfunc" id="7830806">len</span><span class="op" id="7830809">(</span><span class="ident" id="7830810">match</span><span class="op" id="7830815">)</span><span class="op" id="7830816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7830821">}</span><span class="op" id="7830822">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830827">fatalf</span><span class="op" id="7830833">(</span><span class="string" id="7830834">&#34;remainder&nbsp;=&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="7830863">,</span>&nbsp;<span class="ident" id="7830865">g</span><span class="op" id="7830866">,</span>&nbsp;<span class="ident" id="7830868">e</span><span class="op" id="7830869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7830873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7830876">}</span><br>
<span class="lineno"></span><span class="op" id="7830878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span><span class="keyword" id="7830881">func</span>&nbsp;<span class="ident" id="7830886">diff</span><span class="op" id="7830890">(</span><span class="ident" id="7830891">t</span>&nbsp;<span class="op" id="7830893">*</span><span class="ident" id="7830894">testing</span><span class="op" id="7830901">.</span><span class="ident" id="7830902">T</span><span class="op" id="7830903">,</span>&nbsp;<span class="ident" id="7830905">prefix</span>&nbsp;<span class="builtintype" id="7830912">string</span><span class="op" id="7830918">,</span>&nbsp;<span class="ident" id="7830920">have</span><span class="op" id="7830924">,</span>&nbsp;<span class="ident" id="7830926">want</span>&nbsp;<span class="keyword" id="7830931">interface</span><span class="op" id="7830940">{</span><span class="op" id="7830941">}</span><span class="op" id="7830942">)</span>&nbsp;<span class="op" id="7830944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830947">hv</span>&nbsp;<span class="op" id="7830950">:=</span>&nbsp;<span class="ident" id="7830953">reflect</span><span class="op" id="7830960">.</span><span class="ident" id="7830961">ValueOf</span><span class="op" id="7830968">(</span><span class="ident" id="7830969">have</span><span class="op" id="7830973">)</span><span class="op" id="7830974">.</span><span class="ident" id="7830975">Elem</span><span class="op" id="7830979">(</span><span class="op" id="7830980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7830983">wv</span>&nbsp;<span class="op" id="7830986">:=</span>&nbsp;<span class="ident" id="7830989">reflect</span><span class="op" id="7830996">.</span><span class="ident" id="7830997">ValueOf</span><span class="op" id="7831004">(</span><span class="ident" id="7831005">want</span><span class="op" id="7831009">)</span><span class="op" id="7831010">.</span><span class="ident" id="7831011">Elem</span><span class="op" id="7831015">(</span><span class="op" id="7831016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7831019">if</span>&nbsp;<span class="ident" id="7831022">hv</span><span class="op" id="7831024">.</span><span class="ident" id="7831025">Type</span><span class="op" id="7831029">(</span><span class="op" id="7831030">)</span>&nbsp;<span class="op" id="7831032">!=</span>&nbsp;<span class="ident" id="7831035">wv</span><span class="op" id="7831037">.</span><span class="ident" id="7831038">Type</span><span class="op" id="7831042">(</span><span class="op" id="7831043">)</span>&nbsp;<span class="op" id="7831045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831049">t</span><span class="op" id="7831050">.</span><span class="ident" id="7831051">Errorf</span><span class="op" id="7831057">(</span><span class="string" id="7831058">&#34;%s:&nbsp;type&nbsp;mismatch&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7831088">,</span>&nbsp;<span class="ident" id="7831090">prefix</span><span class="op" id="7831096">,</span>&nbsp;<span class="ident" id="7831098">hv</span><span class="op" id="7831100">.</span><span class="ident" id="7831101">Type</span><span class="op" id="7831105">(</span><span class="op" id="7831106">)</span><span class="op" id="7831107">,</span>&nbsp;<span class="ident" id="7831109">wv</span><span class="op" id="7831111">.</span><span class="ident" id="7831112">Type</span><span class="op" id="7831116">(</span><span class="op" id="7831117">)</span><span class="op" id="7831118">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7831121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7831124">for</span>&nbsp;<span class="ident" id="7831128">i</span>&nbsp;<span class="op" id="7831130">:=</span>&nbsp;<span class="num" id="7831133">0</span><span class="op" id="7831134">;</span>&nbsp;<span class="ident" id="7831136">i</span>&nbsp;<span class="op" id="7831138">&lt;</span>&nbsp;<span class="ident" id="7831140">hv</span><span class="op" id="7831142">.</span><span class="ident" id="7831143">NumField</span><span class="op" id="7831151">(</span><span class="op" id="7831152">)</span><span class="op" id="7831153">;</span>&nbsp;<span class="ident" id="7831155">i</span><span class="op" id="7831156">++</span>&nbsp;<span class="op" id="7831159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831163">hf</span>&nbsp;<span class="op" id="7831166">:=</span>&nbsp;<span class="ident" id="7831169">hv</span><span class="op" id="7831171">.</span><span class="ident" id="7831172">Field</span><span class="op" id="7831177">(</span><span class="ident" id="7831178">i</span><span class="op" id="7831179">)</span><span class="op" id="7831180">.</span><span class="ident" id="7831181">Interface</span><span class="op" id="7831190">(</span><span class="op" id="7831191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831195">wf</span>&nbsp;<span class="op" id="7831198">:=</span>&nbsp;<span class="ident" id="7831201">wv</span><span class="op" id="7831203">.</span><span class="ident" id="7831204">Field</span><span class="op" id="7831209">(</span><span class="ident" id="7831210">i</span><span class="op" id="7831211">)</span><span class="op" id="7831212">.</span><span class="ident" id="7831213">Interface</span><span class="op" id="7831222">(</span><span class="op" id="7831223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7831227">if</span>&nbsp;<span class="op" id="7831230">!</span><span class="ident" id="7831231">reflect</span><span class="op" id="7831238">.</span><span class="ident" id="7831239">DeepEqual</span><span class="op" id="7831248">(</span><span class="ident" id="7831249">hf</span><span class="op" id="7831251">,</span>&nbsp;<span class="ident" id="7831253">wf</span><span class="op" id="7831255">)</span>&nbsp;<span class="op" id="7831257">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831262">t</span><span class="op" id="7831263">.</span><span class="ident" id="7831264">Errorf</span><span class="op" id="7831270">(</span><span class="string" id="7831271">&#34;%s:&nbsp;%s&nbsp;=&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7831292">,</span>&nbsp;<span class="ident" id="7831294">prefix</span><span class="op" id="7831300">,</span>&nbsp;<span class="ident" id="7831302">hv</span><span class="op" id="7831304">.</span><span class="ident" id="7831305">Type</span><span class="op" id="7831309">(</span><span class="op" id="7831310">)</span><span class="op" id="7831311">.</span><span class="ident" id="7831312">Field</span><span class="op" id="7831317">(</span><span class="ident" id="7831318">i</span><span class="op" id="7831319">)</span><span class="op" id="7831320">.</span><span class="ident" id="7831321">Name</span><span class="op" id="7831325">,</span>&nbsp;<span class="ident" id="7831327">hf</span><span class="op" id="7831329">,</span>&nbsp;<span class="ident" id="7831331">wf</span><span class="op" id="7831333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7831337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7831340">}</span><br>
<span class="lineno"></span><span class="op" id="7831342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">565</span><span class="keyword" id="7831345">type</span>&nbsp;<span class="ident" id="7831350">responseLocationTest</span>&nbsp;<span class="keyword" id="7831371">struct</span>&nbsp;<span class="op" id="7831378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831381">location</span>&nbsp;<span class="builtintype" id="7831390">string</span>&nbsp;<span class="comment" id="7831397">//&nbsp;Response&#39;s&nbsp;Location&nbsp;header&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831434">requrl</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7831443">string</span>&nbsp;<span class="comment" id="7831450">//&nbsp;Response.Request.URL&nbsp;or&nbsp;&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831481">want</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7831490">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831498">wantErr</span>&nbsp;&nbsp;<span class="builtintype" id="7831507">error</span><br>
<span class="lineno">570</span><span class="op" id="7831513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7831516">var</span>&nbsp;<span class="ident" id="7831520">responseLocationTests</span>&nbsp;<span class="op" id="7831542">=</span>&nbsp;<span class="op" id="7831544">[</span><span class="op" id="7831545">]</span><span class="ident" id="7831546">responseLocationTest</span><span class="op" id="7831566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7831569">{</span><span class="string" id="7831570">&#34;/foo&#34;</span><span class="op" id="7831576">,</span>&nbsp;<span class="string" id="7831578">&#34;http://bar.com/baz&#34;</span><span class="op" id="7831598">,</span>&nbsp;<span class="string" id="7831600">&#34;http://bar.com/foo&#34;</span><span class="op" id="7831620">,</span>&nbsp;<span class="ident" id="7831622">nil</span><span class="op" id="7831625">}</span><span class="op" id="7831626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7831629">{</span><span class="string" id="7831630">&#34;http://foo.com/&#34;</span><span class="op" id="7831647">,</span>&nbsp;<span class="string" id="7831649">&#34;http://bar.com/baz&#34;</span><span class="op" id="7831669">,</span>&nbsp;<span class="string" id="7831671">&#34;http://foo.com/&#34;</span><span class="op" id="7831688">,</span>&nbsp;<span class="ident" id="7831690">nil</span><span class="op" id="7831693">}</span><span class="op" id="7831694">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7831697">{</span><span class="string" id="7831698">&#34;&#34;</span><span class="op" id="7831700">,</span>&nbsp;<span class="string" id="7831702">&#34;http://bar.com/baz&#34;</span><span class="op" id="7831722">,</span>&nbsp;<span class="string" id="7831724">&#34;&#34;</span><span class="op" id="7831726">,</span>&nbsp;<span class="ident" id="7831728">ErrNoLocation</span><span class="op" id="7831741">}</span><span class="op" id="7831742">,</span><br>
<span class="lineno"></span><span class="op" id="7831744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7831747">func</span>&nbsp;<span class="ident" id="7831752">TestLocationResponse</span><span class="op" id="7831772">(</span><span class="ident" id="7831773">t</span>&nbsp;<span class="op" id="7831775">*</span><span class="ident" id="7831776">testing</span><span class="op" id="7831783">.</span><span class="ident" id="7831784">T</span><span class="op" id="7831785">)</span>&nbsp;<span class="op" id="7831787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7831790">for</span>&nbsp;<span class="ident" id="7831794">i</span><span class="op" id="7831795">,</span>&nbsp;<span class="ident" id="7831797">tt</span>&nbsp;<span class="op" id="7831800">:=</span>&nbsp;<span class="keyword" id="7831803">range</span>&nbsp;<span class="ident" id="7831809">responseLocationTests</span>&nbsp;<span class="op" id="7831831">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831835">res</span>&nbsp;<span class="op" id="7831839">:=</span>&nbsp;<span class="builtinfunc" id="7831842">new</span><span class="op" id="7831845">(</span><span class="ident" id="7831846">Response</span><span class="op" id="7831854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831858">res</span><span class="op" id="7831861">.</span><span class="ident" id="7831862">Header</span>&nbsp;<span class="op" id="7831869">=</span>&nbsp;<span class="builtinfunc" id="7831871">make</span><span class="op" id="7831875">(</span><span class="ident" id="7831876">Header</span><span class="op" id="7831882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831886">res</span><span class="op" id="7831889">.</span><span class="ident" id="7831890">Header</span><span class="op" id="7831896">.</span><span class="ident" id="7831897">Set</span><span class="op" id="7831900">(</span><span class="string" id="7831901">&#34;Location&#34;</span><span class="op" id="7831911">,</span>&nbsp;<span class="ident" id="7831913">tt</span><span class="op" id="7831915">.</span><span class="ident" id="7831916">location</span><span class="op" id="7831924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7831928">if</span>&nbsp;<span class="ident" id="7831931">tt</span><span class="op" id="7831933">.</span><span class="ident" id="7831934">requrl</span>&nbsp;<span class="op" id="7831941">!=</span>&nbsp;<span class="string" id="7831944">&#34;&#34;</span>&nbsp;<span class="op" id="7831947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831952">res</span><span class="op" id="7831955">.</span><span class="ident" id="7831956">Request</span>&nbsp;<span class="op" id="7831964">=</span>&nbsp;<span class="op" id="7831966">&amp;</span><span class="ident" id="7831967">Request</span><span class="op" id="7831974">{</span><span class="op" id="7831975">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7831980">var</span>&nbsp;<span class="ident" id="7831984">err</span>&nbsp;<span class="builtintype" id="7831988">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7831997">res</span><span class="op" id="7832000">.</span><span class="ident" id="7832001">Request</span><span class="op" id="7832008">.</span><span class="ident" id="7832009">URL</span><span class="op" id="7832012">,</span>&nbsp;<span class="ident" id="7832014">err</span>&nbsp;<span class="op" id="7832018">=</span>&nbsp;<span class="ident" id="7832020">url</span><span class="op" id="7832023">.</span><span class="ident" id="7832024">Parse</span><span class="op" id="7832029">(</span><span class="ident" id="7832030">tt</span><span class="op" id="7832032">.</span><span class="ident" id="7832033">requrl</span><span class="op" id="7832039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832044">if</span>&nbsp;<span class="ident" id="7832047">err</span>&nbsp;<span class="op" id="7832051">!=</span>&nbsp;<span class="ident" id="7832054">nil</span>&nbsp;<span class="op" id="7832058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832064">t</span><span class="op" id="7832065">.</span><span class="ident" id="7832066">Fatalf</span><span class="op" id="7832072">(</span><span class="string" id="7832073">&#34;bad&nbsp;test&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="7832094">,</span>&nbsp;<span class="ident" id="7832096">tt</span><span class="op" id="7832098">.</span><span class="ident" id="7832099">requrl</span><span class="op" id="7832105">,</span>&nbsp;<span class="ident" id="7832107">err</span><span class="op" id="7832110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832115">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832124">got</span><span class="op" id="7832127">,</span>&nbsp;<span class="ident" id="7832129">err</span>&nbsp;<span class="op" id="7832133">:=</span>&nbsp;<span class="ident" id="7832136">res</span><span class="op" id="7832139">.</span><span class="ident" id="7832140">Location</span><span class="op" id="7832148">(</span><span class="op" id="7832149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832153">if</span>&nbsp;<span class="ident" id="7832156">tt</span><span class="op" id="7832158">.</span><span class="ident" id="7832159">wantErr</span>&nbsp;<span class="op" id="7832167">!=</span>&nbsp;<span class="ident" id="7832170">nil</span>&nbsp;<span class="op" id="7832174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832179">if</span>&nbsp;<span class="ident" id="7832182">err</span>&nbsp;<span class="op" id="7832186">==</span>&nbsp;<span class="ident" id="7832189">nil</span>&nbsp;<span class="op" id="7832193">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832199">t</span><span class="op" id="7832200">.</span><span class="ident" id="7832201">Errorf</span><span class="op" id="7832207">(</span><span class="string" id="7832208">&#34;%d.&nbsp;err=nil;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7832230">,</span>&nbsp;<span class="ident" id="7832232">i</span><span class="op" id="7832233">,</span>&nbsp;<span class="ident" id="7832235">tt</span><span class="op" id="7832237">.</span><span class="ident" id="7832238">wantErr</span><span class="op" id="7832245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832251">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832268">if</span>&nbsp;<span class="ident" id="7832271">g</span><span class="op" id="7832272">,</span>&nbsp;<span class="ident" id="7832274">e</span>&nbsp;<span class="op" id="7832276">:=</span>&nbsp;<span class="ident" id="7832279">err</span><span class="op" id="7832282">.</span><span class="ident" id="7832283">Error</span><span class="op" id="7832288">(</span><span class="op" id="7832289">)</span><span class="op" id="7832290">,</span>&nbsp;<span class="ident" id="7832292">tt</span><span class="op" id="7832294">.</span><span class="ident" id="7832295">wantErr</span><span class="op" id="7832302">.</span><span class="ident" id="7832303">Error</span><span class="op" id="7832308">(</span><span class="op" id="7832309">)</span><span class="op" id="7832310">;</span>&nbsp;<span class="ident" id="7832312">g</span>&nbsp;<span class="op" id="7832314">!=</span>&nbsp;<span class="ident" id="7832317">e</span>&nbsp;<span class="op" id="7832319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832325">t</span><span class="op" id="7832326">.</span><span class="ident" id="7832327">Errorf</span><span class="op" id="7832333">(</span><span class="string" id="7832334">&#34;%d.&nbsp;err=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7832355">,</span>&nbsp;<span class="ident" id="7832357">i</span><span class="op" id="7832358">,</span>&nbsp;<span class="ident" id="7832360">g</span><span class="op" id="7832361">,</span>&nbsp;<span class="ident" id="7832363">e</span><span class="op" id="7832364">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832370">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832387">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832402">if</span>&nbsp;<span class="ident" id="7832405">err</span>&nbsp;<span class="op" id="7832409">!=</span>&nbsp;<span class="ident" id="7832412">nil</span>&nbsp;<span class="op" id="7832416">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832421">t</span><span class="op" id="7832422">.</span><span class="ident" id="7832423">Errorf</span><span class="op" id="7832429">(</span><span class="string" id="7832430">&#34;%d.&nbsp;err=%q&#34;</span><span class="op" id="7832442">,</span>&nbsp;<span class="ident" id="7832444">i</span><span class="op" id="7832445">,</span>&nbsp;<span class="ident" id="7832447">err</span><span class="op" id="7832450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832455">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832470">if</span>&nbsp;<span class="ident" id="7832473">g</span><span class="op" id="7832474">,</span>&nbsp;<span class="ident" id="7832476">e</span>&nbsp;<span class="op" id="7832478">:=</span>&nbsp;<span class="ident" id="7832481">got</span><span class="op" id="7832484">.</span><span class="ident" id="7832485">String</span><span class="op" id="7832491">(</span><span class="op" id="7832492">)</span><span class="op" id="7832493">,</span>&nbsp;<span class="ident" id="7832495">tt</span><span class="op" id="7832497">.</span><span class="ident" id="7832498">want</span><span class="op" id="7832502">;</span>&nbsp;<span class="ident" id="7832504">g</span>&nbsp;<span class="op" id="7832506">!=</span>&nbsp;<span class="ident" id="7832509">e</span>&nbsp;<span class="op" id="7832511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832516">t</span><span class="op" id="7832517">.</span><span class="ident" id="7832518">Errorf</span><span class="op" id="7832524">(</span><span class="string" id="7832525">&#34;%d.&nbsp;Location=%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7832551">,</span>&nbsp;<span class="ident" id="7832553">i</span><span class="op" id="7832554">,</span>&nbsp;<span class="ident" id="7832556">g</span><span class="op" id="7832557">,</span>&nbsp;<span class="ident" id="7832559">e</span><span class="op" id="7832560">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832567">}</span><br>
<span class="lineno"></span><span class="op" id="7832569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7832572">func</span>&nbsp;<span class="ident" id="7832577">TestResponseStatusStutter</span><span class="op" id="7832602">(</span><span class="ident" id="7832603">t</span>&nbsp;<span class="op" id="7832605">*</span><span class="ident" id="7832606">testing</span><span class="op" id="7832613">.</span><span class="ident" id="7832614">T</span><span class="op" id="7832615">)</span>&nbsp;<span class="op" id="7832617">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832620">r</span>&nbsp;<span class="op" id="7832622">:=</span>&nbsp;<span class="op" id="7832625">&amp;</span><span class="ident" id="7832626">Response</span><span class="op" id="7832634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832638">Status</span><span class="op" id="7832644">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7832650">&#34;123&nbsp;some&nbsp;status&#34;</span><span class="op" id="7832667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832671">StatusCode</span><span class="op" id="7832681">:</span>&nbsp;<span class="num" id="7832683">123</span><span class="op" id="7832686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832690">ProtoMajor</span><span class="op" id="7832700">:</span>&nbsp;<span class="num" id="7832702">1</span><span class="op" id="7832703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832707">ProtoMinor</span><span class="op" id="7832717">:</span>&nbsp;<span class="num" id="7832719">3</span><span class="op" id="7832720">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832726">var</span>&nbsp;<span class="ident" id="7832730">buf</span>&nbsp;<span class="ident" id="7832734">bytes</span><span class="op" id="7832739">.</span><span class="ident" id="7832740">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832748">r</span><span class="op" id="7832749">.</span><span class="ident" id="7832750">Write</span><span class="op" id="7832755">(</span><span class="op" id="7832756">&amp;</span><span class="ident" id="7832757">buf</span><span class="op" id="7832760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832763">if</span>&nbsp;<span class="ident" id="7832766">strings</span><span class="op" id="7832773">.</span><span class="ident" id="7832774">Contains</span><span class="op" id="7832782">(</span><span class="ident" id="7832783">buf</span><span class="op" id="7832786">.</span><span class="ident" id="7832787">String</span><span class="op" id="7832793">(</span><span class="op" id="7832794">)</span><span class="op" id="7832795">,</span>&nbsp;<span class="string" id="7832797">&#34;123&nbsp;123&#34;</span><span class="op" id="7832806">)</span>&nbsp;<span class="op" id="7832808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832812">t</span><span class="op" id="7832813">.</span><span class="ident" id="7832814">Errorf</span><span class="op" id="7832820">(</span><span class="string" id="7832821">&#34;stutter&nbsp;in&nbsp;status:&nbsp;%s&#34;</span><span class="op" id="7832844">,</span>&nbsp;<span class="ident" id="7832846">buf</span><span class="op" id="7832849">.</span><span class="ident" id="7832850">String</span><span class="op" id="7832856">(</span><span class="op" id="7832857">)</span><span class="op" id="7832858">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7832861">}</span><br>
<span class="lineno"></span><span class="op" id="7832863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7832866">func</span>&nbsp;<span class="ident" id="7832871">TestResponseContentLengthShortBody</span><span class="op" id="7832905">(</span><span class="ident" id="7832906">t</span>&nbsp;<span class="op" id="7832908">*</span><span class="ident" id="7832909">testing</span><span class="op" id="7832916">.</span><span class="ident" id="7832917">T</span><span class="op" id="7832918">)</span>&nbsp;<span class="op" id="7832920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7832923">const</span>&nbsp;<span class="ident" id="7832929">shortBody</span>&nbsp;<span class="op" id="7832939">=</span>&nbsp;<span class="string" id="7832941">&#34;Short&nbsp;body,&nbsp;not&nbsp;123&nbsp;bytes.&#34;</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7832971">br</span>&nbsp;<span class="op" id="7832974">:=</span>&nbsp;<span class="ident" id="7832977">bufio</span><span class="op" id="7832982">.</span><span class="ident" id="7832983">NewReader</span><span class="op" id="7832992">(</span><span class="ident" id="7832993">strings</span><span class="op" id="7833000">.</span><span class="ident" id="7833001">NewReader</span><span class="op" id="7833010">(</span><span class="string" id="7833011">&#34;HTTP/1.1&nbsp;200&nbsp;OK\r\n&#34;</span>&nbsp;<span class="op" id="7833033">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7833037">&#34;Content-Length:&nbsp;123\r\n&#34;</span>&nbsp;<span class="op" id="7833063">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7833067">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7833074">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833078">shortBody</span><span class="op" id="7833087">)</span><span class="op" id="7833088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833091">res</span><span class="op" id="7833094">,</span>&nbsp;<span class="ident" id="7833096">err</span>&nbsp;<span class="op" id="7833100">:=</span>&nbsp;<span class="ident" id="7833103">ReadResponse</span><span class="op" id="7833115">(</span><span class="ident" id="7833116">br</span><span class="op" id="7833118">,</span>&nbsp;<span class="op" id="7833120">&amp;</span><span class="ident" id="7833121">Request</span><span class="op" id="7833128">{</span><span class="ident" id="7833129">Method</span><span class="op" id="7833135">:</span>&nbsp;<span class="string" id="7833137">&#34;GET&#34;</span><span class="op" id="7833142">}</span><span class="op" id="7833143">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833146">if</span>&nbsp;<span class="ident" id="7833149">err</span>&nbsp;<span class="op" id="7833153">!=</span>&nbsp;<span class="ident" id="7833156">nil</span>&nbsp;<span class="op" id="7833160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833164">t</span><span class="op" id="7833165">.</span><span class="ident" id="7833166">Fatal</span><span class="op" id="7833171">(</span><span class="ident" id="7833172">err</span><span class="op" id="7833175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833181">if</span>&nbsp;<span class="ident" id="7833184">res</span><span class="op" id="7833187">.</span><span class="ident" id="7833188">ContentLength</span>&nbsp;<span class="op" id="7833202">!=</span>&nbsp;<span class="num" id="7833205">123</span>&nbsp;<span class="op" id="7833209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833213">t</span><span class="op" id="7833214">.</span><span class="ident" id="7833215">Fatalf</span><span class="op" id="7833221">(</span><span class="string" id="7833222">&#34;Content-Length&nbsp;=&nbsp;%d;&nbsp;want&nbsp;123&#34;</span><span class="op" id="7833253">,</span>&nbsp;<span class="ident" id="7833255">res</span><span class="op" id="7833258">.</span><span class="ident" id="7833259">ContentLength</span><span class="op" id="7833272">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833278">var</span>&nbsp;<span class="ident" id="7833282">buf</span>&nbsp;<span class="ident" id="7833286">bytes</span><span class="op" id="7833291">.</span><span class="ident" id="7833292">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833300">n</span><span class="op" id="7833301">,</span>&nbsp;<span class="ident" id="7833303">err</span>&nbsp;<span class="op" id="7833307">:=</span>&nbsp;<span class="ident" id="7833310">io</span><span class="op" id="7833312">.</span><span class="ident" id="7833313">Copy</span><span class="op" id="7833317">(</span><span class="op" id="7833318">&amp;</span><span class="ident" id="7833319">buf</span><span class="op" id="7833322">,</span>&nbsp;<span class="ident" id="7833324">res</span><span class="op" id="7833327">.</span><span class="ident" id="7833328">Body</span><span class="op" id="7833332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833335">if</span>&nbsp;<span class="ident" id="7833338">n</span>&nbsp;<span class="op" id="7833340">!=</span>&nbsp;<span class="ident" id="7833343">int64</span><span class="op" id="7833348">(</span><span class="builtinfunc" id="7833349">len</span><span class="op" id="7833352">(</span><span class="ident" id="7833353">shortBody</span><span class="op" id="7833362">)</span><span class="op" id="7833363">)</span>&nbsp;<span class="op" id="7833365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833369">t</span><span class="op" id="7833370">.</span><span class="ident" id="7833371">Errorf</span><span class="op" id="7833377">(</span><span class="string" id="7833378">&#34;Copied&nbsp;%d&nbsp;bytes;&nbsp;want&nbsp;%d,&nbsp;len(%q)&#34;</span><span class="op" id="7833413">,</span>&nbsp;<span class="ident" id="7833415">n</span><span class="op" id="7833416">,</span>&nbsp;<span class="builtinfunc" id="7833418">len</span><span class="op" id="7833421">(</span><span class="ident" id="7833422">shortBody</span><span class="op" id="7833431">)</span><span class="op" id="7833432">,</span>&nbsp;<span class="ident" id="7833434">shortBody</span><span class="op" id="7833443">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833449">if</span>&nbsp;<span class="ident" id="7833452">buf</span><span class="op" id="7833455">.</span><span class="ident" id="7833456">String</span><span class="op" id="7833462">(</span><span class="op" id="7833463">)</span>&nbsp;<span class="op" id="7833465">!=</span>&nbsp;<span class="ident" id="7833468">shortBody</span>&nbsp;<span class="op" id="7833478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833482">t</span><span class="op" id="7833483">.</span><span class="ident" id="7833484">Errorf</span><span class="op" id="7833490">(</span><span class="string" id="7833491">&#34;Read&nbsp;body&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7833514">,</span>&nbsp;<span class="ident" id="7833516">buf</span><span class="op" id="7833519">.</span><span class="ident" id="7833520">String</span><span class="op" id="7833526">(</span><span class="op" id="7833527">)</span><span class="op" id="7833528">,</span>&nbsp;<span class="ident" id="7833530">shortBody</span><span class="op" id="7833539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833545">if</span>&nbsp;<span class="ident" id="7833548">err</span>&nbsp;<span class="op" id="7833552">!=</span>&nbsp;<span class="ident" id="7833555">io</span><span class="op" id="7833557">.</span><span class="ident" id="7833558">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="7833575">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833579">t</span><span class="op" id="7833580">.</span><span class="ident" id="7833581">Errorf</span><span class="op" id="7833587">(</span><span class="string" id="7833588">&#34;io.Copy&nbsp;error&nbsp;=&nbsp;%#v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="7833635">,</span>&nbsp;<span class="ident" id="7833637">err</span><span class="op" id="7833640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833643">}</span><br>
<span class="lineno"></span><span class="op" id="7833645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7833648">func</span>&nbsp;<span class="ident" id="7833653">TestReadResponseUnexpectedEOF</span><span class="op" id="7833682">(</span><span class="ident" id="7833683">t</span>&nbsp;<span class="op" id="7833685">*</span><span class="ident" id="7833686">testing</span><span class="op" id="7833693">.</span><span class="ident" id="7833694">T</span><span class="op" id="7833695">)</span>&nbsp;<span class="op" id="7833697">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833700">br</span>&nbsp;<span class="op" id="7833703">:=</span>&nbsp;<span class="ident" id="7833706">bufio</span><span class="op" id="7833711">.</span><span class="ident" id="7833712">NewReader</span><span class="op" id="7833721">(</span><span class="ident" id="7833722">strings</span><span class="op" id="7833729">.</span><span class="ident" id="7833730">NewReader</span><span class="op" id="7833739">(</span><span class="string" id="7833740">&#34;HTTP/1.1&nbsp;301&nbsp;Moved&nbsp;Permanently\r\n&#34;</span>&nbsp;<span class="op" id="7833777">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7833781">&#34;Location:&nbsp;http://example.com&#34;</span><span class="op" id="7833811">)</span><span class="op" id="7833812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833815">_</span><span class="op" id="7833816">,</span>&nbsp;<span class="ident" id="7833818">err</span>&nbsp;<span class="op" id="7833822">:=</span>&nbsp;<span class="ident" id="7833825">ReadResponse</span><span class="op" id="7833837">(</span><span class="ident" id="7833838">br</span><span class="op" id="7833840">,</span>&nbsp;<span class="ident" id="7833842">nil</span><span class="op" id="7833845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7833848">if</span>&nbsp;<span class="ident" id="7833851">err</span>&nbsp;<span class="op" id="7833855">!=</span>&nbsp;<span class="ident" id="7833858">io</span><span class="op" id="7833860">.</span><span class="ident" id="7833861">ErrUnexpectedEOF</span>&nbsp;<span class="op" id="7833878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7833882">t</span><span class="op" id="7833883">.</span><span class="ident" id="7833884">Errorf</span><span class="op" id="7833890">(</span><span class="string" id="7833891">&#34;ReadResponse&nbsp;=&nbsp;%v;&nbsp;want&nbsp;io.ErrUnexpectedEOF&#34;</span><span class="op" id="7833936">,</span>&nbsp;<span class="ident" id="7833938">err</span><span class="op" id="7833941">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7833944">}</span><br>
<span class="lineno"></span><span class="op" id="7833946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7833949">func</span>&nbsp;<span class="ident" id="7833954">TestNeedsSniff</span><span class="op" id="7833968">(</span><span class="ident" id="7833969">t</span>&nbsp;<span class="op" id="7833971">*</span><span class="ident" id="7833972">testing</span><span class="op" id="7833979">.</span><span class="ident" id="7833980">T</span><span class="op" id="7833981">)</span>&nbsp;<span class="op" id="7833983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7833986">//&nbsp;needsSniff&nbsp;returns&nbsp;true&nbsp;with&nbsp;an&nbsp;empty&nbsp;response.</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834038">r</span>&nbsp;<span class="op" id="7834040">:=</span>&nbsp;<span class="op" id="7834043">&amp;</span><span class="ident" id="7834044">response</span><span class="op" id="7834052">{</span><span class="op" id="7834053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7834056">if</span>&nbsp;<span class="ident" id="7834059">got</span><span class="op" id="7834062">,</span>&nbsp;<span class="ident" id="7834064">want</span>&nbsp;<span class="op" id="7834069">:=</span>&nbsp;<span class="ident" id="7834072">r</span><span class="op" id="7834073">.</span><span class="ident" id="7834074">needsSniff</span><span class="op" id="7834084">(</span><span class="op" id="7834085">)</span><span class="op" id="7834086">,</span>&nbsp;<span class="builtintype" id="7834088">true</span><span class="op" id="7834092">;</span>&nbsp;<span class="ident" id="7834094">got</span>&nbsp;<span class="op" id="7834098">!=</span>&nbsp;<span class="ident" id="7834101">want</span>&nbsp;<span class="op" id="7834106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834110">t</span><span class="op" id="7834111">.</span><span class="ident" id="7834112">Errorf</span><span class="op" id="7834118">(</span><span class="string" id="7834119">&#34;needsSniff&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="7834145">,</span>&nbsp;<span class="ident" id="7834147">got</span><span class="op" id="7834150">,</span>&nbsp;<span class="ident" id="7834152">want</span><span class="op" id="7834156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7834159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7834162">//&nbsp;needsSniff&nbsp;returns&nbsp;false&nbsp;when&nbsp;Content-Type&nbsp;=&nbsp;nil.</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834216">r</span><span class="op" id="7834217">.</span><span class="ident" id="7834218">handlerHeader</span>&nbsp;<span class="op" id="7834232">=</span>&nbsp;<span class="ident" id="7834234">Header</span><span class="op" id="7834240">{</span><span class="string" id="7834241">&#34;Content-Type&#34;</span><span class="op" id="7834255">:</span>&nbsp;<span class="ident" id="7834257">nil</span><span class="op" id="7834260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7834263">if</span>&nbsp;<span class="ident" id="7834266">got</span><span class="op" id="7834269">,</span>&nbsp;<span class="ident" id="7834271">want</span>&nbsp;<span class="op" id="7834276">:=</span>&nbsp;<span class="ident" id="7834279">r</span><span class="op" id="7834280">.</span><span class="ident" id="7834281">needsSniff</span><span class="op" id="7834291">(</span><span class="op" id="7834292">)</span><span class="op" id="7834293">,</span>&nbsp;<span class="builtintype" id="7834295">false</span><span class="op" id="7834300">;</span>&nbsp;<span class="ident" id="7834302">got</span>&nbsp;<span class="op" id="7834306">!=</span>&nbsp;<span class="ident" id="7834309">want</span>&nbsp;<span class="op" id="7834314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7834318">t</span><span class="op" id="7834319">.</span><span class="ident" id="7834320">Errorf</span><span class="op" id="7834326">(</span><span class="string" id="7834327">&#34;needsSniff&nbsp;empty&nbsp;Content-Type&nbsp;=&nbsp;%t;&nbsp;want&nbsp;%t&#34;</span><span class="op" id="7834372">,</span>&nbsp;<span class="ident" id="7834374">got</span><span class="op" id="7834377">,</span>&nbsp;<span class="ident" id="7834379">want</span><span class="op" id="7834383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7834386">}</span><br>
<span class="lineno"></span><span class="op" id="7834388">}</span>
</div>
</body>
</html>
