<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/scanner</h2>
<ul>
<li><a href="/gostd/text/scanner/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/text/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4851061">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4851116">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4851170">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4851221">//&nbsp;Package&nbsp;scanner&nbsp;provides&nbsp;a&nbsp;scanner&nbsp;and&nbsp;tokenizer&nbsp;for&nbsp;UTF-8-encoded&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="4851297">//&nbsp;It&nbsp;takes&nbsp;an&nbsp;io.Reader&nbsp;providing&nbsp;the&nbsp;source,&nbsp;which&nbsp;then&nbsp;can&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="4851372">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;function.&nbsp;&nbsp;For&nbsp;compatibility&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4851444">//&nbsp;existing&nbsp;tools,&nbsp;the&nbsp;NUL&nbsp;character&nbsp;is&nbsp;not&nbsp;allowed.&nbsp;If&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="4851520">//&nbsp;in&nbsp;the&nbsp;source&nbsp;is&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;byte&nbsp;order&nbsp;mark&nbsp;(BOM),&nbsp;it&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno">10</span><span class="comment" id="4851596">//</span><br>
<span class="lineno"></span><span class="comment" id="4851599">//&nbsp;By&nbsp;default,&nbsp;a&nbsp;Scanner&nbsp;skips&nbsp;white&nbsp;space&nbsp;and&nbsp;Go&nbsp;comments&nbsp;and&nbsp;recognizes&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="4851677">//&nbsp;literals&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;Go&nbsp;language&nbsp;specification.&nbsp;&nbsp;It&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4851745">//&nbsp;customized&nbsp;to&nbsp;recognize&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;literals&nbsp;and&nbsp;to&nbsp;recognize</span><br>
<span class="lineno"></span><span class="comment" id="4851821">//&nbsp;different&nbsp;identifier&nbsp;and&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno">15</span><span class="comment" id="4851873">//</span><br>
<span class="lineno"></span><span class="comment" id="4851876">//&nbsp;Basic&nbsp;usage&nbsp;pattern:</span><br>
<span class="lineno"></span><span class="comment" id="4851900">//</span><br>
<span class="lineno"></span><span class="comment" id="4851903">//&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;s&nbsp;scanner.Scanner</span><br>
<span class="lineno"></span><span class="comment" id="4851928">//&nbsp;&nbsp;&nbsp;&nbsp;s.Init(src)</span><br>
<span class="lineno">20</span><span class="comment" id="4851943">//&nbsp;&nbsp;&nbsp;&nbsp;tok&nbsp;:=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="4851962">//&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;tok&nbsp;!=&nbsp;scanner.EOF&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4851990">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;do&nbsp;something&nbsp;with&nbsp;tok</span><br>
<span class="lineno"></span><span class="comment" id="4852019">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tok&nbsp;=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="4852038">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno">25</span><span class="comment" id="4852043">//</span><br>
<span class="lineno"></span><span class="keyword" id="4852046">package</span>&nbsp;<span class="ident" id="4852054">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4852063">import</span>&nbsp;<span class="op" id="4852070">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4852073">&#34;bytes&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4852082">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4852089">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4852095">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4852101">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4852112">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">35</span><span class="op" id="4852127">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4852130">//&nbsp;A&nbsp;source&nbsp;position&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="4852187">//&nbsp;A&nbsp;position&nbsp;is&nbsp;valid&nbsp;if&nbsp;Line&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="4852223">type</span>&nbsp;<span class="ident" id="4852228">Position</span>&nbsp;<span class="keyword" id="4852237">struct</span>&nbsp;<span class="op" id="4852244">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852247">Filename</span>&nbsp;<span class="builtintype" id="4852256">string</span>&nbsp;<span class="comment" id="4852263">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852284">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4852293">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4852300">//&nbsp;byte&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852331">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4852340">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4852347">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852378">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4852387">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4852394">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count&nbsp;per&nbsp;line)</span><br>
<span class="lineno"></span><span class="op" id="4852453">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="4852456">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="4852506">func</span>&nbsp;<span class="op" id="4852511">(</span><span class="ident" id="4852512">pos</span>&nbsp;<span class="op" id="4852516">*</span><span class="ident" id="4852517">Position</span><span class="op" id="4852525">)</span>&nbsp;<span class="ident" id="4852527">IsValid</span><span class="op" id="4852534">(</span><span class="op" id="4852535">)</span>&nbsp;<span class="builtintype" id="4852537">bool</span>&nbsp;<span class="op" id="4852542">{</span>&nbsp;<span class="keyword" id="4852544">return</span>&nbsp;<span class="ident" id="4852551">pos</span><span class="op" id="4852554">.</span><span class="ident" id="4852555">Line</span>&nbsp;<span class="op" id="4852560">&gt;</span>&nbsp;<span class="num" id="4852562">0</span>&nbsp;<span class="op" id="4852564">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4852567">func</span>&nbsp;<span class="op" id="4852572">(</span><span class="ident" id="4852573">pos</span>&nbsp;<span class="ident" id="4852577">Position</span><span class="op" id="4852585">)</span>&nbsp;<span class="ident" id="4852587">String</span><span class="op" id="4852593">(</span><span class="op" id="4852594">)</span>&nbsp;<span class="builtintype" id="4852596">string</span>&nbsp;<span class="op" id="4852603">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852606">s</span>&nbsp;<span class="op" id="4852608">:=</span>&nbsp;<span class="ident" id="4852611">pos</span><span class="op" id="4852614">.</span><span class="ident" id="4852615">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4852625">if</span>&nbsp;<span class="ident" id="4852628">pos</span><span class="op" id="4852631">.</span><span class="ident" id="4852632">IsValid</span><span class="op" id="4852639">(</span><span class="op" id="4852640">)</span>&nbsp;<span class="op" id="4852642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4852646">if</span>&nbsp;<span class="ident" id="4852649">s</span>&nbsp;<span class="op" id="4852651">!=</span>&nbsp;<span class="string" id="4852654">&#34;&#34;</span>&nbsp;<span class="op" id="4852657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852662">s</span>&nbsp;<span class="op" id="4852664">+=</span>&nbsp;<span class="string" id="4852667">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4852673">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852677">s</span>&nbsp;<span class="op" id="4852679">+=</span>&nbsp;<span class="ident" id="4852682">fmt</span><span class="op" id="4852685">.</span><span class="ident" id="4852686">Sprintf</span><span class="op" id="4852693">(</span><span class="string" id="4852694">&#34;%d:%d&#34;</span><span class="op" id="4852701">,</span>&nbsp;<span class="ident" id="4852703">pos</span><span class="op" id="4852706">.</span><span class="ident" id="4852707">Line</span><span class="op" id="4852711">,</span>&nbsp;<span class="ident" id="4852713">pos</span><span class="op" id="4852716">.</span><span class="ident" id="4852717">Column</span><span class="op" id="4852723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4852726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4852729">if</span>&nbsp;<span class="ident" id="4852732">s</span>&nbsp;<span class="op" id="4852734">==</span>&nbsp;<span class="string" id="4852737">&#34;&#34;</span>&nbsp;<span class="op" id="4852740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4852744">s</span>&nbsp;<span class="op" id="4852746">=</span>&nbsp;<span class="string" id="4852748">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4852755">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4852758">return</span>&nbsp;<span class="ident" id="4852765">s</span><br>
<span class="lineno"></span><span class="op" id="4852767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4852770">//&nbsp;Predefined&nbsp;mode&nbsp;bits&nbsp;to&nbsp;control&nbsp;recognition&nbsp;of&nbsp;tokens.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span><span class="comment" id="4852842">//&nbsp;to&nbsp;configure&nbsp;a&nbsp;Scanner&nbsp;such&nbsp;that&nbsp;it&nbsp;only&nbsp;recognizes&nbsp;(Go)&nbsp;identifiers,</span><br>
<span class="lineno">65</span><span class="comment" id="4852915">//&nbsp;integers,&nbsp;and&nbsp;skips&nbsp;comments,&nbsp;set&nbsp;the&nbsp;Scanner&#39;s&nbsp;Mode&nbsp;field&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment" id="4852981">//</span><br>
<span class="lineno"></span><span class="comment" id="4852984">//&nbsp;&nbsp;&nbsp;&nbsp;ScanIdents&nbsp;|&nbsp;ScanInts&nbsp;|&nbsp;SkipComments</span><br>
<span class="lineno"></span><span class="comment" id="4853024">//</span><br>
<span class="lineno"></span><span class="comment" id="4853027">//&nbsp;With&nbsp;the&nbsp;exceptions&nbsp;of&nbsp;comments,&nbsp;which&nbsp;are&nbsp;skipped&nbsp;if&nbsp;SkipComments&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="4853100">//&nbsp;set,&nbsp;unrecognized&nbsp;tokens&nbsp;are&nbsp;not&nbsp;ignored.&nbsp;Instead,&nbsp;the&nbsp;scanner&nbsp;simply</span><br>
<span class="lineno"></span><span class="comment" id="4853173">//&nbsp;returns&nbsp;the&nbsp;respective&nbsp;individual&nbsp;characters&nbsp;(or&nbsp;possibly&nbsp;sub-tokens).</span><br>
<span class="lineno"></span><span class="comment" id="4853247">//&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;mode&nbsp;is&nbsp;ScanIdents&nbsp;(not&nbsp;ScanStrings),&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="4853320">//&nbsp;&#34;foo&#34;&nbsp;is&nbsp;scanned&nbsp;as&nbsp;the&nbsp;token&nbsp;sequence&nbsp;&#39;&#34;&#39;&nbsp;Ident&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="4853377">//</span><br>
<span class="lineno">75</span><span class="keyword" id="4853380">const</span>&nbsp;<span class="op" id="4853386">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853389">ScanIdents</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853404">=</span>&nbsp;<span class="num" id="4853406">1</span>&nbsp;<span class="op" id="4853408">&lt;&lt;</span>&nbsp;<span class="op" id="4853411">-</span><span class="ident" id="4853412">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853419">ScanInts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853434">=</span>&nbsp;<span class="num" id="4853436">1</span>&nbsp;<span class="op" id="4853438">&lt;&lt;</span>&nbsp;<span class="op" id="4853441">-</span><span class="ident" id="4853442">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853447">ScanFloats</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853462">=</span>&nbsp;<span class="num" id="4853464">1</span>&nbsp;<span class="op" id="4853466">&lt;&lt;</span>&nbsp;<span class="op" id="4853469">-</span><span class="ident" id="4853470">Float</span>&nbsp;<span class="comment" id="4853476">//&nbsp;includes&nbsp;Ints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853494">ScanChars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853509">=</span>&nbsp;<span class="num" id="4853511">1</span>&nbsp;<span class="op" id="4853513">&lt;&lt;</span>&nbsp;<span class="op" id="4853516">-</span><span class="ident" id="4853517">Char</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853523">ScanStrings</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853538">=</span>&nbsp;<span class="num" id="4853540">1</span>&nbsp;<span class="op" id="4853542">&lt;&lt;</span>&nbsp;<span class="op" id="4853545">-</span><span class="ident" id="4853546">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853554">ScanRawStrings</span>&nbsp;<span class="op" id="4853569">=</span>&nbsp;<span class="num" id="4853571">1</span>&nbsp;<span class="op" id="4853573">&lt;&lt;</span>&nbsp;<span class="op" id="4853576">-</span><span class="ident" id="4853577">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853588">ScanComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4853603">=</span>&nbsp;<span class="num" id="4853605">1</span>&nbsp;<span class="op" id="4853607">&lt;&lt;</span>&nbsp;<span class="op" id="4853610">-</span><span class="ident" id="4853611">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853620">SkipComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4853635">=</span>&nbsp;<span class="num" id="4853637">1</span>&nbsp;<span class="op" id="4853639">&lt;&lt;</span>&nbsp;<span class="op" id="4853642">-</span><span class="ident" id="4853643">skipComment</span>&nbsp;<span class="comment" id="4853655">//&nbsp;if&nbsp;set&nbsp;with&nbsp;ScanComments,&nbsp;comments&nbsp;become&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853713">GoTokens</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4853728">=</span>&nbsp;<span class="ident" id="4853730">ScanIdents</span>&nbsp;<span class="op" id="4853741">|</span>&nbsp;<span class="ident" id="4853743">ScanFloats</span>&nbsp;<span class="op" id="4853754">|</span>&nbsp;<span class="ident" id="4853756">ScanChars</span>&nbsp;<span class="op" id="4853766">|</span>&nbsp;<span class="ident" id="4853768">ScanStrings</span>&nbsp;<span class="op" id="4853780">|</span>&nbsp;<span class="ident" id="4853782">ScanRawStrings</span>&nbsp;<span class="op" id="4853797">|</span>&nbsp;<span class="ident" id="4853799">ScanComments</span>&nbsp;<span class="op" id="4853812">|</span>&nbsp;<span class="ident" id="4853814">SkipComments</span><br>
<span class="lineno">85</span><span class="op" id="4853827">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4853830">//&nbsp;The&nbsp;result&nbsp;of&nbsp;Scan&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;tokens&nbsp;or&nbsp;a&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="4853907">const</span>&nbsp;<span class="op" id="4853913">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853916">EOF</span>&nbsp;<span class="op" id="4853920">=</span>&nbsp;<span class="op" id="4853922">-</span><span class="op" id="4853923">(</span><span class="ident" id="4853924">iota</span>&nbsp;<span class="op" id="4853929">+</span>&nbsp;<span class="num" id="4853931">1</span><span class="op" id="4853932">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853935">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853942">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853947">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853954">Char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853960">String</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853968">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853979">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4853988">skipComment</span><br>
<span class="lineno"></span><span class="op" id="4854000">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="4854003">var</span>&nbsp;<span class="ident" id="4854007">tokenString</span>&nbsp;<span class="op" id="4854019">=</span>&nbsp;<span class="keyword" id="4854021">map</span><span class="op" id="4854024">[</span><span class="builtintype" id="4854025">rune</span><span class="op" id="4854029">]</span><span class="builtintype" id="4854030">string</span><span class="op" id="4854036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854039">EOF</span><span class="op" id="4854042">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4854050">&#34;EOF&#34;</span><span class="op" id="4854055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854058">Ident</span><span class="op" id="4854063">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4854069">&#34;Ident&#34;</span><span class="op" id="4854076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854079">Int</span><span class="op" id="4854082">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4854090">&#34;Int&#34;</span><span class="op" id="4854095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854098">Float</span><span class="op" id="4854103">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4854109">&#34;Float&#34;</span><span class="op" id="4854116">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854119">Char</span><span class="op" id="4854123">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4854130">&#34;Char&#34;</span><span class="op" id="4854136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854139">String</span><span class="op" id="4854145">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4854150">&#34;String&#34;</span><span class="op" id="4854158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854161">RawString</span><span class="op" id="4854170">:</span>&nbsp;<span class="string" id="4854172">&#34;RawString&#34;</span><span class="op" id="4854183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854186">Comment</span><span class="op" id="4854193">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4854197">&#34;Comment&#34;</span><span class="op" id="4854206">,</span><br>
<span class="lineno"></span><span class="op" id="4854208">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="4854211">//&nbsp;TokenString&nbsp;returns&nbsp;a&nbsp;printable&nbsp;string&nbsp;for&nbsp;a&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="4854287">func</span>&nbsp;<span class="ident" id="4854292">TokenString</span><span class="op" id="4854303">(</span><span class="ident" id="4854304">tok</span>&nbsp;<span class="builtintype" id="4854308">rune</span><span class="op" id="4854312">)</span>&nbsp;<span class="builtintype" id="4854314">string</span>&nbsp;<span class="op" id="4854321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4854324">if</span>&nbsp;<span class="ident" id="4854327">s</span><span class="op" id="4854328">,</span>&nbsp;<span class="ident" id="4854330">found</span>&nbsp;<span class="op" id="4854336">:=</span>&nbsp;<span class="ident" id="4854339">tokenString</span><span class="op" id="4854350">[</span><span class="ident" id="4854351">tok</span><span class="op" id="4854354">]</span><span class="op" id="4854355">;</span>&nbsp;<span class="ident" id="4854357">found</span>&nbsp;<span class="op" id="4854363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4854367">return</span>&nbsp;<span class="ident" id="4854374">s</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4854377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4854380">return</span>&nbsp;<span class="ident" id="4854387">fmt</span><span class="op" id="4854390">.</span><span class="ident" id="4854391">Sprintf</span><span class="op" id="4854398">(</span><span class="string" id="4854399">&#34;%q&#34;</span><span class="op" id="4854403">,</span>&nbsp;<span class="builtintype" id="4854405">string</span><span class="op" id="4854411">(</span><span class="ident" id="4854412">tok</span><span class="op" id="4854415">)</span><span class="op" id="4854416">)</span><br>
<span class="lineno"></span><span class="op" id="4854418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4854421">//&nbsp;GoWhitespace&nbsp;is&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;Scanner&#39;s&nbsp;Whitespace&nbsp;field.</span><br>
<span class="lineno">120</span><span class="comment" id="4854494">//&nbsp;Its&nbsp;value&nbsp;selects&nbsp;Go&#39;s&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="4854544">const</span>&nbsp;<span class="ident" id="4854550">GoWhitespace</span>&nbsp;<span class="op" id="4854563">=</span>&nbsp;<span class="num" id="4854565">1</span><span class="op" id="4854566">&lt;&lt;</span><span class="string" id="4854568">&#39;\t&#39;</span>&nbsp;<span class="op" id="4854573">|</span>&nbsp;<span class="num" id="4854575">1</span><span class="op" id="4854576">&lt;&lt;</span><span class="string" id="4854578">&#39;\n&#39;</span>&nbsp;<span class="op" id="4854583">|</span>&nbsp;<span class="num" id="4854585">1</span><span class="op" id="4854586">&lt;&lt;</span><span class="string" id="4854588">&#39;\r&#39;</span>&nbsp;<span class="op" id="4854593">|</span>&nbsp;<span class="num" id="4854595">1</span><span class="op" id="4854596">&lt;&lt;</span><span class="string" id="4854598">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4854603">const</span>&nbsp;<span class="ident" id="4854609">bufLen</span>&nbsp;<span class="op" id="4854616">=</span>&nbsp;<span class="num" id="4854618">1024</span>&nbsp;<span class="comment" id="4854623">//&nbsp;at&nbsp;least&nbsp;utf8.UTFMax</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4854648">//&nbsp;A&nbsp;Scanner&nbsp;implements&nbsp;reading&nbsp;of&nbsp;Unicode&nbsp;characters&nbsp;and&nbsp;tokens&nbsp;from&nbsp;an&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="4854732">type</span>&nbsp;<span class="ident" id="4854737">Scanner</span>&nbsp;<span class="keyword" id="4854745">struct</span>&nbsp;<span class="op" id="4854752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4854755">//&nbsp;Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854765">src</span>&nbsp;<span class="ident" id="4854769">io</span><span class="op" id="4854771">.</span><span class="ident" id="4854772">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4854781">//&nbsp;Source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854799">srcBuf</span>&nbsp;<span class="op" id="4854806">[</span><span class="ident" id="4854807">bufLen</span>&nbsp;<span class="op" id="4854814">+</span>&nbsp;<span class="num" id="4854816">1</span><span class="op" id="4854817">]</span><span class="builtintype" id="4854818">byte</span>&nbsp;<span class="comment" id="4854823">//&nbsp;+1&nbsp;for&nbsp;sentinel&nbsp;for&nbsp;common&nbsp;case&nbsp;of&nbsp;s.next()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854871">srcPos</span>&nbsp;<span class="builtintype" id="4854878">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4854895">//&nbsp;reading&nbsp;position&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4854931">srcEnd</span>&nbsp;<span class="builtintype" id="4854938">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4854955">//&nbsp;source&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4854986">//&nbsp;Source&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855006">srcBufOffset</span>&nbsp;<span class="builtintype" id="4855019">int</span>&nbsp;<span class="comment" id="4855023">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;srcBuf[0]&nbsp;in&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855062">line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4855075">int</span>&nbsp;<span class="comment" id="4855079">//&nbsp;line&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855094">column</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4855107">int</span>&nbsp;<span class="comment" id="4855111">//&nbsp;character&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855131">lastLineLen</span>&nbsp;&nbsp;<span class="builtintype" id="4855144">int</span>&nbsp;<span class="comment" id="4855148">//&nbsp;length&nbsp;of&nbsp;last&nbsp;line&nbsp;in&nbsp;characters&nbsp;(for&nbsp;correct&nbsp;column&nbsp;reporting)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855217">lastCharLen</span>&nbsp;&nbsp;<span class="builtintype" id="4855230">int</span>&nbsp;<span class="comment" id="4855234">//&nbsp;length&nbsp;of&nbsp;last&nbsp;character&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4855273">//&nbsp;Token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4855295">//&nbsp;Typically,&nbsp;token&nbsp;text&nbsp;is&nbsp;stored&nbsp;completely&nbsp;in&nbsp;srcBuf,&nbsp;but&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4855368">//&nbsp;the&nbsp;token&nbsp;text&#39;s&nbsp;head&nbsp;may&nbsp;be&nbsp;buffered&nbsp;in&nbsp;tokBuf&nbsp;while&nbsp;the&nbsp;token&nbsp;text&#39;s</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4855443">//&nbsp;tail&nbsp;is&nbsp;stored&nbsp;in&nbsp;srcBuf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855473">tokBuf</span>&nbsp;<span class="ident" id="4855480">bytes</span><span class="op" id="4855485">.</span><span class="ident" id="4855486">Buffer</span>&nbsp;<span class="comment" id="4855493">//&nbsp;token&nbsp;text&nbsp;head&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;srcBuf&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855543">tokPos</span>&nbsp;<span class="builtintype" id="4855550">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4855563">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;position&nbsp;(srcBuf&nbsp;index);&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855622">tokEnd</span>&nbsp;<span class="builtintype" id="4855629">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4855642">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4855682">//&nbsp;One&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855711">ch</span>&nbsp;<span class="builtintype" id="4855714">rune</span>&nbsp;<span class="comment" id="4855719">//&nbsp;character&nbsp;before&nbsp;current&nbsp;srcPos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4855756">//&nbsp;Error&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.&nbsp;If&nbsp;no&nbsp;Error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4855816">//&nbsp;function&nbsp;is&nbsp;set,&nbsp;the&nbsp;error&nbsp;is&nbsp;reported&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855873">Error</span>&nbsp;<span class="keyword" id="4855879">func</span><span class="op" id="4855883">(</span><span class="ident" id="4855884">s</span>&nbsp;<span class="op" id="4855886">*</span><span class="ident" id="4855887">Scanner</span><span class="op" id="4855894">,</span>&nbsp;<span class="ident" id="4855896">msg</span>&nbsp;<span class="builtintype" id="4855900">string</span><span class="op" id="4855906">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4855910">//&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4855975">ErrorCount</span>&nbsp;<span class="builtintype" id="4855986">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4855992">//&nbsp;The&nbsp;Mode&nbsp;field&nbsp;controls&nbsp;which&nbsp;tokens&nbsp;are&nbsp;recognized.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856063">//&nbsp;to&nbsp;recognize&nbsp;Ints,&nbsp;set&nbsp;the&nbsp;ScanInts&nbsp;bit&nbsp;in&nbsp;Mode.&nbsp;The&nbsp;field&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856133">//&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856158">Mode</span>&nbsp;<span class="builtintype" id="4856163">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856170">//&nbsp;The&nbsp;Whitespace&nbsp;field&nbsp;controls&nbsp;which&nbsp;characters&nbsp;are&nbsp;recognized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856236">//&nbsp;as&nbsp;white&nbsp;space.&nbsp;To&nbsp;recognize&nbsp;a&nbsp;character&nbsp;ch&nbsp;&lt;=&nbsp;&#39;&nbsp;&#39;&nbsp;as&nbsp;white&nbsp;space,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856307">//&nbsp;set&nbsp;the&nbsp;ch&#39;th&nbsp;bit&nbsp;in&nbsp;Whitespace&nbsp;(the&nbsp;Scanner&#39;s&nbsp;behavior&nbsp;is&nbsp;undefined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856380">//&nbsp;for&nbsp;values&nbsp;ch&nbsp;&gt;&nbsp;&#39;&nbsp;&#39;).&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856444">Whitespace</span>&nbsp;<span class="ident" id="4856455">uint64</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856464">//&nbsp;IsIdentRune&nbsp;is&nbsp;a&nbsp;predicate&nbsp;controlling&nbsp;the&nbsp;characters&nbsp;accepted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856531">//&nbsp;as&nbsp;the&nbsp;ith&nbsp;rune&nbsp;in&nbsp;an&nbsp;identifier.&nbsp;The&nbsp;set&nbsp;of&nbsp;valid&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856597">//&nbsp;must&nbsp;not&nbsp;intersect&nbsp;with&nbsp;the&nbsp;set&nbsp;of&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856660">//&nbsp;If&nbsp;no&nbsp;IsIdentRune&nbsp;function&nbsp;is&nbsp;set,&nbsp;regular&nbsp;Go&nbsp;identifiers&nbsp;are</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856726">//&nbsp;accepted&nbsp;instead.&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4856786">IsIdentRune</span>&nbsp;<span class="keyword" id="4856798">func</span><span class="op" id="4856802">(</span><span class="ident" id="4856803">ch</span>&nbsp;<span class="builtintype" id="4856806">rune</span><span class="op" id="4856810">,</span>&nbsp;<span class="ident" id="4856812">i</span>&nbsp;<span class="builtintype" id="4856814">int</span><span class="op" id="4856817">)</span>&nbsp;<span class="builtintype" id="4856819">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856826">//&nbsp;Start&nbsp;position&nbsp;of&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token;&nbsp;set&nbsp;by&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856890">//&nbsp;Calling&nbsp;Init&nbsp;or&nbsp;Next&nbsp;invalidates&nbsp;the&nbsp;position&nbsp;(Line&nbsp;==&nbsp;0).</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4856953">//&nbsp;The&nbsp;Filename&nbsp;field&nbsp;is&nbsp;always&nbsp;left&nbsp;untouched&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4857017">//&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;reported&nbsp;(via&nbsp;Error)&nbsp;and&nbsp;Position&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4857082">//&nbsp;the&nbsp;scanner&nbsp;is&nbsp;not&nbsp;inside&nbsp;a&nbsp;token.&nbsp;Call&nbsp;Pos&nbsp;to&nbsp;obtain&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4857149">//&nbsp;position&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857176">Position</span><br>
<span class="lineno">185</span><span class="op" id="4857185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4857188">//&nbsp;Init&nbsp;initializes&nbsp;a&nbsp;Scanner&nbsp;with&nbsp;a&nbsp;new&nbsp;source&nbsp;and&nbsp;returns&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="4857251">//&nbsp;Error&nbsp;is&nbsp;set&nbsp;to&nbsp;nil,&nbsp;ErrorCount&nbsp;is&nbsp;set&nbsp;to&nbsp;0,&nbsp;Mode&nbsp;is&nbsp;set&nbsp;to&nbsp;GoTokens,</span><br>
<span class="lineno"></span><span class="comment" id="4857324">//&nbsp;and&nbsp;Whitespace&nbsp;is&nbsp;set&nbsp;to&nbsp;GoWhitespace.</span><br>
<span class="lineno">190</span><span class="keyword" id="4857366">func</span>&nbsp;<span class="op" id="4857371">(</span><span class="ident" id="4857372">s</span>&nbsp;<span class="op" id="4857374">*</span><span class="ident" id="4857375">Scanner</span><span class="op" id="4857382">)</span>&nbsp;<span class="ident" id="4857384">Init</span><span class="op" id="4857388">(</span><span class="ident" id="4857389">src</span>&nbsp;<span class="ident" id="4857393">io</span><span class="op" id="4857395">.</span><span class="ident" id="4857396">Reader</span><span class="op" id="4857402">)</span>&nbsp;<span class="op" id="4857404">*</span><span class="ident" id="4857405">Scanner</span>&nbsp;<span class="op" id="4857413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857416">s</span><span class="op" id="4857417">.</span><span class="ident" id="4857418">src</span>&nbsp;<span class="op" id="4857422">=</span>&nbsp;<span class="ident" id="4857424">src</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4857430">//&nbsp;initialize&nbsp;source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4857459">//&nbsp;(the&nbsp;first&nbsp;call&nbsp;to&nbsp;next()&nbsp;will&nbsp;fill&nbsp;it&nbsp;by&nbsp;calling&nbsp;src.Read)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857523">s</span><span class="op" id="4857524">.</span><span class="ident" id="4857525">srcBuf</span><span class="op" id="4857531">[</span><span class="num" id="4857532">0</span><span class="op" id="4857533">]</span>&nbsp;<span class="op" id="4857535">=</span>&nbsp;<span class="ident" id="4857537">utf8</span><span class="op" id="4857541">.</span><span class="ident" id="4857542">RuneSelf</span>&nbsp;<span class="comment" id="4857551">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857564">s</span><span class="op" id="4857565">.</span><span class="ident" id="4857566">srcPos</span>&nbsp;<span class="op" id="4857573">=</span>&nbsp;<span class="num" id="4857575">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857578">s</span><span class="op" id="4857579">.</span><span class="ident" id="4857580">srcEnd</span>&nbsp;<span class="op" id="4857587">=</span>&nbsp;<span class="num" id="4857589">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4857593">//&nbsp;initialize&nbsp;source&nbsp;position</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857624">s</span><span class="op" id="4857625">.</span><span class="ident" id="4857626">srcBufOffset</span>&nbsp;<span class="op" id="4857639">=</span>&nbsp;<span class="num" id="4857641">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857644">s</span><span class="op" id="4857645">.</span><span class="ident" id="4857646">line</span>&nbsp;<span class="op" id="4857651">=</span>&nbsp;<span class="num" id="4857653">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857656">s</span><span class="op" id="4857657">.</span><span class="ident" id="4857658">column</span>&nbsp;<span class="op" id="4857665">=</span>&nbsp;<span class="num" id="4857667">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857670">s</span><span class="op" id="4857671">.</span><span class="ident" id="4857672">lastLineLen</span>&nbsp;<span class="op" id="4857684">=</span>&nbsp;<span class="num" id="4857686">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857689">s</span><span class="op" id="4857690">.</span><span class="ident" id="4857691">lastCharLen</span>&nbsp;<span class="op" id="4857703">=</span>&nbsp;<span class="num" id="4857705">0</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4857709">//&nbsp;initialize&nbsp;token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4857742">//&nbsp;(required&nbsp;for&nbsp;first&nbsp;call&nbsp;to&nbsp;next()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857783">s</span><span class="op" id="4857784">.</span><span class="ident" id="4857785">tokPos</span>&nbsp;<span class="op" id="4857792">=</span>&nbsp;<span class="op" id="4857794">-</span><span class="num" id="4857795">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4857799">//&nbsp;initialize&nbsp;one&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857839">s</span><span class="op" id="4857840">.</span><span class="ident" id="4857841">ch</span>&nbsp;<span class="op" id="4857844">=</span>&nbsp;<span class="op" id="4857846">-</span><span class="num" id="4857847">1</span>&nbsp;<span class="comment" id="4857849">//&nbsp;no&nbsp;char&nbsp;read&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4857871">//&nbsp;initialize&nbsp;public&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857900">s</span><span class="op" id="4857901">.</span><span class="ident" id="4857902">Error</span>&nbsp;<span class="op" id="4857908">=</span>&nbsp;<span class="builtintype" id="4857910">nil</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857915">s</span><span class="op" id="4857916">.</span><span class="ident" id="4857917">ErrorCount</span>&nbsp;<span class="op" id="4857928">=</span>&nbsp;<span class="num" id="4857930">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857933">s</span><span class="op" id="4857934">.</span><span class="ident" id="4857935">Mode</span>&nbsp;<span class="op" id="4857940">=</span>&nbsp;<span class="ident" id="4857942">GoTokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857952">s</span><span class="op" id="4857953">.</span><span class="ident" id="4857954">Whitespace</span>&nbsp;<span class="op" id="4857965">=</span>&nbsp;<span class="ident" id="4857967">GoWhitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4857981">s</span><span class="op" id="4857982">.</span><span class="ident" id="4857983">Line</span>&nbsp;<span class="op" id="4857988">=</span>&nbsp;<span class="num" id="4857990">0</span>&nbsp;<span class="comment" id="4857992">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858023">return</span>&nbsp;<span class="ident" id="4858030">s</span><br>
<span class="lineno"></span><span class="op" id="4858032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4858035">//&nbsp;next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.&nbsp;It&nbsp;is&nbsp;designed&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="4858109">//&nbsp;that&nbsp;only&nbsp;a&nbsp;minimal&nbsp;amount&nbsp;of&nbsp;work&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;common&nbsp;ASCII</span><br>
<span class="lineno">225</span><span class="comment" id="4858184">//&nbsp;case&nbsp;(one&nbsp;test&nbsp;to&nbsp;check&nbsp;for&nbsp;both&nbsp;ASCII&nbsp;and&nbsp;end-of-buffer,&nbsp;and&nbsp;one&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="4858258">//&nbsp;to&nbsp;check&nbsp;for&nbsp;newlines).</span><br>
<span class="lineno"></span><span class="keyword" id="4858285">func</span>&nbsp;<span class="op" id="4858290">(</span><span class="ident" id="4858291">s</span>&nbsp;<span class="op" id="4858293">*</span><span class="ident" id="4858294">Scanner</span><span class="op" id="4858301">)</span>&nbsp;<span class="ident" id="4858303">next</span><span class="op" id="4858307">(</span><span class="op" id="4858308">)</span>&nbsp;<span class="builtintype" id="4858310">rune</span>&nbsp;<span class="op" id="4858315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858318">ch</span><span class="op" id="4858320">,</span>&nbsp;<span class="ident" id="4858322">width</span>&nbsp;<span class="op" id="4858328">:=</span>&nbsp;<span class="builtintype" id="4858331">rune</span><span class="op" id="4858335">(</span><span class="ident" id="4858336">s</span><span class="op" id="4858337">.</span><span class="ident" id="4858338">srcBuf</span><span class="op" id="4858344">[</span><span class="ident" id="4858345">s</span><span class="op" id="4858346">.</span><span class="ident" id="4858347">srcPos</span><span class="op" id="4858353">]</span><span class="op" id="4858354">)</span><span class="op" id="4858355">,</span>&nbsp;<span class="num" id="4858357">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858361">if</span>&nbsp;<span class="ident" id="4858364">ch</span>&nbsp;<span class="op" id="4858367">&gt;=</span>&nbsp;<span class="ident" id="4858370">utf8</span><span class="op" id="4858374">.</span><span class="ident" id="4858375">RuneSelf</span>&nbsp;<span class="op" id="4858384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4858388">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII&nbsp;or&nbsp;not&nbsp;enough&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858438">for</span>&nbsp;<span class="ident" id="4858442">s</span><span class="op" id="4858443">.</span><span class="ident" id="4858444">srcPos</span><span class="op" id="4858450">+</span><span class="ident" id="4858451">utf8</span><span class="op" id="4858455">.</span><span class="ident" id="4858456">UTFMax</span>&nbsp;<span class="op" id="4858463">&gt;</span>&nbsp;<span class="ident" id="4858465">s</span><span class="op" id="4858466">.</span><span class="ident" id="4858467">srcEnd</span>&nbsp;<span class="op" id="4858474">&amp;&amp;</span>&nbsp;<span class="op" id="4858477">!</span><span class="ident" id="4858478">utf8</span><span class="op" id="4858482">.</span><span class="ident" id="4858483">FullRune</span><span class="op" id="4858491">(</span><span class="ident" id="4858492">s</span><span class="op" id="4858493">.</span><span class="ident" id="4858494">srcBuf</span><span class="op" id="4858500">[</span><span class="ident" id="4858501">s</span><span class="op" id="4858502">.</span><span class="ident" id="4858503">srcPos</span><span class="op" id="4858509">:</span><span class="ident" id="4858510">s</span><span class="op" id="4858511">.</span><span class="ident" id="4858512">srcEnd</span><span class="op" id="4858518">]</span><span class="op" id="4858519">)</span>&nbsp;<span class="op" id="4858521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4858526">//&nbsp;not&nbsp;enough&nbsp;bytes:&nbsp;read&nbsp;some&nbsp;more,&nbsp;but&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4858576">//&nbsp;save&nbsp;away&nbsp;token&nbsp;text&nbsp;if&nbsp;any</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4858610">if</span>&nbsp;<span class="ident" id="4858613">s</span><span class="op" id="4858614">.</span><span class="ident" id="4858615">tokPos</span>&nbsp;<span class="op" id="4858622">&gt;=</span>&nbsp;<span class="num" id="4858625">0</span>&nbsp;<span class="op" id="4858627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858633">s</span><span class="op" id="4858634">.</span><span class="ident" id="4858635">tokBuf</span><span class="op" id="4858641">.</span><span class="ident" id="4858642">Write</span><span class="op" id="4858647">(</span><span class="ident" id="4858648">s</span><span class="op" id="4858649">.</span><span class="ident" id="4858650">srcBuf</span><span class="op" id="4858656">[</span><span class="ident" id="4858657">s</span><span class="op" id="4858658">.</span><span class="ident" id="4858659">tokPos</span><span class="op" id="4858665">:</span><span class="ident" id="4858666">s</span><span class="op" id="4858667">.</span><span class="ident" id="4858668">srcPos</span><span class="op" id="4858674">]</span><span class="op" id="4858675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858681">s</span><span class="op" id="4858682">.</span><span class="ident" id="4858683">tokPos</span>&nbsp;<span class="op" id="4858690">=</span>&nbsp;<span class="num" id="4858692">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4858698">//&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;by&nbsp;Scan()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4858730">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4858735">//&nbsp;move&nbsp;unread&nbsp;bytes&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4858782">copy</span><span class="op" id="4858786">(</span><span class="ident" id="4858787">s</span><span class="op" id="4858788">.</span><span class="ident" id="4858789">srcBuf</span><span class="op" id="4858795">[</span><span class="num" id="4858796">0</span><span class="op" id="4858797">:</span><span class="op" id="4858798">]</span><span class="op" id="4858799">,</span>&nbsp;<span class="ident" id="4858801">s</span><span class="op" id="4858802">.</span><span class="ident" id="4858803">srcBuf</span><span class="op" id="4858809">[</span><span class="ident" id="4858810">s</span><span class="op" id="4858811">.</span><span class="ident" id="4858812">srcPos</span><span class="op" id="4858818">:</span><span class="ident" id="4858819">s</span><span class="op" id="4858820">.</span><span class="ident" id="4858821">srcEnd</span><span class="op" id="4858827">]</span><span class="op" id="4858828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4858833">s</span><span class="op" id="4858834">.</span><span class="ident" id="4858835">srcBufOffset</span>&nbsp;<span class="op" id="4858848">+=</span>&nbsp;<span class="ident" id="4858851">s</span><span class="op" id="4858852">.</span><span class="ident" id="4858853">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4858863">//&nbsp;read&nbsp;more&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4858885">//&nbsp;(an&nbsp;io.Reader&nbsp;must&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4858940">//&nbsp;the&nbsp;end&nbsp;of&nbsp;what&nbsp;it&nbsp;is&nbsp;reading&nbsp;-&nbsp;simply&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4858995">//&nbsp;n&nbsp;==&nbsp;0&nbsp;will&nbsp;make&nbsp;this&nbsp;loop&nbsp;retry&nbsp;forever;&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4859051">//&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;reader&nbsp;implementation&nbsp;in&nbsp;that&nbsp;case)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859109">i</span>&nbsp;<span class="op" id="4859111">:=</span>&nbsp;<span class="ident" id="4859114">s</span><span class="op" id="4859115">.</span><span class="ident" id="4859116">srcEnd</span>&nbsp;<span class="op" id="4859123">-</span>&nbsp;<span class="ident" id="4859125">s</span><span class="op" id="4859126">.</span><span class="ident" id="4859127">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859137">n</span><span class="op" id="4859138">,</span>&nbsp;<span class="ident" id="4859140">err</span>&nbsp;<span class="op" id="4859144">:=</span>&nbsp;<span class="ident" id="4859147">s</span><span class="op" id="4859148">.</span><span class="ident" id="4859149">src</span><span class="op" id="4859152">.</span><span class="ident" id="4859153">Read</span><span class="op" id="4859157">(</span><span class="ident" id="4859158">s</span><span class="op" id="4859159">.</span><span class="ident" id="4859160">srcBuf</span><span class="op" id="4859166">[</span><span class="ident" id="4859167">i</span><span class="op" id="4859168">:</span><span class="ident" id="4859169">bufLen</span><span class="op" id="4859175">]</span><span class="op" id="4859176">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859181">s</span><span class="op" id="4859182">.</span><span class="ident" id="4859183">srcPos</span>&nbsp;<span class="op" id="4859190">=</span>&nbsp;<span class="num" id="4859192">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859197">s</span><span class="op" id="4859198">.</span><span class="ident" id="4859199">srcEnd</span>&nbsp;<span class="op" id="4859206">=</span>&nbsp;<span class="ident" id="4859208">i</span>&nbsp;<span class="op" id="4859210">+</span>&nbsp;<span class="ident" id="4859212">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859217">s</span><span class="op" id="4859218">.</span><span class="ident" id="4859219">srcBuf</span><span class="op" id="4859225">[</span><span class="ident" id="4859226">s</span><span class="op" id="4859227">.</span><span class="ident" id="4859228">srcEnd</span><span class="op" id="4859234">]</span>&nbsp;<span class="op" id="4859236">=</span>&nbsp;<span class="ident" id="4859238">utf8</span><span class="op" id="4859242">.</span><span class="ident" id="4859243">RuneSelf</span>&nbsp;<span class="comment" id="4859252">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859267">if</span>&nbsp;<span class="ident" id="4859270">err</span>&nbsp;<span class="op" id="4859274">!=</span>&nbsp;<span class="builtintype" id="4859277">nil</span>&nbsp;<span class="op" id="4859281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859287">if</span>&nbsp;<span class="ident" id="4859290">err</span>&nbsp;<span class="op" id="4859294">!=</span>&nbsp;<span class="ident" id="4859297">io</span><span class="op" id="4859299">.</span><span class="ident" id="4859300">EOF</span>&nbsp;<span class="op" id="4859304">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859311">s</span><span class="op" id="4859312">.</span><span class="builtintype" id="4859313">error</span><span class="op" id="4859318">(</span><span class="ident" id="4859319">err</span><span class="op" id="4859322">.</span><span class="ident" id="4859323">Error</span><span class="op" id="4859328">(</span><span class="op" id="4859329">)</span><span class="op" id="4859330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4859336">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859342">if</span>&nbsp;<span class="ident" id="4859345">s</span><span class="op" id="4859346">.</span><span class="ident" id="4859347">srcEnd</span>&nbsp;<span class="op" id="4859354">==</span>&nbsp;<span class="num" id="4859357">0</span>&nbsp;<span class="op" id="4859359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859366">if</span>&nbsp;<span class="ident" id="4859369">s</span><span class="op" id="4859370">.</span><span class="ident" id="4859371">lastCharLen</span>&nbsp;<span class="op" id="4859383">&gt;</span>&nbsp;<span class="num" id="4859385">0</span>&nbsp;<span class="op" id="4859387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4859395">//&nbsp;previous&nbsp;character&nbsp;was&nbsp;not&nbsp;EOF</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859435">s</span><span class="op" id="4859436">.</span><span class="ident" id="4859437">column</span><span class="op" id="4859443">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4859451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859458">s</span><span class="op" id="4859459">.</span><span class="ident" id="4859460">lastCharLen</span>&nbsp;<span class="op" id="4859472">=</span>&nbsp;<span class="num" id="4859474">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859481">return</span>&nbsp;<span class="ident" id="4859488">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4859496">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4859502">//&nbsp;If&nbsp;err&nbsp;==&nbsp;EOF,&nbsp;we&nbsp;won&#39;t&nbsp;be&nbsp;getting&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4859549">//&nbsp;bytes;&nbsp;break&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;loop.&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4859596">//&nbsp;err&nbsp;is&nbsp;something&nbsp;else,&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4859643">//&nbsp;we&nbsp;can&nbsp;get&nbsp;more&nbsp;bytes;&nbsp;thus&nbsp;also&nbsp;break.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859690">break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4859699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4859703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4859707">//&nbsp;at&nbsp;least&nbsp;one&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859730">ch</span>&nbsp;<span class="op" id="4859733">=</span>&nbsp;<span class="builtintype" id="4859735">rune</span><span class="op" id="4859739">(</span><span class="ident" id="4859740">s</span><span class="op" id="4859741">.</span><span class="ident" id="4859742">srcBuf</span><span class="op" id="4859748">[</span><span class="ident" id="4859749">s</span><span class="op" id="4859750">.</span><span class="ident" id="4859751">srcPos</span><span class="op" id="4859757">]</span><span class="op" id="4859758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859762">if</span>&nbsp;<span class="ident" id="4859765">ch</span>&nbsp;<span class="op" id="4859768">&gt;=</span>&nbsp;<span class="ident" id="4859771">utf8</span><span class="op" id="4859775">.</span><span class="ident" id="4859776">RuneSelf</span>&nbsp;<span class="op" id="4859785">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4859790">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859821">ch</span><span class="op" id="4859823">,</span>&nbsp;<span class="ident" id="4859825">width</span>&nbsp;<span class="op" id="4859831">=</span>&nbsp;<span class="ident" id="4859833">utf8</span><span class="op" id="4859837">.</span><span class="ident" id="4859838">DecodeRune</span><span class="op" id="4859848">(</span><span class="ident" id="4859849">s</span><span class="op" id="4859850">.</span><span class="ident" id="4859851">srcBuf</span><span class="op" id="4859857">[</span><span class="ident" id="4859858">s</span><span class="op" id="4859859">.</span><span class="ident" id="4859860">srcPos</span><span class="op" id="4859866">:</span><span class="ident" id="4859867">s</span><span class="op" id="4859868">.</span><span class="ident" id="4859869">srcEnd</span><span class="op" id="4859875">]</span><span class="op" id="4859876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4859881">if</span>&nbsp;<span class="ident" id="4859884">ch</span>&nbsp;<span class="op" id="4859887">==</span>&nbsp;<span class="ident" id="4859890">utf8</span><span class="op" id="4859894">.</span><span class="ident" id="4859895">RuneError</span>&nbsp;<span class="op" id="4859905">&amp;&amp;</span>&nbsp;<span class="ident" id="4859908">width</span>&nbsp;<span class="op" id="4859914">==</span>&nbsp;<span class="num" id="4859917">1</span>&nbsp;<span class="op" id="4859919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4859925">//&nbsp;advance&nbsp;for&nbsp;correct&nbsp;error&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859967">s</span><span class="op" id="4859968">.</span><span class="ident" id="4859969">srcPos</span>&nbsp;<span class="op" id="4859976">+=</span>&nbsp;<span class="ident" id="4859979">width</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4859989">s</span><span class="op" id="4859990">.</span><span class="ident" id="4859991">lastCharLen</span>&nbsp;<span class="op" id="4860003">=</span>&nbsp;<span class="ident" id="4860005">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860015">s</span><span class="op" id="4860016">.</span><span class="ident" id="4860017">column</span><span class="op" id="4860023">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860030">s</span><span class="op" id="4860031">.</span><span class="builtintype" id="4860032">error</span><span class="op" id="4860037">(</span><span class="string" id="4860038">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="4860062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860068">return</span>&nbsp;<span class="ident" id="4860075">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4860081">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4860085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4860088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4860092">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860104">s</span><span class="op" id="4860105">.</span><span class="ident" id="4860106">srcPos</span>&nbsp;<span class="op" id="4860113">+=</span>&nbsp;<span class="ident" id="4860116">width</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860123">s</span><span class="op" id="4860124">.</span><span class="ident" id="4860125">lastCharLen</span>&nbsp;<span class="op" id="4860137">=</span>&nbsp;<span class="ident" id="4860139">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860146">s</span><span class="op" id="4860147">.</span><span class="ident" id="4860148">column</span><span class="op" id="4860154">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4860159">//&nbsp;special&nbsp;situations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860182">switch</span>&nbsp;<span class="ident" id="4860189">ch</span>&nbsp;<span class="op" id="4860192">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860195">case</span>&nbsp;<span class="num" id="4860200">0</span><span class="op" id="4860201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4860205">//&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860245">s</span><span class="op" id="4860246">.</span><span class="builtintype" id="4860247">error</span><span class="op" id="4860252">(</span><span class="string" id="4860253">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="4860276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860279">case</span>&nbsp;<span class="string" id="4860284">&#39;\n&#39;</span><span class="op" id="4860288">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860292">s</span><span class="op" id="4860293">.</span><span class="ident" id="4860294">line</span><span class="op" id="4860298">++</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860303">s</span><span class="op" id="4860304">.</span><span class="ident" id="4860305">lastLineLen</span>&nbsp;<span class="op" id="4860317">=</span>&nbsp;<span class="ident" id="4860319">s</span><span class="op" id="4860320">.</span><span class="ident" id="4860321">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860330">s</span><span class="op" id="4860331">.</span><span class="ident" id="4860332">column</span>&nbsp;<span class="op" id="4860339">=</span>&nbsp;<span class="num" id="4860341">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4860344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860348">return</span>&nbsp;<span class="ident" id="4860355">ch</span><br>
<span class="lineno">305</span><span class="op" id="4860358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4860361">//&nbsp;Next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="4860415">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports</span><br>
<span class="lineno"></span><span class="comment" id="4860470">//&nbsp;a&nbsp;read&nbsp;error&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise</span><br>
<span class="lineno">310</span><span class="comment" id="4860528">//&nbsp;it&nbsp;prints&nbsp;an&nbsp;error&nbsp;message&nbsp;to&nbsp;os.Stderr.&nbsp;Next&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="4860586">//&nbsp;update&nbsp;the&nbsp;Scanner&#39;s&nbsp;Position&nbsp;field;&nbsp;use&nbsp;Pos()&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4860639">//&nbsp;get&nbsp;the&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="4860668">func</span>&nbsp;<span class="op" id="4860673">(</span><span class="ident" id="4860674">s</span>&nbsp;<span class="op" id="4860676">*</span><span class="ident" id="4860677">Scanner</span><span class="op" id="4860684">)</span>&nbsp;<span class="ident" id="4860686">Next</span><span class="op" id="4860690">(</span><span class="op" id="4860691">)</span>&nbsp;<span class="builtintype" id="4860693">rune</span>&nbsp;<span class="op" id="4860698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860701">s</span><span class="op" id="4860702">.</span><span class="ident" id="4860703">tokPos</span>&nbsp;<span class="op" id="4860710">=</span>&nbsp;<span class="op" id="4860712">-</span><span class="num" id="4860713">1</span>&nbsp;<span class="comment" id="4860715">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860744">s</span><span class="op" id="4860745">.</span><span class="ident" id="4860746">Line</span>&nbsp;<span class="op" id="4860751">=</span>&nbsp;<span class="num" id="4860753">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4860758">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860788">ch</span>&nbsp;<span class="op" id="4860791">:=</span>&nbsp;<span class="ident" id="4860794">s</span><span class="op" id="4860795">.</span><span class="ident" id="4860796">Peek</span><span class="op" id="4860800">(</span><span class="op" id="4860801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4860804">s</span><span class="op" id="4860805">.</span><span class="ident" id="4860806">ch</span>&nbsp;<span class="op" id="4860809">=</span>&nbsp;<span class="ident" id="4860811">s</span><span class="op" id="4860812">.</span><span class="ident" id="4860813">next</span><span class="op" id="4860817">(</span><span class="op" id="4860818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4860821">return</span>&nbsp;<span class="ident" id="4860828">ch</span><br>
<span class="lineno"></span><span class="op" id="4860831">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="4860834">//&nbsp;Peek&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character&nbsp;in&nbsp;the&nbsp;source&nbsp;without&nbsp;advancing</span><br>
<span class="lineno"></span><span class="comment" id="4860909">//&nbsp;the&nbsp;scanner.&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;if&nbsp;the&nbsp;scanner&#39;s&nbsp;position&nbsp;is&nbsp;at&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span><span class="comment" id="4860981">//&nbsp;character&nbsp;of&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="4861009">func</span>&nbsp;<span class="op" id="4861014">(</span><span class="ident" id="4861015">s</span>&nbsp;<span class="op" id="4861017">*</span><span class="ident" id="4861018">Scanner</span><span class="op" id="4861025">)</span>&nbsp;<span class="ident" id="4861027">Peek</span><span class="op" id="4861031">(</span><span class="op" id="4861032">)</span>&nbsp;<span class="builtintype" id="4861034">rune</span>&nbsp;<span class="op" id="4861039">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861042">if</span>&nbsp;<span class="ident" id="4861045">s</span><span class="op" id="4861046">.</span><span class="ident" id="4861047">ch</span>&nbsp;<span class="op" id="4861050">&lt;</span>&nbsp;<span class="num" id="4861052">0</span>&nbsp;<span class="op" id="4861054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4861058">//&nbsp;this&nbsp;code&nbsp;is&nbsp;only&nbsp;run&nbsp;for&nbsp;the&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861114">s</span><span class="op" id="4861115">.</span><span class="ident" id="4861116">ch</span>&nbsp;<span class="op" id="4861119">=</span>&nbsp;<span class="ident" id="4861121">s</span><span class="op" id="4861122">.</span><span class="ident" id="4861123">next</span><span class="op" id="4861127">(</span><span class="op" id="4861128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861132">if</span>&nbsp;<span class="ident" id="4861135">s</span><span class="op" id="4861136">.</span><span class="ident" id="4861137">ch</span>&nbsp;<span class="op" id="4861140">==</span>&nbsp;<span class="string" id="4861143">&#39;\uFEFF&#39;</span>&nbsp;<span class="op" id="4861152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861157">s</span><span class="op" id="4861158">.</span><span class="ident" id="4861159">ch</span>&nbsp;<span class="op" id="4861162">=</span>&nbsp;<span class="ident" id="4861164">s</span><span class="op" id="4861165">.</span><span class="ident" id="4861166">next</span><span class="op" id="4861170">(</span><span class="op" id="4861171">)</span>&nbsp;<span class="comment" id="4861173">//&nbsp;ignore&nbsp;BOM</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4861189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4861192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861195">return</span>&nbsp;<span class="ident" id="4861202">s</span><span class="op" id="4861203">.</span><span class="ident" id="4861204">ch</span><br>
<span class="lineno"></span><span class="op" id="4861207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4861210">func</span>&nbsp;<span class="op" id="4861215">(</span><span class="ident" id="4861216">s</span>&nbsp;<span class="op" id="4861218">*</span><span class="ident" id="4861219">Scanner</span><span class="op" id="4861226">)</span>&nbsp;<span class="builtintype" id="4861228">error</span><span class="op" id="4861233">(</span><span class="ident" id="4861234">msg</span>&nbsp;<span class="builtintype" id="4861238">string</span><span class="op" id="4861244">)</span>&nbsp;<span class="op" id="4861246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861249">s</span><span class="op" id="4861250">.</span><span class="ident" id="4861251">ErrorCount</span><span class="op" id="4861261">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861265">if</span>&nbsp;<span class="ident" id="4861268">s</span><span class="op" id="4861269">.</span><span class="ident" id="4861270">Error</span>&nbsp;<span class="op" id="4861276">!=</span>&nbsp;<span class="builtintype" id="4861279">nil</span>&nbsp;<span class="op" id="4861283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861287">s</span><span class="op" id="4861288">.</span><span class="ident" id="4861289">Error</span><span class="op" id="4861294">(</span><span class="ident" id="4861295">s</span><span class="op" id="4861296">,</span>&nbsp;<span class="ident" id="4861298">msg</span><span class="op" id="4861301">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861305">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4861313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861316">pos</span>&nbsp;<span class="op" id="4861320">:=</span>&nbsp;<span class="ident" id="4861323">s</span><span class="op" id="4861324">.</span><span class="ident" id="4861325">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861335">if</span>&nbsp;<span class="op" id="4861338">!</span><span class="ident" id="4861339">pos</span><span class="op" id="4861342">.</span><span class="ident" id="4861343">IsValid</span><span class="op" id="4861350">(</span><span class="op" id="4861351">)</span>&nbsp;<span class="op" id="4861353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861357">pos</span>&nbsp;<span class="op" id="4861361">=</span>&nbsp;<span class="ident" id="4861363">s</span><span class="op" id="4861364">.</span><span class="ident" id="4861365">Pos</span><span class="op" id="4861368">(</span><span class="op" id="4861369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4861372">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861375">fmt</span><span class="op" id="4861378">.</span><span class="ident" id="4861379">Fprintf</span><span class="op" id="4861386">(</span><span class="ident" id="4861387">os</span><span class="op" id="4861389">.</span><span class="ident" id="4861390">Stderr</span><span class="op" id="4861396">,</span>&nbsp;<span class="string" id="4861398">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="4861408">,</span>&nbsp;<span class="ident" id="4861410">pos</span><span class="op" id="4861413">,</span>&nbsp;<span class="ident" id="4861415">msg</span><span class="op" id="4861418">)</span><br>
<span class="lineno"></span><span class="op" id="4861420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4861423">func</span>&nbsp;<span class="op" id="4861428">(</span><span class="ident" id="4861429">s</span>&nbsp;<span class="op" id="4861431">*</span><span class="ident" id="4861432">Scanner</span><span class="op" id="4861439">)</span>&nbsp;<span class="ident" id="4861441">isIdentRune</span><span class="op" id="4861452">(</span><span class="ident" id="4861453">ch</span>&nbsp;<span class="builtintype" id="4861456">rune</span><span class="op" id="4861460">,</span>&nbsp;<span class="ident" id="4861462">i</span>&nbsp;<span class="builtintype" id="4861464">int</span><span class="op" id="4861467">)</span>&nbsp;<span class="builtintype" id="4861469">bool</span>&nbsp;<span class="op" id="4861474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861477">if</span>&nbsp;<span class="ident" id="4861480">s</span><span class="op" id="4861481">.</span><span class="ident" id="4861482">IsIdentRune</span>&nbsp;<span class="op" id="4861494">!=</span>&nbsp;<span class="builtintype" id="4861497">nil</span>&nbsp;<span class="op" id="4861501">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861505">return</span>&nbsp;<span class="ident" id="4861512">s</span><span class="op" id="4861513">.</span><span class="ident" id="4861514">IsIdentRune</span><span class="op" id="4861525">(</span><span class="ident" id="4861526">ch</span><span class="op" id="4861528">,</span>&nbsp;<span class="ident" id="4861530">i</span><span class="op" id="4861531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4861534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861537">return</span>&nbsp;<span class="ident" id="4861544">ch</span>&nbsp;<span class="op" id="4861547">==</span>&nbsp;<span class="string" id="4861550">&#39;_&#39;</span>&nbsp;<span class="op" id="4861554">||</span>&nbsp;<span class="ident" id="4861557">unicode</span><span class="op" id="4861564">.</span><span class="ident" id="4861565">IsLetter</span><span class="op" id="4861573">(</span><span class="ident" id="4861574">ch</span><span class="op" id="4861576">)</span>&nbsp;<span class="op" id="4861578">||</span>&nbsp;<span class="ident" id="4861581">unicode</span><span class="op" id="4861588">.</span><span class="ident" id="4861589">IsDigit</span><span class="op" id="4861596">(</span><span class="ident" id="4861597">ch</span><span class="op" id="4861599">)</span>&nbsp;<span class="op" id="4861601">&amp;&amp;</span>&nbsp;<span class="ident" id="4861604">i</span>&nbsp;<span class="op" id="4861606">&gt;</span>&nbsp;<span class="num" id="4861608">0</span><br>
<span class="lineno"></span><span class="op" id="4861610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="4861613">func</span>&nbsp;<span class="op" id="4861618">(</span><span class="ident" id="4861619">s</span>&nbsp;<span class="op" id="4861621">*</span><span class="ident" id="4861622">Scanner</span><span class="op" id="4861629">)</span>&nbsp;<span class="ident" id="4861631">scanIdentifier</span><span class="op" id="4861645">(</span><span class="op" id="4861646">)</span>&nbsp;<span class="builtintype" id="4861648">rune</span>&nbsp;<span class="op" id="4861653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4861656">//&nbsp;we&nbsp;know&nbsp;the&nbsp;zero&#39;th&nbsp;rune&nbsp;is&nbsp;OK;&nbsp;start&nbsp;scanning&nbsp;at&nbsp;the&nbsp;next&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861723">ch</span>&nbsp;<span class="op" id="4861726">:=</span>&nbsp;<span class="ident" id="4861729">s</span><span class="op" id="4861730">.</span><span class="ident" id="4861731">next</span><span class="op" id="4861735">(</span><span class="op" id="4861736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861739">for</span>&nbsp;<span class="ident" id="4861743">i</span>&nbsp;<span class="op" id="4861745">:=</span>&nbsp;<span class="num" id="4861748">1</span><span class="op" id="4861749">;</span>&nbsp;<span class="ident" id="4861751">s</span><span class="op" id="4861752">.</span><span class="ident" id="4861753">isIdentRune</span><span class="op" id="4861764">(</span><span class="ident" id="4861765">ch</span><span class="op" id="4861767">,</span>&nbsp;<span class="ident" id="4861769">i</span><span class="op" id="4861770">)</span><span class="op" id="4861771">;</span>&nbsp;<span class="ident" id="4861773">i</span><span class="op" id="4861774">++</span>&nbsp;<span class="op" id="4861777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4861781">ch</span>&nbsp;<span class="op" id="4861784">=</span>&nbsp;<span class="ident" id="4861786">s</span><span class="op" id="4861787">.</span><span class="ident" id="4861788">next</span><span class="op" id="4861792">(</span><span class="op" id="4861793">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4861796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861799">return</span>&nbsp;<span class="ident" id="4861806">ch</span><br>
<span class="lineno"></span><span class="op" id="4861809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4861812">func</span>&nbsp;<span class="ident" id="4861817">digitVal</span><span class="op" id="4861825">(</span><span class="ident" id="4861826">ch</span>&nbsp;<span class="builtintype" id="4861829">rune</span><span class="op" id="4861833">)</span>&nbsp;<span class="builtintype" id="4861835">int</span>&nbsp;<span class="op" id="4861839">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861842">switch</span>&nbsp;<span class="op" id="4861849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861852">case</span>&nbsp;<span class="string" id="4861857">&#39;0&#39;</span>&nbsp;<span class="op" id="4861861">&lt;=</span>&nbsp;<span class="ident" id="4861864">ch</span>&nbsp;<span class="op" id="4861867">&amp;&amp;</span>&nbsp;<span class="ident" id="4861870">ch</span>&nbsp;<span class="op" id="4861873">&lt;=</span>&nbsp;<span class="string" id="4861876">&#39;9&#39;</span><span class="op" id="4861879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861883">return</span>&nbsp;<span class="builtintype" id="4861890">int</span><span class="op" id="4861893">(</span><span class="ident" id="4861894">ch</span>&nbsp;<span class="op" id="4861897">-</span>&nbsp;<span class="string" id="4861899">&#39;0&#39;</span><span class="op" id="4861902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861905">case</span>&nbsp;<span class="string" id="4861910">&#39;a&#39;</span>&nbsp;<span class="op" id="4861914">&lt;=</span>&nbsp;<span class="ident" id="4861917">ch</span>&nbsp;<span class="op" id="4861920">&amp;&amp;</span>&nbsp;<span class="ident" id="4861923">ch</span>&nbsp;<span class="op" id="4861926">&lt;=</span>&nbsp;<span class="string" id="4861929">&#39;f&#39;</span><span class="op" id="4861932">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861936">return</span>&nbsp;<span class="builtintype" id="4861943">int</span><span class="op" id="4861946">(</span><span class="ident" id="4861947">ch</span>&nbsp;<span class="op" id="4861950">-</span>&nbsp;<span class="string" id="4861952">&#39;a&#39;</span>&nbsp;<span class="op" id="4861956">+</span>&nbsp;<span class="num" id="4861958">10</span><span class="op" id="4861960">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861963">case</span>&nbsp;<span class="string" id="4861968">&#39;A&#39;</span>&nbsp;<span class="op" id="4861972">&lt;=</span>&nbsp;<span class="ident" id="4861975">ch</span>&nbsp;<span class="op" id="4861978">&amp;&amp;</span>&nbsp;<span class="ident" id="4861981">ch</span>&nbsp;<span class="op" id="4861984">&lt;=</span>&nbsp;<span class="string" id="4861987">&#39;F&#39;</span><span class="op" id="4861990">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4861994">return</span>&nbsp;<span class="builtintype" id="4862001">int</span><span class="op" id="4862004">(</span><span class="ident" id="4862005">ch</span>&nbsp;<span class="op" id="4862008">-</span>&nbsp;<span class="string" id="4862010">&#39;A&#39;</span>&nbsp;<span class="op" id="4862014">+</span>&nbsp;<span class="num" id="4862016">10</span><span class="op" id="4862018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862024">return</span>&nbsp;<span class="num" id="4862031">16</span>&nbsp;<span class="comment" id="4862034">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="4862069">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="4862072">func</span>&nbsp;<span class="ident" id="4862077">isDecimal</span><span class="op" id="4862086">(</span><span class="ident" id="4862087">ch</span>&nbsp;<span class="builtintype" id="4862090">rune</span><span class="op" id="4862094">)</span>&nbsp;<span class="builtintype" id="4862096">bool</span>&nbsp;<span class="op" id="4862101">{</span>&nbsp;<span class="keyword" id="4862103">return</span>&nbsp;<span class="string" id="4862110">&#39;0&#39;</span>&nbsp;<span class="op" id="4862114">&lt;=</span>&nbsp;<span class="ident" id="4862117">ch</span>&nbsp;<span class="op" id="4862120">&amp;&amp;</span>&nbsp;<span class="ident" id="4862123">ch</span>&nbsp;<span class="op" id="4862126">&lt;=</span>&nbsp;<span class="string" id="4862129">&#39;9&#39;</span>&nbsp;<span class="op" id="4862133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4862136">func</span>&nbsp;<span class="op" id="4862141">(</span><span class="ident" id="4862142">s</span>&nbsp;<span class="op" id="4862144">*</span><span class="ident" id="4862145">Scanner</span><span class="op" id="4862152">)</span>&nbsp;<span class="ident" id="4862154">scanMantissa</span><span class="op" id="4862166">(</span><span class="ident" id="4862167">ch</span>&nbsp;<span class="builtintype" id="4862170">rune</span><span class="op" id="4862174">)</span>&nbsp;<span class="builtintype" id="4862176">rune</span>&nbsp;<span class="op" id="4862181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862184">for</span>&nbsp;<span class="ident" id="4862188">isDecimal</span><span class="op" id="4862197">(</span><span class="ident" id="4862198">ch</span><span class="op" id="4862200">)</span>&nbsp;<span class="op" id="4862202">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862206">ch</span>&nbsp;<span class="op" id="4862209">=</span>&nbsp;<span class="ident" id="4862211">s</span><span class="op" id="4862212">.</span><span class="ident" id="4862213">next</span><span class="op" id="4862217">(</span><span class="op" id="4862218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862224">return</span>&nbsp;<span class="ident" id="4862231">ch</span><br>
<span class="lineno"></span><span class="op" id="4862234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="4862237">func</span>&nbsp;<span class="op" id="4862242">(</span><span class="ident" id="4862243">s</span>&nbsp;<span class="op" id="4862245">*</span><span class="ident" id="4862246">Scanner</span><span class="op" id="4862253">)</span>&nbsp;<span class="ident" id="4862255">scanFraction</span><span class="op" id="4862267">(</span><span class="ident" id="4862268">ch</span>&nbsp;<span class="builtintype" id="4862271">rune</span><span class="op" id="4862275">)</span>&nbsp;<span class="builtintype" id="4862277">rune</span>&nbsp;<span class="op" id="4862282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862285">if</span>&nbsp;<span class="ident" id="4862288">ch</span>&nbsp;<span class="op" id="4862291">==</span>&nbsp;<span class="string" id="4862294">&#39;.&#39;</span>&nbsp;<span class="op" id="4862298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862302">ch</span>&nbsp;<span class="op" id="4862305">=</span>&nbsp;<span class="ident" id="4862307">s</span><span class="op" id="4862308">.</span><span class="ident" id="4862309">scanMantissa</span><span class="op" id="4862321">(</span><span class="ident" id="4862322">s</span><span class="op" id="4862323">.</span><span class="ident" id="4862324">next</span><span class="op" id="4862328">(</span><span class="op" id="4862329">)</span><span class="op" id="4862330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862336">return</span>&nbsp;<span class="ident" id="4862343">ch</span><br>
<span class="lineno">390</span><span class="op" id="4862346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4862349">func</span>&nbsp;<span class="op" id="4862354">(</span><span class="ident" id="4862355">s</span>&nbsp;<span class="op" id="4862357">*</span><span class="ident" id="4862358">Scanner</span><span class="op" id="4862365">)</span>&nbsp;<span class="ident" id="4862367">scanExponent</span><span class="op" id="4862379">(</span><span class="ident" id="4862380">ch</span>&nbsp;<span class="builtintype" id="4862383">rune</span><span class="op" id="4862387">)</span>&nbsp;<span class="builtintype" id="4862389">rune</span>&nbsp;<span class="op" id="4862394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862397">if</span>&nbsp;<span class="ident" id="4862400">ch</span>&nbsp;<span class="op" id="4862403">==</span>&nbsp;<span class="string" id="4862406">&#39;e&#39;</span>&nbsp;<span class="op" id="4862410">||</span>&nbsp;<span class="ident" id="4862413">ch</span>&nbsp;<span class="op" id="4862416">==</span>&nbsp;<span class="string" id="4862419">&#39;E&#39;</span>&nbsp;<span class="op" id="4862423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862427">ch</span>&nbsp;<span class="op" id="4862430">=</span>&nbsp;<span class="ident" id="4862432">s</span><span class="op" id="4862433">.</span><span class="ident" id="4862434">next</span><span class="op" id="4862438">(</span><span class="op" id="4862439">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862443">if</span>&nbsp;<span class="ident" id="4862446">ch</span>&nbsp;<span class="op" id="4862449">==</span>&nbsp;<span class="string" id="4862452">&#39;-&#39;</span>&nbsp;<span class="op" id="4862456">||</span>&nbsp;<span class="ident" id="4862459">ch</span>&nbsp;<span class="op" id="4862462">==</span>&nbsp;<span class="string" id="4862465">&#39;+&#39;</span>&nbsp;<span class="op" id="4862469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862474">ch</span>&nbsp;<span class="op" id="4862477">=</span>&nbsp;<span class="ident" id="4862479">s</span><span class="op" id="4862480">.</span><span class="ident" id="4862481">next</span><span class="op" id="4862485">(</span><span class="op" id="4862486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862494">ch</span>&nbsp;<span class="op" id="4862497">=</span>&nbsp;<span class="ident" id="4862499">s</span><span class="op" id="4862500">.</span><span class="ident" id="4862501">scanMantissa</span><span class="op" id="4862513">(</span><span class="ident" id="4862514">ch</span><span class="op" id="4862516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862519">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862522">return</span>&nbsp;<span class="ident" id="4862529">ch</span><br>
<span class="lineno"></span><span class="op" id="4862532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4862535">func</span>&nbsp;<span class="op" id="4862540">(</span><span class="ident" id="4862541">s</span>&nbsp;<span class="op" id="4862543">*</span><span class="ident" id="4862544">Scanner</span><span class="op" id="4862551">)</span>&nbsp;<span class="ident" id="4862553">scanNumber</span><span class="op" id="4862563">(</span><span class="ident" id="4862564">ch</span>&nbsp;<span class="builtintype" id="4862567">rune</span><span class="op" id="4862571">)</span>&nbsp;<span class="op" id="4862573">(</span><span class="builtintype" id="4862574">rune</span><span class="op" id="4862578">,</span>&nbsp;<span class="builtintype" id="4862580">rune</span><span class="op" id="4862584">)</span>&nbsp;<span class="op" id="4862586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4862589">//&nbsp;isDecimal(ch)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862607">if</span>&nbsp;<span class="ident" id="4862610">ch</span>&nbsp;<span class="op" id="4862613">==</span>&nbsp;<span class="string" id="4862616">&#39;0&#39;</span>&nbsp;<span class="op" id="4862620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4862624">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862642">ch</span>&nbsp;<span class="op" id="4862645">=</span>&nbsp;<span class="ident" id="4862647">s</span><span class="op" id="4862648">.</span><span class="ident" id="4862649">next</span><span class="op" id="4862653">(</span><span class="op" id="4862654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862658">if</span>&nbsp;<span class="ident" id="4862661">ch</span>&nbsp;<span class="op" id="4862664">==</span>&nbsp;<span class="string" id="4862667">&#39;x&#39;</span>&nbsp;<span class="op" id="4862671">||</span>&nbsp;<span class="ident" id="4862674">ch</span>&nbsp;<span class="op" id="4862677">==</span>&nbsp;<span class="string" id="4862680">&#39;X&#39;</span>&nbsp;<span class="op" id="4862684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4862689">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862711">ch</span>&nbsp;<span class="op" id="4862714">=</span>&nbsp;<span class="ident" id="4862716">s</span><span class="op" id="4862717">.</span><span class="ident" id="4862718">next</span><span class="op" id="4862722">(</span><span class="op" id="4862723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862728">hasMantissa</span>&nbsp;<span class="op" id="4862740">:=</span>&nbsp;<span class="builtintype" id="4862743">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862752">for</span>&nbsp;<span class="ident" id="4862756">digitVal</span><span class="op" id="4862764">(</span><span class="ident" id="4862765">ch</span><span class="op" id="4862767">)</span>&nbsp;<span class="op" id="4862769">&lt;</span>&nbsp;<span class="num" id="4862771">16</span>&nbsp;<span class="op" id="4862774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862780">ch</span>&nbsp;<span class="op" id="4862783">=</span>&nbsp;<span class="ident" id="4862785">s</span><span class="op" id="4862786">.</span><span class="ident" id="4862787">next</span><span class="op" id="4862791">(</span><span class="op" id="4862792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862798">hasMantissa</span>&nbsp;<span class="op" id="4862810">=</span>&nbsp;<span class="builtintype" id="4862812">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862825">if</span>&nbsp;<span class="op" id="4862828">!</span><span class="ident" id="4862829">hasMantissa</span>&nbsp;<span class="op" id="4862841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862847">s</span><span class="op" id="4862848">.</span><span class="builtintype" id="4862849">error</span><span class="op" id="4862854">(</span><span class="string" id="4862855">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="4862883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4862892">}</span>&nbsp;<span class="keyword" id="4862894">else</span>&nbsp;<span class="op" id="4862899">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4862904">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862929">has8or9</span>&nbsp;<span class="op" id="4862937">:=</span>&nbsp;<span class="builtintype" id="4862940">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862949">for</span>&nbsp;<span class="ident" id="4862953">isDecimal</span><span class="op" id="4862962">(</span><span class="ident" id="4862963">ch</span><span class="op" id="4862965">)</span>&nbsp;<span class="op" id="4862967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4862973">if</span>&nbsp;<span class="ident" id="4862976">ch</span>&nbsp;<span class="op" id="4862979">&gt;</span>&nbsp;<span class="string" id="4862981">&#39;7&#39;</span>&nbsp;<span class="op" id="4862985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4862992">has8or9</span>&nbsp;<span class="op" id="4863000">=</span>&nbsp;<span class="builtintype" id="4863002">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863017">ch</span>&nbsp;<span class="op" id="4863020">=</span>&nbsp;<span class="ident" id="4863022">s</span><span class="op" id="4863023">.</span><span class="ident" id="4863024">next</span><span class="op" id="4863028">(</span><span class="op" id="4863029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863039">if</span>&nbsp;<span class="ident" id="4863042">s</span><span class="op" id="4863043">.</span><span class="ident" id="4863044">Mode</span><span class="op" id="4863048">&amp;</span><span class="ident" id="4863049">ScanFloats</span>&nbsp;<span class="op" id="4863060">!=</span>&nbsp;<span class="num" id="4863063">0</span>&nbsp;<span class="op" id="4863065">&amp;&amp;</span>&nbsp;<span class="op" id="4863068">(</span><span class="ident" id="4863069">ch</span>&nbsp;<span class="op" id="4863072">==</span>&nbsp;<span class="string" id="4863075">&#39;.&#39;</span>&nbsp;<span class="op" id="4863079">||</span>&nbsp;<span class="ident" id="4863082">ch</span>&nbsp;<span class="op" id="4863085">==</span>&nbsp;<span class="string" id="4863088">&#39;e&#39;</span>&nbsp;<span class="op" id="4863092">||</span>&nbsp;<span class="ident" id="4863095">ch</span>&nbsp;<span class="op" id="4863098">==</span>&nbsp;<span class="string" id="4863101">&#39;E&#39;</span><span class="op" id="4863104">)</span>&nbsp;<span class="op" id="4863106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4863112">//&nbsp;float</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863125">ch</span>&nbsp;<span class="op" id="4863128">=</span>&nbsp;<span class="ident" id="4863130">s</span><span class="op" id="4863131">.</span><span class="ident" id="4863132">scanFraction</span><span class="op" id="4863144">(</span><span class="ident" id="4863145">ch</span><span class="op" id="4863147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863153">ch</span>&nbsp;<span class="op" id="4863156">=</span>&nbsp;<span class="ident" id="4863158">s</span><span class="op" id="4863159">.</span><span class="ident" id="4863160">scanExponent</span><span class="op" id="4863172">(</span><span class="ident" id="4863173">ch</span><span class="op" id="4863175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863181">return</span>&nbsp;<span class="ident" id="4863188">Float</span><span class="op" id="4863193">,</span>&nbsp;<span class="ident" id="4863195">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4863206">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863222">if</span>&nbsp;<span class="ident" id="4863225">has8or9</span>&nbsp;<span class="op" id="4863233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863239">s</span><span class="op" id="4863240">.</span><span class="builtintype" id="4863241">error</span><span class="op" id="4863246">(</span><span class="string" id="4863247">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="4863269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863282">return</span>&nbsp;<span class="ident" id="4863289">Int</span><span class="op" id="4863292">,</span>&nbsp;<span class="ident" id="4863294">ch</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4863301">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863326">ch</span>&nbsp;<span class="op" id="4863329">=</span>&nbsp;<span class="ident" id="4863331">s</span><span class="op" id="4863332">.</span><span class="ident" id="4863333">scanMantissa</span><span class="op" id="4863345">(</span><span class="ident" id="4863346">ch</span><span class="op" id="4863348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863351">if</span>&nbsp;<span class="ident" id="4863354">s</span><span class="op" id="4863355">.</span><span class="ident" id="4863356">Mode</span><span class="op" id="4863360">&amp;</span><span class="ident" id="4863361">ScanFloats</span>&nbsp;<span class="op" id="4863372">!=</span>&nbsp;<span class="num" id="4863375">0</span>&nbsp;<span class="op" id="4863377">&amp;&amp;</span>&nbsp;<span class="op" id="4863380">(</span><span class="ident" id="4863381">ch</span>&nbsp;<span class="op" id="4863384">==</span>&nbsp;<span class="string" id="4863387">&#39;.&#39;</span>&nbsp;<span class="op" id="4863391">||</span>&nbsp;<span class="ident" id="4863394">ch</span>&nbsp;<span class="op" id="4863397">==</span>&nbsp;<span class="string" id="4863400">&#39;e&#39;</span>&nbsp;<span class="op" id="4863404">||</span>&nbsp;<span class="ident" id="4863407">ch</span>&nbsp;<span class="op" id="4863410">==</span>&nbsp;<span class="string" id="4863413">&#39;E&#39;</span><span class="op" id="4863416">)</span>&nbsp;<span class="op" id="4863418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4863422">//&nbsp;float</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863433">ch</span>&nbsp;<span class="op" id="4863436">=</span>&nbsp;<span class="ident" id="4863438">s</span><span class="op" id="4863439">.</span><span class="ident" id="4863440">scanFraction</span><span class="op" id="4863452">(</span><span class="ident" id="4863453">ch</span><span class="op" id="4863455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863459">ch</span>&nbsp;<span class="op" id="4863462">=</span>&nbsp;<span class="ident" id="4863464">s</span><span class="op" id="4863465">.</span><span class="ident" id="4863466">scanExponent</span><span class="op" id="4863478">(</span><span class="ident" id="4863479">ch</span><span class="op" id="4863481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863485">return</span>&nbsp;<span class="ident" id="4863492">Float</span><span class="op" id="4863497">,</span>&nbsp;<span class="ident" id="4863499">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863506">return</span>&nbsp;<span class="ident" id="4863513">Int</span><span class="op" id="4863516">,</span>&nbsp;<span class="ident" id="4863518">ch</span><br>
<span class="lineno">450</span><span class="op" id="4863521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4863524">func</span>&nbsp;<span class="op" id="4863529">(</span><span class="ident" id="4863530">s</span>&nbsp;<span class="op" id="4863532">*</span><span class="ident" id="4863533">Scanner</span><span class="op" id="4863540">)</span>&nbsp;<span class="ident" id="4863542">scanDigits</span><span class="op" id="4863552">(</span><span class="ident" id="4863553">ch</span>&nbsp;<span class="builtintype" id="4863556">rune</span><span class="op" id="4863560">,</span>&nbsp;<span class="ident" id="4863562">base</span><span class="op" id="4863566">,</span>&nbsp;<span class="ident" id="4863568">n</span>&nbsp;<span class="builtintype" id="4863570">int</span><span class="op" id="4863573">)</span>&nbsp;<span class="builtintype" id="4863575">rune</span>&nbsp;<span class="op" id="4863580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863583">for</span>&nbsp;<span class="ident" id="4863587">n</span>&nbsp;<span class="op" id="4863589">&gt;</span>&nbsp;<span class="num" id="4863591">0</span>&nbsp;<span class="op" id="4863593">&amp;&amp;</span>&nbsp;<span class="ident" id="4863596">digitVal</span><span class="op" id="4863604">(</span><span class="ident" id="4863605">ch</span><span class="op" id="4863607">)</span>&nbsp;<span class="op" id="4863609">&lt;</span>&nbsp;<span class="ident" id="4863611">base</span>&nbsp;<span class="op" id="4863616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863620">ch</span>&nbsp;<span class="op" id="4863623">=</span>&nbsp;<span class="ident" id="4863625">s</span><span class="op" id="4863626">.</span><span class="ident" id="4863627">next</span><span class="op" id="4863631">(</span><span class="op" id="4863632">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863636">n</span><span class="op" id="4863637">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863644">if</span>&nbsp;<span class="ident" id="4863647">n</span>&nbsp;<span class="op" id="4863649">&gt;</span>&nbsp;<span class="num" id="4863651">0</span>&nbsp;<span class="op" id="4863653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863657">s</span><span class="op" id="4863658">.</span><span class="builtintype" id="4863659">error</span><span class="op" id="4863664">(</span><span class="string" id="4863665">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="4863686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4863689">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863692">return</span>&nbsp;<span class="ident" id="4863699">ch</span><br>
<span class="lineno"></span><span class="op" id="4863702">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4863705">func</span>&nbsp;<span class="op" id="4863710">(</span><span class="ident" id="4863711">s</span>&nbsp;<span class="op" id="4863713">*</span><span class="ident" id="4863714">Scanner</span><span class="op" id="4863721">)</span>&nbsp;<span class="ident" id="4863723">scanEscape</span><span class="op" id="4863733">(</span><span class="ident" id="4863734">quote</span>&nbsp;<span class="builtintype" id="4863740">rune</span><span class="op" id="4863744">)</span>&nbsp;<span class="builtintype" id="4863746">rune</span>&nbsp;<span class="op" id="4863751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863754">ch</span>&nbsp;<span class="op" id="4863757">:=</span>&nbsp;<span class="ident" id="4863760">s</span><span class="op" id="4863761">.</span><span class="ident" id="4863762">next</span><span class="op" id="4863766">(</span><span class="op" id="4863767">)</span>&nbsp;<span class="comment" id="4863769">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;/&#39;</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863798">switch</span>&nbsp;<span class="ident" id="4863805">ch</span>&nbsp;<span class="op" id="4863808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863811">case</span>&nbsp;<span class="string" id="4863816">&#39;a&#39;</span><span class="op" id="4863819">,</span>&nbsp;<span class="string" id="4863821">&#39;b&#39;</span><span class="op" id="4863824">,</span>&nbsp;<span class="string" id="4863826">&#39;f&#39;</span><span class="op" id="4863829">,</span>&nbsp;<span class="string" id="4863831">&#39;n&#39;</span><span class="op" id="4863834">,</span>&nbsp;<span class="string" id="4863836">&#39;r&#39;</span><span class="op" id="4863839">,</span>&nbsp;<span class="string" id="4863841">&#39;t&#39;</span><span class="op" id="4863844">,</span>&nbsp;<span class="string" id="4863846">&#39;v&#39;</span><span class="op" id="4863849">,</span>&nbsp;<span class="string" id="4863851">&#39;\\&#39;</span><span class="op" id="4863855">,</span>&nbsp;<span class="ident" id="4863857">quote</span><span class="op" id="4863862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4863866">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863885">ch</span>&nbsp;<span class="op" id="4863888">=</span>&nbsp;<span class="ident" id="4863890">s</span><span class="op" id="4863891">.</span><span class="ident" id="4863892">next</span><span class="op" id="4863896">(</span><span class="op" id="4863897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863900">case</span>&nbsp;<span class="string" id="4863905">&#39;0&#39;</span><span class="op" id="4863908">,</span>&nbsp;<span class="string" id="4863910">&#39;1&#39;</span><span class="op" id="4863913">,</span>&nbsp;<span class="string" id="4863915">&#39;2&#39;</span><span class="op" id="4863918">,</span>&nbsp;<span class="string" id="4863920">&#39;3&#39;</span><span class="op" id="4863923">,</span>&nbsp;<span class="string" id="4863925">&#39;4&#39;</span><span class="op" id="4863928">,</span>&nbsp;<span class="string" id="4863930">&#39;5&#39;</span><span class="op" id="4863933">,</span>&nbsp;<span class="string" id="4863935">&#39;6&#39;</span><span class="op" id="4863938">,</span>&nbsp;<span class="string" id="4863940">&#39;7&#39;</span><span class="op" id="4863943">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863947">ch</span>&nbsp;<span class="op" id="4863950">=</span>&nbsp;<span class="ident" id="4863952">s</span><span class="op" id="4863953">.</span><span class="ident" id="4863954">scanDigits</span><span class="op" id="4863964">(</span><span class="ident" id="4863965">ch</span><span class="op" id="4863967">,</span>&nbsp;<span class="num" id="4863969">8</span><span class="op" id="4863970">,</span>&nbsp;<span class="num" id="4863972">3</span><span class="op" id="4863973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4863976">case</span>&nbsp;<span class="string" id="4863981">&#39;x&#39;</span><span class="op" id="4863984">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4863988">ch</span>&nbsp;<span class="op" id="4863991">=</span>&nbsp;<span class="ident" id="4863993">s</span><span class="op" id="4863994">.</span><span class="ident" id="4863995">scanDigits</span><span class="op" id="4864005">(</span><span class="ident" id="4864006">s</span><span class="op" id="4864007">.</span><span class="ident" id="4864008">next</span><span class="op" id="4864012">(</span><span class="op" id="4864013">)</span><span class="op" id="4864014">,</span>&nbsp;<span class="num" id="4864016">16</span><span class="op" id="4864018">,</span>&nbsp;<span class="num" id="4864020">2</span><span class="op" id="4864021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864024">case</span>&nbsp;<span class="string" id="4864029">&#39;u&#39;</span><span class="op" id="4864032">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864036">ch</span>&nbsp;<span class="op" id="4864039">=</span>&nbsp;<span class="ident" id="4864041">s</span><span class="op" id="4864042">.</span><span class="ident" id="4864043">scanDigits</span><span class="op" id="4864053">(</span><span class="ident" id="4864054">s</span><span class="op" id="4864055">.</span><span class="ident" id="4864056">next</span><span class="op" id="4864060">(</span><span class="op" id="4864061">)</span><span class="op" id="4864062">,</span>&nbsp;<span class="num" id="4864064">16</span><span class="op" id="4864066">,</span>&nbsp;<span class="num" id="4864068">4</span><span class="op" id="4864069">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864072">case</span>&nbsp;<span class="string" id="4864077">&#39;U&#39;</span><span class="op" id="4864080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864084">ch</span>&nbsp;<span class="op" id="4864087">=</span>&nbsp;<span class="ident" id="4864089">s</span><span class="op" id="4864090">.</span><span class="ident" id="4864091">scanDigits</span><span class="op" id="4864101">(</span><span class="ident" id="4864102">s</span><span class="op" id="4864103">.</span><span class="ident" id="4864104">next</span><span class="op" id="4864108">(</span><span class="op" id="4864109">)</span><span class="op" id="4864110">,</span>&nbsp;<span class="num" id="4864112">16</span><span class="op" id="4864114">,</span>&nbsp;<span class="num" id="4864116">8</span><span class="op" id="4864117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864120">default</span><span class="op" id="4864127">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864131">s</span><span class="op" id="4864132">.</span><span class="builtintype" id="4864133">error</span><span class="op" id="4864138">(</span><span class="string" id="4864139">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="4864160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864163">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864166">return</span>&nbsp;<span class="ident" id="4864173">ch</span><br>
<span class="lineno"></span><span class="op" id="4864176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4864179">func</span>&nbsp;<span class="op" id="4864184">(</span><span class="ident" id="4864185">s</span>&nbsp;<span class="op" id="4864187">*</span><span class="ident" id="4864188">Scanner</span><span class="op" id="4864195">)</span>&nbsp;<span class="ident" id="4864197">scanString</span><span class="op" id="4864207">(</span><span class="ident" id="4864208">quote</span>&nbsp;<span class="builtintype" id="4864214">rune</span><span class="op" id="4864218">)</span>&nbsp;<span class="op" id="4864220">(</span><span class="ident" id="4864221">n</span>&nbsp;<span class="builtintype" id="4864223">int</span><span class="op" id="4864226">)</span>&nbsp;<span class="op" id="4864228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864231">ch</span>&nbsp;<span class="op" id="4864234">:=</span>&nbsp;<span class="ident" id="4864237">s</span><span class="op" id="4864238">.</span><span class="ident" id="4864239">next</span><span class="op" id="4864243">(</span><span class="op" id="4864244">)</span>&nbsp;<span class="comment" id="4864246">//&nbsp;read&nbsp;character&nbsp;after&nbsp;quote</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864277">for</span>&nbsp;<span class="ident" id="4864281">ch</span>&nbsp;<span class="op" id="4864284">!=</span>&nbsp;<span class="ident" id="4864287">quote</span>&nbsp;<span class="op" id="4864293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864297">if</span>&nbsp;<span class="ident" id="4864300">ch</span>&nbsp;<span class="op" id="4864303">==</span>&nbsp;<span class="string" id="4864306">&#39;\n&#39;</span>&nbsp;<span class="op" id="4864311">||</span>&nbsp;<span class="ident" id="4864314">ch</span>&nbsp;<span class="op" id="4864317">&lt;</span>&nbsp;<span class="num" id="4864319">0</span>&nbsp;<span class="op" id="4864321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864326">s</span><span class="op" id="4864327">.</span><span class="builtintype" id="4864328">error</span><span class="op" id="4864333">(</span><span class="string" id="4864334">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="4864358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864363">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864372">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864376">if</span>&nbsp;<span class="ident" id="4864379">ch</span>&nbsp;<span class="op" id="4864382">==</span>&nbsp;<span class="string" id="4864385">&#39;\\&#39;</span>&nbsp;<span class="op" id="4864390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864395">ch</span>&nbsp;<span class="op" id="4864398">=</span>&nbsp;<span class="ident" id="4864400">s</span><span class="op" id="4864401">.</span><span class="ident" id="4864402">scanEscape</span><span class="op" id="4864412">(</span><span class="ident" id="4864413">quote</span><span class="op" id="4864418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864422">}</span>&nbsp;<span class="keyword" id="4864424">else</span>&nbsp;<span class="op" id="4864429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864434">ch</span>&nbsp;<span class="op" id="4864437">=</span>&nbsp;<span class="ident" id="4864439">s</span><span class="op" id="4864440">.</span><span class="ident" id="4864441">next</span><span class="op" id="4864445">(</span><span class="op" id="4864446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864450">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864454">n</span><span class="op" id="4864455">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864462">return</span><br>
<span class="lineno"></span><span class="op" id="4864469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="4864472">func</span>&nbsp;<span class="op" id="4864477">(</span><span class="ident" id="4864478">s</span>&nbsp;<span class="op" id="4864480">*</span><span class="ident" id="4864481">Scanner</span><span class="op" id="4864488">)</span>&nbsp;<span class="ident" id="4864490">scanRawString</span><span class="op" id="4864503">(</span><span class="op" id="4864504">)</span>&nbsp;<span class="op" id="4864506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864509">ch</span>&nbsp;<span class="op" id="4864512">:=</span>&nbsp;<span class="ident" id="4864515">s</span><span class="op" id="4864516">.</span><span class="ident" id="4864517">next</span><span class="op" id="4864521">(</span><span class="op" id="4864522">)</span>&nbsp;<span class="comment" id="4864524">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;`&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864553">for</span>&nbsp;<span class="ident" id="4864557">ch</span>&nbsp;<span class="op" id="4864560">!=</span>&nbsp;<span class="string" id="4864563">&#39;`&#39;</span>&nbsp;<span class="op" id="4864567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864571">if</span>&nbsp;<span class="ident" id="4864574">ch</span>&nbsp;<span class="op" id="4864577">&lt;</span>&nbsp;<span class="num" id="4864579">0</span>&nbsp;<span class="op" id="4864581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864586">s</span><span class="op" id="4864587">.</span><span class="builtintype" id="4864588">error</span><span class="op" id="4864593">(</span><span class="string" id="4864594">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="4864618">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864623">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864636">ch</span>&nbsp;<span class="op" id="4864639">=</span>&nbsp;<span class="ident" id="4864641">s</span><span class="op" id="4864642">.</span><span class="ident" id="4864643">next</span><span class="op" id="4864647">(</span><span class="op" id="4864648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864651">}</span><br>
<span class="lineno"></span><span class="op" id="4864653">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="4864656">func</span>&nbsp;<span class="op" id="4864661">(</span><span class="ident" id="4864662">s</span>&nbsp;<span class="op" id="4864664">*</span><span class="ident" id="4864665">Scanner</span><span class="op" id="4864672">)</span>&nbsp;<span class="ident" id="4864674">scanChar</span><span class="op" id="4864682">(</span><span class="op" id="4864683">)</span>&nbsp;<span class="op" id="4864685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864688">if</span>&nbsp;<span class="ident" id="4864691">s</span><span class="op" id="4864692">.</span><span class="ident" id="4864693">scanString</span><span class="op" id="4864703">(</span><span class="string" id="4864704">&#39;\&#39;&#39;</span><span class="op" id="4864708">)</span>&nbsp;<span class="op" id="4864710">!=</span>&nbsp;<span class="num" id="4864713">1</span>&nbsp;<span class="op" id="4864715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864719">s</span><span class="op" id="4864720">.</span><span class="builtintype" id="4864721">error</span><span class="op" id="4864726">(</span><span class="string" id="4864727">&#34;illegal&nbsp;char&nbsp;literal&#34;</span><span class="op" id="4864749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864752">}</span><br>
<span class="lineno">515</span><span class="op" id="4864754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4864757">func</span>&nbsp;<span class="op" id="4864762">(</span><span class="ident" id="4864763">s</span>&nbsp;<span class="op" id="4864765">*</span><span class="ident" id="4864766">Scanner</span><span class="op" id="4864773">)</span>&nbsp;<span class="ident" id="4864775">scanComment</span><span class="op" id="4864786">(</span><span class="ident" id="4864787">ch</span>&nbsp;<span class="builtintype" id="4864790">rune</span><span class="op" id="4864794">)</span>&nbsp;<span class="builtintype" id="4864796">rune</span>&nbsp;<span class="op" id="4864801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864804">//&nbsp;ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864831">if</span>&nbsp;<span class="ident" id="4864834">ch</span>&nbsp;<span class="op" id="4864837">==</span>&nbsp;<span class="string" id="4864840">&#39;/&#39;</span>&nbsp;<span class="op" id="4864844">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864848">//&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864866">ch</span>&nbsp;<span class="op" id="4864869">=</span>&nbsp;<span class="ident" id="4864871">s</span><span class="op" id="4864872">.</span><span class="ident" id="4864873">next</span><span class="op" id="4864877">(</span><span class="op" id="4864878">)</span>&nbsp;<span class="comment" id="4864880">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;//&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864911">for</span>&nbsp;<span class="ident" id="4864915">ch</span>&nbsp;<span class="op" id="4864918">!=</span>&nbsp;<span class="string" id="4864921">&#39;\n&#39;</span>&nbsp;<span class="op" id="4864926">&amp;&amp;</span>&nbsp;<span class="ident" id="4864929">ch</span>&nbsp;<span class="op" id="4864932">&gt;=</span>&nbsp;<span class="num" id="4864935">0</span>&nbsp;<span class="op" id="4864937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864942">ch</span>&nbsp;<span class="op" id="4864945">=</span>&nbsp;<span class="ident" id="4864947">s</span><span class="op" id="4864948">.</span><span class="ident" id="4864949">next</span><span class="op" id="4864953">(</span><span class="op" id="4864954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864958">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4864962">return</span>&nbsp;<span class="ident" id="4864969">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4864973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4864977">//&nbsp;general&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4864997">ch</span>&nbsp;<span class="op" id="4865000">=</span>&nbsp;<span class="ident" id="4865002">s</span><span class="op" id="4865003">.</span><span class="ident" id="4865004">next</span><span class="op" id="4865008">(</span><span class="op" id="4865009">)</span>&nbsp;<span class="comment" id="4865011">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;/*&#34;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865041">for</span>&nbsp;<span class="op" id="4865045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865049">if</span>&nbsp;<span class="ident" id="4865052">ch</span>&nbsp;<span class="op" id="4865055">&lt;</span>&nbsp;<span class="num" id="4865057">0</span>&nbsp;<span class="op" id="4865059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865064">s</span><span class="op" id="4865065">.</span><span class="builtintype" id="4865066">error</span><span class="op" id="4865071">(</span><span class="string" id="4865072">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="4865096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865101">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4865109">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865113">ch0</span>&nbsp;<span class="op" id="4865117">:=</span>&nbsp;<span class="ident" id="4865120">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865125">ch</span>&nbsp;<span class="op" id="4865128">=</span>&nbsp;<span class="ident" id="4865130">s</span><span class="op" id="4865131">.</span><span class="ident" id="4865132">next</span><span class="op" id="4865136">(</span><span class="op" id="4865137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865141">if</span>&nbsp;<span class="ident" id="4865144">ch0</span>&nbsp;<span class="op" id="4865148">==</span>&nbsp;<span class="string" id="4865151">&#39;*&#39;</span>&nbsp;<span class="op" id="4865155">&amp;&amp;</span>&nbsp;<span class="ident" id="4865158">ch</span>&nbsp;<span class="op" id="4865161">==</span>&nbsp;<span class="string" id="4865164">&#39;/&#39;</span>&nbsp;<span class="op" id="4865168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865173">ch</span>&nbsp;<span class="op" id="4865176">=</span>&nbsp;<span class="ident" id="4865178">s</span><span class="op" id="4865179">.</span><span class="ident" id="4865180">next</span><span class="op" id="4865184">(</span><span class="op" id="4865185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865190">break</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4865198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4865201">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865204">return</span>&nbsp;<span class="ident" id="4865211">ch</span><br>
<span class="lineno"></span><span class="op" id="4865214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="4865217">//&nbsp;Scan&nbsp;reads&nbsp;the&nbsp;next&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character&nbsp;from&nbsp;source&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4865295">//&nbsp;It&nbsp;only&nbsp;recognizes&nbsp;tokens&nbsp;t&nbsp;for&nbsp;which&nbsp;the&nbsp;respective&nbsp;Mode&nbsp;bit&nbsp;(1&lt;&lt;-t)&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="4865376">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports&nbsp;scanner&nbsp;errors&nbsp;(read&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4865456">//&nbsp;token&nbsp;errors)&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise&nbsp;it&nbsp;prints&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="4865534">//&nbsp;message&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">550</span><span class="keyword" id="4865559">func</span>&nbsp;<span class="op" id="4865564">(</span><span class="ident" id="4865565">s</span>&nbsp;<span class="op" id="4865567">*</span><span class="ident" id="4865568">Scanner</span><span class="op" id="4865575">)</span>&nbsp;<span class="ident" id="4865577">Scan</span><span class="op" id="4865581">(</span><span class="op" id="4865582">)</span>&nbsp;<span class="builtintype" id="4865584">rune</span>&nbsp;<span class="op" id="4865589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865592">ch</span>&nbsp;<span class="op" id="4865595">:=</span>&nbsp;<span class="ident" id="4865598">s</span><span class="op" id="4865599">.</span><span class="ident" id="4865600">Peek</span><span class="op" id="4865604">(</span><span class="op" id="4865605">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865609">//&nbsp;reset&nbsp;token&nbsp;text&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865639">s</span><span class="op" id="4865640">.</span><span class="ident" id="4865641">tokPos</span>&nbsp;<span class="op" id="4865648">=</span>&nbsp;<span class="op" id="4865650">-</span><span class="num" id="4865651">1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865654">s</span><span class="op" id="4865655">.</span><span class="ident" id="4865656">Line</span>&nbsp;<span class="op" id="4865661">=</span>&nbsp;<span class="num" id="4865663">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="4865666">redo</span><span class="op" id="4865670">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865673">//&nbsp;skip&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865694">for</span>&nbsp;<span class="ident" id="4865698">s</span><span class="op" id="4865699">.</span><span class="ident" id="4865700">Whitespace</span><span class="op" id="4865710">&amp;</span><span class="op" id="4865711">(</span><span class="num" id="4865712">1</span><span class="op" id="4865713">&lt;&lt;</span><span class="builtintype" id="4865715">uint</span><span class="op" id="4865719">(</span><span class="ident" id="4865720">ch</span><span class="op" id="4865722">)</span><span class="op" id="4865723">)</span>&nbsp;<span class="op" id="4865725">!=</span>&nbsp;<span class="num" id="4865728">0</span>&nbsp;<span class="op" id="4865730">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865734">ch</span>&nbsp;<span class="op" id="4865737">=</span>&nbsp;<span class="ident" id="4865739">s</span><span class="op" id="4865740">.</span><span class="ident" id="4865741">next</span><span class="op" id="4865745">(</span><span class="op" id="4865746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4865749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865753">//&nbsp;start&nbsp;collecting&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865785">s</span><span class="op" id="4865786">.</span><span class="ident" id="4865787">tokBuf</span><span class="op" id="4865793">.</span><span class="ident" id="4865794">Reset</span><span class="op" id="4865799">(</span><span class="op" id="4865800">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865803">s</span><span class="op" id="4865804">.</span><span class="ident" id="4865805">tokPos</span>&nbsp;<span class="op" id="4865812">=</span>&nbsp;<span class="ident" id="4865814">s</span><span class="op" id="4865815">.</span><span class="ident" id="4865816">srcPos</span>&nbsp;<span class="op" id="4865823">-</span>&nbsp;<span class="ident" id="4865825">s</span><span class="op" id="4865826">.</span><span class="ident" id="4865827">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865841">//&nbsp;set&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865864">//&nbsp;(this&nbsp;is&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Pos())</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4865928">s</span><span class="op" id="4865929">.</span><span class="ident" id="4865930">Offset</span>&nbsp;<span class="op" id="4865937">=</span>&nbsp;<span class="ident" id="4865939">s</span><span class="op" id="4865940">.</span><span class="ident" id="4865941">srcBufOffset</span>&nbsp;<span class="op" id="4865954">+</span>&nbsp;<span class="ident" id="4865956">s</span><span class="op" id="4865957">.</span><span class="ident" id="4865958">tokPos</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4865966">if</span>&nbsp;<span class="ident" id="4865969">s</span><span class="op" id="4865970">.</span><span class="ident" id="4865971">column</span>&nbsp;<span class="op" id="4865978">&gt;</span>&nbsp;<span class="num" id="4865980">0</span>&nbsp;<span class="op" id="4865982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4865986">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866034">s</span><span class="op" id="4866035">.</span><span class="ident" id="4866036">Line</span>&nbsp;<span class="op" id="4866041">=</span>&nbsp;<span class="ident" id="4866043">s</span><span class="op" id="4866044">.</span><span class="ident" id="4866045">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866052">s</span><span class="op" id="4866053">.</span><span class="ident" id="4866054">Column</span>&nbsp;<span class="op" id="4866061">=</span>&nbsp;<span class="ident" id="4866063">s</span><span class="op" id="4866064">.</span><span class="ident" id="4866065">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866073">}</span>&nbsp;<span class="keyword" id="4866075">else</span>&nbsp;<span class="op" id="4866080">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4866084">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4866115">//&nbsp;(we&nbsp;cannot&nbsp;be&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4866165">//&nbsp;since&nbsp;we&nbsp;have&nbsp;called&nbsp;next()&nbsp;at&nbsp;least&nbsp;once)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866213">s</span><span class="op" id="4866214">.</span><span class="ident" id="4866215">Line</span>&nbsp;<span class="op" id="4866220">=</span>&nbsp;<span class="ident" id="4866222">s</span><span class="op" id="4866223">.</span><span class="ident" id="4866224">line</span>&nbsp;<span class="op" id="4866229">-</span>&nbsp;<span class="num" id="4866231">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866235">s</span><span class="op" id="4866236">.</span><span class="ident" id="4866237">Column</span>&nbsp;<span class="op" id="4866244">=</span>&nbsp;<span class="ident" id="4866246">s</span><span class="op" id="4866247">.</span><span class="ident" id="4866248">lastLineLen</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4866265">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866291">tok</span>&nbsp;<span class="op" id="4866295">:=</span>&nbsp;<span class="ident" id="4866298">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866302">switch</span>&nbsp;<span class="op" id="4866309">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866312">case</span>&nbsp;<span class="ident" id="4866317">s</span><span class="op" id="4866318">.</span><span class="ident" id="4866319">isIdentRune</span><span class="op" id="4866330">(</span><span class="ident" id="4866331">ch</span><span class="op" id="4866333">,</span>&nbsp;<span class="num" id="4866335">0</span><span class="op" id="4866336">)</span><span class="op" id="4866337">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866341">if</span>&nbsp;<span class="ident" id="4866344">s</span><span class="op" id="4866345">.</span><span class="ident" id="4866346">Mode</span><span class="op" id="4866350">&amp;</span><span class="ident" id="4866351">ScanIdents</span>&nbsp;<span class="op" id="4866362">!=</span>&nbsp;<span class="num" id="4866365">0</span>&nbsp;<span class="op" id="4866367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866372">tok</span>&nbsp;<span class="op" id="4866376">=</span>&nbsp;<span class="ident" id="4866378">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866387">ch</span>&nbsp;<span class="op" id="4866390">=</span>&nbsp;<span class="ident" id="4866392">s</span><span class="op" id="4866393">.</span><span class="ident" id="4866394">scanIdentifier</span><span class="op" id="4866408">(</span><span class="op" id="4866409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866413">}</span>&nbsp;<span class="keyword" id="4866415">else</span>&nbsp;<span class="op" id="4866420">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866425">ch</span>&nbsp;<span class="op" id="4866428">=</span>&nbsp;<span class="ident" id="4866430">s</span><span class="op" id="4866431">.</span><span class="ident" id="4866432">next</span><span class="op" id="4866436">(</span><span class="op" id="4866437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866444">case</span>&nbsp;<span class="ident" id="4866449">isDecimal</span><span class="op" id="4866458">(</span><span class="ident" id="4866459">ch</span><span class="op" id="4866461">)</span><span class="op" id="4866462">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866466">if</span>&nbsp;<span class="ident" id="4866469">s</span><span class="op" id="4866470">.</span><span class="ident" id="4866471">Mode</span><span class="op" id="4866475">&amp;</span><span class="op" id="4866476">(</span><span class="ident" id="4866477">ScanInts</span><span class="op" id="4866485">|</span><span class="ident" id="4866486">ScanFloats</span><span class="op" id="4866496">)</span>&nbsp;<span class="op" id="4866498">!=</span>&nbsp;<span class="num" id="4866501">0</span>&nbsp;<span class="op" id="4866503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866508">tok</span><span class="op" id="4866511">,</span>&nbsp;<span class="ident" id="4866513">ch</span>&nbsp;<span class="op" id="4866516">=</span>&nbsp;<span class="ident" id="4866518">s</span><span class="op" id="4866519">.</span><span class="ident" id="4866520">scanNumber</span><span class="op" id="4866530">(</span><span class="ident" id="4866531">ch</span><span class="op" id="4866533">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866537">}</span>&nbsp;<span class="keyword" id="4866539">else</span>&nbsp;<span class="op" id="4866544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866549">ch</span>&nbsp;<span class="op" id="4866552">=</span>&nbsp;<span class="ident" id="4866554">s</span><span class="op" id="4866555">.</span><span class="ident" id="4866556">next</span><span class="op" id="4866560">(</span><span class="op" id="4866561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866568">default</span><span class="op" id="4866575">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866579">switch</span>&nbsp;<span class="ident" id="4866586">ch</span>&nbsp;<span class="op" id="4866589">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866593">case</span>&nbsp;<span class="string" id="4866598">&#39;&#34;&#39;</span><span class="op" id="4866601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866606">if</span>&nbsp;<span class="ident" id="4866609">s</span><span class="op" id="4866610">.</span><span class="ident" id="4866611">Mode</span><span class="op" id="4866615">&amp;</span><span class="ident" id="4866616">ScanStrings</span>&nbsp;<span class="op" id="4866628">!=</span>&nbsp;<span class="num" id="4866631">0</span>&nbsp;<span class="op" id="4866633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866639">s</span><span class="op" id="4866640">.</span><span class="ident" id="4866641">scanString</span><span class="op" id="4866651">(</span><span class="string" id="4866652">&#39;&#34;&#39;</span><span class="op" id="4866655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866661">tok</span>&nbsp;<span class="op" id="4866665">=</span>&nbsp;<span class="ident" id="4866667">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866677">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866682">ch</span>&nbsp;<span class="op" id="4866685">=</span>&nbsp;<span class="ident" id="4866687">s</span><span class="op" id="4866688">.</span><span class="ident" id="4866689">next</span><span class="op" id="4866693">(</span><span class="op" id="4866694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866698">case</span>&nbsp;<span class="string" id="4866703">&#39;\&#39;&#39;</span><span class="op" id="4866707">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866712">if</span>&nbsp;<span class="ident" id="4866715">s</span><span class="op" id="4866716">.</span><span class="ident" id="4866717">Mode</span><span class="op" id="4866721">&amp;</span><span class="ident" id="4866722">ScanChars</span>&nbsp;<span class="op" id="4866732">!=</span>&nbsp;<span class="num" id="4866735">0</span>&nbsp;<span class="op" id="4866737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866743">s</span><span class="op" id="4866744">.</span><span class="ident" id="4866745">scanChar</span><span class="op" id="4866753">(</span><span class="op" id="4866754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866760">tok</span>&nbsp;<span class="op" id="4866764">=</span>&nbsp;<span class="ident" id="4866766">Char</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866779">ch</span>&nbsp;<span class="op" id="4866782">=</span>&nbsp;<span class="ident" id="4866784">s</span><span class="op" id="4866785">.</span><span class="ident" id="4866786">next</span><span class="op" id="4866790">(</span><span class="op" id="4866791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866795">case</span>&nbsp;<span class="string" id="4866800">&#39;.&#39;</span><span class="op" id="4866803">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866808">ch</span>&nbsp;<span class="op" id="4866811">=</span>&nbsp;<span class="ident" id="4866813">s</span><span class="op" id="4866814">.</span><span class="ident" id="4866815">next</span><span class="op" id="4866819">(</span><span class="op" id="4866820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866825">if</span>&nbsp;<span class="ident" id="4866828">isDecimal</span><span class="op" id="4866837">(</span><span class="ident" id="4866838">ch</span><span class="op" id="4866840">)</span>&nbsp;<span class="op" id="4866842">&amp;&amp;</span>&nbsp;<span class="ident" id="4866845">s</span><span class="op" id="4866846">.</span><span class="ident" id="4866847">Mode</span><span class="op" id="4866851">&amp;</span><span class="ident" id="4866852">ScanFloats</span>&nbsp;<span class="op" id="4866863">!=</span>&nbsp;<span class="num" id="4866866">0</span>&nbsp;<span class="op" id="4866868">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866874">tok</span>&nbsp;<span class="op" id="4866878">=</span>&nbsp;<span class="ident" id="4866880">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866890">ch</span>&nbsp;<span class="op" id="4866893">=</span>&nbsp;<span class="ident" id="4866895">s</span><span class="op" id="4866896">.</span><span class="ident" id="4866897">scanMantissa</span><span class="op" id="4866909">(</span><span class="ident" id="4866910">ch</span><span class="op" id="4866912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866918">ch</span>&nbsp;<span class="op" id="4866921">=</span>&nbsp;<span class="ident" id="4866923">s</span><span class="op" id="4866924">.</span><span class="ident" id="4866925">scanExponent</span><span class="op" id="4866937">(</span><span class="ident" id="4866938">ch</span><span class="op" id="4866940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4866945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866949">case</span>&nbsp;<span class="string" id="4866954">&#39;/&#39;</span><span class="op" id="4866957">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4866962">ch</span>&nbsp;<span class="op" id="4866965">=</span>&nbsp;<span class="ident" id="4866967">s</span><span class="op" id="4866968">.</span><span class="ident" id="4866969">next</span><span class="op" id="4866973">(</span><span class="op" id="4866974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4866979">if</span>&nbsp;<span class="op" id="4866982">(</span><span class="ident" id="4866983">ch</span>&nbsp;<span class="op" id="4866986">==</span>&nbsp;<span class="string" id="4866989">&#39;/&#39;</span>&nbsp;<span class="op" id="4866993">||</span>&nbsp;<span class="ident" id="4866996">ch</span>&nbsp;<span class="op" id="4866999">==</span>&nbsp;<span class="string" id="4867002">&#39;*&#39;</span><span class="op" id="4867005">)</span>&nbsp;<span class="op" id="4867007">&amp;&amp;</span>&nbsp;<span class="ident" id="4867010">s</span><span class="op" id="4867011">.</span><span class="ident" id="4867012">Mode</span><span class="op" id="4867016">&amp;</span><span class="ident" id="4867017">ScanComments</span>&nbsp;<span class="op" id="4867030">!=</span>&nbsp;<span class="num" id="4867033">0</span>&nbsp;<span class="op" id="4867035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867041">if</span>&nbsp;<span class="ident" id="4867044">s</span><span class="op" id="4867045">.</span><span class="ident" id="4867046">Mode</span><span class="op" id="4867050">&amp;</span><span class="ident" id="4867051">SkipComments</span>&nbsp;<span class="op" id="4867064">!=</span>&nbsp;<span class="num" id="4867067">0</span>&nbsp;<span class="op" id="4867069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867076">s</span><span class="op" id="4867077">.</span><span class="ident" id="4867078">tokPos</span>&nbsp;<span class="op" id="4867085">=</span>&nbsp;<span class="op" id="4867087">-</span><span class="num" id="4867088">1</span>&nbsp;<span class="comment" id="4867090">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867123">ch</span>&nbsp;<span class="op" id="4867126">=</span>&nbsp;<span class="ident" id="4867128">s</span><span class="op" id="4867129">.</span><span class="ident" id="4867130">scanComment</span><span class="op" id="4867141">(</span><span class="ident" id="4867142">ch</span><span class="op" id="4867144">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867151">goto</span>&nbsp;<span class="ident" id="4867156">redo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4867165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867171">ch</span>&nbsp;<span class="op" id="4867174">=</span>&nbsp;<span class="ident" id="4867176">s</span><span class="op" id="4867177">.</span><span class="ident" id="4867178">scanComment</span><span class="op" id="4867189">(</span><span class="ident" id="4867190">ch</span><span class="op" id="4867192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867198">tok</span>&nbsp;<span class="op" id="4867202">=</span>&nbsp;<span class="ident" id="4867204">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4867215">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867219">case</span>&nbsp;<span class="string" id="4867224">&#39;`&#39;</span><span class="op" id="4867227">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867232">if</span>&nbsp;<span class="ident" id="4867235">s</span><span class="op" id="4867236">.</span><span class="ident" id="4867237">Mode</span><span class="op" id="4867241">&amp;</span><span class="ident" id="4867242">ScanRawStrings</span>&nbsp;<span class="op" id="4867257">!=</span>&nbsp;<span class="num" id="4867260">0</span>&nbsp;<span class="op" id="4867262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867268">s</span><span class="op" id="4867269">.</span><span class="ident" id="4867270">scanRawString</span><span class="op" id="4867283">(</span><span class="op" id="4867284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867290">tok</span>&nbsp;<span class="op" id="4867294">=</span>&nbsp;<span class="ident" id="4867296">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4867306">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867311">ch</span>&nbsp;<span class="op" id="4867314">=</span>&nbsp;<span class="ident" id="4867316">s</span><span class="op" id="4867317">.</span><span class="ident" id="4867318">next</span><span class="op" id="4867322">(</span><span class="op" id="4867323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867327">default</span><span class="op" id="4867334">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867339">ch</span>&nbsp;<span class="op" id="4867342">=</span>&nbsp;<span class="ident" id="4867344">s</span><span class="op" id="4867345">.</span><span class="ident" id="4867346">next</span><span class="op" id="4867350">(</span><span class="op" id="4867351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4867355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4867358">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4867362">//&nbsp;end&nbsp;of&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867384">s</span><span class="op" id="4867385">.</span><span class="ident" id="4867386">tokEnd</span>&nbsp;<span class="op" id="4867393">=</span>&nbsp;<span class="ident" id="4867395">s</span><span class="op" id="4867396">.</span><span class="ident" id="4867397">srcPos</span>&nbsp;<span class="op" id="4867404">-</span>&nbsp;<span class="ident" id="4867406">s</span><span class="op" id="4867407">.</span><span class="ident" id="4867408">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867422">s</span><span class="op" id="4867423">.</span><span class="ident" id="4867424">ch</span>&nbsp;<span class="op" id="4867427">=</span>&nbsp;<span class="ident" id="4867429">ch</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867433">return</span>&nbsp;<span class="ident" id="4867440">tok</span><br>
<span class="lineno"></span><span class="op" id="4867444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4867447">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;immediately&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="4867510">//&nbsp;the&nbsp;character&nbsp;or&nbsp;token&nbsp;returned&nbsp;by&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Next&nbsp;or&nbsp;Scan.</span><br>
<span class="lineno">650</span><span class="keyword" id="4867579">func</span>&nbsp;<span class="op" id="4867584">(</span><span class="ident" id="4867585">s</span>&nbsp;<span class="op" id="4867587">*</span><span class="ident" id="4867588">Scanner</span><span class="op" id="4867595">)</span>&nbsp;<span class="ident" id="4867597">Pos</span><span class="op" id="4867600">(</span><span class="op" id="4867601">)</span>&nbsp;<span class="op" id="4867603">(</span><span class="ident" id="4867604">pos</span>&nbsp;<span class="ident" id="4867608">Position</span><span class="op" id="4867616">)</span>&nbsp;<span class="op" id="4867618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867621">pos</span><span class="op" id="4867624">.</span><span class="ident" id="4867625">Filename</span>&nbsp;<span class="op" id="4867634">=</span>&nbsp;<span class="ident" id="4867636">s</span><span class="op" id="4867637">.</span><span class="ident" id="4867638">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867648">pos</span><span class="op" id="4867651">.</span><span class="ident" id="4867652">Offset</span>&nbsp;<span class="op" id="4867659">=</span>&nbsp;<span class="ident" id="4867661">s</span><span class="op" id="4867662">.</span><span class="ident" id="4867663">srcBufOffset</span>&nbsp;<span class="op" id="4867676">+</span>&nbsp;<span class="ident" id="4867678">s</span><span class="op" id="4867679">.</span><span class="ident" id="4867680">srcPos</span>&nbsp;<span class="op" id="4867687">-</span>&nbsp;<span class="ident" id="4867689">s</span><span class="op" id="4867690">.</span><span class="ident" id="4867691">lastCharLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867704">switch</span>&nbsp;<span class="op" id="4867711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867714">case</span>&nbsp;<span class="ident" id="4867719">s</span><span class="op" id="4867720">.</span><span class="ident" id="4867721">column</span>&nbsp;<span class="op" id="4867728">&gt;</span>&nbsp;<span class="num" id="4867730">0</span><span class="op" id="4867731">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4867735">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867783">pos</span><span class="op" id="4867786">.</span><span class="ident" id="4867787">Line</span>&nbsp;<span class="op" id="4867792">=</span>&nbsp;<span class="ident" id="4867794">s</span><span class="op" id="4867795">.</span><span class="ident" id="4867796">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867803">pos</span><span class="op" id="4867806">.</span><span class="ident" id="4867807">Column</span>&nbsp;<span class="op" id="4867814">=</span>&nbsp;<span class="ident" id="4867816">s</span><span class="op" id="4867817">.</span><span class="ident" id="4867818">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867826">case</span>&nbsp;<span class="ident" id="4867831">s</span><span class="op" id="4867832">.</span><span class="ident" id="4867833">lastLineLen</span>&nbsp;<span class="op" id="4867845">&gt;</span>&nbsp;<span class="num" id="4867847">0</span><span class="op" id="4867848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4867852">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867883">pos</span><span class="op" id="4867886">.</span><span class="ident" id="4867887">Line</span>&nbsp;<span class="op" id="4867892">=</span>&nbsp;<span class="ident" id="4867894">s</span><span class="op" id="4867895">.</span><span class="ident" id="4867896">line</span>&nbsp;<span class="op" id="4867901">-</span>&nbsp;<span class="num" id="4867903">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867907">pos</span><span class="op" id="4867910">.</span><span class="ident" id="4867911">Column</span>&nbsp;<span class="op" id="4867918">=</span>&nbsp;<span class="ident" id="4867920">s</span><span class="op" id="4867921">.</span><span class="ident" id="4867922">lastLineLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4867935">default</span><span class="op" id="4867942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4867946">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867982">pos</span><span class="op" id="4867985">.</span><span class="ident" id="4867986">Line</span>&nbsp;<span class="op" id="4867991">=</span>&nbsp;<span class="num" id="4867993">1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4867997">pos</span><span class="op" id="4868000">.</span><span class="ident" id="4868001">Column</span>&nbsp;<span class="op" id="4868008">=</span>&nbsp;<span class="num" id="4868010">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4868013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868016">return</span><br>
<span class="lineno"></span><span class="op" id="4868023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="4868026">//&nbsp;TokenText&nbsp;returns&nbsp;the&nbsp;string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="4868108">//&nbsp;Valid&nbsp;after&nbsp;calling&nbsp;Scan().</span><br>
<span class="lineno"></span><span class="keyword" id="4868139">func</span>&nbsp;<span class="op" id="4868144">(</span><span class="ident" id="4868145">s</span>&nbsp;<span class="op" id="4868147">*</span><span class="ident" id="4868148">Scanner</span><span class="op" id="4868155">)</span>&nbsp;<span class="ident" id="4868157">TokenText</span><span class="op" id="4868166">(</span><span class="op" id="4868167">)</span>&nbsp;<span class="builtintype" id="4868169">string</span>&nbsp;<span class="op" id="4868176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868179">if</span>&nbsp;<span class="ident" id="4868182">s</span><span class="op" id="4868183">.</span><span class="ident" id="4868184">tokPos</span>&nbsp;<span class="op" id="4868191">&lt;</span>&nbsp;<span class="num" id="4868193">0</span>&nbsp;<span class="op" id="4868195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4868199">//&nbsp;no&nbsp;token&nbsp;text</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868218">return</span>&nbsp;<span class="string" id="4868225">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4868229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868233">if</span>&nbsp;<span class="ident" id="4868236">s</span><span class="op" id="4868237">.</span><span class="ident" id="4868238">tokEnd</span>&nbsp;<span class="op" id="4868245">&lt;</span>&nbsp;<span class="num" id="4868247">0</span>&nbsp;<span class="op" id="4868249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4868253">//&nbsp;if&nbsp;EOF&nbsp;was&nbsp;reached,&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;to&nbsp;-1&nbsp;(s.srcPos&nbsp;==&nbsp;0)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4868316">s</span><span class="op" id="4868317">.</span><span class="ident" id="4868318">tokEnd</span>&nbsp;<span class="op" id="4868325">=</span>&nbsp;<span class="ident" id="4868327">s</span><span class="op" id="4868328">.</span><span class="ident" id="4868329">tokPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4868337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868341">if</span>&nbsp;<span class="ident" id="4868344">s</span><span class="op" id="4868345">.</span><span class="ident" id="4868346">tokBuf</span><span class="op" id="4868352">.</span><span class="ident" id="4868353">Len</span><span class="op" id="4868356">(</span><span class="op" id="4868357">)</span>&nbsp;<span class="op" id="4868359">==</span>&nbsp;<span class="num" id="4868362">0</span>&nbsp;<span class="op" id="4868364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4868368">//&nbsp;common&nbsp;case:&nbsp;the&nbsp;entire&nbsp;token&nbsp;text&nbsp;is&nbsp;still&nbsp;in&nbsp;srcBuf</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868427">return</span>&nbsp;<span class="builtintype" id="4868434">string</span><span class="op" id="4868440">(</span><span class="ident" id="4868441">s</span><span class="op" id="4868442">.</span><span class="ident" id="4868443">srcBuf</span><span class="op" id="4868449">[</span><span class="ident" id="4868450">s</span><span class="op" id="4868451">.</span><span class="ident" id="4868452">tokPos</span><span class="op" id="4868458">:</span><span class="ident" id="4868459">s</span><span class="op" id="4868460">.</span><span class="ident" id="4868461">tokEnd</span><span class="op" id="4868467">]</span><span class="op" id="4868468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4868471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4868475">//&nbsp;part&nbsp;of&nbsp;the&nbsp;token&nbsp;text&nbsp;was&nbsp;saved&nbsp;in&nbsp;tokBuf:&nbsp;save&nbsp;the&nbsp;rest&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4868540">//&nbsp;tokBuf&nbsp;as&nbsp;well&nbsp;and&nbsp;return&nbsp;its&nbsp;content</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4868582">s</span><span class="op" id="4868583">.</span><span class="ident" id="4868584">tokBuf</span><span class="op" id="4868590">.</span><span class="ident" id="4868591">Write</span><span class="op" id="4868596">(</span><span class="ident" id="4868597">s</span><span class="op" id="4868598">.</span><span class="ident" id="4868599">srcBuf</span><span class="op" id="4868605">[</span><span class="ident" id="4868606">s</span><span class="op" id="4868607">.</span><span class="ident" id="4868608">tokPos</span><span class="op" id="4868614">:</span><span class="ident" id="4868615">s</span><span class="op" id="4868616">.</span><span class="ident" id="4868617">tokEnd</span><span class="op" id="4868623">]</span><span class="op" id="4868624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4868627">s</span><span class="op" id="4868628">.</span><span class="ident" id="4868629">tokPos</span>&nbsp;<span class="op" id="4868636">=</span>&nbsp;<span class="ident" id="4868638">s</span><span class="op" id="4868639">.</span><span class="ident" id="4868640">tokEnd</span>&nbsp;<span class="comment" id="4868647">//&nbsp;ensure&nbsp;idempotency&nbsp;of&nbsp;TokenText()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4868690">return</span>&nbsp;<span class="ident" id="4868697">s</span><span class="op" id="4868698">.</span><span class="ident" id="4868699">tokBuf</span><span class="op" id="4868705">.</span><span class="ident" id="4868706">String</span><span class="op" id="4868712">(</span><span class="op" id="4868713">)</span><br>
<span class="lineno"></span><span class="op" id="4868715">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
