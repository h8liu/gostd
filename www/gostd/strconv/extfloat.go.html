<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1683992">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1684047">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1684101">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1684152">package</span>&nbsp;<span class="ident" id="1684160">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1684169">//&nbsp;An&nbsp;extFloat&nbsp;represents&nbsp;an&nbsp;extended&nbsp;floating-point&nbsp;number,&nbsp;with&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="1684240">//&nbsp;precision&nbsp;than&nbsp;a&nbsp;float64.&nbsp;It&nbsp;does&nbsp;not&nbsp;try&nbsp;to&nbsp;save&nbsp;bits:&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1684303">//&nbsp;number&nbsp;represented&nbsp;by&nbsp;the&nbsp;structure&nbsp;is&nbsp;mant*(2^exp),&nbsp;with&nbsp;a&nbsp;negative</span><br>
<span class="lineno">10</span><span class="comment" id="1684375">//&nbsp;sign&nbsp;if&nbsp;neg&nbsp;is&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="1684399">type</span>&nbsp;<span class="ident" id="1684404">extFloat</span>&nbsp;<span class="keyword" id="1684413">struct</span>&nbsp;<span class="op" id="1684420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684423">mant</span>&nbsp;<span class="ident" id="1684428">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684436">exp</span>&nbsp;&nbsp;<span class="builtintype" id="1684441">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684446">neg</span>&nbsp;&nbsp;<span class="builtintype" id="1684451">bool</span><br>
<span class="lineno">15</span><span class="op" id="1684456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1684459">//&nbsp;Powers&nbsp;of&nbsp;ten&nbsp;taken&nbsp;from&nbsp;double-conversion&nbsp;library.</span><br>
<span class="lineno"></span><span class="comment" id="1684514">//&nbsp;http://code.google.com/p/double-conversion/</span><br>
<span class="lineno"></span><span class="keyword" id="1684561">const</span>&nbsp;<span class="op" id="1684567">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684570">firstPowerOfTen</span>&nbsp;<span class="op" id="1684586">=</span>&nbsp;<span class="op" id="1684588">-</span><span class="num" id="1684589">348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1684594">stepPowerOfTen</span>&nbsp;&nbsp;<span class="op" id="1684610">=</span>&nbsp;<span class="num" id="1684612">8</span><br>
<span class="lineno"></span><span class="op" id="1684614">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1684617">var</span>&nbsp;<span class="ident" id="1684621">smallPowersOfTen</span>&nbsp;<span class="op" id="1684638">=</span>&nbsp;<span class="op" id="1684640">[</span><span class="op" id="1684641">...</span><span class="op" id="1684644">]</span><span class="ident" id="1684645">extFloat</span><span class="op" id="1684653">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684656">{</span><span class="num" id="1684657">1</span>&nbsp;<span class="op" id="1684659">&lt;&lt;</span>&nbsp;<span class="num" id="1684662">63</span><span class="op" id="1684664">,</span>&nbsp;<span class="op" id="1684666">-</span><span class="num" id="1684667">63</span><span class="op" id="1684669">,</span>&nbsp;<span class="builtintype" id="1684671">false</span><span class="op" id="1684676">}</span><span class="op" id="1684677">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1684686">//&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684692">{</span><span class="num" id="1684693">0xa</span>&nbsp;<span class="op" id="1684697">&lt;&lt;</span>&nbsp;<span class="num" id="1684700">60</span><span class="op" id="1684702">,</span>&nbsp;<span class="op" id="1684704">-</span><span class="num" id="1684705">60</span><span class="op" id="1684707">,</span>&nbsp;<span class="builtintype" id="1684709">false</span><span class="op" id="1684714">}</span><span class="op" id="1684715">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1684722">//&nbsp;1e1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684730">{</span><span class="num" id="1684731">0x64</span>&nbsp;<span class="op" id="1684736">&lt;&lt;</span>&nbsp;<span class="num" id="1684739">57</span><span class="op" id="1684741">,</span>&nbsp;<span class="op" id="1684743">-</span><span class="num" id="1684744">57</span><span class="op" id="1684746">,</span>&nbsp;<span class="builtintype" id="1684748">false</span><span class="op" id="1684753">}</span><span class="op" id="1684754">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1684760">//&nbsp;1e2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684768">{</span><span class="num" id="1684769">0x3e8</span>&nbsp;<span class="op" id="1684775">&lt;&lt;</span>&nbsp;<span class="num" id="1684778">54</span><span class="op" id="1684780">,</span>&nbsp;<span class="op" id="1684782">-</span><span class="num" id="1684783">54</span><span class="op" id="1684785">,</span>&nbsp;<span class="builtintype" id="1684787">false</span><span class="op" id="1684792">}</span><span class="op" id="1684793">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1684798">//&nbsp;1e3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684806">{</span><span class="num" id="1684807">0x2710</span>&nbsp;<span class="op" id="1684814">&lt;&lt;</span>&nbsp;<span class="num" id="1684817">50</span><span class="op" id="1684819">,</span>&nbsp;<span class="op" id="1684821">-</span><span class="num" id="1684822">50</span><span class="op" id="1684824">,</span>&nbsp;<span class="builtintype" id="1684826">false</span><span class="op" id="1684831">}</span><span class="op" id="1684832">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1684836">//&nbsp;1e4</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684844">{</span><span class="num" id="1684845">0x186a0</span>&nbsp;<span class="op" id="1684853">&lt;&lt;</span>&nbsp;<span class="num" id="1684856">47</span><span class="op" id="1684858">,</span>&nbsp;<span class="op" id="1684860">-</span><span class="num" id="1684861">47</span><span class="op" id="1684863">,</span>&nbsp;<span class="builtintype" id="1684865">false</span><span class="op" id="1684870">}</span><span class="op" id="1684871">,</span>&nbsp;&nbsp;<span class="comment" id="1684874">//&nbsp;1e5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684882">{</span><span class="num" id="1684883">0xf4240</span>&nbsp;<span class="op" id="1684891">&lt;&lt;</span>&nbsp;<span class="num" id="1684894">44</span><span class="op" id="1684896">,</span>&nbsp;<span class="op" id="1684898">-</span><span class="num" id="1684899">44</span><span class="op" id="1684901">,</span>&nbsp;<span class="builtintype" id="1684903">false</span><span class="op" id="1684908">}</span><span class="op" id="1684909">,</span>&nbsp;&nbsp;<span class="comment" id="1684912">//&nbsp;1e6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684920">{</span><span class="num" id="1684921">0x989680</span>&nbsp;<span class="op" id="1684930">&lt;&lt;</span>&nbsp;<span class="num" id="1684933">40</span><span class="op" id="1684935">,</span>&nbsp;<span class="op" id="1684937">-</span><span class="num" id="1684938">40</span><span class="op" id="1684940">,</span>&nbsp;<span class="builtintype" id="1684942">false</span><span class="op" id="1684947">}</span><span class="op" id="1684948">,</span>&nbsp;<span class="comment" id="1684950">//&nbsp;1e7</span><br>
<span class="lineno"></span><span class="op" id="1684957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="1684960">var</span>&nbsp;<span class="ident" id="1684964">powersOfTen</span>&nbsp;<span class="op" id="1684976">=</span>&nbsp;<span class="op" id="1684978">[</span><span class="op" id="1684979">...</span><span class="op" id="1684982">]</span><span class="ident" id="1684983">extFloat</span><span class="op" id="1684991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1684994">{</span><span class="num" id="1684995">0xfa8fd5a0081c0288</span><span class="op" id="1685013">,</span>&nbsp;<span class="op" id="1685015">-</span><span class="num" id="1685016">1220</span><span class="op" id="1685020">,</span>&nbsp;<span class="builtintype" id="1685022">false</span><span class="op" id="1685027">}</span><span class="op" id="1685028">,</span>&nbsp;<span class="comment" id="1685030">//&nbsp;10^-348</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685042">{</span><span class="num" id="1685043">0xbaaee17fa23ebf76</span><span class="op" id="1685061">,</span>&nbsp;<span class="op" id="1685063">-</span><span class="num" id="1685064">1193</span><span class="op" id="1685068">,</span>&nbsp;<span class="builtintype" id="1685070">false</span><span class="op" id="1685075">}</span><span class="op" id="1685076">,</span>&nbsp;<span class="comment" id="1685078">//&nbsp;10^-340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685090">{</span><span class="num" id="1685091">0x8b16fb203055ac76</span><span class="op" id="1685109">,</span>&nbsp;<span class="op" id="1685111">-</span><span class="num" id="1685112">1166</span><span class="op" id="1685116">,</span>&nbsp;<span class="builtintype" id="1685118">false</span><span class="op" id="1685123">}</span><span class="op" id="1685124">,</span>&nbsp;<span class="comment" id="1685126">//&nbsp;10^-332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685138">{</span><span class="num" id="1685139">0xcf42894a5dce35ea</span><span class="op" id="1685157">,</span>&nbsp;<span class="op" id="1685159">-</span><span class="num" id="1685160">1140</span><span class="op" id="1685164">,</span>&nbsp;<span class="builtintype" id="1685166">false</span><span class="op" id="1685171">}</span><span class="op" id="1685172">,</span>&nbsp;<span class="comment" id="1685174">//&nbsp;10^-324</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685186">{</span><span class="num" id="1685187">0x9a6bb0aa55653b2d</span><span class="op" id="1685205">,</span>&nbsp;<span class="op" id="1685207">-</span><span class="num" id="1685208">1113</span><span class="op" id="1685212">,</span>&nbsp;<span class="builtintype" id="1685214">false</span><span class="op" id="1685219">}</span><span class="op" id="1685220">,</span>&nbsp;<span class="comment" id="1685222">//&nbsp;10^-316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685234">{</span><span class="num" id="1685235">0xe61acf033d1a45df</span><span class="op" id="1685253">,</span>&nbsp;<span class="op" id="1685255">-</span><span class="num" id="1685256">1087</span><span class="op" id="1685260">,</span>&nbsp;<span class="builtintype" id="1685262">false</span><span class="op" id="1685267">}</span><span class="op" id="1685268">,</span>&nbsp;<span class="comment" id="1685270">//&nbsp;10^-308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685282">{</span><span class="num" id="1685283">0xab70fe17c79ac6ca</span><span class="op" id="1685301">,</span>&nbsp;<span class="op" id="1685303">-</span><span class="num" id="1685304">1060</span><span class="op" id="1685308">,</span>&nbsp;<span class="builtintype" id="1685310">false</span><span class="op" id="1685315">}</span><span class="op" id="1685316">,</span>&nbsp;<span class="comment" id="1685318">//&nbsp;10^-300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685330">{</span><span class="num" id="1685331">0xff77b1fcbebcdc4f</span><span class="op" id="1685349">,</span>&nbsp;<span class="op" id="1685351">-</span><span class="num" id="1685352">1034</span><span class="op" id="1685356">,</span>&nbsp;<span class="builtintype" id="1685358">false</span><span class="op" id="1685363">}</span><span class="op" id="1685364">,</span>&nbsp;<span class="comment" id="1685366">//&nbsp;10^-292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685378">{</span><span class="num" id="1685379">0xbe5691ef416bd60c</span><span class="op" id="1685397">,</span>&nbsp;<span class="op" id="1685399">-</span><span class="num" id="1685400">1007</span><span class="op" id="1685404">,</span>&nbsp;<span class="builtintype" id="1685406">false</span><span class="op" id="1685411">}</span><span class="op" id="1685412">,</span>&nbsp;<span class="comment" id="1685414">//&nbsp;10^-284</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685426">{</span><span class="num" id="1685427">0x8dd01fad907ffc3c</span><span class="op" id="1685445">,</span>&nbsp;<span class="op" id="1685447">-</span><span class="num" id="1685448">980</span><span class="op" id="1685451">,</span>&nbsp;<span class="builtintype" id="1685453">false</span><span class="op" id="1685458">}</span><span class="op" id="1685459">,</span>&nbsp;&nbsp;<span class="comment" id="1685462">//&nbsp;10^-276</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685474">{</span><span class="num" id="1685475">0xd3515c2831559a83</span><span class="op" id="1685493">,</span>&nbsp;<span class="op" id="1685495">-</span><span class="num" id="1685496">954</span><span class="op" id="1685499">,</span>&nbsp;<span class="builtintype" id="1685501">false</span><span class="op" id="1685506">}</span><span class="op" id="1685507">,</span>&nbsp;&nbsp;<span class="comment" id="1685510">//&nbsp;10^-268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685522">{</span><span class="num" id="1685523">0x9d71ac8fada6c9b5</span><span class="op" id="1685541">,</span>&nbsp;<span class="op" id="1685543">-</span><span class="num" id="1685544">927</span><span class="op" id="1685547">,</span>&nbsp;<span class="builtintype" id="1685549">false</span><span class="op" id="1685554">}</span><span class="op" id="1685555">,</span>&nbsp;&nbsp;<span class="comment" id="1685558">//&nbsp;10^-260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685570">{</span><span class="num" id="1685571">0xea9c227723ee8bcb</span><span class="op" id="1685589">,</span>&nbsp;<span class="op" id="1685591">-</span><span class="num" id="1685592">901</span><span class="op" id="1685595">,</span>&nbsp;<span class="builtintype" id="1685597">false</span><span class="op" id="1685602">}</span><span class="op" id="1685603">,</span>&nbsp;&nbsp;<span class="comment" id="1685606">//&nbsp;10^-252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685618">{</span><span class="num" id="1685619">0xaecc49914078536d</span><span class="op" id="1685637">,</span>&nbsp;<span class="op" id="1685639">-</span><span class="num" id="1685640">874</span><span class="op" id="1685643">,</span>&nbsp;<span class="builtintype" id="1685645">false</span><span class="op" id="1685650">}</span><span class="op" id="1685651">,</span>&nbsp;&nbsp;<span class="comment" id="1685654">//&nbsp;10^-244</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685666">{</span><span class="num" id="1685667">0x823c12795db6ce57</span><span class="op" id="1685685">,</span>&nbsp;<span class="op" id="1685687">-</span><span class="num" id="1685688">847</span><span class="op" id="1685691">,</span>&nbsp;<span class="builtintype" id="1685693">false</span><span class="op" id="1685698">}</span><span class="op" id="1685699">,</span>&nbsp;&nbsp;<span class="comment" id="1685702">//&nbsp;10^-236</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685714">{</span><span class="num" id="1685715">0xc21094364dfb5637</span><span class="op" id="1685733">,</span>&nbsp;<span class="op" id="1685735">-</span><span class="num" id="1685736">821</span><span class="op" id="1685739">,</span>&nbsp;<span class="builtintype" id="1685741">false</span><span class="op" id="1685746">}</span><span class="op" id="1685747">,</span>&nbsp;&nbsp;<span class="comment" id="1685750">//&nbsp;10^-228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685762">{</span><span class="num" id="1685763">0x9096ea6f3848984f</span><span class="op" id="1685781">,</span>&nbsp;<span class="op" id="1685783">-</span><span class="num" id="1685784">794</span><span class="op" id="1685787">,</span>&nbsp;<span class="builtintype" id="1685789">false</span><span class="op" id="1685794">}</span><span class="op" id="1685795">,</span>&nbsp;&nbsp;<span class="comment" id="1685798">//&nbsp;10^-220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685810">{</span><span class="num" id="1685811">0xd77485cb25823ac7</span><span class="op" id="1685829">,</span>&nbsp;<span class="op" id="1685831">-</span><span class="num" id="1685832">768</span><span class="op" id="1685835">,</span>&nbsp;<span class="builtintype" id="1685837">false</span><span class="op" id="1685842">}</span><span class="op" id="1685843">,</span>&nbsp;&nbsp;<span class="comment" id="1685846">//&nbsp;10^-212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685858">{</span><span class="num" id="1685859">0xa086cfcd97bf97f4</span><span class="op" id="1685877">,</span>&nbsp;<span class="op" id="1685879">-</span><span class="num" id="1685880">741</span><span class="op" id="1685883">,</span>&nbsp;<span class="builtintype" id="1685885">false</span><span class="op" id="1685890">}</span><span class="op" id="1685891">,</span>&nbsp;&nbsp;<span class="comment" id="1685894">//&nbsp;10^-204</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685906">{</span><span class="num" id="1685907">0xef340a98172aace5</span><span class="op" id="1685925">,</span>&nbsp;<span class="op" id="1685927">-</span><span class="num" id="1685928">715</span><span class="op" id="1685931">,</span>&nbsp;<span class="builtintype" id="1685933">false</span><span class="op" id="1685938">}</span><span class="op" id="1685939">,</span>&nbsp;&nbsp;<span class="comment" id="1685942">//&nbsp;10^-196</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1685954">{</span><span class="num" id="1685955">0xb23867fb2a35b28e</span><span class="op" id="1685973">,</span>&nbsp;<span class="op" id="1685975">-</span><span class="num" id="1685976">688</span><span class="op" id="1685979">,</span>&nbsp;<span class="builtintype" id="1685981">false</span><span class="op" id="1685986">}</span><span class="op" id="1685987">,</span>&nbsp;&nbsp;<span class="comment" id="1685990">//&nbsp;10^-188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686002">{</span><span class="num" id="1686003">0x84c8d4dfd2c63f3b</span><span class="op" id="1686021">,</span>&nbsp;<span class="op" id="1686023">-</span><span class="num" id="1686024">661</span><span class="op" id="1686027">,</span>&nbsp;<span class="builtintype" id="1686029">false</span><span class="op" id="1686034">}</span><span class="op" id="1686035">,</span>&nbsp;&nbsp;<span class="comment" id="1686038">//&nbsp;10^-180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686050">{</span><span class="num" id="1686051">0xc5dd44271ad3cdba</span><span class="op" id="1686069">,</span>&nbsp;<span class="op" id="1686071">-</span><span class="num" id="1686072">635</span><span class="op" id="1686075">,</span>&nbsp;<span class="builtintype" id="1686077">false</span><span class="op" id="1686082">}</span><span class="op" id="1686083">,</span>&nbsp;&nbsp;<span class="comment" id="1686086">//&nbsp;10^-172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686098">{</span><span class="num" id="1686099">0x936b9fcebb25c996</span><span class="op" id="1686117">,</span>&nbsp;<span class="op" id="1686119">-</span><span class="num" id="1686120">608</span><span class="op" id="1686123">,</span>&nbsp;<span class="builtintype" id="1686125">false</span><span class="op" id="1686130">}</span><span class="op" id="1686131">,</span>&nbsp;&nbsp;<span class="comment" id="1686134">//&nbsp;10^-164</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686146">{</span><span class="num" id="1686147">0xdbac6c247d62a584</span><span class="op" id="1686165">,</span>&nbsp;<span class="op" id="1686167">-</span><span class="num" id="1686168">582</span><span class="op" id="1686171">,</span>&nbsp;<span class="builtintype" id="1686173">false</span><span class="op" id="1686178">}</span><span class="op" id="1686179">,</span>&nbsp;&nbsp;<span class="comment" id="1686182">//&nbsp;10^-156</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686194">{</span><span class="num" id="1686195">0xa3ab66580d5fdaf6</span><span class="op" id="1686213">,</span>&nbsp;<span class="op" id="1686215">-</span><span class="num" id="1686216">555</span><span class="op" id="1686219">,</span>&nbsp;<span class="builtintype" id="1686221">false</span><span class="op" id="1686226">}</span><span class="op" id="1686227">,</span>&nbsp;&nbsp;<span class="comment" id="1686230">//&nbsp;10^-148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686242">{</span><span class="num" id="1686243">0xf3e2f893dec3f126</span><span class="op" id="1686261">,</span>&nbsp;<span class="op" id="1686263">-</span><span class="num" id="1686264">529</span><span class="op" id="1686267">,</span>&nbsp;<span class="builtintype" id="1686269">false</span><span class="op" id="1686274">}</span><span class="op" id="1686275">,</span>&nbsp;&nbsp;<span class="comment" id="1686278">//&nbsp;10^-140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686290">{</span><span class="num" id="1686291">0xb5b5ada8aaff80b8</span><span class="op" id="1686309">,</span>&nbsp;<span class="op" id="1686311">-</span><span class="num" id="1686312">502</span><span class="op" id="1686315">,</span>&nbsp;<span class="builtintype" id="1686317">false</span><span class="op" id="1686322">}</span><span class="op" id="1686323">,</span>&nbsp;&nbsp;<span class="comment" id="1686326">//&nbsp;10^-132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686338">{</span><span class="num" id="1686339">0x87625f056c7c4a8b</span><span class="op" id="1686357">,</span>&nbsp;<span class="op" id="1686359">-</span><span class="num" id="1686360">475</span><span class="op" id="1686363">,</span>&nbsp;<span class="builtintype" id="1686365">false</span><span class="op" id="1686370">}</span><span class="op" id="1686371">,</span>&nbsp;&nbsp;<span class="comment" id="1686374">//&nbsp;10^-124</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686386">{</span><span class="num" id="1686387">0xc9bcff6034c13053</span><span class="op" id="1686405">,</span>&nbsp;<span class="op" id="1686407">-</span><span class="num" id="1686408">449</span><span class="op" id="1686411">,</span>&nbsp;<span class="builtintype" id="1686413">false</span><span class="op" id="1686418">}</span><span class="op" id="1686419">,</span>&nbsp;&nbsp;<span class="comment" id="1686422">//&nbsp;10^-116</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686434">{</span><span class="num" id="1686435">0x964e858c91ba2655</span><span class="op" id="1686453">,</span>&nbsp;<span class="op" id="1686455">-</span><span class="num" id="1686456">422</span><span class="op" id="1686459">,</span>&nbsp;<span class="builtintype" id="1686461">false</span><span class="op" id="1686466">}</span><span class="op" id="1686467">,</span>&nbsp;&nbsp;<span class="comment" id="1686470">//&nbsp;10^-108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686482">{</span><span class="num" id="1686483">0xdff9772470297ebd</span><span class="op" id="1686501">,</span>&nbsp;<span class="op" id="1686503">-</span><span class="num" id="1686504">396</span><span class="op" id="1686507">,</span>&nbsp;<span class="builtintype" id="1686509">false</span><span class="op" id="1686514">}</span><span class="op" id="1686515">,</span>&nbsp;&nbsp;<span class="comment" id="1686518">//&nbsp;10^-100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686530">{</span><span class="num" id="1686531">0xa6dfbd9fb8e5b88f</span><span class="op" id="1686549">,</span>&nbsp;<span class="op" id="1686551">-</span><span class="num" id="1686552">369</span><span class="op" id="1686555">,</span>&nbsp;<span class="builtintype" id="1686557">false</span><span class="op" id="1686562">}</span><span class="op" id="1686563">,</span>&nbsp;&nbsp;<span class="comment" id="1686566">//&nbsp;10^-92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686577">{</span><span class="num" id="1686578">0xf8a95fcf88747d94</span><span class="op" id="1686596">,</span>&nbsp;<span class="op" id="1686598">-</span><span class="num" id="1686599">343</span><span class="op" id="1686602">,</span>&nbsp;<span class="builtintype" id="1686604">false</span><span class="op" id="1686609">}</span><span class="op" id="1686610">,</span>&nbsp;&nbsp;<span class="comment" id="1686613">//&nbsp;10^-84</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686624">{</span><span class="num" id="1686625">0xb94470938fa89bcf</span><span class="op" id="1686643">,</span>&nbsp;<span class="op" id="1686645">-</span><span class="num" id="1686646">316</span><span class="op" id="1686649">,</span>&nbsp;<span class="builtintype" id="1686651">false</span><span class="op" id="1686656">}</span><span class="op" id="1686657">,</span>&nbsp;&nbsp;<span class="comment" id="1686660">//&nbsp;10^-76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686671">{</span><span class="num" id="1686672">0x8a08f0f8bf0f156b</span><span class="op" id="1686690">,</span>&nbsp;<span class="op" id="1686692">-</span><span class="num" id="1686693">289</span><span class="op" id="1686696">,</span>&nbsp;<span class="builtintype" id="1686698">false</span><span class="op" id="1686703">}</span><span class="op" id="1686704">,</span>&nbsp;&nbsp;<span class="comment" id="1686707">//&nbsp;10^-68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686718">{</span><span class="num" id="1686719">0xcdb02555653131b6</span><span class="op" id="1686737">,</span>&nbsp;<span class="op" id="1686739">-</span><span class="num" id="1686740">263</span><span class="op" id="1686743">,</span>&nbsp;<span class="builtintype" id="1686745">false</span><span class="op" id="1686750">}</span><span class="op" id="1686751">,</span>&nbsp;&nbsp;<span class="comment" id="1686754">//&nbsp;10^-60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686765">{</span><span class="num" id="1686766">0x993fe2c6d07b7fac</span><span class="op" id="1686784">,</span>&nbsp;<span class="op" id="1686786">-</span><span class="num" id="1686787">236</span><span class="op" id="1686790">,</span>&nbsp;<span class="builtintype" id="1686792">false</span><span class="op" id="1686797">}</span><span class="op" id="1686798">,</span>&nbsp;&nbsp;<span class="comment" id="1686801">//&nbsp;10^-52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686812">{</span><span class="num" id="1686813">0xe45c10c42a2b3b06</span><span class="op" id="1686831">,</span>&nbsp;<span class="op" id="1686833">-</span><span class="num" id="1686834">210</span><span class="op" id="1686837">,</span>&nbsp;<span class="builtintype" id="1686839">false</span><span class="op" id="1686844">}</span><span class="op" id="1686845">,</span>&nbsp;&nbsp;<span class="comment" id="1686848">//&nbsp;10^-44</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686859">{</span><span class="num" id="1686860">0xaa242499697392d3</span><span class="op" id="1686878">,</span>&nbsp;<span class="op" id="1686880">-</span><span class="num" id="1686881">183</span><span class="op" id="1686884">,</span>&nbsp;<span class="builtintype" id="1686886">false</span><span class="op" id="1686891">}</span><span class="op" id="1686892">,</span>&nbsp;&nbsp;<span class="comment" id="1686895">//&nbsp;10^-36</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686906">{</span><span class="num" id="1686907">0xfd87b5f28300ca0e</span><span class="op" id="1686925">,</span>&nbsp;<span class="op" id="1686927">-</span><span class="num" id="1686928">157</span><span class="op" id="1686931">,</span>&nbsp;<span class="builtintype" id="1686933">false</span><span class="op" id="1686938">}</span><span class="op" id="1686939">,</span>&nbsp;&nbsp;<span class="comment" id="1686942">//&nbsp;10^-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1686953">{</span><span class="num" id="1686954">0xbce5086492111aeb</span><span class="op" id="1686972">,</span>&nbsp;<span class="op" id="1686974">-</span><span class="num" id="1686975">130</span><span class="op" id="1686978">,</span>&nbsp;<span class="builtintype" id="1686980">false</span><span class="op" id="1686985">}</span><span class="op" id="1686986">,</span>&nbsp;&nbsp;<span class="comment" id="1686989">//&nbsp;10^-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687000">{</span><span class="num" id="1687001">0x8cbccc096f5088cc</span><span class="op" id="1687019">,</span>&nbsp;<span class="op" id="1687021">-</span><span class="num" id="1687022">103</span><span class="op" id="1687025">,</span>&nbsp;<span class="builtintype" id="1687027">false</span><span class="op" id="1687032">}</span><span class="op" id="1687033">,</span>&nbsp;&nbsp;<span class="comment" id="1687036">//&nbsp;10^-12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687047">{</span><span class="num" id="1687048">0xd1b71758e219652c</span><span class="op" id="1687066">,</span>&nbsp;<span class="op" id="1687068">-</span><span class="num" id="1687069">77</span><span class="op" id="1687071">,</span>&nbsp;<span class="builtintype" id="1687073">false</span><span class="op" id="1687078">}</span><span class="op" id="1687079">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687083">//&nbsp;10^-4</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687093">{</span><span class="num" id="1687094">0x9c40000000000000</span><span class="op" id="1687112">,</span>&nbsp;<span class="op" id="1687114">-</span><span class="num" id="1687115">50</span><span class="op" id="1687117">,</span>&nbsp;<span class="builtintype" id="1687119">false</span><span class="op" id="1687124">}</span><span class="op" id="1687125">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687129">//&nbsp;10^4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687138">{</span><span class="num" id="1687139">0xe8d4a51000000000</span><span class="op" id="1687157">,</span>&nbsp;<span class="op" id="1687159">-</span><span class="num" id="1687160">24</span><span class="op" id="1687162">,</span>&nbsp;<span class="builtintype" id="1687164">false</span><span class="op" id="1687169">}</span><span class="op" id="1687170">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687174">//&nbsp;10^12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687184">{</span><span class="num" id="1687185">0xad78ebc5ac620000</span><span class="op" id="1687203">,</span>&nbsp;<span class="num" id="1687205">3</span><span class="op" id="1687206">,</span>&nbsp;<span class="builtintype" id="1687208">false</span><span class="op" id="1687213">}</span><span class="op" id="1687214">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1687220">//&nbsp;10^20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687230">{</span><span class="num" id="1687231">0x813f3978f8940984</span><span class="op" id="1687249">,</span>&nbsp;<span class="num" id="1687251">30</span><span class="op" id="1687253">,</span>&nbsp;<span class="builtintype" id="1687255">false</span><span class="op" id="1687260">}</span><span class="op" id="1687261">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1687266">//&nbsp;10^28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687276">{</span><span class="num" id="1687277">0xc097ce7bc90715b3</span><span class="op" id="1687295">,</span>&nbsp;<span class="num" id="1687297">56</span><span class="op" id="1687299">,</span>&nbsp;<span class="builtintype" id="1687301">false</span><span class="op" id="1687306">}</span><span class="op" id="1687307">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1687312">//&nbsp;10^36</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687322">{</span><span class="num" id="1687323">0x8f7e32ce7bea5c70</span><span class="op" id="1687341">,</span>&nbsp;<span class="num" id="1687343">83</span><span class="op" id="1687345">,</span>&nbsp;<span class="builtintype" id="1687347">false</span><span class="op" id="1687352">}</span><span class="op" id="1687353">,</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1687358">//&nbsp;10^44</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687368">{</span><span class="num" id="1687369">0xd5d238a4abe98068</span><span class="op" id="1687387">,</span>&nbsp;<span class="num" id="1687389">109</span><span class="op" id="1687392">,</span>&nbsp;<span class="builtintype" id="1687394">false</span><span class="op" id="1687399">}</span><span class="op" id="1687400">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687404">//&nbsp;10^52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687414">{</span><span class="num" id="1687415">0x9f4f2726179a2245</span><span class="op" id="1687433">,</span>&nbsp;<span class="num" id="1687435">136</span><span class="op" id="1687438">,</span>&nbsp;<span class="builtintype" id="1687440">false</span><span class="op" id="1687445">}</span><span class="op" id="1687446">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687450">//&nbsp;10^60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687460">{</span><span class="num" id="1687461">0xed63a231d4c4fb27</span><span class="op" id="1687479">,</span>&nbsp;<span class="num" id="1687481">162</span><span class="op" id="1687484">,</span>&nbsp;<span class="builtintype" id="1687486">false</span><span class="op" id="1687491">}</span><span class="op" id="1687492">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687496">//&nbsp;10^68</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687506">{</span><span class="num" id="1687507">0xb0de65388cc8ada8</span><span class="op" id="1687525">,</span>&nbsp;<span class="num" id="1687527">189</span><span class="op" id="1687530">,</span>&nbsp;<span class="builtintype" id="1687532">false</span><span class="op" id="1687537">}</span><span class="op" id="1687538">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687542">//&nbsp;10^76</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687552">{</span><span class="num" id="1687553">0x83c7088e1aab65db</span><span class="op" id="1687571">,</span>&nbsp;<span class="num" id="1687573">216</span><span class="op" id="1687576">,</span>&nbsp;<span class="builtintype" id="1687578">false</span><span class="op" id="1687583">}</span><span class="op" id="1687584">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687588">//&nbsp;10^84</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687598">{</span><span class="num" id="1687599">0xc45d1df942711d9a</span><span class="op" id="1687617">,</span>&nbsp;<span class="num" id="1687619">242</span><span class="op" id="1687622">,</span>&nbsp;<span class="builtintype" id="1687624">false</span><span class="op" id="1687629">}</span><span class="op" id="1687630">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687634">//&nbsp;10^92</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687644">{</span><span class="num" id="1687645">0x924d692ca61be758</span><span class="op" id="1687663">,</span>&nbsp;<span class="num" id="1687665">269</span><span class="op" id="1687668">,</span>&nbsp;<span class="builtintype" id="1687670">false</span><span class="op" id="1687675">}</span><span class="op" id="1687676">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687680">//&nbsp;10^100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687691">{</span><span class="num" id="1687692">0xda01ee641a708dea</span><span class="op" id="1687710">,</span>&nbsp;<span class="num" id="1687712">295</span><span class="op" id="1687715">,</span>&nbsp;<span class="builtintype" id="1687717">false</span><span class="op" id="1687722">}</span><span class="op" id="1687723">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687727">//&nbsp;10^108</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687738">{</span><span class="num" id="1687739">0xa26da3999aef774a</span><span class="op" id="1687757">,</span>&nbsp;<span class="num" id="1687759">322</span><span class="op" id="1687762">,</span>&nbsp;<span class="builtintype" id="1687764">false</span><span class="op" id="1687769">}</span><span class="op" id="1687770">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687774">//&nbsp;10^116</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687785">{</span><span class="num" id="1687786">0xf209787bb47d6b85</span><span class="op" id="1687804">,</span>&nbsp;<span class="num" id="1687806">348</span><span class="op" id="1687809">,</span>&nbsp;<span class="builtintype" id="1687811">false</span><span class="op" id="1687816">}</span><span class="op" id="1687817">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687821">//&nbsp;10^124</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687832">{</span><span class="num" id="1687833">0xb454e4a179dd1877</span><span class="op" id="1687851">,</span>&nbsp;<span class="num" id="1687853">375</span><span class="op" id="1687856">,</span>&nbsp;<span class="builtintype" id="1687858">false</span><span class="op" id="1687863">}</span><span class="op" id="1687864">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687868">//&nbsp;10^132</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687879">{</span><span class="num" id="1687880">0x865b86925b9bc5c2</span><span class="op" id="1687898">,</span>&nbsp;<span class="num" id="1687900">402</span><span class="op" id="1687903">,</span>&nbsp;<span class="builtintype" id="1687905">false</span><span class="op" id="1687910">}</span><span class="op" id="1687911">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687915">//&nbsp;10^140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687926">{</span><span class="num" id="1687927">0xc83553c5c8965d3d</span><span class="op" id="1687945">,</span>&nbsp;<span class="num" id="1687947">428</span><span class="op" id="1687950">,</span>&nbsp;<span class="builtintype" id="1687952">false</span><span class="op" id="1687957">}</span><span class="op" id="1687958">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1687962">//&nbsp;10^148</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1687973">{</span><span class="num" id="1687974">0x952ab45cfa97a0b3</span><span class="op" id="1687992">,</span>&nbsp;<span class="num" id="1687994">455</span><span class="op" id="1687997">,</span>&nbsp;<span class="builtintype" id="1687999">false</span><span class="op" id="1688004">}</span><span class="op" id="1688005">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688009">//&nbsp;10^156</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688020">{</span><span class="num" id="1688021">0xde469fbd99a05fe3</span><span class="op" id="1688039">,</span>&nbsp;<span class="num" id="1688041">481</span><span class="op" id="1688044">,</span>&nbsp;<span class="builtintype" id="1688046">false</span><span class="op" id="1688051">}</span><span class="op" id="1688052">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688056">//&nbsp;10^164</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688067">{</span><span class="num" id="1688068">0xa59bc234db398c25</span><span class="op" id="1688086">,</span>&nbsp;<span class="num" id="1688088">508</span><span class="op" id="1688091">,</span>&nbsp;<span class="builtintype" id="1688093">false</span><span class="op" id="1688098">}</span><span class="op" id="1688099">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688103">//&nbsp;10^172</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688114">{</span><span class="num" id="1688115">0xf6c69a72a3989f5c</span><span class="op" id="1688133">,</span>&nbsp;<span class="num" id="1688135">534</span><span class="op" id="1688138">,</span>&nbsp;<span class="builtintype" id="1688140">false</span><span class="op" id="1688145">}</span><span class="op" id="1688146">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688150">//&nbsp;10^180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688161">{</span><span class="num" id="1688162">0xb7dcbf5354e9bece</span><span class="op" id="1688180">,</span>&nbsp;<span class="num" id="1688182">561</span><span class="op" id="1688185">,</span>&nbsp;<span class="builtintype" id="1688187">false</span><span class="op" id="1688192">}</span><span class="op" id="1688193">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688197">//&nbsp;10^188</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688208">{</span><span class="num" id="1688209">0x88fcf317f22241e2</span><span class="op" id="1688227">,</span>&nbsp;<span class="num" id="1688229">588</span><span class="op" id="1688232">,</span>&nbsp;<span class="builtintype" id="1688234">false</span><span class="op" id="1688239">}</span><span class="op" id="1688240">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688244">//&nbsp;10^196</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688255">{</span><span class="num" id="1688256">0xcc20ce9bd35c78a5</span><span class="op" id="1688274">,</span>&nbsp;<span class="num" id="1688276">614</span><span class="op" id="1688279">,</span>&nbsp;<span class="builtintype" id="1688281">false</span><span class="op" id="1688286">}</span><span class="op" id="1688287">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688291">//&nbsp;10^204</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688302">{</span><span class="num" id="1688303">0x98165af37b2153df</span><span class="op" id="1688321">,</span>&nbsp;<span class="num" id="1688323">641</span><span class="op" id="1688326">,</span>&nbsp;<span class="builtintype" id="1688328">false</span><span class="op" id="1688333">}</span><span class="op" id="1688334">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688338">//&nbsp;10^212</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688349">{</span><span class="num" id="1688350">0xe2a0b5dc971f303a</span><span class="op" id="1688368">,</span>&nbsp;<span class="num" id="1688370">667</span><span class="op" id="1688373">,</span>&nbsp;<span class="builtintype" id="1688375">false</span><span class="op" id="1688380">}</span><span class="op" id="1688381">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688385">//&nbsp;10^220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688396">{</span><span class="num" id="1688397">0xa8d9d1535ce3b396</span><span class="op" id="1688415">,</span>&nbsp;<span class="num" id="1688417">694</span><span class="op" id="1688420">,</span>&nbsp;<span class="builtintype" id="1688422">false</span><span class="op" id="1688427">}</span><span class="op" id="1688428">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688432">//&nbsp;10^228</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688443">{</span><span class="num" id="1688444">0xfb9b7cd9a4a7443c</span><span class="op" id="1688462">,</span>&nbsp;<span class="num" id="1688464">720</span><span class="op" id="1688467">,</span>&nbsp;<span class="builtintype" id="1688469">false</span><span class="op" id="1688474">}</span><span class="op" id="1688475">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688479">//&nbsp;10^236</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688490">{</span><span class="num" id="1688491">0xbb764c4ca7a44410</span><span class="op" id="1688509">,</span>&nbsp;<span class="num" id="1688511">747</span><span class="op" id="1688514">,</span>&nbsp;<span class="builtintype" id="1688516">false</span><span class="op" id="1688521">}</span><span class="op" id="1688522">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688526">//&nbsp;10^244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688537">{</span><span class="num" id="1688538">0x8bab8eefb6409c1a</span><span class="op" id="1688556">,</span>&nbsp;<span class="num" id="1688558">774</span><span class="op" id="1688561">,</span>&nbsp;<span class="builtintype" id="1688563">false</span><span class="op" id="1688568">}</span><span class="op" id="1688569">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688573">//&nbsp;10^252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688584">{</span><span class="num" id="1688585">0xd01fef10a657842c</span><span class="op" id="1688603">,</span>&nbsp;<span class="num" id="1688605">800</span><span class="op" id="1688608">,</span>&nbsp;<span class="builtintype" id="1688610">false</span><span class="op" id="1688615">}</span><span class="op" id="1688616">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688620">//&nbsp;10^260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688631">{</span><span class="num" id="1688632">0x9b10a4e5e9913129</span><span class="op" id="1688650">,</span>&nbsp;<span class="num" id="1688652">827</span><span class="op" id="1688655">,</span>&nbsp;<span class="builtintype" id="1688657">false</span><span class="op" id="1688662">}</span><span class="op" id="1688663">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688667">//&nbsp;10^268</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688678">{</span><span class="num" id="1688679">0xe7109bfba19c0c9d</span><span class="op" id="1688697">,</span>&nbsp;<span class="num" id="1688699">853</span><span class="op" id="1688702">,</span>&nbsp;<span class="builtintype" id="1688704">false</span><span class="op" id="1688709">}</span><span class="op" id="1688710">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688714">//&nbsp;10^276</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688725">{</span><span class="num" id="1688726">0xac2820d9623bf429</span><span class="op" id="1688744">,</span>&nbsp;<span class="num" id="1688746">880</span><span class="op" id="1688749">,</span>&nbsp;<span class="builtintype" id="1688751">false</span><span class="op" id="1688756">}</span><span class="op" id="1688757">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688761">//&nbsp;10^284</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688772">{</span><span class="num" id="1688773">0x80444b5e7aa7cf85</span><span class="op" id="1688791">,</span>&nbsp;<span class="num" id="1688793">907</span><span class="op" id="1688796">,</span>&nbsp;<span class="builtintype" id="1688798">false</span><span class="op" id="1688803">}</span><span class="op" id="1688804">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688808">//&nbsp;10^292</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688819">{</span><span class="num" id="1688820">0xbf21e44003acdd2d</span><span class="op" id="1688838">,</span>&nbsp;<span class="num" id="1688840">933</span><span class="op" id="1688843">,</span>&nbsp;<span class="builtintype" id="1688845">false</span><span class="op" id="1688850">}</span><span class="op" id="1688851">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688855">//&nbsp;10^300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688866">{</span><span class="num" id="1688867">0x8e679c2f5e44ff8f</span><span class="op" id="1688885">,</span>&nbsp;<span class="num" id="1688887">960</span><span class="op" id="1688890">,</span>&nbsp;<span class="builtintype" id="1688892">false</span><span class="op" id="1688897">}</span><span class="op" id="1688898">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688902">//&nbsp;10^308</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688913">{</span><span class="num" id="1688914">0xd433179d9c8cb841</span><span class="op" id="1688932">,</span>&nbsp;<span class="num" id="1688934">986</span><span class="op" id="1688937">,</span>&nbsp;<span class="builtintype" id="1688939">false</span><span class="op" id="1688944">}</span><span class="op" id="1688945">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1688949">//&nbsp;10^316</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1688960">{</span><span class="num" id="1688961">0x9e19db92b4e31ba9</span><span class="op" id="1688979">,</span>&nbsp;<span class="num" id="1688981">1013</span><span class="op" id="1688985">,</span>&nbsp;<span class="builtintype" id="1688987">false</span><span class="op" id="1688992">}</span><span class="op" id="1688993">,</span>&nbsp;&nbsp;<span class="comment" id="1688996">//&nbsp;10^324</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1689007">{</span><span class="num" id="1689008">0xeb96bf6ebadf77d9</span><span class="op" id="1689026">,</span>&nbsp;<span class="num" id="1689028">1039</span><span class="op" id="1689032">,</span>&nbsp;<span class="builtintype" id="1689034">false</span><span class="op" id="1689039">}</span><span class="op" id="1689040">,</span>&nbsp;&nbsp;<span class="comment" id="1689043">//&nbsp;10^332</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1689054">{</span><span class="num" id="1689055">0xaf87023b9bf0ee6b</span><span class="op" id="1689073">,</span>&nbsp;<span class="num" id="1689075">1066</span><span class="op" id="1689079">,</span>&nbsp;<span class="builtintype" id="1689081">false</span><span class="op" id="1689086">}</span><span class="op" id="1689087">,</span>&nbsp;&nbsp;<span class="comment" id="1689090">//&nbsp;10^340</span><br>
<span class="lineno"></span><span class="op" id="1689100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="1689103">//&nbsp;floatBits&nbsp;returns&nbsp;the&nbsp;bits&nbsp;of&nbsp;the&nbsp;float64&nbsp;that&nbsp;best&nbsp;approximates</span><br>
<span class="lineno"></span><span class="comment" id="1689171">//&nbsp;the&nbsp;extFloat&nbsp;passed&nbsp;as&nbsp;receiver.&nbsp;Overflow&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="1689234">//&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;is&nbsp;±Inf.</span><br>
<span class="lineno"></span><span class="keyword" id="1689269">func</span>&nbsp;<span class="op" id="1689274">(</span><span class="ident" id="1689275">f</span>&nbsp;<span class="op" id="1689277">*</span><span class="ident" id="1689278">extFloat</span><span class="op" id="1689286">)</span>&nbsp;<span class="ident" id="1689288">floatBits</span><span class="op" id="1689297">(</span><span class="ident" id="1689298">flt</span>&nbsp;<span class="op" id="1689302">*</span><span class="ident" id="1689303">floatInfo</span><span class="op" id="1689312">)</span>&nbsp;<span class="op" id="1689314">(</span><span class="ident" id="1689315">bits</span>&nbsp;<span class="ident" id="1689320">uint64</span><span class="op" id="1689326">,</span>&nbsp;<span class="ident" id="1689328">overflow</span>&nbsp;<span class="builtintype" id="1689337">bool</span><span class="op" id="1689341">)</span>&nbsp;<span class="op" id="1689343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689346">f</span><span class="op" id="1689347">.</span><span class="ident" id="1689348">Normalize</span><span class="op" id="1689357">(</span><span class="op" id="1689358">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689362">exp</span>&nbsp;<span class="op" id="1689366">:=</span>&nbsp;<span class="ident" id="1689369">f</span><span class="op" id="1689370">.</span><span class="ident" id="1689371">exp</span>&nbsp;<span class="op" id="1689375">+</span>&nbsp;<span class="num" id="1689377">63</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1689382">//&nbsp;Exponent&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1689406">if</span>&nbsp;<span class="ident" id="1689409">exp</span>&nbsp;<span class="op" id="1689413">&lt;</span>&nbsp;<span class="ident" id="1689415">flt</span><span class="op" id="1689418">.</span><span class="ident" id="1689419">bias</span><span class="op" id="1689423">+</span><span class="num" id="1689424">1</span>&nbsp;<span class="op" id="1689426">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689430">n</span>&nbsp;<span class="op" id="1689432">:=</span>&nbsp;<span class="ident" id="1689435">flt</span><span class="op" id="1689438">.</span><span class="ident" id="1689439">bias</span>&nbsp;<span class="op" id="1689444">+</span>&nbsp;<span class="num" id="1689446">1</span>&nbsp;<span class="op" id="1689448">-</span>&nbsp;<span class="ident" id="1689450">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689456">f</span><span class="op" id="1689457">.</span><span class="ident" id="1689458">mant</span>&nbsp;<span class="op" id="1689463">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="1689467">uint</span><span class="op" id="1689471">(</span><span class="ident" id="1689472">n</span><span class="op" id="1689473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689477">exp</span>&nbsp;<span class="op" id="1689481">+=</span>&nbsp;<span class="ident" id="1689484">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1689487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1689491">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits&nbsp;from&nbsp;the&nbsp;64-bit&nbsp;mantissa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689549">mant</span>&nbsp;<span class="op" id="1689554">:=</span>&nbsp;<span class="ident" id="1689557">f</span><span class="op" id="1689558">.</span><span class="ident" id="1689559">mant</span>&nbsp;<span class="op" id="1689564">&gt;&gt;</span>&nbsp;<span class="op" id="1689567">(</span><span class="num" id="1689568">63</span>&nbsp;<span class="op" id="1689571">-</span>&nbsp;<span class="ident" id="1689573">flt</span><span class="op" id="1689576">.</span><span class="ident" id="1689577">mantbits</span><span class="op" id="1689585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1689588">if</span>&nbsp;<span class="ident" id="1689591">f</span><span class="op" id="1689592">.</span><span class="ident" id="1689593">mant</span><span class="op" id="1689597">&amp;</span><span class="op" id="1689598">(</span><span class="num" id="1689599">1</span><span class="op" id="1689600">&lt;&lt;</span><span class="op" id="1689602">(</span><span class="num" id="1689603">62</span><span class="op" id="1689605">-</span><span class="ident" id="1689606">flt</span><span class="op" id="1689609">.</span><span class="ident" id="1689610">mantbits</span><span class="op" id="1689618">)</span><span class="op" id="1689619">)</span>&nbsp;<span class="op" id="1689621">!=</span>&nbsp;<span class="num" id="1689624">0</span>&nbsp;<span class="op" id="1689626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1689630">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689645">mant</span>&nbsp;<span class="op" id="1689650">+=</span>&nbsp;<span class="num" id="1689653">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1689656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1689660">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1689709">if</span>&nbsp;<span class="ident" id="1689712">mant</span>&nbsp;<span class="op" id="1689717">==</span>&nbsp;<span class="num" id="1689720">2</span><span class="op" id="1689721">&lt;&lt;</span><span class="ident" id="1689723">flt</span><span class="op" id="1689726">.</span><span class="ident" id="1689727">mantbits</span>&nbsp;<span class="op" id="1689736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689740">mant</span>&nbsp;<span class="op" id="1689745">&gt;&gt;=</span>&nbsp;<span class="num" id="1689749">1</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689753">exp</span><span class="op" id="1689756">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1689760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1689764">//&nbsp;Infinities.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1689780">if</span>&nbsp;<span class="ident" id="1689783">exp</span><span class="op" id="1689786">-</span><span class="ident" id="1689787">flt</span><span class="op" id="1689790">.</span><span class="ident" id="1689791">bias</span>&nbsp;<span class="op" id="1689796">&gt;=</span>&nbsp;<span class="num" id="1689799">1</span><span class="op" id="1689800">&lt;&lt;</span><span class="ident" id="1689802">flt</span><span class="op" id="1689805">.</span><span class="ident" id="1689806">expbits</span><span class="op" id="1689813">-</span><span class="num" id="1689814">1</span>&nbsp;<span class="op" id="1689816">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1689820">//&nbsp;±Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689831">mant</span>&nbsp;<span class="op" id="1689836">=</span>&nbsp;<span class="num" id="1689838">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689842">exp</span>&nbsp;<span class="op" id="1689846">=</span>&nbsp;<span class="num" id="1689848">1</span><span class="op" id="1689849">&lt;&lt;</span><span class="ident" id="1689851">flt</span><span class="op" id="1689854">.</span><span class="ident" id="1689855">expbits</span>&nbsp;<span class="op" id="1689863">-</span>&nbsp;<span class="num" id="1689865">1</span>&nbsp;<span class="op" id="1689867">+</span>&nbsp;<span class="ident" id="1689869">flt</span><span class="op" id="1689872">.</span><span class="ident" id="1689873">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689880">overflow</span>&nbsp;<span class="op" id="1689889">=</span>&nbsp;<span class="builtintype" id="1689891">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1689897">}</span>&nbsp;<span class="keyword" id="1689899">else</span>&nbsp;<span class="keyword" id="1689904">if</span>&nbsp;<span class="ident" id="1689907">mant</span><span class="op" id="1689911">&amp;</span><span class="op" id="1689912">(</span><span class="num" id="1689913">1</span><span class="op" id="1689914">&lt;&lt;</span><span class="ident" id="1689916">flt</span><span class="op" id="1689919">.</span><span class="ident" id="1689920">mantbits</span><span class="op" id="1689928">)</span>&nbsp;<span class="op" id="1689930">==</span>&nbsp;<span class="num" id="1689933">0</span>&nbsp;<span class="op" id="1689935">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1689939">//&nbsp;Denormalized?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689958">exp</span>&nbsp;<span class="op" id="1689962">=</span>&nbsp;<span class="ident" id="1689964">flt</span><span class="op" id="1689967">.</span><span class="ident" id="1689968">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1689974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1689977">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1689996">bits</span>&nbsp;<span class="op" id="1690001">=</span>&nbsp;<span class="ident" id="1690003">mant</span>&nbsp;<span class="op" id="1690008">&amp;</span>&nbsp;<span class="op" id="1690010">(</span><span class="ident" id="1690011">uint64</span><span class="op" id="1690017">(</span><span class="num" id="1690018">1</span><span class="op" id="1690019">)</span><span class="op" id="1690020">&lt;&lt;</span><span class="ident" id="1690022">flt</span><span class="op" id="1690025">.</span><span class="ident" id="1690026">mantbits</span>&nbsp;<span class="op" id="1690035">-</span>&nbsp;<span class="num" id="1690037">1</span><span class="op" id="1690038">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1690041">bits</span>&nbsp;<span class="op" id="1690046">|=</span>&nbsp;<span class="ident" id="1690049">uint64</span><span class="op" id="1690055">(</span><span class="op" id="1690056">(</span><span class="ident" id="1690057">exp</span><span class="op" id="1690060">-</span><span class="ident" id="1690061">flt</span><span class="op" id="1690064">.</span><span class="ident" id="1690065">bias</span><span class="op" id="1690069">)</span><span class="op" id="1690070">&amp;</span><span class="op" id="1690071">(</span><span class="num" id="1690072">1</span><span class="op" id="1690073">&lt;&lt;</span><span class="ident" id="1690075">flt</span><span class="op" id="1690078">.</span><span class="ident" id="1690079">expbits</span><span class="op" id="1690086">-</span><span class="num" id="1690087">1</span><span class="op" id="1690088">)</span><span class="op" id="1690089">)</span>&nbsp;<span class="op" id="1690091">&lt;&lt;</span>&nbsp;<span class="ident" id="1690094">flt</span><span class="op" id="1690097">.</span><span class="ident" id="1690098">mantbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1690108">if</span>&nbsp;<span class="ident" id="1690111">f</span><span class="op" id="1690112">.</span><span class="ident" id="1690113">neg</span>&nbsp;<span class="op" id="1690117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1690121">bits</span>&nbsp;<span class="op" id="1690126">|=</span>&nbsp;<span class="num" id="1690129">1</span>&nbsp;<span class="op" id="1690131">&lt;&lt;</span>&nbsp;<span class="op" id="1690134">(</span><span class="ident" id="1690135">flt</span><span class="op" id="1690138">.</span><span class="ident" id="1690139">mantbits</span>&nbsp;<span class="op" id="1690148">+</span>&nbsp;<span class="ident" id="1690150">flt</span><span class="op" id="1690153">.</span><span class="ident" id="1690154">expbits</span><span class="op" id="1690161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1690164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1690167">return</span><br>
<span class="lineno">170</span><span class="op" id="1690174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1690177">//&nbsp;AssignComputeBounds&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;floating&nbsp;point&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="1690235">//&nbsp;defined&nbsp;by&nbsp;mant,&nbsp;exp&nbsp;and&nbsp;precision&nbsp;given&nbsp;by&nbsp;flt.&nbsp;It&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="1690298">//&nbsp;lower,&nbsp;upper&nbsp;such&nbsp;that&nbsp;any&nbsp;number&nbsp;in&nbsp;the&nbsp;closed&nbsp;interval</span><br>
<span class="lineno">175</span><span class="comment" id="1690358">//&nbsp;[lower,&nbsp;upper]&nbsp;is&nbsp;converted&nbsp;back&nbsp;to&nbsp;the&nbsp;same&nbsp;floating&nbsp;point&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="1690429">func</span>&nbsp;<span class="op" id="1690434">(</span><span class="ident" id="1690435">f</span>&nbsp;<span class="op" id="1690437">*</span><span class="ident" id="1690438">extFloat</span><span class="op" id="1690446">)</span>&nbsp;<span class="ident" id="1690448">AssignComputeBounds</span><span class="op" id="1690467">(</span><span class="ident" id="1690468">mant</span>&nbsp;<span class="ident" id="1690473">uint64</span><span class="op" id="1690479">,</span>&nbsp;<span class="ident" id="1690481">exp</span>&nbsp;<span class="builtintype" id="1690485">int</span><span class="op" id="1690488">,</span>&nbsp;<span class="ident" id="1690490">neg</span>&nbsp;<span class="builtintype" id="1690494">bool</span><span class="op" id="1690498">,</span>&nbsp;<span class="ident" id="1690500">flt</span>&nbsp;<span class="op" id="1690504">*</span><span class="ident" id="1690505">floatInfo</span><span class="op" id="1690514">)</span>&nbsp;<span class="op" id="1690516">(</span><span class="ident" id="1690517">lower</span><span class="op" id="1690522">,</span>&nbsp;<span class="ident" id="1690524">upper</span>&nbsp;<span class="ident" id="1690530">extFloat</span><span class="op" id="1690538">)</span>&nbsp;<span class="op" id="1690540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1690543">f</span><span class="op" id="1690544">.</span><span class="ident" id="1690545">mant</span>&nbsp;<span class="op" id="1690550">=</span>&nbsp;<span class="ident" id="1690552">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1690558">f</span><span class="op" id="1690559">.</span><span class="ident" id="1690560">exp</span>&nbsp;<span class="op" id="1690564">=</span>&nbsp;<span class="ident" id="1690566">exp</span>&nbsp;<span class="op" id="1690570">-</span>&nbsp;<span class="builtintype" id="1690572">int</span><span class="op" id="1690575">(</span><span class="ident" id="1690576">flt</span><span class="op" id="1690579">.</span><span class="ident" id="1690580">mantbits</span><span class="op" id="1690588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1690591">f</span><span class="op" id="1690592">.</span><span class="ident" id="1690593">neg</span>&nbsp;<span class="op" id="1690597">=</span>&nbsp;<span class="ident" id="1690599">neg</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1690604">if</span>&nbsp;<span class="ident" id="1690607">f</span><span class="op" id="1690608">.</span><span class="ident" id="1690609">exp</span>&nbsp;<span class="op" id="1690613">&lt;=</span>&nbsp;<span class="num" id="1690616">0</span>&nbsp;<span class="op" id="1690618">&amp;&amp;</span>&nbsp;<span class="ident" id="1690621">mant</span>&nbsp;<span class="op" id="1690626">==</span>&nbsp;<span class="op" id="1690629">(</span><span class="ident" id="1690630">mant</span><span class="op" id="1690634">&gt;&gt;</span><span class="builtintype" id="1690636">uint</span><span class="op" id="1690640">(</span><span class="op" id="1690641">-</span><span class="ident" id="1690642">f</span><span class="op" id="1690643">.</span><span class="ident" id="1690644">exp</span><span class="op" id="1690647">)</span><span class="op" id="1690648">)</span><span class="op" id="1690649">&lt;&lt;</span><span class="builtintype" id="1690651">uint</span><span class="op" id="1690655">(</span><span class="op" id="1690656">-</span><span class="ident" id="1690657">f</span><span class="op" id="1690658">.</span><span class="ident" id="1690659">exp</span><span class="op" id="1690662">)</span>&nbsp;<span class="op" id="1690664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1690668">//&nbsp;An&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1690690">f</span><span class="op" id="1690691">.</span><span class="ident" id="1690692">mant</span>&nbsp;<span class="op" id="1690697">&gt;&gt;=</span>&nbsp;<span class="builtintype" id="1690701">uint</span><span class="op" id="1690705">(</span><span class="op" id="1690706">-</span><span class="ident" id="1690707">f</span><span class="op" id="1690708">.</span><span class="ident" id="1690709">exp</span><span class="op" id="1690712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1690716">f</span><span class="op" id="1690717">.</span><span class="ident" id="1690718">exp</span>&nbsp;<span class="op" id="1690722">=</span>&nbsp;<span class="num" id="1690724">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1690728">return</span>&nbsp;<span class="op" id="1690735">*</span><span class="ident" id="1690736">f</span><span class="op" id="1690737">,</span>&nbsp;<span class="op" id="1690739">*</span><span class="ident" id="1690740">f</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1690743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1690746">expBiased</span>&nbsp;<span class="op" id="1690756">:=</span>&nbsp;<span class="ident" id="1690759">exp</span>&nbsp;<span class="op" id="1690763">-</span>&nbsp;<span class="ident" id="1690765">flt</span><span class="op" id="1690768">.</span><span class="ident" id="1690769">bias</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1690776">upper</span>&nbsp;<span class="op" id="1690782">=</span>&nbsp;<span class="ident" id="1690784">extFloat</span><span class="op" id="1690792">{</span><span class="ident" id="1690793">mant</span><span class="op" id="1690797">:</span>&nbsp;<span class="num" id="1690799">2</span><span class="op" id="1690800">*</span><span class="ident" id="1690801">f</span><span class="op" id="1690802">.</span><span class="ident" id="1690803">mant</span>&nbsp;<span class="op" id="1690808">+</span>&nbsp;<span class="num" id="1690810">1</span><span class="op" id="1690811">,</span>&nbsp;<span class="ident" id="1690813">exp</span><span class="op" id="1690816">:</span>&nbsp;<span class="ident" id="1690818">f</span><span class="op" id="1690819">.</span><span class="ident" id="1690820">exp</span>&nbsp;<span class="op" id="1690824">-</span>&nbsp;<span class="num" id="1690826">1</span><span class="op" id="1690827">,</span>&nbsp;<span class="ident" id="1690829">neg</span><span class="op" id="1690832">:</span>&nbsp;<span class="ident" id="1690834">f</span><span class="op" id="1690835">.</span><span class="ident" id="1690836">neg</span><span class="op" id="1690839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1690842">if</span>&nbsp;<span class="ident" id="1690845">mant</span>&nbsp;<span class="op" id="1690850">!=</span>&nbsp;<span class="num" id="1690853">1</span><span class="op" id="1690854">&lt;&lt;</span><span class="ident" id="1690856">flt</span><span class="op" id="1690859">.</span><span class="ident" id="1690860">mantbits</span>&nbsp;<span class="op" id="1690869">||</span>&nbsp;<span class="ident" id="1690872">expBiased</span>&nbsp;<span class="op" id="1690882">==</span>&nbsp;<span class="num" id="1690885">1</span>&nbsp;<span class="op" id="1690887">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1690891">lower</span>&nbsp;<span class="op" id="1690897">=</span>&nbsp;<span class="ident" id="1690899">extFloat</span><span class="op" id="1690907">{</span><span class="ident" id="1690908">mant</span><span class="op" id="1690912">:</span>&nbsp;<span class="num" id="1690914">2</span><span class="op" id="1690915">*</span><span class="ident" id="1690916">f</span><span class="op" id="1690917">.</span><span class="ident" id="1690918">mant</span>&nbsp;<span class="op" id="1690923">-</span>&nbsp;<span class="num" id="1690925">1</span><span class="op" id="1690926">,</span>&nbsp;<span class="ident" id="1690928">exp</span><span class="op" id="1690931">:</span>&nbsp;<span class="ident" id="1690933">f</span><span class="op" id="1690934">.</span><span class="ident" id="1690935">exp</span>&nbsp;<span class="op" id="1690939">-</span>&nbsp;<span class="num" id="1690941">1</span><span class="op" id="1690942">,</span>&nbsp;<span class="ident" id="1690944">neg</span><span class="op" id="1690947">:</span>&nbsp;<span class="ident" id="1690949">f</span><span class="op" id="1690950">.</span><span class="ident" id="1690951">neg</span><span class="op" id="1690954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1690957">}</span>&nbsp;<span class="keyword" id="1690959">else</span>&nbsp;<span class="op" id="1690964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1690968">lower</span>&nbsp;<span class="op" id="1690974">=</span>&nbsp;<span class="ident" id="1690976">extFloat</span><span class="op" id="1690984">{</span><span class="ident" id="1690985">mant</span><span class="op" id="1690989">:</span>&nbsp;<span class="num" id="1690991">4</span><span class="op" id="1690992">*</span><span class="ident" id="1690993">f</span><span class="op" id="1690994">.</span><span class="ident" id="1690995">mant</span>&nbsp;<span class="op" id="1691000">-</span>&nbsp;<span class="num" id="1691002">1</span><span class="op" id="1691003">,</span>&nbsp;<span class="ident" id="1691005">exp</span><span class="op" id="1691008">:</span>&nbsp;<span class="ident" id="1691010">f</span><span class="op" id="1691011">.</span><span class="ident" id="1691012">exp</span>&nbsp;<span class="op" id="1691016">-</span>&nbsp;<span class="num" id="1691018">2</span><span class="op" id="1691019">,</span>&nbsp;<span class="ident" id="1691021">neg</span><span class="op" id="1691024">:</span>&nbsp;<span class="ident" id="1691026">f</span><span class="op" id="1691027">.</span><span class="ident" id="1691028">neg</span><span class="op" id="1691031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1691034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1691037">return</span><br>
<span class="lineno">195</span><span class="op" id="1691044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1691047">//&nbsp;Normalize&nbsp;normalizes&nbsp;f&nbsp;so&nbsp;that&nbsp;the&nbsp;highest&nbsp;bit&nbsp;of&nbsp;the&nbsp;mantissa&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="1691116">//&nbsp;set,&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;by&nbsp;which&nbsp;the&nbsp;mantissa&nbsp;was&nbsp;left-shifted.</span><br>
<span class="lineno"></span><span class="keyword" id="1691187">func</span>&nbsp;<span class="op" id="1691192">(</span><span class="ident" id="1691193">f</span>&nbsp;<span class="op" id="1691195">*</span><span class="ident" id="1691196">extFloat</span><span class="op" id="1691204">)</span>&nbsp;<span class="ident" id="1691206">Normalize</span><span class="op" id="1691215">(</span><span class="op" id="1691216">)</span>&nbsp;<span class="op" id="1691218">(</span><span class="ident" id="1691219">shift</span>&nbsp;<span class="builtintype" id="1691225">uint</span><span class="op" id="1691229">)</span>&nbsp;<span class="op" id="1691231">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691234">mant</span><span class="op" id="1691238">,</span>&nbsp;<span class="ident" id="1691240">exp</span>&nbsp;<span class="op" id="1691244">:=</span>&nbsp;<span class="ident" id="1691247">f</span><span class="op" id="1691248">.</span><span class="ident" id="1691249">mant</span><span class="op" id="1691253">,</span>&nbsp;<span class="ident" id="1691255">f</span><span class="op" id="1691256">.</span><span class="ident" id="1691257">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1691262">if</span>&nbsp;<span class="ident" id="1691265">mant</span>&nbsp;<span class="op" id="1691270">==</span>&nbsp;<span class="num" id="1691273">0</span>&nbsp;<span class="op" id="1691275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1691279">return</span>&nbsp;<span class="num" id="1691286">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1691289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1691292">if</span>&nbsp;<span class="ident" id="1691295">mant</span><span class="op" id="1691299">&gt;&gt;</span><span class="op" id="1691301">(</span><span class="num" id="1691302">64</span><span class="op" id="1691304">-</span><span class="num" id="1691305">32</span><span class="op" id="1691307">)</span>&nbsp;<span class="op" id="1691309">==</span>&nbsp;<span class="num" id="1691312">0</span>&nbsp;<span class="op" id="1691314">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691318">mant</span>&nbsp;<span class="op" id="1691323">&lt;&lt;=</span>&nbsp;<span class="num" id="1691327">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691332">exp</span>&nbsp;<span class="op" id="1691336">-=</span>&nbsp;<span class="num" id="1691339">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1691343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1691346">if</span>&nbsp;<span class="ident" id="1691349">mant</span><span class="op" id="1691353">&gt;&gt;</span><span class="op" id="1691355">(</span><span class="num" id="1691356">64</span><span class="op" id="1691358">-</span><span class="num" id="1691359">16</span><span class="op" id="1691361">)</span>&nbsp;<span class="op" id="1691363">==</span>&nbsp;<span class="num" id="1691366">0</span>&nbsp;<span class="op" id="1691368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691372">mant</span>&nbsp;<span class="op" id="1691377">&lt;&lt;=</span>&nbsp;<span class="num" id="1691381">16</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691386">exp</span>&nbsp;<span class="op" id="1691390">-=</span>&nbsp;<span class="num" id="1691393">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1691397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1691400">if</span>&nbsp;<span class="ident" id="1691403">mant</span><span class="op" id="1691407">&gt;&gt;</span><span class="op" id="1691409">(</span><span class="num" id="1691410">64</span><span class="op" id="1691412">-</span><span class="num" id="1691413">8</span><span class="op" id="1691414">)</span>&nbsp;<span class="op" id="1691416">==</span>&nbsp;<span class="num" id="1691419">0</span>&nbsp;<span class="op" id="1691421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691425">mant</span>&nbsp;<span class="op" id="1691430">&lt;&lt;=</span>&nbsp;<span class="num" id="1691434">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691438">exp</span>&nbsp;<span class="op" id="1691442">-=</span>&nbsp;<span class="num" id="1691445">8</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1691448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1691451">if</span>&nbsp;<span class="ident" id="1691454">mant</span><span class="op" id="1691458">&gt;&gt;</span><span class="op" id="1691460">(</span><span class="num" id="1691461">64</span><span class="op" id="1691463">-</span><span class="num" id="1691464">4</span><span class="op" id="1691465">)</span>&nbsp;<span class="op" id="1691467">==</span>&nbsp;<span class="num" id="1691470">0</span>&nbsp;<span class="op" id="1691472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691476">mant</span>&nbsp;<span class="op" id="1691481">&lt;&lt;=</span>&nbsp;<span class="num" id="1691485">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691489">exp</span>&nbsp;<span class="op" id="1691493">-=</span>&nbsp;<span class="num" id="1691496">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1691499">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1691502">if</span>&nbsp;<span class="ident" id="1691505">mant</span><span class="op" id="1691509">&gt;&gt;</span><span class="op" id="1691511">(</span><span class="num" id="1691512">64</span><span class="op" id="1691514">-</span><span class="num" id="1691515">2</span><span class="op" id="1691516">)</span>&nbsp;<span class="op" id="1691518">==</span>&nbsp;<span class="num" id="1691521">0</span>&nbsp;<span class="op" id="1691523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691527">mant</span>&nbsp;<span class="op" id="1691532">&lt;&lt;=</span>&nbsp;<span class="num" id="1691536">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691540">exp</span>&nbsp;<span class="op" id="1691544">-=</span>&nbsp;<span class="num" id="1691547">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1691550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1691553">if</span>&nbsp;<span class="ident" id="1691556">mant</span><span class="op" id="1691560">&gt;&gt;</span><span class="op" id="1691562">(</span><span class="num" id="1691563">64</span><span class="op" id="1691565">-</span><span class="num" id="1691566">1</span><span class="op" id="1691567">)</span>&nbsp;<span class="op" id="1691569">==</span>&nbsp;<span class="num" id="1691572">0</span>&nbsp;<span class="op" id="1691574">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691578">mant</span>&nbsp;<span class="op" id="1691583">&lt;&lt;=</span>&nbsp;<span class="num" id="1691587">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691591">exp</span>&nbsp;<span class="op" id="1691595">-=</span>&nbsp;<span class="num" id="1691598">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1691601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691604">shift</span>&nbsp;<span class="op" id="1691610">=</span>&nbsp;<span class="builtintype" id="1691612">uint</span><span class="op" id="1691616">(</span><span class="ident" id="1691617">f</span><span class="op" id="1691618">.</span><span class="ident" id="1691619">exp</span>&nbsp;<span class="op" id="1691623">-</span>&nbsp;<span class="ident" id="1691625">exp</span><span class="op" id="1691628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691631">f</span><span class="op" id="1691632">.</span><span class="ident" id="1691633">mant</span><span class="op" id="1691637">,</span>&nbsp;<span class="ident" id="1691639">f</span><span class="op" id="1691640">.</span><span class="ident" id="1691641">exp</span>&nbsp;<span class="op" id="1691645">=</span>&nbsp;<span class="ident" id="1691647">mant</span><span class="op" id="1691651">,</span>&nbsp;<span class="ident" id="1691653">exp</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1691658">return</span><br>
<span class="lineno"></span><span class="op" id="1691665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1691668">//&nbsp;Multiply&nbsp;sets&nbsp;f&nbsp;to&nbsp;the&nbsp;product&nbsp;f*g:&nbsp;the&nbsp;result&nbsp;is&nbsp;correctly&nbsp;rounded,</span><br>
<span class="lineno"></span><span class="comment" id="1691740">//&nbsp;but&nbsp;not&nbsp;normalized.</span><br>
<span class="lineno">235</span><span class="keyword" id="1691763">func</span>&nbsp;<span class="op" id="1691768">(</span><span class="ident" id="1691769">f</span>&nbsp;<span class="op" id="1691771">*</span><span class="ident" id="1691772">extFloat</span><span class="op" id="1691780">)</span>&nbsp;<span class="ident" id="1691782">Multiply</span><span class="op" id="1691790">(</span><span class="ident" id="1691791">g</span>&nbsp;<span class="ident" id="1691793">extFloat</span><span class="op" id="1691801">)</span>&nbsp;<span class="op" id="1691803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691806">fhi</span><span class="op" id="1691809">,</span>&nbsp;<span class="ident" id="1691811">flo</span>&nbsp;<span class="op" id="1691815">:=</span>&nbsp;<span class="ident" id="1691818">f</span><span class="op" id="1691819">.</span><span class="ident" id="1691820">mant</span><span class="op" id="1691824">&gt;&gt;</span><span class="num" id="1691826">32</span><span class="op" id="1691828">,</span>&nbsp;<span class="ident" id="1691830">uint64</span><span class="op" id="1691836">(</span><span class="builtintype" id="1691837">uint32</span><span class="op" id="1691843">(</span><span class="ident" id="1691844">f</span><span class="op" id="1691845">.</span><span class="ident" id="1691846">mant</span><span class="op" id="1691850">)</span><span class="op" id="1691851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691854">ghi</span><span class="op" id="1691857">,</span>&nbsp;<span class="ident" id="1691859">glo</span>&nbsp;<span class="op" id="1691863">:=</span>&nbsp;<span class="ident" id="1691866">g</span><span class="op" id="1691867">.</span><span class="ident" id="1691868">mant</span><span class="op" id="1691872">&gt;&gt;</span><span class="num" id="1691874">32</span><span class="op" id="1691876">,</span>&nbsp;<span class="ident" id="1691878">uint64</span><span class="op" id="1691884">(</span><span class="builtintype" id="1691885">uint32</span><span class="op" id="1691891">(</span><span class="ident" id="1691892">g</span><span class="op" id="1691893">.</span><span class="ident" id="1691894">mant</span><span class="op" id="1691898">)</span><span class="op" id="1691899">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1691903">//&nbsp;Cross&nbsp;products.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691923">cross1</span>&nbsp;<span class="op" id="1691930">:=</span>&nbsp;<span class="ident" id="1691933">fhi</span>&nbsp;<span class="op" id="1691937">*</span>&nbsp;<span class="ident" id="1691939">glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1691944">cross2</span>&nbsp;<span class="op" id="1691951">:=</span>&nbsp;<span class="ident" id="1691954">flo</span>&nbsp;<span class="op" id="1691958">*</span>&nbsp;<span class="ident" id="1691960">ghi</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1691966">//&nbsp;f.mant*g.mant&nbsp;is&nbsp;fhi*ghi&nbsp;&lt;&lt;&nbsp;64&nbsp;+&nbsp;(cross1+cross2)&nbsp;&lt;&lt;&nbsp;32&nbsp;+&nbsp;flo*glo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1692035">f</span><span class="op" id="1692036">.</span><span class="ident" id="1692037">mant</span>&nbsp;<span class="op" id="1692042">=</span>&nbsp;<span class="ident" id="1692044">fhi</span><span class="op" id="1692047">*</span><span class="ident" id="1692048">ghi</span>&nbsp;<span class="op" id="1692052">+</span>&nbsp;<span class="op" id="1692054">(</span><span class="ident" id="1692055">cross1</span>&nbsp;<span class="op" id="1692062">&gt;&gt;</span>&nbsp;<span class="num" id="1692065">32</span><span class="op" id="1692067">)</span>&nbsp;<span class="op" id="1692069">+</span>&nbsp;<span class="op" id="1692071">(</span><span class="ident" id="1692072">cross2</span>&nbsp;<span class="op" id="1692079">&gt;&gt;</span>&nbsp;<span class="num" id="1692082">32</span><span class="op" id="1692084">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1692087">rem</span>&nbsp;<span class="op" id="1692091">:=</span>&nbsp;<span class="ident" id="1692094">uint64</span><span class="op" id="1692100">(</span><span class="builtintype" id="1692101">uint32</span><span class="op" id="1692107">(</span><span class="ident" id="1692108">cross1</span><span class="op" id="1692114">)</span><span class="op" id="1692115">)</span>&nbsp;<span class="op" id="1692117">+</span>&nbsp;<span class="ident" id="1692119">uint64</span><span class="op" id="1692125">(</span><span class="builtintype" id="1692126">uint32</span><span class="op" id="1692132">(</span><span class="ident" id="1692133">cross2</span><span class="op" id="1692139">)</span><span class="op" id="1692140">)</span>&nbsp;<span class="op" id="1692142">+</span>&nbsp;<span class="op" id="1692144">(</span><span class="op" id="1692145">(</span><span class="ident" id="1692146">flo</span>&nbsp;<span class="op" id="1692150">*</span>&nbsp;<span class="ident" id="1692152">glo</span><span class="op" id="1692155">)</span>&nbsp;<span class="op" id="1692157">&gt;&gt;</span>&nbsp;<span class="num" id="1692160">32</span><span class="op" id="1692162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1692165">//&nbsp;Round&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1692179">rem</span>&nbsp;<span class="op" id="1692183">+=</span>&nbsp;<span class="op" id="1692186">(</span><span class="num" id="1692187">1</span>&nbsp;<span class="op" id="1692189">&lt;&lt;</span>&nbsp;<span class="num" id="1692192">31</span><span class="op" id="1692194">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1692198">f</span><span class="op" id="1692199">.</span><span class="ident" id="1692200">mant</span>&nbsp;<span class="op" id="1692205">+=</span>&nbsp;<span class="op" id="1692208">(</span><span class="ident" id="1692209">rem</span>&nbsp;<span class="op" id="1692213">&gt;&gt;</span>&nbsp;<span class="num" id="1692216">32</span><span class="op" id="1692218">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1692221">f</span><span class="op" id="1692222">.</span><span class="ident" id="1692223">exp</span>&nbsp;<span class="op" id="1692227">=</span>&nbsp;<span class="ident" id="1692229">f</span><span class="op" id="1692230">.</span><span class="ident" id="1692231">exp</span>&nbsp;<span class="op" id="1692235">+</span>&nbsp;<span class="ident" id="1692237">g</span><span class="op" id="1692238">.</span><span class="ident" id="1692239">exp</span>&nbsp;<span class="op" id="1692243">+</span>&nbsp;<span class="num" id="1692245">64</span><br>
<span class="lineno"></span><span class="op" id="1692248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1692251">var</span>&nbsp;<span class="ident" id="1692255">uint64pow10</span>&nbsp;<span class="op" id="1692267">=</span>&nbsp;<span class="op" id="1692269">[</span><span class="op" id="1692270">...</span><span class="op" id="1692273">]</span><span class="ident" id="1692274">uint64</span><span class="op" id="1692280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1692283">1</span><span class="op" id="1692284">,</span>&nbsp;<span class="num" id="1692286">1e1</span><span class="op" id="1692289">,</span>&nbsp;<span class="num" id="1692291">1e2</span><span class="op" id="1692294">,</span>&nbsp;<span class="num" id="1692296">1e3</span><span class="op" id="1692299">,</span>&nbsp;<span class="num" id="1692301">1e4</span><span class="op" id="1692304">,</span>&nbsp;<span class="num" id="1692306">1e5</span><span class="op" id="1692309">,</span>&nbsp;<span class="num" id="1692311">1e6</span><span class="op" id="1692314">,</span>&nbsp;<span class="num" id="1692316">1e7</span><span class="op" id="1692319">,</span>&nbsp;<span class="num" id="1692321">1e8</span><span class="op" id="1692324">,</span>&nbsp;<span class="num" id="1692326">1e9</span><span class="op" id="1692329">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1692332">1e10</span><span class="op" id="1692336">,</span>&nbsp;<span class="num" id="1692338">1e11</span><span class="op" id="1692342">,</span>&nbsp;<span class="num" id="1692344">1e12</span><span class="op" id="1692348">,</span>&nbsp;<span class="num" id="1692350">1e13</span><span class="op" id="1692354">,</span>&nbsp;<span class="num" id="1692356">1e14</span><span class="op" id="1692360">,</span>&nbsp;<span class="num" id="1692362">1e15</span><span class="op" id="1692366">,</span>&nbsp;<span class="num" id="1692368">1e16</span><span class="op" id="1692372">,</span>&nbsp;<span class="num" id="1692374">1e17</span><span class="op" id="1692378">,</span>&nbsp;<span class="num" id="1692380">1e18</span><span class="op" id="1692384">,</span>&nbsp;<span class="num" id="1692386">1e19</span><span class="op" id="1692390">,</span><br>
<span class="lineno"></span><span class="op" id="1692392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1692395">//&nbsp;AssignDecimal&nbsp;sets&nbsp;f&nbsp;to&nbsp;an&nbsp;approximate&nbsp;value&nbsp;mantissa*10^exp.&nbsp;It</span><br>
<span class="lineno"></span><span class="comment" id="1692463">//&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;f&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;the</span><br>
<span class="lineno">260</span><span class="comment" id="1692533">//&nbsp;best&nbsp;approximation&nbsp;of&nbsp;d&nbsp;after&nbsp;being&nbsp;rounded&nbsp;to&nbsp;a&nbsp;float64&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="1692596">//&nbsp;float32&nbsp;depending&nbsp;on&nbsp;flt.</span><br>
<span class="lineno"></span><span class="keyword" id="1692625">func</span>&nbsp;<span class="op" id="1692630">(</span><span class="ident" id="1692631">f</span>&nbsp;<span class="op" id="1692633">*</span><span class="ident" id="1692634">extFloat</span><span class="op" id="1692642">)</span>&nbsp;<span class="ident" id="1692644">AssignDecimal</span><span class="op" id="1692657">(</span><span class="ident" id="1692658">mantissa</span>&nbsp;<span class="ident" id="1692667">uint64</span><span class="op" id="1692673">,</span>&nbsp;<span class="ident" id="1692675">exp10</span>&nbsp;<span class="builtintype" id="1692681">int</span><span class="op" id="1692684">,</span>&nbsp;<span class="ident" id="1692686">neg</span>&nbsp;<span class="builtintype" id="1692690">bool</span><span class="op" id="1692694">,</span>&nbsp;<span class="ident" id="1692696">trunc</span>&nbsp;<span class="builtintype" id="1692702">bool</span><span class="op" id="1692706">,</span>&nbsp;<span class="ident" id="1692708">flt</span>&nbsp;<span class="op" id="1692712">*</span><span class="ident" id="1692713">floatInfo</span><span class="op" id="1692722">)</span>&nbsp;<span class="op" id="1692724">(</span><span class="ident" id="1692725">ok</span>&nbsp;<span class="builtintype" id="1692728">bool</span><span class="op" id="1692732">)</span>&nbsp;<span class="op" id="1692734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1692737">const</span>&nbsp;<span class="ident" id="1692743">uint64digits</span>&nbsp;<span class="op" id="1692756">=</span>&nbsp;<span class="num" id="1692758">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1692762">const</span>&nbsp;<span class="ident" id="1692768">errorscale</span>&nbsp;<span class="op" id="1692779">=</span>&nbsp;<span class="num" id="1692781">8</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1692784">errors</span>&nbsp;<span class="op" id="1692791">:=</span>&nbsp;<span class="num" id="1692794">0</span>&nbsp;<span class="comment" id="1692796">//&nbsp;An&nbsp;upper&nbsp;bound&nbsp;for&nbsp;error,&nbsp;computed&nbsp;in&nbsp;errorscale*ulp.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1692854">if</span>&nbsp;<span class="ident" id="1692857">trunc</span>&nbsp;<span class="op" id="1692863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1692867">//&nbsp;the&nbsp;decimal&nbsp;number&nbsp;was&nbsp;truncated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1692906">errors</span>&nbsp;<span class="op" id="1692913">+=</span>&nbsp;<span class="ident" id="1692916">errorscale</span>&nbsp;<span class="op" id="1692927">/</span>&nbsp;<span class="num" id="1692929">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1692932">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1692936">f</span><span class="op" id="1692937">.</span><span class="ident" id="1692938">mant</span>&nbsp;<span class="op" id="1692943">=</span>&nbsp;<span class="ident" id="1692945">mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1692955">f</span><span class="op" id="1692956">.</span><span class="ident" id="1692957">exp</span>&nbsp;<span class="op" id="1692961">=</span>&nbsp;<span class="num" id="1692963">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1692966">f</span><span class="op" id="1692967">.</span><span class="ident" id="1692968">neg</span>&nbsp;<span class="op" id="1692972">=</span>&nbsp;<span class="ident" id="1692974">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1692980">//&nbsp;Multiply&nbsp;by&nbsp;powers&nbsp;of&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693011">i</span>&nbsp;<span class="op" id="1693013">:=</span>&nbsp;<span class="op" id="1693016">(</span><span class="ident" id="1693017">exp10</span>&nbsp;<span class="op" id="1693023">-</span>&nbsp;<span class="ident" id="1693025">firstPowerOfTen</span><span class="op" id="1693040">)</span>&nbsp;<span class="op" id="1693042">/</span>&nbsp;<span class="ident" id="1693044">stepPowerOfTen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1693060">if</span>&nbsp;<span class="ident" id="1693063">exp10</span>&nbsp;<span class="op" id="1693069">&lt;</span>&nbsp;<span class="ident" id="1693071">firstPowerOfTen</span>&nbsp;<span class="op" id="1693087">||</span>&nbsp;<span class="ident" id="1693090">i</span>&nbsp;<span class="op" id="1693092">&gt;=</span>&nbsp;<span class="builtinfunc" id="1693095">len</span><span class="op" id="1693098">(</span><span class="ident" id="1693099">powersOfTen</span><span class="op" id="1693110">)</span>&nbsp;<span class="op" id="1693112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1693116">return</span>&nbsp;<span class="builtintype" id="1693123">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1693130">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693133">adjExp</span>&nbsp;<span class="op" id="1693140">:=</span>&nbsp;<span class="op" id="1693143">(</span><span class="ident" id="1693144">exp10</span>&nbsp;<span class="op" id="1693150">-</span>&nbsp;<span class="ident" id="1693152">firstPowerOfTen</span><span class="op" id="1693167">)</span>&nbsp;<span class="op" id="1693169">%</span>&nbsp;<span class="ident" id="1693171">stepPowerOfTen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1693188">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;exp%step</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1693216">if</span>&nbsp;<span class="ident" id="1693219">adjExp</span>&nbsp;<span class="op" id="1693226">&lt;</span>&nbsp;<span class="ident" id="1693228">uint64digits</span>&nbsp;<span class="op" id="1693241">&amp;&amp;</span>&nbsp;<span class="ident" id="1693244">mantissa</span>&nbsp;<span class="op" id="1693253">&lt;</span>&nbsp;<span class="ident" id="1693255">uint64pow10</span><span class="op" id="1693266">[</span><span class="ident" id="1693267">uint64digits</span><span class="op" id="1693279">-</span><span class="ident" id="1693280">adjExp</span><span class="op" id="1693286">]</span>&nbsp;<span class="op" id="1693288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1693292">//&nbsp;We&nbsp;can&nbsp;multiply&nbsp;the&nbsp;mantissa&nbsp;exactly.</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693335">f</span><span class="op" id="1693336">.</span><span class="ident" id="1693337">mant</span>&nbsp;<span class="op" id="1693342">*=</span>&nbsp;<span class="ident" id="1693345">uint64pow10</span><span class="op" id="1693356">[</span><span class="ident" id="1693357">adjExp</span><span class="op" id="1693363">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693367">f</span><span class="op" id="1693368">.</span><span class="ident" id="1693369">Normalize</span><span class="op" id="1693378">(</span><span class="op" id="1693379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1693382">}</span>&nbsp;<span class="keyword" id="1693384">else</span>&nbsp;<span class="op" id="1693389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693393">f</span><span class="op" id="1693394">.</span><span class="ident" id="1693395">Normalize</span><span class="op" id="1693404">(</span><span class="op" id="1693405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693409">f</span><span class="op" id="1693410">.</span><span class="ident" id="1693411">Multiply</span><span class="op" id="1693419">(</span><span class="ident" id="1693420">smallPowersOfTen</span><span class="op" id="1693436">[</span><span class="ident" id="1693437">adjExp</span><span class="op" id="1693443">]</span><span class="op" id="1693444">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693448">errors</span>&nbsp;<span class="op" id="1693455">+=</span>&nbsp;<span class="ident" id="1693458">errorscale</span>&nbsp;<span class="op" id="1693469">/</span>&nbsp;<span class="num" id="1693471">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1693474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1693478">//&nbsp;We&nbsp;multiply&nbsp;by&nbsp;10&nbsp;to&nbsp;the&nbsp;exp&nbsp;-&nbsp;exp%step.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693523">f</span><span class="op" id="1693524">.</span><span class="ident" id="1693525">Multiply</span><span class="op" id="1693533">(</span><span class="ident" id="1693534">powersOfTen</span><span class="op" id="1693545">[</span><span class="ident" id="1693546">i</span><span class="op" id="1693547">]</span><span class="op" id="1693548">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1693551">if</span>&nbsp;<span class="ident" id="1693554">errors</span>&nbsp;<span class="op" id="1693561">&gt;</span>&nbsp;<span class="num" id="1693563">0</span>&nbsp;<span class="op" id="1693565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693569">errors</span>&nbsp;<span class="op" id="1693576">+=</span>&nbsp;<span class="num" id="1693579">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1693582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693585">errors</span>&nbsp;<span class="op" id="1693592">+=</span>&nbsp;<span class="ident" id="1693595">errorscale</span>&nbsp;<span class="op" id="1693606">/</span>&nbsp;<span class="num" id="1693608">2</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1693612">//&nbsp;Normalize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693626">shift</span>&nbsp;<span class="op" id="1693632">:=</span>&nbsp;<span class="ident" id="1693635">f</span><span class="op" id="1693636">.</span><span class="ident" id="1693637">Normalize</span><span class="op" id="1693646">(</span><span class="op" id="1693647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693650">errors</span>&nbsp;<span class="op" id="1693657">&lt;&lt;=</span>&nbsp;<span class="ident" id="1693661">shift</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1693669">//&nbsp;Now&nbsp;f&nbsp;is&nbsp;a&nbsp;good&nbsp;approximation&nbsp;of&nbsp;the&nbsp;decimal.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1693719">//&nbsp;Check&nbsp;whether&nbsp;the&nbsp;error&nbsp;is&nbsp;too&nbsp;large:&nbsp;that&nbsp;is,&nbsp;if&nbsp;the&nbsp;mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1693786">//&nbsp;is&nbsp;perturbated&nbsp;by&nbsp;the&nbsp;error,&nbsp;the&nbsp;resulting&nbsp;float64&nbsp;will&nbsp;change.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1693854">//&nbsp;The&nbsp;64&nbsp;bits&nbsp;mantissa&nbsp;is&nbsp;1&nbsp;+&nbsp;52&nbsp;bits&nbsp;for&nbsp;float64&nbsp;+&nbsp;11&nbsp;extra&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1693923">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1693927">//&nbsp;In&nbsp;many&nbsp;cases&nbsp;the&nbsp;approximation&nbsp;will&nbsp;be&nbsp;good&nbsp;enough.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1693984">denormalExp</span>&nbsp;<span class="op" id="1693996">:=</span>&nbsp;<span class="ident" id="1693999">flt</span><span class="op" id="1694002">.</span><span class="ident" id="1694003">bias</span>&nbsp;<span class="op" id="1694008">-</span>&nbsp;<span class="num" id="1694010">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1694014">var</span>&nbsp;<span class="ident" id="1694018">extrabits</span>&nbsp;<span class="builtintype" id="1694028">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1694034">if</span>&nbsp;<span class="ident" id="1694037">f</span><span class="op" id="1694038">.</span><span class="ident" id="1694039">exp</span>&nbsp;<span class="op" id="1694043">&lt;=</span>&nbsp;<span class="ident" id="1694046">denormalExp</span>&nbsp;<span class="op" id="1694058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1694062">//&nbsp;f.mant&nbsp;*&nbsp;2^f.exp&nbsp;is&nbsp;smaller&nbsp;than&nbsp;2^(flt.bias+1).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1694116">extrabits</span>&nbsp;<span class="op" id="1694126">=</span>&nbsp;<span class="builtintype" id="1694128">uint</span><span class="op" id="1694132">(</span><span class="num" id="1694133">63</span>&nbsp;<span class="op" id="1694136">-</span>&nbsp;<span class="ident" id="1694138">flt</span><span class="op" id="1694141">.</span><span class="ident" id="1694142">mantbits</span>&nbsp;<span class="op" id="1694151">+</span>&nbsp;<span class="num" id="1694153">1</span>&nbsp;<span class="op" id="1694155">+</span>&nbsp;<span class="builtintype" id="1694157">uint</span><span class="op" id="1694161">(</span><span class="ident" id="1694162">denormalExp</span><span class="op" id="1694173">-</span><span class="ident" id="1694174">f</span><span class="op" id="1694175">.</span><span class="ident" id="1694176">exp</span><span class="op" id="1694179">)</span><span class="op" id="1694180">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1694183">}</span>&nbsp;<span class="keyword" id="1694185">else</span>&nbsp;<span class="op" id="1694190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1694194">extrabits</span>&nbsp;<span class="op" id="1694204">=</span>&nbsp;<span class="builtintype" id="1694206">uint</span><span class="op" id="1694210">(</span><span class="num" id="1694211">63</span>&nbsp;<span class="op" id="1694214">-</span>&nbsp;<span class="ident" id="1694216">flt</span><span class="op" id="1694219">.</span><span class="ident" id="1694220">mantbits</span><span class="op" id="1694228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1694231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1694235">halfway</span>&nbsp;<span class="op" id="1694243">:=</span>&nbsp;<span class="ident" id="1694246">uint64</span><span class="op" id="1694252">(</span><span class="num" id="1694253">1</span><span class="op" id="1694254">)</span>&nbsp;<span class="op" id="1694256">&lt;&lt;</span>&nbsp;<span class="op" id="1694259">(</span><span class="ident" id="1694260">extrabits</span>&nbsp;<span class="op" id="1694270">-</span>&nbsp;<span class="num" id="1694272">1</span><span class="op" id="1694273">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1694276">mant_extra</span>&nbsp;<span class="op" id="1694287">:=</span>&nbsp;<span class="ident" id="1694290">f</span><span class="op" id="1694291">.</span><span class="ident" id="1694292">mant</span>&nbsp;<span class="op" id="1694297">&amp;</span>&nbsp;<span class="op" id="1694299">(</span><span class="num" id="1694300">1</span><span class="op" id="1694301">&lt;&lt;</span><span class="ident" id="1694303">extrabits</span>&nbsp;<span class="op" id="1694313">-</span>&nbsp;<span class="num" id="1694315">1</span><span class="op" id="1694316">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1694320">//&nbsp;Do&nbsp;a&nbsp;signed&nbsp;comparison&nbsp;here!&nbsp;If&nbsp;the&nbsp;error&nbsp;estimate&nbsp;could&nbsp;make</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1694386">//&nbsp;the&nbsp;mantissa&nbsp;round&nbsp;differently&nbsp;for&nbsp;the&nbsp;conversion&nbsp;to&nbsp;double,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1694451">//&nbsp;then&nbsp;we&nbsp;can&#39;t&nbsp;give&nbsp;a&nbsp;definite&nbsp;answer.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1694493">if</span>&nbsp;<span class="ident" id="1694496">int64</span><span class="op" id="1694501">(</span><span class="ident" id="1694502">halfway</span><span class="op" id="1694509">)</span><span class="op" id="1694510">-</span><span class="ident" id="1694511">int64</span><span class="op" id="1694516">(</span><span class="ident" id="1694517">errors</span><span class="op" id="1694523">)</span>&nbsp;<span class="op" id="1694525">&lt;</span>&nbsp;<span class="ident" id="1694527">int64</span><span class="op" id="1694532">(</span><span class="ident" id="1694533">mant_extra</span><span class="op" id="1694543">)</span>&nbsp;<span class="op" id="1694545">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1694550">int64</span><span class="op" id="1694555">(</span><span class="ident" id="1694556">mant_extra</span><span class="op" id="1694566">)</span>&nbsp;<span class="op" id="1694568">&lt;</span>&nbsp;<span class="ident" id="1694570">int64</span><span class="op" id="1694575">(</span><span class="ident" id="1694576">halfway</span><span class="op" id="1694583">)</span><span class="op" id="1694584">+</span><span class="ident" id="1694585">int64</span><span class="op" id="1694590">(</span><span class="ident" id="1694591">errors</span><span class="op" id="1694597">)</span>&nbsp;<span class="op" id="1694599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1694603">return</span>&nbsp;<span class="builtintype" id="1694610">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1694617">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1694620">return</span>&nbsp;<span class="builtintype" id="1694627">true</span><br>
<span class="lineno">330</span><span class="op" id="1694632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1694635">//&nbsp;Frexp10&nbsp;is&nbsp;an&nbsp;analogue&nbsp;of&nbsp;math.Frexp&nbsp;for&nbsp;decimal&nbsp;powers.&nbsp;It&nbsp;scales</span><br>
<span class="lineno"></span><span class="comment" id="1694705">//&nbsp;f&nbsp;by&nbsp;an&nbsp;approximate&nbsp;power&nbsp;of&nbsp;ten&nbsp;10^-exp,&nbsp;and&nbsp;returns&nbsp;exp10,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="1694772">//&nbsp;that&nbsp;f*10^exp10&nbsp;has&nbsp;the&nbsp;same&nbsp;value&nbsp;as&nbsp;the&nbsp;old&nbsp;f,&nbsp;up&nbsp;to&nbsp;an&nbsp;ulp,</span><br>
<span class="lineno">335</span><span class="comment" id="1694838">//&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;index&nbsp;of&nbsp;10^-exp&nbsp;in&nbsp;the&nbsp;powersOfTen&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="1694899">func</span>&nbsp;<span class="op" id="1694904">(</span><span class="ident" id="1694905">f</span>&nbsp;<span class="op" id="1694907">*</span><span class="ident" id="1694908">extFloat</span><span class="op" id="1694916">)</span>&nbsp;<span class="ident" id="1694918">frexp10</span><span class="op" id="1694925">(</span><span class="op" id="1694926">)</span>&nbsp;<span class="op" id="1694928">(</span><span class="ident" id="1694929">exp10</span><span class="op" id="1694934">,</span>&nbsp;<span class="ident" id="1694936">index</span>&nbsp;<span class="builtintype" id="1694942">int</span><span class="op" id="1694945">)</span>&nbsp;<span class="op" id="1694947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1694950">//&nbsp;The&nbsp;constants&nbsp;expMin&nbsp;and&nbsp;expMax&nbsp;constrain&nbsp;the&nbsp;final&nbsp;value&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1695019">//&nbsp;binary&nbsp;exponent&nbsp;of&nbsp;f.&nbsp;We&nbsp;want&nbsp;a&nbsp;small&nbsp;integral&nbsp;part&nbsp;in&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1695089">//&nbsp;because&nbsp;finding&nbsp;digits&nbsp;of&nbsp;an&nbsp;integer&nbsp;requires&nbsp;divisions,&nbsp;whereas</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1695158">//&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part&nbsp;can&nbsp;be&nbsp;found&nbsp;by&nbsp;repeatedly&nbsp;multiplying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1695231">//&nbsp;by&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1695242">const</span>&nbsp;<span class="ident" id="1695248">expMin</span>&nbsp;<span class="op" id="1695255">=</span>&nbsp;<span class="op" id="1695257">-</span><span class="num" id="1695258">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1695262">const</span>&nbsp;<span class="ident" id="1695268">expMax</span>&nbsp;<span class="op" id="1695275">=</span>&nbsp;<span class="op" id="1695277">-</span><span class="num" id="1695278">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1695282">//&nbsp;Find&nbsp;power&nbsp;of&nbsp;ten&nbsp;such&nbsp;that&nbsp;x&nbsp;*&nbsp;10^n&nbsp;has&nbsp;a&nbsp;binary&nbsp;exponent</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1695345">//&nbsp;between&nbsp;expMin&nbsp;and&nbsp;expMax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1695376">approxExp10</span>&nbsp;<span class="op" id="1695388">:=</span>&nbsp;<span class="op" id="1695391">(</span><span class="op" id="1695392">(</span><span class="ident" id="1695393">expMin</span><span class="op" id="1695399">+</span><span class="ident" id="1695400">expMax</span><span class="op" id="1695406">)</span><span class="op" id="1695407">/</span><span class="num" id="1695408">2</span>&nbsp;<span class="op" id="1695410">-</span>&nbsp;<span class="ident" id="1695412">f</span><span class="op" id="1695413">.</span><span class="ident" id="1695414">exp</span><span class="op" id="1695417">)</span>&nbsp;<span class="op" id="1695419">*</span>&nbsp;<span class="num" id="1695421">28</span>&nbsp;<span class="op" id="1695424">/</span>&nbsp;<span class="num" id="1695426">93</span>&nbsp;<span class="comment" id="1695429">//&nbsp;log(10)/log(2)&nbsp;is&nbsp;close&nbsp;to&nbsp;93/28.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1695467">i</span>&nbsp;<span class="op" id="1695469">:=</span>&nbsp;<span class="op" id="1695472">(</span><span class="ident" id="1695473">approxExp10</span>&nbsp;<span class="op" id="1695485">-</span>&nbsp;<span class="ident" id="1695487">firstPowerOfTen</span><span class="op" id="1695502">)</span>&nbsp;<span class="op" id="1695504">/</span>&nbsp;<span class="ident" id="1695506">stepPowerOfTen</span><br>
<span class="lineno"></span><span class="ident" id="1695521">Loop</span><span class="op" id="1695525">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1695528">for</span>&nbsp;<span class="op" id="1695532">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1695536">exp</span>&nbsp;<span class="op" id="1695540">:=</span>&nbsp;<span class="ident" id="1695543">f</span><span class="op" id="1695544">.</span><span class="ident" id="1695545">exp</span>&nbsp;<span class="op" id="1695549">+</span>&nbsp;<span class="ident" id="1695551">powersOfTen</span><span class="op" id="1695562">[</span><span class="ident" id="1695563">i</span><span class="op" id="1695564">]</span><span class="op" id="1695565">.</span><span class="ident" id="1695566">exp</span>&nbsp;<span class="op" id="1695570">+</span>&nbsp;<span class="num" id="1695572">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1695577">switch</span>&nbsp;<span class="op" id="1695584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1695588">case</span>&nbsp;<span class="ident" id="1695593">exp</span>&nbsp;<span class="op" id="1695597">&lt;</span>&nbsp;<span class="ident" id="1695599">expMin</span><span class="op" id="1695605">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1695610">i</span><span class="op" id="1695611">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1695616">case</span>&nbsp;<span class="ident" id="1695621">exp</span>&nbsp;<span class="op" id="1695625">&gt;</span>&nbsp;<span class="ident" id="1695627">expMax</span><span class="op" id="1695633">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1695638">i</span><span class="op" id="1695639">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1695644">default</span><span class="op" id="1695651">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1695656">break</span>&nbsp;<span class="ident" id="1695662">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1695669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1695672">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1695675">//&nbsp;Apply&nbsp;the&nbsp;desired&nbsp;decimal&nbsp;shift&nbsp;on&nbsp;f.&nbsp;It&nbsp;will&nbsp;have&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1695739">//&nbsp;in&nbsp;the&nbsp;desired&nbsp;range.&nbsp;This&nbsp;is&nbsp;multiplication&nbsp;by&nbsp;10^-exp10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1695802">f</span><span class="op" id="1695803">.</span><span class="ident" id="1695804">Multiply</span><span class="op" id="1695812">(</span><span class="ident" id="1695813">powersOfTen</span><span class="op" id="1695824">[</span><span class="ident" id="1695825">i</span><span class="op" id="1695826">]</span><span class="op" id="1695827">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1695831">return</span>&nbsp;<span class="op" id="1695838">-</span><span class="op" id="1695839">(</span><span class="ident" id="1695840">firstPowerOfTen</span>&nbsp;<span class="op" id="1695856">+</span>&nbsp;<span class="ident" id="1695858">i</span><span class="op" id="1695859">*</span><span class="ident" id="1695860">stepPowerOfTen</span><span class="op" id="1695874">)</span><span class="op" id="1695875">,</span>&nbsp;<span class="ident" id="1695877">i</span><br>
<span class="lineno">365</span><span class="op" id="1695879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1695882">//&nbsp;frexp10Many&nbsp;applies&nbsp;a&nbsp;common&nbsp;shift&nbsp;by&nbsp;a&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;a,&nbsp;b,&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="1695950">func</span>&nbsp;<span class="ident" id="1695955">frexp10Many</span><span class="op" id="1695966">(</span><span class="ident" id="1695967">a</span><span class="op" id="1695968">,</span>&nbsp;<span class="ident" id="1695970">b</span><span class="op" id="1695971">,</span>&nbsp;<span class="ident" id="1695973">c</span>&nbsp;<span class="op" id="1695975">*</span><span class="ident" id="1695976">extFloat</span><span class="op" id="1695984">)</span>&nbsp;<span class="op" id="1695986">(</span><span class="ident" id="1695987">exp10</span>&nbsp;<span class="builtintype" id="1695993">int</span><span class="op" id="1695996">)</span>&nbsp;<span class="op" id="1695998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696001">exp10</span><span class="op" id="1696006">,</span>&nbsp;<span class="ident" id="1696008">i</span>&nbsp;<span class="op" id="1696010">:=</span>&nbsp;<span class="ident" id="1696013">c</span><span class="op" id="1696014">.</span><span class="ident" id="1696015">frexp10</span><span class="op" id="1696022">(</span><span class="op" id="1696023">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696026">a</span><span class="op" id="1696027">.</span><span class="ident" id="1696028">Multiply</span><span class="op" id="1696036">(</span><span class="ident" id="1696037">powersOfTen</span><span class="op" id="1696048">[</span><span class="ident" id="1696049">i</span><span class="op" id="1696050">]</span><span class="op" id="1696051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696054">b</span><span class="op" id="1696055">.</span><span class="ident" id="1696056">Multiply</span><span class="op" id="1696064">(</span><span class="ident" id="1696065">powersOfTen</span><span class="op" id="1696076">[</span><span class="ident" id="1696077">i</span><span class="op" id="1696078">]</span><span class="op" id="1696079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1696082">return</span><br>
<span class="lineno"></span><span class="op" id="1696089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="1696092">//&nbsp;FixedDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;first&nbsp;n&nbsp;significant&nbsp;digits</span><br>
<span class="lineno"></span><span class="comment" id="1696151">//&nbsp;of&nbsp;the&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f.&nbsp;It&nbsp;returns&nbsp;false</span><br>
<span class="lineno"></span><span class="comment" id="1696207">//&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be&nbsp;sure&nbsp;of&nbsp;the&nbsp;answer.</span><br>
<span class="lineno"></span><span class="keyword" id="1696246">func</span>&nbsp;<span class="op" id="1696251">(</span><span class="ident" id="1696252">f</span>&nbsp;<span class="op" id="1696254">*</span><span class="ident" id="1696255">extFloat</span><span class="op" id="1696263">)</span>&nbsp;<span class="ident" id="1696265">FixedDecimal</span><span class="op" id="1696277">(</span><span class="ident" id="1696278">d</span>&nbsp;<span class="op" id="1696280">*</span><span class="ident" id="1696281">decimalSlice</span><span class="op" id="1696293">,</span>&nbsp;<span class="ident" id="1696295">n</span>&nbsp;<span class="builtintype" id="1696297">int</span><span class="op" id="1696300">)</span>&nbsp;<span class="builtintype" id="1696302">bool</span>&nbsp;<span class="op" id="1696307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1696310">if</span>&nbsp;<span class="ident" id="1696313">f</span><span class="op" id="1696314">.</span><span class="ident" id="1696315">mant</span>&nbsp;<span class="op" id="1696320">==</span>&nbsp;<span class="num" id="1696323">0</span>&nbsp;<span class="op" id="1696325">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696329">d</span><span class="op" id="1696330">.</span><span class="ident" id="1696331">nd</span>&nbsp;<span class="op" id="1696334">=</span>&nbsp;<span class="num" id="1696336">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696340">d</span><span class="op" id="1696341">.</span><span class="ident" id="1696342">dp</span>&nbsp;<span class="op" id="1696345">=</span>&nbsp;<span class="num" id="1696347">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696351">d</span><span class="op" id="1696352">.</span><span class="ident" id="1696353">neg</span>&nbsp;<span class="op" id="1696357">=</span>&nbsp;<span class="ident" id="1696359">f</span><span class="op" id="1696360">.</span><span class="ident" id="1696361">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1696367">return</span>&nbsp;<span class="builtintype" id="1696374">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1696380">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1696383">if</span>&nbsp;<span class="ident" id="1696386">n</span>&nbsp;<span class="op" id="1696388">==</span>&nbsp;<span class="num" id="1696391">0</span>&nbsp;<span class="op" id="1696393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1696397">panic</span><span class="op" id="1696402">(</span><span class="string" id="1696403">&#34;strconv:&nbsp;internal&nbsp;error:&nbsp;extFloat.FixedDecimal&nbsp;called&nbsp;with&nbsp;n&nbsp;==&nbsp;0&#34;</span><span class="op" id="1696470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1696473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1696476">//&nbsp;Multiply&nbsp;by&nbsp;an&nbsp;appropriate&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;have&nbsp;a&nbsp;reasonable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1696541">//&nbsp;number&nbsp;to&nbsp;process.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696564">f</span><span class="op" id="1696565">.</span><span class="ident" id="1696566">Normalize</span><span class="op" id="1696575">(</span><span class="op" id="1696576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696579">exp10</span><span class="op" id="1696584">,</span>&nbsp;<span class="ident" id="1696586">_</span>&nbsp;<span class="op" id="1696588">:=</span>&nbsp;<span class="ident" id="1696591">f</span><span class="op" id="1696592">.</span><span class="ident" id="1696593">frexp10</span><span class="op" id="1696600">(</span><span class="op" id="1696601">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696605">shift</span>&nbsp;<span class="op" id="1696611">:=</span>&nbsp;<span class="builtintype" id="1696614">uint</span><span class="op" id="1696618">(</span><span class="op" id="1696619">-</span><span class="ident" id="1696620">f</span><span class="op" id="1696621">.</span><span class="ident" id="1696622">exp</span><span class="op" id="1696625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696628">integer</span>&nbsp;<span class="op" id="1696636">:=</span>&nbsp;<span class="builtintype" id="1696639">uint32</span><span class="op" id="1696645">(</span><span class="ident" id="1696646">f</span><span class="op" id="1696647">.</span><span class="ident" id="1696648">mant</span>&nbsp;<span class="op" id="1696653">&gt;&gt;</span>&nbsp;<span class="ident" id="1696656">shift</span><span class="op" id="1696661">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696664">fraction</span>&nbsp;<span class="op" id="1696673">:=</span>&nbsp;<span class="ident" id="1696676">f</span><span class="op" id="1696677">.</span><span class="ident" id="1696678">mant</span>&nbsp;<span class="op" id="1696683">-</span>&nbsp;<span class="op" id="1696685">(</span><span class="ident" id="1696686">uint64</span><span class="op" id="1696692">(</span><span class="ident" id="1696693">integer</span><span class="op" id="1696700">)</span>&nbsp;<span class="op" id="1696702">&lt;&lt;</span>&nbsp;<span class="ident" id="1696705">shift</span><span class="op" id="1696710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696713">ε</span>&nbsp;<span class="op" id="1696716">:=</span>&nbsp;<span class="ident" id="1696719">uint64</span><span class="op" id="1696725">(</span><span class="num" id="1696726">1</span><span class="op" id="1696727">)</span>&nbsp;<span class="comment" id="1696729">//&nbsp;ε&nbsp;is&nbsp;the&nbsp;uncertainty&nbsp;we&nbsp;have&nbsp;on&nbsp;the&nbsp;mantissa&nbsp;of&nbsp;f.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1696786">//&nbsp;Write&nbsp;exactly&nbsp;n&nbsp;digits&nbsp;to&nbsp;d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696819">needed</span>&nbsp;<span class="op" id="1696826">:=</span>&nbsp;<span class="ident" id="1696829">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1696838">//&nbsp;how&nbsp;many&nbsp;digits&nbsp;are&nbsp;left&nbsp;to&nbsp;write.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696877">integerDigits</span>&nbsp;<span class="op" id="1696891">:=</span>&nbsp;<span class="num" id="1696894">0</span>&nbsp;<span class="comment" id="1696896">//&nbsp;the&nbsp;number&nbsp;of&nbsp;decimal&nbsp;digits&nbsp;of&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1696941">pow10</span>&nbsp;<span class="op" id="1696947">:=</span>&nbsp;<span class="ident" id="1696950">uint64</span><span class="op" id="1696956">(</span><span class="num" id="1696957">1</span><span class="op" id="1696958">)</span>&nbsp;<span class="comment" id="1696960">//&nbsp;the&nbsp;power&nbsp;of&nbsp;ten&nbsp;by&nbsp;which&nbsp;f&nbsp;was&nbsp;scaled.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1697004">for</span>&nbsp;<span class="ident" id="1697008">i</span><span class="op" id="1697009">,</span>&nbsp;<span class="ident" id="1697011">pow</span>&nbsp;<span class="op" id="1697015">:=</span>&nbsp;<span class="num" id="1697018">0</span><span class="op" id="1697019">,</span>&nbsp;<span class="ident" id="1697021">uint64</span><span class="op" id="1697027">(</span><span class="num" id="1697028">1</span><span class="op" id="1697029">)</span><span class="op" id="1697030">;</span>&nbsp;<span class="ident" id="1697032">i</span>&nbsp;<span class="op" id="1697034">&lt;</span>&nbsp;<span class="num" id="1697036">20</span><span class="op" id="1697038">;</span>&nbsp;<span class="ident" id="1697040">i</span><span class="op" id="1697041">++</span>&nbsp;<span class="op" id="1697044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1697048">if</span>&nbsp;<span class="ident" id="1697051">pow</span>&nbsp;<span class="op" id="1697055">&gt;</span>&nbsp;<span class="ident" id="1697057">uint64</span><span class="op" id="1697063">(</span><span class="ident" id="1697064">integer</span><span class="op" id="1697071">)</span>&nbsp;<span class="op" id="1697073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697078">integerDigits</span>&nbsp;<span class="op" id="1697092">=</span>&nbsp;<span class="ident" id="1697094">i</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1697099">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1697107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697111">pow</span>&nbsp;<span class="op" id="1697115">*=</span>&nbsp;<span class="num" id="1697118">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1697122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697125">rest</span>&nbsp;<span class="op" id="1697130">:=</span>&nbsp;<span class="ident" id="1697133">integer</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1697142">if</span>&nbsp;<span class="ident" id="1697145">integerDigits</span>&nbsp;<span class="op" id="1697159">&gt;</span>&nbsp;<span class="ident" id="1697161">needed</span>&nbsp;<span class="op" id="1697168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1697172">//&nbsp;the&nbsp;integral&nbsp;part&nbsp;is&nbsp;already&nbsp;large,&nbsp;trim&nbsp;the&nbsp;last&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697235">pow10</span>&nbsp;<span class="op" id="1697241">=</span>&nbsp;<span class="ident" id="1697243">uint64pow10</span><span class="op" id="1697254">[</span><span class="ident" id="1697255">integerDigits</span><span class="op" id="1697268">-</span><span class="ident" id="1697269">needed</span><span class="op" id="1697275">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697279">integer</span>&nbsp;<span class="op" id="1697287">/=</span>&nbsp;<span class="builtintype" id="1697290">uint32</span><span class="op" id="1697296">(</span><span class="ident" id="1697297">pow10</span><span class="op" id="1697302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697306">rest</span>&nbsp;<span class="op" id="1697311">-=</span>&nbsp;<span class="ident" id="1697314">integer</span>&nbsp;<span class="op" id="1697322">*</span>&nbsp;<span class="builtintype" id="1697324">uint32</span><span class="op" id="1697330">(</span><span class="ident" id="1697331">pow10</span><span class="op" id="1697336">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1697339">}</span>&nbsp;<span class="keyword" id="1697341">else</span>&nbsp;<span class="op" id="1697346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697350">rest</span>&nbsp;<span class="op" id="1697355">=</span>&nbsp;<span class="num" id="1697357">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1697360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1697364">//&nbsp;Write&nbsp;the&nbsp;digits&nbsp;of&nbsp;integer:&nbsp;the&nbsp;digits&nbsp;of&nbsp;rest&nbsp;are&nbsp;omitted.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1697429">var</span>&nbsp;<span class="ident" id="1697433">buf</span>&nbsp;<span class="op" id="1697437">[</span><span class="num" id="1697438">32</span><span class="op" id="1697440">]</span><span class="builtintype" id="1697441">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697447">pos</span>&nbsp;<span class="op" id="1697451">:=</span>&nbsp;<span class="builtinfunc" id="1697454">len</span><span class="op" id="1697457">(</span><span class="ident" id="1697458">buf</span><span class="op" id="1697461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1697464">for</span>&nbsp;<span class="ident" id="1697468">v</span>&nbsp;<span class="op" id="1697470">:=</span>&nbsp;<span class="ident" id="1697473">integer</span><span class="op" id="1697480">;</span>&nbsp;<span class="ident" id="1697482">v</span>&nbsp;<span class="op" id="1697484">&gt;</span>&nbsp;<span class="num" id="1697486">0</span><span class="op" id="1697487">;</span>&nbsp;<span class="op" id="1697489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697493">v1</span>&nbsp;<span class="op" id="1697496">:=</span>&nbsp;<span class="ident" id="1697499">v</span>&nbsp;<span class="op" id="1697501">/</span>&nbsp;<span class="num" id="1697503">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697508">v</span>&nbsp;<span class="op" id="1697510">-=</span>&nbsp;<span class="num" id="1697513">10</span>&nbsp;<span class="op" id="1697516">*</span>&nbsp;<span class="ident" id="1697518">v1</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697523">pos</span><span class="op" id="1697526">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697531">buf</span><span class="op" id="1697534">[</span><span class="ident" id="1697535">pos</span><span class="op" id="1697538">]</span>&nbsp;<span class="op" id="1697540">=</span>&nbsp;<span class="builtintype" id="1697542">byte</span><span class="op" id="1697546">(</span><span class="ident" id="1697547">v</span>&nbsp;<span class="op" id="1697549">+</span>&nbsp;<span class="string" id="1697551">&#39;0&#39;</span><span class="op" id="1697554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697558">v</span>&nbsp;<span class="op" id="1697560">=</span>&nbsp;<span class="ident" id="1697562">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1697566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1697569">for</span>&nbsp;<span class="ident" id="1697573">i</span>&nbsp;<span class="op" id="1697575">:=</span>&nbsp;<span class="ident" id="1697578">pos</span><span class="op" id="1697581">;</span>&nbsp;<span class="ident" id="1697583">i</span>&nbsp;<span class="op" id="1697585">&lt;</span>&nbsp;<span class="builtinfunc" id="1697587">len</span><span class="op" id="1697590">(</span><span class="ident" id="1697591">buf</span><span class="op" id="1697594">)</span><span class="op" id="1697595">;</span>&nbsp;<span class="ident" id="1697597">i</span><span class="op" id="1697598">++</span>&nbsp;<span class="op" id="1697601">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697605">d</span><span class="op" id="1697606">.</span><span class="ident" id="1697607">d</span><span class="op" id="1697608">[</span><span class="ident" id="1697609">i</span><span class="op" id="1697610">-</span><span class="ident" id="1697611">pos</span><span class="op" id="1697614">]</span>&nbsp;<span class="op" id="1697616">=</span>&nbsp;<span class="ident" id="1697618">buf</span><span class="op" id="1697621">[</span><span class="ident" id="1697622">i</span><span class="op" id="1697623">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1697626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697629">nd</span>&nbsp;<span class="op" id="1697632">:=</span>&nbsp;<span class="builtinfunc" id="1697635">len</span><span class="op" id="1697638">(</span><span class="ident" id="1697639">buf</span><span class="op" id="1697642">)</span>&nbsp;<span class="op" id="1697644">-</span>&nbsp;<span class="ident" id="1697646">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697651">d</span><span class="op" id="1697652">.</span><span class="ident" id="1697653">nd</span>&nbsp;<span class="op" id="1697656">=</span>&nbsp;<span class="ident" id="1697658">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697662">d</span><span class="op" id="1697663">.</span><span class="ident" id="1697664">dp</span>&nbsp;<span class="op" id="1697667">=</span>&nbsp;<span class="ident" id="1697669">integerDigits</span>&nbsp;<span class="op" id="1697683">+</span>&nbsp;<span class="ident" id="1697685">exp10</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697692">needed</span>&nbsp;<span class="op" id="1697699">-=</span>&nbsp;<span class="ident" id="1697702">nd</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1697707">if</span>&nbsp;<span class="ident" id="1697710">needed</span>&nbsp;<span class="op" id="1697717">&gt;</span>&nbsp;<span class="num" id="1697719">0</span>&nbsp;<span class="op" id="1697721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1697725">if</span>&nbsp;<span class="ident" id="1697728">rest</span>&nbsp;<span class="op" id="1697733">!=</span>&nbsp;<span class="num" id="1697736">0</span>&nbsp;<span class="op" id="1697738">||</span>&nbsp;<span class="ident" id="1697741">pow10</span>&nbsp;<span class="op" id="1697747">!=</span>&nbsp;<span class="num" id="1697750">1</span>&nbsp;<span class="op" id="1697752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1697757">panic</span><span class="op" id="1697762">(</span><span class="string" id="1697763">&#34;strconv:&nbsp;internal&nbsp;error,&nbsp;rest&nbsp;!=&nbsp;0&nbsp;but&nbsp;needed&nbsp;&gt;&nbsp;0&#34;</span><span class="op" id="1697814">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1697818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1697822">//&nbsp;Emit&nbsp;digits&nbsp;for&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;Each&nbsp;time,&nbsp;10*fraction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1697887">//&nbsp;fits&nbsp;in&nbsp;a&nbsp;uint64&nbsp;without&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1697927">for</span>&nbsp;<span class="ident" id="1697931">needed</span>&nbsp;<span class="op" id="1697938">&gt;</span>&nbsp;<span class="num" id="1697940">0</span>&nbsp;<span class="op" id="1697942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697947">fraction</span>&nbsp;<span class="op" id="1697956">*=</span>&nbsp;<span class="num" id="1697959">10</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1697965">ε</span>&nbsp;<span class="op" id="1697968">*=</span>&nbsp;<span class="num" id="1697971">10</span>&nbsp;<span class="comment" id="1697974">//&nbsp;the&nbsp;uncertainty&nbsp;scales&nbsp;as&nbsp;we&nbsp;multiply&nbsp;by&nbsp;ten.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1698026">if</span>&nbsp;<span class="num" id="1698029">2</span><span class="op" id="1698030">*</span><span class="ident" id="1698031">ε</span>&nbsp;<span class="op" id="1698034">&gt;</span>&nbsp;<span class="num" id="1698036">1</span><span class="op" id="1698037">&lt;&lt;</span><span class="ident" id="1698039">shift</span>&nbsp;<span class="op" id="1698045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698051">//&nbsp;the&nbsp;error&nbsp;is&nbsp;so&nbsp;large&nbsp;it&nbsp;could&nbsp;modify&nbsp;which&nbsp;digit&nbsp;to&nbsp;write,&nbsp;abort.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1698125">return</span>&nbsp;<span class="builtintype" id="1698132">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1698141">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1698146">digit</span>&nbsp;<span class="op" id="1698152">:=</span>&nbsp;<span class="ident" id="1698155">fraction</span>&nbsp;<span class="op" id="1698164">&gt;&gt;</span>&nbsp;<span class="ident" id="1698167">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1698176">d</span><span class="op" id="1698177">.</span><span class="ident" id="1698178">d</span><span class="op" id="1698179">[</span><span class="ident" id="1698180">nd</span><span class="op" id="1698182">]</span>&nbsp;<span class="op" id="1698184">=</span>&nbsp;<span class="builtintype" id="1698186">byte</span><span class="op" id="1698190">(</span><span class="ident" id="1698191">digit</span>&nbsp;<span class="op" id="1698197">+</span>&nbsp;<span class="string" id="1698199">&#39;0&#39;</span><span class="op" id="1698202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1698207">fraction</span>&nbsp;<span class="op" id="1698216">-=</span>&nbsp;<span class="ident" id="1698219">digit</span>&nbsp;<span class="op" id="1698225">&lt;&lt;</span>&nbsp;<span class="ident" id="1698228">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1698237">nd</span><span class="op" id="1698239">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1698245">needed</span><span class="op" id="1698251">--</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1698256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1698260">d</span><span class="op" id="1698261">.</span><span class="ident" id="1698262">nd</span>&nbsp;<span class="op" id="1698265">=</span>&nbsp;<span class="ident" id="1698267">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1698271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698275">//&nbsp;We&nbsp;have&nbsp;written&nbsp;a&nbsp;truncation&nbsp;of&nbsp;f&nbsp;(a&nbsp;numerator&nbsp;/&nbsp;10^d.dp).&nbsp;The&nbsp;remaining&nbsp;part</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698357">//&nbsp;can&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;small&nbsp;number&nbsp;(&lt;&nbsp;1)&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;last&nbsp;digit&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698441">//&nbsp;numerator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698456">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698460">//&nbsp;If&nbsp;rest&nbsp;&gt;&nbsp;0,&nbsp;the&nbsp;amount&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698492">//&nbsp;&nbsp;&nbsp;&nbsp;(rest&lt;&lt;shift&nbsp;|&nbsp;fraction)&nbsp;/&nbsp;(pow10&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698543">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698596">//&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;fact&nbsp;that&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;guarantees&nbsp;that&nbsp;pow10&nbsp;&lt;&lt;&nbsp;shift&nbsp;does&nbsp;not&nbsp;overflow&nbsp;a&nbsp;uint64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698682">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698686">//&nbsp;If&nbsp;rest&nbsp;=&nbsp;0,&nbsp;pow10&nbsp;==&nbsp;1&nbsp;and&nbsp;the&nbsp;amount&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698732">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;/&nbsp;(1&nbsp;&lt;&lt;&nbsp;shift)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698763">//&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;being&nbsp;known&nbsp;with&nbsp;a&nbsp;±ε&nbsp;uncertainty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698816">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698820">//&nbsp;We&nbsp;pass&nbsp;this&nbsp;information&nbsp;to&nbsp;the&nbsp;rounding&nbsp;routine&nbsp;for&nbsp;adjustment.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1698890">ok</span>&nbsp;<span class="op" id="1698893">:=</span>&nbsp;<span class="ident" id="1698896">adjustLastDigitFixed</span><span class="op" id="1698916">(</span><span class="ident" id="1698917">d</span><span class="op" id="1698918">,</span>&nbsp;<span class="ident" id="1698920">uint64</span><span class="op" id="1698926">(</span><span class="ident" id="1698927">rest</span><span class="op" id="1698931">)</span><span class="op" id="1698932">&lt;&lt;</span><span class="ident" id="1698934">shift</span><span class="op" id="1698939">|</span><span class="ident" id="1698940">fraction</span><span class="op" id="1698948">,</span>&nbsp;<span class="ident" id="1698950">pow10</span><span class="op" id="1698955">,</span>&nbsp;<span class="ident" id="1698957">shift</span><span class="op" id="1698962">,</span>&nbsp;<span class="ident" id="1698964">ε</span><span class="op" id="1698966">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1698969">if</span>&nbsp;<span class="op" id="1698972">!</span><span class="ident" id="1698973">ok</span>&nbsp;<span class="op" id="1698976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1698980">return</span>&nbsp;<span class="builtintype" id="1698987">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1698994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1698997">//&nbsp;Trim&nbsp;trailing&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1699022">for</span>&nbsp;<span class="ident" id="1699026">i</span>&nbsp;<span class="op" id="1699028">:=</span>&nbsp;<span class="ident" id="1699031">d</span><span class="op" id="1699032">.</span><span class="ident" id="1699033">nd</span>&nbsp;<span class="op" id="1699036">-</span>&nbsp;<span class="num" id="1699038">1</span><span class="op" id="1699039">;</span>&nbsp;<span class="ident" id="1699041">i</span>&nbsp;<span class="op" id="1699043">&gt;=</span>&nbsp;<span class="num" id="1699046">0</span><span class="op" id="1699047">;</span>&nbsp;<span class="ident" id="1699049">i</span><span class="op" id="1699050">--</span>&nbsp;<span class="op" id="1699053">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1699057">if</span>&nbsp;<span class="ident" id="1699060">d</span><span class="op" id="1699061">.</span><span class="ident" id="1699062">d</span><span class="op" id="1699063">[</span><span class="ident" id="1699064">i</span><span class="op" id="1699065">]</span>&nbsp;<span class="op" id="1699067">!=</span>&nbsp;<span class="string" id="1699070">&#39;0&#39;</span>&nbsp;<span class="op" id="1699074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1699079">d</span><span class="op" id="1699080">.</span><span class="ident" id="1699081">nd</span>&nbsp;<span class="op" id="1699084">=</span>&nbsp;<span class="ident" id="1699086">i</span>&nbsp;<span class="op" id="1699088">+</span>&nbsp;<span class="num" id="1699090">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1699095">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1699103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1699106">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1699109">return</span>&nbsp;<span class="builtintype" id="1699116">true</span><br>
<span class="lineno"></span><span class="op" id="1699121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1699124">//&nbsp;adjustLastDigitFixed&nbsp;assumes&nbsp;d&nbsp;contains&nbsp;the&nbsp;representation&nbsp;of&nbsp;the&nbsp;integral&nbsp;part</span><br>
<span class="lineno"></span><span class="comment" id="1699207">//&nbsp;of&nbsp;some&nbsp;number,&nbsp;whose&nbsp;fractional&nbsp;part&nbsp;is&nbsp;num&nbsp;/&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift).&nbsp;The&nbsp;numerator</span><br>
<span class="lineno">490</span><span class="comment" id="1699287">//&nbsp;num&nbsp;is&nbsp;only&nbsp;known&nbsp;up&nbsp;to&nbsp;an&nbsp;uncertainty&nbsp;of&nbsp;size&nbsp;ε,&nbsp;assumed&nbsp;to&nbsp;be&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="1699365">//&nbsp;(den&nbsp;&lt;&lt;&nbsp;shift)/2.</span><br>
<span class="lineno"></span><span class="comment" id="1699386">//</span><br>
<span class="lineno"></span><span class="comment" id="1699389">//&nbsp;It&nbsp;will&nbsp;increase&nbsp;the&nbsp;last&nbsp;digit&nbsp;by&nbsp;one&nbsp;to&nbsp;account&nbsp;for&nbsp;correct&nbsp;rounding,&nbsp;typically</span><br>
<span class="lineno"></span><span class="comment" id="1699474">//&nbsp;when&nbsp;the&nbsp;fractional&nbsp;part&nbsp;is&nbsp;greater&nbsp;than&nbsp;1/2,&nbsp;and&nbsp;will&nbsp;return&nbsp;false&nbsp;if&nbsp;ε&nbsp;is&nbsp;such</span><br>
<span class="lineno">495</span><span class="comment" id="1699559">//&nbsp;that&nbsp;no&nbsp;correct&nbsp;answer&nbsp;can&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="keyword" id="1699599">func</span>&nbsp;<span class="ident" id="1699604">adjustLastDigitFixed</span><span class="op" id="1699624">(</span><span class="ident" id="1699625">d</span>&nbsp;<span class="op" id="1699627">*</span><span class="ident" id="1699628">decimalSlice</span><span class="op" id="1699640">,</span>&nbsp;<span class="ident" id="1699642">num</span><span class="op" id="1699645">,</span>&nbsp;<span class="ident" id="1699647">den</span>&nbsp;<span class="ident" id="1699651">uint64</span><span class="op" id="1699657">,</span>&nbsp;<span class="ident" id="1699659">shift</span>&nbsp;<span class="builtintype" id="1699665">uint</span><span class="op" id="1699669">,</span>&nbsp;<span class="ident" id="1699671">ε</span>&nbsp;<span class="ident" id="1699674">uint64</span><span class="op" id="1699680">)</span>&nbsp;<span class="builtintype" id="1699682">bool</span>&nbsp;<span class="op" id="1699687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1699690">if</span>&nbsp;<span class="ident" id="1699693">num</span>&nbsp;<span class="op" id="1699697">&gt;</span>&nbsp;<span class="ident" id="1699699">den</span><span class="op" id="1699702">&lt;&lt;</span><span class="ident" id="1699704">shift</span>&nbsp;<span class="op" id="1699710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1699714">panic</span><span class="op" id="1699719">(</span><span class="string" id="1699720">&#34;strconv:&nbsp;num&nbsp;&gt;&nbsp;den&lt;&lt;shift&nbsp;in&nbsp;adjustLastDigitFixed&#34;</span><span class="op" id="1699771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1699774">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1699777">if</span>&nbsp;<span class="num" id="1699780">2</span><span class="op" id="1699781">*</span><span class="ident" id="1699782">ε</span>&nbsp;<span class="op" id="1699785">&gt;</span>&nbsp;<span class="ident" id="1699787">den</span><span class="op" id="1699790">&lt;&lt;</span><span class="ident" id="1699792">shift</span>&nbsp;<span class="op" id="1699798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1699802">panic</span><span class="op" id="1699807">(</span><span class="string" id="1699808">&#34;strconv:&nbsp;ε&nbsp;&gt;&nbsp;(den&lt;&lt;shift)/2&#34;</span><span class="op" id="1699838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1699841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1699844">if</span>&nbsp;<span class="num" id="1699847">2</span><span class="op" id="1699848">*</span><span class="op" id="1699849">(</span><span class="ident" id="1699850">num</span><span class="op" id="1699853">+</span><span class="ident" id="1699854">ε</span><span class="op" id="1699856">)</span>&nbsp;<span class="op" id="1699858">&lt;</span>&nbsp;<span class="ident" id="1699860">den</span><span class="op" id="1699863">&lt;&lt;</span><span class="ident" id="1699865">shift</span>&nbsp;<span class="op" id="1699871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1699875">return</span>&nbsp;<span class="builtintype" id="1699882">true</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1699888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1699891">if</span>&nbsp;<span class="num" id="1699894">2</span><span class="op" id="1699895">*</span><span class="op" id="1699896">(</span><span class="ident" id="1699897">num</span><span class="op" id="1699900">-</span><span class="ident" id="1699901">ε</span><span class="op" id="1699903">)</span>&nbsp;<span class="op" id="1699905">&gt;</span>&nbsp;<span class="ident" id="1699907">den</span><span class="op" id="1699910">&lt;&lt;</span><span class="ident" id="1699912">shift</span>&nbsp;<span class="op" id="1699918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1699922">//&nbsp;increment&nbsp;d&nbsp;by&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1699945">i</span>&nbsp;<span class="op" id="1699947">:=</span>&nbsp;<span class="ident" id="1699950">d</span><span class="op" id="1699951">.</span><span class="ident" id="1699952">nd</span>&nbsp;<span class="op" id="1699955">-</span>&nbsp;<span class="num" id="1699957">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1699961">for</span>&nbsp;<span class="op" id="1699965">;</span>&nbsp;<span class="ident" id="1699967">i</span>&nbsp;<span class="op" id="1699969">&gt;=</span>&nbsp;<span class="num" id="1699972">0</span><span class="op" id="1699973">;</span>&nbsp;<span class="ident" id="1699975">i</span><span class="op" id="1699976">--</span>&nbsp;<span class="op" id="1699979">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1699984">if</span>&nbsp;<span class="ident" id="1699987">d</span><span class="op" id="1699988">.</span><span class="ident" id="1699989">d</span><span class="op" id="1699990">[</span><span class="ident" id="1699991">i</span><span class="op" id="1699992">]</span>&nbsp;<span class="op" id="1699994">==</span>&nbsp;<span class="string" id="1699997">&#39;9&#39;</span>&nbsp;<span class="op" id="1700001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700007">d</span><span class="op" id="1700008">.</span><span class="ident" id="1700009">nd</span><span class="op" id="1700011">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1700017">}</span>&nbsp;<span class="keyword" id="1700019">else</span>&nbsp;<span class="op" id="1700024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700030">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1700039">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1700043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700047">if</span>&nbsp;<span class="ident" id="1700050">i</span>&nbsp;<span class="op" id="1700052">&lt;</span>&nbsp;<span class="num" id="1700054">0</span>&nbsp;<span class="op" id="1700056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700061">d</span><span class="op" id="1700062">.</span><span class="ident" id="1700063">d</span><span class="op" id="1700064">[</span><span class="num" id="1700065">0</span><span class="op" id="1700066">]</span>&nbsp;<span class="op" id="1700068">=</span>&nbsp;<span class="string" id="1700070">&#39;1&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700077">d</span><span class="op" id="1700078">.</span><span class="ident" id="1700079">nd</span>&nbsp;<span class="op" id="1700082">=</span>&nbsp;<span class="num" id="1700084">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700089">d</span><span class="op" id="1700090">.</span><span class="ident" id="1700091">dp</span><span class="op" id="1700093">++</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1700098">}</span>&nbsp;<span class="keyword" id="1700100">else</span>&nbsp;<span class="op" id="1700105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700110">d</span><span class="op" id="1700111">.</span><span class="ident" id="1700112">d</span><span class="op" id="1700113">[</span><span class="ident" id="1700114">i</span><span class="op" id="1700115">]</span><span class="op" id="1700116">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1700121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700125">return</span>&nbsp;<span class="builtintype" id="1700132">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1700138">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700141">return</span>&nbsp;<span class="builtintype" id="1700148">false</span><br>
<span class="lineno"></span><span class="op" id="1700154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1700157">//&nbsp;ShortestDecimal&nbsp;stores&nbsp;in&nbsp;d&nbsp;the&nbsp;shortest&nbsp;decimal&nbsp;representation&nbsp;of&nbsp;f</span><br>
<span class="lineno"></span><span class="comment" id="1700229">//&nbsp;which&nbsp;belongs&nbsp;to&nbsp;the&nbsp;open&nbsp;interval&nbsp;(lower,&nbsp;upper),&nbsp;where&nbsp;f&nbsp;is&nbsp;supposed</span><br>
<span class="lineno">530</span><span class="comment" id="1700303">//&nbsp;to&nbsp;lie.&nbsp;It&nbsp;returns&nbsp;false&nbsp;whenever&nbsp;the&nbsp;result&nbsp;is&nbsp;unsure.&nbsp;The&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="1700381">//&nbsp;uses&nbsp;the&nbsp;Grisu3&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="1700411">func</span>&nbsp;<span class="op" id="1700416">(</span><span class="ident" id="1700417">f</span>&nbsp;<span class="op" id="1700419">*</span><span class="ident" id="1700420">extFloat</span><span class="op" id="1700428">)</span>&nbsp;<span class="ident" id="1700430">ShortestDecimal</span><span class="op" id="1700445">(</span><span class="ident" id="1700446">d</span>&nbsp;<span class="op" id="1700448">*</span><span class="ident" id="1700449">decimalSlice</span><span class="op" id="1700461">,</span>&nbsp;<span class="ident" id="1700463">lower</span><span class="op" id="1700468">,</span>&nbsp;<span class="ident" id="1700470">upper</span>&nbsp;<span class="op" id="1700476">*</span><span class="ident" id="1700477">extFloat</span><span class="op" id="1700485">)</span>&nbsp;<span class="builtintype" id="1700487">bool</span>&nbsp;<span class="op" id="1700492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700495">if</span>&nbsp;<span class="ident" id="1700498">f</span><span class="op" id="1700499">.</span><span class="ident" id="1700500">mant</span>&nbsp;<span class="op" id="1700505">==</span>&nbsp;<span class="num" id="1700508">0</span>&nbsp;<span class="op" id="1700510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700514">d</span><span class="op" id="1700515">.</span><span class="ident" id="1700516">nd</span>&nbsp;<span class="op" id="1700519">=</span>&nbsp;<span class="num" id="1700521">0</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700525">d</span><span class="op" id="1700526">.</span><span class="ident" id="1700527">dp</span>&nbsp;<span class="op" id="1700530">=</span>&nbsp;<span class="num" id="1700532">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700536">d</span><span class="op" id="1700537">.</span><span class="ident" id="1700538">neg</span>&nbsp;<span class="op" id="1700542">=</span>&nbsp;<span class="ident" id="1700544">f</span><span class="op" id="1700545">.</span><span class="ident" id="1700546">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700552">return</span>&nbsp;<span class="builtintype" id="1700559">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1700565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700568">if</span>&nbsp;<span class="ident" id="1700571">f</span><span class="op" id="1700572">.</span><span class="ident" id="1700573">exp</span>&nbsp;<span class="op" id="1700577">==</span>&nbsp;<span class="num" id="1700580">0</span>&nbsp;<span class="op" id="1700582">&amp;&amp;</span>&nbsp;<span class="op" id="1700585">*</span><span class="ident" id="1700586">lower</span>&nbsp;<span class="op" id="1700592">==</span>&nbsp;<span class="op" id="1700595">*</span><span class="ident" id="1700596">f</span>&nbsp;<span class="op" id="1700598">&amp;&amp;</span>&nbsp;<span class="op" id="1700601">*</span><span class="ident" id="1700602">lower</span>&nbsp;<span class="op" id="1700608">==</span>&nbsp;<span class="op" id="1700611">*</span><span class="ident" id="1700612">upper</span>&nbsp;<span class="op" id="1700618">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1700622">//&nbsp;an&nbsp;exact&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700645">var</span>&nbsp;<span class="ident" id="1700649">buf</span>&nbsp;<span class="op" id="1700653">[</span><span class="num" id="1700654">24</span><span class="op" id="1700656">]</span><span class="builtintype" id="1700657">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700664">n</span>&nbsp;<span class="op" id="1700666">:=</span>&nbsp;<span class="builtinfunc" id="1700669">len</span><span class="op" id="1700672">(</span><span class="ident" id="1700673">buf</span><span class="op" id="1700676">)</span>&nbsp;<span class="op" id="1700678">-</span>&nbsp;<span class="num" id="1700680">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700684">for</span>&nbsp;<span class="ident" id="1700688">v</span>&nbsp;<span class="op" id="1700690">:=</span>&nbsp;<span class="ident" id="1700693">f</span><span class="op" id="1700694">.</span><span class="ident" id="1700695">mant</span><span class="op" id="1700699">;</span>&nbsp;<span class="ident" id="1700701">v</span>&nbsp;<span class="op" id="1700703">&gt;</span>&nbsp;<span class="num" id="1700705">0</span><span class="op" id="1700706">;</span>&nbsp;<span class="op" id="1700708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700713">v1</span>&nbsp;<span class="op" id="1700716">:=</span>&nbsp;<span class="ident" id="1700719">v</span>&nbsp;<span class="op" id="1700721">/</span>&nbsp;<span class="num" id="1700723">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700729">v</span>&nbsp;<span class="op" id="1700731">-=</span>&nbsp;<span class="num" id="1700734">10</span>&nbsp;<span class="op" id="1700737">*</span>&nbsp;<span class="ident" id="1700739">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700745">buf</span><span class="op" id="1700748">[</span><span class="ident" id="1700749">n</span><span class="op" id="1700750">]</span>&nbsp;<span class="op" id="1700752">=</span>&nbsp;<span class="builtintype" id="1700754">byte</span><span class="op" id="1700758">(</span><span class="ident" id="1700759">v</span>&nbsp;<span class="op" id="1700761">+</span>&nbsp;<span class="string" id="1700763">&#39;0&#39;</span><span class="op" id="1700766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700771">n</span><span class="op" id="1700772">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700778">v</span>&nbsp;<span class="op" id="1700780">=</span>&nbsp;<span class="ident" id="1700782">v1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1700787">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700791">nd</span>&nbsp;<span class="op" id="1700794">:=</span>&nbsp;<span class="builtinfunc" id="1700797">len</span><span class="op" id="1700800">(</span><span class="ident" id="1700801">buf</span><span class="op" id="1700804">)</span>&nbsp;<span class="op" id="1700806">-</span>&nbsp;<span class="ident" id="1700808">n</span>&nbsp;<span class="op" id="1700810">-</span>&nbsp;<span class="num" id="1700812">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700816">for</span>&nbsp;<span class="ident" id="1700820">i</span>&nbsp;<span class="op" id="1700822">:=</span>&nbsp;<span class="num" id="1700825">0</span><span class="op" id="1700826">;</span>&nbsp;<span class="ident" id="1700828">i</span>&nbsp;<span class="op" id="1700830">&lt;</span>&nbsp;<span class="ident" id="1700832">nd</span><span class="op" id="1700834">;</span>&nbsp;<span class="ident" id="1700836">i</span><span class="op" id="1700837">++</span>&nbsp;<span class="op" id="1700840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700845">d</span><span class="op" id="1700846">.</span><span class="ident" id="1700847">d</span><span class="op" id="1700848">[</span><span class="ident" id="1700849">i</span><span class="op" id="1700850">]</span>&nbsp;<span class="op" id="1700852">=</span>&nbsp;<span class="ident" id="1700854">buf</span><span class="op" id="1700857">[</span><span class="ident" id="1700858">n</span><span class="op" id="1700859">+</span><span class="num" id="1700860">1</span><span class="op" id="1700861">+</span><span class="ident" id="1700862">i</span><span class="op" id="1700863">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1700867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700871">d</span><span class="op" id="1700872">.</span><span class="ident" id="1700873">nd</span><span class="op" id="1700875">,</span>&nbsp;<span class="ident" id="1700877">d</span><span class="op" id="1700878">.</span><span class="ident" id="1700879">dp</span>&nbsp;<span class="op" id="1700882">=</span>&nbsp;<span class="ident" id="1700884">nd</span><span class="op" id="1700886">,</span>&nbsp;<span class="ident" id="1700888">nd</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700893">for</span>&nbsp;<span class="ident" id="1700897">d</span><span class="op" id="1700898">.</span><span class="ident" id="1700899">nd</span>&nbsp;<span class="op" id="1700902">&gt;</span>&nbsp;<span class="num" id="1700904">0</span>&nbsp;<span class="op" id="1700906">&amp;&amp;</span>&nbsp;<span class="ident" id="1700909">d</span><span class="op" id="1700910">.</span><span class="ident" id="1700911">d</span><span class="op" id="1700912">[</span><span class="ident" id="1700913">d</span><span class="op" id="1700914">.</span><span class="ident" id="1700915">nd</span><span class="op" id="1700917">-</span><span class="num" id="1700918">1</span><span class="op" id="1700919">]</span>&nbsp;<span class="op" id="1700921">==</span>&nbsp;<span class="string" id="1700924">&#39;0&#39;</span>&nbsp;<span class="op" id="1700928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700933">d</span><span class="op" id="1700934">.</span><span class="ident" id="1700935">nd</span><span class="op" id="1700937">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1700942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700946">if</span>&nbsp;<span class="ident" id="1700949">d</span><span class="op" id="1700950">.</span><span class="ident" id="1700951">nd</span>&nbsp;<span class="op" id="1700954">==</span>&nbsp;<span class="num" id="1700957">0</span>&nbsp;<span class="op" id="1700959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700964">d</span><span class="op" id="1700965">.</span><span class="ident" id="1700966">dp</span>&nbsp;<span class="op" id="1700969">=</span>&nbsp;<span class="num" id="1700971">0</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1700975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1700979">d</span><span class="op" id="1700980">.</span><span class="ident" id="1700981">neg</span>&nbsp;<span class="op" id="1700985">=</span>&nbsp;<span class="ident" id="1700987">f</span><span class="op" id="1700988">.</span><span class="ident" id="1700989">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1700995">return</span>&nbsp;<span class="builtintype" id="1701002">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1701008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701011">upper</span><span class="op" id="1701016">.</span><span class="ident" id="1701017">Normalize</span><span class="op" id="1701026">(</span><span class="op" id="1701027">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1701030">//&nbsp;Uniformize&nbsp;exponents.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1701056">if</span>&nbsp;<span class="ident" id="1701059">f</span><span class="op" id="1701060">.</span><span class="ident" id="1701061">exp</span>&nbsp;<span class="op" id="1701065">&gt;</span>&nbsp;<span class="ident" id="1701067">upper</span><span class="op" id="1701072">.</span><span class="ident" id="1701073">exp</span>&nbsp;<span class="op" id="1701077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701081">f</span><span class="op" id="1701082">.</span><span class="ident" id="1701083">mant</span>&nbsp;<span class="op" id="1701088">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="1701092">uint</span><span class="op" id="1701096">(</span><span class="ident" id="1701097">f</span><span class="op" id="1701098">.</span><span class="ident" id="1701099">exp</span>&nbsp;<span class="op" id="1701103">-</span>&nbsp;<span class="ident" id="1701105">upper</span><span class="op" id="1701110">.</span><span class="ident" id="1701111">exp</span><span class="op" id="1701114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701118">f</span><span class="op" id="1701119">.</span><span class="ident" id="1701120">exp</span>&nbsp;<span class="op" id="1701124">=</span>&nbsp;<span class="ident" id="1701126">upper</span><span class="op" id="1701131">.</span><span class="ident" id="1701132">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1701137">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1701140">if</span>&nbsp;<span class="ident" id="1701143">lower</span><span class="op" id="1701148">.</span><span class="ident" id="1701149">exp</span>&nbsp;<span class="op" id="1701153">&gt;</span>&nbsp;<span class="ident" id="1701155">upper</span><span class="op" id="1701160">.</span><span class="ident" id="1701161">exp</span>&nbsp;<span class="op" id="1701165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701169">lower</span><span class="op" id="1701174">.</span><span class="ident" id="1701175">mant</span>&nbsp;<span class="op" id="1701180">&lt;&lt;=</span>&nbsp;<span class="builtintype" id="1701184">uint</span><span class="op" id="1701188">(</span><span class="ident" id="1701189">lower</span><span class="op" id="1701194">.</span><span class="ident" id="1701195">exp</span>&nbsp;<span class="op" id="1701199">-</span>&nbsp;<span class="ident" id="1701201">upper</span><span class="op" id="1701206">.</span><span class="ident" id="1701207">exp</span><span class="op" id="1701210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701214">lower</span><span class="op" id="1701219">.</span><span class="ident" id="1701220">exp</span>&nbsp;<span class="op" id="1701224">=</span>&nbsp;<span class="ident" id="1701226">upper</span><span class="op" id="1701231">.</span><span class="ident" id="1701232">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1701237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701241">exp10</span>&nbsp;<span class="op" id="1701247">:=</span>&nbsp;<span class="ident" id="1701250">frexp10Many</span><span class="op" id="1701261">(</span><span class="ident" id="1701262">lower</span><span class="op" id="1701267">,</span>&nbsp;<span class="ident" id="1701269">f</span><span class="op" id="1701270">,</span>&nbsp;<span class="ident" id="1701272">upper</span><span class="op" id="1701277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1701280">//&nbsp;Take&nbsp;a&nbsp;safety&nbsp;margin&nbsp;due&nbsp;to&nbsp;rounding&nbsp;in&nbsp;frexp10Many,&nbsp;but&nbsp;we&nbsp;lose&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701360">upper</span><span class="op" id="1701365">.</span><span class="ident" id="1701366">mant</span><span class="op" id="1701370">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701374">lower</span><span class="op" id="1701379">.</span><span class="ident" id="1701380">mant</span><span class="op" id="1701384">--</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1701389">//&nbsp;The&nbsp;shortest&nbsp;representation&nbsp;of&nbsp;f&nbsp;is&nbsp;either&nbsp;rounded&nbsp;up&nbsp;or&nbsp;down,&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1701460">//&nbsp;in&nbsp;any&nbsp;case,&nbsp;it&nbsp;is&nbsp;a&nbsp;truncation&nbsp;of&nbsp;upper.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701506">shift</span>&nbsp;<span class="op" id="1701512">:=</span>&nbsp;<span class="builtintype" id="1701515">uint</span><span class="op" id="1701519">(</span><span class="op" id="1701520">-</span><span class="ident" id="1701521">upper</span><span class="op" id="1701526">.</span><span class="ident" id="1701527">exp</span><span class="op" id="1701530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701533">integer</span>&nbsp;<span class="op" id="1701541">:=</span>&nbsp;<span class="builtintype" id="1701544">uint32</span><span class="op" id="1701550">(</span><span class="ident" id="1701551">upper</span><span class="op" id="1701556">.</span><span class="ident" id="1701557">mant</span>&nbsp;<span class="op" id="1701562">&gt;&gt;</span>&nbsp;<span class="ident" id="1701565">shift</span><span class="op" id="1701570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701573">fraction</span>&nbsp;<span class="op" id="1701582">:=</span>&nbsp;<span class="ident" id="1701585">upper</span><span class="op" id="1701590">.</span><span class="ident" id="1701591">mant</span>&nbsp;<span class="op" id="1701596">-</span>&nbsp;<span class="op" id="1701598">(</span><span class="ident" id="1701599">uint64</span><span class="op" id="1701605">(</span><span class="ident" id="1701606">integer</span><span class="op" id="1701613">)</span>&nbsp;<span class="op" id="1701615">&lt;&lt;</span>&nbsp;<span class="ident" id="1701618">shift</span><span class="op" id="1701623">)</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1701627">//&nbsp;How&nbsp;far&nbsp;we&nbsp;can&nbsp;go&nbsp;down&nbsp;from&nbsp;upper&nbsp;until&nbsp;the&nbsp;result&nbsp;is&nbsp;wrong.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701692">allowance</span>&nbsp;<span class="op" id="1701702">:=</span>&nbsp;<span class="ident" id="1701705">upper</span><span class="op" id="1701710">.</span><span class="ident" id="1701711">mant</span>&nbsp;<span class="op" id="1701716">-</span>&nbsp;<span class="ident" id="1701718">lower</span><span class="op" id="1701723">.</span><span class="ident" id="1701724">mant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1701730">//&nbsp;How&nbsp;far&nbsp;we&nbsp;should&nbsp;go&nbsp;to&nbsp;get&nbsp;a&nbsp;very&nbsp;precise&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701785">targetDiff</span>&nbsp;<span class="op" id="1701796">:=</span>&nbsp;<span class="ident" id="1701799">upper</span><span class="op" id="1701804">.</span><span class="ident" id="1701805">mant</span>&nbsp;<span class="op" id="1701810">-</span>&nbsp;<span class="ident" id="1701812">f</span><span class="op" id="1701813">.</span><span class="ident" id="1701814">mant</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1701821">//&nbsp;Count&nbsp;integral&nbsp;digits:&nbsp;there&nbsp;are&nbsp;at&nbsp;most&nbsp;10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1701870">var</span>&nbsp;<span class="ident" id="1701874">integerDigits</span>&nbsp;<span class="builtintype" id="1701888">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1701893">for</span>&nbsp;<span class="ident" id="1701897">i</span><span class="op" id="1701898">,</span>&nbsp;<span class="ident" id="1701900">pow</span>&nbsp;<span class="op" id="1701904">:=</span>&nbsp;<span class="num" id="1701907">0</span><span class="op" id="1701908">,</span>&nbsp;<span class="ident" id="1701910">uint64</span><span class="op" id="1701916">(</span><span class="num" id="1701917">1</span><span class="op" id="1701918">)</span><span class="op" id="1701919">;</span>&nbsp;<span class="ident" id="1701921">i</span>&nbsp;<span class="op" id="1701923">&lt;</span>&nbsp;<span class="num" id="1701925">20</span><span class="op" id="1701927">;</span>&nbsp;<span class="ident" id="1701929">i</span><span class="op" id="1701930">++</span>&nbsp;<span class="op" id="1701933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1701937">if</span>&nbsp;<span class="ident" id="1701940">pow</span>&nbsp;<span class="op" id="1701944">&gt;</span>&nbsp;<span class="ident" id="1701946">uint64</span><span class="op" id="1701952">(</span><span class="ident" id="1701953">integer</span><span class="op" id="1701960">)</span>&nbsp;<span class="op" id="1701962">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1701967">integerDigits</span>&nbsp;<span class="op" id="1701981">=</span>&nbsp;<span class="ident" id="1701983">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1701988">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1701996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702000">pow</span>&nbsp;<span class="op" id="1702004">*=</span>&nbsp;<span class="num" id="1702007">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1702011">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1702014">for</span>&nbsp;<span class="ident" id="1702018">i</span>&nbsp;<span class="op" id="1702020">:=</span>&nbsp;<span class="num" id="1702023">0</span><span class="op" id="1702024">;</span>&nbsp;<span class="ident" id="1702026">i</span>&nbsp;<span class="op" id="1702028">&lt;</span>&nbsp;<span class="ident" id="1702030">integerDigits</span><span class="op" id="1702043">;</span>&nbsp;<span class="ident" id="1702045">i</span><span class="op" id="1702046">++</span>&nbsp;<span class="op" id="1702049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702053">pow</span>&nbsp;<span class="op" id="1702057">:=</span>&nbsp;<span class="ident" id="1702060">uint64pow10</span><span class="op" id="1702071">[</span><span class="ident" id="1702072">integerDigits</span><span class="op" id="1702085">-</span><span class="ident" id="1702086">i</span><span class="op" id="1702087">-</span><span class="num" id="1702088">1</span><span class="op" id="1702089">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702093">digit</span>&nbsp;<span class="op" id="1702099">:=</span>&nbsp;<span class="ident" id="1702102">integer</span>&nbsp;<span class="op" id="1702110">/</span>&nbsp;<span class="builtintype" id="1702112">uint32</span><span class="op" id="1702118">(</span><span class="ident" id="1702119">pow</span><span class="op" id="1702122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702126">d</span><span class="op" id="1702127">.</span><span class="ident" id="1702128">d</span><span class="op" id="1702129">[</span><span class="ident" id="1702130">i</span><span class="op" id="1702131">]</span>&nbsp;<span class="op" id="1702133">=</span>&nbsp;<span class="builtintype" id="1702135">byte</span><span class="op" id="1702139">(</span><span class="ident" id="1702140">digit</span>&nbsp;<span class="op" id="1702146">+</span>&nbsp;<span class="string" id="1702148">&#39;0&#39;</span><span class="op" id="1702151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702155">integer</span>&nbsp;<span class="op" id="1702163">-=</span>&nbsp;<span class="ident" id="1702166">digit</span>&nbsp;<span class="op" id="1702172">*</span>&nbsp;<span class="builtintype" id="1702174">uint32</span><span class="op" id="1702180">(</span><span class="ident" id="1702181">pow</span><span class="op" id="1702184">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1702188">//&nbsp;evaluate&nbsp;whether&nbsp;we&nbsp;should&nbsp;stop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1702226">if</span>&nbsp;<span class="ident" id="1702229">currentDiff</span>&nbsp;<span class="op" id="1702241">:=</span>&nbsp;<span class="ident" id="1702244">uint64</span><span class="op" id="1702250">(</span><span class="ident" id="1702251">integer</span><span class="op" id="1702258">)</span><span class="op" id="1702259">&lt;&lt;</span><span class="ident" id="1702261">shift</span>&nbsp;<span class="op" id="1702267">+</span>&nbsp;<span class="ident" id="1702269">fraction</span><span class="op" id="1702277">;</span>&nbsp;<span class="ident" id="1702279">currentDiff</span>&nbsp;<span class="op" id="1702291">&lt;</span>&nbsp;<span class="ident" id="1702293">allowance</span>&nbsp;<span class="op" id="1702303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702308">d</span><span class="op" id="1702309">.</span><span class="ident" id="1702310">nd</span>&nbsp;<span class="op" id="1702313">=</span>&nbsp;<span class="ident" id="1702315">i</span>&nbsp;<span class="op" id="1702317">+</span>&nbsp;<span class="num" id="1702319">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702324">d</span><span class="op" id="1702325">.</span><span class="ident" id="1702326">dp</span>&nbsp;<span class="op" id="1702329">=</span>&nbsp;<span class="ident" id="1702331">integerDigits</span>&nbsp;<span class="op" id="1702345">+</span>&nbsp;<span class="ident" id="1702347">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702356">d</span><span class="op" id="1702357">.</span><span class="ident" id="1702358">neg</span>&nbsp;<span class="op" id="1702362">=</span>&nbsp;<span class="ident" id="1702364">f</span><span class="op" id="1702365">.</span><span class="ident" id="1702366">neg</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1702373">//&nbsp;Sometimes&nbsp;allowance&nbsp;is&nbsp;so&nbsp;large&nbsp;the&nbsp;last&nbsp;digit&nbsp;might&nbsp;need&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1702443">//&nbsp;decremented&nbsp;to&nbsp;get&nbsp;closer&nbsp;to&nbsp;f.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1702481">return</span>&nbsp;<span class="ident" id="1702488">adjustLastDigit</span><span class="op" id="1702503">(</span><span class="ident" id="1702504">d</span><span class="op" id="1702505">,</span>&nbsp;<span class="ident" id="1702507">currentDiff</span><span class="op" id="1702518">,</span>&nbsp;<span class="ident" id="1702520">targetDiff</span><span class="op" id="1702530">,</span>&nbsp;<span class="ident" id="1702532">allowance</span><span class="op" id="1702541">,</span>&nbsp;<span class="ident" id="1702543">pow</span><span class="op" id="1702546">&lt;&lt;</span><span class="ident" id="1702548">shift</span><span class="op" id="1702553">,</span>&nbsp;<span class="num" id="1702555">2</span><span class="op" id="1702556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1702560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1702563">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702566">d</span><span class="op" id="1702567">.</span><span class="ident" id="1702568">nd</span>&nbsp;<span class="op" id="1702571">=</span>&nbsp;<span class="ident" id="1702573">integerDigits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702588">d</span><span class="op" id="1702589">.</span><span class="ident" id="1702590">dp</span>&nbsp;<span class="op" id="1702593">=</span>&nbsp;<span class="ident" id="1702595">d</span><span class="op" id="1702596">.</span><span class="ident" id="1702597">nd</span>&nbsp;<span class="op" id="1702600">+</span>&nbsp;<span class="ident" id="1702602">exp10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702609">d</span><span class="op" id="1702610">.</span><span class="ident" id="1702611">neg</span>&nbsp;<span class="op" id="1702615">=</span>&nbsp;<span class="ident" id="1702617">f</span><span class="op" id="1702618">.</span><span class="ident" id="1702619">neg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1702625">//&nbsp;Compute&nbsp;digits&nbsp;of&nbsp;the&nbsp;fractional&nbsp;part.&nbsp;At&nbsp;each&nbsp;step&nbsp;fraction&nbsp;does&nbsp;not</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1702699">//&nbsp;overflow.&nbsp;The&nbsp;choice&nbsp;of&nbsp;minExp&nbsp;implies&nbsp;that&nbsp;fraction&nbsp;is&nbsp;less&nbsp;than&nbsp;2^60.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1702775">var</span>&nbsp;<span class="ident" id="1702779">digit</span>&nbsp;<span class="builtintype" id="1702785">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702790">multiplier</span>&nbsp;<span class="op" id="1702801">:=</span>&nbsp;<span class="ident" id="1702804">uint64</span><span class="op" id="1702810">(</span><span class="num" id="1702811">1</span><span class="op" id="1702812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1702815">for</span>&nbsp;<span class="op" id="1702819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702823">fraction</span>&nbsp;<span class="op" id="1702832">*=</span>&nbsp;<span class="num" id="1702835">10</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702840">multiplier</span>&nbsp;<span class="op" id="1702851">*=</span>&nbsp;<span class="num" id="1702854">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702859">digit</span>&nbsp;<span class="op" id="1702865">=</span>&nbsp;<span class="builtintype" id="1702867">int</span><span class="op" id="1702870">(</span><span class="ident" id="1702871">fraction</span>&nbsp;<span class="op" id="1702880">&gt;&gt;</span>&nbsp;<span class="ident" id="1702883">shift</span><span class="op" id="1702888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702892">d</span><span class="op" id="1702893">.</span><span class="ident" id="1702894">d</span><span class="op" id="1702895">[</span><span class="ident" id="1702896">d</span><span class="op" id="1702897">.</span><span class="ident" id="1702898">nd</span><span class="op" id="1702900">]</span>&nbsp;<span class="op" id="1702902">=</span>&nbsp;<span class="builtintype" id="1702904">byte</span><span class="op" id="1702908">(</span><span class="ident" id="1702909">digit</span>&nbsp;<span class="op" id="1702915">+</span>&nbsp;<span class="string" id="1702917">&#39;0&#39;</span><span class="op" id="1702920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702924">d</span><span class="op" id="1702925">.</span><span class="ident" id="1702926">nd</span><span class="op" id="1702928">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1702933">fraction</span>&nbsp;<span class="op" id="1702942">-=</span>&nbsp;<span class="ident" id="1702945">uint64</span><span class="op" id="1702951">(</span><span class="ident" id="1702952">digit</span><span class="op" id="1702957">)</span>&nbsp;<span class="op" id="1702959">&lt;&lt;</span>&nbsp;<span class="ident" id="1702962">shift</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1702970">if</span>&nbsp;<span class="ident" id="1702973">fraction</span>&nbsp;<span class="op" id="1702982">&lt;</span>&nbsp;<span class="ident" id="1702984">allowance</span><span class="op" id="1702993">*</span><span class="ident" id="1702994">multiplier</span>&nbsp;<span class="op" id="1703005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1703010">//&nbsp;We&nbsp;are&nbsp;in&nbsp;the&nbsp;admissible&nbsp;range.&nbsp;Note&nbsp;that&nbsp;if&nbsp;allowance&nbsp;is&nbsp;about&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1703083">//&nbsp;overflow,&nbsp;that&nbsp;is,&nbsp;allowance&nbsp;&gt;&nbsp;2^64/10,&nbsp;the&nbsp;condition&nbsp;is&nbsp;automatically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1703160">//&nbsp;true&nbsp;due&nbsp;to&nbsp;the&nbsp;limited&nbsp;range&nbsp;of&nbsp;fraction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1703209">return</span>&nbsp;<span class="ident" id="1703216">adjustLastDigit</span><span class="op" id="1703231">(</span><span class="ident" id="1703232">d</span><span class="op" id="1703233">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1703239">fraction</span><span class="op" id="1703247">,</span>&nbsp;<span class="ident" id="1703249">targetDiff</span><span class="op" id="1703259">*</span><span class="ident" id="1703260">multiplier</span><span class="op" id="1703270">,</span>&nbsp;<span class="ident" id="1703272">allowance</span><span class="op" id="1703281">*</span><span class="ident" id="1703282">multiplier</span><span class="op" id="1703292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1703298">1</span><span class="op" id="1703299">&lt;&lt;</span><span class="ident" id="1703301">shift</span><span class="op" id="1703306">,</span>&nbsp;<span class="ident" id="1703308">multiplier</span><span class="op" id="1703318">*</span><span class="num" id="1703319">2</span><span class="op" id="1703320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1703324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1703327">}</span><br>
<span class="lineno"></span><span class="op" id="1703329">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="1703332">//&nbsp;adjustLastDigit&nbsp;modifies&nbsp;d&nbsp;=&nbsp;x-currentDiff*ε,&nbsp;to&nbsp;get&nbsp;closest&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="1703400">//&nbsp;d&nbsp;=&nbsp;x-targetDiff*ε,&nbsp;without&nbsp;becoming&nbsp;smaller&nbsp;than&nbsp;x-maxDiff*ε.</span><br>
<span class="lineno"></span><span class="comment" id="1703468">//&nbsp;It&nbsp;assumes&nbsp;that&nbsp;a&nbsp;decimal&nbsp;digit&nbsp;is&nbsp;worth&nbsp;ulpDecimal*ε,&nbsp;and&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1703536">//&nbsp;all&nbsp;data&nbsp;is&nbsp;known&nbsp;with&nbsp;a&nbsp;error&nbsp;estimate&nbsp;of&nbsp;ulpBinary*ε.</span><br>
<span class="lineno">645</span><span class="keyword" id="1703596">func</span>&nbsp;<span class="ident" id="1703601">adjustLastDigit</span><span class="op" id="1703616">(</span><span class="ident" id="1703617">d</span>&nbsp;<span class="op" id="1703619">*</span><span class="ident" id="1703620">decimalSlice</span><span class="op" id="1703632">,</span>&nbsp;<span class="ident" id="1703634">currentDiff</span><span class="op" id="1703645">,</span>&nbsp;<span class="ident" id="1703647">targetDiff</span><span class="op" id="1703657">,</span>&nbsp;<span class="ident" id="1703659">maxDiff</span><span class="op" id="1703666">,</span>&nbsp;<span class="ident" id="1703668">ulpDecimal</span><span class="op" id="1703678">,</span>&nbsp;<span class="ident" id="1703680">ulpBinary</span>&nbsp;<span class="ident" id="1703690">uint64</span><span class="op" id="1703696">)</span>&nbsp;<span class="builtintype" id="1703698">bool</span>&nbsp;<span class="op" id="1703703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1703706">if</span>&nbsp;<span class="ident" id="1703709">ulpDecimal</span>&nbsp;<span class="op" id="1703720">&lt;</span>&nbsp;<span class="num" id="1703722">2</span><span class="op" id="1703723">*</span><span class="ident" id="1703724">ulpBinary</span>&nbsp;<span class="op" id="1703734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1703738">//&nbsp;Approximation&nbsp;is&nbsp;too&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1703770">return</span>&nbsp;<span class="builtintype" id="1703777">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1703784">}</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1703787">for</span>&nbsp;<span class="ident" id="1703791">currentDiff</span><span class="op" id="1703802">+</span><span class="ident" id="1703803">ulpDecimal</span><span class="op" id="1703813">/</span><span class="num" id="1703814">2</span><span class="op" id="1703815">+</span><span class="ident" id="1703816">ulpBinary</span>&nbsp;<span class="op" id="1703826">&lt;</span>&nbsp;<span class="ident" id="1703828">targetDiff</span>&nbsp;<span class="op" id="1703839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1703843">d</span><span class="op" id="1703844">.</span><span class="ident" id="1703845">d</span><span class="op" id="1703846">[</span><span class="ident" id="1703847">d</span><span class="op" id="1703848">.</span><span class="ident" id="1703849">nd</span><span class="op" id="1703851">-</span><span class="num" id="1703852">1</span><span class="op" id="1703853">]</span><span class="op" id="1703854">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1703859">currentDiff</span>&nbsp;<span class="op" id="1703871">+=</span>&nbsp;<span class="ident" id="1703874">ulpDecimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1703886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1703889">if</span>&nbsp;<span class="ident" id="1703892">currentDiff</span><span class="op" id="1703903">+</span><span class="ident" id="1703904">ulpDecimal</span>&nbsp;<span class="op" id="1703915">&lt;=</span>&nbsp;<span class="ident" id="1703918">targetDiff</span><span class="op" id="1703928">+</span><span class="ident" id="1703929">ulpDecimal</span><span class="op" id="1703939">/</span><span class="num" id="1703940">2</span><span class="op" id="1703941">+</span><span class="ident" id="1703942">ulpBinary</span>&nbsp;<span class="op" id="1703952">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1703956">//&nbsp;we&nbsp;have&nbsp;two&nbsp;choices,&nbsp;and&nbsp;don&#39;t&nbsp;know&nbsp;what&nbsp;to&nbsp;do.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1704009">return</span>&nbsp;<span class="builtintype" id="1704016">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1704023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1704026">if</span>&nbsp;<span class="ident" id="1704029">currentDiff</span>&nbsp;<span class="op" id="1704041">&lt;</span>&nbsp;<span class="ident" id="1704043">ulpBinary</span>&nbsp;<span class="op" id="1704053">||</span>&nbsp;<span class="ident" id="1704056">currentDiff</span>&nbsp;<span class="op" id="1704068">&gt;</span>&nbsp;<span class="ident" id="1704070">maxDiff</span><span class="op" id="1704077">-</span><span class="ident" id="1704078">ulpBinary</span>&nbsp;<span class="op" id="1704088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1704092">//&nbsp;we&nbsp;went&nbsp;too&nbsp;far</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1704113">return</span>&nbsp;<span class="builtintype" id="1704120">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1704127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1704130">if</span>&nbsp;<span class="ident" id="1704133">d</span><span class="op" id="1704134">.</span><span class="ident" id="1704135">nd</span>&nbsp;<span class="op" id="1704138">==</span>&nbsp;<span class="num" id="1704141">1</span>&nbsp;<span class="op" id="1704143">&amp;&amp;</span>&nbsp;<span class="ident" id="1704146">d</span><span class="op" id="1704147">.</span><span class="ident" id="1704148">d</span><span class="op" id="1704149">[</span><span class="num" id="1704150">0</span><span class="op" id="1704151">]</span>&nbsp;<span class="op" id="1704153">==</span>&nbsp;<span class="string" id="1704156">&#39;0&#39;</span>&nbsp;<span class="op" id="1704160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1704164">//&nbsp;the&nbsp;number&nbsp;has&nbsp;actually&nbsp;reached&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1704207">d</span><span class="op" id="1704208">.</span><span class="ident" id="1704209">nd</span>&nbsp;<span class="op" id="1704212">=</span>&nbsp;<span class="num" id="1704214">0</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1704218">d</span><span class="op" id="1704219">.</span><span class="ident" id="1704220">dp</span>&nbsp;<span class="op" id="1704223">=</span>&nbsp;<span class="num" id="1704225">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1704228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1704231">return</span>&nbsp;<span class="builtintype" id="1704238">true</span><br>
<span class="lineno"></span><span class="op" id="1704243">}</span>
</div>
</body>
</html>
