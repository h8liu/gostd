<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3789262">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3789317">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3789371">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3789422">//&nbsp;HTTP&nbsp;Request&nbsp;reading&nbsp;and&nbsp;parsing.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3789460">package</span>&nbsp;<span class="ident" id="3789468">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3789474">import</span>&nbsp;<span class="op" id="3789481">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789484">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789493">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789502">&#34;crypto/tls&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789516">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789535">&#34;errors&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789545">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789552">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789558">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789571">&#34;mime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789579">&#34;mime/multipart&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789597">&#34;net/textproto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789614">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789625">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789636">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3789647">&#34;sync&#34;</span><br>
<span class="lineno">25</span><span class="op" id="3789654">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3789657">const</span>&nbsp;<span class="op" id="3789663">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789666">maxValueLength</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3789683">=</span>&nbsp;<span class="num" id="3789685">4096</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789691">maxHeaderLines</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3789708">=</span>&nbsp;<span class="num" id="3789710">1024</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789716">chunkSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3789733">=</span>&nbsp;<span class="num" id="3789735">4</span>&nbsp;<span class="op" id="3789737">&lt;&lt;</span>&nbsp;<span class="num" id="3789740">10</span>&nbsp;&nbsp;<span class="comment" id="3789744">//&nbsp;4&nbsp;KB&nbsp;chunks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3789760">defaultMaxMemory</span>&nbsp;<span class="op" id="3789777">=</span>&nbsp;<span class="num" id="3789779">32</span>&nbsp;<span class="op" id="3789782">&lt;&lt;</span>&nbsp;<span class="num" id="3789785">20</span>&nbsp;<span class="comment" id="3789788">//&nbsp;32&nbsp;MB</span><br>
<span class="lineno"></span><span class="op" id="3789797">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3789800">//&nbsp;ErrMissingFile&nbsp;is&nbsp;returned&nbsp;by&nbsp;FormFile&nbsp;when&nbsp;the&nbsp;provided&nbsp;file&nbsp;field&nbsp;name</span><br>
<span class="lineno">35</span><span class="comment" id="3789876">//&nbsp;is&nbsp;either&nbsp;not&nbsp;present&nbsp;in&nbsp;the&nbsp;request&nbsp;or&nbsp;not&nbsp;a&nbsp;file&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="3789937">var</span>&nbsp;<span class="ident" id="3789941">ErrMissingFile</span>&nbsp;<span class="op" id="3789956">=</span>&nbsp;<span class="ident" id="3789958"><a href="/net/http/request.go.html#3789535">errors</a></span><span class="op" id="3789964">.</span><span class="ident" id="3789965">New</span><span class="op" id="3789968">(</span><span class="string" id="3789969">&#34;http:&nbsp;no&nbsp;such&nbsp;file&#34;</span><span class="op" id="3789989">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3789992">//&nbsp;HTTP&nbsp;request&nbsp;parsing&nbsp;errors.</span><br>
<span class="lineno"></span><span class="keyword" id="3790024">type</span>&nbsp;<span class="ident" id="3790029">ProtocolError</span>&nbsp;<span class="keyword" id="3790043">struct</span>&nbsp;<span class="op" id="3790050">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790053">ErrorString</span>&nbsp;<span class="builtintype" id="3790065">string</span><br>
<span class="lineno"></span><span class="op" id="3790072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3790075">func</span>&nbsp;<span class="op" id="3790080">(</span><span class="ident" id="3790081">err</span>&nbsp;<span class="op" id="3790085">*</span><span class="ident" id="3790086"><a href="/net/http/request.go.html#3790029">ProtocolError</a></span><span class="op" id="3790099">)</span>&nbsp;<span class="ident" id="3790101">Error</span><span class="op" id="3790106">(</span><span class="op" id="3790107">)</span>&nbsp;<span class="builtintype" id="3790109">string</span>&nbsp;<span class="op" id="3790116">{</span>&nbsp;<span class="keyword" id="3790118">return</span>&nbsp;<span class="ident" id="3790125"><a href="/net/http/request.go.html#3790081">err</a></span><span class="op" id="3790128">.</span><span class="ident" id="3790129">ErrorString</span>&nbsp;<span class="op" id="3790141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="3790144">var</span>&nbsp;<span class="op" id="3790148">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790151">ErrHeaderTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3790175">=</span>&nbsp;<span class="op" id="3790177">&amp;</span><span class="ident" id="3790178"><a href="/net/http/request.go.html#3790029">ProtocolError</a></span><span class="op" id="3790191">{</span><span class="string" id="3790192">&#34;header&nbsp;too&nbsp;long&#34;</span><span class="op" id="3790209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790212">ErrShortBody</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3790236">=</span>&nbsp;<span class="op" id="3790238">&amp;</span><span class="ident" id="3790239"><a href="/net/http/request.go.html#3790029">ProtocolError</a></span><span class="op" id="3790252">{</span><span class="string" id="3790253">&#34;entity&nbsp;body&nbsp;too&nbsp;short&#34;</span><span class="op" id="3790276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790279">ErrNotSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3790303">=</span>&nbsp;<span class="op" id="3790305">&amp;</span><span class="ident" id="3790306"><a href="/net/http/request.go.html#3790029">ProtocolError</a></span><span class="op" id="3790319">{</span><span class="string" id="3790320">&#34;feature&nbsp;not&nbsp;supported&#34;</span><span class="op" id="3790343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790346">ErrUnexpectedTrailer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3790370">=</span>&nbsp;<span class="op" id="3790372">&amp;</span><span class="ident" id="3790373"><a href="/net/http/request.go.html#3790029">ProtocolError</a></span><span class="op" id="3790386">{</span><span class="string" id="3790387">&#34;trailer&nbsp;header&nbsp;without&nbsp;chunked&nbsp;transfer&nbsp;encoding&#34;</span><span class="op" id="3790437">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790440">ErrMissingContentLength</span>&nbsp;<span class="op" id="3790464">=</span>&nbsp;<span class="op" id="3790466">&amp;</span><span class="ident" id="3790467"><a href="/net/http/request.go.html#3790029">ProtocolError</a></span><span class="op" id="3790480">{</span><span class="string" id="3790481">&#34;missing&nbsp;ContentLength&nbsp;in&nbsp;HEAD&nbsp;response&#34;</span><span class="op" id="3790521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790524">ErrNotMultipart</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3790548">=</span>&nbsp;<span class="op" id="3790550">&amp;</span><span class="ident" id="3790551"><a href="/net/http/request.go.html#3790029">ProtocolError</a></span><span class="op" id="3790564">{</span><span class="string" id="3790565">&#34;request&nbsp;Content-Type&nbsp;isn&#39;t&nbsp;multipart/form-data&#34;</span><span class="op" id="3790613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790616">ErrMissingBoundary</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3790640">=</span>&nbsp;<span class="op" id="3790642">&amp;</span><span class="ident" id="3790643"><a href="/net/http/request.go.html#3790029">ProtocolError</a></span><span class="op" id="3790656">{</span><span class="string" id="3790657">&#34;no&nbsp;multipart&nbsp;boundary&nbsp;param&nbsp;in&nbsp;Content-Type&#34;</span><span class="op" id="3790702">}</span><br>
<span class="lineno"></span><span class="op" id="3790704">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3790707">type</span>&nbsp;<span class="ident" id="3790712">badStringError</span>&nbsp;<span class="keyword" id="3790727">struct</span>&nbsp;<span class="op" id="3790734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790737">what</span>&nbsp;<span class="builtintype" id="3790742">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3790750">str</span>&nbsp;&nbsp;<span class="builtintype" id="3790755">string</span><br>
<span class="lineno"></span><span class="op" id="3790762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="3790765">func</span>&nbsp;<span class="op" id="3790770">(</span><span class="ident" id="3790771">e</span>&nbsp;<span class="op" id="3790773">*</span><span class="ident" id="3790774"><a href="/net/http/request.go.html#3790712">badStringError</a></span><span class="op" id="3790788">)</span>&nbsp;<span class="ident" id="3790790">Error</span><span class="op" id="3790795">(</span><span class="op" id="3790796">)</span>&nbsp;<span class="builtintype" id="3790798">string</span>&nbsp;<span class="op" id="3790805">{</span>&nbsp;<span class="keyword" id="3790807">return</span>&nbsp;<span class="ident" id="3790814"><a href="/net/http/request.go.html#3789545">fmt</a></span><span class="op" id="3790817">.</span><span class="ident" id="3790818">Sprintf</span><span class="op" id="3790825">(</span><span class="string" id="3790826">&#34;%s&nbsp;%q&#34;</span><span class="op" id="3790833">,</span>&nbsp;<span class="ident" id="3790835"><a href="/net/http/request.go.html#3790771">e</a></span><span class="op" id="3790836">.</span><span class="ident" id="3790837">what</span><span class="op" id="3790841">,</span>&nbsp;<span class="ident" id="3790843"><a href="/net/http/request.go.html#3790771">e</a></span><span class="op" id="3790844">.</span><span class="ident" id="3790845">str</span><span class="op" id="3790848">)</span>&nbsp;<span class="op" id="3790850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3790853">//&nbsp;Headers&nbsp;that&nbsp;Request.Write&nbsp;handles&nbsp;itself&nbsp;and&nbsp;should&nbsp;be&nbsp;skipped.</span><br>
<span class="lineno"></span><span class="keyword" id="3790921">var</span>&nbsp;<span class="ident" id="3790925">reqWriteExcludeHeader</span>&nbsp;<span class="op" id="3790947">=</span>&nbsp;<span class="keyword" id="3790949">map</span><span class="op" id="3790952">[</span><span class="builtintype" id="3790953">string</span><span class="op" id="3790959">]</span><span class="builtintype" id="3790960">bool</span><span class="op" id="3790964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3790967">&#34;Host&#34;</span><span class="op" id="3790973">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3790988">true</span><span class="op" id="3790992">,</span>&nbsp;<span class="comment" id="3790994">//&nbsp;not&nbsp;in&nbsp;Header&nbsp;map&nbsp;anyway</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3791023">&#34;User-Agent&#34;</span><span class="op" id="3791035">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791044">true</span><span class="op" id="3791048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3791051">&#34;Content-Length&#34;</span><span class="op" id="3791067">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791072">true</span><span class="op" id="3791076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3791079">&#34;Transfer-Encoding&#34;</span><span class="op" id="3791098">:</span>&nbsp;<span class="ident" id="3791100">true</span><span class="op" id="3791104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3791107">&#34;Trailer&#34;</span><span class="op" id="3791116">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3791128">true</span><span class="op" id="3791132">,</span><br>
<span class="lineno"></span><span class="op" id="3791134">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="3791137">//&nbsp;A&nbsp;Request&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;received&nbsp;by&nbsp;a&nbsp;server</span><br>
<span class="lineno"></span><span class="comment" id="3791198">//&nbsp;or&nbsp;to&nbsp;be&nbsp;sent&nbsp;by&nbsp;a&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="3791228">//</span><br>
<span class="lineno"></span><span class="comment" id="3791231">//&nbsp;The&nbsp;field&nbsp;semantics&nbsp;differ&nbsp;slightly&nbsp;between&nbsp;client&nbsp;and&nbsp;server</span><br>
<span class="lineno">75</span><span class="comment" id="3791296">//&nbsp;usage.&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;notes&nbsp;on&nbsp;the&nbsp;fields&nbsp;below,&nbsp;see&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3791360">//&nbsp;documentation&nbsp;for&nbsp;Request.Write&nbsp;and&nbsp;RoundTripper.</span><br>
<span class="lineno"></span><span class="keyword" id="3791413">type</span>&nbsp;<span class="ident" id="3791418">Request</span>&nbsp;<span class="keyword" id="3791426">struct</span>&nbsp;<span class="op" id="3791433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791436">//&nbsp;Method&nbsp;specifies&nbsp;the&nbsp;HTTP&nbsp;method&nbsp;(GET,&nbsp;POST,&nbsp;PUT,&nbsp;etc.).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791497">//&nbsp;For&nbsp;client&nbsp;requests&nbsp;an&nbsp;empty&nbsp;string&nbsp;means&nbsp;GET.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3791548">Method</span>&nbsp;<span class="builtintype" id="3791555">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791564">//&nbsp;URL&nbsp;specifies&nbsp;either&nbsp;the&nbsp;URI&nbsp;being&nbsp;requested&nbsp;(for&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791625">//&nbsp;requests)&nbsp;or&nbsp;the&nbsp;URL&nbsp;to&nbsp;access&nbsp;(for&nbsp;client&nbsp;requests).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791683">//</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791687">//&nbsp;For&nbsp;server&nbsp;requests&nbsp;the&nbsp;URL&nbsp;is&nbsp;parsed&nbsp;from&nbsp;the&nbsp;URI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791742">//&nbsp;supplied&nbsp;on&nbsp;the&nbsp;Request-Line&nbsp;as&nbsp;stored&nbsp;in&nbsp;RequestURI.&nbsp;&nbsp;For</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791805">//&nbsp;most&nbsp;requests,&nbsp;fields&nbsp;other&nbsp;than&nbsp;Path&nbsp;and&nbsp;RawQuery&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791868">//&nbsp;empty.&nbsp;(See&nbsp;RFC&nbsp;2616,&nbsp;Section&nbsp;5.1.2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791909">//</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791913">//&nbsp;For&nbsp;client&nbsp;requests,&nbsp;the&nbsp;URL&#39;s&nbsp;Host&nbsp;specifies&nbsp;the&nbsp;server&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3791977">//&nbsp;connect&nbsp;to,&nbsp;while&nbsp;the&nbsp;Request&#39;s&nbsp;Host&nbsp;field&nbsp;optionally</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792035">//&nbsp;specifies&nbsp;the&nbsp;Host&nbsp;header&nbsp;value&nbsp;to&nbsp;send&nbsp;in&nbsp;the&nbsp;HTTP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792091">//&nbsp;request.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792104">URL</span>&nbsp;<span class="op" id="3792108">*</span><span class="ident" id="3792109"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3792112">.</span><span class="ident" id="3792113">URL</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792119">//&nbsp;The&nbsp;protocol&nbsp;version&nbsp;for&nbsp;incoming&nbsp;requests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792167">//&nbsp;Client&nbsp;requests&nbsp;always&nbsp;use&nbsp;HTTP/1.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792208">Proto</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3792219">string</span>&nbsp;<span class="comment" id="3792226">//&nbsp;&#34;HTTP/1.0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792241">ProtoMajor</span>&nbsp;<span class="builtintype" id="3792252">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3792259">//&nbsp;1</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3792265">ProtoMinor</span>&nbsp;<span class="builtintype" id="3792276">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3792283">//&nbsp;0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792290">//&nbsp;A&nbsp;header&nbsp;maps&nbsp;request&nbsp;lines&nbsp;to&nbsp;their&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792339">//&nbsp;If&nbsp;the&nbsp;header&nbsp;says</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792362">//</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792366">//&nbsp;&nbsp;&nbsp;&nbspaccept-encoding:&nbsp;gzip,&nbsp;deflate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792401">//&nbsp;&nbsp;&nbsp;&nbspAccept-Language:&nbsp;en-us</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792428">//&nbsp;&nbsp;&nbsp;&nbspConnection:&nbsp;keep-alive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792455">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792459">//&nbsp;then</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792468">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792472">//&nbsp;&nbsp;&nbsp;&nbspHeader&nbsp;=&nbsp;map[string][]string{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792506">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#34;Accept-Encoding&#34;:&nbsp;{&#34;gzip,&nbsp;deflate&#34;},</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792549">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#34;Accept-Language&#34;:&nbsp;{&#34;en-us&#34;},</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792584">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#34;Connection&#34;:&nbsp;{&#34;keep-alive&#34;},</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792619">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792625">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792629">//&nbsp;HTTP&nbsp;defines&nbsp;that&nbsp;header&nbsp;names&nbsp;are&nbsp;case-insensitive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792686">//&nbsp;The&nbsp;request&nbsp;parser&nbsp;implements&nbsp;this&nbsp;by&nbsp;canonicalizing&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792747">//&nbsp;name,&nbsp;making&nbsp;the&nbsp;first&nbsp;character&nbsp;and&nbsp;any&nbsp;characters</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792803">//&nbsp;following&nbsp;a&nbsp;hyphen&nbsp;uppercase&nbsp;and&nbsp;the&nbsp;rest&nbsp;lowercase.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792860">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792864">//&nbsp;For&nbsp;client&nbsp;requests&nbsp;certain&nbsp;headers&nbsp;are&nbsp;automatically</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792922">//&nbsp;added&nbsp;and&nbsp;may&nbsp;override&nbsp;values&nbsp;in&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792967">//</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792971">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;the&nbsp;Request.Write&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793027">Header</span>&nbsp;<span class="ident" id="3793034"><a href="/net/http/header.go.html#3781581">Header</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793043">//&nbsp;Body&nbsp;is&nbsp;the&nbsp;request&#39;s&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793075">//</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793079">//&nbsp;For&nbsp;client&nbsp;requests&nbsp;a&nbsp;nil&nbsp;body&nbsp;means&nbsp;the&nbsp;request&nbsp;has&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793139">//&nbsp;body,&nbsp;such&nbsp;as&nbsp;a&nbsp;GET&nbsp;request.&nbsp;The&nbsp;HTTP&nbsp;Client&#39;s&nbsp;Transport</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793200">//&nbsp;is&nbsp;responsible&nbsp;for&nbsp;calling&nbsp;the&nbsp;Close&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793249">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793253">//&nbsp;For&nbsp;server&nbsp;requests&nbsp;the&nbsp;Request&nbsp;Body&nbsp;is&nbsp;always&nbsp;non-nil</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793312">//&nbsp;but&nbsp;will&nbsp;return&nbsp;EOF&nbsp;immediately&nbsp;when&nbsp;no&nbsp;body&nbsp;is&nbsp;present.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793373">//&nbsp;The&nbsp;Server&nbsp;will&nbsp;close&nbsp;the&nbsp;request&nbsp;body.&nbsp;The&nbsp;ServeHTTP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793431">//&nbsp;Handler&nbsp;does&nbsp;not&nbsp;need&nbsp;to.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793461">Body</span>&nbsp;<span class="ident" id="3793466"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3793468">.</span><span class="ident" id="3793469">ReadCloser</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793482">//&nbsp;ContentLength&nbsp;records&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;associated&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793546">//&nbsp;The&nbsp;value&nbsp;-1&nbsp;indicates&nbsp;that&nbsp;the&nbsp;length&nbsp;is&nbsp;unknown.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793601">//&nbsp;Values&nbsp;&gt;=&nbsp;0&nbsp;indicate&nbsp;that&nbsp;the&nbsp;given&nbsp;number&nbsp;of&nbsp;bytes&nbsp;may</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793661">//&nbsp;be&nbsp;read&nbsp;from&nbsp;Body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793684">//&nbsp;For&nbsp;client&nbsp;requests,&nbsp;a&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;unknown&nbsp;if&nbsp;Body&nbsp;is&nbsp;not&nbsp;nil.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793756">ContentLength</span>&nbsp;<span class="ident" id="3793770">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793778">//&nbsp;TransferEncoding&nbsp;lists&nbsp;the&nbsp;transfer&nbsp;encodings&nbsp;from&nbsp;outermost&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793846">//&nbsp;innermost.&nbsp;An&nbsp;empty&nbsp;list&nbsp;denotes&nbsp;the&nbsp;&#34;identity&#34;&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793908">//&nbsp;TransferEncoding&nbsp;can&nbsp;usually&nbsp;be&nbsp;ignored;&nbsp;chunked&nbsp;encoding&nbsp;is</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793973">//&nbsp;automatically&nbsp;added&nbsp;and&nbsp;removed&nbsp;as&nbsp;necessary&nbsp;when&nbsp;sending&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794039">//&nbsp;receiving&nbsp;requests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794063">TransferEncoding</span>&nbsp;<span class="op" id="3794080">[</span><span class="op" id="3794081">]</span><span class="builtintype" id="3794082">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794091">//&nbsp;Close&nbsp;indicates&nbsp;whether&nbsp;to&nbsp;close&nbsp;the&nbsp;connection&nbsp;after</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794149">//&nbsp;replying&nbsp;to&nbsp;this&nbsp;request&nbsp;(for&nbsp;servers)&nbsp;or&nbsp;after&nbsp;sending</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794209">//&nbsp;the&nbsp;request&nbsp;(for&nbsp;clients).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794240">Close</span>&nbsp;<span class="builtintype" id="3794246">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794253">//&nbsp;For&nbsp;server&nbsp;requests&nbsp;Host&nbsp;specifies&nbsp;the&nbsp;host&nbsp;on&nbsp;which&nbsp;the</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794314">//&nbsp;URL&nbsp;is&nbsp;sought.&nbsp;Per&nbsp;RFC&nbsp;2616,&nbsp;this&nbsp;is&nbsp;either&nbsp;the&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794375">//&nbsp;the&nbsp;&#34;Host&#34;&nbsp;header&nbsp;or&nbsp;the&nbsp;host&nbsp;name&nbsp;given&nbsp;in&nbsp;the&nbsp;URL&nbsp;itself.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794439">//&nbsp;It&nbsp;may&nbsp;be&nbsp;of&nbsp;the&nbsp;form&nbsp;&#34;host:port&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794478">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794482">//&nbsp;For&nbsp;client&nbsp;requests&nbsp;Host&nbsp;optionally&nbsp;overrides&nbsp;the&nbsp;Host</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794541">//&nbsp;header&nbsp;to&nbsp;send.&nbsp;If&nbsp;empty,&nbsp;the&nbsp;Request.Write&nbsp;method&nbsp;uses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794601">//&nbsp;the&nbsp;value&nbsp;of&nbsp;URL.Host.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794628">Host</span>&nbsp;<span class="builtintype" id="3794633">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794642">//&nbsp;Form&nbsp;contains&nbsp;the&nbsp;parsed&nbsp;form&nbsp;data,&nbsp;including&nbsp;both&nbsp;the&nbsp;URL</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794705">//&nbsp;field&#39;s&nbsp;query&nbsp;parameters&nbsp;and&nbsp;the&nbsp;POST&nbsp;or&nbsp;PUT&nbsp;form&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794765">//&nbsp;This&nbsp;field&nbsp;is&nbsp;only&nbsp;available&nbsp;after&nbsp;ParseForm&nbsp;is&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794825">//&nbsp;The&nbsp;HTTP&nbsp;client&nbsp;ignores&nbsp;Form&nbsp;and&nbsp;uses&nbsp;Body&nbsp;instead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794881">Form</span>&nbsp;<span class="ident" id="3794886"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3794889">.</span><span class="ident" id="3794890">Values</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794899">//&nbsp;PostForm&nbsp;contains&nbsp;the&nbsp;parsed&nbsp;form&nbsp;data&nbsp;from&nbsp;POST&nbsp;or&nbsp;PUT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794959">//&nbsp;body&nbsp;parameters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794980">//&nbsp;This&nbsp;field&nbsp;is&nbsp;only&nbsp;available&nbsp;after&nbsp;ParseForm&nbsp;is&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795040">//&nbsp;The&nbsp;HTTP&nbsp;client&nbsp;ignores&nbsp;PostForm&nbsp;and&nbsp;uses&nbsp;Body&nbsp;instead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795100">PostForm</span>&nbsp;<span class="ident" id="3795109"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3795112">.</span><span class="ident" id="3795113">Values</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795122">//&nbsp;MultipartForm&nbsp;is&nbsp;the&nbsp;parsed&nbsp;multipart&nbsp;form,&nbsp;including&nbsp;file&nbsp;uploads.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795194">//&nbsp;This&nbsp;field&nbsp;is&nbsp;only&nbsp;available&nbsp;after&nbsp;ParseMultipartForm&nbsp;is&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795263">//&nbsp;The&nbsp;HTTP&nbsp;client&nbsp;ignores&nbsp;MultipartForm&nbsp;and&nbsp;uses&nbsp;Body&nbsp;instead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795328">MultipartForm</span>&nbsp;<span class="op" id="3795342">*</span><span class="ident" id="3795343"><a href="/net/http/request.go.html#3789579">multipart</a></span><span class="op" id="3795352">.</span><span class="ident" id="3795353">Form</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795360">//&nbsp;Trailer&nbsp;specifies&nbsp;additional&nbsp;headers&nbsp;that&nbsp;are&nbsp;sent&nbsp;after&nbsp;the&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795433">//&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795443">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795447">//&nbsp;For&nbsp;server&nbsp;requests&nbsp;the&nbsp;Trailer&nbsp;map&nbsp;initially&nbsp;contains&nbsp;only&nbsp;the</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795515">//&nbsp;trailer&nbsp;keys,&nbsp;with&nbsp;nil&nbsp;values.&nbsp;(The&nbsp;client&nbsp;declares&nbsp;which&nbsp;trailers&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795589">//&nbsp;will&nbsp;later&nbsp;send.)&nbsp;&nbsp;While&nbsp;the&nbsp;handler&nbsp;is&nbsp;reading&nbsp;from&nbsp;Body,&nbsp;it&nbsp;must</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795660">//&nbsp;not&nbsp;reference&nbsp;Trailer.&nbsp;After&nbsp;reading&nbsp;from&nbsp;Body&nbsp;returns&nbsp;EOF,&nbsp;Trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795732">//&nbsp;can&nbsp;be&nbsp;read&nbsp;again&nbsp;and&nbsp;will&nbsp;contain&nbsp;non-nil&nbsp;values,&nbsp;if&nbsp;they&nbsp;were&nbsp;sent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795805">//&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795824">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795828">//&nbsp;For&nbsp;client&nbsp;requests&nbsp;Trailer&nbsp;must&nbsp;be&nbsp;initialized&nbsp;to&nbsp;a&nbsp;map&nbsp;containing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795900">//&nbsp;the&nbsp;trailer&nbsp;keys&nbsp;to&nbsp;later&nbsp;send.&nbsp;The&nbsp;values&nbsp;may&nbsp;be&nbsp;nil&nbsp;or&nbsp;their&nbsp;final</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795973">//&nbsp;values.&nbsp;The&nbsp;ContentLength&nbsp;must&nbsp;be&nbsp;0&nbsp;or&nbsp;-1,&nbsp;to&nbsp;send&nbsp;a&nbsp;chunked&nbsp;request.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796047">//&nbsp;After&nbsp;the&nbsp;HTTP&nbsp;request&nbsp;is&nbsp;sent&nbsp;the&nbsp;map&nbsp;values&nbsp;can&nbsp;be&nbsp;updated&nbsp;while</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796118">//&nbsp;the&nbsp;request&nbsp;body&nbsp;is&nbsp;read.&nbsp;Once&nbsp;the&nbsp;body&nbsp;returns&nbsp;EOF,&nbsp;the&nbsp;caller&nbsp;must</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796191">//&nbsp;not&nbsp;mutate&nbsp;Trailer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796215">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796219">//&nbsp;Few&nbsp;HTTP&nbsp;clients,&nbsp;servers,&nbsp;or&nbsp;proxies&nbsp;support&nbsp;HTTP&nbsp;trailers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796284">Trailer</span>&nbsp;<span class="ident" id="3796292"><a href="/net/http/header.go.html#3781581">Header</a></span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796301">//&nbsp;RemoteAddr&nbsp;allows&nbsp;HTTP&nbsp;servers&nbsp;and&nbsp;other&nbsp;software&nbsp;to&nbsp;record</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796365">//&nbsp;the&nbsp;network&nbsp;address&nbsp;that&nbsp;sent&nbsp;the&nbsp;request,&nbsp;usually&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796424">//&nbsp;logging.&nbsp;This&nbsp;field&nbsp;is&nbsp;not&nbsp;filled&nbsp;in&nbsp;by&nbsp;ReadRequest&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796484">//&nbsp;has&nbsp;no&nbsp;defined&nbsp;format.&nbsp;The&nbsp;HTTP&nbsp;server&nbsp;in&nbsp;this&nbsp;package</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796543">//&nbsp;sets&nbsp;RemoteAddr&nbsp;to&nbsp;an&nbsp;&#34;IP:port&#34;&nbsp;address&nbsp;before&nbsp;invoking&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796605">//&nbsp;handler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796618">//&nbsp;This&nbsp;field&nbsp;is&nbsp;ignored&nbsp;by&nbsp;the&nbsp;HTTP&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796664">RemoteAddr</span>&nbsp;<span class="builtintype" id="3796675">string</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796684">//&nbsp;RequestURI&nbsp;is&nbsp;the&nbsp;unmodified&nbsp;Request-URI&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796736">//&nbsp;Request-Line&nbsp;(RFC&nbsp;2616,&nbsp;Section&nbsp;5.1)&nbsp;as&nbsp;sent&nbsp;by&nbsp;the&nbsp;client</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796799">//&nbsp;to&nbsp;a&nbsp;server.&nbsp;Usually&nbsp;the&nbsp;URL&nbsp;field&nbsp;should&nbsp;be&nbsp;used&nbsp;instead.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796862">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;set&nbsp;this&nbsp;field&nbsp;in&nbsp;an&nbsp;HTTP&nbsp;client&nbsp;request.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796926">RequestURI</span>&nbsp;<span class="builtintype" id="3796937">string</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796946">//&nbsp;TLS&nbsp;allows&nbsp;HTTP&nbsp;servers&nbsp;and&nbsp;other&nbsp;software&nbsp;to&nbsp;record</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797003">//&nbsp;information&nbsp;about&nbsp;the&nbsp;TLS&nbsp;connection&nbsp;on&nbsp;which&nbsp;the&nbsp;request</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797065">//&nbsp;was&nbsp;received.&nbsp;This&nbsp;field&nbsp;is&nbsp;not&nbsp;filled&nbsp;in&nbsp;by&nbsp;ReadRequest.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797127">//&nbsp;The&nbsp;HTTP&nbsp;server&nbsp;in&nbsp;this&nbsp;package&nbsp;sets&nbsp;the&nbsp;field&nbsp;for</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797182">//&nbsp;TLS-enabled&nbsp;connections&nbsp;before&nbsp;invoking&nbsp;a&nbsp;handler;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797237">//&nbsp;otherwise&nbsp;it&nbsp;leaves&nbsp;the&nbsp;field&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797276">//&nbsp;This&nbsp;field&nbsp;is&nbsp;ignored&nbsp;by&nbsp;the&nbsp;HTTP&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797322">TLS</span>&nbsp;<span class="op" id="3797326">*</span><span class="ident" id="3797327"><a href="/net/http/request.go.html#3789502">tls</a></span><span class="op" id="3797330">.</span><span class="ident" id="3797331">ConnectionState</span><br>
<span class="lineno"></span><span class="op" id="3797347">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="comment" id="3797350">//&nbsp;ProtoAtLeast&nbsp;reports&nbsp;whether&nbsp;the&nbsp;HTTP&nbsp;protocol&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="3797405">//&nbsp;in&nbsp;the&nbsp;request&nbsp;is&nbsp;at&nbsp;least&nbsp;major.minor.</span><br>
<span class="lineno"></span><span class="keyword" id="3797448">func</span>&nbsp;<span class="op" id="3797453">(</span><span class="ident" id="3797454">r</span>&nbsp;<span class="op" id="3797456">*</span><span class="ident" id="3797457"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3797464">)</span>&nbsp;<span class="ident" id="3797466">ProtoAtLeast</span><span class="op" id="3797478">(</span><span class="ident" id="3797479">major</span><span class="op" id="3797484">,</span>&nbsp;<span class="ident" id="3797486">minor</span>&nbsp;<span class="builtintype" id="3797492">int</span><span class="op" id="3797495">)</span>&nbsp;<span class="builtintype" id="3797497">bool</span>&nbsp;<span class="op" id="3797502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3797505">return</span>&nbsp;<span class="ident" id="3797512"><a href="/net/http/request.go.html#3797454">r</a></span><span class="op" id="3797513">.</span><span class="ident" id="3797514">ProtoMajor</span>&nbsp;<span class="op" id="3797525">&gt;</span>&nbsp;<span class="ident" id="3797527"><a href="/net/http/request.go.html#3797479">major</a></span>&nbsp;<span class="op" id="3797533">||</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797538"><a href="/net/http/request.go.html#3797454">r</a></span><span class="op" id="3797539">.</span><span class="ident" id="3797540">ProtoMajor</span>&nbsp;<span class="op" id="3797551">==</span>&nbsp;<span class="ident" id="3797554"><a href="/net/http/request.go.html#3797479">major</a></span>&nbsp;<span class="op" id="3797560">&amp;&amp;</span>&nbsp;<span class="ident" id="3797563"><a href="/net/http/request.go.html#3797454">r</a></span><span class="op" id="3797564">.</span><span class="ident" id="3797565">ProtoMinor</span>&nbsp;<span class="op" id="3797576">&gt;=</span>&nbsp;<span class="ident" id="3797579"><a href="/net/http/request.go.html#3797486">minor</a></span><br>
<span class="lineno"></span><span class="op" id="3797585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3797588">//&nbsp;UserAgent&nbsp;returns&nbsp;the&nbsp;client&#39;s&nbsp;User-Agent,&nbsp;if&nbsp;sent&nbsp;in&nbsp;the&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="3797658">func</span>&nbsp;<span class="op" id="3797663">(</span><span class="ident" id="3797664">r</span>&nbsp;<span class="op" id="3797666">*</span><span class="ident" id="3797667"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3797674">)</span>&nbsp;<span class="ident" id="3797676">UserAgent</span><span class="op" id="3797685">(</span><span class="op" id="3797686">)</span>&nbsp;<span class="builtintype" id="3797688">string</span>&nbsp;<span class="op" id="3797695">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3797698">return</span>&nbsp;<span class="ident" id="3797705"><a href="/net/http/request.go.html#3797664">r</a></span><span class="op" id="3797706">.</span><span class="ident" id="3797707">Header</span><span class="op" id="3797713">.</span><span class="ident" id="3797714">Get</span><span class="op" id="3797717">(</span><span class="string" id="3797718">&#34;User-Agent&#34;</span><span class="op" id="3797730">)</span><br>
<span class="lineno"></span><span class="op" id="3797732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3797735">//&nbsp;Cookies&nbsp;parses&nbsp;and&nbsp;returns&nbsp;the&nbsp;HTTP&nbsp;cookies&nbsp;sent&nbsp;with&nbsp;the&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="3797805">func</span>&nbsp;<span class="op" id="3797810">(</span><span class="ident" id="3797811">r</span>&nbsp;<span class="op" id="3797813">*</span><span class="ident" id="3797814"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3797821">)</span>&nbsp;<span class="ident" id="3797823">Cookies</span><span class="op" id="3797830">(</span><span class="op" id="3797831">)</span>&nbsp;<span class="op" id="3797833">[</span><span class="op" id="3797834">]</span><span class="op" id="3797835">*</span><span class="ident" id="3797836"><a href="/net/http/cookie.go.html#3751461">Cookie</a></span>&nbsp;<span class="op" id="3797843">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3797846">return</span>&nbsp;<span class="ident" id="3797853"><a href="/net/http/cookie.go.html#3755403">readCookies</a></span><span class="op" id="3797864">(</span><span class="ident" id="3797865"><a href="/net/http/request.go.html#3797811">r</a></span><span class="op" id="3797866">.</span><span class="ident" id="3797867">Header</span><span class="op" id="3797873">,</span>&nbsp;<span class="string" id="3797875">&#34;&#34;</span><span class="op" id="3797877">)</span><br>
<span class="lineno"></span><span class="op" id="3797879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3797882">var</span>&nbsp;<span class="ident" id="3797886">ErrNoCookie</span>&nbsp;<span class="op" id="3797898">=</span>&nbsp;<span class="ident" id="3797900"><a href="/net/http/request.go.html#3789535">errors</a></span><span class="op" id="3797906">.</span><span class="ident" id="3797907">New</span><span class="op" id="3797910">(</span><span class="string" id="3797911">&#34;http:&nbsp;named&nbsp;cookie&nbsp;not&nbsp;present&#34;</span><span class="op" id="3797943">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="3797946">//&nbsp;Cookie&nbsp;returns&nbsp;the&nbsp;named&nbsp;cookie&nbsp;provided&nbsp;in&nbsp;the&nbsp;request&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3798008">//&nbsp;ErrNoCookie&nbsp;if&nbsp;not&nbsp;found.</span><br>
<span class="lineno"></span><span class="keyword" id="3798037">func</span>&nbsp;<span class="op" id="3798042">(</span><span class="ident" id="3798043">r</span>&nbsp;<span class="op" id="3798045">*</span><span class="ident" id="3798046"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3798053">)</span>&nbsp;<span class="ident" id="3798055">Cookie</span><span class="op" id="3798061">(</span><span class="ident" id="3798062">name</span>&nbsp;<span class="builtintype" id="3798067">string</span><span class="op" id="3798073">)</span>&nbsp;<span class="op" id="3798075">(</span><span class="op" id="3798076">*</span><span class="ident" id="3798077"><a href="/net/http/cookie.go.html#3751461">Cookie</a></span><span class="op" id="3798083">,</span>&nbsp;<span class="builtintype" id="3798085">error</span><span class="op" id="3798090">)</span>&nbsp;<span class="op" id="3798092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798095">for</span>&nbsp;<span class="ident" id="3798099">_</span><span class="op" id="3798100">,</span>&nbsp;<span class="ident" id="3798102">c</span>&nbsp;<span class="op" id="3798104">:=</span>&nbsp;<span class="keyword" id="3798107">range</span>&nbsp;<span class="ident" id="3798113"><a href="/net/http/cookie.go.html#3755403">readCookies</a></span><span class="op" id="3798124">(</span><span class="ident" id="3798125"><a href="/net/http/request.go.html#3798043">r</a></span><span class="op" id="3798126">.</span><span class="ident" id="3798127">Header</span><span class="op" id="3798133">,</span>&nbsp;<span class="ident" id="3798135"><a href="/net/http/request.go.html#3798062">name</a></span><span class="op" id="3798139">)</span>&nbsp;<span class="op" id="3798141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798145">return</span>&nbsp;<span class="ident" id="3798152"><a href="/net/http/request.go.html#3798102">c</a></span><span class="op" id="3798153">,</span>&nbsp;<span class="ident" id="3798155">nil</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3798160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798163">return</span>&nbsp;<span class="ident" id="3798170">nil</span><span class="op" id="3798173">,</span>&nbsp;<span class="ident" id="3798175"><a href="/net/http/request.go.html#3797886">ErrNoCookie</a></span><br>
<span class="lineno"></span><span class="op" id="3798187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3798190">//&nbsp;AddCookie&nbsp;adds&nbsp;a&nbsp;cookie&nbsp;to&nbsp;the&nbsp;request.&nbsp;&nbsp;Per&nbsp;RFC&nbsp;6265&nbsp;section&nbsp;5.4,</span><br>
<span class="lineno">260</span><span class="comment" id="3798260">//&nbsp;AddCookie&nbsp;does&nbsp;not&nbsp;attach&nbsp;more&nbsp;than&nbsp;one&nbsp;Cookie&nbsp;header&nbsp;field.&nbsp;&nbsp;That</span><br>
<span class="lineno"></span><span class="comment" id="3798330">//&nbsp;means&nbsp;all&nbsp;cookies,&nbsp;if&nbsp;any,&nbsp;are&nbsp;written&nbsp;into&nbsp;the&nbsp;same&nbsp;line,</span><br>
<span class="lineno"></span><span class="comment" id="3798392">//&nbsp;separated&nbsp;by&nbsp;semicolon.</span><br>
<span class="lineno"></span><span class="keyword" id="3798419">func</span>&nbsp;<span class="op" id="3798424">(</span><span class="ident" id="3798425">r</span>&nbsp;<span class="op" id="3798427">*</span><span class="ident" id="3798428"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3798435">)</span>&nbsp;<span class="ident" id="3798437">AddCookie</span><span class="op" id="3798446">(</span><span class="ident" id="3798447">c</span>&nbsp;<span class="op" id="3798449">*</span><span class="ident" id="3798450"><a href="/net/http/cookie.go.html#3751461">Cookie</a></span><span class="op" id="3798456">)</span>&nbsp;<span class="op" id="3798458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798461">s</span>&nbsp;<span class="op" id="3798463">:=</span>&nbsp;<span class="ident" id="3798466"><a href="/net/http/request.go.html#3789545">fmt</a></span><span class="op" id="3798469">.</span><span class="ident" id="3798470">Sprintf</span><span class="op" id="3798477">(</span><span class="string" id="3798478">&#34;%s=%s&#34;</span><span class="op" id="3798485">,</span>&nbsp;<span class="ident" id="3798487"><a href="/net/http/cookie.go.html#3757693">sanitizeCookieName</a></span><span class="op" id="3798505">(</span><span class="ident" id="3798506"><a href="/net/http/request.go.html#3798447">c</a></span><span class="op" id="3798507">.</span><span class="ident" id="3798508">Name</span><span class="op" id="3798512">)</span><span class="op" id="3798513">,</span>&nbsp;<span class="ident" id="3798515"><a href="/net/http/cookie.go.html#3758319">sanitizeCookieValue</a></span><span class="op" id="3798534">(</span><span class="ident" id="3798535"><a href="/net/http/request.go.html#3798447">c</a></span><span class="op" id="3798536">.</span><span class="ident" id="3798537">Value</span><span class="op" id="3798542">)</span><span class="op" id="3798543">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798546">if</span>&nbsp;<span class="ident" id="3798549">c</span>&nbsp;<span class="op" id="3798551">:=</span>&nbsp;<span class="ident" id="3798554"><a href="/net/http/request.go.html#3798425">r</a></span><span class="op" id="3798555">.</span><span class="ident" id="3798556">Header</span><span class="op" id="3798562">.</span><span class="ident" id="3798563">Get</span><span class="op" id="3798566">(</span><span class="string" id="3798567">&#34;Cookie&#34;</span><span class="op" id="3798575">)</span><span class="op" id="3798576">;</span>&nbsp;<span class="ident" id="3798578"><a href="/net/http/request.go.html#3798549">c</a></span>&nbsp;<span class="op" id="3798580">!=</span>&nbsp;<span class="string" id="3798583">&#34;&#34;</span>&nbsp;<span class="op" id="3798586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798590"><a href="/net/http/request.go.html#3798425">r</a></span><span class="op" id="3798591">.</span><span class="ident" id="3798592">Header</span><span class="op" id="3798598">.</span><span class="ident" id="3798599">Set</span><span class="op" id="3798602">(</span><span class="string" id="3798603">&#34;Cookie&#34;</span><span class="op" id="3798611">,</span>&nbsp;<span class="ident" id="3798613"><a href="/net/http/request.go.html#3798549">c</a></span><span class="op" id="3798614">+</span><span class="string" id="3798615">&#34;;&nbsp;&#34;</span><span class="op" id="3798619">+</span><span class="ident" id="3798620"><a href="/net/http/request.go.html#3798461">s</a></span><span class="op" id="3798621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3798624">}</span>&nbsp;<span class="keyword" id="3798626">else</span>&nbsp;<span class="op" id="3798631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798635"><a href="/net/http/request.go.html#3798425">r</a></span><span class="op" id="3798636">.</span><span class="ident" id="3798637">Header</span><span class="op" id="3798643">.</span><span class="ident" id="3798644">Set</span><span class="op" id="3798647">(</span><span class="string" id="3798648">&#34;Cookie&#34;</span><span class="op" id="3798656">,</span>&nbsp;<span class="ident" id="3798658"><a href="/net/http/request.go.html#3798461">s</a></span><span class="op" id="3798659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3798662">}</span><br>
<span class="lineno">270</span><span class="op" id="3798664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3798667">//&nbsp;Referer&nbsp;returns&nbsp;the&nbsp;referring&nbsp;URL,&nbsp;if&nbsp;sent&nbsp;in&nbsp;the&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="3798729">//</span><br>
<span class="lineno"></span><span class="comment" id="3798732">//&nbsp;Referer&nbsp;is&nbsp;misspelled&nbsp;as&nbsp;in&nbsp;the&nbsp;request&nbsp;itself,&nbsp;a&nbsp;mistake&nbsp;from&nbsp;the</span><br>
<span class="lineno">275</span><span class="comment" id="3798802">//&nbsp;earliest&nbsp;days&nbsp;of&nbsp;HTTP.&nbsp;&nbsp;This&nbsp;value&nbsp;can&nbsp;also&nbsp;be&nbsp;fetched&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3798869">//&nbsp;Header&nbsp;map&nbsp;as&nbsp;Header[&#34;Referer&#34;];&nbsp;the&nbsp;benefit&nbsp;of&nbsp;making&nbsp;it&nbsp;available</span><br>
<span class="lineno"></span><span class="comment" id="3798940">//&nbsp;as&nbsp;a&nbsp;method&nbsp;is&nbsp;that&nbsp;the&nbsp;compiler&nbsp;can&nbsp;diagnose&nbsp;programs&nbsp;that&nbsp;use&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3799011">//&nbsp;alternate&nbsp;(correct&nbsp;English)&nbsp;spelling&nbsp;req.Referrer()&nbsp;but&nbsp;cannot</span><br>
<span class="lineno"></span><span class="comment" id="3799077">//&nbsp;diagnose&nbsp;programs&nbsp;that&nbsp;use&nbsp;Header[&#34;Referrer&#34;].</span><br>
<span class="lineno">280</span><span class="keyword" id="3799127">func</span>&nbsp;<span class="op" id="3799132">(</span><span class="ident" id="3799133">r</span>&nbsp;<span class="op" id="3799135">*</span><span class="ident" id="3799136"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3799143">)</span>&nbsp;<span class="ident" id="3799145">Referer</span><span class="op" id="3799152">(</span><span class="op" id="3799153">)</span>&nbsp;<span class="builtintype" id="3799155">string</span>&nbsp;<span class="op" id="3799162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799165">return</span>&nbsp;<span class="ident" id="3799172"><a href="/net/http/request.go.html#3799133">r</a></span><span class="op" id="3799173">.</span><span class="ident" id="3799174">Header</span><span class="op" id="3799180">.</span><span class="ident" id="3799181">Get</span><span class="op" id="3799184">(</span><span class="string" id="3799185">&#34;Referer&#34;</span><span class="op" id="3799194">)</span><br>
<span class="lineno"></span><span class="op" id="3799196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3799199">//&nbsp;multipartByReader&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value.</span><br>
<span class="lineno">285</span><span class="comment" id="3799241">//&nbsp;Its&nbsp;presence&nbsp;in&nbsp;Request.MultipartForm&nbsp;indicates&nbsp;that&nbsp;parsing&nbsp;of&nbsp;the&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="3799320">//&nbsp;body&nbsp;has&nbsp;been&nbsp;handed&nbsp;off&nbsp;to&nbsp;a&nbsp;MultipartReader&nbsp;instead&nbsp;of&nbsp;ParseMultipartFrom.</span><br>
<span class="lineno"></span><span class="keyword" id="3799400">var</span>&nbsp;<span class="ident" id="3799404">multipartByReader</span>&nbsp;<span class="op" id="3799422">=</span>&nbsp;<span class="op" id="3799424">&amp;</span><span class="ident" id="3799425"><a href="/net/http/request.go.html#3789579">multipart</a></span><span class="op" id="3799434">.</span><span class="ident" id="3799435">Form</span><span class="op" id="3799439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799442">Value</span><span class="op" id="3799447">:</span>&nbsp;<span class="builtinfunc" id="3799449">make</span><span class="op" id="3799453">(</span><span class="keyword" id="3799454">map</span><span class="op" id="3799457">[</span><span class="builtintype" id="3799458">string</span><span class="op" id="3799464">]</span><span class="op" id="3799465">[</span><span class="op" id="3799466">]</span><span class="builtintype" id="3799467">string</span><span class="op" id="3799473">)</span><span class="op" id="3799474">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799477">File</span><span class="op" id="3799481">:</span>&nbsp;&nbsp;<span class="builtinfunc" id="3799484">make</span><span class="op" id="3799488">(</span><span class="keyword" id="3799489">map</span><span class="op" id="3799492">[</span><span class="builtintype" id="3799493">string</span><span class="op" id="3799499">]</span><span class="op" id="3799500">[</span><span class="op" id="3799501">]</span><span class="op" id="3799502">*</span><span class="ident" id="3799503"><a href="/net/http/request.go.html#3789579">multipart</a></span><span class="op" id="3799512">.</span><span class="ident" id="3799513">FileHeader</span><span class="op" id="3799523">)</span><span class="op" id="3799524">,</span><br>
<span class="lineno">290</span><span class="op" id="3799526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3799529">//&nbsp;MultipartReader&nbsp;returns&nbsp;a&nbsp;MIME&nbsp;multipart&nbsp;reader&nbsp;if&nbsp;this&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3799593">//&nbsp;multipart/form-data&nbsp;POST&nbsp;request,&nbsp;else&nbsp;returns&nbsp;nil&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3799661">//&nbsp;Use&nbsp;this&nbsp;function&nbsp;instead&nbsp;of&nbsp;ParseMultipartForm&nbsp;to</span><br>
<span class="lineno">295</span><span class="comment" id="3799715">//&nbsp;process&nbsp;the&nbsp;request&nbsp;body&nbsp;as&nbsp;a&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="3799756">func</span>&nbsp;<span class="op" id="3799761">(</span><span class="ident" id="3799762">r</span>&nbsp;<span class="op" id="3799764">*</span><span class="ident" id="3799765"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3799772">)</span>&nbsp;<span class="ident" id="3799774">MultipartReader</span><span class="op" id="3799789">(</span><span class="op" id="3799790">)</span>&nbsp;<span class="op" id="3799792">(</span><span class="op" id="3799793">*</span><span class="ident" id="3799794"><a href="/net/http/request.go.html#3789579">multipart</a></span><span class="op" id="3799803">.</span><span class="ident" id="3799804">Reader</span><span class="op" id="3799810">,</span>&nbsp;<span class="builtintype" id="3799812">error</span><span class="op" id="3799817">)</span>&nbsp;<span class="op" id="3799819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799822">if</span>&nbsp;<span class="ident" id="3799825"><a href="/net/http/request.go.html#3799762">r</a></span><span class="op" id="3799826">.</span><span class="ident" id="3799827">MultipartForm</span>&nbsp;<span class="op" id="3799841">==</span>&nbsp;<span class="ident" id="3799844"><a href="/net/http/request.go.html#3799404">multipartByReader</a></span>&nbsp;<span class="op" id="3799862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799866">return</span>&nbsp;<span class="ident" id="3799873">nil</span><span class="op" id="3799876">,</span>&nbsp;<span class="ident" id="3799878"><a href="/net/http/request.go.html#3789535">errors</a></span><span class="op" id="3799884">.</span><span class="ident" id="3799885">New</span><span class="op" id="3799888">(</span><span class="string" id="3799889">&#34;http:&nbsp;MultipartReader&nbsp;called&nbsp;twice&#34;</span><span class="op" id="3799925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3799928">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799931">if</span>&nbsp;<span class="ident" id="3799934"><a href="/net/http/request.go.html#3799762">r</a></span><span class="op" id="3799935">.</span><span class="ident" id="3799936">MultipartForm</span>&nbsp;<span class="op" id="3799950">!=</span>&nbsp;<span class="ident" id="3799953">nil</span>&nbsp;<span class="op" id="3799957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799961">return</span>&nbsp;<span class="ident" id="3799968">nil</span><span class="op" id="3799971">,</span>&nbsp;<span class="ident" id="3799973"><a href="/net/http/request.go.html#3789535">errors</a></span><span class="op" id="3799979">.</span><span class="ident" id="3799980">New</span><span class="op" id="3799983">(</span><span class="string" id="3799984">&#34;http:&nbsp;multipart&nbsp;handled&nbsp;by&nbsp;ParseMultipartForm&#34;</span><span class="op" id="3800031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3800034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800037"><a href="/net/http/request.go.html#3799762">r</a></span><span class="op" id="3800038">.</span><span class="ident" id="3800039">MultipartForm</span>&nbsp;<span class="op" id="3800053">=</span>&nbsp;<span class="ident" id="3800055"><a href="/net/http/request.go.html#3799404">multipartByReader</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800074">return</span>&nbsp;<span class="ident" id="3800081"><a href="/net/http/request.go.html#3799762">r</a></span><span class="op" id="3800082">.</span><span class="ident" id="3800083">multipartReader</span><span class="op" id="3800098">(</span><span class="op" id="3800099">)</span><br>
<span class="lineno">305</span><span class="op" id="3800101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3800104">func</span>&nbsp;<span class="op" id="3800109">(</span><span class="ident" id="3800110">r</span>&nbsp;<span class="op" id="3800112">*</span><span class="ident" id="3800113"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3800120">)</span>&nbsp;<span class="ident" id="3800122">multipartReader</span><span class="op" id="3800137">(</span><span class="op" id="3800138">)</span>&nbsp;<span class="op" id="3800140">(</span><span class="op" id="3800141">*</span><span class="ident" id="3800142"><a href="/net/http/request.go.html#3789579">multipart</a></span><span class="op" id="3800151">.</span><span class="ident" id="3800152">Reader</span><span class="op" id="3800158">,</span>&nbsp;<span class="builtintype" id="3800160">error</span><span class="op" id="3800165">)</span>&nbsp;<span class="op" id="3800167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800170">v</span>&nbsp;<span class="op" id="3800172">:=</span>&nbsp;<span class="ident" id="3800175"><a href="/net/http/request.go.html#3800110">r</a></span><span class="op" id="3800176">.</span><span class="ident" id="3800177">Header</span><span class="op" id="3800183">.</span><span class="ident" id="3800184">Get</span><span class="op" id="3800187">(</span><span class="string" id="3800188">&#34;Content-Type&#34;</span><span class="op" id="3800202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800205">if</span>&nbsp;<span class="ident" id="3800208"><a href="/net/http/request.go.html#3800170">v</a></span>&nbsp;<span class="op" id="3800210">==</span>&nbsp;<span class="string" id="3800213">&#34;&#34;</span>&nbsp;<span class="op" id="3800216">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800220">return</span>&nbsp;<span class="ident" id="3800227">nil</span><span class="op" id="3800230">,</span>&nbsp;<span class="ident" id="3800232"><a href="/net/http/request.go.html#3790524">ErrNotMultipart</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3800249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800252">d</span><span class="op" id="3800253">,</span>&nbsp;<span class="ident" id="3800255">params</span><span class="op" id="3800261">,</span>&nbsp;<span class="ident" id="3800263">err</span>&nbsp;<span class="op" id="3800267">:=</span>&nbsp;<span class="ident" id="3800270"><a href="/net/http/request.go.html#3789571">mime</a></span><span class="op" id="3800274">.</span><span class="ident" id="3800275">ParseMediaType</span><span class="op" id="3800289">(</span><span class="ident" id="3800290"><a href="/net/http/request.go.html#3800170">v</a></span><span class="op" id="3800291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800294">if</span>&nbsp;<span class="ident" id="3800297"><a href="/net/http/request.go.html#3800263">err</a></span>&nbsp;<span class="op" id="3800301">!=</span>&nbsp;<span class="ident" id="3800304">nil</span>&nbsp;<span class="op" id="3800308">||</span>&nbsp;<span class="ident" id="3800311"><a href="/net/http/request.go.html#3800252">d</a></span>&nbsp;<span class="op" id="3800313">!=</span>&nbsp;<span class="string" id="3800316">&#34;multipart/form-data&#34;</span>&nbsp;<span class="op" id="3800338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800342">return</span>&nbsp;<span class="ident" id="3800349">nil</span><span class="op" id="3800352">,</span>&nbsp;<span class="ident" id="3800354"><a href="/net/http/request.go.html#3790524">ErrNotMultipart</a></span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3800371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800374">boundary</span><span class="op" id="3800382">,</span>&nbsp;<span class="ident" id="3800384">ok</span>&nbsp;<span class="op" id="3800387">:=</span>&nbsp;<span class="ident" id="3800390"><a href="/net/http/request.go.html#3800255">params</a></span><span class="op" id="3800396">[</span><span class="string" id="3800397">&#34;boundary&#34;</span><span class="op" id="3800407">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800410">if</span>&nbsp;<span class="op" id="3800413">!</span><span class="ident" id="3800414"><a href="/net/http/request.go.html#3800384">ok</a></span>&nbsp;<span class="op" id="3800417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800421">return</span>&nbsp;<span class="ident" id="3800428">nil</span><span class="op" id="3800431">,</span>&nbsp;<span class="ident" id="3800433"><a href="/net/http/request.go.html#3790616">ErrMissingBoundary</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3800453">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800456">return</span>&nbsp;<span class="ident" id="3800463"><a href="/net/http/request.go.html#3789579">multipart</a></span><span class="op" id="3800472">.</span><span class="ident" id="3800473">NewReader</span><span class="op" id="3800482">(</span><span class="ident" id="3800483"><a href="/net/http/request.go.html#3800110">r</a></span><span class="op" id="3800484">.</span><span class="ident" id="3800485">Body</span><span class="op" id="3800489">,</span>&nbsp;<span class="ident" id="3800491"><a href="/net/http/request.go.html#3800374">boundary</a></span><span class="op" id="3800499">)</span><span class="op" id="3800500">,</span>&nbsp;<span class="ident" id="3800502">nil</span><br>
<span class="lineno"></span><span class="op" id="3800506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3800509">//&nbsp;Return&nbsp;value&nbsp;if&nbsp;nonempty,&nbsp;def&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="keyword" id="3800553">func</span>&nbsp;<span class="ident" id="3800558">valueOrDefault</span><span class="op" id="3800572">(</span><span class="ident" id="3800573">value</span><span class="op" id="3800578">,</span>&nbsp;<span class="ident" id="3800580">def</span>&nbsp;<span class="builtintype" id="3800584">string</span><span class="op" id="3800590">)</span>&nbsp;<span class="builtintype" id="3800592">string</span>&nbsp;<span class="op" id="3800599">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800602">if</span>&nbsp;<span class="ident" id="3800605"><a href="/net/http/request.go.html#3800573">value</a></span>&nbsp;<span class="op" id="3800611">!=</span>&nbsp;<span class="string" id="3800614">&#34;&#34;</span>&nbsp;<span class="op" id="3800617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800621">return</span>&nbsp;<span class="ident" id="3800628"><a href="/net/http/request.go.html#3800573">value</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3800635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800638">return</span>&nbsp;<span class="ident" id="3800645"><a href="/net/http/request.go.html#3800580">def</a></span><br>
<span class="lineno"></span><span class="op" id="3800649">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="3800652">//&nbsp;NOTE:&nbsp;This&nbsp;is&nbsp;not&nbsp;intended&nbsp;to&nbsp;reflect&nbsp;the&nbsp;actual&nbsp;Go&nbsp;version&nbsp;being&nbsp;used.</span><br>
<span class="lineno"></span><span class="comment" id="3800727">//&nbsp;It&nbsp;was&nbsp;changed&nbsp;from&nbsp;&#34;Go&nbsp;http&nbsp;package&#34;&nbsp;to&nbsp;&#34;Go&nbsp;1.1&nbsp;package&nbsp;http&#34;&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3800800">//&nbsp;time&nbsp;of&nbsp;the&nbsp;Go&nbsp;1.1&nbsp;release&nbsp;because&nbsp;the&nbsp;former&nbsp;User-Agent&nbsp;had&nbsp;ended&nbsp;up</span><br>
<span class="lineno"></span><span class="comment" id="3800873">//&nbsp;on&nbsp;a&nbsp;blacklist&nbsp;for&nbsp;some&nbsp;intrusion&nbsp;detection&nbsp;systems.</span><br>
<span class="lineno">335</span><span class="comment" id="3800929">//&nbsp;See&nbsp;https://codereview.appspot.com/7532043.</span><br>
<span class="lineno"></span><span class="keyword" id="3800976">const</span>&nbsp;<span class="ident" id="3800982">defaultUserAgent</span>&nbsp;<span class="op" id="3800999">=</span>&nbsp;<span class="string" id="3801001">&#34;Go&nbsp;1.1&nbsp;package&nbsp;http&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3801024">//&nbsp;Write&nbsp;writes&nbsp;an&nbsp;HTTP/1.1&nbsp;request&nbsp;--&nbsp;header&nbsp;and&nbsp;body&nbsp;--&nbsp;in&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3801098">//&nbsp;This&nbsp;method&nbsp;consults&nbsp;the&nbsp;following&nbsp;fields&nbsp;of&nbsp;the&nbsp;request:</span><br>
<span class="lineno">340</span><span class="comment" id="3801159">//&nbsp;&nbsp;&nbsp;&nbspHost</span><br>
<span class="lineno"></span><span class="comment" id="3801167">//&nbsp;&nbsp;&nbsp;&nbspURL</span><br>
<span class="lineno"></span><span class="comment" id="3801174">//&nbsp;&nbsp;&nbsp;&nbspMethod&nbsp;(defaults&nbsp;to&nbsp;&#34;GET&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3801204">//&nbsp;&nbsp;&nbsp;&nbspHeader</span><br>
<span class="lineno"></span><span class="comment" id="3801214">//&nbsp;&nbsp;&nbsp;&nbspContentLength</span><br>
<span class="lineno">345</span><span class="comment" id="3801231">//&nbsp;&nbsp;&nbsp;&nbspTransferEncoding</span><br>
<span class="lineno"></span><span class="comment" id="3801251">//&nbsp;&nbsp;&nbsp;&nbspBody</span><br>
<span class="lineno"></span><span class="comment" id="3801259">//</span><br>
<span class="lineno"></span><span class="comment" id="3801262">//&nbsp;If&nbsp;Body&nbsp;is&nbsp;present,&nbsp;Content-Length&nbsp;is&nbsp;&lt;=&nbsp;0&nbsp;and&nbsp;TransferEncoding</span><br>
<span class="lineno"></span><span class="comment" id="3801329">//&nbsp;hasn&#39;t&nbsp;been&nbsp;set&nbsp;to&nbsp;&#34;identity&#34;,&nbsp;Write&nbsp;adds&nbsp;&#34;Transfer-Encoding:</span><br>
<span class="lineno">350</span><span class="comment" id="3801394">//&nbsp;chunked&#34;&nbsp;to&nbsp;the&nbsp;header.&nbsp;Body&nbsp;is&nbsp;closed&nbsp;after&nbsp;it&nbsp;is&nbsp;sent.</span><br>
<span class="lineno"></span><span class="keyword" id="3801454">func</span>&nbsp;<span class="op" id="3801459">(</span><span class="ident" id="3801460">r</span>&nbsp;<span class="op" id="3801462">*</span><span class="ident" id="3801463"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3801470">)</span>&nbsp;<span class="ident" id="3801472">Write</span><span class="op" id="3801477">(</span><span class="ident" id="3801478">w</span>&nbsp;<span class="ident" id="3801480"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3801482">.</span><span class="ident" id="3801483">Writer</span><span class="op" id="3801489">)</span>&nbsp;<span class="builtintype" id="3801491">error</span>&nbsp;<span class="op" id="3801497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801500">return</span>&nbsp;<span class="ident" id="3801507"><a href="/net/http/request.go.html#3801460">r</a></span><span class="op" id="3801508">.</span><span class="ident" id="3801509">write</span><span class="op" id="3801514">(</span><span class="ident" id="3801515"><a href="/net/http/request.go.html#3801478">w</a></span><span class="op" id="3801516">,</span>&nbsp;<span class="ident" id="3801518">false</span><span class="op" id="3801523">,</span>&nbsp;<span class="ident" id="3801525">nil</span><span class="op" id="3801528">)</span><br>
<span class="lineno"></span><span class="op" id="3801530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="3801533">//&nbsp;WriteProxy&nbsp;is&nbsp;like&nbsp;Write&nbsp;but&nbsp;writes&nbsp;the&nbsp;request&nbsp;in&nbsp;the&nbsp;form</span><br>
<span class="lineno"></span><span class="comment" id="3801596">//&nbsp;expected&nbsp;by&nbsp;an&nbsp;HTTP&nbsp;proxy.&nbsp;&nbsp;In&nbsp;particular,&nbsp;WriteProxy&nbsp;writes&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3801664">//&nbsp;initial&nbsp;Request-URI&nbsp;line&nbsp;of&nbsp;the&nbsp;request&nbsp;with&nbsp;an&nbsp;absolute&nbsp;URI,&nbsp;per</span><br>
<span class="lineno"></span><span class="comment" id="3801733">//&nbsp;section&nbsp;5.1.2&nbsp;of&nbsp;RFC&nbsp;2616,&nbsp;including&nbsp;the&nbsp;scheme&nbsp;and&nbsp;host.</span><br>
<span class="lineno"></span><span class="comment" id="3801794">//&nbsp;In&nbsp;either&nbsp;case,&nbsp;WriteProxy&nbsp;also&nbsp;writes&nbsp;a&nbsp;Host&nbsp;header,&nbsp;using</span><br>
<span class="lineno">360</span><span class="comment" id="3801857">//&nbsp;either&nbsp;r.Host&nbsp;or&nbsp;r.URL.Host.</span><br>
<span class="lineno"></span><span class="keyword" id="3801889">func</span>&nbsp;<span class="op" id="3801894">(</span><span class="ident" id="3801895">r</span>&nbsp;<span class="op" id="3801897">*</span><span class="ident" id="3801898"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3801905">)</span>&nbsp;<span class="ident" id="3801907">WriteProxy</span><span class="op" id="3801917">(</span><span class="ident" id="3801918">w</span>&nbsp;<span class="ident" id="3801920"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3801922">.</span><span class="ident" id="3801923">Writer</span><span class="op" id="3801929">)</span>&nbsp;<span class="builtintype" id="3801931">error</span>&nbsp;<span class="op" id="3801937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801940">return</span>&nbsp;<span class="ident" id="3801947"><a href="/net/http/request.go.html#3801895">r</a></span><span class="op" id="3801948">.</span><span class="ident" id="3801949">write</span><span class="op" id="3801954">(</span><span class="ident" id="3801955"><a href="/net/http/request.go.html#3801918">w</a></span><span class="op" id="3801956">,</span>&nbsp;<span class="ident" id="3801958">true</span><span class="op" id="3801962">,</span>&nbsp;<span class="ident" id="3801964">nil</span><span class="op" id="3801967">)</span><br>
<span class="lineno"></span><span class="op" id="3801969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="3801972">//&nbsp;extraHeaders&nbsp;may&nbsp;be&nbsp;nil</span><br>
<span class="lineno"></span><span class="keyword" id="3801999">func</span>&nbsp;<span class="op" id="3802004">(</span><span class="ident" id="3802005">req</span>&nbsp;<span class="op" id="3802009">*</span><span class="ident" id="3802010"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3802017">)</span>&nbsp;<span class="ident" id="3802019">write</span><span class="op" id="3802024">(</span><span class="ident" id="3802025">w</span>&nbsp;<span class="ident" id="3802027"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3802029">.</span><span class="ident" id="3802030">Writer</span><span class="op" id="3802036">,</span>&nbsp;<span class="ident" id="3802038">usingProxy</span>&nbsp;<span class="builtintype" id="3802049">bool</span><span class="op" id="3802053">,</span>&nbsp;<span class="ident" id="3802055">extraHeaders</span>&nbsp;<span class="ident" id="3802068"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3802074">)</span>&nbsp;<span class="builtintype" id="3802076">error</span>&nbsp;<span class="op" id="3802082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802085">host</span>&nbsp;<span class="op" id="3802090">:=</span>&nbsp;<span class="ident" id="3802093"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3802096">.</span><span class="ident" id="3802097">Host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802103">if</span>&nbsp;<span class="ident" id="3802106"><a href="/net/http/request.go.html#3802085">host</a></span>&nbsp;<span class="op" id="3802111">==</span>&nbsp;<span class="string" id="3802114">&#34;&#34;</span>&nbsp;<span class="op" id="3802117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802121">if</span>&nbsp;<span class="ident" id="3802124"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3802127">.</span><span class="ident" id="3802128">URL</span>&nbsp;<span class="op" id="3802132">==</span>&nbsp;<span class="ident" id="3802135">nil</span>&nbsp;<span class="op" id="3802139">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802144">return</span>&nbsp;<span class="ident" id="3802151"><a href="/net/http/request.go.html#3789535">errors</a></span><span class="op" id="3802157">.</span><span class="ident" id="3802158">New</span><span class="op" id="3802161">(</span><span class="string" id="3802162">&#34;http:&nbsp;Request.Write&nbsp;on&nbsp;Request&nbsp;with&nbsp;no&nbsp;Host&nbsp;or&nbsp;URL&nbsp;set&#34;</span><span class="op" id="3802218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3802222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802226"><a href="/net/http/request.go.html#3802085">host</a></span>&nbsp;<span class="op" id="3802231">=</span>&nbsp;<span class="ident" id="3802233"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3802236">.</span><span class="ident" id="3802237">URL</span><span class="op" id="3802240">.</span><span class="ident" id="3802241">Host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3802247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802251">ruri</span>&nbsp;<span class="op" id="3802256">:=</span>&nbsp;<span class="ident" id="3802259"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3802262">.</span><span class="ident" id="3802263">URL</span><span class="op" id="3802266">.</span><span class="ident" id="3802267">RequestURI</span><span class="op" id="3802277">(</span><span class="op" id="3802278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802281">if</span>&nbsp;<span class="ident" id="3802284"><a href="/net/http/request.go.html#3802038">usingProxy</a></span>&nbsp;<span class="op" id="3802295">&amp;&amp;</span>&nbsp;<span class="ident" id="3802298"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3802301">.</span><span class="ident" id="3802302">URL</span><span class="op" id="3802305">.</span><span class="ident" id="3802306">Scheme</span>&nbsp;<span class="op" id="3802313">!=</span>&nbsp;<span class="string" id="3802316">&#34;&#34;</span>&nbsp;<span class="op" id="3802319">&amp;&amp;</span>&nbsp;<span class="ident" id="3802322"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3802325">.</span><span class="ident" id="3802326">URL</span><span class="op" id="3802329">.</span><span class="ident" id="3802330">Opaque</span>&nbsp;<span class="op" id="3802337">==</span>&nbsp;<span class="string" id="3802340">&#34;&#34;</span>&nbsp;<span class="op" id="3802343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802347"><a href="/net/http/request.go.html#3802251">ruri</a></span>&nbsp;<span class="op" id="3802352">=</span>&nbsp;<span class="ident" id="3802354"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3802357">.</span><span class="ident" id="3802358">URL</span><span class="op" id="3802361">.</span><span class="ident" id="3802362">Scheme</span>&nbsp;<span class="op" id="3802369">+</span>&nbsp;<span class="string" id="3802371">&#34;://&#34;</span>&nbsp;<span class="op" id="3802377">+</span>&nbsp;<span class="ident" id="3802379"><a href="/net/http/request.go.html#3802085">host</a></span>&nbsp;<span class="op" id="3802384">+</span>&nbsp;<span class="ident" id="3802386"><a href="/net/http/request.go.html#3802251">ruri</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3802392">}</span>&nbsp;<span class="keyword" id="3802394">else</span>&nbsp;<span class="keyword" id="3802399">if</span>&nbsp;<span class="ident" id="3802402"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3802405">.</span><span class="ident" id="3802406">Method</span>&nbsp;<span class="op" id="3802413">==</span>&nbsp;<span class="string" id="3802416">&#34;CONNECT&#34;</span>&nbsp;<span class="op" id="3802426">&amp;&amp;</span>&nbsp;<span class="ident" id="3802429"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3802432">.</span><span class="ident" id="3802433">URL</span><span class="op" id="3802436">.</span><span class="ident" id="3802437">Path</span>&nbsp;<span class="op" id="3802442">==</span>&nbsp;<span class="string" id="3802445">&#34;&#34;</span>&nbsp;<span class="op" id="3802448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3802452">//&nbsp;CONNECT&nbsp;requests&nbsp;normally&nbsp;give&nbsp;just&nbsp;the&nbsp;host&nbsp;and&nbsp;port,&nbsp;not&nbsp;a&nbsp;full&nbsp;URL.</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802528"><a href="/net/http/request.go.html#3802251">ruri</a></span>&nbsp;<span class="op" id="3802533">=</span>&nbsp;<span class="ident" id="3802535"><a href="/net/http/request.go.html#3802085">host</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3802541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3802544">//&nbsp;TODO(bradfitz):&nbsp;escape&nbsp;at&nbsp;least&nbsp;newlines&nbsp;in&nbsp;ruri?</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3802599">//&nbsp;Wrap&nbsp;the&nbsp;writer&nbsp;in&nbsp;a&nbsp;bufio&nbsp;Writer&nbsp;if&nbsp;it&#39;s&nbsp;not&nbsp;already&nbsp;buffered.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3802667">//&nbsp;Don&#39;t&nbsp;always&nbsp;call&nbsp;NewWriter,&nbsp;as&nbsp;that&nbsp;forces&nbsp;a&nbsp;bytes.Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3802730">//&nbsp;and&nbsp;other&nbsp;small&nbsp;bufio&nbsp;Writers&nbsp;to&nbsp;have&nbsp;a&nbsp;minimum&nbsp;4k&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3802792">//&nbsp;size.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802802">var</span>&nbsp;<span class="ident" id="3802806">bw</span>&nbsp;<span class="op" id="3802809">*</span><span class="ident" id="3802810"><a href="/net/http/request.go.html#3789484">bufio</a></span><span class="op" id="3802815">.</span><span class="ident" id="3802816">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802824">if</span>&nbsp;<span class="ident" id="3802827">_</span><span class="op" id="3802828">,</span>&nbsp;<span class="ident" id="3802830">ok</span>&nbsp;<span class="op" id="3802833">:=</span>&nbsp;<span class="ident" id="3802836"><a href="/net/http/request.go.html#3802025">w</a></span><span class="op" id="3802837">.</span><span class="op" id="3802838">(</span><span class="ident" id="3802839"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3802841">.</span><span class="ident" id="3802842">ByteWriter</span><span class="op" id="3802852">)</span><span class="op" id="3802853">;</span>&nbsp;<span class="op" id="3802855">!</span><span class="ident" id="3802856"><a href="/net/http/request.go.html#3802830">ok</a></span>&nbsp;<span class="op" id="3802859">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802863"><a href="/net/http/request.go.html#3802806">bw</a></span>&nbsp;<span class="op" id="3802866">=</span>&nbsp;<span class="ident" id="3802868"><a href="/net/http/request.go.html#3789484">bufio</a></span><span class="op" id="3802873">.</span><span class="ident" id="3802874">NewWriter</span><span class="op" id="3802883">(</span><span class="ident" id="3802884"><a href="/net/http/request.go.html#3802025">w</a></span><span class="op" id="3802885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802889"><a href="/net/http/request.go.html#3802025">w</a></span>&nbsp;<span class="op" id="3802891">=</span>&nbsp;<span class="ident" id="3802893"><a href="/net/http/request.go.html#3802806">bw</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3802897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802901">_</span><span class="op" id="3802902">,</span>&nbsp;<span class="ident" id="3802904">err</span>&nbsp;<span class="op" id="3802908">:=</span>&nbsp;<span class="ident" id="3802911"><a href="/net/http/request.go.html#3789545">fmt</a></span><span class="op" id="3802914">.</span><span class="ident" id="3802915">Fprintf</span><span class="op" id="3802922">(</span><span class="ident" id="3802923"><a href="/net/http/request.go.html#3802025">w</a></span><span class="op" id="3802924">,</span>&nbsp;<span class="string" id="3802926">&#34;%s&nbsp;%s&nbsp;HTTP/1.1\r\n&#34;</span><span class="op" id="3802946">,</span>&nbsp;<span class="ident" id="3802948"><a href="/net/http/request.go.html#3800558">valueOrDefault</a></span><span class="op" id="3802962">(</span><span class="ident" id="3802963"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3802966">.</span><span class="ident" id="3802967">Method</span><span class="op" id="3802973">,</span>&nbsp;<span class="string" id="3802975">&#34;GET&#34;</span><span class="op" id="3802980">)</span><span class="op" id="3802981">,</span>&nbsp;<span class="ident" id="3802983"><a href="/net/http/request.go.html#3802251">ruri</a></span><span class="op" id="3802987">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802990">if</span>&nbsp;<span class="ident" id="3802993"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3802997">!=</span>&nbsp;<span class="ident" id="3803000">nil</span>&nbsp;<span class="op" id="3803004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803008">return</span>&nbsp;<span class="ident" id="3803015"><a href="/net/http/request.go.html#3802904">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3803024">//&nbsp;Header&nbsp;lines</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803041">_</span><span class="op" id="3803042">,</span>&nbsp;<span class="ident" id="3803044"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803048">=</span>&nbsp;<span class="ident" id="3803050"><a href="/net/http/request.go.html#3789545">fmt</a></span><span class="op" id="3803053">.</span><span class="ident" id="3803054">Fprintf</span><span class="op" id="3803061">(</span><span class="ident" id="3803062"><a href="/net/http/request.go.html#3802025">w</a></span><span class="op" id="3803063">,</span>&nbsp;<span class="string" id="3803065">&#34;Host:&nbsp;%s\r\n&#34;</span><span class="op" id="3803079">,</span>&nbsp;<span class="ident" id="3803081"><a href="/net/http/request.go.html#3802085">host</a></span><span class="op" id="3803085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803088">if</span>&nbsp;<span class="ident" id="3803091"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803095">!=</span>&nbsp;<span class="ident" id="3803098">nil</span>&nbsp;<span class="op" id="3803102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803106">return</span>&nbsp;<span class="ident" id="3803113"><a href="/net/http/request.go.html#3802904">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3803122">//&nbsp;Use&nbsp;the&nbsp;defaultUserAgent&nbsp;unless&nbsp;the&nbsp;Header&nbsp;contains&nbsp;one,&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3803189">//&nbsp;may&nbsp;be&nbsp;blank&nbsp;to&nbsp;not&nbsp;send&nbsp;the&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803230">userAgent</span>&nbsp;<span class="op" id="3803240">:=</span>&nbsp;<span class="ident" id="3803243"><a href="/net/http/request.go.html#3800982">defaultUserAgent</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803261">if</span>&nbsp;<span class="ident" id="3803264"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3803267">.</span><span class="ident" id="3803268">Header</span>&nbsp;<span class="op" id="3803275">!=</span>&nbsp;<span class="ident" id="3803278">nil</span>&nbsp;<span class="op" id="3803282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803286">if</span>&nbsp;<span class="ident" id="3803289">ua</span>&nbsp;<span class="op" id="3803292">:=</span>&nbsp;<span class="ident" id="3803295"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3803298">.</span><span class="ident" id="3803299">Header</span><span class="op" id="3803305">[</span><span class="string" id="3803306">&#34;User-Agent&#34;</span><span class="op" id="3803318">]</span><span class="op" id="3803319">;</span>&nbsp;<span class="builtinfunc" id="3803321">len</span><span class="op" id="3803324">(</span><span class="ident" id="3803325"><a href="/net/http/request.go.html#3803289">ua</a></span><span class="op" id="3803327">)</span>&nbsp;<span class="op" id="3803329">&gt;</span>&nbsp;<span class="num" id="3803331">0</span>&nbsp;<span class="op" id="3803333">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803338"><a href="/net/http/request.go.html#3803230">userAgent</a></span>&nbsp;<span class="op" id="3803348">=</span>&nbsp;<span class="ident" id="3803350"><a href="/net/http/request.go.html#3803289">ua</a></span><span class="op" id="3803352">[</span><span class="num" id="3803353">0</span><span class="op" id="3803354">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803364">if</span>&nbsp;<span class="ident" id="3803367"><a href="/net/http/request.go.html#3803230">userAgent</a></span>&nbsp;<span class="op" id="3803377">!=</span>&nbsp;<span class="string" id="3803380">&#34;&#34;</span>&nbsp;<span class="op" id="3803383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803387">_</span><span class="op" id="3803388">,</span>&nbsp;<span class="ident" id="3803390"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803394">=</span>&nbsp;<span class="ident" id="3803396"><a href="/net/http/request.go.html#3789545">fmt</a></span><span class="op" id="3803399">.</span><span class="ident" id="3803400">Fprintf</span><span class="op" id="3803407">(</span><span class="ident" id="3803408"><a href="/net/http/request.go.html#3802025">w</a></span><span class="op" id="3803409">,</span>&nbsp;<span class="string" id="3803411">&#34;User-Agent:&nbsp;%s\r\n&#34;</span><span class="op" id="3803431">,</span>&nbsp;<span class="ident" id="3803433"><a href="/net/http/request.go.html#3803230">userAgent</a></span><span class="op" id="3803442">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803446">if</span>&nbsp;<span class="ident" id="3803449"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803453">!=</span>&nbsp;<span class="ident" id="3803456">nil</span>&nbsp;<span class="op" id="3803460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803465">return</span>&nbsp;<span class="ident" id="3803472"><a href="/net/http/request.go.html#3802904">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3803485">//&nbsp;Process&nbsp;Body,ContentLength,Close,Trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803530">tw</span><span class="op" id="3803532">,</span>&nbsp;<span class="ident" id="3803534"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803538">:=</span>&nbsp;<span class="ident" id="3803541"><a href="/net/http/transfer.go.html#3897137">newTransferWriter</a></span><span class="op" id="3803558">(</span><span class="ident" id="3803559"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3803562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803565">if</span>&nbsp;<span class="ident" id="3803568"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803572">!=</span>&nbsp;<span class="ident" id="3803575">nil</span>&nbsp;<span class="op" id="3803579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803583">return</span>&nbsp;<span class="ident" id="3803590"><a href="/net/http/request.go.html#3802904">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803595">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803598"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803602">=</span>&nbsp;<span class="ident" id="3803604"><a href="/net/http/request.go.html#3803530">tw</a></span><span class="op" id="3803606">.</span><span class="ident" id="3803607">WriteHeader</span><span class="op" id="3803618">(</span><span class="ident" id="3803619"><a href="/net/http/request.go.html#3802025">w</a></span><span class="op" id="3803620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803623">if</span>&nbsp;<span class="ident" id="3803626"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803630">!=</span>&nbsp;<span class="ident" id="3803633">nil</span>&nbsp;<span class="op" id="3803637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803641">return</span>&nbsp;<span class="ident" id="3803648"><a href="/net/http/request.go.html#3802904">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803657"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803661">=</span>&nbsp;<span class="ident" id="3803663"><a href="/net/http/request.go.html#3802005">req</a></span><span class="op" id="3803666">.</span><span class="ident" id="3803667">Header</span><span class="op" id="3803673">.</span><span class="ident" id="3803674">WriteSubset</span><span class="op" id="3803685">(</span><span class="ident" id="3803686"><a href="/net/http/request.go.html#3802025">w</a></span><span class="op" id="3803687">,</span>&nbsp;<span class="ident" id="3803689"><a href="/net/http/request.go.html#3790925">reqWriteExcludeHeader</a></span><span class="op" id="3803710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803713">if</span>&nbsp;<span class="ident" id="3803716"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803720">!=</span>&nbsp;<span class="ident" id="3803723">nil</span>&nbsp;<span class="op" id="3803727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803731">return</span>&nbsp;<span class="ident" id="3803738"><a href="/net/http/request.go.html#3802904">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803747">if</span>&nbsp;<span class="ident" id="3803750"><a href="/net/http/request.go.html#3802055">extraHeaders</a></span>&nbsp;<span class="op" id="3803763">!=</span>&nbsp;<span class="ident" id="3803766">nil</span>&nbsp;<span class="op" id="3803770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803774"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803778">=</span>&nbsp;<span class="ident" id="3803780"><a href="/net/http/request.go.html#3802055">extraHeaders</a></span><span class="op" id="3803792">.</span><span class="ident" id="3803793">Write</span><span class="op" id="3803798">(</span><span class="ident" id="3803799"><a href="/net/http/request.go.html#3802025">w</a></span><span class="op" id="3803800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803804">if</span>&nbsp;<span class="ident" id="3803807"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803811">!=</span>&nbsp;<span class="ident" id="3803814">nil</span>&nbsp;<span class="op" id="3803818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803823">return</span>&nbsp;<span class="ident" id="3803830"><a href="/net/http/request.go.html#3802904">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803836">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803843">_</span><span class="op" id="3803844">,</span>&nbsp;<span class="ident" id="3803846"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803850">=</span>&nbsp;<span class="ident" id="3803852"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3803854">.</span><span class="ident" id="3803855">WriteString</span><span class="op" id="3803866">(</span><span class="ident" id="3803867"><a href="/net/http/request.go.html#3802025">w</a></span><span class="op" id="3803868">,</span>&nbsp;<span class="string" id="3803870">&#34;\r\n&#34;</span><span class="op" id="3803876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803879">if</span>&nbsp;<span class="ident" id="3803882"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803886">!=</span>&nbsp;<span class="ident" id="3803889">nil</span>&nbsp;<span class="op" id="3803893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803897">return</span>&nbsp;<span class="ident" id="3803904"><a href="/net/http/request.go.html#3802904">err</a></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3803913">//&nbsp;Write&nbsp;body&nbsp;and&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803940"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803944">=</span>&nbsp;<span class="ident" id="3803946"><a href="/net/http/request.go.html#3803530">tw</a></span><span class="op" id="3803948">.</span><span class="ident" id="3803949">WriteBody</span><span class="op" id="3803958">(</span><span class="ident" id="3803959"><a href="/net/http/request.go.html#3802025">w</a></span><span class="op" id="3803960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803963">if</span>&nbsp;<span class="ident" id="3803966"><a href="/net/http/request.go.html#3802904">err</a></span>&nbsp;<span class="op" id="3803970">!=</span>&nbsp;<span class="ident" id="3803973">nil</span>&nbsp;<span class="op" id="3803977">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803981">return</span>&nbsp;<span class="ident" id="3803988"><a href="/net/http/request.go.html#3802904">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803997">if</span>&nbsp;<span class="ident" id="3804000"><a href="/net/http/request.go.html#3802806">bw</a></span>&nbsp;<span class="op" id="3804003">!=</span>&nbsp;<span class="ident" id="3804006">nil</span>&nbsp;<span class="op" id="3804010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804014">return</span>&nbsp;<span class="ident" id="3804021"><a href="/net/http/request.go.html#3802806">bw</a></span><span class="op" id="3804023">.</span><span class="ident" id="3804024">Flush</span><span class="op" id="3804029">(</span><span class="op" id="3804030">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3804033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804036">return</span>&nbsp;<span class="ident" id="3804043">nil</span><br>
<span class="lineno"></span><span class="op" id="3804047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3804050">//&nbsp;ParseHTTPVersion&nbsp;parses&nbsp;a&nbsp;HTTP&nbsp;version&nbsp;string.</span><br>
<span class="lineno">460</span><span class="comment" id="3804100">//&nbsp;&#34;HTTP/1.0&#34;&nbsp;returns&nbsp;(1,&nbsp;0,&nbsp;true).</span><br>
<span class="lineno"></span><span class="keyword" id="3804136">func</span>&nbsp;<span class="ident" id="3804141">ParseHTTPVersion</span><span class="op" id="3804157">(</span><span class="ident" id="3804158">vers</span>&nbsp;<span class="builtintype" id="3804163">string</span><span class="op" id="3804169">)</span>&nbsp;<span class="op" id="3804171">(</span><span class="ident" id="3804172">major</span><span class="op" id="3804177">,</span>&nbsp;<span class="ident" id="3804179">minor</span>&nbsp;<span class="builtintype" id="3804185">int</span><span class="op" id="3804188">,</span>&nbsp;<span class="ident" id="3804190">ok</span>&nbsp;<span class="builtintype" id="3804193">bool</span><span class="op" id="3804197">)</span>&nbsp;<span class="op" id="3804199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804202">const</span>&nbsp;<span class="ident" id="3804208">Big</span>&nbsp;<span class="op" id="3804212">=</span>&nbsp;<span class="num" id="3804214">1000000</span>&nbsp;<span class="comment" id="3804222">//&nbsp;arbitrary&nbsp;upper&nbsp;bound</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804248">switch</span>&nbsp;<span class="ident" id="3804255"><a href="/net/http/request.go.html#3804158">vers</a></span>&nbsp;<span class="op" id="3804260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804263">case</span>&nbsp;<span class="string" id="3804268">&#34;HTTP/1.1&#34;</span><span class="op" id="3804278">:</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804282">return</span>&nbsp;<span class="num" id="3804289">1</span><span class="op" id="3804290">,</span>&nbsp;<span class="num" id="3804292">1</span><span class="op" id="3804293">,</span>&nbsp;<span class="ident" id="3804295">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804301">case</span>&nbsp;<span class="string" id="3804306">&#34;HTTP/1.0&#34;</span><span class="op" id="3804316">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804320">return</span>&nbsp;<span class="num" id="3804327">1</span><span class="op" id="3804328">,</span>&nbsp;<span class="num" id="3804330">0</span><span class="op" id="3804331">,</span>&nbsp;<span class="ident" id="3804333">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3804339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804342">if</span>&nbsp;<span class="op" id="3804345">!</span><span class="ident" id="3804346"><a href="/net/http/request.go.html#3789636">strings</a></span><span class="op" id="3804353">.</span><span class="ident" id="3804354">HasPrefix</span><span class="op" id="3804363">(</span><span class="ident" id="3804364"><a href="/net/http/request.go.html#3804158">vers</a></span><span class="op" id="3804368">,</span>&nbsp;<span class="string" id="3804370">&#34;HTTP/&#34;</span><span class="op" id="3804377">)</span>&nbsp;<span class="op" id="3804379">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804383">return</span>&nbsp;<span class="num" id="3804390">0</span><span class="op" id="3804391">,</span>&nbsp;<span class="num" id="3804393">0</span><span class="op" id="3804394">,</span>&nbsp;<span class="ident" id="3804396">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3804403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804406">dot</span>&nbsp;<span class="op" id="3804410">:=</span>&nbsp;<span class="ident" id="3804413"><a href="/net/http/request.go.html#3789636">strings</a></span><span class="op" id="3804420">.</span><span class="ident" id="3804421">Index</span><span class="op" id="3804426">(</span><span class="ident" id="3804427"><a href="/net/http/request.go.html#3804158">vers</a></span><span class="op" id="3804431">,</span>&nbsp;<span class="string" id="3804433">&#34;.&#34;</span><span class="op" id="3804436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804439">if</span>&nbsp;<span class="ident" id="3804442"><a href="/net/http/request.go.html#3804406">dot</a></span>&nbsp;<span class="op" id="3804446">&lt;</span>&nbsp;<span class="num" id="3804448">0</span>&nbsp;<span class="op" id="3804450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804454">return</span>&nbsp;<span class="num" id="3804461">0</span><span class="op" id="3804462">,</span>&nbsp;<span class="num" id="3804464">0</span><span class="op" id="3804465">,</span>&nbsp;<span class="ident" id="3804467">false</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3804474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804477"><a href="/net/http/request.go.html#3804172">major</a></span><span class="op" id="3804482">,</span>&nbsp;<span class="ident" id="3804484">err</span>&nbsp;<span class="op" id="3804488">:=</span>&nbsp;<span class="ident" id="3804491"><a href="/net/http/request.go.html#3789625">strconv</a></span><span class="op" id="3804498">.</span><span class="ident" id="3804499">Atoi</span><span class="op" id="3804503">(</span><span class="ident" id="3804504"><a href="/net/http/request.go.html#3804158">vers</a></span><span class="op" id="3804508">[</span><span class="num" id="3804509">5</span><span class="op" id="3804510">:</span><span class="ident" id="3804511"><a href="/net/http/request.go.html#3804406">dot</a></span><span class="op" id="3804514">]</span><span class="op" id="3804515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804518">if</span>&nbsp;<span class="ident" id="3804521"><a href="/net/http/request.go.html#3804484">err</a></span>&nbsp;<span class="op" id="3804525">!=</span>&nbsp;<span class="ident" id="3804528">nil</span>&nbsp;<span class="op" id="3804532">||</span>&nbsp;<span class="ident" id="3804535"><a href="/net/http/request.go.html#3804172">major</a></span>&nbsp;<span class="op" id="3804541">&lt;</span>&nbsp;<span class="num" id="3804543">0</span>&nbsp;<span class="op" id="3804545">||</span>&nbsp;<span class="ident" id="3804548"><a href="/net/http/request.go.html#3804172">major</a></span>&nbsp;<span class="op" id="3804554">&gt;</span>&nbsp;<span class="ident" id="3804556"><a href="/net/http/request.go.html#3804208">Big</a></span>&nbsp;<span class="op" id="3804560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804564">return</span>&nbsp;<span class="num" id="3804571">0</span><span class="op" id="3804572">,</span>&nbsp;<span class="num" id="3804574">0</span><span class="op" id="3804575">,</span>&nbsp;<span class="ident" id="3804577">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3804584">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804587"><a href="/net/http/request.go.html#3804179">minor</a></span><span class="op" id="3804592">,</span>&nbsp;<span class="ident" id="3804594"><a href="/net/http/request.go.html#3804484">err</a></span>&nbsp;<span class="op" id="3804598">=</span>&nbsp;<span class="ident" id="3804600"><a href="/net/http/request.go.html#3789625">strconv</a></span><span class="op" id="3804607">.</span><span class="ident" id="3804608">Atoi</span><span class="op" id="3804612">(</span><span class="ident" id="3804613"><a href="/net/http/request.go.html#3804158">vers</a></span><span class="op" id="3804617">[</span><span class="ident" id="3804618"><a href="/net/http/request.go.html#3804406">dot</a></span><span class="op" id="3804621">+</span><span class="num" id="3804622">1</span><span class="op" id="3804623">:</span><span class="op" id="3804624">]</span><span class="op" id="3804625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804628">if</span>&nbsp;<span class="ident" id="3804631"><a href="/net/http/request.go.html#3804484">err</a></span>&nbsp;<span class="op" id="3804635">!=</span>&nbsp;<span class="ident" id="3804638">nil</span>&nbsp;<span class="op" id="3804642">||</span>&nbsp;<span class="ident" id="3804645"><a href="/net/http/request.go.html#3804179">minor</a></span>&nbsp;<span class="op" id="3804651">&lt;</span>&nbsp;<span class="num" id="3804653">0</span>&nbsp;<span class="op" id="3804655">||</span>&nbsp;<span class="ident" id="3804658"><a href="/net/http/request.go.html#3804179">minor</a></span>&nbsp;<span class="op" id="3804664">&gt;</span>&nbsp;<span class="ident" id="3804666"><a href="/net/http/request.go.html#3804208">Big</a></span>&nbsp;<span class="op" id="3804670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804674">return</span>&nbsp;<span class="num" id="3804681">0</span><span class="op" id="3804682">,</span>&nbsp;<span class="num" id="3804684">0</span><span class="op" id="3804685">,</span>&nbsp;<span class="ident" id="3804687">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3804694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804697">return</span>&nbsp;<span class="ident" id="3804704"><a href="/net/http/request.go.html#3804172">major</a></span><span class="op" id="3804709">,</span>&nbsp;<span class="ident" id="3804711"><a href="/net/http/request.go.html#3804179">minor</a></span><span class="op" id="3804716">,</span>&nbsp;<span class="ident" id="3804718">true</span><br>
<span class="lineno">485</span><span class="op" id="3804723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3804726">//&nbsp;NewRequest&nbsp;returns&nbsp;a&nbsp;new&nbsp;Request&nbsp;given&nbsp;a&nbsp;method,&nbsp;URL,&nbsp;and&nbsp;optional&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="3804802">//</span><br>
<span class="lineno"></span><span class="comment" id="3804805">//&nbsp;If&nbsp;the&nbsp;provided&nbsp;body&nbsp;is&nbsp;also&nbsp;an&nbsp;io.Closer,&nbsp;the&nbsp;returned</span><br>
<span class="lineno">490</span><span class="comment" id="3804864">//&nbsp;Request.Body&nbsp;is&nbsp;set&nbsp;to&nbsp;body&nbsp;and&nbsp;will&nbsp;be&nbsp;closed&nbsp;by&nbsp;the&nbsp;Client</span><br>
<span class="lineno"></span><span class="comment" id="3804928">//&nbsp;methods&nbsp;Do,&nbsp;Post,&nbsp;and&nbsp;PostForm,&nbsp;and&nbsp;Transport.RoundTrip.</span><br>
<span class="lineno"></span><span class="keyword" id="3804988">func</span>&nbsp;<span class="ident" id="3804993">NewRequest</span><span class="op" id="3805003">(</span><span class="ident" id="3805004">method</span><span class="op" id="3805010">,</span>&nbsp;<span class="ident" id="3805012">urlStr</span>&nbsp;<span class="builtintype" id="3805019">string</span><span class="op" id="3805025">,</span>&nbsp;<span class="ident" id="3805027">body</span>&nbsp;<span class="ident" id="3805032"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3805034">.</span><span class="ident" id="3805035">Reader</span><span class="op" id="3805041">)</span>&nbsp;<span class="op" id="3805043">(</span><span class="op" id="3805044">*</span><span class="ident" id="3805045"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3805052">,</span>&nbsp;<span class="builtintype" id="3805054">error</span><span class="op" id="3805059">)</span>&nbsp;<span class="op" id="3805061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805064">u</span><span class="op" id="3805065">,</span>&nbsp;<span class="ident" id="3805067">err</span>&nbsp;<span class="op" id="3805071">:=</span>&nbsp;<span class="ident" id="3805074"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3805077">.</span><span class="ident" id="3805078">Parse</span><span class="op" id="3805083">(</span><span class="ident" id="3805084"><a href="/net/http/request.go.html#3805012">urlStr</a></span><span class="op" id="3805090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805093">if</span>&nbsp;<span class="ident" id="3805096"><a href="/net/http/request.go.html#3805067">err</a></span>&nbsp;<span class="op" id="3805100">!=</span>&nbsp;<span class="ident" id="3805103">nil</span>&nbsp;<span class="op" id="3805107">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805111">return</span>&nbsp;<span class="ident" id="3805118">nil</span><span class="op" id="3805121">,</span>&nbsp;<span class="ident" id="3805123"><a href="/net/http/request.go.html#3805067">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805131">rc</span><span class="op" id="3805133">,</span>&nbsp;<span class="ident" id="3805135">ok</span>&nbsp;<span class="op" id="3805138">:=</span>&nbsp;<span class="ident" id="3805141"><a href="/net/http/request.go.html#3805027">body</a></span><span class="op" id="3805145">.</span><span class="op" id="3805146">(</span><span class="ident" id="3805147"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3805149">.</span><span class="ident" id="3805150">ReadCloser</span><span class="op" id="3805160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805163">if</span>&nbsp;<span class="op" id="3805166">!</span><span class="ident" id="3805167"><a href="/net/http/request.go.html#3805135">ok</a></span>&nbsp;<span class="op" id="3805170">&amp;&amp;</span>&nbsp;<span class="ident" id="3805173"><a href="/net/http/request.go.html#3805027">body</a></span>&nbsp;<span class="op" id="3805178">!=</span>&nbsp;<span class="ident" id="3805181">nil</span>&nbsp;<span class="op" id="3805185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805189"><a href="/net/http/request.go.html#3805131">rc</a></span>&nbsp;<span class="op" id="3805192">=</span>&nbsp;<span class="ident" id="3805194"><a href="/net/http/request.go.html#3789558">ioutil</a></span><span class="op" id="3805200">.</span><span class="ident" id="3805201">NopCloser</span><span class="op" id="3805210">(</span><span class="ident" id="3805211"><a href="/net/http/request.go.html#3805027">body</a></span><span class="op" id="3805215">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805221">req</span>&nbsp;<span class="op" id="3805225">:=</span>&nbsp;<span class="op" id="3805228">&amp;</span><span class="ident" id="3805229"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3805236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805240">Method</span><span class="op" id="3805246">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805252"><a href="/net/http/request.go.html#3805004">method</a></span><span class="op" id="3805258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805262">URL</span><span class="op" id="3805265">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805274"><a href="/net/http/request.go.html#3805064">u</a></span><span class="op" id="3805275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805279">Proto</span><span class="op" id="3805284">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3805291">&#34;HTTP/1.1&#34;</span><span class="op" id="3805301">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805305">ProtoMajor</span><span class="op" id="3805315">:</span>&nbsp;<span class="num" id="3805317">1</span><span class="op" id="3805318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805322">ProtoMinor</span><span class="op" id="3805332">:</span>&nbsp;<span class="num" id="3805334">1</span><span class="op" id="3805335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805339">Header</span><span class="op" id="3805345">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3805351">make</span><span class="op" id="3805355">(</span><span class="ident" id="3805356"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3805362">)</span><span class="op" id="3805363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805367">Body</span><span class="op" id="3805371">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805379"><a href="/net/http/request.go.html#3805131">rc</a></span><span class="op" id="3805381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805385">Host</span><span class="op" id="3805389">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3805397"><a href="/net/http/request.go.html#3805064">u</a></span><span class="op" id="3805398">.</span><span class="ident" id="3805399">Host</span><span class="op" id="3805403">,</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805409">if</span>&nbsp;<span class="ident" id="3805412"><a href="/net/http/request.go.html#3805027">body</a></span>&nbsp;<span class="op" id="3805417">!=</span>&nbsp;<span class="ident" id="3805420">nil</span>&nbsp;<span class="op" id="3805424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805428">switch</span>&nbsp;<span class="ident" id="3805435">v</span>&nbsp;<span class="op" id="3805437">:=</span>&nbsp;<span class="ident" id="3805440"><a href="/net/http/request.go.html#3805027">body</a></span><span class="op" id="3805444">.</span><span class="op" id="3805445">(</span><span class="keyword" id="3805446">type</span><span class="op" id="3805450">)</span>&nbsp;<span class="op" id="3805452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805456">case</span>&nbsp;<span class="op" id="3805461">*</span><span class="ident" id="3805462"><a href="/net/http/request.go.html#3789493">bytes</a></span><span class="op" id="3805467">.</span><span class="ident" id="3805468">Buffer</span><span class="op" id="3805474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805479"><a href="/net/http/request.go.html#3805221">req</a></span><span class="op" id="3805482">.</span><span class="ident" id="3805483">ContentLength</span>&nbsp;<span class="op" id="3805497">=</span>&nbsp;<span class="ident" id="3805499">int64</span><span class="op" id="3805504">(</span><span class="ident" id="3805505"><a href="/net/http/request.go.html#3805435">v</a></span><span class="op" id="3805506">.</span><span class="ident" id="3805507">Len</span><span class="op" id="3805510">(</span><span class="op" id="3805511">)</span><span class="op" id="3805512">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805516">case</span>&nbsp;<span class="op" id="3805521">*</span><span class="ident" id="3805522"><a href="/net/http/request.go.html#3789493">bytes</a></span><span class="op" id="3805527">.</span><span class="ident" id="3805528">Reader</span><span class="op" id="3805534">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805539"><a href="/net/http/request.go.html#3805221">req</a></span><span class="op" id="3805542">.</span><span class="ident" id="3805543">ContentLength</span>&nbsp;<span class="op" id="3805557">=</span>&nbsp;<span class="ident" id="3805559">int64</span><span class="op" id="3805564">(</span><span class="ident" id="3805565"><a href="/net/http/request.go.html#3805435">v</a></span><span class="op" id="3805566">.</span><span class="ident" id="3805567">Len</span><span class="op" id="3805570">(</span><span class="op" id="3805571">)</span><span class="op" id="3805572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805576">case</span>&nbsp;<span class="op" id="3805581">*</span><span class="ident" id="3805582"><a href="/net/http/request.go.html#3789636">strings</a></span><span class="op" id="3805589">.</span><span class="ident" id="3805590">Reader</span><span class="op" id="3805596">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805601"><a href="/net/http/request.go.html#3805221">req</a></span><span class="op" id="3805604">.</span><span class="ident" id="3805605">ContentLength</span>&nbsp;<span class="op" id="3805619">=</span>&nbsp;<span class="ident" id="3805621">int64</span><span class="op" id="3805626">(</span><span class="ident" id="3805627"><a href="/net/http/request.go.html#3805435">v</a></span><span class="op" id="3805628">.</span><span class="ident" id="3805629">Len</span><span class="op" id="3805632">(</span><span class="op" id="3805633">)</span><span class="op" id="3805634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805638">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805645">return</span>&nbsp;<span class="ident" id="3805652"><a href="/net/http/request.go.html#3805221">req</a></span><span class="op" id="3805655">,</span>&nbsp;<span class="ident" id="3805657">nil</span><br>
<span class="lineno"></span><span class="op" id="3805661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="3805664">//&nbsp;BasicAuth&nbsp;returns&nbsp;the&nbsp;username&nbsp;and&nbsp;password&nbsp;provided&nbsp;in&nbsp;the&nbsp;request&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3805737">//&nbsp;Authorization&nbsp;header,&nbsp;if&nbsp;the&nbsp;request&nbsp;uses&nbsp;HTTP&nbsp;Basic&nbsp;Authentication.</span><br>
<span class="lineno"></span><span class="comment" id="3805809">//&nbsp;See&nbsp;RFC&nbsp;2617,&nbsp;Section&nbsp;2.</span><br>
<span class="lineno"></span><span class="keyword" id="3805837">func</span>&nbsp;<span class="op" id="3805842">(</span><span class="ident" id="3805843">r</span>&nbsp;<span class="op" id="3805845">*</span><span class="ident" id="3805846"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3805853">)</span>&nbsp;<span class="ident" id="3805855">BasicAuth</span><span class="op" id="3805864">(</span><span class="op" id="3805865">)</span>&nbsp;<span class="op" id="3805867">(</span><span class="ident" id="3805868">username</span><span class="op" id="3805876">,</span>&nbsp;<span class="ident" id="3805878">password</span>&nbsp;<span class="builtintype" id="3805887">string</span><span class="op" id="3805893">,</span>&nbsp;<span class="ident" id="3805895">ok</span>&nbsp;<span class="builtintype" id="3805898">bool</span><span class="op" id="3805902">)</span>&nbsp;<span class="op" id="3805904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805907">auth</span>&nbsp;<span class="op" id="3805912">:=</span>&nbsp;<span class="ident" id="3805915"><a href="/net/http/request.go.html#3805843">r</a></span><span class="op" id="3805916">.</span><span class="ident" id="3805917">Header</span><span class="op" id="3805923">.</span><span class="ident" id="3805924">Get</span><span class="op" id="3805927">(</span><span class="string" id="3805928">&#34;Authorization&#34;</span><span class="op" id="3805943">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805946">if</span>&nbsp;<span class="ident" id="3805949"><a href="/net/http/request.go.html#3805907">auth</a></span>&nbsp;<span class="op" id="3805954">==</span>&nbsp;<span class="string" id="3805957">&#34;&#34;</span>&nbsp;<span class="op" id="3805960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805964">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805975">return</span>&nbsp;<span class="ident" id="3805982"><a href="/net/http/request.go.html#3806155">parseBasicAuth</a></span><span class="op" id="3805996">(</span><span class="ident" id="3805997"><a href="/net/http/request.go.html#3805907">auth</a></span><span class="op" id="3806001">)</span><br>
<span class="lineno"></span><span class="op" id="3806003">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="comment" id="3806006">//&nbsp;parseBasicAuth&nbsp;parses&nbsp;an&nbsp;HTTP&nbsp;Basic&nbsp;Authentication&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="3806068">//&nbsp;&#34;Basic&nbsp;QWxhZGRpbjpvcGVuIHNlc2FtZQ==&#34;&nbsp;returns&nbsp;(&#34;Aladdin&#34;,&nbsp;&#34;open&nbsp;sesame&#34;,&nbsp;true).</span><br>
<span class="lineno"></span><span class="keyword" id="3806150">func</span>&nbsp;<span class="ident" id="3806155">parseBasicAuth</span><span class="op" id="3806169">(</span><span class="ident" id="3806170">auth</span>&nbsp;<span class="builtintype" id="3806175">string</span><span class="op" id="3806181">)</span>&nbsp;<span class="op" id="3806183">(</span><span class="ident" id="3806184">username</span><span class="op" id="3806192">,</span>&nbsp;<span class="ident" id="3806194">password</span>&nbsp;<span class="builtintype" id="3806203">string</span><span class="op" id="3806209">,</span>&nbsp;<span class="ident" id="3806211">ok</span>&nbsp;<span class="builtintype" id="3806214">bool</span><span class="op" id="3806218">)</span>&nbsp;<span class="op" id="3806220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806223">if</span>&nbsp;<span class="op" id="3806226">!</span><span class="ident" id="3806227"><a href="/net/http/request.go.html#3789636">strings</a></span><span class="op" id="3806234">.</span><span class="ident" id="3806235">HasPrefix</span><span class="op" id="3806244">(</span><span class="ident" id="3806245"><a href="/net/http/request.go.html#3806170">auth</a></span><span class="op" id="3806249">,</span>&nbsp;<span class="string" id="3806251">&#34;Basic&nbsp;&#34;</span><span class="op" id="3806259">)</span>&nbsp;<span class="op" id="3806261">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806265">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3806273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3806276">c</span><span class="op" id="3806277">,</span>&nbsp;<span class="ident" id="3806279">err</span>&nbsp;<span class="op" id="3806283">:=</span>&nbsp;<span class="ident" id="3806286"><a href="/net/http/request.go.html#3789516">base64</a></span><span class="op" id="3806292">.</span><span class="ident" id="3806293">StdEncoding</span><span class="op" id="3806304">.</span><span class="ident" id="3806305">DecodeString</span><span class="op" id="3806317">(</span><span class="ident" id="3806318"><a href="/net/http/request.go.html#3789636">strings</a></span><span class="op" id="3806325">.</span><span class="ident" id="3806326">TrimPrefix</span><span class="op" id="3806336">(</span><span class="ident" id="3806337"><a href="/net/http/request.go.html#3806170">auth</a></span><span class="op" id="3806341">,</span>&nbsp;<span class="string" id="3806343">&#34;Basic&nbsp;&#34;</span><span class="op" id="3806351">)</span><span class="op" id="3806352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806355">if</span>&nbsp;<span class="ident" id="3806358"><a href="/net/http/request.go.html#3806279">err</a></span>&nbsp;<span class="op" id="3806362">!=</span>&nbsp;<span class="ident" id="3806365">nil</span>&nbsp;<span class="op" id="3806369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806373">return</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3806381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3806384">cs</span>&nbsp;<span class="op" id="3806387">:=</span>&nbsp;<span class="builtintype" id="3806390">string</span><span class="op" id="3806396">(</span><span class="ident" id="3806397"><a href="/net/http/request.go.html#3806276">c</a></span><span class="op" id="3806398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3806401">s</span>&nbsp;<span class="op" id="3806403">:=</span>&nbsp;<span class="ident" id="3806406"><a href="/net/http/request.go.html#3789636">strings</a></span><span class="op" id="3806413">.</span><span class="ident" id="3806414">IndexByte</span><span class="op" id="3806423">(</span><span class="ident" id="3806424"><a href="/net/http/request.go.html#3806384">cs</a></span><span class="op" id="3806426">,</span>&nbsp;<span class="string" id="3806428">&#39;:&#39;</span><span class="op" id="3806431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806434">if</span>&nbsp;<span class="ident" id="3806437"><a href="/net/http/request.go.html#3806401">s</a></span>&nbsp;<span class="op" id="3806439">&lt;</span>&nbsp;<span class="num" id="3806441">0</span>&nbsp;<span class="op" id="3806443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806447">return</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3806455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806458">return</span>&nbsp;<span class="ident" id="3806465"><a href="/net/http/request.go.html#3806384">cs</a></span><span class="op" id="3806467">[</span><span class="op" id="3806468">:</span><span class="ident" id="3806469"><a href="/net/http/request.go.html#3806401">s</a></span><span class="op" id="3806470">]</span><span class="op" id="3806471">,</span>&nbsp;<span class="ident" id="3806473"><a href="/net/http/request.go.html#3806384">cs</a></span><span class="op" id="3806475">[</span><span class="ident" id="3806476"><a href="/net/http/request.go.html#3806401">s</a></span><span class="op" id="3806477">+</span><span class="num" id="3806478">1</span><span class="op" id="3806479">:</span><span class="op" id="3806480">]</span><span class="op" id="3806481">,</span>&nbsp;<span class="ident" id="3806483">true</span><br>
<span class="lineno"></span><span class="op" id="3806488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3806491">//&nbsp;SetBasicAuth&nbsp;sets&nbsp;the&nbsp;request&#39;s&nbsp;Authorization&nbsp;header&nbsp;to&nbsp;use&nbsp;HTTP</span><br>
<span class="lineno">555</span><span class="comment" id="3806559">//&nbsp;Basic&nbsp;Authentication&nbsp;with&nbsp;the&nbsp;provided&nbsp;username&nbsp;and&nbsp;password.</span><br>
<span class="lineno"></span><span class="comment" id="3806624">//</span><br>
<span class="lineno"></span><span class="comment" id="3806627">//&nbsp;With&nbsp;HTTP&nbsp;Basic&nbsp;Authentication&nbsp;the&nbsp;provided&nbsp;username&nbsp;and&nbsp;password</span><br>
<span class="lineno"></span><span class="comment" id="3806696">//&nbsp;are&nbsp;not&nbsp;encrypted.</span><br>
<span class="lineno"></span><span class="keyword" id="3806718">func</span>&nbsp;<span class="op" id="3806723">(</span><span class="ident" id="3806724">r</span>&nbsp;<span class="op" id="3806726">*</span><span class="ident" id="3806727"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3806734">)</span>&nbsp;<span class="ident" id="3806736">SetBasicAuth</span><span class="op" id="3806748">(</span><span class="ident" id="3806749">username</span><span class="op" id="3806757">,</span>&nbsp;<span class="ident" id="3806759">password</span>&nbsp;<span class="builtintype" id="3806768">string</span><span class="op" id="3806774">)</span>&nbsp;<span class="op" id="3806776">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3806779"><a href="/net/http/request.go.html#3806724">r</a></span><span class="op" id="3806780">.</span><span class="ident" id="3806781">Header</span><span class="op" id="3806787">.</span><span class="ident" id="3806788">Set</span><span class="op" id="3806791">(</span><span class="string" id="3806792">&#34;Authorization&#34;</span><span class="op" id="3806807">,</span>&nbsp;<span class="string" id="3806809">&#34;Basic&nbsp;&#34;</span><span class="op" id="3806817">+</span><span class="ident" id="3806818"><a href="/net/http/client.go.html#3743145">basicAuth</a></span><span class="op" id="3806827">(</span><span class="ident" id="3806828"><a href="/net/http/request.go.html#3806749">username</a></span><span class="op" id="3806836">,</span>&nbsp;<span class="ident" id="3806838"><a href="/net/http/request.go.html#3806759">password</a></span><span class="op" id="3806846">)</span><span class="op" id="3806847">)</span><br>
<span class="lineno"></span><span class="op" id="3806849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3806852">//&nbsp;parseRequestLine&nbsp;parses&nbsp;&#34;GET&nbsp;/foo&nbsp;HTTP/1.1&#34;&nbsp;into&nbsp;its&nbsp;three&nbsp;parts.</span><br>
<span class="lineno"></span><span class="keyword" id="3806921">func</span>&nbsp;<span class="ident" id="3806926">parseRequestLine</span><span class="op" id="3806942">(</span><span class="ident" id="3806943">line</span>&nbsp;<span class="builtintype" id="3806948">string</span><span class="op" id="3806954">)</span>&nbsp;<span class="op" id="3806956">(</span><span class="ident" id="3806957">method</span><span class="op" id="3806963">,</span>&nbsp;<span class="ident" id="3806965">requestURI</span><span class="op" id="3806975">,</span>&nbsp;<span class="ident" id="3806977">proto</span>&nbsp;<span class="builtintype" id="3806983">string</span><span class="op" id="3806989">,</span>&nbsp;<span class="ident" id="3806991">ok</span>&nbsp;<span class="builtintype" id="3806994">bool</span><span class="op" id="3806998">)</span>&nbsp;<span class="op" id="3807000">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807003">s1</span>&nbsp;<span class="op" id="3807006">:=</span>&nbsp;<span class="ident" id="3807009"><a href="/net/http/request.go.html#3789636">strings</a></span><span class="op" id="3807016">.</span><span class="ident" id="3807017">Index</span><span class="op" id="3807022">(</span><span class="ident" id="3807023"><a href="/net/http/request.go.html#3806943">line</a></span><span class="op" id="3807027">,</span>&nbsp;<span class="string" id="3807029">&#34;&nbsp;&#34;</span><span class="op" id="3807032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807035">s2</span>&nbsp;<span class="op" id="3807038">:=</span>&nbsp;<span class="ident" id="3807041"><a href="/net/http/request.go.html#3789636">strings</a></span><span class="op" id="3807048">.</span><span class="ident" id="3807049">Index</span><span class="op" id="3807054">(</span><span class="ident" id="3807055"><a href="/net/http/request.go.html#3806943">line</a></span><span class="op" id="3807059">[</span><span class="ident" id="3807060"><a href="/net/http/request.go.html#3807003">s1</a></span><span class="op" id="3807062">+</span><span class="num" id="3807063">1</span><span class="op" id="3807064">:</span><span class="op" id="3807065">]</span><span class="op" id="3807066">,</span>&nbsp;<span class="string" id="3807068">&#34;&nbsp;&#34;</span><span class="op" id="3807071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807074">if</span>&nbsp;<span class="ident" id="3807077"><a href="/net/http/request.go.html#3807003">s1</a></span>&nbsp;<span class="op" id="3807080">&lt;</span>&nbsp;<span class="num" id="3807082">0</span>&nbsp;<span class="op" id="3807084">||</span>&nbsp;<span class="ident" id="3807087"><a href="/net/http/request.go.html#3807035">s2</a></span>&nbsp;<span class="op" id="3807090">&lt;</span>&nbsp;<span class="num" id="3807092">0</span>&nbsp;<span class="op" id="3807094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807098">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3807106">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807109"><a href="/net/http/request.go.html#3807035">s2</a></span>&nbsp;<span class="op" id="3807112">+=</span>&nbsp;<span class="ident" id="3807115"><a href="/net/http/request.go.html#3807003">s1</a></span>&nbsp;<span class="op" id="3807118">+</span>&nbsp;<span class="num" id="3807120">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807123">return</span>&nbsp;<span class="ident" id="3807130"><a href="/net/http/request.go.html#3806943">line</a></span><span class="op" id="3807134">[</span><span class="op" id="3807135">:</span><span class="ident" id="3807136"><a href="/net/http/request.go.html#3807003">s1</a></span><span class="op" id="3807138">]</span><span class="op" id="3807139">,</span>&nbsp;<span class="ident" id="3807141"><a href="/net/http/request.go.html#3806943">line</a></span><span class="op" id="3807145">[</span><span class="ident" id="3807146"><a href="/net/http/request.go.html#3807003">s1</a></span><span class="op" id="3807148">+</span><span class="num" id="3807149">1</span>&nbsp;<span class="op" id="3807151">:</span>&nbsp;<span class="ident" id="3807153"><a href="/net/http/request.go.html#3807035">s2</a></span><span class="op" id="3807155">]</span><span class="op" id="3807156">,</span>&nbsp;<span class="ident" id="3807158"><a href="/net/http/request.go.html#3806943">line</a></span><span class="op" id="3807162">[</span><span class="ident" id="3807163"><a href="/net/http/request.go.html#3807035">s2</a></span><span class="op" id="3807165">+</span><span class="num" id="3807166">1</span><span class="op" id="3807167">:</span><span class="op" id="3807168">]</span><span class="op" id="3807169">,</span>&nbsp;<span class="ident" id="3807171">true</span><br>
<span class="lineno"></span><span class="op" id="3807176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3807179">var</span>&nbsp;<span class="ident" id="3807183">textprotoReaderPool</span>&nbsp;<span class="ident" id="3807203"><a href="/net/http/request.go.html#3789647">sync</a></span><span class="op" id="3807207">.</span><span class="ident" id="3807208">Pool</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="keyword" id="3807214">func</span>&nbsp;<span class="ident" id="3807219">newTextprotoReader</span><span class="op" id="3807237">(</span><span class="ident" id="3807238">br</span>&nbsp;<span class="op" id="3807241">*</span><span class="ident" id="3807242"><a href="/net/http/request.go.html#3789484">bufio</a></span><span class="op" id="3807247">.</span><span class="ident" id="3807248">Reader</span><span class="op" id="3807254">)</span>&nbsp;<span class="op" id="3807256">*</span><span class="ident" id="3807257"><a href="/net/http/request.go.html#3789597">textproto</a></span><span class="op" id="3807266">.</span><span class="ident" id="3807267">Reader</span>&nbsp;<span class="op" id="3807274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807277">if</span>&nbsp;<span class="ident" id="3807280">v</span>&nbsp;<span class="op" id="3807282">:=</span>&nbsp;<span class="ident" id="3807285"><a href="/net/http/request.go.html#3807183">textprotoReaderPool</a></span><span class="op" id="3807304">.</span><span class="ident" id="3807305">Get</span><span class="op" id="3807308">(</span><span class="op" id="3807309">)</span><span class="op" id="3807310">;</span>&nbsp;<span class="ident" id="3807312"><a href="/net/http/request.go.html#3807280">v</a></span>&nbsp;<span class="op" id="3807314">!=</span>&nbsp;<span class="ident" id="3807317">nil</span>&nbsp;<span class="op" id="3807321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807325">tr</span>&nbsp;<span class="op" id="3807328">:=</span>&nbsp;<span class="ident" id="3807331"><a href="/net/http/request.go.html#3807280">v</a></span><span class="op" id="3807332">.</span><span class="op" id="3807333">(</span><span class="op" id="3807334">*</span><span class="ident" id="3807335"><a href="/net/http/request.go.html#3789597">textproto</a></span><span class="op" id="3807344">.</span><span class="ident" id="3807345">Reader</span><span class="op" id="3807351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807355"><a href="/net/http/request.go.html#3807325">tr</a></span><span class="op" id="3807357">.</span><span class="ident" id="3807358">R</span>&nbsp;<span class="op" id="3807360">=</span>&nbsp;<span class="ident" id="3807362"><a href="/net/http/request.go.html#3807238">br</a></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807367">return</span>&nbsp;<span class="ident" id="3807374"><a href="/net/http/request.go.html#3807325">tr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3807378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807381">return</span>&nbsp;<span class="ident" id="3807388"><a href="/net/http/request.go.html#3789597">textproto</a></span><span class="op" id="3807397">.</span><span class="ident" id="3807398">NewReader</span><span class="op" id="3807407">(</span><span class="ident" id="3807408"><a href="/net/http/request.go.html#3807238">br</a></span><span class="op" id="3807410">)</span><br>
<span class="lineno"></span><span class="op" id="3807412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="keyword" id="3807415">func</span>&nbsp;<span class="ident" id="3807420">putTextprotoReader</span><span class="op" id="3807438">(</span><span class="ident" id="3807439">r</span>&nbsp;<span class="op" id="3807441">*</span><span class="ident" id="3807442"><a href="/net/http/request.go.html#3789597">textproto</a></span><span class="op" id="3807451">.</span><span class="ident" id="3807452">Reader</span><span class="op" id="3807458">)</span>&nbsp;<span class="op" id="3807460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807463"><a href="/net/http/request.go.html#3807439">r</a></span><span class="op" id="3807464">.</span><span class="ident" id="3807465">R</span>&nbsp;<span class="op" id="3807467">=</span>&nbsp;<span class="ident" id="3807469">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807474"><a href="/net/http/request.go.html#3807183">textprotoReaderPool</a></span><span class="op" id="3807493">.</span><span class="ident" id="3807494">Put</span><span class="op" id="3807497">(</span><span class="ident" id="3807498"><a href="/net/http/request.go.html#3807439">r</a></span><span class="op" id="3807499">)</span><br>
<span class="lineno"></span><span class="op" id="3807501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span><span class="comment" id="3807504">//&nbsp;ReadRequest&nbsp;reads&nbsp;and&nbsp;parses&nbsp;a&nbsp;request&nbsp;from&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3807554">func</span>&nbsp;<span class="ident" id="3807559">ReadRequest</span><span class="op" id="3807570">(</span><span class="ident" id="3807571">b</span>&nbsp;<span class="op" id="3807573">*</span><span class="ident" id="3807574"><a href="/net/http/request.go.html#3789484">bufio</a></span><span class="op" id="3807579">.</span><span class="ident" id="3807580">Reader</span><span class="op" id="3807586">)</span>&nbsp;<span class="op" id="3807588">(</span><span class="ident" id="3807589">req</span>&nbsp;<span class="op" id="3807593">*</span><span class="ident" id="3807594"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3807601">,</span>&nbsp;<span class="ident" id="3807603">err</span>&nbsp;<span class="builtintype" id="3807607">error</span><span class="op" id="3807612">)</span>&nbsp;<span class="op" id="3807614">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807618">tp</span>&nbsp;<span class="op" id="3807621">:=</span>&nbsp;<span class="ident" id="3807624"><a href="/net/http/request.go.html#3807219">newTextprotoReader</a></span><span class="op" id="3807642">(</span><span class="ident" id="3807643"><a href="/net/http/request.go.html#3807571">b</a></span><span class="op" id="3807644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807647"><a href="/net/http/request.go.html#3807589">req</a></span>&nbsp;<span class="op" id="3807651">=</span>&nbsp;<span class="builtinfunc" id="3807653">new</span><span class="op" id="3807656">(</span><span class="ident" id="3807657"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3807664">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3807668">//&nbsp;First&nbsp;line:&nbsp;GET&nbsp;/index.html&nbsp;HTTP/1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807709">var</span>&nbsp;<span class="ident" id="3807713">s</span>&nbsp;<span class="builtintype" id="3807715">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807723">if</span>&nbsp;<span class="ident" id="3807726"><a href="/net/http/request.go.html#3807713">s</a></span><span class="op" id="3807727">,</span>&nbsp;<span class="ident" id="3807729"><a href="/net/http/request.go.html#3807603">err</a></span>&nbsp;<span class="op" id="3807733">=</span>&nbsp;<span class="ident" id="3807735"><a href="/net/http/request.go.html#3807618">tp</a></span><span class="op" id="3807737">.</span><span class="ident" id="3807738">ReadLine</span><span class="op" id="3807746">(</span><span class="op" id="3807747">)</span><span class="op" id="3807748">;</span>&nbsp;<span class="ident" id="3807750"><a href="/net/http/request.go.html#3807603">err</a></span>&nbsp;<span class="op" id="3807754">!=</span>&nbsp;<span class="ident" id="3807757">nil</span>&nbsp;<span class="op" id="3807761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807765">return</span>&nbsp;<span class="ident" id="3807772">nil</span><span class="op" id="3807775">,</span>&nbsp;<span class="ident" id="3807777"><a href="/net/http/request.go.html#3807603">err</a></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3807782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807785">defer</span>&nbsp;<span class="keyword" id="3807791">func</span><span class="op" id="3807795">(</span><span class="op" id="3807796">)</span>&nbsp;<span class="op" id="3807798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807802"><a href="/net/http/request.go.html#3807420">putTextprotoReader</a></span><span class="op" id="3807820">(</span><span class="ident" id="3807821"><a href="/net/http/request.go.html#3807618">tp</a></span><span class="op" id="3807823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807827">if</span>&nbsp;<span class="ident" id="3807830"><a href="/net/http/request.go.html#3807603">err</a></span>&nbsp;<span class="op" id="3807834">==</span>&nbsp;<span class="ident" id="3807837"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3807839">.</span><span class="ident" id="3807840">EOF</span>&nbsp;<span class="op" id="3807844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807849"><a href="/net/http/request.go.html#3807603">err</a></span>&nbsp;<span class="op" id="3807853">=</span>&nbsp;<span class="ident" id="3807855"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3807857">.</span><span class="ident" id="3807858">ErrUnexpectedEOF</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3807877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3807880">}</span><span class="op" id="3807881">(</span><span class="op" id="3807882">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807886">var</span>&nbsp;<span class="ident" id="3807890">ok</span>&nbsp;<span class="builtintype" id="3807893">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807899"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3807902">.</span><span class="ident" id="3807903">Method</span><span class="op" id="3807909">,</span>&nbsp;<span class="ident" id="3807911"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3807914">.</span><span class="ident" id="3807915">RequestURI</span><span class="op" id="3807925">,</span>&nbsp;<span class="ident" id="3807927"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3807930">.</span><span class="ident" id="3807931">Proto</span><span class="op" id="3807936">,</span>&nbsp;<span class="ident" id="3807938"><a href="/net/http/request.go.html#3807890">ok</a></span>&nbsp;<span class="op" id="3807941">=</span>&nbsp;<span class="ident" id="3807943"><a href="/net/http/request.go.html#3806926">parseRequestLine</a></span><span class="op" id="3807959">(</span><span class="ident" id="3807960"><a href="/net/http/request.go.html#3807713">s</a></span><span class="op" id="3807961">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807964">if</span>&nbsp;<span class="op" id="3807967">!</span><span class="ident" id="3807968"><a href="/net/http/request.go.html#3807890">ok</a></span>&nbsp;<span class="op" id="3807971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807975">return</span>&nbsp;<span class="ident" id="3807982">nil</span><span class="op" id="3807985">,</span>&nbsp;<span class="op" id="3807987">&amp;</span><span class="ident" id="3807988"><a href="/net/http/request.go.html#3790712">badStringError</a></span><span class="op" id="3808002">{</span><span class="string" id="3808003">&#34;malformed&nbsp;HTTP&nbsp;request&#34;</span><span class="op" id="3808027">,</span>&nbsp;<span class="ident" id="3808029"><a href="/net/http/request.go.html#3807713">s</a></span><span class="op" id="3808030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808036">rawurl</span>&nbsp;<span class="op" id="3808043">:=</span>&nbsp;<span class="ident" id="3808046"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3808049">.</span><span class="ident" id="3808050">RequestURI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808062">if</span>&nbsp;<span class="ident" id="3808065"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3808068">.</span><span class="ident" id="3808069">ProtoMajor</span><span class="op" id="3808079">,</span>&nbsp;<span class="ident" id="3808081"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3808084">.</span><span class="ident" id="3808085">ProtoMinor</span><span class="op" id="3808095">,</span>&nbsp;<span class="ident" id="3808097"><a href="/net/http/request.go.html#3807890">ok</a></span>&nbsp;<span class="op" id="3808100">=</span>&nbsp;<span class="ident" id="3808102"><a href="/net/http/request.go.html#3804141">ParseHTTPVersion</a></span><span class="op" id="3808118">(</span><span class="ident" id="3808119"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3808122">.</span><span class="ident" id="3808123">Proto</span><span class="op" id="3808128">)</span><span class="op" id="3808129">;</span>&nbsp;<span class="op" id="3808131">!</span><span class="ident" id="3808132"><a href="/net/http/request.go.html#3807890">ok</a></span>&nbsp;<span class="op" id="3808135">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808139">return</span>&nbsp;<span class="ident" id="3808146">nil</span><span class="op" id="3808149">,</span>&nbsp;<span class="op" id="3808151">&amp;</span><span class="ident" id="3808152"><a href="/net/http/request.go.html#3790712">badStringError</a></span><span class="op" id="3808166">{</span><span class="string" id="3808167">&#34;malformed&nbsp;HTTP&nbsp;version&#34;</span><span class="op" id="3808191">,</span>&nbsp;<span class="ident" id="3808193"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3808196">.</span><span class="ident" id="3808197">Proto</span><span class="op" id="3808202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808209">//&nbsp;CONNECT&nbsp;requests&nbsp;are&nbsp;used&nbsp;two&nbsp;different&nbsp;ways,&nbsp;and&nbsp;neither&nbsp;uses&nbsp;a&nbsp;full&nbsp;URL:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808288">//&nbsp;The&nbsp;standard&nbsp;use&nbsp;is&nbsp;to&nbsp;tunnel&nbsp;HTTPS&nbsp;through&nbsp;an&nbsp;HTTP&nbsp;proxy.</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808351">//&nbsp;It&nbsp;looks&nbsp;like&nbsp;&#34;CONNECT&nbsp;www.google.com:443&nbsp;HTTP/1.1&#34;,&nbsp;and&nbsp;the&nbsp;parameter&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808429">//&nbsp;just&nbsp;the&nbsp;authority&nbsp;section&nbsp;of&nbsp;a&nbsp;URL.&nbsp;This&nbsp;information&nbsp;should&nbsp;go&nbsp;in&nbsp;req.URL.Host.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808514">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808518">//&nbsp;The&nbsp;net/rpc&nbsp;package&nbsp;also&nbsp;uses&nbsp;CONNECT,&nbsp;but&nbsp;there&nbsp;the&nbsp;parameter&nbsp;is&nbsp;a&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808595">//&nbsp;that&nbsp;starts&nbsp;with&nbsp;a&nbsp;slash.&nbsp;It&nbsp;can&nbsp;be&nbsp;parsed&nbsp;with&nbsp;the&nbsp;regular&nbsp;URL&nbsp;parser,</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808671">//&nbsp;and&nbsp;the&nbsp;path&nbsp;will&nbsp;end&nbsp;up&nbsp;in&nbsp;req.URL.Path,&nbsp;where&nbsp;it&nbsp;needs&nbsp;to&nbsp;be&nbsp;in&nbsp;order&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808751">//&nbsp;RPC&nbsp;to&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808768">justAuthority</span>&nbsp;<span class="op" id="3808782">:=</span>&nbsp;<span class="ident" id="3808785"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3808788">.</span><span class="ident" id="3808789">Method</span>&nbsp;<span class="op" id="3808796">==</span>&nbsp;<span class="string" id="3808799">&#34;CONNECT&#34;</span>&nbsp;<span class="op" id="3808809">&amp;&amp;</span>&nbsp;<span class="op" id="3808812">!</span><span class="ident" id="3808813"><a href="/net/http/request.go.html#3789636">strings</a></span><span class="op" id="3808820">.</span><span class="ident" id="3808821">HasPrefix</span><span class="op" id="3808830">(</span><span class="ident" id="3808831"><a href="/net/http/request.go.html#3808036">rawurl</a></span><span class="op" id="3808837">,</span>&nbsp;<span class="string" id="3808839">&#34;/&#34;</span><span class="op" id="3808842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808845">if</span>&nbsp;<span class="ident" id="3808848"><a href="/net/http/request.go.html#3808768">justAuthority</a></span>&nbsp;<span class="op" id="3808862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808866"><a href="/net/http/request.go.html#3808036">rawurl</a></span>&nbsp;<span class="op" id="3808873">=</span>&nbsp;<span class="string" id="3808875">&#34;http://&#34;</span>&nbsp;<span class="op" id="3808885">+</span>&nbsp;<span class="ident" id="3808887"><a href="/net/http/request.go.html#3808036">rawurl</a></span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808899">if</span>&nbsp;<span class="ident" id="3808902"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3808905">.</span><span class="ident" id="3808906">URL</span><span class="op" id="3808909">,</span>&nbsp;<span class="ident" id="3808911"><a href="/net/http/request.go.html#3807603">err</a></span>&nbsp;<span class="op" id="3808915">=</span>&nbsp;<span class="ident" id="3808917"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3808920">.</span><span class="ident" id="3808921">ParseRequestURI</span><span class="op" id="3808936">(</span><span class="ident" id="3808937"><a href="/net/http/request.go.html#3808036">rawurl</a></span><span class="op" id="3808943">)</span><span class="op" id="3808944">;</span>&nbsp;<span class="ident" id="3808946"><a href="/net/http/request.go.html#3807603">err</a></span>&nbsp;<span class="op" id="3808950">!=</span>&nbsp;<span class="ident" id="3808953">nil</span>&nbsp;<span class="op" id="3808957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808961">return</span>&nbsp;<span class="ident" id="3808968">nil</span><span class="op" id="3808971">,</span>&nbsp;<span class="ident" id="3808973"><a href="/net/http/request.go.html#3807603">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808978">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808982">if</span>&nbsp;<span class="ident" id="3808985"><a href="/net/http/request.go.html#3808768">justAuthority</a></span>&nbsp;<span class="op" id="3808999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3809003">//&nbsp;Strip&nbsp;the&nbsp;bogus&nbsp;&#34;http://&#34;&nbsp;back&nbsp;off.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809044"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809047">.</span><span class="ident" id="3809048">URL</span><span class="op" id="3809051">.</span><span class="ident" id="3809052">Scheme</span>&nbsp;<span class="op" id="3809059">=</span>&nbsp;<span class="string" id="3809061">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3809065">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3809069">//&nbsp;Subsequent&nbsp;lines:&nbsp;Key:&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809103">mimeHeader</span><span class="op" id="3809113">,</span>&nbsp;<span class="ident" id="3809115"><a href="/net/http/request.go.html#3807603">err</a></span>&nbsp;<span class="op" id="3809119">:=</span>&nbsp;<span class="ident" id="3809122"><a href="/net/http/request.go.html#3807618">tp</a></span><span class="op" id="3809124">.</span><span class="ident" id="3809125">ReadMIMEHeader</span><span class="op" id="3809139">(</span><span class="op" id="3809140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809143">if</span>&nbsp;<span class="ident" id="3809146"><a href="/net/http/request.go.html#3807603">err</a></span>&nbsp;<span class="op" id="3809150">!=</span>&nbsp;<span class="ident" id="3809153">nil</span>&nbsp;<span class="op" id="3809157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809161">return</span>&nbsp;<span class="ident" id="3809168">nil</span><span class="op" id="3809171">,</span>&nbsp;<span class="ident" id="3809173"><a href="/net/http/request.go.html#3807603">err</a></span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3809178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809181"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809184">.</span><span class="ident" id="3809185">Header</span>&nbsp;<span class="op" id="3809192">=</span>&nbsp;<span class="ident" id="3809194"><a href="/net/http/header.go.html#3781581">Header</a></span><span class="op" id="3809200">(</span><span class="ident" id="3809201"><a href="/net/http/request.go.html#3809103">mimeHeader</a></span><span class="op" id="3809211">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3809215">//&nbsp;RFC2616:&nbsp;Must&nbsp;treat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3809239">//&nbsp;&nbsp;&nbsp;&nbspGET&nbsp;/index.html&nbsp;HTTP/1.1</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3809268">//&nbsp;&nbsp;&nbsp;&nbspHost:&nbsp;www.google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3809293">//&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3809301">//&nbsp;&nbsp;&nbsp;&nbspGET&nbsp;http://www.google.com/index.html&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3809351">//&nbsp;&nbsp;&nbsp;&nbspHost:&nbsp;doesntmatter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3809374">//&nbsp;the&nbsp;same.&nbsp;&nbsp;In&nbsp;the&nbsp;second&nbsp;case,&nbsp;any&nbsp;Host&nbsp;line&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809435"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809438">.</span><span class="ident" id="3809439">Host</span>&nbsp;<span class="op" id="3809444">=</span>&nbsp;<span class="ident" id="3809446"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809449">.</span><span class="ident" id="3809450">URL</span><span class="op" id="3809453">.</span><span class="ident" id="3809454">Host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809460">if</span>&nbsp;<span class="ident" id="3809463"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809466">.</span><span class="ident" id="3809467">Host</span>&nbsp;<span class="op" id="3809472">==</span>&nbsp;<span class="string" id="3809475">&#34;&#34;</span>&nbsp;<span class="op" id="3809478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809482"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809485">.</span><span class="ident" id="3809486">Host</span>&nbsp;<span class="op" id="3809491">=</span>&nbsp;<span class="ident" id="3809493"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809496">.</span><span class="ident" id="3809497">Header</span><span class="op" id="3809503">.</span><span class="ident" id="3809504">get</span><span class="op" id="3809507">(</span><span class="string" id="3809508">&#34;Host&#34;</span><span class="op" id="3809514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3809517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3809520">delete</span><span class="op" id="3809526">(</span><span class="ident" id="3809527"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809530">.</span><span class="ident" id="3809531">Header</span><span class="op" id="3809537">,</span>&nbsp;<span class="string" id="3809539">&#34;Host&#34;</span><span class="op" id="3809545">)</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809549"><a href="/net/http/response.go.html#3821417">fixPragmaCacheControl</a></span><span class="op" id="3809570">(</span><span class="ident" id="3809571"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809574">.</span><span class="ident" id="3809575">Header</span><span class="op" id="3809581">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809585"><a href="/net/http/request.go.html#3807603">err</a></span>&nbsp;<span class="op" id="3809589">=</span>&nbsp;<span class="ident" id="3809591"><a href="/net/http/transfer.go.html#3903260">readTransfer</a></span><span class="op" id="3809603">(</span><span class="ident" id="3809604"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809607">,</span>&nbsp;<span class="ident" id="3809609"><a href="/net/http/request.go.html#3807571">b</a></span><span class="op" id="3809610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809613">if</span>&nbsp;<span class="ident" id="3809616"><a href="/net/http/request.go.html#3807603">err</a></span>&nbsp;<span class="op" id="3809620">!=</span>&nbsp;<span class="ident" id="3809623">nil</span>&nbsp;<span class="op" id="3809627">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809631">return</span>&nbsp;<span class="ident" id="3809638">nil</span><span class="op" id="3809641">,</span>&nbsp;<span class="ident" id="3809643"><a href="/net/http/request.go.html#3807603">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3809648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809652"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809655">.</span><span class="ident" id="3809656">Close</span>&nbsp;<span class="op" id="3809662">=</span>&nbsp;<span class="ident" id="3809664"><a href="/net/http/transfer.go.html#3909011">shouldClose</a></span><span class="op" id="3809675">(</span><span class="ident" id="3809676"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809679">.</span><span class="ident" id="3809680">ProtoMajor</span><span class="op" id="3809690">,</span>&nbsp;<span class="ident" id="3809692"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809695">.</span><span class="ident" id="3809696">ProtoMinor</span><span class="op" id="3809706">,</span>&nbsp;<span class="ident" id="3809708"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809711">.</span><span class="ident" id="3809712">Header</span><span class="op" id="3809718">,</span>&nbsp;<span class="ident" id="3809720">false</span><span class="op" id="3809725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809728">return</span>&nbsp;<span class="ident" id="3809735"><a href="/net/http/request.go.html#3807589">req</a></span><span class="op" id="3809738">,</span>&nbsp;<span class="ident" id="3809740">nil</span><br>
<span class="lineno">670</span><span class="op" id="3809744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3809747">//&nbsp;MaxBytesReader&nbsp;is&nbsp;similar&nbsp;to&nbsp;io.LimitReader&nbsp;but&nbsp;is&nbsp;intended&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3809814">//&nbsp;limiting&nbsp;the&nbsp;size&nbsp;of&nbsp;incoming&nbsp;request&nbsp;bodies.&nbsp;In&nbsp;contrast&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3809878">//&nbsp;io.LimitReader,&nbsp;MaxBytesReader&#39;s&nbsp;result&nbsp;is&nbsp;a&nbsp;ReadCloser,&nbsp;returns&nbsp;a</span><br>
<span class="lineno">675</span><span class="comment" id="3809948">//&nbsp;non-EOF&nbsp;error&nbsp;for&nbsp;a&nbsp;Read&nbsp;beyond&nbsp;the&nbsp;limit,&nbsp;and&nbsp;Closes&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3810009">//&nbsp;underlying&nbsp;reader&nbsp;when&nbsp;its&nbsp;Close&nbsp;method&nbsp;is&nbsp;called.</span><br>
<span class="lineno"></span><span class="comment" id="3810063">//</span><br>
<span class="lineno"></span><span class="comment" id="3810066">//&nbsp;MaxBytesReader&nbsp;prevents&nbsp;clients&nbsp;from&nbsp;accidentally&nbsp;or&nbsp;maliciously</span><br>
<span class="lineno"></span><span class="comment" id="3810134">//&nbsp;sending&nbsp;a&nbsp;large&nbsp;request&nbsp;and&nbsp;wasting&nbsp;server&nbsp;resources.</span><br>
<span class="lineno">680</span><span class="keyword" id="3810191">func</span>&nbsp;<span class="ident" id="3810196">MaxBytesReader</span><span class="op" id="3810210">(</span><span class="ident" id="3810211">w</span>&nbsp;<span class="ident" id="3810213"><a href="/net/http/server.go.html#3826033">ResponseWriter</a></span><span class="op" id="3810227">,</span>&nbsp;<span class="ident" id="3810229">r</span>&nbsp;<span class="ident" id="3810231"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3810233">.</span><span class="ident" id="3810234">ReadCloser</span><span class="op" id="3810244">,</span>&nbsp;<span class="ident" id="3810246">n</span>&nbsp;<span class="ident" id="3810248">int64</span><span class="op" id="3810253">)</span>&nbsp;<span class="ident" id="3810255"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3810257">.</span><span class="ident" id="3810258">ReadCloser</span>&nbsp;<span class="op" id="3810269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810272">return</span>&nbsp;<span class="op" id="3810279">&amp;</span><span class="ident" id="3810280"><a href="/net/http/request.go.html#3810321">maxBytesReader</a></span><span class="op" id="3810294">{</span><span class="ident" id="3810295">w</span><span class="op" id="3810296">:</span>&nbsp;<span class="ident" id="3810298"><a href="/net/http/request.go.html#3810211">w</a></span><span class="op" id="3810299">,</span>&nbsp;<span class="ident" id="3810301">r</span><span class="op" id="3810302">:</span>&nbsp;<span class="ident" id="3810304"><a href="/net/http/request.go.html#3810229">r</a></span><span class="op" id="3810305">,</span>&nbsp;<span class="ident" id="3810307">n</span><span class="op" id="3810308">:</span>&nbsp;<span class="ident" id="3810310"><a href="/net/http/request.go.html#3810246">n</a></span><span class="op" id="3810311">}</span><br>
<span class="lineno"></span><span class="op" id="3810313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3810316">type</span>&nbsp;<span class="ident" id="3810321">maxBytesReader</span>&nbsp;<span class="keyword" id="3810336">struct</span>&nbsp;<span class="op" id="3810343">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810346">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810354"><a href="/net/http/server.go.html#3826033">ResponseWriter</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810370">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810378"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3810380">.</span><span class="ident" id="3810381">ReadCloser</span>&nbsp;<span class="comment" id="3810392">//&nbsp;underlying&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810414">n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3810422">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3810436">//&nbsp;max&nbsp;bytes&nbsp;remaining</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810460">stopped</span>&nbsp;<span class="builtintype" id="3810468">bool</span><br>
<span class="lineno"></span><span class="op" id="3810473">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="keyword" id="3810476">func</span>&nbsp;<span class="op" id="3810481">(</span><span class="ident" id="3810482">l</span>&nbsp;<span class="op" id="3810484">*</span><span class="ident" id="3810485"><a href="/net/http/request.go.html#3810321">maxBytesReader</a></span><span class="op" id="3810499">)</span>&nbsp;<span class="ident" id="3810501">Read</span><span class="op" id="3810505">(</span><span class="ident" id="3810506">p</span>&nbsp;<span class="op" id="3810508">[</span><span class="op" id="3810509">]</span><span class="builtintype" id="3810510">byte</span><span class="op" id="3810514">)</span>&nbsp;<span class="op" id="3810516">(</span><span class="ident" id="3810517">n</span>&nbsp;<span class="builtintype" id="3810519">int</span><span class="op" id="3810522">,</span>&nbsp;<span class="ident" id="3810524">err</span>&nbsp;<span class="builtintype" id="3810528">error</span><span class="op" id="3810533">)</span>&nbsp;<span class="op" id="3810535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810538">if</span>&nbsp;<span class="ident" id="3810541"><a href="/net/http/request.go.html#3810482">l</a></span><span class="op" id="3810542">.</span><span class="ident" id="3810543">n</span>&nbsp;<span class="op" id="3810545">&lt;=</span>&nbsp;<span class="num" id="3810548">0</span>&nbsp;<span class="op" id="3810550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810554">if</span>&nbsp;<span class="op" id="3810557">!</span><span class="ident" id="3810558"><a href="/net/http/request.go.html#3810482">l</a></span><span class="op" id="3810559">.</span><span class="ident" id="3810560">stopped</span>&nbsp;<span class="op" id="3810568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810573"><a href="/net/http/request.go.html#3810482">l</a></span><span class="op" id="3810574">.</span><span class="ident" id="3810575">stopped</span>&nbsp;<span class="op" id="3810583">=</span>&nbsp;<span class="ident" id="3810585">true</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810593">if</span>&nbsp;<span class="ident" id="3810596">res</span><span class="op" id="3810599">,</span>&nbsp;<span class="ident" id="3810601">ok</span>&nbsp;<span class="op" id="3810604">:=</span>&nbsp;<span class="ident" id="3810607"><a href="/net/http/request.go.html#3810482">l</a></span><span class="op" id="3810608">.</span><span class="ident" id="3810609">w</span><span class="op" id="3810610">.</span><span class="op" id="3810611">(</span><span class="op" id="3810612">*</span><span class="ident" id="3810613"><a href="/net/http/server.go.html#3833137">response</a></span><span class="op" id="3810621">)</span><span class="op" id="3810622">;</span>&nbsp;<span class="ident" id="3810624"><a href="/net/http/request.go.html#3810601">ok</a></span>&nbsp;<span class="op" id="3810627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810633"><a href="/net/http/request.go.html#3810596">res</a></span><span class="op" id="3810636">.</span><span class="ident" id="3810637">requestTooLarge</span><span class="op" id="3810652">(</span><span class="op" id="3810653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3810658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3810662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810666">return</span>&nbsp;<span class="num" id="3810673">0</span><span class="op" id="3810674">,</span>&nbsp;<span class="ident" id="3810676"><a href="/net/http/request.go.html#3789535">errors</a></span><span class="op" id="3810682">.</span><span class="ident" id="3810683">New</span><span class="op" id="3810686">(</span><span class="string" id="3810687">&#34;http:&nbsp;request&nbsp;body&nbsp;too&nbsp;large&#34;</span><span class="op" id="3810717">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3810720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810723">if</span>&nbsp;<span class="ident" id="3810726">int64</span><span class="op" id="3810731">(</span><span class="builtinfunc" id="3810732">len</span><span class="op" id="3810735">(</span><span class="ident" id="3810736"><a href="/net/http/request.go.html#3810506">p</a></span><span class="op" id="3810737">)</span><span class="op" id="3810738">)</span>&nbsp;<span class="op" id="3810740">&gt;</span>&nbsp;<span class="ident" id="3810742"><a href="/net/http/request.go.html#3810482">l</a></span><span class="op" id="3810743">.</span><span class="ident" id="3810744">n</span>&nbsp;<span class="op" id="3810746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810750"><a href="/net/http/request.go.html#3810506">p</a></span>&nbsp;<span class="op" id="3810752">=</span>&nbsp;<span class="ident" id="3810754"><a href="/net/http/request.go.html#3810506">p</a></span><span class="op" id="3810755">[</span><span class="op" id="3810756">:</span><span class="ident" id="3810757"><a href="/net/http/request.go.html#3810482">l</a></span><span class="op" id="3810758">.</span><span class="ident" id="3810759">n</span><span class="op" id="3810760">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3810763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810766"><a href="/net/http/request.go.html#3810517">n</a></span><span class="op" id="3810767">,</span>&nbsp;<span class="ident" id="3810769"><a href="/net/http/request.go.html#3810524">err</a></span>&nbsp;<span class="op" id="3810773">=</span>&nbsp;<span class="ident" id="3810775"><a href="/net/http/request.go.html#3810482">l</a></span><span class="op" id="3810776">.</span><span class="ident" id="3810777">r</span><span class="op" id="3810778">.</span><span class="ident" id="3810779">Read</span><span class="op" id="3810783">(</span><span class="ident" id="3810784"><a href="/net/http/request.go.html#3810506">p</a></span><span class="op" id="3810785">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810788"><a href="/net/http/request.go.html#3810482">l</a></span><span class="op" id="3810789">.</span><span class="ident" id="3810790">n</span>&nbsp;<span class="op" id="3810792">-=</span>&nbsp;<span class="ident" id="3810795">int64</span><span class="op" id="3810800">(</span><span class="ident" id="3810801"><a href="/net/http/request.go.html#3810517">n</a></span><span class="op" id="3810802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810805">return</span><br>
<span class="lineno"></span><span class="op" id="3810812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3810815">func</span>&nbsp;<span class="op" id="3810820">(</span><span class="ident" id="3810821">l</span>&nbsp;<span class="op" id="3810823">*</span><span class="ident" id="3810824"><a href="/net/http/request.go.html#3810321">maxBytesReader</a></span><span class="op" id="3810838">)</span>&nbsp;<span class="ident" id="3810840">Close</span><span class="op" id="3810845">(</span><span class="op" id="3810846">)</span>&nbsp;<span class="builtintype" id="3810848">error</span>&nbsp;<span class="op" id="3810854">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810857">return</span>&nbsp;<span class="ident" id="3810864"><a href="/net/http/request.go.html#3810821">l</a></span><span class="op" id="3810865">.</span><span class="ident" id="3810866">r</span><span class="op" id="3810867">.</span><span class="ident" id="3810868">Close</span><span class="op" id="3810873">(</span><span class="op" id="3810874">)</span><br>
<span class="lineno"></span><span class="op" id="3810876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3810879">func</span>&nbsp;<span class="ident" id="3810884">copyValues</span><span class="op" id="3810894">(</span><span class="ident" id="3810895">dst</span><span class="op" id="3810898">,</span>&nbsp;<span class="ident" id="3810900">src</span>&nbsp;<span class="ident" id="3810904"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3810907">.</span><span class="ident" id="3810908">Values</span><span class="op" id="3810914">)</span>&nbsp;<span class="op" id="3810916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810919">for</span>&nbsp;<span class="ident" id="3810923">k</span><span class="op" id="3810924">,</span>&nbsp;<span class="ident" id="3810926">vs</span>&nbsp;<span class="op" id="3810929">:=</span>&nbsp;<span class="keyword" id="3810932">range</span>&nbsp;<span class="ident" id="3810938"><a href="/net/http/request.go.html#3810900">src</a></span>&nbsp;<span class="op" id="3810942">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810946">for</span>&nbsp;<span class="ident" id="3810950">_</span><span class="op" id="3810951">,</span>&nbsp;<span class="ident" id="3810953">value</span>&nbsp;<span class="op" id="3810959">:=</span>&nbsp;<span class="keyword" id="3810962">range</span>&nbsp;<span class="ident" id="3810968"><a href="/net/http/request.go.html#3810926">vs</a></span>&nbsp;<span class="op" id="3810971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3810976"><a href="/net/http/request.go.html#3810895">dst</a></span><span class="op" id="3810979">.</span><span class="ident" id="3810980">Add</span><span class="op" id="3810983">(</span><span class="ident" id="3810984"><a href="/net/http/request.go.html#3810923">k</a></span><span class="op" id="3810985">,</span>&nbsp;<span class="ident" id="3810987"><a href="/net/http/request.go.html#3810953">value</a></span><span class="op" id="3810992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3810996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3810999">}</span><br>
<span class="lineno"></span><span class="op" id="3811001">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="3811004">func</span>&nbsp;<span class="ident" id="3811009">parsePostForm</span><span class="op" id="3811022">(</span><span class="ident" id="3811023">r</span>&nbsp;<span class="op" id="3811025">*</span><span class="ident" id="3811026"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3811033">)</span>&nbsp;<span class="op" id="3811035">(</span><span class="ident" id="3811036">vs</span>&nbsp;<span class="ident" id="3811039"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3811042">.</span><span class="ident" id="3811043">Values</span><span class="op" id="3811049">,</span>&nbsp;<span class="ident" id="3811051">err</span>&nbsp;<span class="builtintype" id="3811055">error</span><span class="op" id="3811060">)</span>&nbsp;<span class="op" id="3811062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811065">if</span>&nbsp;<span class="ident" id="3811068"><a href="/net/http/request.go.html#3811023">r</a></span><span class="op" id="3811069">.</span><span class="ident" id="3811070">Body</span>&nbsp;<span class="op" id="3811075">==</span>&nbsp;<span class="ident" id="3811078">nil</span>&nbsp;<span class="op" id="3811082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811086"><a href="/net/http/request.go.html#3811051">err</a></span>&nbsp;<span class="op" id="3811090">=</span>&nbsp;<span class="ident" id="3811092"><a href="/net/http/request.go.html#3789535">errors</a></span><span class="op" id="3811098">.</span><span class="ident" id="3811099">New</span><span class="op" id="3811102">(</span><span class="string" id="3811103">&#34;missing&nbsp;form&nbsp;body&#34;</span><span class="op" id="3811122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811126">return</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3811134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811137">ct</span>&nbsp;<span class="op" id="3811140">:=</span>&nbsp;<span class="ident" id="3811143"><a href="/net/http/request.go.html#3811023">r</a></span><span class="op" id="3811144">.</span><span class="ident" id="3811145">Header</span><span class="op" id="3811151">.</span><span class="ident" id="3811152">Get</span><span class="op" id="3811155">(</span><span class="string" id="3811156">&#34;Content-Type&#34;</span><span class="op" id="3811170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3811173">//&nbsp;RFC&nbsp;2616,&nbsp;section&nbsp;7.2.1&nbsp;-&nbsp;empty&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3811214">//&nbsp;&nbsp;&nbsp;SHOULD&nbsp;be&nbsp;treated&nbsp;as&nbsp;application/octet-stream</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811266">if</span>&nbsp;<span class="ident" id="3811269"><a href="/net/http/request.go.html#3811137">ct</a></span>&nbsp;<span class="op" id="3811272">==</span>&nbsp;<span class="string" id="3811275">&#34;&#34;</span>&nbsp;<span class="op" id="3811278">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811282"><a href="/net/http/request.go.html#3811137">ct</a></span>&nbsp;<span class="op" id="3811285">=</span>&nbsp;<span class="string" id="3811287">&#34;application/octet-stream&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3811315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811318"><a href="/net/http/request.go.html#3811137">ct</a></span><span class="op" id="3811320">,</span>&nbsp;<span class="ident" id="3811322">_</span><span class="op" id="3811323">,</span>&nbsp;<span class="ident" id="3811325"><a href="/net/http/request.go.html#3811051">err</a></span>&nbsp;<span class="op" id="3811329">=</span>&nbsp;<span class="ident" id="3811331"><a href="/net/http/request.go.html#3789571">mime</a></span><span class="op" id="3811335">.</span><span class="ident" id="3811336">ParseMediaType</span><span class="op" id="3811350">(</span><span class="ident" id="3811351"><a href="/net/http/request.go.html#3811137">ct</a></span><span class="op" id="3811353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811356">switch</span>&nbsp;<span class="op" id="3811363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811366">case</span>&nbsp;<span class="ident" id="3811371"><a href="/net/http/request.go.html#3811137">ct</a></span>&nbsp;<span class="op" id="3811374">==</span>&nbsp;<span class="string" id="3811377">&#34;application/x-www-form-urlencoded&#34;</span><span class="op" id="3811412">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811416">var</span>&nbsp;<span class="ident" id="3811420">reader</span>&nbsp;<span class="ident" id="3811427"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3811429">.</span><span class="ident" id="3811430">Reader</span>&nbsp;<span class="op" id="3811437">=</span>&nbsp;<span class="ident" id="3811439"><a href="/net/http/request.go.html#3811023">r</a></span><span class="op" id="3811440">.</span><span class="ident" id="3811441">Body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811448">maxFormSize</span>&nbsp;<span class="op" id="3811460">:=</span>&nbsp;<span class="ident" id="3811463">int64</span><span class="op" id="3811468">(</span><span class="num" id="3811469">1</span><span class="op" id="3811470">&lt;&lt;</span><span class="num" id="3811472">63</span>&nbsp;<span class="op" id="3811475">-</span>&nbsp;<span class="num" id="3811477">1</span><span class="op" id="3811478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811482">if</span>&nbsp;<span class="ident" id="3811485">_</span><span class="op" id="3811486">,</span>&nbsp;<span class="ident" id="3811488">ok</span>&nbsp;<span class="op" id="3811491">:=</span>&nbsp;<span class="ident" id="3811494"><a href="/net/http/request.go.html#3811023">r</a></span><span class="op" id="3811495">.</span><span class="ident" id="3811496">Body</span><span class="op" id="3811500">.</span><span class="op" id="3811501">(</span><span class="op" id="3811502">*</span><span class="ident" id="3811503"><a href="/net/http/request.go.html#3810321">maxBytesReader</a></span><span class="op" id="3811517">)</span><span class="op" id="3811518">;</span>&nbsp;<span class="op" id="3811520">!</span><span class="ident" id="3811521"><a href="/net/http/request.go.html#3811488">ok</a></span>&nbsp;<span class="op" id="3811524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811529"><a href="/net/http/request.go.html#3811448">maxFormSize</a></span>&nbsp;<span class="op" id="3811541">=</span>&nbsp;<span class="ident" id="3811543">int64</span><span class="op" id="3811548">(</span><span class="num" id="3811549">10</span>&nbsp;<span class="op" id="3811552">&lt;&lt;</span>&nbsp;<span class="num" id="3811555">20</span><span class="op" id="3811557">)</span>&nbsp;<span class="comment" id="3811559">//&nbsp;10&nbsp;MB&nbsp;is&nbsp;a&nbsp;lot&nbsp;of&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811589"><a href="/net/http/request.go.html#3811420">reader</a></span>&nbsp;<span class="op" id="3811596">=</span>&nbsp;<span class="ident" id="3811598"><a href="/net/http/request.go.html#3789552">io</a></span><span class="op" id="3811600">.</span><span class="ident" id="3811601">LimitReader</span><span class="op" id="3811612">(</span><span class="ident" id="3811613"><a href="/net/http/request.go.html#3811023">r</a></span><span class="op" id="3811614">.</span><span class="ident" id="3811615">Body</span><span class="op" id="3811619">,</span>&nbsp;<span class="ident" id="3811621"><a href="/net/http/request.go.html#3811448">maxFormSize</a></span><span class="op" id="3811632">+</span><span class="num" id="3811633">1</span><span class="op" id="3811634">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3811638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811642">b</span><span class="op" id="3811643">,</span>&nbsp;<span class="ident" id="3811645">e</span>&nbsp;<span class="op" id="3811647">:=</span>&nbsp;<span class="ident" id="3811650"><a href="/net/http/request.go.html#3789558">ioutil</a></span><span class="op" id="3811656">.</span><span class="ident" id="3811657">ReadAll</span><span class="op" id="3811664">(</span><span class="ident" id="3811665"><a href="/net/http/request.go.html#3811420">reader</a></span><span class="op" id="3811671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811675">if</span>&nbsp;<span class="ident" id="3811678"><a href="/net/http/request.go.html#3811645">e</a></span>&nbsp;<span class="op" id="3811680">!=</span>&nbsp;<span class="ident" id="3811683">nil</span>&nbsp;<span class="op" id="3811687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811692">if</span>&nbsp;<span class="ident" id="3811695"><a href="/net/http/request.go.html#3811051">err</a></span>&nbsp;<span class="op" id="3811699">==</span>&nbsp;<span class="ident" id="3811702">nil</span>&nbsp;<span class="op" id="3811706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811712"><a href="/net/http/request.go.html#3811051">err</a></span>&nbsp;<span class="op" id="3811716">=</span>&nbsp;<span class="ident" id="3811718"><a href="/net/http/request.go.html#3811645">e</a></span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3811723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811728">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3811736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811740">if</span>&nbsp;<span class="ident" id="3811743">int64</span><span class="op" id="3811748">(</span><span class="builtinfunc" id="3811749">len</span><span class="op" id="3811752">(</span><span class="ident" id="3811753"><a href="/net/http/request.go.html#3811642">b</a></span><span class="op" id="3811754">)</span><span class="op" id="3811755">)</span>&nbsp;<span class="op" id="3811757">&gt;</span>&nbsp;<span class="ident" id="3811759"><a href="/net/http/request.go.html#3811448">maxFormSize</a></span>&nbsp;<span class="op" id="3811771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811776"><a href="/net/http/request.go.html#3811051">err</a></span>&nbsp;<span class="op" id="3811780">=</span>&nbsp;<span class="ident" id="3811782"><a href="/net/http/request.go.html#3789535">errors</a></span><span class="op" id="3811788">.</span><span class="ident" id="3811789">New</span><span class="op" id="3811792">(</span><span class="string" id="3811793">&#34;http:&nbsp;POST&nbsp;too&nbsp;large&#34;</span><span class="op" id="3811815">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811820">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3811829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811833"><a href="/net/http/request.go.html#3811036">vs</a></span><span class="op" id="3811835">,</span>&nbsp;<span class="ident" id="3811837"><a href="/net/http/request.go.html#3811645">e</a></span>&nbsp;<span class="op" id="3811839">=</span>&nbsp;<span class="ident" id="3811841"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3811844">.</span><span class="ident" id="3811845">ParseQuery</span><span class="op" id="3811855">(</span><span class="builtintype" id="3811856">string</span><span class="op" id="3811862">(</span><span class="ident" id="3811863"><a href="/net/http/request.go.html#3811642">b</a></span><span class="op" id="3811864">)</span><span class="op" id="3811865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811869">if</span>&nbsp;<span class="ident" id="3811872"><a href="/net/http/request.go.html#3811051">err</a></span>&nbsp;<span class="op" id="3811876">==</span>&nbsp;<span class="ident" id="3811879">nil</span>&nbsp;<span class="op" id="3811883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3811888"><a href="/net/http/request.go.html#3811051">err</a></span>&nbsp;<span class="op" id="3811892">=</span>&nbsp;<span class="ident" id="3811894"><a href="/net/http/request.go.html#3811645">e</a></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3811898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3811901">case</span>&nbsp;<span class="ident" id="3811906"><a href="/net/http/request.go.html#3811137">ct</a></span>&nbsp;<span class="op" id="3811909">==</span>&nbsp;<span class="string" id="3811912">&#34;multipart/form-data&#34;</span><span class="op" id="3811933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3811937">//&nbsp;handled&nbsp;by&nbsp;ParseMultipartForm&nbsp;(which&nbsp;is&nbsp;calling&nbsp;us,&nbsp;or&nbsp;should&nbsp;be)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3812008">//&nbsp;TODO(bradfitz):&nbsp;there&nbsp;are&nbsp;too&nbsp;many&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3812057">//&nbsp;orders&nbsp;to&nbsp;call&nbsp;too&nbsp;many&nbsp;functions&nbsp;here.</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3812102">//&nbsp;Clean&nbsp;this&nbsp;up&nbsp;and&nbsp;write&nbsp;more&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3812143">//&nbsp;request_test.go&nbsp;contains&nbsp;the&nbsp;start&nbsp;of&nbsp;this,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3812192">//&nbsp;in&nbsp;TestParseMultipartFormOrder&nbsp;and&nbsp;others.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3812239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3812242">return</span><br>
<span class="lineno">765</span><span class="op" id="3812249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3812252">//&nbsp;ParseForm&nbsp;parses&nbsp;the&nbsp;raw&nbsp;query&nbsp;from&nbsp;the&nbsp;URL&nbsp;and&nbsp;updates&nbsp;r.Form.</span><br>
<span class="lineno"></span><span class="comment" id="3812319">//</span><br>
<span class="lineno"></span><span class="comment" id="3812322">//&nbsp;For&nbsp;POST&nbsp;or&nbsp;PUT&nbsp;requests,&nbsp;it&nbsp;also&nbsp;parses&nbsp;the&nbsp;request&nbsp;body&nbsp;as&nbsp;a&nbsp;form&nbsp;and</span><br>
<span class="lineno">770</span><span class="comment" id="3812397">//&nbsp;put&nbsp;the&nbsp;results&nbsp;into&nbsp;both&nbsp;r.PostForm&nbsp;and&nbsp;r.Form.</span><br>
<span class="lineno"></span><span class="comment" id="3812449">//&nbsp;POST&nbsp;and&nbsp;PUT&nbsp;body&nbsp;parameters&nbsp;take&nbsp;precedence&nbsp;over&nbsp;URL&nbsp;query&nbsp;string&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="3812526">//&nbsp;in&nbsp;r.Form.</span><br>
<span class="lineno"></span><span class="comment" id="3812540">//</span><br>
<span class="lineno"></span><span class="comment" id="3812543">//&nbsp;If&nbsp;the&nbsp;request&nbsp;Body&#39;s&nbsp;size&nbsp;has&nbsp;not&nbsp;already&nbsp;been&nbsp;limited&nbsp;by&nbsp;MaxBytesReader,</span><br>
<span class="lineno">775</span><span class="comment" id="3812621">//&nbsp;the&nbsp;size&nbsp;is&nbsp;capped&nbsp;at&nbsp;10MB.</span><br>
<span class="lineno"></span><span class="comment" id="3812652">//</span><br>
<span class="lineno"></span><span class="comment" id="3812655">//&nbsp;ParseMultipartForm&nbsp;calls&nbsp;ParseForm&nbsp;automatically.</span><br>
<span class="lineno"></span><span class="comment" id="3812708">//&nbsp;It&nbsp;is&nbsp;idempotent.</span><br>
<span class="lineno"></span><span class="keyword" id="3812729">func</span>&nbsp;<span class="op" id="3812734">(</span><span class="ident" id="3812735">r</span>&nbsp;<span class="op" id="3812737">*</span><span class="ident" id="3812738"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3812745">)</span>&nbsp;<span class="ident" id="3812747">ParseForm</span><span class="op" id="3812756">(</span><span class="op" id="3812757">)</span>&nbsp;<span class="builtintype" id="3812759">error</span>&nbsp;<span class="op" id="3812765">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3812768">var</span>&nbsp;<span class="ident" id="3812772">err</span>&nbsp;<span class="builtintype" id="3812776">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3812783">if</span>&nbsp;<span class="ident" id="3812786"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3812787">.</span><span class="ident" id="3812788">PostForm</span>&nbsp;<span class="op" id="3812797">==</span>&nbsp;<span class="ident" id="3812800">nil</span>&nbsp;<span class="op" id="3812804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3812808">if</span>&nbsp;<span class="ident" id="3812811"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3812812">.</span><span class="ident" id="3812813">Method</span>&nbsp;<span class="op" id="3812820">==</span>&nbsp;<span class="string" id="3812823">&#34;POST&#34;</span>&nbsp;<span class="op" id="3812830">||</span>&nbsp;<span class="ident" id="3812833"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3812834">.</span><span class="ident" id="3812835">Method</span>&nbsp;<span class="op" id="3812842">==</span>&nbsp;<span class="string" id="3812845">&#34;PUT&#34;</span>&nbsp;<span class="op" id="3812851">||</span>&nbsp;<span class="ident" id="3812854"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3812855">.</span><span class="ident" id="3812856">Method</span>&nbsp;<span class="op" id="3812863">==</span>&nbsp;<span class="string" id="3812866">&#34;PATCH&#34;</span>&nbsp;<span class="op" id="3812874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3812879"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3812880">.</span><span class="ident" id="3812881">PostForm</span><span class="op" id="3812889">,</span>&nbsp;<span class="ident" id="3812891"><a href="/net/http/request.go.html#3812772">err</a></span>&nbsp;<span class="op" id="3812895">=</span>&nbsp;<span class="ident" id="3812897"><a href="/net/http/request.go.html#3811009">parsePostForm</a></span><span class="op" id="3812910">(</span><span class="ident" id="3812911"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3812912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3812916">}</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3812920">if</span>&nbsp;<span class="ident" id="3812923"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3812924">.</span><span class="ident" id="3812925">PostForm</span>&nbsp;<span class="op" id="3812934">==</span>&nbsp;<span class="ident" id="3812937">nil</span>&nbsp;<span class="op" id="3812941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3812946"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3812947">.</span><span class="ident" id="3812948">PostForm</span>&nbsp;<span class="op" id="3812957">=</span>&nbsp;<span class="builtinfunc" id="3812959">make</span><span class="op" id="3812963">(</span><span class="ident" id="3812964"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3812967">.</span><span class="ident" id="3812968">Values</span><span class="op" id="3812974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3812978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3812981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3812984">if</span>&nbsp;<span class="ident" id="3812987"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3812988">.</span><span class="ident" id="3812989">Form</span>&nbsp;<span class="op" id="3812994">==</span>&nbsp;<span class="ident" id="3812997">nil</span>&nbsp;<span class="op" id="3813001">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3813005">if</span>&nbsp;<span class="builtinfunc" id="3813008">len</span><span class="op" id="3813011">(</span><span class="ident" id="3813012"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3813013">.</span><span class="ident" id="3813014">PostForm</span><span class="op" id="3813022">)</span>&nbsp;<span class="op" id="3813024">&gt;</span>&nbsp;<span class="num" id="3813026">0</span>&nbsp;<span class="op" id="3813028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3813033"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3813034">.</span><span class="ident" id="3813035">Form</span>&nbsp;<span class="op" id="3813040">=</span>&nbsp;<span class="builtinfunc" id="3813042">make</span><span class="op" id="3813046">(</span><span class="ident" id="3813047"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3813050">.</span><span class="ident" id="3813051">Values</span><span class="op" id="3813057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3813062"><a href="/net/http/request.go.html#3810884">copyValues</a></span><span class="op" id="3813072">(</span><span class="ident" id="3813073"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3813074">.</span><span class="ident" id="3813075">Form</span><span class="op" id="3813079">,</span>&nbsp;<span class="ident" id="3813081"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3813082">.</span><span class="ident" id="3813083">PostForm</span><span class="op" id="3813091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3813095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3813099">var</span>&nbsp;<span class="ident" id="3813103">newValues</span>&nbsp;<span class="ident" id="3813113"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3813116">.</span><span class="ident" id="3813117">Values</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3813126">if</span>&nbsp;<span class="ident" id="3813129"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3813130">.</span><span class="ident" id="3813131">URL</span>&nbsp;<span class="op" id="3813135">!=</span>&nbsp;<span class="ident" id="3813138">nil</span>&nbsp;<span class="op" id="3813142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3813147">var</span>&nbsp;<span class="ident" id="3813151">e</span>&nbsp;<span class="builtintype" id="3813153">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3813162"><a href="/net/http/request.go.html#3813103">newValues</a></span><span class="op" id="3813171">,</span>&nbsp;<span class="ident" id="3813173"><a href="/net/http/request.go.html#3813151">e</a></span>&nbsp;<span class="op" id="3813175">=</span>&nbsp;<span class="ident" id="3813177"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3813180">.</span><span class="ident" id="3813181">ParseQuery</span><span class="op" id="3813191">(</span><span class="ident" id="3813192"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3813193">.</span><span class="ident" id="3813194">URL</span><span class="op" id="3813197">.</span><span class="ident" id="3813198">RawQuery</span><span class="op" id="3813206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3813211">if</span>&nbsp;<span class="ident" id="3813214"><a href="/net/http/request.go.html#3812772">err</a></span>&nbsp;<span class="op" id="3813218">==</span>&nbsp;<span class="ident" id="3813221">nil</span>&nbsp;<span class="op" id="3813225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3813231"><a href="/net/http/request.go.html#3812772">err</a></span>&nbsp;<span class="op" id="3813235">=</span>&nbsp;<span class="ident" id="3813237"><a href="/net/http/request.go.html#3813151">e</a></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3813242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3813246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3813250">if</span>&nbsp;<span class="ident" id="3813253"><a href="/net/http/request.go.html#3813103">newValues</a></span>&nbsp;<span class="op" id="3813263">==</span>&nbsp;<span class="ident" id="3813266">nil</span>&nbsp;<span class="op" id="3813270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3813275"><a href="/net/http/request.go.html#3813103">newValues</a></span>&nbsp;<span class="op" id="3813285">=</span>&nbsp;<span class="builtinfunc" id="3813287">make</span><span class="op" id="3813291">(</span><span class="ident" id="3813292"><a href="/net/http/request.go.html#3789614">url</a></span><span class="op" id="3813295">.</span><span class="ident" id="3813296">Values</span><span class="op" id="3813302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3813306">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3813310">if</span>&nbsp;<span class="ident" id="3813313"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3813314">.</span><span class="ident" id="3813315">Form</span>&nbsp;<span class="op" id="3813320">==</span>&nbsp;<span class="ident" id="3813323">nil</span>&nbsp;<span class="op" id="3813327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3813332"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3813333">.</span><span class="ident" id="3813334">Form</span>&nbsp;<span class="op" id="3813339">=</span>&nbsp;<span class="ident" id="3813341"><a href="/net/http/request.go.html#3813103">newValues</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3813353">}</span>&nbsp;<span class="keyword" id="3813355">else</span>&nbsp;<span class="op" id="3813360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3813365"><a href="/net/http/request.go.html#3810884">copyValues</a></span><span class="op" id="3813375">(</span><span class="ident" id="3813376"><a href="/net/http/request.go.html#3812735">r</a></span><span class="op" id="3813377">.</span><span class="ident" id="3813378">Form</span><span class="op" id="3813382">,</span>&nbsp;<span class="ident" id="3813384"><a href="/net/http/request.go.html#3813103">newValues</a></span><span class="op" id="3813393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3813397">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3813400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3813403">return</span>&nbsp;<span class="ident" id="3813410"><a href="/net/http/request.go.html#3812772">err</a></span><br>
<span class="lineno"></span><span class="op" id="3813414">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3813417">//&nbsp;ParseMultipartForm&nbsp;parses&nbsp;a&nbsp;request&nbsp;body&nbsp;as&nbsp;multipart/form-data.</span><br>
<span class="lineno">815</span><span class="comment" id="3813485">//&nbsp;The&nbsp;whole&nbsp;request&nbsp;body&nbsp;is&nbsp;parsed&nbsp;and&nbsp;up&nbsp;to&nbsp;a&nbsp;total&nbsp;of&nbsp;maxMemory&nbsp;bytes&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3813561">//&nbsp;its&nbsp;file&nbsp;parts&nbsp;are&nbsp;stored&nbsp;in&nbsp;memory,&nbsp;with&nbsp;the&nbsp;remainder&nbsp;stored&nbsp;on</span><br>
<span class="lineno"></span><span class="comment" id="3813630">//&nbsp;disk&nbsp;in&nbsp;temporary&nbsp;files.</span><br>
<span class="lineno"></span><span class="comment" id="3813658">//&nbsp;ParseMultipartForm&nbsp;calls&nbsp;ParseForm&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno"></span><span class="comment" id="3813710">//&nbsp;After&nbsp;one&nbsp;call&nbsp;to&nbsp;ParseMultipartForm,&nbsp;subsequent&nbsp;calls&nbsp;have&nbsp;no&nbsp;effect.</span><br>
<span class="lineno">820</span><span class="keyword" id="3813784">func</span>&nbsp;<span class="op" id="3813789">(</span><span class="ident" id="3813790">r</span>&nbsp;<span class="op" id="3813792">*</span><span class="ident" id="3813793"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3813800">)</span>&nbsp;<span class="ident" id="3813802">ParseMultipartForm</span><span class="op" id="3813820">(</span><span class="ident" id="3813821">maxMemory</span>&nbsp;<span class="ident" id="3813831">int64</span><span class="op" id="3813836">)</span>&nbsp;<span class="builtintype" id="3813838">error</span>&nbsp;<span class="op" id="3813844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3813847">if</span>&nbsp;<span class="ident" id="3813850"><a href="/net/http/request.go.html#3813790">r</a></span><span class="op" id="3813851">.</span><span class="ident" id="3813852">MultipartForm</span>&nbsp;<span class="op" id="3813866">==</span>&nbsp;<span class="ident" id="3813869"><a href="/net/http/request.go.html#3799404">multipartByReader</a></span>&nbsp;<span class="op" id="3813887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3813891">return</span>&nbsp;<span class="ident" id="3813898"><a href="/net/http/request.go.html#3789535">errors</a></span><span class="op" id="3813904">.</span><span class="ident" id="3813905">New</span><span class="op" id="3813908">(</span><span class="string" id="3813909">&#34;http:&nbsp;multipart&nbsp;handled&nbsp;by&nbsp;MultipartReader&#34;</span><span class="op" id="3813953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3813956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3813959">if</span>&nbsp;<span class="ident" id="3813962"><a href="/net/http/request.go.html#3813790">r</a></span><span class="op" id="3813963">.</span><span class="ident" id="3813964">Form</span>&nbsp;<span class="op" id="3813969">==</span>&nbsp;<span class="ident" id="3813972">nil</span>&nbsp;<span class="op" id="3813976">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3813980">err</span>&nbsp;<span class="op" id="3813984">:=</span>&nbsp;<span class="ident" id="3813987"><a href="/net/http/request.go.html#3813790">r</a></span><span class="op" id="3813988">.</span><span class="ident" id="3813989">ParseForm</span><span class="op" id="3813998">(</span><span class="op" id="3813999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814003">if</span>&nbsp;<span class="ident" id="3814006"><a href="/net/http/request.go.html#3813980">err</a></span>&nbsp;<span class="op" id="3814010">!=</span>&nbsp;<span class="ident" id="3814013">nil</span>&nbsp;<span class="op" id="3814017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814022">return</span>&nbsp;<span class="ident" id="3814029"><a href="/net/http/request.go.html#3813980">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3814035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3814038">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814041">if</span>&nbsp;<span class="ident" id="3814044"><a href="/net/http/request.go.html#3813790">r</a></span><span class="op" id="3814045">.</span><span class="ident" id="3814046">MultipartForm</span>&nbsp;<span class="op" id="3814060">!=</span>&nbsp;<span class="ident" id="3814063">nil</span>&nbsp;<span class="op" id="3814067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814071">return</span>&nbsp;<span class="ident" id="3814078">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3814083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3814087">mr</span><span class="op" id="3814089">,</span>&nbsp;<span class="ident" id="3814091">err</span>&nbsp;<span class="op" id="3814095">:=</span>&nbsp;<span class="ident" id="3814098"><a href="/net/http/request.go.html#3813790">r</a></span><span class="op" id="3814099">.</span><span class="ident" id="3814100">multipartReader</span><span class="op" id="3814115">(</span><span class="op" id="3814116">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814119">if</span>&nbsp;<span class="ident" id="3814122"><a href="/net/http/request.go.html#3814091">err</a></span>&nbsp;<span class="op" id="3814126">!=</span>&nbsp;<span class="ident" id="3814129">nil</span>&nbsp;<span class="op" id="3814133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814137">return</span>&nbsp;<span class="ident" id="3814144"><a href="/net/http/request.go.html#3814091">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3814149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3814153">f</span><span class="op" id="3814154">,</span>&nbsp;<span class="ident" id="3814156"><a href="/net/http/request.go.html#3814091">err</a></span>&nbsp;<span class="op" id="3814160">:=</span>&nbsp;<span class="ident" id="3814163"><a href="/net/http/request.go.html#3814087">mr</a></span><span class="op" id="3814165">.</span><span class="ident" id="3814166">ReadForm</span><span class="op" id="3814174">(</span><span class="ident" id="3814175"><a href="/net/http/request.go.html#3813821">maxMemory</a></span><span class="op" id="3814184">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814187">if</span>&nbsp;<span class="ident" id="3814190"><a href="/net/http/request.go.html#3814091">err</a></span>&nbsp;<span class="op" id="3814194">!=</span>&nbsp;<span class="ident" id="3814197">nil</span>&nbsp;<span class="op" id="3814201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814205">return</span>&nbsp;<span class="ident" id="3814212"><a href="/net/http/request.go.html#3814091">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3814217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814220">for</span>&nbsp;<span class="ident" id="3814224">k</span><span class="op" id="3814225">,</span>&nbsp;<span class="ident" id="3814227">v</span>&nbsp;<span class="op" id="3814229">:=</span>&nbsp;<span class="keyword" id="3814232">range</span>&nbsp;<span class="ident" id="3814238"><a href="/net/http/request.go.html#3814153">f</a></span><span class="op" id="3814239">.</span><span class="ident" id="3814240">Value</span>&nbsp;<span class="op" id="3814246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3814250"><a href="/net/http/request.go.html#3813790">r</a></span><span class="op" id="3814251">.</span><span class="ident" id="3814252">Form</span><span class="op" id="3814256">[</span><span class="ident" id="3814257"><a href="/net/http/request.go.html#3814224">k</a></span><span class="op" id="3814258">]</span>&nbsp;<span class="op" id="3814260">=</span>&nbsp;<span class="builtinfunc" id="3814262">append</span><span class="op" id="3814268">(</span><span class="ident" id="3814269"><a href="/net/http/request.go.html#3813790">r</a></span><span class="op" id="3814270">.</span><span class="ident" id="3814271">Form</span><span class="op" id="3814275">[</span><span class="ident" id="3814276"><a href="/net/http/request.go.html#3814224">k</a></span><span class="op" id="3814277">]</span><span class="op" id="3814278">,</span>&nbsp;<span class="ident" id="3814280"><a href="/net/http/request.go.html#3814227">v</a></span><span class="op" id="3814281">...</span><span class="op" id="3814284">)</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3814287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3814290"><a href="/net/http/request.go.html#3813790">r</a></span><span class="op" id="3814291">.</span><span class="ident" id="3814292">MultipartForm</span>&nbsp;<span class="op" id="3814306">=</span>&nbsp;<span class="ident" id="3814308"><a href="/net/http/request.go.html#3814153">f</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814312">return</span>&nbsp;<span class="ident" id="3814319">nil</span><br>
<span class="lineno"></span><span class="op" id="3814323">}</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span><span class="comment" id="3814326">//&nbsp;FormValue&nbsp;returns&nbsp;the&nbsp;first&nbsp;value&nbsp;for&nbsp;the&nbsp;named&nbsp;component&nbsp;of&nbsp;the&nbsp;query.</span><br>
<span class="lineno"></span><span class="comment" id="3814401">//&nbsp;POST&nbsp;and&nbsp;PUT&nbsp;body&nbsp;parameters&nbsp;take&nbsp;precedence&nbsp;over&nbsp;URL&nbsp;query&nbsp;string&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="3814479">//&nbsp;FormValue&nbsp;calls&nbsp;ParseMultipartForm&nbsp;and&nbsp;ParseForm&nbsp;if&nbsp;necessary&nbsp;and&nbsp;ignores</span><br>
<span class="lineno"></span><span class="comment" id="3814556">//&nbsp;any&nbsp;errors&nbsp;returned&nbsp;by&nbsp;these&nbsp;functions.</span><br>
<span class="lineno">855</span><span class="comment" id="3814599">//&nbsp;To&nbsp;access&nbsp;multiple&nbsp;values&nbsp;of&nbsp;the&nbsp;same&nbsp;key,&nbsp;call&nbsp;ParseForm&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3814664">//&nbsp;then&nbsp;inspect&nbsp;Request.Form&nbsp;directly.</span><br>
<span class="lineno"></span><span class="keyword" id="3814703">func</span>&nbsp;<span class="op" id="3814708">(</span><span class="ident" id="3814709">r</span>&nbsp;<span class="op" id="3814711">*</span><span class="ident" id="3814712"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3814719">)</span>&nbsp;<span class="ident" id="3814721">FormValue</span><span class="op" id="3814730">(</span><span class="ident" id="3814731">key</span>&nbsp;<span class="builtintype" id="3814735">string</span><span class="op" id="3814741">)</span>&nbsp;<span class="builtintype" id="3814743">string</span>&nbsp;<span class="op" id="3814750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814753">if</span>&nbsp;<span class="ident" id="3814756"><a href="/net/http/request.go.html#3814709">r</a></span><span class="op" id="3814757">.</span><span class="ident" id="3814758">Form</span>&nbsp;<span class="op" id="3814763">==</span>&nbsp;<span class="ident" id="3814766">nil</span>&nbsp;<span class="op" id="3814770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3814774"><a href="/net/http/request.go.html#3814709">r</a></span><span class="op" id="3814775">.</span><span class="ident" id="3814776">ParseMultipartForm</span><span class="op" id="3814794">(</span><span class="ident" id="3814795"><a href="/net/http/request.go.html#3789760">defaultMaxMemory</a></span><span class="op" id="3814811">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3814814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814817">if</span>&nbsp;<span class="ident" id="3814820">vs</span>&nbsp;<span class="op" id="3814823">:=</span>&nbsp;<span class="ident" id="3814826"><a href="/net/http/request.go.html#3814709">r</a></span><span class="op" id="3814827">.</span><span class="ident" id="3814828">Form</span><span class="op" id="3814832">[</span><span class="ident" id="3814833"><a href="/net/http/request.go.html#3814731">key</a></span><span class="op" id="3814836">]</span><span class="op" id="3814837">;</span>&nbsp;<span class="builtinfunc" id="3814839">len</span><span class="op" id="3814842">(</span><span class="ident" id="3814843"><a href="/net/http/request.go.html#3814820">vs</a></span><span class="op" id="3814845">)</span>&nbsp;<span class="op" id="3814847">&gt;</span>&nbsp;<span class="num" id="3814849">0</span>&nbsp;<span class="op" id="3814851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814855">return</span>&nbsp;<span class="ident" id="3814862"><a href="/net/http/request.go.html#3814820">vs</a></span><span class="op" id="3814864">[</span><span class="num" id="3814865">0</span><span class="op" id="3814866">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3814869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3814872">return</span>&nbsp;<span class="string" id="3814879">&#34;&#34;</span><br>
<span class="lineno">865</span><span class="op" id="3814882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3814885">//&nbsp;PostFormValue&nbsp;returns&nbsp;the&nbsp;first&nbsp;value&nbsp;for&nbsp;the&nbsp;named&nbsp;component&nbsp;of&nbsp;the&nbsp;POST</span><br>
<span class="lineno"></span><span class="comment" id="3814962">//&nbsp;or&nbsp;PUT&nbsp;request&nbsp;body.&nbsp;URL&nbsp;query&nbsp;parameters&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="3815020">//&nbsp;PostFormValue&nbsp;calls&nbsp;ParseMultipartForm&nbsp;and&nbsp;ParseForm&nbsp;if&nbsp;necessary&nbsp;and&nbsp;ignores</span><br>
<span class="lineno">870</span><span class="comment" id="3815101">//&nbsp;any&nbsp;errors&nbsp;returned&nbsp;by&nbsp;these&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="3815144">func</span>&nbsp;<span class="op" id="3815149">(</span><span class="ident" id="3815150">r</span>&nbsp;<span class="op" id="3815152">*</span><span class="ident" id="3815153"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3815160">)</span>&nbsp;<span class="ident" id="3815162">PostFormValue</span><span class="op" id="3815175">(</span><span class="ident" id="3815176">key</span>&nbsp;<span class="builtintype" id="3815180">string</span><span class="op" id="3815186">)</span>&nbsp;<span class="builtintype" id="3815188">string</span>&nbsp;<span class="op" id="3815195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815198">if</span>&nbsp;<span class="ident" id="3815201"><a href="/net/http/request.go.html#3815150">r</a></span><span class="op" id="3815202">.</span><span class="ident" id="3815203">PostForm</span>&nbsp;<span class="op" id="3815212">==</span>&nbsp;<span class="ident" id="3815215">nil</span>&nbsp;<span class="op" id="3815219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3815223"><a href="/net/http/request.go.html#3815150">r</a></span><span class="op" id="3815224">.</span><span class="ident" id="3815225">ParseMultipartForm</span><span class="op" id="3815243">(</span><span class="ident" id="3815244"><a href="/net/http/request.go.html#3789760">defaultMaxMemory</a></span><span class="op" id="3815260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3815263">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815266">if</span>&nbsp;<span class="ident" id="3815269">vs</span>&nbsp;<span class="op" id="3815272">:=</span>&nbsp;<span class="ident" id="3815275"><a href="/net/http/request.go.html#3815150">r</a></span><span class="op" id="3815276">.</span><span class="ident" id="3815277">PostForm</span><span class="op" id="3815285">[</span><span class="ident" id="3815286"><a href="/net/http/request.go.html#3815176">key</a></span><span class="op" id="3815289">]</span><span class="op" id="3815290">;</span>&nbsp;<span class="builtinfunc" id="3815292">len</span><span class="op" id="3815295">(</span><span class="ident" id="3815296"><a href="/net/http/request.go.html#3815269">vs</a></span><span class="op" id="3815298">)</span>&nbsp;<span class="op" id="3815300">&gt;</span>&nbsp;<span class="num" id="3815302">0</span>&nbsp;<span class="op" id="3815304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815308">return</span>&nbsp;<span class="ident" id="3815315"><a href="/net/http/request.go.html#3815269">vs</a></span><span class="op" id="3815317">[</span><span class="num" id="3815318">0</span><span class="op" id="3815319">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3815322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815325">return</span>&nbsp;<span class="string" id="3815332">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3815335">}</span><br>
<span class="lineno">880</span><br>
<span class="lineno"></span><span class="comment" id="3815338">//&nbsp;FormFile&nbsp;returns&nbsp;the&nbsp;first&nbsp;file&nbsp;for&nbsp;the&nbsp;provided&nbsp;form&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="3815400">//&nbsp;FormFile&nbsp;calls&nbsp;ParseMultipartForm&nbsp;and&nbsp;ParseForm&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno"></span><span class="keyword" id="3815465">func</span>&nbsp;<span class="op" id="3815470">(</span><span class="ident" id="3815471">r</span>&nbsp;<span class="op" id="3815473">*</span><span class="ident" id="3815474"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3815481">)</span>&nbsp;<span class="ident" id="3815483">FormFile</span><span class="op" id="3815491">(</span><span class="ident" id="3815492">key</span>&nbsp;<span class="builtintype" id="3815496">string</span><span class="op" id="3815502">)</span>&nbsp;<span class="op" id="3815504">(</span><span class="ident" id="3815505"><a href="/net/http/request.go.html#3789579">multipart</a></span><span class="op" id="3815514">.</span><span class="ident" id="3815515">File</span><span class="op" id="3815519">,</span>&nbsp;<span class="op" id="3815521">*</span><span class="ident" id="3815522"><a href="/net/http/request.go.html#3789579">multipart</a></span><span class="op" id="3815531">.</span><span class="ident" id="3815532">FileHeader</span><span class="op" id="3815542">,</span>&nbsp;<span class="builtintype" id="3815544">error</span><span class="op" id="3815549">)</span>&nbsp;<span class="op" id="3815551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815554">if</span>&nbsp;<span class="ident" id="3815557"><a href="/net/http/request.go.html#3815471">r</a></span><span class="op" id="3815558">.</span><span class="ident" id="3815559">MultipartForm</span>&nbsp;<span class="op" id="3815573">==</span>&nbsp;<span class="ident" id="3815576"><a href="/net/http/request.go.html#3799404">multipartByReader</a></span>&nbsp;<span class="op" id="3815594">{</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815598">return</span>&nbsp;<span class="ident" id="3815605">nil</span><span class="op" id="3815608">,</span>&nbsp;<span class="ident" id="3815610">nil</span><span class="op" id="3815613">,</span>&nbsp;<span class="ident" id="3815615"><a href="/net/http/request.go.html#3789535">errors</a></span><span class="op" id="3815621">.</span><span class="ident" id="3815622">New</span><span class="op" id="3815625">(</span><span class="string" id="3815626">&#34;http:&nbsp;multipart&nbsp;handled&nbsp;by&nbsp;MultipartReader&#34;</span><span class="op" id="3815670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3815673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815676">if</span>&nbsp;<span class="ident" id="3815679"><a href="/net/http/request.go.html#3815471">r</a></span><span class="op" id="3815680">.</span><span class="ident" id="3815681">MultipartForm</span>&nbsp;<span class="op" id="3815695">==</span>&nbsp;<span class="ident" id="3815698">nil</span>&nbsp;<span class="op" id="3815702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3815706">err</span>&nbsp;<span class="op" id="3815710">:=</span>&nbsp;<span class="ident" id="3815713"><a href="/net/http/request.go.html#3815471">r</a></span><span class="op" id="3815714">.</span><span class="ident" id="3815715">ParseMultipartForm</span><span class="op" id="3815733">(</span><span class="ident" id="3815734"><a href="/net/http/request.go.html#3789760">defaultMaxMemory</a></span><span class="op" id="3815750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815754">if</span>&nbsp;<span class="ident" id="3815757"><a href="/net/http/request.go.html#3815706">err</a></span>&nbsp;<span class="op" id="3815761">!=</span>&nbsp;<span class="ident" id="3815764">nil</span>&nbsp;<span class="op" id="3815768">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815773">return</span>&nbsp;<span class="ident" id="3815780">nil</span><span class="op" id="3815783">,</span>&nbsp;<span class="ident" id="3815785">nil</span><span class="op" id="3815788">,</span>&nbsp;<span class="ident" id="3815790"><a href="/net/http/request.go.html#3815706">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3815796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3815799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815802">if</span>&nbsp;<span class="ident" id="3815805"><a href="/net/http/request.go.html#3815471">r</a></span><span class="op" id="3815806">.</span><span class="ident" id="3815807">MultipartForm</span>&nbsp;<span class="op" id="3815821">!=</span>&nbsp;<span class="ident" id="3815824">nil</span>&nbsp;<span class="op" id="3815828">&amp;&amp;</span>&nbsp;<span class="ident" id="3815831"><a href="/net/http/request.go.html#3815471">r</a></span><span class="op" id="3815832">.</span><span class="ident" id="3815833">MultipartForm</span><span class="op" id="3815846">.</span><span class="ident" id="3815847">File</span>&nbsp;<span class="op" id="3815852">!=</span>&nbsp;<span class="ident" id="3815855">nil</span>&nbsp;<span class="op" id="3815859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815863">if</span>&nbsp;<span class="ident" id="3815866">fhs</span>&nbsp;<span class="op" id="3815870">:=</span>&nbsp;<span class="ident" id="3815873"><a href="/net/http/request.go.html#3815471">r</a></span><span class="op" id="3815874">.</span><span class="ident" id="3815875">MultipartForm</span><span class="op" id="3815888">.</span><span class="ident" id="3815889">File</span><span class="op" id="3815893">[</span><span class="ident" id="3815894"><a href="/net/http/request.go.html#3815492">key</a></span><span class="op" id="3815897">]</span><span class="op" id="3815898">;</span>&nbsp;<span class="builtinfunc" id="3815900">len</span><span class="op" id="3815903">(</span><span class="ident" id="3815904"><a href="/net/http/request.go.html#3815866">fhs</a></span><span class="op" id="3815907">)</span>&nbsp;<span class="op" id="3815909">&gt;</span>&nbsp;<span class="num" id="3815911">0</span>&nbsp;<span class="op" id="3815913">{</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3815918">f</span><span class="op" id="3815919">,</span>&nbsp;<span class="ident" id="3815921">err</span>&nbsp;<span class="op" id="3815925">:=</span>&nbsp;<span class="ident" id="3815928"><a href="/net/http/request.go.html#3815866">fhs</a></span><span class="op" id="3815931">[</span><span class="num" id="3815932">0</span><span class="op" id="3815933">]</span><span class="op" id="3815934">.</span><span class="ident" id="3815935">Open</span><span class="op" id="3815939">(</span><span class="op" id="3815940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815945">return</span>&nbsp;<span class="ident" id="3815952"><a href="/net/http/request.go.html#3815918">f</a></span><span class="op" id="3815953">,</span>&nbsp;<span class="ident" id="3815955"><a href="/net/http/request.go.html#3815866">fhs</a></span><span class="op" id="3815958">[</span><span class="num" id="3815959">0</span><span class="op" id="3815960">]</span><span class="op" id="3815961">,</span>&nbsp;<span class="ident" id="3815963"><a href="/net/http/request.go.html#3815921">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3815969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3815972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3815975">return</span>&nbsp;<span class="ident" id="3815982">nil</span><span class="op" id="3815985">,</span>&nbsp;<span class="ident" id="3815987">nil</span><span class="op" id="3815990">,</span>&nbsp;<span class="ident" id="3815992"><a href="/net/http/request.go.html#3789941">ErrMissingFile</a></span><br>
<span class="lineno">900</span><span class="op" id="3816007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3816010">func</span>&nbsp;<span class="op" id="3816015">(</span><span class="ident" id="3816016">r</span>&nbsp;<span class="op" id="3816018">*</span><span class="ident" id="3816019"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3816026">)</span>&nbsp;<span class="ident" id="3816028">expectsContinue</span><span class="op" id="3816043">(</span><span class="op" id="3816044">)</span>&nbsp;<span class="builtintype" id="3816046">bool</span>&nbsp;<span class="op" id="3816051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816054">return</span>&nbsp;<span class="ident" id="3816061"><a href="/net/http/header.go.html#3785956">hasToken</a></span><span class="op" id="3816069">(</span><span class="ident" id="3816070"><a href="/net/http/request.go.html#3816016">r</a></span><span class="op" id="3816071">.</span><span class="ident" id="3816072">Header</span><span class="op" id="3816078">.</span><span class="ident" id="3816079">get</span><span class="op" id="3816082">(</span><span class="string" id="3816083">&#34;Expect&#34;</span><span class="op" id="3816091">)</span><span class="op" id="3816092">,</span>&nbsp;<span class="string" id="3816094">&#34;100-continue&#34;</span><span class="op" id="3816108">)</span><br>
<span class="lineno"></span><span class="op" id="3816110">}</span><br>
<span class="lineno">905</span><br>
<span class="lineno"></span><span class="keyword" id="3816113">func</span>&nbsp;<span class="op" id="3816118">(</span><span class="ident" id="3816119">r</span>&nbsp;<span class="op" id="3816121">*</span><span class="ident" id="3816122"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3816129">)</span>&nbsp;<span class="ident" id="3816131">wantsHttp10KeepAlive</span><span class="op" id="3816151">(</span><span class="op" id="3816152">)</span>&nbsp;<span class="builtintype" id="3816154">bool</span>&nbsp;<span class="op" id="3816159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816162">if</span>&nbsp;<span class="ident" id="3816165"><a href="/net/http/request.go.html#3816119">r</a></span><span class="op" id="3816166">.</span><span class="ident" id="3816167">ProtoMajor</span>&nbsp;<span class="op" id="3816178">!=</span>&nbsp;<span class="num" id="3816181">1</span>&nbsp;<span class="op" id="3816183">||</span>&nbsp;<span class="ident" id="3816186"><a href="/net/http/request.go.html#3816119">r</a></span><span class="op" id="3816187">.</span><span class="ident" id="3816188">ProtoMinor</span>&nbsp;<span class="op" id="3816199">!=</span>&nbsp;<span class="num" id="3816202">0</span>&nbsp;<span class="op" id="3816204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816208">return</span>&nbsp;<span class="ident" id="3816215">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3816222">}</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816225">return</span>&nbsp;<span class="ident" id="3816232"><a href="/net/http/header.go.html#3785956">hasToken</a></span><span class="op" id="3816240">(</span><span class="ident" id="3816241"><a href="/net/http/request.go.html#3816119">r</a></span><span class="op" id="3816242">.</span><span class="ident" id="3816243">Header</span><span class="op" id="3816249">.</span><span class="ident" id="3816250">get</span><span class="op" id="3816253">(</span><span class="string" id="3816254">&#34;Connection&#34;</span><span class="op" id="3816266">)</span><span class="op" id="3816267">,</span>&nbsp;<span class="string" id="3816269">&#34;keep-alive&#34;</span><span class="op" id="3816281">)</span><br>
<span class="lineno"></span><span class="op" id="3816283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3816286">func</span>&nbsp;<span class="op" id="3816291">(</span><span class="ident" id="3816292">r</span>&nbsp;<span class="op" id="3816294">*</span><span class="ident" id="3816295"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3816302">)</span>&nbsp;<span class="ident" id="3816304">wantsClose</span><span class="op" id="3816314">(</span><span class="op" id="3816315">)</span>&nbsp;<span class="builtintype" id="3816317">bool</span>&nbsp;<span class="op" id="3816322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816325">return</span>&nbsp;<span class="ident" id="3816332"><a href="/net/http/header.go.html#3785956">hasToken</a></span><span class="op" id="3816340">(</span><span class="ident" id="3816341"><a href="/net/http/request.go.html#3816292">r</a></span><span class="op" id="3816342">.</span><span class="ident" id="3816343">Header</span><span class="op" id="3816349">.</span><span class="ident" id="3816350">get</span><span class="op" id="3816353">(</span><span class="string" id="3816354">&#34;Connection&#34;</span><span class="op" id="3816366">)</span><span class="op" id="3816367">,</span>&nbsp;<span class="string" id="3816369">&#34;close&#34;</span><span class="op" id="3816376">)</span><br>
<span class="lineno">915</span><span class="op" id="3816378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3816381">func</span>&nbsp;<span class="op" id="3816386">(</span><span class="ident" id="3816387">r</span>&nbsp;<span class="op" id="3816389">*</span><span class="ident" id="3816390"><a href="/net/http/request.go.html#3791418">Request</a></span><span class="op" id="3816397">)</span>&nbsp;<span class="ident" id="3816399">closeBody</span><span class="op" id="3816408">(</span><span class="op" id="3816409">)</span>&nbsp;<span class="op" id="3816411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3816414">if</span>&nbsp;<span class="ident" id="3816417"><a href="/net/http/request.go.html#3816387">r</a></span><span class="op" id="3816418">.</span><span class="ident" id="3816419">Body</span>&nbsp;<span class="op" id="3816424">!=</span>&nbsp;<span class="ident" id="3816427">nil</span>&nbsp;<span class="op" id="3816431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3816435"><a href="/net/http/request.go.html#3816387">r</a></span><span class="op" id="3816436">.</span><span class="ident" id="3816437">Body</span><span class="op" id="3816441">.</span><span class="ident" id="3816442">Close</span><span class="op" id="3816447">(</span><span class="op" id="3816448">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3816451">}</span><br>
<span class="lineno"></span><span class="op" id="3816453">}</span>
</div>
</body>
</html>
