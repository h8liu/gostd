<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/doc</h2>
<ul>
<li><a href="/gostd/go/doc/comment.go.html">comment.go</a></li>
<li><a href="/gostd/go/doc/comment_test.go.html">comment_test.go</a></li>
<li><a href="/gostd/go/doc/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/doc/doc_test.go.html">doc_test.go</a></li>
<li><a href="/gostd/go/doc/example.go.html">example.go</a></li>
<li><a href="/gostd/go/doc/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/doc/exports.go.html">exports.go</a></li>
<li><a href="/gostd/go/doc/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/doc/reader.go.html">reader.go</a></li>
<li><a href="/gostd/go/doc/synopsis.go.html">synopsis.go</a></li>
<li><a href="/gostd/go/doc/synopsis_test.go.html">synopsis_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5441771">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5441826">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5441880">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5441931">//&nbsp;Extract&nbsp;example&nbsp;functions&nbsp;from&nbsp;file&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5441977">package</span>&nbsp;<span class="ident" id="5441985">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5441990">import</span>&nbsp;<span class="op" id="5441997">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5442000">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5442010">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5442022">&#34;path&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5442030">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5442040">&#34;sort&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5442048">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5442059">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5442070">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5442081">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5442096">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="5442099">//&nbsp;An&nbsp;Example&nbsp;represents&nbsp;an&nbsp;example&nbsp;function&nbsp;found&nbsp;in&nbsp;a&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5442169">type</span>&nbsp;<span class="ident" id="5442174">Example</span>&nbsp;<span class="keyword" id="5442182">struct</span>&nbsp;<span class="op" id="5442189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5442192">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5442204">string</span>&nbsp;<span class="comment" id="5442211">//&nbsp;name&nbsp;of&nbsp;the&nbsp;item&nbsp;being&nbsp;exemplified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5442250">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5442262">string</span>&nbsp;<span class="comment" id="5442269">//&nbsp;example&nbsp;function&nbsp;doc&nbsp;string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5442301">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5442313">ast</span><span class="op" id="5442316">.</span><span class="ident" id="5442317">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5442323">Play</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5442335">*</span><span class="ident" id="5442336">ast</span><span class="op" id="5442339">.</span><span class="ident" id="5442340">File</span>&nbsp;<span class="comment" id="5442345">//&nbsp;a&nbsp;whole&nbsp;program&nbsp;version&nbsp;of&nbsp;the&nbsp;example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5442388">Comments</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5442400">[</span><span class="op" id="5442401">]</span><span class="op" id="5442402">*</span><span class="ident" id="5442403">ast</span><span class="op" id="5442406">.</span><span class="ident" id="5442407">CommentGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5442421">Output</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5442433">string</span>&nbsp;<span class="comment" id="5442440">//&nbsp;expected&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5442460">EmptyOutput</span>&nbsp;<span class="builtintype" id="5442472">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5442479">//&nbsp;expect&nbsp;empty&nbsp;output</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5442503">Order</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5442515">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5442522">//&nbsp;original&nbsp;source&nbsp;code&nbsp;order</span><br>
<span class="lineno"></span><span class="op" id="5442552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5442555">//&nbsp;Examples&nbsp;returns&nbsp;the&nbsp;examples&nbsp;found&nbsp;in&nbsp;the&nbsp;files,&nbsp;sorted&nbsp;by&nbsp;Name&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="5442630">//&nbsp;The&nbsp;Order&nbsp;fields&nbsp;record&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;the&nbsp;examples&nbsp;were&nbsp;encountered.</span><br>
<span class="lineno">35</span><span class="comment" id="5442707">//</span><br>
<span class="lineno"></span><span class="comment" id="5442710">//&nbsp;Playable&nbsp;Examples&nbsp;must&nbsp;be&nbsp;in&nbsp;a&nbsp;package&nbsp;whose&nbsp;name&nbsp;ends&nbsp;in&nbsp;&#34;_test&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="5442780">//&nbsp;An&nbsp;Example&nbsp;is&nbsp;&#34;playable&#34;&nbsp;(the&nbsp;Play&nbsp;field&nbsp;is&nbsp;non-nil)&nbsp;in&nbsp;either&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="5442855">//&nbsp;circumstances:</span><br>
<span class="lineno"></span><span class="comment" id="5442873">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;example&nbsp;function&nbsp;is&nbsp;self-contained:&nbsp;the&nbsp;function&nbsp;references&nbsp;only</span><br>
<span class="lineno">40</span><span class="comment" id="5442949">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identifiers&nbsp;from&nbsp;other&nbsp;packages&nbsp;(or&nbsp;predeclared&nbsp;identifiers,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5443025">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;int&#34;)&nbsp;and&nbsp;the&nbsp;test&nbsp;file&nbsp;does&nbsp;not&nbsp;include&nbsp;a&nbsp;dot&nbsp;import.</span><br>
<span class="lineno"></span><span class="comment" id="5443088">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;entire&nbsp;test&nbsp;file&nbsp;is&nbsp;the&nbsp;example:&nbsp;the&nbsp;file&nbsp;contains&nbsp;exactly&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5443162">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;example&nbsp;function,&nbsp;zero&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;functions,&nbsp;and&nbsp;at&nbsp;least&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5443238">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;top-level&nbsp;function,&nbsp;type,&nbsp;variable,&nbsp;or&nbsp;constant&nbsp;declaration&nbsp;other</span><br>
<span class="lineno">45</span><span class="comment" id="5443311">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than&nbsp;the&nbsp;example&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="5443345">func</span>&nbsp;<span class="ident" id="5443350">Examples</span><span class="op" id="5443358">(</span><span class="ident" id="5443359">files</span>&nbsp;<span class="op" id="5443365">...</span><span class="op" id="5443368">*</span><span class="ident" id="5443369">ast</span><span class="op" id="5443372">.</span><span class="ident" id="5443373">File</span><span class="op" id="5443377">)</span>&nbsp;<span class="op" id="5443379">[</span><span class="op" id="5443380">]</span><span class="op" id="5443381">*</span><span class="ident" id="5443382">Example</span>&nbsp;<span class="op" id="5443390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443393">var</span>&nbsp;<span class="ident" id="5443397">list</span>&nbsp;<span class="op" id="5443402">[</span><span class="op" id="5443403">]</span><span class="op" id="5443404">*</span><span class="ident" id="5443405">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443414">for</span>&nbsp;<span class="ident" id="5443418">_</span><span class="op" id="5443419">,</span>&nbsp;<span class="ident" id="5443421">file</span>&nbsp;<span class="op" id="5443426">:=</span>&nbsp;<span class="keyword" id="5443429">range</span>&nbsp;<span class="ident" id="5443435">files</span>&nbsp;<span class="op" id="5443441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5443445">hasTests</span>&nbsp;<span class="op" id="5443454">:=</span>&nbsp;<span class="builtintype" id="5443457">false</span>&nbsp;<span class="comment" id="5443463">//&nbsp;file&nbsp;contains&nbsp;tests&nbsp;or&nbsp;benchmarks</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5443502">numDecl</span>&nbsp;<span class="op" id="5443510">:=</span>&nbsp;<span class="num" id="5443513">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5443520">//&nbsp;number&nbsp;of&nbsp;non-import&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443571">var</span>&nbsp;<span class="ident" id="5443575">flist</span>&nbsp;<span class="op" id="5443581">[</span><span class="op" id="5443582">]</span><span class="op" id="5443583">*</span><span class="ident" id="5443584">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443594">for</span>&nbsp;<span class="ident" id="5443598">_</span><span class="op" id="5443599">,</span>&nbsp;<span class="ident" id="5443601">decl</span>&nbsp;<span class="op" id="5443606">:=</span>&nbsp;<span class="keyword" id="5443609">range</span>&nbsp;<span class="ident" id="5443615">file</span><span class="op" id="5443619">.</span><span class="ident" id="5443620">Decls</span>&nbsp;<span class="op" id="5443626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443631">if</span>&nbsp;<span class="ident" id="5443634">g</span><span class="op" id="5443635">,</span>&nbsp;<span class="ident" id="5443637">ok</span>&nbsp;<span class="op" id="5443640">:=</span>&nbsp;<span class="ident" id="5443643">decl</span><span class="op" id="5443647">.</span><span class="op" id="5443648">(</span><span class="op" id="5443649">*</span><span class="ident" id="5443650">ast</span><span class="op" id="5443653">.</span><span class="ident" id="5443654">GenDecl</span><span class="op" id="5443661">)</span><span class="op" id="5443662">;</span>&nbsp;<span class="ident" id="5443664">ok</span>&nbsp;<span class="op" id="5443667">&amp;&amp;</span>&nbsp;<span class="ident" id="5443670">g</span><span class="op" id="5443671">.</span><span class="ident" id="5443672">Tok</span>&nbsp;<span class="op" id="5443676">!=</span>&nbsp;<span class="ident" id="5443679">token</span><span class="op" id="5443684">.</span><span class="ident" id="5443685">IMPORT</span>&nbsp;<span class="op" id="5443692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5443698">numDecl</span><span class="op" id="5443705">++</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443712">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5443724">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5443729">f</span><span class="op" id="5443730">,</span>&nbsp;<span class="ident" id="5443732">ok</span>&nbsp;<span class="op" id="5443735">:=</span>&nbsp;<span class="ident" id="5443738">decl</span><span class="op" id="5443742">.</span><span class="op" id="5443743">(</span><span class="op" id="5443744">*</span><span class="ident" id="5443745">ast</span><span class="op" id="5443748">.</span><span class="ident" id="5443749">FuncDecl</span><span class="op" id="5443757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443762">if</span>&nbsp;<span class="op" id="5443765">!</span><span class="ident" id="5443766">ok</span>&nbsp;<span class="op" id="5443769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443775">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5443787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5443792">numDecl</span><span class="op" id="5443799">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5443805">name</span>&nbsp;<span class="op" id="5443810">:=</span>&nbsp;<span class="ident" id="5443813">f</span><span class="op" id="5443814">.</span><span class="ident" id="5443815">Name</span><span class="op" id="5443819">.</span><span class="ident" id="5443820">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443828">if</span>&nbsp;<span class="ident" id="5443831">isTest</span><span class="op" id="5443837">(</span><span class="ident" id="5443838">name</span><span class="op" id="5443842">,</span>&nbsp;<span class="string" id="5443844">&#34;Test&#34;</span><span class="op" id="5443850">)</span>&nbsp;<span class="op" id="5443852">||</span>&nbsp;<span class="ident" id="5443855">isTest</span><span class="op" id="5443861">(</span><span class="ident" id="5443862">name</span><span class="op" id="5443866">,</span>&nbsp;<span class="string" id="5443868">&#34;Benchmark&#34;</span><span class="op" id="5443879">)</span>&nbsp;<span class="op" id="5443881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5443887">hasTests</span>&nbsp;<span class="op" id="5443896">=</span>&nbsp;<span class="builtintype" id="5443898">true</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443907">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5443919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443924">if</span>&nbsp;<span class="op" id="5443927">!</span><span class="ident" id="5443928">isTest</span><span class="op" id="5443934">(</span><span class="ident" id="5443935">name</span><span class="op" id="5443939">,</span>&nbsp;<span class="string" id="5443941">&#34;Example&#34;</span><span class="op" id="5443950">)</span>&nbsp;<span class="op" id="5443952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443958">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5443970">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443975">var</span>&nbsp;<span class="ident" id="5443979">doc</span>&nbsp;<span class="builtintype" id="5443983">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5443993">if</span>&nbsp;<span class="ident" id="5443996">f</span><span class="op" id="5443997">.</span><span class="ident" id="5443998">Doc</span>&nbsp;<span class="op" id="5444002">!=</span>&nbsp;<span class="ident" id="5444005">nil</span>&nbsp;<span class="op" id="5444009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444015">doc</span>&nbsp;<span class="op" id="5444019">=</span>&nbsp;<span class="ident" id="5444021">f</span><span class="op" id="5444022">.</span><span class="ident" id="5444023">Doc</span><span class="op" id="5444026">.</span><span class="ident" id="5444027">Text</span><span class="op" id="5444031">(</span><span class="op" id="5444032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5444037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444042">output</span><span class="op" id="5444048">,</span>&nbsp;<span class="ident" id="5444050">hasOutput</span>&nbsp;<span class="op" id="5444060">:=</span>&nbsp;<span class="ident" id="5444063">exampleOutput</span><span class="op" id="5444076">(</span><span class="ident" id="5444077">f</span><span class="op" id="5444078">.</span><span class="ident" id="5444079">Body</span><span class="op" id="5444083">,</span>&nbsp;<span class="ident" id="5444085">file</span><span class="op" id="5444089">.</span><span class="ident" id="5444090">Comments</span><span class="op" id="5444098">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444103">flist</span>&nbsp;<span class="op" id="5444109">=</span>&nbsp;<span class="builtinfunc" id="5444111">append</span><span class="op" id="5444117">(</span><span class="ident" id="5444118">flist</span><span class="op" id="5444123">,</span>&nbsp;<span class="op" id="5444125">&amp;</span><span class="ident" id="5444126">Example</span><span class="op" id="5444133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444139">Name</span><span class="op" id="5444143">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5444152">name</span><span class="op" id="5444156">[</span><span class="builtinfunc" id="5444157">len</span><span class="op" id="5444160">(</span><span class="string" id="5444161">&#34;Example&#34;</span><span class="op" id="5444170">)</span><span class="op" id="5444171">:</span><span class="op" id="5444172">]</span><span class="op" id="5444173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444179">Doc</span><span class="op" id="5444182">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5444192">doc</span><span class="op" id="5444195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444201">Code</span><span class="op" id="5444205">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5444214">f</span><span class="op" id="5444215">.</span><span class="ident" id="5444216">Body</span><span class="op" id="5444220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444226">Play</span><span class="op" id="5444230">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5444239">playExample</span><span class="op" id="5444250">(</span><span class="ident" id="5444251">file</span><span class="op" id="5444255">,</span>&nbsp;<span class="ident" id="5444257">f</span><span class="op" id="5444258">.</span><span class="ident" id="5444259">Body</span><span class="op" id="5444263">)</span><span class="op" id="5444264">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444270">Comments</span><span class="op" id="5444278">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5444283">file</span><span class="op" id="5444287">.</span><span class="ident" id="5444288">Comments</span><span class="op" id="5444296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444302">Output</span><span class="op" id="5444308">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5444315">output</span><span class="op" id="5444321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444327">EmptyOutput</span><span class="op" id="5444338">:</span>&nbsp;<span class="ident" id="5444340">output</span>&nbsp;<span class="op" id="5444347">==</span>&nbsp;<span class="string" id="5444350">&#34;&#34;</span>&nbsp;<span class="op" id="5444353">&amp;&amp;</span>&nbsp;<span class="ident" id="5444356">hasOutput</span><span class="op" id="5444365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444371">Order</span><span class="op" id="5444376">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5444384">len</span><span class="op" id="5444387">(</span><span class="ident" id="5444388">flist</span><span class="op" id="5444393">)</span><span class="op" id="5444394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5444399">}</span><span class="op" id="5444400">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5444404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5444408">if</span>&nbsp;<span class="op" id="5444411">!</span><span class="ident" id="5444412">hasTests</span>&nbsp;<span class="op" id="5444421">&amp;&amp;</span>&nbsp;<span class="ident" id="5444424">numDecl</span>&nbsp;<span class="op" id="5444432">&gt;</span>&nbsp;<span class="num" id="5444434">1</span>&nbsp;<span class="op" id="5444436">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5444439">len</span><span class="op" id="5444442">(</span><span class="ident" id="5444443">flist</span><span class="op" id="5444448">)</span>&nbsp;<span class="op" id="5444450">==</span>&nbsp;<span class="num" id="5444453">1</span>&nbsp;<span class="op" id="5444455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5444460">//&nbsp;If&nbsp;this&nbsp;file&nbsp;only&nbsp;has&nbsp;one&nbsp;example&nbsp;function,&nbsp;some</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5444515">//&nbsp;other&nbsp;top-level&nbsp;declarations,&nbsp;and&nbsp;no&nbsp;tests&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5444567">//&nbsp;benchmarks,&nbsp;use&nbsp;the&nbsp;whole&nbsp;file&nbsp;as&nbsp;the&nbsp;example.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444620">flist</span><span class="op" id="5444625">[</span><span class="num" id="5444626">0</span><span class="op" id="5444627">]</span><span class="op" id="5444628">.</span><span class="ident" id="5444629">Code</span>&nbsp;<span class="op" id="5444634">=</span>&nbsp;<span class="ident" id="5444636">file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444644">flist</span><span class="op" id="5444649">[</span><span class="num" id="5444650">0</span><span class="op" id="5444651">]</span><span class="op" id="5444652">.</span><span class="ident" id="5444653">Play</span>&nbsp;<span class="op" id="5444658">=</span>&nbsp;<span class="ident" id="5444660">playExampleFile</span><span class="op" id="5444675">(</span><span class="ident" id="5444676">file</span><span class="op" id="5444680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5444684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444688">list</span>&nbsp;<span class="op" id="5444693">=</span>&nbsp;<span class="builtinfunc" id="5444695">append</span><span class="op" id="5444701">(</span><span class="ident" id="5444702">list</span><span class="op" id="5444706">,</span>&nbsp;<span class="ident" id="5444708">flist</span><span class="op" id="5444713">...</span><span class="op" id="5444716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5444719">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5444722">sort</span><span class="op" id="5444726">.</span><span class="ident" id="5444727">Sort</span><span class="op" id="5444731">(</span><span class="ident" id="5444732">exampleByName</span><span class="op" id="5444745">(</span><span class="ident" id="5444746">list</span><span class="op" id="5444750">)</span><span class="op" id="5444751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5444754">return</span>&nbsp;<span class="ident" id="5444761">list</span><br>
<span class="lineno"></span><span class="op" id="5444766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5444769">var</span>&nbsp;<span class="ident" id="5444773">outputPrefix</span>&nbsp;<span class="op" id="5444786">=</span>&nbsp;<span class="ident" id="5444788">regexp</span><span class="op" id="5444794">.</span><span class="ident" id="5444795">MustCompile</span><span class="op" id="5444806">(</span><span class="string" id="5444807">`(?i)^[[:space:]]*output:`</span><span class="op" id="5444833">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5444836">//&nbsp;Extracts&nbsp;the&nbsp;expected&nbsp;output&nbsp;and&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;valid&nbsp;output&nbsp;comment</span><br>
<span class="lineno"></span><span class="keyword" id="5444913">func</span>&nbsp;<span class="ident" id="5444918">exampleOutput</span><span class="op" id="5444931">(</span><span class="ident" id="5444932">b</span>&nbsp;<span class="op" id="5444934">*</span><span class="ident" id="5444935">ast</span><span class="op" id="5444938">.</span><span class="ident" id="5444939">BlockStmt</span><span class="op" id="5444948">,</span>&nbsp;<span class="ident" id="5444950">comments</span>&nbsp;<span class="op" id="5444959">[</span><span class="op" id="5444960">]</span><span class="op" id="5444961">*</span><span class="ident" id="5444962">ast</span><span class="op" id="5444965">.</span><span class="ident" id="5444966">CommentGroup</span><span class="op" id="5444978">)</span>&nbsp;<span class="op" id="5444980">(</span><span class="ident" id="5444981">output</span>&nbsp;<span class="builtintype" id="5444988">string</span><span class="op" id="5444994">,</span>&nbsp;<span class="ident" id="5444996">ok</span>&nbsp;<span class="builtintype" id="5444999">bool</span><span class="op" id="5445003">)</span>&nbsp;<span class="op" id="5445005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5445008">if</span>&nbsp;<span class="ident" id="5445011">_</span><span class="op" id="5445012">,</span>&nbsp;<span class="ident" id="5445014">last</span>&nbsp;<span class="op" id="5445019">:=</span>&nbsp;<span class="ident" id="5445022">lastComment</span><span class="op" id="5445033">(</span><span class="ident" id="5445034">b</span><span class="op" id="5445035">,</span>&nbsp;<span class="ident" id="5445037">comments</span><span class="op" id="5445045">)</span><span class="op" id="5445046">;</span>&nbsp;<span class="ident" id="5445048">last</span>&nbsp;<span class="op" id="5445053">!=</span>&nbsp;<span class="ident" id="5445056">nil</span>&nbsp;<span class="op" id="5445060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5445064">//&nbsp;test&nbsp;that&nbsp;it&nbsp;begins&nbsp;with&nbsp;the&nbsp;correct&nbsp;prefix</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5445113">text</span>&nbsp;<span class="op" id="5445118">:=</span>&nbsp;<span class="ident" id="5445121">last</span><span class="op" id="5445125">.</span><span class="ident" id="5445126">Text</span><span class="op" id="5445130">(</span><span class="op" id="5445131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5445135">if</span>&nbsp;<span class="ident" id="5445138">loc</span>&nbsp;<span class="op" id="5445142">:=</span>&nbsp;<span class="ident" id="5445145">outputPrefix</span><span class="op" id="5445157">.</span><span class="ident" id="5445158">FindStringIndex</span><span class="op" id="5445173">(</span><span class="ident" id="5445174">text</span><span class="op" id="5445178">)</span><span class="op" id="5445179">;</span>&nbsp;<span class="ident" id="5445181">loc</span>&nbsp;<span class="op" id="5445185">!=</span>&nbsp;<span class="ident" id="5445188">nil</span>&nbsp;<span class="op" id="5445192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5445197">text</span>&nbsp;<span class="op" id="5445202">=</span>&nbsp;<span class="ident" id="5445204">text</span><span class="op" id="5445208">[</span><span class="ident" id="5445209">loc</span><span class="op" id="5445212">[</span><span class="num" id="5445213">1</span><span class="op" id="5445214">]</span><span class="op" id="5445215">:</span><span class="op" id="5445216">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5445221">//&nbsp;Strip&nbsp;zero&nbsp;or&nbsp;more&nbsp;spaces&nbsp;followed&nbsp;by&nbsp;\n&nbsp;or&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5445287">text</span>&nbsp;<span class="op" id="5445292">=</span>&nbsp;<span class="ident" id="5445294">strings</span><span class="op" id="5445301">.</span><span class="ident" id="5445302">TrimLeft</span><span class="op" id="5445310">(</span><span class="ident" id="5445311">text</span><span class="op" id="5445315">,</span>&nbsp;<span class="string" id="5445317">&#34;&nbsp;&#34;</span><span class="op" id="5445320">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5445325">if</span>&nbsp;<span class="builtinfunc" id="5445328">len</span><span class="op" id="5445331">(</span><span class="ident" id="5445332">text</span><span class="op" id="5445336">)</span>&nbsp;<span class="op" id="5445338">&gt;</span>&nbsp;<span class="num" id="5445340">0</span>&nbsp;<span class="op" id="5445342">&amp;&amp;</span>&nbsp;<span class="ident" id="5445345">text</span><span class="op" id="5445349">[</span><span class="num" id="5445350">0</span><span class="op" id="5445351">]</span>&nbsp;<span class="op" id="5445353">==</span>&nbsp;<span class="string" id="5445356">&#39;\n&#39;</span>&nbsp;<span class="op" id="5445361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5445367">text</span>&nbsp;<span class="op" id="5445372">=</span>&nbsp;<span class="ident" id="5445374">text</span><span class="op" id="5445378">[</span><span class="num" id="5445379">1</span><span class="op" id="5445380">:</span><span class="op" id="5445381">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5445386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5445391">return</span>&nbsp;<span class="ident" id="5445398">text</span><span class="op" id="5445402">,</span>&nbsp;<span class="builtintype" id="5445404">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5445411">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5445414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5445417">return</span>&nbsp;<span class="string" id="5445424">&#34;&#34;</span><span class="op" id="5445426">,</span>&nbsp;<span class="builtintype" id="5445428">false</span>&nbsp;<span class="comment" id="5445434">//&nbsp;no&nbsp;suitable&nbsp;comment&nbsp;found</span><br>
<span class="lineno"></span><span class="op" id="5445463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5445466">//&nbsp;isTest&nbsp;tells&nbsp;whether&nbsp;name&nbsp;looks&nbsp;like&nbsp;a&nbsp;test,&nbsp;example,&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno">120</span><span class="comment" id="5445537">//&nbsp;It&nbsp;is&nbsp;a&nbsp;Test&nbsp;(say)&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;character&nbsp;after&nbsp;Test&nbsp;that&nbsp;is&nbsp;not&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5445608">//&nbsp;lower-case&nbsp;letter.&nbsp;(We&nbsp;don&#39;t&nbsp;want&nbsp;Testiness.)</span><br>
<span class="lineno"></span><span class="keyword" id="5445657">func</span>&nbsp;<span class="ident" id="5445662">isTest</span><span class="op" id="5445668">(</span><span class="ident" id="5445669">name</span><span class="op" id="5445673">,</span>&nbsp;<span class="ident" id="5445675">prefix</span>&nbsp;<span class="builtintype" id="5445682">string</span><span class="op" id="5445688">)</span>&nbsp;<span class="builtintype" id="5445690">bool</span>&nbsp;<span class="op" id="5445695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5445698">if</span>&nbsp;<span class="op" id="5445701">!</span><span class="ident" id="5445702">strings</span><span class="op" id="5445709">.</span><span class="ident" id="5445710">HasPrefix</span><span class="op" id="5445719">(</span><span class="ident" id="5445720">name</span><span class="op" id="5445724">,</span>&nbsp;<span class="ident" id="5445726">prefix</span><span class="op" id="5445732">)</span>&nbsp;<span class="op" id="5445734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5445738">return</span>&nbsp;<span class="builtintype" id="5445745">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5445752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5445755">if</span>&nbsp;<span class="builtinfunc" id="5445758">len</span><span class="op" id="5445761">(</span><span class="ident" id="5445762">name</span><span class="op" id="5445766">)</span>&nbsp;<span class="op" id="5445768">==</span>&nbsp;<span class="builtinfunc" id="5445771">len</span><span class="op" id="5445774">(</span><span class="ident" id="5445775">prefix</span><span class="op" id="5445781">)</span>&nbsp;<span class="op" id="5445783">{</span>&nbsp;<span class="comment" id="5445785">//&nbsp;&#34;Test&#34;&nbsp;is&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5445803">return</span>&nbsp;<span class="builtintype" id="5445810">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5445816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="5445819">rune</span><span class="op" id="5445823">,</span>&nbsp;<span class="ident" id="5445825">_</span>&nbsp;<span class="op" id="5445827">:=</span>&nbsp;<span class="ident" id="5445830">utf8</span><span class="op" id="5445834">.</span><span class="ident" id="5445835">DecodeRuneInString</span><span class="op" id="5445853">(</span><span class="ident" id="5445854">name</span><span class="op" id="5445858">[</span><span class="builtinfunc" id="5445859">len</span><span class="op" id="5445862">(</span><span class="ident" id="5445863">prefix</span><span class="op" id="5445869">)</span><span class="op" id="5445870">:</span><span class="op" id="5445871">]</span><span class="op" id="5445872">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5445875">return</span>&nbsp;<span class="op" id="5445882">!</span><span class="ident" id="5445883">unicode</span><span class="op" id="5445890">.</span><span class="ident" id="5445891">IsLower</span><span class="op" id="5445898">(</span><span class="builtintype" id="5445899">rune</span><span class="op" id="5445903">)</span><br>
<span class="lineno"></span><span class="op" id="5445905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5445908">type</span>&nbsp;<span class="ident" id="5445913">exampleByName</span>&nbsp;<span class="op" id="5445927">[</span><span class="op" id="5445928">]</span><span class="op" id="5445929">*</span><span class="ident" id="5445930">Example</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="5445939">func</span>&nbsp;<span class="op" id="5445944">(</span><span class="ident" id="5445945">s</span>&nbsp;<span class="ident" id="5445947">exampleByName</span><span class="op" id="5445960">)</span>&nbsp;<span class="ident" id="5445962">Len</span><span class="op" id="5445965">(</span><span class="op" id="5445966">)</span>&nbsp;<span class="builtintype" id="5445968">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5445982">{</span>&nbsp;<span class="keyword" id="5445984">return</span>&nbsp;<span class="builtinfunc" id="5445991">len</span><span class="op" id="5445994">(</span><span class="ident" id="5445995">s</span><span class="op" id="5445996">)</span>&nbsp;<span class="op" id="5445998">}</span><br>
<span class="lineno"></span><span class="keyword" id="5446000">func</span>&nbsp;<span class="op" id="5446005">(</span><span class="ident" id="5446006">s</span>&nbsp;<span class="ident" id="5446008">exampleByName</span><span class="op" id="5446021">)</span>&nbsp;<span class="ident" id="5446023">Swap</span><span class="op" id="5446027">(</span><span class="ident" id="5446028">i</span><span class="op" id="5446029">,</span>&nbsp;<span class="ident" id="5446031">j</span>&nbsp;<span class="builtintype" id="5446033">int</span><span class="op" id="5446036">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5446043">{</span>&nbsp;<span class="ident" id="5446045">s</span><span class="op" id="5446046">[</span><span class="ident" id="5446047">i</span><span class="op" id="5446048">]</span><span class="op" id="5446049">,</span>&nbsp;<span class="ident" id="5446051">s</span><span class="op" id="5446052">[</span><span class="ident" id="5446053">j</span><span class="op" id="5446054">]</span>&nbsp;<span class="op" id="5446056">=</span>&nbsp;<span class="ident" id="5446058">s</span><span class="op" id="5446059">[</span><span class="ident" id="5446060">j</span><span class="op" id="5446061">]</span><span class="op" id="5446062">,</span>&nbsp;<span class="ident" id="5446064">s</span><span class="op" id="5446065">[</span><span class="ident" id="5446066">i</span><span class="op" id="5446067">]</span>&nbsp;<span class="op" id="5446069">}</span><br>
<span class="lineno"></span><span class="keyword" id="5446071">func</span>&nbsp;<span class="op" id="5446076">(</span><span class="ident" id="5446077">s</span>&nbsp;<span class="ident" id="5446079">exampleByName</span><span class="op" id="5446092">)</span>&nbsp;<span class="ident" id="5446094">Less</span><span class="op" id="5446098">(</span><span class="ident" id="5446099">i</span><span class="op" id="5446100">,</span>&nbsp;<span class="ident" id="5446102">j</span>&nbsp;<span class="builtintype" id="5446104">int</span><span class="op" id="5446107">)</span>&nbsp;<span class="builtintype" id="5446109">bool</span>&nbsp;<span class="op" id="5446114">{</span>&nbsp;<span class="keyword" id="5446116">return</span>&nbsp;<span class="ident" id="5446123">s</span><span class="op" id="5446124">[</span><span class="ident" id="5446125">i</span><span class="op" id="5446126">]</span><span class="op" id="5446127">.</span><span class="ident" id="5446128">Name</span>&nbsp;<span class="op" id="5446133">&lt;</span>&nbsp;<span class="ident" id="5446135">s</span><span class="op" id="5446136">[</span><span class="ident" id="5446137">j</span><span class="op" id="5446138">]</span><span class="op" id="5446139">.</span><span class="ident" id="5446140">Name</span>&nbsp;<span class="op" id="5446145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5446148">//&nbsp;playExample&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File&nbsp;based&nbsp;on&nbsp;the&nbsp;provided</span><br>
<span class="lineno">140</span><span class="comment" id="5446213">//&nbsp;file&nbsp;with&nbsp;the&nbsp;provided&nbsp;function&nbsp;body&nbsp;as&nbsp;the&nbsp;body&nbsp;of&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="5446274">func</span>&nbsp;<span class="ident" id="5446279">playExample</span><span class="op" id="5446290">(</span><span class="ident" id="5446291">file</span>&nbsp;<span class="op" id="5446296">*</span><span class="ident" id="5446297">ast</span><span class="op" id="5446300">.</span><span class="ident" id="5446301">File</span><span class="op" id="5446305">,</span>&nbsp;<span class="ident" id="5446307">body</span>&nbsp;<span class="op" id="5446312">*</span><span class="ident" id="5446313">ast</span><span class="op" id="5446316">.</span><span class="ident" id="5446317">BlockStmt</span><span class="op" id="5446326">)</span>&nbsp;<span class="op" id="5446328">*</span><span class="ident" id="5446329">ast</span><span class="op" id="5446332">.</span><span class="ident" id="5446333">File</span>&nbsp;<span class="op" id="5446338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5446341">if</span>&nbsp;<span class="op" id="5446344">!</span><span class="ident" id="5446345">strings</span><span class="op" id="5446352">.</span><span class="ident" id="5446353">HasSuffix</span><span class="op" id="5446362">(</span><span class="ident" id="5446363">file</span><span class="op" id="5446367">.</span><span class="ident" id="5446368">Name</span><span class="op" id="5446372">.</span><span class="ident" id="5446373">Name</span><span class="op" id="5446377">,</span>&nbsp;<span class="string" id="5446379">&#34;_test&#34;</span><span class="op" id="5446386">)</span>&nbsp;<span class="op" id="5446388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5446392">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5446444">//&nbsp;greater&nbsp;package&nbsp;(yet).</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5446472">return</span>&nbsp;<span class="ident" id="5446479">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5446484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5446488">//&nbsp;Find&nbsp;top-level&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5446533">topDecls</span>&nbsp;<span class="op" id="5446542">:=</span>&nbsp;<span class="builtinfunc" id="5446545">make</span><span class="op" id="5446549">(</span><span class="keyword" id="5446550">map</span><span class="op" id="5446553">[</span><span class="op" id="5446554">*</span><span class="ident" id="5446555">ast</span><span class="op" id="5446558">.</span><span class="ident" id="5446559">Object</span><span class="op" id="5446565">]</span><span class="builtintype" id="5446566">bool</span><span class="op" id="5446570">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5446573">for</span>&nbsp;<span class="ident" id="5446577">_</span><span class="op" id="5446578">,</span>&nbsp;<span class="ident" id="5446580">decl</span>&nbsp;<span class="op" id="5446585">:=</span>&nbsp;<span class="keyword" id="5446588">range</span>&nbsp;<span class="ident" id="5446594">file</span><span class="op" id="5446598">.</span><span class="ident" id="5446599">Decls</span>&nbsp;<span class="op" id="5446605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5446609">switch</span>&nbsp;<span class="ident" id="5446616">d</span>&nbsp;<span class="op" id="5446618">:=</span>&nbsp;<span class="ident" id="5446621">decl</span><span class="op" id="5446625">.</span><span class="op" id="5446626">(</span><span class="keyword" id="5446627">type</span><span class="op" id="5446631">)</span>&nbsp;<span class="op" id="5446633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5446637">case</span>&nbsp;<span class="op" id="5446642">*</span><span class="ident" id="5446643">ast</span><span class="op" id="5446646">.</span><span class="ident" id="5446647">FuncDecl</span><span class="op" id="5446655">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5446660">topDecls</span><span class="op" id="5446668">[</span><span class="ident" id="5446669">d</span><span class="op" id="5446670">.</span><span class="ident" id="5446671">Name</span><span class="op" id="5446675">.</span><span class="ident" id="5446676">Obj</span><span class="op" id="5446679">]</span>&nbsp;<span class="op" id="5446681">=</span>&nbsp;<span class="builtintype" id="5446683">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5446690">case</span>&nbsp;<span class="op" id="5446695">*</span><span class="ident" id="5446696">ast</span><span class="op" id="5446699">.</span><span class="ident" id="5446700">GenDecl</span><span class="op" id="5446707">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5446712">for</span>&nbsp;<span class="ident" id="5446716">_</span><span class="op" id="5446717">,</span>&nbsp;<span class="ident" id="5446719">spec</span>&nbsp;<span class="op" id="5446724">:=</span>&nbsp;<span class="keyword" id="5446727">range</span>&nbsp;<span class="ident" id="5446733">d</span><span class="op" id="5446734">.</span><span class="ident" id="5446735">Specs</span>&nbsp;<span class="op" id="5446741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5446747">switch</span>&nbsp;<span class="ident" id="5446754">s</span>&nbsp;<span class="op" id="5446756">:=</span>&nbsp;<span class="ident" id="5446759">spec</span><span class="op" id="5446763">.</span><span class="op" id="5446764">(</span><span class="keyword" id="5446765">type</span><span class="op" id="5446769">)</span>&nbsp;<span class="op" id="5446771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5446777">case</span>&nbsp;<span class="op" id="5446782">*</span><span class="ident" id="5446783">ast</span><span class="op" id="5446786">.</span><span class="ident" id="5446787">TypeSpec</span><span class="op" id="5446795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5446802">topDecls</span><span class="op" id="5446810">[</span><span class="ident" id="5446811">s</span><span class="op" id="5446812">.</span><span class="ident" id="5446813">Name</span><span class="op" id="5446817">.</span><span class="ident" id="5446818">Obj</span><span class="op" id="5446821">]</span>&nbsp;<span class="op" id="5446823">=</span>&nbsp;<span class="builtintype" id="5446825">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5446834">case</span>&nbsp;<span class="op" id="5446839">*</span><span class="ident" id="5446840">ast</span><span class="op" id="5446843">.</span><span class="ident" id="5446844">ValueSpec</span><span class="op" id="5446853">:</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5446860">for</span>&nbsp;<span class="ident" id="5446864">_</span><span class="op" id="5446865">,</span>&nbsp;<span class="ident" id="5446867">id</span>&nbsp;<span class="op" id="5446870">:=</span>&nbsp;<span class="keyword" id="5446873">range</span>&nbsp;<span class="ident" id="5446879">s</span><span class="op" id="5446880">.</span><span class="ident" id="5446881">Names</span>&nbsp;<span class="op" id="5446887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5446895">topDecls</span><span class="op" id="5446903">[</span><span class="ident" id="5446904">id</span><span class="op" id="5446906">.</span><span class="ident" id="5446907">Obj</span><span class="op" id="5446910">]</span>&nbsp;<span class="op" id="5446912">=</span>&nbsp;<span class="builtintype" id="5446914">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5446924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5446930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5446935">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5446939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5446942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5446946">//&nbsp;Find&nbsp;unresolved&nbsp;identifiers&nbsp;and&nbsp;uses&nbsp;of&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5447014">unresolved</span>&nbsp;<span class="op" id="5447025">:=</span>&nbsp;<span class="builtinfunc" id="5447028">make</span><span class="op" id="5447032">(</span><span class="keyword" id="5447033">map</span><span class="op" id="5447036">[</span><span class="builtintype" id="5447037">string</span><span class="op" id="5447043">]</span><span class="builtintype" id="5447044">bool</span><span class="op" id="5447048">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5447051">usesTopDecl</span>&nbsp;<span class="op" id="5447063">:=</span>&nbsp;<span class="builtintype" id="5447066">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5447073">var</span>&nbsp;<span class="ident" id="5447077">inspectFunc</span>&nbsp;<span class="keyword" id="5447089">func</span><span class="op" id="5447093">(</span><span class="ident" id="5447094">ast</span><span class="op" id="5447097">.</span><span class="ident" id="5447098">Node</span><span class="op" id="5447102">)</span>&nbsp;<span class="builtintype" id="5447104">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5447110">inspectFunc</span>&nbsp;<span class="op" id="5447122">=</span>&nbsp;<span class="keyword" id="5447124">func</span><span class="op" id="5447128">(</span><span class="ident" id="5447129">n</span>&nbsp;<span class="ident" id="5447131">ast</span><span class="op" id="5447134">.</span><span class="ident" id="5447135">Node</span><span class="op" id="5447139">)</span>&nbsp;<span class="builtintype" id="5447141">bool</span>&nbsp;<span class="op" id="5447146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5447150">//&nbsp;For&nbsp;selector&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;left&nbsp;hand&nbsp;side.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5447214">//&nbsp;(For&nbsp;an&nbsp;expression&nbsp;like&nbsp;fmt.Println,&nbsp;only&nbsp;add&nbsp;&#34;fmt&#34;&nbsp;to&nbsp;the</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5447278">//&nbsp;set&nbsp;of&nbsp;unresolved&nbsp;names,&nbsp;not&nbsp;&#34;Println&#34;.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5447324">if</span>&nbsp;<span class="ident" id="5447327">e</span><span class="op" id="5447328">,</span>&nbsp;<span class="ident" id="5447330">ok</span>&nbsp;<span class="op" id="5447333">:=</span>&nbsp;<span class="ident" id="5447336">n</span><span class="op" id="5447337">.</span><span class="op" id="5447338">(</span><span class="op" id="5447339">*</span><span class="ident" id="5447340">ast</span><span class="op" id="5447343">.</span><span class="ident" id="5447344">SelectorExpr</span><span class="op" id="5447356">)</span><span class="op" id="5447357">;</span>&nbsp;<span class="ident" id="5447359">ok</span>&nbsp;<span class="op" id="5447362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5447367">ast</span><span class="op" id="5447370">.</span><span class="ident" id="5447371">Inspect</span><span class="op" id="5447378">(</span><span class="ident" id="5447379">e</span><span class="op" id="5447380">.</span><span class="ident" id="5447381">X</span><span class="op" id="5447382">,</span>&nbsp;<span class="ident" id="5447384">inspectFunc</span><span class="op" id="5447395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5447400">return</span>&nbsp;<span class="builtintype" id="5447407">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5447415">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5447419">//&nbsp;For&nbsp;key&nbsp;value&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5447474">//&nbsp;as&nbsp;the&nbsp;key&nbsp;should&nbsp;be&nbsp;resolved&nbsp;by&nbsp;the&nbsp;type&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5447528">//&nbsp;composite&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5447552">if</span>&nbsp;<span class="ident" id="5447555">e</span><span class="op" id="5447556">,</span>&nbsp;<span class="ident" id="5447558">ok</span>&nbsp;<span class="op" id="5447561">:=</span>&nbsp;<span class="ident" id="5447564">n</span><span class="op" id="5447565">.</span><span class="op" id="5447566">(</span><span class="op" id="5447567">*</span><span class="ident" id="5447568">ast</span><span class="op" id="5447571">.</span><span class="ident" id="5447572">KeyValueExpr</span><span class="op" id="5447584">)</span><span class="op" id="5447585">;</span>&nbsp;<span class="ident" id="5447587">ok</span>&nbsp;<span class="op" id="5447590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5447595">ast</span><span class="op" id="5447598">.</span><span class="ident" id="5447599">Inspect</span><span class="op" id="5447606">(</span><span class="ident" id="5447607">e</span><span class="op" id="5447608">.</span><span class="ident" id="5447609">Value</span><span class="op" id="5447614">,</span>&nbsp;<span class="ident" id="5447616">inspectFunc</span><span class="op" id="5447627">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5447632">return</span>&nbsp;<span class="builtintype" id="5447639">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5447647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5447651">if</span>&nbsp;<span class="ident" id="5447654">id</span><span class="op" id="5447656">,</span>&nbsp;<span class="ident" id="5447658">ok</span>&nbsp;<span class="op" id="5447661">:=</span>&nbsp;<span class="ident" id="5447664">n</span><span class="op" id="5447665">.</span><span class="op" id="5447666">(</span><span class="op" id="5447667">*</span><span class="ident" id="5447668">ast</span><span class="op" id="5447671">.</span><span class="ident" id="5447672">Ident</span><span class="op" id="5447677">)</span><span class="op" id="5447678">;</span>&nbsp;<span class="ident" id="5447680">ok</span>&nbsp;<span class="op" id="5447683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5447688">if</span>&nbsp;<span class="ident" id="5447691">id</span><span class="op" id="5447693">.</span><span class="ident" id="5447694">Obj</span>&nbsp;<span class="op" id="5447698">==</span>&nbsp;<span class="ident" id="5447701">nil</span>&nbsp;<span class="op" id="5447705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5447711">unresolved</span><span class="op" id="5447721">[</span><span class="ident" id="5447722">id</span><span class="op" id="5447724">.</span><span class="ident" id="5447725">Name</span><span class="op" id="5447729">]</span>&nbsp;<span class="op" id="5447731">=</span>&nbsp;<span class="builtintype" id="5447733">true</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5447741">}</span>&nbsp;<span class="keyword" id="5447743">else</span>&nbsp;<span class="keyword" id="5447748">if</span>&nbsp;<span class="ident" id="5447751">topDecls</span><span class="op" id="5447759">[</span><span class="ident" id="5447760">id</span><span class="op" id="5447762">.</span><span class="ident" id="5447763">Obj</span><span class="op" id="5447766">]</span>&nbsp;<span class="op" id="5447768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5447774">usesTopDecl</span>&nbsp;<span class="op" id="5447786">=</span>&nbsp;<span class="builtintype" id="5447788">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5447796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5447800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5447804">return</span>&nbsp;<span class="builtintype" id="5447811">true</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5447817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5447820">ast</span><span class="op" id="5447823">.</span><span class="ident" id="5447824">Inspect</span><span class="op" id="5447831">(</span><span class="ident" id="5447832">body</span><span class="op" id="5447836">,</span>&nbsp;<span class="ident" id="5447838">inspectFunc</span><span class="op" id="5447849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5447852">if</span>&nbsp;<span class="ident" id="5447855">usesTopDecl</span>&nbsp;<span class="op" id="5447867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5447871">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;not&nbsp;self-contained&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5447937">return</span>&nbsp;<span class="ident" id="5447944">nil</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5447949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5447953">//&nbsp;Remove&nbsp;predeclared&nbsp;identifiers&nbsp;from&nbsp;unresolved&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448010">for</span>&nbsp;<span class="ident" id="5448014">n</span>&nbsp;<span class="op" id="5448016">:=</span>&nbsp;<span class="keyword" id="5448019">range</span>&nbsp;<span class="ident" id="5448025">unresolved</span>&nbsp;<span class="op" id="5448036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448040">if</span>&nbsp;<span class="ident" id="5448043">predeclaredTypes</span><span class="op" id="5448059">[</span><span class="ident" id="5448060">n</span><span class="op" id="5448061">]</span>&nbsp;<span class="op" id="5448063">||</span>&nbsp;<span class="ident" id="5448066">predeclaredConstants</span><span class="op" id="5448086">[</span><span class="ident" id="5448087">n</span><span class="op" id="5448088">]</span>&nbsp;<span class="op" id="5448090">||</span>&nbsp;<span class="ident" id="5448093">predeclaredFuncs</span><span class="op" id="5448109">[</span><span class="ident" id="5448110">n</span><span class="op" id="5448111">]</span>&nbsp;<span class="op" id="5448113">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5448118">delete</span><span class="op" id="5448124">(</span><span class="ident" id="5448125">unresolved</span><span class="op" id="5448135">,</span>&nbsp;<span class="ident" id="5448137">n</span><span class="op" id="5448138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5448142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5448145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5448149">//&nbsp;Use&nbsp;unresolved&nbsp;identifiers&nbsp;to&nbsp;determine&nbsp;the&nbsp;imports&nbsp;used&nbsp;by&nbsp;this</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5448218">//&nbsp;example.&nbsp;The&nbsp;heuristic&nbsp;assumes&nbsp;package&nbsp;names&nbsp;match&nbsp;base&nbsp;import</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5448285">//&nbsp;paths&nbsp;for&nbsp;imports&nbsp;w/o&nbsp;renames&nbsp;(should&nbsp;be&nbsp;good&nbsp;enough&nbsp;most&nbsp;of&nbsp;the&nbsp;time).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5448361">namedImports</span>&nbsp;<span class="op" id="5448374">:=</span>&nbsp;<span class="builtinfunc" id="5448377">make</span><span class="op" id="5448381">(</span><span class="keyword" id="5448382">map</span><span class="op" id="5448385">[</span><span class="builtintype" id="5448386">string</span><span class="op" id="5448392">]</span><span class="builtintype" id="5448393">string</span><span class="op" id="5448399">)</span>&nbsp;<span class="comment" id="5448401">//&nbsp;[name]path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448416">var</span>&nbsp;<span class="ident" id="5448420">blankImports</span>&nbsp;<span class="op" id="5448433">[</span><span class="op" id="5448434">]</span><span class="ident" id="5448435">ast</span><span class="op" id="5448438">.</span><span class="ident" id="5448439">Spec</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5448456">//&nbsp;_&nbsp;imports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448470">for</span>&nbsp;<span class="ident" id="5448474">_</span><span class="op" id="5448475">,</span>&nbsp;<span class="ident" id="5448477">s</span>&nbsp;<span class="op" id="5448479">:=</span>&nbsp;<span class="keyword" id="5448482">range</span>&nbsp;<span class="ident" id="5448488">file</span><span class="op" id="5448492">.</span><span class="ident" id="5448493">Imports</span>&nbsp;<span class="op" id="5448501">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5448505">p</span><span class="op" id="5448506">,</span>&nbsp;<span class="ident" id="5448508">err</span>&nbsp;<span class="op" id="5448512">:=</span>&nbsp;<span class="ident" id="5448515">strconv</span><span class="op" id="5448522">.</span><span class="ident" id="5448523">Unquote</span><span class="op" id="5448530">(</span><span class="ident" id="5448531">s</span><span class="op" id="5448532">.</span><span class="ident" id="5448533">Path</span><span class="op" id="5448537">.</span><span class="ident" id="5448538">Value</span><span class="op" id="5448543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448547">if</span>&nbsp;<span class="ident" id="5448550">err</span>&nbsp;<span class="op" id="5448554">!=</span>&nbsp;<span class="ident" id="5448557">nil</span>&nbsp;<span class="op" id="5448561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448566">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5448577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5448581">n</span>&nbsp;<span class="op" id="5448583">:=</span>&nbsp;<span class="ident" id="5448586">path</span><span class="op" id="5448590">.</span><span class="ident" id="5448591">Base</span><span class="op" id="5448595">(</span><span class="ident" id="5448596">p</span><span class="op" id="5448597">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448601">if</span>&nbsp;<span class="ident" id="5448604">s</span><span class="op" id="5448605">.</span><span class="ident" id="5448606">Name</span>&nbsp;<span class="op" id="5448611">!=</span>&nbsp;<span class="ident" id="5448614">nil</span>&nbsp;<span class="op" id="5448618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5448623">n</span>&nbsp;<span class="op" id="5448625">=</span>&nbsp;<span class="ident" id="5448627">s</span><span class="op" id="5448628">.</span><span class="ident" id="5448629">Name</span><span class="op" id="5448633">.</span><span class="ident" id="5448634">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448642">switch</span>&nbsp;<span class="ident" id="5448649">n</span>&nbsp;<span class="op" id="5448651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448656">case</span>&nbsp;<span class="string" id="5448661">&#34;_&#34;</span><span class="op" id="5448664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5448670">blankImports</span>&nbsp;<span class="op" id="5448683">=</span>&nbsp;<span class="builtinfunc" id="5448685">append</span><span class="op" id="5448691">(</span><span class="ident" id="5448692">blankImports</span><span class="op" id="5448704">,</span>&nbsp;<span class="ident" id="5448706">s</span><span class="op" id="5448707">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448713">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448725">case</span>&nbsp;<span class="string" id="5448730">&#34;.&#34;</span><span class="op" id="5448733">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5448739">//&nbsp;We&nbsp;can&#39;t&nbsp;resolve&nbsp;dot&nbsp;imports&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448782">return</span>&nbsp;<span class="ident" id="5448789">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5448796">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5448800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448804">if</span>&nbsp;<span class="ident" id="5448807">unresolved</span><span class="op" id="5448817">[</span><span class="ident" id="5448818">n</span><span class="op" id="5448819">]</span>&nbsp;<span class="op" id="5448821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5448826">namedImports</span><span class="op" id="5448838">[</span><span class="ident" id="5448839">n</span><span class="op" id="5448840">]</span>&nbsp;<span class="op" id="5448842">=</span>&nbsp;<span class="ident" id="5448844">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5448849">delete</span><span class="op" id="5448855">(</span><span class="ident" id="5448856">unresolved</span><span class="op" id="5448866">,</span>&nbsp;<span class="ident" id="5448868">n</span><span class="op" id="5448869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5448873">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5448876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5448880">//&nbsp;If&nbsp;there&nbsp;are&nbsp;other&nbsp;unresolved&nbsp;identifiers,&nbsp;give&nbsp;up&nbsp;because&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5448948">//&nbsp;synthesized&nbsp;file&nbsp;is&nbsp;not&nbsp;going&nbsp;to&nbsp;build.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5448992">if</span>&nbsp;<span class="builtinfunc" id="5448995">len</span><span class="op" id="5448998">(</span><span class="ident" id="5448999">unresolved</span><span class="op" id="5449009">)</span>&nbsp;<span class="op" id="5449011">&gt;</span>&nbsp;<span class="num" id="5449013">0</span>&nbsp;<span class="op" id="5449015">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449019">return</span>&nbsp;<span class="ident" id="5449026">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5449035">//&nbsp;Include&nbsp;documentation&nbsp;belonging&nbsp;to&nbsp;blank&nbsp;imports.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449089">var</span>&nbsp;<span class="ident" id="5449093">comments</span>&nbsp;<span class="op" id="5449102">[</span><span class="op" id="5449103">]</span><span class="op" id="5449104">*</span><span class="ident" id="5449105">ast</span><span class="op" id="5449108">.</span><span class="ident" id="5449109">CommentGroup</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449123">for</span>&nbsp;<span class="ident" id="5449127">_</span><span class="op" id="5449128">,</span>&nbsp;<span class="ident" id="5449130">s</span>&nbsp;<span class="op" id="5449132">:=</span>&nbsp;<span class="keyword" id="5449135">range</span>&nbsp;<span class="ident" id="5449141">blankImports</span>&nbsp;<span class="op" id="5449154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449158">if</span>&nbsp;<span class="ident" id="5449161">c</span>&nbsp;<span class="op" id="5449163">:=</span>&nbsp;<span class="ident" id="5449166">s</span><span class="op" id="5449167">.</span><span class="op" id="5449168">(</span><span class="op" id="5449169">*</span><span class="ident" id="5449170">ast</span><span class="op" id="5449173">.</span><span class="ident" id="5449174">ImportSpec</span><span class="op" id="5449184">)</span><span class="op" id="5449185">.</span><span class="ident" id="5449186">Doc</span><span class="op" id="5449189">;</span>&nbsp;<span class="ident" id="5449191">c</span>&nbsp;<span class="op" id="5449193">!=</span>&nbsp;<span class="ident" id="5449196">nil</span>&nbsp;<span class="op" id="5449200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449205">comments</span>&nbsp;<span class="op" id="5449214">=</span>&nbsp;<span class="builtinfunc" id="5449216">append</span><span class="op" id="5449222">(</span><span class="ident" id="5449223">comments</span><span class="op" id="5449231">,</span>&nbsp;<span class="ident" id="5449233">c</span><span class="op" id="5449234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449241">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5449245">//&nbsp;Include&nbsp;comments&nbsp;that&nbsp;are&nbsp;inside&nbsp;the&nbsp;function&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449301">for</span>&nbsp;<span class="ident" id="5449305">_</span><span class="op" id="5449306">,</span>&nbsp;<span class="ident" id="5449308">c</span>&nbsp;<span class="op" id="5449310">:=</span>&nbsp;<span class="keyword" id="5449313">range</span>&nbsp;<span class="ident" id="5449319">file</span><span class="op" id="5449323">.</span><span class="ident" id="5449324">Comments</span>&nbsp;<span class="op" id="5449333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449337">if</span>&nbsp;<span class="ident" id="5449340">body</span><span class="op" id="5449344">.</span><span class="ident" id="5449345">Pos</span><span class="op" id="5449348">(</span><span class="op" id="5449349">)</span>&nbsp;<span class="op" id="5449351">&lt;=</span>&nbsp;<span class="ident" id="5449354">c</span><span class="op" id="5449355">.</span><span class="ident" id="5449356">Pos</span><span class="op" id="5449359">(</span><span class="op" id="5449360">)</span>&nbsp;<span class="op" id="5449362">&amp;&amp;</span>&nbsp;<span class="ident" id="5449365">c</span><span class="op" id="5449366">.</span><span class="ident" id="5449367">End</span><span class="op" id="5449370">(</span><span class="op" id="5449371">)</span>&nbsp;<span class="op" id="5449373">&lt;=</span>&nbsp;<span class="ident" id="5449376">body</span><span class="op" id="5449380">.</span><span class="ident" id="5449381">End</span><span class="op" id="5449384">(</span><span class="op" id="5449385">)</span>&nbsp;<span class="op" id="5449387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449392">comments</span>&nbsp;<span class="op" id="5449401">=</span>&nbsp;<span class="builtinfunc" id="5449403">append</span><span class="op" id="5449409">(</span><span class="ident" id="5449410">comments</span><span class="op" id="5449418">,</span>&nbsp;<span class="ident" id="5449420">c</span><span class="op" id="5449421">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5449432">//&nbsp;Strip&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;and&nbsp;adjust&nbsp;body&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449490">body</span><span class="op" id="5449494">,</span>&nbsp;<span class="ident" id="5449496">comments</span>&nbsp;<span class="op" id="5449505">=</span>&nbsp;<span class="ident" id="5449507">stripOutputComment</span><span class="op" id="5449525">(</span><span class="ident" id="5449526">body</span><span class="op" id="5449530">,</span>&nbsp;<span class="ident" id="5449532">comments</span><span class="op" id="5449540">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5449544">//&nbsp;Synthesize&nbsp;import&nbsp;declaration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449579">importDecl</span>&nbsp;<span class="op" id="5449590">:=</span>&nbsp;<span class="op" id="5449593">&amp;</span><span class="ident" id="5449594">ast</span><span class="op" id="5449597">.</span><span class="ident" id="5449598">GenDecl</span><span class="op" id="5449605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449609">Tok</span><span class="op" id="5449612">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5449617">token</span><span class="op" id="5449622">.</span><span class="ident" id="5449623">IMPORT</span><span class="op" id="5449629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449633">Lparen</span><span class="op" id="5449639">:</span>&nbsp;<span class="num" id="5449641">1</span><span class="op" id="5449642">,</span>&nbsp;<span class="comment" id="5449644">//&nbsp;Need&nbsp;non-zero&nbsp;Lparen&nbsp;and&nbsp;Rparen&nbsp;so&nbsp;that&nbsp;printer</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449697">Rparen</span><span class="op" id="5449703">:</span>&nbsp;<span class="num" id="5449705">1</span><span class="op" id="5449706">,</span>&nbsp;<span class="comment" id="5449708">//&nbsp;treats&nbsp;this&nbsp;as&nbsp;a&nbsp;factored&nbsp;import.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449749">for</span>&nbsp;<span class="ident" id="5449753">n</span><span class="op" id="5449754">,</span>&nbsp;<span class="ident" id="5449756">p</span>&nbsp;<span class="op" id="5449758">:=</span>&nbsp;<span class="keyword" id="5449761">range</span>&nbsp;<span class="ident" id="5449767">namedImports</span>&nbsp;<span class="op" id="5449780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449784">s</span>&nbsp;<span class="op" id="5449786">:=</span>&nbsp;<span class="op" id="5449789">&amp;</span><span class="ident" id="5449790">ast</span><span class="op" id="5449793">.</span><span class="ident" id="5449794">ImportSpec</span><span class="op" id="5449804">{</span><span class="ident" id="5449805">Path</span><span class="op" id="5449809">:</span>&nbsp;<span class="op" id="5449811">&amp;</span><span class="ident" id="5449812">ast</span><span class="op" id="5449815">.</span><span class="ident" id="5449816">BasicLit</span><span class="op" id="5449824">{</span><span class="ident" id="5449825">Value</span><span class="op" id="5449830">:</span>&nbsp;<span class="ident" id="5449832">strconv</span><span class="op" id="5449839">.</span><span class="ident" id="5449840">Quote</span><span class="op" id="5449845">(</span><span class="ident" id="5449846">p</span><span class="op" id="5449847">)</span><span class="op" id="5449848">}</span><span class="op" id="5449849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5449853">if</span>&nbsp;<span class="ident" id="5449856">path</span><span class="op" id="5449860">.</span><span class="ident" id="5449861">Base</span><span class="op" id="5449865">(</span><span class="ident" id="5449866">p</span><span class="op" id="5449867">)</span>&nbsp;<span class="op" id="5449869">!=</span>&nbsp;<span class="ident" id="5449872">n</span>&nbsp;<span class="op" id="5449874">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449879">s</span><span class="op" id="5449880">.</span><span class="ident" id="5449881">Name</span>&nbsp;<span class="op" id="5449886">=</span>&nbsp;<span class="ident" id="5449888">ast</span><span class="op" id="5449891">.</span><span class="ident" id="5449892">NewIdent</span><span class="op" id="5449900">(</span><span class="ident" id="5449901">n</span><span class="op" id="5449902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449910">importDecl</span><span class="op" id="5449920">.</span><span class="ident" id="5449921">Specs</span>&nbsp;<span class="op" id="5449927">=</span>&nbsp;<span class="builtinfunc" id="5449929">append</span><span class="op" id="5449935">(</span><span class="ident" id="5449936">importDecl</span><span class="op" id="5449946">.</span><span class="ident" id="5449947">Specs</span><span class="op" id="5449952">,</span>&nbsp;<span class="ident" id="5449954">s</span><span class="op" id="5449955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5449958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5449961">importDecl</span><span class="op" id="5449971">.</span><span class="ident" id="5449972">Specs</span>&nbsp;<span class="op" id="5449978">=</span>&nbsp;<span class="builtinfunc" id="5449980">append</span><span class="op" id="5449986">(</span><span class="ident" id="5449987">importDecl</span><span class="op" id="5449997">.</span><span class="ident" id="5449998">Specs</span><span class="op" id="5450003">,</span>&nbsp;<span class="ident" id="5450005">blankImports</span><span class="op" id="5450017">...</span><span class="op" id="5450020">)</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5450024">//&nbsp;Synthesize&nbsp;main&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450054">funcDecl</span>&nbsp;<span class="op" id="5450063">:=</span>&nbsp;<span class="op" id="5450066">&amp;</span><span class="ident" id="5450067">ast</span><span class="op" id="5450070">.</span><span class="ident" id="5450071">FuncDecl</span><span class="op" id="5450079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450083">Name</span><span class="op" id="5450087">:</span>&nbsp;<span class="ident" id="5450089">ast</span><span class="op" id="5450092">.</span><span class="ident" id="5450093">NewIdent</span><span class="op" id="5450101">(</span><span class="string" id="5450102">&#34;main&#34;</span><span class="op" id="5450108">)</span><span class="op" id="5450109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450113">Type</span><span class="op" id="5450117">:</span>&nbsp;<span class="op" id="5450119">&amp;</span><span class="ident" id="5450120">ast</span><span class="op" id="5450123">.</span><span class="ident" id="5450124">FuncType</span><span class="op" id="5450132">{</span><span class="ident" id="5450133">Params</span><span class="op" id="5450139">:</span>&nbsp;<span class="op" id="5450141">&amp;</span><span class="ident" id="5450142">ast</span><span class="op" id="5450145">.</span><span class="ident" id="5450146">FieldList</span><span class="op" id="5450155">{</span><span class="op" id="5450156">}</span><span class="op" id="5450157">}</span><span class="op" id="5450158">,</span>&nbsp;<span class="comment" id="5450160">//&nbsp;FuncType.Params&nbsp;must&nbsp;be&nbsp;non-nil</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450197">Body</span><span class="op" id="5450201">:</span>&nbsp;<span class="ident" id="5450203">body</span><span class="op" id="5450207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5450210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5450214">//&nbsp;Synthesize&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5450235">return</span>&nbsp;<span class="op" id="5450242">&amp;</span><span class="ident" id="5450243">ast</span><span class="op" id="5450246">.</span><span class="ident" id="5450247">File</span><span class="op" id="5450251">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450255">Name</span><span class="op" id="5450259">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5450265">ast</span><span class="op" id="5450268">.</span><span class="ident" id="5450269">NewIdent</span><span class="op" id="5450277">(</span><span class="string" id="5450278">&#34;main&#34;</span><span class="op" id="5450284">)</span><span class="op" id="5450285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450289">Decls</span><span class="op" id="5450294">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5450299">[</span><span class="op" id="5450300">]</span><span class="ident" id="5450301">ast</span><span class="op" id="5450304">.</span><span class="ident" id="5450305">Decl</span><span class="op" id="5450309">{</span><span class="ident" id="5450310">importDecl</span><span class="op" id="5450320">,</span>&nbsp;<span class="ident" id="5450322">funcDecl</span><span class="op" id="5450330">}</span><span class="op" id="5450331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450335">Comments</span><span class="op" id="5450343">:</span>&nbsp;<span class="ident" id="5450345">comments</span><span class="op" id="5450353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5450356">}</span><br>
<span class="lineno"></span><span class="op" id="5450358">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="5450361">//&nbsp;playExampleFile&nbsp;takes&nbsp;a&nbsp;whole&nbsp;file&nbsp;example&nbsp;and&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File</span><br>
<span class="lineno"></span><span class="comment" id="5450439">//&nbsp;such&nbsp;that&nbsp;the&nbsp;example&nbsp;is&nbsp;function&nbsp;main&nbsp;in&nbsp;package&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="5450498">func</span>&nbsp;<span class="ident" id="5450503">playExampleFile</span><span class="op" id="5450518">(</span><span class="ident" id="5450519">file</span>&nbsp;<span class="op" id="5450524">*</span><span class="ident" id="5450525">ast</span><span class="op" id="5450528">.</span><span class="ident" id="5450529">File</span><span class="op" id="5450533">)</span>&nbsp;<span class="op" id="5450535">*</span><span class="ident" id="5450536">ast</span><span class="op" id="5450539">.</span><span class="ident" id="5450540">File</span>&nbsp;<span class="op" id="5450545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5450548">//&nbsp;Strip&nbsp;copyright&nbsp;comment&nbsp;if&nbsp;present.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450588">comments</span>&nbsp;<span class="op" id="5450597">:=</span>&nbsp;<span class="ident" id="5450600">file</span><span class="op" id="5450604">.</span><span class="ident" id="5450605">Comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5450615">if</span>&nbsp;<span class="builtinfunc" id="5450618">len</span><span class="op" id="5450621">(</span><span class="ident" id="5450622">comments</span><span class="op" id="5450630">)</span>&nbsp;<span class="op" id="5450632">&gt;</span>&nbsp;<span class="num" id="5450634">0</span>&nbsp;<span class="op" id="5450636">&amp;&amp;</span>&nbsp;<span class="ident" id="5450639">strings</span><span class="op" id="5450646">.</span><span class="ident" id="5450647">HasPrefix</span><span class="op" id="5450656">(</span><span class="ident" id="5450657">comments</span><span class="op" id="5450665">[</span><span class="num" id="5450666">0</span><span class="op" id="5450667">]</span><span class="op" id="5450668">.</span><span class="ident" id="5450669">Text</span><span class="op" id="5450673">(</span><span class="op" id="5450674">)</span><span class="op" id="5450675">,</span>&nbsp;<span class="string" id="5450677">&#34;Copyright&#34;</span><span class="op" id="5450688">)</span>&nbsp;<span class="op" id="5450690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450694">comments</span>&nbsp;<span class="op" id="5450703">=</span>&nbsp;<span class="ident" id="5450705">comments</span><span class="op" id="5450713">[</span><span class="num" id="5450714">1</span><span class="op" id="5450715">:</span><span class="op" id="5450716">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5450719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5450723">//&nbsp;Copy&nbsp;declaration&nbsp;slice,&nbsp;rewriting&nbsp;the&nbsp;ExampleX&nbsp;function&nbsp;to&nbsp;main.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5450792">var</span>&nbsp;<span class="ident" id="5450796">decls</span>&nbsp;<span class="op" id="5450802">[</span><span class="op" id="5450803">]</span><span class="ident" id="5450804">ast</span><span class="op" id="5450807">.</span><span class="ident" id="5450808">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5450814">for</span>&nbsp;<span class="ident" id="5450818">_</span><span class="op" id="5450819">,</span>&nbsp;<span class="ident" id="5450821">d</span>&nbsp;<span class="op" id="5450823">:=</span>&nbsp;<span class="keyword" id="5450826">range</span>&nbsp;<span class="ident" id="5450832">file</span><span class="op" id="5450836">.</span><span class="ident" id="5450837">Decls</span>&nbsp;<span class="op" id="5450843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5450847">if</span>&nbsp;<span class="ident" id="5450850">f</span><span class="op" id="5450851">,</span>&nbsp;<span class="ident" id="5450853">ok</span>&nbsp;<span class="op" id="5450856">:=</span>&nbsp;<span class="ident" id="5450859">d</span><span class="op" id="5450860">.</span><span class="op" id="5450861">(</span><span class="op" id="5450862">*</span><span class="ident" id="5450863">ast</span><span class="op" id="5450866">.</span><span class="ident" id="5450867">FuncDecl</span><span class="op" id="5450875">)</span><span class="op" id="5450876">;</span>&nbsp;<span class="ident" id="5450878">ok</span>&nbsp;<span class="op" id="5450881">&amp;&amp;</span>&nbsp;<span class="ident" id="5450884">isTest</span><span class="op" id="5450890">(</span><span class="ident" id="5450891">f</span><span class="op" id="5450892">.</span><span class="ident" id="5450893">Name</span><span class="op" id="5450897">.</span><span class="ident" id="5450898">Name</span><span class="op" id="5450902">,</span>&nbsp;<span class="string" id="5450904">&#34;Example&#34;</span><span class="op" id="5450913">)</span>&nbsp;<span class="op" id="5450915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5450920">//&nbsp;Copy&nbsp;the&nbsp;FuncDecl,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450974">newF</span>&nbsp;<span class="op" id="5450979">:=</span>&nbsp;<span class="op" id="5450982">*</span><span class="ident" id="5450983">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5450988">newF</span><span class="op" id="5450992">.</span><span class="ident" id="5450993">Name</span>&nbsp;<span class="op" id="5450998">=</span>&nbsp;<span class="ident" id="5451000">ast</span><span class="op" id="5451003">.</span><span class="ident" id="5451004">NewIdent</span><span class="op" id="5451012">(</span><span class="string" id="5451013">&#34;main&#34;</span><span class="op" id="5451019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451024">newF</span><span class="op" id="5451028">.</span><span class="ident" id="5451029">Body</span><span class="op" id="5451033">,</span>&nbsp;<span class="ident" id="5451035">comments</span>&nbsp;<span class="op" id="5451044">=</span>&nbsp;<span class="ident" id="5451046">stripOutputComment</span><span class="op" id="5451064">(</span><span class="ident" id="5451065">f</span><span class="op" id="5451066">.</span><span class="ident" id="5451067">Body</span><span class="op" id="5451071">,</span>&nbsp;<span class="ident" id="5451073">comments</span><span class="op" id="5451081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451086">d</span>&nbsp;<span class="op" id="5451088">=</span>&nbsp;<span class="op" id="5451090">&amp;</span><span class="ident" id="5451091">newF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5451098">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451102">decls</span>&nbsp;<span class="op" id="5451108">=</span>&nbsp;<span class="builtinfunc" id="5451110">append</span><span class="op" id="5451116">(</span><span class="ident" id="5451117">decls</span><span class="op" id="5451122">,</span>&nbsp;<span class="ident" id="5451124">d</span><span class="op" id="5451125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5451128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5451132">//&nbsp;Copy&nbsp;the&nbsp;File,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451180">f</span>&nbsp;<span class="op" id="5451182">:=</span>&nbsp;<span class="op" id="5451185">*</span><span class="ident" id="5451186">file</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451192">f</span><span class="op" id="5451193">.</span><span class="ident" id="5451194">Name</span>&nbsp;<span class="op" id="5451199">=</span>&nbsp;<span class="ident" id="5451201">ast</span><span class="op" id="5451204">.</span><span class="ident" id="5451205">NewIdent</span><span class="op" id="5451213">(</span><span class="string" id="5451214">&#34;main&#34;</span><span class="op" id="5451220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451223">f</span><span class="op" id="5451224">.</span><span class="ident" id="5451225">Decls</span>&nbsp;<span class="op" id="5451231">=</span>&nbsp;<span class="ident" id="5451233">decls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451240">f</span><span class="op" id="5451241">.</span><span class="ident" id="5451242">Comments</span>&nbsp;<span class="op" id="5451251">=</span>&nbsp;<span class="ident" id="5451253">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5451263">return</span>&nbsp;<span class="op" id="5451270">&amp;</span><span class="ident" id="5451271">f</span><br>
<span class="lineno"></span><span class="op" id="5451273">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5451276">//&nbsp;stripOutputComment&nbsp;finds&nbsp;and&nbsp;removes&nbsp;an&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;from&nbsp;body</span><br>
<span class="lineno"></span><span class="comment" id="5451347">//&nbsp;and&nbsp;comments,&nbsp;and&nbsp;adjusts&nbsp;the&nbsp;body&nbsp;block&#39;s&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="5451407">func</span>&nbsp;<span class="ident" id="5451412">stripOutputComment</span><span class="op" id="5451430">(</span><span class="ident" id="5451431">body</span>&nbsp;<span class="op" id="5451436">*</span><span class="ident" id="5451437">ast</span><span class="op" id="5451440">.</span><span class="ident" id="5451441">BlockStmt</span><span class="op" id="5451450">,</span>&nbsp;<span class="ident" id="5451452">comments</span>&nbsp;<span class="op" id="5451461">[</span><span class="op" id="5451462">]</span><span class="op" id="5451463">*</span><span class="ident" id="5451464">ast</span><span class="op" id="5451467">.</span><span class="ident" id="5451468">CommentGroup</span><span class="op" id="5451480">)</span>&nbsp;<span class="op" id="5451482">(</span><span class="op" id="5451483">*</span><span class="ident" id="5451484">ast</span><span class="op" id="5451487">.</span><span class="ident" id="5451488">BlockStmt</span><span class="op" id="5451497">,</span>&nbsp;<span class="op" id="5451499">[</span><span class="op" id="5451500">]</span><span class="op" id="5451501">*</span><span class="ident" id="5451502">ast</span><span class="op" id="5451505">.</span><span class="ident" id="5451506">CommentGroup</span><span class="op" id="5451518">)</span>&nbsp;<span class="op" id="5451520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5451523">//&nbsp;Do&nbsp;nothing&nbsp;if&nbsp;no&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;found.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451569">i</span><span class="op" id="5451570">,</span>&nbsp;<span class="ident" id="5451572">last</span>&nbsp;<span class="op" id="5451577">:=</span>&nbsp;<span class="ident" id="5451580">lastComment</span><span class="op" id="5451591">(</span><span class="ident" id="5451592">body</span><span class="op" id="5451596">,</span>&nbsp;<span class="ident" id="5451598">comments</span><span class="op" id="5451606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5451609">if</span>&nbsp;<span class="ident" id="5451612">last</span>&nbsp;<span class="op" id="5451617">==</span>&nbsp;<span class="ident" id="5451620">nil</span>&nbsp;<span class="op" id="5451624">||</span>&nbsp;<span class="op" id="5451627">!</span><span class="ident" id="5451628">outputPrefix</span><span class="op" id="5451640">.</span><span class="ident" id="5451641">MatchString</span><span class="op" id="5451652">(</span><span class="ident" id="5451653">last</span><span class="op" id="5451657">.</span><span class="ident" id="5451658">Text</span><span class="op" id="5451662">(</span><span class="op" id="5451663">)</span><span class="op" id="5451664">)</span>&nbsp;<span class="op" id="5451666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5451670">return</span>&nbsp;<span class="ident" id="5451677">body</span><span class="op" id="5451681">,</span>&nbsp;<span class="ident" id="5451683">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5451693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5451697">//&nbsp;Copy&nbsp;body&nbsp;and&nbsp;comments,&nbsp;as&nbsp;the&nbsp;originals&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451765">newBody</span>&nbsp;<span class="op" id="5451773">:=</span>&nbsp;<span class="op" id="5451776">&amp;</span><span class="ident" id="5451777">ast</span><span class="op" id="5451780">.</span><span class="ident" id="5451781">BlockStmt</span><span class="op" id="5451790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451794">Lbrace</span><span class="op" id="5451800">:</span>&nbsp;<span class="ident" id="5451802">body</span><span class="op" id="5451806">.</span><span class="ident" id="5451807">Lbrace</span><span class="op" id="5451813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451817">List</span><span class="op" id="5451821">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5451825">body</span><span class="op" id="5451829">.</span><span class="ident" id="5451830">List</span><span class="op" id="5451834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451838">Rbrace</span><span class="op" id="5451844">:</span>&nbsp;<span class="ident" id="5451846">last</span><span class="op" id="5451850">.</span><span class="ident" id="5451851">Pos</span><span class="op" id="5451854">(</span><span class="op" id="5451855">)</span><span class="op" id="5451856">,</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5451859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5451862">newComments</span>&nbsp;<span class="op" id="5451874">:=</span>&nbsp;<span class="builtinfunc" id="5451877">make</span><span class="op" id="5451881">(</span><span class="op" id="5451882">[</span><span class="op" id="5451883">]</span><span class="op" id="5451884">*</span><span class="ident" id="5451885">ast</span><span class="op" id="5451888">.</span><span class="ident" id="5451889">CommentGroup</span><span class="op" id="5451901">,</span>&nbsp;<span class="builtinfunc" id="5451903">len</span><span class="op" id="5451906">(</span><span class="ident" id="5451907">comments</span><span class="op" id="5451915">)</span><span class="op" id="5451916">-</span><span class="num" id="5451917">1</span><span class="op" id="5451918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5451921">copy</span><span class="op" id="5451925">(</span><span class="ident" id="5451926">newComments</span><span class="op" id="5451937">,</span>&nbsp;<span class="ident" id="5451939">comments</span><span class="op" id="5451947">[</span><span class="op" id="5451948">:</span><span class="ident" id="5451949">i</span><span class="op" id="5451950">]</span><span class="op" id="5451951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5451954">copy</span><span class="op" id="5451958">(</span><span class="ident" id="5451959">newComments</span><span class="op" id="5451970">[</span><span class="ident" id="5451971">i</span><span class="op" id="5451972">:</span><span class="op" id="5451973">]</span><span class="op" id="5451974">,</span>&nbsp;<span class="ident" id="5451976">comments</span><span class="op" id="5451984">[</span><span class="ident" id="5451985">i</span><span class="op" id="5451986">+</span><span class="num" id="5451987">1</span><span class="op" id="5451988">:</span><span class="op" id="5451989">]</span><span class="op" id="5451990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5451993">return</span>&nbsp;<span class="ident" id="5452000">newBody</span><span class="op" id="5452007">,</span>&nbsp;<span class="ident" id="5452009">newComments</span><br>
<span class="lineno">340</span><span class="op" id="5452021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5452024">//&nbsp;lastComment&nbsp;returns&nbsp;the&nbsp;last&nbsp;comment&nbsp;inside&nbsp;the&nbsp;provided&nbsp;block.</span><br>
<span class="lineno"></span><span class="keyword" id="5452091">func</span>&nbsp;<span class="ident" id="5452096">lastComment</span><span class="op" id="5452107">(</span><span class="ident" id="5452108">b</span>&nbsp;<span class="op" id="5452110">*</span><span class="ident" id="5452111">ast</span><span class="op" id="5452114">.</span><span class="ident" id="5452115">BlockStmt</span><span class="op" id="5452124">,</span>&nbsp;<span class="ident" id="5452126">c</span>&nbsp;<span class="op" id="5452128">[</span><span class="op" id="5452129">]</span><span class="op" id="5452130">*</span><span class="ident" id="5452131">ast</span><span class="op" id="5452134">.</span><span class="ident" id="5452135">CommentGroup</span><span class="op" id="5452147">)</span>&nbsp;<span class="op" id="5452149">(</span><span class="ident" id="5452150">i</span>&nbsp;<span class="builtintype" id="5452152">int</span><span class="op" id="5452155">,</span>&nbsp;<span class="ident" id="5452157">last</span>&nbsp;<span class="op" id="5452162">*</span><span class="ident" id="5452163">ast</span><span class="op" id="5452166">.</span><span class="ident" id="5452167">CommentGroup</span><span class="op" id="5452179">)</span>&nbsp;<span class="op" id="5452181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5452184">pos</span><span class="op" id="5452187">,</span>&nbsp;<span class="ident" id="5452189">end</span>&nbsp;<span class="op" id="5452193">:=</span>&nbsp;<span class="ident" id="5452196">b</span><span class="op" id="5452197">.</span><span class="ident" id="5452198">Pos</span><span class="op" id="5452201">(</span><span class="op" id="5452202">)</span><span class="op" id="5452203">,</span>&nbsp;<span class="ident" id="5452205">b</span><span class="op" id="5452206">.</span><span class="ident" id="5452207">End</span><span class="op" id="5452210">(</span><span class="op" id="5452211">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5452214">for</span>&nbsp;<span class="ident" id="5452218">j</span><span class="op" id="5452219">,</span>&nbsp;<span class="ident" id="5452221">cg</span>&nbsp;<span class="op" id="5452224">:=</span>&nbsp;<span class="keyword" id="5452227">range</span>&nbsp;<span class="ident" id="5452233">c</span>&nbsp;<span class="op" id="5452235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5452239">if</span>&nbsp;<span class="ident" id="5452242">cg</span><span class="op" id="5452244">.</span><span class="ident" id="5452245">Pos</span><span class="op" id="5452248">(</span><span class="op" id="5452249">)</span>&nbsp;<span class="op" id="5452251">&lt;</span>&nbsp;<span class="ident" id="5452253">pos</span>&nbsp;<span class="op" id="5452257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5452262">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5452273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5452277">if</span>&nbsp;<span class="ident" id="5452280">cg</span><span class="op" id="5452282">.</span><span class="ident" id="5452283">End</span><span class="op" id="5452286">(</span><span class="op" id="5452287">)</span>&nbsp;<span class="op" id="5452289">&gt;</span>&nbsp;<span class="ident" id="5452291">end</span>&nbsp;<span class="op" id="5452295">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5452300">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5452308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5452312">i</span><span class="op" id="5452313">,</span>&nbsp;<span class="ident" id="5452315">last</span>&nbsp;<span class="op" id="5452320">=</span>&nbsp;<span class="ident" id="5452322">j</span><span class="op" id="5452323">,</span>&nbsp;<span class="ident" id="5452325">cg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5452329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5452332">return</span><br>
<span class="lineno">355</span><span class="op" id="5452339">}</span>
</div>
</body>
</html>
