<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5058930">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5058985">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5059039">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5059090">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5059160">package</span>&nbsp;<span class="ident" id="5059168">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5059174">import</span>&nbsp;<span class="op" id="5059181">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5059184">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5059193">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5059199">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5059209">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="5059212">var</span>&nbsp;<span class="ident" id="5059216">typeFiles</span>&nbsp;<span class="op" id="5059226">=</span>&nbsp;<span class="op" id="5059228">[</span><span class="op" id="5059229">]</span><span class="builtintype" id="5059230">string</span><span class="op" id="5059236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5059239">&#34;/etc/mime.types&#34;</span><span class="op" id="5059256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5059259">&#34;/etc/apache2/mime.types&#34;</span><span class="op" id="5059284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5059287">&#34;/etc/apache/mime.types&#34;</span><span class="op" id="5059311">,</span><br>
<span class="lineno"></span><span class="op" id="5059313">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5059316">func</span>&nbsp;<span class="ident" id="5059321">loadMimeFile</span><span class="op" id="5059333">(</span><span class="ident" id="5059334">filename</span>&nbsp;<span class="builtintype" id="5059343">string</span><span class="op" id="5059349">)</span>&nbsp;<span class="op" id="5059351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5059354">f</span><span class="op" id="5059355">,</span>&nbsp;<span class="ident" id="5059357">err</span>&nbsp;<span class="op" id="5059361">:=</span>&nbsp;<span class="ident" id="5059364">os</span><span class="op" id="5059366">.</span><span class="ident" id="5059367">Open</span><span class="op" id="5059371">(</span><span class="ident" id="5059372">filename</span><span class="op" id="5059380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059383">if</span>&nbsp;<span class="ident" id="5059386">err</span>&nbsp;<span class="op" id="5059390">!=</span>&nbsp;<span class="ident" id="5059393">nil</span>&nbsp;<span class="op" id="5059397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059401">return</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5059409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059412">defer</span>&nbsp;<span class="ident" id="5059418">f</span><span class="op" id="5059419">.</span><span class="ident" id="5059420">Close</span><span class="op" id="5059425">(</span><span class="op" id="5059426">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5059430">scanner</span>&nbsp;<span class="op" id="5059438">:=</span>&nbsp;<span class="ident" id="5059441">bufio</span><span class="op" id="5059446">.</span><span class="ident" id="5059447">NewScanner</span><span class="op" id="5059457">(</span><span class="ident" id="5059458">f</span><span class="op" id="5059459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059462">for</span>&nbsp;<span class="ident" id="5059466">scanner</span><span class="op" id="5059473">.</span><span class="ident" id="5059474">Scan</span><span class="op" id="5059478">(</span><span class="op" id="5059479">)</span>&nbsp;<span class="op" id="5059481">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5059485">fields</span>&nbsp;<span class="op" id="5059492">:=</span>&nbsp;<span class="ident" id="5059495">strings</span><span class="op" id="5059502">.</span><span class="ident" id="5059503">Fields</span><span class="op" id="5059509">(</span><span class="ident" id="5059510">scanner</span><span class="op" id="5059517">.</span><span class="ident" id="5059518">Text</span><span class="op" id="5059522">(</span><span class="op" id="5059523">)</span><span class="op" id="5059524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059528">if</span>&nbsp;<span class="builtinfunc" id="5059531">len</span><span class="op" id="5059534">(</span><span class="ident" id="5059535">fields</span><span class="op" id="5059541">)</span>&nbsp;<span class="op" id="5059543">&lt;=</span>&nbsp;<span class="num" id="5059546">1</span>&nbsp;<span class="op" id="5059548">||</span>&nbsp;<span class="ident" id="5059551">fields</span><span class="op" id="5059557">[</span><span class="num" id="5059558">0</span><span class="op" id="5059559">]</span><span class="op" id="5059560">[</span><span class="num" id="5059561">0</span><span class="op" id="5059562">]</span>&nbsp;<span class="op" id="5059564">==</span>&nbsp;<span class="string" id="5059567">&#39;#&#39;</span>&nbsp;<span class="op" id="5059571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059576">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5059587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5059591">mimeType</span>&nbsp;<span class="op" id="5059600">:=</span>&nbsp;<span class="ident" id="5059603">fields</span><span class="op" id="5059609">[</span><span class="num" id="5059610">0</span><span class="op" id="5059611">]</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059615">for</span>&nbsp;<span class="ident" id="5059619">_</span><span class="op" id="5059620">,</span>&nbsp;<span class="ident" id="5059622">ext</span>&nbsp;<span class="op" id="5059626">:=</span>&nbsp;<span class="keyword" id="5059629">range</span>&nbsp;<span class="ident" id="5059635">fields</span><span class="op" id="5059641">[</span><span class="num" id="5059642">1</span><span class="op" id="5059643">:</span><span class="op" id="5059644">]</span>&nbsp;<span class="op" id="5059646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059651">if</span>&nbsp;<span class="ident" id="5059654">ext</span><span class="op" id="5059657">[</span><span class="num" id="5059658">0</span><span class="op" id="5059659">]</span>&nbsp;<span class="op" id="5059661">==</span>&nbsp;<span class="string" id="5059664">&#39;#&#39;</span>&nbsp;<span class="op" id="5059668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059674">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5059683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5059688">setExtensionType</span><span class="op" id="5059704">(</span><span class="string" id="5059705">&#34;.&#34;</span><span class="op" id="5059708">+</span><span class="ident" id="5059709">ext</span><span class="op" id="5059712">,</span>&nbsp;<span class="ident" id="5059714">mimeType</span><span class="op" id="5059722">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5059726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5059729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059732">if</span>&nbsp;<span class="ident" id="5059735">err</span>&nbsp;<span class="op" id="5059739">:=</span>&nbsp;<span class="ident" id="5059742">scanner</span><span class="op" id="5059749">.</span><span class="ident" id="5059750">Err</span><span class="op" id="5059753">(</span><span class="op" id="5059754">)</span><span class="op" id="5059755">;</span>&nbsp;<span class="ident" id="5059757">err</span>&nbsp;<span class="op" id="5059761">!=</span>&nbsp;<span class="ident" id="5059764">nil</span>&nbsp;<span class="op" id="5059768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5059772">panic</span><span class="op" id="5059777">(</span><span class="ident" id="5059778">err</span><span class="op" id="5059781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5059784">}</span><br>
<span class="lineno">45</span><span class="op" id="5059786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5059789">func</span>&nbsp;<span class="ident" id="5059794">initMime</span><span class="op" id="5059802">(</span><span class="op" id="5059803">)</span>&nbsp;<span class="op" id="5059805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059808">for</span>&nbsp;<span class="ident" id="5059812">_</span><span class="op" id="5059813">,</span>&nbsp;<span class="ident" id="5059815">filename</span>&nbsp;<span class="op" id="5059824">:=</span>&nbsp;<span class="keyword" id="5059827">range</span>&nbsp;<span class="ident" id="5059833">typeFiles</span>&nbsp;<span class="op" id="5059843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5059847">loadMimeFile</span><span class="op" id="5059859">(</span><span class="ident" id="5059860">filename</span><span class="op" id="5059868">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5059871">}</span><br>
<span class="lineno"></span><span class="op" id="5059873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5059876">func</span>&nbsp;<span class="ident" id="5059881">initMimeForTests</span><span class="op" id="5059897">(</span><span class="op" id="5059898">)</span>&nbsp;<span class="keyword" id="5059900">map</span><span class="op" id="5059903">[</span><span class="builtintype" id="5059904">string</span><span class="op" id="5059910">]</span><span class="builtintype" id="5059911">string</span>&nbsp;<span class="op" id="5059918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5059921">typeFiles</span>&nbsp;<span class="op" id="5059931">=</span>&nbsp;<span class="op" id="5059933">[</span><span class="op" id="5059934">]</span><span class="builtintype" id="5059935">string</span><span class="op" id="5059941">{</span><span class="string" id="5059942">&#34;testdata/test.types&#34;</span><span class="op" id="5059963">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5059966">return</span>&nbsp;<span class="keyword" id="5059973">map</span><span class="op" id="5059976">[</span><span class="builtintype" id="5059977">string</span><span class="op" id="5059983">]</span><span class="builtintype" id="5059984">string</span><span class="op" id="5059990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5059994">&#34;.T1&#34;</span><span class="op" id="5059999">:</span>&nbsp;&nbsp;<span class="string" id="5060002">&#34;application/test&#34;</span><span class="op" id="5060020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5060024">&#34;.t2&#34;</span><span class="op" id="5060029">:</span>&nbsp;&nbsp;<span class="string" id="5060032">&#34;text/test;&nbsp;charset=utf-8&#34;</span><span class="op" id="5060058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5060062">&#34;.png&#34;</span><span class="op" id="5060068">:</span>&nbsp;<span class="string" id="5060070">&#34;image/png&#34;</span><span class="op" id="5060081">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5060084">}</span><br>
<span class="lineno">60</span><span class="op" id="5060086">}</span>
</div>
</body>
</html>
