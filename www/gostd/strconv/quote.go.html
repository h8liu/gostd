<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1728593">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1728648">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1728702">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1728753">//go:generate&nbsp;go&nbsp;run&nbsp;makeisprint.go&nbsp;-output&nbsp;isprint.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1728809">package</span>&nbsp;<span class="ident" id="1728817">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1728826">import</span>&nbsp;<span class="op" id="1728833">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1728836">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="1728851">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1728854">const</span>&nbsp;<span class="ident" id="1728860">lowerhex</span>&nbsp;<span class="op" id="1728869">=</span>&nbsp;<span class="string" id="1728871">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1728891">func</span>&nbsp;<span class="ident" id="1728896">quoteWith</span><span class="op" id="1728905">(</span><span class="ident" id="1728906">s</span>&nbsp;<span class="builtintype" id="1728908">string</span><span class="op" id="1728914">,</span>&nbsp;<span class="ident" id="1728916">quote</span>&nbsp;<span class="builtintype" id="1728922">byte</span><span class="op" id="1728926">,</span>&nbsp;<span class="ident" id="1728928">ASCIIonly</span>&nbsp;<span class="builtintype" id="1728938">bool</span><span class="op" id="1728942">)</span>&nbsp;<span class="builtintype" id="1728944">string</span>&nbsp;<span class="op" id="1728951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728954">var</span>&nbsp;<span class="ident" id="1728958">runeTmp</span>&nbsp;<span class="op" id="1728966">[</span><span class="ident" id="1728967">utf8</span><span class="op" id="1728971">.</span><span class="ident" id="1728972">UTFMax</span><span class="op" id="1728978">]</span><span class="builtintype" id="1728979">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1728985">buf</span>&nbsp;<span class="op" id="1728989">:=</span>&nbsp;<span class="builtinfunc" id="1728992">make</span><span class="op" id="1728996">(</span><span class="op" id="1728997">[</span><span class="op" id="1728998">]</span><span class="builtintype" id="1728999">byte</span><span class="op" id="1729003">,</span>&nbsp;<span class="num" id="1729005">0</span><span class="op" id="1729006">,</span>&nbsp;<span class="num" id="1729008">3</span><span class="op" id="1729009">*</span><span class="builtinfunc" id="1729010">len</span><span class="op" id="1729013">(</span><span class="ident" id="1729014">s</span><span class="op" id="1729015">)</span><span class="op" id="1729016">/</span><span class="num" id="1729017">2</span><span class="op" id="1729018">)</span>&nbsp;<span class="comment" id="1729020">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729055">buf</span>&nbsp;<span class="op" id="1729059">=</span>&nbsp;<span class="builtinfunc" id="1729061">append</span><span class="op" id="1729067">(</span><span class="ident" id="1729068">buf</span><span class="op" id="1729071">,</span>&nbsp;<span class="ident" id="1729073">quote</span><span class="op" id="1729078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729081">for</span>&nbsp;<span class="ident" id="1729085">width</span>&nbsp;<span class="op" id="1729091">:=</span>&nbsp;<span class="num" id="1729094">0</span><span class="op" id="1729095">;</span>&nbsp;<span class="builtinfunc" id="1729097">len</span><span class="op" id="1729100">(</span><span class="ident" id="1729101">s</span><span class="op" id="1729102">)</span>&nbsp;<span class="op" id="1729104">&gt;</span>&nbsp;<span class="num" id="1729106">0</span><span class="op" id="1729107">;</span>&nbsp;<span class="ident" id="1729109">s</span>&nbsp;<span class="op" id="1729111">=</span>&nbsp;<span class="ident" id="1729113">s</span><span class="op" id="1729114">[</span><span class="ident" id="1729115">width</span><span class="op" id="1729120">:</span><span class="op" id="1729121">]</span>&nbsp;<span class="op" id="1729123">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729127">r</span>&nbsp;<span class="op" id="1729129">:=</span>&nbsp;<span class="builtintype" id="1729132">rune</span><span class="op" id="1729136">(</span><span class="ident" id="1729137">s</span><span class="op" id="1729138">[</span><span class="num" id="1729139">0</span><span class="op" id="1729140">]</span><span class="op" id="1729141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729145">width</span>&nbsp;<span class="op" id="1729151">=</span>&nbsp;<span class="num" id="1729153">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729157">if</span>&nbsp;<span class="ident" id="1729160">r</span>&nbsp;<span class="op" id="1729162">&gt;=</span>&nbsp;<span class="ident" id="1729165">utf8</span><span class="op" id="1729169">.</span><span class="ident" id="1729170">RuneSelf</span>&nbsp;<span class="op" id="1729179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729184">r</span><span class="op" id="1729185">,</span>&nbsp;<span class="ident" id="1729187">width</span>&nbsp;<span class="op" id="1729193">=</span>&nbsp;<span class="ident" id="1729195">utf8</span><span class="op" id="1729199">.</span><span class="ident" id="1729200">DecodeRuneInString</span><span class="op" id="1729218">(</span><span class="ident" id="1729219">s</span><span class="op" id="1729220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729224">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729228">if</span>&nbsp;<span class="ident" id="1729231">width</span>&nbsp;<span class="op" id="1729237">==</span>&nbsp;<span class="num" id="1729240">1</span>&nbsp;<span class="op" id="1729242">&amp;&amp;</span>&nbsp;<span class="ident" id="1729245">r</span>&nbsp;<span class="op" id="1729247">==</span>&nbsp;<span class="ident" id="1729250">utf8</span><span class="op" id="1729254">.</span><span class="ident" id="1729255">RuneError</span>&nbsp;<span class="op" id="1729265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729270">buf</span>&nbsp;<span class="op" id="1729274">=</span>&nbsp;<span class="builtinfunc" id="1729276">append</span><span class="op" id="1729282">(</span><span class="ident" id="1729283">buf</span><span class="op" id="1729286">,</span>&nbsp;<span class="string" id="1729288">`\x`</span><span class="op" id="1729292">...</span><span class="op" id="1729295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729300">buf</span>&nbsp;<span class="op" id="1729304">=</span>&nbsp;<span class="builtinfunc" id="1729306">append</span><span class="op" id="1729312">(</span><span class="ident" id="1729313">buf</span><span class="op" id="1729316">,</span>&nbsp;<span class="ident" id="1729318">lowerhex</span><span class="op" id="1729326">[</span><span class="ident" id="1729327">s</span><span class="op" id="1729328">[</span><span class="num" id="1729329">0</span><span class="op" id="1729330">]</span><span class="op" id="1729331">&gt;&gt;</span><span class="num" id="1729333">4</span><span class="op" id="1729334">]</span><span class="op" id="1729335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729340">buf</span>&nbsp;<span class="op" id="1729344">=</span>&nbsp;<span class="builtinfunc" id="1729346">append</span><span class="op" id="1729352">(</span><span class="ident" id="1729353">buf</span><span class="op" id="1729356">,</span>&nbsp;<span class="ident" id="1729358">lowerhex</span><span class="op" id="1729366">[</span><span class="ident" id="1729367">s</span><span class="op" id="1729368">[</span><span class="num" id="1729369">0</span><span class="op" id="1729370">]</span><span class="op" id="1729371">&amp;</span><span class="num" id="1729372">0xF</span><span class="op" id="1729375">]</span><span class="op" id="1729376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729381">continue</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729396">if</span>&nbsp;<span class="ident" id="1729399">r</span>&nbsp;<span class="op" id="1729401">==</span>&nbsp;<span class="builtintype" id="1729404">rune</span><span class="op" id="1729408">(</span><span class="ident" id="1729409">quote</span><span class="op" id="1729414">)</span>&nbsp;<span class="op" id="1729416">||</span>&nbsp;<span class="ident" id="1729419">r</span>&nbsp;<span class="op" id="1729421">==</span>&nbsp;<span class="string" id="1729424">&#39;\\&#39;</span>&nbsp;<span class="op" id="1729429">{</span>&nbsp;<span class="comment" id="1729431">//&nbsp;always&nbsp;backslashed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729456">buf</span>&nbsp;<span class="op" id="1729460">=</span>&nbsp;<span class="builtinfunc" id="1729462">append</span><span class="op" id="1729468">(</span><span class="ident" id="1729469">buf</span><span class="op" id="1729472">,</span>&nbsp;<span class="string" id="1729474">&#39;\\&#39;</span><span class="op" id="1729478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729483">buf</span>&nbsp;<span class="op" id="1729487">=</span>&nbsp;<span class="builtinfunc" id="1729489">append</span><span class="op" id="1729495">(</span><span class="ident" id="1729496">buf</span><span class="op" id="1729499">,</span>&nbsp;<span class="builtintype" id="1729501">byte</span><span class="op" id="1729505">(</span><span class="ident" id="1729506">r</span><span class="op" id="1729507">)</span><span class="op" id="1729508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729513">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729528">if</span>&nbsp;<span class="ident" id="1729531">ASCIIonly</span>&nbsp;<span class="op" id="1729541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729546">if</span>&nbsp;<span class="ident" id="1729549">r</span>&nbsp;<span class="op" id="1729551">&lt;</span>&nbsp;<span class="ident" id="1729553">utf8</span><span class="op" id="1729557">.</span><span class="ident" id="1729558">RuneSelf</span>&nbsp;<span class="op" id="1729567">&amp;&amp;</span>&nbsp;<span class="ident" id="1729570">IsPrint</span><span class="op" id="1729577">(</span><span class="ident" id="1729578">r</span><span class="op" id="1729579">)</span>&nbsp;<span class="op" id="1729581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729587">buf</span>&nbsp;<span class="op" id="1729591">=</span>&nbsp;<span class="builtinfunc" id="1729593">append</span><span class="op" id="1729599">(</span><span class="ident" id="1729600">buf</span><span class="op" id="1729603">,</span>&nbsp;<span class="builtintype" id="1729605">byte</span><span class="op" id="1729609">(</span><span class="ident" id="1729610">r</span><span class="op" id="1729611">)</span><span class="op" id="1729612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729618">continue</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729634">}</span>&nbsp;<span class="keyword" id="1729636">else</span>&nbsp;<span class="keyword" id="1729641">if</span>&nbsp;<span class="ident" id="1729644">IsPrint</span><span class="op" id="1729651">(</span><span class="ident" id="1729652">r</span><span class="op" id="1729653">)</span>&nbsp;<span class="op" id="1729655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729660">n</span>&nbsp;<span class="op" id="1729662">:=</span>&nbsp;<span class="ident" id="1729665">utf8</span><span class="op" id="1729669">.</span><span class="ident" id="1729670">EncodeRune</span><span class="op" id="1729680">(</span><span class="ident" id="1729681">runeTmp</span><span class="op" id="1729688">[</span><span class="op" id="1729689">:</span><span class="op" id="1729690">]</span><span class="op" id="1729691">,</span>&nbsp;<span class="ident" id="1729693">r</span><span class="op" id="1729694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729699">buf</span>&nbsp;<span class="op" id="1729703">=</span>&nbsp;<span class="builtinfunc" id="1729705">append</span><span class="op" id="1729711">(</span><span class="ident" id="1729712">buf</span><span class="op" id="1729715">,</span>&nbsp;<span class="ident" id="1729717">runeTmp</span><span class="op" id="1729724">[</span><span class="op" id="1729725">:</span><span class="ident" id="1729726">n</span><span class="op" id="1729727">]</span><span class="op" id="1729728">...</span><span class="op" id="1729731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729736">continue</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729751">switch</span>&nbsp;<span class="ident" id="1729758">r</span>&nbsp;<span class="op" id="1729760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729764">case</span>&nbsp;<span class="string" id="1729769">&#39;\a&#39;</span><span class="op" id="1729773">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729778">buf</span>&nbsp;<span class="op" id="1729782">=</span>&nbsp;<span class="builtinfunc" id="1729784">append</span><span class="op" id="1729790">(</span><span class="ident" id="1729791">buf</span><span class="op" id="1729794">,</span>&nbsp;<span class="string" id="1729796">`\a`</span><span class="op" id="1729800">...</span><span class="op" id="1729803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729807">case</span>&nbsp;<span class="string" id="1729812">&#39;\b&#39;</span><span class="op" id="1729816">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729821">buf</span>&nbsp;<span class="op" id="1729825">=</span>&nbsp;<span class="builtinfunc" id="1729827">append</span><span class="op" id="1729833">(</span><span class="ident" id="1729834">buf</span><span class="op" id="1729837">,</span>&nbsp;<span class="string" id="1729839">`\b`</span><span class="op" id="1729843">...</span><span class="op" id="1729846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729850">case</span>&nbsp;<span class="string" id="1729855">&#39;\f&#39;</span><span class="op" id="1729859">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729864">buf</span>&nbsp;<span class="op" id="1729868">=</span>&nbsp;<span class="builtinfunc" id="1729870">append</span><span class="op" id="1729876">(</span><span class="ident" id="1729877">buf</span><span class="op" id="1729880">,</span>&nbsp;<span class="string" id="1729882">`\f`</span><span class="op" id="1729886">...</span><span class="op" id="1729889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729893">case</span>&nbsp;<span class="string" id="1729898">&#39;\n&#39;</span><span class="op" id="1729902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729907">buf</span>&nbsp;<span class="op" id="1729911">=</span>&nbsp;<span class="builtinfunc" id="1729913">append</span><span class="op" id="1729919">(</span><span class="ident" id="1729920">buf</span><span class="op" id="1729923">,</span>&nbsp;<span class="string" id="1729925">`\n`</span><span class="op" id="1729929">...</span><span class="op" id="1729932">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729936">case</span>&nbsp;<span class="string" id="1729941">&#39;\r&#39;</span><span class="op" id="1729945">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729950">buf</span>&nbsp;<span class="op" id="1729954">=</span>&nbsp;<span class="builtinfunc" id="1729956">append</span><span class="op" id="1729962">(</span><span class="ident" id="1729963">buf</span><span class="op" id="1729966">,</span>&nbsp;<span class="string" id="1729968">`\r`</span><span class="op" id="1729972">...</span><span class="op" id="1729975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729979">case</span>&nbsp;<span class="string" id="1729984">&#39;\t&#39;</span><span class="op" id="1729988">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729993">buf</span>&nbsp;<span class="op" id="1729997">=</span>&nbsp;<span class="builtinfunc" id="1729999">append</span><span class="op" id="1730005">(</span><span class="ident" id="1730006">buf</span><span class="op" id="1730009">,</span>&nbsp;<span class="string" id="1730011">`\t`</span><span class="op" id="1730015">...</span><span class="op" id="1730018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730022">case</span>&nbsp;<span class="string" id="1730027">&#39;\v&#39;</span><span class="op" id="1730031">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730036">buf</span>&nbsp;<span class="op" id="1730040">=</span>&nbsp;<span class="builtinfunc" id="1730042">append</span><span class="op" id="1730048">(</span><span class="ident" id="1730049">buf</span><span class="op" id="1730052">,</span>&nbsp;<span class="string" id="1730054">`\v`</span><span class="op" id="1730058">...</span><span class="op" id="1730061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730065">default</span><span class="op" id="1730072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730077">switch</span>&nbsp;<span class="op" id="1730084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730089">case</span>&nbsp;<span class="ident" id="1730094">r</span>&nbsp;<span class="op" id="1730096">&lt;</span>&nbsp;<span class="string" id="1730098">&#39;&nbsp;&#39;</span><span class="op" id="1730101">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730107">buf</span>&nbsp;<span class="op" id="1730111">=</span>&nbsp;<span class="builtinfunc" id="1730113">append</span><span class="op" id="1730119">(</span><span class="ident" id="1730120">buf</span><span class="op" id="1730123">,</span>&nbsp;<span class="string" id="1730125">`\x`</span><span class="op" id="1730129">...</span><span class="op" id="1730132">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730138">buf</span>&nbsp;<span class="op" id="1730142">=</span>&nbsp;<span class="builtinfunc" id="1730144">append</span><span class="op" id="1730150">(</span><span class="ident" id="1730151">buf</span><span class="op" id="1730154">,</span>&nbsp;<span class="ident" id="1730156">lowerhex</span><span class="op" id="1730164">[</span><span class="ident" id="1730165">s</span><span class="op" id="1730166">[</span><span class="num" id="1730167">0</span><span class="op" id="1730168">]</span><span class="op" id="1730169">&gt;&gt;</span><span class="num" id="1730171">4</span><span class="op" id="1730172">]</span><span class="op" id="1730173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730179">buf</span>&nbsp;<span class="op" id="1730183">=</span>&nbsp;<span class="builtinfunc" id="1730185">append</span><span class="op" id="1730191">(</span><span class="ident" id="1730192">buf</span><span class="op" id="1730195">,</span>&nbsp;<span class="ident" id="1730197">lowerhex</span><span class="op" id="1730205">[</span><span class="ident" id="1730206">s</span><span class="op" id="1730207">[</span><span class="num" id="1730208">0</span><span class="op" id="1730209">]</span><span class="op" id="1730210">&amp;</span><span class="num" id="1730211">0xF</span><span class="op" id="1730214">]</span><span class="op" id="1730215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730220">case</span>&nbsp;<span class="ident" id="1730225">r</span>&nbsp;<span class="op" id="1730227">&gt;</span>&nbsp;<span class="ident" id="1730229">utf8</span><span class="op" id="1730233">.</span><span class="ident" id="1730234">MaxRune</span><span class="op" id="1730241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730247">r</span>&nbsp;<span class="op" id="1730249">=</span>&nbsp;<span class="num" id="1730251">0xFFFD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730262">fallthrough</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730277">case</span>&nbsp;<span class="ident" id="1730282">r</span>&nbsp;<span class="op" id="1730284">&lt;</span>&nbsp;<span class="num" id="1730286">0x10000</span><span class="op" id="1730293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730299">buf</span>&nbsp;<span class="op" id="1730303">=</span>&nbsp;<span class="builtinfunc" id="1730305">append</span><span class="op" id="1730311">(</span><span class="ident" id="1730312">buf</span><span class="op" id="1730315">,</span>&nbsp;<span class="string" id="1730317">`\u`</span><span class="op" id="1730321">...</span><span class="op" id="1730324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730330">for</span>&nbsp;<span class="ident" id="1730334">s</span>&nbsp;<span class="op" id="1730336">:=</span>&nbsp;<span class="num" id="1730339">12</span><span class="op" id="1730341">;</span>&nbsp;<span class="ident" id="1730343">s</span>&nbsp;<span class="op" id="1730345">&gt;=</span>&nbsp;<span class="num" id="1730348">0</span><span class="op" id="1730349">;</span>&nbsp;<span class="ident" id="1730351">s</span>&nbsp;<span class="op" id="1730353">-=</span>&nbsp;<span class="num" id="1730356">4</span>&nbsp;<span class="op" id="1730358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730365">buf</span>&nbsp;<span class="op" id="1730369">=</span>&nbsp;<span class="builtinfunc" id="1730371">append</span><span class="op" id="1730377">(</span><span class="ident" id="1730378">buf</span><span class="op" id="1730381">,</span>&nbsp;<span class="ident" id="1730383">lowerhex</span><span class="op" id="1730391">[</span><span class="ident" id="1730392">r</span><span class="op" id="1730393">&gt;&gt;</span><span class="builtintype" id="1730395">uint</span><span class="op" id="1730399">(</span><span class="ident" id="1730400">s</span><span class="op" id="1730401">)</span><span class="op" id="1730402">&amp;</span><span class="num" id="1730403">0xF</span><span class="op" id="1730406">]</span><span class="op" id="1730407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730413">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730418">default</span><span class="op" id="1730425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730431">buf</span>&nbsp;<span class="op" id="1730435">=</span>&nbsp;<span class="builtinfunc" id="1730437">append</span><span class="op" id="1730443">(</span><span class="ident" id="1730444">buf</span><span class="op" id="1730447">,</span>&nbsp;<span class="string" id="1730449">`\U`</span><span class="op" id="1730453">...</span><span class="op" id="1730456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730462">for</span>&nbsp;<span class="ident" id="1730466">s</span>&nbsp;<span class="op" id="1730468">:=</span>&nbsp;<span class="num" id="1730471">28</span><span class="op" id="1730473">;</span>&nbsp;<span class="ident" id="1730475">s</span>&nbsp;<span class="op" id="1730477">&gt;=</span>&nbsp;<span class="num" id="1730480">0</span><span class="op" id="1730481">;</span>&nbsp;<span class="ident" id="1730483">s</span>&nbsp;<span class="op" id="1730485">-=</span>&nbsp;<span class="num" id="1730488">4</span>&nbsp;<span class="op" id="1730490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730497">buf</span>&nbsp;<span class="op" id="1730501">=</span>&nbsp;<span class="builtinfunc" id="1730503">append</span><span class="op" id="1730509">(</span><span class="ident" id="1730510">buf</span><span class="op" id="1730513">,</span>&nbsp;<span class="ident" id="1730515">lowerhex</span><span class="op" id="1730523">[</span><span class="ident" id="1730524">r</span><span class="op" id="1730525">&gt;&gt;</span><span class="builtintype" id="1730527">uint</span><span class="op" id="1730531">(</span><span class="ident" id="1730532">s</span><span class="op" id="1730533">)</span><span class="op" id="1730534">&amp;</span><span class="num" id="1730535">0xF</span><span class="op" id="1730538">]</span><span class="op" id="1730539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730545">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730560">buf</span>&nbsp;<span class="op" id="1730564">=</span>&nbsp;<span class="builtinfunc" id="1730566">append</span><span class="op" id="1730572">(</span><span class="ident" id="1730573">buf</span><span class="op" id="1730576">,</span>&nbsp;<span class="ident" id="1730578">quote</span><span class="op" id="1730583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730586">return</span>&nbsp;<span class="builtintype" id="1730593">string</span><span class="op" id="1730599">(</span><span class="ident" id="1730600">buf</span><span class="op" id="1730603">)</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="op" id="1730606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1730609">//&nbsp;Quote&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.&nbsp;&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="1730681">//&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno">90</span><span class="comment" id="1730752">//&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1730817">//&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="1730829">func</span>&nbsp;<span class="ident" id="1730834">Quote</span><span class="op" id="1730839">(</span><span class="ident" id="1730840">s</span>&nbsp;<span class="builtintype" id="1730842">string</span><span class="op" id="1730848">)</span>&nbsp;<span class="builtintype" id="1730850">string</span>&nbsp;<span class="op" id="1730857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730860">return</span>&nbsp;<span class="ident" id="1730867">quoteWith</span><span class="op" id="1730876">(</span><span class="ident" id="1730877">s</span><span class="op" id="1730878">,</span>&nbsp;<span class="string" id="1730880">&#39;&#34;&#39;</span><span class="op" id="1730883">,</span>&nbsp;<span class="builtintype" id="1730885">false</span><span class="op" id="1730890">)</span><br>
<span class="lineno"></span><span class="op" id="1730892">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="comment" id="1730895">//&nbsp;AppendQuote&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno"></span><span class="comment" id="1730968">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;Quote,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="1731034">func</span>&nbsp;<span class="ident" id="1731039">AppendQuote</span><span class="op" id="1731050">(</span><span class="ident" id="1731051">dst</span>&nbsp;<span class="op" id="1731055">[</span><span class="op" id="1731056">]</span><span class="builtintype" id="1731057">byte</span><span class="op" id="1731061">,</span>&nbsp;<span class="ident" id="1731063">s</span>&nbsp;<span class="builtintype" id="1731065">string</span><span class="op" id="1731071">)</span>&nbsp;<span class="op" id="1731073">[</span><span class="op" id="1731074">]</span><span class="builtintype" id="1731075">byte</span>&nbsp;<span class="op" id="1731080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731083">return</span>&nbsp;<span class="builtinfunc" id="1731090">append</span><span class="op" id="1731096">(</span><span class="ident" id="1731097">dst</span><span class="op" id="1731100">,</span>&nbsp;<span class="ident" id="1731102">Quote</span><span class="op" id="1731107">(</span><span class="ident" id="1731108">s</span><span class="op" id="1731109">)</span><span class="op" id="1731110">...</span><span class="op" id="1731113">)</span><br>
<span class="lineno">100</span><span class="op" id="1731115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1731118">//&nbsp;QuoteToASCII&nbsp;returns&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="1731192">//&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="1731267">//&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno">105</span><span class="keyword" id="1731343">func</span>&nbsp;<span class="ident" id="1731348">QuoteToASCII</span><span class="op" id="1731360">(</span><span class="ident" id="1731361">s</span>&nbsp;<span class="builtintype" id="1731363">string</span><span class="op" id="1731369">)</span>&nbsp;<span class="builtintype" id="1731371">string</span>&nbsp;<span class="op" id="1731378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731381">return</span>&nbsp;<span class="ident" id="1731388">quoteWith</span><span class="op" id="1731397">(</span><span class="ident" id="1731398">s</span><span class="op" id="1731399">,</span>&nbsp;<span class="string" id="1731401">&#39;&#34;&#39;</span><span class="op" id="1731404">,</span>&nbsp;<span class="builtintype" id="1731406">true</span><span class="op" id="1731410">)</span><br>
<span class="lineno"></span><span class="op" id="1731412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1731415">//&nbsp;AppendQuoteToASCII&nbsp;appends&nbsp;a&nbsp;double-quoted&nbsp;Go&nbsp;string&nbsp;literal&nbsp;representing&nbsp;s,</span><br>
<span class="lineno">110</span><span class="comment" id="1731495">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="keyword" id="1731568">func</span>&nbsp;<span class="ident" id="1731573">AppendQuoteToASCII</span><span class="op" id="1731591">(</span><span class="ident" id="1731592">dst</span>&nbsp;<span class="op" id="1731596">[</span><span class="op" id="1731597">]</span><span class="builtintype" id="1731598">byte</span><span class="op" id="1731602">,</span>&nbsp;<span class="ident" id="1731604">s</span>&nbsp;<span class="builtintype" id="1731606">string</span><span class="op" id="1731612">)</span>&nbsp;<span class="op" id="1731614">[</span><span class="op" id="1731615">]</span><span class="builtintype" id="1731616">byte</span>&nbsp;<span class="op" id="1731621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731624">return</span>&nbsp;<span class="builtinfunc" id="1731631">append</span><span class="op" id="1731637">(</span><span class="ident" id="1731638">dst</span><span class="op" id="1731641">,</span>&nbsp;<span class="ident" id="1731643">QuoteToASCII</span><span class="op" id="1731655">(</span><span class="ident" id="1731656">s</span><span class="op" id="1731657">)</span><span class="op" id="1731658">...</span><span class="op" id="1731661">)</span><br>
<span class="lineno"></span><span class="op" id="1731663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="1731666">//&nbsp;QuoteRune&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1731741">//&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,&nbsp;\u0100)</span><br>
<span class="lineno"></span><span class="comment" id="1731819">//&nbsp;for&nbsp;control&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="1731897">func</span>&nbsp;<span class="ident" id="1731902">QuoteRune</span><span class="op" id="1731911">(</span><span class="ident" id="1731912">r</span>&nbsp;<span class="builtintype" id="1731914">rune</span><span class="op" id="1731918">)</span>&nbsp;<span class="builtintype" id="1731920">string</span>&nbsp;<span class="op" id="1731927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1731930">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731967">return</span>&nbsp;<span class="ident" id="1731974">quoteWith</span><span class="op" id="1731983">(</span><span class="builtintype" id="1731984">string</span><span class="op" id="1731990">(</span><span class="ident" id="1731991">r</span><span class="op" id="1731992">)</span><span class="op" id="1731993">,</span>&nbsp;<span class="string" id="1731995">&#39;\&#39;&#39;</span><span class="op" id="1731999">,</span>&nbsp;<span class="builtintype" id="1732001">false</span><span class="op" id="1732006">)</span><br>
<span class="lineno"></span><span class="op" id="1732008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1732011">//&nbsp;AppendQuoteRune&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="1732098">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRune,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">125</span><span class="keyword" id="1732168">func</span>&nbsp;<span class="ident" id="1732173">AppendQuoteRune</span><span class="op" id="1732188">(</span><span class="ident" id="1732189">dst</span>&nbsp;<span class="op" id="1732193">[</span><span class="op" id="1732194">]</span><span class="builtintype" id="1732195">byte</span><span class="op" id="1732199">,</span>&nbsp;<span class="ident" id="1732201">r</span>&nbsp;<span class="builtintype" id="1732203">rune</span><span class="op" id="1732207">)</span>&nbsp;<span class="op" id="1732209">[</span><span class="op" id="1732210">]</span><span class="builtintype" id="1732211">byte</span>&nbsp;<span class="op" id="1732216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732219">return</span>&nbsp;<span class="builtinfunc" id="1732226">append</span><span class="op" id="1732232">(</span><span class="ident" id="1732233">dst</span><span class="op" id="1732236">,</span>&nbsp;<span class="ident" id="1732238">QuoteRune</span><span class="op" id="1732247">(</span><span class="ident" id="1732248">r</span><span class="op" id="1732249">)</span><span class="op" id="1732250">...</span><span class="op" id="1732253">)</span><br>
<span class="lineno"></span><span class="op" id="1732255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1732258">//&nbsp;QuoteRuneToASCII&nbsp;returns&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing</span><br>
<span class="lineno">130</span><span class="comment" id="1732336">//&nbsp;the&nbsp;rune.&nbsp;&nbsp;The&nbsp;returned&nbsp;string&nbsp;uses&nbsp;Go&nbsp;escape&nbsp;sequences&nbsp;(\t,&nbsp;\n,&nbsp;\xFF,</span><br>
<span class="lineno"></span><span class="comment" id="1732410">//&nbsp;\u0100)&nbsp;for&nbsp;non-ASCII&nbsp;characters&nbsp;and&nbsp;non-printable&nbsp;characters&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="1732486">//&nbsp;by&nbsp;IsPrint.</span><br>
<span class="lineno"></span><span class="keyword" id="1732501">func</span>&nbsp;<span class="ident" id="1732506">QuoteRuneToASCII</span><span class="op" id="1732522">(</span><span class="ident" id="1732523">r</span>&nbsp;<span class="builtintype" id="1732525">rune</span><span class="op" id="1732529">)</span>&nbsp;<span class="builtintype" id="1732531">string</span>&nbsp;<span class="op" id="1732538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1732541">//&nbsp;TODO:&nbsp;avoid&nbsp;the&nbsp;allocation&nbsp;here.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732578">return</span>&nbsp;<span class="ident" id="1732585">quoteWith</span><span class="op" id="1732594">(</span><span class="builtintype" id="1732595">string</span><span class="op" id="1732601">(</span><span class="ident" id="1732602">r</span><span class="op" id="1732603">)</span><span class="op" id="1732604">,</span>&nbsp;<span class="string" id="1732606">&#39;\&#39;&#39;</span><span class="op" id="1732610">,</span>&nbsp;<span class="builtintype" id="1732612">true</span><span class="op" id="1732616">)</span><br>
<span class="lineno"></span><span class="op" id="1732618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1732621">//&nbsp;AppendQuoteRuneToASCII&nbsp;appends&nbsp;a&nbsp;single-quoted&nbsp;Go&nbsp;character&nbsp;literal&nbsp;representing&nbsp;the&nbsp;rune,</span><br>
<span class="lineno"></span><span class="comment" id="1732715">//&nbsp;as&nbsp;generated&nbsp;by&nbsp;QuoteRuneToASCII,&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;extended&nbsp;buffer.</span><br>
<span class="lineno">140</span><span class="keyword" id="1732792">func</span>&nbsp;<span class="ident" id="1732797">AppendQuoteRuneToASCII</span><span class="op" id="1732819">(</span><span class="ident" id="1732820">dst</span>&nbsp;<span class="op" id="1732824">[</span><span class="op" id="1732825">]</span><span class="builtintype" id="1732826">byte</span><span class="op" id="1732830">,</span>&nbsp;<span class="ident" id="1732832">r</span>&nbsp;<span class="builtintype" id="1732834">rune</span><span class="op" id="1732838">)</span>&nbsp;<span class="op" id="1732840">[</span><span class="op" id="1732841">]</span><span class="builtintype" id="1732842">byte</span>&nbsp;<span class="op" id="1732847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732850">return</span>&nbsp;<span class="builtinfunc" id="1732857">append</span><span class="op" id="1732863">(</span><span class="ident" id="1732864">dst</span><span class="op" id="1732867">,</span>&nbsp;<span class="ident" id="1732869">QuoteRuneToASCII</span><span class="op" id="1732885">(</span><span class="ident" id="1732886">r</span><span class="op" id="1732887">)</span><span class="op" id="1732888">...</span><span class="op" id="1732891">)</span><br>
<span class="lineno"></span><span class="op" id="1732893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1732896">//&nbsp;CanBackquote&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;s&nbsp;can&nbsp;be&nbsp;represented</span><br>
<span class="lineno">145</span><span class="comment" id="1732960">//&nbsp;unchanged&nbsp;as&nbsp;a&nbsp;single-line&nbsp;backquoted&nbsp;string&nbsp;without&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="1733024">//&nbsp;characters&nbsp;other&nbsp;than&nbsp;tab.</span><br>
<span class="lineno"></span><span class="keyword" id="1733054">func</span>&nbsp;<span class="ident" id="1733059">CanBackquote</span><span class="op" id="1733071">(</span><span class="ident" id="1733072">s</span>&nbsp;<span class="builtintype" id="1733074">string</span><span class="op" id="1733080">)</span>&nbsp;<span class="builtintype" id="1733082">bool</span>&nbsp;<span class="op" id="1733087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733090">for</span>&nbsp;<span class="builtinfunc" id="1733094">len</span><span class="op" id="1733097">(</span><span class="ident" id="1733098">s</span><span class="op" id="1733099">)</span>&nbsp;<span class="op" id="1733101">&gt;</span>&nbsp;<span class="num" id="1733103">0</span>&nbsp;<span class="op" id="1733105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733109">r</span><span class="op" id="1733110">,</span>&nbsp;<span class="ident" id="1733112">wid</span>&nbsp;<span class="op" id="1733116">:=</span>&nbsp;<span class="ident" id="1733119">utf8</span><span class="op" id="1733123">.</span><span class="ident" id="1733124">DecodeRuneInString</span><span class="op" id="1733142">(</span><span class="ident" id="1733143">s</span><span class="op" id="1733144">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733148">s</span>&nbsp;<span class="op" id="1733150">=</span>&nbsp;<span class="ident" id="1733152">s</span><span class="op" id="1733153">[</span><span class="ident" id="1733154">wid</span><span class="op" id="1733157">:</span><span class="op" id="1733158">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733162">if</span>&nbsp;<span class="ident" id="1733165">wid</span>&nbsp;<span class="op" id="1733169">&gt;</span>&nbsp;<span class="num" id="1733171">1</span>&nbsp;<span class="op" id="1733173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733178">if</span>&nbsp;<span class="ident" id="1733181">r</span>&nbsp;<span class="op" id="1733183">==</span>&nbsp;<span class="string" id="1733186">&#39;\ufeff&#39;</span>&nbsp;<span class="op" id="1733195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733201">return</span>&nbsp;<span class="builtintype" id="1733208">false</span>&nbsp;<span class="comment" id="1733214">//&nbsp;BOMs&nbsp;are&nbsp;invisible&nbsp;and&nbsp;should&nbsp;not&nbsp;be&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1733265">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733270">continue</span>&nbsp;<span class="comment" id="1733279">//&nbsp;All&nbsp;other&nbsp;multibyte&nbsp;runes&nbsp;are&nbsp;correctly&nbsp;encoded&nbsp;and&nbsp;assumed&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1733355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733359">if</span>&nbsp;<span class="ident" id="1733362">r</span>&nbsp;<span class="op" id="1733364">==</span>&nbsp;<span class="ident" id="1733367">utf8</span><span class="op" id="1733371">.</span><span class="ident" id="1733372">RuneError</span>&nbsp;<span class="op" id="1733382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733387">return</span>&nbsp;<span class="builtintype" id="1733394">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1733402">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733406">if</span>&nbsp;<span class="op" id="1733409">(</span><span class="ident" id="1733410">r</span>&nbsp;<span class="op" id="1733412">&lt;</span>&nbsp;<span class="string" id="1733414">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="1733418">&amp;&amp;</span>&nbsp;<span class="ident" id="1733421">r</span>&nbsp;<span class="op" id="1733423">!=</span>&nbsp;<span class="string" id="1733426">&#39;\t&#39;</span><span class="op" id="1733430">)</span>&nbsp;<span class="op" id="1733432">||</span>&nbsp;<span class="ident" id="1733435">r</span>&nbsp;<span class="op" id="1733437">==</span>&nbsp;<span class="string" id="1733440">&#39;`&#39;</span>&nbsp;<span class="op" id="1733444">||</span>&nbsp;<span class="ident" id="1733447">r</span>&nbsp;<span class="op" id="1733449">==</span>&nbsp;<span class="string" id="1733452">&#39;\u007F&#39;</span>&nbsp;<span class="op" id="1733461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733466">return</span>&nbsp;<span class="builtintype" id="1733473">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1733481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1733484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733487">return</span>&nbsp;<span class="builtintype" id="1733494">true</span><br>
<span class="lineno">165</span><span class="op" id="1733499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1733502">func</span>&nbsp;<span class="ident" id="1733507">unhex</span><span class="op" id="1733512">(</span><span class="ident" id="1733513">b</span>&nbsp;<span class="builtintype" id="1733515">byte</span><span class="op" id="1733519">)</span>&nbsp;<span class="op" id="1733521">(</span><span class="ident" id="1733522">v</span>&nbsp;<span class="builtintype" id="1733524">rune</span><span class="op" id="1733528">,</span>&nbsp;<span class="ident" id="1733530">ok</span>&nbsp;<span class="builtintype" id="1733533">bool</span><span class="op" id="1733537">)</span>&nbsp;<span class="op" id="1733539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733542">c</span>&nbsp;<span class="op" id="1733544">:=</span>&nbsp;<span class="builtintype" id="1733547">rune</span><span class="op" id="1733551">(</span><span class="ident" id="1733552">b</span><span class="op" id="1733553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733556">switch</span>&nbsp;<span class="op" id="1733563">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733566">case</span>&nbsp;<span class="string" id="1733571">&#39;0&#39;</span>&nbsp;<span class="op" id="1733575">&lt;=</span>&nbsp;<span class="ident" id="1733578">c</span>&nbsp;<span class="op" id="1733580">&amp;&amp;</span>&nbsp;<span class="ident" id="1733583">c</span>&nbsp;<span class="op" id="1733585">&lt;=</span>&nbsp;<span class="string" id="1733588">&#39;9&#39;</span><span class="op" id="1733591">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733595">return</span>&nbsp;<span class="ident" id="1733602">c</span>&nbsp;<span class="op" id="1733604">-</span>&nbsp;<span class="string" id="1733606">&#39;0&#39;</span><span class="op" id="1733609">,</span>&nbsp;<span class="builtintype" id="1733611">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733617">case</span>&nbsp;<span class="string" id="1733622">&#39;a&#39;</span>&nbsp;<span class="op" id="1733626">&lt;=</span>&nbsp;<span class="ident" id="1733629">c</span>&nbsp;<span class="op" id="1733631">&amp;&amp;</span>&nbsp;<span class="ident" id="1733634">c</span>&nbsp;<span class="op" id="1733636">&lt;=</span>&nbsp;<span class="string" id="1733639">&#39;f&#39;</span><span class="op" id="1733642">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733646">return</span>&nbsp;<span class="ident" id="1733653">c</span>&nbsp;<span class="op" id="1733655">-</span>&nbsp;<span class="string" id="1733657">&#39;a&#39;</span>&nbsp;<span class="op" id="1733661">+</span>&nbsp;<span class="num" id="1733663">10</span><span class="op" id="1733665">,</span>&nbsp;<span class="builtintype" id="1733667">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733673">case</span>&nbsp;<span class="string" id="1733678">&#39;A&#39;</span>&nbsp;<span class="op" id="1733682">&lt;=</span>&nbsp;<span class="ident" id="1733685">c</span>&nbsp;<span class="op" id="1733687">&amp;&amp;</span>&nbsp;<span class="ident" id="1733690">c</span>&nbsp;<span class="op" id="1733692">&lt;=</span>&nbsp;<span class="string" id="1733695">&#39;F&#39;</span><span class="op" id="1733698">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733702">return</span>&nbsp;<span class="ident" id="1733709">c</span>&nbsp;<span class="op" id="1733711">-</span>&nbsp;<span class="string" id="1733713">&#39;A&#39;</span>&nbsp;<span class="op" id="1733717">+</span>&nbsp;<span class="num" id="1733719">10</span><span class="op" id="1733721">,</span>&nbsp;<span class="builtintype" id="1733723">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1733729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733732">return</span><br>
<span class="lineno"></span><span class="op" id="1733739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="1733742">//&nbsp;UnquoteChar&nbsp;decodes&nbsp;the&nbsp;first&nbsp;character&nbsp;or&nbsp;byte&nbsp;in&nbsp;the&nbsp;escaped&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="1733815">//&nbsp;or&nbsp;character&nbsp;literal&nbsp;represented&nbsp;by&nbsp;the&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="1733868">//&nbsp;It&nbsp;returns&nbsp;four&nbsp;values:</span><br>
<span class="lineno"></span><span class="comment" id="1733895">//</span><br>
<span class="lineno"></span><span class="comment" id="1733898">//&nbsp;&nbsp;&nbsp;&nbsp1)&nbsp;value,&nbsp;the&nbsp;decoded&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;byte&nbsp;value;</span><br>
<span class="lineno">185</span><span class="comment" id="1733957">//&nbsp;&nbsp;&nbsp;&nbsp2)&nbsp;multibyte,&nbsp;a&nbsp;boolean&nbsp;indicating&nbsp;whether&nbsp;the&nbsp;decoded&nbsp;character&nbsp;requires&nbsp;a&nbsp;multibyte&nbsp;UTF-8&nbsp;representation;</span><br>
<span class="lineno"></span><span class="comment" id="1734068">//&nbsp;&nbsp;&nbsp;&nbsp3)&nbsp;tail,&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string&nbsp;after&nbsp;the&nbsp;character;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1734133">//&nbsp;&nbsp;&nbsp;&nbsp4)&nbsp;an&nbsp;error&nbsp;that&nbsp;will&nbsp;be&nbsp;nil&nbsp;if&nbsp;the&nbsp;character&nbsp;is&nbsp;syntactically&nbsp;valid.</span><br>
<span class="lineno"></span><span class="comment" id="1734206">//</span><br>
<span class="lineno"></span><span class="comment" id="1734209">//&nbsp;The&nbsp;second&nbsp;argument,&nbsp;quote,&nbsp;specifies&nbsp;the&nbsp;type&nbsp;of&nbsp;literal&nbsp;being&nbsp;parsed</span><br>
<span class="lineno">190</span><span class="comment" id="1734283">//&nbsp;and&nbsp;therefore&nbsp;which&nbsp;escaped&nbsp;quote&nbsp;character&nbsp;is&nbsp;permitted.</span><br>
<span class="lineno"></span><span class="comment" id="1734344">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;single&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;the&nbsp;sequence&nbsp;\&#39;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="1734427">//&nbsp;If&nbsp;set&nbsp;to&nbsp;a&nbsp;double&nbsp;quote,&nbsp;it&nbsp;permits&nbsp;\&#34;&nbsp;and&nbsp;disallows&nbsp;unescaped&nbsp;&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="1734497">//&nbsp;If&nbsp;set&nbsp;to&nbsp;zero,&nbsp;it&nbsp;does&nbsp;not&nbsp;permit&nbsp;either&nbsp;escape&nbsp;and&nbsp;allows&nbsp;both&nbsp;quote&nbsp;characters&nbsp;to&nbsp;appear&nbsp;unescaped.</span><br>
<span class="lineno"></span><span class="keyword" id="1734603">func</span>&nbsp;<span class="ident" id="1734608">UnquoteChar</span><span class="op" id="1734619">(</span><span class="ident" id="1734620">s</span>&nbsp;<span class="builtintype" id="1734622">string</span><span class="op" id="1734628">,</span>&nbsp;<span class="ident" id="1734630">quote</span>&nbsp;<span class="builtintype" id="1734636">byte</span><span class="op" id="1734640">)</span>&nbsp;<span class="op" id="1734642">(</span><span class="ident" id="1734643">value</span>&nbsp;<span class="builtintype" id="1734649">rune</span><span class="op" id="1734653">,</span>&nbsp;<span class="ident" id="1734655">multibyte</span>&nbsp;<span class="builtintype" id="1734665">bool</span><span class="op" id="1734669">,</span>&nbsp;<span class="ident" id="1734671">tail</span>&nbsp;<span class="builtintype" id="1734676">string</span><span class="op" id="1734682">,</span>&nbsp;<span class="ident" id="1734684">err</span>&nbsp;<span class="builtintype" id="1734688">error</span><span class="op" id="1734693">)</span>&nbsp;<span class="op" id="1734695">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1734698">//&nbsp;easy&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734713">switch</span>&nbsp;<span class="ident" id="1734720">c</span>&nbsp;<span class="op" id="1734722">:=</span>&nbsp;<span class="ident" id="1734725">s</span><span class="op" id="1734726">[</span><span class="num" id="1734727">0</span><span class="op" id="1734728">]</span><span class="op" id="1734729">;</span>&nbsp;<span class="op" id="1734731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734734">case</span>&nbsp;<span class="ident" id="1734739">c</span>&nbsp;<span class="op" id="1734741">==</span>&nbsp;<span class="ident" id="1734744">quote</span>&nbsp;<span class="op" id="1734750">&amp;&amp;</span>&nbsp;<span class="op" id="1734753">(</span><span class="ident" id="1734754">quote</span>&nbsp;<span class="op" id="1734760">==</span>&nbsp;<span class="string" id="1734763">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="1734768">||</span>&nbsp;<span class="ident" id="1734771">quote</span>&nbsp;<span class="op" id="1734777">==</span>&nbsp;<span class="string" id="1734780">&#39;&#34;&#39;</span><span class="op" id="1734783">)</span><span class="op" id="1734784">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1734788">err</span>&nbsp;<span class="op" id="1734792">=</span>&nbsp;<span class="ident" id="1734794">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734806">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734814">case</span>&nbsp;<span class="ident" id="1734819">c</span>&nbsp;<span class="op" id="1734821">&gt;=</span>&nbsp;<span class="ident" id="1734824">utf8</span><span class="op" id="1734828">.</span><span class="ident" id="1734829">RuneSelf</span><span class="op" id="1734837">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1734841">r</span><span class="op" id="1734842">,</span>&nbsp;<span class="ident" id="1734844">size</span>&nbsp;<span class="op" id="1734849">:=</span>&nbsp;<span class="ident" id="1734852">utf8</span><span class="op" id="1734856">.</span><span class="ident" id="1734857">DecodeRuneInString</span><span class="op" id="1734875">(</span><span class="ident" id="1734876">s</span><span class="op" id="1734877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734881">return</span>&nbsp;<span class="ident" id="1734888">r</span><span class="op" id="1734889">,</span>&nbsp;<span class="builtintype" id="1734891">true</span><span class="op" id="1734895">,</span>&nbsp;<span class="ident" id="1734897">s</span><span class="op" id="1734898">[</span><span class="ident" id="1734899">size</span><span class="op" id="1734903">:</span><span class="op" id="1734904">]</span><span class="op" id="1734905">,</span>&nbsp;<span class="ident" id="1734907">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734912">case</span>&nbsp;<span class="ident" id="1734917">c</span>&nbsp;<span class="op" id="1734919">!=</span>&nbsp;<span class="string" id="1734922">&#39;\\&#39;</span><span class="op" id="1734926">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734930">return</span>&nbsp;<span class="builtintype" id="1734937">rune</span><span class="op" id="1734941">(</span><span class="ident" id="1734942">s</span><span class="op" id="1734943">[</span><span class="num" id="1734944">0</span><span class="op" id="1734945">]</span><span class="op" id="1734946">)</span><span class="op" id="1734947">,</span>&nbsp;<span class="builtintype" id="1734949">false</span><span class="op" id="1734954">,</span>&nbsp;<span class="ident" id="1734956">s</span><span class="op" id="1734957">[</span><span class="num" id="1734958">1</span><span class="op" id="1734959">:</span><span class="op" id="1734960">]</span><span class="op" id="1734961">,</span>&nbsp;<span class="ident" id="1734963">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1734968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1734972">//&nbsp;hard&nbsp;case:&nbsp;c&nbsp;is&nbsp;backslash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735002">if</span>&nbsp;<span class="builtinfunc" id="1735005">len</span><span class="op" id="1735008">(</span><span class="ident" id="1735009">s</span><span class="op" id="1735010">)</span>&nbsp;<span class="op" id="1735012">&lt;=</span>&nbsp;<span class="num" id="1735015">1</span>&nbsp;<span class="op" id="1735017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735021">err</span>&nbsp;<span class="op" id="1735025">=</span>&nbsp;<span class="ident" id="1735027">ErrSyntax</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735039">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735050">c</span>&nbsp;<span class="op" id="1735052">:=</span>&nbsp;<span class="ident" id="1735055">s</span><span class="op" id="1735056">[</span><span class="num" id="1735057">1</span><span class="op" id="1735058">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735061">s</span>&nbsp;<span class="op" id="1735063">=</span>&nbsp;<span class="ident" id="1735065">s</span><span class="op" id="1735066">[</span><span class="num" id="1735067">2</span><span class="op" id="1735068">:</span><span class="op" id="1735069">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735073">switch</span>&nbsp;<span class="ident" id="1735080">c</span>&nbsp;<span class="op" id="1735082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735085">case</span>&nbsp;<span class="string" id="1735090">&#39;a&#39;</span><span class="op" id="1735093">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735097">value</span>&nbsp;<span class="op" id="1735103">=</span>&nbsp;<span class="string" id="1735105">&#39;\a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735111">case</span>&nbsp;<span class="string" id="1735116">&#39;b&#39;</span><span class="op" id="1735119">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735123">value</span>&nbsp;<span class="op" id="1735129">=</span>&nbsp;<span class="string" id="1735131">&#39;\b&#39;</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735137">case</span>&nbsp;<span class="string" id="1735142">&#39;f&#39;</span><span class="op" id="1735145">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735149">value</span>&nbsp;<span class="op" id="1735155">=</span>&nbsp;<span class="string" id="1735157">&#39;\f&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735163">case</span>&nbsp;<span class="string" id="1735168">&#39;n&#39;</span><span class="op" id="1735171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735175">value</span>&nbsp;<span class="op" id="1735181">=</span>&nbsp;<span class="string" id="1735183">&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735189">case</span>&nbsp;<span class="string" id="1735194">&#39;r&#39;</span><span class="op" id="1735197">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735201">value</span>&nbsp;<span class="op" id="1735207">=</span>&nbsp;<span class="string" id="1735209">&#39;\r&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735215">case</span>&nbsp;<span class="string" id="1735220">&#39;t&#39;</span><span class="op" id="1735223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735227">value</span>&nbsp;<span class="op" id="1735233">=</span>&nbsp;<span class="string" id="1735235">&#39;\t&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735241">case</span>&nbsp;<span class="string" id="1735246">&#39;v&#39;</span><span class="op" id="1735249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735253">value</span>&nbsp;<span class="op" id="1735259">=</span>&nbsp;<span class="string" id="1735261">&#39;\v&#39;</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735267">case</span>&nbsp;<span class="string" id="1735272">&#39;x&#39;</span><span class="op" id="1735275">,</span>&nbsp;<span class="string" id="1735277">&#39;u&#39;</span><span class="op" id="1735280">,</span>&nbsp;<span class="string" id="1735282">&#39;U&#39;</span><span class="op" id="1735285">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735289">n</span>&nbsp;<span class="op" id="1735291">:=</span>&nbsp;<span class="num" id="1735294">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735298">switch</span>&nbsp;<span class="ident" id="1735305">c</span>&nbsp;<span class="op" id="1735307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735311">case</span>&nbsp;<span class="string" id="1735316">&#39;x&#39;</span><span class="op" id="1735319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735324">n</span>&nbsp;<span class="op" id="1735326">=</span>&nbsp;<span class="num" id="1735328">2</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735332">case</span>&nbsp;<span class="string" id="1735337">&#39;u&#39;</span><span class="op" id="1735340">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735345">n</span>&nbsp;<span class="op" id="1735347">=</span>&nbsp;<span class="num" id="1735349">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735353">case</span>&nbsp;<span class="string" id="1735358">&#39;U&#39;</span><span class="op" id="1735361">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735366">n</span>&nbsp;<span class="op" id="1735368">=</span>&nbsp;<span class="num" id="1735370">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735374">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735378">var</span>&nbsp;<span class="ident" id="1735382">v</span>&nbsp;<span class="builtintype" id="1735384">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735391">if</span>&nbsp;<span class="builtinfunc" id="1735394">len</span><span class="op" id="1735397">(</span><span class="ident" id="1735398">s</span><span class="op" id="1735399">)</span>&nbsp;<span class="op" id="1735401">&lt;</span>&nbsp;<span class="ident" id="1735403">n</span>&nbsp;<span class="op" id="1735405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735410">err</span>&nbsp;<span class="op" id="1735414">=</span>&nbsp;<span class="ident" id="1735416">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735429">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735438">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735442">for</span>&nbsp;<span class="ident" id="1735446">j</span>&nbsp;<span class="op" id="1735448">:=</span>&nbsp;<span class="num" id="1735451">0</span><span class="op" id="1735452">;</span>&nbsp;<span class="ident" id="1735454">j</span>&nbsp;<span class="op" id="1735456">&lt;</span>&nbsp;<span class="ident" id="1735458">n</span><span class="op" id="1735459">;</span>&nbsp;<span class="ident" id="1735461">j</span><span class="op" id="1735462">++</span>&nbsp;<span class="op" id="1735465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735470">x</span><span class="op" id="1735471">,</span>&nbsp;<span class="ident" id="1735473">ok</span>&nbsp;<span class="op" id="1735476">:=</span>&nbsp;<span class="ident" id="1735479">unhex</span><span class="op" id="1735484">(</span><span class="ident" id="1735485">s</span><span class="op" id="1735486">[</span><span class="ident" id="1735487">j</span><span class="op" id="1735488">]</span><span class="op" id="1735489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735494">if</span>&nbsp;<span class="op" id="1735497">!</span><span class="ident" id="1735498">ok</span>&nbsp;<span class="op" id="1735501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735507">err</span>&nbsp;<span class="op" id="1735511">=</span>&nbsp;<span class="ident" id="1735513">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735527">return</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735542">v</span>&nbsp;<span class="op" id="1735544">=</span>&nbsp;<span class="ident" id="1735546">v</span><span class="op" id="1735547">&lt;&lt;</span><span class="num" id="1735549">4</span>&nbsp;<span class="op" id="1735551">|</span>&nbsp;<span class="ident" id="1735553">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735561">s</span>&nbsp;<span class="op" id="1735563">=</span>&nbsp;<span class="ident" id="1735565">s</span><span class="op" id="1735566">[</span><span class="ident" id="1735567">n</span><span class="op" id="1735568">:</span><span class="op" id="1735569">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735573">if</span>&nbsp;<span class="ident" id="1735576">c</span>&nbsp;<span class="op" id="1735578">==</span>&nbsp;<span class="string" id="1735581">&#39;x&#39;</span>&nbsp;<span class="op" id="1735585">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1735590">//&nbsp;single-byte&nbsp;string,&nbsp;possibly&nbsp;not&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735635">value</span>&nbsp;<span class="op" id="1735641">=</span>&nbsp;<span class="ident" id="1735643">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735648">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735660">if</span>&nbsp;<span class="ident" id="1735663">v</span>&nbsp;<span class="op" id="1735665">&gt;</span>&nbsp;<span class="ident" id="1735667">utf8</span><span class="op" id="1735671">.</span><span class="ident" id="1735672">MaxRune</span>&nbsp;<span class="op" id="1735680">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735685">err</span>&nbsp;<span class="op" id="1735689">=</span>&nbsp;<span class="ident" id="1735691">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735704">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735717">value</span>&nbsp;<span class="op" id="1735723">=</span>&nbsp;<span class="ident" id="1735725">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735729">multibyte</span>&nbsp;<span class="op" id="1735739">=</span>&nbsp;<span class="builtintype" id="1735741">true</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735747">case</span>&nbsp;<span class="string" id="1735752">&#39;0&#39;</span><span class="op" id="1735755">,</span>&nbsp;<span class="string" id="1735757">&#39;1&#39;</span><span class="op" id="1735760">,</span>&nbsp;<span class="string" id="1735762">&#39;2&#39;</span><span class="op" id="1735765">,</span>&nbsp;<span class="string" id="1735767">&#39;3&#39;</span><span class="op" id="1735770">,</span>&nbsp;<span class="string" id="1735772">&#39;4&#39;</span><span class="op" id="1735775">,</span>&nbsp;<span class="string" id="1735777">&#39;5&#39;</span><span class="op" id="1735780">,</span>&nbsp;<span class="string" id="1735782">&#39;6&#39;</span><span class="op" id="1735785">,</span>&nbsp;<span class="string" id="1735787">&#39;7&#39;</span><span class="op" id="1735790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735794">v</span>&nbsp;<span class="op" id="1735796">:=</span>&nbsp;<span class="builtintype" id="1735799">rune</span><span class="op" id="1735803">(</span><span class="ident" id="1735804">c</span><span class="op" id="1735805">)</span>&nbsp;<span class="op" id="1735807">-</span>&nbsp;<span class="string" id="1735809">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735815">if</span>&nbsp;<span class="builtinfunc" id="1735818">len</span><span class="op" id="1735821">(</span><span class="ident" id="1735822">s</span><span class="op" id="1735823">)</span>&nbsp;<span class="op" id="1735825">&lt;</span>&nbsp;<span class="num" id="1735827">2</span>&nbsp;<span class="op" id="1735829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735834">err</span>&nbsp;<span class="op" id="1735838">=</span>&nbsp;<span class="ident" id="1735840">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735853">return</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735866">for</span>&nbsp;<span class="ident" id="1735870">j</span>&nbsp;<span class="op" id="1735872">:=</span>&nbsp;<span class="num" id="1735875">0</span><span class="op" id="1735876">;</span>&nbsp;<span class="ident" id="1735878">j</span>&nbsp;<span class="op" id="1735880">&lt;</span>&nbsp;<span class="num" id="1735882">2</span><span class="op" id="1735883">;</span>&nbsp;<span class="ident" id="1735885">j</span><span class="op" id="1735886">++</span>&nbsp;<span class="op" id="1735889">{</span>&nbsp;<span class="comment" id="1735891">//&nbsp;one&nbsp;digit&nbsp;already;&nbsp;two&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735925">x</span>&nbsp;<span class="op" id="1735927">:=</span>&nbsp;<span class="builtintype" id="1735930">rune</span><span class="op" id="1735934">(</span><span class="ident" id="1735935">s</span><span class="op" id="1735936">[</span><span class="ident" id="1735937">j</span><span class="op" id="1735938">]</span><span class="op" id="1735939">)</span>&nbsp;<span class="op" id="1735941">-</span>&nbsp;<span class="string" id="1735943">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735950">if</span>&nbsp;<span class="ident" id="1735953">x</span>&nbsp;<span class="op" id="1735955">&lt;</span>&nbsp;<span class="num" id="1735957">0</span>&nbsp;<span class="op" id="1735959">||</span>&nbsp;<span class="ident" id="1735962">x</span>&nbsp;<span class="op" id="1735964">&gt;</span>&nbsp;<span class="num" id="1735966">7</span>&nbsp;<span class="op" id="1735968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735974">err</span>&nbsp;<span class="op" id="1735978">=</span>&nbsp;<span class="ident" id="1735980">ErrSyntax</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735994">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736009">v</span>&nbsp;<span class="op" id="1736011">=</span>&nbsp;<span class="op" id="1736013">(</span><span class="ident" id="1736014">v</span>&nbsp;<span class="op" id="1736016">&lt;&lt;</span>&nbsp;<span class="num" id="1736019">3</span><span class="op" id="1736020">)</span>&nbsp;<span class="op" id="1736022">|</span>&nbsp;<span class="ident" id="1736024">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736032">s</span>&nbsp;<span class="op" id="1736034">=</span>&nbsp;<span class="ident" id="1736036">s</span><span class="op" id="1736037">[</span><span class="num" id="1736038">2</span><span class="op" id="1736039">:</span><span class="op" id="1736040">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736044">if</span>&nbsp;<span class="ident" id="1736047">v</span>&nbsp;<span class="op" id="1736049">&gt;</span>&nbsp;<span class="num" id="1736051">255</span>&nbsp;<span class="op" id="1736055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736060">err</span>&nbsp;<span class="op" id="1736064">=</span>&nbsp;<span class="ident" id="1736066">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736079">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736092">value</span>&nbsp;<span class="op" id="1736098">=</span>&nbsp;<span class="ident" id="1736100">v</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736103">case</span>&nbsp;<span class="string" id="1736108">&#39;\\&#39;</span><span class="op" id="1736112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736116">value</span>&nbsp;<span class="op" id="1736122">=</span>&nbsp;<span class="string" id="1736124">&#39;\\&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736130">case</span>&nbsp;<span class="string" id="1736135">&#39;\&#39;&#39;</span><span class="op" id="1736139">,</span>&nbsp;<span class="string" id="1736141">&#39;&#34;&#39;</span><span class="op" id="1736144">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736148">if</span>&nbsp;<span class="ident" id="1736151">c</span>&nbsp;<span class="op" id="1736153">!=</span>&nbsp;<span class="ident" id="1736156">quote</span>&nbsp;<span class="op" id="1736162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736167">err</span>&nbsp;<span class="op" id="1736171">=</span>&nbsp;<span class="ident" id="1736173">ErrSyntax</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736186">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736199">value</span>&nbsp;<span class="op" id="1736205">=</span>&nbsp;<span class="builtintype" id="1736207">rune</span><span class="op" id="1736211">(</span><span class="ident" id="1736212">c</span><span class="op" id="1736213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736216">default</span><span class="op" id="1736223">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736227">err</span>&nbsp;<span class="op" id="1736231">=</span>&nbsp;<span class="ident" id="1736233">ErrSyntax</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736245">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736256">tail</span>&nbsp;<span class="op" id="1736261">=</span>&nbsp;<span class="ident" id="1736263">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736266">return</span><br>
<span class="lineno"></span><span class="op" id="1736273">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="1736276">//&nbsp;Unquote&nbsp;interprets&nbsp;s&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;double-quoted,</span><br>
<span class="lineno"></span><span class="comment" id="1736335">//&nbsp;or&nbsp;backquoted&nbsp;Go&nbsp;string&nbsp;literal,&nbsp;returning&nbsp;the&nbsp;string&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="1736398">//&nbsp;that&nbsp;s&nbsp;quotes.&nbsp;&nbsp;(If&nbsp;s&nbsp;is&nbsp;single-quoted,&nbsp;it&nbsp;would&nbsp;be&nbsp;a&nbsp;Go</span><br>
<span class="lineno"></span><span class="comment" id="1736458">//&nbsp;character&nbsp;literal;&nbsp;Unquote&nbsp;returns&nbsp;the&nbsp;corresponding</span><br>
<span class="lineno">305</span><span class="comment" id="1736514">//&nbsp;one-character&nbsp;string.)</span><br>
<span class="lineno"></span><span class="keyword" id="1736540">func</span>&nbsp;<span class="ident" id="1736545">Unquote</span><span class="op" id="1736552">(</span><span class="ident" id="1736553">s</span>&nbsp;<span class="builtintype" id="1736555">string</span><span class="op" id="1736561">)</span>&nbsp;<span class="op" id="1736563">(</span><span class="ident" id="1736564">t</span>&nbsp;<span class="builtintype" id="1736566">string</span><span class="op" id="1736572">,</span>&nbsp;<span class="ident" id="1736574">err</span>&nbsp;<span class="builtintype" id="1736578">error</span><span class="op" id="1736583">)</span>&nbsp;<span class="op" id="1736585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736588">n</span>&nbsp;<span class="op" id="1736590">:=</span>&nbsp;<span class="builtinfunc" id="1736593">len</span><span class="op" id="1736596">(</span><span class="ident" id="1736597">s</span><span class="op" id="1736598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736601">if</span>&nbsp;<span class="ident" id="1736604">n</span>&nbsp;<span class="op" id="1736606">&lt;</span>&nbsp;<span class="num" id="1736608">2</span>&nbsp;<span class="op" id="1736610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736614">return</span>&nbsp;<span class="string" id="1736621">&#34;&#34;</span><span class="op" id="1736623">,</span>&nbsp;<span class="ident" id="1736625">ErrSyntax</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736639">quote</span>&nbsp;<span class="op" id="1736645">:=</span>&nbsp;<span class="ident" id="1736648">s</span><span class="op" id="1736649">[</span><span class="num" id="1736650">0</span><span class="op" id="1736651">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736654">if</span>&nbsp;<span class="ident" id="1736657">quote</span>&nbsp;<span class="op" id="1736663">!=</span>&nbsp;<span class="ident" id="1736666">s</span><span class="op" id="1736667">[</span><span class="ident" id="1736668">n</span><span class="op" id="1736669">-</span><span class="num" id="1736670">1</span><span class="op" id="1736671">]</span>&nbsp;<span class="op" id="1736673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736677">return</span>&nbsp;<span class="string" id="1736684">&#34;&#34;</span><span class="op" id="1736686">,</span>&nbsp;<span class="ident" id="1736688">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736699">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736702">s</span>&nbsp;<span class="op" id="1736704">=</span>&nbsp;<span class="ident" id="1736706">s</span><span class="op" id="1736707">[</span><span class="num" id="1736708">1</span>&nbsp;<span class="op" id="1736710">:</span>&nbsp;<span class="ident" id="1736712">n</span><span class="op" id="1736713">-</span><span class="num" id="1736714">1</span><span class="op" id="1736715">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736719">if</span>&nbsp;<span class="ident" id="1736722">quote</span>&nbsp;<span class="op" id="1736728">==</span>&nbsp;<span class="string" id="1736731">&#39;`&#39;</span>&nbsp;<span class="op" id="1736735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736739">if</span>&nbsp;<span class="ident" id="1736742">contains</span><span class="op" id="1736750">(</span><span class="ident" id="1736751">s</span><span class="op" id="1736752">,</span>&nbsp;<span class="string" id="1736754">&#39;`&#39;</span><span class="op" id="1736757">)</span>&nbsp;<span class="op" id="1736759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736764">return</span>&nbsp;<span class="string" id="1736771">&#34;&#34;</span><span class="op" id="1736773">,</span>&nbsp;<span class="ident" id="1736775">ErrSyntax</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736791">return</span>&nbsp;<span class="ident" id="1736798">s</span><span class="op" id="1736799">,</span>&nbsp;<span class="ident" id="1736801">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736809">if</span>&nbsp;<span class="ident" id="1736812">quote</span>&nbsp;<span class="op" id="1736818">!=</span>&nbsp;<span class="string" id="1736821">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="1736825">&amp;&amp;</span>&nbsp;<span class="ident" id="1736828">quote</span>&nbsp;<span class="op" id="1736834">!=</span>&nbsp;<span class="string" id="1736837">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="1736842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736846">return</span>&nbsp;<span class="string" id="1736853">&#34;&#34;</span><span class="op" id="1736855">,</span>&nbsp;<span class="ident" id="1736857">ErrSyntax</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736871">if</span>&nbsp;<span class="ident" id="1736874">contains</span><span class="op" id="1736882">(</span><span class="ident" id="1736883">s</span><span class="op" id="1736884">,</span>&nbsp;<span class="string" id="1736886">&#39;\n&#39;</span><span class="op" id="1736890">)</span>&nbsp;<span class="op" id="1736892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736896">return</span>&nbsp;<span class="string" id="1736903">&#34;&#34;</span><span class="op" id="1736905">,</span>&nbsp;<span class="ident" id="1736907">ErrSyntax</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1736922">//&nbsp;Is&nbsp;it&nbsp;trivial?&nbsp;&nbsp;Avoid&nbsp;allocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736960">if</span>&nbsp;<span class="op" id="1736963">!</span><span class="ident" id="1736964">contains</span><span class="op" id="1736972">(</span><span class="ident" id="1736973">s</span><span class="op" id="1736974">,</span>&nbsp;<span class="string" id="1736976">&#39;\\&#39;</span><span class="op" id="1736980">)</span>&nbsp;<span class="op" id="1736982">&amp;&amp;</span>&nbsp;<span class="op" id="1736985">!</span><span class="ident" id="1736986">contains</span><span class="op" id="1736994">(</span><span class="ident" id="1736995">s</span><span class="op" id="1736996">,</span>&nbsp;<span class="ident" id="1736998">quote</span><span class="op" id="1737003">)</span>&nbsp;<span class="op" id="1737005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737009">switch</span>&nbsp;<span class="ident" id="1737016">quote</span>&nbsp;<span class="op" id="1737022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737026">case</span>&nbsp;<span class="string" id="1737031">&#39;&#34;&#39;</span><span class="op" id="1737034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737039">return</span>&nbsp;<span class="ident" id="1737046">s</span><span class="op" id="1737047">,</span>&nbsp;<span class="ident" id="1737049">nil</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737055">case</span>&nbsp;<span class="string" id="1737060">&#39;\&#39;&#39;</span><span class="op" id="1737064">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737069">r</span><span class="op" id="1737070">,</span>&nbsp;<span class="ident" id="1737072">size</span>&nbsp;<span class="op" id="1737077">:=</span>&nbsp;<span class="ident" id="1737080">utf8</span><span class="op" id="1737084">.</span><span class="ident" id="1737085">DecodeRuneInString</span><span class="op" id="1737103">(</span><span class="ident" id="1737104">s</span><span class="op" id="1737105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737110">if</span>&nbsp;<span class="ident" id="1737113">size</span>&nbsp;<span class="op" id="1737118">==</span>&nbsp;<span class="builtinfunc" id="1737121">len</span><span class="op" id="1737124">(</span><span class="ident" id="1737125">s</span><span class="op" id="1737126">)</span>&nbsp;<span class="op" id="1737128">&amp;&amp;</span>&nbsp;<span class="op" id="1737131">(</span><span class="ident" id="1737132">r</span>&nbsp;<span class="op" id="1737134">!=</span>&nbsp;<span class="ident" id="1737137">utf8</span><span class="op" id="1737141">.</span><span class="ident" id="1737142">RuneError</span>&nbsp;<span class="op" id="1737152">||</span>&nbsp;<span class="ident" id="1737155">size</span>&nbsp;<span class="op" id="1737160">!=</span>&nbsp;<span class="num" id="1737163">1</span><span class="op" id="1737164">)</span>&nbsp;<span class="op" id="1737166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737172">return</span>&nbsp;<span class="ident" id="1737179">s</span><span class="op" id="1737180">,</span>&nbsp;<span class="ident" id="1737182">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737189">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737200">var</span>&nbsp;<span class="ident" id="1737204">runeTmp</span>&nbsp;<span class="op" id="1737212">[</span><span class="ident" id="1737213">utf8</span><span class="op" id="1737217">.</span><span class="ident" id="1737218">UTFMax</span><span class="op" id="1737224">]</span><span class="builtintype" id="1737225">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737231">buf</span>&nbsp;<span class="op" id="1737235">:=</span>&nbsp;<span class="builtinfunc" id="1737238">make</span><span class="op" id="1737242">(</span><span class="op" id="1737243">[</span><span class="op" id="1737244">]</span><span class="builtintype" id="1737245">byte</span><span class="op" id="1737249">,</span>&nbsp;<span class="num" id="1737251">0</span><span class="op" id="1737252">,</span>&nbsp;<span class="num" id="1737254">3</span><span class="op" id="1737255">*</span><span class="builtinfunc" id="1737256">len</span><span class="op" id="1737259">(</span><span class="ident" id="1737260">s</span><span class="op" id="1737261">)</span><span class="op" id="1737262">/</span><span class="num" id="1737263">2</span><span class="op" id="1737264">)</span>&nbsp;<span class="comment" id="1737266">//&nbsp;Try&nbsp;to&nbsp;avoid&nbsp;more&nbsp;allocations.</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737301">for</span>&nbsp;<span class="builtinfunc" id="1737305">len</span><span class="op" id="1737308">(</span><span class="ident" id="1737309">s</span><span class="op" id="1737310">)</span>&nbsp;<span class="op" id="1737312">&gt;</span>&nbsp;<span class="num" id="1737314">0</span>&nbsp;<span class="op" id="1737316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737320">c</span><span class="op" id="1737321">,</span>&nbsp;<span class="ident" id="1737323">multibyte</span><span class="op" id="1737332">,</span>&nbsp;<span class="ident" id="1737334">ss</span><span class="op" id="1737336">,</span>&nbsp;<span class="ident" id="1737338">err</span>&nbsp;<span class="op" id="1737342">:=</span>&nbsp;<span class="ident" id="1737345">UnquoteChar</span><span class="op" id="1737356">(</span><span class="ident" id="1737357">s</span><span class="op" id="1737358">,</span>&nbsp;<span class="ident" id="1737360">quote</span><span class="op" id="1737365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737369">if</span>&nbsp;<span class="ident" id="1737372">err</span>&nbsp;<span class="op" id="1737376">!=</span>&nbsp;<span class="ident" id="1737379">nil</span>&nbsp;<span class="op" id="1737383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737388">return</span>&nbsp;<span class="string" id="1737395">&#34;&#34;</span><span class="op" id="1737397">,</span>&nbsp;<span class="ident" id="1737399">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737405">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737409">s</span>&nbsp;<span class="op" id="1737411">=</span>&nbsp;<span class="ident" id="1737413">ss</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737418">if</span>&nbsp;<span class="ident" id="1737421">c</span>&nbsp;<span class="op" id="1737423">&lt;</span>&nbsp;<span class="ident" id="1737425">utf8</span><span class="op" id="1737429">.</span><span class="ident" id="1737430">RuneSelf</span>&nbsp;<span class="op" id="1737439">||</span>&nbsp;<span class="op" id="1737442">!</span><span class="ident" id="1737443">multibyte</span>&nbsp;<span class="op" id="1737453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737458">buf</span>&nbsp;<span class="op" id="1737462">=</span>&nbsp;<span class="builtinfunc" id="1737464">append</span><span class="op" id="1737470">(</span><span class="ident" id="1737471">buf</span><span class="op" id="1737474">,</span>&nbsp;<span class="builtintype" id="1737476">byte</span><span class="op" id="1737480">(</span><span class="ident" id="1737481">c</span><span class="op" id="1737482">)</span><span class="op" id="1737483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737487">}</span>&nbsp;<span class="keyword" id="1737489">else</span>&nbsp;<span class="op" id="1737494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737499">n</span>&nbsp;<span class="op" id="1737501">:=</span>&nbsp;<span class="ident" id="1737504">utf8</span><span class="op" id="1737508">.</span><span class="ident" id="1737509">EncodeRune</span><span class="op" id="1737519">(</span><span class="ident" id="1737520">runeTmp</span><span class="op" id="1737527">[</span><span class="op" id="1737528">:</span><span class="op" id="1737529">]</span><span class="op" id="1737530">,</span>&nbsp;<span class="ident" id="1737532">c</span><span class="op" id="1737533">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737538">buf</span>&nbsp;<span class="op" id="1737542">=</span>&nbsp;<span class="builtinfunc" id="1737544">append</span><span class="op" id="1737550">(</span><span class="ident" id="1737551">buf</span><span class="op" id="1737554">,</span>&nbsp;<span class="ident" id="1737556">runeTmp</span><span class="op" id="1737563">[</span><span class="op" id="1737564">:</span><span class="ident" id="1737565">n</span><span class="op" id="1737566">]</span><span class="op" id="1737567">...</span><span class="op" id="1737570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737578">if</span>&nbsp;<span class="ident" id="1737581">quote</span>&nbsp;<span class="op" id="1737587">==</span>&nbsp;<span class="string" id="1737590">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="1737595">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="1737598">len</span><span class="op" id="1737601">(</span><span class="ident" id="1737602">s</span><span class="op" id="1737603">)</span>&nbsp;<span class="op" id="1737605">!=</span>&nbsp;<span class="num" id="1737608">0</span>&nbsp;<span class="op" id="1737610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1737615">//&nbsp;single-quoted&nbsp;must&nbsp;be&nbsp;single&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737660">return</span>&nbsp;<span class="string" id="1737667">&#34;&#34;</span><span class="op" id="1737669">,</span>&nbsp;<span class="ident" id="1737671">ErrSyntax</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737689">return</span>&nbsp;<span class="builtintype" id="1737696">string</span><span class="op" id="1737702">(</span><span class="ident" id="1737703">buf</span><span class="op" id="1737706">)</span><span class="op" id="1737707">,</span>&nbsp;<span class="ident" id="1737709">nil</span><br>
<span class="lineno"></span><span class="op" id="1737713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="1737716">//&nbsp;contains&nbsp;reports&nbsp;whether&nbsp;the&nbsp;string&nbsp;contains&nbsp;the&nbsp;byte&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="1737776">func</span>&nbsp;<span class="ident" id="1737781">contains</span><span class="op" id="1737789">(</span><span class="ident" id="1737790">s</span>&nbsp;<span class="builtintype" id="1737792">string</span><span class="op" id="1737798">,</span>&nbsp;<span class="ident" id="1737800">c</span>&nbsp;<span class="builtintype" id="1737802">byte</span><span class="op" id="1737806">)</span>&nbsp;<span class="builtintype" id="1737808">bool</span>&nbsp;<span class="op" id="1737813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737816">for</span>&nbsp;<span class="ident" id="1737820">i</span>&nbsp;<span class="op" id="1737822">:=</span>&nbsp;<span class="num" id="1737825">0</span><span class="op" id="1737826">;</span>&nbsp;<span class="ident" id="1737828">i</span>&nbsp;<span class="op" id="1737830">&lt;</span>&nbsp;<span class="builtinfunc" id="1737832">len</span><span class="op" id="1737835">(</span><span class="ident" id="1737836">s</span><span class="op" id="1737837">)</span><span class="op" id="1737838">;</span>&nbsp;<span class="ident" id="1737840">i</span><span class="op" id="1737841">++</span>&nbsp;<span class="op" id="1737844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737848">if</span>&nbsp;<span class="ident" id="1737851">s</span><span class="op" id="1737852">[</span><span class="ident" id="1737853">i</span><span class="op" id="1737854">]</span>&nbsp;<span class="op" id="1737856">==</span>&nbsp;<span class="ident" id="1737859">c</span>&nbsp;<span class="op" id="1737861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737866">return</span>&nbsp;<span class="builtintype" id="1737873">true</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737886">return</span>&nbsp;<span class="builtintype" id="1737893">false</span><br>
<span class="lineno"></span><span class="op" id="1737899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="comment" id="1737902">//&nbsp;bsearch16&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1737959">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch16&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="1738011">func</span>&nbsp;<span class="ident" id="1738016">bsearch16</span><span class="op" id="1738025">(</span><span class="ident" id="1738026">a</span>&nbsp;<span class="op" id="1738028">[</span><span class="op" id="1738029">]</span><span class="builtintype" id="1738030">uint16</span><span class="op" id="1738036">,</span>&nbsp;<span class="ident" id="1738038">x</span>&nbsp;<span class="builtintype" id="1738040">uint16</span><span class="op" id="1738046">)</span>&nbsp;<span class="builtintype" id="1738048">int</span>&nbsp;<span class="op" id="1738052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1738055">i</span><span class="op" id="1738056">,</span>&nbsp;<span class="ident" id="1738058">j</span>&nbsp;<span class="op" id="1738060">:=</span>&nbsp;<span class="num" id="1738063">0</span><span class="op" id="1738064">,</span>&nbsp;<span class="builtinfunc" id="1738066">len</span><span class="op" id="1738069">(</span><span class="ident" id="1738070">a</span><span class="op" id="1738071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1738074">for</span>&nbsp;<span class="ident" id="1738078">i</span>&nbsp;<span class="op" id="1738080">&lt;</span>&nbsp;<span class="ident" id="1738082">j</span>&nbsp;<span class="op" id="1738084">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1738088">h</span>&nbsp;<span class="op" id="1738090">:=</span>&nbsp;<span class="ident" id="1738093">i</span>&nbsp;<span class="op" id="1738095">+</span>&nbsp;<span class="op" id="1738097">(</span><span class="ident" id="1738098">j</span><span class="op" id="1738099">-</span><span class="ident" id="1738100">i</span><span class="op" id="1738101">)</span><span class="op" id="1738102">/</span><span class="num" id="1738103">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1738107">if</span>&nbsp;<span class="ident" id="1738110">a</span><span class="op" id="1738111">[</span><span class="ident" id="1738112">h</span><span class="op" id="1738113">]</span>&nbsp;<span class="op" id="1738115">&lt;</span>&nbsp;<span class="ident" id="1738117">x</span>&nbsp;<span class="op" id="1738119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1738124">i</span>&nbsp;<span class="op" id="1738126">=</span>&nbsp;<span class="ident" id="1738128">h</span>&nbsp;<span class="op" id="1738130">+</span>&nbsp;<span class="num" id="1738132">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1738136">}</span>&nbsp;<span class="keyword" id="1738138">else</span>&nbsp;<span class="op" id="1738143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1738148">j</span>&nbsp;<span class="op" id="1738150">=</span>&nbsp;<span class="ident" id="1738152">h</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1738156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1738159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1738162">return</span>&nbsp;<span class="ident" id="1738169">i</span><br>
<span class="lineno"></span><span class="op" id="1738171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="comment" id="1738174">//&nbsp;bsearch32&nbsp;returns&nbsp;the&nbsp;smallest&nbsp;i&nbsp;such&nbsp;that&nbsp;a[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1738231">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;i,&nbsp;bsearch32&nbsp;returns&nbsp;len(a).</span><br>
<span class="lineno"></span><span class="keyword" id="1738283">func</span>&nbsp;<span class="ident" id="1738288">bsearch32</span><span class="op" id="1738297">(</span><span class="ident" id="1738298">a</span>&nbsp;<span class="op" id="1738300">[</span><span class="op" id="1738301">]</span><span class="builtintype" id="1738302">uint32</span><span class="op" id="1738308">,</span>&nbsp;<span class="ident" id="1738310">x</span>&nbsp;<span class="builtintype" id="1738312">uint32</span><span class="op" id="1738318">)</span>&nbsp;<span class="builtintype" id="1738320">int</span>&nbsp;<span class="op" id="1738324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1738327">i</span><span class="op" id="1738328">,</span>&nbsp;<span class="ident" id="1738330">j</span>&nbsp;<span class="op" id="1738332">:=</span>&nbsp;<span class="num" id="1738335">0</span><span class="op" id="1738336">,</span>&nbsp;<span class="builtinfunc" id="1738338">len</span><span class="op" id="1738341">(</span><span class="ident" id="1738342">a</span><span class="op" id="1738343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1738346">for</span>&nbsp;<span class="ident" id="1738350">i</span>&nbsp;<span class="op" id="1738352">&lt;</span>&nbsp;<span class="ident" id="1738354">j</span>&nbsp;<span class="op" id="1738356">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1738360">h</span>&nbsp;<span class="op" id="1738362">:=</span>&nbsp;<span class="ident" id="1738365">i</span>&nbsp;<span class="op" id="1738367">+</span>&nbsp;<span class="op" id="1738369">(</span><span class="ident" id="1738370">j</span><span class="op" id="1738371">-</span><span class="ident" id="1738372">i</span><span class="op" id="1738373">)</span><span class="op" id="1738374">/</span><span class="num" id="1738375">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1738379">if</span>&nbsp;<span class="ident" id="1738382">a</span><span class="op" id="1738383">[</span><span class="ident" id="1738384">h</span><span class="op" id="1738385">]</span>&nbsp;<span class="op" id="1738387">&lt;</span>&nbsp;<span class="ident" id="1738389">x</span>&nbsp;<span class="op" id="1738391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1738396">i</span>&nbsp;<span class="op" id="1738398">=</span>&nbsp;<span class="ident" id="1738400">h</span>&nbsp;<span class="op" id="1738402">+</span>&nbsp;<span class="num" id="1738404">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1738408">}</span>&nbsp;<span class="keyword" id="1738410">else</span>&nbsp;<span class="op" id="1738415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1738420">j</span>&nbsp;<span class="op" id="1738422">=</span>&nbsp;<span class="ident" id="1738424">h</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1738428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1738431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1738434">return</span>&nbsp;<span class="ident" id="1738441">i</span><br>
<span class="lineno"></span><span class="op" id="1738443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="1738446">//&nbsp;TODO:&nbsp;IsPrint&nbsp;is&nbsp;a&nbsp;local&nbsp;implementation&nbsp;of&nbsp;unicode.IsPrint,&nbsp;verified&nbsp;by&nbsp;the&nbsp;tests</span><br>
<span class="lineno"></span><span class="comment" id="1738531">//&nbsp;to&nbsp;give&nbsp;the&nbsp;same&nbsp;answer.&nbsp;It&nbsp;allows&nbsp;this&nbsp;package&nbsp;not&nbsp;to&nbsp;depend&nbsp;on&nbsp;unicode,</span><br>
<span class="lineno"></span><span class="comment" id="1738608">//&nbsp;and&nbsp;therefore&nbsp;not&nbsp;pull&nbsp;in&nbsp;all&nbsp;the&nbsp;Unicode&nbsp;tables.&nbsp;If&nbsp;the&nbsp;linker&nbsp;were&nbsp;better</span><br>
<span class="lineno"></span><span class="comment" id="1738687">//&nbsp;at&nbsp;tossing&nbsp;unused&nbsp;tables,&nbsp;we&nbsp;could&nbsp;get&nbsp;rid&nbsp;of&nbsp;this&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="comment" id="1738757">//&nbsp;That&nbsp;would&nbsp;be&nbsp;nice.</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span><span class="comment" id="1738781">//&nbsp;IsPrint&nbsp;reports&nbsp;whether&nbsp;the&nbsp;rune&nbsp;is&nbsp;defined&nbsp;as&nbsp;printable&nbsp;by&nbsp;Go,&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1738853">//&nbsp;the&nbsp;same&nbsp;definition&nbsp;as&nbsp;unicode.IsPrint:&nbsp;letters,&nbsp;numbers,&nbsp;punctuation,</span><br>
<span class="lineno"></span><span class="comment" id="1738927">//&nbsp;symbols&nbsp;and&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="1738955">func</span>&nbsp;<span class="ident" id="1738960">IsPrint</span><span class="op" id="1738967">(</span><span class="ident" id="1738968">r</span>&nbsp;<span class="builtintype" id="1738970">rune</span><span class="op" id="1738974">)</span>&nbsp;<span class="builtintype" id="1738976">bool</span>&nbsp;<span class="op" id="1738981">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1738984">//&nbsp;Fast&nbsp;check&nbsp;for&nbsp;Latin-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1739011">if</span>&nbsp;<span class="ident" id="1739014">r</span>&nbsp;<span class="op" id="1739016">&lt;=</span>&nbsp;<span class="num" id="1739019">0xFF</span>&nbsp;<span class="op" id="1739024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1739028">if</span>&nbsp;<span class="num" id="1739031">0x20</span>&nbsp;<span class="op" id="1739036">&lt;=</span>&nbsp;<span class="ident" id="1739039">r</span>&nbsp;<span class="op" id="1739041">&amp;&amp;</span>&nbsp;<span class="ident" id="1739044">r</span>&nbsp;<span class="op" id="1739046">&lt;=</span>&nbsp;<span class="num" id="1739049">0x7E</span>&nbsp;<span class="op" id="1739054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1739059">//&nbsp;All&nbsp;the&nbsp;ASCII&nbsp;is&nbsp;printable&nbsp;from&nbsp;space&nbsp;through&nbsp;DEL-1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1739118">return</span>&nbsp;<span class="builtintype" id="1739125">true</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1739132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1739136">if</span>&nbsp;<span class="num" id="1739139">0xA1</span>&nbsp;<span class="op" id="1739144">&lt;=</span>&nbsp;<span class="ident" id="1739147">r</span>&nbsp;<span class="op" id="1739149">&amp;&amp;</span>&nbsp;<span class="ident" id="1739152">r</span>&nbsp;<span class="op" id="1739154">&lt;=</span>&nbsp;<span class="num" id="1739157">0xFF</span>&nbsp;<span class="op" id="1739162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1739167">//&nbsp;Similarly&nbsp;for&nbsp;&nbsp;through&nbsp;...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1739204">return</span>&nbsp;<span class="ident" id="1739211">r</span>&nbsp;<span class="op" id="1739213">!=</span>&nbsp;<span class="num" id="1739216">0xAD</span>&nbsp;<span class="comment" id="1739221">//&nbsp;...except&nbsp;for&nbsp;the&nbsp;bizarre&nbsp;soft&nbsp;hyphen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1739265">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1739269">return</span>&nbsp;<span class="builtintype" id="1739276">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1739283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1739287">//&nbsp;Same&nbsp;algorithm,&nbsp;either&nbsp;on&nbsp;uint16&nbsp;or&nbsp;uint32&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1739341">//&nbsp;First,&nbsp;find&nbsp;first&nbsp;i&nbsp;such&nbsp;that&nbsp;isPrint[i]&nbsp;&gt;=&nbsp;x.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1739392">//&nbsp;This&nbsp;is&nbsp;the&nbsp;index&nbsp;of&nbsp;either&nbsp;the&nbsp;start&nbsp;or&nbsp;end&nbsp;of&nbsp;a&nbsp;pair&nbsp;that&nbsp;might&nbsp;span&nbsp;x.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1739470">//&nbsp;The&nbsp;start&nbsp;is&nbsp;even&nbsp;(isPrint[i&amp;^1])&nbsp;and&nbsp;the&nbsp;end&nbsp;is&nbsp;odd&nbsp;(isPrint[i|1]).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1739543">//&nbsp;If&nbsp;we&nbsp;find&nbsp;x&nbsp;in&nbsp;a&nbsp;range,&nbsp;make&nbsp;sure&nbsp;x&nbsp;is&nbsp;not&nbsp;in&nbsp;isNotPrint&nbsp;list.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1739612">if</span>&nbsp;<span class="num" id="1739615">0</span>&nbsp;<span class="op" id="1739617">&lt;=</span>&nbsp;<span class="ident" id="1739620">r</span>&nbsp;<span class="op" id="1739622">&amp;&amp;</span>&nbsp;<span class="ident" id="1739625">r</span>&nbsp;<span class="op" id="1739627">&lt;</span>&nbsp;<span class="num" id="1739629">1</span><span class="op" id="1739630">&lt;&lt;</span><span class="num" id="1739632">16</span>&nbsp;<span class="op" id="1739635">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1739639">rr</span><span class="op" id="1739641">,</span>&nbsp;<span class="ident" id="1739643">isPrint</span><span class="op" id="1739650">,</span>&nbsp;<span class="ident" id="1739652">isNotPrint</span>&nbsp;<span class="op" id="1739663">:=</span>&nbsp;<span class="builtintype" id="1739666">uint16</span><span class="op" id="1739672">(</span><span class="ident" id="1739673">r</span><span class="op" id="1739674">)</span><span class="op" id="1739675">,</span>&nbsp;<span class="ident" id="1739677">isPrint16</span><span class="op" id="1739686">,</span>&nbsp;<span class="ident" id="1739688">isNotPrint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1739703">i</span>&nbsp;<span class="op" id="1739705">:=</span>&nbsp;<span class="ident" id="1739708">bsearch16</span><span class="op" id="1739717">(</span><span class="ident" id="1739718">isPrint</span><span class="op" id="1739725">,</span>&nbsp;<span class="ident" id="1739727">rr</span><span class="op" id="1739729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1739733">if</span>&nbsp;<span class="ident" id="1739736">i</span>&nbsp;<span class="op" id="1739738">&gt;=</span>&nbsp;<span class="builtinfunc" id="1739741">len</span><span class="op" id="1739744">(</span><span class="ident" id="1739745">isPrint</span><span class="op" id="1739752">)</span>&nbsp;<span class="op" id="1739754">||</span>&nbsp;<span class="ident" id="1739757">rr</span>&nbsp;<span class="op" id="1739760">&lt;</span>&nbsp;<span class="ident" id="1739762">isPrint</span><span class="op" id="1739769">[</span><span class="ident" id="1739770">i</span><span class="op" id="1739771">&amp;^</span><span class="num" id="1739773">1</span><span class="op" id="1739774">]</span>&nbsp;<span class="op" id="1739776">||</span>&nbsp;<span class="ident" id="1739779">isPrint</span><span class="op" id="1739786">[</span><span class="ident" id="1739787">i</span><span class="op" id="1739788">|</span><span class="num" id="1739789">1</span><span class="op" id="1739790">]</span>&nbsp;<span class="op" id="1739792">&lt;</span>&nbsp;<span class="ident" id="1739794">rr</span>&nbsp;<span class="op" id="1739797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1739802">return</span>&nbsp;<span class="builtintype" id="1739809">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1739817">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1739821">j</span>&nbsp;<span class="op" id="1739823">:=</span>&nbsp;<span class="ident" id="1739826">bsearch16</span><span class="op" id="1739835">(</span><span class="ident" id="1739836">isNotPrint</span><span class="op" id="1739846">,</span>&nbsp;<span class="ident" id="1739848">rr</span><span class="op" id="1739850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1739854">return</span>&nbsp;<span class="ident" id="1739861">j</span>&nbsp;<span class="op" id="1739863">&gt;=</span>&nbsp;<span class="builtinfunc" id="1739866">len</span><span class="op" id="1739869">(</span><span class="ident" id="1739870">isNotPrint</span><span class="op" id="1739880">)</span>&nbsp;<span class="op" id="1739882">||</span>&nbsp;<span class="ident" id="1739885">isNotPrint</span><span class="op" id="1739895">[</span><span class="ident" id="1739896">j</span><span class="op" id="1739897">]</span>&nbsp;<span class="op" id="1739899">!=</span>&nbsp;<span class="ident" id="1739902">rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1739906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1739910">rr</span><span class="op" id="1739912">,</span>&nbsp;<span class="ident" id="1739914">isPrint</span><span class="op" id="1739921">,</span>&nbsp;<span class="ident" id="1739923">isNotPrint</span>&nbsp;<span class="op" id="1739934">:=</span>&nbsp;<span class="builtintype" id="1739937">uint32</span><span class="op" id="1739943">(</span><span class="ident" id="1739944">r</span><span class="op" id="1739945">)</span><span class="op" id="1739946">,</span>&nbsp;<span class="ident" id="1739948">isPrint32</span><span class="op" id="1739957">,</span>&nbsp;<span class="ident" id="1739959">isNotPrint32</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1739973">i</span>&nbsp;<span class="op" id="1739975">:=</span>&nbsp;<span class="ident" id="1739978">bsearch32</span><span class="op" id="1739987">(</span><span class="ident" id="1739988">isPrint</span><span class="op" id="1739995">,</span>&nbsp;<span class="ident" id="1739997">rr</span><span class="op" id="1739999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1740002">if</span>&nbsp;<span class="ident" id="1740005">i</span>&nbsp;<span class="op" id="1740007">&gt;=</span>&nbsp;<span class="builtinfunc" id="1740010">len</span><span class="op" id="1740013">(</span><span class="ident" id="1740014">isPrint</span><span class="op" id="1740021">)</span>&nbsp;<span class="op" id="1740023">||</span>&nbsp;<span class="ident" id="1740026">rr</span>&nbsp;<span class="op" id="1740029">&lt;</span>&nbsp;<span class="ident" id="1740031">isPrint</span><span class="op" id="1740038">[</span><span class="ident" id="1740039">i</span><span class="op" id="1740040">&amp;^</span><span class="num" id="1740042">1</span><span class="op" id="1740043">]</span>&nbsp;<span class="op" id="1740045">||</span>&nbsp;<span class="ident" id="1740048">isPrint</span><span class="op" id="1740055">[</span><span class="ident" id="1740056">i</span><span class="op" id="1740057">|</span><span class="num" id="1740058">1</span><span class="op" id="1740059">]</span>&nbsp;<span class="op" id="1740061">&lt;</span>&nbsp;<span class="ident" id="1740063">rr</span>&nbsp;<span class="op" id="1740066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1740070">return</span>&nbsp;<span class="builtintype" id="1740077">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1740084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1740087">if</span>&nbsp;<span class="ident" id="1740090">r</span>&nbsp;<span class="op" id="1740092">&gt;=</span>&nbsp;<span class="num" id="1740095">0x20000</span>&nbsp;<span class="op" id="1740103">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1740107">return</span>&nbsp;<span class="builtintype" id="1740114">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1740120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1740123">r</span>&nbsp;<span class="op" id="1740125">-=</span>&nbsp;<span class="num" id="1740128">0x10000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1740137">j</span>&nbsp;<span class="op" id="1740139">:=</span>&nbsp;<span class="ident" id="1740142">bsearch16</span><span class="op" id="1740151">(</span><span class="ident" id="1740152">isNotPrint</span><span class="op" id="1740162">,</span>&nbsp;<span class="builtintype" id="1740164">uint16</span><span class="op" id="1740170">(</span><span class="ident" id="1740171">r</span><span class="op" id="1740172">)</span><span class="op" id="1740173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1740176">return</span>&nbsp;<span class="ident" id="1740183">j</span>&nbsp;<span class="op" id="1740185">&gt;=</span>&nbsp;<span class="builtinfunc" id="1740188">len</span><span class="op" id="1740191">(</span><span class="ident" id="1740192">isNotPrint</span><span class="op" id="1740202">)</span>&nbsp;<span class="op" id="1740204">||</span>&nbsp;<span class="ident" id="1740207">isNotPrint</span><span class="op" id="1740217">[</span><span class="ident" id="1740218">j</span><span class="op" id="1740219">]</span>&nbsp;<span class="op" id="1740221">!=</span>&nbsp;<span class="builtintype" id="1740224">uint16</span><span class="op" id="1740230">(</span><span class="ident" id="1740231">r</span><span class="op" id="1740232">)</span><br>
<span class="lineno">455</span><span class="op" id="1740234">}</span>
</div>
</body>
</html>
