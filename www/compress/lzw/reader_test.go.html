<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7763308">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7763363">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7763417">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7763468">package</span>&nbsp;<span class="ident" id="7763476">lzw</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7763481">import</span>&nbsp;<span class="op" id="7763488">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763491">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763500">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763506">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763519">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763530">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763541">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763552">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7763562">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7763565">type</span>&nbsp;<span class="ident" id="7763570">lzwTest</span>&nbsp;<span class="keyword" id="7763578">struct</span>&nbsp;<span class="op" id="7763585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763588">desc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7763599">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763607">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7763618">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763626">compressed</span>&nbsp;<span class="builtintype" id="7763637">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763645">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7763656">error</span><br>
<span class="lineno"></span><span class="op" id="7763662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7763665">var</span>&nbsp;<span class="ident" id="7763669">lzwTests</span>&nbsp;<span class="op" id="7763678">=</span>&nbsp;<span class="op" id="7763680">[</span><span class="op" id="7763681">]</span><span class="ident" id="7763682">lzwTest</span><span class="op" id="7763689">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763696">&#34;empty;LSB;8&#34;</span><span class="op" id="7763709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763713">&#34;&#34;</span><span class="op" id="7763715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763719">&#34;\x01\x01&#34;</span><span class="op" id="7763729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763733">nil</span><span class="op" id="7763736">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763739">}</span><span class="op" id="7763740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763747">&#34;empty;MSB;8&#34;</span><span class="op" id="7763760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763764">&#34;&#34;</span><span class="op" id="7763766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763770">&#34;\x80\x80&#34;</span><span class="op" id="7763780">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763784">nil</span><span class="op" id="7763787">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763790">}</span><span class="op" id="7763791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763798">&#34;tobe;LSB;7&#34;</span><span class="op" id="7763810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763814">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="7763840">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763844">&#34;\x54\x4f\x42\x45\x4f\x52\x4e\x4f\x54\x82\x84\x86\x8b\x85\x87\x89\x81&#34;</span><span class="op" id="7763914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7763918">nil</span><span class="op" id="7763921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763924">}</span><span class="op" id="7763925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7763928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763932">&#34;tobe;LSB;8&#34;</span><span class="op" id="7763944">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763948">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="7763974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7763978">&#34;\x54\x9e\x08\x29\xf2\x44\x8a\x93\x27\x54\x04\x12\x34\xb8\xb0\xe0\xc1\x84\x01\x01&#34;</span><span class="op" id="7764060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764064">nil</span><span class="op" id="7764067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764070">}</span><span class="op" id="7764071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764074">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764078">&#34;tobe;MSB;7&#34;</span><span class="op" id="7764090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764094">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="7764120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764124">&#34;\x54\x4f\x42\x45\x4f\x52\x4e\x4f\x54\x82\x84\x86\x8b\x85\x87\x89\x81&#34;</span><span class="op" id="7764194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764198">nil</span><span class="op" id="7764201">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764204">}</span><span class="op" id="7764205">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764212">&#34;tobe;MSB;8&#34;</span><span class="op" id="7764224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764228">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="7764254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764258">&#34;\x2a\x13\xc8\x44\x52\x79\x48\x9c\x4f\x2a\x40\xa0\x90\x68\x5c\x16\x0f\x09\x80\x80&#34;</span><span class="op" id="7764340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764344">nil</span><span class="op" id="7764347">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764350">}</span><span class="op" id="7764351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764358">&#34;tobe-truncated;LSB;8&#34;</span><span class="op" id="7764380">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764384">&#34;TOBEORNOTTOBEORTOBEORNOT&#34;</span><span class="op" id="7764410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764414">&#34;\x54\x9e\x08\x29\xf2\x44\x8a\x93\x27\x54\x04&#34;</span><span class="op" id="7764460">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764464">io</span><span class="op" id="7764466">.</span><span class="ident" id="7764467">ErrUnexpectedEOF</span><span class="op" id="7764483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764486">}</span><span class="op" id="7764487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7764490">//&nbsp;This&nbsp;example&nbsp;comes&nbsp;from&nbsp;http://en.wikipedia.org/wiki/Graphics_Interchange_Format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764580">&#34;gif;LSB;8&#34;</span><span class="op" id="7764591">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764595">&#34;\x28\xff\xff\xff\x28\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff&#34;</span><span class="op" id="7764657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764661">&#34;\x00\x51\xfc\x1b\x28\x70\xa0\xc1\x83\x01\x01&#34;</span><span class="op" id="7764707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764711">nil</span><span class="op" id="7764714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764717">}</span><span class="op" id="7764718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7764721">//&nbsp;This&nbsp;example&nbsp;comes&nbsp;from&nbsp;http://compgroups.net/comp.lang.ruby/Decompressing-LZW-compression-from-PDF-file</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764834">&#34;pdf;MSB;8&#34;</span><span class="op" id="7764845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764849">&#34;-----A---B&#34;</span><span class="op" id="7764861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7764865">&#34;\x80\x0b\x60\x50\x22\x0c\x0c\x85\x01&#34;</span><span class="op" id="7764903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7764907">nil</span><span class="op" id="7764910">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7764913">}</span><span class="op" id="7764914">,</span><br>
<span class="lineno"></span><span class="op" id="7764916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7764919">func</span>&nbsp;<span class="ident" id="7764924">TestReader</span><span class="op" id="7764934">(</span><span class="ident" id="7764935">t</span>&nbsp;<span class="op" id="7764937">*</span><span class="ident" id="7764938">testing</span><span class="op" id="7764945">.</span><span class="ident" id="7764946">T</span><span class="op" id="7764947">)</span>&nbsp;<span class="op" id="7764949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7764952">var</span>&nbsp;<span class="ident" id="7764956">b</span>&nbsp;<span class="ident" id="7764958">bytes</span><span class="op" id="7764963">.</span><span class="ident" id="7764964">Buffer</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7764972">for</span>&nbsp;<span class="ident" id="7764976">_</span><span class="op" id="7764977">,</span>&nbsp;<span class="ident" id="7764979">tt</span>&nbsp;<span class="op" id="7764982">:=</span>&nbsp;<span class="keyword" id="7764985">range</span>&nbsp;<span class="ident" id="7764991">lzwTests</span>&nbsp;<span class="op" id="7765000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765004">d</span>&nbsp;<span class="op" id="7765006">:=</span>&nbsp;<span class="ident" id="7765009">strings</span><span class="op" id="7765016">.</span><span class="ident" id="7765017">Split</span><span class="op" id="7765022">(</span><span class="ident" id="7765023">tt</span><span class="op" id="7765025">.</span><span class="ident" id="7765026">desc</span><span class="op" id="7765030">,</span>&nbsp;<span class="string" id="7765032">&#34;;&#34;</span><span class="op" id="7765035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765039">var</span>&nbsp;<span class="ident" id="7765043">order</span>&nbsp;<span class="ident" id="7765049">Order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765057">switch</span>&nbsp;<span class="ident" id="7765064">d</span><span class="op" id="7765065">[</span><span class="num" id="7765066">1</span><span class="op" id="7765067">]</span>&nbsp;<span class="op" id="7765069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765073">case</span>&nbsp;<span class="string" id="7765078">&#34;LSB&#34;</span><span class="op" id="7765083">:</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765088">order</span>&nbsp;<span class="op" id="7765094">=</span>&nbsp;<span class="ident" id="7765096">LSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765102">case</span>&nbsp;<span class="string" id="7765107">&#34;MSB&#34;</span><span class="op" id="7765112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765117">order</span>&nbsp;<span class="op" id="7765123">=</span>&nbsp;<span class="ident" id="7765125">MSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765131">default</span><span class="op" id="7765138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765143">t</span><span class="op" id="7765144">.</span><span class="ident" id="7765145">Errorf</span><span class="op" id="7765151">(</span><span class="string" id="7765152">&#34;%s:&nbsp;bad&nbsp;order&nbsp;%q&#34;</span><span class="op" id="7765170">,</span>&nbsp;<span class="ident" id="7765172">tt</span><span class="op" id="7765174">.</span><span class="ident" id="7765175">desc</span><span class="op" id="7765179">,</span>&nbsp;<span class="ident" id="7765181">d</span><span class="op" id="7765182">[</span><span class="num" id="7765183">1</span><span class="op" id="7765184">]</span><span class="op" id="7765185">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7765189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765193">litWidth</span><span class="op" id="7765201">,</span>&nbsp;<span class="ident" id="7765203">_</span>&nbsp;<span class="op" id="7765205">:=</span>&nbsp;<span class="ident" id="7765208">strconv</span><span class="op" id="7765215">.</span><span class="ident" id="7765216">Atoi</span><span class="op" id="7765220">(</span><span class="ident" id="7765221">d</span><span class="op" id="7765222">[</span><span class="num" id="7765223">2</span><span class="op" id="7765224">]</span><span class="op" id="7765225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765229">rc</span>&nbsp;<span class="op" id="7765232">:=</span>&nbsp;<span class="ident" id="7765235">NewReader</span><span class="op" id="7765244">(</span><span class="ident" id="7765245">strings</span><span class="op" id="7765252">.</span><span class="ident" id="7765253">NewReader</span><span class="op" id="7765262">(</span><span class="ident" id="7765263">tt</span><span class="op" id="7765265">.</span><span class="ident" id="7765266">compressed</span><span class="op" id="7765276">)</span><span class="op" id="7765277">,</span>&nbsp;<span class="ident" id="7765279">order</span><span class="op" id="7765284">,</span>&nbsp;<span class="ident" id="7765286">litWidth</span><span class="op" id="7765294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765298">defer</span>&nbsp;<span class="ident" id="7765304">rc</span><span class="op" id="7765306">.</span><span class="ident" id="7765307">Close</span><span class="op" id="7765312">(</span><span class="op" id="7765313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765317">b</span><span class="op" id="7765318">.</span><span class="ident" id="7765319">Reset</span><span class="op" id="7765324">(</span><span class="op" id="7765325">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765329">n</span><span class="op" id="7765330">,</span>&nbsp;<span class="ident" id="7765332">err</span>&nbsp;<span class="op" id="7765336">:=</span>&nbsp;<span class="ident" id="7765339">io</span><span class="op" id="7765341">.</span><span class="ident" id="7765342">Copy</span><span class="op" id="7765346">(</span><span class="op" id="7765347">&amp;</span><span class="ident" id="7765348">b</span><span class="op" id="7765349">,</span>&nbsp;<span class="ident" id="7765351">rc</span><span class="op" id="7765353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765357">if</span>&nbsp;<span class="ident" id="7765360">err</span>&nbsp;<span class="op" id="7765364">!=</span>&nbsp;<span class="ident" id="7765367">nil</span>&nbsp;<span class="op" id="7765371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765376">if</span>&nbsp;<span class="ident" id="7765379">err</span>&nbsp;<span class="op" id="7765383">!=</span>&nbsp;<span class="ident" id="7765386">tt</span><span class="op" id="7765388">.</span><span class="ident" id="7765389">err</span>&nbsp;<span class="op" id="7765393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765399">t</span><span class="op" id="7765400">.</span><span class="ident" id="7765401">Errorf</span><span class="op" id="7765407">(</span><span class="string" id="7765408">&#34;%s:&nbsp;io.Copy:&nbsp;%v&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7765433">,</span>&nbsp;<span class="ident" id="7765435">tt</span><span class="op" id="7765437">.</span><span class="ident" id="7765438">desc</span><span class="op" id="7765442">,</span>&nbsp;<span class="ident" id="7765444">err</span><span class="op" id="7765447">,</span>&nbsp;<span class="ident" id="7765449">tt</span><span class="op" id="7765451">.</span><span class="ident" id="7765452">err</span><span class="op" id="7765455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7765460">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765465">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7765476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765480">s</span>&nbsp;<span class="op" id="7765482">:=</span>&nbsp;<span class="ident" id="7765485">b</span><span class="op" id="7765486">.</span><span class="ident" id="7765487">String</span><span class="op" id="7765493">(</span><span class="op" id="7765494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765498">if</span>&nbsp;<span class="ident" id="7765501">s</span>&nbsp;<span class="op" id="7765503">!=</span>&nbsp;<span class="ident" id="7765506">tt</span><span class="op" id="7765508">.</span><span class="ident" id="7765509">raw</span>&nbsp;<span class="op" id="7765513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765518">t</span><span class="op" id="7765519">.</span><span class="ident" id="7765520">Errorf</span><span class="op" id="7765526">(</span><span class="string" id="7765527">&#34;%s:&nbsp;got&nbsp;%d-byte&nbsp;%q&nbsp;want&nbsp;%d-byte&nbsp;%q&#34;</span><span class="op" id="7765563">,</span>&nbsp;<span class="ident" id="7765565">tt</span><span class="op" id="7765567">.</span><span class="ident" id="7765568">desc</span><span class="op" id="7765572">,</span>&nbsp;<span class="ident" id="7765574">n</span><span class="op" id="7765575">,</span>&nbsp;<span class="ident" id="7765577">s</span><span class="op" id="7765578">,</span>&nbsp;<span class="builtinfunc" id="7765580">len</span><span class="op" id="7765583">(</span><span class="ident" id="7765584">tt</span><span class="op" id="7765586">.</span><span class="ident" id="7765587">raw</span><span class="op" id="7765590">)</span><span class="op" id="7765591">,</span>&nbsp;<span class="ident" id="7765593">tt</span><span class="op" id="7765595">.</span><span class="ident" id="7765596">raw</span><span class="op" id="7765599">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7765603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7765606">}</span><br>
<span class="lineno"></span><span class="op" id="7765608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7765611">func</span>&nbsp;<span class="ident" id="7765616">benchmarkDecoder</span><span class="op" id="7765632">(</span><span class="ident" id="7765633">b</span>&nbsp;<span class="op" id="7765635">*</span><span class="ident" id="7765636">testing</span><span class="op" id="7765643">.</span><span class="ident" id="7765644">B</span><span class="op" id="7765645">,</span>&nbsp;<span class="ident" id="7765647">n</span>&nbsp;<span class="builtintype" id="7765649">int</span><span class="op" id="7765652">)</span>&nbsp;<span class="op" id="7765654">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765657">b</span><span class="op" id="7765658">.</span><span class="ident" id="7765659">StopTimer</span><span class="op" id="7765668">(</span><span class="op" id="7765669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765672">b</span><span class="op" id="7765673">.</span><span class="ident" id="7765674">SetBytes</span><span class="op" id="7765682">(</span><span class="ident" id="7765683">int64</span><span class="op" id="7765688">(</span><span class="ident" id="7765689">n</span><span class="op" id="7765690">)</span><span class="op" id="7765691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765694">buf0</span><span class="op" id="7765698">,</span>&nbsp;<span class="ident" id="7765700">err</span>&nbsp;<span class="op" id="7765704">:=</span>&nbsp;<span class="ident" id="7765707">ioutil</span><span class="op" id="7765713">.</span><span class="ident" id="7765714">ReadFile</span><span class="op" id="7765722">(</span><span class="string" id="7765723">&#34;../testdata/e.txt&#34;</span><span class="op" id="7765742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765745">if</span>&nbsp;<span class="ident" id="7765748">err</span>&nbsp;<span class="op" id="7765752">!=</span>&nbsp;<span class="ident" id="7765755">nil</span>&nbsp;<span class="op" id="7765759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765763">b</span><span class="op" id="7765764">.</span><span class="ident" id="7765765">Fatal</span><span class="op" id="7765770">(</span><span class="ident" id="7765771">err</span><span class="op" id="7765774">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7765777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765780">if</span>&nbsp;<span class="builtinfunc" id="7765783">len</span><span class="op" id="7765786">(</span><span class="ident" id="7765787">buf0</span><span class="op" id="7765791">)</span>&nbsp;<span class="op" id="7765793">==</span>&nbsp;<span class="num" id="7765796">0</span>&nbsp;<span class="op" id="7765798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765802">b</span><span class="op" id="7765803">.</span><span class="ident" id="7765804">Fatalf</span><span class="op" id="7765810">(</span><span class="string" id="7765811">&#34;test&nbsp;file&nbsp;has&nbsp;no&nbsp;data&#34;</span><span class="op" id="7765834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7765837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765840">compressed</span>&nbsp;<span class="op" id="7765851">:=</span>&nbsp;<span class="builtinfunc" id="7765854">new</span><span class="op" id="7765857">(</span><span class="ident" id="7765858">bytes</span><span class="op" id="7765863">.</span><span class="ident" id="7765864">Buffer</span><span class="op" id="7765870">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765873">w</span>&nbsp;<span class="op" id="7765875">:=</span>&nbsp;<span class="ident" id="7765878">NewWriter</span><span class="op" id="7765887">(</span><span class="ident" id="7765888">compressed</span><span class="op" id="7765898">,</span>&nbsp;<span class="ident" id="7765900">LSB</span><span class="op" id="7765903">,</span>&nbsp;<span class="num" id="7765905">8</span><span class="op" id="7765906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765909">for</span>&nbsp;<span class="ident" id="7765913">i</span>&nbsp;<span class="op" id="7765915">:=</span>&nbsp;<span class="num" id="7765918">0</span><span class="op" id="7765919">;</span>&nbsp;<span class="ident" id="7765921">i</span>&nbsp;<span class="op" id="7765923">&lt;</span>&nbsp;<span class="ident" id="7765925">n</span><span class="op" id="7765926">;</span>&nbsp;<span class="ident" id="7765928">i</span>&nbsp;<span class="op" id="7765930">+=</span>&nbsp;<span class="builtinfunc" id="7765933">len</span><span class="op" id="7765936">(</span><span class="ident" id="7765937">buf0</span><span class="op" id="7765941">)</span>&nbsp;<span class="op" id="7765943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7765947">if</span>&nbsp;<span class="builtinfunc" id="7765950">len</span><span class="op" id="7765953">(</span><span class="ident" id="7765954">buf0</span><span class="op" id="7765958">)</span>&nbsp;<span class="op" id="7765960">&gt;</span>&nbsp;<span class="ident" id="7765962">n</span><span class="op" id="7765963">-</span><span class="ident" id="7765964">i</span>&nbsp;<span class="op" id="7765966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765971">buf0</span>&nbsp;<span class="op" id="7765976">=</span>&nbsp;<span class="ident" id="7765978">buf0</span><span class="op" id="7765982">[</span><span class="op" id="7765983">:</span><span class="ident" id="7765984">n</span><span class="op" id="7765985">-</span><span class="ident" id="7765986">i</span><span class="op" id="7765987">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7765991">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7765995">w</span><span class="op" id="7765996">.</span><span class="ident" id="7765997">Write</span><span class="op" id="7766002">(</span><span class="ident" id="7766003">buf0</span><span class="op" id="7766007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7766010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7766013">w</span><span class="op" id="7766014">.</span><span class="ident" id="7766015">Close</span><span class="op" id="7766020">(</span><span class="op" id="7766021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7766024">buf1</span>&nbsp;<span class="op" id="7766029">:=</span>&nbsp;<span class="ident" id="7766032">compressed</span><span class="op" id="7766042">.</span><span class="ident" id="7766043">Bytes</span><span class="op" id="7766048">(</span><span class="op" id="7766049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7766052">buf0</span><span class="op" id="7766056">,</span>&nbsp;<span class="ident" id="7766058">compressed</span><span class="op" id="7766068">,</span>&nbsp;<span class="ident" id="7766070">w</span>&nbsp;<span class="op" id="7766072">=</span>&nbsp;<span class="ident" id="7766074">nil</span><span class="op" id="7766077">,</span>&nbsp;<span class="ident" id="7766079">nil</span><span class="op" id="7766082">,</span>&nbsp;<span class="ident" id="7766084">nil</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7766089">runtime</span><span class="op" id="7766096">.</span><span class="ident" id="7766097">GC</span><span class="op" id="7766099">(</span><span class="op" id="7766100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7766103">b</span><span class="op" id="7766104">.</span><span class="ident" id="7766105">StartTimer</span><span class="op" id="7766115">(</span><span class="op" id="7766116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7766119">for</span>&nbsp;<span class="ident" id="7766123">i</span>&nbsp;<span class="op" id="7766125">:=</span>&nbsp;<span class="num" id="7766128">0</span><span class="op" id="7766129">;</span>&nbsp;<span class="ident" id="7766131">i</span>&nbsp;<span class="op" id="7766133">&lt;</span>&nbsp;<span class="ident" id="7766135">b</span><span class="op" id="7766136">.</span><span class="ident" id="7766137">N</span><span class="op" id="7766138">;</span>&nbsp;<span class="ident" id="7766140">i</span><span class="op" id="7766141">++</span>&nbsp;<span class="op" id="7766144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7766148">io</span><span class="op" id="7766150">.</span><span class="ident" id="7766151">Copy</span><span class="op" id="7766155">(</span><span class="ident" id="7766156">ioutil</span><span class="op" id="7766162">.</span><span class="ident" id="7766163">Discard</span><span class="op" id="7766170">,</span>&nbsp;<span class="ident" id="7766172">NewReader</span><span class="op" id="7766181">(</span><span class="ident" id="7766182">bytes</span><span class="op" id="7766187">.</span><span class="ident" id="7766188">NewReader</span><span class="op" id="7766197">(</span><span class="ident" id="7766198">buf1</span><span class="op" id="7766202">)</span><span class="op" id="7766203">,</span>&nbsp;<span class="ident" id="7766205">LSB</span><span class="op" id="7766208">,</span>&nbsp;<span class="num" id="7766210">8</span><span class="op" id="7766211">)</span><span class="op" id="7766212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7766215">}</span><br>
<span class="lineno">140</span><span class="op" id="7766217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7766220">func</span>&nbsp;<span class="ident" id="7766225">BenchmarkDecoder1e4</span><span class="op" id="7766244">(</span><span class="ident" id="7766245">b</span>&nbsp;<span class="op" id="7766247">*</span><span class="ident" id="7766248">testing</span><span class="op" id="7766255">.</span><span class="ident" id="7766256">B</span><span class="op" id="7766257">)</span>&nbsp;<span class="op" id="7766259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7766262">benchmarkDecoder</span><span class="op" id="7766278">(</span><span class="ident" id="7766279">b</span><span class="op" id="7766280">,</span>&nbsp;<span class="num" id="7766282">1e4</span><span class="op" id="7766285">)</span><br>
<span class="lineno"></span><span class="op" id="7766287">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="7766290">func</span>&nbsp;<span class="ident" id="7766295">BenchmarkDecoder1e5</span><span class="op" id="7766314">(</span><span class="ident" id="7766315">b</span>&nbsp;<span class="op" id="7766317">*</span><span class="ident" id="7766318">testing</span><span class="op" id="7766325">.</span><span class="ident" id="7766326">B</span><span class="op" id="7766327">)</span>&nbsp;<span class="op" id="7766329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7766332">benchmarkDecoder</span><span class="op" id="7766348">(</span><span class="ident" id="7766349">b</span><span class="op" id="7766350">,</span>&nbsp;<span class="num" id="7766352">1e5</span><span class="op" id="7766355">)</span><br>
<span class="lineno"></span><span class="op" id="7766357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7766360">func</span>&nbsp;<span class="ident" id="7766365">BenchmarkDecoder1e6</span><span class="op" id="7766384">(</span><span class="ident" id="7766385">b</span>&nbsp;<span class="op" id="7766387">*</span><span class="ident" id="7766388">testing</span><span class="op" id="7766395">.</span><span class="ident" id="7766396">B</span><span class="op" id="7766397">)</span>&nbsp;<span class="op" id="7766399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7766402">benchmarkDecoder</span><span class="op" id="7766418">(</span><span class="ident" id="7766419">b</span><span class="op" id="7766420">,</span>&nbsp;<span class="num" id="7766422">1e6</span><span class="op" id="7766425">)</span><br>
<span class="lineno"></span><span class="op" id="7766427">}</span>
</div>
</body>
</html>
