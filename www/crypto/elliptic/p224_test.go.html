<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8345675">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8345731">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8345785">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8345836">package</span>&nbsp;<span class="ident" id="8345844">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8345854">import</span>&nbsp;<span class="op" id="8345861">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8345864">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8345876">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8345886">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8345889">var</span>&nbsp;<span class="ident" id="8345893">toFromBigTests</span>&nbsp;<span class="op" id="8345908">=</span>&nbsp;<span class="op" id="8345910">[</span><span class="op" id="8345911">]</span><span class="builtintype" id="8345912">string</span><span class="op" id="8345918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8345921">&#34;0&#34;</span><span class="op" id="8345924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8345927">&#34;1&#34;</span><span class="op" id="8345930">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8345933">&#34;23&#34;</span><span class="op" id="8345937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8345940">&#34;b70e0cb46bb4bf7f321390b94a03c1d356c01122343280d6105c1d21&#34;</span><span class="op" id="8345998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8346001">&#34;706a46d476dcb76798e6046d89474788d164c18032d268fd10704fa6&#34;</span><span class="op" id="8346059">,</span><br>
<span class="lineno"></span><span class="op" id="8346061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8346064">func</span>&nbsp;<span class="ident" id="8346069">p224AlternativeToBig</span><span class="op" id="8346089">(</span><span class="ident" id="8346090">in</span>&nbsp;<span class="op" id="8346093">*</span><span class="ident" id="8346094">p224FieldElement</span><span class="op" id="8346110">)</span>&nbsp;<span class="op" id="8346112">*</span><span class="ident" id="8346113">big</span><span class="op" id="8346116">.</span><span class="ident" id="8346117">Int</span>&nbsp;<span class="op" id="8346121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8346124">ret</span>&nbsp;<span class="op" id="8346128">:=</span>&nbsp;<span class="builtinfunc" id="8346131">new</span><span class="op" id="8346134">(</span><span class="ident" id="8346135">big</span><span class="op" id="8346138">.</span><span class="ident" id="8346139">Int</span><span class="op" id="8346142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8346145">tmp</span>&nbsp;<span class="op" id="8346149">:=</span>&nbsp;<span class="builtinfunc" id="8346152">new</span><span class="op" id="8346155">(</span><span class="ident" id="8346156">big</span><span class="op" id="8346159">.</span><span class="ident" id="8346160">Int</span><span class="op" id="8346163">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8346167">for</span>&nbsp;<span class="ident" id="8346171">i</span>&nbsp;<span class="op" id="8346173">:=</span>&nbsp;<span class="builtintype" id="8346176">uint</span><span class="op" id="8346180">(</span><span class="num" id="8346181">0</span><span class="op" id="8346182">)</span><span class="op" id="8346183">;</span>&nbsp;<span class="ident" id="8346185">i</span>&nbsp;<span class="op" id="8346187">&lt;</span>&nbsp;<span class="num" id="8346189">8</span><span class="op" id="8346190">;</span>&nbsp;<span class="ident" id="8346192">i</span><span class="op" id="8346193">++</span>&nbsp;<span class="op" id="8346196">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8346200">tmp</span><span class="op" id="8346203">.</span><span class="ident" id="8346204">SetInt64</span><span class="op" id="8346212">(</span><span class="ident" id="8346213">int64</span><span class="op" id="8346218">(</span><span class="ident" id="8346219">in</span><span class="op" id="8346221">[</span><span class="ident" id="8346222">i</span><span class="op" id="8346223">]</span><span class="op" id="8346224">)</span><span class="op" id="8346225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8346229">tmp</span><span class="op" id="8346232">.</span><span class="ident" id="8346233">Lsh</span><span class="op" id="8346236">(</span><span class="ident" id="8346237">tmp</span><span class="op" id="8346240">,</span>&nbsp;<span class="num" id="8346242">28</span><span class="op" id="8346244">*</span><span class="ident" id="8346245">i</span><span class="op" id="8346246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8346250">ret</span><span class="op" id="8346253">.</span><span class="ident" id="8346254">Add</span><span class="op" id="8346257">(</span><span class="ident" id="8346258">ret</span><span class="op" id="8346261">,</span>&nbsp;<span class="ident" id="8346263">tmp</span><span class="op" id="8346266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8346269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8346272">ret</span><span class="op" id="8346275">.</span><span class="ident" id="8346276">Mod</span><span class="op" id="8346279">(</span><span class="ident" id="8346280">ret</span><span class="op" id="8346283">,</span>&nbsp;<span class="ident" id="8346285">p224</span><span class="op" id="8346289">.</span><span class="ident" id="8346290">P</span><span class="op" id="8346291">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8346294">return</span>&nbsp;<span class="ident" id="8346301">ret</span><br>
<span class="lineno"></span><span class="op" id="8346305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8346308">func</span>&nbsp;<span class="ident" id="8346313">TestToFromBig</span><span class="op" id="8346326">(</span><span class="ident" id="8346327">t</span>&nbsp;<span class="op" id="8346329">*</span><span class="ident" id="8346330">testing</span><span class="op" id="8346337">.</span><span class="ident" id="8346338">T</span><span class="op" id="8346339">)</span>&nbsp;<span class="op" id="8346341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8346344">for</span>&nbsp;<span class="ident" id="8346348">i</span><span class="op" id="8346349">,</span>&nbsp;<span class="ident" id="8346351">test</span>&nbsp;<span class="op" id="8346356">:=</span>&nbsp;<span class="keyword" id="8346359">range</span>&nbsp;<span class="ident" id="8346365">toFromBigTests</span>&nbsp;<span class="op" id="8346380">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8346384">n</span><span class="op" id="8346385">,</span>&nbsp;<span class="ident" id="8346387">_</span>&nbsp;<span class="op" id="8346389">:=</span>&nbsp;<span class="builtinfunc" id="8346392">new</span><span class="op" id="8346395">(</span><span class="ident" id="8346396">big</span><span class="op" id="8346399">.</span><span class="ident" id="8346400">Int</span><span class="op" id="8346403">)</span><span class="op" id="8346404">.</span><span class="ident" id="8346405">SetString</span><span class="op" id="8346414">(</span><span class="ident" id="8346415">test</span><span class="op" id="8346419">,</span>&nbsp;<span class="num" id="8346421">16</span><span class="op" id="8346423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8346427">var</span>&nbsp;<span class="ident" id="8346431">x</span>&nbsp;<span class="ident" id="8346433">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8346452">p224FromBig</span><span class="op" id="8346463">(</span><span class="op" id="8346464">&amp;</span><span class="ident" id="8346465">x</span><span class="op" id="8346466">,</span>&nbsp;<span class="ident" id="8346468">n</span><span class="op" id="8346469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8346473">m</span>&nbsp;<span class="op" id="8346475">:=</span>&nbsp;<span class="ident" id="8346478">p224ToBig</span><span class="op" id="8346487">(</span><span class="op" id="8346488">&amp;</span><span class="ident" id="8346489">x</span><span class="op" id="8346490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8346494">if</span>&nbsp;<span class="ident" id="8346497">n</span><span class="op" id="8346498">.</span><span class="ident" id="8346499">Cmp</span><span class="op" id="8346502">(</span><span class="ident" id="8346503">m</span><span class="op" id="8346504">)</span>&nbsp;<span class="op" id="8346506">!=</span>&nbsp;<span class="num" id="8346509">0</span>&nbsp;<span class="op" id="8346511">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8346516">t</span><span class="op" id="8346517">.</span><span class="ident" id="8346518">Errorf</span><span class="op" id="8346524">(</span><span class="string" id="8346525">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&#34;</span><span class="op" id="8346540">,</span>&nbsp;<span class="ident" id="8346542">i</span><span class="op" id="8346543">,</span>&nbsp;<span class="ident" id="8346545">n</span><span class="op" id="8346546">,</span>&nbsp;<span class="ident" id="8346548">m</span><span class="op" id="8346549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8346553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8346557">q</span>&nbsp;<span class="op" id="8346559">:=</span>&nbsp;<span class="ident" id="8346562">p224AlternativeToBig</span><span class="op" id="8346582">(</span><span class="op" id="8346583">&amp;</span><span class="ident" id="8346584">x</span><span class="op" id="8346585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8346589">if</span>&nbsp;<span class="ident" id="8346592">n</span><span class="op" id="8346593">.</span><span class="ident" id="8346594">Cmp</span><span class="op" id="8346597">(</span><span class="ident" id="8346598">q</span><span class="op" id="8346599">)</span>&nbsp;<span class="op" id="8346601">!=</span>&nbsp;<span class="num" id="8346604">0</span>&nbsp;<span class="op" id="8346606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8346611">t</span><span class="op" id="8346612">.</span><span class="ident" id="8346613">Errorf</span><span class="op" id="8346619">(</span><span class="string" id="8346620">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&nbsp;(alternative)&#34;</span><span class="op" id="8346649">,</span>&nbsp;<span class="ident" id="8346651">i</span><span class="op" id="8346652">,</span>&nbsp;<span class="ident" id="8346654">n</span><span class="op" id="8346655">,</span>&nbsp;<span class="ident" id="8346657">m</span><span class="op" id="8346658">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8346662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8346665">}</span><br>
<span class="lineno"></span><span class="op" id="8346667">}</span>
</div>
</body>
</html>
