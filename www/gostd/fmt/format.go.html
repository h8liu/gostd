<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>fmt</h2>
<ul>
<li><a href="/gostd/fmt/doc.go.html">doc.go</a></li>
<li><a href="/gostd/fmt/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/fmt/fmt_test.go.html">fmt_test.go</a></li>
<li><a href="/gostd/fmt/format.go.html">format.go</a></li>
<li><a href="/gostd/fmt/print.go.html">print.go</a></li>
<li><a href="/gostd/fmt/scan.go.html">scan.go</a></li>
<li><a href="/gostd/fmt/scan_test.go.html">scan_test.go</a></li>
<li><a href="/gostd/fmt/stringer_test.go.html">stringer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2379361">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2379416">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2379470">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2379521">package</span>&nbsp;<span class="ident" id="2379529">fmt</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2379534">import</span>&nbsp;<span class="op" id="2379541">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2379544">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2379552">&#34;strconv&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2379563">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="2379578">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2379581">const</span>&nbsp;<span class="op" id="2379587">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2379590">//&nbsp;%b&nbsp;of&nbsp;an&nbsp;int64,&nbsp;plus&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2379623">//&nbsp;Hex&nbsp;can&nbsp;add&nbsp;0x&nbsp;and&nbsp;we&nbsp;handle&nbsp;it&nbsp;specially.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2379670">nByte</span>&nbsp;<span class="op" id="2379676">=</span>&nbsp;<span class="num" id="2379678">65</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2379683">ldigits</span>&nbsp;<span class="op" id="2379691">=</span>&nbsp;<span class="string" id="2379693">&#34;0123456789abcdef&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2379713">udigits</span>&nbsp;<span class="op" id="2379721">=</span>&nbsp;<span class="string" id="2379723">&#34;0123456789ABCDEF&#34;</span><br>
<span class="lineno">20</span><span class="op" id="2379742">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2379745">const</span>&nbsp;<span class="op" id="2379751">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2379754">signed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2379763">=</span>&nbsp;<span class="builtintype" id="2379765">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2379771">unsigned</span>&nbsp;<span class="op" id="2379780">=</span>&nbsp;<span class="builtintype" id="2379782">false</span><br>
<span class="lineno">25</span><span class="op" id="2379788">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2379791">var</span>&nbsp;<span class="ident" id="2379795">padZeroBytes</span>&nbsp;<span class="op" id="2379808">=</span>&nbsp;<span class="builtinfunc" id="2379810">make</span><span class="op" id="2379814">(</span><span class="op" id="2379815">[</span><span class="op" id="2379816">]</span><span class="builtintype" id="2379817">byte</span><span class="op" id="2379821">,</span>&nbsp;<span class="ident" id="2379823">nByte</span><span class="op" id="2379828">)</span><br>
<span class="lineno"></span><span class="keyword" id="2379830">var</span>&nbsp;<span class="ident" id="2379834">padSpaceBytes</span>&nbsp;<span class="op" id="2379848">=</span>&nbsp;<span class="builtinfunc" id="2379850">make</span><span class="op" id="2379854">(</span><span class="op" id="2379855">[</span><span class="op" id="2379856">]</span><span class="builtintype" id="2379857">byte</span><span class="op" id="2379861">,</span>&nbsp;<span class="ident" id="2379863">nByte</span><span class="op" id="2379868">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="2379871">func</span>&nbsp;<span class="ident" id="2379876">init</span><span class="op" id="2379880">(</span><span class="op" id="2379881">)</span>&nbsp;<span class="op" id="2379883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2379886">for</span>&nbsp;<span class="ident" id="2379890">i</span>&nbsp;<span class="op" id="2379892">:=</span>&nbsp;<span class="num" id="2379895">0</span><span class="op" id="2379896">;</span>&nbsp;<span class="ident" id="2379898">i</span>&nbsp;<span class="op" id="2379900">&lt;</span>&nbsp;<span class="ident" id="2379902">nByte</span><span class="op" id="2379907">;</span>&nbsp;<span class="ident" id="2379909">i</span><span class="op" id="2379910">++</span>&nbsp;<span class="op" id="2379913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2379917">padZeroBytes</span><span class="op" id="2379929">[</span><span class="ident" id="2379930">i</span><span class="op" id="2379931">]</span>&nbsp;<span class="op" id="2379933">=</span>&nbsp;<span class="string" id="2379935">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2379941">padSpaceBytes</span><span class="op" id="2379954">[</span><span class="ident" id="2379955">i</span><span class="op" id="2379956">]</span>&nbsp;<span class="op" id="2379958">=</span>&nbsp;<span class="string" id="2379960">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2379965">}</span><br>
<span class="lineno">35</span><span class="op" id="2379967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2379970">//&nbsp;flags&nbsp;placed&nbsp;in&nbsp;a&nbsp;separate&nbsp;struct&nbsp;for&nbsp;easy&nbsp;clearing.</span><br>
<span class="lineno"></span><span class="keyword" id="2380026">type</span>&nbsp;<span class="ident" id="2380031">fmtFlags</span>&nbsp;<span class="keyword" id="2380040">struct</span>&nbsp;<span class="op" id="2380047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380050">widPresent</span>&nbsp;&nbsp;<span class="builtintype" id="2380062">bool</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380068">precPresent</span>&nbsp;<span class="builtintype" id="2380080">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380086">minus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2380098">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380104">plus</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2380116">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380122">sharp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2380134">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380140">space</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2380152">bool</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380158">unicode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2380170">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380176">uniQuote</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2380188">bool</span>&nbsp;<span class="comment" id="2380193">//&nbsp;Use&nbsp;&#39;x&#39;=&nbsp;prefix&nbsp;for&nbsp;%U&nbsp;if&nbsp;printable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380234">zero</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2380246">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2380253">//&nbsp;For&nbsp;the&nbsp;formats&nbsp;%+v&nbsp;%#v,&nbsp;we&nbsp;set&nbsp;the&nbsp;plusV/sharpV&nbsp;flags</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2380312">//&nbsp;and&nbsp;clear&nbsp;the&nbsp;plus/sharp&nbsp;flags&nbsp;since&nbsp;%+v&nbsp;and&nbsp;%#v&nbsp;are&nbsp;in&nbsp;effect</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2380379">//&nbsp;different,&nbsp;flagless&nbsp;formats&nbsp;set&nbsp;at&nbsp;the&nbsp;top&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380433">plusV</span>&nbsp;&nbsp;<span class="builtintype" id="2380440">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380446">sharpV</span>&nbsp;<span class="builtintype" id="2380453">bool</span><br>
<span class="lineno"></span><span class="op" id="2380458">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2380461">//&nbsp;A&nbsp;fmt&nbsp;is&nbsp;the&nbsp;raw&nbsp;formatter&nbsp;used&nbsp;by&nbsp;Printf&nbsp;etc.</span><br>
<span class="lineno"></span><span class="comment" id="2380511">//&nbsp;It&nbsp;prints&nbsp;into&nbsp;a&nbsp;buffer&nbsp;that&nbsp;must&nbsp;be&nbsp;set&nbsp;up&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="2380570">type</span>&nbsp;<span class="ident" id="2380575">fmt</span>&nbsp;<span class="keyword" id="2380579">struct</span>&nbsp;<span class="op" id="2380586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380589">intbuf</span>&nbsp;<span class="op" id="2380596">[</span><span class="ident" id="2380597">nByte</span><span class="op" id="2380602">]</span><span class="builtintype" id="2380603">byte</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380609">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2380616">*</span><span class="ident" id="2380617">buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2380625">//&nbsp;width,&nbsp;precision</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380646">wid</span>&nbsp;&nbsp;<span class="builtintype" id="2380651">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380656">prec</span>&nbsp;<span class="builtintype" id="2380661">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380666">fmtFlags</span><br>
<span class="lineno">65</span><span class="op" id="2380675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2380678">func</span>&nbsp;<span class="op" id="2380683">(</span><span class="ident" id="2380684">f</span>&nbsp;<span class="op" id="2380686">*</span><span class="ident" id="2380687">fmt</span><span class="op" id="2380690">)</span>&nbsp;<span class="ident" id="2380692">clearflags</span><span class="op" id="2380702">(</span><span class="op" id="2380703">)</span>&nbsp;<span class="op" id="2380705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380708">f</span><span class="op" id="2380709">.</span><span class="ident" id="2380710">fmtFlags</span>&nbsp;<span class="op" id="2380719">=</span>&nbsp;<span class="ident" id="2380721">fmtFlags</span><span class="op" id="2380729">{</span><span class="op" id="2380730">}</span><br>
<span class="lineno"></span><span class="op" id="2380732">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="2380735">func</span>&nbsp;<span class="op" id="2380740">(</span><span class="ident" id="2380741">f</span>&nbsp;<span class="op" id="2380743">*</span><span class="ident" id="2380744">fmt</span><span class="op" id="2380747">)</span>&nbsp;<span class="ident" id="2380749">init</span><span class="op" id="2380753">(</span><span class="ident" id="2380754">buf</span>&nbsp;<span class="op" id="2380758">*</span><span class="ident" id="2380759">buffer</span><span class="op" id="2380765">)</span>&nbsp;<span class="op" id="2380767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380770">f</span><span class="op" id="2380771">.</span><span class="ident" id="2380772">buf</span>&nbsp;<span class="op" id="2380776">=</span>&nbsp;<span class="ident" id="2380778">buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380783">f</span><span class="op" id="2380784">.</span><span class="ident" id="2380785">clearflags</span><span class="op" id="2380795">(</span><span class="op" id="2380796">)</span><br>
<span class="lineno"></span><span class="op" id="2380798">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2380801">//&nbsp;computePadding&nbsp;computes&nbsp;left&nbsp;and&nbsp;right&nbsp;padding&nbsp;widths&nbsp;(only&nbsp;one&nbsp;will&nbsp;be&nbsp;non-zero).</span><br>
<span class="lineno"></span><span class="keyword" id="2380887">func</span>&nbsp;<span class="op" id="2380892">(</span><span class="ident" id="2380893">f</span>&nbsp;<span class="op" id="2380895">*</span><span class="ident" id="2380896">fmt</span><span class="op" id="2380899">)</span>&nbsp;<span class="ident" id="2380901">computePadding</span><span class="op" id="2380915">(</span><span class="ident" id="2380916">width</span>&nbsp;<span class="builtintype" id="2380922">int</span><span class="op" id="2380925">)</span>&nbsp;<span class="op" id="2380927">(</span><span class="ident" id="2380928">padding</span>&nbsp;<span class="op" id="2380936">[</span><span class="op" id="2380937">]</span><span class="builtintype" id="2380938">byte</span><span class="op" id="2380942">,</span>&nbsp;<span class="ident" id="2380944">leftWidth</span><span class="op" id="2380953">,</span>&nbsp;<span class="ident" id="2380955">rightWidth</span>&nbsp;<span class="builtintype" id="2380966">int</span><span class="op" id="2380969">)</span>&nbsp;<span class="op" id="2380971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380974">left</span>&nbsp;<span class="op" id="2380979">:=</span>&nbsp;<span class="op" id="2380982">!</span><span class="ident" id="2380983">f</span><span class="op" id="2380984">.</span><span class="ident" id="2380985">minus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2380992">w</span>&nbsp;<span class="op" id="2380994">:=</span>&nbsp;<span class="ident" id="2380997">f</span><span class="op" id="2380998">.</span><span class="ident" id="2380999">wid</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381004">if</span>&nbsp;<span class="ident" id="2381007">w</span>&nbsp;<span class="op" id="2381009">&lt;</span>&nbsp;<span class="num" id="2381011">0</span>&nbsp;<span class="op" id="2381013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381017">left</span>&nbsp;<span class="op" id="2381022">=</span>&nbsp;<span class="builtintype" id="2381024">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381032">w</span>&nbsp;<span class="op" id="2381034">=</span>&nbsp;<span class="op" id="2381036">-</span><span class="ident" id="2381037">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381043">w</span>&nbsp;<span class="op" id="2381045">-=</span>&nbsp;<span class="ident" id="2381048">width</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381055">if</span>&nbsp;<span class="ident" id="2381058">w</span>&nbsp;<span class="op" id="2381060">&gt;</span>&nbsp;<span class="num" id="2381062">0</span>&nbsp;<span class="op" id="2381064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381068">if</span>&nbsp;<span class="ident" id="2381071">left</span>&nbsp;<span class="op" id="2381076">&amp;&amp;</span>&nbsp;<span class="ident" id="2381079">f</span><span class="op" id="2381080">.</span><span class="ident" id="2381081">zero</span>&nbsp;<span class="op" id="2381086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381091">return</span>&nbsp;<span class="ident" id="2381098">padZeroBytes</span><span class="op" id="2381110">,</span>&nbsp;<span class="ident" id="2381112">w</span><span class="op" id="2381113">,</span>&nbsp;<span class="num" id="2381115">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381123">if</span>&nbsp;<span class="ident" id="2381126">left</span>&nbsp;<span class="op" id="2381131">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381136">return</span>&nbsp;<span class="ident" id="2381143">padSpaceBytes</span><span class="op" id="2381156">,</span>&nbsp;<span class="ident" id="2381158">w</span><span class="op" id="2381159">,</span>&nbsp;<span class="num" id="2381161">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381165">}</span>&nbsp;<span class="keyword" id="2381167">else</span>&nbsp;<span class="op" id="2381172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2381177">//&nbsp;can&#39;t&nbsp;be&nbsp;zero&nbsp;padding&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381218">return</span>&nbsp;<span class="ident" id="2381225">padSpaceBytes</span><span class="op" id="2381238">,</span>&nbsp;<span class="num" id="2381240">0</span><span class="op" id="2381241">,</span>&nbsp;<span class="ident" id="2381243">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381247">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381253">return</span><br>
<span class="lineno"></span><span class="op" id="2381260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2381263">//&nbsp;writePadding&nbsp;generates&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding.</span><br>
<span class="lineno">100</span><span class="keyword" id="2381309">func</span>&nbsp;<span class="op" id="2381314">(</span><span class="ident" id="2381315">f</span>&nbsp;<span class="op" id="2381317">*</span><span class="ident" id="2381318">fmt</span><span class="op" id="2381321">)</span>&nbsp;<span class="ident" id="2381323">writePadding</span><span class="op" id="2381335">(</span><span class="ident" id="2381336">n</span>&nbsp;<span class="builtintype" id="2381338">int</span><span class="op" id="2381341">,</span>&nbsp;<span class="ident" id="2381343">padding</span>&nbsp;<span class="op" id="2381351">[</span><span class="op" id="2381352">]</span><span class="builtintype" id="2381353">byte</span><span class="op" id="2381357">)</span>&nbsp;<span class="op" id="2381359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381362">for</span>&nbsp;<span class="ident" id="2381366">n</span>&nbsp;<span class="op" id="2381368">&gt;</span>&nbsp;<span class="num" id="2381370">0</span>&nbsp;<span class="op" id="2381372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381376">m</span>&nbsp;<span class="op" id="2381378">:=</span>&nbsp;<span class="ident" id="2381381">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381385">if</span>&nbsp;<span class="ident" id="2381388">m</span>&nbsp;<span class="op" id="2381390">&gt;</span>&nbsp;<span class="ident" id="2381392">nByte</span>&nbsp;<span class="op" id="2381398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381403">m</span>&nbsp;<span class="op" id="2381405">=</span>&nbsp;<span class="ident" id="2381407">nByte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381419">f</span><span class="op" id="2381420">.</span><span class="ident" id="2381421">buf</span><span class="op" id="2381424">.</span><span class="ident" id="2381425">Write</span><span class="op" id="2381430">(</span><span class="ident" id="2381431">padding</span><span class="op" id="2381438">[</span><span class="num" id="2381439">0</span><span class="op" id="2381440">:</span><span class="ident" id="2381441">m</span><span class="op" id="2381442">]</span><span class="op" id="2381443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381447">n</span>&nbsp;<span class="op" id="2381449">-=</span>&nbsp;<span class="ident" id="2381452">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381455">}</span><br>
<span class="lineno"></span><span class="op" id="2381457">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="2381460">//&nbsp;pad&nbsp;appends&nbsp;b&nbsp;to&nbsp;f.buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2381539">func</span>&nbsp;<span class="op" id="2381544">(</span><span class="ident" id="2381545">f</span>&nbsp;<span class="op" id="2381547">*</span><span class="ident" id="2381548">fmt</span><span class="op" id="2381551">)</span>&nbsp;<span class="ident" id="2381553">pad</span><span class="op" id="2381556">(</span><span class="ident" id="2381557">b</span>&nbsp;<span class="op" id="2381559">[</span><span class="op" id="2381560">]</span><span class="builtintype" id="2381561">byte</span><span class="op" id="2381565">)</span>&nbsp;<span class="op" id="2381567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381570">if</span>&nbsp;<span class="op" id="2381573">!</span><span class="ident" id="2381574">f</span><span class="op" id="2381575">.</span><span class="ident" id="2381576">widPresent</span>&nbsp;<span class="op" id="2381587">||</span>&nbsp;<span class="ident" id="2381590">f</span><span class="op" id="2381591">.</span><span class="ident" id="2381592">wid</span>&nbsp;<span class="op" id="2381596">==</span>&nbsp;<span class="num" id="2381599">0</span>&nbsp;<span class="op" id="2381601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381605">f</span><span class="op" id="2381606">.</span><span class="ident" id="2381607">buf</span><span class="op" id="2381610">.</span><span class="ident" id="2381611">Write</span><span class="op" id="2381616">(</span><span class="ident" id="2381617">b</span><span class="op" id="2381618">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381622">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381633">padding</span><span class="op" id="2381640">,</span>&nbsp;<span class="ident" id="2381642">left</span><span class="op" id="2381646">,</span>&nbsp;<span class="ident" id="2381648">right</span>&nbsp;<span class="op" id="2381654">:=</span>&nbsp;<span class="ident" id="2381657">f</span><span class="op" id="2381658">.</span><span class="ident" id="2381659">computePadding</span><span class="op" id="2381673">(</span><span class="ident" id="2381674">utf8</span><span class="op" id="2381678">.</span><span class="ident" id="2381679">RuneCount</span><span class="op" id="2381688">(</span><span class="ident" id="2381689">b</span><span class="op" id="2381690">)</span><span class="op" id="2381691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381694">if</span>&nbsp;<span class="ident" id="2381697">left</span>&nbsp;<span class="op" id="2381702">&gt;</span>&nbsp;<span class="num" id="2381704">0</span>&nbsp;<span class="op" id="2381706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381710">f</span><span class="op" id="2381711">.</span><span class="ident" id="2381712">writePadding</span><span class="op" id="2381724">(</span><span class="ident" id="2381725">left</span><span class="op" id="2381729">,</span>&nbsp;<span class="ident" id="2381731">padding</span><span class="op" id="2381738">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381744">f</span><span class="op" id="2381745">.</span><span class="ident" id="2381746">buf</span><span class="op" id="2381749">.</span><span class="ident" id="2381750">Write</span><span class="op" id="2381755">(</span><span class="ident" id="2381756">b</span><span class="op" id="2381757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381760">if</span>&nbsp;<span class="ident" id="2381763">right</span>&nbsp;<span class="op" id="2381769">&gt;</span>&nbsp;<span class="num" id="2381771">0</span>&nbsp;<span class="op" id="2381773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381777">f</span><span class="op" id="2381778">.</span><span class="ident" id="2381779">writePadding</span><span class="op" id="2381791">(</span><span class="ident" id="2381792">right</span><span class="op" id="2381797">,</span>&nbsp;<span class="ident" id="2381799">padding</span><span class="op" id="2381806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2381809">}</span><br>
<span class="lineno">125</span><span class="op" id="2381811">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2381814">//&nbsp;padString&nbsp;appends&nbsp;s&nbsp;to&nbsp;buf,&nbsp;padded&nbsp;on&nbsp;left&nbsp;(w&nbsp;&gt;&nbsp;0)&nbsp;or&nbsp;right&nbsp;(w&nbsp;&lt;&nbsp;0&nbsp;or&nbsp;f.minus).</span><br>
<span class="lineno"></span><span class="keyword" id="2381897">func</span>&nbsp;<span class="op" id="2381902">(</span><span class="ident" id="2381903">f</span>&nbsp;<span class="op" id="2381905">*</span><span class="ident" id="2381906">fmt</span><span class="op" id="2381909">)</span>&nbsp;<span class="ident" id="2381911">padString</span><span class="op" id="2381920">(</span><span class="ident" id="2381921">s</span>&nbsp;<span class="builtintype" id="2381923">string</span><span class="op" id="2381929">)</span>&nbsp;<span class="op" id="2381931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381934">if</span>&nbsp;<span class="op" id="2381937">!</span><span class="ident" id="2381938">f</span><span class="op" id="2381939">.</span><span class="ident" id="2381940">widPresent</span>&nbsp;<span class="op" id="2381951">||</span>&nbsp;<span class="ident" id="2381954">f</span><span class="op" id="2381955">.</span><span class="ident" id="2381956">wid</span>&nbsp;<span class="op" id="2381960">==</span>&nbsp;<span class="num" id="2381963">0</span>&nbsp;<span class="op" id="2381965">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2381969">f</span><span class="op" id="2381970">.</span><span class="ident" id="2381971">buf</span><span class="op" id="2381974">.</span><span class="ident" id="2381975">WriteString</span><span class="op" id="2381986">(</span><span class="ident" id="2381987">s</span><span class="op" id="2381988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2381992">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382003">padding</span><span class="op" id="2382010">,</span>&nbsp;<span class="ident" id="2382012">left</span><span class="op" id="2382016">,</span>&nbsp;<span class="ident" id="2382018">right</span>&nbsp;<span class="op" id="2382024">:=</span>&nbsp;<span class="ident" id="2382027">f</span><span class="op" id="2382028">.</span><span class="ident" id="2382029">computePadding</span><span class="op" id="2382043">(</span><span class="ident" id="2382044">utf8</span><span class="op" id="2382048">.</span><span class="ident" id="2382049">RuneCountInString</span><span class="op" id="2382066">(</span><span class="ident" id="2382067">s</span><span class="op" id="2382068">)</span><span class="op" id="2382069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382072">if</span>&nbsp;<span class="ident" id="2382075">left</span>&nbsp;<span class="op" id="2382080">&gt;</span>&nbsp;<span class="num" id="2382082">0</span>&nbsp;<span class="op" id="2382084">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382088">f</span><span class="op" id="2382089">.</span><span class="ident" id="2382090">writePadding</span><span class="op" id="2382102">(</span><span class="ident" id="2382103">left</span><span class="op" id="2382107">,</span>&nbsp;<span class="ident" id="2382109">padding</span><span class="op" id="2382116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382122">f</span><span class="op" id="2382123">.</span><span class="ident" id="2382124">buf</span><span class="op" id="2382127">.</span><span class="ident" id="2382128">WriteString</span><span class="op" id="2382139">(</span><span class="ident" id="2382140">s</span><span class="op" id="2382141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382144">if</span>&nbsp;<span class="ident" id="2382147">right</span>&nbsp;<span class="op" id="2382153">&gt;</span>&nbsp;<span class="num" id="2382155">0</span>&nbsp;<span class="op" id="2382157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382161">f</span><span class="op" id="2382162">.</span><span class="ident" id="2382163">writePadding</span><span class="op" id="2382175">(</span><span class="ident" id="2382176">right</span><span class="op" id="2382181">,</span>&nbsp;<span class="ident" id="2382183">padding</span><span class="op" id="2382190">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382193">}</span><br>
<span class="lineno"></span><span class="op" id="2382195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2382198">var</span>&nbsp;<span class="op" id="2382202">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382205">trueBytes</span>&nbsp;&nbsp;<span class="op" id="2382216">=</span>&nbsp;<span class="op" id="2382218">[</span><span class="op" id="2382219">]</span><span class="builtintype" id="2382220">byte</span><span class="op" id="2382224">(</span><span class="string" id="2382225">&#34;true&#34;</span><span class="op" id="2382231">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382234">falseBytes</span>&nbsp;<span class="op" id="2382245">=</span>&nbsp;<span class="op" id="2382247">[</span><span class="op" id="2382248">]</span><span class="builtintype" id="2382249">byte</span><span class="op" id="2382253">(</span><span class="string" id="2382254">&#34;false&#34;</span><span class="op" id="2382261">)</span><br>
<span class="lineno"></span><span class="op" id="2382263">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2382266">//&nbsp;fmt_boolean&nbsp;formats&nbsp;a&nbsp;boolean.</span><br>
<span class="lineno"></span><span class="keyword" id="2382300">func</span>&nbsp;<span class="op" id="2382305">(</span><span class="ident" id="2382306">f</span>&nbsp;<span class="op" id="2382308">*</span><span class="ident" id="2382309">fmt</span><span class="op" id="2382312">)</span>&nbsp;<span class="ident" id="2382314">fmt_boolean</span><span class="op" id="2382325">(</span><span class="ident" id="2382326">v</span>&nbsp;<span class="builtintype" id="2382328">bool</span><span class="op" id="2382332">)</span>&nbsp;<span class="op" id="2382334">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382337">if</span>&nbsp;<span class="ident" id="2382340">v</span>&nbsp;<span class="op" id="2382342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382346">f</span><span class="op" id="2382347">.</span><span class="ident" id="2382348">pad</span><span class="op" id="2382351">(</span><span class="ident" id="2382352">trueBytes</span><span class="op" id="2382361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382364">}</span>&nbsp;<span class="keyword" id="2382366">else</span>&nbsp;<span class="op" id="2382371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382375">f</span><span class="op" id="2382376">.</span><span class="ident" id="2382377">pad</span><span class="op" id="2382380">(</span><span class="ident" id="2382381">falseBytes</span><span class="op" id="2382391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382394">}</span><br>
<span class="lineno">155</span><span class="op" id="2382396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2382399">//&nbsp;integer;&nbsp;interprets&nbsp;prec&nbsp;but&nbsp;not&nbsp;wid.&nbsp;&nbsp;Once&nbsp;formatted,&nbsp;result&nbsp;is&nbsp;sent&nbsp;to&nbsp;pad()</span><br>
<span class="lineno"></span><span class="comment" id="2382481">//&nbsp;and&nbsp;then&nbsp;flags&nbsp;are&nbsp;cleared.</span><br>
<span class="lineno"></span><span class="keyword" id="2382512">func</span>&nbsp;<span class="op" id="2382517">(</span><span class="ident" id="2382518">f</span>&nbsp;<span class="op" id="2382520">*</span><span class="ident" id="2382521">fmt</span><span class="op" id="2382524">)</span>&nbsp;<span class="ident" id="2382526">integer</span><span class="op" id="2382533">(</span><span class="ident" id="2382534">a</span>&nbsp;<span class="ident" id="2382536">int64</span><span class="op" id="2382541">,</span>&nbsp;<span class="ident" id="2382543">base</span>&nbsp;<span class="ident" id="2382548">uint64</span><span class="op" id="2382554">,</span>&nbsp;<span class="ident" id="2382556">signedness</span>&nbsp;<span class="builtintype" id="2382567">bool</span><span class="op" id="2382571">,</span>&nbsp;<span class="ident" id="2382573">digits</span>&nbsp;<span class="builtintype" id="2382580">string</span><span class="op" id="2382586">)</span>&nbsp;<span class="op" id="2382588">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2382591">//&nbsp;precision&nbsp;of&nbsp;0&nbsp;and&nbsp;value&nbsp;of&nbsp;0&nbsp;means&nbsp;&#34;print&nbsp;nothing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382647">if</span>&nbsp;<span class="ident" id="2382650">f</span><span class="op" id="2382651">.</span><span class="ident" id="2382652">precPresent</span>&nbsp;<span class="op" id="2382664">&amp;&amp;</span>&nbsp;<span class="ident" id="2382667">f</span><span class="op" id="2382668">.</span><span class="ident" id="2382669">prec</span>&nbsp;<span class="op" id="2382674">==</span>&nbsp;<span class="num" id="2382677">0</span>&nbsp;<span class="op" id="2382679">&amp;&amp;</span>&nbsp;<span class="ident" id="2382682">a</span>&nbsp;<span class="op" id="2382684">==</span>&nbsp;<span class="num" id="2382687">0</span>&nbsp;<span class="op" id="2382689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382693">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382705">var</span>&nbsp;<span class="ident" id="2382709">buf</span>&nbsp;<span class="op" id="2382713">[</span><span class="op" id="2382714">]</span><span class="builtintype" id="2382715">byte</span>&nbsp;<span class="op" id="2382720">=</span>&nbsp;<span class="ident" id="2382722">f</span><span class="op" id="2382723">.</span><span class="ident" id="2382724">intbuf</span><span class="op" id="2382730">[</span><span class="num" id="2382731">0</span><span class="op" id="2382732">:</span><span class="op" id="2382733">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382736">if</span>&nbsp;<span class="ident" id="2382739">f</span><span class="op" id="2382740">.</span><span class="ident" id="2382741">widPresent</span>&nbsp;<span class="op" id="2382752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382756">width</span>&nbsp;<span class="op" id="2382762">:=</span>&nbsp;<span class="ident" id="2382765">f</span><span class="op" id="2382766">.</span><span class="ident" id="2382767">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382773">if</span>&nbsp;<span class="ident" id="2382776">base</span>&nbsp;<span class="op" id="2382781">==</span>&nbsp;<span class="num" id="2382784">16</span>&nbsp;<span class="op" id="2382787">&amp;&amp;</span>&nbsp;<span class="ident" id="2382790">f</span><span class="op" id="2382791">.</span><span class="ident" id="2382792">sharp</span>&nbsp;<span class="op" id="2382798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2382803">//&nbsp;Also&nbsp;adds&nbsp;&#34;0x&#34;.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382825">width</span>&nbsp;<span class="op" id="2382831">+=</span>&nbsp;<span class="num" id="2382834">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382842">if</span>&nbsp;<span class="ident" id="2382845">width</span>&nbsp;<span class="op" id="2382851">&gt;</span>&nbsp;<span class="ident" id="2382853">nByte</span>&nbsp;<span class="op" id="2382859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2382864">//&nbsp;We&#39;re&nbsp;going&nbsp;to&nbsp;need&nbsp;a&nbsp;bigger&nbsp;boat.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382905">buf</span>&nbsp;<span class="op" id="2382909">=</span>&nbsp;<span class="builtinfunc" id="2382911">make</span><span class="op" id="2382915">(</span><span class="op" id="2382916">[</span><span class="op" id="2382917">]</span><span class="builtintype" id="2382918">byte</span><span class="op" id="2382922">,</span>&nbsp;<span class="ident" id="2382924">width</span><span class="op" id="2382929">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2382936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382940">negative</span>&nbsp;<span class="op" id="2382949">:=</span>&nbsp;<span class="ident" id="2382952">signedness</span>&nbsp;<span class="op" id="2382963">==</span>&nbsp;<span class="ident" id="2382966">signed</span>&nbsp;<span class="op" id="2382973">&amp;&amp;</span>&nbsp;<span class="ident" id="2382976">a</span>&nbsp;<span class="op" id="2382978">&lt;</span>&nbsp;<span class="num" id="2382980">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2382983">if</span>&nbsp;<span class="ident" id="2382986">negative</span>&nbsp;<span class="op" id="2382995">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2382999">a</span>&nbsp;<span class="op" id="2383001">=</span>&nbsp;<span class="op" id="2383003">-</span><span class="ident" id="2383004">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2383007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2383011">//&nbsp;two&nbsp;ways&nbsp;to&nbsp;ask&nbsp;for&nbsp;extra&nbsp;leading&nbsp;zero&nbsp;digits:&nbsp;%.3d&nbsp;or&nbsp;%03d.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2383076">//&nbsp;apparently&nbsp;the&nbsp;first&nbsp;cancels&nbsp;the&nbsp;second.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383121">prec</span>&nbsp;<span class="op" id="2383126">:=</span>&nbsp;<span class="num" id="2383129">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383132">if</span>&nbsp;<span class="ident" id="2383135">f</span><span class="op" id="2383136">.</span><span class="ident" id="2383137">precPresent</span>&nbsp;<span class="op" id="2383149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383153">prec</span>&nbsp;<span class="op" id="2383158">=</span>&nbsp;<span class="ident" id="2383160">f</span><span class="op" id="2383161">.</span><span class="ident" id="2383162">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383169">f</span><span class="op" id="2383170">.</span><span class="ident" id="2383171">zero</span>&nbsp;<span class="op" id="2383176">=</span>&nbsp;<span class="builtintype" id="2383178">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2383185">}</span>&nbsp;<span class="keyword" id="2383187">else</span>&nbsp;<span class="keyword" id="2383192">if</span>&nbsp;<span class="ident" id="2383195">f</span><span class="op" id="2383196">.</span><span class="ident" id="2383197">zero</span>&nbsp;<span class="op" id="2383202">&amp;&amp;</span>&nbsp;<span class="ident" id="2383205">f</span><span class="op" id="2383206">.</span><span class="ident" id="2383207">widPresent</span>&nbsp;<span class="op" id="2383218">&amp;&amp;</span>&nbsp;<span class="op" id="2383221">!</span><span class="ident" id="2383222">f</span><span class="op" id="2383223">.</span><span class="ident" id="2383224">minus</span>&nbsp;<span class="op" id="2383230">&amp;&amp;</span>&nbsp;<span class="ident" id="2383233">f</span><span class="op" id="2383234">.</span><span class="ident" id="2383235">wid</span>&nbsp;<span class="op" id="2383239">&gt;</span>&nbsp;<span class="num" id="2383241">0</span>&nbsp;<span class="op" id="2383243">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383247">prec</span>&nbsp;<span class="op" id="2383252">=</span>&nbsp;<span class="ident" id="2383254">f</span><span class="op" id="2383255">.</span><span class="ident" id="2383256">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383262">if</span>&nbsp;<span class="ident" id="2383265">negative</span>&nbsp;<span class="op" id="2383274">||</span>&nbsp;<span class="ident" id="2383277">f</span><span class="op" id="2383278">.</span><span class="ident" id="2383279">plus</span>&nbsp;<span class="op" id="2383284">||</span>&nbsp;<span class="ident" id="2383287">f</span><span class="op" id="2383288">.</span><span class="ident" id="2383289">space</span>&nbsp;<span class="op" id="2383295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383300">prec</span><span class="op" id="2383304">--</span>&nbsp;<span class="comment" id="2383307">//&nbsp;leave&nbsp;room&nbsp;for&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2383332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2383335">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2383339">//&nbsp;format&nbsp;a&nbsp;into&nbsp;buf,&nbsp;ending&nbsp;at&nbsp;buf[i].&nbsp;&nbsp;(printing&nbsp;is&nbsp;easier&nbsp;right-to-left.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2383417">//&nbsp;a&nbsp;is&nbsp;made&nbsp;into&nbsp;unsigned&nbsp;ua.&nbsp;&nbsp;we&nbsp;could&nbsp;make&nbsp;things</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2383471">//&nbsp;marginally&nbsp;faster&nbsp;by&nbsp;splitting&nbsp;the&nbsp;32-bit&nbsp;case&nbsp;out&nbsp;into&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2383542">//&nbsp;block&nbsp;but&nbsp;it&#39;s&nbsp;not&nbsp;worth&nbsp;the&nbsp;duplication,&nbsp;so&nbsp;ua&nbsp;has&nbsp;64&nbsp;bits.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383607">i</span>&nbsp;<span class="op" id="2383609">:=</span>&nbsp;<span class="builtinfunc" id="2383612">len</span><span class="op" id="2383615">(</span><span class="ident" id="2383616">buf</span><span class="op" id="2383619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383622">ua</span>&nbsp;<span class="op" id="2383625">:=</span>&nbsp;<span class="ident" id="2383628">uint64</span><span class="op" id="2383634">(</span><span class="ident" id="2383635">a</span><span class="op" id="2383636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2383639">//&nbsp;use&nbsp;constants&nbsp;for&nbsp;the&nbsp;division&nbsp;and&nbsp;modulo&nbsp;for&nbsp;more&nbsp;efficient&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2383710">//&nbsp;switch&nbsp;cases&nbsp;ordered&nbsp;by&nbsp;popularity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383750">switch</span>&nbsp;<span class="ident" id="2383757">base</span>&nbsp;<span class="op" id="2383762">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383765">case</span>&nbsp;<span class="num" id="2383770">10</span><span class="op" id="2383772">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383776">for</span>&nbsp;<span class="ident" id="2383780">ua</span>&nbsp;<span class="op" id="2383783">&gt;=</span>&nbsp;<span class="num" id="2383786">10</span>&nbsp;<span class="op" id="2383789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383794">i</span><span class="op" id="2383795">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383801">next</span>&nbsp;<span class="op" id="2383806">:=</span>&nbsp;<span class="ident" id="2383809">ua</span>&nbsp;<span class="op" id="2383812">/</span>&nbsp;<span class="num" id="2383814">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383820">buf</span><span class="op" id="2383823">[</span><span class="ident" id="2383824">i</span><span class="op" id="2383825">]</span>&nbsp;<span class="op" id="2383827">=</span>&nbsp;<span class="builtintype" id="2383829">byte</span><span class="op" id="2383833">(</span><span class="string" id="2383834">&#39;0&#39;</span>&nbsp;<span class="op" id="2383838">+</span>&nbsp;<span class="ident" id="2383840">ua</span>&nbsp;<span class="op" id="2383843">-</span>&nbsp;<span class="ident" id="2383845">next</span><span class="op" id="2383849">*</span><span class="num" id="2383850">10</span><span class="op" id="2383852">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383857">ua</span>&nbsp;<span class="op" id="2383860">=</span>&nbsp;<span class="ident" id="2383862">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2383869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383872">case</span>&nbsp;<span class="num" id="2383877">16</span><span class="op" id="2383879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383883">for</span>&nbsp;<span class="ident" id="2383887">ua</span>&nbsp;<span class="op" id="2383890">&gt;=</span>&nbsp;<span class="num" id="2383893">16</span>&nbsp;<span class="op" id="2383896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383901">i</span><span class="op" id="2383902">--</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383908">buf</span><span class="op" id="2383911">[</span><span class="ident" id="2383912">i</span><span class="op" id="2383913">]</span>&nbsp;<span class="op" id="2383915">=</span>&nbsp;<span class="ident" id="2383917">digits</span><span class="op" id="2383923">[</span><span class="ident" id="2383924">ua</span><span class="op" id="2383926">&amp;</span><span class="num" id="2383927">0xF</span><span class="op" id="2383930">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383935">ua</span>&nbsp;<span class="op" id="2383938">&gt;&gt;=</span>&nbsp;<span class="num" id="2383942">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2383946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383949">case</span>&nbsp;<span class="num" id="2383954">8</span><span class="op" id="2383955">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2383959">for</span>&nbsp;<span class="ident" id="2383963">ua</span>&nbsp;<span class="op" id="2383966">&gt;=</span>&nbsp;<span class="num" id="2383969">8</span>&nbsp;<span class="op" id="2383971">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383976">i</span><span class="op" id="2383977">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2383983">buf</span><span class="op" id="2383986">[</span><span class="ident" id="2383987">i</span><span class="op" id="2383988">]</span>&nbsp;<span class="op" id="2383990">=</span>&nbsp;<span class="builtintype" id="2383992">byte</span><span class="op" id="2383996">(</span><span class="string" id="2383997">&#39;0&#39;</span>&nbsp;<span class="op" id="2384001">+</span>&nbsp;<span class="ident" id="2384003">ua</span><span class="op" id="2384005">&amp;</span><span class="num" id="2384006">7</span><span class="op" id="2384007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384012">ua</span>&nbsp;<span class="op" id="2384015">&gt;&gt;=</span>&nbsp;<span class="num" id="2384019">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2384023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2384026">case</span>&nbsp;<span class="num" id="2384031">2</span><span class="op" id="2384032">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2384036">for</span>&nbsp;<span class="ident" id="2384040">ua</span>&nbsp;<span class="op" id="2384043">&gt;=</span>&nbsp;<span class="num" id="2384046">2</span>&nbsp;<span class="op" id="2384048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384053">i</span><span class="op" id="2384054">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384060">buf</span><span class="op" id="2384063">[</span><span class="ident" id="2384064">i</span><span class="op" id="2384065">]</span>&nbsp;<span class="op" id="2384067">=</span>&nbsp;<span class="builtintype" id="2384069">byte</span><span class="op" id="2384073">(</span><span class="string" id="2384074">&#39;0&#39;</span>&nbsp;<span class="op" id="2384078">+</span>&nbsp;<span class="ident" id="2384080">ua</span><span class="op" id="2384082">&amp;</span><span class="num" id="2384083">1</span><span class="op" id="2384084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384089">ua</span>&nbsp;<span class="op" id="2384092">&gt;&gt;=</span>&nbsp;<span class="num" id="2384096">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2384100">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2384103">default</span><span class="op" id="2384110">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2384114">panic</span><span class="op" id="2384119">(</span><span class="string" id="2384120">&#34;fmt:&nbsp;unknown&nbsp;base;&nbsp;can&#39;t&nbsp;happen&#34;</span><span class="op" id="2384153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2384156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384159">i</span><span class="op" id="2384160">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384164">buf</span><span class="op" id="2384167">[</span><span class="ident" id="2384168">i</span><span class="op" id="2384169">]</span>&nbsp;<span class="op" id="2384171">=</span>&nbsp;<span class="ident" id="2384173">digits</span><span class="op" id="2384179">[</span><span class="ident" id="2384180">ua</span><span class="op" id="2384182">]</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2384185">for</span>&nbsp;<span class="ident" id="2384189">i</span>&nbsp;<span class="op" id="2384191">&gt;</span>&nbsp;<span class="num" id="2384193">0</span>&nbsp;<span class="op" id="2384195">&amp;&amp;</span>&nbsp;<span class="ident" id="2384198">prec</span>&nbsp;<span class="op" id="2384203">&gt;</span>&nbsp;<span class="builtinfunc" id="2384205">len</span><span class="op" id="2384208">(</span><span class="ident" id="2384209">buf</span><span class="op" id="2384212">)</span><span class="op" id="2384213">-</span><span class="ident" id="2384214">i</span>&nbsp;<span class="op" id="2384216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384220">i</span><span class="op" id="2384221">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384226">buf</span><span class="op" id="2384229">[</span><span class="ident" id="2384230">i</span><span class="op" id="2384231">]</span>&nbsp;<span class="op" id="2384233">=</span>&nbsp;<span class="string" id="2384235">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2384240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2384244">//&nbsp;Various&nbsp;prefixes:&nbsp;0x,&nbsp;-,&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2384278">if</span>&nbsp;<span class="ident" id="2384281">f</span><span class="op" id="2384282">.</span><span class="ident" id="2384283">sharp</span>&nbsp;<span class="op" id="2384289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2384293">switch</span>&nbsp;<span class="ident" id="2384300">base</span>&nbsp;<span class="op" id="2384305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2384309">case</span>&nbsp;<span class="num" id="2384314">8</span><span class="op" id="2384315">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2384320">if</span>&nbsp;<span class="ident" id="2384323">buf</span><span class="op" id="2384326">[</span><span class="ident" id="2384327">i</span><span class="op" id="2384328">]</span>&nbsp;<span class="op" id="2384330">!=</span>&nbsp;<span class="string" id="2384333">&#39;0&#39;</span>&nbsp;<span class="op" id="2384337">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384343">i</span><span class="op" id="2384344">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384351">buf</span><span class="op" id="2384354">[</span><span class="ident" id="2384355">i</span><span class="op" id="2384356">]</span>&nbsp;<span class="op" id="2384358">=</span>&nbsp;<span class="string" id="2384360">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2384367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2384371">case</span>&nbsp;<span class="num" id="2384376">16</span><span class="op" id="2384378">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384383">i</span><span class="op" id="2384384">--</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384390">buf</span><span class="op" id="2384393">[</span><span class="ident" id="2384394">i</span><span class="op" id="2384395">]</span>&nbsp;<span class="op" id="2384397">=</span>&nbsp;<span class="string" id="2384399">&#39;x&#39;</span>&nbsp;<span class="op" id="2384403">+</span>&nbsp;<span class="ident" id="2384405">digits</span><span class="op" id="2384411">[</span><span class="num" id="2384412">10</span><span class="op" id="2384414">]</span>&nbsp;<span class="op" id="2384416">-</span>&nbsp;<span class="string" id="2384418">&#39;a&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384425">i</span><span class="op" id="2384426">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384432">buf</span><span class="op" id="2384435">[</span><span class="ident" id="2384436">i</span><span class="op" id="2384437">]</span>&nbsp;<span class="op" id="2384439">=</span>&nbsp;<span class="string" id="2384441">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2384447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2384450">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2384453">if</span>&nbsp;<span class="ident" id="2384456">f</span><span class="op" id="2384457">.</span><span class="ident" id="2384458">unicode</span>&nbsp;<span class="op" id="2384466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384470">i</span><span class="op" id="2384471">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384476">buf</span><span class="op" id="2384479">[</span><span class="ident" id="2384480">i</span><span class="op" id="2384481">]</span>&nbsp;<span class="op" id="2384483">=</span>&nbsp;<span class="string" id="2384485">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384491">i</span><span class="op" id="2384492">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384497">buf</span><span class="op" id="2384500">[</span><span class="ident" id="2384501">i</span><span class="op" id="2384502">]</span>&nbsp;<span class="op" id="2384504">=</span>&nbsp;<span class="string" id="2384506">&#39;U&#39;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2384511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2384515">if</span>&nbsp;<span class="ident" id="2384518">negative</span>&nbsp;<span class="op" id="2384527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384531">i</span><span class="op" id="2384532">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384537">buf</span><span class="op" id="2384540">[</span><span class="ident" id="2384541">i</span><span class="op" id="2384542">]</span>&nbsp;<span class="op" id="2384544">=</span>&nbsp;<span class="string" id="2384546">&#39;-&#39;</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2384551">}</span>&nbsp;<span class="keyword" id="2384553">else</span>&nbsp;<span class="keyword" id="2384558">if</span>&nbsp;<span class="ident" id="2384561">f</span><span class="op" id="2384562">.</span><span class="ident" id="2384563">plus</span>&nbsp;<span class="op" id="2384568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384572">i</span><span class="op" id="2384573">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384578">buf</span><span class="op" id="2384581">[</span><span class="ident" id="2384582">i</span><span class="op" id="2384583">]</span>&nbsp;<span class="op" id="2384585">=</span>&nbsp;<span class="string" id="2384587">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2384592">}</span>&nbsp;<span class="keyword" id="2384594">else</span>&nbsp;<span class="keyword" id="2384599">if</span>&nbsp;<span class="ident" id="2384602">f</span><span class="op" id="2384603">.</span><span class="ident" id="2384604">space</span>&nbsp;<span class="op" id="2384610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384614">i</span><span class="op" id="2384615">--</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384620">buf</span><span class="op" id="2384623">[</span><span class="ident" id="2384624">i</span><span class="op" id="2384625">]</span>&nbsp;<span class="op" id="2384627">=</span>&nbsp;<span class="string" id="2384629">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2384634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2384638">//&nbsp;If&nbsp;we&nbsp;want&nbsp;a&nbsp;quoted&nbsp;char&nbsp;for&nbsp;%#U,&nbsp;move&nbsp;the&nbsp;data&nbsp;up&nbsp;to&nbsp;make&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2384707">if</span>&nbsp;<span class="ident" id="2384710">f</span><span class="op" id="2384711">.</span><span class="ident" id="2384712">unicode</span>&nbsp;<span class="op" id="2384720">&amp;&amp;</span>&nbsp;<span class="ident" id="2384723">f</span><span class="op" id="2384724">.</span><span class="ident" id="2384725">uniQuote</span>&nbsp;<span class="op" id="2384734">&amp;&amp;</span>&nbsp;<span class="ident" id="2384737">a</span>&nbsp;<span class="op" id="2384739">&gt;=</span>&nbsp;<span class="num" id="2384742">0</span>&nbsp;<span class="op" id="2384744">&amp;&amp;</span>&nbsp;<span class="ident" id="2384747">a</span>&nbsp;<span class="op" id="2384749">&lt;=</span>&nbsp;<span class="ident" id="2384752">utf8</span><span class="op" id="2384756">.</span><span class="ident" id="2384757">MaxRune</span>&nbsp;<span class="op" id="2384765">&amp;&amp;</span>&nbsp;<span class="ident" id="2384768">strconv</span><span class="op" id="2384775">.</span><span class="ident" id="2384776">IsPrint</span><span class="op" id="2384783">(</span><span class="builtintype" id="2384784">rune</span><span class="op" id="2384788">(</span><span class="ident" id="2384789">a</span><span class="op" id="2384790">)</span><span class="op" id="2384791">)</span>&nbsp;<span class="op" id="2384793">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384797">runeWidth</span>&nbsp;<span class="op" id="2384807">:=</span>&nbsp;<span class="ident" id="2384810">utf8</span><span class="op" id="2384814">.</span><span class="ident" id="2384815">RuneLen</span><span class="op" id="2384822">(</span><span class="builtintype" id="2384823">rune</span><span class="op" id="2384827">(</span><span class="ident" id="2384828">a</span><span class="op" id="2384829">)</span><span class="op" id="2384830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384834">width</span>&nbsp;<span class="op" id="2384840">:=</span>&nbsp;<span class="num" id="2384843">1</span>&nbsp;<span class="op" id="2384845">+</span>&nbsp;<span class="num" id="2384847">1</span>&nbsp;<span class="op" id="2384849">+</span>&nbsp;<span class="ident" id="2384851">runeWidth</span>&nbsp;<span class="op" id="2384861">+</span>&nbsp;<span class="num" id="2384863">1</span>&nbsp;<span class="comment" id="2384865">//&nbsp;space,&nbsp;quote,&nbsp;rune,&nbsp;quote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2384896">copy</span><span class="op" id="2384900">(</span><span class="ident" id="2384901">buf</span><span class="op" id="2384904">[</span><span class="ident" id="2384905">i</span><span class="op" id="2384906">-</span><span class="ident" id="2384907">width</span><span class="op" id="2384912">:</span><span class="op" id="2384913">]</span><span class="op" id="2384914">,</span>&nbsp;<span class="ident" id="2384916">buf</span><span class="op" id="2384919">[</span><span class="ident" id="2384920">i</span><span class="op" id="2384921">:</span><span class="op" id="2384922">]</span><span class="op" id="2384923">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="2384927">//&nbsp;guaranteed&nbsp;to&nbsp;have&nbsp;enough&nbsp;room.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2384964">i</span>&nbsp;<span class="op" id="2384966">-=</span>&nbsp;<span class="ident" id="2384969">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2384977">//&nbsp;Now&nbsp;put&nbsp;&#34;&nbsp;&#39;x&#39;&#34;&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385009">j</span>&nbsp;<span class="op" id="2385011">:=</span>&nbsp;<span class="builtinfunc" id="2385014">len</span><span class="op" id="2385017">(</span><span class="ident" id="2385018">buf</span><span class="op" id="2385021">)</span>&nbsp;<span class="op" id="2385023">-</span>&nbsp;<span class="ident" id="2385025">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385033">buf</span><span class="op" id="2385036">[</span><span class="ident" id="2385037">j</span><span class="op" id="2385038">]</span>&nbsp;<span class="op" id="2385040">=</span>&nbsp;<span class="string" id="2385042">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385048">j</span><span class="op" id="2385049">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385054">buf</span><span class="op" id="2385057">[</span><span class="ident" id="2385058">j</span><span class="op" id="2385059">]</span>&nbsp;<span class="op" id="2385061">=</span>&nbsp;<span class="string" id="2385063">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385070">j</span><span class="op" id="2385071">++</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385076">utf8</span><span class="op" id="2385080">.</span><span class="ident" id="2385081">EncodeRune</span><span class="op" id="2385091">(</span><span class="ident" id="2385092">buf</span><span class="op" id="2385095">[</span><span class="ident" id="2385096">j</span><span class="op" id="2385097">:</span><span class="op" id="2385098">]</span><span class="op" id="2385099">,</span>&nbsp;<span class="builtintype" id="2385101">rune</span><span class="op" id="2385105">(</span><span class="ident" id="2385106">a</span><span class="op" id="2385107">)</span><span class="op" id="2385108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385112">j</span>&nbsp;<span class="op" id="2385114">+=</span>&nbsp;<span class="ident" id="2385117">runeWidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385129">buf</span><span class="op" id="2385132">[</span><span class="ident" id="2385133">j</span><span class="op" id="2385134">]</span>&nbsp;<span class="op" id="2385136">=</span>&nbsp;<span class="string" id="2385138">&#39;\&#39;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2385144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385148">f</span><span class="op" id="2385149">.</span><span class="ident" id="2385150">pad</span><span class="op" id="2385153">(</span><span class="ident" id="2385154">buf</span><span class="op" id="2385157">[</span><span class="ident" id="2385158">i</span><span class="op" id="2385159">:</span><span class="op" id="2385160">]</span><span class="op" id="2385161">)</span><br>
<span class="lineno"></span><span class="op" id="2385163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2385166">//&nbsp;truncate&nbsp;truncates&nbsp;the&nbsp;string&nbsp;to&nbsp;the&nbsp;specified&nbsp;precision,&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2385239">func</span>&nbsp;<span class="op" id="2385244">(</span><span class="ident" id="2385245">f</span>&nbsp;<span class="op" id="2385247">*</span><span class="ident" id="2385248">fmt</span><span class="op" id="2385251">)</span>&nbsp;<span class="ident" id="2385253">truncate</span><span class="op" id="2385261">(</span><span class="ident" id="2385262">s</span>&nbsp;<span class="builtintype" id="2385264">string</span><span class="op" id="2385270">)</span>&nbsp;<span class="builtintype" id="2385272">string</span>&nbsp;<span class="op" id="2385279">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2385282">if</span>&nbsp;<span class="ident" id="2385285">f</span><span class="op" id="2385286">.</span><span class="ident" id="2385287">precPresent</span>&nbsp;<span class="op" id="2385299">&amp;&amp;</span>&nbsp;<span class="ident" id="2385302">f</span><span class="op" id="2385303">.</span><span class="ident" id="2385304">prec</span>&nbsp;<span class="op" id="2385309">&lt;</span>&nbsp;<span class="ident" id="2385311">utf8</span><span class="op" id="2385315">.</span><span class="ident" id="2385316">RuneCountInString</span><span class="op" id="2385333">(</span><span class="ident" id="2385334">s</span><span class="op" id="2385335">)</span>&nbsp;<span class="op" id="2385337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385341">n</span>&nbsp;<span class="op" id="2385343">:=</span>&nbsp;<span class="ident" id="2385346">f</span><span class="op" id="2385347">.</span><span class="ident" id="2385348">prec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2385355">for</span>&nbsp;<span class="ident" id="2385359">i</span>&nbsp;<span class="op" id="2385361">:=</span>&nbsp;<span class="keyword" id="2385364">range</span>&nbsp;<span class="ident" id="2385370">s</span>&nbsp;<span class="op" id="2385372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2385377">if</span>&nbsp;<span class="ident" id="2385380">n</span>&nbsp;<span class="op" id="2385382">==</span>&nbsp;<span class="num" id="2385385">0</span>&nbsp;<span class="op" id="2385387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385393">s</span>&nbsp;<span class="op" id="2385395">=</span>&nbsp;<span class="ident" id="2385397">s</span><span class="op" id="2385398">[</span><span class="op" id="2385399">:</span><span class="ident" id="2385400">i</span><span class="op" id="2385401">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2385407">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2385416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385421">n</span><span class="op" id="2385422">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2385427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2385430">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2385433">return</span>&nbsp;<span class="ident" id="2385440">s</span><br>
<span class="lineno"></span><span class="op" id="2385442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2385445">//&nbsp;fmt_s&nbsp;formats&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2385472">func</span>&nbsp;<span class="op" id="2385477">(</span><span class="ident" id="2385478">f</span>&nbsp;<span class="op" id="2385480">*</span><span class="ident" id="2385481">fmt</span><span class="op" id="2385484">)</span>&nbsp;<span class="ident" id="2385486">fmt_s</span><span class="op" id="2385491">(</span><span class="ident" id="2385492">s</span>&nbsp;<span class="builtintype" id="2385494">string</span><span class="op" id="2385500">)</span>&nbsp;<span class="op" id="2385502">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385505">s</span>&nbsp;<span class="op" id="2385507">=</span>&nbsp;<span class="ident" id="2385509">f</span><span class="op" id="2385510">.</span><span class="ident" id="2385511">truncate</span><span class="op" id="2385519">(</span><span class="ident" id="2385520">s</span><span class="op" id="2385521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385524">f</span><span class="op" id="2385525">.</span><span class="ident" id="2385526">padString</span><span class="op" id="2385535">(</span><span class="ident" id="2385536">s</span><span class="op" id="2385537">)</span><br>
<span class="lineno"></span><span class="op" id="2385539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2385542">//&nbsp;fmt_sbx&nbsp;formats&nbsp;a&nbsp;string&nbsp;or&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">315</span><span class="keyword" id="2385624">func</span>&nbsp;<span class="op" id="2385629">(</span><span class="ident" id="2385630">f</span>&nbsp;<span class="op" id="2385632">*</span><span class="ident" id="2385633">fmt</span><span class="op" id="2385636">)</span>&nbsp;<span class="ident" id="2385638">fmt_sbx</span><span class="op" id="2385645">(</span><span class="ident" id="2385646">s</span>&nbsp;<span class="builtintype" id="2385648">string</span><span class="op" id="2385654">,</span>&nbsp;<span class="ident" id="2385656">b</span>&nbsp;<span class="op" id="2385658">[</span><span class="op" id="2385659">]</span><span class="builtintype" id="2385660">byte</span><span class="op" id="2385664">,</span>&nbsp;<span class="ident" id="2385666">digits</span>&nbsp;<span class="builtintype" id="2385673">string</span><span class="op" id="2385679">)</span>&nbsp;<span class="op" id="2385681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385684">n</span>&nbsp;<span class="op" id="2385686">:=</span>&nbsp;<span class="builtinfunc" id="2385689">len</span><span class="op" id="2385692">(</span><span class="ident" id="2385693">b</span><span class="op" id="2385694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2385697">if</span>&nbsp;<span class="ident" id="2385700">b</span>&nbsp;<span class="op" id="2385702">==</span>&nbsp;<span class="ident" id="2385705">nil</span>&nbsp;<span class="op" id="2385709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385713">n</span>&nbsp;<span class="op" id="2385715">=</span>&nbsp;<span class="builtinfunc" id="2385717">len</span><span class="op" id="2385720">(</span><span class="ident" id="2385721">s</span><span class="op" id="2385722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2385725">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385728">x</span>&nbsp;<span class="op" id="2385730">:=</span>&nbsp;<span class="ident" id="2385733">digits</span><span class="op" id="2385739">[</span><span class="num" id="2385740">10</span><span class="op" id="2385742">]</span>&nbsp;<span class="op" id="2385744">-</span>&nbsp;<span class="string" id="2385746">&#39;a&#39;</span>&nbsp;<span class="op" id="2385750">+</span>&nbsp;<span class="string" id="2385752">&#39;x&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2385757">//&nbsp;TODO:&nbsp;Avoid&nbsp;buffer&nbsp;by&nbsp;pre-padding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2385796">var</span>&nbsp;<span class="ident" id="2385800">buf</span>&nbsp;<span class="op" id="2385804">[</span><span class="op" id="2385805">]</span><span class="builtintype" id="2385806">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2385812">for</span>&nbsp;<span class="ident" id="2385816">i</span>&nbsp;<span class="op" id="2385818">:=</span>&nbsp;<span class="num" id="2385821">0</span><span class="op" id="2385822">;</span>&nbsp;<span class="ident" id="2385824">i</span>&nbsp;<span class="op" id="2385826">&lt;</span>&nbsp;<span class="ident" id="2385828">n</span><span class="op" id="2385829">;</span>&nbsp;<span class="ident" id="2385831">i</span><span class="op" id="2385832">++</span>&nbsp;<span class="op" id="2385835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2385839">if</span>&nbsp;<span class="ident" id="2385842">i</span>&nbsp;<span class="op" id="2385844">&gt;</span>&nbsp;<span class="num" id="2385846">0</span>&nbsp;<span class="op" id="2385848">&amp;&amp;</span>&nbsp;<span class="ident" id="2385851">f</span><span class="op" id="2385852">.</span><span class="ident" id="2385853">space</span>&nbsp;<span class="op" id="2385859">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385864">buf</span>&nbsp;<span class="op" id="2385868">=</span>&nbsp;<span class="builtinfunc" id="2385870">append</span><span class="op" id="2385876">(</span><span class="ident" id="2385877">buf</span><span class="op" id="2385880">,</span>&nbsp;<span class="string" id="2385882">&#39;&nbsp;&#39;</span><span class="op" id="2385885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2385889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2385893">if</span>&nbsp;<span class="ident" id="2385896">f</span><span class="op" id="2385897">.</span><span class="ident" id="2385898">sharp</span>&nbsp;<span class="op" id="2385904">&amp;&amp;</span>&nbsp;<span class="op" id="2385907">(</span><span class="ident" id="2385908">f</span><span class="op" id="2385909">.</span><span class="ident" id="2385910">space</span>&nbsp;<span class="op" id="2385916">||</span>&nbsp;<span class="ident" id="2385919">i</span>&nbsp;<span class="op" id="2385921">==</span>&nbsp;<span class="num" id="2385924">0</span><span class="op" id="2385925">)</span>&nbsp;<span class="op" id="2385927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385932">buf</span>&nbsp;<span class="op" id="2385936">=</span>&nbsp;<span class="builtinfunc" id="2385938">append</span><span class="op" id="2385944">(</span><span class="ident" id="2385945">buf</span><span class="op" id="2385948">,</span>&nbsp;<span class="string" id="2385950">&#39;0&#39;</span><span class="op" id="2385953">,</span>&nbsp;<span class="ident" id="2385955">x</span><span class="op" id="2385956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2385960">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2385964">var</span>&nbsp;<span class="ident" id="2385968">c</span>&nbsp;<span class="builtintype" id="2385970">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2385977">if</span>&nbsp;<span class="ident" id="2385980">b</span>&nbsp;<span class="op" id="2385982">==</span>&nbsp;<span class="ident" id="2385985">nil</span>&nbsp;<span class="op" id="2385989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2385994">c</span>&nbsp;<span class="op" id="2385996">=</span>&nbsp;<span class="ident" id="2385998">s</span><span class="op" id="2385999">[</span><span class="ident" id="2386000">i</span><span class="op" id="2386001">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2386005">}</span>&nbsp;<span class="keyword" id="2386007">else</span>&nbsp;<span class="op" id="2386012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2386017">c</span>&nbsp;<span class="op" id="2386019">=</span>&nbsp;<span class="ident" id="2386021">b</span><span class="op" id="2386022">[</span><span class="ident" id="2386023">i</span><span class="op" id="2386024">]</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2386028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2386032">buf</span>&nbsp;<span class="op" id="2386036">=</span>&nbsp;<span class="builtinfunc" id="2386038">append</span><span class="op" id="2386044">(</span><span class="ident" id="2386045">buf</span><span class="op" id="2386048">,</span>&nbsp;<span class="ident" id="2386050">digits</span><span class="op" id="2386056">[</span><span class="ident" id="2386057">c</span><span class="op" id="2386058">&gt;&gt;</span><span class="num" id="2386060">4</span><span class="op" id="2386061">]</span><span class="op" id="2386062">,</span>&nbsp;<span class="ident" id="2386064">digits</span><span class="op" id="2386070">[</span><span class="ident" id="2386071">c</span><span class="op" id="2386072">&amp;</span><span class="num" id="2386073">0xF</span><span class="op" id="2386076">]</span><span class="op" id="2386077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2386080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2386083">f</span><span class="op" id="2386084">.</span><span class="ident" id="2386085">pad</span><span class="op" id="2386088">(</span><span class="ident" id="2386089">buf</span><span class="op" id="2386092">)</span><br>
<span class="lineno"></span><span class="op" id="2386094">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="comment" id="2386097">//&nbsp;fmt_sx&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="2386164">func</span>&nbsp;<span class="op" id="2386169">(</span><span class="ident" id="2386170">f</span>&nbsp;<span class="op" id="2386172">*</span><span class="ident" id="2386173">fmt</span><span class="op" id="2386176">)</span>&nbsp;<span class="ident" id="2386178">fmt_sx</span><span class="op" id="2386184">(</span><span class="ident" id="2386185">s</span><span class="op" id="2386186">,</span>&nbsp;<span class="ident" id="2386188">digits</span>&nbsp;<span class="builtintype" id="2386195">string</span><span class="op" id="2386201">)</span>&nbsp;<span class="op" id="2386203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2386206">if</span>&nbsp;<span class="ident" id="2386209">f</span><span class="op" id="2386210">.</span><span class="ident" id="2386211">precPresent</span>&nbsp;<span class="op" id="2386223">&amp;&amp;</span>&nbsp;<span class="ident" id="2386226">f</span><span class="op" id="2386227">.</span><span class="ident" id="2386228">prec</span>&nbsp;<span class="op" id="2386233">&lt;</span>&nbsp;<span class="builtinfunc" id="2386235">len</span><span class="op" id="2386238">(</span><span class="ident" id="2386239">s</span><span class="op" id="2386240">)</span>&nbsp;<span class="op" id="2386242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2386246">s</span>&nbsp;<span class="op" id="2386248">=</span>&nbsp;<span class="ident" id="2386250">s</span><span class="op" id="2386251">[</span><span class="op" id="2386252">:</span><span class="ident" id="2386253">f</span><span class="op" id="2386254">.</span><span class="ident" id="2386255">prec</span><span class="op" id="2386259">]</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2386262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2386265">f</span><span class="op" id="2386266">.</span><span class="ident" id="2386267">fmt_sbx</span><span class="op" id="2386274">(</span><span class="ident" id="2386275">s</span><span class="op" id="2386276">,</span>&nbsp;<span class="ident" id="2386278">nil</span><span class="op" id="2386281">,</span>&nbsp;<span class="ident" id="2386283">digits</span><span class="op" id="2386289">)</span><br>
<span class="lineno"></span><span class="op" id="2386291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2386294">//&nbsp;fmt_bx&nbsp;formats&nbsp;a&nbsp;byte&nbsp;slice&nbsp;as&nbsp;a&nbsp;hexadecimal&nbsp;encoding&nbsp;of&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno">350</span><span class="keyword" id="2386365">func</span>&nbsp;<span class="op" id="2386370">(</span><span class="ident" id="2386371">f</span>&nbsp;<span class="op" id="2386373">*</span><span class="ident" id="2386374">fmt</span><span class="op" id="2386377">)</span>&nbsp;<span class="ident" id="2386379">fmt_bx</span><span class="op" id="2386385">(</span><span class="ident" id="2386386">b</span>&nbsp;<span class="op" id="2386388">[</span><span class="op" id="2386389">]</span><span class="builtintype" id="2386390">byte</span><span class="op" id="2386394">,</span>&nbsp;<span class="ident" id="2386396">digits</span>&nbsp;<span class="builtintype" id="2386403">string</span><span class="op" id="2386409">)</span>&nbsp;<span class="op" id="2386411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2386414">if</span>&nbsp;<span class="ident" id="2386417">f</span><span class="op" id="2386418">.</span><span class="ident" id="2386419">precPresent</span>&nbsp;<span class="op" id="2386431">&amp;&amp;</span>&nbsp;<span class="ident" id="2386434">f</span><span class="op" id="2386435">.</span><span class="ident" id="2386436">prec</span>&nbsp;<span class="op" id="2386441">&lt;</span>&nbsp;<span class="builtinfunc" id="2386443">len</span><span class="op" id="2386446">(</span><span class="ident" id="2386447">b</span><span class="op" id="2386448">)</span>&nbsp;<span class="op" id="2386450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2386454">b</span>&nbsp;<span class="op" id="2386456">=</span>&nbsp;<span class="ident" id="2386458">b</span><span class="op" id="2386459">[</span><span class="op" id="2386460">:</span><span class="ident" id="2386461">f</span><span class="op" id="2386462">.</span><span class="ident" id="2386463">prec</span><span class="op" id="2386467">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2386470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2386473">f</span><span class="op" id="2386474">.</span><span class="ident" id="2386475">fmt_sbx</span><span class="op" id="2386482">(</span><span class="string" id="2386483">&#34;&#34;</span><span class="op" id="2386485">,</span>&nbsp;<span class="ident" id="2386487">b</span><span class="op" id="2386488">,</span>&nbsp;<span class="ident" id="2386490">digits</span><span class="op" id="2386496">)</span><br>
<span class="lineno">355</span><span class="op" id="2386498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2386501">//&nbsp;fmt_q&nbsp;formats&nbsp;a&nbsp;string&nbsp;as&nbsp;a&nbsp;double-quoted,&nbsp;escaped&nbsp;Go&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="2386575">func</span>&nbsp;<span class="op" id="2386580">(</span><span class="ident" id="2386581">f</span>&nbsp;<span class="op" id="2386583">*</span><span class="ident" id="2386584">fmt</span><span class="op" id="2386587">)</span>&nbsp;<span class="ident" id="2386589">fmt_q</span><span class="op" id="2386594">(</span><span class="ident" id="2386595">s</span>&nbsp;<span class="builtintype" id="2386597">string</span><span class="op" id="2386603">)</span>&nbsp;<span class="op" id="2386605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2386608">s</span>&nbsp;<span class="op" id="2386610">=</span>&nbsp;<span class="ident" id="2386612">f</span><span class="op" id="2386613">.</span><span class="ident" id="2386614">truncate</span><span class="op" id="2386622">(</span><span class="ident" id="2386623">s</span><span class="op" id="2386624">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2386627">var</span>&nbsp;<span class="ident" id="2386631">quoted</span>&nbsp;<span class="builtintype" id="2386638">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2386646">if</span>&nbsp;<span class="ident" id="2386649">f</span><span class="op" id="2386650">.</span><span class="ident" id="2386651">sharp</span>&nbsp;<span class="op" id="2386657">&amp;&amp;</span>&nbsp;<span class="ident" id="2386660">strconv</span><span class="op" id="2386667">.</span><span class="ident" id="2386668">CanBackquote</span><span class="op" id="2386680">(</span><span class="ident" id="2386681">s</span><span class="op" id="2386682">)</span>&nbsp;<span class="op" id="2386684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2386688">quoted</span>&nbsp;<span class="op" id="2386695">=</span>&nbsp;<span class="string" id="2386697">&#34;`&#34;</span>&nbsp;<span class="op" id="2386701">+</span>&nbsp;<span class="ident" id="2386703">s</span>&nbsp;<span class="op" id="2386705">+</span>&nbsp;<span class="string" id="2386707">&#34;`&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2386712">}</span>&nbsp;<span class="keyword" id="2386714">else</span>&nbsp;<span class="op" id="2386719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2386723">if</span>&nbsp;<span class="ident" id="2386726">f</span><span class="op" id="2386727">.</span><span class="ident" id="2386728">plus</span>&nbsp;<span class="op" id="2386733">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2386738">quoted</span>&nbsp;<span class="op" id="2386745">=</span>&nbsp;<span class="ident" id="2386747">strconv</span><span class="op" id="2386754">.</span><span class="ident" id="2386755">QuoteToASCII</span><span class="op" id="2386767">(</span><span class="ident" id="2386768">s</span><span class="op" id="2386769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2386773">}</span>&nbsp;<span class="keyword" id="2386775">else</span>&nbsp;<span class="op" id="2386780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2386785">quoted</span>&nbsp;<span class="op" id="2386792">=</span>&nbsp;<span class="ident" id="2386794">strconv</span><span class="op" id="2386801">.</span><span class="ident" id="2386802">Quote</span><span class="op" id="2386807">(</span><span class="ident" id="2386808">s</span><span class="op" id="2386809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2386813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2386816">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2386819">f</span><span class="op" id="2386820">.</span><span class="ident" id="2386821">padString</span><span class="op" id="2386830">(</span><span class="ident" id="2386831">quoted</span><span class="op" id="2386837">)</span><br>
<span class="lineno"></span><span class="op" id="2386839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2386842">//&nbsp;fmt_qc&nbsp;formats&nbsp;the&nbsp;integer&nbsp;as&nbsp;a&nbsp;single-quoted,&nbsp;escaped&nbsp;Go&nbsp;character&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2386923">//&nbsp;If&nbsp;the&nbsp;character&nbsp;is&nbsp;not&nbsp;valid&nbsp;Unicode,&nbsp;it&nbsp;will&nbsp;print&nbsp;&#39;\ufffd&#39;.</span><br>
<span class="lineno">375</span><span class="keyword" id="2386989">func</span>&nbsp;<span class="op" id="2386994">(</span><span class="ident" id="2386995">f</span>&nbsp;<span class="op" id="2386997">*</span><span class="ident" id="2386998">fmt</span><span class="op" id="2387001">)</span>&nbsp;<span class="ident" id="2387003">fmt_qc</span><span class="op" id="2387009">(</span><span class="ident" id="2387010">c</span>&nbsp;<span class="ident" id="2387012">int64</span><span class="op" id="2387017">)</span>&nbsp;<span class="op" id="2387019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387022">var</span>&nbsp;<span class="ident" id="2387026">quoted</span>&nbsp;<span class="op" id="2387033">[</span><span class="op" id="2387034">]</span><span class="builtintype" id="2387035">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387041">if</span>&nbsp;<span class="ident" id="2387044">f</span><span class="op" id="2387045">.</span><span class="ident" id="2387046">plus</span>&nbsp;<span class="op" id="2387051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387055">quoted</span>&nbsp;<span class="op" id="2387062">=</span>&nbsp;<span class="ident" id="2387064">strconv</span><span class="op" id="2387071">.</span><span class="ident" id="2387072">AppendQuoteRuneToASCII</span><span class="op" id="2387094">(</span><span class="ident" id="2387095">f</span><span class="op" id="2387096">.</span><span class="ident" id="2387097">intbuf</span><span class="op" id="2387103">[</span><span class="num" id="2387104">0</span><span class="op" id="2387105">:</span><span class="num" id="2387106">0</span><span class="op" id="2387107">]</span><span class="op" id="2387108">,</span>&nbsp;<span class="builtintype" id="2387110">rune</span><span class="op" id="2387114">(</span><span class="ident" id="2387115">c</span><span class="op" id="2387116">)</span><span class="op" id="2387117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2387120">}</span>&nbsp;<span class="keyword" id="2387122">else</span>&nbsp;<span class="op" id="2387127">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387131">quoted</span>&nbsp;<span class="op" id="2387138">=</span>&nbsp;<span class="ident" id="2387140">strconv</span><span class="op" id="2387147">.</span><span class="ident" id="2387148">AppendQuoteRune</span><span class="op" id="2387163">(</span><span class="ident" id="2387164">f</span><span class="op" id="2387165">.</span><span class="ident" id="2387166">intbuf</span><span class="op" id="2387172">[</span><span class="num" id="2387173">0</span><span class="op" id="2387174">:</span><span class="num" id="2387175">0</span><span class="op" id="2387176">]</span><span class="op" id="2387177">,</span>&nbsp;<span class="builtintype" id="2387179">rune</span><span class="op" id="2387183">(</span><span class="ident" id="2387184">c</span><span class="op" id="2387185">)</span><span class="op" id="2387186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2387189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387192">f</span><span class="op" id="2387193">.</span><span class="ident" id="2387194">pad</span><span class="op" id="2387197">(</span><span class="ident" id="2387198">quoted</span><span class="op" id="2387204">)</span><br>
<span class="lineno"></span><span class="op" id="2387206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="2387209">//&nbsp;floating-point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2387228">func</span>&nbsp;<span class="ident" id="2387233">doPrec</span><span class="op" id="2387239">(</span><span class="ident" id="2387240">f</span>&nbsp;<span class="op" id="2387242">*</span><span class="ident" id="2387243">fmt</span><span class="op" id="2387246">,</span>&nbsp;<span class="ident" id="2387248">def</span>&nbsp;<span class="builtintype" id="2387252">int</span><span class="op" id="2387255">)</span>&nbsp;<span class="builtintype" id="2387257">int</span>&nbsp;<span class="op" id="2387261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387264">if</span>&nbsp;<span class="ident" id="2387267">f</span><span class="op" id="2387268">.</span><span class="ident" id="2387269">precPresent</span>&nbsp;<span class="op" id="2387281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387285">return</span>&nbsp;<span class="ident" id="2387292">f</span><span class="op" id="2387293">.</span><span class="ident" id="2387294">prec</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2387300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387303">return</span>&nbsp;<span class="ident" id="2387310">def</span><br>
<span class="lineno"></span><span class="op" id="2387314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2387317">//&nbsp;formatFloat&nbsp;formats&nbsp;a&nbsp;float64;&nbsp;it&nbsp;is&nbsp;an&nbsp;efficient&nbsp;equivalent&nbsp;to&nbsp;&nbsp;f.pad(strconv.FormatFloat()...).</span><br>
<span class="lineno">395</span><span class="keyword" id="2387418">func</span>&nbsp;<span class="op" id="2387423">(</span><span class="ident" id="2387424">f</span>&nbsp;<span class="op" id="2387426">*</span><span class="ident" id="2387427">fmt</span><span class="op" id="2387430">)</span>&nbsp;<span class="ident" id="2387432">formatFloat</span><span class="op" id="2387443">(</span><span class="ident" id="2387444">v</span>&nbsp;<span class="builtintype" id="2387446">float64</span><span class="op" id="2387453">,</span>&nbsp;<span class="ident" id="2387455">verb</span>&nbsp;<span class="builtintype" id="2387460">byte</span><span class="op" id="2387464">,</span>&nbsp;<span class="ident" id="2387466">prec</span><span class="op" id="2387470">,</span>&nbsp;<span class="ident" id="2387472">n</span>&nbsp;<span class="builtintype" id="2387474">int</span><span class="op" id="2387477">)</span>&nbsp;<span class="op" id="2387479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2387482">//&nbsp;Format&nbsp;number,&nbsp;reserving&nbsp;space&nbsp;for&nbsp;leading&nbsp;+&nbsp;sign&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387547">num</span>&nbsp;<span class="op" id="2387551">:=</span>&nbsp;<span class="ident" id="2387554">strconv</span><span class="op" id="2387561">.</span><span class="ident" id="2387562">AppendFloat</span><span class="op" id="2387573">(</span><span class="ident" id="2387574">f</span><span class="op" id="2387575">.</span><span class="ident" id="2387576">intbuf</span><span class="op" id="2387582">[</span><span class="num" id="2387583">0</span><span class="op" id="2387584">:</span><span class="num" id="2387585">1</span><span class="op" id="2387586">]</span><span class="op" id="2387587">,</span>&nbsp;<span class="ident" id="2387589">v</span><span class="op" id="2387590">,</span>&nbsp;<span class="ident" id="2387592">verb</span><span class="op" id="2387596">,</span>&nbsp;<span class="ident" id="2387598">prec</span><span class="op" id="2387602">,</span>&nbsp;<span class="ident" id="2387604">n</span><span class="op" id="2387605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387608">if</span>&nbsp;<span class="ident" id="2387611">num</span><span class="op" id="2387614">[</span><span class="num" id="2387615">1</span><span class="op" id="2387616">]</span>&nbsp;<span class="op" id="2387618">==</span>&nbsp;<span class="string" id="2387621">&#39;-&#39;</span>&nbsp;<span class="op" id="2387625">||</span>&nbsp;<span class="ident" id="2387628">num</span><span class="op" id="2387631">[</span><span class="num" id="2387632">1</span><span class="op" id="2387633">]</span>&nbsp;<span class="op" id="2387635">==</span>&nbsp;<span class="string" id="2387638">&#39;+&#39;</span>&nbsp;<span class="op" id="2387642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387646">num</span>&nbsp;<span class="op" id="2387650">=</span>&nbsp;<span class="ident" id="2387652">num</span><span class="op" id="2387655">[</span><span class="num" id="2387656">1</span><span class="op" id="2387657">:</span><span class="op" id="2387658">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2387661">}</span>&nbsp;<span class="keyword" id="2387663">else</span>&nbsp;<span class="op" id="2387668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387672">num</span><span class="op" id="2387675">[</span><span class="num" id="2387676">0</span><span class="op" id="2387677">]</span>&nbsp;<span class="op" id="2387679">=</span>&nbsp;<span class="string" id="2387681">&#39;+&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2387686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2387689">//&nbsp;Special&nbsp;handling&nbsp;for&nbsp;infinity,&nbsp;which&nbsp;doesn&#39;t&nbsp;look&nbsp;like&nbsp;a&nbsp;number&nbsp;so&nbsp;shouldn&#39;t&nbsp;be&nbsp;padded&nbsp;with&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387792">if</span>&nbsp;<span class="ident" id="2387795">math</span><span class="op" id="2387799">.</span><span class="ident" id="2387800">IsInf</span><span class="op" id="2387805">(</span><span class="ident" id="2387806">v</span><span class="op" id="2387807">,</span>&nbsp;<span class="num" id="2387809">0</span><span class="op" id="2387810">)</span>&nbsp;<span class="op" id="2387812">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387816">if</span>&nbsp;<span class="ident" id="2387819">f</span><span class="op" id="2387820">.</span><span class="ident" id="2387821">zero</span>&nbsp;<span class="op" id="2387826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2387831">defer</span>&nbsp;<span class="keyword" id="2387837">func</span><span class="op" id="2387841">(</span><span class="op" id="2387842">)</span>&nbsp;<span class="op" id="2387844">{</span>&nbsp;<span class="ident" id="2387846">f</span><span class="op" id="2387847">.</span><span class="ident" id="2387848">zero</span>&nbsp;<span class="op" id="2387853">=</span>&nbsp;<span class="builtintype" id="2387855">true</span>&nbsp;<span class="op" id="2387860">}</span><span class="op" id="2387861">(</span><span class="op" id="2387862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2387867">f</span><span class="op" id="2387868">.</span><span class="ident" id="2387869">zero</span>&nbsp;<span class="op" id="2387874">=</span>&nbsp;<span class="builtintype" id="2387876">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2387884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2387887">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2387890">//&nbsp;num&nbsp;is&nbsp;now&nbsp;a&nbsp;signed&nbsp;version&nbsp;of&nbsp;the&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2387937">//&nbsp;If&nbsp;we&#39;re&nbsp;zero&nbsp;padding,&nbsp;want&nbsp;the&nbsp;sign&nbsp;before&nbsp;the&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2388004">//&nbsp;Achieve&nbsp;this&nbsp;by&nbsp;writing&nbsp;the&nbsp;sign&nbsp;out&nbsp;and&nbsp;then&nbsp;padding&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388083">if</span>&nbsp;<span class="ident" id="2388086">f</span><span class="op" id="2388087">.</span><span class="ident" id="2388088">zero</span>&nbsp;<span class="op" id="2388093">&amp;&amp;</span>&nbsp;<span class="ident" id="2388096">f</span><span class="op" id="2388097">.</span><span class="ident" id="2388098">widPresent</span>&nbsp;<span class="op" id="2388109">&amp;&amp;</span>&nbsp;<span class="ident" id="2388112">f</span><span class="op" id="2388113">.</span><span class="ident" id="2388114">wid</span>&nbsp;<span class="op" id="2388118">&gt;</span>&nbsp;<span class="builtinfunc" id="2388120">len</span><span class="op" id="2388123">(</span><span class="ident" id="2388124">num</span><span class="op" id="2388127">)</span>&nbsp;<span class="op" id="2388129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388133">if</span>&nbsp;<span class="ident" id="2388136">f</span><span class="op" id="2388137">.</span><span class="ident" id="2388138">space</span>&nbsp;<span class="op" id="2388144">&amp;&amp;</span>&nbsp;<span class="ident" id="2388147">v</span>&nbsp;<span class="op" id="2388149">&gt;=</span>&nbsp;<span class="num" id="2388152">0</span>&nbsp;<span class="op" id="2388154">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388159">f</span><span class="op" id="2388160">.</span><span class="ident" id="2388161">buf</span><span class="op" id="2388164">.</span><span class="ident" id="2388165">WriteByte</span><span class="op" id="2388174">(</span><span class="string" id="2388175">&#39;&nbsp;&#39;</span><span class="op" id="2388178">)</span>&nbsp;<span class="comment" id="2388180">//&nbsp;This&nbsp;is&nbsp;what&nbsp;C&nbsp;does:&nbsp;even&nbsp;with&nbsp;zero,&nbsp;f.space&nbsp;means&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388244">f</span><span class="op" id="2388245">.</span><span class="ident" id="2388246">wid</span><span class="op" id="2388249">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2388254">}</span>&nbsp;<span class="keyword" id="2388256">else</span>&nbsp;<span class="keyword" id="2388261">if</span>&nbsp;<span class="ident" id="2388264">f</span><span class="op" id="2388265">.</span><span class="ident" id="2388266">plus</span>&nbsp;<span class="op" id="2388271">||</span>&nbsp;<span class="ident" id="2388274">v</span>&nbsp;<span class="op" id="2388276">&lt;</span>&nbsp;<span class="num" id="2388278">0</span>&nbsp;<span class="op" id="2388280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388285">f</span><span class="op" id="2388286">.</span><span class="ident" id="2388287">buf</span><span class="op" id="2388290">.</span><span class="ident" id="2388291">WriteByte</span><span class="op" id="2388300">(</span><span class="ident" id="2388301">num</span><span class="op" id="2388304">[</span><span class="num" id="2388305">0</span><span class="op" id="2388306">]</span><span class="op" id="2388307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388312">f</span><span class="op" id="2388313">.</span><span class="ident" id="2388314">wid</span><span class="op" id="2388317">--</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2388322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388326">f</span><span class="op" id="2388327">.</span><span class="ident" id="2388328">pad</span><span class="op" id="2388331">(</span><span class="ident" id="2388332">num</span><span class="op" id="2388335">[</span><span class="num" id="2388336">1</span><span class="op" id="2388337">:</span><span class="op" id="2388338">]</span><span class="op" id="2388339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388343">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2388351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2388354">//&nbsp;f.space&nbsp;says&nbsp;to&nbsp;replace&nbsp;a&nbsp;leading&nbsp;+&nbsp;with&nbsp;a&nbsp;space.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388408">if</span>&nbsp;<span class="ident" id="2388411">f</span><span class="op" id="2388412">.</span><span class="ident" id="2388413">space</span>&nbsp;<span class="op" id="2388419">&amp;&amp;</span>&nbsp;<span class="ident" id="2388422">num</span><span class="op" id="2388425">[</span><span class="num" id="2388426">0</span><span class="op" id="2388427">]</span>&nbsp;<span class="op" id="2388429">==</span>&nbsp;<span class="string" id="2388432">&#39;+&#39;</span>&nbsp;<span class="op" id="2388436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388440">num</span><span class="op" id="2388443">[</span><span class="num" id="2388444">0</span><span class="op" id="2388445">]</span>&nbsp;<span class="op" id="2388447">=</span>&nbsp;<span class="string" id="2388449">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388455">f</span><span class="op" id="2388456">.</span><span class="ident" id="2388457">pad</span><span class="op" id="2388460">(</span><span class="ident" id="2388461">num</span><span class="op" id="2388464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388468">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2388476">}</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2388479">//&nbsp;Now&nbsp;we&nbsp;know&nbsp;the&nbsp;sign&nbsp;is&nbsp;attached&nbsp;directly&nbsp;to&nbsp;the&nbsp;number,&nbsp;if&nbsp;present&nbsp;at&nbsp;all.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2388559">//&nbsp;We&nbsp;want&nbsp;a&nbsp;sign&nbsp;if&nbsp;asked&nbsp;for,&nbsp;if&nbsp;it&#39;s&nbsp;negative,&nbsp;or&nbsp;if&nbsp;it&#39;s&nbsp;infinity&nbsp;(+Inf&nbsp;vs.&nbsp;-Inf).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388647">if</span>&nbsp;<span class="ident" id="2388650">f</span><span class="op" id="2388651">.</span><span class="ident" id="2388652">plus</span>&nbsp;<span class="op" id="2388657">||</span>&nbsp;<span class="ident" id="2388660">num</span><span class="op" id="2388663">[</span><span class="num" id="2388664">0</span><span class="op" id="2388665">]</span>&nbsp;<span class="op" id="2388667">==</span>&nbsp;<span class="string" id="2388670">&#39;-&#39;</span>&nbsp;<span class="op" id="2388674">||</span>&nbsp;<span class="ident" id="2388677">math</span><span class="op" id="2388681">.</span><span class="ident" id="2388682">IsInf</span><span class="op" id="2388687">(</span><span class="ident" id="2388688">v</span><span class="op" id="2388689">,</span>&nbsp;<span class="num" id="2388691">0</span><span class="op" id="2388692">)</span>&nbsp;<span class="op" id="2388694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388698">f</span><span class="op" id="2388699">.</span><span class="ident" id="2388700">pad</span><span class="op" id="2388703">(</span><span class="ident" id="2388704">num</span><span class="op" id="2388707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2388711">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2388719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2388722">//&nbsp;No&nbsp;sign&nbsp;to&nbsp;show&nbsp;and&nbsp;the&nbsp;number&nbsp;is&nbsp;positive;&nbsp;just&nbsp;print&nbsp;the&nbsp;unsigned&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2388802">f</span><span class="op" id="2388803">.</span><span class="ident" id="2388804">pad</span><span class="op" id="2388807">(</span><span class="ident" id="2388808">num</span><span class="op" id="2388811">[</span><span class="num" id="2388812">1</span><span class="op" id="2388813">:</span><span class="op" id="2388814">]</span><span class="op" id="2388815">)</span><br>
<span class="lineno"></span><span class="op" id="2388817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="2388820">//&nbsp;fmt_e64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2388872">func</span>&nbsp;<span class="op" id="2388877">(</span><span class="ident" id="2388878">f</span>&nbsp;<span class="op" id="2388880">*</span><span class="ident" id="2388881">fmt</span><span class="op" id="2388884">)</span>&nbsp;<span class="ident" id="2388886">fmt_e64</span><span class="op" id="2388893">(</span><span class="ident" id="2388894">v</span>&nbsp;<span class="builtintype" id="2388896">float64</span><span class="op" id="2388903">)</span>&nbsp;<span class="op" id="2388905">{</span>&nbsp;<span class="ident" id="2388907">f</span><span class="op" id="2388908">.</span><span class="ident" id="2388909">formatFloat</span><span class="op" id="2388920">(</span><span class="ident" id="2388921">v</span><span class="op" id="2388922">,</span>&nbsp;<span class="string" id="2388924">&#39;e&#39;</span><span class="op" id="2388927">,</span>&nbsp;<span class="ident" id="2388929">doPrec</span><span class="op" id="2388935">(</span><span class="ident" id="2388936">f</span><span class="op" id="2388937">,</span>&nbsp;<span class="num" id="2388939">6</span><span class="op" id="2388940">)</span><span class="op" id="2388941">,</span>&nbsp;<span class="num" id="2388943">64</span><span class="op" id="2388945">)</span>&nbsp;<span class="op" id="2388947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2388950">//&nbsp;fmt_E64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2389002">func</span>&nbsp;<span class="op" id="2389007">(</span><span class="ident" id="2389008">f</span>&nbsp;<span class="op" id="2389010">*</span><span class="ident" id="2389011">fmt</span><span class="op" id="2389014">)</span>&nbsp;<span class="ident" id="2389016">fmt_E64</span><span class="op" id="2389023">(</span><span class="ident" id="2389024">v</span>&nbsp;<span class="builtintype" id="2389026">float64</span><span class="op" id="2389033">)</span>&nbsp;<span class="op" id="2389035">{</span>&nbsp;<span class="ident" id="2389037">f</span><span class="op" id="2389038">.</span><span class="ident" id="2389039">formatFloat</span><span class="op" id="2389050">(</span><span class="ident" id="2389051">v</span><span class="op" id="2389052">,</span>&nbsp;<span class="string" id="2389054">&#39;E&#39;</span><span class="op" id="2389057">,</span>&nbsp;<span class="ident" id="2389059">doPrec</span><span class="op" id="2389065">(</span><span class="ident" id="2389066">f</span><span class="op" id="2389067">,</span>&nbsp;<span class="num" id="2389069">6</span><span class="op" id="2389070">)</span><span class="op" id="2389071">,</span>&nbsp;<span class="num" id="2389073">64</span><span class="op" id="2389075">)</span>&nbsp;<span class="op" id="2389077">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="comment" id="2389080">//&nbsp;fmt_f64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2389128">func</span>&nbsp;<span class="op" id="2389133">(</span><span class="ident" id="2389134">f</span>&nbsp;<span class="op" id="2389136">*</span><span class="ident" id="2389137">fmt</span><span class="op" id="2389140">)</span>&nbsp;<span class="ident" id="2389142">fmt_f64</span><span class="op" id="2389149">(</span><span class="ident" id="2389150">v</span>&nbsp;<span class="builtintype" id="2389152">float64</span><span class="op" id="2389159">)</span>&nbsp;<span class="op" id="2389161">{</span>&nbsp;<span class="ident" id="2389163">f</span><span class="op" id="2389164">.</span><span class="ident" id="2389165">formatFloat</span><span class="op" id="2389176">(</span><span class="ident" id="2389177">v</span><span class="op" id="2389178">,</span>&nbsp;<span class="string" id="2389180">&#39;f&#39;</span><span class="op" id="2389183">,</span>&nbsp;<span class="ident" id="2389185">doPrec</span><span class="op" id="2389191">(</span><span class="ident" id="2389192">f</span><span class="op" id="2389193">,</span>&nbsp;<span class="num" id="2389195">6</span><span class="op" id="2389196">)</span><span class="op" id="2389197">,</span>&nbsp;<span class="num" id="2389199">64</span><span class="op" id="2389201">)</span>&nbsp;<span class="op" id="2389203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2389206">//&nbsp;fmt_g64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">450</span><span class="keyword" id="2389277">func</span>&nbsp;<span class="op" id="2389282">(</span><span class="ident" id="2389283">f</span>&nbsp;<span class="op" id="2389285">*</span><span class="ident" id="2389286">fmt</span><span class="op" id="2389289">)</span>&nbsp;<span class="ident" id="2389291">fmt_g64</span><span class="op" id="2389298">(</span><span class="ident" id="2389299">v</span>&nbsp;<span class="builtintype" id="2389301">float64</span><span class="op" id="2389308">)</span>&nbsp;<span class="op" id="2389310">{</span>&nbsp;<span class="ident" id="2389312">f</span><span class="op" id="2389313">.</span><span class="ident" id="2389314">formatFloat</span><span class="op" id="2389325">(</span><span class="ident" id="2389326">v</span><span class="op" id="2389327">,</span>&nbsp;<span class="string" id="2389329">&#39;g&#39;</span><span class="op" id="2389332">,</span>&nbsp;<span class="ident" id="2389334">doPrec</span><span class="op" id="2389340">(</span><span class="ident" id="2389341">f</span><span class="op" id="2389342">,</span>&nbsp;<span class="op" id="2389344">-</span><span class="num" id="2389345">1</span><span class="op" id="2389346">)</span><span class="op" id="2389347">,</span>&nbsp;<span class="num" id="2389349">64</span><span class="op" id="2389351">)</span>&nbsp;<span class="op" id="2389353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2389356">//&nbsp;fmt_G64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2389427">func</span>&nbsp;<span class="op" id="2389432">(</span><span class="ident" id="2389433">f</span>&nbsp;<span class="op" id="2389435">*</span><span class="ident" id="2389436">fmt</span><span class="op" id="2389439">)</span>&nbsp;<span class="ident" id="2389441">fmt_G64</span><span class="op" id="2389448">(</span><span class="ident" id="2389449">v</span>&nbsp;<span class="builtintype" id="2389451">float64</span><span class="op" id="2389458">)</span>&nbsp;<span class="op" id="2389460">{</span>&nbsp;<span class="ident" id="2389462">f</span><span class="op" id="2389463">.</span><span class="ident" id="2389464">formatFloat</span><span class="op" id="2389475">(</span><span class="ident" id="2389476">v</span><span class="op" id="2389477">,</span>&nbsp;<span class="string" id="2389479">&#39;G&#39;</span><span class="op" id="2389482">,</span>&nbsp;<span class="ident" id="2389484">doPrec</span><span class="op" id="2389490">(</span><span class="ident" id="2389491">f</span><span class="op" id="2389492">,</span>&nbsp;<span class="op" id="2389494">-</span><span class="num" id="2389495">1</span><span class="op" id="2389496">)</span><span class="op" id="2389497">,</span>&nbsp;<span class="num" id="2389499">64</span><span class="op" id="2389501">)</span>&nbsp;<span class="op" id="2389503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="comment" id="2389506">//&nbsp;fmt_fb64&nbsp;formats&nbsp;a&nbsp;float64&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2389581">func</span>&nbsp;<span class="op" id="2389586">(</span><span class="ident" id="2389587">f</span>&nbsp;<span class="op" id="2389589">*</span><span class="ident" id="2389590">fmt</span><span class="op" id="2389593">)</span>&nbsp;<span class="ident" id="2389595">fmt_fb64</span><span class="op" id="2389603">(</span><span class="ident" id="2389604">v</span>&nbsp;<span class="builtintype" id="2389606">float64</span><span class="op" id="2389613">)</span>&nbsp;<span class="op" id="2389615">{</span>&nbsp;<span class="ident" id="2389617">f</span><span class="op" id="2389618">.</span><span class="ident" id="2389619">formatFloat</span><span class="op" id="2389630">(</span><span class="ident" id="2389631">v</span><span class="op" id="2389632">,</span>&nbsp;<span class="string" id="2389634">&#39;b&#39;</span><span class="op" id="2389637">,</span>&nbsp;<span class="num" id="2389639">0</span><span class="op" id="2389640">,</span>&nbsp;<span class="num" id="2389642">64</span><span class="op" id="2389644">)</span>&nbsp;<span class="op" id="2389646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2389649">//&nbsp;float32</span><br>
<span class="lineno"></span><span class="comment" id="2389660">//&nbsp;cannot&nbsp;defer&nbsp;to&nbsp;float64&nbsp;versions</span><br>
<span class="lineno">460</span><span class="comment" id="2389696">//&nbsp;because&nbsp;it&nbsp;will&nbsp;get&nbsp;rounding&nbsp;wrong&nbsp;in&nbsp;corner&nbsp;cases.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2389752">//&nbsp;fmt_e32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23e+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2389804">func</span>&nbsp;<span class="op" id="2389809">(</span><span class="ident" id="2389810">f</span>&nbsp;<span class="op" id="2389812">*</span><span class="ident" id="2389813">fmt</span><span class="op" id="2389816">)</span>&nbsp;<span class="ident" id="2389818">fmt_e32</span><span class="op" id="2389825">(</span><span class="ident" id="2389826">v</span>&nbsp;<span class="builtintype" id="2389828">float32</span><span class="op" id="2389835">)</span>&nbsp;<span class="op" id="2389837">{</span>&nbsp;<span class="ident" id="2389839">f</span><span class="op" id="2389840">.</span><span class="ident" id="2389841">formatFloat</span><span class="op" id="2389852">(</span><span class="builtintype" id="2389853">float64</span><span class="op" id="2389860">(</span><span class="ident" id="2389861">v</span><span class="op" id="2389862">)</span><span class="op" id="2389863">,</span>&nbsp;<span class="string" id="2389865">&#39;e&#39;</span><span class="op" id="2389868">,</span>&nbsp;<span class="ident" id="2389870">doPrec</span><span class="op" id="2389876">(</span><span class="ident" id="2389877">f</span><span class="op" id="2389878">,</span>&nbsp;<span class="num" id="2389880">6</span><span class="op" id="2389881">)</span><span class="op" id="2389882">,</span>&nbsp;<span class="num" id="2389884">32</span><span class="op" id="2389886">)</span>&nbsp;<span class="op" id="2389888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="2389891">//&nbsp;fmt_E32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23E+12.</span><br>
<span class="lineno"></span><span class="keyword" id="2389943">func</span>&nbsp;<span class="op" id="2389948">(</span><span class="ident" id="2389949">f</span>&nbsp;<span class="op" id="2389951">*</span><span class="ident" id="2389952">fmt</span><span class="op" id="2389955">)</span>&nbsp;<span class="ident" id="2389957">fmt_E32</span><span class="op" id="2389964">(</span><span class="ident" id="2389965">v</span>&nbsp;<span class="builtintype" id="2389967">float32</span><span class="op" id="2389974">)</span>&nbsp;<span class="op" id="2389976">{</span>&nbsp;<span class="ident" id="2389978">f</span><span class="op" id="2389979">.</span><span class="ident" id="2389980">formatFloat</span><span class="op" id="2389991">(</span><span class="builtintype" id="2389992">float64</span><span class="op" id="2389999">(</span><span class="ident" id="2390000">v</span><span class="op" id="2390001">)</span><span class="op" id="2390002">,</span>&nbsp;<span class="string" id="2390004">&#39;E&#39;</span><span class="op" id="2390007">,</span>&nbsp;<span class="ident" id="2390009">doPrec</span><span class="op" id="2390015">(</span><span class="ident" id="2390016">f</span><span class="op" id="2390017">,</span>&nbsp;<span class="num" id="2390019">6</span><span class="op" id="2390020">)</span><span class="op" id="2390021">,</span>&nbsp;<span class="num" id="2390023">32</span><span class="op" id="2390025">)</span>&nbsp;<span class="op" id="2390027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2390030">//&nbsp;fmt_f32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-1.23.</span><br>
<span class="lineno"></span><span class="keyword" id="2390078">func</span>&nbsp;<span class="op" id="2390083">(</span><span class="ident" id="2390084">f</span>&nbsp;<span class="op" id="2390086">*</span><span class="ident" id="2390087">fmt</span><span class="op" id="2390090">)</span>&nbsp;<span class="ident" id="2390092">fmt_f32</span><span class="op" id="2390099">(</span><span class="ident" id="2390100">v</span>&nbsp;<span class="builtintype" id="2390102">float32</span><span class="op" id="2390109">)</span>&nbsp;<span class="op" id="2390111">{</span>&nbsp;<span class="ident" id="2390113">f</span><span class="op" id="2390114">.</span><span class="ident" id="2390115">formatFloat</span><span class="op" id="2390126">(</span><span class="builtintype" id="2390127">float64</span><span class="op" id="2390134">(</span><span class="ident" id="2390135">v</span><span class="op" id="2390136">)</span><span class="op" id="2390137">,</span>&nbsp;<span class="string" id="2390139">&#39;f&#39;</span><span class="op" id="2390142">,</span>&nbsp;<span class="ident" id="2390144">doPrec</span><span class="op" id="2390150">(</span><span class="ident" id="2390151">f</span><span class="op" id="2390152">,</span>&nbsp;<span class="num" id="2390154">6</span><span class="op" id="2390155">)</span><span class="op" id="2390156">,</span>&nbsp;<span class="num" id="2390158">32</span><span class="op" id="2390160">)</span>&nbsp;<span class="op" id="2390162">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="comment" id="2390165">//&nbsp;fmt_g32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;e&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="2390236">func</span>&nbsp;<span class="op" id="2390241">(</span><span class="ident" id="2390242">f</span>&nbsp;<span class="op" id="2390244">*</span><span class="ident" id="2390245">fmt</span><span class="op" id="2390248">)</span>&nbsp;<span class="ident" id="2390250">fmt_g32</span><span class="op" id="2390257">(</span><span class="ident" id="2390258">v</span>&nbsp;<span class="builtintype" id="2390260">float32</span><span class="op" id="2390267">)</span>&nbsp;<span class="op" id="2390269">{</span>&nbsp;<span class="ident" id="2390271">f</span><span class="op" id="2390272">.</span><span class="ident" id="2390273">formatFloat</span><span class="op" id="2390284">(</span><span class="builtintype" id="2390285">float64</span><span class="op" id="2390292">(</span><span class="ident" id="2390293">v</span><span class="op" id="2390294">)</span><span class="op" id="2390295">,</span>&nbsp;<span class="string" id="2390297">&#39;g&#39;</span><span class="op" id="2390300">,</span>&nbsp;<span class="ident" id="2390302">doPrec</span><span class="op" id="2390308">(</span><span class="ident" id="2390309">f</span><span class="op" id="2390310">,</span>&nbsp;<span class="op" id="2390312">-</span><span class="num" id="2390313">1</span><span class="op" id="2390314">)</span><span class="op" id="2390315">,</span>&nbsp;<span class="num" id="2390317">32</span><span class="op" id="2390319">)</span>&nbsp;<span class="op" id="2390321">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2390324">//&nbsp;fmt_G32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;&#39;f&#39;&nbsp;or&nbsp;&#39;E&#39;&nbsp;form&nbsp;according&nbsp;to&nbsp;size.</span><br>
<span class="lineno">475</span><span class="keyword" id="2390395">func</span>&nbsp;<span class="op" id="2390400">(</span><span class="ident" id="2390401">f</span>&nbsp;<span class="op" id="2390403">*</span><span class="ident" id="2390404">fmt</span><span class="op" id="2390407">)</span>&nbsp;<span class="ident" id="2390409">fmt_G32</span><span class="op" id="2390416">(</span><span class="ident" id="2390417">v</span>&nbsp;<span class="builtintype" id="2390419">float32</span><span class="op" id="2390426">)</span>&nbsp;<span class="op" id="2390428">{</span>&nbsp;<span class="ident" id="2390430">f</span><span class="op" id="2390431">.</span><span class="ident" id="2390432">formatFloat</span><span class="op" id="2390443">(</span><span class="builtintype" id="2390444">float64</span><span class="op" id="2390451">(</span><span class="ident" id="2390452">v</span><span class="op" id="2390453">)</span><span class="op" id="2390454">,</span>&nbsp;<span class="string" id="2390456">&#39;G&#39;</span><span class="op" id="2390459">,</span>&nbsp;<span class="ident" id="2390461">doPrec</span><span class="op" id="2390467">(</span><span class="ident" id="2390468">f</span><span class="op" id="2390469">,</span>&nbsp;<span class="op" id="2390471">-</span><span class="num" id="2390472">1</span><span class="op" id="2390473">)</span><span class="op" id="2390474">,</span>&nbsp;<span class="num" id="2390476">32</span><span class="op" id="2390478">)</span>&nbsp;<span class="op" id="2390480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2390483">//&nbsp;fmt_fb32&nbsp;formats&nbsp;a&nbsp;float32&nbsp;in&nbsp;the&nbsp;form&nbsp;-123p3&nbsp;(exponent&nbsp;is&nbsp;power&nbsp;of&nbsp;2).</span><br>
<span class="lineno"></span><span class="keyword" id="2390558">func</span>&nbsp;<span class="op" id="2390563">(</span><span class="ident" id="2390564">f</span>&nbsp;<span class="op" id="2390566">*</span><span class="ident" id="2390567">fmt</span><span class="op" id="2390570">)</span>&nbsp;<span class="ident" id="2390572">fmt_fb32</span><span class="op" id="2390580">(</span><span class="ident" id="2390581">v</span>&nbsp;<span class="builtintype" id="2390583">float32</span><span class="op" id="2390590">)</span>&nbsp;<span class="op" id="2390592">{</span>&nbsp;<span class="ident" id="2390594">f</span><span class="op" id="2390595">.</span><span class="ident" id="2390596">formatFloat</span><span class="op" id="2390607">(</span><span class="builtintype" id="2390608">float64</span><span class="op" id="2390615">(</span><span class="ident" id="2390616">v</span><span class="op" id="2390617">)</span><span class="op" id="2390618">,</span>&nbsp;<span class="string" id="2390620">&#39;b&#39;</span><span class="op" id="2390623">,</span>&nbsp;<span class="num" id="2390625">0</span><span class="op" id="2390626">,</span>&nbsp;<span class="num" id="2390628">32</span><span class="op" id="2390630">)</span>&nbsp;<span class="op" id="2390632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="comment" id="2390635">//&nbsp;fmt_c64&nbsp;formats&nbsp;a&nbsp;complex64&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2390689">func</span>&nbsp;<span class="op" id="2390694">(</span><span class="ident" id="2390695">f</span>&nbsp;<span class="op" id="2390697">*</span><span class="ident" id="2390698">fmt</span><span class="op" id="2390701">)</span>&nbsp;<span class="ident" id="2390703">fmt_c64</span><span class="op" id="2390710">(</span><span class="ident" id="2390711">v</span>&nbsp;<span class="builtintype" id="2390713">complex64</span><span class="op" id="2390722">,</span>&nbsp;<span class="ident" id="2390724">verb</span>&nbsp;<span class="builtintype" id="2390729">rune</span><span class="op" id="2390733">)</span>&nbsp;<span class="op" id="2390735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2390738">f</span><span class="op" id="2390739">.</span><span class="ident" id="2390740">fmt_complex</span><span class="op" id="2390751">(</span><span class="builtintype" id="2390752">float64</span><span class="op" id="2390759">(</span><span class="builtinfunc" id="2390760">real</span><span class="op" id="2390764">(</span><span class="ident" id="2390765">v</span><span class="op" id="2390766">)</span><span class="op" id="2390767">)</span><span class="op" id="2390768">,</span>&nbsp;<span class="builtintype" id="2390770">float64</span><span class="op" id="2390777">(</span><span class="builtinfunc" id="2390778">imag</span><span class="op" id="2390782">(</span><span class="ident" id="2390783">v</span><span class="op" id="2390784">)</span><span class="op" id="2390785">)</span><span class="op" id="2390786">,</span>&nbsp;<span class="num" id="2390788">32</span><span class="op" id="2390790">,</span>&nbsp;<span class="ident" id="2390792">verb</span><span class="op" id="2390796">)</span><br>
<span class="lineno"></span><span class="op" id="2390798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="2390801">//&nbsp;fmt_c128&nbsp;formats&nbsp;a&nbsp;complex128&nbsp;according&nbsp;to&nbsp;the&nbsp;verb.</span><br>
<span class="lineno"></span><span class="keyword" id="2390857">func</span>&nbsp;<span class="op" id="2390862">(</span><span class="ident" id="2390863">f</span>&nbsp;<span class="op" id="2390865">*</span><span class="ident" id="2390866">fmt</span><span class="op" id="2390869">)</span>&nbsp;<span class="ident" id="2390871">fmt_c128</span><span class="op" id="2390879">(</span><span class="ident" id="2390880">v</span>&nbsp;<span class="builtintype" id="2390882">complex128</span><span class="op" id="2390892">,</span>&nbsp;<span class="ident" id="2390894">verb</span>&nbsp;<span class="builtintype" id="2390899">rune</span><span class="op" id="2390903">)</span>&nbsp;<span class="op" id="2390905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2390908">f</span><span class="op" id="2390909">.</span><span class="ident" id="2390910">fmt_complex</span><span class="op" id="2390921">(</span><span class="builtinfunc" id="2390922">real</span><span class="op" id="2390926">(</span><span class="ident" id="2390927">v</span><span class="op" id="2390928">)</span><span class="op" id="2390929">,</span>&nbsp;<span class="builtinfunc" id="2390931">imag</span><span class="op" id="2390935">(</span><span class="ident" id="2390936">v</span><span class="op" id="2390937">)</span><span class="op" id="2390938">,</span>&nbsp;<span class="num" id="2390940">64</span><span class="op" id="2390942">,</span>&nbsp;<span class="ident" id="2390944">verb</span><span class="op" id="2390948">)</span><br>
<span class="lineno"></span><span class="op" id="2390950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span><span class="comment" id="2390953">//&nbsp;fmt_complex&nbsp;formats&nbsp;a&nbsp;complex&nbsp;number&nbsp;as&nbsp;(r+ji).</span><br>
<span class="lineno"></span><span class="keyword" id="2391004">func</span>&nbsp;<span class="op" id="2391009">(</span><span class="ident" id="2391010">f</span>&nbsp;<span class="op" id="2391012">*</span><span class="ident" id="2391013">fmt</span><span class="op" id="2391016">)</span>&nbsp;<span class="ident" id="2391018">fmt_complex</span><span class="op" id="2391029">(</span><span class="ident" id="2391030">r</span><span class="op" id="2391031">,</span>&nbsp;<span class="ident" id="2391033">j</span>&nbsp;<span class="builtintype" id="2391035">float64</span><span class="op" id="2391042">,</span>&nbsp;<span class="ident" id="2391044">size</span>&nbsp;<span class="builtintype" id="2391049">int</span><span class="op" id="2391052">,</span>&nbsp;<span class="ident" id="2391054">verb</span>&nbsp;<span class="builtintype" id="2391059">rune</span><span class="op" id="2391063">)</span>&nbsp;<span class="op" id="2391065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391068">f</span><span class="op" id="2391069">.</span><span class="ident" id="2391070">buf</span><span class="op" id="2391073">.</span><span class="ident" id="2391074">WriteByte</span><span class="op" id="2391083">(</span><span class="string" id="2391084">&#39;(&#39;</span><span class="op" id="2391087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391090">oldPlus</span>&nbsp;<span class="op" id="2391098">:=</span>&nbsp;<span class="ident" id="2391101">f</span><span class="op" id="2391102">.</span><span class="ident" id="2391103">plus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391109">oldSpace</span>&nbsp;<span class="op" id="2391118">:=</span>&nbsp;<span class="ident" id="2391121">f</span><span class="op" id="2391122">.</span><span class="ident" id="2391123">space</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391130">oldWid</span>&nbsp;<span class="op" id="2391137">:=</span>&nbsp;<span class="ident" id="2391140">f</span><span class="op" id="2391141">.</span><span class="ident" id="2391142">wid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2391147">for</span>&nbsp;<span class="ident" id="2391151">i</span>&nbsp;<span class="op" id="2391153">:=</span>&nbsp;<span class="num" id="2391156">0</span><span class="op" id="2391157">;</span>&nbsp;<span class="op" id="2391159">;</span>&nbsp;<span class="ident" id="2391161">i</span><span class="op" id="2391162">++</span>&nbsp;<span class="op" id="2391165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2391169">switch</span>&nbsp;<span class="ident" id="2391176">verb</span>&nbsp;<span class="op" id="2391181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2391185">case</span>&nbsp;<span class="string" id="2391190">&#39;b&#39;</span><span class="op" id="2391193">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391198">f</span><span class="op" id="2391199">.</span><span class="ident" id="2391200">formatFloat</span><span class="op" id="2391211">(</span><span class="ident" id="2391212">r</span><span class="op" id="2391213">,</span>&nbsp;<span class="string" id="2391215">&#39;b&#39;</span><span class="op" id="2391218">,</span>&nbsp;<span class="num" id="2391220">0</span><span class="op" id="2391221">,</span>&nbsp;<span class="ident" id="2391223">size</span><span class="op" id="2391227">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2391231">case</span>&nbsp;<span class="string" id="2391236">&#39;e&#39;</span><span class="op" id="2391239">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391244">f</span><span class="op" id="2391245">.</span><span class="ident" id="2391246">formatFloat</span><span class="op" id="2391257">(</span><span class="ident" id="2391258">r</span><span class="op" id="2391259">,</span>&nbsp;<span class="string" id="2391261">&#39;e&#39;</span><span class="op" id="2391264">,</span>&nbsp;<span class="ident" id="2391266">doPrec</span><span class="op" id="2391272">(</span><span class="ident" id="2391273">f</span><span class="op" id="2391274">,</span>&nbsp;<span class="num" id="2391276">6</span><span class="op" id="2391277">)</span><span class="op" id="2391278">,</span>&nbsp;<span class="ident" id="2391280">size</span><span class="op" id="2391284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2391288">case</span>&nbsp;<span class="string" id="2391293">&#39;E&#39;</span><span class="op" id="2391296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391301">f</span><span class="op" id="2391302">.</span><span class="ident" id="2391303">formatFloat</span><span class="op" id="2391314">(</span><span class="ident" id="2391315">r</span><span class="op" id="2391316">,</span>&nbsp;<span class="string" id="2391318">&#39;E&#39;</span><span class="op" id="2391321">,</span>&nbsp;<span class="ident" id="2391323">doPrec</span><span class="op" id="2391329">(</span><span class="ident" id="2391330">f</span><span class="op" id="2391331">,</span>&nbsp;<span class="num" id="2391333">6</span><span class="op" id="2391334">)</span><span class="op" id="2391335">,</span>&nbsp;<span class="ident" id="2391337">size</span><span class="op" id="2391341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2391345">case</span>&nbsp;<span class="string" id="2391350">&#39;f&#39;</span><span class="op" id="2391353">,</span>&nbsp;<span class="string" id="2391355">&#39;F&#39;</span><span class="op" id="2391358">:</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391363">f</span><span class="op" id="2391364">.</span><span class="ident" id="2391365">formatFloat</span><span class="op" id="2391376">(</span><span class="ident" id="2391377">r</span><span class="op" id="2391378">,</span>&nbsp;<span class="string" id="2391380">&#39;f&#39;</span><span class="op" id="2391383">,</span>&nbsp;<span class="ident" id="2391385">doPrec</span><span class="op" id="2391391">(</span><span class="ident" id="2391392">f</span><span class="op" id="2391393">,</span>&nbsp;<span class="num" id="2391395">6</span><span class="op" id="2391396">)</span><span class="op" id="2391397">,</span>&nbsp;<span class="ident" id="2391399">size</span><span class="op" id="2391403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2391407">case</span>&nbsp;<span class="string" id="2391412">&#39;g&#39;</span><span class="op" id="2391415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391420">f</span><span class="op" id="2391421">.</span><span class="ident" id="2391422">formatFloat</span><span class="op" id="2391433">(</span><span class="ident" id="2391434">r</span><span class="op" id="2391435">,</span>&nbsp;<span class="string" id="2391437">&#39;g&#39;</span><span class="op" id="2391440">,</span>&nbsp;<span class="ident" id="2391442">doPrec</span><span class="op" id="2391448">(</span><span class="ident" id="2391449">f</span><span class="op" id="2391450">,</span>&nbsp;<span class="op" id="2391452">-</span><span class="num" id="2391453">1</span><span class="op" id="2391454">)</span><span class="op" id="2391455">,</span>&nbsp;<span class="ident" id="2391457">size</span><span class="op" id="2391461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2391465">case</span>&nbsp;<span class="string" id="2391470">&#39;G&#39;</span><span class="op" id="2391473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391478">f</span><span class="op" id="2391479">.</span><span class="ident" id="2391480">formatFloat</span><span class="op" id="2391491">(</span><span class="ident" id="2391492">r</span><span class="op" id="2391493">,</span>&nbsp;<span class="string" id="2391495">&#39;G&#39;</span><span class="op" id="2391498">,</span>&nbsp;<span class="ident" id="2391500">doPrec</span><span class="op" id="2391506">(</span><span class="ident" id="2391507">f</span><span class="op" id="2391508">,</span>&nbsp;<span class="op" id="2391510">-</span><span class="num" id="2391511">1</span><span class="op" id="2391512">)</span><span class="op" id="2391513">,</span>&nbsp;<span class="ident" id="2391515">size</span><span class="op" id="2391519">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2391523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2391527">if</span>&nbsp;<span class="ident" id="2391530">i</span>&nbsp;<span class="op" id="2391532">!=</span>&nbsp;<span class="num" id="2391535">0</span>&nbsp;<span class="op" id="2391537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2391542">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2391550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2391554">//&nbsp;Imaginary&nbsp;part&nbsp;always&nbsp;has&nbsp;a&nbsp;sign.</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391593">f</span><span class="op" id="2391594">.</span><span class="ident" id="2391595">plus</span>&nbsp;<span class="op" id="2391600">=</span>&nbsp;<span class="builtintype" id="2391602">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391609">f</span><span class="op" id="2391610">.</span><span class="ident" id="2391611">space</span>&nbsp;<span class="op" id="2391617">=</span>&nbsp;<span class="builtintype" id="2391619">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391627">f</span><span class="op" id="2391628">.</span><span class="ident" id="2391629">wid</span>&nbsp;<span class="op" id="2391633">=</span>&nbsp;<span class="ident" id="2391635">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391644">r</span>&nbsp;<span class="op" id="2391646">=</span>&nbsp;<span class="ident" id="2391648">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2391651">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391654">f</span><span class="op" id="2391655">.</span><span class="ident" id="2391656">space</span>&nbsp;<span class="op" id="2391662">=</span>&nbsp;<span class="ident" id="2391664">oldSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391674">f</span><span class="op" id="2391675">.</span><span class="ident" id="2391676">plus</span>&nbsp;<span class="op" id="2391681">=</span>&nbsp;<span class="ident" id="2391683">oldPlus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391692">f</span><span class="op" id="2391693">.</span><span class="ident" id="2391694">wid</span>&nbsp;<span class="op" id="2391698">=</span>&nbsp;<span class="ident" id="2391700">oldWid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2391708">f</span><span class="op" id="2391709">.</span><span class="ident" id="2391710">buf</span><span class="op" id="2391713">.</span><span class="ident" id="2391714">Write</span><span class="op" id="2391719">(</span><span class="ident" id="2391720">irparenBytes</span><span class="op" id="2391732">)</span><br>
<span class="lineno"></span><span class="op" id="2391734">}</span>
</div>
</body>
</html>
