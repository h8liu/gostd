<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6519069">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6519124">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6519178">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6519229">package</span>&nbsp;<span class="ident" id="6519237">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6519242">import</span>&nbsp;<span class="op" id="6519249">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6519252">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6519261">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6519268">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6519278">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6519281">type</span>&nbsp;<span class="ident" id="6519286">rc4Test</span>&nbsp;<span class="keyword" id="6519294">struct</span>&nbsp;<span class="op" id="6519301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6519304">key</span><span class="op" id="6519307">,</span>&nbsp;<span class="ident" id="6519309">keystream</span>&nbsp;<span class="op" id="6519319">[</span><span class="op" id="6519320">]</span><span class="builtintype" id="6519321">byte</span><br>
<span class="lineno">15</span><span class="op" id="6519326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6519329">var</span>&nbsp;<span class="ident" id="6519333">golden</span>&nbsp;<span class="op" id="6519340">=</span>&nbsp;<span class="op" id="6519342">[</span><span class="op" id="6519343">]</span><span class="ident" id="6519344">rc4Test</span><span class="op" id="6519351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6519354">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6519417">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519495">[</span><span class="op" id="6519496">]</span><span class="builtintype" id="6519497">byte</span><span class="op" id="6519501">{</span><span class="num" id="6519502">0x01</span><span class="op" id="6519506">,</span>&nbsp;<span class="num" id="6519508">0x23</span><span class="op" id="6519512">,</span>&nbsp;<span class="num" id="6519514">0x45</span><span class="op" id="6519518">,</span>&nbsp;<span class="num" id="6519520">0x67</span><span class="op" id="6519524">,</span>&nbsp;<span class="num" id="6519526">0x89</span><span class="op" id="6519530">,</span>&nbsp;<span class="num" id="6519532">0xab</span><span class="op" id="6519536">,</span>&nbsp;<span class="num" id="6519538">0xcd</span><span class="op" id="6519542">,</span>&nbsp;<span class="num" id="6519544">0xef</span><span class="op" id="6519548">}</span><span class="op" id="6519549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519553">[</span><span class="op" id="6519554">]</span><span class="builtintype" id="6519555">byte</span><span class="op" id="6519559">{</span><span class="num" id="6519560">0x74</span><span class="op" id="6519564">,</span>&nbsp;<span class="num" id="6519566">0x94</span><span class="op" id="6519570">,</span>&nbsp;<span class="num" id="6519572">0xc2</span><span class="op" id="6519576">,</span>&nbsp;<span class="num" id="6519578">0xe7</span><span class="op" id="6519582">,</span>&nbsp;<span class="num" id="6519584">0x10</span><span class="op" id="6519588">,</span>&nbsp;<span class="num" id="6519590">0x4b</span><span class="op" id="6519594">,</span>&nbsp;<span class="num" id="6519596">0x08</span><span class="op" id="6519600">,</span>&nbsp;<span class="num" id="6519602">0x79</span><span class="op" id="6519606">}</span><span class="op" id="6519607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519610">}</span><span class="op" id="6519611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519614">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519618">[</span><span class="op" id="6519619">]</span><span class="builtintype" id="6519620">byte</span><span class="op" id="6519624">{</span><span class="num" id="6519625">0x00</span><span class="op" id="6519629">,</span>&nbsp;<span class="num" id="6519631">0x00</span><span class="op" id="6519635">,</span>&nbsp;<span class="num" id="6519637">0x00</span><span class="op" id="6519641">,</span>&nbsp;<span class="num" id="6519643">0x00</span><span class="op" id="6519647">,</span>&nbsp;<span class="num" id="6519649">0x00</span><span class="op" id="6519653">,</span>&nbsp;<span class="num" id="6519655">0x00</span><span class="op" id="6519659">,</span>&nbsp;<span class="num" id="6519661">0x00</span><span class="op" id="6519665">,</span>&nbsp;<span class="num" id="6519667">0x00</span><span class="op" id="6519671">}</span><span class="op" id="6519672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519676">[</span><span class="op" id="6519677">]</span><span class="builtintype" id="6519678">byte</span><span class="op" id="6519682">{</span><span class="num" id="6519683">0xde</span><span class="op" id="6519687">,</span>&nbsp;<span class="num" id="6519689">0x18</span><span class="op" id="6519693">,</span>&nbsp;<span class="num" id="6519695">0x89</span><span class="op" id="6519699">,</span>&nbsp;<span class="num" id="6519701">0x41</span><span class="op" id="6519705">,</span>&nbsp;<span class="num" id="6519707">0xa3</span><span class="op" id="6519711">,</span>&nbsp;<span class="num" id="6519713">0x37</span><span class="op" id="6519717">,</span>&nbsp;<span class="num" id="6519719">0x5d</span><span class="op" id="6519723">,</span>&nbsp;<span class="num" id="6519725">0x3a</span><span class="op" id="6519729">}</span><span class="op" id="6519730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519733">}</span><span class="op" id="6519734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519741">[</span><span class="op" id="6519742">]</span><span class="builtintype" id="6519743">byte</span><span class="op" id="6519747">{</span><span class="num" id="6519748">0xef</span><span class="op" id="6519752">,</span>&nbsp;<span class="num" id="6519754">0x01</span><span class="op" id="6519758">,</span>&nbsp;<span class="num" id="6519760">0x23</span><span class="op" id="6519764">,</span>&nbsp;<span class="num" id="6519766">0x45</span><span class="op" id="6519770">}</span><span class="op" id="6519771">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519775">[</span><span class="op" id="6519776">]</span><span class="builtintype" id="6519777">byte</span><span class="op" id="6519781">{</span><span class="num" id="6519782">0xd6</span><span class="op" id="6519786">,</span>&nbsp;<span class="num" id="6519788">0xa1</span><span class="op" id="6519792">,</span>&nbsp;<span class="num" id="6519794">0x41</span><span class="op" id="6519798">,</span>&nbsp;<span class="num" id="6519800">0xa7</span><span class="op" id="6519804">,</span>&nbsp;<span class="num" id="6519806">0xec</span><span class="op" id="6519810">,</span>&nbsp;<span class="num" id="6519812">0x3c</span><span class="op" id="6519816">,</span>&nbsp;<span class="num" id="6519818">0x38</span><span class="op" id="6519822">,</span>&nbsp;<span class="num" id="6519824">0xdf</span><span class="op" id="6519828">,</span>&nbsp;<span class="num" id="6519830">0xbd</span><span class="op" id="6519834">,</span>&nbsp;<span class="num" id="6519836">0x61</span><span class="op" id="6519840">}</span><span class="op" id="6519841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519844">}</span><span class="op" id="6519845">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6519849">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519924">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519928">[</span><span class="op" id="6519929">]</span><span class="builtintype" id="6519930">byte</span><span class="op" id="6519934">{</span><span class="num" id="6519935">0x4b</span><span class="op" id="6519939">,</span>&nbsp;<span class="num" id="6519941">0x65</span><span class="op" id="6519945">,</span>&nbsp;<span class="num" id="6519947">0x79</span><span class="op" id="6519951">}</span><span class="op" id="6519952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6519956">[</span><span class="op" id="6519957">]</span><span class="builtintype" id="6519958">byte</span><span class="op" id="6519962">{</span><span class="num" id="6519963">0xeb</span><span class="op" id="6519967">,</span>&nbsp;<span class="num" id="6519969">0x9f</span><span class="op" id="6519973">,</span>&nbsp;<span class="num" id="6519975">0x77</span><span class="op" id="6519979">,</span>&nbsp;<span class="num" id="6519981">0x81</span><span class="op" id="6519985">,</span>&nbsp;<span class="num" id="6519987">0xb7</span><span class="op" id="6519991">,</span>&nbsp;<span class="num" id="6519993">0x34</span><span class="op" id="6519997">,</span>&nbsp;<span class="num" id="6519999">0xca</span><span class="op" id="6520003">,</span>&nbsp;<span class="num" id="6520005">0x72</span><span class="op" id="6520009">,</span>&nbsp;<span class="num" id="6520011">0xa7</span><span class="op" id="6520015">,</span>&nbsp;<span class="num" id="6520017">0x19</span><span class="op" id="6520021">}</span><span class="op" id="6520022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6520025">}</span><span class="op" id="6520026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6520029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6520033">[</span><span class="op" id="6520034">]</span><span class="builtintype" id="6520035">byte</span><span class="op" id="6520039">{</span><span class="num" id="6520040">0x57</span><span class="op" id="6520044">,</span>&nbsp;<span class="num" id="6520046">0x69</span><span class="op" id="6520050">,</span>&nbsp;<span class="num" id="6520052">0x6b</span><span class="op" id="6520056">,</span>&nbsp;<span class="num" id="6520058">0x69</span><span class="op" id="6520062">}</span><span class="op" id="6520063">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6520067">[</span><span class="op" id="6520068">]</span><span class="builtintype" id="6520069">byte</span><span class="op" id="6520073">{</span><span class="num" id="6520074">0x60</span><span class="op" id="6520078">,</span>&nbsp;<span class="num" id="6520080">0x44</span><span class="op" id="6520084">,</span>&nbsp;<span class="num" id="6520086">0xdb</span><span class="op" id="6520090">,</span>&nbsp;<span class="num" id="6520092">0x6d</span><span class="op" id="6520096">,</span>&nbsp;<span class="num" id="6520098">0x41</span><span class="op" id="6520102">,</span>&nbsp;<span class="num" id="6520104">0xb7</span><span class="op" id="6520108">}</span><span class="op" id="6520109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6520112">}</span><span class="op" id="6520113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6520116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6520120">[</span><span class="op" id="6520121">]</span><span class="builtintype" id="6520122">byte</span><span class="op" id="6520126">{</span><span class="num" id="6520127">0x00</span><span class="op" id="6520131">,</span>&nbsp;<span class="num" id="6520133">0x00</span><span class="op" id="6520137">,</span>&nbsp;<span class="num" id="6520139">0x00</span><span class="op" id="6520143">,</span>&nbsp;<span class="num" id="6520145">0x00</span><span class="op" id="6520149">,</span>&nbsp;<span class="num" id="6520151">0x00</span><span class="op" id="6520155">,</span>&nbsp;<span class="num" id="6520157">0x00</span><span class="op" id="6520161">,</span>&nbsp;<span class="num" id="6520163">0x00</span><span class="op" id="6520167">,</span>&nbsp;<span class="num" id="6520169">0x00</span><span class="op" id="6520173">}</span><span class="op" id="6520174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6520178">[</span><span class="op" id="6520179">]</span><span class="builtintype" id="6520180">byte</span><span class="op" id="6520184">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520189">0xde</span><span class="op" id="6520193">,</span>&nbsp;<span class="num" id="6520195">0x18</span><span class="op" id="6520199">,</span>&nbsp;<span class="num" id="6520201">0x89</span><span class="op" id="6520205">,</span>&nbsp;<span class="num" id="6520207">0x41</span><span class="op" id="6520211">,</span>&nbsp;<span class="num" id="6520213">0xa3</span><span class="op" id="6520217">,</span>&nbsp;<span class="num" id="6520219">0x37</span><span class="op" id="6520223">,</span>&nbsp;<span class="num" id="6520225">0x5d</span><span class="op" id="6520229">,</span>&nbsp;<span class="num" id="6520231">0x3a</span><span class="op" id="6520235">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520240">0x8a</span><span class="op" id="6520244">,</span>&nbsp;<span class="num" id="6520246">0x06</span><span class="op" id="6520250">,</span>&nbsp;<span class="num" id="6520252">0x1e</span><span class="op" id="6520256">,</span>&nbsp;<span class="num" id="6520258">0x67</span><span class="op" id="6520262">,</span>&nbsp;<span class="num" id="6520264">0x57</span><span class="op" id="6520268">,</span>&nbsp;<span class="num" id="6520270">0x6e</span><span class="op" id="6520274">,</span>&nbsp;<span class="num" id="6520276">0x92</span><span class="op" id="6520280">,</span>&nbsp;<span class="num" id="6520282">0x6d</span><span class="op" id="6520286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520291">0xc7</span><span class="op" id="6520295">,</span>&nbsp;<span class="num" id="6520297">0x1a</span><span class="op" id="6520301">,</span>&nbsp;<span class="num" id="6520303">0x7f</span><span class="op" id="6520307">,</span>&nbsp;<span class="num" id="6520309">0xa3</span><span class="op" id="6520313">,</span>&nbsp;<span class="num" id="6520315">0xf0</span><span class="op" id="6520319">,</span>&nbsp;<span class="num" id="6520321">0xcc</span><span class="op" id="6520325">,</span>&nbsp;<span class="num" id="6520327">0xeb</span><span class="op" id="6520331">,</span>&nbsp;<span class="num" id="6520333">0x97</span><span class="op" id="6520337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520342">0x45</span><span class="op" id="6520346">,</span>&nbsp;<span class="num" id="6520348">0x2b</span><span class="op" id="6520352">,</span>&nbsp;<span class="num" id="6520354">0x4d</span><span class="op" id="6520358">,</span>&nbsp;<span class="num" id="6520360">0x32</span><span class="op" id="6520364">,</span>&nbsp;<span class="num" id="6520366">0x27</span><span class="op" id="6520370">,</span>&nbsp;<span class="num" id="6520372">0x96</span><span class="op" id="6520376">,</span>&nbsp;<span class="num" id="6520378">0x5f</span><span class="op" id="6520382">,</span>&nbsp;<span class="num" id="6520384">0x9e</span><span class="op" id="6520388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520393">0xa8</span><span class="op" id="6520397">,</span>&nbsp;<span class="num" id="6520399">0xcc</span><span class="op" id="6520403">,</span>&nbsp;<span class="num" id="6520405">0x75</span><span class="op" id="6520409">,</span>&nbsp;<span class="num" id="6520411">0x07</span><span class="op" id="6520415">,</span>&nbsp;<span class="num" id="6520417">0x6d</span><span class="op" id="6520421">,</span>&nbsp;<span class="num" id="6520423">0x9f</span><span class="op" id="6520427">,</span>&nbsp;<span class="num" id="6520429">0xb9</span><span class="op" id="6520433">,</span>&nbsp;<span class="num" id="6520435">0xc5</span><span class="op" id="6520439">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520444">0x41</span><span class="op" id="6520448">,</span>&nbsp;<span class="num" id="6520450">0x7a</span><span class="op" id="6520454">,</span>&nbsp;<span class="num" id="6520456">0xa5</span><span class="op" id="6520460">,</span>&nbsp;<span class="num" id="6520462">0xcb</span><span class="op" id="6520466">,</span>&nbsp;<span class="num" id="6520468">0x30</span><span class="op" id="6520472">,</span>&nbsp;<span class="num" id="6520474">0xfc</span><span class="op" id="6520478">,</span>&nbsp;<span class="num" id="6520480">0x22</span><span class="op" id="6520484">,</span>&nbsp;<span class="num" id="6520486">0x19</span><span class="op" id="6520490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520495">0x8b</span><span class="op" id="6520499">,</span>&nbsp;<span class="num" id="6520501">0x34</span><span class="op" id="6520505">,</span>&nbsp;<span class="num" id="6520507">0x98</span><span class="op" id="6520511">,</span>&nbsp;<span class="num" id="6520513">0x2d</span><span class="op" id="6520517">,</span>&nbsp;<span class="num" id="6520519">0xbb</span><span class="op" id="6520523">,</span>&nbsp;<span class="num" id="6520525">0x62</span><span class="op" id="6520529">,</span>&nbsp;<span class="num" id="6520531">0x9e</span><span class="op" id="6520535">,</span>&nbsp;<span class="num" id="6520537">0xc0</span><span class="op" id="6520541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520546">0x4b</span><span class="op" id="6520550">,</span>&nbsp;<span class="num" id="6520552">0x4f</span><span class="op" id="6520556">,</span>&nbsp;<span class="num" id="6520558">0x8b</span><span class="op" id="6520562">,</span>&nbsp;<span class="num" id="6520564">0x05</span><span class="op" id="6520568">,</span>&nbsp;<span class="num" id="6520570">0xa0</span><span class="op" id="6520574">,</span>&nbsp;<span class="num" id="6520576">0x71</span><span class="op" id="6520580">,</span>&nbsp;<span class="num" id="6520582">0x08</span><span class="op" id="6520586">,</span>&nbsp;<span class="num" id="6520588">0x50</span><span class="op" id="6520592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520597">0x92</span><span class="op" id="6520601">,</span>&nbsp;<span class="num" id="6520603">0xa0</span><span class="op" id="6520607">,</span>&nbsp;<span class="num" id="6520609">0xc3</span><span class="op" id="6520613">,</span>&nbsp;<span class="num" id="6520615">0x58</span><span class="op" id="6520619">,</span>&nbsp;<span class="num" id="6520621">0x4a</span><span class="op" id="6520625">,</span>&nbsp;<span class="num" id="6520627">0x48</span><span class="op" id="6520631">,</span>&nbsp;<span class="num" id="6520633">0xe4</span><span class="op" id="6520637">,</span>&nbsp;<span class="num" id="6520639">0xa3</span><span class="op" id="6520643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520648">0x0a</span><span class="op" id="6520652">,</span>&nbsp;<span class="num" id="6520654">0x39</span><span class="op" id="6520658">,</span>&nbsp;<span class="num" id="6520660">0x7b</span><span class="op" id="6520664">,</span>&nbsp;<span class="num" id="6520666">0x8a</span><span class="op" id="6520670">,</span>&nbsp;<span class="num" id="6520672">0xcd</span><span class="op" id="6520676">,</span>&nbsp;<span class="num" id="6520678">0x1d</span><span class="op" id="6520682">,</span>&nbsp;<span class="num" id="6520684">0x00</span><span class="op" id="6520688">,</span>&nbsp;<span class="num" id="6520690">0x9e</span><span class="op" id="6520694">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520699">0xc8</span><span class="op" id="6520703">,</span>&nbsp;<span class="num" id="6520705">0x7d</span><span class="op" id="6520709">,</span>&nbsp;<span class="num" id="6520711">0x68</span><span class="op" id="6520715">,</span>&nbsp;<span class="num" id="6520717">0x11</span><span class="op" id="6520721">,</span>&nbsp;<span class="num" id="6520723">0xf2</span><span class="op" id="6520727">,</span>&nbsp;<span class="num" id="6520729">0x2c</span><span class="op" id="6520733">,</span>&nbsp;<span class="num" id="6520735">0xf4</span><span class="op" id="6520739">,</span>&nbsp;<span class="num" id="6520741">0x9c</span><span class="op" id="6520745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520750">0xa3</span><span class="op" id="6520754">,</span>&nbsp;<span class="num" id="6520756">0xe5</span><span class="op" id="6520760">,</span>&nbsp;<span class="num" id="6520762">0x93</span><span class="op" id="6520766">,</span>&nbsp;<span class="num" id="6520768">0x54</span><span class="op" id="6520772">,</span>&nbsp;<span class="num" id="6520774">0xb9</span><span class="op" id="6520778">,</span>&nbsp;<span class="num" id="6520780">0x45</span><span class="op" id="6520784">,</span>&nbsp;<span class="num" id="6520786">0x15</span><span class="op" id="6520790">,</span>&nbsp;<span class="num" id="6520792">0x35</span><span class="op" id="6520796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520801">0xa2</span><span class="op" id="6520805">,</span>&nbsp;<span class="num" id="6520807">0x18</span><span class="op" id="6520811">,</span>&nbsp;<span class="num" id="6520813">0x7a</span><span class="op" id="6520817">,</span>&nbsp;<span class="num" id="6520819">0x86</span><span class="op" id="6520823">,</span>&nbsp;<span class="num" id="6520825">0x42</span><span class="op" id="6520829">,</span>&nbsp;<span class="num" id="6520831">0x6c</span><span class="op" id="6520835">,</span>&nbsp;<span class="num" id="6520837">0xca</span><span class="op" id="6520841">,</span>&nbsp;<span class="num" id="6520843">0x7d</span><span class="op" id="6520847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520852">0x5e</span><span class="op" id="6520856">,</span>&nbsp;<span class="num" id="6520858">0x82</span><span class="op" id="6520862">,</span>&nbsp;<span class="num" id="6520864">0x3e</span><span class="op" id="6520868">,</span>&nbsp;<span class="num" id="6520870">0xba</span><span class="op" id="6520874">,</span>&nbsp;<span class="num" id="6520876">0x00</span><span class="op" id="6520880">,</span>&nbsp;<span class="num" id="6520882">0x44</span><span class="op" id="6520886">,</span>&nbsp;<span class="num" id="6520888">0x12</span><span class="op" id="6520892">,</span>&nbsp;<span class="num" id="6520894">0x67</span><span class="op" id="6520898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520903">0x12</span><span class="op" id="6520907">,</span>&nbsp;<span class="num" id="6520909">0x57</span><span class="op" id="6520913">,</span>&nbsp;<span class="num" id="6520915">0xb8</span><span class="op" id="6520919">,</span>&nbsp;<span class="num" id="6520921">0xd8</span><span class="op" id="6520925">,</span>&nbsp;<span class="num" id="6520927">0x60</span><span class="op" id="6520931">,</span>&nbsp;<span class="num" id="6520933">0xae</span><span class="op" id="6520937">,</span>&nbsp;<span class="num" id="6520939">0x4c</span><span class="op" id="6520943">,</span>&nbsp;<span class="num" id="6520945">0xbd</span><span class="op" id="6520949">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6520954">0x4c</span><span class="op" id="6520958">,</span>&nbsp;<span class="num" id="6520960">0x49</span><span class="op" id="6520964">,</span>&nbsp;<span class="num" id="6520966">0x06</span><span class="op" id="6520970">,</span>&nbsp;<span class="num" id="6520972">0xbb</span><span class="op" id="6520976">,</span>&nbsp;<span class="num" id="6520978">0xc5</span><span class="op" id="6520982">,</span>&nbsp;<span class="num" id="6520984">0x35</span><span class="op" id="6520988">,</span>&nbsp;<span class="num" id="6520990">0xef</span><span class="op" id="6520994">,</span>&nbsp;<span class="num" id="6520996">0xe1</span><span class="op" id="6521000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6521005">0x58</span><span class="op" id="6521009">,</span>&nbsp;<span class="num" id="6521011">0x7f</span><span class="op" id="6521015">,</span>&nbsp;<span class="num" id="6521017">0x08</span><span class="op" id="6521021">,</span>&nbsp;<span class="num" id="6521023">0xdb</span><span class="op" id="6521027">,</span>&nbsp;<span class="num" id="6521029">0x33</span><span class="op" id="6521033">,</span>&nbsp;<span class="num" id="6521035">0x95</span><span class="op" id="6521039">,</span>&nbsp;<span class="num" id="6521041">0x5c</span><span class="op" id="6521045">,</span>&nbsp;<span class="num" id="6521047">0xdb</span><span class="op" id="6521051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6521056">0xcb</span><span class="op" id="6521060">,</span>&nbsp;<span class="num" id="6521062">0xad</span><span class="op" id="6521066">,</span>&nbsp;<span class="num" id="6521068">0x9b</span><span class="op" id="6521072">,</span>&nbsp;<span class="num" id="6521074">0x10</span><span class="op" id="6521078">,</span>&nbsp;<span class="num" id="6521080">0xf5</span><span class="op" id="6521084">,</span>&nbsp;<span class="num" id="6521086">0x3f</span><span class="op" id="6521090">,</span>&nbsp;<span class="num" id="6521092">0xc4</span><span class="op" id="6521096">,</span>&nbsp;<span class="num" id="6521098">0xe5</span><span class="op" id="6521102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6521107">0x2c</span><span class="op" id="6521111">,</span>&nbsp;<span class="num" id="6521113">0x59</span><span class="op" id="6521117">,</span>&nbsp;<span class="num" id="6521119">0x15</span><span class="op" id="6521123">,</span>&nbsp;<span class="num" id="6521125">0x65</span><span class="op" id="6521129">,</span>&nbsp;<span class="num" id="6521131">0x51</span><span class="op" id="6521135">,</span>&nbsp;<span class="num" id="6521137">0x84</span><span class="op" id="6521141">,</span>&nbsp;<span class="num" id="6521143">0x87</span><span class="op" id="6521147">,</span>&nbsp;<span class="num" id="6521149">0xfe</span><span class="op" id="6521153">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6521158">0x08</span><span class="op" id="6521162">,</span>&nbsp;<span class="num" id="6521164">0x4d</span><span class="op" id="6521168">,</span>&nbsp;<span class="num" id="6521170">0x0e</span><span class="op" id="6521174">,</span>&nbsp;<span class="num" id="6521176">0x3f</span><span class="op" id="6521180">,</span>&nbsp;<span class="num" id="6521182">0x03</span><span class="op" id="6521186">,</span>&nbsp;<span class="num" id="6521188">0xde</span><span class="op" id="6521192">,</span>&nbsp;<span class="num" id="6521194">0xbc</span><span class="op" id="6521198">,</span>&nbsp;<span class="num" id="6521200">0xc9</span><span class="op" id="6521204">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6521209">0xda</span><span class="op" id="6521213">,</span>&nbsp;<span class="num" id="6521215">0x1c</span><span class="op" id="6521219">,</span>&nbsp;<span class="num" id="6521221">0xe9</span><span class="op" id="6521225">,</span>&nbsp;<span class="num" id="6521227">0x0d</span><span class="op" id="6521231">,</span>&nbsp;<span class="num" id="6521233">0x08</span><span class="op" id="6521237">,</span>&nbsp;<span class="num" id="6521239">0x5c</span><span class="op" id="6521243">,</span>&nbsp;<span class="num" id="6521245">0x2d</span><span class="op" id="6521249">,</span>&nbsp;<span class="num" id="6521251">0x8a</span><span class="op" id="6521255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6521260">0x19</span><span class="op" id="6521264">,</span>&nbsp;<span class="num" id="6521266">0xd8</span><span class="op" id="6521270">,</span>&nbsp;<span class="num" id="6521272">0x37</span><span class="op" id="6521276">,</span>&nbsp;<span class="num" id="6521278">0x30</span><span class="op" id="6521282">,</span>&nbsp;<span class="num" id="6521284">0x86</span><span class="op" id="6521288">,</span>&nbsp;<span class="num" id="6521290">0x16</span><span class="op" id="6521294">,</span>&nbsp;<span class="num" id="6521296">0x36</span><span class="op" id="6521300">,</span>&nbsp;<span class="num" id="6521302">0x92</span><span class="op" id="6521306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6521311">0x14</span><span class="op" id="6521315">,</span>&nbsp;<span class="num" id="6521317">0x2b</span><span class="op" id="6521321">,</span>&nbsp;<span class="num" id="6521323">0xd8</span><span class="op" id="6521327">,</span>&nbsp;<span class="num" id="6521329">0xfc</span><span class="op" id="6521333">,</span>&nbsp;<span class="num" id="6521335">0x5d</span><span class="op" id="6521339">,</span>&nbsp;<span class="num" id="6521341">0x7a</span><span class="op" id="6521345">,</span>&nbsp;<span class="num" id="6521347">0x73</span><span class="op" id="6521351">,</span>&nbsp;<span class="num" id="6521353">0x49</span><span class="op" id="6521357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6521362">0x6a</span><span class="op" id="6521366">,</span>&nbsp;<span class="num" id="6521368">0x8e</span><span class="op" id="6521372">,</span>&nbsp;<span class="num" id="6521374">0x59</span><span class="op" id="6521378">,</span>&nbsp;<span class="num" id="6521380">0xee</span><span class="op" id="6521384">,</span>&nbsp;<span class="num" id="6521386">0x7e</span><span class="op" id="6521390">,</span>&nbsp;<span class="num" id="6521392">0xcf</span><span class="op" id="6521396">,</span>&nbsp;<span class="num" id="6521398">0x6b</span><span class="op" id="6521402">,</span>&nbsp;<span class="num" id="6521404">0x94</span><span class="op" id="6521408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6521413">0x06</span><span class="op" id="6521417">,</span>&nbsp;<span class="num" id="6521419">0x63</span><span class="op" id="6521423">,</span>&nbsp;<span class="num" id="6521425">0xf4</span><span class="op" id="6521429">,</span>&nbsp;<span class="num" id="6521431">0xa6</span><span class="op" id="6521435">,</span>&nbsp;<span class="num" id="6521437">0xbe</span><span class="op" id="6521441">,</span>&nbsp;<span class="num" id="6521443">0xe6</span><span class="op" id="6521447">,</span>&nbsp;<span class="num" id="6521449">0x5b</span><span class="op" id="6521453">,</span>&nbsp;<span class="num" id="6521455">0xd2</span><span class="op" id="6521459">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6521464">0xc8</span><span class="op" id="6521468">,</span>&nbsp;<span class="num" id="6521470">0x5c</span><span class="op" id="6521474">,</span>&nbsp;<span class="num" id="6521476">0x46</span><span class="op" id="6521480">,</span>&nbsp;<span class="num" id="6521482">0x98</span><span class="op" id="6521486">,</span>&nbsp;<span class="num" id="6521488">0x6c</span><span class="op" id="6521492">,</span>&nbsp;<span class="num" id="6521494">0x1b</span><span class="op" id="6521498">,</span>&nbsp;<span class="num" id="6521500">0xef</span><span class="op" id="6521504">,</span>&nbsp;<span class="num" id="6521506">0x34</span><span class="op" id="6521510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6521515">0x90</span><span class="op" id="6521519">,</span>&nbsp;<span class="num" id="6521521">0xd3</span><span class="op" id="6521525">,</span>&nbsp;<span class="num" id="6521527">0x7b</span><span class="op" id="6521531">,</span>&nbsp;<span class="num" id="6521533">0x38</span><span class="op" id="6521537">,</span>&nbsp;<span class="num" id="6521539">0xda</span><span class="op" id="6521543">,</span>&nbsp;<span class="num" id="6521545">0x85</span><span class="op" id="6521549">,</span>&nbsp;<span class="num" id="6521551">0xd3</span><span class="op" id="6521555">,</span>&nbsp;<span class="num" id="6521557">0x2e</span><span class="op" id="6521561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6521566">0x97</span><span class="op" id="6521570">,</span>&nbsp;<span class="num" id="6521572">0x39</span><span class="op" id="6521576">,</span>&nbsp;<span class="num" id="6521578">0xcb</span><span class="op" id="6521582">,</span>&nbsp;<span class="num" id="6521584">0x23</span><span class="op" id="6521588">,</span>&nbsp;<span class="num" id="6521590">0x4a</span><span class="op" id="6521594">,</span>&nbsp;<span class="num" id="6521596">0x2b</span><span class="op" id="6521600">,</span>&nbsp;<span class="num" id="6521602">0xe7</span><span class="op" id="6521606">,</span>&nbsp;<span class="num" id="6521608">0x40</span><span class="op" id="6521612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6521616">}</span><span class="op" id="6521617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6521620">}</span><span class="op" id="6521621">,</span><br>
<span class="lineno">75</span><span class="op" id="6521623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6521626">func</span>&nbsp;<span class="ident" id="6521631">testEncrypt</span><span class="op" id="6521642">(</span><span class="ident" id="6521643">t</span>&nbsp;<span class="op" id="6521645">*</span><span class="ident" id="6521646">testing</span><span class="op" id="6521653">.</span><span class="ident" id="6521654">T</span><span class="op" id="6521655">,</span>&nbsp;<span class="ident" id="6521657">desc</span>&nbsp;<span class="builtintype" id="6521662">string</span><span class="op" id="6521668">,</span>&nbsp;<span class="ident" id="6521670">c</span>&nbsp;<span class="op" id="6521672">*</span><span class="ident" id="6521673">Cipher</span><span class="op" id="6521679">,</span>&nbsp;<span class="ident" id="6521681">src</span><span class="op" id="6521684">,</span>&nbsp;<span class="ident" id="6521686">expect</span>&nbsp;<span class="op" id="6521693">[</span><span class="op" id="6521694">]</span><span class="builtintype" id="6521695">byte</span><span class="op" id="6521699">)</span>&nbsp;<span class="op" id="6521701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6521704">dst</span>&nbsp;<span class="op" id="6521708">:=</span>&nbsp;<span class="builtinfunc" id="6521711">make</span><span class="op" id="6521715">(</span><span class="op" id="6521716">[</span><span class="op" id="6521717">]</span><span class="builtintype" id="6521718">byte</span><span class="op" id="6521722">,</span>&nbsp;<span class="builtinfunc" id="6521724">len</span><span class="op" id="6521727">(</span><span class="ident" id="6521728">src</span><span class="op" id="6521731">)</span><span class="op" id="6521732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6521735">c</span><span class="op" id="6521736">.</span><span class="ident" id="6521737">XORKeyStream</span><span class="op" id="6521749">(</span><span class="ident" id="6521750">dst</span><span class="op" id="6521753">,</span>&nbsp;<span class="ident" id="6521755">src</span><span class="op" id="6521758">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6521761">for</span>&nbsp;<span class="ident" id="6521765">i</span><span class="op" id="6521766">,</span>&nbsp;<span class="ident" id="6521768">v</span>&nbsp;<span class="op" id="6521770">:=</span>&nbsp;<span class="keyword" id="6521773">range</span>&nbsp;<span class="ident" id="6521779">dst</span>&nbsp;<span class="op" id="6521783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6521787">if</span>&nbsp;<span class="ident" id="6521790">v</span>&nbsp;<span class="op" id="6521792">!=</span>&nbsp;<span class="ident" id="6521795">expect</span><span class="op" id="6521801">[</span><span class="ident" id="6521802">i</span><span class="op" id="6521803">]</span>&nbsp;<span class="op" id="6521805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6521810">t</span><span class="op" id="6521811">.</span><span class="ident" id="6521812">Fatalf</span><span class="op" id="6521818">(</span><span class="string" id="6521819">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="6521863">,</span>&nbsp;<span class="ident" id="6521865">desc</span><span class="op" id="6521869">,</span>&nbsp;<span class="ident" id="6521871">i</span><span class="op" id="6521872">,</span>&nbsp;<span class="ident" id="6521874">dst</span><span class="op" id="6521877">,</span>&nbsp;<span class="ident" id="6521879">expect</span><span class="op" id="6521885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6521889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6521892">}</span><br>
<span class="lineno">85</span><span class="op" id="6521894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6521897">func</span>&nbsp;<span class="ident" id="6521902">TestGolden</span><span class="op" id="6521912">(</span><span class="ident" id="6521913">t</span>&nbsp;<span class="op" id="6521915">*</span><span class="ident" id="6521916">testing</span><span class="op" id="6521923">.</span><span class="ident" id="6521924">T</span><span class="op" id="6521925">)</span>&nbsp;<span class="op" id="6521927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6521930">for</span>&nbsp;<span class="ident" id="6521934">gi</span><span class="op" id="6521936">,</span>&nbsp;<span class="ident" id="6521938">g</span>&nbsp;<span class="op" id="6521940">:=</span>&nbsp;<span class="keyword" id="6521943">range</span>&nbsp;<span class="ident" id="6521949">golden</span>&nbsp;<span class="op" id="6521956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6521960">data</span>&nbsp;<span class="op" id="6521965">:=</span>&nbsp;<span class="builtinfunc" id="6521968">make</span><span class="op" id="6521972">(</span><span class="op" id="6521973">[</span><span class="op" id="6521974">]</span><span class="builtintype" id="6521975">byte</span><span class="op" id="6521979">,</span>&nbsp;<span class="builtinfunc" id="6521981">len</span><span class="op" id="6521984">(</span><span class="ident" id="6521985">g</span><span class="op" id="6521986">.</span><span class="ident" id="6521987">keystream</span><span class="op" id="6521996">)</span><span class="op" id="6521997">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6522001">for</span>&nbsp;<span class="ident" id="6522005">i</span>&nbsp;<span class="op" id="6522007">:=</span>&nbsp;<span class="keyword" id="6522010">range</span>&nbsp;<span class="ident" id="6522016">data</span>&nbsp;<span class="op" id="6522021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522026">data</span><span class="op" id="6522030">[</span><span class="ident" id="6522031">i</span><span class="op" id="6522032">]</span>&nbsp;<span class="op" id="6522034">=</span>&nbsp;<span class="builtintype" id="6522036">byte</span><span class="op" id="6522040">(</span><span class="ident" id="6522041">i</span><span class="op" id="6522042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6522046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522051">expect</span>&nbsp;<span class="op" id="6522058">:=</span>&nbsp;<span class="builtinfunc" id="6522061">make</span><span class="op" id="6522065">(</span><span class="op" id="6522066">[</span><span class="op" id="6522067">]</span><span class="builtintype" id="6522068">byte</span><span class="op" id="6522072">,</span>&nbsp;<span class="builtinfunc" id="6522074">len</span><span class="op" id="6522077">(</span><span class="ident" id="6522078">g</span><span class="op" id="6522079">.</span><span class="ident" id="6522080">keystream</span><span class="op" id="6522089">)</span><span class="op" id="6522090">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6522094">for</span>&nbsp;<span class="ident" id="6522098">i</span>&nbsp;<span class="op" id="6522100">:=</span>&nbsp;<span class="keyword" id="6522103">range</span>&nbsp;<span class="ident" id="6522109">expect</span>&nbsp;<span class="op" id="6522116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522121">expect</span><span class="op" id="6522127">[</span><span class="ident" id="6522128">i</span><span class="op" id="6522129">]</span>&nbsp;<span class="op" id="6522131">=</span>&nbsp;<span class="builtintype" id="6522133">byte</span><span class="op" id="6522137">(</span><span class="ident" id="6522138">i</span><span class="op" id="6522139">)</span>&nbsp;<span class="op" id="6522141">^</span>&nbsp;<span class="ident" id="6522143">g</span><span class="op" id="6522144">.</span><span class="ident" id="6522145">keystream</span><span class="op" id="6522154">[</span><span class="ident" id="6522155">i</span><span class="op" id="6522156">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6522160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6522165">for</span>&nbsp;<span class="ident" id="6522169">size</span>&nbsp;<span class="op" id="6522174">:=</span>&nbsp;<span class="num" id="6522177">1</span><span class="op" id="6522178">;</span>&nbsp;<span class="ident" id="6522180">size</span>&nbsp;<span class="op" id="6522185">&lt;=</span>&nbsp;<span class="builtinfunc" id="6522188">len</span><span class="op" id="6522191">(</span><span class="ident" id="6522192">g</span><span class="op" id="6522193">.</span><span class="ident" id="6522194">keystream</span><span class="op" id="6522203">)</span><span class="op" id="6522204">;</span>&nbsp;<span class="ident" id="6522206">size</span><span class="op" id="6522210">++</span>&nbsp;<span class="op" id="6522213">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522218">c</span><span class="op" id="6522219">,</span>&nbsp;<span class="ident" id="6522221">err</span>&nbsp;<span class="op" id="6522225">:=</span>&nbsp;<span class="ident" id="6522228">NewCipher</span><span class="op" id="6522237">(</span><span class="ident" id="6522238">g</span><span class="op" id="6522239">.</span><span class="ident" id="6522240">key</span><span class="op" id="6522243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6522248">if</span>&nbsp;<span class="ident" id="6522251">err</span>&nbsp;<span class="op" id="6522255">!=</span>&nbsp;<span class="ident" id="6522258">nil</span>&nbsp;<span class="op" id="6522262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522268">t</span><span class="op" id="6522269">.</span><span class="ident" id="6522270">Fatalf</span><span class="op" id="6522276">(</span><span class="string" id="6522277">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="6522297">,</span>&nbsp;<span class="ident" id="6522299">gi</span><span class="op" id="6522301">,</span>&nbsp;<span class="ident" id="6522303">err</span><span class="op" id="6522306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6522311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522317">off</span>&nbsp;<span class="op" id="6522321">:=</span>&nbsp;<span class="num" id="6522324">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6522329">for</span>&nbsp;<span class="ident" id="6522333">off</span>&nbsp;<span class="op" id="6522337">&lt;</span>&nbsp;<span class="builtinfunc" id="6522339">len</span><span class="op" id="6522342">(</span><span class="ident" id="6522343">g</span><span class="op" id="6522344">.</span><span class="ident" id="6522345">keystream</span><span class="op" id="6522354">)</span>&nbsp;<span class="op" id="6522356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522362">n</span>&nbsp;<span class="op" id="6522364">:=</span>&nbsp;<span class="builtinfunc" id="6522367">len</span><span class="op" id="6522370">(</span><span class="ident" id="6522371">g</span><span class="op" id="6522372">.</span><span class="ident" id="6522373">keystream</span><span class="op" id="6522382">)</span>&nbsp;<span class="op" id="6522384">-</span>&nbsp;<span class="ident" id="6522386">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6522394">if</span>&nbsp;<span class="ident" id="6522397">n</span>&nbsp;<span class="op" id="6522399">&gt;</span>&nbsp;<span class="ident" id="6522401">size</span>&nbsp;<span class="op" id="6522406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522413">n</span>&nbsp;<span class="op" id="6522415">=</span>&nbsp;<span class="ident" id="6522417">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6522426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522432">desc</span>&nbsp;<span class="op" id="6522437">:=</span>&nbsp;<span class="ident" id="6522440">fmt</span><span class="op" id="6522443">.</span><span class="ident" id="6522444">Sprintf</span><span class="op" id="6522451">(</span><span class="string" id="6522452">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="6522465">,</span>&nbsp;<span class="ident" id="6522467">gi</span><span class="op" id="6522469">,</span>&nbsp;<span class="ident" id="6522471">off</span><span class="op" id="6522474">,</span>&nbsp;<span class="ident" id="6522476">off</span><span class="op" id="6522479">+</span><span class="ident" id="6522480">n</span><span class="op" id="6522481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522487">testEncrypt</span><span class="op" id="6522498">(</span><span class="ident" id="6522499">t</span><span class="op" id="6522500">,</span>&nbsp;<span class="ident" id="6522502">desc</span><span class="op" id="6522506">,</span>&nbsp;<span class="ident" id="6522508">c</span><span class="op" id="6522509">,</span>&nbsp;<span class="ident" id="6522511">data</span><span class="op" id="6522515">[</span><span class="ident" id="6522516">off</span><span class="op" id="6522519">:</span><span class="ident" id="6522520">off</span><span class="op" id="6522523">+</span><span class="ident" id="6522524">n</span><span class="op" id="6522525">]</span><span class="op" id="6522526">,</span>&nbsp;<span class="ident" id="6522528">expect</span><span class="op" id="6522534">[</span><span class="ident" id="6522535">off</span><span class="op" id="6522538">:</span><span class="ident" id="6522539">off</span><span class="op" id="6522542">+</span><span class="ident" id="6522543">n</span><span class="op" id="6522544">]</span><span class="op" id="6522545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522551">off</span>&nbsp;<span class="op" id="6522555">+=</span>&nbsp;<span class="ident" id="6522558">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6522563">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6522567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6522570">}</span><br>
<span class="lineno"></span><span class="op" id="6522572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6522575">func</span>&nbsp;<span class="ident" id="6522580">TestBlock</span><span class="op" id="6522589">(</span><span class="ident" id="6522590">t</span>&nbsp;<span class="op" id="6522592">*</span><span class="ident" id="6522593">testing</span><span class="op" id="6522600">.</span><span class="ident" id="6522601">T</span><span class="op" id="6522602">)</span>&nbsp;<span class="op" id="6522604">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522607">testBlock</span><span class="op" id="6522616">(</span><span class="ident" id="6522617">t</span><span class="op" id="6522618">,</span>&nbsp;<span class="op" id="6522620">(</span><span class="op" id="6522621">*</span><span class="ident" id="6522622">Cipher</span><span class="op" id="6522628">)</span><span class="op" id="6522629">.</span><span class="ident" id="6522630">XORKeyStream</span><span class="op" id="6522642">)</span><br>
<span class="lineno"></span><span class="op" id="6522644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6522647">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="6522676">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="6522743">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="6522787">func</span>&nbsp;<span class="ident" id="6522792">TestBlockGeneric</span><span class="op" id="6522808">(</span><span class="ident" id="6522809">t</span>&nbsp;<span class="op" id="6522811">*</span><span class="ident" id="6522812">testing</span><span class="op" id="6522819">.</span><span class="ident" id="6522820">T</span><span class="op" id="6522821">)</span>&nbsp;<span class="op" id="6522823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522826">testBlock</span><span class="op" id="6522835">(</span><span class="ident" id="6522836">t</span><span class="op" id="6522837">,</span>&nbsp;<span class="op" id="6522839">(</span><span class="op" id="6522840">*</span><span class="ident" id="6522841">Cipher</span><span class="op" id="6522847">)</span><span class="op" id="6522848">.</span><span class="ident" id="6522849">xorKeyStreamGeneric</span><span class="op" id="6522868">)</span><br>
<span class="lineno"></span><span class="op" id="6522870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="6522873">func</span>&nbsp;<span class="ident" id="6522878">testBlock</span><span class="op" id="6522887">(</span><span class="ident" id="6522888">t</span>&nbsp;<span class="op" id="6522890">*</span><span class="ident" id="6522891">testing</span><span class="op" id="6522898">.</span><span class="ident" id="6522899">T</span><span class="op" id="6522900">,</span>&nbsp;<span class="ident" id="6522902">xor</span>&nbsp;<span class="keyword" id="6522906">func</span><span class="op" id="6522910">(</span><span class="ident" id="6522911">c</span>&nbsp;<span class="op" id="6522913">*</span><span class="ident" id="6522914">Cipher</span><span class="op" id="6522920">,</span>&nbsp;<span class="ident" id="6522922">dst</span><span class="op" id="6522925">,</span>&nbsp;<span class="ident" id="6522927">src</span>&nbsp;<span class="op" id="6522931">[</span><span class="op" id="6522932">]</span><span class="builtintype" id="6522933">byte</span><span class="op" id="6522937">)</span><span class="op" id="6522938">)</span>&nbsp;<span class="op" id="6522940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522943">c1a</span><span class="op" id="6522946">,</span>&nbsp;<span class="ident" id="6522948">_</span>&nbsp;<span class="op" id="6522950">:=</span>&nbsp;<span class="ident" id="6522953">NewCipher</span><span class="op" id="6522962">(</span><span class="ident" id="6522963">golden</span><span class="op" id="6522969">[</span><span class="num" id="6522970">0</span><span class="op" id="6522971">]</span><span class="op" id="6522972">.</span><span class="ident" id="6522973">key</span><span class="op" id="6522976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6522979">c1b</span><span class="op" id="6522982">,</span>&nbsp;<span class="ident" id="6522984">_</span>&nbsp;<span class="op" id="6522986">:=</span>&nbsp;<span class="ident" id="6522989">NewCipher</span><span class="op" id="6522998">(</span><span class="ident" id="6522999">golden</span><span class="op" id="6523005">[</span><span class="num" id="6523006">1</span><span class="op" id="6523007">]</span><span class="op" id="6523008">.</span><span class="ident" id="6523009">key</span><span class="op" id="6523012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523015">data1</span>&nbsp;<span class="op" id="6523021">:=</span>&nbsp;<span class="builtinfunc" id="6523024">make</span><span class="op" id="6523028">(</span><span class="op" id="6523029">[</span><span class="op" id="6523030">]</span><span class="builtintype" id="6523031">byte</span><span class="op" id="6523035">,</span>&nbsp;<span class="num" id="6523037">1</span><span class="op" id="6523038">&lt;&lt;</span><span class="num" id="6523040">20</span><span class="op" id="6523042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6523045">for</span>&nbsp;<span class="ident" id="6523049">i</span>&nbsp;<span class="op" id="6523051">:=</span>&nbsp;<span class="keyword" id="6523054">range</span>&nbsp;<span class="ident" id="6523060">data1</span>&nbsp;<span class="op" id="6523066">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523070">xor</span><span class="op" id="6523073">(</span><span class="ident" id="6523074">c1a</span><span class="op" id="6523077">,</span>&nbsp;<span class="ident" id="6523079">data1</span><span class="op" id="6523084">[</span><span class="ident" id="6523085">i</span><span class="op" id="6523086">:</span><span class="ident" id="6523087">i</span><span class="op" id="6523088">+</span><span class="num" id="6523089">1</span><span class="op" id="6523090">]</span><span class="op" id="6523091">,</span>&nbsp;<span class="ident" id="6523093">data1</span><span class="op" id="6523098">[</span><span class="ident" id="6523099">i</span><span class="op" id="6523100">:</span><span class="ident" id="6523101">i</span><span class="op" id="6523102">+</span><span class="num" id="6523103">1</span><span class="op" id="6523104">]</span><span class="op" id="6523105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523109">xor</span><span class="op" id="6523112">(</span><span class="ident" id="6523113">c1b</span><span class="op" id="6523116">,</span>&nbsp;<span class="ident" id="6523118">data1</span><span class="op" id="6523123">[</span><span class="ident" id="6523124">i</span><span class="op" id="6523125">:</span><span class="ident" id="6523126">i</span><span class="op" id="6523127">+</span><span class="num" id="6523128">1</span><span class="op" id="6523129">]</span><span class="op" id="6523130">,</span>&nbsp;<span class="ident" id="6523132">data1</span><span class="op" id="6523137">[</span><span class="ident" id="6523138">i</span><span class="op" id="6523139">:</span><span class="ident" id="6523140">i</span><span class="op" id="6523141">+</span><span class="num" id="6523142">1</span><span class="op" id="6523143">]</span><span class="op" id="6523144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6523147">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523151">c2a</span><span class="op" id="6523154">,</span>&nbsp;<span class="ident" id="6523156">_</span>&nbsp;<span class="op" id="6523158">:=</span>&nbsp;<span class="ident" id="6523161">NewCipher</span><span class="op" id="6523170">(</span><span class="ident" id="6523171">golden</span><span class="op" id="6523177">[</span><span class="num" id="6523178">0</span><span class="op" id="6523179">]</span><span class="op" id="6523180">.</span><span class="ident" id="6523181">key</span><span class="op" id="6523184">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523187">c2b</span><span class="op" id="6523190">,</span>&nbsp;<span class="ident" id="6523192">_</span>&nbsp;<span class="op" id="6523194">:=</span>&nbsp;<span class="ident" id="6523197">NewCipher</span><span class="op" id="6523206">(</span><span class="ident" id="6523207">golden</span><span class="op" id="6523213">[</span><span class="num" id="6523214">1</span><span class="op" id="6523215">]</span><span class="op" id="6523216">.</span><span class="ident" id="6523217">key</span><span class="op" id="6523220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523223">data2</span>&nbsp;<span class="op" id="6523229">:=</span>&nbsp;<span class="builtinfunc" id="6523232">make</span><span class="op" id="6523236">(</span><span class="op" id="6523237">[</span><span class="op" id="6523238">]</span><span class="builtintype" id="6523239">byte</span><span class="op" id="6523243">,</span>&nbsp;<span class="num" id="6523245">1</span><span class="op" id="6523246">&lt;&lt;</span><span class="num" id="6523248">20</span><span class="op" id="6523250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523253">xor</span><span class="op" id="6523256">(</span><span class="ident" id="6523257">c2a</span><span class="op" id="6523260">,</span>&nbsp;<span class="ident" id="6523262">data2</span><span class="op" id="6523267">,</span>&nbsp;<span class="ident" id="6523269">data2</span><span class="op" id="6523274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523277">xor</span><span class="op" id="6523280">(</span><span class="ident" id="6523281">c2b</span><span class="op" id="6523284">,</span>&nbsp;<span class="ident" id="6523286">data2</span><span class="op" id="6523291">,</span>&nbsp;<span class="ident" id="6523293">data2</span><span class="op" id="6523298">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6523302">if</span>&nbsp;<span class="op" id="6523305">!</span><span class="ident" id="6523306">bytes</span><span class="op" id="6523311">.</span><span class="ident" id="6523312">Equal</span><span class="op" id="6523317">(</span><span class="ident" id="6523318">data1</span><span class="op" id="6523323">,</span>&nbsp;<span class="ident" id="6523325">data2</span><span class="op" id="6523330">)</span>&nbsp;<span class="op" id="6523332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523336">t</span><span class="op" id="6523337">.</span><span class="ident" id="6523338">Fatalf</span><span class="op" id="6523344">(</span><span class="string" id="6523345">&#34;bad&nbsp;block&#34;</span><span class="op" id="6523356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6523359">}</span><br>
<span class="lineno"></span><span class="op" id="6523361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="6523364">func</span>&nbsp;<span class="ident" id="6523369">benchmark</span><span class="op" id="6523378">(</span><span class="ident" id="6523379">b</span>&nbsp;<span class="op" id="6523381">*</span><span class="ident" id="6523382">testing</span><span class="op" id="6523389">.</span><span class="ident" id="6523390">B</span><span class="op" id="6523391">,</span>&nbsp;<span class="ident" id="6523393">size</span>&nbsp;<span class="ident" id="6523398">int64</span><span class="op" id="6523403">)</span>&nbsp;<span class="op" id="6523405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523408">buf</span>&nbsp;<span class="op" id="6523412">:=</span>&nbsp;<span class="builtinfunc" id="6523415">make</span><span class="op" id="6523419">(</span><span class="op" id="6523420">[</span><span class="op" id="6523421">]</span><span class="builtintype" id="6523422">byte</span><span class="op" id="6523426">,</span>&nbsp;<span class="ident" id="6523428">size</span><span class="op" id="6523432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523435">c</span><span class="op" id="6523436">,</span>&nbsp;<span class="ident" id="6523438">err</span>&nbsp;<span class="op" id="6523442">:=</span>&nbsp;<span class="ident" id="6523445">NewCipher</span><span class="op" id="6523454">(</span><span class="ident" id="6523455">golden</span><span class="op" id="6523461">[</span><span class="num" id="6523462">0</span><span class="op" id="6523463">]</span><span class="op" id="6523464">.</span><span class="ident" id="6523465">key</span><span class="op" id="6523468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6523471">if</span>&nbsp;<span class="ident" id="6523474">err</span>&nbsp;<span class="op" id="6523478">!=</span>&nbsp;<span class="ident" id="6523481">nil</span>&nbsp;<span class="op" id="6523485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6523489">panic</span><span class="op" id="6523494">(</span><span class="ident" id="6523495">err</span><span class="op" id="6523498">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6523501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523504">b</span><span class="op" id="6523505">.</span><span class="ident" id="6523506">SetBytes</span><span class="op" id="6523514">(</span><span class="ident" id="6523515">size</span><span class="op" id="6523519">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6523523">for</span>&nbsp;<span class="ident" id="6523527">i</span>&nbsp;<span class="op" id="6523529">:=</span>&nbsp;<span class="num" id="6523532">0</span><span class="op" id="6523533">;</span>&nbsp;<span class="ident" id="6523535">i</span>&nbsp;<span class="op" id="6523537">&lt;</span>&nbsp;<span class="ident" id="6523539">b</span><span class="op" id="6523540">.</span><span class="ident" id="6523541">N</span><span class="op" id="6523542">;</span>&nbsp;<span class="ident" id="6523544">i</span><span class="op" id="6523545">++</span>&nbsp;<span class="op" id="6523548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523552">c</span><span class="op" id="6523553">.</span><span class="ident" id="6523554">XORKeyStream</span><span class="op" id="6523566">(</span><span class="ident" id="6523567">buf</span><span class="op" id="6523570">,</span>&nbsp;<span class="ident" id="6523572">buf</span><span class="op" id="6523575">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6523578">}</span><br>
<span class="lineno"></span><span class="op" id="6523580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6523583">func</span>&nbsp;<span class="ident" id="6523588">BenchmarkRC4_128</span><span class="op" id="6523604">(</span><span class="ident" id="6523605">b</span>&nbsp;<span class="op" id="6523607">*</span><span class="ident" id="6523608">testing</span><span class="op" id="6523615">.</span><span class="ident" id="6523616">B</span><span class="op" id="6523617">)</span>&nbsp;<span class="op" id="6523619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523622">benchmark</span><span class="op" id="6523631">(</span><span class="ident" id="6523632">b</span><span class="op" id="6523633">,</span>&nbsp;<span class="num" id="6523635">128</span><span class="op" id="6523638">)</span><br>
<span class="lineno">165</span><span class="op" id="6523640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6523643">func</span>&nbsp;<span class="ident" id="6523648">BenchmarkRC4_1K</span><span class="op" id="6523663">(</span><span class="ident" id="6523664">b</span>&nbsp;<span class="op" id="6523666">*</span><span class="ident" id="6523667">testing</span><span class="op" id="6523674">.</span><span class="ident" id="6523675">B</span><span class="op" id="6523676">)</span>&nbsp;<span class="op" id="6523678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523681">benchmark</span><span class="op" id="6523690">(</span><span class="ident" id="6523691">b</span><span class="op" id="6523692">,</span>&nbsp;<span class="num" id="6523694">1024</span><span class="op" id="6523698">)</span><br>
<span class="lineno"></span><span class="op" id="6523700">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="6523703">func</span>&nbsp;<span class="ident" id="6523708">BenchmarkRC4_8K</span><span class="op" id="6523723">(</span><span class="ident" id="6523724">b</span>&nbsp;<span class="op" id="6523726">*</span><span class="ident" id="6523727">testing</span><span class="op" id="6523734">.</span><span class="ident" id="6523735">B</span><span class="op" id="6523736">)</span>&nbsp;<span class="op" id="6523738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6523741">benchmark</span><span class="op" id="6523750">(</span><span class="ident" id="6523751">b</span><span class="op" id="6523752">,</span>&nbsp;<span class="num" id="6523754">8096</span><span class="op" id="6523758">)</span><br>
<span class="lineno"></span><span class="op" id="6523760">}</span>
</div>
</body>
</html>
