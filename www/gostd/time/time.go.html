<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html" class="current">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2613894">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2613949">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2614003">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2614054">//&nbsp;Package&nbsp;time&nbsp;provides&nbsp;functionality&nbsp;for&nbsp;measuring&nbsp;and&nbsp;displaying&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2614128">//</span><br>
<span class="lineno"></span><span class="comment" id="2614131">//&nbsp;The&nbsp;calendrical&nbsp;calculations&nbsp;always&nbsp;assume&nbsp;a&nbsp;Gregorian&nbsp;calendar.</span><br>
<span class="lineno"></span><span class="keyword" id="2614199">package</span>&nbsp;<span class="ident" id="2614207">time</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2614213">import</span>&nbsp;<span class="string" id="2614220">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2614230">//&nbsp;A&nbsp;Time&nbsp;represents&nbsp;an&nbsp;instant&nbsp;in&nbsp;time&nbsp;with&nbsp;nanosecond&nbsp;precision.</span><br>
<span class="lineno"></span><span class="comment" id="2614297">//</span><br>
<span class="lineno"></span><span class="comment" id="2614300">//&nbsp;Programs&nbsp;using&nbsp;times&nbsp;should&nbsp;typically&nbsp;store&nbsp;and&nbsp;pass&nbsp;them&nbsp;as&nbsp;values,</span><br>
<span class="lineno">15</span><span class="comment" id="2614372">//&nbsp;not&nbsp;pointers.&nbsp;&nbsp;That&nbsp;is,&nbsp;time&nbsp;variables&nbsp;and&nbsp;struct&nbsp;fields&nbsp;should&nbsp;be&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2614445">//&nbsp;type&nbsp;time.Time,&nbsp;not&nbsp;*time.Time.&nbsp;&nbsp;A&nbsp;Time&nbsp;value&nbsp;can&nbsp;be&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2614509">//&nbsp;multiple&nbsp;goroutines&nbsp;simultaneously.</span><br>
<span class="lineno"></span><span class="comment" id="2614548">//</span><br>
<span class="lineno"></span><span class="comment" id="2614551">//&nbsp;Time&nbsp;instants&nbsp;can&nbsp;be&nbsp;compared&nbsp;using&nbsp;the&nbsp;Before,&nbsp;After,&nbsp;and&nbsp;Equal&nbsp;methods.</span><br>
<span class="lineno">20</span><span class="comment" id="2614628">//&nbsp;The&nbsp;Sub&nbsp;method&nbsp;subtracts&nbsp;two&nbsp;instants,&nbsp;producing&nbsp;a&nbsp;Duration.</span><br>
<span class="lineno"></span><span class="comment" id="2614692">//&nbsp;The&nbsp;Add&nbsp;method&nbsp;adds&nbsp;a&nbsp;Time&nbsp;and&nbsp;a&nbsp;Duration,&nbsp;producing&nbsp;a&nbsp;Time.</span><br>
<span class="lineno"></span><span class="comment" id="2614756">//</span><br>
<span class="lineno"></span><span class="comment" id="2614759">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;Time&nbsp;is&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00.000000000&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2614836">//&nbsp;As&nbsp;this&nbsp;time&nbsp;is&nbsp;unlikely&nbsp;to&nbsp;come&nbsp;up&nbsp;in&nbsp;practice,&nbsp;the&nbsp;IsZero&nbsp;method&nbsp;gives</span><br>
<span class="lineno">25</span><span class="comment" id="2614912">//&nbsp;a&nbsp;simple&nbsp;way&nbsp;of&nbsp;detecting&nbsp;a&nbsp;time&nbsp;that&nbsp;has&nbsp;not&nbsp;been&nbsp;initialized&nbsp;explicitly.</span><br>
<span class="lineno"></span><span class="comment" id="2614990">//</span><br>
<span class="lineno"></span><span class="comment" id="2614993">//&nbsp;Each&nbsp;Time&nbsp;has&nbsp;associated&nbsp;with&nbsp;it&nbsp;a&nbsp;Location,&nbsp;consulted&nbsp;when&nbsp;computing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2615070">//&nbsp;presentation&nbsp;form&nbsp;of&nbsp;the&nbsp;time,&nbsp;such&nbsp;as&nbsp;in&nbsp;the&nbsp;Format,&nbsp;Hour,&nbsp;and&nbsp;Year&nbsp;methods.</span><br>
<span class="lineno"></span><span class="comment" id="2615151">//&nbsp;The&nbsp;methods&nbsp;Local,&nbsp;UTC,&nbsp;and&nbsp;In&nbsp;return&nbsp;a&nbsp;Time&nbsp;with&nbsp;a&nbsp;specific&nbsp;location.</span><br>
<span class="lineno">30</span><span class="comment" id="2615225">//&nbsp;Changing&nbsp;the&nbsp;location&nbsp;in&nbsp;this&nbsp;way&nbsp;changes&nbsp;only&nbsp;the&nbsp;presentation;&nbsp;it&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="2615305">//&nbsp;change&nbsp;the&nbsp;instant&nbsp;in&nbsp;time&nbsp;being&nbsp;denoted&nbsp;and&nbsp;therefore&nbsp;does&nbsp;not&nbsp;affect&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2615383">//&nbsp;computations&nbsp;described&nbsp;in&nbsp;earlier&nbsp;paragraphs.</span><br>
<span class="lineno"></span><span class="comment" id="2615432">//</span><br>
<span class="lineno"></span><span class="comment" id="2615435">//&nbsp;Note&nbsp;that&nbsp;the&nbsp;Go&nbsp;==&nbsp;operator&nbsp;compares&nbsp;not&nbsp;just&nbsp;the&nbsp;time&nbsp;instant&nbsp;but&nbsp;also&nbsp;the</span><br>
<span class="lineno">35</span><span class="comment" id="2615515">//&nbsp;Location.&nbsp;Therefore,&nbsp;Time&nbsp;values&nbsp;should&nbsp;not&nbsp;be&nbsp;used&nbsp;as&nbsp;map&nbsp;or&nbsp;database&nbsp;keys</span><br>
<span class="lineno"></span><span class="comment" id="2615594">//&nbsp;without&nbsp;first&nbsp;guaranteeing&nbsp;that&nbsp;the&nbsp;identical&nbsp;Location&nbsp;has&nbsp;been&nbsp;set&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2615673">//&nbsp;values,&nbsp;which&nbsp;can&nbsp;be&nbsp;achieved&nbsp;through&nbsp;use&nbsp;of&nbsp;the&nbsp;UTC&nbsp;or&nbsp;Local&nbsp;method.</span><br>
<span class="lineno"></span><span class="comment" id="2615746">//</span><br>
<span class="lineno"></span><span class="keyword" id="2615749">type</span>&nbsp;<span class="ident" id="2615754">Time</span>&nbsp;<span class="keyword" id="2615759">struct</span>&nbsp;<span class="op" id="2615766">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2615769">//&nbsp;sec&nbsp;gives&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;elapsed&nbsp;since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2615819">//&nbsp;January&nbsp;1,&nbsp;year&nbsp;1&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2615855">sec</span>&nbsp;<span class="ident" id="2615859">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2615867">//&nbsp;nsec&nbsp;specifies&nbsp;a&nbsp;non-negative&nbsp;nanosecond</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2615912">//&nbsp;offset&nbsp;within&nbsp;the&nbsp;second&nbsp;named&nbsp;by&nbsp;Seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2615959">//&nbsp;It&nbsp;must&nbsp;be&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2616003">nsec</span>&nbsp;<span class="builtintype" id="2616008">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2616016">//&nbsp;loc&nbsp;specifies&nbsp;the&nbsp;Location&nbsp;that&nbsp;should&nbsp;be&nbsp;used&nbsp;to</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2616070">//&nbsp;determine&nbsp;the&nbsp;minute,&nbsp;hour,&nbsp;month,&nbsp;day,&nbsp;and&nbsp;year</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2616123">//&nbsp;that&nbsp;correspond&nbsp;to&nbsp;this&nbsp;Time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2616157">//&nbsp;Only&nbsp;the&nbsp;zero&nbsp;Time&nbsp;has&nbsp;a&nbsp;nil&nbsp;Location.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2616200">//&nbsp;In&nbsp;that&nbsp;case&nbsp;it&nbsp;is&nbsp;interpreted&nbsp;to&nbsp;mean&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2616248">loc</span>&nbsp;<span class="op" id="2616252">*</span><span class="ident" id="2616253">Location</span><br>
<span class="lineno">55</span><span class="op" id="2616262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2616265">//&nbsp;After&nbsp;reports&nbsp;whether&nbsp;the&nbsp;time&nbsp;instant&nbsp;t&nbsp;is&nbsp;after&nbsp;u.</span><br>
<span class="lineno"></span><span class="keyword" id="2616321">func</span>&nbsp;<span class="op" id="2616326">(</span><span class="ident" id="2616327">t</span>&nbsp;<span class="ident" id="2616329">Time</span><span class="op" id="2616333">)</span>&nbsp;<span class="ident" id="2616335">After</span><span class="op" id="2616340">(</span><span class="ident" id="2616341">u</span>&nbsp;<span class="ident" id="2616343">Time</span><span class="op" id="2616347">)</span>&nbsp;<span class="builtintype" id="2616349">bool</span>&nbsp;<span class="op" id="2616354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2616357">return</span>&nbsp;<span class="ident" id="2616364">t</span><span class="op" id="2616365">.</span><span class="ident" id="2616366">sec</span>&nbsp;<span class="op" id="2616370">&gt;</span>&nbsp;<span class="ident" id="2616372">u</span><span class="op" id="2616373">.</span><span class="ident" id="2616374">sec</span>&nbsp;<span class="op" id="2616378">||</span>&nbsp;<span class="ident" id="2616381">t</span><span class="op" id="2616382">.</span><span class="ident" id="2616383">sec</span>&nbsp;<span class="op" id="2616387">==</span>&nbsp;<span class="ident" id="2616390">u</span><span class="op" id="2616391">.</span><span class="ident" id="2616392">sec</span>&nbsp;<span class="op" id="2616396">&amp;&amp;</span>&nbsp;<span class="ident" id="2616399">t</span><span class="op" id="2616400">.</span><span class="ident" id="2616401">nsec</span>&nbsp;<span class="op" id="2616406">&gt;</span>&nbsp;<span class="ident" id="2616408">u</span><span class="op" id="2616409">.</span><span class="ident" id="2616410">nsec</span><br>
<span class="lineno">60</span><span class="op" id="2616415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2616418">//&nbsp;Before&nbsp;reports&nbsp;whether&nbsp;the&nbsp;time&nbsp;instant&nbsp;t&nbsp;is&nbsp;before&nbsp;u.</span><br>
<span class="lineno"></span><span class="keyword" id="2616476">func</span>&nbsp;<span class="op" id="2616481">(</span><span class="ident" id="2616482">t</span>&nbsp;<span class="ident" id="2616484">Time</span><span class="op" id="2616488">)</span>&nbsp;<span class="ident" id="2616490">Before</span><span class="op" id="2616496">(</span><span class="ident" id="2616497">u</span>&nbsp;<span class="ident" id="2616499">Time</span><span class="op" id="2616503">)</span>&nbsp;<span class="builtintype" id="2616505">bool</span>&nbsp;<span class="op" id="2616510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2616513">return</span>&nbsp;<span class="ident" id="2616520">t</span><span class="op" id="2616521">.</span><span class="ident" id="2616522">sec</span>&nbsp;<span class="op" id="2616526">&lt;</span>&nbsp;<span class="ident" id="2616528">u</span><span class="op" id="2616529">.</span><span class="ident" id="2616530">sec</span>&nbsp;<span class="op" id="2616534">||</span>&nbsp;<span class="ident" id="2616537">t</span><span class="op" id="2616538">.</span><span class="ident" id="2616539">sec</span>&nbsp;<span class="op" id="2616543">==</span>&nbsp;<span class="ident" id="2616546">u</span><span class="op" id="2616547">.</span><span class="ident" id="2616548">sec</span>&nbsp;<span class="op" id="2616552">&amp;&amp;</span>&nbsp;<span class="ident" id="2616555">t</span><span class="op" id="2616556">.</span><span class="ident" id="2616557">nsec</span>&nbsp;<span class="op" id="2616562">&lt;</span>&nbsp;<span class="ident" id="2616564">u</span><span class="op" id="2616565">.</span><span class="ident" id="2616566">nsec</span><br>
<span class="lineno">65</span><span class="op" id="2616571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2616574">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;t&nbsp;and&nbsp;u&nbsp;represent&nbsp;the&nbsp;same&nbsp;time&nbsp;instant.</span><br>
<span class="lineno"></span><span class="comment" id="2616640">//&nbsp;Two&nbsp;times&nbsp;can&nbsp;be&nbsp;equal&nbsp;even&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;different&nbsp;locations.</span><br>
<span class="lineno"></span><span class="comment" id="2616707">//&nbsp;For&nbsp;example,&nbsp;6:00&nbsp;+0200&nbsp;CEST&nbsp;and&nbsp;4:00&nbsp;UTC&nbsp;are&nbsp;Equal.</span><br>
<span class="lineno">70</span><span class="comment" id="2616763">//&nbsp;This&nbsp;comparison&nbsp;is&nbsp;different&nbsp;from&nbsp;using&nbsp;t&nbsp;==&nbsp;u,&nbsp;which&nbsp;also&nbsp;compares</span><br>
<span class="lineno"></span><span class="comment" id="2616834">//&nbsp;the&nbsp;locations.</span><br>
<span class="lineno"></span><span class="keyword" id="2616852">func</span>&nbsp;<span class="op" id="2616857">(</span><span class="ident" id="2616858">t</span>&nbsp;<span class="ident" id="2616860">Time</span><span class="op" id="2616864">)</span>&nbsp;<span class="ident" id="2616866">Equal</span><span class="op" id="2616871">(</span><span class="ident" id="2616872">u</span>&nbsp;<span class="ident" id="2616874">Time</span><span class="op" id="2616878">)</span>&nbsp;<span class="builtintype" id="2616880">bool</span>&nbsp;<span class="op" id="2616885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2616888">return</span>&nbsp;<span class="ident" id="2616895">t</span><span class="op" id="2616896">.</span><span class="ident" id="2616897">sec</span>&nbsp;<span class="op" id="2616901">==</span>&nbsp;<span class="ident" id="2616904">u</span><span class="op" id="2616905">.</span><span class="ident" id="2616906">sec</span>&nbsp;<span class="op" id="2616910">&amp;&amp;</span>&nbsp;<span class="ident" id="2616913">t</span><span class="op" id="2616914">.</span><span class="ident" id="2616915">nsec</span>&nbsp;<span class="op" id="2616920">==</span>&nbsp;<span class="ident" id="2616923">u</span><span class="op" id="2616924">.</span><span class="ident" id="2616925">nsec</span><br>
<span class="lineno"></span><span class="op" id="2616930">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="2616933">//&nbsp;A&nbsp;Month&nbsp;specifies&nbsp;a&nbsp;month&nbsp;of&nbsp;the&nbsp;year&nbsp;(January&nbsp;=&nbsp;1,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2616994">type</span>&nbsp;<span class="ident" id="2616999">Month</span>&nbsp;<span class="builtintype" id="2617005">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2617010">const</span>&nbsp;<span class="op" id="2617016">(</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617019">January</span>&nbsp;<span class="ident" id="2617027">Month</span>&nbsp;<span class="op" id="2617033">=</span>&nbsp;<span class="num" id="2617035">1</span>&nbsp;<span class="op" id="2617037">+</span>&nbsp;<span class="ident" id="2617039">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617045">February</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617055">March</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617062">April</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617069">May</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617074">June</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617080">July</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617086">August</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617094">September</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617105">October</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617114">November</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617124">December</span><br>
<span class="lineno"></span><span class="op" id="2617133">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2617136">var</span>&nbsp;<span class="ident" id="2617140">months</span>&nbsp;<span class="op" id="2617147">=</span>&nbsp;<span class="op" id="2617149">[</span><span class="op" id="2617150">...</span><span class="op" id="2617153">]</span><span class="builtintype" id="2617154">string</span><span class="op" id="2617160">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617163">&#34;January&#34;</span><span class="op" id="2617172">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617175">&#34;February&#34;</span><span class="op" id="2617185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617188">&#34;March&#34;</span><span class="op" id="2617195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617198">&#34;April&#34;</span><span class="op" id="2617205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617208">&#34;May&#34;</span><span class="op" id="2617213">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617216">&#34;June&#34;</span><span class="op" id="2617222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617225">&#34;July&#34;</span><span class="op" id="2617231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617234">&#34;August&#34;</span><span class="op" id="2617242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617245">&#34;September&#34;</span><span class="op" id="2617256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617259">&#34;October&#34;</span><span class="op" id="2617268">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617271">&#34;November&#34;</span><span class="op" id="2617281">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617284">&#34;December&#34;</span><span class="op" id="2617294">,</span><br>
<span class="lineno"></span><span class="op" id="2617296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2617299">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;English&nbsp;name&nbsp;of&nbsp;the&nbsp;month&nbsp;(&#34;January&#34;,&nbsp;&#34;February&#34;,&nbsp;...).</span><br>
<span class="lineno">110</span><span class="keyword" id="2617377">func</span>&nbsp;<span class="op" id="2617382">(</span><span class="ident" id="2617383">m</span>&nbsp;<span class="ident" id="2617385">Month</span><span class="op" id="2617390">)</span>&nbsp;<span class="ident" id="2617392">String</span><span class="op" id="2617398">(</span><span class="op" id="2617399">)</span>&nbsp;<span class="builtintype" id="2617401">string</span>&nbsp;<span class="op" id="2617408">{</span>&nbsp;<span class="keyword" id="2617410">return</span>&nbsp;<span class="ident" id="2617417">months</span><span class="op" id="2617423">[</span><span class="ident" id="2617424">m</span><span class="op" id="2617425">-</span><span class="num" id="2617426">1</span><span class="op" id="2617427">]</span>&nbsp;<span class="op" id="2617429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2617432">//&nbsp;A&nbsp;Weekday&nbsp;specifies&nbsp;a&nbsp;day&nbsp;of&nbsp;the&nbsp;week&nbsp;(Sunday&nbsp;=&nbsp;0,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2617492">type</span>&nbsp;<span class="ident" id="2617497">Weekday</span>&nbsp;<span class="builtintype" id="2617505">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="2617510">const</span>&nbsp;<span class="op" id="2617516">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617519">Sunday</span>&nbsp;<span class="ident" id="2617526">Weekday</span>&nbsp;<span class="op" id="2617534">=</span>&nbsp;<span class="ident" id="2617536">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617542">Monday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617550">Tuesday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617559">Wednesday</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617570">Thursday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617580">Friday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2617588">Saturday</span><br>
<span class="lineno"></span><span class="op" id="2617597">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2617600">var</span>&nbsp;<span class="ident" id="2617604">days</span>&nbsp;<span class="op" id="2617609">=</span>&nbsp;<span class="op" id="2617611">[</span><span class="op" id="2617612">...</span><span class="op" id="2617615">]</span><span class="builtintype" id="2617616">string</span><span class="op" id="2617622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617625">&#34;Sunday&#34;</span><span class="op" id="2617633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617636">&#34;Monday&#34;</span><span class="op" id="2617644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617647">&#34;Tuesday&#34;</span><span class="op" id="2617656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617659">&#34;Wednesday&#34;</span><span class="op" id="2617670">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617673">&#34;Thursday&#34;</span><span class="op" id="2617683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617686">&#34;Friday&#34;</span><span class="op" id="2617694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2617697">&#34;Saturday&#34;</span><span class="op" id="2617707">,</span><br>
<span class="lineno"></span><span class="op" id="2617709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="2617712">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;English&nbsp;name&nbsp;of&nbsp;the&nbsp;day&nbsp;(&#34;Sunday&#34;,&nbsp;&#34;Monday&#34;,&nbsp;...).</span><br>
<span class="lineno"></span><span class="keyword" id="2617785">func</span>&nbsp;<span class="op" id="2617790">(</span><span class="ident" id="2617791">d</span>&nbsp;<span class="ident" id="2617793">Weekday</span><span class="op" id="2617800">)</span>&nbsp;<span class="ident" id="2617802">String</span><span class="op" id="2617808">(</span><span class="op" id="2617809">)</span>&nbsp;<span class="builtintype" id="2617811">string</span>&nbsp;<span class="op" id="2617818">{</span>&nbsp;<span class="keyword" id="2617820">return</span>&nbsp;<span class="ident" id="2617827">days</span><span class="op" id="2617831">[</span><span class="ident" id="2617832">d</span><span class="op" id="2617833">]</span>&nbsp;<span class="op" id="2617835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2617838">//&nbsp;Computations&nbsp;on&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="2617863">//</span><br>
<span class="lineno">140</span><span class="comment" id="2617866">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Time&nbsp;is&nbsp;defined&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="2617912">//&nbsp;&nbsp;&nbsp;&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00.000000000&nbsp;UTC</span><br>
<span class="lineno"></span><span class="comment" id="2617957">//&nbsp;which&nbsp;(1)&nbsp;looks&nbsp;like&nbsp;a&nbsp;zero,&nbsp;or&nbsp;as&nbsp;close&nbsp;as&nbsp;you&nbsp;can&nbsp;get&nbsp;in&nbsp;a&nbsp;date</span><br>
<span class="lineno"></span><span class="comment" id="2618026">//&nbsp;(1-1-1&nbsp;00:00:00&nbsp;UTC),&nbsp;(2)&nbsp;is&nbsp;unlikely&nbsp;enough&nbsp;to&nbsp;arise&nbsp;in&nbsp;practice&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2618098">//&nbsp;be&nbsp;a&nbsp;suitable&nbsp;&#34;not&nbsp;set&#34;&nbsp;sentinel,&nbsp;unlike&nbsp;Jan&nbsp;1&nbsp;1970,&nbsp;and&nbsp;(3)&nbsp;has&nbsp;a</span><br>
<span class="lineno">145</span><span class="comment" id="2618168">//&nbsp;non-negative&nbsp;year&nbsp;even&nbsp;in&nbsp;time&nbsp;zones&nbsp;west&nbsp;of&nbsp;UTC,&nbsp;unlike&nbsp;1-1-0</span><br>
<span class="lineno"></span><span class="comment" id="2618234">//&nbsp;00:00:00&nbsp;UTC,&nbsp;which&nbsp;would&nbsp;be&nbsp;12-31-(-1)&nbsp;19:00:00&nbsp;in&nbsp;New&nbsp;York.</span><br>
<span class="lineno"></span><span class="comment" id="2618299">//</span><br>
<span class="lineno"></span><span class="comment" id="2618302">//&nbsp;The&nbsp;zero&nbsp;Time&nbsp;value&nbsp;does&nbsp;not&nbsp;force&nbsp;a&nbsp;specific&nbsp;epoch&nbsp;for&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2618370">//&nbsp;representation.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;use&nbsp;the&nbsp;Unix&nbsp;epoch&nbsp;internally,&nbsp;we</span><br>
<span class="lineno">150</span><span class="comment" id="2618440">//&nbsp;could&nbsp;define&nbsp;that&nbsp;to&nbsp;distinguish&nbsp;a&nbsp;zero&nbsp;value&nbsp;from&nbsp;Jan&nbsp;1&nbsp;1970,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2618511">//&nbsp;time&nbsp;would&nbsp;be&nbsp;represented&nbsp;by&nbsp;sec=-1,&nbsp;nsec=1e9.&nbsp;&nbsp;However,&nbsp;it&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="2618579">//&nbsp;suggest&nbsp;a&nbsp;representation,&nbsp;namely&nbsp;using&nbsp;1-1-1&nbsp;00:00:00&nbsp;UTC&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2618647">//&nbsp;epoch,&nbsp;and&nbsp;that&#39;s&nbsp;what&nbsp;we&nbsp;do.</span><br>
<span class="lineno"></span><span class="comment" id="2618680">//</span><br>
<span class="lineno">155</span><span class="comment" id="2618683">//&nbsp;The&nbsp;Add&nbsp;and&nbsp;Sub&nbsp;computations&nbsp;are&nbsp;oblivious&nbsp;to&nbsp;the&nbsp;choice&nbsp;of&nbsp;epoch.</span><br>
<span class="lineno"></span><span class="comment" id="2618753">//</span><br>
<span class="lineno"></span><span class="comment" id="2618756">//&nbsp;The&nbsp;presentation&nbsp;computations&nbsp;-&nbsp;year,&nbsp;month,&nbsp;minute,&nbsp;and&nbsp;so&nbsp;on&nbsp;-&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2618828">//&nbsp;rely&nbsp;heavily&nbsp;on&nbsp;division&nbsp;and&nbsp;modulus&nbsp;by&nbsp;positive&nbsp;constants.&nbsp;&nbsp;For</span><br>
<span class="lineno"></span><span class="comment" id="2618896">//&nbsp;calendrical&nbsp;calculations&nbsp;we&nbsp;want&nbsp;these&nbsp;divisions&nbsp;to&nbsp;round&nbsp;down,&nbsp;even</span><br>
<span class="lineno">160</span><span class="comment" id="2618968">//&nbsp;for&nbsp;negative&nbsp;values,&nbsp;so&nbsp;that&nbsp;the&nbsp;remainder&nbsp;is&nbsp;always&nbsp;positive,&nbsp;but</span><br>
<span class="lineno"></span><span class="comment" id="2619038">//&nbsp;Go&#39;s&nbsp;division&nbsp;(like&nbsp;most&nbsp;hardware&nbsp;division&nbsp;instructions)&nbsp;rounds&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2619108">//&nbsp;zero.&nbsp;&nbsp;We&nbsp;can&nbsp;still&nbsp;do&nbsp;those&nbsp;computations&nbsp;and&nbsp;then&nbsp;adjust&nbsp;the&nbsp;result</span><br>
<span class="lineno"></span><span class="comment" id="2619180">//&nbsp;for&nbsp;a&nbsp;negative&nbsp;numerator,&nbsp;but&nbsp;it&#39;s&nbsp;annoying&nbsp;to&nbsp;write&nbsp;the&nbsp;adjustment</span><br>
<span class="lineno"></span><span class="comment" id="2619251">//&nbsp;over&nbsp;and&nbsp;over.&nbsp;&nbsp;Instead,&nbsp;we&nbsp;can&nbsp;change&nbsp;to&nbsp;a&nbsp;different&nbsp;epoch&nbsp;so&nbsp;long</span><br>
<span class="lineno">165</span><span class="comment" id="2619322">//&nbsp;ago&nbsp;that&nbsp;all&nbsp;the&nbsp;times&nbsp;we&nbsp;care&nbsp;about&nbsp;will&nbsp;be&nbsp;positive,&nbsp;and&nbsp;then&nbsp;round</span><br>
<span class="lineno"></span><span class="comment" id="2619395">//&nbsp;to&nbsp;zero&nbsp;and&nbsp;round&nbsp;down&nbsp;coincide.&nbsp;&nbsp;These&nbsp;presentation&nbsp;routines&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="2619468">//&nbsp;have&nbsp;to&nbsp;add&nbsp;the&nbsp;zone&nbsp;offset,&nbsp;so&nbsp;adding&nbsp;the&nbsp;translation&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2619533">//&nbsp;alternate&nbsp;epoch&nbsp;is&nbsp;cheap.&nbsp;&nbsp;For&nbsp;example,&nbsp;having&nbsp;a&nbsp;non-negative&nbsp;time&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="2619605">//&nbsp;means&nbsp;that&nbsp;we&nbsp;can&nbsp;write</span><br>
<span class="lineno">170</span><span class="comment" id="2619632">//</span><br>
<span class="lineno"></span><span class="comment" id="2619635">//&nbsp;&nbsp;&nbsp;&nbsp;sec&nbsp;=&nbsp;t&nbsp;%&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2619651">//</span><br>
<span class="lineno"></span><span class="comment" id="2619654">//&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="2619668">//</span><br>
<span class="lineno">175</span><span class="comment" id="2619671">//&nbsp;&nbsp;&nbsp;&nbsp;sec&nbsp;=&nbsp;t&nbsp;%&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2619687">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sec&nbsp;&lt;&nbsp;0&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="2619703">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sec&nbsp;+=&nbsp;60</span><br>
<span class="lineno"></span><span class="comment" id="2619717">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="2619722">//</span><br>
<span class="lineno">180</span><span class="comment" id="2619725">//&nbsp;everywhere.</span><br>
<span class="lineno"></span><span class="comment" id="2619740">//</span><br>
<span class="lineno"></span><span class="comment" id="2619743">//&nbsp;The&nbsp;calendar&nbsp;runs&nbsp;on&nbsp;an&nbsp;exact&nbsp;400&nbsp;year&nbsp;cycle:&nbsp;a&nbsp;400-year&nbsp;calendar</span><br>
<span class="lineno"></span><span class="comment" id="2619812">//&nbsp;printed&nbsp;for&nbsp;1970-2469&nbsp;will&nbsp;apply&nbsp;as&nbsp;well&nbsp;to&nbsp;2470-2869.&nbsp;&nbsp;Even&nbsp;the&nbsp;days</span><br>
<span class="lineno"></span><span class="comment" id="2619885">//&nbsp;of&nbsp;the&nbsp;week&nbsp;match&nbsp;up.&nbsp;&nbsp;It&nbsp;simplifies&nbsp;the&nbsp;computations&nbsp;to&nbsp;choose&nbsp;the</span><br>
<span class="lineno">185</span><span class="comment" id="2619956">//&nbsp;cycle&nbsp;boundaries&nbsp;so&nbsp;that&nbsp;the&nbsp;exceptional&nbsp;years&nbsp;are&nbsp;always&nbsp;delayed&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="2620028">//&nbsp;long&nbsp;as&nbsp;possible.&nbsp;&nbsp;That&nbsp;means&nbsp;choosing&nbsp;a&nbsp;year&nbsp;equal&nbsp;to&nbsp;1&nbsp;mod&nbsp;400,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="2620100">//&nbsp;that&nbsp;the&nbsp;first&nbsp;leap&nbsp;year&nbsp;is&nbsp;the&nbsp;4th&nbsp;year,&nbsp;the&nbsp;first&nbsp;missed&nbsp;leap&nbsp;year</span><br>
<span class="lineno"></span><span class="comment" id="2620172">//&nbsp;is&nbsp;the&nbsp;100th&nbsp;year,&nbsp;and&nbsp;the&nbsp;missed&nbsp;missed&nbsp;leap&nbsp;year&nbsp;is&nbsp;the&nbsp;400th&nbsp;year.</span><br>
<span class="lineno"></span><span class="comment" id="2620245">//&nbsp;So&nbsp;we&#39;d&nbsp;prefer&nbsp;instead&nbsp;to&nbsp;print&nbsp;a&nbsp;calendar&nbsp;for&nbsp;2001-2400&nbsp;and&nbsp;reuse&nbsp;it</span><br>
<span class="lineno">190</span><span class="comment" id="2620318">//&nbsp;for&nbsp;2401-2800.</span><br>
<span class="lineno"></span><span class="comment" id="2620336">//</span><br>
<span class="lineno"></span><span class="comment" id="2620339">//&nbsp;Finally,&nbsp;it&#39;s&nbsp;convenient&nbsp;if&nbsp;the&nbsp;delta&nbsp;between&nbsp;the&nbsp;Unix&nbsp;epoch&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2620407">//&nbsp;long-ago&nbsp;epoch&nbsp;is&nbsp;representable&nbsp;by&nbsp;an&nbsp;int64&nbsp;constant.</span><br>
<span class="lineno"></span><span class="comment" id="2620464">//</span><br>
<span class="lineno">195</span><span class="comment" id="2620467">//&nbsp;These&nbsp;three&nbsp;considerations—choose&nbsp;an&nbsp;epoch&nbsp;as&nbsp;early&nbsp;as&nbsp;possible,&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2620542">//&nbsp;uses&nbsp;a&nbsp;year&nbsp;equal&nbsp;to&nbsp;1&nbsp;mod&nbsp;400,&nbsp;and&nbsp;that&nbsp;is&nbsp;no&nbsp;more&nbsp;than&nbsp;2⁶³&nbsp;seconds</span><br>
<span class="lineno"></span><span class="comment" id="2620617">//&nbsp;earlier&nbsp;than&nbsp;1970—bring&nbsp;us&nbsp;to&nbsp;the&nbsp;year&nbsp;-292277022399.&nbsp;&nbsp;We&nbsp;refer&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2620689">//&nbsp;this&nbsp;year&nbsp;as&nbsp;the&nbsp;absolute&nbsp;zero&nbsp;year,&nbsp;and&nbsp;to&nbsp;times&nbsp;measured&nbsp;as&nbsp;a&nbsp;uint64</span><br>
<span class="lineno"></span><span class="comment" id="2620763">//&nbsp;seconds&nbsp;since&nbsp;this&nbsp;year&nbsp;as&nbsp;absolute&nbsp;times.</span><br>
<span class="lineno">200</span><span class="comment" id="2620809">//</span><br>
<span class="lineno"></span><span class="comment" id="2620812">//&nbsp;Times&nbsp;measured&nbsp;as&nbsp;an&nbsp;int64&nbsp;seconds&nbsp;since&nbsp;the&nbsp;year&nbsp;1—the&nbsp;representation</span><br>
<span class="lineno"></span><span class="comment" id="2620888">//&nbsp;used&nbsp;for&nbsp;Time&#39;s&nbsp;sec&nbsp;field—are&nbsp;called&nbsp;internal&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2620946">//</span><br>
<span class="lineno"></span><span class="comment" id="2620949">//&nbsp;Times&nbsp;measured&nbsp;as&nbsp;an&nbsp;int64&nbsp;seconds&nbsp;since&nbsp;the&nbsp;year&nbsp;1970&nbsp;are&nbsp;called&nbsp;Unix</span><br>
<span class="lineno">205</span><span class="comment" id="2621023">//&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2621033">//</span><br>
<span class="lineno"></span><span class="comment" id="2621036">//&nbsp;It&nbsp;is&nbsp;tempting&nbsp;to&nbsp;just&nbsp;use&nbsp;the&nbsp;year&nbsp;1&nbsp;as&nbsp;the&nbsp;absolute&nbsp;epoch,&nbsp;defining</span><br>
<span class="lineno"></span><span class="comment" id="2621109">//&nbsp;that&nbsp;the&nbsp;routines&nbsp;are&nbsp;only&nbsp;valid&nbsp;for&nbsp;years&nbsp;&gt;=&nbsp;1.&nbsp;&nbsp;However,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2621175">//&nbsp;routines&nbsp;would&nbsp;then&nbsp;be&nbsp;invalid&nbsp;when&nbsp;displaying&nbsp;the&nbsp;epoch&nbsp;in&nbsp;time&nbsp;zones</span><br>
<span class="lineno">210</span><span class="comment" id="2621249">//&nbsp;west&nbsp;of&nbsp;UTC,&nbsp;since&nbsp;it&nbsp;is&nbsp;year&nbsp;0.&nbsp;&nbsp;It&nbsp;doesn&#39;t&nbsp;seem&nbsp;tenable&nbsp;to&nbsp;say&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2621322">//&nbsp;printing&nbsp;the&nbsp;zero&nbsp;time&nbsp;correctly&nbsp;isn&#39;t&nbsp;supported&nbsp;in&nbsp;half&nbsp;the&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2621391">//&nbsp;zones.&nbsp;&nbsp;By&nbsp;comparison,&nbsp;it&#39;s&nbsp;reasonable&nbsp;to&nbsp;mishandle&nbsp;some&nbsp;times&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2621460">//&nbsp;the&nbsp;year&nbsp;-292277022399.</span><br>
<span class="lineno"></span><span class="comment" id="2621487">//</span><br>
<span class="lineno">215</span><span class="comment" id="2621490">//&nbsp;All&nbsp;this&nbsp;is&nbsp;opaque&nbsp;to&nbsp;clients&nbsp;of&nbsp;the&nbsp;API&nbsp;and&nbsp;can&nbsp;be&nbsp;changed&nbsp;if&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="2621558">//&nbsp;better&nbsp;implementation&nbsp;presents&nbsp;itself.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2621601">const</span>&nbsp;<span class="op" id="2621607">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2621610">//&nbsp;The&nbsp;unsigned&nbsp;zero&nbsp;year&nbsp;for&nbsp;internal&nbsp;calculations.</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2621664">//&nbsp;Must&nbsp;be&nbsp;1&nbsp;mod&nbsp;400,&nbsp;and&nbsp;times&nbsp;before&nbsp;it&nbsp;will&nbsp;not&nbsp;compute&nbsp;correctly,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2621735">//&nbsp;but&nbsp;otherwise&nbsp;can&nbsp;be&nbsp;changed&nbsp;at&nbsp;will.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2621777">absoluteZeroYear</span>&nbsp;<span class="op" id="2621794">=</span>&nbsp;<span class="op" id="2621796">-</span><span class="num" id="2621797">292277022399</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2621812">//&nbsp;The&nbsp;year&nbsp;of&nbsp;the&nbsp;zero&nbsp;Time.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2621843">//&nbsp;Assumed&nbsp;by&nbsp;the&nbsp;unixToInternal&nbsp;computation&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2621896">internalYear</span>&nbsp;<span class="op" id="2621909">=</span>&nbsp;<span class="num" id="2621911">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2621915">//&nbsp;The&nbsp;year&nbsp;of&nbsp;the&nbsp;zero&nbsp;Unix&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2621951">unixYear</span>&nbsp;<span class="op" id="2621960">=</span>&nbsp;<span class="num" id="2621962">1970</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2621969">//&nbsp;Offsets&nbsp;to&nbsp;convert&nbsp;between&nbsp;internal&nbsp;and&nbsp;absolute&nbsp;or&nbsp;Unix&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2622037">absoluteToInternal</span>&nbsp;<span class="ident" id="2622056">int64</span>&nbsp;<span class="op" id="2622062">=</span>&nbsp;<span class="op" id="2622064">(</span><span class="ident" id="2622065">absoluteZeroYear</span>&nbsp;<span class="op" id="2622082">-</span>&nbsp;<span class="ident" id="2622084">internalYear</span><span class="op" id="2622096">)</span>&nbsp;<span class="op" id="2622098">*</span>&nbsp;<span class="num" id="2622100">365.2425</span>&nbsp;<span class="op" id="2622109">*</span>&nbsp;<span class="ident" id="2622111">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2622126">internalToAbsolute</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2622151">=</span>&nbsp;<span class="op" id="2622153">-</span><span class="ident" id="2622154">absoluteToInternal</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2622175">unixToInternal</span>&nbsp;<span class="ident" id="2622190">int64</span>&nbsp;<span class="op" id="2622196">=</span>&nbsp;<span class="op" id="2622198">(</span><span class="num" id="2622199">1969</span><span class="op" id="2622203">*</span><span class="num" id="2622204">365</span>&nbsp;<span class="op" id="2622208">+</span>&nbsp;<span class="num" id="2622210">1969</span><span class="op" id="2622214">/</span><span class="num" id="2622215">4</span>&nbsp;<span class="op" id="2622217">-</span>&nbsp;<span class="num" id="2622219">1969</span><span class="op" id="2622223">/</span><span class="num" id="2622224">100</span>&nbsp;<span class="op" id="2622228">+</span>&nbsp;<span class="num" id="2622230">1969</span><span class="op" id="2622234">/</span><span class="num" id="2622235">400</span><span class="op" id="2622238">)</span>&nbsp;<span class="op" id="2622240">*</span>&nbsp;<span class="ident" id="2622242">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2622257">internalToUnix</span>&nbsp;<span class="ident" id="2622272">int64</span>&nbsp;<span class="op" id="2622278">=</span>&nbsp;<span class="op" id="2622280">-</span><span class="ident" id="2622281">unixToInternal</span><br>
<span class="lineno"></span><span class="op" id="2622296">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2622299">//&nbsp;IsZero&nbsp;reports&nbsp;whether&nbsp;t&nbsp;represents&nbsp;the&nbsp;zero&nbsp;time&nbsp;instant,</span><br>
<span class="lineno">240</span><span class="comment" id="2622361">//&nbsp;January&nbsp;1,&nbsp;year&nbsp;1,&nbsp;00:00:00&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2622397">func</span>&nbsp;<span class="op" id="2622402">(</span><span class="ident" id="2622403">t</span>&nbsp;<span class="ident" id="2622405">Time</span><span class="op" id="2622409">)</span>&nbsp;<span class="ident" id="2622411">IsZero</span><span class="op" id="2622417">(</span><span class="op" id="2622418">)</span>&nbsp;<span class="builtintype" id="2622420">bool</span>&nbsp;<span class="op" id="2622425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2622428">return</span>&nbsp;<span class="ident" id="2622435">t</span><span class="op" id="2622436">.</span><span class="ident" id="2622437">sec</span>&nbsp;<span class="op" id="2622441">==</span>&nbsp;<span class="num" id="2622444">0</span>&nbsp;<span class="op" id="2622446">&amp;&amp;</span>&nbsp;<span class="ident" id="2622449">t</span><span class="op" id="2622450">.</span><span class="ident" id="2622451">nsec</span>&nbsp;<span class="op" id="2622456">==</span>&nbsp;<span class="num" id="2622459">0</span><br>
<span class="lineno"></span><span class="op" id="2622461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="2622464">//&nbsp;abs&nbsp;returns&nbsp;the&nbsp;time&nbsp;t&nbsp;as&nbsp;an&nbsp;absolute&nbsp;time,&nbsp;adjusted&nbsp;by&nbsp;the&nbsp;zone&nbsp;offset.</span><br>
<span class="lineno"></span><span class="comment" id="2622540">//&nbsp;It&nbsp;is&nbsp;called&nbsp;when&nbsp;computing&nbsp;a&nbsp;presentation&nbsp;property&nbsp;like&nbsp;Month&nbsp;or&nbsp;Hour.</span><br>
<span class="lineno"></span><span class="keyword" id="2622615">func</span>&nbsp;<span class="op" id="2622620">(</span><span class="ident" id="2622621">t</span>&nbsp;<span class="ident" id="2622623">Time</span><span class="op" id="2622627">)</span>&nbsp;<span class="ident" id="2622629">abs</span><span class="op" id="2622632">(</span><span class="op" id="2622633">)</span>&nbsp;<span class="ident" id="2622635">uint64</span>&nbsp;<span class="op" id="2622642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2622645">l</span>&nbsp;<span class="op" id="2622647">:=</span>&nbsp;<span class="ident" id="2622650">t</span><span class="op" id="2622651">.</span><span class="ident" id="2622652">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2622657">//&nbsp;Avoid&nbsp;function&nbsp;calls&nbsp;when&nbsp;possible.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2622697">if</span>&nbsp;<span class="ident" id="2622700">l</span>&nbsp;<span class="op" id="2622702">==</span>&nbsp;<span class="builtintype" id="2622705">nil</span>&nbsp;<span class="op" id="2622709">||</span>&nbsp;<span class="ident" id="2622712">l</span>&nbsp;<span class="op" id="2622714">==</span>&nbsp;<span class="op" id="2622717">&amp;</span><span class="ident" id="2622718">localLoc</span>&nbsp;<span class="op" id="2622727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2622731">l</span>&nbsp;<span class="op" id="2622733">=</span>&nbsp;<span class="ident" id="2622735">l</span><span class="op" id="2622736">.</span><span class="ident" id="2622737">get</span><span class="op" id="2622740">(</span><span class="op" id="2622741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2622744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2622747">sec</span>&nbsp;<span class="op" id="2622751">:=</span>&nbsp;<span class="ident" id="2622754">t</span><span class="op" id="2622755">.</span><span class="ident" id="2622756">sec</span>&nbsp;<span class="op" id="2622760">+</span>&nbsp;<span class="ident" id="2622762">internalToUnix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2622778">if</span>&nbsp;<span class="ident" id="2622781">l</span>&nbsp;<span class="op" id="2622783">!=</span>&nbsp;<span class="op" id="2622786">&amp;</span><span class="ident" id="2622787">utcLoc</span>&nbsp;<span class="op" id="2622794">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2622798">if</span>&nbsp;<span class="ident" id="2622801">l</span><span class="op" id="2622802">.</span><span class="ident" id="2622803">cacheZone</span>&nbsp;<span class="op" id="2622813">!=</span>&nbsp;<span class="builtintype" id="2622816">nil</span>&nbsp;<span class="op" id="2622820">&amp;&amp;</span>&nbsp;<span class="ident" id="2622823">l</span><span class="op" id="2622824">.</span><span class="ident" id="2622825">cacheStart</span>&nbsp;<span class="op" id="2622836">&lt;=</span>&nbsp;<span class="ident" id="2622839">sec</span>&nbsp;<span class="op" id="2622843">&amp;&amp;</span>&nbsp;<span class="ident" id="2622846">sec</span>&nbsp;<span class="op" id="2622850">&lt;</span>&nbsp;<span class="ident" id="2622852">l</span><span class="op" id="2622853">.</span><span class="ident" id="2622854">cacheEnd</span>&nbsp;<span class="op" id="2622863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2622868">sec</span>&nbsp;<span class="op" id="2622872">+=</span>&nbsp;<span class="ident" id="2622875">int64</span><span class="op" id="2622880">(</span><span class="ident" id="2622881">l</span><span class="op" id="2622882">.</span><span class="ident" id="2622883">cacheZone</span><span class="op" id="2622892">.</span><span class="ident" id="2622893">offset</span><span class="op" id="2622899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2622903">}</span>&nbsp;<span class="keyword" id="2622905">else</span>&nbsp;<span class="op" id="2622910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2622915">_</span><span class="op" id="2622916">,</span>&nbsp;<span class="ident" id="2622918">offset</span><span class="op" id="2622924">,</span>&nbsp;<span class="ident" id="2622926">_</span><span class="op" id="2622927">,</span>&nbsp;<span class="ident" id="2622929">_</span><span class="op" id="2622930">,</span>&nbsp;<span class="ident" id="2622932">_</span>&nbsp;<span class="op" id="2622934">:=</span>&nbsp;<span class="ident" id="2622937">l</span><span class="op" id="2622938">.</span><span class="ident" id="2622939">lookup</span><span class="op" id="2622945">(</span><span class="ident" id="2622946">sec</span><span class="op" id="2622949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2622954">sec</span>&nbsp;<span class="op" id="2622958">+=</span>&nbsp;<span class="ident" id="2622961">int64</span><span class="op" id="2622966">(</span><span class="ident" id="2622967">offset</span><span class="op" id="2622973">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2622977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2622980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2622983">return</span>&nbsp;<span class="ident" id="2622990">uint64</span><span class="op" id="2622996">(</span><span class="ident" id="2622997">sec</span>&nbsp;<span class="op" id="2623001">+</span>&nbsp;<span class="op" id="2623003">(</span><span class="ident" id="2623004">unixToInternal</span>&nbsp;<span class="op" id="2623019">+</span>&nbsp;<span class="ident" id="2623021">internalToAbsolute</span><span class="op" id="2623039">)</span><span class="op" id="2623040">)</span><br>
<span class="lineno"></span><span class="op" id="2623042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="2623045">//&nbsp;locabs&nbsp;is&nbsp;a&nbsp;combination&nbsp;of&nbsp;the&nbsp;Zone&nbsp;and&nbsp;abs&nbsp;methods,</span><br>
<span class="lineno"></span><span class="comment" id="2623101">//&nbsp;extracting&nbsp;both&nbsp;return&nbsp;values&nbsp;from&nbsp;a&nbsp;single&nbsp;zone&nbsp;lookup.</span><br>
<span class="lineno"></span><span class="keyword" id="2623161">func</span>&nbsp;<span class="op" id="2623166">(</span><span class="ident" id="2623167">t</span>&nbsp;<span class="ident" id="2623169">Time</span><span class="op" id="2623173">)</span>&nbsp;<span class="ident" id="2623175">locabs</span><span class="op" id="2623181">(</span><span class="op" id="2623182">)</span>&nbsp;<span class="op" id="2623184">(</span><span class="ident" id="2623185">name</span>&nbsp;<span class="builtintype" id="2623190">string</span><span class="op" id="2623196">,</span>&nbsp;<span class="ident" id="2623198">offset</span>&nbsp;<span class="builtintype" id="2623205">int</span><span class="op" id="2623208">,</span>&nbsp;<span class="ident" id="2623210">abs</span>&nbsp;<span class="ident" id="2623214">uint64</span><span class="op" id="2623220">)</span>&nbsp;<span class="op" id="2623222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2623225">l</span>&nbsp;<span class="op" id="2623227">:=</span>&nbsp;<span class="ident" id="2623230">t</span><span class="op" id="2623231">.</span><span class="ident" id="2623232">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2623237">if</span>&nbsp;<span class="ident" id="2623240">l</span>&nbsp;<span class="op" id="2623242">==</span>&nbsp;<span class="builtintype" id="2623245">nil</span>&nbsp;<span class="op" id="2623249">||</span>&nbsp;<span class="ident" id="2623252">l</span>&nbsp;<span class="op" id="2623254">==</span>&nbsp;<span class="op" id="2623257">&amp;</span><span class="ident" id="2623258">localLoc</span>&nbsp;<span class="op" id="2623267">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2623271">l</span>&nbsp;<span class="op" id="2623273">=</span>&nbsp;<span class="ident" id="2623275">l</span><span class="op" id="2623276">.</span><span class="ident" id="2623277">get</span><span class="op" id="2623280">(</span><span class="op" id="2623281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2623284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2623287">//&nbsp;Avoid&nbsp;function&nbsp;call&nbsp;if&nbsp;we&nbsp;hit&nbsp;the&nbsp;local&nbsp;time&nbsp;cache.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2623343">sec</span>&nbsp;<span class="op" id="2623347">:=</span>&nbsp;<span class="ident" id="2623350">t</span><span class="op" id="2623351">.</span><span class="ident" id="2623352">sec</span>&nbsp;<span class="op" id="2623356">+</span>&nbsp;<span class="ident" id="2623358">internalToUnix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2623374">if</span>&nbsp;<span class="ident" id="2623377">l</span>&nbsp;<span class="op" id="2623379">!=</span>&nbsp;<span class="op" id="2623382">&amp;</span><span class="ident" id="2623383">utcLoc</span>&nbsp;<span class="op" id="2623390">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2623394">if</span>&nbsp;<span class="ident" id="2623397">l</span><span class="op" id="2623398">.</span><span class="ident" id="2623399">cacheZone</span>&nbsp;<span class="op" id="2623409">!=</span>&nbsp;<span class="builtintype" id="2623412">nil</span>&nbsp;<span class="op" id="2623416">&amp;&amp;</span>&nbsp;<span class="ident" id="2623419">l</span><span class="op" id="2623420">.</span><span class="ident" id="2623421">cacheStart</span>&nbsp;<span class="op" id="2623432">&lt;=</span>&nbsp;<span class="ident" id="2623435">sec</span>&nbsp;<span class="op" id="2623439">&amp;&amp;</span>&nbsp;<span class="ident" id="2623442">sec</span>&nbsp;<span class="op" id="2623446">&lt;</span>&nbsp;<span class="ident" id="2623448">l</span><span class="op" id="2623449">.</span><span class="ident" id="2623450">cacheEnd</span>&nbsp;<span class="op" id="2623459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2623464">name</span>&nbsp;<span class="op" id="2623469">=</span>&nbsp;<span class="ident" id="2623471">l</span><span class="op" id="2623472">.</span><span class="ident" id="2623473">cacheZone</span><span class="op" id="2623482">.</span><span class="ident" id="2623483">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2623491">offset</span>&nbsp;<span class="op" id="2623498">=</span>&nbsp;<span class="ident" id="2623500">l</span><span class="op" id="2623501">.</span><span class="ident" id="2623502">cacheZone</span><span class="op" id="2623511">.</span><span class="ident" id="2623512">offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2623521">}</span>&nbsp;<span class="keyword" id="2623523">else</span>&nbsp;<span class="op" id="2623528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2623533">name</span><span class="op" id="2623537">,</span>&nbsp;<span class="ident" id="2623539">offset</span><span class="op" id="2623545">,</span>&nbsp;<span class="ident" id="2623547">_</span><span class="op" id="2623548">,</span>&nbsp;<span class="ident" id="2623550">_</span><span class="op" id="2623551">,</span>&nbsp;<span class="ident" id="2623553">_</span>&nbsp;<span class="op" id="2623555">=</span>&nbsp;<span class="ident" id="2623557">l</span><span class="op" id="2623558">.</span><span class="ident" id="2623559">lookup</span><span class="op" id="2623565">(</span><span class="ident" id="2623566">sec</span><span class="op" id="2623569">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2623573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2623577">sec</span>&nbsp;<span class="op" id="2623581">+=</span>&nbsp;<span class="ident" id="2623584">int64</span><span class="op" id="2623589">(</span><span class="ident" id="2623590">offset</span><span class="op" id="2623596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2623599">}</span>&nbsp;<span class="keyword" id="2623601">else</span>&nbsp;<span class="op" id="2623606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2623610">name</span>&nbsp;<span class="op" id="2623615">=</span>&nbsp;<span class="string" id="2623617">&#34;UTC&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2623624">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2623627">abs</span>&nbsp;<span class="op" id="2623631">=</span>&nbsp;<span class="ident" id="2623633">uint64</span><span class="op" id="2623639">(</span><span class="ident" id="2623640">sec</span>&nbsp;<span class="op" id="2623644">+</span>&nbsp;<span class="op" id="2623646">(</span><span class="ident" id="2623647">unixToInternal</span>&nbsp;<span class="op" id="2623662">+</span>&nbsp;<span class="ident" id="2623664">internalToAbsolute</span><span class="op" id="2623682">)</span><span class="op" id="2623683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2623686">return</span><br>
<span class="lineno"></span><span class="op" id="2623693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2623696">//&nbsp;Date&nbsp;returns&nbsp;the&nbsp;year,&nbsp;month,&nbsp;and&nbsp;day&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno">290</span><span class="keyword" id="2623756">func</span>&nbsp;<span class="op" id="2623761">(</span><span class="ident" id="2623762">t</span>&nbsp;<span class="ident" id="2623764">Time</span><span class="op" id="2623768">)</span>&nbsp;<span class="ident" id="2623770">Date</span><span class="op" id="2623774">(</span><span class="op" id="2623775">)</span>&nbsp;<span class="op" id="2623777">(</span><span class="ident" id="2623778">year</span>&nbsp;<span class="builtintype" id="2623783">int</span><span class="op" id="2623786">,</span>&nbsp;<span class="ident" id="2623788">month</span>&nbsp;<span class="ident" id="2623794">Month</span><span class="op" id="2623799">,</span>&nbsp;<span class="ident" id="2623801">day</span>&nbsp;<span class="builtintype" id="2623805">int</span><span class="op" id="2623808">)</span>&nbsp;<span class="op" id="2623810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2623813">year</span><span class="op" id="2623817">,</span>&nbsp;<span class="ident" id="2623819">month</span><span class="op" id="2623824">,</span>&nbsp;<span class="ident" id="2623826">day</span><span class="op" id="2623829">,</span>&nbsp;<span class="ident" id="2623831">_</span>&nbsp;<span class="op" id="2623833">=</span>&nbsp;<span class="ident" id="2623835">t</span><span class="op" id="2623836">.</span><span class="ident" id="2623837">date</span><span class="op" id="2623841">(</span><span class="builtintype" id="2623842">true</span><span class="op" id="2623846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2623849">return</span><br>
<span class="lineno"></span><span class="op" id="2623856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="comment" id="2623859">//&nbsp;Year&nbsp;returns&nbsp;the&nbsp;year&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="2623903">func</span>&nbsp;<span class="op" id="2623908">(</span><span class="ident" id="2623909">t</span>&nbsp;<span class="ident" id="2623911">Time</span><span class="op" id="2623915">)</span>&nbsp;<span class="ident" id="2623917">Year</span><span class="op" id="2623921">(</span><span class="op" id="2623922">)</span>&nbsp;<span class="builtintype" id="2623924">int</span>&nbsp;<span class="op" id="2623928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2623931">year</span><span class="op" id="2623935">,</span>&nbsp;<span class="ident" id="2623937">_</span><span class="op" id="2623938">,</span>&nbsp;<span class="ident" id="2623940">_</span><span class="op" id="2623941">,</span>&nbsp;<span class="ident" id="2623943">_</span>&nbsp;<span class="op" id="2623945">:=</span>&nbsp;<span class="ident" id="2623948">t</span><span class="op" id="2623949">.</span><span class="ident" id="2623950">date</span><span class="op" id="2623954">(</span><span class="builtintype" id="2623955">false</span><span class="op" id="2623960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2623963">return</span>&nbsp;<span class="ident" id="2623970">year</span><br>
<span class="lineno"></span><span class="op" id="2623975">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="2623978">//&nbsp;Month&nbsp;returns&nbsp;the&nbsp;month&nbsp;of&nbsp;the&nbsp;year&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2624033">func</span>&nbsp;<span class="op" id="2624038">(</span><span class="ident" id="2624039">t</span>&nbsp;<span class="ident" id="2624041">Time</span><span class="op" id="2624045">)</span>&nbsp;<span class="ident" id="2624047">Month</span><span class="op" id="2624052">(</span><span class="op" id="2624053">)</span>&nbsp;<span class="ident" id="2624055">Month</span>&nbsp;<span class="op" id="2624061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2624064">_</span><span class="op" id="2624065">,</span>&nbsp;<span class="ident" id="2624067">month</span><span class="op" id="2624072">,</span>&nbsp;<span class="ident" id="2624074">_</span><span class="op" id="2624075">,</span>&nbsp;<span class="ident" id="2624077">_</span>&nbsp;<span class="op" id="2624079">:=</span>&nbsp;<span class="ident" id="2624082">t</span><span class="op" id="2624083">.</span><span class="ident" id="2624084">date</span><span class="op" id="2624088">(</span><span class="builtintype" id="2624089">true</span><span class="op" id="2624093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2624096">return</span>&nbsp;<span class="ident" id="2624103">month</span><br>
<span class="lineno">305</span><span class="op" id="2624109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2624112">//&nbsp;Day&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;month&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2624164">func</span>&nbsp;<span class="op" id="2624169">(</span><span class="ident" id="2624170">t</span>&nbsp;<span class="ident" id="2624172">Time</span><span class="op" id="2624176">)</span>&nbsp;<span class="ident" id="2624178">Day</span><span class="op" id="2624181">(</span><span class="op" id="2624182">)</span>&nbsp;<span class="builtintype" id="2624184">int</span>&nbsp;<span class="op" id="2624188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2624191">_</span><span class="op" id="2624192">,</span>&nbsp;<span class="ident" id="2624194">_</span><span class="op" id="2624195">,</span>&nbsp;<span class="ident" id="2624197">day</span><span class="op" id="2624200">,</span>&nbsp;<span class="ident" id="2624202">_</span>&nbsp;<span class="op" id="2624204">:=</span>&nbsp;<span class="ident" id="2624207">t</span><span class="op" id="2624208">.</span><span class="ident" id="2624209">date</span><span class="op" id="2624213">(</span><span class="builtintype" id="2624214">true</span><span class="op" id="2624218">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2624221">return</span>&nbsp;<span class="ident" id="2624228">day</span><br>
<span class="lineno"></span><span class="op" id="2624232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2624235">//&nbsp;Weekday&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;week&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno"></span><span class="keyword" id="2624290">func</span>&nbsp;<span class="op" id="2624295">(</span><span class="ident" id="2624296">t</span>&nbsp;<span class="ident" id="2624298">Time</span><span class="op" id="2624302">)</span>&nbsp;<span class="ident" id="2624304">Weekday</span><span class="op" id="2624311">(</span><span class="op" id="2624312">)</span>&nbsp;<span class="ident" id="2624314">Weekday</span>&nbsp;<span class="op" id="2624322">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2624325">return</span>&nbsp;<span class="ident" id="2624332">absWeekday</span><span class="op" id="2624342">(</span><span class="ident" id="2624343">t</span><span class="op" id="2624344">.</span><span class="ident" id="2624345">abs</span><span class="op" id="2624348">(</span><span class="op" id="2624349">)</span><span class="op" id="2624350">)</span><br>
<span class="lineno"></span><span class="op" id="2624352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2624355">//&nbsp;absWeekday&nbsp;is&nbsp;like&nbsp;Weekday&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2624419">func</span>&nbsp;<span class="ident" id="2624424">absWeekday</span><span class="op" id="2624434">(</span><span class="ident" id="2624435">abs</span>&nbsp;<span class="ident" id="2624439">uint64</span><span class="op" id="2624445">)</span>&nbsp;<span class="ident" id="2624447">Weekday</span>&nbsp;<span class="op" id="2624455">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2624458">//&nbsp;January&nbsp;1&nbsp;of&nbsp;the&nbsp;absolute&nbsp;year,&nbsp;like&nbsp;January&nbsp;1&nbsp;of&nbsp;2001,&nbsp;was&nbsp;a&nbsp;Monday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2624532">sec</span>&nbsp;<span class="op" id="2624536">:=</span>&nbsp;<span class="op" id="2624539">(</span><span class="ident" id="2624540">abs</span>&nbsp;<span class="op" id="2624544">+</span>&nbsp;<span class="ident" id="2624546">uint64</span><span class="op" id="2624552">(</span><span class="ident" id="2624553">Monday</span><span class="op" id="2624559">)</span><span class="op" id="2624560">*</span><span class="ident" id="2624561">secondsPerDay</span><span class="op" id="2624574">)</span>&nbsp;<span class="op" id="2624576">%</span>&nbsp;<span class="ident" id="2624578">secondsPerWeek</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2624594">return</span>&nbsp;<span class="ident" id="2624601">Weekday</span><span class="op" id="2624608">(</span><span class="builtintype" id="2624609">int</span><span class="op" id="2624612">(</span><span class="ident" id="2624613">sec</span><span class="op" id="2624616">)</span>&nbsp;<span class="op" id="2624618">/</span>&nbsp;<span class="ident" id="2624620">secondsPerDay</span><span class="op" id="2624633">)</span><br>
<span class="lineno"></span><span class="op" id="2624635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span><span class="comment" id="2624638">//&nbsp;ISOWeek&nbsp;returns&nbsp;the&nbsp;ISO&nbsp;8601&nbsp;year&nbsp;and&nbsp;week&nbsp;number&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="comment" id="2624710">//&nbsp;Week&nbsp;ranges&nbsp;from&nbsp;1&nbsp;to&nbsp;53.&nbsp;Jan&nbsp;01&nbsp;to&nbsp;Jan&nbsp;03&nbsp;of&nbsp;year&nbsp;n&nbsp;might&nbsp;belong&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2624782">//&nbsp;week&nbsp;52&nbsp;or&nbsp;53&nbsp;of&nbsp;year&nbsp;n-1,&nbsp;and&nbsp;Dec&nbsp;29&nbsp;to&nbsp;Dec&nbsp;31&nbsp;might&nbsp;belong&nbsp;to&nbsp;week&nbsp;1</span><br>
<span class="lineno"></span><span class="comment" id="2624856">//&nbsp;of&nbsp;year&nbsp;n+1.</span><br>
<span class="lineno"></span><span class="keyword" id="2624872">func</span>&nbsp;<span class="op" id="2624877">(</span><span class="ident" id="2624878">t</span>&nbsp;<span class="ident" id="2624880">Time</span><span class="op" id="2624884">)</span>&nbsp;<span class="ident" id="2624886">ISOWeek</span><span class="op" id="2624893">(</span><span class="op" id="2624894">)</span>&nbsp;<span class="op" id="2624896">(</span><span class="ident" id="2624897">year</span><span class="op" id="2624901">,</span>&nbsp;<span class="ident" id="2624903">week</span>&nbsp;<span class="builtintype" id="2624908">int</span><span class="op" id="2624911">)</span>&nbsp;<span class="op" id="2624913">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2624916">year</span><span class="op" id="2624920">,</span>&nbsp;<span class="ident" id="2624922">month</span><span class="op" id="2624927">,</span>&nbsp;<span class="ident" id="2624929">day</span><span class="op" id="2624932">,</span>&nbsp;<span class="ident" id="2624934">yday</span>&nbsp;<span class="op" id="2624939">:=</span>&nbsp;<span class="ident" id="2624942">t</span><span class="op" id="2624943">.</span><span class="ident" id="2624944">date</span><span class="op" id="2624948">(</span><span class="builtintype" id="2624949">true</span><span class="op" id="2624953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2624956">wday</span>&nbsp;<span class="op" id="2624961">:=</span>&nbsp;<span class="builtintype" id="2624964">int</span><span class="op" id="2624967">(</span><span class="ident" id="2624968">t</span><span class="op" id="2624969">.</span><span class="ident" id="2624970">Weekday</span><span class="op" id="2624977">(</span><span class="op" id="2624978">)</span><span class="op" id="2624979">+</span><span class="num" id="2624980">6</span><span class="op" id="2624981">)</span>&nbsp;<span class="op" id="2624983">%</span>&nbsp;<span class="num" id="2624985">7</span>&nbsp;<span class="comment" id="2624987">//&nbsp;weekday&nbsp;but&nbsp;Monday&nbsp;=&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2625015">const</span>&nbsp;<span class="op" id="2625021">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2625025">Mon</span>&nbsp;<span class="builtintype" id="2625029">int</span>&nbsp;<span class="op" id="2625033">=</span>&nbsp;<span class="ident" id="2625035">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2625042">Tue</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2625048">Wed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2625054">Thu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2625060">Fri</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2625066">Sat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2625072">Sun</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2625077">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625081">//&nbsp;Calculate&nbsp;week&nbsp;as&nbsp;number&nbsp;of&nbsp;Mondays&nbsp;in&nbsp;year&nbsp;up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625135">//&nbsp;and&nbsp;including&nbsp;today,&nbsp;plus&nbsp;1&nbsp;because&nbsp;the&nbsp;first&nbsp;week&nbsp;is&nbsp;week&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625201">//&nbsp;Putting&nbsp;the&nbsp;+&nbsp;1&nbsp;inside&nbsp;the&nbsp;numerator&nbsp;as&nbsp;a&nbsp;+&nbsp;7&nbsp;keeps&nbsp;the</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625261">//&nbsp;numerator&nbsp;from&nbsp;being&nbsp;negative,&nbsp;which&nbsp;would&nbsp;cause&nbsp;it&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625320">//&nbsp;round&nbsp;incorrectly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2625343">week</span>&nbsp;<span class="op" id="2625348">=</span>&nbsp;<span class="op" id="2625350">(</span><span class="ident" id="2625351">yday</span>&nbsp;<span class="op" id="2625356">-</span>&nbsp;<span class="ident" id="2625358">wday</span>&nbsp;<span class="op" id="2625363">+</span>&nbsp;<span class="num" id="2625365">7</span><span class="op" id="2625366">)</span>&nbsp;<span class="op" id="2625368">/</span>&nbsp;<span class="num" id="2625370">7</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625374">//&nbsp;The&nbsp;week&nbsp;number&nbsp;is&nbsp;now&nbsp;correct&nbsp;under&nbsp;the&nbsp;assumption</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625430">//&nbsp;that&nbsp;the&nbsp;first&nbsp;Monday&nbsp;of&nbsp;the&nbsp;year&nbsp;is&nbsp;in&nbsp;week&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625482">//&nbsp;If&nbsp;Jan&nbsp;1&nbsp;is&nbsp;a&nbsp;Tuesday,&nbsp;Wednesday,&nbsp;or&nbsp;Thursday,&nbsp;the&nbsp;first&nbsp;Monday</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625550">//&nbsp;is&nbsp;actually&nbsp;in&nbsp;week&nbsp;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2625577">jan1wday</span>&nbsp;<span class="op" id="2625586">:=</span>&nbsp;<span class="op" id="2625589">(</span><span class="ident" id="2625590">wday</span>&nbsp;<span class="op" id="2625595">-</span>&nbsp;<span class="ident" id="2625597">yday</span>&nbsp;<span class="op" id="2625602">+</span>&nbsp;<span class="num" id="2625604">7</span><span class="op" id="2625605">*</span><span class="num" id="2625606">53</span><span class="op" id="2625608">)</span>&nbsp;<span class="op" id="2625610">%</span>&nbsp;<span class="num" id="2625612">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2625615">if</span>&nbsp;<span class="ident" id="2625618">Tue</span>&nbsp;<span class="op" id="2625622">&lt;=</span>&nbsp;<span class="ident" id="2625625">jan1wday</span>&nbsp;<span class="op" id="2625634">&amp;&amp;</span>&nbsp;<span class="ident" id="2625637">jan1wday</span>&nbsp;<span class="op" id="2625646">&lt;=</span>&nbsp;<span class="ident" id="2625649">Thu</span>&nbsp;<span class="op" id="2625653">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2625657">week</span><span class="op" id="2625661">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2625665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625669">//&nbsp;If&nbsp;the&nbsp;week&nbsp;number&nbsp;is&nbsp;still&nbsp;0,&nbsp;we&#39;re&nbsp;in&nbsp;early&nbsp;January&nbsp;but&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625734">//&nbsp;the&nbsp;last&nbsp;week&nbsp;of&nbsp;last&nbsp;year.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2625766">if</span>&nbsp;<span class="ident" id="2625769">week</span>&nbsp;<span class="op" id="2625774">==</span>&nbsp;<span class="num" id="2625777">0</span>&nbsp;<span class="op" id="2625779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2625783">year</span><span class="op" id="2625787">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2625792">week</span>&nbsp;<span class="op" id="2625797">=</span>&nbsp;<span class="num" id="2625799">52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625804">//&nbsp;A&nbsp;year&nbsp;has&nbsp;53&nbsp;weeks&nbsp;when&nbsp;Jan&nbsp;1&nbsp;or&nbsp;Dec&nbsp;31&nbsp;is&nbsp;a&nbsp;Thursday,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625865">//&nbsp;meaning&nbsp;Jan&nbsp;1&nbsp;of&nbsp;the&nbsp;next&nbsp;year&nbsp;is&nbsp;a&nbsp;Friday</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2625913">//&nbsp;or&nbsp;it&nbsp;was&nbsp;a&nbsp;leap&nbsp;year&nbsp;and&nbsp;Jan&nbsp;1&nbsp;of&nbsp;the&nbsp;next&nbsp;year&nbsp;is&nbsp;a&nbsp;Saturday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2625982">if</span>&nbsp;<span class="ident" id="2625985">jan1wday</span>&nbsp;<span class="op" id="2625994">==</span>&nbsp;<span class="ident" id="2625997">Fri</span>&nbsp;<span class="op" id="2626001">||</span>&nbsp;<span class="op" id="2626004">(</span><span class="ident" id="2626005">jan1wday</span>&nbsp;<span class="op" id="2626014">==</span>&nbsp;<span class="ident" id="2626017">Sat</span>&nbsp;<span class="op" id="2626021">&amp;&amp;</span>&nbsp;<span class="ident" id="2626024">isLeap</span><span class="op" id="2626030">(</span><span class="ident" id="2626031">year</span><span class="op" id="2626035">)</span><span class="op" id="2626036">)</span>&nbsp;<span class="op" id="2626038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2626043">week</span><span class="op" id="2626047">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2626052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2626055">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2626059">//&nbsp;December&nbsp;29&nbsp;to&nbsp;31&nbsp;are&nbsp;in&nbsp;week&nbsp;1&nbsp;of&nbsp;next&nbsp;year&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2626111">//&nbsp;they&nbsp;are&nbsp;after&nbsp;the&nbsp;last&nbsp;Thursday&nbsp;of&nbsp;the&nbsp;year&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2626164">//&nbsp;December&nbsp;31&nbsp;is&nbsp;a&nbsp;Monday,&nbsp;Tuesday,&nbsp;or&nbsp;Wednesday.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2626216">if</span>&nbsp;<span class="ident" id="2626219">month</span>&nbsp;<span class="op" id="2626225">==</span>&nbsp;<span class="ident" id="2626228">December</span>&nbsp;<span class="op" id="2626237">&amp;&amp;</span>&nbsp;<span class="ident" id="2626240">day</span>&nbsp;<span class="op" id="2626244">&gt;=</span>&nbsp;<span class="num" id="2626247">29</span>&nbsp;<span class="op" id="2626250">&amp;&amp;</span>&nbsp;<span class="ident" id="2626253">wday</span>&nbsp;<span class="op" id="2626258">&lt;</span>&nbsp;<span class="ident" id="2626260">Thu</span>&nbsp;<span class="op" id="2626264">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2626268">if</span>&nbsp;<span class="ident" id="2626271">dec31wday</span>&nbsp;<span class="op" id="2626281">:=</span>&nbsp;<span class="op" id="2626284">(</span><span class="ident" id="2626285">wday</span>&nbsp;<span class="op" id="2626290">+</span>&nbsp;<span class="num" id="2626292">31</span>&nbsp;<span class="op" id="2626295">-</span>&nbsp;<span class="ident" id="2626297">day</span><span class="op" id="2626300">)</span>&nbsp;<span class="op" id="2626302">%</span>&nbsp;<span class="num" id="2626304">7</span><span class="op" id="2626305">;</span>&nbsp;<span class="ident" id="2626307">Mon</span>&nbsp;<span class="op" id="2626311">&lt;=</span>&nbsp;<span class="ident" id="2626314">dec31wday</span>&nbsp;<span class="op" id="2626324">&amp;&amp;</span>&nbsp;<span class="ident" id="2626327">dec31wday</span>&nbsp;<span class="op" id="2626337">&lt;=</span>&nbsp;<span class="ident" id="2626340">Wed</span>&nbsp;<span class="op" id="2626344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2626349">year</span><span class="op" id="2626353">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2626359">week</span>&nbsp;<span class="op" id="2626364">=</span>&nbsp;<span class="num" id="2626366">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2626370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2626373">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2626377">return</span><br>
<span class="lineno"></span><span class="op" id="2626384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2626387">//&nbsp;Clock&nbsp;returns&nbsp;the&nbsp;hour,&nbsp;minute,&nbsp;and&nbsp;second&nbsp;within&nbsp;the&nbsp;day&nbsp;specified&nbsp;by&nbsp;t.</span><br>
<span class="lineno">385</span><span class="keyword" id="2626464">func</span>&nbsp;<span class="op" id="2626469">(</span><span class="ident" id="2626470">t</span>&nbsp;<span class="ident" id="2626472">Time</span><span class="op" id="2626476">)</span>&nbsp;<span class="ident" id="2626478">Clock</span><span class="op" id="2626483">(</span><span class="op" id="2626484">)</span>&nbsp;<span class="op" id="2626486">(</span><span class="ident" id="2626487">hour</span><span class="op" id="2626491">,</span>&nbsp;<span class="ident" id="2626493">min</span><span class="op" id="2626496">,</span>&nbsp;<span class="ident" id="2626498">sec</span>&nbsp;<span class="builtintype" id="2626502">int</span><span class="op" id="2626505">)</span>&nbsp;<span class="op" id="2626507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2626510">return</span>&nbsp;<span class="ident" id="2626517">absClock</span><span class="op" id="2626525">(</span><span class="ident" id="2626526">t</span><span class="op" id="2626527">.</span><span class="ident" id="2626528">abs</span><span class="op" id="2626531">(</span><span class="op" id="2626532">)</span><span class="op" id="2626533">)</span><br>
<span class="lineno"></span><span class="op" id="2626535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2626538">//&nbsp;absClock&nbsp;is&nbsp;like&nbsp;clock&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="2626598">func</span>&nbsp;<span class="ident" id="2626603">absClock</span><span class="op" id="2626611">(</span><span class="ident" id="2626612">abs</span>&nbsp;<span class="ident" id="2626616">uint64</span><span class="op" id="2626622">)</span>&nbsp;<span class="op" id="2626624">(</span><span class="ident" id="2626625">hour</span><span class="op" id="2626629">,</span>&nbsp;<span class="ident" id="2626631">min</span><span class="op" id="2626634">,</span>&nbsp;<span class="ident" id="2626636">sec</span>&nbsp;<span class="builtintype" id="2626640">int</span><span class="op" id="2626643">)</span>&nbsp;<span class="op" id="2626645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2626648">sec</span>&nbsp;<span class="op" id="2626652">=</span>&nbsp;<span class="builtintype" id="2626654">int</span><span class="op" id="2626657">(</span><span class="ident" id="2626658">abs</span>&nbsp;<span class="op" id="2626662">%</span>&nbsp;<span class="ident" id="2626664">secondsPerDay</span><span class="op" id="2626677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2626680">hour</span>&nbsp;<span class="op" id="2626685">=</span>&nbsp;<span class="ident" id="2626687">sec</span>&nbsp;<span class="op" id="2626691">/</span>&nbsp;<span class="ident" id="2626693">secondsPerHour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2626709">sec</span>&nbsp;<span class="op" id="2626713">-=</span>&nbsp;<span class="ident" id="2626716">hour</span>&nbsp;<span class="op" id="2626721">*</span>&nbsp;<span class="ident" id="2626723">secondsPerHour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2626739">min</span>&nbsp;<span class="op" id="2626743">=</span>&nbsp;<span class="ident" id="2626745">sec</span>&nbsp;<span class="op" id="2626749">/</span>&nbsp;<span class="ident" id="2626751">secondsPerMinute</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2626769">sec</span>&nbsp;<span class="op" id="2626773">-=</span>&nbsp;<span class="ident" id="2626776">min</span>&nbsp;<span class="op" id="2626780">*</span>&nbsp;<span class="ident" id="2626782">secondsPerMinute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2626800">return</span><br>
<span class="lineno"></span><span class="op" id="2626807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2626810">//&nbsp;Hour&nbsp;returns&nbsp;the&nbsp;hour&nbsp;within&nbsp;the&nbsp;day&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;23].</span><br>
<span class="lineno">400</span><span class="keyword" id="2626888">func</span>&nbsp;<span class="op" id="2626893">(</span><span class="ident" id="2626894">t</span>&nbsp;<span class="ident" id="2626896">Time</span><span class="op" id="2626900">)</span>&nbsp;<span class="ident" id="2626902">Hour</span><span class="op" id="2626906">(</span><span class="op" id="2626907">)</span>&nbsp;<span class="builtintype" id="2626909">int</span>&nbsp;<span class="op" id="2626913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2626916">return</span>&nbsp;<span class="builtintype" id="2626923">int</span><span class="op" id="2626926">(</span><span class="ident" id="2626927">t</span><span class="op" id="2626928">.</span><span class="ident" id="2626929">abs</span><span class="op" id="2626932">(</span><span class="op" id="2626933">)</span><span class="op" id="2626934">%</span><span class="ident" id="2626935">secondsPerDay</span><span class="op" id="2626948">)</span>&nbsp;<span class="op" id="2626950">/</span>&nbsp;<span class="ident" id="2626952">secondsPerHour</span><br>
<span class="lineno"></span><span class="op" id="2626967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2626970">//&nbsp;Minute&nbsp;returns&nbsp;the&nbsp;minute&nbsp;offset&nbsp;within&nbsp;the&nbsp;hour&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;59].</span><br>
<span class="lineno">405</span><span class="keyword" id="2627060">func</span>&nbsp;<span class="op" id="2627065">(</span><span class="ident" id="2627066">t</span>&nbsp;<span class="ident" id="2627068">Time</span><span class="op" id="2627072">)</span>&nbsp;<span class="ident" id="2627074">Minute</span><span class="op" id="2627080">(</span><span class="op" id="2627081">)</span>&nbsp;<span class="builtintype" id="2627083">int</span>&nbsp;<span class="op" id="2627087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2627090">return</span>&nbsp;<span class="builtintype" id="2627097">int</span><span class="op" id="2627100">(</span><span class="ident" id="2627101">t</span><span class="op" id="2627102">.</span><span class="ident" id="2627103">abs</span><span class="op" id="2627106">(</span><span class="op" id="2627107">)</span><span class="op" id="2627108">%</span><span class="ident" id="2627109">secondsPerHour</span><span class="op" id="2627123">)</span>&nbsp;<span class="op" id="2627125">/</span>&nbsp;<span class="ident" id="2627127">secondsPerMinute</span><br>
<span class="lineno"></span><span class="op" id="2627144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2627147">//&nbsp;Second&nbsp;returns&nbsp;the&nbsp;second&nbsp;offset&nbsp;within&nbsp;the&nbsp;minute&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;59].</span><br>
<span class="lineno">410</span><span class="keyword" id="2627239">func</span>&nbsp;<span class="op" id="2627244">(</span><span class="ident" id="2627245">t</span>&nbsp;<span class="ident" id="2627247">Time</span><span class="op" id="2627251">)</span>&nbsp;<span class="ident" id="2627253">Second</span><span class="op" id="2627259">(</span><span class="op" id="2627260">)</span>&nbsp;<span class="builtintype" id="2627262">int</span>&nbsp;<span class="op" id="2627266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2627269">return</span>&nbsp;<span class="builtintype" id="2627276">int</span><span class="op" id="2627279">(</span><span class="ident" id="2627280">t</span><span class="op" id="2627281">.</span><span class="ident" id="2627282">abs</span><span class="op" id="2627285">(</span><span class="op" id="2627286">)</span>&nbsp;<span class="op" id="2627288">%</span>&nbsp;<span class="ident" id="2627290">secondsPerMinute</span><span class="op" id="2627306">)</span><br>
<span class="lineno"></span><span class="op" id="2627308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2627311">//&nbsp;Nanosecond&nbsp;returns&nbsp;the&nbsp;nanosecond&nbsp;offset&nbsp;within&nbsp;the&nbsp;second&nbsp;specified&nbsp;by&nbsp;t,</span><br>
<span class="lineno">415</span><span class="comment" id="2627389">//&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span><span class="keyword" id="2627421">func</span>&nbsp;<span class="op" id="2627426">(</span><span class="ident" id="2627427">t</span>&nbsp;<span class="ident" id="2627429">Time</span><span class="op" id="2627433">)</span>&nbsp;<span class="ident" id="2627435">Nanosecond</span><span class="op" id="2627445">(</span><span class="op" id="2627446">)</span>&nbsp;<span class="builtintype" id="2627448">int</span>&nbsp;<span class="op" id="2627452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2627455">return</span>&nbsp;<span class="builtintype" id="2627462">int</span><span class="op" id="2627465">(</span><span class="ident" id="2627466">t</span><span class="op" id="2627467">.</span><span class="ident" id="2627468">nsec</span><span class="op" id="2627472">)</span><br>
<span class="lineno"></span><span class="op" id="2627474">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">420</span><span class="comment" id="2627477">//&nbsp;YearDay&nbsp;returns&nbsp;the&nbsp;day&nbsp;of&nbsp;the&nbsp;year&nbsp;specified&nbsp;by&nbsp;t,&nbsp;in&nbsp;the&nbsp;range&nbsp;[1,365]&nbsp;for&nbsp;non-leap&nbsp;years,</span><br>
<span class="lineno"></span><span class="comment" id="2627573">//&nbsp;and&nbsp;[1,366]&nbsp;in&nbsp;leap&nbsp;years.</span><br>
<span class="lineno"></span><span class="keyword" id="2627603">func</span>&nbsp;<span class="op" id="2627608">(</span><span class="ident" id="2627609">t</span>&nbsp;<span class="ident" id="2627611">Time</span><span class="op" id="2627615">)</span>&nbsp;<span class="ident" id="2627617">YearDay</span><span class="op" id="2627624">(</span><span class="op" id="2627625">)</span>&nbsp;<span class="builtintype" id="2627627">int</span>&nbsp;<span class="op" id="2627631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2627634">_</span><span class="op" id="2627635">,</span>&nbsp;<span class="ident" id="2627637">_</span><span class="op" id="2627638">,</span>&nbsp;<span class="ident" id="2627640">_</span><span class="op" id="2627641">,</span>&nbsp;<span class="ident" id="2627643">yday</span>&nbsp;<span class="op" id="2627648">:=</span>&nbsp;<span class="ident" id="2627651">t</span><span class="op" id="2627652">.</span><span class="ident" id="2627653">date</span><span class="op" id="2627657">(</span><span class="builtintype" id="2627658">false</span><span class="op" id="2627663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2627666">return</span>&nbsp;<span class="ident" id="2627673">yday</span>&nbsp;<span class="op" id="2627678">+</span>&nbsp;<span class="num" id="2627680">1</span><br>
<span class="lineno">425</span><span class="op" id="2627682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2627685">//&nbsp;A&nbsp;Duration&nbsp;represents&nbsp;the&nbsp;elapsed&nbsp;time&nbsp;between&nbsp;two&nbsp;instants</span><br>
<span class="lineno"></span><span class="comment" id="2627748">//&nbsp;as&nbsp;an&nbsp;int64&nbsp;nanosecond&nbsp;count.&nbsp;&nbsp;The&nbsp;representation&nbsp;limits&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2627812">//&nbsp;largest&nbsp;representable&nbsp;duration&nbsp;to&nbsp;approximately&nbsp;290&nbsp;years.</span><br>
<span class="lineno">430</span><span class="keyword" id="2627874">type</span>&nbsp;<span class="ident" id="2627879">Duration</span>&nbsp;<span class="ident" id="2627888">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2627895">const</span>&nbsp;<span class="op" id="2627901">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2627904">minDuration</span>&nbsp;<span class="ident" id="2627916">Duration</span>&nbsp;<span class="op" id="2627925">=</span>&nbsp;<span class="op" id="2627927">-</span><span class="num" id="2627928">1</span>&nbsp;<span class="op" id="2627930">&lt;&lt;</span>&nbsp;<span class="num" id="2627933">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2627937">maxDuration</span>&nbsp;<span class="ident" id="2627949">Duration</span>&nbsp;<span class="op" id="2627958">=</span>&nbsp;<span class="num" id="2627960">1</span><span class="op" id="2627961">&lt;&lt;</span><span class="num" id="2627963">63</span>&nbsp;<span class="op" id="2627966">-</span>&nbsp;<span class="num" id="2627968">1</span><br>
<span class="lineno">435</span><span class="op" id="2627970">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2627973">//&nbsp;Common&nbsp;durations.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;definition&nbsp;for&nbsp;units&nbsp;of&nbsp;Day&nbsp;or&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2628045">//&nbsp;to&nbsp;avoid&nbsp;confusion&nbsp;across&nbsp;daylight&nbsp;savings&nbsp;time&nbsp;zone&nbsp;transitions.</span><br>
<span class="lineno"></span><span class="comment" id="2628114">//</span><br>
<span class="lineno">440</span><span class="comment" id="2628117">//&nbsp;To&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;units&nbsp;in&nbsp;a&nbsp;Duration,&nbsp;divide:</span><br>
<span class="lineno"></span><span class="comment" id="2628172">//&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;:=&nbsp;time.Second</span><br>
<span class="lineno"></span><span class="comment" id="2628197">//&nbsp;&nbsp;&nbsp;&nbsp;fmt.Print(int64(second/time.Millisecond))&nbsp;//&nbsp;prints&nbsp;1000</span><br>
<span class="lineno"></span><span class="comment" id="2628257">//</span><br>
<span class="lineno"></span><span class="comment" id="2628260">//&nbsp;To&nbsp;convert&nbsp;an&nbsp;integer&nbsp;number&nbsp;of&nbsp;units&nbsp;to&nbsp;a&nbsp;Duration,&nbsp;multiply:</span><br>
<span class="lineno">445</span><span class="comment" id="2628326">//&nbsp;&nbsp;&nbsp;&nbsp;seconds&nbsp;:=&nbsp;10</span><br>
<span class="lineno"></span><span class="comment" id="2628343">//&nbsp;&nbsp;&nbsp;&nbsp;fmt.Print(time.Duration(seconds)*time.Second)&nbsp;//&nbsp;prints&nbsp;10s</span><br>
<span class="lineno"></span><span class="comment" id="2628406">//</span><br>
<span class="lineno"></span><span class="keyword" id="2628409">const</span>&nbsp;<span class="op" id="2628415">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2628418">Nanosecond</span>&nbsp;&nbsp;<span class="ident" id="2628430">Duration</span>&nbsp;<span class="op" id="2628439">=</span>&nbsp;<span class="num" id="2628441">1</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2628444">Microsecond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2628465">=</span>&nbsp;<span class="num" id="2628467">1000</span>&nbsp;<span class="op" id="2628472">*</span>&nbsp;<span class="ident" id="2628474">Nanosecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2628486">Millisecond</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2628507">=</span>&nbsp;<span class="num" id="2628509">1000</span>&nbsp;<span class="op" id="2628514">*</span>&nbsp;<span class="ident" id="2628516">Microsecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2628529">Second</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2628550">=</span>&nbsp;<span class="num" id="2628552">1000</span>&nbsp;<span class="op" id="2628557">*</span>&nbsp;<span class="ident" id="2628559">Millisecond</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2628572">Minute</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2628593">=</span>&nbsp;<span class="num" id="2628595">60</span>&nbsp;<span class="op" id="2628598">*</span>&nbsp;<span class="ident" id="2628600">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2628608">Hour</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2628629">=</span>&nbsp;<span class="num" id="2628631">60</span>&nbsp;<span class="op" id="2628634">*</span>&nbsp;<span class="ident" id="2628636">Minute</span><br>
<span class="lineno">455</span><span class="op" id="2628643">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2628646">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representing&nbsp;the&nbsp;duration&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;72h3m0.5s&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2628724">//&nbsp;Leading&nbsp;zero&nbsp;units&nbsp;are&nbsp;omitted.&nbsp;&nbsp;As&nbsp;a&nbsp;special&nbsp;case,&nbsp;durations&nbsp;less&nbsp;than&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="2628803">//&nbsp;second&nbsp;format&nbsp;use&nbsp;a&nbsp;smaller&nbsp;unit&nbsp;(milli-,&nbsp;micro-,&nbsp;or&nbsp;nanoseconds)&nbsp;to&nbsp;ensure</span><br>
<span class="lineno">460</span><span class="comment" id="2628882">//&nbsp;that&nbsp;the&nbsp;leading&nbsp;digit&nbsp;is&nbsp;non-zero.&nbsp;&nbsp;The&nbsp;zero&nbsp;duration&nbsp;formats&nbsp;as&nbsp;0,</span><br>
<span class="lineno"></span><span class="comment" id="2628954">//&nbsp;with&nbsp;no&nbsp;unit.</span><br>
<span class="lineno"></span><span class="keyword" id="2628971">func</span>&nbsp;<span class="op" id="2628976">(</span><span class="ident" id="2628977">d</span>&nbsp;<span class="ident" id="2628979">Duration</span><span class="op" id="2628987">)</span>&nbsp;<span class="ident" id="2628989">String</span><span class="op" id="2628995">(</span><span class="op" id="2628996">)</span>&nbsp;<span class="builtintype" id="2628998">string</span>&nbsp;<span class="op" id="2629005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2629008">//&nbsp;Largest&nbsp;time&nbsp;is&nbsp;2540400h10m10.000000000s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2629053">var</span>&nbsp;<span class="ident" id="2629057">buf</span>&nbsp;<span class="op" id="2629061">[</span><span class="num" id="2629062">32</span><span class="op" id="2629064">]</span><span class="builtintype" id="2629065">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629071">w</span>&nbsp;<span class="op" id="2629073">:=</span>&nbsp;<span class="builtinfunc" id="2629076">len</span><span class="op" id="2629079">(</span><span class="ident" id="2629080">buf</span><span class="op" id="2629083">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629087">u</span>&nbsp;<span class="op" id="2629089">:=</span>&nbsp;<span class="ident" id="2629092">uint64</span><span class="op" id="2629098">(</span><span class="ident" id="2629099">d</span><span class="op" id="2629100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629103">neg</span>&nbsp;<span class="op" id="2629107">:=</span>&nbsp;<span class="ident" id="2629110">d</span>&nbsp;<span class="op" id="2629112">&lt;</span>&nbsp;<span class="num" id="2629114">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2629117">if</span>&nbsp;<span class="ident" id="2629120">neg</span>&nbsp;<span class="op" id="2629124">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629128">u</span>&nbsp;<span class="op" id="2629130">=</span>&nbsp;<span class="op" id="2629132">-</span><span class="ident" id="2629133">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2629136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2629140">if</span>&nbsp;<span class="ident" id="2629143">u</span>&nbsp;<span class="op" id="2629145">&lt;</span>&nbsp;<span class="ident" id="2629147">uint64</span><span class="op" id="2629153">(</span><span class="ident" id="2629154">Second</span><span class="op" id="2629160">)</span>&nbsp;<span class="op" id="2629162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2629166">//&nbsp;Special&nbsp;case:&nbsp;if&nbsp;duration&nbsp;is&nbsp;smaller&nbsp;than&nbsp;a&nbsp;second,</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2629223">//&nbsp;use&nbsp;smaller&nbsp;units,&nbsp;like&nbsp;1.2ms</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2629258">var</span>&nbsp;<span class="ident" id="2629262">prec</span>&nbsp;<span class="builtintype" id="2629267">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629273">w</span><span class="op" id="2629274">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629279">buf</span><span class="op" id="2629282">[</span><span class="ident" id="2629283">w</span><span class="op" id="2629284">]</span>&nbsp;<span class="op" id="2629286">=</span>&nbsp;<span class="string" id="2629288">&#39;s&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629294">w</span><span class="op" id="2629295">--</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2629300">switch</span>&nbsp;<span class="op" id="2629307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2629311">case</span>&nbsp;<span class="ident" id="2629316">u</span>&nbsp;<span class="op" id="2629318">==</span>&nbsp;<span class="num" id="2629321">0</span><span class="op" id="2629322">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2629327">return</span>&nbsp;<span class="string" id="2629334">&#34;0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2629340">case</span>&nbsp;<span class="ident" id="2629345">u</span>&nbsp;<span class="op" id="2629347">&lt;</span>&nbsp;<span class="ident" id="2629349">uint64</span><span class="op" id="2629355">(</span><span class="ident" id="2629356">Microsecond</span><span class="op" id="2629367">)</span><span class="op" id="2629368">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2629373">//&nbsp;print&nbsp;nanoseconds</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629397">prec</span>&nbsp;<span class="op" id="2629402">=</span>&nbsp;<span class="num" id="2629404">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629409">buf</span><span class="op" id="2629412">[</span><span class="ident" id="2629413">w</span><span class="op" id="2629414">]</span>&nbsp;<span class="op" id="2629416">=</span>&nbsp;<span class="string" id="2629418">&#39;n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2629424">case</span>&nbsp;<span class="ident" id="2629429">u</span>&nbsp;<span class="op" id="2629431">&lt;</span>&nbsp;<span class="ident" id="2629433">uint64</span><span class="op" id="2629439">(</span><span class="ident" id="2629440">Millisecond</span><span class="op" id="2629451">)</span><span class="op" id="2629452">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2629457">//&nbsp;print&nbsp;microseconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629482">prec</span>&nbsp;<span class="op" id="2629487">=</span>&nbsp;<span class="num" id="2629489">3</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2629494">//&nbsp;U+00B5&nbsp;&#39;µ&#39;&nbsp;micro&nbsp;sign&nbsp;==&nbsp;0xC2&nbsp;0xB5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629536">w</span><span class="op" id="2629537">--</span>&nbsp;<span class="comment" id="2629540">//&nbsp;Need&nbsp;room&nbsp;for&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2629571">copy</span><span class="op" id="2629575">(</span><span class="ident" id="2629576">buf</span><span class="op" id="2629579">[</span><span class="ident" id="2629580">w</span><span class="op" id="2629581">:</span><span class="op" id="2629582">]</span><span class="op" id="2629583">,</span>&nbsp;<span class="string" id="2629585">&#34;µ&#34;</span><span class="op" id="2629589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2629593">default</span><span class="op" id="2629600">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2629605">//&nbsp;print&nbsp;milliseconds</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629630">prec</span>&nbsp;<span class="op" id="2629635">=</span>&nbsp;<span class="num" id="2629637">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629642">buf</span><span class="op" id="2629645">[</span><span class="ident" id="2629646">w</span><span class="op" id="2629647">]</span>&nbsp;<span class="op" id="2629649">=</span>&nbsp;<span class="string" id="2629651">&#39;m&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2629657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629661">w</span><span class="op" id="2629662">,</span>&nbsp;<span class="ident" id="2629664">u</span>&nbsp;<span class="op" id="2629666">=</span>&nbsp;<span class="ident" id="2629668">fmtFrac</span><span class="op" id="2629675">(</span><span class="ident" id="2629676">buf</span><span class="op" id="2629679">[</span><span class="op" id="2629680">:</span><span class="ident" id="2629681">w</span><span class="op" id="2629682">]</span><span class="op" id="2629683">,</span>&nbsp;<span class="ident" id="2629685">u</span><span class="op" id="2629686">,</span>&nbsp;<span class="ident" id="2629688">prec</span><span class="op" id="2629692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629696">w</span>&nbsp;<span class="op" id="2629698">=</span>&nbsp;<span class="ident" id="2629700">fmtInt</span><span class="op" id="2629706">(</span><span class="ident" id="2629707">buf</span><span class="op" id="2629710">[</span><span class="op" id="2629711">:</span><span class="ident" id="2629712">w</span><span class="op" id="2629713">]</span><span class="op" id="2629714">,</span>&nbsp;<span class="ident" id="2629716">u</span><span class="op" id="2629717">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2629720">}</span>&nbsp;<span class="keyword" id="2629722">else</span>&nbsp;<span class="op" id="2629727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629731">w</span><span class="op" id="2629732">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629737">buf</span><span class="op" id="2629740">[</span><span class="ident" id="2629741">w</span><span class="op" id="2629742">]</span>&nbsp;<span class="op" id="2629744">=</span>&nbsp;<span class="string" id="2629746">&#39;s&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629753">w</span><span class="op" id="2629754">,</span>&nbsp;<span class="ident" id="2629756">u</span>&nbsp;<span class="op" id="2629758">=</span>&nbsp;<span class="ident" id="2629760">fmtFrac</span><span class="op" id="2629767">(</span><span class="ident" id="2629768">buf</span><span class="op" id="2629771">[</span><span class="op" id="2629772">:</span><span class="ident" id="2629773">w</span><span class="op" id="2629774">]</span><span class="op" id="2629775">,</span>&nbsp;<span class="ident" id="2629777">u</span><span class="op" id="2629778">,</span>&nbsp;<span class="num" id="2629780">9</span><span class="op" id="2629781">)</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2629786">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629816">w</span>&nbsp;<span class="op" id="2629818">=</span>&nbsp;<span class="ident" id="2629820">fmtInt</span><span class="op" id="2629826">(</span><span class="ident" id="2629827">buf</span><span class="op" id="2629830">[</span><span class="op" id="2629831">:</span><span class="ident" id="2629832">w</span><span class="op" id="2629833">]</span><span class="op" id="2629834">,</span>&nbsp;<span class="ident" id="2629836">u</span><span class="op" id="2629837">%</span><span class="num" id="2629838">60</span><span class="op" id="2629840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629844">u</span>&nbsp;<span class="op" id="2629846">/=</span>&nbsp;<span class="num" id="2629849">60</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2629855">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2629885">if</span>&nbsp;<span class="ident" id="2629888">u</span>&nbsp;<span class="op" id="2629890">&gt;</span>&nbsp;<span class="num" id="2629892">0</span>&nbsp;<span class="op" id="2629894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629899">w</span><span class="op" id="2629900">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629906">buf</span><span class="op" id="2629909">[</span><span class="ident" id="2629910">w</span><span class="op" id="2629911">]</span>&nbsp;<span class="op" id="2629913">=</span>&nbsp;<span class="string" id="2629915">&#39;m&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629922">w</span>&nbsp;<span class="op" id="2629924">=</span>&nbsp;<span class="ident" id="2629926">fmtInt</span><span class="op" id="2629932">(</span><span class="ident" id="2629933">buf</span><span class="op" id="2629936">[</span><span class="op" id="2629937">:</span><span class="ident" id="2629938">w</span><span class="op" id="2629939">]</span><span class="op" id="2629940">,</span>&nbsp;<span class="ident" id="2629942">u</span><span class="op" id="2629943">%</span><span class="num" id="2629944">60</span><span class="op" id="2629946">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2629951">u</span>&nbsp;<span class="op" id="2629953">/=</span>&nbsp;<span class="num" id="2629956">60</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2629963">//&nbsp;u&nbsp;is&nbsp;now&nbsp;integer&nbsp;hours</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2629992">//&nbsp;Stop&nbsp;at&nbsp;hours&nbsp;because&nbsp;days&nbsp;can&nbsp;be&nbsp;different&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2630051">if</span>&nbsp;<span class="ident" id="2630054">u</span>&nbsp;<span class="op" id="2630056">&gt;</span>&nbsp;<span class="num" id="2630058">0</span>&nbsp;<span class="op" id="2630060">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630066">w</span><span class="op" id="2630067">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630074">buf</span><span class="op" id="2630077">[</span><span class="ident" id="2630078">w</span><span class="op" id="2630079">]</span>&nbsp;<span class="op" id="2630081">=</span>&nbsp;<span class="string" id="2630083">&#39;h&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630091">w</span>&nbsp;<span class="op" id="2630093">=</span>&nbsp;<span class="ident" id="2630095">fmtInt</span><span class="op" id="2630101">(</span><span class="ident" id="2630102">buf</span><span class="op" id="2630105">[</span><span class="op" id="2630106">:</span><span class="ident" id="2630107">w</span><span class="op" id="2630108">]</span><span class="op" id="2630109">,</span>&nbsp;<span class="ident" id="2630111">u</span><span class="op" id="2630112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2630117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2630121">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2630124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2630128">if</span>&nbsp;<span class="ident" id="2630131">neg</span>&nbsp;<span class="op" id="2630135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630139">w</span><span class="op" id="2630140">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630145">buf</span><span class="op" id="2630148">[</span><span class="ident" id="2630149">w</span><span class="op" id="2630150">]</span>&nbsp;<span class="op" id="2630152">=</span>&nbsp;<span class="string" id="2630154">&#39;-&#39;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2630159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2630163">return</span>&nbsp;<span class="builtintype" id="2630170">string</span><span class="op" id="2630176">(</span><span class="ident" id="2630177">buf</span><span class="op" id="2630180">[</span><span class="ident" id="2630181">w</span><span class="op" id="2630182">:</span><span class="op" id="2630183">]</span><span class="op" id="2630184">)</span><br>
<span class="lineno"></span><span class="op" id="2630186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="2630189">//&nbsp;fmtFrac&nbsp;formats&nbsp;the&nbsp;fraction&nbsp;of&nbsp;v/10**prec&nbsp;(e.g.,&nbsp;&#34;.12345&#34;)&nbsp;into&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2630261">//&nbsp;tail&nbsp;of&nbsp;buf,&nbsp;omitting&nbsp;trailing&nbsp;zeros.&nbsp;&nbsp;it&nbsp;omits&nbsp;the&nbsp;decimal</span><br>
<span class="lineno"></span><span class="comment" id="2630324">//&nbsp;point&nbsp;too&nbsp;when&nbsp;the&nbsp;fraction&nbsp;is&nbsp;0.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2630393">//&nbsp;output&nbsp;bytes&nbsp;begin&nbsp;and&nbsp;the&nbsp;value&nbsp;v/10**prec.</span><br>
<span class="lineno"></span><span class="keyword" id="2630441">func</span>&nbsp;<span class="ident" id="2630446">fmtFrac</span><span class="op" id="2630453">(</span><span class="ident" id="2630454">buf</span>&nbsp;<span class="op" id="2630458">[</span><span class="op" id="2630459">]</span><span class="builtintype" id="2630460">byte</span><span class="op" id="2630464">,</span>&nbsp;<span class="ident" id="2630466">v</span>&nbsp;<span class="ident" id="2630468">uint64</span><span class="op" id="2630474">,</span>&nbsp;<span class="ident" id="2630476">prec</span>&nbsp;<span class="builtintype" id="2630481">int</span><span class="op" id="2630484">)</span>&nbsp;<span class="op" id="2630486">(</span><span class="ident" id="2630487">nw</span>&nbsp;<span class="builtintype" id="2630490">int</span><span class="op" id="2630493">,</span>&nbsp;<span class="ident" id="2630495">nv</span>&nbsp;<span class="ident" id="2630498">uint64</span><span class="op" id="2630504">)</span>&nbsp;<span class="op" id="2630506">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2630509">//&nbsp;Omit&nbsp;trailing&nbsp;zeros&nbsp;up&nbsp;to&nbsp;and&nbsp;including&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630568">w</span>&nbsp;<span class="op" id="2630570">:=</span>&nbsp;<span class="builtinfunc" id="2630573">len</span><span class="op" id="2630576">(</span><span class="ident" id="2630577">buf</span><span class="op" id="2630580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2630583">print</span>&nbsp;<span class="op" id="2630589">:=</span>&nbsp;<span class="builtintype" id="2630592">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2630599">for</span>&nbsp;<span class="ident" id="2630603">i</span>&nbsp;<span class="op" id="2630605">:=</span>&nbsp;<span class="num" id="2630608">0</span><span class="op" id="2630609">;</span>&nbsp;<span class="ident" id="2630611">i</span>&nbsp;<span class="op" id="2630613">&lt;</span>&nbsp;<span class="ident" id="2630615">prec</span><span class="op" id="2630619">;</span>&nbsp;<span class="ident" id="2630621">i</span><span class="op" id="2630622">++</span>&nbsp;<span class="op" id="2630625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630629">digit</span>&nbsp;<span class="op" id="2630635">:=</span>&nbsp;<span class="ident" id="2630638">v</span>&nbsp;<span class="op" id="2630640">%</span>&nbsp;<span class="num" id="2630642">10</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2630647">print</span>&nbsp;<span class="op" id="2630653">=</span>&nbsp;<span class="builtinfunc" id="2630655">print</span>&nbsp;<span class="op" id="2630661">||</span>&nbsp;<span class="ident" id="2630664">digit</span>&nbsp;<span class="op" id="2630670">!=</span>&nbsp;<span class="num" id="2630673">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2630677">if</span>&nbsp;<span class="builtinfunc" id="2630680">print</span>&nbsp;<span class="op" id="2630686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630691">w</span><span class="op" id="2630692">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630698">buf</span><span class="op" id="2630701">[</span><span class="ident" id="2630702">w</span><span class="op" id="2630703">]</span>&nbsp;<span class="op" id="2630705">=</span>&nbsp;<span class="builtintype" id="2630707">byte</span><span class="op" id="2630711">(</span><span class="ident" id="2630712">digit</span><span class="op" id="2630717">)</span>&nbsp;<span class="op" id="2630719">+</span>&nbsp;<span class="string" id="2630721">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2630727">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630731">v</span>&nbsp;<span class="op" id="2630733">/=</span>&nbsp;<span class="num" id="2630736">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2630740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2630743">if</span>&nbsp;<span class="builtinfunc" id="2630746">print</span>&nbsp;<span class="op" id="2630752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630756">w</span><span class="op" id="2630757">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630762">buf</span><span class="op" id="2630765">[</span><span class="ident" id="2630766">w</span><span class="op" id="2630767">]</span>&nbsp;<span class="op" id="2630769">=</span>&nbsp;<span class="string" id="2630771">&#39;.&#39;</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2630776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2630779">return</span>&nbsp;<span class="ident" id="2630786">w</span><span class="op" id="2630787">,</span>&nbsp;<span class="ident" id="2630789">v</span><br>
<span class="lineno"></span><span class="op" id="2630791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2630794">//&nbsp;fmtInt&nbsp;formats&nbsp;v&nbsp;into&nbsp;the&nbsp;tail&nbsp;of&nbsp;buf.</span><br>
<span class="lineno">560</span><span class="comment" id="2630836">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;where&nbsp;the&nbsp;output&nbsp;begins.</span><br>
<span class="lineno"></span><span class="keyword" id="2630885">func</span>&nbsp;<span class="ident" id="2630890">fmtInt</span><span class="op" id="2630896">(</span><span class="ident" id="2630897">buf</span>&nbsp;<span class="op" id="2630901">[</span><span class="op" id="2630902">]</span><span class="builtintype" id="2630903">byte</span><span class="op" id="2630907">,</span>&nbsp;<span class="ident" id="2630909">v</span>&nbsp;<span class="ident" id="2630911">uint64</span><span class="op" id="2630917">)</span>&nbsp;<span class="builtintype" id="2630919">int</span>&nbsp;<span class="op" id="2630923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630926">w</span>&nbsp;<span class="op" id="2630928">:=</span>&nbsp;<span class="builtinfunc" id="2630931">len</span><span class="op" id="2630934">(</span><span class="ident" id="2630935">buf</span><span class="op" id="2630938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2630941">if</span>&nbsp;<span class="ident" id="2630944">v</span>&nbsp;<span class="op" id="2630946">==</span>&nbsp;<span class="num" id="2630949">0</span>&nbsp;<span class="op" id="2630951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630955">w</span><span class="op" id="2630956">--</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2630961">buf</span><span class="op" id="2630964">[</span><span class="ident" id="2630965">w</span><span class="op" id="2630966">]</span>&nbsp;<span class="op" id="2630968">=</span>&nbsp;<span class="string" id="2630970">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2630975">}</span>&nbsp;<span class="keyword" id="2630977">else</span>&nbsp;<span class="op" id="2630982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2630986">for</span>&nbsp;<span class="ident" id="2630990">v</span>&nbsp;<span class="op" id="2630992">&gt;</span>&nbsp;<span class="num" id="2630994">0</span>&nbsp;<span class="op" id="2630996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2631001">w</span><span class="op" id="2631002">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2631008">buf</span><span class="op" id="2631011">[</span><span class="ident" id="2631012">w</span><span class="op" id="2631013">]</span>&nbsp;<span class="op" id="2631015">=</span>&nbsp;<span class="builtintype" id="2631017">byte</span><span class="op" id="2631021">(</span><span class="ident" id="2631022">v</span><span class="op" id="2631023">%</span><span class="num" id="2631024">10</span><span class="op" id="2631026">)</span>&nbsp;<span class="op" id="2631028">+</span>&nbsp;<span class="string" id="2631030">&#39;0&#39;</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2631037">v</span>&nbsp;<span class="op" id="2631039">/=</span>&nbsp;<span class="num" id="2631042">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2631047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2631050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2631053">return</span>&nbsp;<span class="ident" id="2631060">w</span><br>
<span class="lineno"></span><span class="op" id="2631062">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="2631065">//&nbsp;Nanoseconds&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;an&nbsp;integer&nbsp;nanosecond&nbsp;count.</span><br>
<span class="lineno"></span><span class="keyword" id="2631133">func</span>&nbsp;<span class="op" id="2631138">(</span><span class="ident" id="2631139">d</span>&nbsp;<span class="ident" id="2631141">Duration</span><span class="op" id="2631149">)</span>&nbsp;<span class="ident" id="2631151">Nanoseconds</span><span class="op" id="2631162">(</span><span class="op" id="2631163">)</span>&nbsp;<span class="ident" id="2631165">int64</span>&nbsp;<span class="op" id="2631171">{</span>&nbsp;<span class="keyword" id="2631173">return</span>&nbsp;<span class="ident" id="2631180">int64</span><span class="op" id="2631185">(</span><span class="ident" id="2631186">d</span><span class="op" id="2631187">)</span>&nbsp;<span class="op" id="2631189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2631192">//&nbsp;These&nbsp;methods&nbsp;return&nbsp;float64&nbsp;because&nbsp;the&nbsp;dominant</span><br>
<span class="lineno">580</span><span class="comment" id="2631245">//&nbsp;use&nbsp;case&nbsp;is&nbsp;for&nbsp;printing&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;like&nbsp;1.5s,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2631312">//&nbsp;a&nbsp;truncation&nbsp;to&nbsp;integer&nbsp;would&nbsp;make&nbsp;them&nbsp;not&nbsp;useful&nbsp;in&nbsp;those&nbsp;cases.</span><br>
<span class="lineno"></span><span class="comment" id="2631382">//&nbsp;Splitting&nbsp;the&nbsp;integer&nbsp;and&nbsp;fraction&nbsp;ourselves&nbsp;guarantees&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2631446">//&nbsp;converting&nbsp;the&nbsp;returned&nbsp;float64&nbsp;to&nbsp;an&nbsp;integer&nbsp;rounds&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="2631511">//&nbsp;way&nbsp;that&nbsp;a&nbsp;pure&nbsp;integer&nbsp;conversion&nbsp;would&nbsp;have,&nbsp;even&nbsp;in&nbsp;cases</span><br>
<span class="lineno">585</span><span class="comment" id="2631575">//&nbsp;where,&nbsp;say,&nbsp;float64(d.Nanoseconds())/1e9&nbsp;would&nbsp;have&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="2631638">//&nbsp;differently.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2631655">//&nbsp;Seconds&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;seconds.</span><br>
<span class="lineno"></span><span class="keyword" id="2631726">func</span>&nbsp;<span class="op" id="2631731">(</span><span class="ident" id="2631732">d</span>&nbsp;<span class="ident" id="2631734">Duration</span><span class="op" id="2631742">)</span>&nbsp;<span class="ident" id="2631744">Seconds</span><span class="op" id="2631751">(</span><span class="op" id="2631752">)</span>&nbsp;<span class="builtintype" id="2631754">float64</span>&nbsp;<span class="op" id="2631762">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2631765">sec</span>&nbsp;<span class="op" id="2631769">:=</span>&nbsp;<span class="ident" id="2631772">d</span>&nbsp;<span class="op" id="2631774">/</span>&nbsp;<span class="ident" id="2631776">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2631784">nsec</span>&nbsp;<span class="op" id="2631789">:=</span>&nbsp;<span class="ident" id="2631792">d</span>&nbsp;<span class="op" id="2631794">%</span>&nbsp;<span class="ident" id="2631796">Second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2631804">return</span>&nbsp;<span class="builtintype" id="2631811">float64</span><span class="op" id="2631818">(</span><span class="ident" id="2631819">sec</span><span class="op" id="2631822">)</span>&nbsp;<span class="op" id="2631824">+</span>&nbsp;<span class="builtintype" id="2631826">float64</span><span class="op" id="2631833">(</span><span class="ident" id="2631834">nsec</span><span class="op" id="2631838">)</span><span class="op" id="2631839">*</span><span class="num" id="2631840">1e-9</span><br>
<span class="lineno"></span><span class="op" id="2631845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="2631848">//&nbsp;Minutes&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;minutes.</span><br>
<span class="lineno"></span><span class="keyword" id="2631919">func</span>&nbsp;<span class="op" id="2631924">(</span><span class="ident" id="2631925">d</span>&nbsp;<span class="ident" id="2631927">Duration</span><span class="op" id="2631935">)</span>&nbsp;<span class="ident" id="2631937">Minutes</span><span class="op" id="2631944">(</span><span class="op" id="2631945">)</span>&nbsp;<span class="builtintype" id="2631947">float64</span>&nbsp;<span class="op" id="2631955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2631958">min</span>&nbsp;<span class="op" id="2631962">:=</span>&nbsp;<span class="ident" id="2631965">d</span>&nbsp;<span class="op" id="2631967">/</span>&nbsp;<span class="ident" id="2631969">Minute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2631977">nsec</span>&nbsp;<span class="op" id="2631982">:=</span>&nbsp;<span class="ident" id="2631985">d</span>&nbsp;<span class="op" id="2631987">%</span>&nbsp;<span class="ident" id="2631989">Minute</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2631997">return</span>&nbsp;<span class="builtintype" id="2632004">float64</span><span class="op" id="2632011">(</span><span class="ident" id="2632012">min</span><span class="op" id="2632015">)</span>&nbsp;<span class="op" id="2632017">+</span>&nbsp;<span class="builtintype" id="2632019">float64</span><span class="op" id="2632026">(</span><span class="ident" id="2632027">nsec</span><span class="op" id="2632031">)</span><span class="op" id="2632032">*</span><span class="op" id="2632033">(</span><span class="num" id="2632034">1e-9</span><span class="op" id="2632038">/</span><span class="num" id="2632039">60</span><span class="op" id="2632041">)</span><br>
<span class="lineno">600</span><span class="op" id="2632043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2632046">//&nbsp;Hours&nbsp;returns&nbsp;the&nbsp;duration&nbsp;as&nbsp;a&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;hours.</span><br>
<span class="lineno"></span><span class="keyword" id="2632113">func</span>&nbsp;<span class="op" id="2632118">(</span><span class="ident" id="2632119">d</span>&nbsp;<span class="ident" id="2632121">Duration</span><span class="op" id="2632129">)</span>&nbsp;<span class="ident" id="2632131">Hours</span><span class="op" id="2632136">(</span><span class="op" id="2632137">)</span>&nbsp;<span class="builtintype" id="2632139">float64</span>&nbsp;<span class="op" id="2632147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2632150">hour</span>&nbsp;<span class="op" id="2632155">:=</span>&nbsp;<span class="ident" id="2632158">d</span>&nbsp;<span class="op" id="2632160">/</span>&nbsp;<span class="ident" id="2632162">Hour</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2632168">nsec</span>&nbsp;<span class="op" id="2632173">:=</span>&nbsp;<span class="ident" id="2632176">d</span>&nbsp;<span class="op" id="2632178">%</span>&nbsp;<span class="ident" id="2632180">Hour</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2632186">return</span>&nbsp;<span class="builtintype" id="2632193">float64</span><span class="op" id="2632200">(</span><span class="ident" id="2632201">hour</span><span class="op" id="2632205">)</span>&nbsp;<span class="op" id="2632207">+</span>&nbsp;<span class="builtintype" id="2632209">float64</span><span class="op" id="2632216">(</span><span class="ident" id="2632217">nsec</span><span class="op" id="2632221">)</span><span class="op" id="2632222">*</span><span class="op" id="2632223">(</span><span class="num" id="2632224">1e-9</span><span class="op" id="2632228">/</span><span class="num" id="2632229">60</span><span class="op" id="2632231">/</span><span class="num" id="2632232">60</span><span class="op" id="2632234">)</span><br>
<span class="lineno"></span><span class="op" id="2632236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2632239">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;time&nbsp;t+d.</span><br>
<span class="lineno">610</span><span class="keyword" id="2632268">func</span>&nbsp;<span class="op" id="2632273">(</span><span class="ident" id="2632274">t</span>&nbsp;<span class="ident" id="2632276">Time</span><span class="op" id="2632280">)</span>&nbsp;<span class="ident" id="2632282">Add</span><span class="op" id="2632285">(</span><span class="ident" id="2632286">d</span>&nbsp;<span class="ident" id="2632288">Duration</span><span class="op" id="2632296">)</span>&nbsp;<span class="ident" id="2632298">Time</span>&nbsp;<span class="op" id="2632303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2632306">t</span><span class="op" id="2632307">.</span><span class="ident" id="2632308">sec</span>&nbsp;<span class="op" id="2632312">+=</span>&nbsp;<span class="ident" id="2632315">int64</span><span class="op" id="2632320">(</span><span class="ident" id="2632321">d</span>&nbsp;<span class="op" id="2632323">/</span>&nbsp;<span class="num" id="2632325">1e9</span><span class="op" id="2632328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2632331">nsec</span>&nbsp;<span class="op" id="2632336">:=</span>&nbsp;<span class="builtintype" id="2632339">int32</span><span class="op" id="2632344">(</span><span class="ident" id="2632345">t</span><span class="op" id="2632346">.</span><span class="ident" id="2632347">nsec</span><span class="op" id="2632351">)</span>&nbsp;<span class="op" id="2632353">+</span>&nbsp;<span class="builtintype" id="2632355">int32</span><span class="op" id="2632360">(</span><span class="ident" id="2632361">d</span><span class="op" id="2632362">%</span><span class="num" id="2632363">1e9</span><span class="op" id="2632366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2632369">if</span>&nbsp;<span class="ident" id="2632372">nsec</span>&nbsp;<span class="op" id="2632377">&gt;=</span>&nbsp;<span class="num" id="2632380">1e9</span>&nbsp;<span class="op" id="2632384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2632388">t</span><span class="op" id="2632389">.</span><span class="ident" id="2632390">sec</span><span class="op" id="2632393">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2632398">nsec</span>&nbsp;<span class="op" id="2632403">-=</span>&nbsp;<span class="num" id="2632406">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2632411">}</span>&nbsp;<span class="keyword" id="2632413">else</span>&nbsp;<span class="keyword" id="2632418">if</span>&nbsp;<span class="ident" id="2632421">nsec</span>&nbsp;<span class="op" id="2632426">&lt;</span>&nbsp;<span class="num" id="2632428">0</span>&nbsp;<span class="op" id="2632430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2632434">t</span><span class="op" id="2632435">.</span><span class="ident" id="2632436">sec</span><span class="op" id="2632439">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2632444">nsec</span>&nbsp;<span class="op" id="2632449">+=</span>&nbsp;<span class="num" id="2632452">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2632457">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2632460">t</span><span class="op" id="2632461">.</span><span class="ident" id="2632462">nsec</span>&nbsp;<span class="op" id="2632467">=</span>&nbsp;<span class="ident" id="2632469">nsec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2632475">return</span>&nbsp;<span class="ident" id="2632482">t</span><br>
<span class="lineno"></span><span class="op" id="2632484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2632487">//&nbsp;Sub&nbsp;returns&nbsp;the&nbsp;duration&nbsp;t-u.&nbsp;If&nbsp;the&nbsp;result&nbsp;exceeds&nbsp;the&nbsp;maximum&nbsp;(or&nbsp;minimum)</span><br>
<span class="lineno">625</span><span class="comment" id="2632567">//&nbsp;value&nbsp;that&nbsp;can&nbsp;be&nbsp;stored&nbsp;in&nbsp;a&nbsp;Duration,&nbsp;the&nbsp;maximum&nbsp;(or&nbsp;minimum)&nbsp;duration</span><br>
<span class="lineno"></span><span class="comment" id="2632644">//&nbsp;will&nbsp;be&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="2632665">//&nbsp;To&nbsp;compute&nbsp;t-d&nbsp;for&nbsp;a&nbsp;duration&nbsp;d,&nbsp;use&nbsp;t.Add(-d).</span><br>
<span class="lineno"></span><span class="keyword" id="2632716">func</span>&nbsp;<span class="op" id="2632721">(</span><span class="ident" id="2632722">t</span>&nbsp;<span class="ident" id="2632724">Time</span><span class="op" id="2632728">)</span>&nbsp;<span class="ident" id="2632730">Sub</span><span class="op" id="2632733">(</span><span class="ident" id="2632734">u</span>&nbsp;<span class="ident" id="2632736">Time</span><span class="op" id="2632740">)</span>&nbsp;<span class="ident" id="2632742">Duration</span>&nbsp;<span class="op" id="2632751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2632754">d</span>&nbsp;<span class="op" id="2632756">:=</span>&nbsp;<span class="ident" id="2632759">Duration</span><span class="op" id="2632767">(</span><span class="ident" id="2632768">t</span><span class="op" id="2632769">.</span><span class="ident" id="2632770">sec</span><span class="op" id="2632773">-</span><span class="ident" id="2632774">u</span><span class="op" id="2632775">.</span><span class="ident" id="2632776">sec</span><span class="op" id="2632779">)</span><span class="op" id="2632780">*</span><span class="ident" id="2632781">Second</span>&nbsp;<span class="op" id="2632788">+</span>&nbsp;<span class="ident" id="2632790">Duration</span><span class="op" id="2632798">(</span><span class="builtintype" id="2632799">int32</span><span class="op" id="2632804">(</span><span class="ident" id="2632805">t</span><span class="op" id="2632806">.</span><span class="ident" id="2632807">nsec</span><span class="op" id="2632811">)</span><span class="op" id="2632812">-</span><span class="builtintype" id="2632813">int32</span><span class="op" id="2632818">(</span><span class="ident" id="2632819">u</span><span class="op" id="2632820">.</span><span class="ident" id="2632821">nsec</span><span class="op" id="2632825">)</span><span class="op" id="2632826">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2632829">//&nbsp;Check&nbsp;for&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2632866">switch</span>&nbsp;<span class="op" id="2632873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2632876">case</span>&nbsp;<span class="ident" id="2632881">u</span><span class="op" id="2632882">.</span><span class="ident" id="2632883">Add</span><span class="op" id="2632886">(</span><span class="ident" id="2632887">d</span><span class="op" id="2632888">)</span><span class="op" id="2632889">.</span><span class="ident" id="2632890">Equal</span><span class="op" id="2632895">(</span><span class="ident" id="2632896">t</span><span class="op" id="2632897">)</span><span class="op" id="2632898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2632902">return</span>&nbsp;<span class="ident" id="2632909">d</span>&nbsp;<span class="comment" id="2632911">//&nbsp;d&nbsp;is&nbsp;correct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2632928">case</span>&nbsp;<span class="ident" id="2632933">t</span><span class="op" id="2632934">.</span><span class="ident" id="2632935">Before</span><span class="op" id="2632941">(</span><span class="ident" id="2632942">u</span><span class="op" id="2632943">)</span><span class="op" id="2632944">:</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2632948">return</span>&nbsp;<span class="ident" id="2632955">minDuration</span>&nbsp;<span class="comment" id="2632967">//&nbsp;t&nbsp;-&nbsp;u&nbsp;is&nbsp;negative&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2633002">default</span><span class="op" id="2633009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2633013">return</span>&nbsp;<span class="ident" id="2633020">maxDuration</span>&nbsp;<span class="comment" id="2633032">//&nbsp;t&nbsp;-&nbsp;u&nbsp;is&nbsp;positive&nbsp;out&nbsp;of&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2633067">}</span><br>
<span class="lineno"></span><span class="op" id="2633069">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span><span class="comment" id="2633072">//&nbsp;Since&nbsp;returns&nbsp;the&nbsp;time&nbsp;elapsed&nbsp;since&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2633115">//&nbsp;It&nbsp;is&nbsp;shorthand&nbsp;for&nbsp;time.Now().Sub(t).</span><br>
<span class="lineno"></span><span class="keyword" id="2633157">func</span>&nbsp;<span class="ident" id="2633162">Since</span><span class="op" id="2633167">(</span><span class="ident" id="2633168">t</span>&nbsp;<span class="ident" id="2633170">Time</span><span class="op" id="2633174">)</span>&nbsp;<span class="ident" id="2633176">Duration</span>&nbsp;<span class="op" id="2633185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2633188">return</span>&nbsp;<span class="ident" id="2633195">Now</span><span class="op" id="2633198">(</span><span class="op" id="2633199">)</span><span class="op" id="2633200">.</span><span class="ident" id="2633201">Sub</span><span class="op" id="2633204">(</span><span class="ident" id="2633205">t</span><span class="op" id="2633206">)</span><br>
<span class="lineno">645</span><span class="op" id="2633208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2633211">//&nbsp;AddDate&nbsp;returns&nbsp;the&nbsp;time&nbsp;corresponding&nbsp;to&nbsp;adding&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2633267">//&nbsp;given&nbsp;number&nbsp;of&nbsp;years,&nbsp;months,&nbsp;and&nbsp;days&nbsp;to&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="2633316">//&nbsp;For&nbsp;example,&nbsp;AddDate(-1,&nbsp;2,&nbsp;3)&nbsp;applied&nbsp;to&nbsp;January&nbsp;1,&nbsp;2011</span><br>
<span class="lineno">650</span><span class="comment" id="2633377">//&nbsp;returns&nbsp;March&nbsp;4,&nbsp;2010.</span><br>
<span class="lineno"></span><span class="comment" id="2633403">//</span><br>
<span class="lineno"></span><span class="comment" id="2633406">//&nbsp;AddDate&nbsp;normalizes&nbsp;its&nbsp;result&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;that&nbsp;Date&nbsp;does,</span><br>
<span class="lineno"></span><span class="comment" id="2633471">//&nbsp;so,&nbsp;for&nbsp;example,&nbsp;adding&nbsp;one&nbsp;month&nbsp;to&nbsp;October&nbsp;31&nbsp;yields</span><br>
<span class="lineno"></span><span class="comment" id="2633529">//&nbsp;December&nbsp;1,&nbsp;the&nbsp;normalized&nbsp;form&nbsp;for&nbsp;November&nbsp;31.</span><br>
<span class="lineno">655</span><span class="keyword" id="2633581">func</span>&nbsp;<span class="op" id="2633586">(</span><span class="ident" id="2633587">t</span>&nbsp;<span class="ident" id="2633589">Time</span><span class="op" id="2633593">)</span>&nbsp;<span class="ident" id="2633595">AddDate</span><span class="op" id="2633602">(</span><span class="ident" id="2633603">years</span>&nbsp;<span class="builtintype" id="2633609">int</span><span class="op" id="2633612">,</span>&nbsp;<span class="ident" id="2633614">months</span>&nbsp;<span class="builtintype" id="2633621">int</span><span class="op" id="2633624">,</span>&nbsp;<span class="ident" id="2633626">days</span>&nbsp;<span class="builtintype" id="2633631">int</span><span class="op" id="2633634">)</span>&nbsp;<span class="ident" id="2633636">Time</span>&nbsp;<span class="op" id="2633641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2633644">year</span><span class="op" id="2633648">,</span>&nbsp;<span class="ident" id="2633650">month</span><span class="op" id="2633655">,</span>&nbsp;<span class="ident" id="2633657">day</span>&nbsp;<span class="op" id="2633661">:=</span>&nbsp;<span class="ident" id="2633664">t</span><span class="op" id="2633665">.</span><span class="ident" id="2633666">Date</span><span class="op" id="2633670">(</span><span class="op" id="2633671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2633674">hour</span><span class="op" id="2633678">,</span>&nbsp;<span class="ident" id="2633680">min</span><span class="op" id="2633683">,</span>&nbsp;<span class="ident" id="2633685">sec</span>&nbsp;<span class="op" id="2633689">:=</span>&nbsp;<span class="ident" id="2633692">t</span><span class="op" id="2633693">.</span><span class="ident" id="2633694">Clock</span><span class="op" id="2633699">(</span><span class="op" id="2633700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2633703">return</span>&nbsp;<span class="ident" id="2633710">Date</span><span class="op" id="2633714">(</span><span class="ident" id="2633715">year</span><span class="op" id="2633719">+</span><span class="ident" id="2633720">years</span><span class="op" id="2633725">,</span>&nbsp;<span class="ident" id="2633727">month</span><span class="op" id="2633732">+</span><span class="ident" id="2633733">Month</span><span class="op" id="2633738">(</span><span class="ident" id="2633739">months</span><span class="op" id="2633745">)</span><span class="op" id="2633746">,</span>&nbsp;<span class="ident" id="2633748">day</span><span class="op" id="2633751">+</span><span class="ident" id="2633752">days</span><span class="op" id="2633756">,</span>&nbsp;<span class="ident" id="2633758">hour</span><span class="op" id="2633762">,</span>&nbsp;<span class="ident" id="2633764">min</span><span class="op" id="2633767">,</span>&nbsp;<span class="ident" id="2633769">sec</span><span class="op" id="2633772">,</span>&nbsp;<span class="builtintype" id="2633774">int</span><span class="op" id="2633777">(</span><span class="ident" id="2633778">t</span><span class="op" id="2633779">.</span><span class="ident" id="2633780">nsec</span><span class="op" id="2633784">)</span><span class="op" id="2633785">,</span>&nbsp;<span class="ident" id="2633787">t</span><span class="op" id="2633788">.</span><span class="ident" id="2633789">loc</span><span class="op" id="2633792">)</span><br>
<span class="lineno"></span><span class="op" id="2633794">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="keyword" id="2633797">const</span>&nbsp;<span class="op" id="2633803">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2633806">secondsPerMinute</span>&nbsp;<span class="op" id="2633823">=</span>&nbsp;<span class="num" id="2633825">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2633829">secondsPerHour</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2633846">=</span>&nbsp;<span class="num" id="2633848">60</span>&nbsp;<span class="op" id="2633851">*</span>&nbsp;<span class="num" id="2633853">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2633857">secondsPerDay</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2633874">=</span>&nbsp;<span class="num" id="2633876">24</span>&nbsp;<span class="op" id="2633879">*</span>&nbsp;<span class="ident" id="2633881">secondsPerHour</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2633897">secondsPerWeek</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2633914">=</span>&nbsp;<span class="num" id="2633916">7</span>&nbsp;<span class="op" id="2633918">*</span>&nbsp;<span class="ident" id="2633920">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2633935">daysPer400Years</span>&nbsp;&nbsp;<span class="op" id="2633952">=</span>&nbsp;<span class="num" id="2633954">365</span><span class="op" id="2633957">*</span><span class="num" id="2633958">400</span>&nbsp;<span class="op" id="2633962">+</span>&nbsp;<span class="num" id="2633964">97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2633968">daysPer100Years</span>&nbsp;&nbsp;<span class="op" id="2633985">=</span>&nbsp;<span class="num" id="2633987">365</span><span class="op" id="2633990">*</span><span class="num" id="2633991">100</span>&nbsp;<span class="op" id="2633995">+</span>&nbsp;<span class="num" id="2633997">24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2634001">daysPer4Years</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2634018">=</span>&nbsp;<span class="num" id="2634020">365</span><span class="op" id="2634023">*</span><span class="num" id="2634024">4</span>&nbsp;<span class="op" id="2634026">+</span>&nbsp;<span class="num" id="2634028">1</span><br>
<span class="lineno"></span><span class="op" id="2634030">)</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="2634033">//&nbsp;date&nbsp;computes&nbsp;the&nbsp;year,&nbsp;day&nbsp;of&nbsp;year,&nbsp;and&nbsp;when&nbsp;full=true,</span><br>
<span class="lineno"></span><span class="comment" id="2634093">//&nbsp;the&nbsp;month&nbsp;and&nbsp;day&nbsp;in&nbsp;which&nbsp;t&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="2634133">func</span>&nbsp;<span class="op" id="2634138">(</span><span class="ident" id="2634139">t</span>&nbsp;<span class="ident" id="2634141">Time</span><span class="op" id="2634145">)</span>&nbsp;<span class="ident" id="2634147">date</span><span class="op" id="2634151">(</span><span class="ident" id="2634152">full</span>&nbsp;<span class="builtintype" id="2634157">bool</span><span class="op" id="2634161">)</span>&nbsp;<span class="op" id="2634163">(</span><span class="ident" id="2634164">year</span>&nbsp;<span class="builtintype" id="2634169">int</span><span class="op" id="2634172">,</span>&nbsp;<span class="ident" id="2634174">month</span>&nbsp;<span class="ident" id="2634180">Month</span><span class="op" id="2634185">,</span>&nbsp;<span class="ident" id="2634187">day</span>&nbsp;<span class="builtintype" id="2634191">int</span><span class="op" id="2634194">,</span>&nbsp;<span class="ident" id="2634196">yday</span>&nbsp;<span class="builtintype" id="2634201">int</span><span class="op" id="2634204">)</span>&nbsp;<span class="op" id="2634206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2634209">return</span>&nbsp;<span class="ident" id="2634216">absDate</span><span class="op" id="2634223">(</span><span class="ident" id="2634224">t</span><span class="op" id="2634225">.</span><span class="ident" id="2634226">abs</span><span class="op" id="2634229">(</span><span class="op" id="2634230">)</span><span class="op" id="2634231">,</span>&nbsp;<span class="ident" id="2634233">full</span><span class="op" id="2634237">)</span><br>
<span class="lineno">675</span><span class="op" id="2634239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2634242">//&nbsp;absDate&nbsp;is&nbsp;like&nbsp;date&nbsp;but&nbsp;operates&nbsp;on&nbsp;an&nbsp;absolute&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2634300">func</span>&nbsp;<span class="ident" id="2634305">absDate</span><span class="op" id="2634312">(</span><span class="ident" id="2634313">abs</span>&nbsp;<span class="ident" id="2634317">uint64</span><span class="op" id="2634323">,</span>&nbsp;<span class="ident" id="2634325">full</span>&nbsp;<span class="builtintype" id="2634330">bool</span><span class="op" id="2634334">)</span>&nbsp;<span class="op" id="2634336">(</span><span class="ident" id="2634337">year</span>&nbsp;<span class="builtintype" id="2634342">int</span><span class="op" id="2634345">,</span>&nbsp;<span class="ident" id="2634347">month</span>&nbsp;<span class="ident" id="2634353">Month</span><span class="op" id="2634358">,</span>&nbsp;<span class="ident" id="2634360">day</span>&nbsp;<span class="builtintype" id="2634364">int</span><span class="op" id="2634367">,</span>&nbsp;<span class="ident" id="2634369">yday</span>&nbsp;<span class="builtintype" id="2634374">int</span><span class="op" id="2634377">)</span>&nbsp;<span class="op" id="2634379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2634382">//&nbsp;Split&nbsp;into&nbsp;time&nbsp;and&nbsp;day.</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2634411">d</span>&nbsp;<span class="op" id="2634413">:=</span>&nbsp;<span class="ident" id="2634416">abs</span>&nbsp;<span class="op" id="2634420">/</span>&nbsp;<span class="ident" id="2634422">secondsPerDay</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2634438">//&nbsp;Account&nbsp;for&nbsp;400&nbsp;year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2634471">n</span>&nbsp;<span class="op" id="2634473">:=</span>&nbsp;<span class="ident" id="2634476">d</span>&nbsp;<span class="op" id="2634478">/</span>&nbsp;<span class="ident" id="2634480">daysPer400Years</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2634497">y</span>&nbsp;<span class="op" id="2634499">:=</span>&nbsp;<span class="num" id="2634502">400</span>&nbsp;<span class="op" id="2634506">*</span>&nbsp;<span class="ident" id="2634508">n</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2634511">d</span>&nbsp;<span class="op" id="2634513">-=</span>&nbsp;<span class="ident" id="2634516">daysPer400Years</span>&nbsp;<span class="op" id="2634532">*</span>&nbsp;<span class="ident" id="2634534">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2634538">//&nbsp;Cut&nbsp;off&nbsp;100-year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2634567">//&nbsp;The&nbsp;last&nbsp;cycle&nbsp;has&nbsp;one&nbsp;extra&nbsp;leap&nbsp;year,&nbsp;so&nbsp;on&nbsp;the&nbsp;last&nbsp;day</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2634630">//&nbsp;of&nbsp;that&nbsp;year,&nbsp;day&nbsp;/&nbsp;daysPer100Years&nbsp;will&nbsp;be&nbsp;4&nbsp;instead&nbsp;of&nbsp;3.</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2634694">//&nbsp;Cut&nbsp;it&nbsp;back&nbsp;down&nbsp;to&nbsp;3&nbsp;by&nbsp;subtracting&nbsp;n&gt;&gt;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2634741">n</span>&nbsp;<span class="op" id="2634743">=</span>&nbsp;<span class="ident" id="2634745">d</span>&nbsp;<span class="op" id="2634747">/</span>&nbsp;<span class="ident" id="2634749">daysPer100Years</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2634766">n</span>&nbsp;<span class="op" id="2634768">-=</span>&nbsp;<span class="ident" id="2634771">n</span>&nbsp;<span class="op" id="2634773">&gt;&gt;</span>&nbsp;<span class="num" id="2634776">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2634779">y</span>&nbsp;<span class="op" id="2634781">+=</span>&nbsp;<span class="num" id="2634784">100</span>&nbsp;<span class="op" id="2634788">*</span>&nbsp;<span class="ident" id="2634790">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2634793">d</span>&nbsp;<span class="op" id="2634795">-=</span>&nbsp;<span class="ident" id="2634798">daysPer100Years</span>&nbsp;<span class="op" id="2634814">*</span>&nbsp;<span class="ident" id="2634816">n</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2634820">//&nbsp;Cut&nbsp;off&nbsp;4-year&nbsp;cycles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2634847">//&nbsp;The&nbsp;last&nbsp;cycle&nbsp;has&nbsp;a&nbsp;missing&nbsp;leap&nbsp;year,&nbsp;which&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2634906">//&nbsp;affect&nbsp;the&nbsp;computation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2634934">n</span>&nbsp;<span class="op" id="2634936">=</span>&nbsp;<span class="ident" id="2634938">d</span>&nbsp;<span class="op" id="2634940">/</span>&nbsp;<span class="ident" id="2634942">daysPer4Years</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2634957">y</span>&nbsp;<span class="op" id="2634959">+=</span>&nbsp;<span class="num" id="2634962">4</span>&nbsp;<span class="op" id="2634964">*</span>&nbsp;<span class="ident" id="2634966">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2634969">d</span>&nbsp;<span class="op" id="2634971">-=</span>&nbsp;<span class="ident" id="2634974">daysPer4Years</span>&nbsp;<span class="op" id="2634988">*</span>&nbsp;<span class="ident" id="2634990">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2634994">//&nbsp;Cut&nbsp;off&nbsp;years&nbsp;within&nbsp;a&nbsp;4-year&nbsp;cycle.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2635035">//&nbsp;The&nbsp;last&nbsp;year&nbsp;is&nbsp;a&nbsp;leap&nbsp;year,&nbsp;so&nbsp;on&nbsp;the&nbsp;last&nbsp;day&nbsp;of&nbsp;that&nbsp;year,</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2635102">//&nbsp;day&nbsp;/&nbsp;365&nbsp;will&nbsp;be&nbsp;4&nbsp;instead&nbsp;of&nbsp;3.&nbsp;&nbsp;Cut&nbsp;it&nbsp;back&nbsp;down&nbsp;to&nbsp;3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2635163">//&nbsp;by&nbsp;subtracting&nbsp;n&gt;&gt;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635188">n</span>&nbsp;<span class="op" id="2635190">=</span>&nbsp;<span class="ident" id="2635192">d</span>&nbsp;<span class="op" id="2635194">/</span>&nbsp;<span class="num" id="2635196">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635201">n</span>&nbsp;<span class="op" id="2635203">-=</span>&nbsp;<span class="ident" id="2635206">n</span>&nbsp;<span class="op" id="2635208">&gt;&gt;</span>&nbsp;<span class="num" id="2635211">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635214">y</span>&nbsp;<span class="op" id="2635216">+=</span>&nbsp;<span class="ident" id="2635219">n</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635222">d</span>&nbsp;<span class="op" id="2635224">-=</span>&nbsp;<span class="num" id="2635227">365</span>&nbsp;<span class="op" id="2635231">*</span>&nbsp;<span class="ident" id="2635233">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635237">year</span>&nbsp;<span class="op" id="2635242">=</span>&nbsp;<span class="builtintype" id="2635244">int</span><span class="op" id="2635247">(</span><span class="ident" id="2635248">int64</span><span class="op" id="2635253">(</span><span class="ident" id="2635254">y</span><span class="op" id="2635255">)</span>&nbsp;<span class="op" id="2635257">+</span>&nbsp;<span class="ident" id="2635259">absoluteZeroYear</span><span class="op" id="2635275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635278">yday</span>&nbsp;<span class="op" id="2635283">=</span>&nbsp;<span class="builtintype" id="2635285">int</span><span class="op" id="2635288">(</span><span class="ident" id="2635289">d</span><span class="op" id="2635290">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2635294">if</span>&nbsp;<span class="op" id="2635297">!</span><span class="ident" id="2635298">full</span>&nbsp;<span class="op" id="2635303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2635307">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2635315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635319">day</span>&nbsp;<span class="op" id="2635323">=</span>&nbsp;<span class="ident" id="2635325">yday</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2635331">if</span>&nbsp;<span class="ident" id="2635334">isLeap</span><span class="op" id="2635340">(</span><span class="ident" id="2635341">year</span><span class="op" id="2635345">)</span>&nbsp;<span class="op" id="2635347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2635351">//&nbsp;Leap&nbsp;year</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2635366">switch</span>&nbsp;<span class="op" id="2635373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2635377">case</span>&nbsp;<span class="ident" id="2635382">day</span>&nbsp;<span class="op" id="2635386">&gt;</span>&nbsp;<span class="num" id="2635388">31</span><span class="op" id="2635390">+</span><span class="num" id="2635391">29</span><span class="op" id="2635393">-</span><span class="num" id="2635394">1</span><span class="op" id="2635395">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2635400">//&nbsp;After&nbsp;leap&nbsp;day;&nbsp;pretend&nbsp;it&nbsp;wasn&#39;t&nbsp;there.</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635447">day</span><span class="op" id="2635450">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2635455">case</span>&nbsp;<span class="ident" id="2635460">day</span>&nbsp;<span class="op" id="2635464">==</span>&nbsp;<span class="num" id="2635467">31</span><span class="op" id="2635469">+</span><span class="num" id="2635470">29</span><span class="op" id="2635472">-</span><span class="num" id="2635473">1</span><span class="op" id="2635474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2635479">//&nbsp;Leap&nbsp;day.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635495">month</span>&nbsp;<span class="op" id="2635501">=</span>&nbsp;<span class="ident" id="2635503">February</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635515">day</span>&nbsp;<span class="op" id="2635519">=</span>&nbsp;<span class="num" id="2635521">29</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2635527">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2635536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2635539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2635543">//&nbsp;Estimate&nbsp;month&nbsp;on&nbsp;assumption&nbsp;that&nbsp;every&nbsp;month&nbsp;has&nbsp;31&nbsp;days.</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2635606">//&nbsp;The&nbsp;estimate&nbsp;may&nbsp;be&nbsp;too&nbsp;low&nbsp;by&nbsp;at&nbsp;most&nbsp;one&nbsp;month,&nbsp;so&nbsp;adjust.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635671">month</span>&nbsp;<span class="op" id="2635677">=</span>&nbsp;<span class="ident" id="2635679">Month</span><span class="op" id="2635684">(</span><span class="ident" id="2635685">day</span>&nbsp;<span class="op" id="2635689">/</span>&nbsp;<span class="num" id="2635691">31</span><span class="op" id="2635693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635696">end</span>&nbsp;<span class="op" id="2635700">:=</span>&nbsp;<span class="builtintype" id="2635703">int</span><span class="op" id="2635706">(</span><span class="ident" id="2635707">daysBefore</span><span class="op" id="2635717">[</span><span class="ident" id="2635718">month</span><span class="op" id="2635723">+</span><span class="num" id="2635724">1</span><span class="op" id="2635725">]</span><span class="op" id="2635726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2635729">var</span>&nbsp;<span class="ident" id="2635733">begin</span>&nbsp;<span class="builtintype" id="2635739">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2635744">if</span>&nbsp;<span class="ident" id="2635747">day</span>&nbsp;<span class="op" id="2635751">&gt;=</span>&nbsp;<span class="ident" id="2635754">end</span>&nbsp;<span class="op" id="2635758">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635762">month</span><span class="op" id="2635767">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635772">begin</span>&nbsp;<span class="op" id="2635778">=</span>&nbsp;<span class="ident" id="2635780">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2635785">}</span>&nbsp;<span class="keyword" id="2635787">else</span>&nbsp;<span class="op" id="2635792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635796">begin</span>&nbsp;<span class="op" id="2635802">=</span>&nbsp;<span class="builtintype" id="2635804">int</span><span class="op" id="2635807">(</span><span class="ident" id="2635808">daysBefore</span><span class="op" id="2635818">[</span><span class="ident" id="2635819">month</span><span class="op" id="2635824">]</span><span class="op" id="2635825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2635828">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635832">month</span><span class="op" id="2635837">++</span>&nbsp;<span class="comment" id="2635840">//&nbsp;because&nbsp;January&nbsp;is&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2635865">day</span>&nbsp;<span class="op" id="2635869">=</span>&nbsp;<span class="ident" id="2635871">day</span>&nbsp;<span class="op" id="2635875">-</span>&nbsp;<span class="ident" id="2635877">begin</span>&nbsp;<span class="op" id="2635883">+</span>&nbsp;<span class="num" id="2635885">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2635888">return</span><br>
<span class="lineno"></span><span class="op" id="2635895">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="comment" id="2635898">//&nbsp;daysBefore[m]&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;in&nbsp;a&nbsp;non-leap&nbsp;year</span><br>
<span class="lineno"></span><span class="comment" id="2635960">//&nbsp;before&nbsp;month&nbsp;m&nbsp;begins.&nbsp;&nbsp;There&nbsp;is&nbsp;an&nbsp;entry&nbsp;for&nbsp;m=12,&nbsp;counting</span><br>
<span class="lineno"></span><span class="comment" id="2636024">//&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;before&nbsp;January&nbsp;of&nbsp;next&nbsp;year&nbsp;(365).</span><br>
<span class="lineno"></span><span class="keyword" id="2636081">var</span>&nbsp;<span class="ident" id="2636085">daysBefore</span>&nbsp;<span class="op" id="2636096">=</span>&nbsp;<span class="op" id="2636098">[</span><span class="op" id="2636099">...</span><span class="op" id="2636102">]</span><span class="builtintype" id="2636103">int32</span><span class="op" id="2636108">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636111">0</span><span class="op" id="2636112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636115">31</span><span class="op" id="2636117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636120">31</span>&nbsp;<span class="op" id="2636123">+</span>&nbsp;<span class="num" id="2636125">28</span><span class="op" id="2636127">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636130">31</span>&nbsp;<span class="op" id="2636133">+</span>&nbsp;<span class="num" id="2636135">28</span>&nbsp;<span class="op" id="2636138">+</span>&nbsp;<span class="num" id="2636140">31</span><span class="op" id="2636142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636145">31</span>&nbsp;<span class="op" id="2636148">+</span>&nbsp;<span class="num" id="2636150">28</span>&nbsp;<span class="op" id="2636153">+</span>&nbsp;<span class="num" id="2636155">31</span>&nbsp;<span class="op" id="2636158">+</span>&nbsp;<span class="num" id="2636160">30</span><span class="op" id="2636162">,</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636165">31</span>&nbsp;<span class="op" id="2636168">+</span>&nbsp;<span class="num" id="2636170">28</span>&nbsp;<span class="op" id="2636173">+</span>&nbsp;<span class="num" id="2636175">31</span>&nbsp;<span class="op" id="2636178">+</span>&nbsp;<span class="num" id="2636180">30</span>&nbsp;<span class="op" id="2636183">+</span>&nbsp;<span class="num" id="2636185">31</span><span class="op" id="2636187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636190">31</span>&nbsp;<span class="op" id="2636193">+</span>&nbsp;<span class="num" id="2636195">28</span>&nbsp;<span class="op" id="2636198">+</span>&nbsp;<span class="num" id="2636200">31</span>&nbsp;<span class="op" id="2636203">+</span>&nbsp;<span class="num" id="2636205">30</span>&nbsp;<span class="op" id="2636208">+</span>&nbsp;<span class="num" id="2636210">31</span>&nbsp;<span class="op" id="2636213">+</span>&nbsp;<span class="num" id="2636215">30</span><span class="op" id="2636217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636220">31</span>&nbsp;<span class="op" id="2636223">+</span>&nbsp;<span class="num" id="2636225">28</span>&nbsp;<span class="op" id="2636228">+</span>&nbsp;<span class="num" id="2636230">31</span>&nbsp;<span class="op" id="2636233">+</span>&nbsp;<span class="num" id="2636235">30</span>&nbsp;<span class="op" id="2636238">+</span>&nbsp;<span class="num" id="2636240">31</span>&nbsp;<span class="op" id="2636243">+</span>&nbsp;<span class="num" id="2636245">30</span>&nbsp;<span class="op" id="2636248">+</span>&nbsp;<span class="num" id="2636250">31</span><span class="op" id="2636252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636255">31</span>&nbsp;<span class="op" id="2636258">+</span>&nbsp;<span class="num" id="2636260">28</span>&nbsp;<span class="op" id="2636263">+</span>&nbsp;<span class="num" id="2636265">31</span>&nbsp;<span class="op" id="2636268">+</span>&nbsp;<span class="num" id="2636270">30</span>&nbsp;<span class="op" id="2636273">+</span>&nbsp;<span class="num" id="2636275">31</span>&nbsp;<span class="op" id="2636278">+</span>&nbsp;<span class="num" id="2636280">30</span>&nbsp;<span class="op" id="2636283">+</span>&nbsp;<span class="num" id="2636285">31</span>&nbsp;<span class="op" id="2636288">+</span>&nbsp;<span class="num" id="2636290">31</span><span class="op" id="2636292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636295">31</span>&nbsp;<span class="op" id="2636298">+</span>&nbsp;<span class="num" id="2636300">28</span>&nbsp;<span class="op" id="2636303">+</span>&nbsp;<span class="num" id="2636305">31</span>&nbsp;<span class="op" id="2636308">+</span>&nbsp;<span class="num" id="2636310">30</span>&nbsp;<span class="op" id="2636313">+</span>&nbsp;<span class="num" id="2636315">31</span>&nbsp;<span class="op" id="2636318">+</span>&nbsp;<span class="num" id="2636320">30</span>&nbsp;<span class="op" id="2636323">+</span>&nbsp;<span class="num" id="2636325">31</span>&nbsp;<span class="op" id="2636328">+</span>&nbsp;<span class="num" id="2636330">31</span>&nbsp;<span class="op" id="2636333">+</span>&nbsp;<span class="num" id="2636335">30</span><span class="op" id="2636337">,</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636340">31</span>&nbsp;<span class="op" id="2636343">+</span>&nbsp;<span class="num" id="2636345">28</span>&nbsp;<span class="op" id="2636348">+</span>&nbsp;<span class="num" id="2636350">31</span>&nbsp;<span class="op" id="2636353">+</span>&nbsp;<span class="num" id="2636355">30</span>&nbsp;<span class="op" id="2636358">+</span>&nbsp;<span class="num" id="2636360">31</span>&nbsp;<span class="op" id="2636363">+</span>&nbsp;<span class="num" id="2636365">30</span>&nbsp;<span class="op" id="2636368">+</span>&nbsp;<span class="num" id="2636370">31</span>&nbsp;<span class="op" id="2636373">+</span>&nbsp;<span class="num" id="2636375">31</span>&nbsp;<span class="op" id="2636378">+</span>&nbsp;<span class="num" id="2636380">30</span>&nbsp;<span class="op" id="2636383">+</span>&nbsp;<span class="num" id="2636385">31</span><span class="op" id="2636387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636390">31</span>&nbsp;<span class="op" id="2636393">+</span>&nbsp;<span class="num" id="2636395">28</span>&nbsp;<span class="op" id="2636398">+</span>&nbsp;<span class="num" id="2636400">31</span>&nbsp;<span class="op" id="2636403">+</span>&nbsp;<span class="num" id="2636405">30</span>&nbsp;<span class="op" id="2636408">+</span>&nbsp;<span class="num" id="2636410">31</span>&nbsp;<span class="op" id="2636413">+</span>&nbsp;<span class="num" id="2636415">30</span>&nbsp;<span class="op" id="2636418">+</span>&nbsp;<span class="num" id="2636420">31</span>&nbsp;<span class="op" id="2636423">+</span>&nbsp;<span class="num" id="2636425">31</span>&nbsp;<span class="op" id="2636428">+</span>&nbsp;<span class="num" id="2636430">30</span>&nbsp;<span class="op" id="2636433">+</span>&nbsp;<span class="num" id="2636435">31</span>&nbsp;<span class="op" id="2636438">+</span>&nbsp;<span class="num" id="2636440">30</span><span class="op" id="2636442">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2636445">31</span>&nbsp;<span class="op" id="2636448">+</span>&nbsp;<span class="num" id="2636450">28</span>&nbsp;<span class="op" id="2636453">+</span>&nbsp;<span class="num" id="2636455">31</span>&nbsp;<span class="op" id="2636458">+</span>&nbsp;<span class="num" id="2636460">30</span>&nbsp;<span class="op" id="2636463">+</span>&nbsp;<span class="num" id="2636465">31</span>&nbsp;<span class="op" id="2636468">+</span>&nbsp;<span class="num" id="2636470">30</span>&nbsp;<span class="op" id="2636473">+</span>&nbsp;<span class="num" id="2636475">31</span>&nbsp;<span class="op" id="2636478">+</span>&nbsp;<span class="num" id="2636480">31</span>&nbsp;<span class="op" id="2636483">+</span>&nbsp;<span class="num" id="2636485">30</span>&nbsp;<span class="op" id="2636488">+</span>&nbsp;<span class="num" id="2636490">31</span>&nbsp;<span class="op" id="2636493">+</span>&nbsp;<span class="num" id="2636495">30</span>&nbsp;<span class="op" id="2636498">+</span>&nbsp;<span class="num" id="2636500">31</span><span class="op" id="2636502">,</span><br>
<span class="lineno"></span><span class="op" id="2636504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span><span class="keyword" id="2636507">func</span>&nbsp;<span class="ident" id="2636512">daysIn</span><span class="op" id="2636518">(</span><span class="ident" id="2636519">m</span>&nbsp;<span class="ident" id="2636521">Month</span><span class="op" id="2636526">,</span>&nbsp;<span class="ident" id="2636528">year</span>&nbsp;<span class="builtintype" id="2636533">int</span><span class="op" id="2636536">)</span>&nbsp;<span class="builtintype" id="2636538">int</span>&nbsp;<span class="op" id="2636542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2636545">if</span>&nbsp;<span class="ident" id="2636548">m</span>&nbsp;<span class="op" id="2636550">==</span>&nbsp;<span class="ident" id="2636553">February</span>&nbsp;<span class="op" id="2636562">&amp;&amp;</span>&nbsp;<span class="ident" id="2636565">isLeap</span><span class="op" id="2636571">(</span><span class="ident" id="2636572">year</span><span class="op" id="2636576">)</span>&nbsp;<span class="op" id="2636578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2636582">return</span>&nbsp;<span class="num" id="2636589">29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2636593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2636596">return</span>&nbsp;<span class="builtintype" id="2636603">int</span><span class="op" id="2636606">(</span><span class="ident" id="2636607">daysBefore</span><span class="op" id="2636617">[</span><span class="ident" id="2636618">m</span><span class="op" id="2636619">]</span>&nbsp;<span class="op" id="2636621">-</span>&nbsp;<span class="ident" id="2636623">daysBefore</span><span class="op" id="2636633">[</span><span class="ident" id="2636634">m</span><span class="op" id="2636635">-</span><span class="num" id="2636636">1</span><span class="op" id="2636637">]</span><span class="op" id="2636638">)</span><br>
<span class="lineno">775</span><span class="op" id="2636640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2636643">//&nbsp;Provided&nbsp;by&nbsp;package&nbsp;runtime.</span><br>
<span class="lineno"></span><span class="keyword" id="2636675">func</span>&nbsp;<span class="ident" id="2636680">now</span><span class="op" id="2636683">(</span><span class="op" id="2636684">)</span>&nbsp;<span class="op" id="2636686">(</span><span class="ident" id="2636687">sec</span>&nbsp;<span class="ident" id="2636691">int64</span><span class="op" id="2636696">,</span>&nbsp;<span class="ident" id="2636698">nsec</span>&nbsp;<span class="builtintype" id="2636703">int32</span><span class="op" id="2636708">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span><span class="comment" id="2636711">//&nbsp;Now&nbsp;returns&nbsp;the&nbsp;current&nbsp;local&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2636750">func</span>&nbsp;<span class="ident" id="2636755">Now</span><span class="op" id="2636758">(</span><span class="op" id="2636759">)</span>&nbsp;<span class="ident" id="2636761">Time</span>&nbsp;<span class="op" id="2636766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2636769">sec</span><span class="op" id="2636772">,</span>&nbsp;<span class="ident" id="2636774">nsec</span>&nbsp;<span class="op" id="2636779">:=</span>&nbsp;<span class="ident" id="2636782">now</span><span class="op" id="2636785">(</span><span class="op" id="2636786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2636789">return</span>&nbsp;<span class="ident" id="2636796">Time</span><span class="op" id="2636800">{</span><span class="ident" id="2636801">sec</span>&nbsp;<span class="op" id="2636805">+</span>&nbsp;<span class="ident" id="2636807">unixToInternal</span><span class="op" id="2636821">,</span>&nbsp;<span class="ident" id="2636823">nsec</span><span class="op" id="2636827">,</span>&nbsp;<span class="ident" id="2636829">Local</span><span class="op" id="2636834">}</span><br>
<span class="lineno"></span><span class="op" id="2636836">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="comment" id="2636839">//&nbsp;UTC&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;set&nbsp;to&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2636886">func</span>&nbsp;<span class="op" id="2636891">(</span><span class="ident" id="2636892">t</span>&nbsp;<span class="ident" id="2636894">Time</span><span class="op" id="2636898">)</span>&nbsp;<span class="ident" id="2636900">UTC</span><span class="op" id="2636903">(</span><span class="op" id="2636904">)</span>&nbsp;<span class="ident" id="2636906">Time</span>&nbsp;<span class="op" id="2636911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2636914">t</span><span class="op" id="2636915">.</span><span class="ident" id="2636916">loc</span>&nbsp;<span class="op" id="2636920">=</span>&nbsp;<span class="ident" id="2636922">UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2636927">return</span>&nbsp;<span class="ident" id="2636934">t</span><br>
<span class="lineno">790</span><span class="op" id="2636936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2636939">//&nbsp;Local&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;set&nbsp;to&nbsp;local&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="2636995">func</span>&nbsp;<span class="op" id="2637000">(</span><span class="ident" id="2637001">t</span>&nbsp;<span class="ident" id="2637003">Time</span><span class="op" id="2637007">)</span>&nbsp;<span class="ident" id="2637009">Local</span><span class="op" id="2637014">(</span><span class="op" id="2637015">)</span>&nbsp;<span class="ident" id="2637017">Time</span>&nbsp;<span class="op" id="2637022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2637025">t</span><span class="op" id="2637026">.</span><span class="ident" id="2637027">loc</span>&nbsp;<span class="op" id="2637031">=</span>&nbsp;<span class="ident" id="2637033">Local</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2637040">return</span>&nbsp;<span class="ident" id="2637047">t</span><br>
<span class="lineno"></span><span class="op" id="2637049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2637052">//&nbsp;In&nbsp;returns&nbsp;t&nbsp;with&nbsp;the&nbsp;location&nbsp;information&nbsp;set&nbsp;to&nbsp;loc.</span><br>
<span class="lineno"></span><span class="comment" id="2637110">//</span><br>
<span class="lineno">800</span><span class="comment" id="2637113">//&nbsp;In&nbsp;panics&nbsp;if&nbsp;loc&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2637141">func</span>&nbsp;<span class="op" id="2637146">(</span><span class="ident" id="2637147">t</span>&nbsp;<span class="ident" id="2637149">Time</span><span class="op" id="2637153">)</span>&nbsp;<span class="ident" id="2637155">In</span><span class="op" id="2637157">(</span><span class="ident" id="2637158">loc</span>&nbsp;<span class="op" id="2637162">*</span><span class="ident" id="2637163">Location</span><span class="op" id="2637171">)</span>&nbsp;<span class="ident" id="2637173">Time</span>&nbsp;<span class="op" id="2637178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2637181">if</span>&nbsp;<span class="ident" id="2637184">loc</span>&nbsp;<span class="op" id="2637188">==</span>&nbsp;<span class="builtintype" id="2637191">nil</span>&nbsp;<span class="op" id="2637195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2637199">panic</span><span class="op" id="2637204">(</span><span class="string" id="2637205">&#34;time:&nbsp;missing&nbsp;Location&nbsp;in&nbsp;call&nbsp;to&nbsp;Time.In&#34;</span><span class="op" id="2637248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2637251">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2637254">t</span><span class="op" id="2637255">.</span><span class="ident" id="2637256">loc</span>&nbsp;<span class="op" id="2637260">=</span>&nbsp;<span class="ident" id="2637262">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2637267">return</span>&nbsp;<span class="ident" id="2637274">t</span><br>
<span class="lineno"></span><span class="op" id="2637276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2637279">//&nbsp;Location&nbsp;returns&nbsp;the&nbsp;time&nbsp;zone&nbsp;information&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno">810</span><span class="keyword" id="2637344">func</span>&nbsp;<span class="op" id="2637349">(</span><span class="ident" id="2637350">t</span>&nbsp;<span class="ident" id="2637352">Time</span><span class="op" id="2637356">)</span>&nbsp;<span class="ident" id="2637358">Location</span><span class="op" id="2637366">(</span><span class="op" id="2637367">)</span>&nbsp;<span class="op" id="2637369">*</span><span class="ident" id="2637370">Location</span>&nbsp;<span class="op" id="2637379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2637382">l</span>&nbsp;<span class="op" id="2637384">:=</span>&nbsp;<span class="ident" id="2637387">t</span><span class="op" id="2637388">.</span><span class="ident" id="2637389">loc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2637394">if</span>&nbsp;<span class="ident" id="2637397">l</span>&nbsp;<span class="op" id="2637399">==</span>&nbsp;<span class="builtintype" id="2637402">nil</span>&nbsp;<span class="op" id="2637406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2637410">l</span>&nbsp;<span class="op" id="2637412">=</span>&nbsp;<span class="ident" id="2637414">UTC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2637419">}</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2637422">return</span>&nbsp;<span class="ident" id="2637429">l</span><br>
<span class="lineno"></span><span class="op" id="2637431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2637434">//&nbsp;Zone&nbsp;computes&nbsp;the&nbsp;time&nbsp;zone&nbsp;in&nbsp;effect&nbsp;at&nbsp;time&nbsp;t,&nbsp;returning&nbsp;the&nbsp;abbreviated</span><br>
<span class="lineno"></span><span class="comment" id="2637512">//&nbsp;name&nbsp;of&nbsp;the&nbsp;zone&nbsp;(such&nbsp;as&nbsp;&#34;CET&#34;)&nbsp;and&nbsp;its&nbsp;offset&nbsp;in&nbsp;seconds&nbsp;east&nbsp;of&nbsp;UTC.</span><br>
<span class="lineno">820</span><span class="keyword" id="2637587">func</span>&nbsp;<span class="op" id="2637592">(</span><span class="ident" id="2637593">t</span>&nbsp;<span class="ident" id="2637595">Time</span><span class="op" id="2637599">)</span>&nbsp;<span class="ident" id="2637601">Zone</span><span class="op" id="2637605">(</span><span class="op" id="2637606">)</span>&nbsp;<span class="op" id="2637608">(</span><span class="ident" id="2637609">name</span>&nbsp;<span class="builtintype" id="2637614">string</span><span class="op" id="2637620">,</span>&nbsp;<span class="ident" id="2637622">offset</span>&nbsp;<span class="builtintype" id="2637629">int</span><span class="op" id="2637632">)</span>&nbsp;<span class="op" id="2637634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2637637">name</span><span class="op" id="2637641">,</span>&nbsp;<span class="ident" id="2637643">offset</span><span class="op" id="2637649">,</span>&nbsp;<span class="ident" id="2637651">_</span><span class="op" id="2637652">,</span>&nbsp;<span class="ident" id="2637654">_</span><span class="op" id="2637655">,</span>&nbsp;<span class="ident" id="2637657">_</span>&nbsp;<span class="op" id="2637659">=</span>&nbsp;<span class="ident" id="2637661">t</span><span class="op" id="2637662">.</span><span class="ident" id="2637663">loc</span><span class="op" id="2637666">.</span><span class="ident" id="2637667">lookup</span><span class="op" id="2637673">(</span><span class="ident" id="2637674">t</span><span class="op" id="2637675">.</span><span class="ident" id="2637676">sec</span>&nbsp;<span class="op" id="2637680">+</span>&nbsp;<span class="ident" id="2637682">internalToUnix</span><span class="op" id="2637696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2637699">return</span><br>
<span class="lineno"></span><span class="op" id="2637706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">825</span><span class="comment" id="2637709">//&nbsp;Unix&nbsp;returns&nbsp;t&nbsp;as&nbsp;a&nbsp;Unix&nbsp;time,&nbsp;the&nbsp;number&nbsp;of&nbsp;seconds&nbsp;elapsed</span><br>
<span class="lineno"></span><span class="comment" id="2637773">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="keyword" id="2637803">func</span>&nbsp;<span class="op" id="2637808">(</span><span class="ident" id="2637809">t</span>&nbsp;<span class="ident" id="2637811">Time</span><span class="op" id="2637815">)</span>&nbsp;<span class="ident" id="2637817">Unix</span><span class="op" id="2637821">(</span><span class="op" id="2637822">)</span>&nbsp;<span class="ident" id="2637824">int64</span>&nbsp;<span class="op" id="2637830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2637833">return</span>&nbsp;<span class="ident" id="2637840">t</span><span class="op" id="2637841">.</span><span class="ident" id="2637842">sec</span>&nbsp;<span class="op" id="2637846">+</span>&nbsp;<span class="ident" id="2637848">internalToUnix</span><br>
<span class="lineno"></span><span class="op" id="2637863">}</span><br>
<span class="lineno">830</span><br>
<span class="lineno"></span><span class="comment" id="2637866">//&nbsp;UnixNano&nbsp;returns&nbsp;t&nbsp;as&nbsp;a&nbsp;Unix&nbsp;time,&nbsp;the&nbsp;number&nbsp;of&nbsp;nanoseconds&nbsp;elapsed</span><br>
<span class="lineno"></span><span class="comment" id="2637938">//&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.&nbsp;The&nbsp;result&nbsp;is&nbsp;undefined&nbsp;if&nbsp;the&nbsp;Unix&nbsp;time</span><br>
<span class="lineno"></span><span class="comment" id="2638009">//&nbsp;in&nbsp;nanoseconds&nbsp;cannot&nbsp;be&nbsp;represented&nbsp;by&nbsp;an&nbsp;int64.&nbsp;Note&nbsp;that&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2638077">//&nbsp;means&nbsp;the&nbsp;result&nbsp;of&nbsp;calling&nbsp;UnixNano&nbsp;on&nbsp;the&nbsp;zero&nbsp;Time&nbsp;is&nbsp;undefined.</span><br>
<span class="lineno">835</span><span class="keyword" id="2638148">func</span>&nbsp;<span class="op" id="2638153">(</span><span class="ident" id="2638154">t</span>&nbsp;<span class="ident" id="2638156">Time</span><span class="op" id="2638160">)</span>&nbsp;<span class="ident" id="2638162">UnixNano</span><span class="op" id="2638170">(</span><span class="op" id="2638171">)</span>&nbsp;<span class="ident" id="2638173">int64</span>&nbsp;<span class="op" id="2638179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2638182">return</span>&nbsp;<span class="op" id="2638189">(</span><span class="ident" id="2638190">t</span><span class="op" id="2638191">.</span><span class="ident" id="2638192">sec</span><span class="op" id="2638195">+</span><span class="ident" id="2638196">internalToUnix</span><span class="op" id="2638210">)</span><span class="op" id="2638211">*</span><span class="num" id="2638212">1e9</span>&nbsp;<span class="op" id="2638216">+</span>&nbsp;<span class="ident" id="2638218">int64</span><span class="op" id="2638223">(</span><span class="ident" id="2638224">t</span><span class="op" id="2638225">.</span><span class="ident" id="2638226">nsec</span><span class="op" id="2638230">)</span><br>
<span class="lineno"></span><span class="op" id="2638232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2638235">const</span>&nbsp;<span class="ident" id="2638241">timeBinaryVersion</span>&nbsp;<span class="builtintype" id="2638259">byte</span>&nbsp;<span class="op" id="2638264">=</span>&nbsp;<span class="num" id="2638266">1</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span><span class="comment" id="2638269">//&nbsp;MarshalBinary&nbsp;implements&nbsp;the&nbsp;encoding.BinaryMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2638337">func</span>&nbsp;<span class="op" id="2638342">(</span><span class="ident" id="2638343">t</span>&nbsp;<span class="ident" id="2638345">Time</span><span class="op" id="2638349">)</span>&nbsp;<span class="ident" id="2638351">MarshalBinary</span><span class="op" id="2638364">(</span><span class="op" id="2638365">)</span>&nbsp;<span class="op" id="2638367">(</span><span class="op" id="2638368">[</span><span class="op" id="2638369">]</span><span class="builtintype" id="2638370">byte</span><span class="op" id="2638374">,</span>&nbsp;<span class="builtintype" id="2638376">error</span><span class="op" id="2638381">)</span>&nbsp;<span class="op" id="2638383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2638386">var</span>&nbsp;<span class="ident" id="2638390">offsetMin</span>&nbsp;<span class="builtintype" id="2638400">int16</span>&nbsp;<span class="comment" id="2638406">//&nbsp;minutes&nbsp;east&nbsp;of&nbsp;UTC.&nbsp;-1&nbsp;is&nbsp;UTC.</span><br>
<span class="lineno"></span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2638443">if</span>&nbsp;<span class="ident" id="2638446">t</span><span class="op" id="2638447">.</span><span class="ident" id="2638448">Location</span><span class="op" id="2638456">(</span><span class="op" id="2638457">)</span>&nbsp;<span class="op" id="2638459">==</span>&nbsp;<span class="op" id="2638462">&amp;</span><span class="ident" id="2638463">utcLoc</span>&nbsp;<span class="op" id="2638470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2638474">offsetMin</span>&nbsp;<span class="op" id="2638484">=</span>&nbsp;<span class="op" id="2638486">-</span><span class="num" id="2638487">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2638490">}</span>&nbsp;<span class="keyword" id="2638492">else</span>&nbsp;<span class="op" id="2638497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2638501">_</span><span class="op" id="2638502">,</span>&nbsp;<span class="ident" id="2638504">offset</span>&nbsp;<span class="op" id="2638511">:=</span>&nbsp;<span class="ident" id="2638514">t</span><span class="op" id="2638515">.</span><span class="ident" id="2638516">Zone</span><span class="op" id="2638520">(</span><span class="op" id="2638521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2638525">if</span>&nbsp;<span class="ident" id="2638528">offset</span><span class="op" id="2638534">%</span><span class="num" id="2638535">60</span>&nbsp;<span class="op" id="2638538">!=</span>&nbsp;<span class="num" id="2638541">0</span>&nbsp;<span class="op" id="2638543">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2638548">return</span>&nbsp;<span class="builtintype" id="2638555">nil</span><span class="op" id="2638558">,</span>&nbsp;<span class="ident" id="2638560">errors</span><span class="op" id="2638566">.</span><span class="ident" id="2638567">New</span><span class="op" id="2638570">(</span><span class="string" id="2638571">&#34;Time.MarshalBinary:&nbsp;zone&nbsp;offset&nbsp;has&nbsp;fractional&nbsp;minute&#34;</span><span class="op" id="2638626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2638630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2638634">offset</span>&nbsp;<span class="op" id="2638641">/=</span>&nbsp;<span class="num" id="2638644">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2638649">if</span>&nbsp;<span class="ident" id="2638652">offset</span>&nbsp;<span class="op" id="2638659">&lt;</span>&nbsp;<span class="op" id="2638661">-</span><span class="num" id="2638662">32768</span>&nbsp;<span class="op" id="2638668">||</span>&nbsp;<span class="ident" id="2638671">offset</span>&nbsp;<span class="op" id="2638678">==</span>&nbsp;<span class="op" id="2638681">-</span><span class="num" id="2638682">1</span>&nbsp;<span class="op" id="2638684">||</span>&nbsp;<span class="ident" id="2638687">offset</span>&nbsp;<span class="op" id="2638694">&gt;</span>&nbsp;<span class="num" id="2638696">32767</span>&nbsp;<span class="op" id="2638702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2638707">return</span>&nbsp;<span class="builtintype" id="2638714">nil</span><span class="op" id="2638717">,</span>&nbsp;<span class="ident" id="2638719">errors</span><span class="op" id="2638725">.</span><span class="ident" id="2638726">New</span><span class="op" id="2638729">(</span><span class="string" id="2638730">&#34;Time.MarshalBinary:&nbsp;unexpected&nbsp;zone&nbsp;offset&#34;</span><span class="op" id="2638774">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2638778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2638782">offsetMin</span>&nbsp;<span class="op" id="2638792">=</span>&nbsp;<span class="builtintype" id="2638794">int16</span><span class="op" id="2638799">(</span><span class="ident" id="2638800">offset</span><span class="op" id="2638806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2638809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2638813">enc</span>&nbsp;<span class="op" id="2638817">:=</span>&nbsp;<span class="op" id="2638820">[</span><span class="op" id="2638821">]</span><span class="builtintype" id="2638822">byte</span><span class="op" id="2638826">{</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2638830">timeBinaryVersion</span><span class="op" id="2638847">,</span>&nbsp;<span class="comment" id="2638849">//&nbsp;byte&nbsp;0&nbsp;:&nbsp;version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2638871">byte</span><span class="op" id="2638875">(</span><span class="ident" id="2638876">t</span><span class="op" id="2638877">.</span><span class="ident" id="2638878">sec</span>&nbsp;<span class="op" id="2638882">&gt;&gt;</span>&nbsp;<span class="num" id="2638885">56</span><span class="op" id="2638887">)</span><span class="op" id="2638888">,</span>&nbsp;<span class="comment" id="2638890">//&nbsp;bytes&nbsp;1-8:&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2638914">byte</span><span class="op" id="2638918">(</span><span class="ident" id="2638919">t</span><span class="op" id="2638920">.</span><span class="ident" id="2638921">sec</span>&nbsp;<span class="op" id="2638925">&gt;&gt;</span>&nbsp;<span class="num" id="2638928">48</span><span class="op" id="2638930">)</span><span class="op" id="2638931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2638935">byte</span><span class="op" id="2638939">(</span><span class="ident" id="2638940">t</span><span class="op" id="2638941">.</span><span class="ident" id="2638942">sec</span>&nbsp;<span class="op" id="2638946">&gt;&gt;</span>&nbsp;<span class="num" id="2638949">40</span><span class="op" id="2638951">)</span><span class="op" id="2638952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2638956">byte</span><span class="op" id="2638960">(</span><span class="ident" id="2638961">t</span><span class="op" id="2638962">.</span><span class="ident" id="2638963">sec</span>&nbsp;<span class="op" id="2638967">&gt;&gt;</span>&nbsp;<span class="num" id="2638970">32</span><span class="op" id="2638972">)</span><span class="op" id="2638973">,</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2638977">byte</span><span class="op" id="2638981">(</span><span class="ident" id="2638982">t</span><span class="op" id="2638983">.</span><span class="ident" id="2638984">sec</span>&nbsp;<span class="op" id="2638988">&gt;&gt;</span>&nbsp;<span class="num" id="2638991">24</span><span class="op" id="2638993">)</span><span class="op" id="2638994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2638998">byte</span><span class="op" id="2639002">(</span><span class="ident" id="2639003">t</span><span class="op" id="2639004">.</span><span class="ident" id="2639005">sec</span>&nbsp;<span class="op" id="2639009">&gt;&gt;</span>&nbsp;<span class="num" id="2639012">16</span><span class="op" id="2639014">)</span><span class="op" id="2639015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2639019">byte</span><span class="op" id="2639023">(</span><span class="ident" id="2639024">t</span><span class="op" id="2639025">.</span><span class="ident" id="2639026">sec</span>&nbsp;<span class="op" id="2639030">&gt;&gt;</span>&nbsp;<span class="num" id="2639033">8</span><span class="op" id="2639034">)</span><span class="op" id="2639035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2639039">byte</span><span class="op" id="2639043">(</span><span class="ident" id="2639044">t</span><span class="op" id="2639045">.</span><span class="ident" id="2639046">sec</span><span class="op" id="2639049">)</span><span class="op" id="2639050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2639054">byte</span><span class="op" id="2639058">(</span><span class="ident" id="2639059">t</span><span class="op" id="2639060">.</span><span class="ident" id="2639061">nsec</span>&nbsp;<span class="op" id="2639066">&gt;&gt;</span>&nbsp;<span class="num" id="2639069">24</span><span class="op" id="2639071">)</span><span class="op" id="2639072">,</span>&nbsp;<span class="comment" id="2639074">//&nbsp;bytes&nbsp;9-12:&nbsp;nanoseconds</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2639103">byte</span><span class="op" id="2639107">(</span><span class="ident" id="2639108">t</span><span class="op" id="2639109">.</span><span class="ident" id="2639110">nsec</span>&nbsp;<span class="op" id="2639115">&gt;&gt;</span>&nbsp;<span class="num" id="2639118">16</span><span class="op" id="2639120">)</span><span class="op" id="2639121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2639125">byte</span><span class="op" id="2639129">(</span><span class="ident" id="2639130">t</span><span class="op" id="2639131">.</span><span class="ident" id="2639132">nsec</span>&nbsp;<span class="op" id="2639137">&gt;&gt;</span>&nbsp;<span class="num" id="2639140">8</span><span class="op" id="2639141">)</span><span class="op" id="2639142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2639146">byte</span><span class="op" id="2639150">(</span><span class="ident" id="2639151">t</span><span class="op" id="2639152">.</span><span class="ident" id="2639153">nsec</span><span class="op" id="2639157">)</span><span class="op" id="2639158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2639162">byte</span><span class="op" id="2639166">(</span><span class="ident" id="2639167">offsetMin</span>&nbsp;<span class="op" id="2639177">&gt;&gt;</span>&nbsp;<span class="num" id="2639180">8</span><span class="op" id="2639181">)</span><span class="op" id="2639182">,</span>&nbsp;<span class="comment" id="2639184">//&nbsp;bytes&nbsp;13-14:&nbsp;zone&nbsp;offset&nbsp;in&nbsp;minutes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2639225">byte</span><span class="op" id="2639229">(</span><span class="ident" id="2639230">offsetMin</span><span class="op" id="2639239">)</span><span class="op" id="2639240">,</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2639243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2639247">return</span>&nbsp;<span class="ident" id="2639254">enc</span><span class="op" id="2639257">,</span>&nbsp;<span class="builtintype" id="2639259">nil</span><br>
<span class="lineno"></span><span class="op" id="2639263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">880</span><span class="comment" id="2639266">//&nbsp;UnmarshalBinary&nbsp;implements&nbsp;the&nbsp;encoding.BinaryUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2639338">func</span>&nbsp;<span class="op" id="2639343">(</span><span class="ident" id="2639344">t</span>&nbsp;<span class="op" id="2639346">*</span><span class="ident" id="2639347">Time</span><span class="op" id="2639351">)</span>&nbsp;<span class="ident" id="2639353">UnmarshalBinary</span><span class="op" id="2639368">(</span><span class="ident" id="2639369">data</span>&nbsp;<span class="op" id="2639374">[</span><span class="op" id="2639375">]</span><span class="builtintype" id="2639376">byte</span><span class="op" id="2639380">)</span>&nbsp;<span class="builtintype" id="2639382">error</span>&nbsp;<span class="op" id="2639388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2639391">buf</span>&nbsp;<span class="op" id="2639395">:=</span>&nbsp;<span class="ident" id="2639398">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2639404">if</span>&nbsp;<span class="builtinfunc" id="2639407">len</span><span class="op" id="2639410">(</span><span class="ident" id="2639411">buf</span><span class="op" id="2639414">)</span>&nbsp;<span class="op" id="2639416">==</span>&nbsp;<span class="num" id="2639419">0</span>&nbsp;<span class="op" id="2639421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2639425">return</span>&nbsp;<span class="ident" id="2639432">errors</span><span class="op" id="2639438">.</span><span class="ident" id="2639439">New</span><span class="op" id="2639442">(</span><span class="string" id="2639443">&#34;Time.UnmarshalBinary:&nbsp;no&nbsp;data&#34;</span><span class="op" id="2639474">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2639477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2639481">if</span>&nbsp;<span class="ident" id="2639484">buf</span><span class="op" id="2639487">[</span><span class="num" id="2639488">0</span><span class="op" id="2639489">]</span>&nbsp;<span class="op" id="2639491">!=</span>&nbsp;<span class="ident" id="2639494">timeBinaryVersion</span>&nbsp;<span class="op" id="2639512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2639516">return</span>&nbsp;<span class="ident" id="2639523">errors</span><span class="op" id="2639529">.</span><span class="ident" id="2639530">New</span><span class="op" id="2639533">(</span><span class="string" id="2639534">&#34;Time.UnmarshalBinary:&nbsp;unsupported&nbsp;version&#34;</span><span class="op" id="2639577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2639580">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2639584">if</span>&nbsp;<span class="builtinfunc" id="2639587">len</span><span class="op" id="2639590">(</span><span class="ident" id="2639591">buf</span><span class="op" id="2639594">)</span>&nbsp;<span class="op" id="2639596">!=</span>&nbsp;<span class="comment" id="2639599">/*version*/</span>&nbsp;<span class="num" id="2639611">1</span><span class="op" id="2639612">+</span>&nbsp;<span class="comment" id="2639614">/*sec*/</span>&nbsp;<span class="num" id="2639622">8</span><span class="op" id="2639623">+</span>&nbsp;<span class="comment" id="2639625">/*nsec*/</span>&nbsp;<span class="num" id="2639634">4</span><span class="op" id="2639635">+</span>&nbsp;<span class="comment" id="2639637">/*zone&nbsp;offset*/</span>&nbsp;<span class="num" id="2639653">2</span>&nbsp;<span class="op" id="2639655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2639659">return</span>&nbsp;<span class="ident" id="2639666">errors</span><span class="op" id="2639672">.</span><span class="ident" id="2639673">New</span><span class="op" id="2639676">(</span><span class="string" id="2639677">&#34;Time.UnmarshalBinary:&nbsp;invalid&nbsp;length&#34;</span><span class="op" id="2639715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2639718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2639722">buf</span>&nbsp;<span class="op" id="2639726">=</span>&nbsp;<span class="ident" id="2639728">buf</span><span class="op" id="2639731">[</span><span class="num" id="2639732">1</span><span class="op" id="2639733">:</span><span class="op" id="2639734">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2639737">t</span><span class="op" id="2639738">.</span><span class="ident" id="2639739">sec</span>&nbsp;<span class="op" id="2639743">=</span>&nbsp;<span class="ident" id="2639745">int64</span><span class="op" id="2639750">(</span><span class="ident" id="2639751">buf</span><span class="op" id="2639754">[</span><span class="num" id="2639755">7</span><span class="op" id="2639756">]</span><span class="op" id="2639757">)</span>&nbsp;<span class="op" id="2639759">|</span>&nbsp;<span class="ident" id="2639761">int64</span><span class="op" id="2639766">(</span><span class="ident" id="2639767">buf</span><span class="op" id="2639770">[</span><span class="num" id="2639771">6</span><span class="op" id="2639772">]</span><span class="op" id="2639773">)</span><span class="op" id="2639774">&lt;&lt;</span><span class="num" id="2639776">8</span>&nbsp;<span class="op" id="2639778">|</span>&nbsp;<span class="ident" id="2639780">int64</span><span class="op" id="2639785">(</span><span class="ident" id="2639786">buf</span><span class="op" id="2639789">[</span><span class="num" id="2639790">5</span><span class="op" id="2639791">]</span><span class="op" id="2639792">)</span><span class="op" id="2639793">&lt;&lt;</span><span class="num" id="2639795">16</span>&nbsp;<span class="op" id="2639798">|</span>&nbsp;<span class="ident" id="2639800">int64</span><span class="op" id="2639805">(</span><span class="ident" id="2639806">buf</span><span class="op" id="2639809">[</span><span class="num" id="2639810">4</span><span class="op" id="2639811">]</span><span class="op" id="2639812">)</span><span class="op" id="2639813">&lt;&lt;</span><span class="num" id="2639815">24</span>&nbsp;<span class="op" id="2639818">|</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2639822">int64</span><span class="op" id="2639827">(</span><span class="ident" id="2639828">buf</span><span class="op" id="2639831">[</span><span class="num" id="2639832">3</span><span class="op" id="2639833">]</span><span class="op" id="2639834">)</span><span class="op" id="2639835">&lt;&lt;</span><span class="num" id="2639837">32</span>&nbsp;<span class="op" id="2639840">|</span>&nbsp;<span class="ident" id="2639842">int64</span><span class="op" id="2639847">(</span><span class="ident" id="2639848">buf</span><span class="op" id="2639851">[</span><span class="num" id="2639852">2</span><span class="op" id="2639853">]</span><span class="op" id="2639854">)</span><span class="op" id="2639855">&lt;&lt;</span><span class="num" id="2639857">40</span>&nbsp;<span class="op" id="2639860">|</span>&nbsp;<span class="ident" id="2639862">int64</span><span class="op" id="2639867">(</span><span class="ident" id="2639868">buf</span><span class="op" id="2639871">[</span><span class="num" id="2639872">1</span><span class="op" id="2639873">]</span><span class="op" id="2639874">)</span><span class="op" id="2639875">&lt;&lt;</span><span class="num" id="2639877">48</span>&nbsp;<span class="op" id="2639880">|</span>&nbsp;<span class="ident" id="2639882">int64</span><span class="op" id="2639887">(</span><span class="ident" id="2639888">buf</span><span class="op" id="2639891">[</span><span class="num" id="2639892">0</span><span class="op" id="2639893">]</span><span class="op" id="2639894">)</span><span class="op" id="2639895">&lt;&lt;</span><span class="num" id="2639897">56</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2639902">buf</span>&nbsp;<span class="op" id="2639906">=</span>&nbsp;<span class="ident" id="2639908">buf</span><span class="op" id="2639911">[</span><span class="num" id="2639912">8</span><span class="op" id="2639913">:</span><span class="op" id="2639914">]</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2639917">t</span><span class="op" id="2639918">.</span><span class="ident" id="2639919">nsec</span>&nbsp;<span class="op" id="2639924">=</span>&nbsp;<span class="builtintype" id="2639926">int32</span><span class="op" id="2639931">(</span><span class="ident" id="2639932">buf</span><span class="op" id="2639935">[</span><span class="num" id="2639936">3</span><span class="op" id="2639937">]</span><span class="op" id="2639938">)</span>&nbsp;<span class="op" id="2639940">|</span>&nbsp;<span class="builtintype" id="2639942">int32</span><span class="op" id="2639947">(</span><span class="ident" id="2639948">buf</span><span class="op" id="2639951">[</span><span class="num" id="2639952">2</span><span class="op" id="2639953">]</span><span class="op" id="2639954">)</span><span class="op" id="2639955">&lt;&lt;</span><span class="num" id="2639957">8</span>&nbsp;<span class="op" id="2639959">|</span>&nbsp;<span class="builtintype" id="2639961">int32</span><span class="op" id="2639966">(</span><span class="ident" id="2639967">buf</span><span class="op" id="2639970">[</span><span class="num" id="2639971">1</span><span class="op" id="2639972">]</span><span class="op" id="2639973">)</span><span class="op" id="2639974">&lt;&lt;</span><span class="num" id="2639976">16</span>&nbsp;<span class="op" id="2639979">|</span>&nbsp;<span class="builtintype" id="2639981">int32</span><span class="op" id="2639986">(</span><span class="ident" id="2639987">buf</span><span class="op" id="2639990">[</span><span class="num" id="2639991">0</span><span class="op" id="2639992">]</span><span class="op" id="2639993">)</span><span class="op" id="2639994">&lt;&lt;</span><span class="num" id="2639996">24</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2640001">buf</span>&nbsp;<span class="op" id="2640005">=</span>&nbsp;<span class="ident" id="2640007">buf</span><span class="op" id="2640010">[</span><span class="num" id="2640011">4</span><span class="op" id="2640012">:</span><span class="op" id="2640013">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2640016">offset</span>&nbsp;<span class="op" id="2640023">:=</span>&nbsp;<span class="builtintype" id="2640026">int</span><span class="op" id="2640029">(</span><span class="builtintype" id="2640030">int16</span><span class="op" id="2640035">(</span><span class="ident" id="2640036">buf</span><span class="op" id="2640039">[</span><span class="num" id="2640040">1</span><span class="op" id="2640041">]</span><span class="op" id="2640042">)</span><span class="op" id="2640043">|</span><span class="builtintype" id="2640044">int16</span><span class="op" id="2640049">(</span><span class="ident" id="2640050">buf</span><span class="op" id="2640053">[</span><span class="num" id="2640054">0</span><span class="op" id="2640055">]</span><span class="op" id="2640056">)</span><span class="op" id="2640057">&lt;&lt;</span><span class="num" id="2640059">8</span><span class="op" id="2640060">)</span>&nbsp;<span class="op" id="2640062">*</span>&nbsp;<span class="num" id="2640064">60</span><br>
<span class="lineno"></span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2640069">if</span>&nbsp;<span class="ident" id="2640072">offset</span>&nbsp;<span class="op" id="2640079">==</span>&nbsp;<span class="op" id="2640082">-</span><span class="num" id="2640083">1</span><span class="op" id="2640084">*</span><span class="num" id="2640085">60</span>&nbsp;<span class="op" id="2640088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2640092">t</span><span class="op" id="2640093">.</span><span class="ident" id="2640094">loc</span>&nbsp;<span class="op" id="2640098">=</span>&nbsp;<span class="op" id="2640100">&amp;</span><span class="ident" id="2640101">utcLoc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2640109">}</span>&nbsp;<span class="keyword" id="2640111">else</span>&nbsp;<span class="keyword" id="2640116">if</span>&nbsp;<span class="ident" id="2640119">_</span><span class="op" id="2640120">,</span>&nbsp;<span class="ident" id="2640122">localoff</span><span class="op" id="2640130">,</span>&nbsp;<span class="ident" id="2640132">_</span><span class="op" id="2640133">,</span>&nbsp;<span class="ident" id="2640135">_</span><span class="op" id="2640136">,</span>&nbsp;<span class="ident" id="2640138">_</span>&nbsp;<span class="op" id="2640140">:=</span>&nbsp;<span class="ident" id="2640143">Local</span><span class="op" id="2640148">.</span><span class="ident" id="2640149">lookup</span><span class="op" id="2640155">(</span><span class="ident" id="2640156">t</span><span class="op" id="2640157">.</span><span class="ident" id="2640158">sec</span>&nbsp;<span class="op" id="2640162">+</span>&nbsp;<span class="ident" id="2640164">internalToUnix</span><span class="op" id="2640178">)</span><span class="op" id="2640179">;</span>&nbsp;<span class="ident" id="2640181">offset</span>&nbsp;<span class="op" id="2640188">==</span>&nbsp;<span class="ident" id="2640191">localoff</span>&nbsp;<span class="op" id="2640200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2640204">t</span><span class="op" id="2640205">.</span><span class="ident" id="2640206">loc</span>&nbsp;<span class="op" id="2640210">=</span>&nbsp;<span class="ident" id="2640212">Local</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2640219">}</span>&nbsp;<span class="keyword" id="2640221">else</span>&nbsp;<span class="op" id="2640226">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2640230">t</span><span class="op" id="2640231">.</span><span class="ident" id="2640232">loc</span>&nbsp;<span class="op" id="2640236">=</span>&nbsp;<span class="ident" id="2640238">FixedZone</span><span class="op" id="2640247">(</span><span class="string" id="2640248">&#34;&#34;</span><span class="op" id="2640250">,</span>&nbsp;<span class="ident" id="2640252">offset</span><span class="op" id="2640258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2640261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2640265">return</span>&nbsp;<span class="builtintype" id="2640272">nil</span><br>
<span class="lineno"></span><span class="op" id="2640276">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="comment" id="2640279">//&nbsp;TODO(rsc):&nbsp;Remove&nbsp;GobEncoder,&nbsp;GobDecoder,&nbsp;MarshalJSON,&nbsp;UnmarshalJSON&nbsp;in&nbsp;Go&nbsp;2.</span><br>
<span class="lineno"></span><span class="comment" id="2640360">//&nbsp;The&nbsp;same&nbsp;semantics&nbsp;will&nbsp;be&nbsp;provided&nbsp;by&nbsp;the&nbsp;generic&nbsp;MarshalBinary,&nbsp;MarshalText,</span><br>
<span class="lineno"></span><span class="comment" id="2640442">//&nbsp;UnmarshalBinary,&nbsp;UnmarshalText.</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span><span class="comment" id="2640478">//&nbsp;GobEncode&nbsp;implements&nbsp;the&nbsp;gob.GobEncoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2640532">func</span>&nbsp;<span class="op" id="2640537">(</span><span class="ident" id="2640538">t</span>&nbsp;<span class="ident" id="2640540">Time</span><span class="op" id="2640544">)</span>&nbsp;<span class="ident" id="2640546">GobEncode</span><span class="op" id="2640555">(</span><span class="op" id="2640556">)</span>&nbsp;<span class="op" id="2640558">(</span><span class="op" id="2640559">[</span><span class="op" id="2640560">]</span><span class="builtintype" id="2640561">byte</span><span class="op" id="2640565">,</span>&nbsp;<span class="builtintype" id="2640567">error</span><span class="op" id="2640572">)</span>&nbsp;<span class="op" id="2640574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2640577">return</span>&nbsp;<span class="ident" id="2640584">t</span><span class="op" id="2640585">.</span><span class="ident" id="2640586">MarshalBinary</span><span class="op" id="2640599">(</span><span class="op" id="2640600">)</span><br>
<span class="lineno"></span><span class="op" id="2640602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="comment" id="2640605">//&nbsp;GobDecode&nbsp;implements&nbsp;the&nbsp;gob.GobDecoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="2640659">func</span>&nbsp;<span class="op" id="2640664">(</span><span class="ident" id="2640665">t</span>&nbsp;<span class="op" id="2640667">*</span><span class="ident" id="2640668">Time</span><span class="op" id="2640672">)</span>&nbsp;<span class="ident" id="2640674">GobDecode</span><span class="op" id="2640683">(</span><span class="ident" id="2640684">data</span>&nbsp;<span class="op" id="2640689">[</span><span class="op" id="2640690">]</span><span class="builtintype" id="2640691">byte</span><span class="op" id="2640695">)</span>&nbsp;<span class="builtintype" id="2640697">error</span>&nbsp;<span class="op" id="2640703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2640706">return</span>&nbsp;<span class="ident" id="2640713">t</span><span class="op" id="2640714">.</span><span class="ident" id="2640715">UnmarshalBinary</span><span class="op" id="2640730">(</span><span class="ident" id="2640731">data</span><span class="op" id="2640735">)</span><br>
<span class="lineno"></span><span class="op" id="2640737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span><span class="comment" id="2640740">//&nbsp;MarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Marshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2640796">//&nbsp;The&nbsp;time&nbsp;is&nbsp;a&nbsp;quoted&nbsp;string&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format,&nbsp;with&nbsp;sub-second&nbsp;precision&nbsp;added&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2640891">func</span>&nbsp;<span class="op" id="2640896">(</span><span class="ident" id="2640897">t</span>&nbsp;<span class="ident" id="2640899">Time</span><span class="op" id="2640903">)</span>&nbsp;<span class="ident" id="2640905">MarshalJSON</span><span class="op" id="2640916">(</span><span class="op" id="2640917">)</span>&nbsp;<span class="op" id="2640919">(</span><span class="op" id="2640920">[</span><span class="op" id="2640921">]</span><span class="builtintype" id="2640922">byte</span><span class="op" id="2640926">,</span>&nbsp;<span class="builtintype" id="2640928">error</span><span class="op" id="2640933">)</span>&nbsp;<span class="op" id="2640935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2640938">if</span>&nbsp;<span class="ident" id="2640941">y</span>&nbsp;<span class="op" id="2640943">:=</span>&nbsp;<span class="ident" id="2640946">t</span><span class="op" id="2640947">.</span><span class="ident" id="2640948">Year</span><span class="op" id="2640952">(</span><span class="op" id="2640953">)</span><span class="op" id="2640954">;</span>&nbsp;<span class="ident" id="2640956">y</span>&nbsp;<span class="op" id="2640958">&lt;</span>&nbsp;<span class="num" id="2640960">0</span>&nbsp;<span class="op" id="2640962">||</span>&nbsp;<span class="ident" id="2640965">y</span>&nbsp;<span class="op" id="2640967">&gt;=</span>&nbsp;<span class="num" id="2640970">10000</span>&nbsp;<span class="op" id="2640976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2640980">//&nbsp;RFC&nbsp;3339&nbsp;is&nbsp;clear&nbsp;that&nbsp;years&nbsp;are&nbsp;4&nbsp;digits&nbsp;exactly.</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2641036">//&nbsp;See&nbsp;golang.org/issue/4556#c15&nbsp;for&nbsp;more&nbsp;discussion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2641092">return</span>&nbsp;<span class="builtintype" id="2641099">nil</span><span class="op" id="2641102">,</span>&nbsp;<span class="ident" id="2641104">errors</span><span class="op" id="2641110">.</span><span class="ident" id="2641111">New</span><span class="op" id="2641114">(</span><span class="string" id="2641115">&#34;Time.MarshalJSON:&nbsp;year&nbsp;outside&nbsp;of&nbsp;range&nbsp;[0,9999]&#34;</span><span class="op" id="2641165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2641168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2641171">return</span>&nbsp;<span class="op" id="2641178">[</span><span class="op" id="2641179">]</span><span class="builtintype" id="2641180">byte</span><span class="op" id="2641184">(</span><span class="ident" id="2641185">t</span><span class="op" id="2641186">.</span><span class="ident" id="2641187">Format</span><span class="op" id="2641193">(</span><span class="string" id="2641194">`&#34;`</span>&nbsp;<span class="op" id="2641198">+</span>&nbsp;<span class="ident" id="2641200">RFC3339Nano</span>&nbsp;<span class="op" id="2641212">+</span>&nbsp;<span class="string" id="2641214">`&#34;`</span><span class="op" id="2641217">)</span><span class="op" id="2641218">)</span><span class="op" id="2641219">,</span>&nbsp;<span class="builtintype" id="2641221">nil</span><br>
<span class="lineno"></span><span class="op" id="2641225">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="comment" id="2641228">//&nbsp;UnmarshalJSON&nbsp;implements&nbsp;the&nbsp;json.Unmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2641288">//&nbsp;The&nbsp;time&nbsp;is&nbsp;expected&nbsp;to&nbsp;be&nbsp;a&nbsp;quoted&nbsp;string&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="2641354">func</span>&nbsp;<span class="op" id="2641359">(</span><span class="ident" id="2641360">t</span>&nbsp;<span class="op" id="2641362">*</span><span class="ident" id="2641363">Time</span><span class="op" id="2641367">)</span>&nbsp;<span class="ident" id="2641369">UnmarshalJSON</span><span class="op" id="2641382">(</span><span class="ident" id="2641383">data</span>&nbsp;<span class="op" id="2641388">[</span><span class="op" id="2641389">]</span><span class="builtintype" id="2641390">byte</span><span class="op" id="2641394">)</span>&nbsp;<span class="op" id="2641396">(</span><span class="ident" id="2641397">err</span>&nbsp;<span class="builtintype" id="2641401">error</span><span class="op" id="2641406">)</span>&nbsp;<span class="op" id="2641408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2641411">//&nbsp;Fractional&nbsp;seconds&nbsp;are&nbsp;handled&nbsp;implicitly&nbsp;by&nbsp;Parse.</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2641467">*</span><span class="ident" id="2641468">t</span><span class="op" id="2641469">,</span>&nbsp;<span class="ident" id="2641471">err</span>&nbsp;<span class="op" id="2641475">=</span>&nbsp;<span class="ident" id="2641477">Parse</span><span class="op" id="2641482">(</span><span class="string" id="2641483">`&#34;`</span><span class="op" id="2641486">+</span><span class="ident" id="2641487">RFC3339</span><span class="op" id="2641494">+</span><span class="string" id="2641495">`&#34;`</span><span class="op" id="2641498">,</span>&nbsp;<span class="builtintype" id="2641500">string</span><span class="op" id="2641506">(</span><span class="ident" id="2641507">data</span><span class="op" id="2641511">)</span><span class="op" id="2641512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2641515">return</span><br>
<span class="lineno"></span><span class="op" id="2641522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2641525">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno">950</span><span class="comment" id="2641589">//&nbsp;The&nbsp;time&nbsp;is&nbsp;formatted&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format,&nbsp;with&nbsp;sub-second&nbsp;precision&nbsp;added&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="2641678">func</span>&nbsp;<span class="op" id="2641683">(</span><span class="ident" id="2641684">t</span>&nbsp;<span class="ident" id="2641686">Time</span><span class="op" id="2641690">)</span>&nbsp;<span class="ident" id="2641692">MarshalText</span><span class="op" id="2641703">(</span><span class="op" id="2641704">)</span>&nbsp;<span class="op" id="2641706">(</span><span class="op" id="2641707">[</span><span class="op" id="2641708">]</span><span class="builtintype" id="2641709">byte</span><span class="op" id="2641713">,</span>&nbsp;<span class="builtintype" id="2641715">error</span><span class="op" id="2641720">)</span>&nbsp;<span class="op" id="2641722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2641725">if</span>&nbsp;<span class="ident" id="2641728">y</span>&nbsp;<span class="op" id="2641730">:=</span>&nbsp;<span class="ident" id="2641733">t</span><span class="op" id="2641734">.</span><span class="ident" id="2641735">Year</span><span class="op" id="2641739">(</span><span class="op" id="2641740">)</span><span class="op" id="2641741">;</span>&nbsp;<span class="ident" id="2641743">y</span>&nbsp;<span class="op" id="2641745">&lt;</span>&nbsp;<span class="num" id="2641747">0</span>&nbsp;<span class="op" id="2641749">||</span>&nbsp;<span class="ident" id="2641752">y</span>&nbsp;<span class="op" id="2641754">&gt;=</span>&nbsp;<span class="num" id="2641757">10000</span>&nbsp;<span class="op" id="2641763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2641767">return</span>&nbsp;<span class="builtintype" id="2641774">nil</span><span class="op" id="2641777">,</span>&nbsp;<span class="ident" id="2641779">errors</span><span class="op" id="2641785">.</span><span class="ident" id="2641786">New</span><span class="op" id="2641789">(</span><span class="string" id="2641790">&#34;Time.MarshalText:&nbsp;year&nbsp;outside&nbsp;of&nbsp;range&nbsp;[0,9999]&#34;</span><span class="op" id="2641840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2641843">}</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2641846">return</span>&nbsp;<span class="op" id="2641853">[</span><span class="op" id="2641854">]</span><span class="builtintype" id="2641855">byte</span><span class="op" id="2641859">(</span><span class="ident" id="2641860">t</span><span class="op" id="2641861">.</span><span class="ident" id="2641862">Format</span><span class="op" id="2641868">(</span><span class="ident" id="2641869">RFC3339Nano</span><span class="op" id="2641880">)</span><span class="op" id="2641881">)</span><span class="op" id="2641882">,</span>&nbsp;<span class="builtintype" id="2641884">nil</span><br>
<span class="lineno"></span><span class="op" id="2641888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2641891">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="2641959">//&nbsp;The&nbsp;time&nbsp;is&nbsp;expected&nbsp;to&nbsp;be&nbsp;in&nbsp;RFC&nbsp;3339&nbsp;format.</span><br>
<span class="lineno">960</span><span class="keyword" id="2642009">func</span>&nbsp;<span class="op" id="2642014">(</span><span class="ident" id="2642015">t</span>&nbsp;<span class="op" id="2642017">*</span><span class="ident" id="2642018">Time</span><span class="op" id="2642022">)</span>&nbsp;<span class="ident" id="2642024">UnmarshalText</span><span class="op" id="2642037">(</span><span class="ident" id="2642038">data</span>&nbsp;<span class="op" id="2642043">[</span><span class="op" id="2642044">]</span><span class="builtintype" id="2642045">byte</span><span class="op" id="2642049">)</span>&nbsp;<span class="op" id="2642051">(</span><span class="ident" id="2642052">err</span>&nbsp;<span class="builtintype" id="2642056">error</span><span class="op" id="2642061">)</span>&nbsp;<span class="op" id="2642063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2642066">//&nbsp;Fractional&nbsp;seconds&nbsp;are&nbsp;handled&nbsp;implicitly&nbsp;by&nbsp;Parse.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2642122">*</span><span class="ident" id="2642123">t</span><span class="op" id="2642124">,</span>&nbsp;<span class="ident" id="2642126">err</span>&nbsp;<span class="op" id="2642130">=</span>&nbsp;<span class="ident" id="2642132">Parse</span><span class="op" id="2642137">(</span><span class="ident" id="2642138">RFC3339</span><span class="op" id="2642145">,</span>&nbsp;<span class="builtintype" id="2642147">string</span><span class="op" id="2642153">(</span><span class="ident" id="2642154">data</span><span class="op" id="2642158">)</span><span class="op" id="2642159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2642162">return</span><br>
<span class="lineno"></span><span class="op" id="2642169">}</span><br>
<span class="lineno">965</span><br>
<span class="lineno"></span><span class="comment" id="2642172">//&nbsp;Unix&nbsp;returns&nbsp;the&nbsp;local&nbsp;Time&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;given&nbsp;Unix&nbsp;time,</span><br>
<span class="lineno"></span><span class="comment" id="2642241">//&nbsp;sec&nbsp;seconds&nbsp;and&nbsp;nsec&nbsp;nanoseconds&nbsp;since&nbsp;January&nbsp;1,&nbsp;1970&nbsp;UTC.</span><br>
<span class="lineno"></span><span class="comment" id="2642304">//&nbsp;It&nbsp;is&nbsp;valid&nbsp;to&nbsp;pass&nbsp;nsec&nbsp;outside&nbsp;the&nbsp;range&nbsp;[0,&nbsp;999999999].</span><br>
<span class="lineno"></span><span class="keyword" id="2642366">func</span>&nbsp;<span class="ident" id="2642371">Unix</span><span class="op" id="2642375">(</span><span class="ident" id="2642376">sec</span>&nbsp;<span class="ident" id="2642380">int64</span><span class="op" id="2642385">,</span>&nbsp;<span class="ident" id="2642387">nsec</span>&nbsp;<span class="ident" id="2642392">int64</span><span class="op" id="2642397">)</span>&nbsp;<span class="ident" id="2642399">Time</span>&nbsp;<span class="op" id="2642404">{</span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2642407">if</span>&nbsp;<span class="ident" id="2642410">nsec</span>&nbsp;<span class="op" id="2642415">&lt;</span>&nbsp;<span class="num" id="2642417">0</span>&nbsp;<span class="op" id="2642419">||</span>&nbsp;<span class="ident" id="2642422">nsec</span>&nbsp;<span class="op" id="2642427">&gt;=</span>&nbsp;<span class="num" id="2642430">1e9</span>&nbsp;<span class="op" id="2642434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2642438">n</span>&nbsp;<span class="op" id="2642440">:=</span>&nbsp;<span class="ident" id="2642443">nsec</span>&nbsp;<span class="op" id="2642448">/</span>&nbsp;<span class="num" id="2642450">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2642456">sec</span>&nbsp;<span class="op" id="2642460">+=</span>&nbsp;<span class="ident" id="2642463">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2642467">nsec</span>&nbsp;<span class="op" id="2642472">-=</span>&nbsp;<span class="ident" id="2642475">n</span>&nbsp;<span class="op" id="2642477">*</span>&nbsp;<span class="num" id="2642479">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2642485">if</span>&nbsp;<span class="ident" id="2642488">nsec</span>&nbsp;<span class="op" id="2642493">&lt;</span>&nbsp;<span class="num" id="2642495">0</span>&nbsp;<span class="op" id="2642497">{</span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2642502">nsec</span>&nbsp;<span class="op" id="2642507">+=</span>&nbsp;<span class="num" id="2642510">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2642517">sec</span><span class="op" id="2642520">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2642525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2642528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2642531">return</span>&nbsp;<span class="ident" id="2642538">Time</span><span class="op" id="2642542">{</span><span class="ident" id="2642543">sec</span>&nbsp;<span class="op" id="2642547">+</span>&nbsp;<span class="ident" id="2642549">unixToInternal</span><span class="op" id="2642563">,</span>&nbsp;<span class="builtintype" id="2642565">int32</span><span class="op" id="2642570">(</span><span class="ident" id="2642571">nsec</span><span class="op" id="2642575">)</span><span class="op" id="2642576">,</span>&nbsp;<span class="ident" id="2642578">Local</span><span class="op" id="2642583">}</span><br>
<span class="lineno">980</span><span class="op" id="2642585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2642588">func</span>&nbsp;<span class="ident" id="2642593">isLeap</span><span class="op" id="2642599">(</span><span class="ident" id="2642600">year</span>&nbsp;<span class="builtintype" id="2642605">int</span><span class="op" id="2642608">)</span>&nbsp;<span class="builtintype" id="2642610">bool</span>&nbsp;<span class="op" id="2642615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2642618">return</span>&nbsp;<span class="ident" id="2642625">year</span><span class="op" id="2642629">%</span><span class="num" id="2642630">4</span>&nbsp;<span class="op" id="2642632">==</span>&nbsp;<span class="num" id="2642635">0</span>&nbsp;<span class="op" id="2642637">&amp;&amp;</span>&nbsp;<span class="op" id="2642640">(</span><span class="ident" id="2642641">year</span><span class="op" id="2642645">%</span><span class="num" id="2642646">100</span>&nbsp;<span class="op" id="2642650">!=</span>&nbsp;<span class="num" id="2642653">0</span>&nbsp;<span class="op" id="2642655">||</span>&nbsp;<span class="ident" id="2642658">year</span><span class="op" id="2642662">%</span><span class="num" id="2642663">400</span>&nbsp;<span class="op" id="2642667">==</span>&nbsp;<span class="num" id="2642670">0</span><span class="op" id="2642671">)</span><br>
<span class="lineno"></span><span class="op" id="2642673">}</span><br>
<span class="lineno">985</span><br>
<span class="lineno"></span><span class="comment" id="2642676">//&nbsp;norm&nbsp;returns&nbsp;nhi,&nbsp;nlo&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2642711">//&nbsp;&nbsp;&nbsp;&nbsp;hi&nbsp;*&nbsp;base&nbsp;+&nbsp;lo&nbsp;==&nbsp;nhi&nbsp;*&nbsp;base&nbsp;+&nbsp;nlo</span><br>
<span class="lineno"></span><span class="comment" id="2642749">//&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&lt;=&nbsp;nlo&nbsp;&lt;&nbsp;base</span><br>
<span class="lineno"></span><span class="keyword" id="2642768">func</span>&nbsp;<span class="ident" id="2642773">norm</span><span class="op" id="2642777">(</span><span class="ident" id="2642778">hi</span><span class="op" id="2642780">,</span>&nbsp;<span class="ident" id="2642782">lo</span><span class="op" id="2642784">,</span>&nbsp;<span class="ident" id="2642786">base</span>&nbsp;<span class="builtintype" id="2642791">int</span><span class="op" id="2642794">)</span>&nbsp;<span class="op" id="2642796">(</span><span class="ident" id="2642797">nhi</span><span class="op" id="2642800">,</span>&nbsp;<span class="ident" id="2642802">nlo</span>&nbsp;<span class="builtintype" id="2642806">int</span><span class="op" id="2642809">)</span>&nbsp;<span class="op" id="2642811">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2642814">if</span>&nbsp;<span class="ident" id="2642817">lo</span>&nbsp;<span class="op" id="2642820">&lt;</span>&nbsp;<span class="num" id="2642822">0</span>&nbsp;<span class="op" id="2642824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2642828">n</span>&nbsp;<span class="op" id="2642830">:=</span>&nbsp;<span class="op" id="2642833">(</span><span class="op" id="2642834">-</span><span class="ident" id="2642835">lo</span><span class="op" id="2642837">-</span><span class="num" id="2642838">1</span><span class="op" id="2642839">)</span><span class="op" id="2642840">/</span><span class="ident" id="2642841">base</span>&nbsp;<span class="op" id="2642846">+</span>&nbsp;<span class="num" id="2642848">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2642852">hi</span>&nbsp;<span class="op" id="2642855">-=</span>&nbsp;<span class="ident" id="2642858">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2642862">lo</span>&nbsp;<span class="op" id="2642865">+=</span>&nbsp;<span class="ident" id="2642868">n</span>&nbsp;<span class="op" id="2642870">*</span>&nbsp;<span class="ident" id="2642872">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2642878">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2642881">if</span>&nbsp;<span class="ident" id="2642884">lo</span>&nbsp;<span class="op" id="2642887">&gt;=</span>&nbsp;<span class="ident" id="2642890">base</span>&nbsp;<span class="op" id="2642895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2642899">n</span>&nbsp;<span class="op" id="2642901">:=</span>&nbsp;<span class="ident" id="2642904">lo</span>&nbsp;<span class="op" id="2642907">/</span>&nbsp;<span class="ident" id="2642909">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2642916">hi</span>&nbsp;<span class="op" id="2642919">+=</span>&nbsp;<span class="ident" id="2642922">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2642926">lo</span>&nbsp;<span class="op" id="2642929">-=</span>&nbsp;<span class="ident" id="2642932">n</span>&nbsp;<span class="op" id="2642934">*</span>&nbsp;<span class="ident" id="2642936">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2642942">}</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2642945">return</span>&nbsp;<span class="ident" id="2642952">hi</span><span class="op" id="2642954">,</span>&nbsp;<span class="ident" id="2642956">lo</span><br>
<span class="lineno"></span><span class="op" id="2642959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2642962">//&nbsp;Date&nbsp;returns&nbsp;the&nbsp;Time&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="2643004">//&nbsp;&nbsp;&nbsp;&nbsp;yyyy-mm-dd&nbsp;hh:mm:ss&nbsp;+&nbsp;nsec&nbsp;nanoseconds</span><br>
<span class="lineno">1005</span><span class="comment" id="2643046">//&nbsp;in&nbsp;the&nbsp;appropriate&nbsp;zone&nbsp;for&nbsp;that&nbsp;time&nbsp;in&nbsp;the&nbsp;given&nbsp;location.</span><br>
<span class="lineno"></span><span class="comment" id="2643110">//</span><br>
<span class="lineno"></span><span class="comment" id="2643113">//&nbsp;The&nbsp;month,&nbsp;day,&nbsp;hour,&nbsp;min,&nbsp;sec,&nbsp;and&nbsp;nsec&nbsp;values&nbsp;may&nbsp;be&nbsp;outside</span><br>
<span class="lineno"></span><span class="comment" id="2643179">//&nbsp;their&nbsp;usual&nbsp;ranges&nbsp;and&nbsp;will&nbsp;be&nbsp;normalized&nbsp;during&nbsp;the&nbsp;conversion.</span><br>
<span class="lineno"></span><span class="comment" id="2643247">//&nbsp;For&nbsp;example,&nbsp;October&nbsp;32&nbsp;converts&nbsp;to&nbsp;November&nbsp;1.</span><br>
<span class="lineno">1010</span><span class="comment" id="2643298">//</span><br>
<span class="lineno"></span><span class="comment" id="2643301">//&nbsp;A&nbsp;daylight&nbsp;savings&nbsp;time&nbsp;transition&nbsp;skips&nbsp;or&nbsp;repeats&nbsp;times.</span><br>
<span class="lineno"></span><span class="comment" id="2643363">//&nbsp;For&nbsp;example,&nbsp;in&nbsp;the&nbsp;United&nbsp;States,&nbsp;March&nbsp;13,&nbsp;2011&nbsp;2:15am&nbsp;never&nbsp;occurred,</span><br>
<span class="lineno"></span><span class="comment" id="2643439">//&nbsp;while&nbsp;November&nbsp;6,&nbsp;2011&nbsp;1:15am&nbsp;occurred&nbsp;twice.&nbsp;&nbsp;In&nbsp;such&nbsp;cases,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2643508">//&nbsp;choice&nbsp;of&nbsp;time&nbsp;zone,&nbsp;and&nbsp;therefore&nbsp;the&nbsp;time,&nbsp;is&nbsp;not&nbsp;well-defined.</span><br>
<span class="lineno">1015</span><span class="comment" id="2643577">//&nbsp;Date&nbsp;returns&nbsp;a&nbsp;time&nbsp;that&nbsp;is&nbsp;correct&nbsp;in&nbsp;one&nbsp;of&nbsp;the&nbsp;two&nbsp;zones&nbsp;involved</span><br>
<span class="lineno"></span><span class="comment" id="2643649">//&nbsp;in&nbsp;the&nbsp;transition,&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;guarantee&nbsp;which.</span><br>
<span class="lineno"></span><span class="comment" id="2643704">//</span><br>
<span class="lineno"></span><span class="comment" id="2643707">//&nbsp;Date&nbsp;panics&nbsp;if&nbsp;loc&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="2643737">func</span>&nbsp;<span class="ident" id="2643742">Date</span><span class="op" id="2643746">(</span><span class="ident" id="2643747">year</span>&nbsp;<span class="builtintype" id="2643752">int</span><span class="op" id="2643755">,</span>&nbsp;<span class="ident" id="2643757">month</span>&nbsp;<span class="ident" id="2643763">Month</span><span class="op" id="2643768">,</span>&nbsp;<span class="ident" id="2643770">day</span><span class="op" id="2643773">,</span>&nbsp;<span class="ident" id="2643775">hour</span><span class="op" id="2643779">,</span>&nbsp;<span class="ident" id="2643781">min</span><span class="op" id="2643784">,</span>&nbsp;<span class="ident" id="2643786">sec</span><span class="op" id="2643789">,</span>&nbsp;<span class="ident" id="2643791">nsec</span>&nbsp;<span class="builtintype" id="2643796">int</span><span class="op" id="2643799">,</span>&nbsp;<span class="ident" id="2643801">loc</span>&nbsp;<span class="op" id="2643805">*</span><span class="ident" id="2643806">Location</span><span class="op" id="2643814">)</span>&nbsp;<span class="ident" id="2643816">Time</span>&nbsp;<span class="op" id="2643821">{</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2643824">if</span>&nbsp;<span class="ident" id="2643827">loc</span>&nbsp;<span class="op" id="2643831">==</span>&nbsp;<span class="builtintype" id="2643834">nil</span>&nbsp;<span class="op" id="2643838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2643842">panic</span><span class="op" id="2643847">(</span><span class="string" id="2643848">&#34;time:&nbsp;missing&nbsp;Location&nbsp;in&nbsp;call&nbsp;to&nbsp;Date&#34;</span><span class="op" id="2643888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2643891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2643895">//&nbsp;Normalize&nbsp;month,&nbsp;overflowing&nbsp;into&nbsp;year.</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2643939">m</span>&nbsp;<span class="op" id="2643941">:=</span>&nbsp;<span class="builtintype" id="2643944">int</span><span class="op" id="2643947">(</span><span class="ident" id="2643948">month</span><span class="op" id="2643953">)</span>&nbsp;<span class="op" id="2643955">-</span>&nbsp;<span class="num" id="2643957">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2643960">year</span><span class="op" id="2643964">,</span>&nbsp;<span class="ident" id="2643966">m</span>&nbsp;<span class="op" id="2643968">=</span>&nbsp;<span class="ident" id="2643970">norm</span><span class="op" id="2643974">(</span><span class="ident" id="2643975">year</span><span class="op" id="2643979">,</span>&nbsp;<span class="ident" id="2643981">m</span><span class="op" id="2643982">,</span>&nbsp;<span class="num" id="2643984">12</span><span class="op" id="2643986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2643989">month</span>&nbsp;<span class="op" id="2643995">=</span>&nbsp;<span class="ident" id="2643997">Month</span><span class="op" id="2644002">(</span><span class="ident" id="2644003">m</span><span class="op" id="2644004">)</span>&nbsp;<span class="op" id="2644006">+</span>&nbsp;<span class="num" id="2644008">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2644012">//&nbsp;Normalize&nbsp;nsec,&nbsp;sec,&nbsp;min,&nbsp;hour,&nbsp;overflowing&nbsp;into&nbsp;day.</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644070">sec</span><span class="op" id="2644073">,</span>&nbsp;<span class="ident" id="2644075">nsec</span>&nbsp;<span class="op" id="2644080">=</span>&nbsp;<span class="ident" id="2644082">norm</span><span class="op" id="2644086">(</span><span class="ident" id="2644087">sec</span><span class="op" id="2644090">,</span>&nbsp;<span class="ident" id="2644092">nsec</span><span class="op" id="2644096">,</span>&nbsp;<span class="num" id="2644098">1e9</span><span class="op" id="2644101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644104">min</span><span class="op" id="2644107">,</span>&nbsp;<span class="ident" id="2644109">sec</span>&nbsp;<span class="op" id="2644113">=</span>&nbsp;<span class="ident" id="2644115">norm</span><span class="op" id="2644119">(</span><span class="ident" id="2644120">min</span><span class="op" id="2644123">,</span>&nbsp;<span class="ident" id="2644125">sec</span><span class="op" id="2644128">,</span>&nbsp;<span class="num" id="2644130">60</span><span class="op" id="2644132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644135">hour</span><span class="op" id="2644139">,</span>&nbsp;<span class="ident" id="2644141">min</span>&nbsp;<span class="op" id="2644145">=</span>&nbsp;<span class="ident" id="2644147">norm</span><span class="op" id="2644151">(</span><span class="ident" id="2644152">hour</span><span class="op" id="2644156">,</span>&nbsp;<span class="ident" id="2644158">min</span><span class="op" id="2644161">,</span>&nbsp;<span class="num" id="2644163">60</span><span class="op" id="2644165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644168">day</span><span class="op" id="2644171">,</span>&nbsp;<span class="ident" id="2644173">hour</span>&nbsp;<span class="op" id="2644178">=</span>&nbsp;<span class="ident" id="2644180">norm</span><span class="op" id="2644184">(</span><span class="ident" id="2644185">day</span><span class="op" id="2644188">,</span>&nbsp;<span class="ident" id="2644190">hour</span><span class="op" id="2644194">,</span>&nbsp;<span class="num" id="2644196">24</span><span class="op" id="2644198">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644202">y</span>&nbsp;<span class="op" id="2644204">:=</span>&nbsp;<span class="ident" id="2644207">uint64</span><span class="op" id="2644213">(</span><span class="ident" id="2644214">int64</span><span class="op" id="2644219">(</span><span class="ident" id="2644220">year</span><span class="op" id="2644224">)</span>&nbsp;<span class="op" id="2644226">-</span>&nbsp;<span class="ident" id="2644228">absoluteZeroYear</span><span class="op" id="2644244">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2644248">//&nbsp;Compute&nbsp;days&nbsp;since&nbsp;the&nbsp;absolute&nbsp;epoch.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2644292">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;from&nbsp;400-year&nbsp;cycles.</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644330">n</span>&nbsp;<span class="op" id="2644332">:=</span>&nbsp;<span class="ident" id="2644335">y</span>&nbsp;<span class="op" id="2644337">/</span>&nbsp;<span class="num" id="2644339">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644344">y</span>&nbsp;<span class="op" id="2644346">-=</span>&nbsp;<span class="num" id="2644349">400</span>&nbsp;<span class="op" id="2644353">*</span>&nbsp;<span class="ident" id="2644355">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644358">d</span>&nbsp;<span class="op" id="2644360">:=</span>&nbsp;<span class="ident" id="2644363">daysPer400Years</span>&nbsp;<span class="op" id="2644379">*</span>&nbsp;<span class="ident" id="2644381">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2644385">//&nbsp;Add&nbsp;in&nbsp;100-year&nbsp;cycles.</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644413">n</span>&nbsp;<span class="op" id="2644415">=</span>&nbsp;<span class="ident" id="2644417">y</span>&nbsp;<span class="op" id="2644419">/</span>&nbsp;<span class="num" id="2644421">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644426">y</span>&nbsp;<span class="op" id="2644428">-=</span>&nbsp;<span class="num" id="2644431">100</span>&nbsp;<span class="op" id="2644435">*</span>&nbsp;<span class="ident" id="2644437">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644440">d</span>&nbsp;<span class="op" id="2644442">+=</span>&nbsp;<span class="ident" id="2644445">daysPer100Years</span>&nbsp;<span class="op" id="2644461">*</span>&nbsp;<span class="ident" id="2644463">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2644467">//&nbsp;Add&nbsp;in&nbsp;4-year&nbsp;cycles.</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644493">n</span>&nbsp;<span class="op" id="2644495">=</span>&nbsp;<span class="ident" id="2644497">y</span>&nbsp;<span class="op" id="2644499">/</span>&nbsp;<span class="num" id="2644501">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644504">y</span>&nbsp;<span class="op" id="2644506">-=</span>&nbsp;<span class="num" id="2644509">4</span>&nbsp;<span class="op" id="2644511">*</span>&nbsp;<span class="ident" id="2644513">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644516">d</span>&nbsp;<span class="op" id="2644518">+=</span>&nbsp;<span class="ident" id="2644521">daysPer4Years</span>&nbsp;<span class="op" id="2644535">*</span>&nbsp;<span class="ident" id="2644537">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2644541">//&nbsp;Add&nbsp;in&nbsp;non-leap&nbsp;years.</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644568">n</span>&nbsp;<span class="op" id="2644570">=</span>&nbsp;<span class="ident" id="2644572">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644575">d</span>&nbsp;<span class="op" id="2644577">+=</span>&nbsp;<span class="num" id="2644580">365</span>&nbsp;<span class="op" id="2644584">*</span>&nbsp;<span class="ident" id="2644586">n</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2644590">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;before&nbsp;this&nbsp;month.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644625">d</span>&nbsp;<span class="op" id="2644627">+=</span>&nbsp;<span class="ident" id="2644630">uint64</span><span class="op" id="2644636">(</span><span class="ident" id="2644637">daysBefore</span><span class="op" id="2644647">[</span><span class="ident" id="2644648">month</span><span class="op" id="2644653">-</span><span class="num" id="2644654">1</span><span class="op" id="2644655">]</span><span class="op" id="2644656">)</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2644659">if</span>&nbsp;<span class="ident" id="2644662">isLeap</span><span class="op" id="2644668">(</span><span class="ident" id="2644669">year</span><span class="op" id="2644673">)</span>&nbsp;<span class="op" id="2644675">&amp;&amp;</span>&nbsp;<span class="ident" id="2644678">month</span>&nbsp;<span class="op" id="2644684">&gt;=</span>&nbsp;<span class="ident" id="2644687">March</span>&nbsp;<span class="op" id="2644693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644697">d</span><span class="op" id="2644698">++</span>&nbsp;<span class="comment" id="2644701">//&nbsp;February&nbsp;29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2644717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2644721">//&nbsp;Add&nbsp;in&nbsp;days&nbsp;before&nbsp;today.</span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644751">d</span>&nbsp;<span class="op" id="2644753">+=</span>&nbsp;<span class="ident" id="2644756">uint64</span><span class="op" id="2644762">(</span><span class="ident" id="2644763">day</span>&nbsp;<span class="op" id="2644767">-</span>&nbsp;<span class="num" id="2644769">1</span><span class="op" id="2644770">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2644774">//&nbsp;Add&nbsp;in&nbsp;time&nbsp;elapsed&nbsp;today.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644805">abs</span>&nbsp;<span class="op" id="2644809">:=</span>&nbsp;<span class="ident" id="2644812">d</span>&nbsp;<span class="op" id="2644814">*</span>&nbsp;<span class="ident" id="2644816">secondsPerDay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644831">abs</span>&nbsp;<span class="op" id="2644835">+=</span>&nbsp;<span class="ident" id="2644838">uint64</span><span class="op" id="2644844">(</span><span class="ident" id="2644845">hour</span><span class="op" id="2644849">*</span><span class="ident" id="2644850">secondsPerHour</span>&nbsp;<span class="op" id="2644865">+</span>&nbsp;<span class="ident" id="2644867">min</span><span class="op" id="2644870">*</span><span class="ident" id="2644871">secondsPerMinute</span>&nbsp;<span class="op" id="2644888">+</span>&nbsp;<span class="ident" id="2644890">sec</span><span class="op" id="2644893">)</span><br>
<span class="lineno">1070</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2644897">unix</span>&nbsp;<span class="op" id="2644902">:=</span>&nbsp;<span class="ident" id="2644905">int64</span><span class="op" id="2644910">(</span><span class="ident" id="2644911">abs</span><span class="op" id="2644914">)</span>&nbsp;<span class="op" id="2644916">+</span>&nbsp;<span class="op" id="2644918">(</span><span class="ident" id="2644919">absoluteToInternal</span>&nbsp;<span class="op" id="2644938">+</span>&nbsp;<span class="ident" id="2644940">internalToUnix</span><span class="op" id="2644954">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2644958">//&nbsp;Look&nbsp;for&nbsp;zone&nbsp;offset&nbsp;for&nbsp;t,&nbsp;so&nbsp;we&nbsp;can&nbsp;adjust&nbsp;to&nbsp;UTC.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2645015">//&nbsp;The&nbsp;lookup&nbsp;function&nbsp;expects&nbsp;UTC,&nbsp;so&nbsp;we&nbsp;pass&nbsp;t&nbsp;in&nbsp;the</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2645072">//&nbsp;hope&nbsp;that&nbsp;it&nbsp;will&nbsp;not&nbsp;be&nbsp;too&nbsp;close&nbsp;to&nbsp;a&nbsp;zone&nbsp;transition,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2645133">//&nbsp;and&nbsp;then&nbsp;adjust&nbsp;if&nbsp;it&nbsp;is.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2645163">_</span><span class="op" id="2645164">,</span>&nbsp;<span class="ident" id="2645166">offset</span><span class="op" id="2645172">,</span>&nbsp;<span class="ident" id="2645174">_</span><span class="op" id="2645175">,</span>&nbsp;<span class="ident" id="2645177">start</span><span class="op" id="2645182">,</span>&nbsp;<span class="ident" id="2645184">end</span>&nbsp;<span class="op" id="2645188">:=</span>&nbsp;<span class="ident" id="2645191">loc</span><span class="op" id="2645194">.</span><span class="ident" id="2645195">lookup</span><span class="op" id="2645201">(</span><span class="ident" id="2645202">unix</span><span class="op" id="2645206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2645209">if</span>&nbsp;<span class="ident" id="2645212">offset</span>&nbsp;<span class="op" id="2645219">!=</span>&nbsp;<span class="num" id="2645222">0</span>&nbsp;<span class="op" id="2645224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2645228">switch</span>&nbsp;<span class="ident" id="2645235">utc</span>&nbsp;<span class="op" id="2645239">:=</span>&nbsp;<span class="ident" id="2645242">unix</span>&nbsp;<span class="op" id="2645247">-</span>&nbsp;<span class="ident" id="2645249">int64</span><span class="op" id="2645254">(</span><span class="ident" id="2645255">offset</span><span class="op" id="2645261">)</span><span class="op" id="2645262">;</span>&nbsp;<span class="op" id="2645264">{</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2645268">case</span>&nbsp;<span class="ident" id="2645273">utc</span>&nbsp;<span class="op" id="2645277">&lt;</span>&nbsp;<span class="ident" id="2645279">start</span><span class="op" id="2645284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2645289">_</span><span class="op" id="2645290">,</span>&nbsp;<span class="ident" id="2645292">offset</span><span class="op" id="2645298">,</span>&nbsp;<span class="ident" id="2645300">_</span><span class="op" id="2645301">,</span>&nbsp;<span class="ident" id="2645303">_</span><span class="op" id="2645304">,</span>&nbsp;<span class="ident" id="2645306">_</span>&nbsp;<span class="op" id="2645308">=</span>&nbsp;<span class="ident" id="2645310">loc</span><span class="op" id="2645313">.</span><span class="ident" id="2645314">lookup</span><span class="op" id="2645320">(</span><span class="ident" id="2645321">start</span>&nbsp;<span class="op" id="2645327">-</span>&nbsp;<span class="num" id="2645329">1</span><span class="op" id="2645330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2645334">case</span>&nbsp;<span class="ident" id="2645339">utc</span>&nbsp;<span class="op" id="2645343">&gt;=</span>&nbsp;<span class="ident" id="2645346">end</span><span class="op" id="2645349">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2645354">_</span><span class="op" id="2645355">,</span>&nbsp;<span class="ident" id="2645357">offset</span><span class="op" id="2645363">,</span>&nbsp;<span class="ident" id="2645365">_</span><span class="op" id="2645366">,</span>&nbsp;<span class="ident" id="2645368">_</span><span class="op" id="2645369">,</span>&nbsp;<span class="ident" id="2645371">_</span>&nbsp;<span class="op" id="2645373">=</span>&nbsp;<span class="ident" id="2645375">loc</span><span class="op" id="2645378">.</span><span class="ident" id="2645379">lookup</span><span class="op" id="2645385">(</span><span class="ident" id="2645386">end</span><span class="op" id="2645389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2645393">}</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2645397">unix</span>&nbsp;<span class="op" id="2645402">-=</span>&nbsp;<span class="ident" id="2645405">int64</span><span class="op" id="2645410">(</span><span class="ident" id="2645411">offset</span><span class="op" id="2645417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2645420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2645424">return</span>&nbsp;<span class="ident" id="2645431">Time</span><span class="op" id="2645435">{</span><span class="ident" id="2645436">unix</span>&nbsp;<span class="op" id="2645441">+</span>&nbsp;<span class="ident" id="2645443">unixToInternal</span><span class="op" id="2645457">,</span>&nbsp;<span class="builtintype" id="2645459">int32</span><span class="op" id="2645464">(</span><span class="ident" id="2645465">nsec</span><span class="op" id="2645469">)</span><span class="op" id="2645470">,</span>&nbsp;<span class="ident" id="2645472">loc</span><span class="op" id="2645475">}</span><br>
<span class="lineno"></span><span class="op" id="2645477">}</span><br>
<span class="lineno">1090</span><br>
<span class="lineno"></span><span class="comment" id="2645480">//&nbsp;Truncate&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;t&nbsp;down&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;d&nbsp;(since&nbsp;the&nbsp;zero&nbsp;time).</span><br>
<span class="lineno"></span><span class="comment" id="2645572">//&nbsp;If&nbsp;d&nbsp;&lt;=&nbsp;0,&nbsp;Truncate&nbsp;returns&nbsp;t&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2645616">func</span>&nbsp;<span class="op" id="2645621">(</span><span class="ident" id="2645622">t</span>&nbsp;<span class="ident" id="2645624">Time</span><span class="op" id="2645628">)</span>&nbsp;<span class="ident" id="2645630">Truncate</span><span class="op" id="2645638">(</span><span class="ident" id="2645639">d</span>&nbsp;<span class="ident" id="2645641">Duration</span><span class="op" id="2645649">)</span>&nbsp;<span class="ident" id="2645651">Time</span>&nbsp;<span class="op" id="2645656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2645659">if</span>&nbsp;<span class="ident" id="2645662">d</span>&nbsp;<span class="op" id="2645664">&lt;=</span>&nbsp;<span class="num" id="2645667">0</span>&nbsp;<span class="op" id="2645669">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2645673">return</span>&nbsp;<span class="ident" id="2645680">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2645683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2645686">_</span><span class="op" id="2645687">,</span>&nbsp;<span class="ident" id="2645689">r</span>&nbsp;<span class="op" id="2645691">:=</span>&nbsp;<span class="ident" id="2645694">div</span><span class="op" id="2645697">(</span><span class="ident" id="2645698">t</span><span class="op" id="2645699">,</span>&nbsp;<span class="ident" id="2645701">d</span><span class="op" id="2645702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2645705">return</span>&nbsp;<span class="ident" id="2645712">t</span><span class="op" id="2645713">.</span><span class="ident" id="2645714">Add</span><span class="op" id="2645717">(</span><span class="op" id="2645718">-</span><span class="ident" id="2645719">r</span><span class="op" id="2645720">)</span><br>
<span class="lineno"></span><span class="op" id="2645722">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="comment" id="2645725">//&nbsp;Round&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;rounding&nbsp;t&nbsp;to&nbsp;the&nbsp;nearest&nbsp;multiple&nbsp;of&nbsp;d&nbsp;(since&nbsp;the&nbsp;zero&nbsp;time).</span><br>
<span class="lineno"></span><span class="comment" id="2645819">//&nbsp;The&nbsp;rounding&nbsp;behavior&nbsp;for&nbsp;halfway&nbsp;values&nbsp;is&nbsp;to&nbsp;round&nbsp;up.</span><br>
<span class="lineno"></span><span class="comment" id="2645879">//&nbsp;If&nbsp;d&nbsp;&lt;=&nbsp;0,&nbsp;Round&nbsp;returns&nbsp;t&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="keyword" id="2645920">func</span>&nbsp;<span class="op" id="2645925">(</span><span class="ident" id="2645926">t</span>&nbsp;<span class="ident" id="2645928">Time</span><span class="op" id="2645932">)</span>&nbsp;<span class="ident" id="2645934">Round</span><span class="op" id="2645939">(</span><span class="ident" id="2645940">d</span>&nbsp;<span class="ident" id="2645942">Duration</span><span class="op" id="2645950">)</span>&nbsp;<span class="ident" id="2645952">Time</span>&nbsp;<span class="op" id="2645957">{</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2645960">if</span>&nbsp;<span class="ident" id="2645963">d</span>&nbsp;<span class="op" id="2645965">&lt;=</span>&nbsp;<span class="num" id="2645968">0</span>&nbsp;<span class="op" id="2645970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2645974">return</span>&nbsp;<span class="ident" id="2645981">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2645984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2645987">_</span><span class="op" id="2645988">,</span>&nbsp;<span class="ident" id="2645990">r</span>&nbsp;<span class="op" id="2645992">:=</span>&nbsp;<span class="ident" id="2645995">div</span><span class="op" id="2645998">(</span><span class="ident" id="2645999">t</span><span class="op" id="2646000">,</span>&nbsp;<span class="ident" id="2646002">d</span><span class="op" id="2646003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2646006">if</span>&nbsp;<span class="ident" id="2646009">r</span><span class="op" id="2646010">+</span><span class="ident" id="2646011">r</span>&nbsp;<span class="op" id="2646013">&lt;</span>&nbsp;<span class="ident" id="2646015">d</span>&nbsp;<span class="op" id="2646017">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2646021">return</span>&nbsp;<span class="ident" id="2646028">t</span><span class="op" id="2646029">.</span><span class="ident" id="2646030">Add</span><span class="op" id="2646033">(</span><span class="op" id="2646034">-</span><span class="ident" id="2646035">r</span><span class="op" id="2646036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2646039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2646042">return</span>&nbsp;<span class="ident" id="2646049">t</span><span class="op" id="2646050">.</span><span class="ident" id="2646051">Add</span><span class="op" id="2646054">(</span><span class="ident" id="2646055">d</span>&nbsp;<span class="op" id="2646057">-</span>&nbsp;<span class="ident" id="2646059">r</span><span class="op" id="2646060">)</span><br>
<span class="lineno"></span><span class="op" id="2646062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1115</span><span class="comment" id="2646065">//&nbsp;div&nbsp;divides&nbsp;t&nbsp;by&nbsp;d&nbsp;and&nbsp;returns&nbsp;the&nbsp;quotient&nbsp;parity&nbsp;and&nbsp;remainder.</span><br>
<span class="lineno"></span><span class="comment" id="2646134">//&nbsp;We&nbsp;don&#39;t&nbsp;use&nbsp;the&nbsp;quotient&nbsp;parity&nbsp;anymore&nbsp;(round&nbsp;half&nbsp;up&nbsp;instead&nbsp;of&nbsp;round&nbsp;to&nbsp;even)</span><br>
<span class="lineno"></span><span class="comment" id="2646219">//&nbsp;but&nbsp;it&#39;s&nbsp;still&nbsp;here&nbsp;in&nbsp;case&nbsp;we&nbsp;change&nbsp;our&nbsp;minds.</span><br>
<span class="lineno"></span><span class="keyword" id="2646271">func</span>&nbsp;<span class="ident" id="2646276">div</span><span class="op" id="2646279">(</span><span class="ident" id="2646280">t</span>&nbsp;<span class="ident" id="2646282">Time</span><span class="op" id="2646286">,</span>&nbsp;<span class="ident" id="2646288">d</span>&nbsp;<span class="ident" id="2646290">Duration</span><span class="op" id="2646298">)</span>&nbsp;<span class="op" id="2646300">(</span><span class="ident" id="2646301">qmod2</span>&nbsp;<span class="builtintype" id="2646307">int</span><span class="op" id="2646310">,</span>&nbsp;<span class="ident" id="2646312">r</span>&nbsp;<span class="ident" id="2646314">Duration</span><span class="op" id="2646322">)</span>&nbsp;<span class="op" id="2646324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646327">neg</span>&nbsp;<span class="op" id="2646331">:=</span>&nbsp;<span class="builtintype" id="2646334">false</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646341">nsec</span>&nbsp;<span class="op" id="2646346">:=</span>&nbsp;<span class="builtintype" id="2646349">int32</span><span class="op" id="2646354">(</span><span class="ident" id="2646355">t</span><span class="op" id="2646356">.</span><span class="ident" id="2646357">nsec</span><span class="op" id="2646361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2646364">if</span>&nbsp;<span class="ident" id="2646367">t</span><span class="op" id="2646368">.</span><span class="ident" id="2646369">sec</span>&nbsp;<span class="op" id="2646373">&lt;</span>&nbsp;<span class="num" id="2646375">0</span>&nbsp;<span class="op" id="2646377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2646381">//&nbsp;Operate&nbsp;on&nbsp;absolute&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646413">neg</span>&nbsp;<span class="op" id="2646417">=</span>&nbsp;<span class="builtintype" id="2646419">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646426">t</span><span class="op" id="2646427">.</span><span class="ident" id="2646428">sec</span>&nbsp;<span class="op" id="2646432">=</span>&nbsp;<span class="op" id="2646434">-</span><span class="ident" id="2646435">t</span><span class="op" id="2646436">.</span><span class="ident" id="2646437">sec</span><br>
<span class="lineno">1125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646443">nsec</span>&nbsp;<span class="op" id="2646448">=</span>&nbsp;<span class="op" id="2646450">-</span><span class="ident" id="2646451">nsec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2646458">if</span>&nbsp;<span class="ident" id="2646461">nsec</span>&nbsp;<span class="op" id="2646466">&lt;</span>&nbsp;<span class="num" id="2646468">0</span>&nbsp;<span class="op" id="2646470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646475">nsec</span>&nbsp;<span class="op" id="2646480">+=</span>&nbsp;<span class="num" id="2646483">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646490">t</span><span class="op" id="2646491">.</span><span class="ident" id="2646492">sec</span><span class="op" id="2646495">--</span>&nbsp;<span class="comment" id="2646498">//&nbsp;t.sec&nbsp;&gt;=&nbsp;1&nbsp;before&nbsp;the&nbsp;--&nbsp;so&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2646536">}</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2646539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2646543">switch</span>&nbsp;<span class="op" id="2646550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2646553">//&nbsp;Special&nbsp;case:&nbsp;2d&nbsp;divides&nbsp;1&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2646592">case</span>&nbsp;<span class="ident" id="2646597">d</span>&nbsp;<span class="op" id="2646599">&lt;</span>&nbsp;<span class="ident" id="2646601">Second</span>&nbsp;<span class="op" id="2646608">&amp;&amp;</span>&nbsp;<span class="ident" id="2646611">Second</span><span class="op" id="2646617">%</span><span class="op" id="2646618">(</span><span class="ident" id="2646619">d</span><span class="op" id="2646620">+</span><span class="ident" id="2646621">d</span><span class="op" id="2646622">)</span>&nbsp;<span class="op" id="2646624">==</span>&nbsp;<span class="num" id="2646627">0</span><span class="op" id="2646628">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646632">qmod2</span>&nbsp;<span class="op" id="2646638">=</span>&nbsp;<span class="builtintype" id="2646640">int</span><span class="op" id="2646643">(</span><span class="ident" id="2646644">nsec</span><span class="op" id="2646648">/</span><span class="builtintype" id="2646649">int32</span><span class="op" id="2646654">(</span><span class="ident" id="2646655">d</span><span class="op" id="2646656">)</span><span class="op" id="2646657">)</span>&nbsp;<span class="op" id="2646659">&amp;</span>&nbsp;<span class="num" id="2646661">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646665">r</span>&nbsp;<span class="op" id="2646667">=</span>&nbsp;<span class="ident" id="2646669">Duration</span><span class="op" id="2646677">(</span><span class="ident" id="2646678">nsec</span>&nbsp;<span class="op" id="2646683">%</span>&nbsp;<span class="builtintype" id="2646685">int32</span><span class="op" id="2646690">(</span><span class="ident" id="2646691">d</span><span class="op" id="2646692">)</span><span class="op" id="2646693">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2646697">//&nbsp;Special&nbsp;case:&nbsp;d&nbsp;is&nbsp;a&nbsp;multiple&nbsp;of&nbsp;1&nbsp;second.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2646744">case</span>&nbsp;<span class="ident" id="2646749">d</span><span class="op" id="2646750">%</span><span class="ident" id="2646751">Second</span>&nbsp;<span class="op" id="2646758">==</span>&nbsp;<span class="num" id="2646761">0</span><span class="op" id="2646762">:</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646766">d1</span>&nbsp;<span class="op" id="2646769">:=</span>&nbsp;<span class="ident" id="2646772">int64</span><span class="op" id="2646777">(</span><span class="ident" id="2646778">d</span>&nbsp;<span class="op" id="2646780">/</span>&nbsp;<span class="ident" id="2646782">Second</span><span class="op" id="2646788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646792">qmod2</span>&nbsp;<span class="op" id="2646798">=</span>&nbsp;<span class="builtintype" id="2646800">int</span><span class="op" id="2646803">(</span><span class="ident" id="2646804">t</span><span class="op" id="2646805">.</span><span class="ident" id="2646806">sec</span><span class="op" id="2646809">/</span><span class="ident" id="2646810">d1</span><span class="op" id="2646812">)</span>&nbsp;<span class="op" id="2646814">&amp;</span>&nbsp;<span class="num" id="2646816">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2646820">r</span>&nbsp;<span class="op" id="2646822">=</span>&nbsp;<span class="ident" id="2646824">Duration</span><span class="op" id="2646832">(</span><span class="ident" id="2646833">t</span><span class="op" id="2646834">.</span><span class="ident" id="2646835">sec</span><span class="op" id="2646838">%</span><span class="ident" id="2646839">d1</span><span class="op" id="2646841">)</span><span class="op" id="2646842">*</span><span class="ident" id="2646843">Second</span>&nbsp;<span class="op" id="2646850">+</span>&nbsp;<span class="ident" id="2646852">Duration</span><span class="op" id="2646860">(</span><span class="ident" id="2646861">nsec</span><span class="op" id="2646865">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2646869">//&nbsp;General&nbsp;case.</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2646887">//&nbsp;This&nbsp;could&nbsp;be&nbsp;faster&nbsp;if&nbsp;more&nbsp;cleverness&nbsp;were&nbsp;applied,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2646945">//&nbsp;but&nbsp;it&#39;s&nbsp;really&nbsp;only&nbsp;here&nbsp;to&nbsp;avoid&nbsp;special&nbsp;case&nbsp;restrictions&nbsp;in&nbsp;the&nbsp;API.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2647022">//&nbsp;No&nbsp;one&nbsp;will&nbsp;care&nbsp;about&nbsp;these&nbsp;cases.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2647062">default</span><span class="op" id="2647069">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2647073">//&nbsp;Compute&nbsp;nanoseconds&nbsp;as&nbsp;128-bit&nbsp;number.</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647117">sec</span>&nbsp;<span class="op" id="2647121">:=</span>&nbsp;<span class="ident" id="2647124">uint64</span><span class="op" id="2647130">(</span><span class="ident" id="2647131">t</span><span class="op" id="2647132">.</span><span class="ident" id="2647133">sec</span><span class="op" id="2647136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647140">tmp</span>&nbsp;<span class="op" id="2647144">:=</span>&nbsp;<span class="op" id="2647147">(</span><span class="ident" id="2647148">sec</span>&nbsp;<span class="op" id="2647152">&gt;&gt;</span>&nbsp;<span class="num" id="2647155">32</span><span class="op" id="2647157">)</span>&nbsp;<span class="op" id="2647159">*</span>&nbsp;<span class="num" id="2647161">1e9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647167">u1</span>&nbsp;<span class="op" id="2647170">:=</span>&nbsp;<span class="ident" id="2647173">tmp</span>&nbsp;<span class="op" id="2647177">&gt;&gt;</span>&nbsp;<span class="num" id="2647180">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647185">u0</span>&nbsp;<span class="op" id="2647188">:=</span>&nbsp;<span class="ident" id="2647191">tmp</span>&nbsp;<span class="op" id="2647195">&lt;&lt;</span>&nbsp;<span class="num" id="2647198">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647203">tmp</span>&nbsp;<span class="op" id="2647207">=</span>&nbsp;<span class="ident" id="2647209">uint64</span><span class="op" id="2647215">(</span><span class="ident" id="2647216">sec</span><span class="op" id="2647219">&amp;</span><span class="num" id="2647220">0xFFFFFFFF</span><span class="op" id="2647230">)</span>&nbsp;<span class="op" id="2647232">*</span>&nbsp;<span class="num" id="2647234">1e9</span><br>
<span class="lineno">1155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647240">u0x</span><span class="op" id="2647243">,</span>&nbsp;<span class="ident" id="2647245">u0</span>&nbsp;<span class="op" id="2647248">:=</span>&nbsp;<span class="ident" id="2647251">u0</span><span class="op" id="2647253">,</span>&nbsp;<span class="ident" id="2647255">u0</span><span class="op" id="2647257">+</span><span class="ident" id="2647258">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2647264">if</span>&nbsp;<span class="ident" id="2647267">u0</span>&nbsp;<span class="op" id="2647270">&lt;</span>&nbsp;<span class="ident" id="2647272">u0x</span>&nbsp;<span class="op" id="2647276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647281">u1</span><span class="op" id="2647283">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2647288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647292">u0x</span><span class="op" id="2647295">,</span>&nbsp;<span class="ident" id="2647297">u0</span>&nbsp;<span class="op" id="2647300">=</span>&nbsp;<span class="ident" id="2647302">u0</span><span class="op" id="2647304">,</span>&nbsp;<span class="ident" id="2647306">u0</span><span class="op" id="2647308">+</span><span class="ident" id="2647309">uint64</span><span class="op" id="2647315">(</span><span class="ident" id="2647316">nsec</span><span class="op" id="2647320">)</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2647324">if</span>&nbsp;<span class="ident" id="2647327">u0</span>&nbsp;<span class="op" id="2647330">&lt;</span>&nbsp;<span class="ident" id="2647332">u0x</span>&nbsp;<span class="op" id="2647336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647341">u1</span><span class="op" id="2647343">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2647348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2647353">//&nbsp;Compute&nbsp;remainder&nbsp;by&nbsp;subtracting&nbsp;r&lt;&lt;k&nbsp;for&nbsp;decreasing&nbsp;k.</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2647414">//&nbsp;Quotient&nbsp;parity&nbsp;is&nbsp;whether&nbsp;we&nbsp;subtract&nbsp;on&nbsp;last&nbsp;round.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647473">d1</span>&nbsp;<span class="op" id="2647476">:=</span>&nbsp;<span class="ident" id="2647479">uint64</span><span class="op" id="2647485">(</span><span class="ident" id="2647486">d</span><span class="op" id="2647487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2647491">for</span>&nbsp;<span class="ident" id="2647495">d1</span><span class="op" id="2647497">&gt;&gt;</span><span class="num" id="2647499">63</span>&nbsp;<span class="op" id="2647502">!=</span>&nbsp;<span class="num" id="2647505">1</span>&nbsp;<span class="op" id="2647507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647512">d1</span>&nbsp;<span class="op" id="2647515">&lt;&lt;=</span>&nbsp;<span class="num" id="2647519">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2647523">}</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647527">d0</span>&nbsp;<span class="op" id="2647530">:=</span>&nbsp;<span class="ident" id="2647533">uint64</span><span class="op" id="2647539">(</span><span class="num" id="2647540">0</span><span class="op" id="2647541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2647545">for</span>&nbsp;<span class="op" id="2647549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647554">qmod2</span>&nbsp;<span class="op" id="2647560">=</span>&nbsp;<span class="num" id="2647562">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2647567">if</span>&nbsp;<span class="ident" id="2647570">u1</span>&nbsp;<span class="op" id="2647573">&gt;</span>&nbsp;<span class="ident" id="2647575">d1</span>&nbsp;<span class="op" id="2647578">||</span>&nbsp;<span class="ident" id="2647581">u1</span>&nbsp;<span class="op" id="2647584">==</span>&nbsp;<span class="ident" id="2647587">d1</span>&nbsp;<span class="op" id="2647590">&amp;&amp;</span>&nbsp;<span class="ident" id="2647593">u0</span>&nbsp;<span class="op" id="2647596">&gt;=</span>&nbsp;<span class="ident" id="2647599">d0</span>&nbsp;<span class="op" id="2647602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2647608">//&nbsp;subtract</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647624">qmod2</span>&nbsp;<span class="op" id="2647630">=</span>&nbsp;<span class="num" id="2647632">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647638">u0x</span><span class="op" id="2647641">,</span>&nbsp;<span class="ident" id="2647643">u0</span>&nbsp;<span class="op" id="2647646">=</span>&nbsp;<span class="ident" id="2647648">u0</span><span class="op" id="2647650">,</span>&nbsp;<span class="ident" id="2647652">u0</span><span class="op" id="2647654">-</span><span class="ident" id="2647655">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2647662">if</span>&nbsp;<span class="ident" id="2647665">u0</span>&nbsp;<span class="op" id="2647668">&gt;</span>&nbsp;<span class="ident" id="2647670">u0x</span>&nbsp;<span class="op" id="2647674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647681">u1</span><span class="op" id="2647683">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2647690">}</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647696">u1</span>&nbsp;<span class="op" id="2647699">-=</span>&nbsp;<span class="ident" id="2647702">d1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2647708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2647713">if</span>&nbsp;<span class="ident" id="2647716">d1</span>&nbsp;<span class="op" id="2647719">==</span>&nbsp;<span class="num" id="2647722">0</span>&nbsp;<span class="op" id="2647724">&amp;&amp;</span>&nbsp;<span class="ident" id="2647727">d0</span>&nbsp;<span class="op" id="2647730">==</span>&nbsp;<span class="ident" id="2647733">uint64</span><span class="op" id="2647739">(</span><span class="ident" id="2647740">d</span><span class="op" id="2647741">)</span>&nbsp;<span class="op" id="2647743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2647749">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2647758">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647763">d0</span>&nbsp;<span class="op" id="2647766">&gt;&gt;=</span>&nbsp;<span class="num" id="2647770">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647775">d0</span>&nbsp;<span class="op" id="2647778">|=</span>&nbsp;<span class="op" id="2647781">(</span><span class="ident" id="2647782">d1</span>&nbsp;<span class="op" id="2647785">&amp;</span>&nbsp;<span class="num" id="2647787">1</span><span class="op" id="2647788">)</span>&nbsp;<span class="op" id="2647790">&lt;&lt;</span>&nbsp;<span class="num" id="2647793">63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647799">d1</span>&nbsp;<span class="op" id="2647802">&gt;&gt;=</span>&nbsp;<span class="num" id="2647806">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2647810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2647814">r</span>&nbsp;<span class="op" id="2647816">=</span>&nbsp;<span class="ident" id="2647818">Duration</span><span class="op" id="2647826">(</span><span class="ident" id="2647827">u0</span><span class="op" id="2647829">)</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2647832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2647836">if</span>&nbsp;<span class="ident" id="2647839">neg</span>&nbsp;<span class="op" id="2647843">&amp;&amp;</span>&nbsp;<span class="ident" id="2647846">r</span>&nbsp;<span class="op" id="2647848">!=</span>&nbsp;<span class="num" id="2647851">0</span>&nbsp;<span class="op" id="2647853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2647857">//&nbsp;If&nbsp;input&nbsp;was&nbsp;negative&nbsp;and&nbsp;not&nbsp;an&nbsp;exact&nbsp;multiple&nbsp;of&nbsp;d,&nbsp;we&nbsp;computed&nbsp;q,&nbsp;r&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2647943">//&nbsp;&nbsp;&nbsp;&nbsp;q*d&nbsp;+&nbsp;r&nbsp;=&nbsp;-t</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2647961">//&nbsp;But&nbsp;the&nbsp;right&nbsp;answers&nbsp;are&nbsp;given&nbsp;by&nbsp;-(q-1),&nbsp;d-r:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2648014">//&nbsp;&nbsp;&nbsp;&nbsp;q*d&nbsp;+&nbsp;r&nbsp;=&nbsp;-t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2648032">//&nbsp;&nbsp;&nbsp;&nbsp;-q*d&nbsp;-&nbsp;r&nbsp;=&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2648050">//&nbsp;&nbsp;&nbsp;&nbsp;-(q-1)*d&nbsp;+&nbsp;(d&nbsp;-&nbsp;r)&nbsp;=&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2648078">qmod2</span>&nbsp;<span class="op" id="2648084">^=</span>&nbsp;<span class="num" id="2648087">1</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2648091">r</span>&nbsp;<span class="op" id="2648093">=</span>&nbsp;<span class="ident" id="2648095">d</span>&nbsp;<span class="op" id="2648097">-</span>&nbsp;<span class="ident" id="2648099">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2648102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2648105">return</span><br>
<span class="lineno"></span><span class="op" id="2648112">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
